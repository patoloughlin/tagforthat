{"count":54201,"tag":"wpf","questions":[{"tags":["wpf","visual-studio","binding","textbox","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13281406,"title":"VSTUDIO2012 - Set binding for default text in WPF textbox","body":"<p>I'm trying to bind the default text in a textbox but i can't...</p>\n\n<p>in the mainwindow:</p>\n\n<pre><code>Private Sub Button_Click_2(sender As Object, e As RoutedEventArgs)\n\n    Dim usbmon_path As Object\n    usbmon_path = System.IO.Directory.GetCurrentDirectory &amp; \"\\USB MON\"\n\n    Dim W2 As New Window2\n    W2.Show()\n\nEnd Sub\n</code></pre>\n\n<p>(then the button open the window2 form)</p>\n\n<p>in the window2 xaml:</p>\n\n<pre><code> &lt;TextBox ..blabla...  Text=\"{Binding Path=usbmon_path}\"  ...blabla/&gt;\n</code></pre>\n\n<p>I don't get any error but text is empty...\nwhat i'm doing wrong?</p>\n\n<p>thankyou for read!</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13281143,"title":"How can I change the Icon of WPF application","body":"<p>I have a <code>wpf</code> application, I want to set the icon for all the windows.</p>\n\n<p>I have and <code>ico</code> file in my project folder /img/app.ico, but it is <code>build action = Resource</code>.</p>\n\n<p>I change the application <code>Icon and manifest</code> to <code>/img/app.ico</code>, but it won't work. </p>\n\n<p>An error is prompt when compiling:</p>\n\n<pre><code>The img/app.ico is not found.\n</code></pre>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13262258,"title":"PieSeries2D mouseClick on SeriesPoint showing another UserControl. IN WPF","body":"<p>I'm using DevExpress dxmvvm:ModuleView\nHERE IS MY XAML CODE. I want show PieChart some Series when click next UserControl. But when the A SeriesPoint click A_UserControl showing and B SeriesPoint click B_UserControl showing etc... Pls help me: HOW TO BINDING!!! My english is poor, sorry!!!</p>\n\n<pre><code>&lt;dxmvvm:ModuleView.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;viewModel:StrFlockTypeVM x:Key=\"strFlockModel\"/&gt;\n    &lt;/ResourceDictionary&gt;\n&lt;/dxmvvm:ModuleView.Resources&gt;\n\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;ContentControl Content=\"{Binding Navigator.View}\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Top\"/&gt;\n\n    &lt;dxc:ChartControl Grid.Row=\"1\"\n                      x:Name=\"strFlockChart\"\n                      HorizontalAlignment=\"Left\" \n                      VerticalAlignment=\"Top\" \n                      IsManipulationEnabled=\"True\"\n                      BorderThickness=\"1\"\n                      EnableAnimation=\"True\"&gt;\n\n        &lt;dxc:ChartControl.Diagram&gt;\n            &lt;dxc:SimpleDiagram2D&gt;\n                &lt;dxc:SimpleDiagram2D.Series&gt;\n                    &lt;dxc:PieSeries2D x:Name=\"series\"       \n                                     ArgumentScaleType=\"Qualitative\" \n                                     AnimationAutoStartMode=\"PlayOnce\"\n                                     HoleRadiusPercent=\"0\"\n                                     SweepDirection=\"Clockwise\"&gt;  \n\n                        &lt;dxc:PieSeries2D.PointAnimation&gt;\n                            &lt;dxc:Pie2DFlyInAnimation Duration=\"0:0:3\" \n                                                     PointOrder=\"Random\"/&gt;\n                        &lt;/dxc:PieSeries2D.PointAnimation&gt;\n                        &lt;dxc:PieSeries2D.PointOptions&gt;\n                            &lt;dxc:PointOptions PointView=\"ArgumentAndValues\"&gt;\n                                &lt;dxc:PointOptions.ValueNumericOptions&gt;\n                                    &lt;dxc:NumericOptions Format=\"Percent\" \n                                                        Precision=\"0\"/&gt;\n                                &lt;/dxc:PointOptions.ValueNumericOptions&gt;\n                            &lt;/dxc:PointOptions&gt;\n                        &lt;/dxc:PieSeries2D.PointOptions&gt;\n                        &lt;dxc:PieSeries2D.LegendPointOptions&gt;\n                            &lt;dxc:PointOptions Pattern=\"{}{A}\"/&gt;\n                        &lt;/dxc:PieSeries2D.LegendPointOptions&gt;\n                        &lt;dxc:PieSeries2D.Label&gt;\n                            &lt;dxc:SeriesLabel Visible=\"True\" \n                                             Indent=\"80\" \n                                             dxc:PieSeries.LabelPosition=\"TwoColumns\"\n                                             RenderMode=\"RectangleConnectedToCenter\"/&gt;\n                        &lt;/dxc:PieSeries2D.Label&gt;\n                        &lt;dxc:PieSeries2D.Points&gt;\n                            &lt;dxc:SeriesPoint Argument=\"A\" Value=\"120\"/&gt;\n                            &lt;dxc:SeriesPoint Argument=\"B\" Value=\"100\"/&gt;\n                            &lt;dxc:SeriesPoint Argument=\"C\" Value=\"80\"/&gt;\n                            &lt;dxc:SeriesPoint Argument=\"D\" Value=\"60\"/&gt;\n                            &lt;dxc:SeriesPoint Argument=\"E\" Value=\"50\"/&gt;\n                        &lt;/dxc:PieSeries2D.Points&gt;\n                        &lt;dxc:PieSeries2D.Model&gt;\n                            &lt;dxc:SimplePie2DModel/&gt;\n                        &lt;/dxc:PieSeries2D.Model&gt;\n                    &lt;/dxc:PieSeries2D&gt;\n                &lt;/dxc:SimpleDiagram2D.Series&gt;\n            &lt;/dxc:SimpleDiagram2D&gt;\n        &lt;/dxc:ChartControl.Diagram&gt;\n        &lt;dxc:ChartControl.ToolTipOptions&gt;\n            &lt;dxc:ToolTipOptions&gt;\n                &lt;dxc:ToolTipOptions.ToolTipPosition&gt;\n                    &lt;dxc:ToolTipRelativePosition/&gt;\n                &lt;/dxc:ToolTipOptions.ToolTipPosition&gt;\n            &lt;/dxc:ToolTipOptions&gt;\n        &lt;/dxc:ChartControl.ToolTipOptions&gt;\n        &lt;dxc:ChartControl.Palette&gt;\n            &lt;dxc:OfficePalette/&gt;\n        &lt;/dxc:ChartControl.Palette&gt;\n        &lt;dxc:ChartControl.Legend&gt;\n            &lt;dxc:Legend HorizontalPosition=\"Center\" VerticalPosition=\"BottomOutside\" Orientation=\"Horizontal\"/&gt;\n        &lt;/dxc:ChartControl.Legend&gt;\n    &lt;/dxc:ChartControl&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["wpf","silverlight","binding","controltemplate","contentpresenter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13280576,"title":"Binding ContentPresenter.Content to TemplatedParent (WPF/Silverlight)","body":"<p>Basically, I would like to overlay, for example: <code>TextBlock</code> over <code>Button</code>, by using ControlTemplate (applied to this <code>Button</code>), but I don't want to get rid of default template of it.</p>\n\n<p>Example:</p>\n\n<pre><code>&lt;Grid Grid.Row=\"1\" Grid.ColumnSpan=\"2\"&gt;\n    &lt;Grid.Resources&gt;\n        &lt;Style x:Key=\"myStyle\" TargetType=\"Button\"&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate TargetType=\"Button\"&gt;\n                        &lt;Grid&gt;\n                            &lt;ContentPresenter /&gt;\n                            &lt;TextBlock Text=\"textBlock\" \n                                Margin=\"10\" Foreground=\"Red\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/ControlTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/Grid.Resources&gt;\n\n    &lt;Button Style=\"{StaticResource myStyle}\" Content=\"button1\"&gt;&lt;/Button&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>and it gives <code>Button</code> stripped of it's default template:</p>\n\n<p><img src=\"http://i.stack.imgur.com/j5gqN.gif\" alt=\"enter image description here\"></p>\n\n<p>Rather, I would like to receive something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Q5Mmz.gif\" alt=\"enter image description here\"></p>\n\n<p>Is it possible by using <code>ControlTemplate</code>? I was trying to bind <code>TemplatedParent</code> to  <code>ContentPresenter.Content</code> like here:</p>\n\n<pre><code>&lt;ContentPresenter Content=\"{Binding \n        RelativeSource={RelativeSource Mode=TemplatedParent},\n        Path=., \n        Mode=TwoWay}\"/&gt;  \n</code></pre>\n\n<p>or other combinations, but I couldn't make it work.</p>\n"},{"tags":["c#","wpf","listbox","scrollbar"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13280837,"title":"WPF – Wrong scrolling in a reverse ordered (bottom to top) ListBox","body":"<p>I have the following code to reverse a <code>ListBox</code> (items are placed form bottom to top):</p>\n\n<pre><code>&lt;ListBox HorizontalContentAlignment=\"Stretch\"&gt;          \n    &lt;ListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel VerticalAlignment=\"Bottom\"  Orientation=\"Vertical\"&gt;\n                &lt;VirtualizingStackPanel.LayoutTransform&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/VirtualizingStackPanel.LayoutTransform&gt;\n            &lt;/VirtualizingStackPanel&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListBox.ItemsPanel&gt;\n    &lt;ListBox.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"ListBoxItem\"&gt;\n            &lt;Setter Property=\"LayoutTransform\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n</code></pre>\n\n<p>If you add some items, you will see that the scrollbar is wrong (original instead inverse). What can I do to transform the scrollbar like done with the content? BTW, If you set  <code>ScrollViewer.CanContentScroll=\"False\"</code> in the ListBox the scrolling is fine. But then Virtualization is lost.</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13261775,"title":"Custom Control's OnMouseLeftButtonDown isn't called","body":"<p>I'm pretty new to WPF, and I'm trying to write a custom control that is basically a TextBlock, but also has a click event. I tried piecing the thing together from various sources, but it does not work.</p>\n\n<p>In the following code, I would expect that <code>OnMouseLeftButtonDown</code> is called when a mouse click is performed on the element. If that happens, I want to raise the <code>Click</code> event. Looking in the debugger, the function is never called.</p>\n\n<p>Did I misunderstand how this is supposed to work, or did some other error find it's way into my code?</p>\n\n<pre><code>namespace EP3_gui.Controls\n{\n    public class ClickableTextBlock : TextBlock\n    {\n        public ClickableTextBlock() : base()\n        { }\n\n        public ClickableTextBlock( Inline inline )\n            : base( inline )\n        { }\n\n        protected override void OnMouseLeftButtonDown( MouseButtonEventArgs e )\n        {\n            base.OnMouseLeftButtonDown( e );\n            RoutedEventArgs args = new RoutedEventArgs( ClickEvent );\n            RaiseEvent( args );\n        }\n\n        public static readonly RoutedEvent ClickEvent = EventManager.RegisterRoutedEvent(\n            \"Click\",\n            RoutingStrategy.Bubble,\n            typeof( RoutedEventHandler ),\n            typeof( ClickableTextBlock )\n        );\n\n        public event RoutedEventHandler Click\n        {\n            add { AddHandler( ClickEvent, value ); }\n            remove { RemoveHandler( ClickEvent, value ); }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","xaml","listview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13280930,"title":"How can I create a hover button in a ListViewItem?","body":"<p>I'm making a ListView using WPF, and I want to have buttons that show up on the right side of the entry when the mouse hovers over the item. Now, I have already implemented this solution for a ListBox, but obviously a ListView is a different animal, and I can't figure out how to port it over.  With the same code as the ListBox, the buttons show up, but the ListViewItem is no longer useful (can't be sorted), and does not display correctly.  Here's the code I have for the ListBox hover buttons; does anyone know how to make it work for a ListView?</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n    &lt;Setter Property=\"ContentTemplate\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;DataTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBlock Text=\"{Binding}\" /&gt;\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type ListViewItem}\"&gt;\n                &lt;Grid Background=\"Transparent\"&gt;\n                    &lt;Button x:Name=\"editButton\" Click=\"editButton_Click\" Width=\"16\" Height=\"16\" HorizontalAlignment=\"Right\" Margin=\"0,0,20,0\" Visibility=\"Hidden\"&gt;\n                        &lt;Button.Template&gt;\n                            &lt;ControlTemplate&gt;\n                                &lt;Border HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n                                    &lt;Image&gt;\n                                        &lt;Image.Source&gt;\n                                            &lt;BitmapImage UriSource=\"/XXXX;component/Resources/edit_icon_16x16.png\"&gt;&lt;/BitmapImage&gt;\n                                        &lt;/Image.Source&gt;\n                                    &lt;/Image&gt;\n                                &lt;/Border&gt;\n                            &lt;/ControlTemplate&gt;\n                        &lt;/Button.Template&gt;\n                    &lt;/Button&gt;\n                    &lt;ContentPresenter/&gt;\n                &lt;/Grid&gt;\n                &lt;ControlTemplate.Triggers&gt;\n                    &lt;Trigger  Property=\"IsMouseOver\" Value=\"True\"&gt;\n                        &lt;Setter Property=\"Visibility\" TargetName=\"editButton\" Value=\"Visible\" /&gt;\n                    &lt;/Trigger&gt;\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["wpf","linq","c#-4.0",".net-4.0","observablecollection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13279133,"title":"What more LINQ operators/methods can I use to optimize my C# Collections based code?","body":"<p><strong>Is there a way (using <code>LINQ</code> possibly) I can optimize the below code</strong>. What this code does is adds, removes and updates the items in the variable <code>myFirstCollection</code> by comparing the items in variable <code>mySecondCollection</code>. Can somehow I use more LINQ methods/queries or other LINQ operators so that the <code>myFirstCollection</code> variable is compared and updated as quickly as possible. </p>\n\n<p><strong>To add to my requirement, my <code>ObservableCollection</code> variable <code>myfirstCollection</code> is bound to the <code>WPF Grid</code> so that the additions, deletions and, updates are reflected in grid immediately with data binding.</strong></p>\n\n<pre><code>private void UpdateFirstCollection(ObservableCollection&lt;MyDTO&gt; myFirstCollection, IEnumerable&lt;MyDTO&gt; mySecondCollection)\n{\n//Code to add items to First Collection, how to optimize this block?\n    foreach (var item in mySecondCollection.ToList())\n    {\n        if (!myFirstCollection.Contains(item))\n        {\n            myFirstCollection.Add(item);\n        }\n        else\n        {\n//Code to update items from First Collection, how to optimize this block?\n            var itemToUpdate = myFirstCollection.FirstOrDefault(dto =&gt; dto.ID == item.ID);\n            if (itemToUpdate != null)\n            {\n                itemToUpdate = item;\n            }\n        }\n    }\n\n//Code to remove items from First Collection, how to optimize this block?\n    var copy = new ObservableCollection&lt;myDTO&gt;(myFirstCollection);\n    foreach (var item in copy.ToList())\n    {\n        if (!mySecondCollection.Contains(item))\n        {\n            myFirstCollection.Remove(item);\n        }\n    }\n}\n</code></pre>\n\n<p>Any help to <em>Refactor</em> / <em>Improve</em> the above code based on any articles/links is highly appreciated.</p>\n"},{"tags":["c#","wpf","filenotfoundexception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":291,"score":0,"question_id":7413907,"title":"BitmapImage filenotfound exception (PresentationCore.resources) on construction","body":"<p>I have a problem with a BitmapImage in wpf. When i create it it gives a filenotfound exception, which says it's missing the PresentationCore.resources assembly. But i've added it to my references list and it still throws the same exception</p>\n\n<pre><code>Uri filename = new Uri(@\"D:\\barcode_zwart_wit.jpg\", UriKind.Absolute);\nBitmapImage image = new BitmapImage(filename); //&lt;-- FileNotFound Exception\n</code></pre>\n\n<ul>\n<li>The image uri is correct.<br/></li>\n<li>The image isn't opened somewhere else</li>\n<li>I've checked the version of the PresentationCore.resources, no problem there.<br/></li>\n<li>The lines are in the setter of a property, which is first launched in the constructor of a usercontrol.<br/></li>\n<li>Visual Studio 2010, .net v4</li>\n</ul>\n\n<p>Does anyone have any idea what's the problem? Does PresentationCore.resources have any dependencies i don't know about?</p>\n"},{"tags":["c#","wpf",".net-assembly","serializable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13263043,"title":"c# Serializable Class - WPF MainWindow Exception Occurs","body":"<p>I have a WPF application which is hooking into a DLL that I am also writing. The DLL scans a data folder of a 3rd Party application and handles all the interpretation of data within. The WPF is to provide a nice GUI on top of that; I separated them because it may be necessary in the future to write a command line interface for it too.</p>\n\n<p>The scanning of the data folder takes some time so I wanted to save the state of the object (a Repository) and open that instead if the data folder has been scanned and retains the same 'Last Modified' state. I have marked the Repository object as [Serializable] however when I attempt to save the state (from either the WPF or the DLL) I get an exception that the WPF MainWindow is not [Serializable].</p>\n\n<p>If I read the created .dat file it does have some (not sure if all) information from that class.</p>\n\n<p>I don't understand why it would be trying to save any information about the WPF windows. I have tried to mark the window as [Serializable] just to try however that class does not allow it. Searching around the web had me looking into AppDomains since I'm loading a DLL along with the application but that is a little over my head. Below is how I am currently trying to implement it. Edit: The call to serialize is at the bottom of the WPF code. </p>\n\n<p>I should mention that I created an inline class within the WPF namespace and was able to successfully serialize that to a file.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>This is the DLL:</p>\n\n<pre><code>namespace HPOO_XML_Parser\n{\n[Serializable]\npublic class HPOORepository\n{\n\n    string _version;\n    string _path;\n    string _library;\n    string _uuid;\n\n\n    [NonSerialized]\n    BackgroundWorker bWorker = new BackgroundWorker();\n    [NonSerialized]\n    XElement _xmlRepo;      \n\n\n    int _nodeCount;\n    List&lt;Node&gt; nodes;\n    ...\n    Rest of properties and methods\n}\n</code></pre>\n\n<p>And the WPF which calls it</p>\n\n<pre><code>namespace HPOO_Repository_Scanner\n{\n/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    HPOORepository repo;\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        StatusVisibility(); // Simply hides progress bar/cancel button\n    }\n\n    private void OpenRepository(object sender, RoutedEventArgs e)\n    {\n\n        string ooHome;\n        using (FolderBrowserDialog browser = new FolderBrowserDialog())\n        {\n            ooHome = Environment.GetEnvironmentVariable(\"ICONCLUDE_HOME\");\n            if (ooHome != null)\n            {\n                browser.SelectedPath = ooHome;\n            }\n            browser.ShowNewFolderButton = false;\n            browser.Description = \"Select a repository to open...\";\n\n            if (browser.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                try\n                {\n                    repo = new HPOORepository(browser.SelectedPath);\n                }\n                catch (Exception ex)\n                {\n                    System.Windows.MessageBox.Show(ex.Message, \"Invalid Repository Selected\", MessageBoxButton.OK, MessageBoxImage.Error);\n\n                }\n            }\n            repo.ProgressChanged += new ProgressChangedEventHandler(repo_ProgressChanged);\n\n            prgStatus.Maximum = 100;\n\n            repo.ReadRepository();\n\n        }\n\n    }\nprivate void mnuSave_Click(object sender, RoutedEventArgs e)\n    {\n        SaveRepo(repo);\n    }\n\n    public void SaveRepo(object repository)\n    {\n        BinaryFormatter binFormat = new BinaryFormatter();\n\n        using (Stream fStream = new FileStream(\"test\" + \".dat\",\n            FileMode.Create, FileAccess.Write, FileShare.None))\n        {\n            binFormat.Serialize(fStream, repository);\n        }\n    }\n</code></pre>\n\n<p>Edit: And finally the exception:</p>\n\n<pre><code>System.Runtime.Serialization.SerializationException was unhandled\nMessage=Type 'HPOO_Repository_Scanner.MainWindow' in Assembly 'HPOO Repository Scanner, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.\nSource=mscorlib\nStackTrace:\n\n\n    at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)\n       at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph)\n       at HPOO_Repository_Scanner.MainWindow.SaveRepo(Object repository) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 179\n       at HPOO_Repository_Scanner.MainWindow.mnuSave_Click(Object sender, RoutedEventArgs e) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 168\n       at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)\n       at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\n       at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\n       at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e)\n       at System.Windows.Controls.MenuItem.InvokeClickAfterRender(Object arg)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.DispatcherOperation.InvokeImpl()\n       at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)\n       at System.Threading.ExecutionContext.runTryCode(Object userData)\n       at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Windows.Threading.DispatcherOperation.Invoke()\n       at System.Windows.Threading.Dispatcher.ProcessQueue()\n       at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)\n       at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n       at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)\n       at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.Run()\n       at System.Windows.Application.RunDispatcher(Object ignore)\n       at System.Windows.Application.RunInternal(Window window)\n       at System.Windows.Application.Run(Window window)\n       at System.Windows.Application.Run()\n       at HPOO_Repository_Scanner.App.Main() in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\obj\\x86\\Debug\\App.g.cs:line 0\n       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ThreadHelper.ThreadStart()\n  InnerException: \n</code></pre>\n"},{"tags":["wpf","xaml","progress-bar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13280375,"title":"override bound value of progressbar with a setter in xaml/wpf","body":"<p>I have the following XAML</p>\n\n<pre><code>&lt;ProgressBar Grid.Column=\"0\" Grid.Row=\"0\" Margin=\"0,1\" Minimum=\"0\" Maximum=\"100\" Value=\"{Binding Progress}\"&gt;\n    &lt;ProgressBar.Resources&gt;\n        &lt;Style TargetType=\"{x:Type ProgressBar}\"&gt;\n            &lt;Style.Triggers&gt;\n                &lt;DataTrigger Binding=\"{Binding DidAllServicesRestart}\" Value=\"False\"&gt;\n                    &lt;Setter Property=\"Foreground\" Value=\"DarkRed\"/&gt;\n                    &lt;Setter Property=\"Value\" Value=\"100\"/&gt;\n                &lt;/DataTrigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/ProgressBar.Resources&gt;\n&lt;/ProgressBar&gt;\n</code></pre>\n\n<p>The DataTrigger works great for setting Foreground to DarkRed, but setting the value of the progressbar to 100 does not work. I'm guessing because the {Binding Progress} overrides it?</p>\n\n<p>How can I work around this?</p>\n"},{"tags":["wpf","itemscontrol","findcontrol"],"answer_count":5,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":14212,"score":9,"question_id":980120,"title":"Finding control within WPF itemscontrol","body":"<p>Hi i have few a single textbox within the the datatemplate for itemscontrol. When i bind the itemcontrols to a observable collection i get two text boxes. But i need to do some manipulations based on each of the text boxes for which i want to find each textbox seperatly using some id.</p>\n\n<p>Can anybody help on how to find a control witin the itemscontrol in WPF.</p>\n"},{"tags":["wpf","treeview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280054,"title":"WPF highliting treeview row at mouse hover.","body":"<p>I have a question about how can I highlight only one row at mouse hover event in treeview.\nI've added trigger </p>\n\n<pre><code>     &lt;MultiTrigger&gt;\n                        &lt;MultiTrigger.Conditions&gt;\n                            &lt;Condition Property=\"IsMouseOver\" Value=\"True\"&gt;&lt;/Condition&gt;\n                        &lt;/MultiTrigger.Conditions&gt;\n                        &lt;Setter TargetName=\"Bd\" Property=\"Background\" Value=\"{DynamicResource {x:Static SystemColors.HighlightBrushKey}}\"&gt;&lt;/Setter&gt;\n     &lt;/MultiTrigger&gt;\n</code></pre>\n\n<p>But I get the following result:</p>\n\n<p>Here pic:http://i.stack.imgur.com/j9N3x.png</p>\n\n<p>As you can see that parents of each item is highlighted also. In this example - mouse was over TempPE item.</p>\n"},{"tags":["wpf","binding","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3,"score":1,"question_id":13279908,"title":"CurrentCell is changed to a row that isn't SelectedItem in Datagrid","body":"<p>I have a DataGrid that is part of a DataTemplate that is assigned to the ContentTemplate of a TabControl.  The TabControl's ItemsSource is bound to a collection and, as such, the DataContext for the DataGrid changes to a new collection once each Tab is selected.  Currently, there are bindings for ItemsSource and SelectedItem on the DataGrid.  </p>\n\n<p>When I move through the tabs the DataGrid is able to keep the selected row synchronized properly but the problem I'm having is that CurrentCell is always set to the first column and first row regardless of what SelectedItem equals.</p>\n\n<p>I've tried setting the CurrentCell property when the DataContext changes for the DataGrid but the DataGrid always resets it back to the first row and first column.  Does anyone know how I can accomplish keeping the CurrentCell on the same Row as SelectedItem when DataContext changes?</p>\n"},{"tags":["c#","wpf","pixelsense"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13279322,"title":"Finding a dynamically added ScatterViewItem","body":"<p>I have the following: </p>\n\n<pre><code>Window window = Application.Current.Windows.Cast&lt;Window&gt;().SingleOrDefault(x =&gt; x.IsActive);\nScatterView main = UIHelper.FindChild&lt;ScatterView&gt;(window, \"MainScatterView\");\n        main.Items.Add(type);\n\n//Neither of these work\nScatterViewItem parent = (ScatterViewItem)main.ContainerFromElement(type);\n\nScatterViewItem parent = UIHelper.FindVisualParent&lt;ScatterViewItem&gt;(type);\n</code></pre>\n\n<p>The documentation says: <em>When you add an object that is not of type ScatterViewItem, the ScatterView control first wraps the object in a ScatterViewItem control before adding it to the collection</em> <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx</a></p>\n\n<p>How does one get the scatterviewitem that it has been wrapped in?</p>\n"},{"tags":["wpf","vb.net","flowdocument","rich-text"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":506,"score":8,"question_id":4864226,"title":"flowdocument - inserting rich text at end creating extra paragraph breaks above insertion point","body":"<p>I am creating a flowdocument that consists of multiple records. Each record contains two tables at the top, and then some rich text that I'm pulling out of a database. The code that appends the rich text is found below (cp.Comments contains the rtf tagged text).</p>\n\n<pre><code>Dim tr As TextRange\nDim arr() As Byte\n\nUsing ms As New System.IO.MemoryStream\n  arr = (New System.Text.UTF8Encoding).GetBytes(cp.Comments)\n  ms.Write(arr, 0, arr.Length)\n  ms.Seek(0, IO.SeekOrigin.Begin)\n\n  tr = New TextRange(fd.ContentEnd, fd.ContentEnd)   'add to end\n  tr.Load(ms, DataFormats.Rtf)\nEnd Using\n</code></pre>\n\n<p>The flowdocument renders the first of the records correctly, but all subsequent records are rendered with a break between the first and the second table.  What is the most odd is that I'm rendering the 2 tables <em>before</em> importing the RTF, but the RTF is somehow affecting the spacing between the tables anyway.</p>\n\n<pre><code>fd = new FlowDocument\n\nfor each cp in SomeCollection\n\n   fdtemp = New FlowDocument\n\n   CreateFirstTable(cp, fdtemp)\n   CreateSecondTable(cp, fdtemp)\n   AddRTF(cp, fdtemp)\n\n   FlowDocumentUtils.AddDocument(fdtemp, fd)\n\nnext\n</code></pre>\n\n<p>The problem isn't something related to the data in the first element of the collection - if I tell the rendering to skip the rendering of the first record, then the second record renders ok, but the rest contain the extra spacing.</p>\n\n<p>Note: the problem is definitely related to the rich text insertion - if I comment out the AddRTF call, then all the tables are correctly rendered smashed together. (table margins are all set to (0,0,0,0))</p>\n\n<p>Has anyone ever seen this?</p>\n"},{"tags":["c#","wpf","performance","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13279655,"title":"How to make my WPF application as FAST as Outlook","body":"<p>The commons WPF applications take some time for loading medium complex views, once the view is loaded it works fine. For example in a Master - Detail view, if the Detail view is very complex and use different DataTemplates take some seconds (2-3 seconds) for load the view.</p>\n\n<p>When i open the Outlook application, for instance, it renders complex views and it is relative much more fast.</p>\n\n<p>Is there a way for increase the performance of my WPF application? Maybe a way for not loading the template's data every time that change the \"master\" item, and load it only one time in the app time live?</p>\n\n<p>i will appreciate any suggestion. </p>\n"},{"tags":["c#","wpf","usercontrols"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13161987,"title":"Why is the Dependency Property not returning its value?","body":"<p>I have a MyUserControl with the following Xaml:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding InputValueProperty}\" /&gt;\n</code></pre>\n\n<p>In the MyUserControl.xaml.cs I have:</p>\n\n<pre><code>public string InputValue\n{\n    get { return (string)GetValue(InputValueProperty); }\n    set { SetValue(InputValueProperty, value); }\n}\npublic static readonly DependencyProperty InputValueProperty = \n    DependencyProperty.Register(\"InputValueProperty\", typeof(string), \n    typeof(MyUserControl));\n</code></pre>\n\n<p>In my MainWindow.xaml I create a user control:</p>\n\n<pre><code>&lt;local:MyUserControl InputValue=\"My Input\" /&gt;\n</code></pre>\n\n<p>Later on in my MainWindow.xaml.cs I am trying to access this string.  All instances of MyUserControl are contained in a List and I access them with a foreach.</p>\n\n<pre><code>string temp = userControl.InputValue;\n</code></pre>\n\n<p>This is always null.  In my MainWindow.xaml I can see the \"My Input\" in the text box of the user control but I can't ever seem to get it out of there. </p>\n"},{"tags":["c#","wpf","richtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":13116278,"title":"How can I type half-space in RichTextBox?","body":"<p>When I press \"Shift + Space\" to type half-space (when I 'm writing in Persian) in a RichTextBox, it just inserts space. It types all other Persian characters correctly, but when it comes to \"Shift+Space\", it types just space.</p>\n\n<p>The name of this character is \"ZERO WIDTH NON-JOINER\" and the information is given in this link: <a href=\"http://www.fileformat.info/info/unicode/char/200c/index.htm\" rel=\"nofollow\">http://www.fileformat.info/info/unicode/char/200c/index.htm</a>.</p>\n\n<p>I should mention that I fixed the problem by handling previewKewDown event; but I like to know what is the problem with this key combination in a RichTextBox.</p>\n\n<p>thanks.</p>\n"},{"tags":[".net","wpf","animated-gif"],"answer_count":9,"favorite_count":20,"up_vote_count":41,"down_vote_count":0,"view_count":34390,"score":41,"question_id":210922,"title":"How do I get an animated gif to work in WPF?","body":"<p>What control type should I use - Image, MediaElement, etc??</p>\n"},{"tags":["c#","wpf","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13275949,"title":"update dataGrid back to ef from anonymous type","body":"<p>The following code shows into dataGrid result from two tables</p>\n\n<p>But I understand that I can not update the data back into the DB (since it shows anonymous type)</p>\n\n<pre><code>public class NameAndDone\n{\n    public string document_Name { get; set; }\n    public bool ? document_Done { get; set; }\n}\n\n\n       vagEntities projectE = new vagEntities();\n       var doc = from c in projectE.Person_Documents\n                  join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n                  where c.Person_Id == selc   \n                  select new NameAndDone { document_Name = cw.Document_Name,document_Done = c.Document_done};\n\n       carsGrid.ItemsSource = doc;\n</code></pre>\n\n<p>and in the xaml </p>\n\n<pre><code>        &lt;DataGrid Grid.Row=\"1\" RowHeight=\"30\" AutoGenerateColumns=\"False\" Margin=\"15,15,15,96\" x:Name=\"carsGrid\" &gt;\n    &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn  Binding=\"{Binding Path=document_Name}\" MinWidth=\"100\" Header=\"Documents\"  /&gt;\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=document_Done}\" Header=\"Done\" /&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>My question is: Is it possible to update with the saveChanges () function?\nOr I need to change all the code (hope not)</p>\n\n<p>Thanks in advance to anyone who helps (even if I can not understand)</p>\n\n<p>Please, does anyone have an idea?</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278522,"title":"How to add a context menu for only one level in a TreeView","body":"<p>I've got a TreeView, containing a number of levels of <code>TreeViewItems</code>.</p>\n\n<p>I would like to add a context menu to only one level of items in the TreeView. However, my code produces a result whereby every single item in the TreeView has a context menu.</p>\n\n<p>This is my code:    </p>\n\n<pre><code>//.... foreach item in this level.... \n\n{\nContextMenu cmDatabase = new ContextMenu();\nMenuItem menuItem = new MenuItem();\nmenuItem.Header = \"Close Connection\";\nImage imgMenuIcon = new Image();\nimgMenuIcon.Source = new BitmapImage(new Uri(\"icon.png\"));\nmenuItem.Icon = imgMenuIcon;\ncmDatabase.Items.Add(menuItem);\ntreeViewItem.ContextMenu = cmDatabase;\n}\n</code></pre>\n\n<p>I've also tried manually setting all the other TreeViewItems' contextMenu property to null.  No luck though.  Any ideas?</p>\n"},{"tags":["c#","wpf","multithreading","user-interface","wpf-controls"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13273289,"title":"WPF Control On Separate UI Thread?","body":"<p>I am making a media player, now.. I have added a realtime search function to search for songs etc. (Some thing like WMP realtime search) i.e while you enter the keywords the searching happens.</p>\n\n<p>During the searching process, accessing the database and loading an IEnumerable is done on another thread via a BackGroundProcess. The UI is updated by invoking a dispatcher of a UIElement.</p>\n\n<p>This process is rather fast, but however while you enter the search keywords in the textbox, there seems to be a small lag, this is beacause the Listbox.ItemSource updating takes some time. \ni.e say you want to search for \"Adele\", when you type in \"a\", the search function loads the results for \"A\", but as we are typing the whole word \"Adele\" , it some time to display the \"d\" \"e\" \"l\" \"e\" and there is a slight lag in between these letters.</p>\n\n<p>During this search process, when I stop updating the UI the search process seems very smooth, this only means to me that the Listbox is locking up the thread, so the rest of the player's UI is stuck there while the Listbox is done with its processing.</p>\n\n<p>So I believe if I can put the Listbox Control to another UI thread, I can maintain the smooth flow of the player irrespective of the time taken to load the Listbox.\nFYI: Data Virutualization is there &amp; ListBox has UI Virtualization is working</p>\n\n<p>How can i put the ListBox control onto another UI Thread?\nWPF, C#</p>\n\n<p>Thanks in advance  :)</p>\n"},{"tags":[".net","sql-server","wpf","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":10,"score":3,"question_id":13278889,"title":"How to add data to SQL Server Express database using Entity Framework","body":"<p>I'm writing simple program for my university. I created an Entity Framework model, draw diagrams, created database from model, applied SQL file on my database and now I'm trying to add some items to the DB. </p>\n\n<p>I'm doing it this way:</p>\n\n<pre><code>using (NewsletterEntities context = new NewsletterEntities())\n{\n   Sender newSender = new Sender();\n   newSender.Login = Login.Text;\n   newSender.Password = Password.Text;\n   newSender.Port = 23;\n   newSender.SMTP = SMTP.Text;\n   newSender.Email = Email.Text;\n   newSender.SenderID = 0;\n\n   context.Senders.AddObject(newSender);\n   context.SaveChanges();\n}\n</code></pre>\n\n<p>When I try to execute it it pops up with inner exception: </p>\n\n<blockquote>\n  <p>Cannot insert explicit value for identity column in table 'Senders' when IDENTITY_INSERT is set to OFF.</p>\n</blockquote>\n\n<p>I was trying to look for the error, but I don't know much about entity framework and couldn't find anything specific.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["wpf","xaml","caching"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13278848,"title":"WPF Frame serving cached page","body":"<p>I am writing a help system for a WPF application.  I came up with a system where the content owner will build templates in a simplified XML format that is transformed with XSLT to XAML through an HttpModule in IIS, the generated XAML pages are displayed in a Frame in the client application.  I expose basic functionality to the pages through a View Model, so commands and data are available from the client application.</p>\n\n<p>This works well but my problem is that it seems the Frame is caching the XAML someplace.  For example, if I make a change to the XML, the client continues to display the previous XAML.  If I navigate to the URI in an external browser(IE or Chrome), I can see the new XAML.  Strangely enough, this also causes the Frames cache to be updated with the new XAML.</p>\n\n<p>This caching persists across restarts of the application, my process for development has been, make the change to the XML, navigate to the URI in IE, then navigate in the client application.  This is annoying and also when this goes live I can't have this behavior.</p>\n\n<p>When I am navigating in the page, I am doing it by assigning the URI to the Frame's Source property, like this:</p>\n\n<pre><code>instance.Frame.Source = new Uri(instance.WizardUri, instance.PageUri);\n</code></pre>\n\n<p>Any ideas on what could be causing this?</p>\n"},{"tags":["c#","wpf","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278426,"title":"WPF -- property is null when next page is shown","body":"<p>I'm having an issue where on my listview, when I select an item, the row highlight and the value for the property does get set. But when I click on the button to show the second page, the listview isnt highlighted/selected from the previous. The property is null. The two listview on each page reference the same properties for itemsource and selecteditem. Can anyone help me on why second page doesnt trigger property?</p>\n\n<p>MainWindow.xaml</p>\n\n<pre><code>    &lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Button Name=\"btnPrevious\" Content=\"&amp;lt;\" Grid.Column=\"0\" Height=\"300\" Click=\"btnPrevious_Click\"&gt;&lt;/Button&gt;\n        &lt;Grid Width=\"310\" Height=\"300\" Grid.Column=\"2\"&gt;\n            &lt;Frame x:Name=\"UserControlContainer\" NavigationUIVisibility=\"Hidden\" Width=\"310\" /&gt;\n        &lt;/Grid&gt;\n        &lt;Button Name=\"btnNext\" Content=\"&amp;gt;\" Grid.Column=\"4\" Height=\"300\" Click=\"btnNext_Click\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>MainWindow.xaml.cs</p>\n\n<pre><code>public partial class MainWindow : UserControl\n    {\n        private FirstPage fPage;\n        private SecondPage sPage;\n\n        private static int oldIndex = 1;\n\n        public FirstPage FPage\n        {\n            get\n            {\n                if (fPage == null)\n                    fPage = new FirstPage();\n\n                return fPage;\n            }\n            set\n            {\n                fPage = value;\n            }\n        }\n\n        public SecondPage SPage\n        {\n            get\n            {\n                if (sPage == null)\n                    sPage = new SecondPage();\n\n                return sPage;\n            }\n            set\n            {\n                sPage = value;\n            }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            UserControlContainer.Source = new Uri(\"Views\\\\FirstPage.xaml\", UriKind.Relative);\n        }\n\n        private void btnPrevious_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.FPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 2);\n\n            oldIndex = 2;\n        }\n\n        private void btnNext_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.SPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 1);\n\n            oldIndex = 1;\n        }\n    }\n</code></pre>\n\n<p>MainViewModel.cs</p>\n\n<pre><code>public class MainViewModel : INotifyPropertyChanged\n{\n    Dictionary&lt;int, string&gt; itemList;\n    KeyValuePair&lt;int, string&gt;? selectedItemList = null;\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    private void NotifyPropertyChanged(String PropertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));\n        }\n    }\n\n    public Dictionary&lt;int, string&gt; ItemList\n    {\n        get\n        {\n            itemList = GetItemsList();\n            return itemList;\n        }\n    }\n\n    private Dictionary&lt;int, string&gt; GetItemsList()\n    {\n        var resultList = new Dictionary&lt;int, string&gt;();\n\n        resultList.Add(1, \"Item I\");\n        resultList.Add(2, \"Item II\");\n        resultList.Add(3, \"Item III\");\n\n        return resultList;\n    }\n\n    public KeyValuePair&lt;int, string&gt;? SelectedItemList\n    {\n        get \n        { \n            return selectedItemList; \n        }\n        set\n        {\n            selectedItemList = value;\n            NotifyPropertyChanged(\"SelectedNewPtLevel\");\n        }\n    }\n}\n</code></pre>\n\n<p>FirstPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstFirst\" HorizontalAlignment=\"Left\"  \n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Yellow\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>SecondPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstSecond\" HorizontalAlignment=\"Left\"\n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Pink\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n"},{"tags":["wpf","tabcontrol","tabitem","hierarchicaldatatemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13278708,"title":"Hierarchical TabControl","body":"<p>I would realize a sort of \"Hierarchical TabControl\" in which there are TabItems as root and all their related children (shown always as TabItem).</p>\n\n<p>I have to realize that using WPF, so I try to write a ContentTemplate of TabItem, using the HierarchicalDataTemplate, but with any result :(</p>\n\n<p>I would like to obtain something like this:\n <img src=\"http://i.stack.imgur.com/um1ZG.jpg\" alt=\"enter image description here\"></p>\n\n<p>Can anyone of you give me some advices?</p>\n\n<p>Thanks in advance,</p>\n\n<p>Deby</p>\n"},{"tags":["c#",".net","wpf","mvvm","avalonedit"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":288,"score":2,"question_id":12344367,"title":"Making AvalonEdit MVVM compatible","body":"<p>I'm trying to make Avalon MVVM compatible in my WPF application. From googling, I found out that <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">AvalonEdit is not MVVM friendly</a> and I need to export the state of AvalonEdit by making a class derived from TextEditor then adding the necessary dependency properties. I'm afraid that I'm quite lost in Herr Grunwald's answer <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>If you really need to export the state of the editor using MVVM, then I suggest you create a class deriving from TextEditor which adds the necessary dependency properties and synchronizes them with the actual properties in AvalonEdit.</p>\n</blockquote>\n\n<p>Does anyone have an example or have good suggestions on how to achieve this?</p>\n"},{"tags":["c#","wpf","xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":48,"score":-6,"question_id":13277692,"title":"Is a Database or XML file better for storing information?","body":"<p>I have some information that needs be stored.  These are \"default values\" for certain inputs that are contained in the program.</p>\n\n<p>Would it be better to store this information in a Database or an XML file?  Which is faster?</p>\n\n<p>Currently there are 2 versions of the program that I am re-writing.  1 version uses an XML file and the other uses an Access database.</p>\n\n<p>What do you think is the best one?</p>\n"},{"tags":["c#","wpf","splash-screen","timespan","eventlistener"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":129,"score":8,"question_id":13213625,"title":"SplashScreen.Close(Timespan.FromMilliseconds(int)) : Is there an Event dispatched at Timespan Complete?","body":"<p>C# WPF Application</p>\n\n<p>I have a <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.aspx\" rel=\"nofollow\">SplashScreen</a> being displayed at startup for a minimum amount of time by using</p>\n\n<pre><code>Thread.Sleep(int); //int = milliseconds to display splash screen\n</code></pre>\n\n<p>When that sleep time is reached, the code resumes and the SplashScreen fades out to close by using</p>\n\n<pre><code>SplashScreen.Close(Timespan.FromMilliseconds(int)); //int = milliseconds fade-out\n</code></pre>\n\n<p>I would like to pause at this point to wait until the SplashScreen has become 100% transparent and is fully closed, then continue with other tasks, I.E. Writiting to the Console or displaying a MainWindow. </p>\n\n<p>Is there an event fired when the (TimeSpan.FromMilliseconds(int)) is complete?\nAny other suggestions?</p>\n\n<pre><code>namespace StartupSplash\n{\n    public class SplashScreenStartup\n    {\n        //IMPORTANT:set image property to Resource and NOT Splash Screen\n        private SplashScreen Splash = new SplashScreen(\"Resources/SplashScreen.png\");\n\n        public void SplashScreenStartUp()\n        {\n            Splash.Show(false, true);\n            Thread.Sleep(3000); // Pause code, display splash screen 3 seconds\n            Splash.Close(TimeSpan.FromMilliseconds(3000)); // 3 second splash fade-out\n            // I want to wait until splash screen fadeOut has completed before\n            // this next console output is performed.\n            Console.WriteLine(\"Executes before Splash fadeOut completes.\");\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","wpf","xaml","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278040,"title":"Datagrid RowDetails not being updated","body":"<p>I'm having a problem getting the <code>RowDetailsTemplate</code> to update when modifying the collection (\"Items\") that a <code>DataGrid</code> is bound to.  The collection is being modified from within a view model.  When I modify the <i>contents</i> of one of the bound items, the change is updated in both the DataGridRow and RowDetailsTemplate.  E.g.</p>\n\n<pre><code>Items[i].Name = \"new name\";  // RowDetailsTemplate gets updated\n</code></pre>\n\n<p><b>But</b> if I assign one of the items to a totally new object the DataGridRow updated, but the RowDetailsTemplate doesn't get updated. E.g.</p>\n\n<pre><code>Items[i] = new Model {Name = \"new name\"};  // RowDetailsTemplate NOT updated\n</code></pre>\n\n<p>The only thing I thought at first was that I needed to add a listener to the CollectionChanged event of the bound Items and explicitly raise a property change notification. E.g</p>\n\n<pre><code>Items = new ObeservableCollection&lt;Model&gt;();\nItems.CollectionChanged += (o,e) =&gt; OnNotifyPropertyChanged(\"Items\");\n</code></pre>\n\n<p>but that didn't work.</p>\n\n<p>My XAML bindings look like this:</p>\n\n<pre><code>&lt;DataGrid DataContext=\"{StaticResource viewmodel}\" \n          ItemsSource=\"{Binding Items, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"&gt;\n  &lt;DataGrid.RowDetailsTemplate&gt;\n    &lt;DataTemplate&gt;\n      &lt;TextBlock Text=\"{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"/&gt;\n    &lt;/DataTemplate&gt;\n  &lt;/DataGrid.RowDetailsTemplate&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Why is the <code>DataGridRow</code> notified of the changed Item but not the <code>RowDetailsTemplate</code>?!</p>\n\n<p><b>Update</b>\nDoing a delete/add instead of modifying the collection works.  E.g.</p>\n\n<pre><code>Items.Remove(Items[i]);\nItems.Add (new Model {Name = \"new name\"});  // RowDetailsTemplate updated OK\n</code></pre>\n\n<p>(Oh and the Model class of course implements <code>INotifyPropertyChanged</code>.)</p>\n\n<p>Seems like this might be an issue where I need to refresh the DataContext of the details view?  </p>\n"},{"tags":["c#","wpf","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":318,"score":0,"question_id":10257724,"title":"WPF DataGrid - how to set the column headers to have vertical text?","body":"<p>Well, actually rotated -90 degrees from horizontal is what I mean. I need to do this because the text for the header is quite long but the cell value is short, and I want to fit a lot of columns on the screen. Is it possible to do this easily or do I need to learn about resources and templates first? I don't mind a \"hack\" solution!</p>\n"},{"tags":["c#","wpf","datetime","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12937164,"title":"Dynamic Data Display Scattered DateTime Axis","body":"<p>I am trying to chart candlestick markers for a chart of stock prices. I have a marker for every minute of a trading day - 9:30 AM to 4:00 PM. I don't want to display empty space for 4:01 PM to 9:29 AM for each trading day. Is there a way I can remove that time span from my X axis on my graph? I want all the data to look continuous without break in flow. I am using a NumericAxis for my X axis with a TickToDateTimeLabelProvider that I created. Is there a way to change the LabelProvider to fit my needs? Or does it stretch deeper than that? </p>\n\n<p>Here is my code for the LabelProvider:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Microsoft.Research.DynamicDataDisplay.Charts {\npublic class TickToDateTimeLabelProvider : NumericLabelProviderBase {\n    public override UIElement[] CreateLabels(ITicksInfo&lt;double&gt; ticksInfo) {\n        var res = new TextBlock[ticksInfo.Ticks.Length];\n        for (int i = 0; i &lt; ticksInfo.Ticks.Length; ++i) {\n            long l = (long)ticksInfo.Ticks[i];\n            if (l &lt; 0)\n                l = 0;\n            DateTime dt = new DateTime(l);\n            res[i] = new TextBlock();\n            res[i].Text = dt.ToString();\n        }\n        return res;\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13278159,"title":"What is more efficient, a datatable or a custom object?","body":"<p>Normally, when working with data from a database with a forms application, I keep it in a dataset or datatable and pull data out as needed. Now, I am working with WPF and trying to conform more to the MVVM pattern. Converting these datatables to objects make it a little easier to use with MVVM.</p>\n\n<p>For example, if I had a table filled by a query like so -\n<strong>Select p.first_name, p.last_name, p.phone,p.email from person as p where p.first_name = 'Bob'</strong>\nInstead of keeping the datatable, I would just now convert that into a person object.</p>\n\n<p>From a performance standpoint, is there and downfall to making objects or should I stick with datasets and datatables?</p>\n"},{"tags":["wpf","data-binding","mvvm","grid"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1009,"score":3,"question_id":6995844,"title":"WPF Grid as ItemsPanel for a list dynamically bound to an ItemsControl","body":"<p>I am using a Grid as ItemsPanel for a list dynamically bound to an ItemsControl. The code below is working - with a remaining problem: I can’t find a way to dynamically initialize the ColumnDefinitions and RowDefinitions of the grid. As consequence all values are placed on top of each other.</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding Cells}\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;Grid/&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n    &lt;ItemsControl.ItemContainerStyle&gt;\n        &lt;Style&gt;\n            &lt;Setter Property=\"Grid.Row\" Value=\"{Binding RowIndex}\"/&gt;\n            &lt;Setter Property=\"Grid.Column\" Value=\"{Binding ColumnIndex}\"/&gt;\n        &lt;/Style&gt;\n    &lt;/ItemsControl.ItemContainerStyle&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;TextBlock Text=\"{Binding Value}\" /&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>Please be aware, that I am searching an answer according the MVVM pattern. Therefore sub classing and code behind are just workarounds, but no solutions.</p>\n"},{"tags":["wpf","virtualization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13277500,"title":"Databinding where the data is of type UIElement","body":"<p>I have a DataGrid bound to a collection view model. The element view model has a property called UI of type UIElement. The scenario is that I want the generated UIElement to be bound.</p>\n\n<p>So for example (imaginary toy example), say the UIElement is a TextBlock with a text Foo, then I want the DataGrid to have rows of TextBlock's with the text Foo.</p>\n\n<p>The reason why I want this is not important here.</p>\n\n<p>So how might one databind to a property of type UIElement where the UIElement is injected as the databound content?</p>\n"},{"tags":[".net","wpf","parsing","xaml","converter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274250,"title":"WPF - Strange XAML parsing error on XP...typeConverter? - Cannot convert string '0' in attribute 'Row'","body":"<p>Have a client running XP.  They have a little bit of \"weirdness\" going on with a very simple XAML control once it's instantiated.</p>\n\n<p>NO issues on non-XP machines.  Sporadic issues on a specific customer machines.</p>\n\n<p>Unable to reproduce locally.  Anyone experience this?  It seems like the default type converter is failing for the attached property...but I'm assuming it's a side effect to something else.</p>\n\n<p>ERROR:\n\"Cannot convert string '0' in attribute 'Row' to object of type 'System.Int32'.  0 is not a valid value for Int32\"</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n      &lt;RowDefinition Height=\"Auto\"/&gt;\n      &lt;RowDefinition Height=\"Auto\"/&gt;\n      &lt;RowDefinition Height=\"*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n      &lt;ColumnDefinition Width=\"*\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n    &lt;Menu Grid.Row=\"0\" Grid.Column=\"0\"&gt;\n       :\n       :\n    &lt;/Menu&gt;\n&lt;/Grid&gt;\n</code></pre>\n"},{"tags":["wpf","xaml","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13274875,"title":"WPF/Xaml Datagrid wont fire ValidatesOnDataErros when binding is in DataGridTextColumn","body":"<p>I have a datagrid that is bound to an observable collection from my viewmodel.  This all works fine and displays my data in the datagrid.</p>\n\n<p>What i need to do now is validate some columns when the user chnages the text.  I am using the IDataErrorInfo to do this.</p>\n\n<p>If i do the following:-</p>\n\n<pre><code>**&lt;TextBox \n     Width=\"100\" \n     Text=\"{Binding Path=CallCode,\n     Mode=TwoWay,\n     ValidatesOnDataErrors=True,\n     UpdateSourceTrigger=PropertyChanged }\"/&gt;**\n</code></pre>\n\n<p>This works and triggers the validation code in my viewmodel, however if i add this code to the datagrid as below it doesnt do anything!:-</p>\n\n<pre><code>&lt;Border x:Name=\"body\"                    \n        DockPanel.Dock=\"Top\"   \n        Grid.Row=\"2\" \n        Grid.Column=\"0\"&gt;\n\n        &lt;!-- Results --&gt;\n        &lt;DataGrid x:Name=\"Results\"                            \n            ItemsSource=\"{Binding CallCodesList}\"\n            AutoGenerateColumns=\"False\"\n            ScrollViewer.CanContentScroll=\"True\"\n            ScrollViewer.VerticalScrollBarVisibility=\"Auto\"\n            CanUserAddRows=\"False\"&gt;\n\n            &lt;DataGrid.Columns &gt;\n\n            **&lt;DataGridTextColumn                                                     \n                     Header=\"Call Code\" \n                     CanUserSort=\"True\" \n                     Width=\"100\" \n                     Binding=\"{Binding CallCode, \n                     ValidatesOnDataErrors=True,  \n                     UpdateSourceTrigger=PropertyChanged /&gt;**\n\n                 &lt;DataGridCheckBoxColumn Width=\"70\"\n                        Binding=\"{Binding Path=HasSpeech}\"\n                        Header=\"Speech\"\n                        IsThreeState=\"True\"&gt;\n                    &lt;DataGridCheckBoxColumn.ElementStyle&gt;\n                        &lt;Style TargetType=\"CheckBox\"&gt;\n                            &lt;Setter Property=\"IsChecked\" Value=\"{Binding HasSpeech}\" /&gt;\n                        &lt;/Style&gt;\n                    &lt;/DataGridCheckBoxColumn.ElementStyle&gt;\n                &lt;/DataGridCheckBoxColumn&gt;          \n        &lt;/DataGrid&gt;\n    &lt;/Border&gt;\n</code></pre>\n\n<p>Is there someting i am missing or can it not see something because it is in a datagrid, this is all new so currently stuck :(</p>\n\n<p>Any help with this would be great.</p>\n"},{"tags":["wpf","entity-framework","data-binding","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13277327,"title":"How to bind entities from Entity Framework to DataGrid?","body":"<p>My XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"Newsletter.UI.MessagesWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MessagesWindow\" Name=\"messagesWindow\" Height=\"576\" Width=\"1024\" WindowStartupLocation=\"CenterScreen\" Closed=\"MessagesWindowClosed\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;Style TargetType=\"{x:Type Button}\"&gt;\n            &lt;Setter Property=\"Width\" Value=\"149\"/&gt;\n            &lt;Setter Property=\"Margin\" Value=\"10\"/&gt;\n        &lt;/Style&gt;\n    &lt;/Window.Resources&gt;\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"75\"/&gt;\n            &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;StackPanel Grid.Row=\"0\"  Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Grid&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition Height=\"*\"/&gt;\n                    &lt;RowDefinition Height=\"*\"/&gt;\n                &lt;/Grid.RowDefinitions&gt;\n                &lt;Button Name=\"saveButton\" Grid.Row=\"0\" Content=\"Save\"  Margin=\"10,10,10,5\"/&gt;\n                &lt;TextBox Name=\"searchTextBox\" Grid.Row=\"1\"  Margin=\"10,5,10,10\"/&gt;\n            &lt;/Grid&gt;\n            &lt;Button Name=\"recipientsButton\" Content=\"RECIPIENTS\" Click=\"RecipientsButtonClick\" /&gt;\n            &lt;Button Name=\"createButton\" Content=\"CREATE\" Click=\"CreateButtonClick\" /&gt;\n            &lt;Button Name=\"removeButton\" Content=\"REMOVE\" /&gt;\n            &lt;Button Name=\"editButton\" Content=\"EDIT\" /&gt;\n            &lt;Button Name=\"resendButton\" Content=\"RESEND\"/&gt;\n        &lt;/StackPanel&gt;\n        &lt;DataGrid Name=\"gridMessages\" Grid.Row=\"1\"/&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>My .cs code:</p>\n\n<pre><code>private void messagesWindow_Loaded(object sender, RoutedEventArgs e)\n        {\n            using (NewsletterEntities context = new NewsletterEntities())\n            {\n                var query = from m in context.Messages select m;\n                var result = query.ToList();\n                gridMessages.DataContext = result;\n            }\n        }\n</code></pre>\n\n<p><code>Message</code> class generated by EF:</p>\n\n<pre><code>[EdmEntityTypeAttribute(NamespaceName=\"NewsletterModel\", Name=\"Message\")]\n[Serializable()]\n[DataContractAttribute(IsReference=true)]\npublic partial class Message : EntityObject\n{\n    #region Factory Method\n\n/// &lt;summary&gt;\n/// Create a new Message object.\n/// &lt;/summary&gt;\n/// &lt;param name=\"messageID\"&gt;Initial value of the MessageID property.&lt;/param&gt;\n/// &lt;param name=\"subject\"&gt;Initial value of the Subject property.&lt;/param&gt;\n/// &lt;param name=\"content\"&gt;Initial value of the Content property.&lt;/param&gt;\n/// &lt;param name=\"hasAttachments\"&gt;Initial value of the HasAttachments property.&lt;/param&gt;\n/// &lt;param name=\"senderID\"&gt;Initial value of the SenderID property.&lt;/param&gt;\n/// &lt;param name=\"date\"&gt;Initial value of the Date property.&lt;/param&gt;\npublic static Message CreateMessage(global::System.Int32 messageID, global::System.String subject, global::System.String content, global::System.Boolean hasAttachments, global::System.Int32 senderID, global::System.DateTime date)\n{\n    Message message = new Message();\n    message.MessageID = messageID;\n    message.Subject = subject;\n    message.Content = content;\n    message.HasAttachments = hasAttachments;\n    message.SenderID = senderID;\n    message.Date = date;\n    return message;\n}\n\n#endregion\n\n#region Primitive Properties\n\n/// &lt;summary&gt;\n/// No Metadata Documentation available.\n/// &lt;/summary&gt;\n[EdmScalarPropertyAttribute(EntityKeyProperty=true, IsNullable=false)]\n[DataMemberAttribute()]\npublic global::System.Int32 MessageID\n{\n    get\n    {\n        return _MessageID;\n    }\n    set\n    {\n        if (_MessageID != value)\n        {\n            OnMessageIDChanging(value);\n            ReportPropertyChanging(\"MessageID\");\n            _MessageID = StructuralObject.SetValidValue(value);\n            ReportPropertyChanged(\"MessageID\");\n            OnMessageIDChanged();\n        }\n    }\n}\nprivate global::System.Int32 _MessageID;\npartial void OnMessageIDChanging(global::System.Int32 value);\npartial void OnMessageIDChanged()\n</code></pre>\n\n<p>Unfortunately nothing happens, the DataGrid is empty.\nI'm new to data binding in WPF and EF. I hope this problem is simple but I have no idea how to solve it.</p>\n"},{"tags":["c#","wpf","progress-bar"],"answer_count":3,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":9972,"score":9,"question_id":1194620,"title":"How do I display progress during a busy loop?","body":"<p>I'm working in C# and WPF, very new to both. </p>\n\n<p>I have a loop that reads plenty of data from an external source. The process takes about 20 seconds, and I want to show the progress to the user. I don't need any fancy progress bars, so I chose to plot my progress in a label that will say \"Step 1/1000\", then change to \"Step 2/1000\" etc.</p>\n\n<p>My code looks something like this:</p>\n\n<pre><code>// \"count\" is the number of steps in the loop, \n// I receive it in previous code\n\nString countLabel = \"/\"+count.ToString();\n\nfor (i = 0; i &lt; count; i++)\n{\n    ... do analysis ...\n    labelProgress.Content = \"Step \"+i.ToString()+countLabel\n}\n</code></pre>\n\n<p>However, during that analysis the screen is \"stuck\" and the progress does not show as advancing. I understand this behavior from my past in C++, where I would probably have a separate thread showing a progress bar receiving notifications from the loop, or some form of repaint/refresh, or forcing the window/app to process its message queue.</p>\n\n<p>What's the right way to do it in C#? I'm not tied to the label, so if there's a simple progress-bar popup screen I could use instead of this label it would also be great...</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","data-binding","memory-leaks"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13275183,"title":"Memory leak caused by ItemsControl's items not released","body":"<p>I am facing a pretty annoying problem on my WPF/MVVM application:\nBasically, I have an <code>ItemsControl</code> object with a variable <code>ItemsSource</code>. \nThe source is an <code>IList&lt;DateTime&gt;</code>, and the result will be an <code>ItemsControl</code> creating one chart for each date in the source.</p>\n\n<p>This simple case creates a big problem in my application: the one we all fear about, the one we all make nightmares about: <strong>the unfamous Memory Leak :-(</strong></p>\n\n<p>The scenario here is VERY basic: Let's assume my <code>ItemsSource</code> has two items. The <code>ItemsControl</code> will create two charts accordingly. Now, the <code>ItemsSource</code> is changed to <code>null</code> => <code>ItemsControl</code> is cleared, and a new <code>ItemsSource</code> is initialized with, say 3 components. The <code>ItemsControl</code> will create 3 charts.\nThe problem? The 2 previous charts still exist in memory! So when I changed a databound property for a chart (for example the scale), it will update the 5 charts, including the two which were supposed to be cleared.</p>\n\n<p>So what basically happens is... if one of my clients uses the application for two hours, and updates this control many times, the app will end up updating stuff for 500 different charts => it gets extremely long</p>\n\n<p>I read a lot about memory leaks caused by DataBinding and tried to avoid it as much as possible. Thus, all of the databound properties implement <code>INotifyPropertyChanged</code> as advised by <a href=\"http://support.microsoft.com/kb/938416\" rel=\"nofollow\">this kb article</a></p>\n\n<p>Here is the guilty code:</p>\n\n<p><strong>The control's XAML code:</strong></p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\"&gt;\n        &lt;ItemsControl x:Name=\"graphContainer\"&gt;\n            &lt;ItemsControl.Resources&gt;\n                &lt;conv:MaturityToDateTimeConverter x:Key=\"MaturityToDateTimeConverter\" /&gt;\n                &lt;conv:ImpliedForwardsOnMaturityConverter x:Key=\"ImpliedForwardsOnMaturityConverter\" /&gt;\n            &lt;/ItemsControl.Resources&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;WrapPanel Background=\"#808080\" Width=\"{Binding (FrameworkElement.ActualWidth),\n                                    RelativeSource={RelativeSource \n                                    AncestorType={x:Type ItemsControl}}}\"\n                        Margin=\"4\" /&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border BorderBrush=\"Black\" Background=\"#333333\" BorderThickness=\"1\"&gt;\n                        &lt;controls:VolatilityGraph Margin=\"3\"\n                                                  GraphForeground=\"White\"\n                        Height=\"310\" Width=\"395\" \n                        GraphicType=\"Smile\"\n                        ShowAllData=\"{Binding DataContext.DataModel.ShowAllData, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n\n                        ShowDifferenceGraph=\"{Binding DataContext.DataModel.ShowDifference, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        IsModulable=\"False\"\n                        VolatilityMatrices=\"{Binding DataContext.DataModel.VolatilityMatrices, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        StartingPoint=\"{Binding Converter={StaticResource MaturityToDateTimeConverter}}\"\n                        ShowStartingPointOnly=\"True\"\n                        DisplayedGraphs=\"{Binding DataContext.DataModel.DisplayedGraphs, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        ColorsDictionary=\"{Binding DataContext.DataModel.ColorsDictionary, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        BackgroundGraphsColor=\"{Binding DataContext.DataModel.BackgroundGraphsColor, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        LZGraphsColor=\"{Binding DataContext.DataModel.LZGraphsColor, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        CurrentStock=\"{Binding DataContext.DataModel.CurrentStock, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        XMin=\"{Binding DataContext.DataModel.MinStrike, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        XMax=\"{Binding DataContext.DataModel.MaxStrike, UpdateSourceTrigger=PropertyChanged,\n                                            RelativeSource={RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}}\"\n                        MouseWheelZoomEnabled=\"True\"\n                        MouseDragZoomEnabled=\"True\"\n                        MoveablePointEnabled=\"False\"\n                        &gt;\n                            &lt;controls:VolatilityGraph.Forward&gt;\n                                &lt;MultiBinding Converter=\"{StaticResource ImpliedForwardsOnMaturityConverter}\"&gt;\n                                    &lt;Binding Path=\"DataContext.DataModel.ImpliedForwards\" UpdateSourceTrigger=\"PropertyChanged\"\n                                             RelativeSource=\"{RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}\" /&gt;\n                                    &lt;Binding Path=\".\" /&gt;\n                                    &lt;Binding Path=\"Maturities\" RelativeSource=\"{RelativeSource FindAncestor, \n                                                        AncestorType={x:Type controls:VolatilityCharts}}\" /&gt;\n                                &lt;/MultiBinding&gt;\n                            &lt;/controls:VolatilityGraph.Forward&gt;\n                        &lt;/controls:VolatilityGraph&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n\n\n    &lt;/ScrollViewer&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p><strong>The control's code behind:</strong></p>\n\n<pre><code>public partial class VolatilityCharts : UserControl\n    {\n        #region Dependency Properties\n\n        #region Maturities\n\n        /// &lt;summary&gt;\n        /// Maturities list\n        /// &lt;/summary&gt;\n        public static readonly DependencyProperty MaturitiesProperty =\n            DependencyProperty.Register(\"Maturities\",\n                                        typeof(IEnumerable),\n                                        typeof(VolatilityCharts),\n                                        new PropertyMetadata(MaturitiesChanged));\n\n        /// &lt;summary&gt;\n        /// Maturities\n        /// &lt;/summary&gt;\n        /// &lt;value&gt;The Maturities.&lt;/value&gt;\n        public IEnumerable Maturities\n        {\n            get { return (IEnumerable)GetValue(MaturitiesProperty); }\n            set { SetValue(MaturitiesProperty, value); }\n        }\n\n        /// &lt;summary&gt;\n        /// Handler called when the binding on Maturities changed\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"source\"&gt;&lt;/param&gt;\n        /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n        private static void MaturitiesChanged(DependencyObject source, DependencyPropertyChangedEventArgs e)\n        {\n            VolatilityCharts @this = source as VolatilityCharts;\n            @this.LoadCharts();\n        }\n\n        #endregion\n\n        #endregion\n\n        #region Properties\n\n        /// &lt;summary&gt;\n        /// Shortcut to UnderlyingsDataService\n        /// &lt;/summary&gt;\n        public IVolatilityChartsModel DataModel\n        {\n            get;\n            set;\n        }\n\n        #endregion\n\n        #region ctor\n        /// &lt;summary&gt;\n        /// Create a new instance of VolatilityCharts class\n        /// &lt;/summary&gt;\n        public VolatilityCharts()\n        {\n            this.DataContext = this;\n            InitializeComponent();\n        }\n\n        #endregion\n\n        #region charts of smile\n\n        /// &lt;summary&gt;\n        /// Loads the charts.\n        /// &lt;/summary&gt;\n        internal void LoadCharts()\n        {\n            graphContainer.ItemsSource = this.Maturities;\n        }\n        #endregion\n    }\n</code></pre>\n\n<p><strong>And the code generating the control:</strong> <em>(note: this code is called ONLY ONCE, on application startup. I therefore have only one created instance of <code>VolatilityCharts</code> during the program lifetime)</em></p>\n\n<pre><code>    private static VolatilityCharts GenerateAllCharts()\n    {\n        VolatilityCharts charts = new VolatilityCharts();\n        AllChartsViewModel allChartsViewModel = new AllChartsViewModel(DataModel);\n        charts.DataContext = allChartsViewModel;\n        //// Binding maturities\n        Binding maturitiesBinding = new Binding(\"DataModel.ModelMaturities\");\n        maturitiesBinding.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;\n        maturitiesBinding.Mode = BindingMode.OneWay;\n        maturitiesBinding.IsAsync = true;\n\n        charts.SetBinding(VolatilityCharts.MaturitiesProperty, maturitiesBinding);\n\n        return charts;\n    }\n</code></pre>\n\n<p>Does anybody have any idea on how could I fix this problem?</p>\n\n<p>If you have any question please let me know</p>\n\n<p>Thank you!</p>\n"},{"tags":["wpf","wpf-usercontrols"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":20,"score":1,"question_id":13274956,"title":"wpf custom button best approach","body":"<p>I want to create a custom button inside WPF. Of course, the button will be an UserControl and it will contain many visual elements (like stroke, highlight, shadow, glow, images etc.).</p>\n\n<p>The problem is that if I use DependencyProperties and bind them in XAML I won't be able to see the result at DesignTime (I've tried to implement IsInDesignMode method but for a certain reason that I can't understand my VS just crashes when I use this method on UserControls, otherwise it works just fine) and this is definitely not good. </p>\n\n<p>So I am thinking about not using XAML at all and do all my work in the code behind. </p>\n\n<p>What do you guys think? </p>\n"},{"tags":["wpf","application-shutdown"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":659,"score":2,"question_id":6601875,"title":"Application.Current.Shutdown(-1) not closing WPF app","body":"<p>I am checking if the windows authenticated user is a valid user for my wpf application or not.</p>\n\n<p>If not, I need to shut down the application; but even after executing  Application.Current.Shutdown(-1) the application keeps on executing happily.</p>\n\n<p>The below link says that I need to remove my StartUpURI; but I dont have that tag in my app.xaml. -> <a href=\"http://stackoverflow.com/questions/606043/shutting-down-a-wpf-application-from-app-xaml-cs\">Shutting down a WPF application from App.xaml.cs</a></p>\n\n<p><strong>EDIT :-</strong>\nI have this code in APP.XAML.CS ->   </p>\n\n<pre><code>protected override void OnStartup(StartupEventArgs e)\n        {\n            base.OnStartup(e);\n\n            this.exceptionPolicy = ConfigurationManager.AppSettings.Get(\"ExceptionPolicy\");\n            this.displayErrorDetails = true;\n            this.container = new UnityContainer();\n\n            // Register services and types in Unity\n            RegisterServices();\n\n            // Check user\n            if (!IsValidUser())\n            {\n                //Application.Current.Shutdown(); \n                App.Current.Shutdown();\n            }\n\n        }\n</code></pre>\n"},{"tags":["c#","wpf","data-binding","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13276674,"title":"Get property type of dynamic object in C# (even when value is null)","body":"<p>I have a DynamicObject wrapper that is basically forwarding property values from another private object instance (amongst other things). But is there any way of returning the property-type dynamically as well?</p>\n\n<p>The reasong I'm asking is because I'm having trouble with bindings in WPF trying to convert the view-value (<strong>string</strong> in my case with a textbox bound to a double property) to a presenter value of type <strong>object</strong> instead of <strong>double</strong> (which it would if the object was not dynamic and the property had a returntype of double).</p>\n\n<p>If there where something like TryGetMemberType it would be great...</p>\n"},{"tags":["wpf","datatemplate","controltemplate"],"answer_count":4,"favorite_count":13,"up_vote_count":42,"down_vote_count":0,"view_count":11325,"score":42,"question_id":1340108,"title":"Difference between Control Template and DataTemplate in WPF","body":"<p>What is difference between a ControlTemplate and a DataTemplate in WPF?</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13273577,"title":"ScrollViewer with ItemsControl not working","body":"<pre><code>&lt;ScrollViewer VerticalScrollBarVisibility=\"Visible\"  Height=\"100\"&gt;\n        &lt;ItemsControl Name=\"icReviews\" BorderBrush=\"Black\" BorderThickness=\"1\" Height=\"300\"&gt;\n            &lt;ItemsControl.Background&gt;\n                &lt;LinearGradientBrush StartPoint=\"0,0\" EndPoint=\"1,1\" &gt;\n                    &lt;GradientStop Offset=\"1\" Color=\"#FFFF9900\" /&gt;\n                    &lt;GradientStop Offset=\"0\" Color=\"#FFDD4400\" /&gt;\n                &lt;/LinearGradientBrush&gt;\n            &lt;/ItemsControl.Background&gt;\n\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;UniformGrid Columns=\"3\" Width=\"1712\" Height=\"300\"&gt;&lt;/UniformGrid&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n\n\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel&gt;\n                        &lt;Grid&gt;\n                            &lt;Grid.RowDefinitions&gt;\n                                &lt;RowDefinition &gt;&lt;/RowDefinition&gt;\n                                &lt;RowDefinition&gt;&lt;/RowDefinition&gt;\n                            &lt;/Grid.RowDefinitions&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n                                &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;StackPanel Grid.Row=\"0\" Grid.Column=\"1\" TextElement.FontFamily=\"FangSong\" TextElement.FontSize=\"15\"  TextElement.FontWeight=\"Bold\" TextElement.Foreground=\"Blue\"&gt;\n                                &lt;TextBlock Text=\"{Binding Path=Subject}\" Foreground=\"White\" TextElement.FontSize=\"15\" TextElement.FontFamily=\"FangSong\" TextWrapping=\"Wrap\" Margin=\"5,5\"&gt;&lt;/TextBlock&gt;\n                                &lt;TextBlock Text=\"{Binding Path=Review}\" Foreground=\"White\" TextElement.FontSize=\"15\" TextElement.FontFamily=\"FangSong\" TextWrapping=\"Wrap\" Margin=\"5,5\"&gt;&lt;/TextBlock&gt;\n                                &lt;WrapPanel&gt;\n                                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                        &lt;TextBlock Text=\"Posted by : \" Foreground=\"White\" Margin=\"5,5\" TextElement.FontSize=\"15\"&gt;&lt;/TextBlock&gt;\n                                        &lt;TextBlock Text=\"{Binding Path=Username}\" Foreground=\"White\" TextElement.FontSize=\"15\" TextElement.FontFamily=\"FangSong\" Margin=\"5,5\"&gt;&lt;/TextBlock&gt;\n                                    &lt;/StackPanel&gt;\n                                &lt;/WrapPanel&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/Grid&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n\n        &lt;/ItemsControl&gt;\n    &lt;/ScrollViewer&gt;\n</code></pre>\n\n<p>I have now edited my code with the height attribute of scrollviewer. I still cant see any scrollbars</p>\n"},{"tags":[".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13274105,"title":"Multiple dispatcher threads in WPF, but will only render when first thread is unblocked?","body":"<p>I have a plugin to my application, which does an awful lot on the GUI thread.  We want to isolate the work of the host and the plugin.  We've done this successfully by starting a new thread for the plugin, and starting a dispatcher there.</p>\n\n<p>However, when the main thread blocks, the plugin never redraws.  Is there any way around this?  My suspicion is this is something to do with the WPF render thread?  </p>\n"},{"tags":["wpf","datagrid","binding","freeze","ilist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":240,"score":0,"question_id":6562033,"title":"How bind IList with many items to Datagrid without freezing","body":"<p>Hi I parse txt file to List and then I want bind this collection to WPF datagrid control.</p>\n\n<p>Txt file contain 18 000  - 19 000 rows. Here is sample of this txt file.</p>\n\n<pre><code>910839320   Hovory vo VPS   24.05.2011 08:52    0910839253  VPS     STÁLA   00:01:03            0,0488  \n910839320   Hovory vo VPS   26.05.2011 10:01    0910839267  VPS     STÁLA   00:01:00            0,0465  \n910839320   Hovory vo VPS   26.05.2011 10:04    0910839263  VPS     STÁLA   00:00:19            0,0147\n</code></pre>\n\n<p>I parse text file to IList with this function.</p>\n\n<pre><code>    public class Call\n    {\n        public string Number { get; set; }\n        public string CallType { get; set; }\n        public string Dt { get; set; }\n        public string CallingNumber { get; set; }\n        public string VoiceNetwork { get; set; }\n        public string Type { get; set; }\n        public string TalkTime { get; set; }\n        public string Price { get; set; }\n    }\n\n    private static IEnumerable&lt;Call&gt; Parse(string path)\n    {\n        var calls = new List&lt;Call&gt;();\n\n        string[] lines = System.IO.File.ReadAllLines(path);\n\n        for (int i = 0; i &lt; lines.Length; i++)\n        {\n            string[] line = lines[i].Split('\\t');\n\n            var call = new Call\n                           {\n                               Number = line[0],\n                               CallType = line[1],\n                               Dt = line[2],\n                               CallingNumber = line[3],\n                               VoiceNetwork = line[4],\n                               Type = line[6],\n                               TalkTime = line[7],\n                               Price = line[10]\n                           };\n            calls.Add(call);\n        }\n\n        return calls;\n    }\n</code></pre>\n\n<p>Parsing is OK.</p>\n\n<p>Problem is if I try bind output of mehod Parse to datagrid control. WPF always freeze.</p>\n\n<p>I use WPF, .NET 4 and Caliburn Micro as MVVM framework.</p>\n\n<p>Here is problem code:</p>\n\n<p>XAML:</p>\n\n<pre><code>        &lt;StackPanel Orientation=\"Vertical\" Grid.Column=\"1\"&gt;\n            &lt;DataGrid Name=\"Calls\"/&gt;\n        &lt;/StackPanel&gt;\n</code></pre>\n\n<p>ViewModel:</p>\n\n<pre><code>        public IList&lt;Call&gt; Calls\n        {\n            get { return _class; }\n            set\n            {\n                _class = value;\n                NotifyOfPropertyChange(()=&gt;Calls);\n            }\n        }\n\n        public void OpenTsv()\n        {\n            Task.Factory.StartNew(() =&gt;\n            {\n                var dlg = new Microsoft.Win32.OpenFileDialog \n{ DefaultExt = \".tsv\", Filter = \"Tsv documents (.tsv)|*.tsv\" };\n\n                bool? result = dlg.ShowDialog();\n\n                IList&lt;Call&gt; calls = new List&lt;Call&gt;();\n\n                if (result == true)\n                {\n                    Path = dlg.FileName;\n                    calls = TsvParser.Parse(Path);\n                }\n\n                Execute.OnUIThread((System.Action)(() =&gt;\n                { Calls = calls; }));\n            });\n\n        }\n</code></pre>\n\n<p>How to bind property Calls from ViewModel to DataGrid control without freezing?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":42,"score":5,"question_id":13276003,"title":"Thumbs on line corner points do not relocate points","body":"<p>I am developing a drawing application in which one can draw various types of lines. On the line corner points I have placed a thumb using an itemsControl. The thumbs should move that corner point when the user left mouse clicks on it and drags the mouse. What's happening now is that when I do this the point and thumb move a little bit, but then it loses mouse capture right away and doesn't move anymore. When I debug the first dragdelta event that gets fired correctly has a full visual tree traced up from the sending thumb to the itemscontrol and beyond, but sometimes when it fires the next time, the thumb's location has not been updated, and the containing content presenter has null parents in the visual tree. </p>\n\n<p>This is the portion of the xaml related to the line thumb points:</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"PART_LineRelocate\" ItemsSource=\"{Binding pointsObservableCollection}\"  Visibility=\"Collapsed\" &gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate DataType=\"{x:Type s:LineCornerPoint}\" &gt;\n           &lt;Grid&gt;\n              &lt;c:PointRelocateThumb VerticalAlignment=\"Center\" HorizontalAlignment=\"Center\" Focusable=\"True\"  x:Name=\"PART_PointRelocateThumb\" Cursor=\"Hand\"/&gt;\n           &lt;/Grid&gt;\n        &lt;/DataTemplate&gt;\n     &lt;/ItemsControl.ItemTemplate&gt;\n     &lt;ItemsControl.ItemsPanel&gt;\n         &lt;ItemsPanelTemplate&gt;\n            &lt;Canvas IsItemsHost=\"True\" /&gt;\n         &lt;/ItemsPanelTemplate&gt;\n     &lt;/ItemsControl.ItemsPanel&gt;\n     &lt;ItemsControl.ItemContainerStyle &gt;\n         &lt;Style &gt; \n            &lt;Style.Triggers&gt;\n                  &lt;DataTrigger Value=\"BrokenLinkLine\" Binding=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type s:ToolLine}}, Path=indicator}\" &gt;\n                      &lt;Setter  Property=\"Canvas.Left\" Value=\"{Binding Corner.X}\" /&gt;\n                      &lt;Setter Property=\"Canvas.Top\" Value=\"{Binding Corner.Y}\"   /&gt;\n                  &lt;/DataTrigger&gt;\n\n                     ....More of these datatriggers for the different types of lines\n              &lt;/Style.Triggers&gt;\n         &lt;/Style&gt;\n   &lt;/ItemsControl.ItemContainerStyle&gt;\n</code></pre>\n\n<p></p>\n\n<p>The code for PointRelocateThumb:</p>\n\n<pre><code> public PointRelocateThumb()\n    {\n\n        base.DragDelta += new DragDeltaEventHandler(this.PointRelocateThumb_DragDelta);\n\n    }\n    void PointRelocateThumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e)\n    {\n        PointRelocateThumb prt = (PointRelocateThumb)sender;\n        LineCornerPoint lcp = (LineCornerPoint)prt.DataContext;\n        Point thumbPoint = new Point(Canvas.GetLeft((ContentPresenter)prt.TemplatedParent), Canvas.GetTop((ContentPresenter)prt.TemplatedParent));\n        ToolLine toolLine = null;\n        DrawingCanvas designer = null;\n        ItemsControl itemsControl = ItemsControl.ItemsControlFromItemContainer(prt.TemplatedParent);\n        if (itemsControl != null)\n            toolLine = itemsControl.DataContext as ToolLine;\n        if (toolLine != null)\n            designer = VisualTreeHelper.GetParent(toolLine) as DrawingCanvas;\n        if (toolLine != null &amp;&amp; designer != null &amp;&amp; toolLine.IsSelected)\n        {\n            thumbPoint = new Point(thumbPoint.X + Canvas.GetLeft(toolLine) + 3.5, thumbPoint.Y + Canvas.GetTop(toolLine) + 3.5);\n\n            toolLine.undoBounding();\n            if (System.String.Compare(toolLine.indicator, \"BrokenLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"LinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"OrthogonalLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"BrokenLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"Line\") == 0\n                || System.String.Compare(toolLine.indicator, \"Polygon\") == 0)\n            {\n                if (toolLine.pathFigure.StartPoint.Equals(thumbPoint))\n                {\n                    toolLine.pathFigure.StartPoint = new Point(modifyingToolLine.pathFigure.StartPoint.X + e.HorizontalChange, modifyingToolLine.pathFigure.StartPoint.Y + e.VerticalChange);                    }\n                else\n                {\n                    foreach (LineSegment ls in toolLine.pathSegmentCollection)\n\n                    {\n                        if (ls.Point.Equals(thumbPoint))\n                        {\n                            ls.Point = new Point(ls.Point.X + e.HorizontalChange, ls.Point.Y + e.VerticalChange);\n                            break;\n                        }\n\n                    }\n                }\n            }\n           toolLine.regenerateBoundingItem();\n        }\n        e.Handled = true;\n    } \n }\n</code></pre>\n\n<p>}</p>\n\n<p>Tooline is the line class. What undo binding does is that it makes it so that toolLine has Canvas.Left and Canvas.Top set to 0, but scales the points so that they are still located at the same point - i.e. by adding the old Canvas.Left and Canvas.Top values of the toolLine to each point in the line.</p>\n\n<p>The code for regenerate Bounding item is below:</p>\n\n<pre><code>public void regenerateBoundingItem()\n{\n     //Following line of code just regenerates the underlying path for the toolLine from the \n     //new pathsegmentCollection and pathFigure start point.  \n    regenerateThisLine();\n    double leftMostPoint = double.MaxValue, topMostPoint = double.MaxValue, bottomMostPoint = double.MinValue, rightMostPoint = double.MinValue;\n    getBoundingPoints(ref leftMostPoint, ref topMostPoint, ref bottomMostPoint, ref rightMostPoint);\n\n     //subtracts leftMost point and topMostPoint from each point in the line\n     scaleLinePoints(leftMostPoint, topMostPoint); \n     Canvas.SetLeft(this, leftMostPoint);\n     Canvas.SetTop(this, topMostPoint);\n     this.Width = rightMostPoint - leftMostPoint;\n     this.Height = bottomMostPoint-topMostPoint;\n      regenerateObservableCollection();\n      regenerateThisLine();\n}\nprivate void regenerateObservableCollection()\n{\n    if (this.pointsObservableCollection == null)\n        this.pointsObservableCollection = new ObservableCollection&lt;LineCornerPoint&gt;();\n    this.pointsObservableCollection.Clear();\n    LineCornerPoint startPt = new LineCornerPoint(new Point(this.pathFigure.StartPoint.X - 3.5, this.pathFigure.StartPoint.Y - 3.5));\n    this.pointsObservableCollection.Add(startPt);\n    if (System.String.Compare(indicator, \"BrokenLine\") == 0\n        || System.String.Compare(indicator, \"BrokenLinkLine\") == 0\n        || System.String.Compare(indicator, \"LinkLine\") == 0\n        || System.String.Compare(indicator, \"Polygon\") == 0\n       || System.String.Compare(indicator, \"Line\") == 0)\n    {\n        foreach (LineSegment ls in pathSegmentCollection)\n        {\n            LineCornerPoint pt = new LineCornerPoint(new Point(ls.Point.X - 3.5, ls.Point.Y - 3.5));\n            this.pointsObservableCollection.Add(pt);\n         }\n     }\n}\n</code></pre>\n\n<p>The template for PointRelocateThumb is an ellipse of width and height 7 - which explains why I have to offset all the thumb locations by 3.5.</p>\n"},{"tags":["wpf","wpf-controls","prism"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13163173,"title":"WPF optimize loading on the UI thread","body":"<p>I am trying to optimize the loading times for my WPF prism application. The loading is basically a loop of using reflection to create instances of UI elements and then adding them to the main window (the shell) in a tab control.</p>\n\n<p>Since we are limited to using a single thread to create all the objects, what would be the optimal way to speed up loading / create a better user experience?</p>\n\n<p>These are the options I have so far:</p>\n\n<ol>\n<li><p>Use lazy loading. Only load the tab when the user first clicks on it. But that would have a 4-5 second delay opening the first time as it gets initialized on demand.</p></li>\n<li><p>Cache all the reflection calls. I actually did that, but it did not speed anything up at all. Most of the time occurs during the rendering of the controls...</p></li>\n<li><p>?</p></li>\n</ol>\n\n<p>Any suggestions would be greatly appreciated for this tricky problem.</p>\n"},{"tags":["c#","wpf","styles"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13275765,"title":"WPF TextBlock Style Underline on Mouse Hover","body":"<p>Simple question. Can the following WPF C# code cut down some weight? I mean, WTF, uh... I mean WPF, come one. Have you every seen CSS? I only want to underline the Text when I hover with the mouse just like a link. Do I really have to add 9 lines for that?</p>\n\n<pre><code>&lt;TextBlock x:Name=\"Cassette_tblPrintLabel\" Text=\"Print Label\" Canvas.Left=\"154\" Canvas.Top=\"215\" Foreground=\"#FF3355FF\" Cursor=\"Hand\" MouseDown=\"Cassette_lblPrintLabel_MouseDown\"&gt;\n    &lt;TextBlock.Style&gt;\n        &lt;Style TargetType=\"TextBlock\"&gt;\n            &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                &lt;Setter Property=\"TextBlock.TextDecoration\" Value=\"Underline\" /&gt;\n            &lt;/Trigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/TextBlock.Style&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["wpf","data-binding","telerik","wpf-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13275314,"title":"Binding RadChartView to stored procedure","body":"<p>Is there anyone here that can help me bind Teleriks <code>RadChartView</code> to a stored procedure? The 'RadCartesianChart' is part of the 'RadChartView'.  The stored procedure returns a zip code with a count. I have the following code, but I can't find in the documentation of how to link it.</p>\n\n<pre><code>public partial class spTotalRevByZip_Result : ComplexObject\n{\n    #region Simple Properties\n\n    /// &lt;summary&gt;\n    /// No Metadata Documentation available.\n    /// &lt;/summary&gt;\n    [EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=true)]\n    [DataMemberAttribute()]\n    public Nullable&lt;global::System.Double&gt; custzip\n    {\n        get\n        {\n            return _custzip;\n        }\n        set\n        {\n            OncustzipChanging(value);\n            ReportPropertyChanging(\"custzip\");\n            _custzip = StructuralObject.SetValidValue(value, \"custzip\");\n            ReportPropertyChanged(\"custzip\");\n            OncustzipChanged();\n        }\n    }\n    private Nullable&lt;global::System.Double&gt; _custzip;\n    partial void OncustzipChanging(Nullable&lt;global::System.Double&gt; value);\n    partial void OncustzipChanged();\n</code></pre>\n\n<p>And it's supposed to go with this.</p>\n\n<pre><code> &lt;telerik:RadCartesianChart HorizontalAlignment=\"Left\" Margin=\"10,94,0,0\" Grid.Row=\"1\" VerticalAlignment=\"Top\" Width=\"723\" Height=\"228\"&gt;\n        &lt;telerik:RadCartesianChart.HorizontalAxis&gt;\n            &lt;telerik:CategoricalAxis/&gt;\n        &lt;/telerik:RadCartesianChart.HorizontalAxis&gt;\n        &lt;telerik:RadCartesianChart.VerticalAxis&gt;\n            &lt;telerik:LinearAxis/&gt;\n        &lt;/telerik:RadCartesianChart.VerticalAxis&gt;\n        &lt;telerik:BarSeries&gt;\n            &lt;telerik:BarSeries.DataPoints&gt;\n                &lt;telerik:CategoricalDataPoint Category=\"{x:Null}\" IsSelected=\"False\" Label=\"10\" Value=\"10\"/&gt;\n                &lt;telerik:CategoricalDataPoint Category=\"{x:Null}\" IsSelected=\"False\" Label=\"20\" Value=\"20\"/&gt;\n                &lt;telerik:CategoricalDataPoint Category=\"{x:Null}\" IsSelected=\"False\" Label=\"30\" Value=\"30\"/&gt;\n            &lt;/telerik:BarSeries.DataPoints&gt;\n        &lt;/telerik:BarSeries&gt;\n    &lt;/telerik:RadCartesianChart&gt;\n</code></pre>\n\n<p>Any help would be greatly appreciated! This is a WPF program.</p>\n"},{"tags":[".net","wpf","binding","menu"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1949,"score":3,"question_id":700681,"title":"WPF - Binding to a Menu Icon","body":"<p>I've got a UserControl that contains a menu.  I need to bind the Menu.Icon to a property of the UserControl but it's not working.</p>\n\n<p>The code starts like this - </p>\n\n<pre><code>        &lt;Border Grid.Row=\"0\"&gt;            \n        &lt;DockPanel&gt;\n            &lt;Image x:Name=\"testImage\" Height=\"16\" Width=\"16\" Source=\"{Binding ElementName=UC,Path=AddImage}\"/&gt;\n            &lt;Menu DockPanel.Dock=\"Left\" Height=\"20\"\n              VerticalAlignment=\"Center\"&gt;\n                &lt;MenuItem Header=\"{Binding ElementName=UC,Path=AddText}\"&gt;\n                    &lt;MenuItem.Icon&gt;\n                        &lt;!--&lt;Image x:Name=\"workswhenin\" Height=\"16\" Width=\"16\" Source=\"pack://application:,,/Kowdox;component/Images/UserIcons/user_add.png\"/&gt;--&gt;\n\n                        &lt;Image x:Name=\"realImage\" Height=\"16\" Width=\"16\"\n                        Source=\"{Binding ElementName=UC,Path=AddImage}\"/&gt;\n                    &lt;/MenuItem.Icon&gt;\n                &lt;/MenuItem&gt;\n</code></pre>\n\n<p>The first Image you see declared (testImage) works perfectly so I'm happy that the binding is correct.  The second Image (commented out and named 'workswhenin') contains the pack URI that I'm passing to the UserControls bound property and that works too but the third one (realImage) doesn't appear at all!  </p>\n\n<p>I can't see ANY reason why it shouldn't work; i know the binding is good and i know that the image's placement in the markup is good so what's going on?</p>\n\n<p>Any help will be greatly appreciated.\nThanks in advance.</p>\n"},{"tags":["c#","wpf","c#-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13275235,"title":"What is the difference between Activator.CreateInstance and a standard constructor?","body":"<p>What is the diffrenece between the two examples below? What is the purpose of <code>Activator</code>, why would I use it?</p>\n\n<p>1.</p>\n\n<pre><code>string objTypeName = \"Foo\";\nFoo foo = (Foo)Activator.CreateInstance(Type.GetType(objTypeName));\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Foo foo = new Foo()\n</code></pre>\n\n<p>I went through below the pages linked below, but didn't get a clear picture.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.activator_methods.aspx\" rel=\"nofollow\">Here</a> , <a href=\"http://stackoverflow.com/questions/7598088/purpose-of-activator-createinstance-with-example\">here</a> and <a href=\"http://msdn.microsoft.com/en-us/library/wccyzw83.aspx\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["c#","wpf","wcf","mvvm","user-roles"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":13206409,"title":"Assigning Roles to Application Users","body":"<p>As in all the Line-Of-Business Applications, an application may have multiple <code>Users</code> with some <code>Roles</code> assigned to them. We have recently shifted to WPF MVVM Architecture and looking for best way to assign role to each logged in user. There are many terms floating over internet like Authentication, RoleManager, LoginService etc, but I am not sure which to work out with.</p>\n\n<p><strong>Here is what we have:</strong></p>\n\n<p>A small business application (With 20 Forms), developed within a single-project. We use <code>MVVM</code> architecture, <code>LINQ-to-SQL</code> as DataAccess and <code>Model</code>, with <code>Repository pattern</code> and <code>Unit Of Work</code>.</p>\n\n<p><strong>What we want:</strong></p>\n\n<p>There are different forms and each form has <em>insert</em>, <em>update</em>, <em>delete</em>, <em>print</em> etc operations. What we want is to restrict a logged in user according to his role - to the task he can perform. i.e for e.g. Admin is free to do \"<em>anything</em>\" with the application, while some other users may not be allowed to view some forms or carry out some operations (viz. update or delete).</p>\n\n<p>So how can we achieve this; what kind of service could be used for carrying out this complete mechanism using MVVM architecture within a Desktop LOB application. A technical term or tutorial link will be helpful.</p>\n\n<p>I hope I am clear and thank you very much in advance.</p>\n\n<p><strong>Edit:</strong>  I went through many forums and articles around, but all of them focuses on ASP.NET. Still cannot find a concrete implementation for assignment of roles within WPF. And the sources on ASP.NET doesn't comply well with WPF.  </p>\n"},{"tags":["wpf","mvvm","checkbox"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13274350,"title":"MVVM WPF databound checkbox won't firing events to the ViewModel for Checked and Unchecked states","body":"<p>I have a databound <code>CheckBox</code> inside a <code>DataGrid</code>, using WPF and MVVM;</p>\n\n<pre><code>&lt;DataGridTemplateColumn Width=\"80\" Header=\"Enabled\"&gt;\n    &lt;DataGridTemplateColumn.CellTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;CheckBox IsChecked=\"{Binding Path=IsEnabled, UpdateSourceTrigger=PropertyChanged,  Mode=TwoWay}\" Name=\"theCheckbox\" HorizontalAlignment=\"Center\"/&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n&lt;/DataGridTemplateColumn&gt;\n</code></pre>\n\n<p>This works fine and the <code>CheckBox</code> is being checked when <code>IsEnabled</code> is set.  <code>IsEnabled</code> is a property in my collection of objects which I have bound to the <code>DataGrid</code>.  What I want to do is to be able to validate if a specific rows <code>CheckBox</code> within the <code>DataGrid</code> should be allowed to be checked when the user selects it and if not remove their check and display a warning message something like \"Row 1 cannot be checked without rows 5 and 9 being checked\".  I found out how to do this using code behind using the <code>Checked</code> and <code>Unchecked</code> properties of the <code>CheckBox</code>, but I am using MVVM and therefore want to handle things in the <code>ViewModel</code> associated with the View the <code>DataGrid</code> and <code>CheckBox</code> are in.  How do I do this?  I need a way of passing the Id field of the <code>DataRow</code> through too in order to identify which row I am working on, for arguments sake lets say the Id field is called <code>BorderId</code>.</p>\n"},{"tags":["wpf","templates","calendar"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5154,"score":1,"question_id":397369,"title":"WPF - how to load control template in a resource dictionary in code for a calendar control.","body":"<p>I have a WPF calendar control and the template for the day has a property called</p>\n\n<p>cal.DayTemplate = </p>\n\n<p>I have created a dictionary file contaning my control template for the day of the calendar</p>\n\n<p>But I am not sure how to load it into the DayTemplate property.</p>\n\n<p>I have added my dictionary to the Application.Resources in App.xaml</p>\n\n<p>the x:Key to my control template is x:Key=\"DayTemplate\"</p>\n\n<p>So I though to load it this would work</p>\n\n<p>cal.DayTemplate = new DataTemplate(\"DayTemplate\");</p>\n\n<p>Malcolm</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":5372,"score":8,"question_id":3837755,"title":"Binding to Self/'this' in XAML","body":"<p>Simple WPF/XAML question. In XAML, how do I reference the Self/this object in a given context? In a very basic app with a main window, one control, and a coded C# property of the window, I want to bind a property of the control to the hand coded property of the window. </p>\n\n<p>In code, this is very easy - in the Window's constructor, I added this:</p>\n\n<pre><code>Binding bind = new Binding();\nbind.Source = this;\nbind.Path = new PropertyPath(\"ButtonWidth\");\nbutton1.SetBinding(WidthProperty, bind);\n</code></pre>\n\n<p>Obviously, I have a property called ButtonWidth, and a control called button1. I can't figure out how to do this in XAML. Various attempts like the following example have not worked:</p>\n\n<pre><code>&lt;Button x:Name=\"button1\" Width=\"{Binding Source=Self Path=ButtonWidth}\"/&gt;\n\n&lt;Button x:Name=\"button1\" Width=\"{Binding RelativeSource={RelativeSource Self} Path=ButtonWidth}\"/&gt; \n</code></pre>\n\n<p>etc</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","collectionviewsource"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13274763,"title":"Correct Way to bind ComboBox to CollectionViewSource","body":"<p>Hey i have a CollectionViewSource Property on my ViewModel.</p>\n\n<p>This ViewModel is bound to a ComboBox this way:</p>\n\n<pre><code>&lt;ComboBox   ItemsSource=\"{Binding Products.View}\" \nSelectedItem=\"{Binding SelectedEntity.Product}\"  \nIsSynchronizedWithCurrentItem=\"True\"/&gt;\n</code></pre>\n\n<p>When binding to an existing SelectedEntity it works fine.</p>\n\n<p>When i try to bind to an <code>SelectedEntity</code>, that dosn't posses a Product i want to display the first Item from the List. Therefore i tried to use <code>Products.View.MoveCurrentToFirst()</code>, but still the first item isn't displayed.</p>\n\n<p>It of course works when i set <code>SelectedEntity.Product = Products.View.CurrentItem.</code></p>\n\n<p>What can i do, to improve my code? This looks somewhat wrong to me...</p>\n"},{"tags":["wpf","url","download","bitmapimage"],"answer_count":3,"favorite_count":31,"up_vote_count":11,"down_vote_count":0,"view_count":2991,"score":11,"question_id":3659574,"title":"Synchronously download an image from URL","body":"<p>I am trying to do  a simple thing but I can't ...</p>\n\n<p>I just want to get a BitmapImage from a internet URL, but my function doesn't seem to work properly, it only return me a small part of the image. I know WebResponse are working async and that's certainly why I have this problem, but how can I do it synchronously ?</p>\n\n<p>Here is my function :</p>\n\n<pre><code>    internal static BitmapImage GetImageFromUrl(string url)\n    {\n        Uri urlUri = new Uri(url);\n        WebRequest webRequest = WebRequest.CreateDefault(urlUri);\n        webRequest.ContentType = \"image/jpeg\";\n        WebResponse webResponse = webRequest.GetResponse();\n\n        BitmapImage image = new BitmapImage();\n        image.BeginInit();\n        image.StreamSource = webResponse.GetResponseStream();\n        image.EndInit();\n\n        return image;\n    }\n</code></pre>\n\n<p>Thank a lot for your help.</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":22,"down_vote_count":1,"view_count":4645,"score":21,"question_id":6089403,"title":"Delete all entities in Entity Framework","body":"<p>I want to delete content of all tables (all entities using Entity Framework 4+).\nHow can this be done?</p>\n\n<p>Thanks, James</p>\n"},{"tags":["c#","wpf","xaml","datagrid","string-formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13272144,"title":"How can i format a string as currency in a data bound DataGrid in WPF C#?","body":"<p>I have some data being shown in a DataGrid.  The data comes from SQL, where a \"money\" type can be null.  When i display this data, all is OK when i format the data in a double column format as currency.  ie:</p>\n\n<p>internal void FillGrid()\n        {</p>\n\n<pre><code>        bD = new DataTable();\n        DataTable dt = EmployerQuery();  //queries the SQL DB\n\n\n        bD.Columns.Add(new DataColumn(\"ID\", typeof(int)));\n        bD.Columns.Add(new DataColumn(\"EmployerName\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"FlatMinAmount\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"DistrictRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"VendorRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"Description\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"EmployeeCount\", typeof(int)));\n\n        foreach (DataRow sqlRow in dt.Rows)\n        {\n            var row = bD.NewRow();\n            row[\"ID\"] = sqlRow[\"ClientID\"];\n            row[\"EmployerName\"] = sqlRow[\"OfficialName\"];\n            row[\"FlatMinAmount\"] = sqlRow[\"FlatMinAmount\"];\n            row[\"DistrictRate\"] = sqlRow[\"DistrictRate\"];\n            row[\"VendorRate\"] = sqlRow[\"VendorRate\"];\n            row[\"Description\"] = sqlRow[\"Description\"];\n            row[\"EmployeeCount\"] = sqlRow[\"EmployeeCount\"];\n\n            bD.Rows.Add(row);\n\n        }    \n</code></pre>\n\n<p></p>\n\n<p>However, I then save the data as a .csv file.  When i read that file back, the values for \"FlatMinAmount\" that were null are not allowed to be inserted into a column type double, so I cannot format the data columns as type double, since many are null.  </p>\n\n<pre><code>&lt;dg:DataGrid Name=\"newGrid\" ItemsSource=\"{Binding ElementName=readGrid, Path=readGrid}\" AutoGenerateColumns=\"False\"\n                 Margin=\"5\" Height=\"175\" Width=\"Auto\" ColumnWidth=\"Auto\"&gt;\n        &lt;dg:DataGrid.Columns&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding ID}\" Header=\"Employer ID\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployerName}\" Header=\"Employer Name\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding FlatMinAmount, StringFormat=C}\" Header=\"FlatMinAmount\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding DistrictRate, StringFormat=C}\" Header=\"District Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding VendorRate, StringFormat=C}\" Header=\"Vendor Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding Description}\" Header=\"Description\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployeeCount}\" Header=\"EmployeeCount\" Width=\"*\" IsReadOnly=\"True\"/&gt;\n        &lt;/dg:DataGrid.Columns&gt;\n    &lt;/dg:DataGrid&gt;\n\n\nDataTable r = new DataTable();\n\n        try\n        {\n            //string csv = string.Empty;\n\n            //r.Columns.Add(\"ID\", typeof(int));\n            //r.Columns.Add(\"EmployerName\", typeof(string));\n            //r.Columns.Add(\"FlatMinAmount\",typeof(double));\n            //r.Columns.Add(\"DistrictRate\", typeof(double));\n            //r.Columns.Add(\"VendorRate\", typeof(double));\n            //r.Columns.Add(\"Description\", typeof(string));\n            //r.Columns.Add(\"EmployeeCount\", typeof(int));\n\n            r.Columns.Add(\"ID\");\n            r.Columns.Add(\"EmployerName\");\n            r.Columns.Add(\"FlatMinAmount\");\n            r.Columns.Add(\"DistrictRate\");\n            r.Columns.Add(\"VendorRate\");\n            r.Columns.Add(\"Description\");\n            r.Columns.Add(\"EmployeeCount\");\n\n            // Read sample data from CSV file\n            using (CsvFileReader reader = new CsvFileReader(filename))\n            {\n                CsvRow row = new CsvRow();\n                while (reader.ReadRow(row))\n                {\n                    //foreach (string s in row)\n                    {\n                        r.Rows.Add(row[0], row[1], row[2], row[3], row[4], row[5], row[6]);\n\n\n                    }\n\n                }\n            }\n</code></pre>\n\n<p>(readGrid is then set to r in code-behind) </p>\n\n<p>If they are string, then i cannot use the StringFormat=C in the binding to show $ etc.  Also, it seems I cannot style a DataGridTextColumn.  So, how can i display the values I read in from .csv as $xx.xx?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":32,"score":-4,"question_id":13273796,"title":"Working Lyrics Service?","body":"<p>I need a Lyrics provider for my media player.\nSearched the web and found alot of samples. None of them work now, either the service is down or service has changed the API :S</p>\n\n<p>Can someone direct me to a working API Service for a lyrics providing app??</p>\n\n<p>According to my knowledge these sites don't supply their services for developers anymore\nLyricsPlugin : Not Working\nLyricWiki : Not Working\nLeosLyrics\nLyrDB(worked sometime back though)</p>\n\n<p>.Net 4, C#, WPF</p>\n\n<p>Thanks in advance.\nHave a nice day! :)</p>\n"},{"tags":["c#",".net","wpf","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13274253,"title":"WPF ,Window AllowTransparency , Poor Performance Fix","body":"<p>Performance for a Windows Presentation Foundation (WPF)-based program may be less than expected. For example, you may experience jittery animation, a low frame rate, or high CPU usage. This problem occurs if the program uses the layered windows feature. This feature is enabled if the value of the Windows.AllowsTransparency property is set to TRUE.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1624,"score":6,"question_id":4809520,"title":"How to allow copying message on MessageBox","body":"<p>How can I allow selecting and copying of text from MessageBox in WPF?</p>\n"},{"tags":["c#","wpf","datacontext","dataitems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2220,"score":1,"question_id":2859978,"title":"Populate datagrid using Datacontext in C# WPF","body":"<p>I'm trying to get data from file. The file first has three lines of text that describes the file, then there is a header for the data below. I've managed to extract that. What I'm having problems is getting the data below the header line. The data below the header line can look like \"1   2   3  4  5   6     7   8   9   abc\". </p>\n\n<pre><code>DataGrid dataGrid1 = new DataGrid();\nmasterGrid.Children.Add(dataGrid1);\n\nusing (TextReader tr = new StreamReader(@filename))\n{\n    int lineCount = 1;\n    while (tr.Peek() &gt;= 0)\n    {\n        string line = tr.ReadLine();\n        {\n            string[] data = line.Trim().Split(' ');\n\n            Dictionary&lt;string, object&gt; sensorData = new Dictionary&lt;string, object&gt;();\n\n            for (int i = 0, j = 0; i &lt; data.Length; i++)\n            {\n                //I know that I'm delimiting the data by a space before.\n                //but the data from the text file doesn't necessarily have\n                //just one space between each piece of data\n                //so if I don't do this, spaces will become part of the data.\n                if (String.Compare(data[i],\" \") &gt; 0)\n                {\n                    sensorData[head[j]] = data[i];\n                    j++;\n                }\n            }\n\n            sensorDatas.Add(sensorData);\n\n            sensorData = null;\n\n        }\n        lineCount++;\n    }\n}\n\ndataGrid1.DataContext = sensorDatas;\n</code></pre>\n\n<p>I can't figure out why this doens't work. If I change \"dataGrid1.DataContext = sensorDatas;\" to \"dataGrid1.ItemsSource = sensorDatas;\" then I get the data in the proper columns, but I also get some Raw View data such as: Comparer, Count, Keys, Values as columns, which I don't want.</p>\n\n<p>Any insight?</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13265535,"title":"Unable to change background for a Wpf toolkit autocompletebox?","body":"<p>How should i change the background of the wpftoolkit autocompletebox.? I tried by subscribing to enabledchanged event and changed the background of the control which is not changing at all.Can any body help.</p>\n"},{"tags":["c#","wpf","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13268597,"title":"Ispost back like functionality in WPF pages","body":"<p>I am building a WPF application which contains a large number of pages. I want to know whether there is any function which is similar to IsPostBack in Asp.Net. I just wanted to know is this the first time the specific page is loading. Thanks in advance.</p>\n"},{"tags":["wpf","combobox","listbox","mousewheel","itemtemplate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13271777,"title":"Disable MouseWheel in editable ComboBox as ItemTemplate","body":"<p>I use a ComboBox as ItemTemplate inside a ListBox. My ComboBox is editable. When the user use the mouse wheel in the combobox, it change the current value. I don't want that. I want the ListBox to scroll. Is there any solution to this ?\nMost examples I found are based only on a readonly ComboBox. \nIt seems that none of the solution I found works.\noverride OnMouseWheel setting isHandled = true does not work\nit seems the event is handled in other places. I tried to override OnMouseWheel in\nthe TextBox used by the ControlTemplate of my ComboBox without success.</p>\n\n<p>any ideas ?</p>\n"},{"tags":["wpf","performance","image","decode","bitmapimage"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13054909,"title":"BitmapImage decoding speed performance wpf","body":"<p>I have 5 images all the same pixel height and pixel width (2481 * 3508 for that matter). But, one is gif, one jpeg, one png and one bmp. Now I render them into a BitmapSource with (1) two thirds of the original pixel height for DecodePixelHeight and (2) original pixel height for DecodePixelHeight. </p>\n\n<p>First scenario: </p>\n\n<pre><code>bitmapImage.BeginInit();\nbitmapImage.CreateOptions = BitmapCreateOptions.IgnoreColorProfile;\nbitmapImage.CacheOption = BitmapCacheOption.OnLoad;\nbitmapImage.DecodePixelHeight = 2/3 * originalHeight;\nbitmapImage.StreamSource = streamWithTheFile;\nbitmapImage.EndInit();\nbitmapImage.Freeze();\n</code></pre>\n\n<p>BMP and Jpeg are equally slow. Png and Gif need less than half the time. Why?</p>\n\n<p>Second scenario:</p>\n\n<pre><code>bitmapImage.BeginInit();\nbitmapImage.CreateOptions = BitmapCreateOptions.IgnoreColorProfile;\nbitmapImage.CacheOption = BitmapCacheOption.OnLoad;\nbitmapImage.StreamSource = streamWithTheFile;\nbitmapImage.EndInit();\nbitmapImage.Freeze();\n</code></pre>\n\n<p>Png half of the time needed before. Jpeg and BMP one 5th of the time needed before. Gif the same time as before.</p>\n\n<p>According to <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.decodepixelheight.aspx\" rel=\"nofollow\">documentation</a> I would have assumed that Png and Jpeg performance would somehow be more independent of actual decode size than the other formats.  What could be the reason, that it is not?</p>\n"},{"tags":["wpf","c#-4.0","wpfdatagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13272881,"title":"Access Parent Container Control By Child Control on Key Binding","body":"<p>I finding a focused Control when a key (<kbd>Ctrl</kbd>+<kbd>E</kbd>) Hit.</p>\n\n<p>For that</p>\n\n<pre><code>var focusedConName = Keyboard.FocusedElement.GetType().Name;\nvar focusedElement = FocusManager.GetFocusedElement(this);\n</code></pre>\n\n<p>this will work but i stuck with something which is annoying </p>\n\n<p>The problem which is faced by this</p>\n\n<ol>\n<li>why can't I typecast focusedElement  to focusedConName  like <code>focusedElement as focusedConName</code>?</li>\n<li>how can I get the <code>ListBox</code> name of <code>ListBoxItem</code> or <code>Datagrid</code> Name of <code>DataCellItem</code>?</li>\n</ol>\n"},{"tags":["c#","wpf","xaml","visual-studio-2012","kinect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13256124,"title":"KinectColorViewer and SDK 1.6","body":"<p>I'm new to Kinect and VS Development, and I was using the <a href=\"http://channel9.msdn.com/Series/KinectQuickstart\" rel=\"nofollow\">Windows Kinect Quickstart Series</a>, but unfortunately, it was meant for Kinect SDK v1.00.</p>\n\n<p>I got stuck on KinectColorView usage, and I'cant proceed (I have been Googlin' for 2 days now). I also found this very similar question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> here on StackOverflow but couldn't solve my problem. I know that I'm close, but i need help.</p>\n\n<p><strong>The problem is: that I can't get my KinectColorViewer to work.</strong></p>\n\n<p>I added it to the XAML designer, but it seems I can't bind it to the SensorManager. \nHere is my XAML code:</p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:WpfViewers=\"clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers\" xmlns:Toolkit=\"clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"KinectSetupDev.MainWindow\"\n    Title=\"MainWindow\" Height=\"768\" Width=\"1024\" Loaded=\"Window_Loaded_1\" Closed=\"Window_Closed_1\"&gt;\n\n    &lt;Grid HorizontalAlignment=\"Left\" Height=\"736\" VerticalAlignment=\"Top\" Width=\"1012\" Margin=\"2,2,0,0\"&gt;\n         &lt;TextBlock x:Name=\"tbMessages\" HorizontalAlignment=\"Left\" Height=\"60\" Margin=\"10,662,0,0\" TextWrapping=\"Wrap\" VerticalAlignment=\"Top\" Width=\"992\"/&gt;\n         &lt;WpfViewers:KinectColorViewer x:Name=\"KinectColorViewer\" KinectSensorManager=\"{Binding KinectSensorManager}\" HorizontalAlignment=\"Left\" Height=\"240\" Margin=\"608,27,0,0\" VerticalAlignment=\"Top\" Width=\"320\" BorderThickness=\"1\" BorderBrush=\"Black\"/&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Nothing to report about the XAML code, except that i had to add the chunk</p>\n\n<pre><code>\"KinectSensorManager=\"{Binding KinectSensorManager}\"\n</code></pre>\n\n<p>in the KinectColorViewer item by writing it, because I couldn't find the way to this by the XAML designer's GUI (so I have some doubts about its viability).</p>\n\n<p>Here is my code-behind (<em>I almost totally copied it by the question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> so I can't understand why it's not working!!</em>)</p>\n\n<pre><code>namespace KinectSetupDev\n{\n  public partial class MainWindow : Window\n  {\n    // Automatically finds a Kinect for you.\n    private readonly KinectSensorChooser sensorChooser = new KinectSensorChooser();\n\n    public KinectSensorManager KinectSensorManager01 { get; private set; }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n\n    }\n\n    private void Window_Loaded_1(object sender, RoutedEventArgs e)\n    {\n        // Initialize the Kinect sensor manager.\n        KinectSensorManager01 = new KinectSensorManager();\n        KinectSensorManager01.KinectSensorChanged += this.KinectSensorChanged;\n\n        // Locate an available sensor.\n        sensorChooser.Start();\n\n        // Bind chooser's sensor value to the local sensor manager.\n        var kinectSensorBinding = new Binding(\"Kinect\") { Source = this.sensorChooser };\n        BindingOperations.SetBinding(this.KinectSensorManager01, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);\n    }\n\n    private void Window_Closed_1(object sender, EventArgs e)\n    {\n        UninitializeKinectServices(KinectSensorManager01.KinectSensor);\n    }\n\n    #region Kinect Discovery &amp; Setup\n\n    private void KinectSensorChanged(object sender, KinectSensorManagerEventArgs&lt;KinectSensor&gt; args)\n    {\n        if (null != args.OldValue)  \n            UninitializeKinectServices(args.OldValue);\n\n        if (null != args.NewValue)\n            InitializeKinectServices(KinectSensorManager01, args.NewValue);\n    }\n\n    // Kinect enabled apps should customize which Kinect services it initializes here.\n    private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)\n    {\n        // Application should enable all streams first.\n        kinectSensorManager.ColorStreamEnabled = true;\n        kinectSensorManager.DepthStreamEnabled = true;\n        kinectSensorManager.SkeletonStreamEnabled = true;\n\n        // Start the sensor!\n        try\n        {\n            sensor.Start();\n            sensorChooser.Kinect.ElevationAngle = 10;\n            tbMessages.Text = \"Kinect Started\";\n        }\n        catch (System.IO.IOException)\n        {\n            sensor = null;\n            tbMessages.Text = \"Kinect Not Started\" + \"\\r\";\n        }\n    }\n\n    // Kinect enabled apps should uninitialize all Kinect services that were initialized in InitializeKinectServices() here.\n    private void UninitializeKinectServices(KinectSensor sensor)\n    {\n        if (sensor != null)\n        {\n\n            if (sensor.IsRunning)\n            {\n                sensorChooser.Kinect.ElevationAngle = 0;\n                sensor.Stop();\n                sensor.AudioSource.Stop();\n\n            }\n        }\n    }\n\n    #endregion Kinect Discovery &amp; Setup\n\n  }\n}\n</code></pre>\n\n<p>I tried to add the line  <code>DataContext = this;</code>  in the contructor, but it does not work.</p>\n\n<p><strong>The application runs, my Kinect starts but the KinectColorViewer does not show anything.</strong></p>\n\n<p><em>Moreover, can anyone tell the difference between</em>  <code>sensor.SkeletonStream.Enable();</code> \n<em>and</em>  <code>kinectSensorManager.SkeletonStreamEnabled = true;</code>  <em>??</em></p>\n"},{"tags":[".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13268345,"title":"Changing the location of a child user control dynamically","body":"<p>I have created an user control which have another user control as child inside it. I have tried moving  the child user control bu issuing the following statement</p>\n\n<p><code>this.versionDisplay.SetValue(Canvas.TopProperty,10.0);</code></p>\n\n<p>But VS2010 is showing an error as follows</p>\n\n<blockquote>\n  <p>Error 23  'MainApp.MainGui.MainControls.MainTitleControl' does not\n  contain a definition for 'versionDisplay' and no extension method\n  'versionDisplay' accepting a first argument of type\n  'MainApp.MainGui.MainControls.MainTitleControl' could be found (are\n  you missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<p>I am sure that name of the child control is versionDisplay.</p>\n\n<p>Code for MainTitleControl</p>\n\n<pre><code>&lt;UserControl x:Class=\"Main.MainGui.MainControls.MainTitleControl\"\n     xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n     xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n     xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n     xmlns:wcontrols=\"clr-namespace:WEPA.MainGui.MainControls\"\n     Height=\"80\" Width=\"395\" Loaded=\"UserControl_Loaded\" &gt;\n\n     &lt;Grid Background=\"Transparent\"  &gt;\n         &lt;Image  HorizontalAlignment=\"Left\"  Name=\"image1\" Stretch=\"Fill\" VerticalAlignment=\"Top\"  Width=\"635\" Height=\"120\" Source=\"/MainApplication;component/images/UnCategorized/Wireless.png\" Margin=\"12,0,0,0\" / &gt;\n         &lt;wcontrols:supportInfoControl Name=\"versionDisplay\" Height=\"20\" Canvas.Left=\"185\" Canvas.Top=\"70\" Margin=\"200,95,-114,-35\" /&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Please advice.</p>\n"},{"tags":["wpf","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13198375,"title":"MVVM two Viewmodel in single xaml file","body":"<p>i am using one xaml file which contains two Panels(left panel, right panel). which means two views.\nI am also using two ViewModel to each views. \nHow to bind DataContext to this situation?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13268487,"title":"WPF windows switching","body":"<p>My wpf app have two windows. One is used for playing musics, one for doing some other things. \nI switch from windows 1 to windows 2 using code below: </p>\n\n<pre><code>Window2 window2 = new Window2 ();\nApp.Current.MainWindow = window2 ;\nwindow2 .Show();\nthis.Close();\n</code></pre>\n\n<p>The problem is window2 is showed but window1 is still running(music still playing) althought window1 was disappeared (I hear the musics's sound)</p>\n\n<p>How can i stop all window1's  business before swtiching to window2?</p>\n"},{"tags":["wpf","control","measure"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13272669,"title":"WPF Specify controls' length in millimeters","body":"<p>These days I am working on a complex WPF application. So far it has been a good experience. But I am stuck on a point. Its a designer application and users drag custom controls on a canvas and set their properties. Currently users can specify the control's length in cm, in, px and pt. I need to give them the option of specifying control's length in millimeters.</p>\n\n<p>I know of LengthConverter class in WPF but it does not give us the facility to use millimeters as unit. Why is that? Why would Microsoft not give the possibility of specifying lengths of controls in mm?</p>\n\n<p>What are the workarounds to do so?</p>\n"},{"tags":["c#","wpf","mvvm","outlook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13251705,"title":"Failing to create an email with outlook interop when outlook has already been opened","body":"<p>How do you open an outlook window? I tried the code below but this doesn't work when an instance of outlook is already running - </p>\n\n<pre><code>System.Diagnostics.Process[] processes = System.Diagnostics.Process.GetProcessesByName(\"OUTLOOK\");\n\nint processCount = processes.Length;\nif (processCount != 0)\n{\n    **outlookApp = Marshal.GetActiveObject(\"Outlook.Application\") as Microsoft.Office.Interop.Outlook.Application;** this is throwing the below error **\n}\nelse\n{\n    outlookApp = new Microsoft.Office.Interop.Outlook.Application();\n}\n</code></pre>\n\n<p>And I got:</p>\n\n<pre><code>Error:\nOperation unavailable (Exception from HRESULT: 0x800401E3 (MK_E_UNAVAILABLE))\n</code></pre>\n\n<p>Can someone please give an alternate approach or changes to the above code?</p>\n"},{"tags":["c#","wpf","storyboard","itemscontrol"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13259366,"title":"Animate height change when the DataContext of an ItemsControl changes in WPF","body":"<p>I have an <code>ItemsControl</code> that binds to its <code>DataContext</code>. When the <code>DataContext</code> changes, I want the height change of <code>ItemsControl</code> animated. I tried to specify a <code>DataContextChanged</code> event for the <code>ItemsControl</code>: </p>\n\n<pre><code>&lt;ItemsControl x:Name=\"items\" ItemsSource=\"{Binding}\" ItemTemplate=\"{StaticResource LocationTemplate}\" DataContextChanged=\"Items_DataContextChanged\"&gt;\n</code></pre>\n\n<p>And in the handler, I tried to create a <code>DoubleAnimation</code> for height. However, I don't know how to specify <code>From</code> and <code>To</code> properties. Anyone can help? Thanks!</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1915,"score":2,"question_id":4348408,"title":"how to close window form which is hosting WPF user control from within a WPF user control","body":"<p>I want to close a window form that is hosting a WPF user control. Something like this as used while closing a current form in window application. But for WPF application I am not able to get reference to user controls parent</p>\n\n<p>How to get Form which is hosting this control so that I can close my form</p>\n\n<p>this.Close()</p>\n"},{"tags":["c#","wpf","radio-button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13170299,"title":"WPF Radiobutton TwoWay Binding causes always two Property calls. How to distinguish?","body":"<p>I have several RadioButtons combined in one Group so that only one can be checked. The RadioButtons are bound to boolean Properties.</p>\n\n<p>This works very well and my program reacts on the changes of these Properties.</p>\n\n<p>Suppose <code>optA</code> is selected. Next I select <code>optB</code>, the value of <code>PropertyB</code> is set to true and my program reacts accordingly. However, at this time both <code>optA</code> and <code>optB</code> are true until the Group of Radio buttons updates <code>optA</code> to false  which again triggers my \"IsSelected\" event.</p>\n\n<p>I think this is totally correct behavior...\nBut how can I distinguish between a change from the user and the automated change from the group?</p>\n\n<p>Edit: Code</p>\n\n<pre><code>&lt;RadioButton Name=\"featureCheckBox\" GroupName=\"featureRadioButtonGroup\" IsChecked=\"{Binding Path=IsSelected, Mode=TwoWay}\" /&gt;\n\n public bool IsSelected { \n\n        get{ return _isSelected; }\n        set { PropertyChanged.ChangeAndNotify(ref _isSelected, value, () =&gt; IsSelected); }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","workflow-foundation-4","workflowservice"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13199533,"title":"Workflow Service custom tracking participant that talks to an client-side endpoint(s)?","body":"<p>I'm at the investigative stage for Workflow Service and WPF.</p>\n\n<p>Having State Machine WF Service hosted in IIS and one or more WPF clients talking to the WF Service sounds reasonable choice so far.</p>\n\n<p>However, although days of reading and research it isn't clear to me what would be the best strategy for tracking the transfer between states from WPF app.</p>\n\n<p>There're numerous samples of tracking participants but most of them are based on One process scenario. </p>\n\n<p>So I am thinking of a structure as below.</p>\n\n<ol>\n<li>A server-side WCF operation that any client calls to register its client-side endpoint</li>\n<li>A custom tracking participant that goes through all registered client-side endpoints and sends TrackingRecord at it's Track() method.</li>\n</ol>\n\n<p>Advantage of this approach is that it allows real time update of the states without extra layers like ETW. Another advantage is that it allows decoupling of the logic (or maybe model layer) from the presentation layer.</p>\n\n<p>Can anyone share the opinion over the above structure?\nI would also welcome any suggestions for achieving the goal.</p>\n\n<hr>\n\n<p>[EDIT]\nTo make my idea above more detailed and clear, below steps would be a typical usage.</p>\n\n<p>1) (WPF client) contains and opens a WCF endpoint for receiving TrackRecords.</p>\n\n<p>2) (WF Service) opens a WCF operation (or a simple WF instance with a Receive message) that registers client-side address to an internal store.</p>\n\n<p>3) (WF Service) a custom tracking participant is created and added that will send TrackingRecord to the registered clients' endpoints.</p>\n\n<p>4) (client) connects to the above service and hands out client-side endpoint mentioned at step 1 and consequently receives TrackingRecords.</p>\n"},{"tags":["c#","wpf","xaml","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13271689,"title":"WPF combobox ItemTemplate does not apply","body":"<p>I have a combobox, which is bound to a dictionary of </p>\n\n<pre><code>&lt;int, MyObject&gt;\n</code></pre>\n\n<p>by the following code:</p>\n\n<pre><code>this.comboBox.ItemsSource= dictionary;\n</code></pre>\n\n<p>MyObject has some public properties, such as Name (string) and Selected (boolean). </p>\n\n<p>In my Xaml I have an ItemTemplate on comboBox:</p>\n\n<pre><code>&lt;ComboBox.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;TextBlock Text=\"{Binding Path=Key, Mode=OneWay}\"/&gt;\n    &lt;/DataTemplate&gt;\n&lt;/ComboBox.ItemTemplate&gt;\n</code></pre>\n\n<p>When I run the app, I get the combobox filled with [1, MyObject] values. </p>\n\n<p>What I eventually want to do is have a checkbox and a textblock in the ItemTemplate, which will be bound to MyObject.Selected and MyObject.Name. At the moment, I can't even get the datatemplate to display the dictionaty Key value.</p>\n\n<p>Any ideas why the itemtemplate is being ignored? I've tried the full temeplate (stack planel containing a combobox and textblock), that showed the same values at runtime.</p>\n\n<p>cheers.</p>\n"},{"tags":["wpf","starter-kits"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13271575,"title":"Where to download SCE Starter Kit","body":"<p>Where to download SCE Starter Kit?\nSyndicated Client Experience Starter Kit for VS 2012</p>\n\n<p>I am not able to download:<br/>\n<a href=\"http://blogs.msdn.com/b/llobo/archive/2008/01/16/live-the-syndicated-client-experiences-starter-kit-reader-sdk.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/llobo/archive/2008/01/16/live-the-syndicated-client-experiences-starter-kit-reader-sdk.aspx</a></p>\n"},{"tags":["c#","wpf","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":9092494,"title":"When I draw a button, it snaps back to the middle of the screen?","body":"<p>I'm very new to WPF. I was trying to add a button to a tab item (of a tab control I had already dragged in) in Visual C# 2010 Express. Upon doing this, the button repeatedly snapped to the center of the screen when I tried to drag-and-drop reposition it. Why is this happening, and how can I move the button? I haven't written any code, and the only properties of the button that I've changed are the size, content, and name.</p>\n"},{"tags":["wpf","entity-framework","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13249086,"title":"async-await issue in EF 6","body":"<p>I'm trying async-await programming with entity-framework 6 (code first) + WPF and I can't see why the UI still freezes after I made the code asynchronous.\nHere is what I'm doing from the very first line:</p>\n\n<p>first there is an event handler responding to a click button:</p>\n\n<pre><code>private async void LoginButton_Click(object sender, RoutedEventArgs e) {\n  if (await this._service.Authenticate(username.Text, password.Password) != null)\n    this.Close();\n}\n</code></pre>\n\n<p>Then I have the Authenticate method in my service layer:</p>\n\n<pre><code>public async Task&lt;User&gt; Authenticate(string username, string password) {\n  CurrentUser = await this._context.GetUserAsync(username.ToLower().Trim(), password.EncryptPassword());\n  return CurrentUser;\n}\n</code></pre>\n\n<p>and at the end is the EF code in the context:</p>\n\n<pre><code>public async Task&lt;User&gt; GetUserAsync(string username, string password) {\n  return await this.People.AsNoTracking().OfType&lt;User&gt;().FirstOrDefaultAsync(u =&gt; u.Username == username &amp;&amp; u.Password == password);\n}\n</code></pre>\n\n<p><strong>Update:</strong> After some tracing the cause of UI freezing turned out to be the initialization process. UI thread blocks until the EF context is initialized and once that is done the actual querying/saving process is performed asynchronously. </p>\n"},{"tags":["c#","wpf","com","port"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13270754,"title":"Error while receiving data from serial port","body":"<p>I have application with several windows (actually its two almost same windows with some functions). One of that function is reading data from COM port (read weight from weighting machine). Problem is that, it works perfect on first window, but when im closing it and opening another window, then clicking same function (lets call it calculate weight), im getting this error message:\nAccess to the port 'COM1' is denied.</p>\n\n<p>Code:</p>\n\n<pre><code>   private void calculateWeight_Click(object sender, RoutedEventArgs e)\n{\n    sp = new SerialPort(\"COM1\", 9600, Parity.None, 8, StopBits.One);\n    tekst = string.Empty;\n    sp.Open();\n    sp.WriteLine(((char)5).ToString());\n    sp.WriteLine(((char)17).ToString());\n    sp.DataReceived += new SerialDataReceivedEventHandler(sp_DataReceived);\n}\nprivate delegate void UpdateUi(string s);\nvoid sp_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n    tekst += sp.ReadExisting();\n    if (tekst.Contains('S') &amp;&amp; tekst.Length &gt; 14)\n        Dispatcher.Invoke(DispatcherPriority.Send, new UpdateUi(czytajWage), tekst);\n}\nstring tekst = string.Empty;\n\nvoid czytajWage(string s)\n{\n    string w = \"\";\n    for (int i = 5; i &lt; 14; i++)\n    {\n        w += s[i];\n    }\n    MessageBox.Show(w);\n    w = \"\";\n    tekst = \"\";\n\n    sp.DataReceived -= sp_DataReceived;\n}\n</code></pre>\n\n<p>Anyone can help? ;)</p>\n"},{"tags":["wpf","xaml","textbox"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2357,"score":0,"question_id":5593649,"title":"Help text in WPF TextBox that disppears after first input - Watermark, the XAML way","body":"<p>In a WPF TextBox  I'd like to provide a description that vanishes after the first input. This should provide a little help to the user what he should enter in the text field.</p>\n\n<p>The text could be displayed above the given TextBox using a Label. I am interested in an <strong>example</strong>, but couldn't find any. Ideally the solution is XAML only.</p>\n"},{"tags":["c#","wpf","mvvm","mvvm-light"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13213221,"title":"How a ViewModel communicates with its own View","body":"<p>I am developing a WPF MVVM Light application, I want to display some message boxes/dialog boxes or there are some other scenarios where I want my View model to communicate with its view or raise some event on its respective view.</p>\n\n<p>How could I achieve that?</p>\n"},{"tags":["wpf","gridview","slider","width","clipping"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":209,"score":3,"question_id":12203643,"title":"Howto resize the width of a GridView column after it has been initialized?","body":"<p><strong>Updated problem:</strong></p>\n\n<p>In WPF I use a <code>GridView</code> (inside a <code>ListView</code>) to display a list of <code>Textbox-Slider</code> pairs. Each such pair is arranged in exactly one cell of the single column (by using a <code>DockPanel</code> for each pair).</p>\n\n<p>The Slider has a minimal width so that it does not collapse, the textbox does not, it is resized dynamically on receiving input.</p>\n\n<p>The problem is that when the textbox's width increases the column width is not equivalently changed. This causes the slider in the corresponding row to be visually clipped on the right side. As a result the slider's knob disappears in the void when moved to the right end. </p>\n\n<p>So the question is: How do I force the column width of the gridview to resize dynamically if the contents exceed the available space (which was set at initialization time)?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Uv1BZ.png\" alt=\"Percentage sliders with disappearing knobs\"></p>\n\n<p><em>Just ignore the label between the textbox and the slider (without it the behaviour does not change).</em></p>\n"},{"tags":["c#",".net","wpf","serialization","application-settings"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":492,"score":2,"question_id":6309026,"title":"ApplicationSettingsBase writes empty tag for custom collection","body":"<p>I have been fighting with this off and on for several days now.  I need to store a collection of custom objects as part of the user's settings.  Based on lots of google work it seems that building a preferences class off of <code>ApplicationSettingsBase</code> is an appropriate way to do so.  The problem I run into is as soon as I try to store a collection of a custom type no data gets saved for that property.  If I keep to collections of base types, such as string, things work.  I have a separate proof of concept project I have been working with for the past day to isolate down to just this issue.</p>\n\n<p>This project consists of a WPF window with a listbox and two buttons, “+” and “-“.  I have a Prefs class with three properties defining different types of collections.  In my window code I bind the listbox to one of these lists and the buttons either add or remove an item to/from the list.  Closing the window should save the contents of the list to the users.config file for the current user.  Reopening it should display the saved contents of the list.</p>\n\n<p>If I use List1 (<code>ObservableCollection&lt;string&gt;</code>) and click the + button a few times then close the window the data is correctly saved to user.config.  However if I change and use List2(<code>ObservableCollection&lt;Foo&gt;</code>) or List3(<code>FooCollection</code>) I just end up with an empty value tag.  I have tried to implement <code>ISerializable</code> and <code>IXmlSerializable</code> in attempts to get this working with no change in behavior.  In fact running in debug mode with break points shows that the collection contains data when the save method is called but the serialization interface methods are never being called.</p>\n\n<p>What am I missing?  </p>\n\n<p>UPDATE: I have changed my approach and written the data off to another file alongside of user.config for the time being so that I can make some progress on other portions of the app.  But I would still like to know why application settings base was failing to record my collection data.</p>\n\n<p>Here is all of the relevent code, if someone thinks an ommitted section is important I will add it back into the post.</p>\n\n<p>user.config after adding a couple of elements to each list property</p>\n\n<pre><code>&lt;setting name=\"List1\" serializeAs=\"Xml\"&gt;\n    &lt;value&gt;\n        &lt;ArrayOfString xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n            xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;string&gt;0&lt;/string&gt;\n            &lt;string&gt;1&lt;/string&gt;\n            &lt;string&gt;2&lt;/string&gt;\n        &lt;/ArrayOfString&gt;\n    &lt;/value&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List2\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List3\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n</code></pre>\n\n<p>Window XAML</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;ListBox Name=\"l1\" Grid.Column=\"0\" Grid.Row=\"0\" ItemsSource=\"{Binding}\"&gt;&lt;/ListBox&gt;\n    &lt;StackPanel Grid.Column=\"1\" Grid.Row=\"0\"&gt;\n        &lt;Button Name=\"bP\" Margin=\"5\" Padding=\"5\" Click=\"bP_Click\"&gt;+&lt;/Button&gt;\n        &lt;Button Name=\"bM\" Margin=\"5\" Padding=\"5\" Click=\"bM_Click\"&gt;-&lt;/Button&gt;\n    &lt;/StackPanel&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Code Behind for Window</p>\n\n<pre><code>public partial class Window1 : Window\n{\n    Prefs Prefs = new Prefs();\n\n    public Window1()\n    {\n        InitializeComponent();\n\n        //l1.DataContext = Prefs.List1;\n        //l1.DataContext = Prefs.List2;\n        l1.DataContext = Prefs.List3;\n    }\n\n    private void Window_Closed(object sender, EventArgs e)\n    {\n        Prefs.Save();\n    }\n\n    private void bP_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.Add(Prefs.List1.Count.ToString());\n        //Prefs.List2.Add(new Foo(Prefs.List2.Count.ToString()));\n        Prefs.List3.Add(new Foo(Prefs.List3.Count.ToString()));\n    }\n\n    private void bM_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.RemoveAt(Prefs.List1.Count - 1);\n        //Prefs.List2.RemoveAt(Prefs.List2.Count - 1);\n        Prefs.List3.RemoveAt(Prefs.List3.Count - 1);\n    }\n}\n</code></pre>\n\n<p>Prefs class</p>\n\n<pre><code>class Prefs : ApplicationSettingsBase\n{\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;string&gt; List1\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;string&gt; Value = this[\"List1\"] as System.Collections.ObjectModel.ObservableCollection&lt;string&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;string&gt;();\n                this[\"List1\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; List2\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; Value = this[\"List2\"] as System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;();\n                this[\"List2\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public FooCollection List3\n    {\n        get\n        {\n            FooCollection Value = this[\"List3\"] as FooCollection;\n            if (Value == null)\n            {\n                Value = new FooCollection();\n                this[\"List3\"] = Value;\n            }\n            return Value;\n        }\n    }\n}\n</code></pre>\n\n<p>Foo Class</p>\n\n<pre><code>[Serializable()]\nclass Foo : System.ComponentModel.INotifyPropertyChanged, ISerializable, IXmlSerializable\n{\n    private string _Name;\n    private const string PropName_Name = \"Name\";\n    public string Name\n    {\n        get { return this._Name; }\n        set\n        {\n            if (value != this._Name)\n            {\n                this._Name = value;\n                RaisePropertyChanged(Foo.PropName_Name);\n            }\n        }\n    }\n    public override string ToString()\n    {\n        return Name;\n    }\n\n    public Foo() { }\n    public Foo(string name)\n    {\n        this._Name = name;\n    }\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public Foo(SerializationInfo info, StreamingContext context)\n    {\n        this._Name = (string)info.GetValue(Foo.PropName_Name, typeof(string));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(Foo.PropName_Name, this._Name);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        reader.MoveToContent();\n        _Name = reader.GetAttribute(Foo.PropName_Name);\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        writer.WriteAttributeString(Foo.PropName_Name, _Name);\n    }\n    #endregion\n}\n</code></pre>\n\n<p>and FooCollection class</p>\n\n<pre><code>[Serializable()]\nclass FooCollection : ICollection&lt;Foo&gt;, System.ComponentModel.INotifyPropertyChanged, INotifyCollectionChanged, ISerializable, IXmlSerializable\n{\n    List&lt;Foo&gt; Items;\n    private const string PropName_Items = \"Items\";\n\n    public FooCollection()\n    {\n        Items = new List&lt;Foo&gt;();\n    }\n\n    public Foo this[int index]\n    {\n/***Omitted for space***/\n    }\n\n    #region ICollection&lt;Foo&gt; Members\n/***Omitted for space***/\n    #endregion\n\n    public void RemoveAt(int index)\n    {\n/***Omitted for space***/\n    }\n\n    #region IEnumerable Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyCollectionChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public FooCollection(SerializationInfo info, StreamingContext context)\n    {\n        this.Items = (List&lt;Foo&gt;)info.GetValue(FooCollection.PropName_Items, typeof(List&lt;Foo&gt;));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(FooCollection.PropName_Items, this.Items);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        reader.MoveToContent();\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            if (reader.IsStartElement(FooCollection.PropName_Items))\n            {\n                reader.ReadStartElement();\n\n                while (reader.IsStartElement(\"Foo\"))\n                {\n                    this.Items.Add((Foo)FooSerializer.Deserialize(reader));\n                }\n\n                reader.ReadEndElement();\n            }\n\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        writer.WriteStartElement(FooCollection.PropName_Items);\n\n        foreach (Foo Item in Items)\n        {\n            writer.WriteStartElement(\"Foo\");\n            FooSerializer.Serialize(writer, Item);\n            writer.WriteEndElement();//\"Foo\"\n        }\n\n        writer.WriteEndElement(); //FooCollection.PropName_Items\n    }\n    #endregion\n}\n</code></pre>\n"},{"tags":["wpf","wpf-controls","tabcontrol","tabitem"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":448,"score":1,"question_id":8493781,"title":"How to have some tabs aligned left and others aligned right? (TabControl in wpf)","body":"<p>I have a tabcontrol and I want to put some tabitem headers aligned to the left, and others aligned to the right. Like in this mock screenshot:</p>\n\n<p><img src=\"http://img269.imageshack.us/img269/8894/tabcontrol.png\"/></p>\n\n<p>What I've tried already:</p>\n\n<ul>\n<li>Styles: I can right align the tabitem using this:</li>\n</ul>\n\n<p><a href=\"http://stackoverflow.com/questions/4800455/align-wpf-tabcontrol-strip\">align wpf tabcontrol strip</a></p>\n\n<p>But I haven't been able to find a way to mix left and right aligned tab items.</p>\n\n<ul>\n<li>Using two TabControls: I can have two overlapping TabControls, one with left aligned tabs, the other with Right aligned tabs. The difficulty is getting them to switch. Click or MouseDown don't fire consistently when the user clicks the tab header (even with Ishitvisible = true). SelectionChanged doesn't work because if the user has previously selected tab 'D' in TabControl 2, then goes to Tab 'A' and back to 'D' - TabControl 2 doesn't know the selection has changed.</li>\n</ul>\n\n<p>At this point I am out of ideas. </p>\n"},{"tags":["wpf","mvvm","immutable"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13262631,"title":"Immutable data model for an WPF application with MVVM implementation","body":"<p>I have an application which has a data tree as a databackend. To implement the the MVVM pattern I have a logic layer of classes which encapsulate the data tree. Therefore the logic also is arranged in a tree. If the input is in a valid state the data should be copied to a second thread which works as a double buffer of the last valid state. Therefore one way would be cloning. </p>\n\n<p>Another approach would be to implement the complete data backend to be immutable. This would imply to rebuild the whole data tree if something new is entered. My question is, is there a practical way to do this? I'm stuck at the point where I have to reassign the data tree efficently to the logic layer.</p>\n\n<p>**UPDATE - Some Code</p>\n\n<p>What we are doing is to abstract hardware devices which we use to run our experiments. Therefore we defined classes like \"chassis, sequence, card, channel, step\". Those build a tree structure like this:</p>\n\n<pre><code>                            Chassis\n                          /      \\\n                   Sequence1      Sequence2\n                   /    |    \\\n              Card1   Card2  Card3\n             /     \\\n     Channel1      Channel2\n    /        \\\nStep1        Step2\n</code></pre>\n\n<p>In code it looks like this:</p>\n\n<pre><code>public class Chassis{\n\nreadonly var List&lt;Sequence&gt; Sequences = new List&lt;Sequence&gt;();\n\n}\n\npublic class Sequence{\n\nreadonly var List&lt;Card&gt; Cards = new List&lt;Card&gt;();\n\n}\n</code></pre>\n\n<p>and so on. Of course each class has some more properties but those are easy to handle. My Problem now is that List is a mutable object. I can call List.Add() and it changed. Ok there is a ReadOnlyList but I'm not sure if it implements the immutability the right way. Right as in copy by value not reference and not just blocking to write to it by blocking the set methods. \nThe next problem is that the amount of sequences and step can vary. For this reason I need an atomic exchange of list elements. \nAt the moment I don't have any more code as I'm still thinking if this way would help me and if it is possible at all to implement it in a reasonable amount of time.</p>\n"},{"tags":["c#","wpf","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":11363203,"title":"How to get a dynamic ListBox ItemTemplate to stretch horizontally the full width of the ListBox?","body":"<p>I have a normal listbox with a custom template to show the items. What I cannot manage is to stretch the template horizontally over the full widtg of the list box.</p>\n\n<p>My problem is, that all of the elements in the main window are put dynamically, and they resize along with the window size changed method. I've searched through the net and the idea was to put HorizontalAligment=\"Stretch\". This I tried, everywhere possible, with no significant success.</p>\n\n<p>my xaml code goes like this:</p>\n\n<pre><code>&lt;UserControl x:Class=\"LiveGames.Dealer.UsersList\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         mc:Ignorable=\"d\" \n         Background=\"Transparent\"&gt;\n&lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n     &lt;Grid&gt;\n        &lt;Grid.Resources&gt;\n            &lt;DataTemplate x:Key=\"PlayerTemplate\"&gt;\n                &lt;WrapPanel&gt;\n                    &lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n                        &lt;Border.Background&gt;\n                            &lt;LinearGradientBrush StartPoint=\"0.5,0\" EndPoint=\"0.5,1\"&gt;\n                                &lt;GradientStop Offset=\"0.0\" x:Name=\"gradientOne_Name\" Color=\"Red\" /&gt;\n                                &lt;GradientStop Offset=\"1.0\" x:Name=\"gradientTwo_Name\" Color=\"DarkRed\" /&gt;\n                            &lt;/LinearGradientBrush&gt;\n                        &lt;/Border.Background&gt;\n                        &lt;Grid &gt;\n                            &lt;Grid.ColumnDefinitions x:Uid=\"5\"&gt;\n                                &lt;ColumnDefinition  Width=\"*\"/&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;Grid.RowDefinitions&gt;\n                                &lt;RowDefinition Name=\"RowH\" Height=\"50\"/&gt;\n                            &lt;/Grid.RowDefinitions&gt;\n\n                            &lt;!--  &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Grid.Row=\"1\" Text=\"Player: \" FontSize=\"18\" /&gt;--&gt;\n                            &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Text=\"{Binding Path=ID}\" FontSize=\"22\" FontWeight=\"Bold\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/Border&gt;\n                &lt;/WrapPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/Grid.Resources&gt;\n        &lt;Canvas&gt;\n            &lt;ListBox Name=\"userList\" Background=\"Transparent\" BorderBrush=\"Transparent\" BorderThickness=\"0\" ItemsSource=\"{Binding}\"  ItemTemplate=\"{StaticResource PlayerTemplate}\" HorizontalContentAlignment=\"Stretch\"&gt;\n                &lt;ListBox.ItemContainerStyle&gt;\n                    &lt;Style TargetType=\"ListBoxItem\" &gt;\n                        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\"/&gt;\n                    &lt;/Style&gt;\n                &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;/ListBox&gt;\n        &lt;/Canvas&gt;\n    &lt;/Grid&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p></p>\n\n<p>Does anybody have any idea how to do this, maybe even in the code behind?</p>\n\n<p>M</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13265442,"title":"WPF Listview item highlight by their first character","body":"<p>I have a listview and it binds customer datas from database. I want to be focused by their first character. For example, when I click on to \"B\" from keyboard then, highlight focus must go to customers whose names' first character is \"B\". Do you have any idea? My listview's XAML is below.</p>\n\n<pre><code>&lt;ListView x:Name=\"datalist\" ButtonBase.Click=\"datalist_Click\" ContextMenuOpening=\"datalist_ContextMenuOpening\" MouseDoubleClick=\"datalist_MouseDoubleClick\" SelectionChanged=\"datalist_SelectionChanged\"\nMouseUp=\"datalist_MouseUp\" PreviewMouseUp=\"datalist_PreviewMouseUp\" &gt; \n</code></pre>\n"},{"tags":["c#","wpf","growl"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1268,"score":3,"question_id":4643272,"title":"What \"growl\" type notification windows are available for WPF (windows that appear and fade after X seconds)?","body":"<p>I wanted to know if there are any good \"growl\" type notification windows available as open source or guided tutorials for WPF applications.  I'm looking for a window that can appear when users save for example, notifying them that the save was successful and then disappears after X seconds (with a fade out) without the user needing to take the explicit action to close the notification window.  This way for messages/notifications that require no confirmation, like the example, the user would not have to click \"OK\" to make the messagebox or dialog close.</p>\n"},{"tags":["wpf","statemachine","diagramming"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13120255,"title":"Drawing State Chart Diagram in WPF","body":"<p>Could anyone please suggest me a good reference to create StateChart Diagram in WPF. My major concern is Drawing rather than backend workflow.\nAny two states can have one or more connectors between them which will show the transition conditions.</p>\n\n<p>Thanks in advance.\nMirza</p>\n"},{"tags":[".net","wpf","winforms","telerik","windowsformshost"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13196454,"title":"Telerik RadPanorama control in a WindowsFormsHost control","body":"<p>I am building a WPF app where I work and I want to use the RadPanorama for the Start Screen or \"Launching Pad\" for the App.  I understand, and have seen the numerous threads, that there is no RadPanorama for WPF.  </p>\n\n<p>However, is there any reason I cannot embed one in a WindowsFormsHost?  </p>\n\n<p>Seems to work after a VERY quick little test but I am wondering if anyone has any feedback on doing it this way?  Somethings are very 'messy' to get at with out the Design Time support.  Is there a way around that? </p>\n"},{"tags":["wpf","button","styles"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13267351,"title":"Flashing button content template in WPF","body":"<p>I have the following two styles for a button to be either regular or Red for a warning. But when it is red I want it to flash rather than be solid red. Is there a way using WPF animation or some feature that I can make this happen just using styles?</p>\n\n<pre><code> &lt;ControlTemplate x:Key=\"ToolbarButtonRed\" TargetType=\"{x:Type Button}\"&gt;\n        &lt;Border Margin=\"0.3\" BorderThickness=\"1,1,1,1\" CornerRadius=\"4,4,4,4\" BorderBrush=\"#cccccc\" Background=\"#999999\" Width=\"47\"&gt;\n            &lt;Grid&gt;\n                &lt;Border x:Name=\"BorderUp\" BorderThickness=\"2,2,2,2\" CornerRadius=\"4,4,4,4\"&gt;\n                    &lt;Border.Background&gt;\n                        &lt;LinearGradientBrush StartPoint=\".5,0\" EndPoint=\".5,1\"&gt;\n                            &lt;GradientStop Color=\"#ffaaaa\" Offset=\"0\"/&gt;\n                            &lt;GradientStop Color=\"#cc6666\" Offset=\"0.6\"/&gt;\n                            &lt;GradientStop Color=\"#bb2222\" Offset=\"1\"/&gt;\n                        &lt;/LinearGradientBrush&gt;\n                    &lt;/Border.Background&gt;\n                &lt;/Border&gt;\n                &lt;Border x:Name=\"BorderDown\" BorderThickness=\"2,2,2,2\" CornerRadius=\"4,4,4,4\" Opacity=\"0\"&gt;\n                    &lt;Border.BorderBrush&gt;\n                        &lt;LinearGradientBrush StartPoint=\"0.5,0\" EndPoint=\"0.5,1\" &gt;\n                            &lt;GradientStop Color=\"White\" Offset=\"1\"/&gt;\n                            &lt;GradientStop Color=\"#222222\" Offset=\"0\"/&gt;\n                        &lt;/LinearGradientBrush&gt;\n                    &lt;/Border.BorderBrush&gt;\n                    &lt;Border.Background&gt;\n                        &lt;LinearGradientBrush StartPoint=\".5,0\" EndPoint=\".5,1\"&gt;\n                            &lt;GradientStop Color=\"#ff9966\" Offset=\"0\"/&gt;\n                            &lt;GradientStop Color=\"#bb2222\" Offset=\"0.6\"/&gt;\n                            &lt;GradientStop Color=\"#441111\" Offset=\"1\"/&gt;\n                        &lt;/LinearGradientBrush&gt;\n                    &lt;/Border.Background&gt;\n                &lt;/Border&gt;\n                &lt;ContentPresenter x:Name=\"Contents\" \n                                      HorizontalAlignment=\"Center\" \n                                      VerticalAlignment=\"Center\" \n                                      Width=\"Auto\"\n                                      TextBlock.Foreground=\"White\"\n                                      Margin=\"3,3,3,3\"/&gt;\n            &lt;/Grid&gt;\n        &lt;/Border&gt;\n        &lt;ControlTemplate.Triggers&gt;\n            &lt;Trigger Property=\"IsPressed\" Value=\"True\"&gt;\n                &lt;Setter TargetName=\"BorderDown\" Property=\"Opacity\" Value=\"1\"/&gt;\n                &lt;Setter TargetName=\"Contents\" Property=\"Margin\" Value=\"4,4,2,2\"/&gt;\n            &lt;/Trigger&gt;\n            &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                &lt;Setter TargetName=\"BorderDown\" Property=\"Opacity\" Value=\"1\"/&gt;\n            &lt;/Trigger&gt;\n        &lt;/ControlTemplate.Triggers&gt;\n\n    &lt;/ControlTemplate&gt;\n\n    &lt;Style x:Key=\"ToolbarButtonDisplay\" TargetType=\"Button\"&gt;\n        &lt;Setter Property=\"ContentTemplate\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\"&gt;\n                        &lt;Image Source=\"{Binding Path=(Windows:ButtonProperties.Image), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}\" Margin=\"0,2,0,0\" Width=\"32\"/&gt;\n                        &lt;TextBlock FontSize=\"9\" FontWeight=\"Normal\" FontFamily=\"Arial\" Foreground=\"White\" HorizontalAlignment=\"Center\" Margin=\"2,2,2,2\"&gt;\n                                &lt;ContentPresenter Content=\"{Binding Path=Content, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}\"&gt;&lt;/ContentPresenter&gt;\n                        &lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"Windows:ButtonProperties.IsRed\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Template\" Value=\"{DynamicResource ToolbarButtonRed}\"/&gt;\n            &lt;/Trigger&gt;\n            &lt;Trigger Property=\"Windows:ButtonProperties.IsRed\" Value=\"False\"&gt;\n                &lt;Setter Property=\"Template\" Value=\"{DynamicResource ToolbarButton}\"/&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n</code></pre>\n"},{"tags":["wpf","layout","line"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13266660,"title":"How can I layout a line with an arrow in a flexible grid?","body":"<p>My WPF window contains a Grid that stretches to the entire window width and layouts some controls along the way. Inmidst of these controls, there should be displayed some lines with arrows on one end, that visualise some kind of flow. The lines span across multiple grid columns or rows and have some margin to each sides, to keep them away from the other controls. Multiple lines have certain connection points where they must touch. For now, I only need horizontal and vertical lines.</p>\n\n<p>I've tried with the Line control, but that seems to require X and Y coordinates for both ends, in pixels. That's not easy because the line may stretch as the user changes the window size.</p>\n\n<p>Next was the Path control, but I don't know how to add arrow ends there. The Path data was \"M0,0 L1,0\" with Stretch=\"Fill\", so if I draw an arrow in the path, it would stretch as well, which I shouldn't do.</p>\n\n<p>What alternatives are there to stretch a line but not the arrow on it?</p>\n"},{"tags":["wpf","grid","resize","textblock"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":708,"score":0,"question_id":1794457,"title":"WPF resizing TextBlock","body":"<p>I have a textblock in a grid in WPF.</p>\n\n<p>I want the text to dynamically size (font) when resized. At the moment textboxes, comboboxes do this, but the the textblock stays the same. Is it possible?</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":732,"score":2,"question_id":7093861,"title":"Filter items of a ListBox based on the text of a TextBox using only XAML in WPF","body":"<p>I currently have a ListBox binded to a collection of items. As the collection is big we want to filter the items being shown based on the text entered on a TextBox. </p>\n\n<p>What I'm asking is if this is possible to implement using only XAML, I don't want to modify the collection of items, I would like to modify the Visibility of each of the items based on the filter.</p>\n\n<p>Hope its clear,</p>\n\n<p>thanks!</p>\n"},{"tags":["wpf","resize","label","textblock"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1274,"score":1,"question_id":1464185,"title":"How to set textblock or label with resizable font size in WPF?","body":"<p>In WPF, if i put any controls in grid, if i resize the grid, it automatically resizes all the controls in it.But in label or textblock or any other text elements, all the control sizes will change but font size remains same, it will not change.</p>\n\n<p>If font has to change as per grid size, What should be done?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2155,"score":5,"question_id":4794355,"title":"WPF 4: Grow/Shrink TextBlock (Font Size) based on available space","body":"<p>I've seen this question asked a lot, however, to the opposite of what I'm looking for.  While other people want a control to size itself based on the size of text, I'm trying to figure out is if there is a way to grow the size of text to the amount of space available.</p>\n\n<p>Take the idea of a digital clock window and you want the numbers stating the time to grow (or shrink) based on the size of the window the clock is in.  If there isn't a way to automatically do this any pointers to a programmatic way I can get this accomplished?</p>\n\n<p>Thanks in advanced.</p>\n"},{"tags":["wpf","application","winrt","microsoft-metro","enterprise"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":1,"view_count":1619,"score":6,"question_id":11201490,"title":"How suitable is Metro style (WinRT) UI for enterprise apps?","body":"<p>If you guys were at the start point of designing a new enterprise/business app, would you consider <strong>Metro style</strong> (<strong>WinRT</strong>) user interface for that?</p>\n\n<p>We need:</p>\n\n<ul>\n<li>a comprehensive desktop app (WPF/MVVM) for editing many complex forms with hundreds fields, some forms/windows/pages can be very big, so free space on the screen has to be utilised wisely. Users have to get all items by mouse ASAP and use keyboard for quick access.</li>\n<li>a web app for viewing data (much simpler than the desktop app)</li>\n<li>mobile apps for iPhone/Android with basic functions for off-line tasks in the field.</li>\n</ul>\n\n<p>UI should be consistent between all apps. And I'm sure it wouldn't be a problem to design mobile apps with Metro (and probably the web app). But the desktop app should be too comprehensive for Metro (big forms and lists). </p>\n\n<p>Have anybody seen samples of enterprise/business apps with Metro UI?</p>\n\n<p><strong>P.S.</strong>\nI've read many articles from MS (like <a href=\"http://msdn.microsoft.com/library/windows/apps/hh868273/\">Designing great productivity apps for Windows</a>) and some sober views of things (like <a href=\"http://betanews.com/2012/05/04/how-suitable-is-windows-8-metro-for-business-developers/\">How suitable is Windows 8 Metro for business developers?</a>) and still can't find a good approach for big forms and lists with Metro UI.</p>\n\n<p>Would like to get something like <a href=\"http://www.zune.net/en-us/products/software\">Zune</a> (on the picture below), but tend to think that is impossible.\n<img src=\"http://i.stack.imgur.com/kVURa.png\" alt=\"enter image description here\"></p>\n"},{"tags":["wpf","fonts","resize","textblock"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":4329,"score":5,"question_id":2282662,"title":"WPF TextBlock font resize to fill available space in a Grid","body":"<p>I have some text that is displayed at run time in a textblock. I want\nthe font size to be the biggest it can be to fill the area that is\ngiven. I think I have the textblock setup correctly to \"autosize\" and\nI try to increase the font size till the textblock is bigger than than\nits parent then decrease the font size by 1. The problem is I can't\nget the control to redraw/recompute its size.</p>\n\n<p>Is the a better way to do that? Or is there a way I can make my method work?</p>\n"},{"tags":[".net","wpf","image","3d"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":800,"score":1,"question_id":2681112,"title":"How to make non-blurry image in WPF 3d","body":"<p>I used <code>Viewport3D</code> and <code>ModelVisual3D</code> to create a simple ImageBrush with an image (I tried it with JPG, PNG), but it shows the image blurry, but the original image is very sharp and clear.</p>\n\n<p>I don't know how to make it with the original quality in 3D...</p>\n\n<p>I also tried some 2D solutions like <code>RenderOptions.BitmapScalingMode</code> and <code>SnapsToDevicePixels</code> but seem not fix the problem in the 3D case.</p>\n\n<p>Has anyone encountered this problem or know the solution?</p>\n\n<p>below is sample code:</p>\n\n<pre><code>&lt;Window\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"    \nTitle=\"Window6\" Height=\"600\" Width=\"600\"&gt;\n\n&lt;Window.Resources&gt;\n    &lt;MeshGeometry3D x:Key=\"Card1\" Positions=\"-0.67,1,0 -0.67,-1,0 0.67,-1,0 0.67,1,0\"\n        TextureCoordinates=\"0,0 0,1 1,1 1,0\" TriangleIndices=\"0 1 2 0 2 3\" /&gt;\n&lt;/Window.Resources&gt;\n&lt;DockPanel Height=\"600\" Width=\"600\"&gt;\n    &lt;Viewport3D Width=\"415.67\" x:Name=\"viewport\" Margin=\"0,23.363,0,64.363\" DockPanel.Dock=\"Left\"&gt;\n        &lt;Viewport3D.Camera&gt;\n            &lt;PerspectiveCamera x:Name=\"perCamera\" x:Uid=\"perCamera\" FieldOfView=\"60\" Position=\"0,0,5\" /&gt;\n        &lt;/Viewport3D.Camera&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n            &lt;Model3DGroup &gt;\n                &lt;GeometryModel3D Geometry=\"{StaticResource Card1}\"&gt;\n                    &lt;GeometryModel3D.Material&gt;\n                        &lt;DiffuseMaterial&gt;\n                            &lt;DiffuseMaterial.Brush&gt;\n                                &lt;ImageBrush ImageSource=\"images\\card.png\"/&gt;\n                            &lt;/DiffuseMaterial.Brush&gt;\n                        &lt;/DiffuseMaterial&gt;\n                    &lt;/GeometryModel3D.Material&gt;\n                &lt;/GeometryModel3D&gt;\n                &lt;/Model3DGroup&gt;\n            &lt;/ModelVisual3D.Content&gt;\n        &lt;/ModelVisual3D&gt;\n        &lt;!-- light --&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n                &lt;DirectionalLight Color=\"#FFFFFFFF\" Direction=\"0,0,-1\"/&gt;\n            &lt;/ModelVisual3D.Content&gt;\n        &lt;/ModelVisual3D&gt;\n\n    &lt;/Viewport3D&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#","wpf","string","listbox","listboxitem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13267657,"title":"adding a ListBoxItem in a ListBox in C#?","body":"<p>I know that:</p>\n\n<pre><code>String test = \"test\";\nListBox.Items.Add(test);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>String test = \"test\";\nint index = 1;\nListBox.Items.Insert(index, String);\n</code></pre>\n\n<p>adds the String in a ListBox, but I want to insert ListBoxItem, how to?\npreviously I learn that</p>\n\n<pre><code>var contentToString = (String)ListBoxItem.Content;\n</code></pre>\n\n<p>simply converts ListBoxItem to String, but I couldn't do the opposite to convert String to ListBoxItem</p>\n"},{"tags":["c#","wpf","windows","controlpanel","windows-search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13264646,"title":"Access windows control panel items (applets) via c# code","body":"<p>I am new to this and i have a small task. I want to access the control panel items, perform search and display their name, description and task lists etc what ever I can access in my window. Something similar to what windows explorer search does.</p>\n\n<p>This is what I have done till now. I followed the approach <a href=\"http://www.codeproject.com/Articles/6105/Enumerate-and-Host-Control-Panel-Applets-using-C\" rel=\"nofollow\">here</a> and I am able to access the cpl files in System folder. But they are not all the cpl files. And hence my result ends up being a subset of the desired result set.</p>\n\n<p>Also by accessing the cpl files I do not get the task list and other details which are valuable in my search operation.</p>\n\n<p>What else should I try? Can someone guide me?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13266624,"title":"How to retrieve a control's container when clicked","body":"<p>I've got a <code>TreeView</code> which contains a number of <code>TreeViewItems</code>.  Each <code>TreeViewItem</code> contains a horizontally-oriented <code>StackPanel</code> which in turn contains an image and a label.</p>\n\n<p>When the user clicks on the TreeViewItem, I would like to get a reference for that <code>TreeViewItem</code>.  Instead, the source is returning as either label or image, depending on which part of the <code>TreeViewItem</code> the user clicks on.</p>\n\n<p>I cannot use the selectedItemChanged event, as this is strictly an operation which must occur every time a TreeViewItem is clicked.</p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;TreeView DockPanel.Dock=\"Left\" \n          Name=\"tvSchema\" \n          AllowDrop=\"True\"\n          TreeViewItem.PreviewMouseLeftButtonDown=\"tvSchema_PreviewMouseLeftButtonDown\"&gt;\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>And here is the code which attempts to retrieve the selected TreeViewItem when the user clicks on one:</p>\n\n<pre><code>private void tvSchema_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n{\n     object x = e.OriginalSource; //Returns TextBlock\n     object y = e.Source; //Returns Label\n     object z = sender; //Returns TreeView\n}\n</code></pre>\n\n<p>What can be done to get the actual TreeViewItem?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13266916,"title":"How to pause a Threading.timer to complete a function","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/684200/synchronizing-a-timer-to-prevent-overlap\">Synchronizing a timer to prevent overlap</a>  </p>\n</blockquote>\n\n\n\n<p>I have a <code>Threading.Timer</code> in my class.</p>\n\n<pre><code> System.Threading.Timer timer;\n TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n</code></pre>\n\n<p>and defined a callback for it.</p>\n\n<pre><code>private void ProcessTimerEvent(object obj)\n{\n  if(value)\n    MyFunction();\n}\n</code></pre>\n\n<p>When run it, re-running callback before <code>myfunction</code> to complete.</p>\n\n<p>How to pause <code>Threading.Timer</code> to complete <code>myfunction</code>?</p>\n"},{"tags":["wpf","events","listbox","mouse-events"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":456,"score":0,"question_id":5675248,"title":"Automatic ListBox Selection/SelectedItem/SelectedIndex changed while moving mouse out of ListBox","body":"<p>Have a listbox with couple of items. Select any item (say the v.first item) and keep try to Drag it in empty area (Outside of listbox), ListBox selection is getting changed.Albeit i'm moving mouse in area out of ListBox.  </p>\n\n<p>I want selection change only when i move mouse within the ListBox.Or completely disable the selection change while mouse move (Dragged).  Here is the snapshot of a small poc.</p>\n\n<p><img src=\"http://i.stack.imgur.com/y9XCs.png\" alt=\"enter image description here\"></p>\n\n<pre><code>&lt;Grid&gt;  \n    &lt;ListBox HorizontalAlignment=\"Left\" Margin=\"111,49,0,180\" Name=\"listBox1\" Width=\"154\"&gt;  \n        &lt;ListBoxItem BorderThickness=\"2\" Height=\"50\" Width=\"Auto\" Name=\"heig\" BorderBrush=\"Chocolate\"&gt;Rohit Item 1&lt;/ListBoxItem&gt;  \n        &lt;ListBoxItem Height=\"50\" BorderThickness=\"2\" BorderBrush=\"Blue\"  &gt;Vivek&lt;/ListBoxItem&gt;  \n        &lt;ListBoxItem Height=\"50\" BorderBrush=\"Cyan\" BorderThickness=\"2\"  &gt;Gaurav&lt;/ListBoxItem&gt;  \n        &lt;ListBoxItem Name=\"height\" Height=\"50\" BorderBrush=\"CornflowerBlue\" BorderThickness=\"2\" &gt;Asit Item 2&lt;/ListBoxItem&gt;  \n    &lt;/ListBox&gt;  \n&lt;/Grid&gt;`\n</code></pre>\n\n<p>Still Waiting for a response.... THoughtss</p>\n"},{"tags":["c#","wpf","datagrid","colors"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13251789,"title":"WPF datagrid change color when text change","body":"<p>I want to change the color of the cell in a datagrid when the user changes the text or content of that cell.</p>\n\n<p>I am using WPF an C#.</p>\n\n<p>I have a simple datagrid: </p>\n\n<pre><code>&lt;DataGrid x:Name=\"dataGrid1\" Grid.RowSpan=\"2\" Margin=\"5\" ItemsSource=\"{Binding Source=Horreos}\" KeyDown=\"dataGrid1_KeyDown\" SelectedCellsChanged=\"dataGrid1_SelectedCellsChanged\"&gt; &lt;DataGrid.Columns &gt; &lt;/DataGrid.Columns&gt; &lt;/DataGrid&gt; \n</code></pre>\n\n<p>This events: keydown and selectedcellschange are tests for change my color cell. In the .cs I tried changing the cel.... but I failed.</p>\n\n<p><strong>I need an event that is released when the content changes</strong></p>\n"},{"tags":["c#",".net","wpf","winapi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2951,"score":0,"question_id":1776382,"title":"How do I remove the icon and title from a WPF Window but display it in the taskbar?","body":"<p>I'm trying to create a WPF window, which has no icon and no title displayed in the titlebar.</p>\n\n<p>I already found some examples how the icon can be removed (for example <a href=\"http://www.danrigsby.com/blog/index.php/2008/05/26/remove-icon-from-wpf-window/\" rel=\"nofollow\">here</a>), but all these solutions work if I'm debugging the application in Visual Studio but they don't work when I'm just running the executable.</p>\n\n<p>I would also like the title not to be shown. Of course I could leave the title blank, but I would like the title to be disyplayed in the taskbar (similiar to what Windows Explorer does in Vista/7)</p>\n"},{"tags":["c#","wpf","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13265891,"title":"I have issues with the C# WPF WebBrowser class","body":"<p>I have issues with the C# WPF WebBrowser class</p>\n\n<p>I have a C# WPF application which uses a WebBrowser class.  I have overwritten the LoadComplete method as well as several other methods to try to get the html content after the pages is loaded:</p>\n\n<pre><code>    String URL = textBox1.Text;\n\n    URL = URL.Replace(' ', '+');\n\n    webbrowser1 = new WebBrowser();\n\n    webbrowser1.LoadCompleted += new LoadCompletedEventHandler(webbrowser1_LoadCompleted);\n    webbrowser1.Loaded += new RoutedEventHandler(webbrowser1_Loaded);\n    webbrowser1.Navigated += webbrowser1_Navigated;\n\n    grd.Children.Add(webbrowser1);\n\n    int i = 0;\n    webbrowser1.Navigate(new Uri(\"https://www.google.com/#q=\" + URL + ....\n</code></pre>\n\n<p>I have put breakpoints in these methods and I have written code to grap the Inner HTML from the HTMLDocument of the WebBrowser class and I have output the html text to different files for each method.</p>\n\n<p>Then I have run the program.  While the program runs, I watch the actual program to see if the document loads.  The web page that is loading is the results page of a google search query.</p>\n\n<p>Visually, the output is a blank, white page when eaqch method for LoadComplete, Loaded and Navagated is hit while I run through the code.  It is only after the methods have been hit (some a couple of times) and the program is idle does the display show the results page.</p>\n\n<p>The HTML code that is output to files does not represent the google search results page.  Instead, it represents the google home page and does not have ny of the results.  Any ideas?  How can I programatically get the results page?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13262949,"title":"Change Cursor when combobox dropdown is open","body":"<p>I want to change the cursor to \"Hand\" when dropdown of a combobox is open.\nSo I did the below on <code>comboBox1_DropDownOpened</code> event. But the problem is cursor changes. But when I move through the menu Items the Cursor is remaining  as a Arrow.</p>\n\n<p>Please advice me.</p>\n\n<pre><code>private void comboBox1_DropDownOpened(object sender, EventArgs e)\n{    \n    this.Cursor = Cursors.Hand;    \n}\n</code></pre>\n"},{"tags":["c#","wpf","vb.net"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":176,"score":1,"question_id":9263965,"title":"How to calculate font size of TextBlock to fill in Canvas?","body":"<p>What I need is some <strong>formula</strong> to calculate <strong>font size</strong> of <code>TextBlock</code> for its owner -  <code>Canvas</code>.</p>\n\n<p>Let's say I have <code>Canvas</code> height 100.0 then which <strong><code>TextBlock</code> font size</strong> should be to fill all space of the <code>Canvas</code>?</p>\n\n<p><em>P.S. The main problem is that I scroll those TextBlocks horizontally...</em></p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13265483,"title":"Height/2 is equal to the maximum font size to fill the height. Is it correct?","body":"<p>I found that half of the text height is same as to the maximum font size to fill the Height.</p>\n\n<pre><code>double fontSize = textHeight/ 2;\n</code></pre>\n\n<p>Is it true?</p>\n"},{"tags":["wpf","combobox","collectionviewsource","selectedvalue","icollectionview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13172124,"title":"ComboBox SelectedValue correctly sets SelectedValue in Viewmodel but not in View","body":"<p>In my Project my selectedvalue sets correctly in viewmodel but my view not sets its selectedvalue</p>\n\n<p>in xaml code:</p>\n\n<pre><code> &lt;ComboBox ItemsSource=\"{Binding AllValues}\" SelectedValue=\"{Binding SelectedValue,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}\" Width=\"150\" Margin=\"5,0,0,0\"&gt;\n</code></pre>\n\n<p>in ViewModel:</p>\n\n<pre><code>public Model SelectedValue\n        {\n            get\n            {\n                return _model.Value;\n            }\n            set\n            {\n                 _model.Value = value;\n                if (CVSCollection.View != null)\n                    CVSCollection.View.Refresh();\n                RaisePropertyChanged(\"SelectedValue\");\n            }\n        }\n</code></pre>\n"},{"tags":["c#","wpf","file","process","delete"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13262548,"title":"Delete a file being used by another process","body":"<p>I'm trying to programmically delete a file, but the file is apparently being used by another process (which happens to be my program). Basically, the program loads images from a folder by using FromUri to create a Bitmap, which is then loaded into an Image array, which in turn becomes the child of a stackpanel. Not very efficient, but it works.</p>\n\n<p>I've tried clearing the stackpanel's children, and making the images in the array null, but I'm still getting the IOException telling me that the file is being used by another process.</p>\n\n<p>Is there some other way to remove the file from my application's processes?</p>\n"},{"tags":["wpf","xaml","datagrid","matrix","junction-table"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13265162,"title":"How to show junction table in a matrix with WPF?","body":"<p>I have two enums:</p>\n\n<pre><code>public enum MyEnumA\n{\n    OptionA1 = 1,\n    OptionA2 = 2,\n    OptionA3 = 3,\n}\n\npublic enum MyEnumB\n{\n    OptionB1 = 1,\n    OptionB2 = 2,\n    OptionB3 = 3,\n}\n</code></pre>\n\n<p>and a class containing both enums</p>\n\n<pre><code>public class AB\n{\n    public MyEnumA A { get; set; }\n    public MyEnumB B { get; set; }\n}\n</code></pre>\n\n<p>I want to have a matrix of checkboxes of both enums. The data is read from and saved to a List. This list is the actual junction table. For the time being I filled the list by hand:</p>\n\n<pre><code>    private List&lt;AB&gt; ABList = new List&lt;AB&gt;();\n\n    ABList.Add(new AB { A = MyEnumA.OptionA2, B = MyEnumB.OptionB1 });\n    ABList.Add(new AB { A = MyEnumA.OptionA3, B = MyEnumB.OptionB3 });\n</code></pre>\n\n<p>The matrix now should look like this:</p>\n\n<pre><code>            OptionA1 OptionA2 OptionA3\nOptionB1                 X\nOptionB2\nOptionB3                          X\n</code></pre>\n\n<p>I have found a WinForm solution where everything is done in code-behind: <a href=\"http://social.msdn.microsoft.com/Forums/eu/winformsdatacontrols/thread/33fae605-902a-40e3-9bbb-60b77fc33b9b\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/eu/winformsdatacontrols/thread/33fae605-902a-40e3-9bbb-60b77fc33b9b</a> But can't it be done in xaml with data binding?</p>\n"},{"tags":["sql","wpf","textbox","intellisense"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13263046,"title":"SQL Intellisense in WPF Textbox","body":"<p>I am building an application which contains Textbox. I want the Textbox to act just like SQl Server Editor with intellisense. I need help, can i make my Textbox act like a Sql Server Query Editor WITH Intellisense.</p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263917,"title":"WPF Binding how to get object reference","body":"<p>I have a ListView showing a list of Accounts using MVVM &amp; a custom template and working fine\nNow on clicking the Acct Name, we need to execute a custom action which requires the current Acct object</p>\n\n<p>Is there a way to set the Label.Tag property to the Acct object ?</p>\n\n<p>the xaml def is below\nenv is vs2010 .net 4.0 c#</p>\n\n<pre><code>&lt;ListView Name=\"lv1\" Grid.Column=\"1\" Grid.Row=\"4\"\n    ItemsSource=\"{Binding AccountsList}\"\n    Background=\"Transparent\" BorderThickness=\"0\"&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Source=\"/asm1;component/Images/Icons/pdf1.png\" Width=\"12\" Height=\"12\" /&gt;\n                &lt;Label Content=\"{Binding Name}\" Margin=\"0,0,25,0\" \n                    ContextMenu=\"{x:Null}\" Name=\"lblacctItem\" \n                    MouseDoubleClick=\"lbl_MouseDoubleClick\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n    &lt;ListView.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;WrapPanel Background=\"Transparent\" \n                Width=\"{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource AncestorType=ScrollContentPresenter}}\" \n                ItemWidth=\"{Binding (ListView.View).ItemWidth, RelativeSource={RelativeSource AncestorType=ListView}}\" \n                MinWidth=\"{Binding ItemWidth, RelativeSource={RelativeSource Self}}\" \n                ItemHeight=\"{Binding (ListView.View).ItemHeight, RelativeSource={RelativeSource AncestorType=ListView}}\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListView.ItemsPanel&gt;\n&lt;/ListView&gt;\n</code></pre>\n"},{"tags":["wpf","validation","xaml","mvvm","idataerrorinfo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13263386,"title":"xaml validation error rad line and error tooltip not disply using IDataErrorInfo?","body":"<p>In my project, for the validation i have used IDataErrorInfor and in xaml code i have mentioned NotifyfyOvalidationError= true for textbox.</p>\n\n<p>All validations are performed correctly but only thing is that  in my view it not diplaying the error template as red line across TextBox and tooltip which i want to show as to observe that this TextBox Contains Error..</p>\n\n<p>Same thind is works correctly for all other TextBoxs and anoother thing is that Validation for this TextBox is works form viewmodel whatever i have set in my code..</p>\n\n<p>Xaml : </p>\n\n<pre><code> &lt;TextBox  Margin=\"0,7\"  Text=\"{Binding Path=Address.AddressLines, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=true, NotifyOnValidationError=true}\" Width=\"200\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Stretch\" AcceptsReturn=\"True\" VerticalScrollBarVisibility=\"Auto\" ToolTip=\"{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors)[0].ErrorContent}\"  /&gt; \n</code></pre>\n\n<p>View Model :     </p>\n\n<h1>region IDataErrorInfo Members</h1>\n\n<pre><code>string IDataErrorInfo.Error { get { return null; } }\n\nstring IDataErrorInfo.this[string propertyName]\n{\n    get { return this.GetValidationError(propertyName); }\n}\n\n#endregion // IDataErrorInfo Members\n\n#region Validation\n\n/// &lt;summary&gt;\n/// Returns true if this object has no validation errors.\n/// &lt;/summary&gt;\npublic bool IsValid\n{\n    get\n    {\n        foreach (string property in ValidatedProperties)\n            if (GetValidationError(property) != null)\n                return false;\n\n        return true;\n    }\n}\n\nstatic readonly string[] ValidatedProperties = \n{ \n      \"Address\",\n};\nstring GetValidationError(string propertyName)\n{\n    if (Array.IndexOf(ValidatedProperties, propertyName) &lt; 0)\n        return null;\n\n    string error = null;\n\n    switch (propertyName)\n    {\n\n        case \"Address\":\n            error = this.ValidateAddressLine();\n            break;\n\n        default:\n            Debug.Fail(\"Unexpected property being validated on School: \" + propertyName);\n            break;\n    }\n\n    return error;\n}\nstring ValidateAddressLine()\n{\n    if (IsStringMissing(this.Address.AddressLines))\n    {\n        return \"Enter Address.\";\n    }\n    return null;\n}\n\nstatic bool IsStringMissing(string value)\n{\n    return\n        String.IsNullOrEmpty(value) ||\n        value.Trim() == String.Empty;\n}\n#endregion // Validation\n</code></pre>\n\n<p>Any one find solution of my problem..</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13262037,"title":"Is it possible to dynamically create a ResourceKey for a StaticResource? (eg using a Binding)","body":"<p>Suppose the object I'm binding to has a property with a string representing the ResourceKey - how do I get a StaticResource to dynamically acquire it's ResourceKey based on a binding to the underlying object?</p>\n\n<p>I want something equivalent to this </p>\n\n<pre><code>MyProperty=\"{StaticResource ResourceKey={Binding Path=MyProperty}}\"\n</code></pre>\n\n<p>While this compiles, it will fail complaining it can't find a key of type System.Windows.Data.Binding</p>\n\n<p>I don't need dynamic re-evaluation if the underlying value changes (eg DynamicResource)</p>\n"},{"tags":["wpf","datagrid","content-styling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13250753,"title":"WPF Style issue in WPF Datagrid","body":"<p>I have a WPF datagrid and i have bound it with an observablecollection. It is working fine but the issue is that I have apply the styles at cell level at runtime. There is a sample method ApplyStyleAtCellLevelInDataGrid() which is mentioned below. I have to call this method two times to show the effect of styles in WPF DataGrid. Why is it so...</p>\n\n<p>Here is XAML</p>\n\n<pre><code> &lt;Style x:Key=\"BaseStyle\"  TargetType=\"{x:Type TextBlock}\"&gt;\n     &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n     &lt;Setter Property=\"Foreground\" Value=\"Black\"/&gt;        \n     &lt;Setter Property=\"FontSize\" Value=\"10\"/&gt;\n     &lt;Setter Property=\"TextAlignment\" Value=\"Center\"/&gt;\n &lt;/Style&gt;\n\n&lt;Style TargetType=\"{x:Type TextBlock}\" x:Key=\"Col1Style\" BasedOn=\"{StaticResource BaseStyle}\"&gt;\n\n        &lt;Setter Property=\"Background\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;SolidColorBrush Color=\"Tomato\"/&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;            \n\n        &lt;Style.Triggers&gt;\n            &lt;EventTrigger RoutedEvent=\"Binding.TargetUpdated\"&gt;\n                &lt;BeginStoryboard HandoffBehavior=\"Compose\"&gt;\n                    &lt;Storyboard TargetProperty=\"(TextBlock.Background).(SolidColorBrush.Color)\"&gt;\n                    &lt;ColorAnimation Duration=\"0:0:1.5\" To=\"DarkRed\"  AutoReverse=\"True\" RepeatBehavior=\"1\" /&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/BeginStoryboard&gt;\n            &lt;/EventTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>&lt; Style x:Key=\"DGCellStyle\" TargetType=\"{x:Type DataGridCell}\"></p>\n\n<pre><code>        &lt;Setter Property=\"BorderThickness\" Value=\"0\" /&gt;\n        &lt;Setter Property=\"FontSize\" Value=\"10\"&gt;&lt;/Setter&gt;\n        &lt;Setter Property=\"Foreground\" Value=\"Black\"&gt;&lt;/Setter&gt;           \n    &lt;/Style&gt;\n</code></pre>\n\n<p>Grid Declaration in XAML</p>\n\n<pre><code>&lt;DataGrid Name=\"dataGrid1\"  ItemsSource=\"{Binding Values}\" CellStyle=\"{StaticResource DGCellStyle}\" SnapsToDevicePixels=\"True\" UseLayoutRounding=\"False\"&gt;\n\n  &lt;DataGrid.Columns&gt;\n      &lt;DataGridTextColumn  Header=\"Value\" Binding=\"{Binding Value1, Mode=OneWay, NotifyOnTargetUpdated=True}\" Width=\"0.25*\"/&gt;\n      &lt;DataGridTextColumn Header=\"Value 1\" Binding=\"{Binding Value2, Mode=OneWay, NotifyOnTargetUpdated=True}\" Width=\"0.25*\"/&gt;\n      &lt;DataGridTextColumn Header=\"Value 2\" Binding=\"{Binding Value3, Mode=OneWay, NotifyOnTargetUpdated=True}\" Width=\"0.25*\"/&gt;\n      &lt;DataGridTextColumn Header=\"Value 3\" Binding=\"{Binding Value4, Mode=OneWay, NotifyOnTargetUpdated=True}\" Width=\"0.25*\"/&gt;\n   &lt;/DataGrid.Columns&gt;           \n &lt;/DataGrid&gt;\n</code></pre>\n\n<p>Code</p>\n\n<pre><code> private void ApplyStyleAtCellLevelInDataGrid()\n\n    {\n        if (Values == null || Values.Count == 0)\n        {\n            Values = new ObservableCollection&lt;MyClass&gt;();\n            Values.Add(new MyClass { Value1 = \"1\", Value4 = \"2\", Value2 = \"4\", Value3 = \"3\" });\n            Values.Add(new MyClass { Value1 = \"2\", Value4 = \"3\", Value2 = \"5\", Value3 = \"7\" });\n            Values.Add(new MyClass { Value1 = \"3\", Value4 = \"4\", Value2 = \"7\", Value3 = \"2\" });\n            Values.Add(new MyClass { Value1 = \"4\", Value4 = \"4\", Value2 = \"8\", Value3 = \"6\" });\n        }\n        else\n        {\n            foreach (var item in Values)\n            {\n                MyClass c = item as MyClass;\n                c.Value1 = _rand.Next(0, 100).ToString();         \n                c.Value2 = _rand.Next(0, 100).ToString();\n                c.Value3 = _rand.Next(0, 100).ToString();\n                c.Value4 = _rand.Next(0, 100).ToString();\n            }\n        }\n\n        //////////////\n\n        DataGridCell cell = GetCell(1, 1);\n\n        Style defaultStyle = (Style)FindResource(\"NewStyle\");\n        ((TextBlock)cell.Content).Style = defaultStyle;\n\n        cell = GetCell(1, 2);\n        defaultStyle = (Style)FindResource(\"NewStyleExtended\");\n        ((TextBlock)cell.Content).Style = defaultStyle;\n\n        cell = GetCell(2, 2);\n        defaultStyle = (Style)FindResource(\"NewStyle\");\n        ((TextBlock)cell.Content).Style = defaultStyle;\n\n        cell = GetCell(2, 3);\n        defaultStyle = (Style)FindResource(\"Col1Style\");\n        ((TextBlock)cell.Content).Style = defaultStyle;\n    }\n\n\n private void Window_Loaded(object sender, RoutedEventArgs e)\n    {         \n// Single call of this method does not work,\n\nI have to call two times then it shows the effect\n\n        ApplyStyleAtCellLevelInDataGrid(); \n        ApplyStyleAtCellLevelInDataGrid();\n    }\n</code></pre>\n"},{"tags":["c#","wpf","export-to-excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13232408,"title":"How to export from sql to a formatted excel","body":"<p>I have a C# WPF application which interacts with SQL Server Database. In application I want user be able to export some kind of data from SQL to Excel. I'm trying firstly to fill a Datatable and then export it to excel file. Everything was fine, untill I faced up with a task to export a datatable filled with this sql query:<img src=\"http://i.stack.imgur.com/1zyeO.jpg\" alt=\"enter image description here\"></p>\n\n<p>to a formatted excel file like this:\n<img src=\"http://i.stack.imgur.com/CxKka.jpg\" alt=\"report\"></p>\n\n<p>So how can I sort selldetails of every sell in one region in excel file?\nIt's been a long time I'm puzzling my mind over this problem, please, help me!</p>\n"},{"tags":["c#","wpf","data-binding","binding","datagrid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13251456,"title":"Binding datagrid","body":"<p>I've been trying to bind DataGridTextColumns column-wise to arrays (int[] I think) and have been unsuccessful. Nothing I've found on msdn, stackoverflow etc has been particularly helpful .</p>\n\n<pre><code>&lt;DataGrid AutoGenerateColumns=\"False\" VerticalAlignment=\"Top\" Margin=\"0,47,0,0\" Height=\"351\" Name=\"dataGrid1\" IsReadOnly=\"True\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Slave Address\" Width=\"100\" Binding=\"{Binding SlaveAddressValues}\"/&gt;\n                &lt;DataGridTextColumn Header=\"Meter Readings\" Width=\"100\" Binding=\"{Binding MeterReadingValues}\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n</code></pre>\n\n<p>I've tried a number of things including putting binding in with datagrid instead or as well as datagridtextcolumns (itemsource etc), defining datacontext in code (I'd like to keep as much as possible out of code for mvvm reasons), using paths and sources, and also trying to combine my two arrays in a class (which isn't really what I want anyway). However nothing has worked in getting even the following simple test case to properly bind with the datagrid.</p>\n\n<pre><code>private int[] SlaveAddressValues = { 0, 0, 0, 0 };\nprivate int[] MeterAddressValues = { 2, 2, 2, 3 };\n</code></pre>\n\n<p>Anyone got any ideas?</p>\n\n<p>Right, maybe I should have put my solution here but it was a bit long so I put it as an answer. it's one of many ways anyway so post another answer if you feel so inclined.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13262226,"title":"Mouse activity slowing down WPF graphics demo","body":"<p>Below is a small graphics demo in WPF. It looks something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Cq3h2.png\" alt=\"enter image description here\"></p>\n\n<p>When it's running, if I move the mouse around the main area of the window, the animation slows down (at least on my system). If I move the mouse pointer out of the window entirely, the animation come back up to speed.</p>\n\n<p>Any suggestions for how to prevent the mouse movement interfering with the animation speed?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Threading;\nusing System.Windows.Threading;\n\nnamespace WPF_Golden_Section\n{\n    class DrawingVisualElement : FrameworkElement\n    {\n        public DrawingVisual visual;\n\n        public DrawingVisualElement() { visual = new DrawingVisual(); }\n\n        protected override int VisualChildrenCount { get { return 1; } }\n\n        protected override Visual GetVisualChild(int index) { return visual; }\n    }\n\n    public static class CanvasUtils\n    {\n        public static Canvas SetCoordinateSystem(this Canvas canvas, Double xMin, Double xMax, Double yMin, Double yMax)\n        {\n            var width = xMax - xMin;\n            var height = yMax - yMin;\n\n            var translateX = -xMin;\n            var translateY = height + yMin;\n\n            var group = new TransformGroup();\n\n            group.Children.Add(new TranslateTransform(translateX, -translateY));\n            group.Children.Add(new ScaleTransform(canvas.ActualWidth / width, canvas.ActualHeight / -height));\n\n            canvas.RenderTransform = group;\n\n            return canvas;\n        }\n    }\n\n    public static class ColorUtils\n    {\n        public static Color Write(this Color color)\n        {\n            Console.Write(\"Color[{0} {1} {2} {3}]\", color.A, color.R, color.G, color.B);\n\n            return color;\n        }\n\n        static byte ColorComponentToByte(double n)\n        {\n            return \n                (byte)\n                    Math.Round(Math.Min(Math.Max(n, 0), 1) * 255);\n        }\n\n        public static Color Rgb(double r, double g, double b)\n        {\n            return\n                Color.FromRgb(\n                    ColorComponentToByte(r),\n                    ColorComponentToByte(g),\n                    ColorComponentToByte(b));\n        }\n\n        public static Color SetArgb(this Color color, double a, double r, double g, double b)\n        {\n            color.A = ColorComponentToByte(a);\n            color.R = ColorComponentToByte(r);\n            color.G = ColorComponentToByte(g);\n            color.B = ColorComponentToByte(b);\n\n            return color;\n        }\n    }\n\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            Width = 600;\n            Height = 600;\n\n            var dockPanel = new DockPanel();\n\n            Content = dockPanel;\n\n            var slider =\n                new Slider()\n                {\n                    Minimum = 0.1,\n                    Maximum = 10,\n                    LargeChange = 0.001,\n                    Value = 1\n                };\n\n            dockPanel.Children.Add(slider);\n\n            DockPanel.SetDock(slider, Dock.Top);\n\n            var incrementSlider =\n                new Slider()\n                {\n                    Maximum = 0.001,\n                    Minimum = 0.00001,\n                    Value = 0.0001\n                };\n\n            dockPanel.Children.Add(incrementSlider);\n\n\n            DockPanel.SetDock(incrementSlider, Dock.Top);\n\n            var pauseButton = new Button() { Content = \"Pause\" };\n\n            dockPanel.Children.Add(pauseButton);\n\n            DockPanel.SetDock(pauseButton, Dock.Top);\n\n            var canvas = new Canvas();\n\n            dockPanel.Children.Add(canvas);\n\n            DockPanel.SetDock(canvas, Dock.Top);\n\n            SizeChanged += (s, e) =&gt; canvas.SetCoordinateSystem(-400, 400, -400, 400);\n\n            var element = new DrawingVisualElement();\n\n            Action draw = () =&gt;\n                {\n                    canvas.Children.Clear();\n\n                    // var element = new DrawingVisualElement();\n\n                    using (var dc = element.visual.RenderOpen())\n                    {\n                        for (var i = 0.0; i &lt; 720.0; i += slider.Value)\n                        {\n                            var radius = Math.Sin(i / 720.0 * Math.PI) * 30;\n\n                            var phi = (1 + Math.Sqrt(5)) / 2;\n\n                            var omega = 2 * Math.PI * (phi - 1) * i;\n\n                            var x = Math.Cos(omega) * 0.5 * i;\n                            var y = Math.Sin(omega) * 0.5 * i;\n\n                            dc.DrawEllipse(\n                                new SolidColorBrush(ColorUtils.Rgb(i / 360.0, i / 360.0, 0.25)),\n                                new Pen(Brushes.Black, Math.Max(radius / 6, 1)),\n                                new Point(x, y),\n                                radius / 2,\n                                radius / 2);\n                        }\n                    }\n\n                    canvas.Children.Add(element);\n                };\n\n            slider.ValueChanged += (s, e) =&gt;\n            {\n                Title = slider.Value.ToString() + \"     \" + incrementSlider.Value;\n                draw();\n            };\n\n            var timer = new DispatcherTimer();\n\n            timer.Tick += (s, e) =&gt;\n                {\n                    if (slider.Value &lt; 10.0)\n                        slider.Value += incrementSlider.Value;\n                };\n\n            timer.Start();\n\n            pauseButton.Click += (s, e) =&gt;\n                {\n                    if (timer.IsEnabled)\n                        timer.Stop();\n                    else\n                        timer.Start();\n                };\n\n            slider.Value = 3.5;\n            incrementSlider.Value = 0.00001;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","wpf-controls","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261815,"title":"Extracting raw RTF from a RichTextBox","body":"<p>There's got to be a better way to do this than what I'm doing.</p>\n\n<p>I'm trying to extract the raw RTF from a WPF RichTextBox.  Well, really I'm trying to take a bunch of my custom classes and turn it into an RTF string, but I'm using a RichTextBox to do it because I don't particularly want to write my own RTF library.</p>\n\n<p>The method I'm using (modified from something first seen <a href=\"http://stackoverflow.com/questions/3003984/how-to-set-rtf-from-winforms-to-wpf-richtextbox\" title=\"here\">here</a> and used to extract XML <a href=\"http://stackoverflow.com/questions/601838/get-rtf-from-richtextbox\">here</a>) is as follows:</p>\n\n<pre><code>RTB.Selection.Save(memstream, DataFormats.Rtf);\nmemstream.Seek(0, SeekOrigin.Begin);\nvar sr = new StreamReader(memstream);\nvar myText = sr.ReadToEnd();\n</code></pre>\n\n<p>This works, but seems ridiculously clumsy.  And I'm worried about the performance implications on large amounts of text.  Is there a better way?  (For the purpose of this question, let's assume that I can't use the WinForms RichTextBox.)</p>\n"},{"tags":["c#","wpf","firefox","browser","gecko"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1785,"score":5,"question_id":7552144,"title":"Embed Firefox/Gecko in WPF/C#","body":"<p>i want to embed the current Gecko in my WPF-Project.\ni know there is the possibility with the Winforms-Host and the Skybound-Gecko-Libary.</p>\n\n<p>But i use not the standard wpf-theme für my application. its another and the scrollbar of the control will not be styled. furthermore this is an old libary which is designed for firefox 3.</p>\n\n<p>which is the best libary/strategy to use the current gecko in wpf?\nthanks for your help</p>\n"},{"tags":["wpf","mvvm","caliburn.micro"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":13214705,"title":"Caliburn micro and tabcontrol","body":"<p>I have looked at most resources but i can find a good solution. I have a tab control HARD coded.</p>\n\n<pre><code>&lt;TabControl TabStripPlacement=\"Left\" Padding=\"0\" Style=\"{DynamicResource SettingsTab}\" ItemContainerStyle=\"{DynamicResource SettingsTabItemStyle}\" Background=\"WhiteSmoke\" &gt;\n                &lt;TabItem Header=\"ΓΕΝΙΚΑ\" Margin=\"0\" IsEnabled=\"False\" &gt; &lt;Grid /&gt;&lt;/TabItem&gt;                              \n                &lt;TabItem Header=\"Προσωπικό\" Margin=\"0\" IsSelected=\"True\"&gt;\n                    &lt;Grid MinHeight=\"400\"&gt;                     \n\n                        &lt;ContentControl HorizontalAlignment=\"Stretch\" Margin=\"50,67,50,0\"  Name=\"ActiveItem\" /&gt;\n                    &lt;/Grid&gt;\n                &lt;/TabItem&gt;\n                &lt;TabItem Header=\"Τραπέζια\" Margin=\"0\"&gt;\n                    &lt;Grid /&gt;\n                &lt;/TabItem&gt;\n</code></pre>\n\n<p><strong>UPDATE -  Restate problem</strong><br>\nHere is my customized tab control. The gray text is a disabled tab item it acts like a group. Like General settings, System settings etc. So it  has a role as a navigation menu. Curently i have a content control at each tabitem (not the disabled ones) and bind the view model i want.<br>\nBut i cant use Conductor.Collection.OneActive with CM.<br>\nWhy?<br>\nI have seen helloscreens example from CM sample and other samples but the problem here is that if i do this via binding then there is no way to display the disabled tabitems other than creating a dummy view model that serves no purpose.So how can i achieve this ? </p>\n\n<p><img src=\"http://i.stack.imgur.com/S00j6.png\" alt=\"ad\"></p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13259816,"title":"Editable combobox with valid selection","body":"<p>I have a editable combobox in WPF (IsEditable=True). I would also like to ensure that the values which the user enters are in the list only. I don't want user to add their own values to the combo. I cannot make IsReadonly=true as that will not allow users to type. So is validation the only option in SelectionChange event? or is there a better way to do the same?</p>\n\n<p>Thanks\nShankara Narayanan.</p>\n"},{"tags":["wpf","popup","screen","position","xbap"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":3419,"score":3,"question_id":978186,"title":"Binding a Popup to another control's relative screen position","body":"<p>I'm writing an XBAP with a complex Popup (Canvas Z-index of 99 with a grid on it...) that I would like to \"attach\" to the button that opens it and follow that button around wherever it goes on the screen. For example, if the button is in a ListBox or an XamDataGrid I would like the popup to follow the button as it scrolls through. If it is beneath an Expander I want it to stay attached to the button when the expander forces it to move, etc.  </p>\n\n<p>Any Ideas?</p>\n"},{"tags":["wpf","popup","binding"],"answer_count":6,"favorite_count":11,"up_vote_count":10,"down_vote_count":0,"view_count":14987,"score":10,"question_id":1600218,"title":"How can I move a WPF Popup when its anchor element moves?","body":"<p>I have a Popup defined like this:</p>\n\n<pre><code>&lt;Popup\n    Name=\"myPopup\"\n    StaysOpen=\"True\"\n    Placement=\"Bottom\"\n    PlacementRectangle=\"0,20,0,20\"\n    PlacementTarget=\"{Binding ElementName=myPopupAnchor}\"&gt;\n    &lt;TextBlock ... /&gt;\n&lt;/Popup&gt;\n</code></pre>\n\n<p>I have added event handlers to the <code>myPopupAnchor</code> element for the events <code>MouseEnter</code> and <code>MouseLeave</code>. The two event handlers toggle the popup's visibility. </p>\n\n<p>My problem is the position of myPopupAnchor is only read when the popup is first shown, or hidden and then shown again. If the anchor moves, the popup does not.</p>\n\n<p>I'm looking for ways to work around this, I want a moving Popup. Can I notify WPF that the <code>PlacementTarget</code> binding has changed and should be read again? Can I manually set the popup's position?</p>\n\n<p>Currently, I have a very crude workaround that involves closing and then opening the popup again, which causes some repainting issues.</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13256076,"title":"How would I convert a set of Styles to DataTemplates for an enum type?","body":"<p>Currently we have an enum type where each unique value is being represented by a unique style:</p>\n\n<pre><code>&lt;Style x:Key=\"EnumValue1\" TargetType=\"CheckBox\"&gt;\n&lt;Setter Property=\"FontSize\" Value=\"11\" /&gt;\n&lt;Setter Property=\"Margin\" Value=\"0 0 1 0\" /&gt;\n&lt;Setter Property=\"VerticalAlignment\" Value=\"Top\" /&gt;\n&lt;Setter Property=\"Height\" Value=\"18\" /&gt;\n&lt;!-- ... common property setters etc. --&gt;\n\n&lt;Setter Property=\"Template\"&gt;\n    &lt;Setter.Value&gt;\n        &lt;ControlTemplate TargetType=\"CheckBox\"&gt;\n            &lt;Border&gt;\n                &lt;StackPanel&gt;\n                    &lt;!-- custom enum value-specific control content --&gt;\n                    &lt;ContentPresenter Content=\"{TemplateBinding Content}\" /&gt;\n                &lt;/StackPanel&gt;\n            &lt;/Border&gt;\n            &lt;ControlTemplate.Triggers&gt;\n                &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                    &lt;Trigger.Setters&gt;\n                        &lt;Setter Property=\"Foreground\" Value=\"WhiteSmoke\" /&gt;\n                    &lt;/Trigger.Setters&gt;\n                &lt;/Trigger&gt;\n                   &lt;!-- ... custom triggers etc ... --&gt;\n            &lt;/ControlTemplate.Triggers&gt;\n        &lt;/ControlTemplate&gt;\n    &lt;/Setter.Value&gt;\n&lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Currently the Checkboxes are being created programmatically in code-behind - I'm changing this to a ListBox bound to a collection of these enum values and I think it makes sense to convert these to a DataTemplate instead - question is, how do I maximize re-use?</p>\n\n<p>I have roughly 10 unique values and 10 unique styles ...9/10 of the styles use the same Setters, the ControlTemplate.Triggers are the same for all 10 but obviously the visual tree in the ControlTemplate is different</p>\n\n<p>I thought about using a base Style class and having each specific-variant derive / override it with another Style and use a StyleSelector, but then how would I vary the ControlTemplate visual tree per style without having to re-define the triggers? </p>\n\n<p>But this seems 'philosophically' wrong ...I feel like I should be using DataTemplates, because this is by definition what they're meant to be use for</p>\n"},{"tags":["c#","wpf","codebehind","attached-properties"],"answer_count":3,"favorite_count":5,"up_vote_count":26,"down_vote_count":0,"view_count":12185,"score":26,"question_id":541420,"title":"How to I access an attached property in code behind?","body":"<p>I have a rectangle in my XAML and want to change its <code>Canvas.Left</code> property in code behind:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl x:Class=\"Second90.Page\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n    Width=\"400\" Height=\"300\" KeyDown=\"txt_KeyDown\"&gt;\n    &lt;Canvas&gt;\n        &lt;Rectangle \n            Name=\"theObject\" \n            Canvas.Top=\"20\" \n            Canvas.Left=\"20\" \n            Width=\"10\" \n            Height=\"10\" \n            Fill=\"Gray\"/&gt;\n    &lt;/Canvas&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>But this doesn't work:</p>\n\n<pre><code>private void txt_KeyDown(object sender, KeyEventArgs e)\n{\n    theObject.Canvas.Left = 50;\n}\n</code></pre>\n\n<p>Does anyone know what the syntax is to do this?</p>\n"},{"tags":["wpf","wcf","timeout","client","godaddy"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":13112653,"title":"(SOLVED) WCF 4.0 Service Hangs after First Call + 15 seconds Hosted on GoDaddy","body":"<p>I am trying to deploy a WCF 4.0 service at Godaddy and having trouble. Everything works fine on my local machine but when deployed I get an odd hang after the first call + 15 seconds that I can't figure out.</p>\n\n<p>At first I thought it was my Client as the Server's trace wasn't showing any faults. Then I found someone else's service with basicHttpBinding hosted online @ <a href=\"http://www.dimmiunapassword.com/wcf/PwdService.svc\" rel=\"nofollow\">http://www.dimmiunapassword.com/wcf/PwdService.svc</a> that works fine. I can make a request, wait 20 seconds, make another and its successful.</p>\n\n<p>I thought it may be a problem with something I am doing in my service then, so I created a new basic service that returns a modified string... it's actually the New Project Template with nothing changed. That way I knew it was nothing with my more complex service returning larger amounts of data (although it works fine on my localhost). Unfortunately I'm having the same issue. I can make the first call fine and subsequent calls within 15 seconds go through fine, but if I wait 20 seconds- the Client will Timeout on the 1 minute default mark.</p>\n\n<p>After the Client times out, I can recall the service and the call goes through fine but exhibits the same 15 second behavior. If I wait long enough after the first call, say 10 minutes, another call will go through fine as well, almost like a Timeout is being triggered on the server and then resets to work again. On the flip-side, if the Client times out at the 1 minute default, it's almost like that resets the server as well.</p>\n\n<p>I've tried closing the service after each call. I've tried wrapping the channel and closing/disposing. I've tried a Using statement to close. Nothing worked. I think I've tried nearly every configuration for Concurrency, Instancing, Throttling, Sessioning, Timeouts, and Size limits with no luck. I've also traced the client and server, the client shows a timeout fault and the server shows nothing but the last successful request. The only thing I can notice is the \"Thread ID\" in the Clients trace changes and every time, it fails throwing a Timeout fault @ 1 minute (default). I can request 10+ calls within 15 seconds of the first call and they all process on the same \"Thread ID\" in the trace... as soon as it hits 15 seconds, the Thread ID changes and that's when the Client just hangs until the Timeout.</p>\n\n<p>I am stumped. I've been having this problem for about two weeks and I'm out of idea's. I'm not sure what I am doing wrong or if this is a IIS/GoDaddy problem?</p>\n\n<h2>The Service Hosted in IIS/Godaddy</h2>\n\n<p>Here is the <strong>IService1.vb</strong>:</p>\n\n<pre><code>&lt;ServiceContract()&gt;\nPublic Interface IService1\n\n    &lt;OperationContract()&gt;\n    Function GetData(ByVal value As Integer) As String\n\n    &lt;OperationContract()&gt;\n    Function GetDataUsingDataContract(ByVal composite As CompositeType) As CompositeType\n\nEnd Interface\n\n\n&lt;DataContract()&gt;\nPublic Class CompositeType\n\n    &lt;DataMember()&gt;\n    Public Property BoolValue() As Boolean\n\n    &lt;DataMember()&gt;\n    Public Property StringValue() As String\n\nEnd Class\n</code></pre>\n\n<p>Here is the <strong>Service1.svc.vb</strong>:</p>\n\n<pre><code>&lt;ServiceBehavior()&gt;\nPublic Class Service1\nImplements IService1\n\nPublic Sub New()\nEnd Sub\n\nPublic Function GetData(ByVal value As Integer) As String Implements IService1.GetData\n    Return String.Format(\"You entered: {0}\", value)\nEnd Function\n\nPublic Function GetDataUsingDataContract(ByVal composite As CompositeType) As CompositeType Implements IService1.GetDataUsingDataContract\n    If composite Is Nothing Then\n        Throw New ArgumentNullException(\"composite\")\n    End If\n    If composite.BoolValue Then\n        composite.StringValue &amp;= \"Suffix\"\n    End If\n    Return composite\n\nEnd Function\n\nEnd Class\n</code></pre>\n\n<p>Here is the <strong>Web.config</strong>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n\n  &lt;system.web&gt;\n    &lt;compilation debug=\"true\" strict=\"false\" explicit=\"true\" targetFramework=\"4.0\" /&gt;\n  &lt;/system.web&gt;\n\n  &lt;system.serviceModel&gt;\n\n    &lt;services&gt;\n      &lt;service name=\"wcfTestHost.Service1\"&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress=\"http://www.website.com/wcf/Service1.svc\"&gt;&lt;/add&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n\n        &lt;endpoint binding=\"basicHttpBinding\" contract=\"wcfTestHost.IService1\"&gt;\n\n        &lt;/endpoint&gt;\n\n        &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\"/&gt;\n\n      &lt;/service&gt;  \n    &lt;/services&gt;\n\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior&gt;\n          &lt;!-- To avoid disclosing metadata information, set the value below to false before deployment --&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n          &lt;!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information --&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"false\"/&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n\n    &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n\n  &lt;/system.serviceModel&gt;\n\n\n  &lt;system.webServer&gt;\n    &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n    &lt;!--\n        To browse web app root directory during debugging, set the value below to true.\n        Set to false before deployment to avoid disclosing web app folder information.\n      --&gt;\n    &lt;directoryBrowse enabled=\"true\"/&gt;\n  &lt;/system.webServer&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<h2><strong>As for the WPF Client test App</strong></h2>\n\n<p>Here is the <strong>app.config</strong>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;system.diagnostics&gt;\n        &lt;sources&gt;\n            &lt;source name=\"DefaultSource\" switchName=\"DefaultSwitch\"&gt;\n                &lt;listeners&gt;\n                    &lt;add name=\"FileLog\"/&gt;\n                &lt;/listeners&gt;\n            &lt;/source&gt;\n        &lt;/sources&gt;\n        &lt;switches&gt;\n            &lt;add name=\"DefaultSwitch\" value=\"Information\" /&gt;\n        &lt;/switches&gt;\n        &lt;sharedListeners&gt;\n            &lt;add name=\"FileLog\"\n                 type=\"Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL\"\n                 initializeData=\"FileLogWriter\"/&gt;\n        &lt;/sharedListeners&gt;\n    &lt;/system.diagnostics&gt;\n    &lt;system.serviceModel&gt;\n        &lt;bindings&gt;\n            &lt;basicHttpBinding&gt;\n                &lt;binding name=\"BasicHttpBinding_IService1\" /&gt;\n            &lt;/basicHttpBinding&gt;\n        &lt;/bindings&gt;\n        &lt;client&gt;\n            &lt;endpoint address=\"http://www.website.com/wcf/Service1.svc\"\n                binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_IService1\"\n                contract=\"TestService.IService1\" name=\"BasicHttpBinding_IService1\" /&gt;\n        &lt;/client&gt;\n    &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Here is the <strong>MainWindow.xaml.vb</strong>:</p>\n\n<p><strong>Just add a Button thats linked up to the \"TestBtn_Click\"</strong></p>\n\n<p><strong>And throw a Label on your window called \"lblTime\".</strong></p>\n\n<pre><code>Class MainWindow \n\n    Dim cTimer As New Timers.Timer\n    Dim iTime As Integer = 0\n\n    Public Delegate Sub UpdateLabel(ByVal whatLabel As Label, ByVal sWhat As String)\n    Public Sub _UpdateLabel(ByVal whatLabel As Label, ByVal sWhat As String)\n        whatLabel.Content = sWhat\n    End Sub\n\n\n\n    Private Sub TestBtn_Click(sender As Object, e As RoutedEventArgs)\n        AddHandler cTimer.Elapsed, AddressOf cTimer_Elapsed\n        cTimer.Interval = 1000\n        cTimer.Start()\n        iTime = 0\n\n        Using lb As New TestService.Service1Client\n            Dim st As String = lb.GetData(\"5\")\n            lb.Close()\n            MsgBox(st)\n        End Using\n\n        cTimer.Stop()\n\n        iTime = 0\n        cTimer.Start()\n    End Sub\n\n\n    Public Sub cTimer_Elapsed()\n        iTime += 1\n\n        lblTime.Dispatcher.Invoke(New UpdateLabel(AddressOf _UpdateLabel), lblTime, \"Time: \" &amp; iTime)\n    End Sub\nEnd Class\n</code></pre>\n\n<p>I don't want to wait for the WCF Service to timeout, then make another call every time. I don't need sessions either. I would like the Service to either stay connected/open->send/receive or connect/send/receive/close without a timeout exception every other call outside 15 seconds of the first. I have to be doing something wrong and if not, has anyone else experienced this on Godaddy or any other hosting environment?</p>\n\n<p>I think I've included everything someone will need to help me out. If not, please let me know and I will add. I normally don't ask questions like this as I can usually debug myself but this has got me. Any help at all would be greatly appreciated! Thanks </p>\n\n<h1>Edit #1</h1>\n\n<p>I came across this url <a href=\"http://blogs.msdn.com/b/wenlong/archive/2010/02/11/why-does-wcf-become-slow-after-being-idle-for-15-seconds.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/wenlong/archive/2010/02/11/why-does-wcf-become-slow-after-being-idle-for-15-seconds.aspx</a> which I believe may be the problem/work-around. It talks about WCF becoming slow after the threads idle for 15 seconds but in my case it flat times out. In the Trace Logs I noticed the Thread ID changing after 15 seconds and that sounds exactly like this Threadpool issue though. I'm going to give this a try and see if it works tonight or tomorrow. I'll report back.</p>\n\n<h1>Edit #2</h1>\n\n<p>Edit #1 did not help so to further test\\debug, I managed to host the same WCF Service on a different Server/Domain than Godaddy and the WCF Service worked as it should. No problems at all. \nI'm in the process of trying to solve this through Godaddy now, it really seems like something on their end. I'll update the thread with anything new once I find out.</p>\n\n<h1>Edit #3</h1>\n\n<p>After about 2 weeks of trying to debug myself and another week waiting for GoDaddy to understand what my problem was <em>(I finally directed them to this StackOverflow page)</em>, the WCF Service is finally working correctly. Turns out, it was something with GoDaddy's server. I'm not exactly sure what was causing the issue but they migrated me to another server and whala, works perfect. Hopefully this saves someone time.</p>\n"},{"tags":["wpf","xaml","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13258936,"title":"Custom DependencyProperty with custom datatype","body":"<p>I want to create a custom DependencyProperty for a usercontrol</p>\n\n<pre><code> public Table Grids\n    {\n        get { return (Table)GetValue(GridsProperty); }\n        set { SetValue(GridsProperty, value); }\n    }\n\n    // Using a DependencyProperty as the backing store for Grids.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty GridsProperty =\n                DependencyProperty.Register(\"Grids\", typeof(Table), \n                typeof(MyViewer), new UIPropertyMetadata(10));\n</code></pre>\n\n<p>Here Table is a custom datatype used to store rows &amp; Columns. That will help me in using them like;</p>\n\n<pre><code>&lt;my:MyViewer \n    HorizontalAlignment=\"Left\" \n    Margin=\"66,54,0,0\" \n    x:Name=\"MyViewer1\" \n    VerticalAlignment=\"Top\" \n    Height=\"400\" \n    Width=\"400\"\n    Grids=\"10\"/&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;my:MyViewer \n    HorizontalAlignment=\"Left\" \n    Margin=\"66,54,0,0\" \n    x:Name=\"MyViewer1\" \n    VerticalAlignment=\"Top\" \n    Height=\"400\" \n    Width=\"400\"\n    Grids=\"10,20\"/&gt;\n</code></pre>\n\n<p>I tried to define the Table datatype as;</p>\n\n<pre><code>public class Table \n    {\n        public int Rows { get; set; }\n        public int Columns { get; set; }\n\n        public Table(int uniform)\n        {\n            Rows = uniform;\n            Columns = uniform;\n        }\n\n        public Table(int rows, int columns)\n        {\n            Rows = rows;\n            Columns = columns;\n        }\n    }\n</code></pre>\n\n<p>but it's not working; when i use Grids=\"10\" in XAML it breaks.\nCan anybody help me to achive this?</p>\n"},{"tags":["c#","wpf","xaml","multibinding","syncfusion"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13256286,"title":"WPF MultiBinding fails in Syncfusion TabItemExt header","body":"<p>I have a subclass of <code>TabItem</code> as follows, for which I'm trying to set the <code>Header</code> property. I've tried this with a <code>MultiBinding</code>:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n            &lt;Binding Path=\"BoundVariable1\" /&gt;\n            &lt;Binding Path=\"BoundVariable2\" /&gt;\n        &lt;/MultiBinding&gt;    \n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>But it fails as such:</p>\n\n<pre><code>System.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\nSystem.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\n</code></pre>\n\n<p>I'd always thought the <code>StringFormat</code> served the role of the converter, but perhaps not?</p>\n\n<p>Wrapping the fields together in some kind of container, like a <code>Label</code>, also doesn't seem to work:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Label&gt;\n            &lt;Label.Text&gt;\n                &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n                    &lt;Binding Path=\"BoundVariable1\" /&gt;\n                    &lt;Binding Path=\"BoundVariable2\" /&gt;\n                &lt;/MultiBinding&gt;    \n            &lt;/Label.Text&gt;\n        &lt;/Label&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>In this case, the <code>.ToString()</code> representation of the label (\"<code>System.Windows.Controls.Label</code>\") is shown as the header.</p>\n\n<p>Note that a single binding works just fine:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Binding Path=\"BoundVariable1\" /&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>If it matters, I'm using the Syncfusion <code>TabItemExt</code> as one of my superclasses in the inheritance hierarchy, but as that class doesn't override the <code>Header</code> property I don't think that makes a difference.</p>\n\n<p>What am I doing wrong? I know I can make another property in the ViewModel to act as the Header (and then single-bind that) but I want to learn how to do this properly in XAML.</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13260595,"title":"WPF shape geometry scaling without affecting stroke","body":"<p>I am wondering if someone has managed to override the default behaviour of the WPF shape rendering when applying a scaletransform to the shape. The default behaviour transforms the entire shape drawing, including strokes, but I would like to only scale the geometry. The difficulty is that my shapes reside in a visual hierarchy with render transforms applied on different levels (sort of like a 2D scene graph but a WPF visual tree), this I cannot change(!). I have read in different places that it might be possible to create a custom shape to cancel out the transform for the render transform and put it on the geometry instead. At the moment I have something like:</p>\n\n<pre><code>public sealed class MyPath : Shape\n{\n    // This class has a Data property of type Geometry just like the normal Path class\n\n    protected override Geometry DefiningGeometry\n    {\n        get\n        {\n            Geometry data = Data;\n\n            if (data == null)\n            {\n                data = Geometry.Empty;\n            }\n\n            return data;\n        }\n    }\n\n    protected override void OnRender(DrawingContext drawingContext)\n    {\n        Transform tr = RenderedGeometry.Transform;\n        Geometry geomToDraw = RenderedGeometry.Clone();\n        geomToDraw.Transform = new MatrixTransform(tr.Value * tr.Value);\n        Matrix trInv = tr.Value; trInv.Invert();\n        drawingContext.PushTransform(new MatrixTransform(trInv));\n        drawingContext.DrawGeometry(Brushes.Transparent, new Pen() { Brush = Brushes.Black, Thickness = 1 }, geomToDraw);\n    }\n}\n</code></pre>\n\n<p>As is clearly evident, I am quite new to this and the above code is probably completely messed up. I was trying to transfer the matrix to the geometry without changing the final resulting geometry transform, hence the tr.Value*tr.Value and trInv. But it does not work as I want it to. I know this transfer transform technique works in theory because I tried it out with constant transforms (testing to set Geometry.Transform to scale x with 4 and pushing a transform to scale x with 0.25 worked fine but the resulting shape drawing did not seem to apply stretch=fill, which I rely upon). So there must be something that I am missing with the render transforms.</p>\n\n<p>The test scenario that is not working is this:</p>\n\n<ul>\n<li>I apply a render scale transform with scaleX=4 and scaleY=1 in xaml.</li>\n<li>The built-in Path class scales the entire drawing so that strokes 4 times wider in the x direction than in the y direction.</li>\n<li>I want MyPath to scale the geometry only, not the strokes. &lt;- THIS IS NOT WORKING!\n<ul>\n<li>What happens is: The geometry gets scaled correctly, the strokes get scaled by 4 in the x direction and by slightly less than 4 in the y direction. What is wrong? I have a feeling that I should not be working solely with RenderedGeometry.Transform but what should I use instead? I need to incorporate the render transform and the stretch=fill on the shape. My render transforms hierarchy may contain a mix of scales, rotations and translations so the solution must be general enough to handle any transform, not just axis-aligned scaling.</li>\n</ul></li>\n</ul>\n\n<p>Note: I know it is bad to create the geometry in OnRender but I want to get it working before spending time cleaning it up.</p>\n\n<p>By the way, I read this post:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/724139/invariant-stroke-thickness-of-path-regardless-of-the-scale\">Invariant stroke thickness of Path regardless of the scale</a></p>\n\n<p>The problem as stated before is that I do have to take render transforms into consideration and I am not sure of how to adapt that solution to work with them.</p>\n"},{"tags":["c#","wpf","c#-4.0","xamdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13256056,"title":"How to add a tooltip to the XamDataGrid record programmatically","body":"<p>I already know how to set the tooltip for a XamDataGrid using a style, e.g.:</p>\n\n<pre><code>&lt;Style TargetType={x:Type ig:DataRecordCellArea&gt;...\n</code></pre>\n\n<p>However, for a specific reason (don't have time to explain it all), I really need to invoke the tooltip programmatically, preferably hooked to a <code>MouseOver</code> event. </p>\n\n<p>I would really appreciate it if someone could illustrate the way.  What have I done so far? Not much, because the Infragistics site is full of XAML examples and doesn't offer any guidance on doing this programmatically (except for one trivial cell-level tooltip example).</p>\n"},{"tags":["c#","wpf","video-streaming","expression","broadcasting"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":268,"score":4,"question_id":10990427,"title":"wpf application for broadcasting video with 15sec delay","body":"<p>I have a WPF application for broadcasting video using Microsoft.expression.encoder and framework 4.0, but i got a delay of 15 sec while broadcasting.Is there any suggestion to reduce the delay while broadcasting.</p>\n\n<p>below is the Code</p>\n\n<pre><code>using Microsoft.Expression.Encoder.Live; \nusing Microsoft.Expression.Encoder;\n\nprivate void button1_Click(object sender, RoutedEventArgs e)\n{ \n    try \n    { \n        EncoderDevice video = null; \n        EncoderDevice audio = null;\n        GetSelectedVideoAndAudioDevices(out video, out audio);\n        StopJob();\n\n        if (video == null)\n        {\n            return;\n        }\n\n        StopJob();\n        _job = new LiveJob();\n\n        if (video != null &amp;&amp; audio != null)\n        {\n            //StopJob();\n            _deviceSource = null;\n            _deviceSource = _job.AddDeviceSource(video, audio);\n            _job.ActivateSource(_deviceSource);\n\n            // Finds and applys a smooth streaming preset        \n            //_job.ApplyPreset(LivePresets.VC1HighSpeedBroadband4x3);\n\n            // Creates the publishing format for the job\n            PullBroadcastPublishFormat format = new PullBroadcastPublishFormat();\n            format.BroadcastPort = 9090;\n            format.MaximumNumberOfConnections = 50;\n\n            // Adds the publishing format to the job\n            _job.PublishFormats.Add(format);\n\n            // Starts encoding\n            _job.StartEncoding();\n        }\n        //webCamCtrl.StartCapture();\n    }\n    catch (Exception ex)\n    {\n        WriteLogFile(this.GetType().Name, \"button1_Click\", ex.Message.ToString());\n    }\n\n}\n</code></pre>\n\n<p>I am using MediaElement to show  the webcam both on my server and client systems.</p>\n\n<p>on Client Side </p>\n\n<pre><code> try\n            {\n\n                theMainWindow.getServerIPAddress();\n                IP = theMainWindow.machineIP;\n                MediaElement1.Source = new Uri(\"http://\" + IP + \":9090/\");\n            }\n            catch (Exception ex)\n            {\n            }\n</code></pre>\n"},{"tags":["c#","wpf","webkit","webbrowser"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":0,"view_count":6470,"score":18,"question_id":4001547,"title":"C# WPF WebBrowser alternative","body":"<p>I need a web browser inside my .NET 3.5 application and I don't want to use the default webbrowser (because it feels buggy and slow). I tried Chris Cavanagh's chromium but I just couldn't get it to work... are there any easier to use alternatives? I'm looking for something very simple and light on the computer, it will host a webstore front if that matters.</p>\n"},{"tags":[".net","wpf","browser","webbrowser"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1649,"score":6,"question_id":1140363,"title":"Hosting browser in WPF","body":"<p>Is it possible to host any other web browser <strong>beside IE</strong> in WPF desktop application?</p>\n\n<p>Edit:</p>\n\n<p>If yes, how?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13257884,"title":"How do I bind the value of a dependency property in the UserControl it's defined in XAML?","body":"<p>Suppose I have a UserControl which has a DataContext set to it's VM</p>\n\n<p>Now suppose the UserControl has a dependency property defined that I want to initially bind to a property on the ViewModel ...how would I reference this property in the XAML of the UserControl given the top-level element is UserControl?</p>\n\n<pre><code>&lt;UserControl x:Class=\"TestApp1.TestControl\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         xmlns:local=\"clr-namespace:TestApp1\"\n         mc:Ignorable=\"d\" \n         d:DesignHeight=\"300\" d:DesignWidth=\"300\" x:Name=\"test\"&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Dependency property:</p>\n\n<pre><code>    public static readonly DependencyProperty MyTestPropProperty= null;\n\n    public string MyTestProp\n    {\n        get { return (string)GetValue(MyTestPropProperty); }\n        set { SetValue(MyTestPropProperty, value); }\n    }\n\n    static TestControl()\n    {\n        MyTestPropProperty= DependencyProperty.Register(\n            \"MyTestProp\",\n            typeof(string), \n            typeof(TestControl), \n            new FrameworkPropertyMetadata());\n    }\n</code></pre>\n\n<p>On the XAML I\"d like to be able go MyTestProp={Binding yadda yadda} but I have no way to reference it from XAML</p>\n"},{"tags":["wpf","vb.net","datagrid","observablecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13256478,"title":"VB.net WPF DataGrid ObservableCollection Binding property update","body":"<p>I am using VB.NET and WPF within Visual Studio 2010 Express.</p>\n\n<p>Currently, I have:</p>\n\n<ul>\n<li>A DataGrid by the name of <em>downloadListDG</em>. This has a column which is a template containing an image.</li>\n<li>An <em>ObservableCollection</em> of a custom <em>DownloadListItem</em> class.</li>\n<li>This <em>DownloadListItem</em> has a public property which is another custom class.</li>\n<li>This class has a private dim which is a StateType (a custom enum), and a public readonly property which returns a string depending on what the StateType is (actually an image URI if you're curious).</li>\n<li>The <em>DownloadListItem</em> also has a public property which just returns the StateType (this is just for binding purposes)</li>\n</ul>\n\n<p>My problem is that whenever the StateType changes, the image column in the DataGrid does not change. I have been trying to use the <em>IPropertyChangedNofity</em>, but nothing changes, so either I'm using it incorrectly or I need to use another method.</p>\n\n<pre><code>Implements INotifyPropertyChanged\n\nPublic Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged\n\nAddHandler ControllerRef.StateChanged, AddressOf StateChangeHandler\n\nPrivate Sub StateChangeHandler(NewState As State)\n    MsgBox(NewState)\n    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(\"CurrentState\"))\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance,<br />\nWibble.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13255882,"title":"Pass data by CommandParameter","body":"<p>I am trying to pass <strong>UserName</strong> by <code>CommandParameter</code>.</p>\n\n<pre><code>&lt;GridViewColumn   Width=\"Auto\" Header=\"UserName\" &gt;\n   &lt;GridViewColumn.CellTemplate&gt;\n       &lt;DataTemplate&gt;\n          &lt;Button Click=\"Button_Click\" Content=\"...\" CommandParameter=\"{Binding Path=UserName}\"&gt;&lt;/Button&gt;                                                                                                         &lt;/DataTemplate&gt;\n    &lt;/GridViewColumn.CellTemplate&gt;\n&lt;/GridViewColumn&gt;\n</code></pre>\n\n<p>But here I am not sure what do I have to use to catch it...</p>\n\n<pre><code>private void Button_Click(object sender, RoutedEventArgs e)\n{\n    // How to get UserName  here?\n}\n</code></pre>\n\n<p>Any clue?</p>\n\n<p>Thank you!</p>\n"},{"tags":[".net","wpf","memory-leaks"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":623,"score":1,"question_id":1925052,"title":"Do I have a memory leak in my WPF Navigation?","body":"<p>I'm looking through a WPF application looking for a memory leak (using ANTS Memory Profiler 5.1) and I keep seeing some pages and controls taking up memory when they shouldn't be.</p>\n\n<p>So I go to the Object Retention Graph and to see what is keeping them around, and I keep seeing this for every page:</p>\n\n<p><img src=\"http://img683.imageshack.us/img683/3013/ants.jpg\" alt=\"Object Retention Graph\"></p>\n\n<p>The thing is, I have KeepAlive set to false on every page, and I don't think such a property exists on the user controls.</p>\n\n<p>Can anyone tell me what I should be looking for? Is this even a memory leak or is this normal behaviour for a WPF application?</p>\n"},{"tags":["c#","wpf","datagrid","entity","inotifycollectionchanged"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13257888,"title":"Is there a way to trigger some kind of `OnPropertyChanged` event for a computed property that uses a property of a \"child entity\" in a collection?","body":"<p>Is there a way to trigger some kind of <code>OnPropertyChanged</code> event for a computed property that uses a property of a \"child entity\" in a collection?</p>\n\n<p>A small example:</p>\n\n<p>I have a simple  WPF application with a DataGrid showing Customer properties.\nI am using Entity Framework 5, CodeFirst approach, so I wrote my classes manually with my own INotifyPropertyChanged implementation.</p>\n\n<pre><code>public partial class Customer : INotifyPropertyChanged\n{\n    private string _firstName;\n    public virtual string FirstName\n    {\n        get { return _firstName; }\n        set\n        {\n            _firstName = value;\n            OnPropertyChanged(\"FirstName\");\n            OnPropertyChanged(\"FullName\");\n        }\n    }\n\n    private string _lastName;\n    public virtual string LastName\n    {\n        get { return _lastName; }\n        set\n        {\n            _lastName = value;\n            OnPropertyChanged(\"LastName\");\n            OnPropertyChanged(\"FullName\");\n        }\n    }\n\n    public virtual ICollection&lt;Car&gt; Cars { get; set; }\n    public virtual ICollection&lt;Invoice&gt; Invoices { get; set; }\n\n    ...\n}\n</code></pre>\n\n<p>Now in that same class I created 3 computed properties:</p>\n\n<pre><code>    public string FullName\n    {\n        get { return (FirstName + \" \" + LastName).Trim(); }\n    }\n\n    public int TotalCars\n    {\n        get\n        {\n            return Cars.Count();\n        }\n    }\n\n    public int TotalOpenInvoices\n    {\n        get\n        {\n            if (Invoices != null)\n                return (from i in Invoices\n                        where i.PayedInFull == false\n                        select i).Count();\n            else return 0;\n        }\n    }\n</code></pre>\n\n<p>The <code>FullName</code> is automatically updated in the DataGrid because I'm calling <code>OnPropertyChanged(\"FullName\");</code></p>\n\n<p>I found an example of the INotifyCollectionChanged implementation that I can probably use to auto update the <code>TotalCars</code> when something is added to or removed from the ICollection:\n<a href=\"http://www.dotnetfunda.com/articles/article886-change-notification-for-objects-and-collections.aspx\" rel=\"nofollow\">http://www.dotnetfunda.com/articles/article886-change-notification-for-objects-and-collections.aspx</a></p>\n\n<p>But what is the best approach to trigger the <code>OnPropertyChange(\"TotalOpenInvoices\")</code> when a property (<code>PayedInFull</code>) inside the ICollection (<code>Invoices</code>) changes?</p>\n\n<p>Doing something like <code>OnPropertyChanged(\"Customer.TotalOpenInvoices\");</code> in the Invoice class doesn't seem to do the trick... :)</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13256246,"title":"linq to entity framework with join","body":"<p>I have in my DB 2 tables: </p>\n\n<ol>\n<li><p>Documents (Document_Id ,document_Name) </p></li>\n<li><p>Person_Documents (person_ID ,Documet_Id document_Done)</p></li>\n</ol>\n\n<p>I use entity framework and ,and I want to fill <code>DataGrid</code> with the data <code>document_Name</code> and <code>document_Done</code>,</p>\n\n<p>I have tried the following with no results:</p>\n\n<pre><code>      vagEntities projectE = new vagEntities();\n      var doc = from c in projectE.Person_Documents                   \n          join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n          where c.Person_Id == 150\n          select c;\n\n      DocGrid.ItemsSource = doc;\n</code></pre>\n\n<p>Please, where am I wrong?\nun the xaml i write this</p>\n\n<pre><code>                &lt;DataGridTextColumn Binding=\"{Binding Path=Document_Name}\" MinWidth=\"100\"   Header=\"document\"  /&gt;\n\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=Document_done}\" Header=\"Do\" /&gt;\n</code></pre>\n"},{"tags":["wpf","dependency-properties"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":13020357,"title":"Need in-IDE update of WPF properties","body":"<p>I have a real-world problem in which I need to customize the developer experience inside the WPF visual designer and property window of Visual Studio.</p>\n\n<p>I have three properties A B and C:</p>\n\n<ol>\n<li><p>Each of the three properties must appear in the property window;</p></li>\n<li><p>Property C must be read-only, and its value must be calculated on the basis of the values of properties A and B, which are read-write; and</p></li>\n<li><p>If A or B change, the value for C should be updated <em>without</em> having to reload the designer.</p></li>\n</ol>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#",".net","wpf","draggable","attachedbehaviors"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":2,"view_count":112,"score":1,"question_id":13076056,"title":"Is there a good solution for a ItemsControl in WPF that can have its elements reordered by vertical drag and drop?","body":"<p>So here's the scenario I'm working with:</p>\n\n<p>I've got a priority list currently represented as an ItemsControl/ListView, bound to an observable collection of priority items.  I want to provide tightly visually constrained vertical dragging for element reordering.</p>\n\n<p>So, no drag adorners, no horizontal movement, only vertical movement.  When a list item moves past the midpoint of another item, it should \"swap positions\" through animation.  I am sure this can be done by working with mousedown/mousemove on the containers themselves, and I'm sure render transforms can be applied to do this, but my ideal solution would have two components to it:</p>\n\n<ol>\n<li><p>The functionality could be attached as a WPF interactions <a href=\"http://wpftutorial.net/Behaviors.html\" rel=\"nofollow\">behavior</a>.</p></li>\n<li><p>The system would be MVVM friendly and not require any significant code behind.</p></li>\n</ol>\n\n<p>Has this been done? Where can I find it?  If it hasn't how could I go about putting all the bits together in order to do this?</p>\n\n<p>EDIT: <strong>Bounty opened. Please direct questions to me via comments and I will reply as fast as possible.</strong></p>\n"},{"tags":["c#","wpf","pdf","xps","print-preview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13255879,"title":"Creating print previews of documents","body":"<p>I need to create a software which will create print previews of the documents of following formats: the MS Office documents (<code>.doc(x)</code>, <code>.ppt(x)</code>, <code>.xls(x)</code>), images, <code>.txt</code> files and PDF files. I have made a working prototype using <code>XPS</code> files. So basically I do the following: I convert the office files to <code>.xps</code> using Office Automation and then I render the <code>.xps</code> documents to images. I simply create XPS files from images and <code>.txt</code> by adding text or an image to <code>FlowDocument</code>, then rendering it. But I have found out that there is no way to convert PDF to XPS fast (A document which has 600 pages takes more than 2 minutes to convert and this is totally not suitable). So I am stuck at this point. It seems that I should start over again, using the different file format. Should I rewrite my program using PDF, for example, or is there any other way to accomplish my task? And if I should use PDF, could you, please, suggest me a good PDF C# library to render previews of pages as fast as possible? I tried using <strong>Websupergoo's ABCPdf</strong>, but it is too slow, because it does not allow me to render the previews to <code>System.Windows.Media.Imaging.BitmapSource</code>, only <code>System.Drawing.Bitmap</code>, so I have to convert <code>Bitmap</code> to <code>BitmapSource</code> and it takes up a lot of time.<br>\nThanks in advance.</p>\n"},{"tags":["wpf","binding","datagrid","width","datagridcolumn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12871551,"title":"Binding the Width Property of a DataGridColumn to the ActualWidth of the parent DataGrid","body":"<p>I tried to solve my previous <a href=\"http://stackoverflow.com/questions/12758886/datagrid-columnwidth-property-ignored-in-datatemplate-for-row-details\">question</a> with manually binding the <code>Width</code> property of the <code>DataGridTextColumn</code> here is the first Version of my XAML Code.</p>\n\n<pre><code>   &lt;DataGrid AutoGenerateColumns=\"False\" Background=\"White\" ItemsSource=\"{Binding Items, Mode=OneWay}\" \n              HorizontalGridLinesBrush=\"Silver\" VerticalGridLinesBrush=\"Silver\"\n              Margin=\"332,10,10,10\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"\n              x:Name=\"myDataGrid\" ColumnWidth=\"*\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, RelativeSource={RelativeSource AncestorType=DataGrid}}\" IsReadOnly=\"True\" Header=\"Column1\" Binding=\"{Binding Value1, Mode=OneWay}\" /&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, RelativeSource={RelativeSource AncestorType=DataGrid}}\" IsReadOnly=\"True\" Header=\"Column2\" Binding=\"{Binding Value2, Mode=OneWay}\"/&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, RelativeSource={RelativeSource AncestorType=DataGrid}}\" IsReadOnly=\"True\" Header=\"Column3\" Binding=\"{Binding Value3, Mode=OneWay}\"/&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>After a little research i found this <a href=\"http://stackoverflow.com/questions/9313586/binding-datagrid-column-width\">post</a> that seems to provide the answer to my problem and i updated my <code>DataGrid</code> code.</p>\n\n<pre><code>   &lt;DataGrid AutoGenerateColumns=\"False\" Background=\"White\" ItemsSource=\"{Binding Items, Mode=OneWay}\" \n              HorizontalGridLinesBrush=\"Silver\" VerticalGridLinesBrush=\"Silver\"\n              Margin=\"332,10,10,10\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"\n              x:Name=\"myDataGrid\" ColumnWidth=\"*\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, Source={x:Reference Name=myDataGrid}}\" IsReadOnly=\"True\" Header=\"Column1\" Binding=\"{Binding Value1, Mode=OneWay}\" /&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, Source={x:Reference Name=myDataGrid}}\" IsReadOnly=\"True\" Header=\"Column2\" Binding=\"{Binding Value2, Mode=OneWay}\"/&gt;\n            &lt;DataGridTextColumn Width=\"{Binding Path=ActualWidth, Converter={StaticResource ResourceKey=WidthValueConverter}, Source={x:Reference Name=myDataGrid}}\" IsReadOnly=\"True\" Header=\"Column3\" Binding=\"{Binding Value3, Mode=OneWay}\"/&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>but now im getting this XamlParseException</p>\n\n<pre><code>Cannot call MarkupExtension.ProvideValue because of a cyclical dependency. Properties inside a \nMarkupExtension cannot reference objects that reference the result of the MarkupExtension. \nThe affected MarkupExtensions are:\n'System.Windows.Data.Binding' Line number '37' and line position '37'.\n'System.Windows.Data.Binding' Line number '38' and line position '37'.\n'System.Windows.Data.Binding' Line number '39' and line position '37'.\n</code></pre>\n\n<p>So how can i bind the <code>Width</code> property of a <code>DataGridColumn</code> to the <code>ActualWidth</code> property of its parent <code>DataGrid</code></p>\n"},{"tags":["c#","wpf","binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":13256687,"title":"wpf binding to another control property","body":"<p>so i have this usercontrol :</p>\n\n<pre><code>&lt;UserControl x:Class=\"Client.SpectrumSpace\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             xmlns:my=\"clr-namespace:Client\" \n             mc:Ignorable=\"d\" d:DesignHeight=\"150\" d:DesignWidth=\"350\"&gt;\n    &lt;Canvas&gt;\n        &lt;Rectangle Width=\"350\" Height=\"150\" Fill=\"Transparent\" Stroke=\"White\" StrokeThickness=\"1\"&gt;\n            &lt;Rectangle.ContextMenu&gt;\n                &lt;ContextMenu Name=\"contextMenu\"&gt;\n                    &lt;MenuItem Name=\"ctxItem1\" Header=\"AntennaName\" \n                              IsEnabled=\"{Binding MainWindow.availeableAntennas[0]}\"/&gt;\n                &lt;/ContextMenu&gt;\n            &lt;/Rectangle.ContextMenu&gt;\n        &lt;/Rectangle&gt;\n    &lt;/Canvas&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>and as you can see im trying to bind the MainWindow.availableAntennas[0] property to the MenuItem.IsEnabled property</p>\n\n<p>this is how i declared the array on MainWindow class:</p>\n\n<pre><code>public  bool[]      availableAntennas   = new bool[9];\n</code></pre>\n\n<p>my problem is that the IsEnabled property is always true and yes i double checked the availeableAntennas[0] is false, so what am i doing wrong here?</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13255718,"title":"Boolean Converter not hitting converter","body":"<p>I'm using a boolean converter in my XAML in a WPF project. I want to disable a few buttons while \"IsBusy\" is true. I am absolutely sure that IsBusy is being set to true/false properly. I am able to successfully bind directly to IsBusy without the converter. The following does not currently work. I've put breakpoints in the actual converter class and the \"Convert\" and \"ConvertBack\" methods are never hit. What is wrong here?</p>\n\n<pre><code>IsEnabled=\"{Binding IsBusy, Converter={StaticResource InvertedBooleanConverter}}\"\n</code></pre>\n\n<p>Resources:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;converters:InvertedBooleanConverter x:Key=\"InvertedBooleanConverter\" /&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>Converters:</p>\n\n<pre><code>xmlns:converters=\"clr-namespace:MyProject.Converters\"\n</code></pre>\n\n<p>The converter:</p>\n\n<pre><code>namespace MyProject.Converters\n {\n\n    [ValueConversion(typeof(bool), typeof(bool))]\n    public class InvertedBooleanConverter : IValueConverter\n    {\n        #region IValueConverter Members\n\n        public object Convert(object value, Type targetType, object parameter,\n            System.Globalization.CultureInfo culture)\n        {\n            if (targetType != typeof(bool))\n                throw new InvalidOperationException(\"The target must be a boolean\");\n\n            return !(bool)value;\n        }\n\n        public object ConvertBack(object value, Type targetType, object parameter,\n            System.Globalization.CultureInfo culture)\n        {\n            throw new NotSupportedException();\n        }\n\n        #endregion\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","binding","dependency-properties"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":191,"score":2,"question_id":13052100,"title":"Binding from DependecyProperty to DataContext (ViewModel) in XAML","body":"<p>Assume this situation:<br>\nI have created a new control (\"MyControl\") with DependencyProperty \"SuperValue\".<br>\nNow, in XAML i set \"SuperValue\" to \"TestValue\":</p>\n\n<pre><code>&lt;local:MyControl SuperValue=\"TestValue\" /&gt;\n</code></pre>\n\n<p>This control has a ViewModel (DataContext).<br>\nI want to pass value of DependencyProperty (in this example \"TestValue\") to property in ViewModel.</p>\n\n<p>How can I do this?</p>\n\n<p>Assume that ViewModel of my control do something calculations, for example: User inputs name of country, and control give him a time which is currently there.</p>\n\n<p>The problem is: How can I provide the result of calculation? Assume that this is public property \"Results\" in ViewModel. I want to create a property like \"TextBox.Text\", \"ListView.SelectedItem\" which provides a part of ViewModel data \"to outside\".</p>\n\n<p>For example TextBox and Text property:</p>\n\n<pre><code>&lt;TextBox Text={Binding GiveMeTextValue} /&gt;\n</code></pre>\n\n<p>In this case DP \"Text\" provides to outside a ViewModel property which currently stores inputted text.</p>\n\n<p>I want to use my control in the same way.<br></p>\n"},{"tags":["wpf","mvvm","mvvm-light"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13256521,"title":"Does the ViewModelLocator have a different load order then in-code DataContext assignment?","body":"<p>When using the <code>ViewModelLocator</code> from the MVVM Light framework, is there a difference in the <code>DataContext</code> assignment order then if assigning from the code behind?</p>\n\n<p>That is, would the <code>DataContext</code> be set at a different point in the application execution when assigning in the XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"MyMvvmLightApp.MainWindow\"\n        ...\n        Title=\"MVVM Light Application\"\n        DataContext=\"{Binding Main, Source={StaticResource Locator}}\"&gt;\n</code></pre>\n\n<p>versus the <code>MainWindow.xaml.cs</code> constructor:</p>\n\n<pre><code>public MainWindow()\n{\n    InitializeComponent();\n\n    _mainViewModel = new MainViewModel();\n    DataContext = _mainViewModel;\n\n}\n</code></pre>\n\n<p>I ask, because I have a lookless control that I am using which break when using the Locator.  Everything is fine when using the code behind assignment though.  Weird.</p>\n\n<p>I'd like to use the Locator though, so I can more easily assign the necessary ViewModels to the appropriate Views.</p>\n"},{"tags":["c#","wpf","dispatchertimer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13256164,"title":"send a extra argument in Dispatchertimer.Tick event","body":"<p>my question is how can i send some arguments in Dispatchertimer.Tick event\n here is the code: what i wanted to is receive a integer value at dispatcheTimer_Tick</p>\n\n<pre><code>    dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick);\n\n    private void dispatcherTimer_Tick(object sender, EventArgs e)\n    {\n        //.Text = DateTime.Now.Second.ToString();\n\n    }\n</code></pre>\n\n<p>what i wanted to do is something  like this</p>\n\n<pre><code>    private void dispatcherTimer_Tick(object sender, EventArgs e,int a)\n    {\n        //.Text = DateTime.Now.Second.ToString();\n\n    }\n</code></pre>\n\n<p>how to send a value from a calling point??</p>\n"},{"tags":["wpf","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13256145,"title":"How do I use a static method as the target of CallMethodAction?","body":"<pre><code>xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"\nxmlns:ei=\"http://schemas.microsoft.com/expression/2010/interactions\"\n &lt;Button Content=\"Status\"&gt;\n        &lt;i:Interaction.Triggers&gt;\n            &lt;i:EventTrigger EventName=\"Click\"&gt;\n                &lt;ei:CallMethodAction MethodName=\"ResetStatus\" TargetObject=\"{StaticResource Domain.Adapters.IIS}\"/&gt;\n            &lt;/i:EventTrigger&gt;\n        &lt;/i:Interaction.Triggers&gt;\n    &lt;/Button&gt;\n</code></pre>\n\n<p>throws an exception on launch. Can <code>CallMethodAction</code> call static methods?</p>\n"},{"tags":["wpf","visual-studio","xaml"],"answer_count":6,"favorite_count":1,"up_vote_count":16,"down_vote_count":0,"view_count":2127,"score":16,"question_id":2888347,"title":"#region in XAML","body":"<p>I actually don't like #region in my code. <em>BUT</em> for some reason call me crazy, I would like to have them in my XAML. I would like whole sections to have a #region-like thing and collapse them (e.g. my &lt;Window.CommandBindings>, &lt;Grid.*Definitions>, &lt;Menu>, &lt;Toolbar>, etc..</p>\n\n<p>Does this exist? If not, how about &lt;RegionCollapse></p>\n"},{"tags":["wpf","datatemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13255494,"title":"Dynamically updating WPF data template","body":"<p>I have the below Button XAML</p>\n\n<pre><code>&lt;Button Name=\"btnLogoff\" DockPanel.Dock=\"Left\" Click=\"btnToolbar_Click\" CommandParameter=\"LOGOFF\"\n                    Template=\"{DynamicResource ToolbarButton}\"\n                        Style=\"{StaticResource ToolbarButtonDisplay}\" z:ButtonProperties.Image=\"..\\..\\Resources\\Images\\Logoff.GIF\" Content=\"Logoff\"&gt;\n                &lt;/Button&gt;\n</code></pre>\n\n<p>ButtonProperties is as follows</p>\n\n<pre><code>public class ButtonProperties\n    {\n        public static ImageSource GetImage(DependencyObject obj)\n        {\n            return (ImageSource) obj.GetValue(ImageProperty);\n        } \n\n        public static void SetImage(DependencyObject obj, ImageSource value)\n        {\n            obj.SetValue(ImageProperty, value);\n        } \n\n        public static readonly DependencyProperty ImageProperty = DependencyProperty.RegisterAttached(\"Image\", typeof(ImageSource), typeof(ButtonProperties), new UIPropertyMetadata((ImageSource)null));\n    } \n</code></pre>\n\n<p>Which works fine, to give me a template for buttons I can use throughout the app that have an image and text component.</p>\n\n<p>What I want to be able to do is change the style dynamically from ToolbarButton to ToolbarButtonRed on certain background thread methods, such as notifying the user that an event is about to occur, the button will change to a red style. Both styles are in the resources of the XAML page but I cant figure out how to change the Template programmatically.</p>\n\n<p>I have tried..</p>\n\n<pre><code>        public DataTemplate AlarmTemplate\n        {\n            get\n            {\n                if (_alarmTemplate != null)\n                    return _alarmTemplate;\n                else\n                    return (DataTemplate)_parent.FindResource(\"ToolbarButton\");\n            }\n            set\n            {\n                _alarmTemplate = value;\n                OnPropertyChanged(\"AlarmTemplate\");\n            }\n        }\n\n\nprivate void SetAlarmIcon(bool red)\n        {\n            if (red)\n                AlarmTemplate = (DataTemplate)_parent.FindResource(\"ToolbarButtonRed\");\n            else\n                AlarmTemplate = (DataTemplate)_parent.FindResource(\"ToolbarButton\");\n        }\n</code></pre>\n\n<p>and binding the XAML as such</p>\n\n<p>\n                </p>\n\n<p>But no joy. The button doesnt even display at all. Any suggestions?</p>\n\n<p>UPDATE:</p>\n\n<p>Style below</p>\n\n<pre><code>&lt;Style x:Key=\"ToolbarButtonDisplay\" TargetType=\"Button\"&gt;\n        &lt;Setter Property=\"ContentTemplate\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\"&gt;\n                        &lt;Image Source=\"{Binding Path=(Windows:ButtonProperties.Image), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}\" Margin=\"0,2,0,0\" Width=\"32\"/&gt;\n                        &lt;TextBlock FontSize=\"9\" FontWeight=\"Normal\" FontFamily=\"Arial\" Foreground=\"White\" HorizontalAlignment=\"Center\" Margin=\"2,2,2,2\"&gt;\n                                &lt;ContentPresenter Content=\"{Binding Path=Content, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}\"&gt;&lt;/ContentPresenter&gt;\n                        &lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding Path=IsEnabled}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Template\" Value=\"{StaticResource ToolbarButtonRed}\"/&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>Final update - I got a trigger to work as below</p>\n\n<pre><code>&lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding Path=DisplayToolbar}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Template\" Value=\"{DynamicResource ToolbarButtonRed}\"/&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n</code></pre>\n\n<p>By just using an arbitrary property on the datacontext (DisplayToolbar) as I am not sure how to do this specific to a button. To explain, I have about 30 buttons on the page, which all use the same style and hence the same trigger so the above code will set all 30 to red. I need a way for each button to workout whether IT and IT ALONE should be red, so I'm thinking along the lines of setting some property of a button control if there is one I can use, and have the data trigger look at the buttons properties, not the datacontexts. What is the syntax to bind to the buttons own properties rather than the datacontext?</p>\n"},{"tags":["c#","wpf","charts","devexpress","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":793,"score":1,"question_id":8098092,"title":"Devexpress DXCharts (refresh, update, clear) new instance?","body":"<p>I'm using wpf and c# with the Third party DevExpress Libraries. I'm having a problem with DXCharts. I've tried a few different things to clear or update the chart to no avail. I'm Data-binding to a Data-table(built on the fly) with a dependency property for the Data-source. </p>\n\n<p>The dependency properties for the chart do not seem to be overridden when new data is set to the backing property. This gives me overlaying points on the chart. As you can see in the examples below.</p>\n\n<p><strong>1st Set of Data</strong>\n<img src=\"http://i.stack.imgur.com/1RqP6.jpg\" alt=\"1st set of Data Points\"></p>\n\n<p><strong>2nd Set of Data</strong>\n<img src=\"http://i.stack.imgur.com/DXkFH.jpg\" alt=\"2nd set of Data Points\"></p>\n\n<p>I also tried creating new instances of the Chart control and its still showing the old binded dependency properties. The DXchart usercontrol is embedded into a Content Control. I bind the Chart via a content property. All of this is nested under a DevExpress tab control.</p>\n\n<p>Here is some of the code below:</p>\n\n<p><strong>Dependency Properties</strong></p>\n\n<pre><code>public static readonly DependencyProperty DataTableChartProperty = DependencyProperty.Register\n        (\"DataTableChart\", typeof(DataTable), typeof(MainWindowViewModel));\n\npublic static readonly DependencyProperty ContentElementProperty = DependencyProperty.Register\n        (\"ContentElement\", typeof(FrameworkElement), typeof(MainWindowViewModel));\n</code></pre>\n\n<p><strong>Backing Properties</strong></p>\n\n<pre><code>public DataTable DataTableChart\n    {\n        get { return (DataTable)this.GetValue(DataTableChartProperty); }\n        set { this.SetValue(DataTableChartProperty, value); }\n\npublic FrameworkElement ContentElement\n    {\n        get { return (FrameworkElement)this.GetValue(ContentElementProperty); }\n        set { this.SetValue(ContentElementProperty, value); }\n    }\n</code></pre>\n\n<p><strong>UserControl</strong></p>\n\n<pre><code>&lt;UserControl x:Class=\"Reporting_DIMS.UI.ChartControl\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n         xmlns:dx=\"http://schemas.devexpress.com/winfx/2008/xaml/core\"\n         xmlns:dxb=\"http://schemas.devexpress.com/winfx/2008/xaml/bars\"\n         xmlns:dxc=\"http://schemas.devexpress.com/winfx/2008/xaml/charts\"\n         xmlns:dxg=\"http://schemas.devexpress.com/winfx/2008/xaml/grid\"\n         xmlns:dxe=\"http://schemas.devexpress.com/winfx/2008/xaml/editors\"\n         mc:Ignorable=\"d\"\n         d:DesignHeight=\"700\" d:DesignWidth=\"1100\"&gt;\n&lt;Grid&gt;\n    &lt;Border Padding=\"3\"&gt;\n        &lt;dxc:ChartControl Margin=\"0\" Name=\"chartControl\" DataSource=\"{Binding DataTableChart}\"&gt;\n            &lt;dxc:ChartControl.Diagram&gt;\n                &lt;dxc:XYDiagram2D SeriesDataMember=\"DIMS User\"&gt;\n                    &lt;dxc:XYDiagram2D.SeriesTemplate&gt;\n                        &lt;dxc:BarSideBySideSeries2D ValueDataMember=\"Count\" ArgumentDataMember=\"Entry DateTime\" /&gt;\n                    &lt;/dxc:XYDiagram2D.SeriesTemplate&gt;\n                &lt;/dxc:XYDiagram2D&gt;\n            &lt;/dxc:ChartControl.Diagram&gt;\n            &lt;dxc:ChartControl.Legend&gt;\n                &lt;dxc:Legend x:Name=\"legend\"/&gt;\n            &lt;/dxc:ChartControl.Legend&gt;\n        &lt;/dxc:ChartControl&gt;\n    &lt;/Border&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>Small MainWindow Portion</strong></p>\n\n<pre><code>&lt;dx:DXTabItem Header=\"Log Charts\" Name=\"dXTabItem2\"&gt;\n                    &lt;ContentControl x:Name=\"contentControl\" Content=\"{Binding     ContentElement}\"/&gt;\n                &lt;/dx:DXTabItem&gt;\n</code></pre>\n\n<p>If anyone has any ideas, I would greatly appreciate it. Thanks in Advance!</p>\n"},{"tags":["wpf","button","click","focus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13249529,"title":"Wpf button click when application window is not active","body":"<p>I have a WPF application window with a set of three buttons (Button A, B, C) and these buttons have command binding to respective View Model property. </p>\n\n<p>When Button A is clicked it's command executes (another application is launched, Button A is disabled as CommandCanExecute condition is updated to return false). This results in application window being deactivated. </p>\n\n<p>Clicking Button B doesn’t execute it's command but instead only activates the window and sets the focus to the Main window. 2nd click is required on Button B to execute its command. </p>\n\n<p>The desired functionality is on click of Button B, while the application window is not active, the application window activates and command associated with Button B is executed. I have also tried removing the command and adding a click handler for test purpose but this displays same behaviour.</p>\n\n<p>I appreciate any help with this issue.</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13255406,"title":"What does a Property Setter correspond to when used in conjunction with ControlTemplates?","body":"<p>I have the following Style (stripped for brevity) and have some questions based on it. To my understanding, if a ControlTemplate replaces the entire visual tree of a control for which the Style is based on, what effect do the property Setters have then?</p>\n\n<p>In this example, don't the property Setters for FontSize, Margin, Height etc. correspond to the respective properties on the CheckBox itself? If you replace the Template property of a control, what will these Setters then correspond to if the CheckBox is no longer rendering it's default appearance?</p>\n\n<pre><code>&lt;Style x:Key=\"KeyName\" TargetType=\"CheckBox\"&gt;\n    &lt;Setter Property=\"FontSize\" Value=\"11\" /&gt;\n    &lt;Setter Property=\"Margin\" Value=\"0 0 1 0\" /&gt;\n    &lt;Setter Property=\"VerticalAlignment\" Value=\"Top\" /&gt;\n    &lt;Setter Property=\"Height\" Value=\"18\" /&gt;\n    ... common property setters etc.\n\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"CheckBox\"&gt;\n                &lt;Border&gt;\n                    &lt;StackPanel&gt;\n                        &lt;Ellipse Name=\"Ellipse\" Width=\"7\" Height=\"7\" /&gt;\n                        &lt;ContentPresenter Content=\"{TemplateBinding Content}\" /&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Border&gt;\n                &lt;ControlTemplate.Triggers&gt;\n                    &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                        &lt;Trigger.Setters&gt;\n                            &lt;Setter Property=\"Foreground\" Value=\"WhiteSmoke\" /&gt;\n                        &lt;/Trigger.Setters&gt;\n                    &lt;/Trigger&gt;\n                        ... custom triggers etc ...\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["c#",".net","wpf","input","focus"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13241437,"title":"WPF application with several windows including a non active: focus issue","body":"<p>I have a .Net 4 application with two windows in WPF 4:</p>\n\n<ul>\n<li>One uses the WS_EX_NOACTIVATE style to prevent gaining focus. </li>\n<li>The other is a basic Window.</li>\n</ul>\n\n<p>The \"no-activate\" window behavior is appropriate as soon as I do not select the basic window (it doesn't gains the focus). But when the basic window is selected, the \"no-activate\" window can be focused... and gains it when the user clicked on it.</p>\n\n<p>It is as if WPF considered two windows of the same application had the right to give focus even if they are not supposed to.\nThis behavior does not happen if both windows are WS_EX_NOACTIVATE.</p>\n\n<p>Have you ever been faced with this problem?\nI have read this: <a href=\"http://blogs.msdn.com/b/visualstudio/archive/2010/03/09/wpf-in-visual-studio-2010-part-3-focus-and-activation.aspx\" rel=\"nofollow\">WPF in Visual Studio 2010 – Part 3 : Focus and Activation</a>, but does not solve it.</p>\n\n<p><strong>Edit:</strong> I have been able to get around by using a Popup as a base class for my no-active Window. However, I don't want to have a Popup. Why !? The popup never receives the focus: does someone know why / how ? How can I reproduce this behavior to a Window ? \nI try to step into Popup / Window code, but it is not very clear !</p>\n\n<p>Thanks !</p>\n"},{"tags":["wpf","wpf-controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13251506,"title":"WPF Text Box Validation on numeric value","body":"<p>if have a text box in xaml. i want only numeric values can be write in textbox to validate on button. how can i do it ?    </p>\n\n<pre><code>&lt;TextBox x:Name=\"txtLevel\" Grid.Column=\"1\" HorizontalAlignment=\"Stretch\"&gt;&lt;/TextBox&gt;\n</code></pre>\n"},{"tags":["wpf","resize","flowdocument"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2511,"score":0,"question_id":1359103,"title":"Flowdocument isnt using the full width/height","body":"<p>Hi i have a FlowDocument which i want to fill the entire width and height of my window. I have tried using the flowdocumentpageViewer (no luck) and are now using a documentpageview. I still cant get it to dock/fill the entire space, its just sitting in the middle, in the minimum size it can create (does it make sense?)</p>\n\n<p>here is my code:</p>\n\n<pre><code>public DocumentPageView GetPage()\n        {\n            FlowDocumentPageViewer viewer = new FlowDocumentPageViewer();           \n            StreamReader reader = new StreamReader(location);\n            string data = reader.ReadToEnd();\n            reader.Close();\n            string xamlData = HtmlToXamlConverter.ConvertHtmlToXaml(data, true);\n            FlowDocument result = (FlowDocument)System.Windows.Markup.XamlReader.Load(new MemoryStream(System.Text.UnicodeEncoding.Default.GetBytes(xamlData)));\n\n            viewer.Document = result;\n            viewer.VerticalAlignment = VerticalAlignment.Center;\n            viewer.HorizontalAlignment = HorizontalAlignment.Center;\n\n            DocumentPageView pageView = new DocumentPageView();\n            pageView.VerticalAlignment = VerticalAlignment.Center;\n            pageView.HorizontalAlignment = HorizontalAlignment.Center;\n            pageView.Stretch = System.Windows.Media.Stretch.Uniform;\n            pageView.PageNumber = 0;\n            pageView.StretchDirection = StretchDirection.Both;\n            pageView.DocumentPaginator = ((IDocumentPaginatorSource)result).DocumentPaginator;\n            return pageView;\n        }\n</code></pre>\n\n<p>Please note that this code contains the combination of my two methods but only the DocumentPageView is currently used. This is the xaml that is created from my HTML source:</p>\n\n<pre><code>&lt;FlowDocument xml:space=\"preserve\" xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"&gt;\n&lt;Paragraph TextAlignment=\"center\" FontSize=\"22pt\" FontFamily=\"arial\"&gt;Test Paragraph&lt;/Paragraph&gt;\n&lt;Paragraph TextAlignment=\"center\" FontFamily=\"arial\"&gt;Test second paragraph&lt;/Paragraph&gt;\n&lt;/FlowDocument&gt;\n</code></pre>\n\n<p>If I resize the fonts the content is only resized vertically (please note that the stretch direction is set to both). Any ideas?</p>\n"},{"tags":["wpf","mvvm","listbox","tooltip"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13254395,"title":"Tooltip for ListBoxItem When binded to List of strings","body":"<p>How can we show tooltip for a ListBoxItem when ListBox control is binded to List of strings. Below, is the source code for my ListBox, where ConcernedConditions is of List type.</p>\n\n<pre><code>&lt;ListBox ItemsSource=\"{Binding ConcernedConditions}\" Style=\"{StaticResource CustomStyle}\"&gt;\n    &lt;ListBox.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"{x:Type ListBoxItem}\"&gt;\n            &lt;Setter Property=\"Template\"&gt; \n                &lt;Setter.Value&gt; \n                    &lt;ControlTemplate TargetType=\"{x:Type ListBoxItem}\"&gt; \n                        &lt;ContentPresenter /&gt; \n                    &lt;/ControlTemplate&gt; \n                &lt;/Setter.Value&gt; \n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n</code></pre>\n"},{"tags":["wpf","xaml","datagrid","binding"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":5240,"score":0,"question_id":5809816,"title":"Datagrid binding in WPF","body":"<p>I know this has been asked already but I have done almost everything what is suggested by developers.</p>\n\n<pre><code>&lt;DataGrid x:Name=\"Imported\" VerticalAlignment=\"Top\" DataContext=\"{Binding Source=list}\"  AutoGenerateColumns=\"False\" CanUserResizeColumns=\"True\"&gt;\n        &lt;DataGrid.Columns&gt;                \n            &lt;DataGridTextColumn Header=\"ID\" Binding=\"{Binding Path=ID}\"/&gt;\n            &lt;DataGridTextColumn Header=\"Date\" Binding=\"{Binding Path=Date}\"/&gt;\n           &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>I am trying to show this in modal dialog box and populating the license list in the constructor of the modal dialog box.\nBut still nothing is getting populated inside the datagrid.</p>\n\n<p>Constructor code:</p>\n\n<pre><code>public diagboxclass()\n{\n    List&lt;object&gt; list = new List&lt;object&gt;();\n    list = GetObjectList();\n}\n\npublic class object\n{\n    string id;\n    DateTime date;\n    public string ID\n    {\n        get { return id; }\n        set { id = value; }\n    }\n    public DateTime Date\n    {\n        get { return date; }\n        set { date = value; }\n    }\n}\n</code></pre>\n\n<p>Do you guys think something to do with the object list?</p>\n"},{"tags":["c#","wpf","mvvm","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13253963,"title":"Animate background of single datagrid cell on binding source updated","body":"<p>I would like to changed the background of a singe cell in a datagrid when the source is updated. I am using MVVM, C# and WPF:</p>\n\n<p>Here is my not working code form the xaml file (only the datacell itself):</p>\n\n<pre><code>&lt;DataGridTextColumn x:Name=\"test\" Header=\"Errors\" IsReadOnly=\"True\" Binding=\"{Binding ErrorsReceived}\"&gt;\n    &lt;DataGridTextColumn.CellStyle&gt;\n                    &lt;EventTrigger RoutedEvent=\"Binding.SourceUpdated\"&gt;\n                        &lt;BeginStoryboard&gt;\n                            &lt;Storyboard&gt;\n                                &lt;DoubleAnimation Storyboard.TargetName=\"test\"\n                                            Storyboard.TargetProperty=\"Background\"\n                                            From=\"Red\"\n                                            To=\"White\"\n                                            Duration=\"0:0:0.2\"/&gt;\n                            &lt;/Storyboard&gt;\n                        &lt;/BeginStoryboard&gt;\n                    &lt;/EventTrigger&gt;\n                &lt;/DataGridTextColumn.CellStyle&gt;\n            &lt;/DataGridTextColumn&gt;\n</code></pre>\n\n<p>How can I make this work?</p>\n"},{"tags":["wpf","silverlight","xaml","mvvm","binding"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12350109,"title":"Compile time checking of bindings?","body":"<p>I am moderately new to MVVM and I understand some of the benefits of MVVM over simple code behind xaml (for example testability of the VM). We are using Caliburn Micro to perform some of the binding but that's kind of irrelevant, I could be using specific binding {binding ...} and my question would more or less remain the same.</p>\n\n<p>I understand the logic that the VM should know nothing of the V if everything is done correctly, but it seems that because we are using dynamic run time binding between the V and the VM that the compiler can make no checks on the legality of each binding expression. For example if I have a UI component called UserName then Caliburn will try to bind that to a VM property called UserName at run time (similar to doing something like Value=\"{binding UserName}\"). However if I rename my VM property or misspell the UI component name or binding expression we get no indication of a problem until run time.</p>\n\n<p>It seems to me that it would be really nice to be able to tell the xaml that a UI component or page is going to be bound to a specific interface so that the compiler can do some of the work that will otherwise have to be done (and redone) by the test department (and that is me quite often).</p>\n\n<p>Is there a way to tell xaml that we are binding to an interface or object type? Is there some tool that can plug into a xaml application to validate bindings?</p>\n"},{"tags":["wpf","image","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12970304,"title":"Bind Image in DataTemplate to System.Drawing.Image","body":"<p>I am attempting to bind Image.Source in a DataTemplate to a System.Drawing.Image as discussed here: <a href=\"http://stackoverflow.com/questions/3427034/using-xaml-to-bind-to-a-system-drawing-image-into-a-system-windows-image-control\">using XAML to bind to a System.Drawing.Image into a System.Windows.Image control</a></p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;media:ImageConverter x:Key=\"imageConverter\" /&gt;\n    &lt;DataTemplate DataType=\"{x:Type data:GameTile}\" &gt;\n        &lt;StackPanel Orientation=\"Vertical\" Margin=\"5\" Background=\"Transparent\"&gt;\n            &lt;Viewbox&gt;\n                &lt;TextBlock FontWeight=\"Bold\" Text=\"{Binding PointValue}\" TextAlignment=\"Center\" FontSize=\"14\" /&gt;\n            &lt;/Viewbox&gt;\n            &lt;Image Margin=\"0,5,0,0\" Source=\"{Binding Path=Image.Image, Converter={StaticResource imageConverter}}\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n&lt;/UserControl.Resources&gt;\n    &lt;Grid&gt;\n        &lt;loop:ListBox x:Name=\"listBox1\" \n                         ItemsSource=\"{Binding Path=GameModel.Game.GameTiles}\"\n                         ItemContainerStyle=\"{StaticResource GameTileContainerStyle}\" Orientation=\"Vertical\" /&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>The GameTile object has an Image (not a system.drawing.image) property that points to a Picture object which has an Image property of type System.Drawing.Image.\nI am binding the ItemsSource on the ListBox to a GameTiles Collection on a Game object.</p>\n\n<p><strong>Objects</strong></p>\n\n<pre><code>public class Game\n{\n    public XPCollection&lt;GameTile&gt; GameTiles\n    {\n        get { return GetCollection&lt;GameTile&gt;(\"GameTiles\"); }\n    }\n}\n\npublic class GameTiles\n{\n    Picture fImage;\n    public Picture Image\n    {\n        get { return fImage; }\n        set { SetPropertyValue&lt;Picture&gt;(\"Image\", ref fImage, value); }\n    }\n}\n\npublic class Picture\n{\n\n    private FileData fFile;\n    public FileData File\n    {\n        get { return fFile; }\n        set\n        {\n            SetPropertyValue(\"File\", ref fFile, value);\n            if (string.IsNullOrEmpty(fName))\n            {\n                fName = (value == null ? string.Empty : value.FileName);\n            }\n            fImage = null;\n        }\n    }\n\n    Image fImage;\n    public System.Drawing.Image Image\n    {\n        get \n        {\n            if (fImage == null)\n            {\n                try\n                {\n                    MemoryStream stream = new MemoryStream();\n                    fFile.SaveToStream(stream);\n                    stream.Position = 0;\n                    fImage = Image.FromStream(stream);\n                }\n                catch \n                { \n                    //TODO: log exception\n                }\n            }\n            return fImage;\n        }\n        //set { SetPropertyValue&lt;Image&gt;(\"Image\", ref fImage, value); }\n    }\n}\n</code></pre>\n\n<p>The images are not showing up in the ListBoxItems, but any other property that I bind to in the DataTemplate will show up. It may be worth noting that I am using Devexpress Xpo as an ORM. Also the classes represented above do implement INotifyPropertyChanged.\nAny thoughts on what I may be missing?</p>\n\n<p>EDIT: Forgot to mention that I have implemented a value converter as mentioned in the post that I linked to above. However, if I put a breakpoint in the converter method, it is never called.</p>\n\n<p>EDIT: Added the fFile property to the code above.\nI can set an Image.Source to the GameTile.Image.Image property through c#(by converting it to BitmapImage), and have it work as expected, but I'm not sure how to accomplish that with a DataTemplate through c#. I would prefer to set the binding in XAML, but would settle for a c# workaround with a DataTemplate (or something else that would work). I am pretty confident that the issue is not with the GameTile.Image property pulling image from the database because if I manually set the source on an Image.Source in c#, the image is there. It simply isn't working in the DataTemplate.</p>\n\n<p>Edit: Determined the issue to be related to properties that are not directly on the DataType that I am binding to for example with  and GameTile has a (int)PointValue property, a (Picture object)Image property, and a (Prize object)Prize property.</p>\n\n<p>If I bind to</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding PointValue}\" /&gt; \n</code></pre>\n\n<p>it works as expected.\nBut if I bind to</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding Prize.Name}\" /&gt; \n</code></pre>\n\n<p>it does not work.\nAnd If I bind to</p>\n\n<pre><code>&lt;Image Margin=\"0,5,0,0\" Source=\"{Binding Image.BitmapImage}\" /&gt;\n</code></pre>\n\n<p>it fails also. The following graphic shows the error that is being thrown by the binding.</p>\n\n<blockquote>\n  <p>BindingExpression path error: 'Name' property not found on 'object'\n  ''XPCollection' (Hash=...)'. BindingExpression:Path=Prize.Name;\n  DataItem=GameTile' (HashCode=...); target element is\n  'TextBlock'(Name=''); target property is 'Text' (type 'String')</p>\n</blockquote>\n\n<p><img src=\"http://i.stack.imgur.com/SC8D1.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks,\nEric</p>\n"},{"tags":["wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13252092,"title":"Grid Header Mouse up event - WPF","body":"<p>I have a WPF  DataGrid and I have subscribed to the PreviewMouseUp event of the Grid. Now since the grid contains records and column headers, I can click either of them and the PreviewMoudeUp event will get triggered. How do I know whether I clicked the column Header or clicked the Row? Basically I want to get the exact control (either column header or the content row) within the grid. </p>\n\n<p>When I look at the sender, it always gives a reference to the Grid. But actually I want to know within the grid a reference to the header or row whichever is clicked and I need this information in the PreviewMouseUp event. Any help is appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Indira</p>\n"},{"tags":["c#","javascript","wpf","webbrowser-control","ihtmldocument2"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13253647,"title":"Getting return value from Javascript in C# Webbrowser control WPF","body":"<p>I made JavaScript injection into WebBrowser control in C# <code>(System.Windows.Controls.WebBrowser)</code>\nsuch that, <code>&lt;C#&gt;</code></p>\n\n<pre><code>        IHTMLDocument2 webdoc = (IHTMLDocument2)webBrowser1.Document;\n        string var = File.ReadAllText(\"C:/.../Resources/script.txt\");\n        object retVal = webdoc.parentWindow.execScript(var, \"Jscript\");\n</code></pre>\n\n<p>and the JavaScript file script.txt is,\n</p>\n\n<pre><code>var headID = document.getElementsByTagName('head')[0];\nvar newScript = document.createElement('script');\nnewScript.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'\nheadID.appendChild(newScript)\n\n$('body').bind('click',function(e){\n    var domsArray = [];\n    for (var i = 0; i &lt; 15; i++){\n        for (var j = 0; j &lt; 15; j++){\n            if (document.elementFromPoint(e.clientX+i, e.clientY+j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX+i, e.clientY+j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX+i, e.clientY+j));\n            }if (document.elementFromPoint(e.clientX-i, e.clientY+j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX-i, e.clientY+j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX-i, e.clientY+j));\n            }if (document.elementFromPoint(e.clientX+i, e.clientY-j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX+i, e.clientY-j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX+i, e.clientY-j));\n            }if (document.elementFromPoint(e.clientX-i, e.clientY-j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX-i, e.clientY-j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX-i, e.clientY-j));\n        }}}\nfor (var p = 0; p &lt; domsArray.length; p++){\n    alert(domsArray[p].href);\n}});\n</code></pre>\n\n<p>What it does is, whenever a user clicks on any point in webbrowser page, it collects the href near around that point.</p>\n\n<p>I wanted to return the href array, to my C# so that I can create buttons with those links.</p>\n\n<p>However, when I tried,</p>\n\n<pre><code>Console.WriteLine(retVal);\n</code></pre>\n\n<p>It didn't print anything on console.\nEven after I cast them into things like string or int with other dummy return values, it didn't print anything.\nAm I getting correct return?\nIs there any way that I can test the output return from javascript?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":2,"view_count":52,"score":3,"question_id":13253994,"title":"WPF Grid not keeping its Width and Height","body":"<p>I have a Canvas inside of a Grid in a WPF app. I want to draw a skeleton in Canvas from Kinect data. But the Canvas has a tiny width, probably 1px. The Grid makes it shrink, not keeping its set Width and Height. How to make Grid keep its declared size?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13137841,"title":"Exclude control from scrolling","body":"<p>I have a situation in which <code>ScrollViewer</code> is set in the base class (<code>Window</code>) and my user control is dynamicaly added as a content of the window. Now, I want one of the controls (<code>ToolBar</code>) in my user control  to be excluded from scrolling (to stay visible on top). I know there is a property <code>HandlesScrolling</code> on the <code>Control</code> class but it is internal. I have no way to put the toolbar outside the <code>ScrollViewer</code> because I don't have access to it.\nIs there any way to do this?</p>\n"},{"tags":["wpf","validation","focus"],"answer_count":6,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":9507,"score":8,"question_id":103575,"title":"WPF Validation Not Firing on First LostFocus of the TextBox","body":"<p>I am trying to validate the WPF form against an object. The validation fires when I type something in the textbox lose focus come back to the textbox and then erase whatever I have written. But if I just load the WPF application and tab off the textbox without writing and erasing anything from the textbox, then it is not fired. </p>\n\n<p>Here is the Customer.cs class: </p>\n\n<pre><code>public class Customer : IDataErrorInfo\n    {\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n\n        public string Error\n        {\n            get { throw new NotImplementedException(); }\n        }\n        public string this[string columnName]\n        {\n            get\n            {\n                string result = null;\n\n                if (columnName.Equals(\"FirstName\"))\n                {\n                    if (String.IsNullOrEmpty(FirstName))\n                    {\n                        result = \"FirstName cannot be null or empty\"; \n                    }\n                }\n                else if (columnName.Equals(\"LastName\"))\n                {\n                    if (String.IsNullOrEmpty(LastName))\n                    {\n                        result = \"LastName cannot be null or empty\"; \n                    }\n                }\n                return result;\n            }\n        }\n    }\n</code></pre>\n\n<p>And here is the WPF code: </p>\n\n<pre><code>&lt;TextBlock Grid.Row=\"1\" Margin=\"10\" Grid.Column=\"0\"&gt;LastName&lt;/TextBlock&gt;\n&lt;TextBox Style=\"{StaticResource textBoxStyle}\" Name=\"txtLastName\" Margin=\"10\"\n         VerticalAlignment=\"Top\" Grid.Row=\"1\" Grid.Column=\"1\"&gt;\n    &lt;Binding Source=\"{StaticResource CustomerKey}\" Path=\"LastName\"\n             ValidatesOnExceptions=\"True\" ValidatesOnDataErrors=\"True\"\n             UpdateSourceTrigger=\"LostFocus\"/&gt;         \n&lt;/TextBox&gt;\n</code></pre>\n"},{"tags":["wpf","binding","instance"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13253097,"title":"WPF Bind to resource instance","body":"<p>I have a ContextMenu defined in XAML and I modify it in code:</p>\n\n<pre><code>ContextMenu EditContextMenu;\nEditContextMenu  = (ContextMenu)this.FindResource(\"EditContextMenu\");\n//Modify it here...\n</code></pre>\n\n<p>Then, I need to set it as a <code>ContextMenu</code> for all TextBoxes, DatePickers, etc in a XAML theme file using data binding. I've tried adding a property to the main window :</p>\n\n<pre><code>    public ContextMenu sosEditContextMenu\n    {\n        get\n        {\n            return EditContextMenu;\n        }\n    }\n</code></pre>\n\n<p>...and binding it like this (the folowing is from a theme file with '<code>FTWin</code>' being the <code>Name</code> of my main window where the <code>sosEditContextMenu</code> property is defined):</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type TextBox}\"&gt;\n    &lt;Setter Property=\"ContextMenu\" Value=\"{Binding Source=FTWin, Path=sosEditContextMenu}\"/&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>...but it doesn't work. I've tried various things and I either got Exceptions about resources not being found or nothing happened.</p>\n\n<p>Is what I'm trying to do possible and, if yes, what am I doing wrong?\nI don't know if <a href=\"http://stackoverflow.com/questions/5129116/how-to-bind-a-single-object-instance-in-wpf\">setting the DataContext of an object could help</a>, but setting it for all TextBoxes by code is not so nice right?</p>\n"},{"tags":["wpf","tabs","navigation","issues"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13253719,"title":"WPF Issue with Tab Navigation","body":"<p>I have control template which is here:</p>\n\n<pre><code>&lt;ControlTemplate x:Key=\"DialogWindowTemplate\" TargetType=\"{x:Type w:DialogWindow}\"&gt;\n    &lt;Border d:DesignHeight=\"500\" d:DesignWidth=\"700\" CornerRadius=\"5\" Background=\"{StaticResource ContrastWhiteBrush}\"\n        BorderThickness=\"1\" BorderBrush=\"{StaticResource ContentNormalBrush}\"&gt;\n        &lt;Grid&gt;\n\n            &lt;StackPanel Grid.Row=\"0\" Orientation=\"Horizontal\" HorizontalAlignment=\"Right\"\n                    VerticalAlignment=\"Center\" Margin=\"10,0,10,0\"&gt;\n                &lt;Button Content=\"{TemplateBinding ActionName}\" Style=\"{StaticResource ButtonStyle}\"  KeyboardNavigation.TabIndex=\"1\"\n                    VerticalAlignment=\"Center\" Margin=\"10,0,10,0\" Padding=\"5,0,5,0\" FontWeight=\"Bold\" Height=\"30\" Width=\"75\"\n                    Command=\"{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActionCommand}\"/&gt;\n                &lt;TextBlock Text=\"{x:Static loc:Controls.Dialog_Or}\" Style=\"{StaticResource ContentNormalFontStyle}\"\n                       VerticalAlignment=\"Center\" Margin=\"0\"/&gt;\n                &lt;Button Style=\"{StaticResource CancelButtonStyle}\" VerticalAlignment=\"Center\" Margin=\"10,0,10,0\" KeyboardNavigation.TabIndex=\"2\"\n                    Command=\"{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CancelCommand}\"/&gt;\n            &lt;/StackPanel&gt;\n        &lt;/Grid&gt;\n    &lt;/Border&gt;\n&lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>This is .cs file</p>\n\n<pre><code> public DialogWindow()\n    {\n        // load the template\n        ResourceDictionary rd = new ResourceDictionary();\n        rd.Source = new Uri(TEMPLATE_URI);\n        this.Resources.MergedDictionaries.Add(rd);\n        this.Template = this.Resources[\"DialogWindowTemplate\"] as ControlTemplate;\n        this.WindowStyle = WindowStyle.None;\n        this.AllowsTransparency = true;\n        this.CommandBindings.Add(new CommandBinding(ApplicationCommands.Close, CloseCommandHandler));\n        this.CommandBindings.Add(new CommandBinding(_escCommand, CloseCommandHandler));\n    }\n</code></pre>\n\n<p><strong>My issue is : I tried all possible options but Tab Navigation does not work for those Buttons. But when I press Ctrl + Tab then it works. I tried this KeyBoard.ControlTabNavigation = \"None\" also. but It doesn't work.</strong></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13253384,"title":"Adding ProgressBar to DataGrid column","body":"<p>I have a WPF application where i would like to show a progressbar in a datagrid column. Here's what i have so far:</p>\n\n<pre><code>    &lt;DataGrid Name=\"dgOrders\" ItemsSource=\"{Binding}\" AutoGenerateColumns=\"False\" HorizontalGridLinesBrush=\"#35000000\" VerticalGridLinesBrush=\"#35000000\" BorderThickness=\"1\" CanUserAddRows=\"False\" CanUserReorderColumns=\"False\" CanUserResizeRows=\"False\" CanUserSortColumns=\"False\" EnableRowVirtualization=\"False\" IsReadOnly=\"True\" RowHeaderWidth=\"0\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTemplateColumn Header=\"Progress\" Width=\"*\" Visibility=\"Hidden\"&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;ProgressBar Value=\"{Binding Path=ProgressValue, Mode=OneWay}\" Minimum=\"0\" Maximum=\"100\" /&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>This works and i get nice progressbars on every row. Now here comes the part i get confused: i use this datagrid inside a <code>UserControl</code> what is then used in a <code>Page</code> like this: </p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Controls:OrderDataGrid x:Name=\"cntrlOrderDataGrid\"&gt;&lt;/Controls:OrderDataGrid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>And the pages are loaded from a <code>Frame</code>. </p>\n\n<p>The question is how and where i should implement the class and the <code>ProgressValue</code> so it would update my <code>ProgressBar</code> value binding.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13249895,"title":"Binding single property to parent items source","body":"<p>I want to show a list of questions in a ListBox. Each ListBoxItem contains the question and a ListBox with RadioButtons that show the answer options. The ItemsSource of the first ListBox is an observerable collection with objects of class Question. The ItemsSource of the second ListBox is a list property in QuestionClass: QuestionObj.Answers.\nMy problem is to bind RadioButton property GroupName to the Question property QuestionObj.Index. How can I solve this?</p>\n\n<p>Here is the code of class Question:</p>\n\n<pre><code>public class Question\n{\n    private static int countQuestions;\n\n    private int index;\n    private string questionText;\n    private List&lt;String&gt; answers = new List&lt;String&gt;();\n\n    public Question()\n    {\n        countQuestions++;\n    }\n    public Question(string type, bool isRequired, string questionText, List&lt;String&gt; answers = null) :this()    \n    {\n        this.index = countQuestions;\n        this.questionText = questionText;\n        this.answers = answers;\n    }\n\n    public int Index\n    {\n        get { return index; }\n    }\n    public string QuestionText\n    {\n        get { return questionText; }\n    }\n    public List&lt;String&gt; Answers\n    {\n        get { return answers; }\n    }\n}\n</code></pre>\n\n<p>and here the xaml:</p>\n\n<pre><code>&lt;ListBox x:Name=\"Questions\" ItemsSource=\"{Binding QuestionList}\" &gt;\n    &lt;ListBox.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;Grid&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition/&gt;\n                    &lt;RowDefinition/&gt;\n                &lt;/Grid.RowDefinitions&gt;\n                &lt;Label Grid.Row=\"0\" Content=\"{Binding QuestionText}\"/&gt;\n                &lt;ListBox x:Name=\"AnswerOptions\" Grid.Row=\"1\" ItemsSource=\"{Binding Answers}\"&gt;\n                    &lt;ListBox.ItemTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;RadioButton Content=\"{Binding}\" GroupName={Binding ??????}/&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/ListBox.ItemTemplate&gt;\n                &lt;/ListBox&gt;\n            &lt;/Grid&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListBox.ItemTemplate&gt;\n&lt;/ListBox&gt;\n</code></pre>\n"},{"tags":["c#","wpf","listview"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13252515,"title":"WPF Listview binding and cell background color","body":"<p>I have built a small tool where users enter SQL, hit an execute button and get the results in a listview. This was very simple using C# and WPF but now I'd like to hightlight data whose value is null (more specifically System.DBNull).</p>\n\n<p>Here's what I've done. <em>I'm adding this in hopes that it might really handy to others.</em></p>\n\n<p>My XAML is quite simple, I just have a listview. </p>\n\n<p><strong>I won't know the columns until i execute the query because they are dependent on the results of that query.</strong></p>\n\n<pre><code>&lt;ListView Grid.Row=\"3\" Name=\"listviewResults\" /&gt;\n</code></pre>\n\n<p>Upon executing my query I end up with a DataTable as expected. I set the columns with the following code.</p>\n\n<pre><code>GridView gv = new GridView();\nforeach (DataColumn col in dt.Columns)\n{\n    GridViewColumn gvCol = new GridViewColumn();\n    string colHdr = \"\";\n    foreach (char c in col.ColumnName)\n    {\n        colHdr += c;\n        if (c == '_')\n            colHdr += '_';\n    }\n    gvCol.Header = colHdr;\n    gvCol.DisplayMemberBinding = new Binding(col.ColumnName);\n    gv.Columns.Add(gvCol);\n}\nlistviewResults.View = gv;\n</code></pre>\n\n<p>And I set the ItemsSource as follows.</p>\n\n<pre><code>listviewResults.ItemsSource = ((IListSource)dt).GetList();\n</code></pre>\n\n<p>Simple enough right? This gives me a listview that has columns and data that result from my query.\nNow come the questions.</p>\n\n<ol>\n<li><p>What properties am I actually binding to when I set the ItemsSource like this? It's col.ColumnName right? </p></li>\n<li><p>How do you setup DataTriggers on dynamic property bindings like I have?</p></li>\n<li><p>How do you set the background of a single cell in  a DataTrigger? All of the examples I've found set the whole row background.</p></li>\n<li><p>Is there any way to programatically set the background of a cell? This is the type of thing that drives me bonkers in WPF.</p></li>\n</ol>\n\n<p>Thank you!</p>\n"},{"tags":["c#","wpf","windows"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13252162,"title":"Print table and control","body":"<p>i have a form created by wpf. I use c# and xaml.\ncan i Print and save that form to be document file like pdf or word document?\nif it can, how to do that?</p>\n\n<p>i need your help.</p>\n\n<p>may be this is can </p>\n\n<p>if it can not, is there other solution?</p>\n\n<p>this is refrence code i use.</p>\n\n<pre><code>&lt;FlowDocumentReader&gt;\n\n\n&lt;FlowDocument&gt;\n\n    &lt;Table CellSpacing=\"5\"&gt;\n\n      &lt;Table.Columns&gt;\n        &lt;TableColumn/&gt;\n        &lt;TableColumn/&gt;\n        &lt;TableColumn/&gt;\n        &lt;TableColumn/&gt;\n      &lt;/Table.Columns&gt;\n\n      &lt;TableRowGroup&gt;\n\n        &lt;!-- Title row for the table. --&gt;\n        &lt;TableRow Background=\"SkyBlue\"&gt;\n          &lt;TableCell ColumnSpan=\"4\" TextAlignment=\"Center\"&gt;\n            &lt;Paragraph FontSize=\"24pt\" FontWeight=\"Bold\"&gt;Planetary Information&lt;/Paragraph&gt;\n          &lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Header row for the table. --&gt;\n        &lt;TableRow Background=\"LightGoldenrodYellow\"&gt;\n          &lt;TableCell&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;Planet&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;Mean Distance from Sun&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;Mean Diameter&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;Approximate Mass&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Sub-title row for the inner planets. --&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell ColumnSpan=\"4\"&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;The Inner Planets&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Four data rows for the inner planets. --&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Mercury&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;57,910,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;4,880 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;3.30e23 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow Background=\"lightgray\"&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Venus&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;108,200,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;12,103.6 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;4.869e24 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Earth&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;149,600,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;12,756.3 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;5.972e24 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow Background=\"lightgray\"&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Mars&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;227,940,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;6,794 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;6.4219e23 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Sub-title row for the outter planets. --&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell ColumnSpan=\"4\"&gt;&lt;Paragraph FontSize=\"14pt\" FontWeight=\"Bold\"&gt;The Major Outer Planets&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Four data rows for the major outter planets. --&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Jupiter&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;778,330,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;142,984 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;1.900e27 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow Background=\"lightgray\"&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Saturn&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;1,429,400,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;120,536 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;5.68e26 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Uranus&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;2,870,990,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;51,118 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;8.683e25 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n        &lt;TableRow Background=\"lightgray\"&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;Neptune&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;4,504,000,000 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;49,532 km&lt;/Paragraph&gt;&lt;/TableCell&gt;\n          &lt;TableCell&gt;&lt;Paragraph&gt;1.0247e26 kg&lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n        &lt;!-- Footer row for the table. --&gt;\n        &lt;TableRow&gt;\n          &lt;TableCell ColumnSpan=\"4\"&gt;&lt;Paragraph FontSize=\"10pt\" FontStyle=\"Italic\"&gt;\n            Information from the \n            &lt;Hyperlink NavigateUri=\"http://encarta.msn.com/encnet/refpages/artcenter.aspx\"&gt;Encarta&lt;/Hyperlink&gt; \n            web site.\n            &lt;/Paragraph&gt;&lt;/TableCell&gt;\n        &lt;/TableRow&gt;\n\n      &lt;/TableRowGroup&gt;\n    &lt;/Table&gt;\n  &lt;/FlowDocument&gt;\n&lt;/FlowDocumentReader&gt;\n</code></pre>\n"},{"tags":["c#","wpf","data-binding","controltemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13251386,"title":"Button with 2 texts, binding via controltemplate","body":"<p>I want to make multiple buttons like this</p>\n\n<pre><code>        &lt;Button&gt;\n            &lt;Grid&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition Width=\"3*\"&gt;&lt;/ColumnDefinition&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n\n                &lt;Label Grid.Column=\"0\" name=\"lblShortcut\"&gt;F1&lt;/Label&gt;\n                &lt;Label Grid.Column=\"1\" name=\"lblText\"&gt;search&lt;/Label&gt;\n            &lt;/Grid&gt;\n        &lt;/Button&gt;\n</code></pre>\n\n<p>So I know that I have to work with something like a Template, and I want to bind those buttons to a class like this:</p>\n\n<pre><code>        class SearchButtonContent\n        {\n                public string Shortcut { get ; set; }\n                public string Text { get ; set; }\n        }\n</code></pre>\n\n<p>In such way that a <code>Shortcut</code> is bound to <code>lblShortcut</code> and <code>Text</code> to <code>lblText</code>. What is the best way to achieve this with elegant templates, with the possibility to make those buttons in code at runtime?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13249891,"title":"Why can I not assign a Name value to UserControls that are scoped as Internal in WPF?","body":"<p>I have a UserControl, which I have set to Internal as such:</p>\n\n<pre><code>UserControl x:Class=\"ClassName\"\n             x:ClassModifier=\"internal\"</code></pre>\n\n<p>And it's matching .cs file:</p>\n\n<pre><code> internal partial class ClassName : UserControl\n    {\n        public ClassName()\n        {\n            InitializeComponent();\n        }\n    }</code></pre>\n\n<p>Now, when I try to use the control on a window, like this:</p>\n\n<pre><code> uControls:ClassName x:Name=\"instanceName\" Margin=\"0,0,8,0\" Height=\"60\" VerticalAlignment=\"Top\" Width=\"60\" HorizontalAlignment=\"Right\" MouseLeftButtonUp=\"instanceName_MouseLeftButtonUp\" Cursor=\"ScrollNW\" </code></pre>\n\n<p>I get an error stating:</p>\n\n<pre><code>The type 'ClassName' cannot have a Name attribute. Value types and types without a default constructor can be used as items within a ResourceDictionary. Line 12 Position 44.</code></pre>\n\n<p>If I change the access modifiers to public, all works as expected.</p>\n\n<p>Why can I not have internal User Controls?</p>\n"},{"tags":["wpf","data-binding","c#-4.0","polyline"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2183,"score":1,"question_id":3960101,"title":"Polyline using DataBinding and PointCollection for continuous update","body":"<p><br>\nfirst of all I describe my objective I want to achive. I want to visualise a continuous data stream (maximum 1000 values per second but could be reduced). This data stream should be visualised as a chart - being more precise it's a visualisation of an ECG among other things. \nMy first idea was using polyline and bind it to a point collection. The problem here is that nothing is shown on the UI. Perhaps it's a wrong aproach for this task. Better ideas are welcomed. Here ist my code so far. First the View:\n<pre><code> \n<code>&lt;Canvas&gt;</code>\n  <code>&lt;Polyline Points=\"{Binding Points}\" Stroke=\"Red\" StrokeThickness=\"2\" /&gt;</code>\n<code>&lt;/Canvas&gt;</code>\n</pre></code></p>\n\n<p>For the sake of simplicity I use the code-behind even though I use the MVVM-pattern. That's also the reason why I want to use the binding and not just the name of the polyline and add the values.\n<pre><code>\npublic partial class MainWindow : Window\n{\n   private short[] data = new short[]{ 10,30,50,70,90,110,130,150,170,190,210 };\n   private short[] data1 = new short[] { 15,14,16,13,17,12,18,11,19,10,24 };</p>\n\n<pre><code>    public MainWindow()\n    {\n        InitializeComponent();\n        for (int i = 0; i &lt; data.Length; i++)\n        {\n            Points.Add(new Point(data[i], data1[i]));\n        }\n    }\n\n    private PointCollection _points = new PointCollection();\n    public PointCollection Points\n    {\n        get { return _points; }\n    }\n</code></pre>\n\n<p>}\n</pre></code>\nI know that is no good coding style but for first tests its enough for me. I use array data for x-values and data1 for y-values. Can anyone tell me whats wrong with that binding? What's to be done for a continuous update of the view, whenever new values occur?<br>\nThanks for your help in advance.   </p>\n\n<p>[Updated new version]\nThe view: \n<pre><code>\n<code>&lt;Window.Resources&gt;</code>\n        <code>&lt;my:PointCollectionConverter x:Key=\"myPointsConverter\"/&gt;</code>\n<code>&lt;/Window.Resources&gt;</code>\n    <code>&lt;Grid Name=\"grid\"&gt;</code>\n        <code>&lt;Polyline x:Name=\"ekglineI\" Points=\"{Binding Points, Converter={StaticResource myPointsConverter}}\" Stroke=\"Red\" StrokeThickness=\"2\"  /&gt;</code>\n        <code>&lt;Button Content=\"Button\" Click=\"button1_Click\" /&gt;</code>\n<code>&lt;/Grid&gt;</code>\n</pre></code>\nThe code-behind which draws a polyline on startup and later on when a button is clicked.\n<pre><code>\npublic partial class MainWindow : Window, INotifyPropertyChanged\n    {\n        private short[] data = new short[] { 10, 30, 50, 70, 90, 110, 130, 150, 170, 190, 210 };\n        private short[] data2 = new short[] { 230, 250, 270, 290, 300, 310, 330, 350, 370, 390, 410 };\n        private short[] data1 = new short[] { 15, 14, 16, 13, 17, 12, 18, 11, 19, 10, 24 };</p>\n\n<p>public MainWindow()\n        {\n            InitializeComponent();\n            grid.DataContext = this;\n            for (int i = 0; i &lt; data.Length; i++)\n            {\n                Points.Add(new Point(data[i], data1[i]));\n            }\n        }\n        public event PropertyChangedEventHandler PropertyChanged;\n        private ObservableCollection _points = new ObservableCollection();\n        public ObservableCollection Points\n        {\n            get { return _points; }\n        }</p>\n\n<pre><code>    private void button1_Click(object sender, RoutedEventArgs e)\n    {\n        for (int i = 0; i &lt; data2.Length; i++)\n        {\n            Points.Add(new Point(data2[i], data1[i]));\n        }\n        PropertyChanged(this, new PropertyChangedEventArgs(\"Points\"));\n    }\n</code></pre>\n\n<p></pre></code></p>\n\n<p>Now what I want to do is getting rid of this line: <code>grid.DataContext = this;</code> so that I can use my MVVM or is there another possibility?</p>\n"},{"tags":["c#","wpf","textbox","format","currency"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":351,"score":3,"question_id":9463271,"title":"Formating textbox string for currency","body":"<p>i have a textbox in WPF and i would like yo dynamically show the currency symbol , i.e. when the user edits the textbox and the textbox loses the focus , the currency symbol is automatically inserted at the end (beginning) , i prefer it in XAML rather than hard-coding.\n i would like to mention that my textbox is <strong>not binded</strong> to anything.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13252391,"title":"Finding items in listview by typing first letter WPF","body":"<p>I have a listview which binds customer informations from database. There are 15 columns which are binded in that listview. One of that column is Customer Name.  </p>\n\n<p>I want to be focused them when I type their  name's initial character from the keyboard. Have you any idea to make this ?  </p>\n\n<p>This is my listview's XAML code</p>\n\n<pre><code>&lt;ListView x:Name=\"datalist\" ButtonBase.Click=\"datalist_Click\" ContextMenuOpening=\"datalist_ContextMenuOpening\" MouseDoubleClick=\"datalist_MouseDoubleClick\" SelectionChanged=\"datalist_SelectionChanged\"\nMouseUp=\"datalist_MouseUp\" PreviewMouseUp=\"datalist_PreviewMouseUp\" &gt;\n</code></pre>\n"},{"tags":["c#","wpf","deployment","runtime","app-config"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13251077,"title":"Need changable App.config file in WPF","body":"<p>I have a desktop WPF application which uses Entity Framework 4.1 Code First approach to manage data. </p>\n\n<p>EF adds a connection string to the App.config file and I wan't to be able to change this connection string at runtime.</p>\n\n<p>Scenario is like this: </p>\n\n<p>When I deploy the application it has a default connection string in the App.config file. The user runs the application and since the connection string will probably be invalid for the user (because of server name, user id and password) I will display a server configuration window.</p>\n\n<p>Here user will enter the valid information about his connection and press OK. I will then be able to change the App.config file and save the user's new valid information to the file.</p>\n\n<p>Problems: </p>\n\n<p>If I change it using ConfigurationManager, the changes will be temporary meaning that the file is not saved, changes are made in memory.</p>\n\n<p>If I read the App.config file into a stream, make required changes in the memory, delete physical file and save the in memory stream as App.config again, Windows will not let me make changes to files under ProgramFiles folder.</p>\n\n<p>What is would be the best approach here?</p>\n\n<p><strong>EDIT: Problem Again!</strong></p>\n\n<p>After I modify the App.config file with this method:</p>\n\n<pre><code>private void ApplyChangesToConnectionString()\n{\n    var config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);\n    var connectionStringsSection = (ConnectionStringsSection)config.GetSection(\"connectionStrings\");\n    connectionStringsSection.ConnectionStrings[\"SomeUniqueName\"].ConnectionString = GetChangesAppliedConnectionString(connectionStringsSection.ConnectionStrings[\"SomeUniqueName\"].ConnectionString);\n    config.Save(); // This line throws an exception\n    ConfigurationManager.RefreshSection(\"connectionStrings\");   \n}\n</code></pre>\n\n<p><code>config.Save();</code> method call throws an error saying </p>\n\n<blockquote>\n  <p>\"Access to \"C:\\Program Files (x86)\\MyCompany\\MyApp\\MyApp.exe.config\"\n  is denied.\"</p>\n</blockquote>\n\n<p>I know that files under \"Program files\" are immutable, so how can I handle this?</p>\n"},{"tags":["wpf","inversion-of-control","unity","containers","where"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":193,"score":2,"question_id":10372463,"title":"Where to place and configure IoC container in a WPF application?","body":"<p>I am working on a middle sized WPF application (MVVM) that should be extensible and maintainable in the future. Thus I decided to use an IoC container (Unity in this case) to keep things flexible. </p>\n\n<p>However I am not sure where to place and configure Unity in a WPF application. </p>\n\n<p>I guess container should be accessible globally so it should probably go to Application class. But should I make it as static property? Should I configure it in Application_Startup() event handler?  </p>\n\n<p>Eg:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Interaction logic for App.xaml\n/// &lt;/summary&gt;\npublic partial class App : Application\n{\n    public static UnityContainer MyUnityContainer;\n\n\n    private void Application_Startup(object sender, StartupEventArgs e)\n    {\n        // instantiate and configure Unity\n    }\n}\n</code></pre>\n\n<p>This way I will be able to access container from any place in the application via static property:</p>\n\n<pre><code>App.MyUnityContainer\n</code></pre>\n\n<p>I guess this is one way to do it but I am not sure if there are better practices for this issue, specifically for WPF apps.</p>\n"},{"tags":["c#",".net","wpf","oop","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13251081,"title":"how to use 2 constructor in MVVM in wpf?","body":"<p>I want to use a different constructor in a WPF MVVM project. First one is used in MDI form. But second constructor usage is over another form which have been sending a parameter to second one. How can I use it? </p>\n\n<pre><code>public MyModelView()\n{\n    InitializeComponent();\n    tlb.SelectVisibility = System.Windows.Visibility.Visible;\n}\n\npublic MyModelView(MyViewModel test)\n{\n    InitializeComponent();\n    DataContext = test;\n    tlb.SelectVisibility = test.Visibility;\n}\n</code></pre>\n\n<p>I have two constructors. But I have a datacontext in xaml side. The error is</p>\n\n<p><code>Xaml parse exception: 'The invocation of the constructor on type 'XYZ.AP.UI.ViewModel.MyViewModel' that matches the specified binding constraints threw an exception.' Line number '15' and line position '6'.</code></p>\n\n<pre><code>&lt;Windows:TransactionWindow.DataContext&gt;\n    &lt;ViewModel:MyViewModel /&gt;\n&lt;/Windows:TransactionWindow.DataContext&gt;\n</code></pre>\n"},{"tags":["c#","wpf","textbox","passwordbox"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13250642,"title":"Block double byte chars in a textbox","body":"<p>I am working on a WPF .net 3.5 application.</p>\n\n<p>I need to create my own Passwordbox, because of security issues with the built in one.\nthe new PasswordwordBox is based on a regular TextBox.</p>\n\n<p>Everything is working fine, only that in the WPF Passwordbox double bytes characters are blocked, and I want to add this behavior also to my new PasswordBox.</p>\n\n<p>How can I do that? </p>\n"},{"tags":["c#","wpf","httpwebrequest"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13247279,"title":"WPF(C#) how to use a post request to transfer file?","body":"<p>I have a picture that is presented in the form of a byte array. I need to save it to a file and send a post request. Tell me how to do it better</p>\n\n<p>Here is what I do</p>\n\n<pre><code>private Stream file;\n\n\n public void Fun1()\n\n  {\n\n   using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Create))\n\n      {\n\n       file.Write(bt, 0, bt.Length);\n       _cookies = DataHolder.Instance.Cookies;\n       HttpWebRequest request = (HttpWebRequest)WebRequest.Create(String.Concat(\"http://   Mysite.com/image.php?image=FILE\",file));\n            request.Method = \"POST\";\n            request.ContentType = \"multipart/form-data\";\n            request.CookieContainer = _cookies;     \n            request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallbackPlayersfun1), request);\n\n      }\n\n   }\n\n private void GetRequestStreamCallbackPlayersfun1(IAsyncResult asynchronousResult)\n\n{\n\n        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n        Stream postStream = request.EndGetRequestStream(asynchronousResult);\n using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Open))\n        {\n\n            BinaryReader br = new BinaryReader(file, Encoding.UTF8);\n            byte[] buffer = br.ReadBytes(2048);\n            while (buffer.Length &gt; 0)\n            {\n                postStream.Write(buffer, 0, buffer.Length);\n                buffer = br.ReadBytes(2048);\n            }\n        }\n        postStream.Close();\n\n        request.BeginGetResponse(new AsyncCallback(ReadCallbackSavePlayersfun1), request);\n\n}\n\n private void ReadCallbackSavePlayersfun1(IAsyncResult asynchronousResult)\n\n{\n\n  lock (__SYNC)\n\n{\n\n    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n                HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);\n\n            }\n        }\n</code></pre>\n\n<p>As a result, the server did not come, tell me what am I doing wrong</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13250563,"title":"FileUpload in wpf ( Access to the path is denied)","body":"<pre><code> public void Uploader(string filename, Stream Data)\n        {\n\n            BinaryReader reader = new BinaryReader(Data);\n            string path = @\"C:/Friendisc/Images\";            \n            FileStream fstream = new FileStream(path, FileMode.CreateNew);\n            BinaryWriter wr = new BinaryWriter(fstream);\n            wr.Write(reader.ReadBytes((int)Data.Length));\n            wr.Close();\n            fstream.Close();\n            Data.Close();\n        }\n</code></pre>\n\n<p>I am getting the error: Access to the path is denied.\nWhat do I need to do?</p>\n\n<p>Also How would I upload the image on another project within the same solution?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13236851,"title":"How to force a listbox to always have at least one item selected and highlighted?","body":"<p>My WPF C# program has a listbox that holds items that the user can manipulate: changing the order, copy/paste, etc.  Currently, when I select an item in the listbox, then click the move up button, the item will move up the list, but then the item is no longer highlighted or selected.  So, I cannot do consecutive manipulations without reselecting the listbox item. </p>\n\n<p>How can I force my listbox to retain it's selection and highlighting?</p>\n"},{"tags":["c#",".net","wpf","resources","expression-blend"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13235655,"title":"Modify Resource in Design Time, with code behind in WPF project","body":"<p><strong>What I'm trying to do right now:</strong> Modify the Expression Blend UI / Visual Studio, to add a button on one of my dependency properties, and when I click on it, it creates a new trigger.</p>\n\n<p><strong>What is working</strong>: I created the button, it appears in the UI, that's fine.</p>\n\n<p><strong>What is not working</strong>: I cannot modify the Resource to add a trigger (if I step in, it works but it does not modify on the global resource, only on the instance I think).</p>\n\n<p>I have my main project in Visual Studio, and a property with a button like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/hCSbB.png\" alt=\"Visual Studio UI\"></p>\n\n<p>When the button is pressed this is what happens:</p>\n\n<ul>\n<li>I get my Control that contains that dependency property (Ok). </li>\n<li>I searched for the Resource file that contains the Resource I want to modify (Ok).</li>\n<li>I update the Resource, but it does not replace the Resource on disk.</li>\n</ul>\n\n<p>I think that it's because I only modify it on memory, so it's in the \"air\"</p>\n\n<p>I don't know where to go now... I need help</p>\n\n<p>The code behind where I modify the Resource is in an other DLL, the MyLibrary.<strong>Design</strong>.cs</p>\n\n<p>I'm using Visual Studio 2010 / Blend 4 / .NET 4.0</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":13167800,"title":"Split over-tall WPF RichTextBox into multiple controls","body":"<p>I'm trying to get the content height of a RichTextBox and if it exceeds 500px, split it into multiple RichTextBoxes with the maximum height of 500px.</p>\n\n<p>Anyone know how to do this? Thanks.</p>\n\n<p>EDITED:</p>\n\n<p>by \"split\" I mean put the content that exceeds the height limit in another RichTextBox, the solution can't just change the appearence of the current RichTextBox due to project specificities.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":65,"score":-1,"question_id":13250329,"title":"How to validate the url using c#?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4835269/how-to-check-that-a-uri-string-is-valid\">How to check that a uri string is valid</a>  </p>\n</blockquote>\n\n\n\n<p>I have a text box where user is supposed to enter a URL , How can I\nprogrammatically figure out the a URL that user has been entered is valid or\nnot ,If it valid have to process further process else have to enter valid url?</p>\n\n<p>I try this code:</p>\n\n<pre><code>string url = textBox1.Text;\nif (!url.StartsWith(\"http://\"))\n    url = \"http://\" + url;\nUri myUri;\nif(Uri.TryCreate(url,UriKind.RelativeOrAbsolute,out myUri))\n{\n    //use the uri here\n}\nelse\n{\n    MessageBox.Show(\"Please Enter the Absolute URL name\");\n    textBox1.Clear();\n    textBox1.Focus();\n}\n</code></pre>\n"},{"tags":["c#","wpf","xaml","data-binding","combobox"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6154,"score":1,"question_id":6854308,"title":"WPF Databinding combobox to a list<string>","body":"<p>i am having hard luck in trying to bind my property which is of type List to my combobox through XAML.</p>\n\n<pre><code>public List&lt;string&gt; MyProperty  { get; set; }\n</code></pre>\n\n<p>xaml binding </p>\n\n<pre><code>&lt;ComboBox Name=\"cboDomainNames\" ItemsSource=\"{Binding Path=MyProperty}\"/&gt; \n</code></pre>\n\n<p>but on trying to assign</p>\n\n<pre><code>cboDomainNames.ItemsSource = MyProperty;\n</code></pre>\n\n<p>works perfect!!!!</p>\n\n<p>Just wondering what i am missing here! </p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13230785,"title":"Visual Studio 2012 XAML Designer - Cannot add more than one item","body":"<p>I'm new to VS 2012, and I have this issue every time I use the <strong>XAML Designer</strong>.</p>\n\n<p>Every time I add an item (e.g. a RadioButton, and Image, a Label) to my window, it deletes the previous one.</p>\n\n<p>As a result, I can have only one item in my window, I know it is absurd, what am I missing?</p>\n\n<p>Here is the xaml of the window</p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:WpfViewers=\"clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers\" xmlns:Toolkit=\"clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"KinectSetupDev.MainWindow\"\n    Title=\"MainWindow\" Height=\"400\" Width=\"600\"&gt;\n    &lt;Toolkit:KinectSensorChooserUI x:Name=\"SensorChooserUI\" VerticalAlignment=\"Center\" Height=\"40\" Margin=\"277,2,275,328\"/&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Here is the xaml of the window after dragging an image on it (from the Toolbox)</p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:WpfViewers=\"clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers\" xmlns:Toolkit=\"clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"KinectSetupDev.MainWindow\"\n    Title=\"MainWindow\" Height=\"400\" Width=\"600\"&gt;\n&lt;Image HorizontalAlignment=\"Left\" Height=\"86\" Margin=\"77,188,0,0\" VerticalAlignment=\"Top\" Width=\"111\"/&gt;\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":7,"view_count":56,"score":-7,"question_id":13247788,"title":"how could we use extended method in .net?","body":"<p>Explain with example or any Link to give a solution briefly.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13248852,"title":"Simulate MouseClick on Background Form","body":"<p>Is it possible to simulate a mouseclick on a Form that is minimized, or behind other forms, without giving it the focus and bringing it up in the foremost position?</p>\n\n<p>I've got the code to simulate a mouse click, and it works just fine, but it needs the co-ords of the click and it doesn't accept in input the Form address.</p>\n"},{"tags":["c#",".net","wpf","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13249356,"title":"Exists any way (or advice) to speed-up c#/WPF projects build?","body":"<p>I have the application (solution in VS2010) with +-10 projects. Some of these projects are quite large (dozens of folders and hundreds of files).</p>\n\n<p>When I make a change in project on lower level and I want to run my tests (+-10 seconds) then I have to wait 2 minutes for projects build.\nThis is very inefficient.</p>\n\n<p>Is there any way to speed-up build? For example, split current projects into multiple projects or something else?</p>\n\n<p>Or are there some general advice and recommendations to speed-up building projects in Visual Studio?</p>\n"},{"tags":["c#","wpf","browser"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13249326,"title":"Alternative to WebBrowser for transparent window","body":"<p>Can anyone suggest an alternative to the WebBrowser control that will work on a window with AllowsTransparency = true. I've written my own base window class with custom chrome.</p>\n\n<p>I just want to display some basic HTML (text + images) from a string generated at runtime, so no Javascript / ActiveX etc support is required. I'd prefer to do without the additional payload of a full browser wrapper such as <a href=\"https://bitbucket.org/geckofx\" rel=\"nofollow\">GeckoFX</a> or <a href=\"https://github.com/chillitom/CefSharp\" rel=\"nofollow\">CefSharp</a>.</p>\n\n<p>I've tried writing a control based on the <a href=\"http://blogs.msdn.com/b/wpfsdk/archive/2006/05/25/xaml-flowdocument-to-html-conversion-prototype.aspx\" rel=\"nofollow\">HTML to XAML FlowDocument converter</a> but this doesn't support images and also doesn't always render table borders correctly.</p>\n"},{"tags":["wpf","list","data-binding","datatemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13248857,"title":"WPF Composite data template","body":"<p>I've faced the following problem:</p>\n\n<p>I have my hierarchical data in one composite ObservableCollection, where list elements are pairs of one ConfigurationDescriptor and list of JobDescriptors. \nSo I store 1-to-N relations (many JobDescriptors can be linked to only one ConfigurationDescriptor). So I've created an new type, named DescriptorCoupling. </p>\n\n<pre><code>public class DescriptorCoupling\n{\n    private ConfigurationDescriptor configurationDescriptor;\n    private ObservableCollection&lt;JobDescriptor&gt; jobDescriptors = new ObservableCollection&lt;JobDescriptor&gt;();\n\n//...\n}\n\npublic class InitialViewModel\n{\n    private ObservableCollection&lt;ConfigurationDescriptor&gt; configurationDescriptors = new ObservableCollection&lt;ConfigurationDescriptor&gt;();\n    private ObservableCollection&lt;JobDescriptor&gt; jobDescriptors = new ObservableCollection&lt;JobDescriptor&gt;();\n\n    private ObservableCollection&lt;DescriptorCoupling&gt; batchList = new ObservableCollection&lt;DescriptorCoupling&gt;();\n\n    //...\n}\n</code></pre>\n\n<p>How could I bind my BatchList collection, to one ItemsControl/ListBox/ListView element, if I want my outer and inner collection of elements to be represented as list elements in the list (in TreeView like form, with composite reorganization functionality).</p>\n\n<p>example (where every line is a single ListItem):</p>\n\n<pre><code>&lt;ListItem&gt;  - conf_01   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_1   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_2   &lt;/ListItem&gt;\n&lt;ListItem&gt;  - conf_02   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_1   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_3   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_4   &lt;/ListItem&gt;\n&lt;ListItem&gt;  - conf_03   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_3   &lt;/ListItem&gt;\n&lt;ListItem&gt;  --- job_1   &lt;/ListItem&gt;\n</code></pre>\n\n<p>(I want to be able to reorganize my outer and inner list elements, so the reorganization has only effect on the correct level of the hierarchy.)\nIs there something with a composite data template functionality to do this in XAML?</p>\n\n<p>Thank you for your help.</p>\n"},{"tags":["c#","wpf","data-binding","modelvisual3d"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13249045,"title":"Databinding ModelVisual3D","body":"<p>I've been trying to implement a coverflow in my WPF application using this tutorial:</p>\n\n<p><a href=\"http://d3dal3.blogspot.dk/2008/10/wpf-cover-flow-tutorial-part-1.html\" rel=\"nofollow\">Ded's coverflow tutorial</a></p>\n\n<p>Right now, I'm adding covers in code-behind like so:</p>\n\n<pre><code>    List&lt;TVSeries&gt; series = theTvdb.SearchSeries(\"Dexter\");\n    for (int i = 0; i &lt; series.Count; i++)\n        {\n            var cover = new TVSeriesCover(series[i]);\n            coverList.Add(cover);\n            visualModel.Children.Add(cover);\n            cover.pos = i;\n            UpdateIndex(i);\n        }\n</code></pre>\n\n<p>Is it possible to achieve this using databinding?</p>\n\n<p>The following is my XAML:</p>\n\n<pre><code>&lt;Viewport3D x:Name=\"viewPort\" ClipToBounds=\"False\" Focusable=\"True\" MouseDown=\"viewPort_MouseDown\" Margin=\"20,29,12,303\" SnapsToDevicePixels=\"False\" FlowDirection=\"LeftToRight\"&gt;\n    &lt;Viewport3D.Camera&gt;\n        &lt;PerspectiveCamera x:Name=\"camera\" Position=\"0,0,5\" UpDirection=\"0,1,0\" LookDirection=\"0,0,-1\" FieldOfView=\"100\" NearPlaneDistance=\"0.125\" /&gt;\n    &lt;/Viewport3D.Camera&gt;\n    &lt;Viewport3D.Children&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n                &lt;DirectionalLight Color=\"White\" Direction=\"1,0,-5\" /&gt;\n            &lt;/ModelVisual3D.Content&gt;\n        &lt;/ModelVisual3D&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n                &lt;DirectionalLight Color=\"White\" Direction=\"-1,0,-5\" /&gt;\n                &lt;/ModelVisual3D.Content&gt;\n            &lt;/ModelVisual3D&gt;\n        &lt;ModelVisual3D x:Name=\"visualModel\"/&gt;\n    &lt;/Viewport3D.Children&gt;\n&lt;/Viewport3D&gt;\n</code></pre>\n"},{"tags":["wpf","graphics","path"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":11618997,"title":"Graphics path minilanguage line aliasing","body":"<p>I am trying to draw a tick in a checkbox and for reason the aliasing doesn't seem to work, the lines are really jagged and don't look good at all. I am missing somthing?</p>\n\n<pre><code>&lt;Style x:Key=\"{x:Type CheckBox}\" TargetType=\"CheckBox\"&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"Black\"/&gt;\n    &lt;Setter Property=\"RenderOptions.EdgeMode\" Value=\"Aliased\"/&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"CheckBox\"&gt;\n                &lt;BulletDecorator Height=\"20\" MinHeight=\"20\"&gt;\n                    &lt;BulletDecorator.Bullet&gt;\n                        &lt;Grid \n                              Width=\"20\"\n                              Height=\"20\"&gt;\n                            &lt;Border x:Name=\"Border\" \n                                    CornerRadius=\"0\" \n                                    Background=\"Black\"\n                                    BorderThickness=\"0\"\n                                    BorderBrush=\"Black\"\n                              Width=\"20\"\n                              Height=\"20\" &gt;\n                                        &lt;Path \n                                        x:Name=\"CheckMark\"\n                                        Stroke=\"White\"\n                                        StrokeThickness=\"8\"\n                                        Data=\"M 3,8 L 5,17,17,2\"/&gt;\n                            &lt;/Border&gt;\n                        &lt;/Grid&gt;\n                    &lt;/BulletDecorator.Bullet&gt;\n                    &lt;ContentPresenter Margin=\"0,0,0,0\"\n                            VerticalAlignment=\"Top\"\n                            HorizontalAlignment=\"Left\"\n                            RecognizesAccessKey=\"True\" RenderOptions.EdgeMode=\"Aliased\"/&gt;\n                &lt;/BulletDecorator&gt;\n                &lt;ControlTemplate.Triggers&gt;\n                    &lt;Trigger Property=\"IsChecked\" Value=\"false\"&gt;\n                        &lt;Setter TargetName=\"CheckMark\" Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n                    &lt;/Trigger&gt;\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["wpf","label","textblock"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":3,"view_count":3507,"score":1,"question_id":5382925,"title":"Difference between Label and TextBlock - WPF","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/59099/what-is-the-difference-between-the-wpf-textblock-element-and-label-control\">What is the difference between the WPF TextBlock element and Label control?</a>  </p>\n</blockquote>\n\n\n\n<p>According to the <a href=\"http://www.microsoft.com/learning/en/us/exam.aspx?ID=70-511&amp;locale=en-us\" rel=\"nofollow\">Windows Applications Development with Microsoft .NET 4 70-511</a> Training Kit<br><br>\nWhat is the difference between the <code>Label</code> control and <code>TextBlock</code> control since both are content controls and just displaying text?</p>\n"},{"tags":["c#","wpf","xaml","wpf-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13247756,"title":"Get the actual size of an imagebrush control for a canvas background","body":"<p>I'm trying to figure out how to get the \"View size\" of an image which is set as the background on a <code>Canvas</code> control.\nThe background is set with a <code>ImageBrush</code>, with strech set to UniForm.<br>\nIf the strech property was set to Fill, then I could just use the ActualWidth and ActualHeight of the canvas.<br><br>\nThis is not possible with UniForm, so how should I approach this?</p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;Grid DataContext=\"{Binding ImageViewerVM.CurrentImage}\"&gt;\n    &lt;controls:RubberBandingCanvas x:Name=\"RubCanvas\"&gt;\n        &lt;controls:RubberBandingCanvas.Resources&gt;\n            &lt;Converters:ControlVisibilityConverter x:Key=\"VisibilityHiddenConverter\" /&gt;\n            &lt;Converters:StringToBitmapConverter x:Key=\"StringToBitmapConverter\" /&gt;\n        &lt;/controls:RubberBandingCanvas.Resources&gt;\n        &lt;controls:RubberBandingCanvas.Background&gt;\n            &lt;ImageBrush x:Name=\"ibCurrentImage\" ImageSource=\"{Binding Path=Path, Converter={StaticResource StringToBitmapConverter}}\" Stretch=\"Uniform\"&gt;&lt;/ImageBrush&gt;\n        &lt;/controls:RubberBandingCanvas.Background&gt;\n        &lt;Ellipse Canvas.Top=\"10\" Canvas.Right=\"10\" Fill=\"Red\" Stroke=\"Black\" Height=\"15\" Width=\"15\" Visibility=\"{Binding Path=IsMultiTiff, Converter={StaticResource VisibilityHiddenConverter}}\"/&gt;            \n    &lt;/controls:RubberBandingCanvas&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p><br>\nBest regards,<br>\nJesper Jensen</p>\n"},{"tags":["wpf"],"answer_count":16,"favorite_count":26,"up_vote_count":45,"down_vote_count":0,"view_count":37971,"score":45,"question_id":5511,"title":"Numeric Data Entry in WPF","body":"<P>How are you handling the entry of numeric values in WPF applications?</P>\r\n<P>Without a NumericUpDown control, I've been using a TextBox and handling its PreviewKeyDown event with the code below, but it's pretty ugly.</P>\r\n<P>Has anyone found a more graceful way to get numeric data from the user without relying on a third-party control?</P><PRE><CODE>private void NumericEditPreviewKeyDown(object sender, KeyEventArgs e)\r\n{\r\n    bool isNumPadNumeric = (e.Key &gt;= Key.NumPad0 &amp;&amp; e.Key &lt;= Key.NumPad9) || e.Key == Key.Decimal;\r\n    bool isNumeric = (e.Key &gt;= Key.D0 &amp;&amp; e.Key &lt;= Key.D9) || e.Key == Key.OemPeriod;\r\n\r\n    if ((isNumeric || isNumPadNumeric) &amp;&amp; Keyboard.Modifiers != ModifierKeys.None)\r\n    {\r\n        e.Handled = true;\r\n        return;\r\n    }\r\n\r\n    bool isControl = ((Keyboard.Modifiers != ModifierKeys.None &amp;&amp; Keyboard.Modifiers != ModifierKeys.Shift)\r\n        || e.Key == Key.Back || e.Key == Key.Delete || e.Key == Key.Insert\r\n        || e.Key == Key.Down || e.Key == Key.Left || e.Key == Key.Right || e.Key == Key.Up\r\n        || e.Key == Key.Tab\r\n        || e.Key == Key.PageDown || e.Key == Key.PageUp\r\n        || e.Key == Key.Enter || e.Key == Key.Return || e.Key == Key.Escape\r\n        || e.Key == Key.Home || e.Key == Key.End);\r\n\r\n    e.Handled = !isControl &amp;&amp; !isNumeric &amp;&amp; !isNumPadNumeric;\r\n}\r\n</CODE></PRE>"},{"tags":["c#","wpf","wpf-controls","textblock","textwrapping"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13247621,"title":"Custom text wrapping algorithm in TextBlock","body":"<p>Is there any way to implement custom text wrapping algorithm in <b>TextBlock</b> element? I mean automatic wrapping depending on control size. Currently I use <b>TextWrapping</b> property, but it doesn't work as I expected.\nFor example I have this string:</p>\n\n<blockquote>\n<pre>pleasant /'plez(ə)nt/</pre>\n</blockquote>\n\n<p>Currently this text can be wrapped like:</p>\n\n<blockquote>\n<pre>pleasant /'plez\n(ə)nt/</pre>\n</blockquote>\n\n<p>But I need something like this (wrap only on white spaces):</p>\n\n<blockquote>\n<pre>pleasant\n/'plez(ə)nt/</pre>\n</blockquote>\n\n<p>As I understand current implementation wraps on punctuation symbols also, but this cause to unexpected behavior with complicated text like word transcription.</p>\n"},{"tags":["wpf","mediaplayer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13246833,"title":"alternative of windows media player in C#?","body":"<p>We use MediaElement in WPF,but get some problems on some custom's Computer because of different \nversion of Media Player.</p>\n\n<p>Is there any third party of audio player library ?</p>\n"},{"tags":["c#","wpf","usercontrols","visualtreehelper","dependencyobject"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13248013,"title":"VisualTreeHelper not finding children of DependencyObject, How can I reliably find objects?","body":"<p>I have a UserControl called <code>ZoneContainer</code>. This has a property that which contains a <code>ListBox</code> containing a number of <code>ListItem</code>s. Each ListItem contains a <code>DockPanel</code>.</p>\n\n<p>I'm trying to use a the following code to find the children that exist inside <code>ZoneContainer</code> but <code>childrenCount</code> is 0 every time.</p>\n\n<pre><code>var parent = this as DependencyObject; // I can see that this is populated.\n\nint childrenCount = VisualTreeHelper.GetChildrenCount(parent);\n</code></pre>\n\n<p>Is there another way to find a specific child object inside a list of objects? Ultimately I'm trying to find the DockPanel, but it's not finding any children even though I know they're in the object.</p>\n"},{"tags":["wpf","filtering","bindinglist"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":600,"score":0,"question_id":1879360,"title":"How to implement filtering for BindingList and ICollectionView","body":"<p>I'm currently using a BindingList that is bound to a WPF-ItemsControl.\nAs I need to implement some filtering on that list, I would like to take advantage of the filtering possibilities of ICollectionView.\nUnfortunately the straight-forward approach, returns false for CanFilter and CanCustomFilter.</p>\n\n<p>So I'm wondering what is the correct approach, to make filtering available for this BindingList.</p>\n\n<p>tia\nMartin</p>\n"},{"tags":["wpf","prism"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13244405,"title":"WPF Prism How to relate Module, View and Region with Unity container","body":"<p>I am having difficulty in finding a relation between a given Module and Views(plain WPF user control) which has been Registered to different regions using this Module (in IModule Initialize() method). </p>\n\n<p>When a Request comes to load a module <code>IModuleManager.LoadModule</code>  is being used the first time to load the module. First time loading a module is not as issue.</p>\n\n<p>Now, another request comes to load a module,which was already loaded so I can not use <code>IModuleManager.LoadModule</code> method, (User will just give ModuleName). </p>\n\n<p>Now I have to find out what are the its Regions (need to clear them first) and its View (need to load them in there respective Regions).\nSo I need a map , kind of triplet, of Module-View-Region and create this triplet first time when IModuleManager.LoadModuleCompleted gets triggered. Later I can use this to find the regions and views.</p>\n\n<p>Used <code>IRegionViewRegistry.ContentRegistered</code> but it just gives (Regions and Views). But no way to relate it to ModuleName(of Module Info) and <code>IModuleManager.LoadModuleCompleted</code> just gives <code>ModuleInfo</code> (no way to find out Regions and Views it uses)</p>\n"},{"tags":["c#","wpf","observablecollection","blockingcollection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13234103,"title":"update an ObservableCollection with a BlockingCollection","body":"<p>I subscribe to a service that will raise an Event when a new element is received, I add this element to a <code>BlockingCollection</code>.<br>\nI have a second thread running that will loop the <code>BlockingCollection</code> to add/update the element in an observable collection.</p>\n\n<p>The problem is how do you do add in the <code>ObservableCollection</code>? \nI know I can't just do an <code>.add</code> on this type of collection, as it needs to be done on the UI thread. So I tried using different <code>ObservableCollection</code> subclass that use the dispatcher to marshal the adding of element, but every single time, I end up with the same error</p>\n\n<blockquote>\n  <p>\"An unhandled exception of type 'System.StackOverflowException'\n  occurred in Unknown Module.\"</p>\n</blockquote>\n\n<p>with a troubleshooting tips as:</p>\n\n<blockquote>\n  <p>make sure you don't have an infinite loop or inifiniterecursion.</p>\n</blockquote>\n\n<p>Well the thing is, I do have some kind of infinite loop actually, as the <code>BlockingQueue</code> is receiving new elements all the time, like 5 to 10 per sec.<br>\nI won't get the exception if I don't bind a control to the <code>observablecollection</code> though, or if I use a List instead.</p>\n\n<pre><code>Class ElementHolder\n{\n    private ExternalService _externalService;\n    private ObservableCollection&lt;Element&gt; _elementsList = new ObservableCollection&lt;Element&gt;();\n    private BlockingCollection&lt;Element&gt; _elementsReceived = new BlockingCollection&lt;Element&gt;();\n\n    public ObservableCollection&lt;Element&gt; ElementsList\n    {\n        get\n        {\n            return _elementList;\n        }\n        set\n        {\n            _elementList = value;\n        }\n    }\n\npublic ElementHolder()\n    {\n        Task.Factory.StartNew(ReadElements);\n        _externalService = new ExternalService();\n        _externalService.ReceivedNewElement += new Action&lt;Element&gt;(o =&gt; _elementsReceived.Add(o));\n        _externalService.Subscribe();\n    }\n\nprivate void ReadElements()\n    {\n        foreach (Element element in _elementsReceived.GetConsumingEnumerable())\n        {\n            Element item = _elementsList.FirstOrDefault(o =&gt; o.ID == element.ID);\n            if (item == null)\n            {\n                _elementList.Add(element);\n            }\n            else\n            {\n                item.Update(element);\n            }\n        }\n    }\n</code></pre>\n\n<p>EDIT\nThe bug disappeared by itself, when i was tracking it down. I was trying to make things simpler to really understand where the issue was, and then it started to work. When putting things back together it still works... BUT it comes back time to time, for what seems unrelated reason like adding a style to my listview. I'm starting to think there's an issue in the third party dll.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13244914,"title":"3D graphics in wpf c# on windows","body":"<p>I am new to 3d Graphics and also wpf and need to combine these two in my current project. I add points and normals to <code>MeshGeometry3D</code> and add <code>MeshGeometry3D</code> to <code>GeometryModel3D</code>. Then add <code>GeometryModel3D</code> to <code>ModelVisual3D</code> and finally add <code>ModelVisual3D</code> to <code>ViewPort3D</code>. Now if i need to rotate i perform the required Transform either on GeometryModel3D or ModelVisual3D and add it again finally to the ViewPort3D. I'm running into a problems: </p>\n\n<pre><code>objViewPort3D.Remove(objModelVisual3D);\nobjGeometryModel3D.Transform = new RotateTransform3D(new AxisAngleRotation3D(new Vector3D(0, 1, 0), angle += 15));\nobjModelVisual3D.Content = objGeometryModel3D;\nobjViewPort3D.Children.Add(objModelVisual3D);\n</code></pre>\n\n<p>to rotate it everytime by 15 degrees why must i do <code>angle += 15</code> and not just <code>15</code>? It seems that the stored model is not transformed by <code>Transform</code> operation but transformation is applied only when displaying by <code>ViewPort3D</code>. I want the transformation to actually change the coordinates in the stored MeshGeometry3D object so that when i do the transform next time it does on the previously transformed model and not the original model. How do i obtain this behaviour?</p>\n"},{"tags":["wpf","wpf-controls","wpfdatagrid","observablecollection","wpf-usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12191454,"title":"items of listbox inside datagrid not getting selected in wpf","body":"<p>I am trying to get a listbox as one of the column inside a Datagrid. Actually its a datagrid inside a usercontrol but i dont think it should make much difference. My listbox is a multi select listbox. I am able to populate this listbox and I am able to update the source list when multiple items are selected in the listbox by the user. I got this solution from <a href=\"http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html\" rel=\"nofollow\">here</a>.</p>\n\n<p>What i am not able to do is the other way round. My source already has some items in it. I want to show these items as selected in the listbox when window loads and then the usual, i.e. when the user changes selection the source should get updated (which i am able to achieve as i said earlier).</p>\n\n<p>I am not sure how much of my code will be sufficient to detect the problem. I am trying to give relevant code as much as possible. If anything is missing or any additional info is required then please let me know. I will update the post accordingly.</p>\n\n<p>My column definition in xaml</p>\n\n<pre><code>                    &lt;DataGridTemplateColumn Header=\"Roles\"&gt;\n                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;ListBox ItemContainerStyle=\"{StaticResource ContainerStyle}\" \n                                SelectionMode=\"Extended\" ItemsSource=\"{Binding RelativeSource={RelativeSource Findancestor, AncestorType={x:Type Window}}, Path=DataContext.DDData}\"\n                                SelectedValuePath=\"{Binding RelativeSource={RelativeSource Findancestor, AncestorType={x:Type ctrls:RadarDataGrid}}, Path=DataContext.Roles}\"\n                                DisplayMemberPath=\"RoleName\"\n                                local:MultiSelectorBehaviours.SynchronizedSelectedItems=\"{Binding Roles}\"&gt;\n                                &lt;/ListBox&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;/DataGridTemplateColumn&gt;\n</code></pre>\n\n<p>My datagrid is bound using <code>DataContext=\"{Binding UserList}\"</code> and the UserList is an observablecollection in my code behind. Also \"DDData\" mentioned is also an observablecollection in my code behind. \"ContainerStyle\" is a style to change the foreground color and background color when an item is selected.</p>\n\n<p>How \"UserList\" and \"DDData\" is defined?</p>\n\n<p>UserList:</p>\n\n<pre><code>    protected static DependencyProperty UserListProperty = DependencyProperty.Register\n        (\"UserList\", typeof(ObservableCollection&lt;User&gt;), typeof(Users));\n\n    public ObservableCollection&lt;User&gt; UserList\n    {\n        get { return GetValue(Users.UserListProperty) as ObservableCollection&lt;User&gt;; }\n        set\n        {\n            SetValue(Users.UserListProperty, value);\n        }\n    }\n</code></pre>\n\n<p>DDData:</p>\n\n<pre><code>    private ObservableCollection&lt;Role&gt; _DDData;\n\n    public ObservableCollection&lt;Role&gt; DDData \n    {\n        get\n        { return _DDData; }\n        set\n        {\n            _DDData = value;\n            //INofifyPropertyChanged event been called\n            PptyChanged(\"DDData\");\n        }\n    }\n</code></pre>\n\n<p>How \"UserList\" and \"DDData\" gets populated? I have a service which returns an observablecollection objects and this service is called on Window_Loaded event. I will show my User and Role classes later.</p>\n\n<pre><code>    private void ProcessUsersLoaded(ObservableCollection&lt;User&gt; users)\n    {\n        this.Dispatcher.Invoke((Action)delegate\n        {\n            this.Cursor = Cursors.Arrow;\n\n            foreach (User item in users)\n            {\n                User obj = new User()\n                {\n                    UserId = item.UserId,\n                    UserName = item.UserName\n                };\n\n                obj.Roles = new ObservableCollection&lt;Role&gt;();\n\n                //One user can be bound to multiple roles\n                foreach (var item2 in item.Roles)\n                {\n                    obj.Roles.Add(new Role() { RoleId = item2.RoleId, RoleName = item2.RoleName });\n                }\n\n                UserList.Add(obj);\n            }\n            DDData = new ObservableCollection&lt;Role&gt;();\n\n            DDData.Add(new Role() { RoleId = 1, RoleName = \"R1\" });\n            DDData.Add(new Role() { RoleId = 2, RoleName = \"R2\" });\n            DDData.Add(new Role() { RoleId = 3, RoleName = \"R3\" });\n            DDData.Add(new Role() { RoleId = 4, RoleName = \"R4\" });\n            DDData.Add(new Role() { RoleId = 5, RoleName = \"R5\" });\n\n\n        }, null);\n    }\n</code></pre>\n\n<p>I am using Invoke because it is an asynchronous call. I am not including how async has been achieved here because then the post will never end.</p>\n\n<p>Now finally my User and Role classes</p>\n\n<p>User class</p>\n\n<pre><code>public class User : INotifyPropertyChanged\n{\n    [DataMember]\n    public int UserId { get; set; }\n    [DataMember]\n    public string UserName { get; set; }\n    [DataMember]\n    public string FirstName { get; set; }\n    [DataMember]\n    public string LastName { get; set; }\n    [DataMember]\n    public string EmailId { get; set; }\n    [DataMember]\n    public string Password { get; set; }\n\n\n    private ObservableCollection&lt;Role&gt; _roles;\n\n    [DataMember]\n    public ObservableCollection&lt;Role&gt; Roles \n    {\n        get\n        { return _roles; }\n        set\n        {\n            _roles = value;\n            PptyChanged(\"Roles\");\n        }\n    }\n\n    [DataMember]\n    public Role CurrRole { get; set; }\n\n\n    #region INotifyPropertyChanged Members\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    #endregion\n\n    private void PptyChanged(string prop)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(prop));\n        }\n    }\n\n}\n</code></pre>\n\n<p>And my Role class</p>\n\n<pre><code>[DataContract]\npublic class Role : CRUDStatus\n{\n\n    [DataMember]\n    public int RoleId { get; set; }\n    [DataMember]\n    public string RoleName { get; set; }\n    [DataMember]\n    public string RoleDescription { get; set; }\n    [DataMember]\n    public string RoleComments { get; set; }\n}\n</code></pre>\n\n<p>I am not creating a proxy but using ChannelFactory class to dynamically create the proxy so the assembly in which these classes reside is shared between the service and the persentation layer.</p>\n\n<p>I hope the post wasnt too long. I tried to be as explainative as possible. </p>\n\n<p>Please help!\nThanks in advance.</p>\n\n<p>Regards,</p>\n\n<p>Samar</p>\n\n<p><em><strong>EDIT:</em></strong> One update here. After running my window when I try to check the ItemsSource of the grid (through a button click) I get <strong>Roles.Count = 0 for all the objects inside \"UserList\"</strong> i.e. all the roles which I have added in the \"UserList\" during load has been lost!! But if I select some items from the listbox and check the ItemsSource, the Roles list gets the selected Role objects for that particular User. Also when i remove this line </p>\n\n<blockquote>\n  <p>local:MultiSelectorBehaviours.SynchronizedSelectedItems=\"{Binding Roles}\"</p>\n</blockquote>\n\n<p>I start receiving counts as mentioned above but then I am not able to update the list.</p>\n\n<p>Please help!</p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13246602,"title":"DataTemplate in a separate ResourceDictionary","body":"<p>I know there a lot of topics related to this question but I could not find a solution that fits perfectly for my problem ... maybe there is none? </p>\n\n<p>At the moment I have a <code>UserControl</code> which holds a navigation which allows the user to switch between different screens. These screens are defined in the <code>Resources</code> part of my <code>UserControl</code> as <code>DataTemplate</code>. </p>\n\n<p><strong>Something like that:</strong></p>\n\n<pre><code>&lt;DataTemplate TargetType={x:Type vm:ViewModel1}&gt;\n    ...\n&lt;/DataTemplate&gt;\n&lt;DataTemplate TargetType={x:Type vm:ViewModel2}&gt;\n    ...\n&lt;/DataTemplate&gt;\n&lt;DataTemplate TargetType={x:Type vm:ViewModel3}&gt;\n    ...\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Ok and what I wanna do is to place these DataTemplates in a separate XAML file and link this file to the UserControl's resources part. Do I really have to make this new XAML Resource Dictionary globally available in my application (adding it to the App.xaml resources) or is there another/better way?</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13246924,"title":"WPF Chart Show tooltip by default","body":"<p>i am Using System.Windows.Controls.DataVisualization.Toolkit.  On hover in the tooltip it shows me the % value. i want to show that % value without any hover on every Pie data. it will be fine if i can show them outsize the chart in a Label.\nhere is my PieChartBinding.</p>\n\n<p>\n                                               IndependentValueBinding=\"{Binding Path=Key.Name}\"/>\n                </p>\n"},{"tags":["c#","wpf","threadpool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":377039,"title":"Weird problem when using ThreadPools to search through object lists","body":"<p>I have these container objects (let's call them Container) in a list. Each of these Container objects in turn has a DataItem (or a derivate) in a list. In a typical scenario a user will have 15-20 Container objects with 1000-5000 DataItems each. Then there are some DataMatcher objects that can be used for different types of searches. These work mostly fine (since I have several hundered unit tests on them), but in order to make my WPF application feel snappy and responsive, I decided that I should use the ThreadPool for this task. Thus I have a DataItemCommandRunner which runs on a Container object, and basically performs each delegate in a list it takes as a parameter on each DataItem in turn; I use the ThreadPool to queue up one thread for each Container, so that the search in theory should be as efficient as possible on multicore computers etc.</p>\n\n<p>This is basically done in a DataItemUpdater class that looks something like this:</p>\n\n<pre><code>public class DataItemUpdater\n{\n    private Container ch;\n    private IEnumerable&lt;DataItemCommand&gt; cmds;\n\n    public DataItemUpdater(Container container, IEnumerable&lt;DataItemCommand&gt; commandList)\n    {\n        ch = container;\n        cmds = commandList;\n    }\n\n    public void RunCommandsOnContainer(object useless)\n    {\n        Thread.CurrentThread.Priority = ThreadPriority.AboveNormal;\n        foreach (DataItem di in ch.ItemList)\n        {\n            foreach (var cmd in cmds)\n            {\n                cmd(sh);\n            }\n        }\n        //Console.WriteLine(\"Done running for {0}\", ch.DisplayName);\n    }\n}\n</code></pre>\n\n<p>(The useless object parameter for RunCommandsOnContainer is because I am experimenting with this with and without using threads, and one of them requires some parameter. Also, setting the priority to AboveNormal is just an experiment as well.)</p>\n\n<p>This works fine for all but one scenario - when I use the AllWordsMatcher object type that will look for DataItem objects containing all words being searched for (as opposed to any words, exact phrase or regular expression for instance).</p>\n\n<p>This is a pretty simple somestring.Contains(eachWord) based object, backed by unit tests. But herein lies some hairy strangeness.</p>\n\n<p>When the RunCommandsOnContainer runs using ThreadPool threads, it will return insane results. Say I have a string like this:</p>\n\n<pre><code>var someString = \"123123123 - just some numbers\";\n</code></pre>\n\n<p>And I run this:</p>\n\n<pre><code>var res = someString.Contains(\"data\");\n</code></pre>\n\n<p>When it runs, this will actually return true quite a lot - I have debugging information that shows it returning true for empty strings and other strings that simply do not contain the data. Also, it will some times return false even when the string actually contains the data being looked for.</p>\n\n<p>The kicker in all this? Why do I suspect the ThreadPool and not my own code?</p>\n\n<p>When I run the RunCommandsOnContainer() command for each Container in my main thread (i.e. locking the UI and everything), it works 100% correctly - every time! It never finds anything it shouldn't, and it never skips anything it should have found.</p>\n\n<p>However, as soon as I use the ThreadPool, it starts finding a LOT of items it shouldn't, while some times not finding items it should.</p>\n\n<p>I realize this is a complex problem (it is painful trying to debug, that's for sure!), but any insight into why and how to fix this would be greatly appreciated!</p>\n\n<p>Thanks!</p>\n\n<p>Rune</p>\n"},{"tags":["wpf","xaml","resx","xamlparseexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13246891,"title":"Resource name BorderWidth in Resource files causes exception","body":"<p>I have a resource file (.resx) which i refer to in the XAML like so</p>\n\n<pre><code>{x:Static Resources:TextResource.BorderWidth}\n</code></pre>\n\n<p>Works fine everywhere but in a textblock for a certain resource name, BorderWidth. There it throws a XamlParseException with a inner ArgumentException. If i change the resource name to anything else it works fine. Why does it do this?</p>\n\n<blockquote>\n  <p><em>Exception:</em> <strong>XamlParseException</strong> <em>{\"'Set property 'System.Windows.Controls.TextBlock.Text' threw an exception.' Line number '62' and line position '24'.\"}</em></p>\n  \n  <blockquote>\n    <p><em>Inner Exception:</em> <strong>ArgumentException</strong> <em>{\"'5' is not a valid value for property 'Text'.\"}</em></p>\n  </blockquote>\n</blockquote>\n\n<p><strong>Xaml for textblock</strong></p>\n\n<pre><code>&lt;TextBlock Grid.Column = \"0\"\nGrid.Row = \"0\"\nText = \"{x:Static Resources:TextResource.BorderWidth}\"\nStyle = \"{StaticResource TextBlockMark}\"\nVisibility = \"{Binding Mark.HasBorder,Converter={StaticResource VisibilityConverter}}\" /&gt;\n</code></pre>\n\n<p><strong>StackTrace</strong></p>\n\n<pre><code>at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)\nat System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)\nat System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)\nat System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)\nat Comprima.Viewer.Modules.Drawing.Views.MarkPropertiesToolbarView.InitializeComponent() in c:\\Projects\\General\\Comprima Viewer\\Comprima.Viewer.Modules.Drawing\\Views\\MarkPropertiesToolbarView.xaml:line 1\nat Comprima.Viewer.Modules.Drawing.Views.MarkPropertiesToolbarView..ctor(IMarkPropertiesViewModel viewModel) in c:\\Projects\\General\\Comprima Viewer\\Comprima.Viewer.Modules.Drawing\\Views\\MarkPropertiesToolbarView.xaml.cs:line 14\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13246100,"title":"Unable to offset a Point3D in a Point3DCollection","body":"<p>I am trying to offset a point in a Point3DCollection but could not get it translated to the new position. The text box shows 0,0,0 for the first point though I am doing an offset of 3,3,3 to it. What is wrong with the following code:</p>\n\n<pre><code>var result = new Point3DCollection(n);\n\nvar pt1 = new Point3D(0, 0, 0);\nvar pt2 = new Point3D(5, 5, 5);\n\nresult.Add(pt1);\nresult.Add(pt2);  \nresult[0].Offset(3,3,3);\ntextbox1.Text = result[0].X + \",\" + result[0].Y + \",\" + result[0].Z;\n</code></pre>\n"},{"tags":["c#","wpf","wcf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13239160,"title":"WCF Service TargetInvocationException - Possible Cyclic Reference","body":"<p>I need a little help with an Exception being thrown at my WCF service. The point is: I need to develop a WPF application and I've heard that to treat data WCF is the best choice so I used it only with basic knowledge and now I have this problem.</p>\n\n<p>The point is, I have a Customer class, a Supplier class and an Order class. I have then two services: the first one has all methods to add, read and edit customers and suppliers from database. This service works perfectly fine. The second service has methods to add new orders, edit orders and read them from database, and this service has a problem.</p>\n\n<p>The class Customer has a list of Suppliers (the suppliers from which the customer buys), the class Supplier has a list of Customers (the customers that buy from that supplier). The class order has a Customer, a Supplier and a list of Itens (and the itens are added to the database together with the order).</p>\n\n<p>The method for adding an order works fine, however, once an order has been added, the method to list the orders throws the TargetInvocationException. I searched a lot on the internet and the best answer I've found is that it's possibly a \"Ciclyc Reference\".</p>\n\n<p>The method to list the orders is inside the repository class and is simply:</p>\n\n<pre><code>public IQueryable&lt;Order&gt; ListOrders()\n{\n    return Context.Set&lt;Order&gt;().Include(x =&gt; x.Customer).Include(x =&gt; x.Supplier);\n}\n</code></pre>\n\n<p>Where Context is the entity framework context. I tried to remove the includes and load the customer and supplier separately, but the result was the same exception.</p>\n\n<p>Can someone please help me ? If I need to post more information just tell me. And sorry if this matter is trivial, I'm new to WPF and WCF so I'm still a little confused.</p>\n\n<p>Thanks a lot in advance.</p>\n\n<p><strong>EDIT</strong> Exception below</p>\n\n<blockquote>\n  <p>An error occurred while receiving the HTTP response to\n  <a href=\"http://SomeService.com/OrdersService.svc\" rel=\"nofollow\">http://SomeService.com/OrdersService.svc</a>. This could be due to the\n  service endpoint binding not using the HTTP protocol. This could also\n  be due to an HTTP request context being </p>\n  \n  <p>aborted by the server (possibly due to the service shutting down). See\n  server logs for more details.</p>\n  \n  <p>Server stack trace:     at\n  System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException\n  webException, HttpWebRequest request, HttpAbortReason abortReason)<br>\n  at\n  System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan\n  timeout)    at\n  System.ServiceModel.Channels.RequestChannel.Request(Message message,\n  TimeSpan timeout)    at\n  System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message\n  message, TimeSpan timeout)    at\n  System.ServiceModel.Channels.ServiceChannel.Call(String action,\n  Boolean oneway, ProxyOperationRuntime operation, Object[] ins,\n  Object[] outs, TimeSpan timeout)    at\n  System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage\n  methodCall, ProxyOperationRuntime operation)    at\n  System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage\n  message)</p>\n  \n  <p>Exception rethrown at [0]:     at\n  System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage\n  reqMsg, IMessage retMsg)    at\n  System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp;\n  msgData, Int32 type)    at IOrdersService.ReturnOrders()    at\n  OrdersServiceClient.ReturnOrders()</p>\n  \n  <p>Inner Exception: The underlying connection was closed: An unexpected\n  error occurred on a receive.    at\n  System.Net.HttpWebRequest.GetResponse()    at\n  System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan\n  timeout)</p>\n  \n  <p>Inner Exception: Unable to read data from the transport connection: An\n  existing connection was forcibly closed by the remote host.    at\n  System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset,\n  Int32 size)    at System.Net.PooledStream.Read(Byte[] buffer, Int32\n  offset, Int32 size)    at\n  System.Net.Connection.SyncRead(HttpWebRequest request, Boolean\n  userRetrievedStream, Boolean probeRead)</p>\n  \n  <p>Inner Exception: An existing connection was forcibly closed by the\n  remote host    at System.Net.Sockets.Socket.Receive(Byte[] buffer,\n  Int32 offset, Int32 size, SocketFlags socketFlags)    at\n  System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset,\n  Int32 size)</p>\n</blockquote>\n"},{"tags":["c#",".net","wpf","installer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13245119,"title":"C# - Make custom installer for wpf application","body":"<p>I want to make a custom application installer for my wpf application. I want to show licence agreement which user will need to accept to proceed then he needs to enter key. then installation bar will begin.</p>\n\n<p>how to do that?Is there any link which can help me?</p>\n"},{"tags":["wpf","collectionviewsource","icollectionview"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":18,"score":3,"question_id":13235112,"title":"How to associate custom data with a CollectionViewGroup?","body":"<p>I've got an ItemsControl in XAML where I am displaying an expander for each group so I can expand/collapse the group. I want to persist the state of the IsExpanded property (and potentially other settings relating to the display of the group header). Normally you just have a class with the properties on it and bind to this. However, the data context for the group is CollectionViewGroup. Now this class isn't very helpful as it only gives you the Name property and the items in the group (which is fine if you just want a heading and maybe display some sort of metric based on the number of items in the group or their contents but not if you just want to store custom data about the state of the group header UI). What I'd like to do is to derive from this class and add other properties to my derived class and bind to that instead. But there doesn't seem to be any easy way to do this. All the details of group generation seem to be hidden away in internal classes which is very frustrating. Has anyone gone down the route of implementing ICollectionView themselves (and therefore all the other related classes as well presumably)? It seems like a massive job to replicate everything in ListCollectionView just to be able to create a custom CollectionViewGroup class and bind to that instead! Thanks.</p>\n"},{"tags":["c#","wpf",".net-4.0","com"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13244814,"title":"How to launch Wpf application as Out Proc COM Server","body":"<p>Is it possible to launch Wpf application as Out Proc COM Server?\nI've googled so much last five days and didn't find any working solution. Kindly help me.</p>\n"},{"tags":["wpf","binding","combobox","selecteditem","itemssource"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1179,"score":2,"question_id":5096932,"title":"WPF ComboBox Binding to Enumeration","body":"<p>I have a Combo Box that has ItemsSource Bound to an Enumeration using ObjectDataProvider, and its SelectedItem Property is bound to a property of a businessobject.\nFor some reason it's binding SelectedItem first and ItemsSource second, therefore overwriting my default on the businessobject property. Any ideas why and possibly a fix?\nThanks in Advance.</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;CollectionViewSource x:Key=\"Units\"&gt;\n     &lt;CollectionViewSource.Source&gt;\n          &lt;ObjectDataProvider MethodName=\"GetNames\" ObjectType=\"{x:Type sys:Enum}\"&gt;\n               &lt;ObjectDataProvider.MethodParameters&gt;\n                    &lt;x:Type TypeName=\"BO:Unit\"/&gt;\n               &lt;/ObjectDataProvider.MethodParameters&gt;\n          &lt;/ObjectDataProvider&gt;\n     &lt;/CollectionViewSource.Source&gt;\n&lt;/CollectionViewSource&gt;\n\n&lt;ComboBox Grid.Column=\"1\" HorizontalAlignment=\"Right\" Width=\"80\"\n          ItemsSource=\"{Binding Source={StaticResource Units}}\" \n          SelectedItem=\"{Binding Path=Unit}\"/&gt;\n</code></pre>\n"},{"tags":["wpf","listview","mvvm","command"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13238121,"title":"fire RaiseCanExecuteChanged when items of a Listview are changed","body":"<p>I'm using a MVVM pattern with Prism</p>\n\n<p>I've got a list of Elements in an ObservableCollection, in my Model. In my View, i binded the ObservableCollection to a Listview, then i trye to display 1 button that is binded to a DelegateCommand called DoSomethingCommand. That means that each line of my Listview have a button to call DoSomethingCommand, with a CommandParameter binded to the ID of the element.</p>\n\n<p>Constraint: DoSomethingCommand will change the status field of my element to \"done\". When an element is \"done\" i want the button to call DoSomethingCommand to be disabled.</p>\n\n<p>So logically, all i have to do is have a canExecuteDoSomethingCommand delegate when i implement the command. But, the problem is when and how can i raise DoSomethingCommand.RaiseCanExecuteChanged? \nBTW Element is part of a third party dll that i can't modify it, but it already implements INotifyPropertyChanged.</p>\n\n<pre><code>&lt;ListView BorderThickness=\"0\" Width=\"Auto\"\n              ItemsSource=\"{Binding ElementList}\"\n              &gt;\n   &lt;ListView.View&gt;\n     &lt;GridView&gt;\n       &lt;GridViewColumn Header=\"Actions\"&gt;\n         &lt;GridViewColumn.CellTemplate&gt;\n             &lt;DataTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                     &lt;Button Command=\"{Binding DataContext.DoSomethingCommand, RelativeSource={RelativeSource AncestorType={x:Type ListView}}}\" CommandParameter=\"{Binding ID}\" &gt;Accept&lt;/Button&gt;\n                &lt;/StackPanel&gt;\n             &lt;/DataTemplate&gt;\n           &lt;/GridViewColumn.CellTemplate&gt;\n        &lt;/GridViewColumn&gt;\n</code></pre>\n\n<p>Implemting the command</p>\n\n<pre><code>DoSomethingCommand = new DelegateCommand&lt;string&gt;(executeDoSomethingCommand, canExecuteDoSomethingCommand);\n</code></pre>\n"},{"tags":["wpf","grid","overlay"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3665,"score":0,"question_id":1660301,"title":"WPF Canvas and Grid overlay","body":"<p>I have a grid which represents some data, and i need a canvas to overlay on top of it to layout some lines.  The canvas is inside it's own usercontrol</p>\n\n<p>The problem is that the canvas and it's contents should autoresize when the grid resizes width and height.</p>\n\n<p>I added the canvas inside a viewbox, but it didn't do the trick.  When the grid resizes, the canvas doesn't.  The purpose of the canvas is to overlay a ruler-like functionality on top of the grid.</p>\n\n<p>Looking forward for your solutions,</p>\n\n<p>MeTTaxa</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I cannot use a style on the grid to replace the canvas, because the grid is showing different information than the canvas does.  Think of it as chart, in which there are bar columns of different sizes (in my case the grid) and the days are lines in an overlay (just as a Gannt Chart)</p>\n\n<p>My code:</p>\n\n<pre><code>    taxCanvas = new TimeAxis();\n    Grid.SetRowSpan(taxCanvas, GRightMain.RowDefinitions.Count);\n    Grid.SetColumnSpan(taxCanvas, GRightMain.ColumnDefinitions.Count);\n\n    Grid.SetColumn(taxCanvas, 0);\n    Grid.SetRow(taxCanvas, 0);\n\n\n    Grid.SetZIndex(taxCanvas, -1);\n\n    taxCanvas.Height = GRight.ActualHeight;\n    taxCanvas.Width = GRight.ActualWidth;\n\n    GRightMain.Children.Add(taxCanvas);\n</code></pre>\n\n<p>TimeAxis is my canvas usercontrol, GRightMain is a grid which holds both my canvas and the grid with the content (Gright) in the same row and column.  </p>\n\n<p>Hope this helps</p>\n"},{"tags":["wpf","video","windows-8","mediaelement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13243562,"title":".wmv videos not playing in WPF MediaElement control in Windows 8","body":"<p>I am having trouble getting videos to play using the WPF MediaElement on a windows 8 box.  Since the MediaElement control relies on Windows Media Player, I tried to play the video on my Win 8 box in WMP and it plays fine, so it doesnt appear to be a codec problem.  My current theory is it has something to do with WMP, rather than a change I need to make to the code.  Any help would be greatly appreciated!</p>\n\n<p>Here is a test app that I mocked up that also has the problem; it works just fine on windows 7 (loads a black screen that plays when you click it), but fails to do anything in win 8 (white screen with no interaction).  I've tried several different methods of loading the video in before I concluded it probably didn't matter how I did it, this code is just the last revision.  If you want to see the issue yourself (actually, just knowing if its just my windows 8 machine would be very helpful), its a pretty small WPF app and any WMV should work.</p>\n\n<p>C#:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n\n        bool opened = false;\n        var mre = new ManualResetEvent(false);\n\n\n        currentMediaElement.BeginInit();\n        currentMediaElement.Source = new Uri(\"Video.wmv\", UriKind.RelativeOrAbsolute);\n        currentMediaElement.EndInit();\n        currentMediaElement.LoadedBehavior = currentMediaElement.UnloadedBehavior = MediaState.Manual;\n        currentMediaElement.MediaOpened += delegate\n        {\n\n            opened = true;\n            mre.Set();\n        };\n        currentMediaElement.Stop();\n\n        mre.WaitOne(5000);\n    }\n\n    private void currentMediaElement_MouseDown(object sender, MouseButtonEventArgs e)\n    {\n        currentMediaElement.Play();\n    }\n}\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"TestApp.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;Grid&gt;\n        &lt;MediaElement Name=\"currentMediaElement\" MouseDown=\"currentMediaElement_MouseDown\"&gt;&lt;/MediaElement&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["wpf","xaml","pdf-generation","xps","xps-generation"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":13178,"score":7,"question_id":1002476,"title":"Best ways to convert XPS to PDF (and vice-versa)?","body":"<p>I have XPS documents being generated from XAML User Controls that act as templates. I want to convert the XPS documents into alternative formats, mainly PDF, programmatically with a .NET based API.</p>\n\n<p>What is the best way to do this? </p>\n"},{"tags":["c#",".net","wpf","prism"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13243572,"title":"Why does the following WPF Command not fire?","body":"<p>C# file:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public DelegateCommand&lt;ICollection&lt;string&gt;&gt; TestCommand { get; set; }\n\n    public ICollection&lt;string&gt; TestParameter\n    {\n        get\n        {\n            List&lt;string&gt; lstParams = new List&lt;string&gt;() { \"test\", \"test2\", \"test3\" };\n            return lstParams;\n        }\n    }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        TestCommand = new DelegateCommand&lt;ICollection&lt;string&gt;&gt;(TestMethod);\n    }\n\n    private void TestMethod(ICollection&lt;string&gt; param)\n    {\n        if (param != null)\n        {\n            lblTest.Content = \"Hit\";\n        }\n    }\n}\n</code></pre>\n\n<p>.XAML file</p>\n\n<pre><code>&lt;Window x:Class=\"WPFAttachedBehaviorTest.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"\n    xmlns:local=\"clr-namespace:WPFAttachedBehaviorTest\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\" DataContext=\"{Binding RelativeSource={RelativeSource Mode=Self}}\"&gt;\n\n&lt;i:Interaction.Triggers&gt;\n    &lt;i:EventTrigger EventName=\"Loaded\"&gt;\n        &lt;i:InvokeCommandAction CommandParameter=\"{Binding Path=TestParameter}\" Command=\"{Binding Path=TestCommand}\" /&gt;\n    &lt;/i:EventTrigger&gt;\n&lt;/i:Interaction.Triggers&gt;\n&lt;Label x:Name=\"lblTest\"&gt;&lt;/Label&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>A break point on the TestParameter getter fires but TestMethod never fires. </p>\n\n<p>I don't see any binding errors in the Output window (on the contrary, if I deliberately mis-spell TestCommand2 it'll complain - so I guess this is correct)</p>\n\n<p>This is using the Prism DelegateCommand and the Expression Blend InvokeCommandAction behavior</p>\n"},{"tags":["wpf","client-server","wcf-client","business-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13242645,"title":"wpf notify changed data in the beackend","body":"<p>I currently developing a client server application and use a WCF interface for communication.\nVia this interface i get my business objects. I am using MVVM.</p>\n\n<p>The users can make changes in the client (e.g. via a textbox). Later i want to send the obejcts back to the server and the server shall decide whether an object needs to be saved or whether it should ignore it because noch changes were made.</p>\n\n<p>I am now looking for a way to \"tag\" the business objects so that the server can make his decision.\nHas somboody an idea how i could do this???\nOr much better does anyone know a tutorial??? </p>\n"},{"tags":["c#","wpf","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13243844,"title":"Concatenation of items in list to use in WPF combobox Itemsource","body":"<p>I have a List where a Person has Firstname and Surname. I want to concatenate Firstname and Surname to set combobox's itemsource and Display member Path.</p>\n"},{"tags":["c#","wpf","roundedcorners-dropshadow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13243503,"title":"textbox with rounded corners and drop shadow","body":"<p>I'm trying to replicate a textbox like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BWQdK.png\" alt=\"Textbox with drop shadow\"></p>\n\n<p>The background outside the textbox will be taken care of by the parent container.</p>\n\n<p>To my knowledge there are 4 items I need to take care of:</p>\n\n<ul>\n<li>Rounding corners</li>\n<li>Adding an inner drop shadow to the top and right hand side</li>\n<li>Adding an outer drop shadow to the left and bottom sides</li>\n<li>Avoiding the text in the text box inheriting the shadow effects.</li>\n</ul>\n\n<p>I've borrowed code from <a href=\"http://stackoverflow.com/questions/4779777/wpf-rounded-corner-textbox\">WPF rounded corner textbox</a> and <a href=\"http://www.codeproject.com/Articles/225076/Creating-Inner-Shadows-for-WPF-and-Silverlight\" rel=\"nofollow\">http://www.codeproject.com/Articles/225076/Creating-Inner-Shadows-for-WPF-and-Silverlight</a> but I just don't have enough grasp on WPF to do this.</p>\n\n<p>Code at present:</p>\n\n<pre><code>&lt;Window x:Class=\"Test.TestWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nTitle=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n&lt;Window.Resources&gt;\n    &lt;ControlTemplate x:Key=\"TextBoxBaseControlTemplate\" TargetType=\"{x:Type TextBoxBase}\"&gt;\n        &lt;Border Background=\"{TemplateBinding Background}\" \n            x:Name=\"Bd\" BorderBrush=\"Black\"\n            BorderThickness=\"{TemplateBinding BorderThickness}\" CornerRadius=\"8\"\n                ClipToBounds=\"True\"&gt;\n            &lt;Border Background=\"Transparent\" BorderBrush=\"Black\" BorderThickness=\"0,10,10,0\" Margin=\"0,-11,-11,0\"&gt;\n                &lt;Border.Effect&gt;\n                    &lt;DropShadowEffect ShadowDepth=\"0\" BlurRadius=\"8\"/&gt;\n                &lt;/Border.Effect&gt;\n                &lt;ScrollViewer x:Name=\"PART_ContentHost\"/&gt;\n            &lt;/Border&gt;\n        &lt;/Border&gt;\n        &lt;ControlTemplate.Triggers&gt;\n            &lt;Trigger Property=\"IsEnabled\" Value=\"False\"&gt;\n                &lt;Setter Property=\"Background\" Value=\"{DynamicResource {x:Static SystemColors.ControlBrushKey}}\" TargetName=\"Bd\"/&gt;\n                &lt;Setter Property=\"Foreground\" Value=\"{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}\"/&gt;\n            &lt;/Trigger&gt;\n            &lt;Trigger Property=\"Width\" Value=\"Auto\"&gt;\n                &lt;Setter Property=\"MinWidth\" Value=\"100\"/&gt;\n            &lt;/Trigger&gt;\n            &lt;Trigger Property=\"Height\" Value=\"Auto\"&gt;\n                &lt;Setter Property=\"MinHeight\" Value=\"20\"/&gt;\n            &lt;/Trigger&gt;\n        &lt;/ControlTemplate.Triggers&gt;\n    &lt;/ControlTemplate&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid&gt;\n    &lt;TextBox Template=\"{StaticResource TextBoxBaseControlTemplate}\" Height=\"25\" Margin=\"5\"&gt;\n        Text\n    &lt;/TextBox&gt;\n&lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>This renders as:</p>\n\n<p><img src=\"http://i.stack.imgur.com/zH1yb.png\" alt=\"CurrentCode\"></p>\n\n<p>Problems are that the drop shadow is outside the rounded corners on the top and right; the text is shadowed; and i've not figured out how to add a shadow to outside of left &amp; bottom.</p>\n\n<p>If I remove </p>\n\n<pre><code>CornerRadius=\"8\"\n</code></pre>\n\n<p>from the BorderThickness then I get a rectangle with the shadow on the inside.</p>\n\n<p>I'm open to any pointers in how to solve this.  </p>\n"},{"tags":["c#","wpf","gui","trading","algorithmic-trading"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":1270,"score":0,"question_id":4999572,"title":"UI for a trading application in C# WPF","body":"<p>I have created a <a href=\"http://www.quantcode.com/modules/mydownloads/singlefile.php?cid=15&amp;lid=579\" rel=\"nofollow\">trading application in WPF</a>, for which I am ashamed of it's shabby look since it is far from being impressive.\nI would now like to redesign the user interface for my application, and make it similar to <a href=\"http://mdavey.files.wordpress.com/2011/01/statarbetf.jpg\" rel=\"nofollow\">an example screen shot of a trading application</a></p>\n\n<p>Can someone please advice tips on what path I should follow to make a UI of similar nature? eg., if there is an open source C# WPF application which has a similar look and feel, that would be great. or if there is a library which has cool listview, scrollbar and progress bars, ..</p>\n\n<p>PS: I do not have microsoft blend</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13225823,"title":"How to bring the name of the checkbox/radiobutton into the function","body":"<p>I using WPF and C# to build my application. Inside my application, i have quite lots of check boxes. Since i have lots of check boxes, there will be <strong>a LOTS</strong> of if checkbox.isChecked = true then do something....So, i need to create a function for the event whenever the check boxes is checked in order to make sure my coding is not flooded with the checkbox.isChecked.</p>\n\n<pre><code>public Window1()\n    {\n        InitializeComponent();\n        CheckTrueFlase(checkboxA);\n        CheckTrueFlase(checkboxB);\n        CheckTrueFlase(checkboxC);\n        CheckTrueFlase(checkboxD);\n    }\n</code></pre>\n\n<p>The function will be something like:</p>\n\n<pre><code>private string CheckTrueFalse(/*What parameter i should write in this area?*/) \n{\n   string x;\n\n   if(checkbox.isChecked == true)\n     x = \"correct\";\n   else if (checkbox.isChecked == false)\n     x = \"wrong\";\n\n   return x;\n }\n</code></pre>\n"},{"tags":["wpf","radio-button","boolean","converter","stackoverflowexception"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":42,"score":-1,"question_id":13238796,"title":"WPF radiobuttons opposite boolean converter not working well and StackOverflowException","body":"<p>I was using a <code>boolean Inverter converter</code> to get boolean values rendered as radio buttons in the UI.</p>\n\n<p>First I was doing this only with the Visible buttons group and everything was working fine. But when I put also the Active buttons problems began.</p>\n\n<p>The first thing wrong is when I turn visible this <code>UserControl</code>, I see the Active buttons set the right way (1st checked, 2nd not checked), but Visible are not (both not checked).</p>\n\n<p>And clicking in one of the buttons of the Visible group, the Output Window will display the message <code>Process is terminated due to StackOverflowException</code>.</p>\n\n<p>So I restart the Application and did more stack tracing and I have seen that when I make the user control appear to the user I see execution passing on:</p>\n\n<p>1st radiobutton group</p>\n\n<ul>\n<li>Active.get — seems right, to retrieve value for the 1st radio button</li>\n<li>OppositeBooleanConverter.Convert - seems right, to get the value inverted for the 1st radio button</li>\n<li>Active.get — seems right, to retrieve value for the 2nd radio button</li>\n</ul>\n\n<p>2nd radiobutton group</p>\n\n<ul>\n<li>Visible.get — seems right, to retrieve value for the 1st radio button</li>\n<li>OppositeBooleanConverter2.Convert — seems right, to get the value inverted for the 1st radio button</li>\n<li>OppositeBooleanConverter.ConvertBack (value= false)- WHY? And NOW THE CONFUSION BEGINS!</li>\n<li>Active.set (value= true) — WHY? seems to be a consequence of previous!</li>\n<li>Active.get — now it is true!</li>\n<li>OppositeBooleanConverter.ConvertBack (value= false)- Call Stack is Active.set(true)->NotifyPropertyChanged(\"Active\")</li>\n<li>Active.set (value= true) — seems to be a consequence of previous!</li>\n<li>Active.get — it is true</li>\n<li>Active.get — it is true</li>\n<li>OppositeBooleanConverter.Convert (value= true)</li>\n<li>Active.set (value= false) — seems to be a consequence of previous!</li>\n<li>Active.get — now it is false!</li>\n</ul>\n\n<p>// tired of stack tracing!</p>\n\n<p>Code is:</p>\n\n<pre><code>&lt;!--XAML--&gt;\n&lt;local:MyUserControl &gt;\n    &lt;UserControl.Resources&gt;\n        &lt;ResourceDictionary&gt;    \n            &lt;!--\n            ...\n            --&gt;\n            &lt;local:OppositeBooleanConverter x:Key=\"MyOppositeBooleanConverter\"/&gt;\n            &lt;local:OppositeBooleanConverter2 x:Key=\"MyOppositeBooleanConverter2\"/&gt;\n        &lt;/ResourceDictionary&gt;\n    &lt;/UserControl.Resources&gt;\n\n    &lt;Grid x:Name=\"LayoutRoot\"&gt;\n        &lt;!--\n        ...\n        --&gt;\n                        &lt;RadioButton Content=\"Active\" x:Name=\"ActiveFalse\" IsChecked=\"{Binding Active, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource MyOppositeBooleanConverter}}\"/&gt;\n\n                        &lt;RadioButton Content=\"Not active\" x:Name=\"ActiveTrue\" Grid.Row=\"1\" Grid.ColumnSpan=\"2\" IsChecked=\"{Binding Active, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\" /&gt;\n\n                        &lt;RadioButton Content=\"Visible\" x:Name=\"VisibleFalse\" Grid.Row=\"2\" IsChecked=\"{Binding Visible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource MyOppositeBooleanConverter2}}\" /&gt;\n\n                        &lt;RadioButton Content=\"Not visible\" x:Name=\"VisibleTrue\" Grid.Row=\"2\" IsChecked=\"{Binding Visible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\" Margin=\"0,19,0,0\"/&gt;\n        &lt;!--\n        ...\n        --&gt;\n    &lt;/Grid&gt;    \n\n&lt;/local:MyUserControl&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>//Code behind\n\npublic class Test\n{\n    private bool m_bActive = false;\n\n    private bool m_bVisible = false;\n\n    public bool Active\n    {\n        get { return m_bActive; }\n        set\n        {\n            m_bActive = value;\n            NotifyPropertyChanged(\"Active\");\n        }\n    }\n\n    public bool Visible\n    {\n        get { return m_bVisible; }\n        set\n        {\n            m_bVisible = value;\n            NotifyPropertyChanged(\"Visible\");\n            NotifyPropertyChanged(\"Total\");\n        }\n    }\n\n\n    public double m_dTotal=0.00;\n\n    public double Total\n    {\n        get { return m_dTotal; }\n        private set\n        {\n            m_dTotal = value;\n            NotifyPropertyChanged(\"Total\");\n        }\n    }\n\n    private void NotifyPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged != null)\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n    }\n}    \n\n\n\npublic class OppositeBooleanConverter : IValueConverter\n{\n    #region IValueConverter Members\n\n    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        return !(bool)value;\n    }\n\n    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        return !(bool)value;\n    }\n\n    #endregion\n}\n\n\npublic class OppositeBooleanConverter2 : IValueConverter\n{\n    #region IValueConverter Members\n\n    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        return !(bool)value;\n    }\n\n    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        return !(bool)value;\n    }\n\n    #endregion\n}        \n</code></pre>\n\n<p>Important note: When I am making the usercontrol appear to the user, I am setting its DataContext:</p>\n\n<pre><code>        UserControl.Visibility = Visibility.Visible;\n        UserControl.DataContext = Test;    //object instance of the Test class\n</code></pre>\n\n<p>So, how do I solve this? Checkbox solution is not acceptable by our Design Department!</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13242072,"title":"How to find ViewModels in project?","body":"<p>This question might sound so basic to MVVM experts but I'm trying to understand how should I know when I need to create ViewModel and how many ... OK I have learned that ViewModel is the glue between View (UI) and Model (Data) but sometimes I see an applications has 2 UIs only and one Model but then there are 5 ViewModels involved in it. </p>\n\n<p>In fact, all I need to understand is what phenomenon in a project should be represented by a ViewModel?</p>\n\n<p>Let's say we have a phone book app. So I'm assuming Contacts need a UI e.g. search. display, edit and delete do tell me how many UIs I need. Also, </p>\n\n<pre><code>{\n string firstName,\n string lastName,\n string phone,\n bool isCompany\n}\n</code></pre>\n\n<p>can be a structure for the Model. </p>\n\n<p>Now, when it gets to ViewModel how many ViewModels are we dealing with? and how do you recognize them?</p>\n\n<p>I hope this is clear. </p>\n"},{"tags":["wpf","color-picker","color-wheel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":672,"score":1,"question_id":2478202,"title":"WPF Colour Picker/Wheel with Multiple Selection","body":"<p>I am looking for a free WPF Colour Picker/Wheel which has the ability to allow multiple colour selections. Does anything like this exist. The ones I have seen allow only one colour to be selected. I want to be able to easily select two or three colors.</p>\n"},{"tags":["wpf","validation","nhibernate","attributes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13241756,"title":"validation dynamic nhibernate c#","body":"<p>I am using <code>Nhibernate</code> and <code>Nhibernate validator</code>, </p>\n\n<p>I need to validate length of property by the config file (leng = value from config).</p>\n\n<p>For example, I want to set ID property validation. Anywhere in the world property is set to a different length. I  want to take the validate length from the external file, so I do not have to build the application if this changes)</p>\n\n<p>How can I do this?</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13237563,"title":"How to databind the tooltip to part of a user control?","body":"<p>I know this question has been asked many times before, I have found a few solutions here on line, but I could not make any of them work. I have a few elements on a custom control I have, and I want to put a bound tool tip on one of them. This is what I have so far.</p>\n\n<pre><code>&lt;UserControl x:Class=\"DirectGraphicsControl.ColorBarView\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         xmlns:DirectGraphicsControl=\"clr-namespace:Windows.DirectGraphicsControl\" mc:Ignorable=\"d\" \n         SizeChanged=\"UserControlSizeChanged\" MinWidth=\"95\"&gt;\n&lt;DockPanel LastChildFill=\"True\" Width=\"80\" x:Name=\"_mainDockPanel\"&gt;\n    &lt;TextBlock DockPanel.Dock=\"Top\" x:Name=\"_title\" x:FieldModifier=\"public\" HorizontalAlignment=\"Center\" Margin=\"0,2,0,2\"/&gt;\n    &lt;StackPanel Orientation=\"Vertical\" DockPanel.Dock=\"Bottom\" Margin=\"0,2,0,2\"\n                    x:Name=\"_bottomLabelsRegion\" x:FieldModifier=\"public\"&gt;\n        &lt;TextBlock x:Name=\"_unitName\" x:FieldModifier=\"public\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Bottom\"/&gt;\n    &lt;/StackPanel&gt;\n    &lt;Grid DataContext=\"{Binding ElementName=_mainDockPanel.Parent, Path=MyTooltip}\" &gt;\n        &lt;DirectGraphicsControl:DirectGraphicsControl x:Name=\"_directGraphicsControl\"\n                                                     MouseDoubleClick=\"HandleColorBarMouseDoubleClick\" x:FieldModifier=\"public\"&gt;\n            &lt;DirectGraphicsControl:DirectGraphicsControl.ToolTip&gt;\n                &lt;ToolTip Content=\"{Binding Path=PlacementTarget.DataContext, \n                                   RelativeSource={RelativeSource Self}}\"/&gt;\n            &lt;/DirectGraphicsControl:DirectGraphicsControl.ToolTip&gt;\n        &lt;/DirectGraphicsControl:DirectGraphicsControl&gt;\n    &lt;/Grid&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p></p>\n\n<p>and this is the code behind.</p>\n\n<pre><code>/// &lt;summary&gt;\n    /// The tool tip text\n    /// &lt;/summary&gt;\n    public static readonly DependencyProperty TooltipProperty =\n        DependencyProperty.Register(Reflection.GetPropertyName&lt;ColorBarView&gt;(m =&gt; m.MyTooltip),\n                                    typeof(string), typeof(ColorBarView));\n\n    /// &lt;summary&gt;\n    /// The tool tip text\n    /// &lt;/summary&gt;\n    public string MyTooltip\n    {\n        get { return \"Test from binding\"; }\n    }\n</code></pre>\n\n<p>The code behind property is only returning a hard coded string for now until I can actually get it working and then it will return the calculated value I would like it to. Currently on mouse over an empty box appears. When I add the text for the tooltip straight to the xaml it shows fine. This makes me think it cannot find the location of the binding.</p>\n\n<p>I am very new to wpf so any suggestions would be great.</p>\n\n<p>Thank you,</p>\n"},{"tags":["c#","wpf","security","principal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13233683,"title":"Setting CurrentPrincipal for a WPF application from within a test","body":"<p>we have a WPF application that uses CurrentPrincipal to handle security. This all works fine.</p>\n\n<p>Now, from within a test project, we call view model operations. The problem is, that in the initialization of the test we create a new instance of the application but we don't know how to set the CurrentPrincipal on this application:</p>\n\n<pre><code> private void TestInitialize()\n {\n      var app = new App();\n      // setting Thread.CurrentPrincipal doesn't set app thread it seems\n }\n</code></pre>\n\n<p>Anyone has an idea how to set the CurrentPrincipal for a WPF application from outside the application?</p>\n"},{"tags":["c#","wpf","com","sta","acrobat-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13240950,"title":"Reporting Progress from COM/STA Thread to WPF UI thread","body":"<p>I working on an application that prints PDFs using COM and the Acrobat SDK.  The app is written in C#, WPF and I am trying to figure out how to run the printing correctly on a separate thread.  I have seen that a BackgroundWorker uses the thread pool and therefore cannot be set to be STA.  I do know how to create a STA thread, but am unsure how I would report progress from a STA thread:</p>\n\n<pre><code>Thread thread = new Thread(PrintMethod);\nthread.SetApartmentState(ApartmentState.STA); //Set the thread to STA\nthread.Start(); \nthread.Join(); //Wait for the thread to end\n</code></pre>\n\n<p>How do I report progress to my WPF ViewModel in a STA thread created like this?</p>\n"},{"tags":["wpf","visual-studio-2010","xaml","uri"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":673,"score":0,"question_id":11128443,"title":"Invalid URI: The Authority/Host could not be parsed","body":"<p>I am using Visual Studio 2010 with Visual Basic and WPF.  I've this one line of XAML code in my program throughout a 2-year development process that sets a background image for the main window.  It's always worked perfectly with absolutely no problems:</p>\n\n<pre><code>&lt;ImageBrush ImageSource=\"/MyProgram;component/Images/background.jpg\"\nStretch=\"UniformToFill\" TileMode=\"None\" /&gt;\n</code></pre>\n\n<p>Now, I've gotten a new computer and copied over my VS2010 projects directory.  All of a sudden, I'm getting this error in the design view:</p>\n\n<pre><code>Invalid URI: The Authority/Host could not be parsed\n</code></pre>\n\n<p>The Design view is completely frozen and won't let me do anything.  However, the program still compiles just fine, background image and all.  But obviously I can't continue my work on the program without the Design view.  How can I fix this problem?</p>\n\n<p>Incidentally, in case someone asks, this program has not been changed AT ALL in between working on my old computer and not working on my new computer.  However, the version of VS2010 has changed from Premium to Ultimate, if that makes a difference.</p>\n\n<p>SOME ADDITIONAL INFORMATION:  I deleted the offending line of XAML code and attempted to re-add the background image to the window via the Design view (the Properties editor).  Everything works fine so long as the background is set to a solid color, but as soon as I click on the button to set an image as the background, before it even lets me pick an image, I get an error that says the property's value is not valid, referencing the same Invalid URI error as before.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13239095,"title":"How to dynamically change columns with rows so WPF UserControl appearance is different for each screen","body":"<p>I have a UserControl that is made of two grids.</p>\n\n<p>There are two columns in the grid side by side and this grid has the horizontal layout.\nColumn 0 has one data and Column 1 has another data.</p>\n\n<p>I need to have this control to be able to change the layout from horizontal to vertical depending on the screen this control should be displayed in, so instead of having Columns 0 and 1 displaying the data, the Row 0 and Row 1 should now display the data.</p>\n\n<p>What is the best way to accomplish this?</p>\n\n<p>Thank you</p>\n"},{"tags":["wpf","binding",".net-4.0","itemscontrol"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2905,"score":4,"question_id":3063031,"title":"ItemsControl ItemTemplate Binding","body":"<p>In WPF4.0, I have a class that contains other class types as properties (combining multiple data types for display).  Something like:</p>\n\n<pre><code>public partial class Owner\n{\n     public string OwnerName { get; set; }\n     public int    OwnerId   { get; set; }\n}\n\npartial class ForDisplay\n{\n    public Owner OwnerData { get; set; }\n    public int Credit { get; set; }\n}\n</code></pre>\n\n<p>In my window, I have an ItemsControl with the following (clipped for clarity):</p>\n\n<pre><code>&lt;ItemsControl ItemsSource={Binding}&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n          &lt;local:MyDisplayControl \n                OwnerName={Binding OwnerData.OwnerName}\n                Credit={Binding Credit} /&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>I then get a collection of display information from the data layer, and set the DataContext of the ItemsControl to this collection.  The \"Credit\" property gets displayed correctly, but the OwnerName property does not.  Instead, I get a binding error: </p>\n\n<blockquote>\n  <p>Error 40: BindingExpression path\n  error: 'OwnerName' property not found\n  on 'object' ''ForDisplay'\n  (HashCode=449124874)'. \n  BindingExpression:Path=OwnerName;\n  DataItem='ForDisplay'\n  (HashCode=449124874); target element\n  is 'TextBlock' (Name=txtOwnerName');\n  target property is 'Text' (type\n  'String')</p>\n</blockquote>\n\n<p>I don't understand why this is attempting to look for the OwnerName property in the ForDisplay class, rather than in the Owner class from the ForDisplay OwnerData property.</p>\n\n<p><strong>Edit</strong>\nIt appears that it has something to do with using the custom control.  If I bind the same properties to a TextBlock, they work correctly.</p>\n\n<pre><code>&lt;ItemsControl ItemsSource={Binding}&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n          &lt;StackPanel&gt;\n              &lt;local:MyDisplayControl \n                        OwnerName={Binding OwnerData.OwnerName}\n                        Credit={Binding Credit} /&gt;\n              &lt;TextBlock Text=\"{Binding OwnerData.OwnerName}\" /&gt;\n              &lt;TextBlock Text=\"{Binding Credit}\" /&gt;\n          &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>Thanks,\nwTs</p>\n"},{"tags":["wpf","graphics","charts","wpf-controls","rendering"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":10160740,"title":"How to render a VisualElement to a Vector Based Image?","body":"<p>I am working on a Chart Control,\nI need to implement the Chart Snapshot feature for capturing a vector based image in high quality of Curves and Texts, in any requested size. </p>\n\n<p>Can anyone suggest me any solution or a pointer to resolve this problem.</p>\n\n<p>Any kind of help in deeply appreciated. </p>\n"},{"tags":["wpf","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13235034,"title":"Wpf combobox Databinding with parent/child table","body":"<p>I'm new to wpf and DataBinding. I tried wpf in a little application.\nAnd now i have a problem using CollectionViewSource in combination with combobox</p>\n\n<p>in a Datagrid i show the content of table \"OrderDetails\"\nAnd now the problem: i would like to display the field \"PartId\" as Combox. the combox should contains all \"Parts\" and displays the \"Name\" not the PartId</p>\n\n<p>(sorry i cant upload Picture of DB-layout)</p>\n\n<p>Table <strong>OrderDetails</strong>:<em>Id</em>,OrderId,PartId,Count</p>\n\n<p>Table <strong>Parts</strong>: <em>Id</em>, Name, Description, Price</p>\n\n<pre><code>&lt;DataGrid Margin=\"80,0,0,0\" Background=\"Transparent\" HeadersVisibility=\"Column\" \n  ItemsSource=\"{Binding Source={StaticResource projectsOrderdetailsViewSource}}\"&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridTemplateColumn Header=\"Fahrzeug\" Width=\"SizeToHeader\"&gt;\n            &lt;DataGridTemplateColumn.CellTemplate&gt;\n                 &lt;DataTemplate&gt;\n                     &lt;ComboBox  DisplayMemberPath=\"Name\"\n                       ItemsSource=\"{Binding Source={StaticResource partsViewSource}}\" \n                       SelectedValue=\"{Binding Path=ID}\"\n                       SelectedValuePath=\"{Binding Path=PartId}\"/&gt;\n                 &lt;/DataTemplate&gt;\n             &lt;/DataGridTemplateColumn.CellTemplate&gt;\n         &lt;/DataGridTemplateColumn&gt;\n....\n</code></pre>\n\n<p>the datagrid and the containing Combobox is displayed,\nbut </p>\n\n<ol>\n<li>the value isn't show correctly. </li>\n<li>If i select anything from the combobox, all items of the datagrid gets the selected value.</li>\n</ol>\n\n<p>Can you help me to configure the combobox correctly</p>\n"},{"tags":[".net","wpf","flowdocument","tableofcontents"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13228869,"title":"How to create flowdocument table of contents","body":"<p>I have created a flow document. In case the document is printed or saved to a file I would like to add a TOC to the start of the document.</p>\n\n<p>What is the correct way of creating a TOC in a flowdocument? Can it be created automatically or should I add the TOC as the last thing looping through all the Paragraphs/Sections and manually add them to a table? If the manual creation is the way to go the next question that appears is how to determine the page number a Paragraph/Section is located on?</p>\n"},{"tags":["c#","wpf","xaml","wpf-controls","expression-blend"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13151028,"title":"Open PathListBoxScrollBehavior WPF","body":"<p>I'm using blend 4 and vs 2010 to develop a port of an app from iPad to Windows Desktop.\nI have a pathlistbox with PathListBoxScrollBehavior attached like in the carousel tutorial showed by Microsoft in the presentation of PathListBoxUtils.</p>\n\n<p>My path is a open path (a line) and I don't want a infinite carousel but a path list box that go through the items but stops when comes in the last or first item. Am I being clear?</p>\n\n<p>Something similar to what exist is on ios (similar to the cover flow effect too)</p>\n\n<p><a href=\"http://www.youtube.com/watch?v=YIWDlnvHRLw&amp;feature=related\" rel=\"nofollow\">http://www.youtube.com/watch?v=YIWDlnvHRLw&amp;feature=related</a> </p>\n\n<p>I know there are ways to do that but I can't find it.</p>\n"},{"tags":["wpf","windows-8","touch"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13239118,"title":"Touch events not firing for \"swipe from edge\" in a WPF app under windows 8","body":"<p>I have a fullscreen windows 8 desktop WPF application that at the moment, is a basically a UserControl with a Canvas. If I do a horizontal (left-to-right) swipe (touch-and-drag) originating from the left edge of the screen, I don't get any touch events (no TouchDown, TouchMove or TouchUp). This is an area about 40 pixels wide. The weird thing is, I can do a vertical swipe directly inside this 40 pixel area without any issues. My current hypothesis, is that windows 8 is stealing my touch events for the app switching gesture.</p>\n\n<p>I tried turning off the app switching gesture and also turning off flicks but neither has solved my problem.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":725,"score":-1,"question_id":10315319,"title":"WPF : Select/Deselect ListView's Data items on click of Select All checkbox control","body":"<p>I am working on a WPF application where I have to bind three different <code>ListViews</code> grouped inside a <code>GroupBox</code> container.</p>\n\n<p>This is the XAML for the display:</p>\n\n<pre><code>&lt;GroupBox Header=\"Zone2 Sensors\" Height=\"250\" Name=\"grpBoxZone2\" Width=\"380\" Margin=\"25,248,90,660\" Grid.Column=\"5\" Grid.ColumnSpan=\"2\" Foreground=\"#FF1E5EE6\"&gt;\n    &lt;Grid Height=\"250\" Width=\"375\" MinHeight=\"250\"&gt;\n        &lt;Label Content=\"Strain\" Width=\"40\" Name=\"labelZone2S\" Foreground=\"#FF1E5EE6\" Margin=\"44,1,291,227\" /&gt;\n        &lt;Label Content=\"Accelerometer\" Width=\"79\" Name=\"labelZone2A\" Foreground=\"#FF1E5EE6\" Margin=\"132,1,164,227\" /&gt;\n        &lt;Label Content=\"Tilt\" Name=\"labelZone2T\" Foreground=\"#FF1E5EE6\" Margin=\"264,1,82,227\" /&gt;\n        &lt;ListView Margin=\"25,42,268,49\" Name=\"lst2\" ItemsSource=\"{Binding}\" HorizontalContentAlignment=\"Stretch\" VerticalContentAlignment=\"Stretch\" BorderThickness=\"0\" SelectionChanged=\"lst2_SelectionChanged\"&gt;\n            &lt;ListView.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border Padding=\"5\" Background=\"#FF83A2DA\" BorderThickness=\"1\" BorderBrush=\"Black\"&gt;\n                        &lt;CheckBox Name=\"CheckBoxs1\" IsChecked=\"{Binding IsSelected}\" Click=\"CheckBoxs1_Click\" Unchecked=\"CheckBoxs1_Unchecked\"&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;TextBlock Text=\"{Binding ObjectData}\"&gt;&lt;/TextBlock&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/CheckBox&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ListView.ItemTemplate&gt;\n        &lt;/ListView&gt;\n        &lt;ListView Margin=\"134,42,159,111\" Name=\"lstZone2A\" ItemsSource=\"{Binding}\" HorizontalAlignment=\"Stretch\" HorizontalContentAlignment=\"Stretch\" VerticalContentAlignment=\"Stretch\" BorderThickness=\"0\" SelectionChanged=\"lstZone2A_SelectionChanged\"&gt;\n            &lt;ListView.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border Padding=\"5\" Background=\"#FF83A2DA\" BorderThickness=\"1\" BorderBrush=\"Black\"&gt;\n                        &lt;CheckBox Name=\"ChkZone2A\" IsChecked=\"{Binding IsSelected}\" Checked=\"ChkZone2A_Checked\" Unchecked=\"ChkZone2A_Unchecked\"&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;TextBlock Text=\"{Binding ObjectData}\"&gt;&lt;/TextBlock&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/CheckBox&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ListView.ItemTemplate&gt;\n        &lt;/ListView&gt;\n        &lt;ListView Margin=\"249,42,44,156\" Name=\"lstZone2T\" ItemsSource=\"{Binding}\" HorizontalAlignment=\"Stretch\" HorizontalContentAlignment=\"Stretch\" VerticalContentAlignment=\"Stretch\" BorderThickness=\"0\" SelectionChanged=\"lstZone2T_SelectionChanged\"&gt;\n            &lt;ListView.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border Padding=\"5\" Background=\"#FF83A2DA\" BorderThickness=\"1\" BorderBrush=\"Black\"&gt;\n                        &lt;CheckBox Name=\"ChkZone2T\" IsChecked=\"{Binding IsSelected}\" Checked=\"ChkZone2T_Checked\" Unchecked=\"ChkZone2T_Unchecked\"&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;TextBlock Text=\"{Binding ObjectData}\"&gt;&lt;/TextBlock&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/CheckBox&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ListView.ItemTemplate&gt;\n        &lt;/ListView&gt;\n        &lt;CheckBox Content=\"Select ALL Sensors\" Margin=\"14,21,248,213\" Name=\"chkZone2SelectAll\" Checked=\"chkZone2SelectAll_Checked\" Unchecked=\"chkZone2SelectAll_Unchecked\" /&gt;\n    &lt;/Grid&gt;\n&lt;/GroupBox&gt;\n</code></pre>\n\n<p>This is the C# code which I use to check and uncheck items:</p>\n\n<pre><code>private void chkZone2SelectAll_Checked(object sender, RoutedEventArgs e)\n{\n    try\n    {\n        StringBuilder sb = new StringBuilder();\n        for (int i = 0; i &lt; lst2.Items.Count; i++)\n        {\n                // Get a all list items from listbox\n                ListBoxItem ListBoxItemObj = (ListBoxItem)lst2.ItemContainerGenerator.ContainerFromItem(lst2.Items[i]);\n                //bool check = ListBoxItemObj.HasContent;\n                // find a ContentPresenter of that list item.. [Call FindVisualChild Method]\n                ContentPresenter ContentPresenterObj = FindVisualChild&lt;ContentPresenter&gt;(ListBoxItemObj);\n\n                // call FindName on the DataTemplate of that ContentPresenter\n                DataTemplate DataTemplateObj = ContentPresenterObj.ContentTemplate;\n                CheckBox Chk = (CheckBox)DataTemplateObj.FindName(\"CheckBoxs1\", ContentPresenterObj);\n                Chk.IsChecked = true;\n        }\n        for (int i = 0; i &lt; lstZone2A.Items.Count; i++)\n        {\n            // Get a all list items from listbox\n            ListBoxItem ListBoxItemObj = (ListBoxItem)lstZone2A.ItemContainerGenerator.ContainerFromItem(lstZone2A.Items[i]);\n\n            // find a ContentPresenter of that list item.. [Call FindVisualChild Method]\n            ContentPresenter ContentPresenterObj = FindVisualChild&lt;ContentPresenter&gt;(ListBoxItemObj);\n\n            // call FindName on the DataTemplate of that ContentPresenter\n            DataTemplate DataTemplateObj = ContentPresenterObj.ContentTemplate;\n            CheckBox Chk = (CheckBox)DataTemplateObj.FindName(\"ChkZone2A\", ContentPresenterObj);\n            Chk.IsChecked = true;\n        }\n        for (int i = 0; i &lt; lstZone2T.Items.Count; i++)\n        {\n            // Get a all list items from listbox\n            ListBoxItem ListBoxItemObj = (ListBoxItem)lstZone2T.ItemContainerGenerator.ContainerFromItem(lstZone2T.Items[i]);\n\n            // find a ContentPresenter of that list item.. [Call FindVisualChild Method]\n            ContentPresenter ContentPresenterObj = FindVisualChild&lt;ContentPresenter&gt;(ListBoxItemObj);\n\n            // call FindName on the DataTemplate of that ContentPresenter\n            DataTemplate DataTemplateObj = ContentPresenterObj.ContentTemplate;\n            CheckBox Chk = (CheckBox)DataTemplateObj.FindName(\"ChkZone2T\", ContentPresenterObj);\n            Chk.IsChecked = true;\n        }\n        foreach (TripInfo cbObject in lst2.Items)\n        {\n            cbObject.IsSelected = true;\n        }\n        foreach (TripInfo cbObject in lstZone2A.Items)\n        {\n            cbObject.IsSelected = true;\n        }\n        foreach (TripInfo cbObject in lstZone2T.Items)\n        {\n            cbObject.IsSelected = true;\n        }\n        foreach (TripInfo cbObject in lst2.Items)\n        {\n            if (cbObject.IsSelected)\n            {\n                if (SelectedSensser != null)\n                {\n                    if (SelectedSensser.Contains(cbObject.ObjectData.ToString())) { }\n                    else\n                    {\n                        sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                    }\n                }\n                else\n                {\n                    sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                }\n                SelectedSensser += sb.ToString().Trim();\n                sb.Clear();\n            }\n        }\n        foreach (TripInfo cbObject in lstZone2A.Items)\n        {\n            if (cbObject.IsSelected)\n            {\n                if (SelectedSensser != null)\n                {\n                    if (SelectedSensser.Contains(cbObject.ObjectData.ToString())) { }\n                    else\n                    {\n                        sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                    }\n                }\n                else\n                {\n                    sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                }\n                SelectedSensser += sb.ToString().Trim();\n                sb.Clear();\n            }\n        }\n        foreach (TripInfo cbObject in lstZone2T.Items)\n        {\n            if (cbObject.IsSelected)\n            {\n                if (SelectedSensser != null)\n                {\n                    if (SelectedSensser.Contains(cbObject.ObjectData.ToString())) { }\n                    else\n                    {\n                        sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                    }\n                }\n                else\n                {\n                    sb.AppendFormat(\"{0}, \", cbObject.ObjectData.ToString());\n                }\n                SelectedSensser += sb.ToString().Trim();\n                sb.Clear();\n            }\n        }\n    }\n    catch (Exception ex) { throw ex; }\n}\n\nprivate ChildControl FindVisualChild&lt;ChildControl&gt;(DependencyObject DependencyObj) where ChildControl : DependencyObject\n{\n    int count = VisualTreeHelper.GetChildrenCount(DependencyObj);\n    for (int i = 0; i &lt; VisualTreeHelper.GetChildrenCount(DependencyObj); i++)\n    {\n        DependencyObject Child = VisualTreeHelper.GetChild(DependencyObj, i);\n\n        if (Child != null &amp;&amp; Child is ChildControl)\n        {\n            return (ChildControl)Child;\n        }\n        else\n        {\n            ChildControl ChildOfChild = FindVisualChild&lt;ChildControl&gt;(Child);\n\n            if (ChildOfChild != null)\n            {\n                return ChildOfChild;\n            }\n        }\n    }\n    return null;\n}\n\npublic class TripInfo\n{\npublic TripInfo(string objectData) { ObjectData = objectData; }\n\npublic TripInfo(bool isSelected, string objectData)\n{\n    IsSelected = isSelected;\n\n    ObjectData = objectData;\n}\n\npublic Boolean IsSelected\n{ get; set; }\npublic String ObjectData\n{ get; set; }\n\n}\n</code></pre>\n\n<p>However, this gives me the following error when it reaches the 8th index, but the <code>ListItems</code> count shows 10 elements:</p>\n\n<pre><code>Value cannot be null.\nParameter name: element\n</code></pre>\n"},{"tags":["wpf","directx","sharpdx","msaa","d3dimage"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13238723,"title":"Multisampling (MSAA) for DirectX11/DirectX10 with D3DImage shared resource","body":"<p>I am trying to get MSAA in DX11 using D3DImage, but is seems, it is not possible, since shared multisampling texture are not allowed, as stated here: <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ff476531(v=vs.85).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windows/desktop/ff476531(v=vs.85).aspx</a></p>\n\n<p>Actually, I use the SharpDX implementation of the D3DImage, which works fine for DX11 and DX10 as long one can leave without anti alisasing. </p>\n\n<p>Approaches to solve it are described in this thread: <a href=\"http://sharpdx.org/forum/5-api-usage/1000-d3d11-problem-with-usage-of-texture2d\" rel=\"nofollow\">http://sharpdx.org/forum/5-api-usage/1000-d3d11-problem-with-usage-of-texture2d</a> which are not successful. There is yet another thread asking a similar question: <a href=\"http://stackoverflow.com/questions/10018230/multisampling-and-direct3d10-d3dimage-interop\">Multisampling and Direct3D10 / D3DImage interop</a></p>\n\n<p>Finally, the question is in fact, if anyone can confirm, that it is <em>definitly NOT possible</em> to use D3DImage for rendering of anti-aliased content from DX10/DX11?</p>\n"},{"tags":["wpf","checkbox","triggers"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3216,"score":1,"question_id":862047,"title":"Select All Checkbox in XAML using trigger?","body":"<p>I'd like to implement a select all checkbox in xaml.<br />\nI have several (templated) checkboxes in a listview. Then I have a checkbox outside of the listview, which I want to have a \"select all\"-behaviour.\nI could easily solve the problem in my ViewModel, however, I think it would be more elegant to do this in xaml, since the select all checkbox doesn't (directly) have anything to do with my ViewModel. \nThe code looks something like this:</p>\n\n<pre><code>&lt;ListView&gt;\n    &lt;ListView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n        &lt;CheckBox Content=\"Globale Eingabe\"\n            Name=\"SelectSingle\"\n            IsChecked=\"{Binding IsChecked}\"&gt;\n        &lt;/CheckBox&gt;\n    &lt;/DataTemplate&gt;\n&lt;ListView.ItemTemplate&gt;  \n&lt;/ListView&gt;\n&lt;CheckBox Name=\"SelectAll\" /&gt;\n</code></pre>\n\n<p>As you see the IsChecked Property of the SelectSingle is already bound to my ViewModel. So I reckon I need a trigger to manipulate the state of the checkbox.   </p>\n\n<p>Now I already tried sth like this:</p>\n\n<pre><code>&lt;CheckBox Content=\"Globale Eingabe\"\n    Name=\"SelectSingle\"\n    IsChecked=\"{Binding IsChecked}\"&gt;\n    &lt;CheckBox.Triggers&gt;\n        &lt;Trigger SourceName=\"SelectAll\" Property=\"IsChecked\" Value=\"True\"&gt;\n            &lt;Setter TargetName=\"SelectSingle\"  Property=\"IsChecked\" Value=\"True\"/&gt;\n        &lt;/Trigger&gt;\n    &lt;/CheckBox.Triggers&gt;\n&lt;/CheckBox&gt;\n</code></pre>\n\n<p>or sth like this:</p>\n\n<pre><code>&lt;CheckBox Content=\"Globale Eingabe\"\n    Name=\"SelectSingle\"\n    IsChecked=\"{Binding IsChecked}\"&gt;\n    &lt;CheckBox.Triggers&gt;\n        &lt;DataTrigger Binding=\"{Binding ElementName=SelectAll, Path=IsChecked}\" \n            Value=\"True\"&gt;\n            &lt;Setter TargetName=\"Check\"\n                Property=\"IsChecked\"\n                Value=\"True\"/&gt;\n        &lt;/DataTrigger&gt;\n    &lt;/CheckBox.Triggers&gt;\n&lt;/CheckBox&gt;\n</code></pre>\n\n<p>I also tried the same thing within a style, but to no avail. I always obtain an error, sth along the lines of \"static member \"IsCheckedProperty couldn't be found in type \"ContentPresenter\"\".</p>\n\n<p>Now that sounds as if the Target/SourceName binding wouldn't work, but why?\nIs there something that I am missing?</p>\n"},{"tags":["wpf","templates","control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13233172,"title":"Access ControlTemplate components (windows 8 app)","body":"<p>I would like to combine some UI elements into a Control, and then access them by code. However I can't figure it out.\nThe control template:</p>\n\n<pre><code>&lt;Page.Resources&gt;\n    &lt;Style x:Key=\"GridViewStyle1\" TargetType=\"GridView\"&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"GridView\"&gt;\n                    &lt;Grid&gt;                      \n                        &lt;TextBox x:Name=\"theTextBox\" Text=\"The Text\" /&gt;                         \n                    &lt;/Grid&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n&lt;/Page.Resources&gt;\n</code></pre>\n\n<p>And a reference to the Template:</p>\n\n<pre><code>&lt;GridView x:Name=\"myGridView1\" Style=\"{StaticResource TileControl}\"/&gt;\n</code></pre>\n\n<p>So what I'm looking for is something like this for example:</p>\n\n<pre><code>myGridView1.Style.Template.Gridview.theTextBox.Text\n</code></pre>\n\n<p>But I can't find it. Any idea how I can do that? Or maybe I'm on the wrong track since it shouldn't be so complicated?</p>\n"},{"tags":["wpf","entity-framework","mvvm","command","viewmodel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13237688,"title":"Create object from View input and pass it to ViewModel (in MVVM)","body":"<p>Recently I'm developing my first project using <strong><a href=\"http://en.wikipedia.org/wiki/Model_View_ViewModel\" rel=\"nofollow\">MVVM</a></strong> concept (I use <strong><a href=\"http://en.wikipedia.org/wiki/Windows_Presentation_Foundation\" rel=\"nofollow\">WPF</a></strong>). I've read many tutorials (ia. famous <a href=\"http://msdn.microsoft.com/en-us/magazine/dd419663.aspx\" rel=\"nofollow\">J.Smith's</a> one) about <strong>MVVM</strong> before I started writing a code. Everything I've read had been clear until I started to code...</p>\n\n<p>The problem is simple: in <em>View</em> layer I have a form with <code>TextBox</code>es. Let's say a few <code>TextBox</code>es, ie.: <strong>Name</strong>, <strong>Surname</strong>, <strong>Phone number</strong>. When user fills all of them and clicks <strong>OK</strong>-button, I want to add new person (with specified personal details) to my local <strong>Database</strong> (I use <em>Entity Framework</em> as a <a href=\"http://en.wikipedia.org/wiki/Object-relational_mapping\" rel=\"nofollow\">ORM</a>). </p>\n\n<p>To do this I need to write something like this: </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Button Name=\"MyButton\" Command=\"MyRelayCommandWhichNeedsAllOfTheTextboxes\" Content=\"OK\" /&gt;\n</code></pre>\n\n<p>Using <code>CommandParameter</code> I can pass one object from <em>View</em> to <em>ViewModel</em>. There are many textboxes so it's probably not a good idea. </p>\n\n<p>From <em>XAML</em> I can assign to <code>CommandParameter</code> whole form which needs to be filled by user. But then, inside <em>ViewModel</em>, I need to know all textboxes' names. The main assumption in MVVM is that all the layers (View, ViewModel and Model) have to be independent. </p>\n\n<p>What's the best solution? How can I pass input data from form to <em>ViewModel</em>?</p>\n"},{"tags":["c#","wpf","dataset","progress-bar","system.reactive"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":13201519,"title":"Update WPF progress bar while filling DataSet, all using Rx","body":"<p>I'm a bit new in Rx, so please excuse me if this seems silly or obvious...</p>\n\n<p>I have an application which at a certain time, is meant to scan a selected folder and retrieve all files recursively, after which it needs to store them in a database. I would like to display a progress bar during that process while keeping the UI responsive of course. A cancel button would also be nice at a later stage.</p>\n\n<p>I've implemented this using Rx, like so:</p>\n\n<pre><code>// Get a list of all the files\nvar enumeratedFiles = Directory.EnumerateFiles(targetDirectory, \"*.*\", SearchOption.AllDirectories);\n\n// prepare the progress bar\n            double value = 0;\n            progBar.Minimum = 0;\n            progBar.Maximum = enumeratedFiles.Count();\n            progBar.Value = value;\n            progBar.Height = 15;\n            progBar.Width = 100;\n            statusBar.Items.Add(progBar);\n\nvar files = enumeratedFiles.ToObservable()\n                .SubscribeOn(TaskPoolScheduler.Default)\n                .ObserveOnDispatcher()\n                .Subscribe(x =&gt;\n                    {\n                        myDataSet.myTable.AddTableRow(System.IO.Path.GetFileNameWithoutExtension(x));\n                        value++;\n                    },\n                    () =&gt;\n                    {\n                        myDataSetTableAdapter.Update(myDataSet.myTable);\n                        myDataSetTableAdapter.Fill(myDataSet.myTable);\n                        statusBar.Items.Remove(progBar);\n                    });\n</code></pre>\n\n<p>However, with the above example the UI is locked and the progress bar doesn't update during the process. I assume that's because the AddTableRow method is blocking the thread, although I believed that the SubscribeOn(TaskPoolScheduler) was supposed to run the task on a new thread?</p>\n\n<p>I've tried a few different approaches as well, with varying results. For example adding a .Do line:</p>\n\n<pre><code>var files = enumeratedFiles.ToObservable()\n                .Do(x =&gt; myDataSet.myTable.AddTableRow(System.IO.Path.GetFileNameWithoutExtension(x)))\n                .SubscribeOn(TaskPoolScheduler.Default)\n                .ObserveOnDispatcher()\n                .Subscribe(x =&gt;\n                    {\n                        value++;\n                    },\n                    () =&gt;\n                    {\n                        myDataSetTableAdapter.Update(myDataSet.myTable);\n                        myDataSetTableAdapter.Fill(myDataSet.myTable);\n                        statusBar.Items.Remove(progBar);\n                        btnCancel.Visibility = Visibility.Collapsed;\n                    });\n</code></pre>\n\n<p>this actually shows the progress bar updates, and the UI is not completely locked but it is choppy and the performance crawls down...</p>\n\n<p>I've tried using a BackgroundWorker to do the same job, but the performance is way worse than the Rx approach above (for example, for 21000 files the Rx approach takes a few seconds while the BackgroundWorker a few minutes to finish).</p>\n\n<p>I've also seen similar problems being tackled with Delegates for the progress bar's ValueProperty method, but I would really like to solve this using Rx if possible.</p>\n\n<p>Am I missing something obvious here? Any suggestion would be highly appreciated...</p>\n"},{"tags":["c#","wpf","kinect"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13231646,"title":"Kinect Face tracking on a non UI thread","body":"<p>I am able to track the face when using all the streams (color,depth,skeleton) on the main UI thread. But when I wish to do all the kinect processing on a separate thread, which i do as follows:</p>\n\n<pre><code>kinectThread = new Thread(getKinectSensorData);\n\npublic void getKinectSensorData()\n    {\n            sensor.AllFramesReady += new EventHandler&lt;AllFramesReadyEventArgs&gt;(sensor_AllFramesReady); \n    }\n</code></pre>\n\n<p>My program crashes at the following line with the error shown bellow:</p>\n\n<pre><code>faceFrame = newfacetracker.Track(sensor.ColorStream.Format, colorPixelData,\n                                       sensor.DepthStream.Format, depthPixelData, currentSkeleton);\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>An unhandled exception of type 'System.InvalidCastException' occurred\n  in Microsoft.Kinect.Toolkit.FaceTracking.dll</p>\n  \n  <p>Additional information: Unable to cast COM object of type\n  'System.__ComObject' to interface type\n  'Microsoft.Kinect.Toolkit.FaceTracking.IFTImage'. This operation\n  failed because the QueryInterface call on the COM component for the\n  interface with IID '{1A00A7BC-C217-11E0-AC90-0024811441FD}' failed due\n  to the following error: No such interface supported (Exception from\n  HRESULT: 0x80004002 (E_NOINTERFACE)).</p>\n</blockquote>\n\n<p>The colorstream, depthstream and skeletonstream all work fine however, the program could never pass the newfacetracker.Track line of code. Is it not possible to run the face tracking on a non-UI thread? Please advise me.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","combobox","textblock"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13236723,"title":"Changing color of a TextBlock within a ComboBox through code","body":"<p>I have a few TextBlocks that is stored within my ComboBox. What I would like to do is have each TextBlock have a different font color. I have seen many topics discussing how to do this, but I would like to know if it is possible to do it in code? The reason I ask is because the application connects to a server and gets items from the network which I then set in the TextBlock before pushing the item onto the ComboBox. I set the ForeGround and BackGround based o what the server tells me it should be, but the color always appears as black no matter what. Any advice would be greatly appreciated.</p>\n"},{"tags":["c#","wpf","kinect","image-zoom"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":241,"score":0,"question_id":12669214,"title":"Adding zooming and panning functionality in SlideShowGestures-WPF Kinect sample","body":"<p>This is the code from the SlideshowGestures-WPF sample that can be used to recognize swipe gestures. I've used Fizbin's (<a href=\"http://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/\" rel=\"nofollow\">http://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/</a>) library to add the zooming gestures in this code. The gesture is identified correctly and the code goes into the 'if' loop in the function 'OnGestureRecognised'. What I want to do is, once that is done I want to zoom in on the image. I tried using the solution here: <a href=\"http://stackoverflow.com/a/927134/1473556\">http://stackoverflow.com/a/927134/1473556</a> by Kelly. But the problem is, RenderTransform does not work with objects of BitmapImage class. So how do I go about it?</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window, INotifyPropertyChanged\n{\n    /// &lt;summary&gt;\n    /// The recognizer being used.\n    /// &lt;/summary&gt;\n    private readonly Recognizer activeRecognizer;\n\n    // skeleton gesture recognizer\n    private GestureController gestureController;\n\n    /// &lt;summary&gt;\n    /// The paths of the picture files.\n    /// &lt;/summary&gt;\n    private readonly string[] picturePaths = CreatePicturePaths();\n\n    /// &lt;summary&gt;\n    /// Array of arrays of contiguous line segements that represent a skeleton.\n    /// &lt;/summary&gt;\n    private static readonly JointType[][] SkeletonSegmentRuns = new JointType[][]\n    {\n        new JointType[] \n        { \n            JointType.Head, JointType.ShoulderCenter, JointType.HipCenter \n        },\n        new JointType[] \n        { \n            JointType.HandLeft, JointType.WristLeft, JointType.ElbowLeft, JointType.ShoulderLeft,\n            JointType.ShoulderCenter,\n            JointType.ShoulderRight, JointType.ElbowRight, JointType.WristRight, JointType.HandRight\n        },\n        new JointType[]\n        {\n            JointType.FootLeft, JointType.AnkleLeft, JointType.KneeLeft, JointType.HipLeft,\n            JointType.HipCenter,\n            JointType.HipRight, JointType.KneeRight, JointType.AnkleRight, JointType.FootRight\n        }\n    };\n\n    /// &lt;summary&gt;\n    /// The sensor we're currently tracking.\n    /// &lt;/summary&gt;\n    private KinectSensor nui;\n\n    /// &lt;summary&gt;\n    /// There is currently no connected sensor.\n    /// &lt;/summary&gt;\n    private bool isDisconnectedField = true;\n\n    /// &lt;summary&gt;\n    /// Any message associated with a failure to connect.\n    /// &lt;/summary&gt;\n    private string disconnectedReasonField;\n\n    /// &lt;summary&gt;\n    /// Array to receive skeletons from sensor, resize when needed.\n    /// &lt;/summary&gt;\n    private Skeleton[] skeletons = new Skeleton[0];\n\n    /// &lt;summary&gt;\n    /// Time until skeleton ceases to be highlighted.\n    /// &lt;/summary&gt;\n    private DateTime highlightTime = DateTime.MinValue;\n\n    /// &lt;summary&gt;\n    /// The ID of the skeleton to highlight.\n    /// &lt;/summary&gt;\n    private int highlightId = -1;\n\n    /// &lt;summary&gt;\n    /// The ID of the skeleton to be tracked.\n    /// &lt;/summary&gt;\n    private int nearestId = -1;\n\n    /// &lt;summary&gt;\n    /// The index of the current image.\n    /// &lt;/summary&gt;\n    private int indexField = 1;\n\n    /// &lt;summary&gt;\n    /// Initializes a new instance of the &lt;see cref=\"MainWindow\" /&gt; class.\n    /// &lt;/summary&gt;\n    public MainWindow()\n    {\n        this.PreviousPicture = this.LoadPicture(this.Index - 1);\n        this.Picture = this.LoadPicture(this.Index);\n        this.NextPicture = this.LoadPicture(this.Index + 1);\n\n        InitializeComponent();\n\n        // initialize the gesture recognizer\n        gestureController = new GestureController();\n        gestureController.GestureRecognized += OnGestureRecognized;\n\n        // Create the gesture recognizer.\n        this.activeRecognizer = this.CreateRecognizer();\n\n        // Wire-up window loaded event.\n        Loaded += this.OnMainWindowLoaded;\n    }\n\n    /// &lt;summary&gt;\n    /// Event implementing INotifyPropertyChanged interface.\n    /// &lt;/summary&gt;\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    /// &lt;summary&gt;\n    /// Gets a value indicating whether no Kinect is currently connected.\n    /// &lt;/summary&gt;\n    public bool IsDisconnected\n    {\n        get\n        {\n            return this.isDisconnectedField;\n        }\n\n        private set\n        {\n            if (this.isDisconnectedField != value)\n            {\n                this.isDisconnectedField = value;\n\n                if (this.PropertyChanged != null)\n                {\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"IsDisconnected\"));\n                }\n            }\n        }\n    }\n\n\n    /// &lt;summary&gt;\n    /// Gets any message associated with a failure to connect.\n    /// &lt;/summary&gt;\n    public string DisconnectedReason\n    {\n        get\n        {\n            return this.disconnectedReasonField;\n        }\n\n        private set\n        {\n            if (this.disconnectedReasonField != value)\n            {\n                this.disconnectedReasonField = value;\n\n                if (this.PropertyChanged != null)\n                {\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"DisconnectedReason\"));\n                }\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Gets or sets the index number of the image to be shown.\n    /// &lt;/summary&gt;\n    public int Index\n    {\n        get\n        {\n            return this.indexField;\n        }\n\n        set\n        {\n            if (this.indexField != value)\n            {\n                this.indexField = value;\n\n                // Notify world of change to Index and Picture.\n                if (this.PropertyChanged != null)\n                {\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"Index\"));\n                }\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Gets the previous image displayed.\n    /// &lt;/summary&gt;\n    public BitmapImage PreviousPicture { get; private set; }\n\n    /// &lt;summary&gt;\n    /// Gets the current image to be displayed.\n    /// &lt;/summary&gt;\n    public BitmapImage Picture { get; private set; }\n\n    /// &lt;summary&gt;\n    /// Gets the next image displayed.\n    /// &lt;/summary&gt;\n    public BitmapImage NextPicture { get; private set; }\n\n    /// &lt;summary&gt;\n    /// Get list of files to display as pictures.\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;Paths to pictures.&lt;/returns&gt;\n    private static string[] CreatePicturePaths()\n    {\n        var list = new List&lt;string&gt;();\n        var commonPicturesPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\n        var newPath = commonPicturesPath + \"\\\\Images\";\n        list.AddRange(Directory.GetFiles(newPath, \"*.jpg\", SearchOption.AllDirectories));\n        if (list.Count == 0)\n        {\n            list.AddRange(Directory.GetFiles(commonPicturesPath, \"*.png\", SearchOption.AllDirectories));\n        }\n\n        if (list.Count == 0)\n        {\n            var myPicturesPath = Environment.GetFolderPath(Environment.SpecialFolder.MyPictures);\n            list.AddRange(Directory.GetFiles(myPicturesPath, \"*.jpg\", SearchOption.AllDirectories));\n            if (list.Count == 0)\n            {\n                list.AddRange(Directory.GetFiles(commonPicturesPath, \"*.png\", SearchOption.AllDirectories));\n            }\n        }\n        return list.ToArray();\n    }\n\n    /// &lt;summary&gt;\n    /// Load the picture with the given index.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"index\"&gt;The index to use.&lt;/param&gt;\n    /// &lt;returns&gt;Corresponding image.&lt;/returns&gt;\n    private BitmapImage LoadPicture(int index)\n    {\n        BitmapImage value;\n\n        if (this.picturePaths.Length != 0)\n        {\n            var actualIndex = index % this.picturePaths.Length;\n            if (actualIndex &lt; 0)\n            {\n                actualIndex += this.picturePaths.Length;\n            }\n\n            Debug.Assert(0 &lt;= actualIndex, \"Index used will be non-negative\");\n            Debug.Assert(actualIndex &lt; this.picturePaths.Length, \"Index is within bounds of path array\");\n\n            try\n            {\n                value = new BitmapImage(new Uri(this.picturePaths[actualIndex]));\n\n            }\n            catch (NotSupportedException)\n            {\n                value = null;\n            }\n        }\n        else\n        {\n            value = null;\n        }\n\n        return value;\n    }\n\n    /// &lt;summary&gt;\n    /// Create a wired-up recognizer for running the slideshow.\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;The wired-up recognizer.&lt;/returns&gt;\n    private Recognizer CreateRecognizer()\n    {\n        // Instantiate a recognizer.\n        var recognizer = new Recognizer();\n\n        // Wire-up swipe right to manually advance picture.\n        recognizer.SwipeRightDetected += (s, e) =&gt;\n        {\n            if (e.Skeleton.TrackingId == nearestId)\n            {\n                Index++;\n                Debug.WriteLine(\"Swiperight. Your gesture is recognised. Congratulations\");\n                // Setup corresponding picture if pictures are available.\n                this.PreviousPicture = this.Picture;\n                this.Picture = this.NextPicture;\n                this.NextPicture = LoadPicture(Index + 1);\n\n                // Notify world of change to Index and Picture.\n                if (this.PropertyChanged != null)\n                {\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"PreviousPicture\"));\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"Picture\"));\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"NextPicture\"));\n                }\n\n                var storyboard = Resources[\"LeftAnimate\"] as Storyboard;\n                if (storyboard != null)\n                {\n                    storyboard.Begin();\n                }\n\n                HighlightSkeleton(e.Skeleton);\n            }\n        };\n\n        // Wire-up swipe left to manually reverse picture.\n        recognizer.SwipeLeftDetected += (s, e) =&gt;\n        {\n            if (e.Skeleton.TrackingId == nearestId)\n            {\n                Index--;\n                Debug.WriteLine(\"Swipeleft. Your gesture is recognised. Congratulations\");\n                // Setup corresponding picture if pictures are available.\n                this.NextPicture = this.Picture;\n                this.Picture = this.PreviousPicture;\n                this.PreviousPicture = LoadPicture(Index - 1);\n\n                // Notify world of change to Index and Picture.\n                if (this.PropertyChanged != null)\n                {\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"PreviousPicture\"));\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"Picture\"));\n                    this.PropertyChanged(this, new PropertyChangedEventArgs(\"NextPicture\"));\n                }\n\n                var storyboard = Resources[\"RightAnimate\"] as Storyboard;\n                if (storyboard != null)\n                {\n                    storyboard.Begin();\n                }\n\n                HighlightSkeleton(e.Skeleton);\n            }\n        };\n\n        return recognizer;\n    }\n\n\n\n\n\n\n    /// &lt;summary&gt;\n    ///\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;Gesture event arguments.&lt;/param&gt;\n    private void OnGestureRecognized(object sender, GestureEventArgs e)\n    {\n        Debug.WriteLine(e.GestureType);\n\n        if (e.GestureType == GestureType.ZoomIn)\n        {\n            Debug.WriteLine(\" line has been Detected.\");\n           // window.Close();\n        }\n\n        /*switch (e.GestureType)\n        {\n            case GestureType.Menu:\n                Gesture = \"Menu\";\n                break;\n            case GestureType.WaveRight:\n                Gesture = \"Wave Right\";\n                break;\n            case GestureType.WaveLeft:\n                Gesture = \"Wave Left\";\n                break;\n            case GestureType.JoinedHands:\n                Gesture = \"Joined Hands\";\n                break;\n            case GestureType.SwipeLeft:\n                Gesture = \"Swipe Left\";\n                break;\n            case GestureType.SwipeRight:\n                Gesture = \"Swipe Right\";\n                break;\n            case GestureType.ZoomIn:\n                Gesture = \"Zoom In\";\n                break;\n            case GestureType.ZoomOut:\n                Gesture = \"Zoom Out\";\n                break;\n\n            default:\n                break;\n        }*/\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n\n    /// &lt;summary&gt;\n    /// Handle insertion of Kinect sensor.\n    /// &lt;/summary&gt;\n    private void InitializeNui()\n    {\n        this.UninitializeNui();\n\n        var index = 0;\n        while (this.nui == null &amp;&amp; index &lt; KinectSensor.KinectSensors.Count)\n        {\n            try\n            {\n                this.nui = KinectSensor.KinectSensors[index];\n\n                this.nui.Start();\n\n                this.IsDisconnected = false;\n\n                this.DisconnectedReason = null;\n            }\n            catch (IOException ex)\n            {\n                this.nui = null;\n\n                this.DisconnectedReason = ex.Message;\n            }\n            catch (InvalidOperationException ex)\n            {\n                this.nui = null;\n\n                this.DisconnectedReason = ex.Message;\n            }\n\n            index++;\n        }\n\n        if (this.nui != null)\n        {\n            this.nui.SkeletonStream.Enable();\n\n            this.nui.SkeletonFrameReady += this.OnSkeletonFrameReady;\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Handle removal of Kinect sensor.\n    /// &lt;/summary&gt;\n    private void UninitializeNui()\n    {\n        if (this.nui != null)\n        {\n            this.nui.SkeletonFrameReady -= this.OnSkeletonFrameReady;\n\n            this.nui.Stop();\n\n            this.nui = null;\n        }\n\n        this.IsDisconnected = true;\n\n        this.DisconnectedReason = null;\n    }\n\n    /// &lt;summary&gt;\n    /// Window loaded actions to initialize Kinect handling.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;The sender.&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;The event args.&lt;/param&gt;\n    private void OnMainWindowLoaded(object sender, RoutedEventArgs e)\n    {\n        // Start the Kinect system, this will cause StatusChanged events to be queued.\n        this.InitializeNui();\n\n        // Handle StatusChange events to pick the first sensor that connects.\n        KinectSensor.KinectSensors.StatusChanged += (s, ee) =&gt;\n        {\n            switch (ee.Status)\n            {\n                case KinectStatus.Connected:\n                    if (nui == null)\n                    {\n                        Debug.WriteLine(\"New Kinect connected\");\n\n                        InitializeNui();\n                    }\n                   else\n                    {\n                        Debug.WriteLine(\"Existing Kinect signalled connection\");\n                    }\n\n                    break;\n                default:\n                    if (ee.Sensor == nui)\n                    {\n                        Debug.WriteLine(\"Existing Kinect disconnected\");\n\n                        UninitializeNui();\n                    }\n                    else\n                    {\n                        Debug.WriteLine(\"Other Kinect event occurred\");\n                    }\n\n                    break;\n            }\n        };\n    }\n\n    /// &lt;summary&gt;\n    /// Handler for skeleton ready handler.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;The sender.&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;The event args.&lt;/param&gt;\n    private void OnSkeletonFrameReady(object sender, SkeletonFrameReadyEventArgs e)\n    {\n\n        using (SkeletonFrame frame = e.OpenSkeletonFrame())\n        {\n            if (frame == null)\n                return;\n\n            // resize the skeletons array if needed\n            if (skeletons.Length != frame.SkeletonArrayLength)\n                skeletons = new Skeleton[frame.SkeletonArrayLength];\n\n            // get the skeleton data\n            frame.CopySkeletonDataTo(skeletons);\n\n            foreach (var skeleton in skeletons)\n            {\n                // skip the skeleton if it is not being tracked\n                if (skeleton.TrackingState != SkeletonTrackingState.Tracked)\n                    continue;\n\n                // update the gesture controller\n                gestureController.UpdateAllGestures(skeleton);\n            }\n        }\n\n        // Get the frame.\n        using (var frame = e.OpenSkeletonFrame())\n        {\n            // Ensure we have a frame.\n            if (frame != null)\n            {\n                // Resize the skeletons array if a new size (normally only on first call).\n                if (this.skeletons.Length != frame.SkeletonArrayLength)\n                {\n                    this.skeletons = new Skeleton[frame.SkeletonArrayLength];\n                }\n\n                // Get the skeletons.\n                frame.CopySkeletonDataTo(this.skeletons);\n\n                // Assume no nearest skeleton and that the nearest skeleton is a long way away.\n                var newNearestId = -1;\n                var nearestDistance2 = double.MaxValue;\n\n                // Look through the skeletons.\n                foreach (var skeleton in this.skeletons)\n                {\n                    // Only consider tracked skeletons.\n                    if (skeleton.TrackingState == SkeletonTrackingState.Tracked)\n                    {\n                        // Find the distance squared.\n                        var distance2 = (skeleton.Position.X * skeleton.Position.X) +\n                            (skeleton.Position.Y * skeleton.Position.Y) +\n                            (skeleton.Position.Z * skeleton.Position.Z);\n\n                        // Is the new distance squared closer than the nearest so far?\n                        if (distance2 &lt; nearestDistance2)\n                        {\n                            // Use the new values.\n                            newNearestId = skeleton.TrackingId;\n                            nearestDistance2 = distance2;\n                        }\n                    }\n                }\n\n                if (this.nearestId != newNearestId)\n                {\n                    this.nearestId = newNearestId;\n                }\n\n                // Pass skeletons to recognizer.\n                this.activeRecognizer.Recognize(sender, frame, this.skeletons);\n\n                this.DrawStickMen(this.skeletons);\n            }\n        }\n    }\n\n}\n}\n</code></pre>\n\n<p>The XAML code is pasted here: </p>\n\n<pre><code>    &lt;Window x:Name=\"window\" x:Class=\"Microsoft.Samples.Kinect.Slideshow.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"V'Me v1.0\" Height=\"800\" Width=\"1280\" WindowState=\"Maximized\" Background= \"#FFD1D6D0\"&gt;\n&lt;Window.Resources&gt;\n    &lt;SolidColorBrush x:Key=\"MediumGreyBrush\" Color=\"#ff6e6e6e\"/&gt;\n    &lt;BooleanToVisibilityConverter x:Key=\"BooleanToVisibilityConverter\"/&gt;\n    &lt;Storyboard x:Key=\"LeftAnimate\"&gt;\n        &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"previous\"&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"1\"/&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"1\"/&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"0\"/&gt;\n        &lt;/DoubleAnimationUsingKeyFrames&gt;\n        &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"next\"&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"0\"/&gt;\n        &lt;/DoubleAnimationUsingKeyFrames&gt;\n        &lt;ThicknessAnimationUsingKeyFrames Storyboard.TargetProperty=\"(FrameworkElement.Margin)\" Storyboard.TargetName=\"current\"&gt;\n            &lt;EasingThicknessKeyFrame KeyTime=\"0\" Value=\"2000,0,-2000,0\"/&gt;\n            &lt;EasingThicknessKeyFrame KeyTime=\"0:0:0.5\" Value=\"0\"/&gt;\n        &lt;/ThicknessAnimationUsingKeyFrames&gt;\n    &lt;/Storyboard&gt;\n    &lt;Storyboard x:Key=\"RightAnimate\"&gt;\n        &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"previous\"&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"0\"/&gt;\n        &lt;/DoubleAnimationUsingKeyFrames&gt;\n        &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"next\"&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"1\"/&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"1\"/&gt;\n            &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"0\"/&gt;\n        &lt;/DoubleAnimationUsingKeyFrames&gt;\n        &lt;ThicknessAnimationUsingKeyFrames Storyboard.TargetProperty=\"(FrameworkElement.Margin)\" Storyboard.TargetName=\"current\"&gt;\n            &lt;EasingThicknessKeyFrame KeyTime=\"0\" Value=\"-2000,0,2000,0\"/&gt;\n            &lt;EasingThicknessKeyFrame KeyTime=\"0:0:0.5\" Value=\"0\"/&gt;\n        &lt;/ThicknessAnimationUsingKeyFrames&gt;\n    &lt;/Storyboard&gt;\n    &lt;Style TargetType=\"{x:Type Image}\"&gt;\n        &lt;Setter Property=\"SnapsToDevicePixels\" Value=\"True\"/&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid DataContext=\"{Binding ElementName=window}\" Margin=\"10 0 10 0\" Height=\"732\" Width=\"1249\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;RowDefinition Height=\"20\"/&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Canvas x:Name=\"StickMen\" Width=\"200\" Height=\"150\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Bottom\"/&gt;\n    &lt;DockPanel Margin=\"0,0,0,15\" Height=\"50\"&gt;&lt;/DockPanel&gt;\n    &lt;Grid Margin=\"0,118,0,61\" Name=\"imgBorder\" Grid.RowSpan=\"4\" ClipToBounds=\"True\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"432*\" /&gt;\n            &lt;ColumnDefinition Width=\"806*\" /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Image x:Name=\"next\" Source=\"{Binding NextPicture}\" StretchDirection=\"Both\" Stretch=\"Uniform\" ClipToBounds=\"True\"\n            SnapsToDevicePixels=\"True\" RenderOptions.BitmapScalingMode=\"HighQuality\" RenderTransformOrigin=\"0.5,0.5\" Opacity=\"0\" Grid.ColumnSpan=\"2\" /&gt;\n        &lt;Image x:Name=\"previous\" Source=\"{Binding PreviousPicture}\" StretchDirection=\"Both\" Stretch=\"Uniform\" ClipToBounds=\"True\"\n            SnapsToDevicePixels=\"True\" RenderOptions.BitmapScalingMode=\"HighQuality\" RenderTransformOrigin=\"0.5,0.5\" Opacity=\"0\" Grid.ColumnSpan=\"2\" /&gt;\n        &lt;Image x:Name=\"current\" Source=\"{Binding Picture}\" StretchDirection=\"Both\" Stretch=\"Uniform\" ClipToBounds=\"True\"\n            SnapsToDevicePixels=\"True\" RenderOptions.BitmapScalingMode=\"HighQuality\" RenderTransformOrigin=\"0.5,0.5\" Grid.ColumnSpan=\"2\" /&gt;\n\n    &lt;/Grid&gt;\n    &lt;StatusBar Grid.Row=\"3\" HorizontalAlignment=\"Stretch\" Name=\"statusBar2\" VerticalAlignment=\"Bottom\" Background=\"White\" Foreground=\"{StaticResource MediumGreyBrush}\" FontWeight=\"UltraBold\"&gt;\n        &lt;StatusBarItem Padding=\"0 0 0 30\" Background=\"#FFD1D6D0\"&gt;&lt;/StatusBarItem&gt;\n    &lt;/StatusBar&gt;\n    &lt;StatusBar Grid.Row=\"3\" HorizontalAlignment=\"Stretch\" Name=\"statusBar\" VerticalAlignment=\"Bottom\" Background=\"White\" Foreground=\"Blue\" FontSize=\"14\"&gt;\n        &lt;StatusBarItem Padding=\"0 0 0 30\" Background=\"#FFD1D6D0\"&gt;&lt;/StatusBarItem&gt;\n    &lt;/StatusBar&gt;\n    &lt;StatusBar Grid.Row=\"3\" Name=\"statusBar1\" VerticalAlignment=\"Bottom\" Background=\"White\" Foreground=\"{StaticResource MediumGreyBrush}\" FontWeight=\"UltraBold\"&gt;\n        &lt;StatusBarItem Padding=\"0 0 0 20\" Background=\"#FFD1D6D0\"&gt;&lt;/StatusBarItem&gt;\n    &lt;/StatusBar&gt;\n    &lt;TextBlock Name=\"statusBarText1\" HorizontalAlignment=\"Center\" Text=\"© Gade Autonomous Systems Pvt. Ltd.\" Foreground=\"Black\" FontWeight=\"Normal\" TextAlignment=\"Center\" FontStretch=\"UltraExpanded\" Margin=\"498,74,437,-11\" Grid.Row=\"3\" Height=\"30\" Width=\"303\" FontSize=\"14\" /&gt;\n    &lt;TextBlock Name=\"statusBarText\" HorizontalAlignment=\"Center\" Text=\"Swipe your right arm to the left to move to next slide, swipe your left arm to the right for previous.\" Height=\"23\" Width=\"707\" VerticalAlignment=\"Center\" FontSize=\"16\" FontWeight=\"Normal\" Grid.Row=\"3\" Foreground=\"Blue\" Margin=\"271,52,271,18\" /&gt;\n    &lt;TextBlock Margin=\"560,49,564,64\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Foreground=\"#FF000001\" FontFamily=\"Cambria\" FontSize=\"30\" Text=\"V'Me v1.0\" FontWeight=\"Light\" Height=\"37\" /&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#","wpf","kinect","gesture-recognition"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2198,"score":2,"question_id":9773999,"title":"Kinect for Windows gesture recognition","body":"<p>I have been looking at the <a href=\"http://www.microsoft.com/en-us/kinectforwindows/develop/overview.aspx\" rel=\"nofollow\">Kinect for Windows</a> release notes and features, since I want to incorporate gesture recognition in my project as well.</p>\n\n<p>At the above page, the first line mentions that \"The Kinect for Windows SDK enables developers to create applications that support gesture and voice recognition, \". Voice recognition API is available with the SDK and readily can be used. However, I don't think there are any gesture recognition APIs available in the SDK. The APIs of Skeleton Tracking are there to be used readily but then they have to be tailored with to get gesture recognition.</p>\n\n<p>I have seen videos of Windows Media Center beng controlled by gestures etc. and other applications too. I wonder if all these applications are custom built and have to write their own gesture recognition code.</p>\n\n<p>Currently, in my project I am using <a href=\"http://kinectdtw.codeplex.com/\" rel=\"nofollow\">Kinect DTW Gesture Recognition</a> from Codeplex. I am having two issues with this -> 1) Looks very performance hogging, and on enabling this with my app, my app throws OutofMemory exception after some time (PC specs are pretty high). 2) Can't say much about the robustness of the system. Works at times for some people and not for others.</p>\n\n<p>I thought if the APIs would have been inbuilt, it would have been good to switch to these. Are these available or else what's the resolution?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13133070,"title":"print preview and print in wpf","body":"<p>I have a WPF Form ,I need to print it ,i use DocumentViewer to print. but when I want to Print it or Preview , I only See the first page while i have more than one page </p>\n\n<pre><code>private void Print(object sender, RoutedEventArgs e)\n{\nPrintSettings printSettings = PrintSettings.Default;\nUIElement container = this.Content as UIElement;\nScrollViewer containerPanel = Helper.FindVisualChildren&lt;ScrollViewer&gt;(container).FirstOrDefault();\nvar origParentDirection = containerPanel.FlowDirection;\nvar origDirection = (containerPanel.Content as FrameworkElement).FlowDirection;\nif (containerPanel != null &amp;&amp; containerPanel.FlowDirection == FlowDirection.RightToLeft)\n{\ncontainerPanel.FlowDirection = FlowDirection.LeftToRight;\n(containerPanel.Content as FrameworkElement).FlowDirection = FlowDirection.RightToLeft;\n}\nvar window = new Window();\nstring tempFileName = System.IO.Path.GetTempFileName();\nSystem.IO.File.Delete(tempFileName);\nusing (XpsDocument xpsDocument = new XpsDocument(tempFileName, FileAccess.ReadWrite, System.IO.Packaging.CompressionOption.Fast))\n{\nXpsDocumentWriter writer = XpsDocument.CreateXpsDocumentWriter(xpsDocument);\n(containerPanel.Content as FrameworkElement).Margin = new Thickness(20);\nwriter.Write((containerPanel.Content as FrameworkElement), printSettings.PrintTicket);\nvar doc = xpsDocument.GetFixedDocumentSequence();\ndoc.PrintTicket = printSettings.PrintTicket;       \nwindow.FlowDirection = System.Windows.FlowDirection.RightToLeft;\nwindow.Content = new DocumentViewer { Document = doc };\nwindow.Margin = new Thickness(10);\nwindow.ShowDialog();\n}\n(containerPanel.Content as FrameworkElement).FlowDirection = origDirection;\ncontainerPanel.FlowDirection = origParentDirection;\n}\n</code></pre>\n"},{"tags":["wpf","wpf-controls","itemscontrol"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13236267,"title":"Using both ItemsPresenter and ContentPresenter in a template","body":"<p>I'm trying to expand my wizard customcontrols template. The control is derived from a selector control and the template has a contentpresenter with content bound to the controls selecteditem property. Hitting the previous/next buttons moves the selectedindex up and down thereby changing the content displayed (I borrowed the core idea from another SO response but I've lost the original so forgive me if I dont cite it) The wizard has a header property which displays as another contentcontrol. Each page is essentially a contentcontrol, there's a little more dressing on each one that I've removed from clarity but nothing of any significance.</p>\n\n<p>I want to add a list of page names to the main template, so the user can see their progress. So I added an itemspresenter or an itemscontrol to the template, but now I get the error \"Must disconnect specified child from current parent Visual before attaching to new parent Visual\", which means nothing to me.</p>\n\n<p>Here's the meat of the xaml;</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type local:Wizard}\"&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type local:Wizard}\"&gt;\n                &lt;Grid&gt;\n                    &lt;Grid.RowDefinitions&gt;\n                        &lt;RowDefinition Height=\"Auto\"/&gt;\n                        &lt;RowDefinition Height=\"*\"/&gt;\n                        &lt;RowDefinition Height=\"Auto\"/&gt;\n                    &lt;/Grid.RowDefinitions&gt;\n                    &lt;Grid.ColumnDefinitions&gt;\n                        &lt;ColumnDefinition Width=\"Auto\"/&gt;\n                        &lt;ColumnDefinition Width=\"*\"/&gt;\n                    &lt;/Grid.ColumnDefinitions&gt;\n\n                    &lt;Border Grid.Row=\"0\" Grid.Column=\"0\" Grid.ColumnSpan=\"2\"&gt;\n                        &lt;ContentControl Content=\"{Binding RelativeSource={x:Static RelativeSource.TemplatedParent}, Path=Header}\" /&gt;\n                    &lt;/Border&gt;\n\n                    &lt;ItemsPresenter Grid.Row=\"1\" Grid.Column=\"0\" /&gt;\n                    &lt;ContentPresenter Grid.Row=\"1\" Grid.Column=\"1\" Content=\"{Binding RelativeSource={x:Static RelativeSource.TemplatedParent}, Path=SelectedItem}\"/&gt;\n\n                    &lt;Grid Grid.Column=\"0\" Grid.ColumnSpan=\"2\"&gt;\n                        ...Buttons go here...\n                    &lt;/Grid&gt;\n                &lt;/Grid&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n\n&lt;Style TargetType=\"{x:Type local:WizardPage}\"&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type local:WizardPage}\"&gt;\n                &lt;ContentPresenter Content=\"{Binding RelativeSource={x:Static RelativeSource.TemplatedParent}, Path=Content}\" /&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>It works fine if I remove the itemspresenter, Can anyone tell what I've overlooked?</p>\n"},{"tags":["wpf","printing","charts","resize","copy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13181066,"title":"Copy/Clone and Print Chart. Problems with ActualWidth & ActualHeight","body":"<p>I am trying to print a chart generated during a report. I am able to put the chart on a DocumentPaginator document, but I am having trouble resizing the chart to fit the page. I noticed that if I changed the size of the reporting program which would change the Charts size would affect the scaling of the Chart. This realization showed me that the Chart's ActualWidth and ActualHeight were directly linked to the scaling.</p>\n\n<p>I tried:</p>\n\n<pre><code>myChart.Width = newWidth;\nmyChart.Height = newHeight;\n\nMeasure(myChart.RenderSize);\nArrange(new Rect(0, 0, newWidth, newHeight));\n</code></pre>\n\n<p>But this caused my visual Chart in the reporting program to resize and the printable chart wouldn't resize to the new size until the second print.</p>\n\n<p>Realizing that myChart was connected to reportChart I tried to copy/clone reportChart to myChart. </p>\n\n<p>I tried:</p>\n\n<pre><code>public class Copy&lt;T&gt;\n{\n    public static T DeepCopy&lt;T&gt;(T element)\n    {\n        string xaml = XamlWriter.Save(element);\n        StringReader xamlString = new StringReader(xaml);\n        XmlTextReader xmlTextReader = new XmlTextReader(xamlString);\n        var DeepCopyobject = (T)XamlReader.Load(xmlTextReader);\n        return DeepCopyobject;\n    }\n\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>myChart = XamlReader.Parse(XamlWriter.Save(reportChart.DataContext)) as Chart\n</code></pre>\n\n<p>but <code>string xaml = XamlWriter.Save(element);</code> would take too long and both would cause a stackoverflow.</p>\n\n<p>I am using</p>\n\n<pre><code>myChart = new Chart() { DataContext = reportChart.DataContext }\n</code></pre>\n\n<p>to make my copy, but ActualWidth and ActualHeight come across '0' so I can't tell if the Chart's DataContext copied correctly.</p>\n\n<p>I did get my Chart to resize using</p>\n\n<pre><code>myChart.Width = newWidth;\nmyChart.Height = newHeight;\n\nmyChart.Measure(new System.Windows.Size(newWidth, newHeight));\nmyChart.Arrange(new Rect(0, 0, newWidth, newHeight));\n</code></pre>\n\n<p>or to say my Chart's ActualWidth and ActualHeight to update to the size I want, but I am getting a black image on my document where the chart should be.</p>\n\n<p>So how do I print a chart with it properly scaled to a selected paper size?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13234771,"title":"ContentPresenter issue","body":"<p>I have a ContentControl on which I have a grid. Column 1 will be a TreeView, Column 2 is a splitter and I have set column 3 to be a ContentPresenter. Defined as such:</p>\n\n<pre><code>&lt;ContentPresenter Grid.Column=\"2\" Name=\"PlaceHolder\" /&gt;\n</code></pre>\n\n<p>If I then add my ContentControl to a Page and add an item to the ContentControl it does not just appear in column 2 but instead spans the entire width of the ContentControl. This is how I add something to the ContentPresenter:</p>\n\n<pre><code>&lt;MyNamespace:MyControlName&gt;\n    &lt;Button&gt;Hello world!&lt;/Button&gt;\n&lt;/MyNamespace:MyControlName&gt;\n</code></pre>\n\n<p>How can I get the button to only appear in column 2 and have the TreeView in column 0 appear as normal?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["wpf","vb.net","filtering","collections"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2686,"score":1,"question_id":744338,"title":"Filter a wpf collectionviewsource in VB?","body":"<p>I want to filter a collectionviewsource using a filter  I've written, but I'm not sure how I can apply the filter to it?</p>\n\n<p>Here is my collection view source:</p>\n\n<pre><code>    &lt;Grid.Resources&gt;\n        &lt;CollectionViewSource x:Key=\"myCollectionView\" \n           Source=\"{Binding Path=Query4, Source={x:Static Application.Current}}\"&gt;\n            &lt;CollectionViewSource.SortDescriptions&gt;\n                &lt;scm:SortDescription PropertyName=\"ContactID\" \n                                     Direction=\"Descending\"/&gt;\n            &lt;/CollectionViewSource.SortDescriptions&gt;\n        &lt;/CollectionViewSource&gt;\n    &lt;/Grid.Resources&gt;\n</code></pre>\n\n<p>I have implemented a filter as such:</p>\n\n<pre><code>    Private Sub WorkerFilter(ByVal sender As Object, ByVal e As FilterEventArgs)\n\n    Dim value As Object = CType(e.Item, System.Data.DataRow)(\"StaffSection\")\n\n    If (Not value Is Nothing) And (Not value Is DBNull.Value) Then\n        If (value = \"Builder\") Or (value = \"Office Staff\") Then\n            e.Accepted = True\n\n        Else\n\n            e.Accepted = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>So how can I get the CollectionViewSource filtered by the filter on load? Could you please give all hte code I need (only a few lines I figure) as I'm quite new to coding.</p>\n\n<p>Thanks guys</p>\n\n<p>EDIT: For the record,</p>\n\n<pre><code>  &lt;CollectionViewSource x:Key=\"myCollectionView\" Filter=\"WorkerFilter\" ... /&gt;\n</code></pre>\n\n<p>gives me the error: </p>\n\n<blockquote>\n  <p>Failed object initialization\n  (ISupportInitialize.EndInit).\n  'System.Windows.Data.BindingListCollectionView'\n  view does not support filtering. \n  Error at object 'myCollectionView'</p>\n</blockquote>\n"},{"tags":["wpf","dependency-properties"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13194243,"title":"DependencyProperty not firing","body":"<p>I have the following XAML that uses a classes CurrencyImg property to look up a static resource at runtime, as there are a lot of these in a treeview, I don't want to have to load the same image 1000 times, I keep it in a resourcedictionary so it is only loaded once.</p>\n\n<pre><code>&lt;Image Name=\"imgCurrency\"  Grid.Column=\"5\" Margin=\"0,0,0,0\"  Source=\"{w:ImageStaticResource {Binding CurrencyImg}}\" Height=\"22\" VerticalAlignment=\"Top\"/&gt;\n</code></pre>\n\n<p>With a sample resource dictionary entry as</p>\n\n<pre><code>&lt;ImageSource x:Key=\"..\\Resources\\Images\\USD.ico\"&gt;../Resources/Images/USD.ico&lt;/ImageSource&gt;\n</code></pre>\n\n<p>The property is as follows</p>\n\n<pre><code>public string CurrencyImg\n{\n    get\n    {\n        if (DisplayUSDRate)\n        {\n            return AppString.General.ImagePath + AppString.CurrencyId.USD + \".ico\";\n        }\n        else\n        {\n            return AppString.General.ImagePath + curr + \".ico\";\n        }\n    }\n}\n</code></pre>\n\n<p>And the property action which does the work</p>\n\n<pre><code>public override bool DisplayUSDRate\n{\n    get { return _customer.DisplayUSDRate; }\n    set\n    {\n        _customer.DisplayUSDRate = value;\n        OnPropertyChanged(\"CurrencyImg\");\n    }\n}\n</code></pre>\n\n<p>Now when this runs, the OnPropertyChanged(\"CurrencyImg\") does nothing, and it's clear why. In the XAML I'm not directly binding to the CurrencyImg property, I'm using it as a parameter to my StaticResourceExtension class, so when I call OnPropertyChanged, it thinks there are no bound properties to update, so the XAML image does not update. I can understand this, but obviously this does not help me as what I need to happen is the following.</p>\n\n<p>1) For the class to determine which currency image gets displayed for that row\n2) For the images to come from a resource dictionary so they don't get loaded more than once or performance hugely suffers\n3) For changes to the DisplayUSDRate property to then reflect by updating the flag to the appropriate image. This is the bit I can't figure out how to do with my StaticResourceExtension (code below)</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Data;\nusing System.Windows.Markup;\n\nnamespace Citi.Rbcs.UI.Windows\n{\n    public class ImageStaticResource : StaticResourceExtension\n    {\n        public Binding Binding { get; set; }\n        private static readonly DependencyProperty DummyProperty;\n\n        public ImageStaticResource()\n        {\n        }\n\n        public ImageStaticResource(Binding binding)\n        {\n            Binding = binding;\n        }\n\n        static ImageStaticResource()\n        {\n            DummyProperty = DependencyProperty.RegisterAttached(\n                \"Dummy\", \n                typeof (Object), \n                typeof (DependencyObject),\n                new UIPropertyMetadata(null));\n        }\n\n        public override object ProvideValue(IServiceProvider serviceProvider)\n        {\n            var target = (IProvideValueTarget)serviceProvider.GetService(typeof(IProvideValueTarget)); \n            var targetObject = (FrameworkElement)target.TargetObject; \n\n            Binding.Source = targetObject.DataContext; \n            var DummyDO = new DependencyObject(); \n            BindingOperations.SetBinding(DummyDO, DummyProperty, Binding); \n\n            ResourceKey = DummyDO.GetValue(DummyProperty);\n\n            var resourceDictionary = new ResourceDictionary\n                                         {\n                                             Source = new Uri(\"pack://application:,,,/Windows/Images.xaml\")\n                                         };\n\n            var key = (string) ResourceKey;            \n            if (!resourceDictionary.Contains(key)) ResourceKey = \"Default\";\n\n            return base.ProvideValue(serviceProvider);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","3d","xna","kinect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13235145,"title":"XNA and .NET Framework","body":"<p>I wanted to know if .NET and XNA frameworks can be used together in any program?</p>\n\n<p>If it is a yes, is there any way that I can show a 3D model, combined with a skeleton using XNA, in WPF? </p>\n"},{"tags":["wpf","opengl","graphics","opentk"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13228878,"title":"OpenTK, SharpGL and WPF","body":"<p>I am about to begin a new project. Some decisions are out of my control: Using WPF and OpenGL are some of them.</p>\n\n<p>However, I have narrowed down my OpenGL options to two: Either OpenTK or SharpGL. SharpGL has a WPF control, while OpenTK only has a Windows Forms control, which makes it that I have to embed it in a Windows Forms Host :-/\nWhile I don't mind the airspace restrictions, I do wish to have decent performance, since I am building a real time application. Not a game, but still, real time.</p>\n\n<p>How much of a performance hit would my program take for using OpenTK over a Windows Forms Host, vs using SharpGL with a \"pure\" WPF control?</p>\n"},{"tags":["c#","wpf","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13235288,"title":"Binding a string property to a TextBlock","body":"<p>i have a usercontrol that looks like this in code:</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Client\n{\n    public partial class Spectrum : UserControl\n    {\n        public string AntennaName { get; set; }\n\n        public Spectrum()\n        {\n            InitializeComponent();\n        }\n    }\n}\n</code></pre>\n\n<p>and the xaml ( not in whole but the important parts ):</p>\n\n<pre><code>&lt;UserControl x:Class=\"Client.Spectrum\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             xmlns:local=\"clr-namespace:Client\"\n             mc:Ignorable=\"d\" d:DesignHeight=\"150\" d:DesignWidth=\"350\" \n             Background=\"#253121\" BorderBrush=\"Black\" BorderThickness=\"1\"\n             DataContext=\"{Binding RelativeSource={RelativeSource Self}}\"&gt;\n    &lt;StackPanel\n        &lt;TextBlock Margin=\"10,3,0,0\" Foreground=\"White\" \n                   FontWeight=\"Bold\" FontStyle=\"Italic\" TextAlignment=\"Left\"\n                   Text=\"{Binding AntennaName}\"/&gt;\n    &lt;/StackPanel&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>as you can see im trying to bind the AntennaName property to the TextBlock.Text property but without much luck.\ncan you tell me what am i doing wrong?</p>\n"},{"tags":["c#","wpf","entity-framework"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13235190,"title":"Entity Framework Pre Generated View on custom queries","body":"<p>I have a following Data Structure EntityObject (Unit, Product, ...) 1 : 1 Translation 1:n Translation Items.</p>\n\n<p>To fill ComboBoxes and listViews i only need to query the Translations this way:</p>\n\n<pre><code>    public CollectionViewSource GetShowColumns()\n    {\n        CollectionViewSource result = new CollectionViewSource();\n        List&lt;UnitDTO&gt; units = new List&lt;UnitDTO&gt;();\n        var qry = from x in _context.Units\n                  select new\n                  {\n                      x.Name,\n                      x.Name.Translations,\n                      x.Id\n                  };\n\n        foreach (var temp in qry)\n        {\n            units.Add(new UnitDTO() { Id = temp.Id, Name = temp.Name });\n        }\n        result.Source = units;\n        return result;\n    }\n</code></pre>\n\n<p>My DTO Object contains an Id and Translation Property.</p>\n\n<p>I already used <a href=\"http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d\" rel=\"nofollow\">EF Power Tools</a> To Prgenerate views. But i still experience a huge differnece between warm and cold queries.</p>\n\n<p>What shall i do ? </p>\n"},{"tags":["c#","wpf","xaml","dynamic","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13208461,"title":"Failing to add different items in combobox on dynamic radiobutton click","body":"<p>I am working on radiobuttons and combobox in my wpf App. Although I am a C++ developer, I recently moved to C#. My app deals with dynamic generation of the above mentioned components. Basically I have created 4 dynamic radiobuttons in my app and on clicking each, i should should add different items to my combobox. Here is the code:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding Children}\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\" &gt;\n                        &lt;RadioButton Content=\"{Binding RadioBase}\"  Margin=\"0,10,0,0\"  IsChecked=\"{Binding BaseCheck}\" GroupName=\"SlotGroup\"  Height=\"15\" Width=\"80\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"/&gt;                            \n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n\n&lt;ComboBox Visibility=\"{Binding IsRegisterItemsVisible}\" ItemsSource=\"{Binding RegComboList}\" SelectedItem=\"{Binding SelectedRegComboList, Mode=TwoWay}\" SelectedIndex=\"0\" /&gt;\n</code></pre>\n\n<p>FPGARadioWidgetViewModel Class:</p>\n\n<pre><code>public ObservableCollection&lt;FPGAViewModel&gt; Children { get; set; }\n\n    public FPGARadioWidgetViewModel()\n    {\n        Children = new ObservableCollection&lt;FPGAViewModel&gt;();\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x0\", ID = 0 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x40\", ID = 1 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x80\", ID = 2 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0xc0\", ID = 3 });            \n    }\n</code></pre>\n\n<p>FPGAViewModel Class:</p>\n\n<pre><code>private bool sBaseCheck;\n    public bool BaseCheck\n    {\n        get { return this.sBaseCheck; }\n        set\n        {\n            this.sBaseCheck = value;                \n            AddComboItems();\n            this.OnPropertyChanged(\"BaseCheck\");\n        }\n    }    \n\nprivate ObservableCollection&lt;string&gt; _RegComboList;\n    public ObservableCollection&lt;string&gt; RegComboList\n    {\n        get { return _RegComboList; }\n        set\n        {\n            _RegComboList = value;\n            OnPropertyChanged(\"RegComboList\");\n        }\n    }        \n\nprivate void AddComboItems()\n    {\n        int baseRegister = 0x40 * ID;\n        ObservableCollection&lt;string&gt; combo = new ObservableCollection&lt;string&gt;();            \n\n        for (int i = 0; i &lt; 0x40; i++)\n        {\n            int reg = (i * 8) + baseRegister;\n            combo[i] = \"0x\" + reg.ToString(\"X\");\n        }\n\n        RegComboList = new ObservableCollection&lt;String&gt;(combo);\n        OnPropertyChanged(\"RegComboList\");\n    }\n\n\nprivate bool isRegisterItemsVisible = false;\n    public bool IsRegisterItemsVisible\n    {\n        get { return isRegisterItemsVisible; }\n        set\n        {\n            isRegisterItemsVisible = value;\n            OnPropertyChanged(\"IsRegisterItemsVisible\");                \n            OnPropertyChanged(\"RegComboList\");\n        }\n    }\n</code></pre>\n\n<p>If you notice, on clicking a particular radiobutton, it should add items with different value in combobox based on ID. It has to be made sure that on clicking any radiobutton only the items of that should be added and previous content of combobox should be cleared. I am trying to do the same thing using my above code but nothing seems to appear in combobox when i debug.</p>\n\n<p>Please help :)        </p>\n"},{"tags":[".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13234045,"title":"How to open xps document by clicking to link in another xps document","body":"<p>I'm writing a help system for some application. This help system works with xps document. My program shows xps document with <code>documentviewer</code>. Xps document should link to another xps. When user will press to link <code>documentviewer</code> should show another xps document. I tried to use Google but I didn't find anything. Have you any idea how I can do that?</p>\n"},{"tags":["c#","wpf"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13234411,"title":"WPF Combobox DataBind","body":"<p>I have two comboboxes. First combobox is for selecting the manager and the second is for selecting  Asst. MAnager. But, the source names are same in the both comboxes. Therefore, for example, if I select \" James\" from first combobox then I won't to select it from the second combobox. When I click on \"James\" in the second combobox, it should give me an error and must not select \"JAmes\". </p>\n\n<p>I wrote that code into the second combobox's selection_changed event: </p>\n\n<pre><code>if (Manager.SelectedItem == Asst_MAnager.SelectedItem)\n{\n    MessageBox.Show(\"You must change Asst_Manager\");\n} \n</code></pre>\n\n<p>That is right , if I select same item then it gives me the error message. But, still it selects the same item after error message. My WPF code is below. Could you give me any idea?</p>\n\n<pre><code>&lt;local:ComboBoxCW Grid.Row=\"1\" Grid.Column=\"1\" Grid.ColumnSpan=\"3\" x:Name=\"Manager\" Text=\"\" Background=\"#FFC8D2E8\"  Margin=\"0,0,0,3\"\n            SelectedID=\"{Binding Path=[Manager}\"  /&gt;\n&lt;local:ComboBoxCW Grid.Row=\"2\" Grid.Column=\"1\" Grid.ColumnSpan=\"3\" x:Name=\"Asst_Manager\" Text=\"\" Background=\"#FFC8D2E8\" CWListName=\"Assistant Manager\" Margin=\"0,0,0,3\"\n            SelectedID=\"{Binding Path=[Asst_Manager]}\" SelectionChanged=\"Asst_Manager_SelectionChanged\" /&gt;\n</code></pre>\n"},{"tags":["wpf","binding","listbox","listboxitem"],"answer_count":3,"favorite_count":6,"up_vote_count":15,"down_vote_count":0,"view_count":8659,"score":15,"question_id":821564,"title":"Double Click a ListBox item to open a browser","body":"<p>I have a <code>ListBox</code> in my wpf window that binds to an <code>ObervableCollection</code>.  I want to open the browser if someone clicks on an element of the <code>ListBox</code> (just like a link). Can someone tell me how to do this? I found something with listboxviews, does it only work this way or is there a way by just using the <code>ListBox</code>?</p>\n\n<p>Yours </p>\n\n<p>Sebastian</p>\n"},{"tags":["c#","wpf","statemachine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13232927,"title":"Creating a state machine designer using WPF and C#","body":"<p>I am going to attempt to write a state machine designer using WPF that will allow me to create something like <a href=\"http://www.lassalle.com/html5/demo/index.htm\" rel=\"nofollow\" title=\"this\">this</a>.</p>\n\n<p>Does anyone know how I can go about doing something like this in C#?  I want the user to be able to create individual states, name them and create transitions to other states (using curves to join the states together).</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13233381,"title":"C# adding labels","body":"<p>I have the following code in XAML, but i would like to create these labels programmatically. </p>\n\n<pre><code>&lt;Label Content=\"\" Name=\"Dice1\" HorizontalAlignment=\"Left\" Margin=\"19,11,0,0\" VerticalAlignment=\"Top\" Grid.Column=\"0\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice2\" HorizontalAlignment=\"Left\" Margin=\"19,11,0,0\" VerticalAlignment=\"Top\" Grid.Column=\"1\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice3\" HorizontalAlignment=\"Left\" Margin=\"19,11,0,0\" VerticalAlignment=\"Top\" Grid.Column=\"2\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice4\" HorizontalAlignment=\"Left\" Margin=\"19,11,0,0\" VerticalAlignment=\"Top\" Grid.Column=\"3\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice5\" HorizontalAlignment=\"Left\" Margin=\"19,10,0,0\" VerticalAlignment=\"Top\" Grid.Row=\"1\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice6\" HorizontalAlignment=\"Left\" Margin=\"19,10,0,0\" VerticalAlignment=\"Top\" Grid.Row=\"1\" Grid.Column=\"1\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice7\" HorizontalAlignment=\"Left\" Margin=\"19,10,0,0\" VerticalAlignment=\"Top\" Grid.Row=\"1\" Grid.Column=\"2\"/&gt;\n&lt;Label Content=\"\" Name=\"Dice8\" HorizontalAlignment=\"Left\" Margin=\"19,10,0,0\" VerticalAlignment=\"Top\" Grid.Row=\"1\" Grid.Column=\"3\"/&gt;\n</code></pre>\n\n<p>I think the best way to do this is in a for loop?? I want the first 4 dices on the same row and the column +1. The last 4 dices on the second row and the column +1. I'm using the names Dice1, Dice2, Dice3, ... because I want to give each label a random integer later on. Anyone has an idea?</p>\n\n<pre><code>for (int i = 0; i &lt; 8; i++)\n{\n    Label Dice = new Label();\n}\n</code></pre>\n"},{"tags":["wpf","mvvm","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13225904,"title":"Bound Value gets reset to the empty string","body":"<p>For my WPF application, I created several <code>UserControls</code> which each have their own <strong>ViewModel</strong>. The <em>ViewModels</em> are all based on a <code>PageViewModelBase</code> which contains a variable \"<strong>_context</strong>\". </p>\n\n<p>The <code>UserControls</code> are presented as pages in a Wizard Dialog, which has its own <strong>WizardViewModel</strong>. <em>WizardViewModel</em> has the variable <code>_masterContext</code> which is passed to the respective child ViewModels via their constructors. For example,</p>\n\n<pre><code>Child1ViewModel vm = new Child1ViewModel(_masterContext);\n</code></pre>\n\n<p>and the constructor of Child1ViewModel :</p>\n\n<pre><code>public Child1ViewModel(Context context) : base(context)\n</code></pre>\n\n<p>and the PageViewModelBase :</p>\n\n<pre><code>protected PageViewModelBase(Context context)\n{\n    _context = context;\n}\n</code></pre>\n\n<p>My intention is to have <strong>only 1 _masterContext</strong>, which can be accessed via each of the ChildViewModels. And each of the child views can bind to this and supply values to various fields in the master context.</p>\n\n<p>However I am encountering the problem that a field that I bind to <code>TextBox.Text</code> gets reset to \"\" whenever I switch from childView1 to childView2. I'm not sure is this due to my MMI code, or there are more than 1 instance of _masterContext in the application, i.e. my method above is not doing as it should. </p>\n\n<p><strong>What could be causing this?</strong></p>\n"},{"tags":["c#","wpf","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13201268,"title":"TreeView Binding with WPF","body":"<p>I'm attempting to create a TreeView with a specific structure. I know how to create a TreeView and Bind data with a HierarchicalDataTemplate however I am struggling with how to design my template correctly.</p>\n\n<p>The information I want to display to the user will look like this:\nClassA\n---ClassB\n---ClassB\n---ClassB\nClassA\n---ClassB\n---ClassB\nClassA\n---ClassB</p>\n\n<p>In other words - I'll have a collection of ClassA which I would see as being a:</p>\n\n<pre><code>public ObservableCollection&lt;ClassA&gt; ClassAItems\n</code></pre>\n\n<p>And I want ClassA to hold a collection of ClassB thus:</p>\n\n<pre><code>public ObserverableCollection&lt;ClassB&gt; ClassBItems\n</code></pre>\n\n<p>Any suggestions on how to get this set up?</p>\n"},{"tags":["c#","wpf","video","media"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13233484,"title":"Where to store videos in projects","body":"<p>I wonder if the videos (used in project) should be stored as resources. If it's a good way of managing such a sort of media, how to use <code>MediaElement</code> to play these videos?</p>\n"},{"tags":["wpf","multithreading","animation","freeze"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":13232917,"title":"WPF animation freezes even if I use new Thread","body":"<p>I am facing a big issue : In my WPF app, the MainWindow contains a Border with a Loading Animation (storyboard). By default it's collapsed. I sometimes make it visible and collapsed when I load a lot of data or when I'm loading a new XAML screen.</p>\n\n<p>First of all, I wasn't using Threading at all and the  animation where both freezing and appearing with lates.</p>\n\n<p>Then I began to use Threading like this :</p>\n\n<pre><code>Messenger.StartAnimation();\nvar task = Task.Factory.StartNew(() =&gt;\n                {\n                    Thread.Sleep(150);\n                }).ContinueWith((a) =&gt;\n                {\n                    // HERE Screen moving + large amount of data loaded with Entity Framework\n                    Thread.Sleep(200);\n\n                    Messenger.StopAnimation();\n                }, CancellationToken.None, TaskContinuationOptions.NotOnFaulted, threadUIContext);\n</code></pre>\n\n<p>This time, the animation worked during 1 second and then it just freezed until all data and new displayed screen where loaded. A It's like the main thread blocks ALL threads.</p>\n\n<p>I've tried to add Timer to Delay my <code>Messenger.StopAnimation()</code> to 3 seconds later. Even this will freeze my animation for 1 second when everything is being changed and loaded on my new screen and then my animation continues for 3 seconds.</p>\n\n<p>I've tried <code>Dispatcher</code>, <code>BackgroundWorker</code> and met same problem that with previous code.</p>\n\n<p>I've tried to put my animation on a popup and even on a new Window which was Transparent. Nothing to do, it always end up freezing for 1 second before stopping...</p>\n\n<p>For info, I use <code>ObservableCollection</code> (I've tried with List, same problem) and I load different screens inside a <code>ContentControl</code> in my <code>MainWindow</code>.</p>\n\n<p>I've watched the techdays video, Fast and Furious and I really wanted to get a smooth animation like on the video, but the freeze seems impossible to remove.</p>\n\n<p>I really need your help on this one. Thanks in advance !</p>\n"},{"tags":["c#","wpf","unit-testing","mvvm","icommand"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":620,"score":1,"question_id":6864233,"title":"WPF MVVM - Unit Testing a command - Private vs Public methods?","body":"<p>Basically, If I use MVVM and expose public ICommands, should my delegates be public or private?</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13232714,"title":"Intercept every mouse click to WPF application","body":"<p>I'm looking to intercept every mouse click in my WPF application. Seems this should be easy with the command routing mechanism, but sorry I'm not finding anything.</p>\n\n<p>My application implements several security levels, and has the requirement to automatically revert to the most restrictive level if no one interacts with (clicks) the application in x minutes. My plan is to add a timer that expires after x minutes and adjusts the security level. Each mouse click into the application will reset the timer.</p>\n"},{"tags":[".net","wpf",".net-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":13232258,"title":"WPF application initialization status","body":"<p>Is it possible to know what application is currently doing during loading (initialization)? Similar to what we get in the output window.</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13232916,"title":"How to use Entypo icons","body":"<p>I have installed <code>Entypo</code> package using <code>NuGet</code>. I got <code>Icons.xaml</code> file that contains <code>Canvas</code>'es. How to use it in the <code>XAML</code> code?</p>\n\n<p>File looks like:</p>\n\n<pre><code>    &lt;ResourceDictionary xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"&gt;\n        &lt;Canvas Width=\"48\" Height=\"48\" Clip=\"F1 M 0,0L 48,0L 48,48L 0,48L 0,0\" x:Key=\"appbar_add\"&gt;\n            &lt;Path Width=\"24\" Height=\"24\" Canvas.Left=\"12\" Canvas.Top=\"12\" Stretch=\"Fill\" Fill=\"{DynamicResource BlackBrush}\" Data=\"F1 M 22,12L 26,12L 26,22L 36,22L 36,26L 26,26L 26,36L 22,36L 22,26L 12,26L 12,22L 22,22L 22,12 Z \" /&gt;\n        &lt;/Canvas&gt;\n        &lt;Canvas Width=\"48\" Height=\"48\" Clip=\"F1 M 0,0L 48,0L 48,48L 0,48L 0,0\" x:Key=\"appbar_alert\"&gt;\n            &lt;Path Width=\"22.1402\" Height=\"20.75\" Canvas.Left=\"12.9299\" Canvas.Top=\"14\" Stretch=\"Fill\" Fill=\"{DynamicResource BlackBrush}\" Data=\"F1 M 24,14C 26,14 36,33 35,34C 34,35 14,35 13,34C 12,33 22,14 24,14 Z M 24,29C 23.1716,29 22.5,29.6716 22.5,30.5C 22.5,31.3284 23.1716,32 24,32C 24.8284,32 25.5,31.3284 25.5,30.5C 25.5,29.6716 24.8284,29 24,29 Z M 22.5,20L 23,28L 25,28L 25.5,20L 22.5,20 Z \" /&gt;\n        &lt;/Canvas&gt;\n        &lt;Canvas Width=\"48.0067\" Height=\"48.0067\" Clip=\"F1 M 0,0L 48.0067,0L 48.0067,48.0067L 0,48.0067L 0,0\" x:Key=\"appbar_alien\"&gt;\n            &lt;Path Width=\"22.005\" Height=\"16.0048\" Canvas.Left=\"12.9999\" Canvas.Top=\"16.9998\" Stretch=\"Fill\" Fill=\"{DynamicResource BlackBrush}\" Data=\"F1 M 16.9999,16.9998L 19.0002,16.9998L 19.0026,19.0027L 21.0002,18.9998L 21.0029,21.0029L 27.0038,21.0029L 26.9999,18.9998L 28.9999,18.9998L 28.9999,16.9998L 31.0002,16.9998L 31.0002,19.0001L 29.0002,19.0001L 29.0041,21.0029L 31.0043,21.0029L 31.0043,23.0032L 33.0046,23.0032L 33.0046,25.0035L 31.0043,25.0035L 31.0001,31.0001L 29.0001,31.0001L 29.0001,33.0001L 25.0035,33.0046L 25.0035,31.0043L 28.9999,30.9999L 29.004,28.0039L 19.0026,28.0039L 19.0026,31.0043L 17.0024,31.0043L 16.9999,25.0001L 15.0002,25.0001L 15.0002,29.0001L 12.9999,29.0001L 12.9999,24.9998L 14.9999,24.9998L 14.9999,22.9998L 16.9999,22.9998L 17.0024,21.0029L 19.0026,21.0029L 18.9999,19.0001L 16.9999,19.0001L 16.9999,16.9998 Z M 33.0046,25.0035L 35.0049,25.0035L 35.0049,29.0041L 33.0046,29.0041L 33.0046,25.0035 Z M 19.0026,31.0043L 23.0032,31.0043L 23.0032,33.0046L 19.0026,33.0046L 19.0026,31.0043 Z M 19.0026,23.0032L 19.0026,25.0035L 21.0029,25.0035L 21.0029,23.0032L 19.0026,23.0032 Z M 27.0038,23.0032L 27.0038,25.0035L 29.004,25.0035L 29.004,23.0032L 27.0038,23.0032 Z \" /&gt;\n   &lt;!-- etc --&gt;\n        &lt;/Canvas&gt;\n    &lt;/ResourceDictionary&gt;\n</code></pre>\n"},{"tags":["c#","wpf","xaml","window","startup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13230151,"title":"How to force WPF startup window to specific screen?","body":"<p>I have a WPF application that will show information on a projector through a dedicated window.\nI would like to configure what screen to be used for projector display and what to be used for  main application window.</p>\n\n<p>This code will generate projector output on specified screen:</p>\n\n<pre><code>var screen = GetProjectorScreen();\n_projectorWindow = new ProjectorWindow();\n_projectorWindow.Left = screen.WorkingArea.Left;\n_projectorWindow.Top = screen.WorkingArea.Top;\n_projectorWindow.Owner = _parentWindow;\n_projectorWindow.Show();\n\n\npublic static Screen GetProjectorScreen()\n{\n    var screens = Screen.AllScreens;\n    if (screens.Length &gt; 1 &amp;&amp; Settings.Default.DisplayScreen &lt; screens.Length)\n    {\n        return screens[Settings.Default.DisplayScreen];\n    }\n    return screens[0];\n}\n</code></pre>\n\n<p>I have tried to do the same trick with startup form, but so far without success.\nI tried to set Top and Left properties in MainWindow constructor but that did not work.</p>\n\n<p>The startup window is launched from App.xaml.cs by setting StartupUri:</p>\n\n<pre><code>StartupUri = new Uri(\"Windows/MainWindow.xaml\", UriKind.Relative);\n</code></pre>\n\n<p>Is there any other way to launch startup form?\nI tried to just call the constructor but that causes a crash because some resources are no longer loaded.</p>\n"},{"tags":["c#","wpf","validation","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13232103,"title":"Textbox isn't highlighting 'red' on validation error","body":"<p>I am binding a TextBox control to an entity called Address, which has a sub-property AddressLines. Internal validation logic has ValidationErrors for AddressLines property, but it doesn't reflect 'visually' on the control via a Red border.</p>\n\n<pre><code>    &lt;TextBox  Text=\"{Binding Path=Address.AddressLines, \n                             Mode=TwoWay,\n                             UpdateSourceTrigger=PropertyChanged, \n                             NotifyOnValidationError=True}\" \n\n              ToolTip=\"{Binding RelativeSource={RelativeSource Self}, \n                                Path=(Validation.Errors)[0].ErrorContent}\" /&gt;\n</code></pre>\n\n<p>If I am not wrong, it happens because the Entity <code>Address</code> itself isn't null and the property <code>AddressLines</code> is. If this is the case, how to notify the control for validation errors in case of Master-Detail errors ?</p>\n\n<p>I hope I am clear. Thank you in advance.</p>\n"},{"tags":["c#","wpf","multithreading","dispatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13230017,"title":"Using ObservableCollection on a new thread","body":"<p>A few days ago I created <a href=\"http://stackoverflow.com/questions/13192247/view-is-not-updated-when-on-a-separate-thread\">this thread</a> because I was unable to update an ObservableCollection from another thread.\nThis was the solution from the thread:</p>\n\n<pre><code>Dispatcher.CurrentDispatcher.BeginInvoke(new Action(delegate\n{\n    TheTVDB theTvdb = new TheTVDB();\n    foreach (TVSeries tvSeries in theTvdb.SearchSeries(\"Dexter\"))\n    {\n        this.Overview.Add(tvSeries);\n    }\n}),\nDispatcherPriority.Background);\n</code></pre>\n\n<p>However, it seems that this is not really the solution as the UI still freezes while doing executing the delegate. My guess is that the above does not really run anything on another thread but instead dispatches it all to the UI thread.\nSo what I really want to do is to create a new thread myself and do the loading (this happens in <code>theTvdb.SearchSeries()</code>). Then I will iterate over the results and add those to my <code>ObservableCollection</code> and this must happen on the UI thread.</p>\n\n<p>Does this approach sound right?</p>\n\n<p>I came up with the below which I thought would load the results and add those to the ObervableCollection and show them in my list view without the UI freezing.</p>\n\n<pre><code>Thread thread = new Thread(new ThreadStart(delegate\n{\n    TheTVDB theTvdb = new TheTVDB();\n    List&lt;TVSeries&gt; dexter = theTvdb.SearchSeries(\"Dexter\");\n\n    foreach (TVSeries tvSeries in dexter)\n    {\n        Dispatcher.CurrentDispatcher.BeginInvoke(new Action(delegate\n        {\n            this.Overview.Add(tvSeries);\n        }),\n        DispatcherPriority.Normal);\n    }\n}));\nthread.SetApartmentState(ApartmentState.STA);\nthread.Start();\n</code></pre>\n\n<p>The above does not produce any error. Instead nothing happens. The UI does not freeze but it is not updated. The objects in <code>Overview</code> is not presented in the UI and I have tested that the binding is correct. The objects will show correctly if I don't load them and add them to the <code>ObservableCollection</code> on another thread.</p>\n\n<p>Another solution I have tried is to use the <a href=\"http://stackoverflow.com/a/2104705/486845\">MTObservableCollection from this answer</a> to a similar question. When using that subclass of the <code>ObservableCollection</code>, I did not dispatch anything myself. This gave me the following error:</p>\n\n<blockquote>\n  <p>Must create DependencySource on same Thread as the DependencyObject.</p>\n</blockquote>\n\n<p>Can anybody please tell me how I can:</p>\n\n<ol>\n<li>Load something on a separate thread</li>\n<li>Use the results from step 1 to update an ObservableCollection which is bound to a listview</li>\n<li>Have the results shown in the UI without the UI freezing</li>\n</ol>\n\n<p>I hope you can help me further.</p>\n\n<p><strong>UPDATE</strong>:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:acb=\"clr-namespace:AttachedCommandBehavior\"\n    mc:Ignorable=\"d\"\n    x:Class=\"TVSeriesLibrary.OverviewView\"\n    x:Name=\"UserControl\"\n    d:DesignWidth=\"512\"\n    d:DesignHeight=\"480\"&gt;\n\n    &lt;UserControl.Resources&gt;\n        &lt;DataTemplate x:Key=\"CoverTemplate\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Width=\"82\" Height=\"85\" Stretch=\"Fill\" Source=\"{Binding Cover}\" Margin=\"10,10,0,10\"/&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/UserControl.Resources&gt;\n\n    &lt;Grid x:Name=\"LayoutRoot\" Background=\"#515050\"&gt;\n        &lt;Grid.Resources&gt;\n            &lt;ResourceDictionary&gt;\n                &lt;Style x:Key=\"ItemContStyle\" TargetType=\"{x:Type ListViewItem}\"&gt;\n                    &lt;Setter Property=\"Background\" Value=\"#282828\" /&gt;\n                    &lt;Setter Property=\"Margin\" Value=\"0,0,0,5\" /&gt;\n                    &lt;Setter Property=\"Padding\" Value=\"0\" /&gt;\n                &lt;/Style&gt;\n            &lt;/ResourceDictionary&gt;\n        &lt;/Grid.Resources&gt;\n\n        &lt;ListView Height=\"112\"\n                  Width=\"488\"\n                  Margin=\"12,150,12,218\"\n                  Foreground=\"#ffffff\"\n                  Background=\"#515050\"\n                  VerticalContentAlignment=\"Center\"\n                  BorderThickness=\"0\"\n                  ItemTemplate=\"{StaticResource CoverTemplate}\"\n                  ItemsSource=\"{Binding Overview}\"&gt;\n            &lt;ListView.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;WrapPanel Orientation=\"Horizontal\" /&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ListView.ItemsPanel&gt;\n        &lt;/ListView&gt;\n\n        &lt;ListView Height=\"170\"\n                  Margin=\"10,298,10,0\"\n                  VerticalAlignment=\"Center\"\n                  Foreground=\"#ffffff\"\n                  Background=\"#515050\"\n                  VerticalContentAlignment=\"Center\"\n                  BorderThickness=\"0\"\n                  Width=\"488\" ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"\n                  ItemsSource=\"{Binding Path=Overview}\"\n                  SelectedItem=\"{Binding Path=SelectedTVSeries}\"\n                  ItemContainerStyle=\"{StaticResource ItemContStyle}\"&gt;\n            &lt;ListView.Resources&gt;\n                &lt;ResourceDictionary&gt;\n                    &lt;Style x:Key=\"hiddenStyle\" TargetType=\"GridViewColumnHeader\"&gt;\n                        &lt;Setter Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n                    &lt;/Style&gt;\n                &lt;/ResourceDictionary&gt;\n            &lt;/ListView.Resources&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridViewColumn Header=\"Cover\" Width=\"auto\" HeaderContainerStyle=\"{StaticResource hiddenStyle}\"&gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;Image Source=\"{Binding Path=Cover}\" Height=\"50\" Margin=\"-6,0,0,0\" /&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n\n\n                    &lt;GridViewColumn Header=\"Title\" Width=\"200\" HeaderContainerStyle=\"{StaticResource hiddenStyle}\"&gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock Text=\"{Binding Path=Name}\" FontWeight=\"Bold\"&gt;&lt;/TextBlock&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n\n                    &lt;GridViewColumn Header=\"Year\" Width=\"100\" HeaderContainerStyle=\"{StaticResource hiddenStyle}\"&gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock Text=\"{Binding Path=DisplayYear}\"&gt;&lt;/TextBlock&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n\n                    &lt;GridViewColumn Header=\"Button\" Width=\"135\" HeaderContainerStyle=\"{StaticResource hiddenStyle}\"&gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;Button Content=\"Details\" Width=\"100\" Height=\"20\" /&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n"},{"tags":["c#","wpf","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13230866,"title":"Span a DataGridCell when the width of text is more than width of column","body":"<p>How can I use the right empty cell(s) in a DataGrid to show continue text if the content of the left cell is greater than its width?</p>\n\n<p>In case of the right cell has data, it is OK to use <code>TextTrimming=\"CharacterEllipsis\"</code></p>\n\n<pre>\n------------------------------\n|   Name   |    Last Name     |\n-------------------------------\n| Looooo...|  a last name     |\n-------------------------------\n\nBut if the right cell is empty, something like:\n\n-------------------------------\n|   Name   |    Last Name     |\n-------------------------------\n| Loooooooong Nameeeeee       |\n-------------------------------\n\n</pre>\n\n<p>Is there any property to make the text like that?</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","usercontrols","user","frames"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":8995206,"title":"Frames vs User controls in WPF","body":"<p>I'm writing a Windows application in WPF. I based my UI in a single menu and a tab control to display different documents or application forms. Since the menu as well as other things are fixed throughout the application, I need a way to display the contents of each <em>TabItem</em>. I have found two:</p>\n\n<ol>\n<li>write  a user control for each form, or</li>\n<li>using  a frame to display the content of each form.</li>\n</ol>\n\n<h3>The question</h3>\n\n<p>Is there any other single way for doing this. How do they compare in terms of clean code?  I mean, in .net forms I only need load the form from the menu.</p>\n\n<p>I know, I should go for any pattern like MVVM, but for this very first time I want to use  the default approach.</p>\n"},{"tags":["wpf","nancy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13231846,"title":"How do I embed nancy in a WPF application","body":"<p>I need to host an embedded HTTP server within a WPF application and I was thinking of using <a href=\"http://nancyfx.org/\" rel=\"nofollow\">Nancy</a>. However I'm having trouble getting started. My requirements are quite modest all I want to do is serve up some HTML and JavaScript and display it in a WebBrowser control.</p>\n\n<p>How would I configure Nancy to do this?</p>\n"},{"tags":[".net","wpf","performance",".net-3.5","measureoverride"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":684,"score":0,"question_id":6959012,"title":"WPF MeasureOverride called multiple times after multiple PropertyChanged notifications","body":"<p>In my application, I have a graph (Custom Wpf Panel) with Wpf controls as elements. The elements are custom controls derived from Wpf Control. DataTemplates associate the controls to their view models.\nThe view models collection, \"GraphElements\" is binded to the itemsControl as shown below.</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"PART_GraphItemsControl\" Grid.Column=\"1\"\n              VerticalAlignment=\"Stretch\" \n              HorizontalAlignment=\"Left\"\n              ItemsSource=\"{Binding Path=GraphElements}\"\n              VirtualizingStackPanel.IsVirtualizing=\"True\"\n              VirtualizingStackPanel.VirtualizationMode=\"Recycling\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;local:GraphDesignerPanel HorizontalAlignment=\"Stretch\"\n                                      VerticalAlignment=\"Top\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>The elements in the graph can vary from 2 to 500. Under certain mode of the application, the elements display their value. To display the value, the ViewModel for the element fires the <code>INotifyPropertyChanged.PropertyChanged(\"VariableValue\")</code></p>\n\n<p><strong>Issue:</strong>\nWhen i have 100+ elements in the graph, each elements view model fires INotifyPropertyChanged.PropertyChanged to have the elements value displayed. This calls MeasureOverride 100+ times leading to memory and peformance issues.</p>\n\n<p>How can I reduce the number of MeasureOverride calls?</p>\n\n<h2>XAML for Value display for the graph element:</h2>\n\n<pre><code> &lt;TextBlock  \n    Text=\"{Binding Path=VariableValue, StringFormat={}({0})}\" Width=\"60\"\n    FontSize=\"11\" Name=\"txtBlk\"&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>The TextBlock above is collapsed if VariableValue is null</p>\n\n<pre><code>&lt;DataTrigger Binding=\"{Binding Path=VariableValue}\" Value=\"{x:Null}\"&gt;\n    &lt;Setter TargetName=\"txtBlk\"  Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n&lt;/DataTrigger&gt;\n</code></pre>\n\n<p><strong>UPDATE:</strong> The issue is reproducible in the sample at the link given below. Download, build, debug. Once App is opened, set a breakpoint in Window.xaml.cs MeasureOverride. Come back to the App and hit the \"Click Me\" button. The breakpoint is hit 11 times !.</p>\n\n<p><a href=\"http://sivainfotech.co.uk/measureoverrideissue.zip\" rel=\"nofollow\">http://sivainfotech.co.uk/measureoverrideissue.zip</a></p>\n\n<p>Any ideas greatly appreciated.</p>\n"},{"tags":["wpf","xaml","listbox","scrollviewer"],"answer_count":4,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":18088,"score":14,"question_id":472796,"title":"How can I get a vertical scrollbar in my ListBox?","body":"<p>In the example below I have a ListBox with dozens of font names in it.</p>\n\n<p>I would have thought it would automatically have a vertical scrollbar on it so that you can select ANY font, not just the first ones in the list, but it doesn't.</p>\n\n<p>So I added a \"ScrollViewer\" and that puts a \"scrollbar area\" on the right but there is no scrollbar in the scrollbar area so that you can scroll (!).</p>\n\n<p>Why isn't a scrollbar automatic and how do I force it to have a scrollbar?</p>\n\n<pre><code>&lt;StackPanel Name=\"stack1\"&gt;\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"2*\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"*\"&gt;&lt;/RowDefinition&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;ScrollViewer&gt;\n            &lt;ListBox Grid.Row=\"0\" Name=\"lstFonts\" Margin=\"3\"  ItemsSource=\"{x:Static Fonts.SystemFontFamilies}\"/&gt;\n        &lt;/ScrollViewer&gt;\n    &lt;/Grid&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2625,"score":2,"question_id":5232734,"title":"how to make textbox who only allow integer value?","body":"<p>i want to make a textbox in my wpf application which will accept only integer values. if someone types characters between [a-z], the textbox will reject it. Thus it will not be displayed in the textbox</p>\n"},{"tags":["c#","wpf","data-structures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13231367,"title":"Datastructure to mimick Performance Monitor","body":"<p>I'm developing a custom monitoring service for our software which is spread out on several systems. We've decided to present the data like the Report view in the Performance Monitor.\n<img src=\"http://i.stack.imgur.com/t9EUe.png\" alt=\"enter image description here\"></p>\n\n<p>To store the data, we use a very simple database table which only keep the latest value:</p>\n\n<pre><code>|Server|Object|Instance|Query|Value|\n</code></pre>\n\n<p>So each value is uniquely identifiable through Server, Object, Instance and Query.\nAn example might be</p>\n\n<pre><code>|Server| Object     |Instance| Query     |Value|\n+------+------------+--------+-----------+-----+\n| Srv1 | Disk       |   C:/  | TotalSize |500GB|\n| Srv1 | Disk       |   C:/  | FreeSpace | 50GB|\n| Srv1 | Disk       |   C:/  | UsedSpace |450GB|\n| Srv1 | Disk       |   C:/  | VolumeLbl |  OS |\n| Srv1 | Disk       |   D:/  | TotalSize |900GB|\n| Srv1 | Disk       |   D:/  | FreeSpace |700GB|\n| Srv1 | Disk       |   D:/  | UsedSpace |200GB|\n| Srv1 | Disk       |   D:/  | VolumeLbl | Data|\n| Srv1 | Performance|   ---  | CpuUsage  | 12% |\n| Srv1 | Performance|   ---  | MemUsage  | 34% |\n| Srv1 | Performance|   ---  | Processes | 64  |\n</code></pre>\n\n<p>Now we want to transform this into this:</p>\n\n<pre><code>Srv1\n    Disk             \n                     C:/        D:/  \n        TotalSize    500GB      900GB\n        FreeSpace    50GB       700GB\n        UsedSpace    450GB      200gb\n        VolumeLbl    OS         Data            \n\n    Performance      \n        CpuUsage     12%\n        MemUsage     34%\n        Processes    64\n</code></pre>\n\n<p>I'm at a loss as to what kind of structure I should use to store this.\nIt's easy to see that the Objects (Disk and Performance) is a sub-object of Server, but should Query be a sub object of Instance, or Object? In a regular table, each row is an object, and the columns are sub-objects of that row. But I feel it should be the other way around in this case, as the Queries are sub-objects of the Instances. And should Values just be stored under the Query or Instance, or should it be some kind of two-dimensional array?\nSo basically, what's the cleanest, most efficiently and best practice way to implement this?</p>\n\n<p>We are using WPF, and being able to bind to the structure is pretty much a requirement. So implementing this using only ObservableCollections or custom structures with CollectionChanged is a second challenge.</p>\n"},{"tags":["wpf","dispatcher"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13231041,"title":"WPF Dispatcher Thread","body":"<p>I have a WPF application that at start up inits a named  pipe server on a separate thread.<br>\nAt some point in time, named pipe clients send info to this thread that in turn needs to update an Observable Collection in the ViewModel.<br>\nAttempting to do so directly results in an exception \"cannot access collection of this time on a non dispatcher thread\" ( I am paraphrasing the error a bit ).<br>\nAt any rate how do I get the handler of the named pipe thread onto the UI thread. I don't seem to have a dispatcher object lying around that I can use to invoke a method. Am I supposed to cache on at start up into a static or singleton or some such.<br>\nThe DispatcherSynchronizationContext looks interesting but not sure how to get one in my view and store in my View Model.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13230647,"title":"How to Bind Data in xaml using C# from sqlserver","body":"<p>How I Bind data in xaml ..I use following logic..</p>\n\n<pre><code>        SqlConnection conn = new SqlConnection(\"Data Source=mahendra;Initial Catalog=Win8App;User ID=sa;Password=*******\");\n        conn.Open();\n        SqlCommand cmd = new SqlCommand(\"select * from tbl_Registration\", conn);\n        SqlDataAdapter sda = new SqlDataAdapter(cmd);\n        DataSet ds = new DataSet();\n        DataTable dt = new DataTable();\n        sda.Fill(dt);\n        cmd.ExecuteNonQuery();      \n        dataGrid1.ItemsSource = dt.DefaultView;\n        conn.Close();\n</code></pre>\n\n<p>My basic need is to show data as same as gridview...</p>\n"},{"tags":["c#","wpf","data-recovery","appcrash"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13230830,"title":"File recovery when app crashes C#","body":"<p>I am creating a WPF/C# app that deletes files and creates new ones before closing (from online data). The problem comes when the app randomly crashes before the new file creation process is complete or even starts. </p>\n\n<p>Is there a way of file recovery (to be done within the app not just undelete apps etc) that I can use in my code so when the app crashes the file that was deleted cannot be lost? </p>\n\n<p>To be more accurate I delete the 4 files at the start of the app and create new ones at the end of the app. But if the app crashes in the middle the files are lost. </p>\n\n<p>How can I prevent this issue? </p>\n\n<p>I tried to reduce the probability of random crashing but once in a while it still happens. </p>\n"},{"tags":["c#","wpf","bootstrapping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13230854,"title":"Bootstrapping WPF","body":"<p>I'm looking for an good tutorial or article about bootstrapping in WPF.\nI am new to WPF an not familar with bootstrapping. </p>\n\n<p>Thanks\nMahus</p>\n"},{"tags":["wpf","mvvm","listbox","dataset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3551,"score":1,"question_id":2023093,"title":"Convert dataset to observable collection","body":"<p>I was trying to bind a dataset to a listbox..certainly because i want to display a couple of tables information in a datatemplate..But this seems not possible and i will have to convert it to an observable collection.But how can i do it.My bl returns dataset objects.How can i convert this to observablecollection..? Is there any way so that i can handle this situation in MVVM..? How do people handle datasets in MVVM architecture..?</p>\n"},{"tags":["c#","wpf","frames","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13230454,"title":"Browser Like Wpf application","body":"<p>I am making wpf Application, and i want to host pages (Not web pages) in tabs just like browsers, i want the tabs to be created Dynamically.\nin short i want behaviour same Like, any browser, except the content to display are my own wpf  pages, \nHow to use the Back and Forward Buttons, to take the current navigation service (Navigation in the Current Tab),  Please tell me a simple Solution, using frames inside each Tab item, if anyone can help with some example, so it would be very nice Thanks...</p>\n"},{"tags":["c#","wpf","c#-4.0",".net-4.0","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13230327,"title":"Using Microsoft.Office.Interop to read excel file data giving exception. WPF app","body":"<p>I have WPF application which reads excel file data and display it in on UI. I am using <code>Microsoft.Office.Interop</code> to read excel file data mainly <code>.xlsx</code>. On dev machine application is working fine but intalling and running this app on some computers it  giving me this error:</p>\n\n<blockquote>\n  <p>ExcelRetrieving the COM class factory for component with CLSID {00024500-0000-0000-C000-000000000046} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)\n  What could be possible solution for this?</p>\n</blockquote>\n"},{"tags":["c#","wpf","datagrid","scrolling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1830,"score":0,"question_id":9667475,"title":"wpf(C#) DataGrid ScrollIntoView - how to scroll to the first row that is not shown?","body":"<p>I am trying to scroll down a WPF datagrid with code behind.\nI use</p>\n\n<pre><code> int itemNum=0;\n    private void Down_Click(object sender, RoutedEventArgs e)\n    {\n        if (itemNum + 1 &gt; dataGridView.Items.Count - 1) return;\n        itemNum+=1;\n        dataGridView.UpdateLayout();\n        dataGridView.ScrollIntoView(dataGridView.Items[itemNum]);\n    }\n</code></pre>\n\n<p>This scrolls down only if the itemNum row is not currently shown.</p>\n\n<p>For example, If the DataGrid is long enough to hold 10 rows and I have 20 rows, I need to call this function 11 times (untill itemNum is 11) in order to scroll to the next row.</p>\n\n<p>It doesnt scroll down if the row is already fits in the grid (even if its the last on the screen).</p>\n\n<p>I want to achieve that when I call this method , the grid will bring the next line into the top of the grid (as the scroller does).\nWhy isnt it working?</p>\n"},{"tags":["wpf","window","hwnd"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":5398,"score":17,"question_id":1399037,"title":"Loading a WPF Window without showing it","body":"<p>I create a global hot key to show a window by PInvoking <code>RegisterHotKey()</code>. But to do this I need that window's <code>HWND</code>, which doesn't exist until the window is loaded, that means shown for the first time. But I don't want to show the window before I can set the hot key. Is there a way to create a <code>HWND</code> for that window that is invisible to the user?</p>\n"},{"tags":["wpf","data-binding","datatable"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1046,"score":4,"question_id":2940618,"title":"What is it about DataTable Column Names with dots that makes them unsuitable for WPF's DataGrid control?","body":"<p>Run this, and be confused:</p>\n\n<pre><code>&lt;Window x:Class=\"Data_Grids.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;StackPanel&gt;\n        &lt;DataGrid\n        Name=\"r1\"\n              ItemsSource=\"{Binding Path=.}\"&gt;\n        &lt;/DataGrid&gt;\n        &lt;DataGrid\n        Name=\"r2\"\n              ItemsSource=\"{Binding Path=.}\"&gt;\n        &lt;/DataGrid&gt;\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Codebehind:</p>\n\n<pre><code>using System.Data;\nusing System.Windows;\n\nnamespace Data_Grids\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            DataTable dt1, dt2;\n            dt1 = new DataTable();\n            dt2 = new DataTable();\n            dt1.Columns.Add(\"a-name\", typeof(string));\n            dt1.Columns.Add(\"b-name\", typeof(string));\n            dt1.Rows.Add(new object[] { 1, \"Hi\" });\n            dt1.Rows.Add(new object[] { 2, \"Hi\" });\n            dt1.Rows.Add(new object[] { 3, \"Hi\" });\n            dt1.Rows.Add(new object[] { 4, \"Hi\" });\n            dt1.Rows.Add(new object[] { 5, \"Hi\" });\n            dt1.Rows.Add(new object[] { 6, \"Hi\" });\n            dt1.Rows.Add(new object[] { 7, \"Hi\" });\n            dt2.Columns.Add(\"a.name\", typeof(string));\n            dt2.Columns.Add(\"b.name\", typeof(string));\n            dt2.Rows.Add(new object[] { 1, \"Hi\" });\n            dt2.Rows.Add(new object[] { 2, \"Hi\" });\n            dt2.Rows.Add(new object[] { 3, \"Hi\" });\n            dt2.Rows.Add(new object[] { 4, \"Hi\" });\n            dt2.Rows.Add(new object[] { 5, \"Hi\" });\n            dt2.Rows.Add(new object[] { 6, \"Hi\" });\n            dt2.Rows.Add(new object[] { 7, \"Hi\" });\n            r1.DataContext = dt1;\n            r2.DataContext = dt2;\n        }\n    }\n}\n</code></pre>\n\n<p>I'll tell you what happens.  The top datagrid is populated with column headers and data.  The bottom datagrid has <em>column headers</em> but all the rows are blank.</p>\n"},{"tags":["c#","wpf","mvvm","viewmodel","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13229905,"title":"Generic Viewmodel Pattern for Master / Detail","body":"<p>As I understand the Concept behind MVVM within the Viemodel the business Logic is included and/or Things like a Master/Detail relationship of Data exposed to the View </p>\n\n<p>So as I found there are a Lot of ORM Generators like that of telerik a.o for Model's and on the other side designers for xaml etc.<br>\nbut I could Not found solutions to Build my needed View Models Base if I know I had a simple Master or Master/Detail view and it is based on Classics from the Model I know.</p>\n\n<p>So is there a known Library Out there that makes it more faster to implement Master/Detail viewmodels maybe useing the generic feature of C#?</p>\n\n<p>Basic idea a generic class that I give the model classes I need as master or detail and \ncould use this generica as base class for my inherited special implementation.</p>\n"},{"tags":["wpf","silverlight","windows-phone-7"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3114,"score":4,"question_id":3904877,"title":"ListBox.ScrollIntoView() does not seem to work in WP7","body":"<p>Hey guys, I want to move the listbox scrollbar to the bottom whenever a new item is added to the itemssource, but ScrollIntoView() doesn't seem to do anything if I pass it either a reference to the newly added item, or the index of it. Has anyone gotten this to work, or have any other suggestions as to how I could scroll the listbox down to the bottom?</p>\n\n<p>Some code:</p>\n\n<pre><code>    void Actions_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)\n    {\n        //if a new item was added, set it to the selected item\n        if (e.NewItems != null)\n        {\n            MainListBox.SelectedIndex = e.NewStartingIndex;\n\n            //MainListBox.ScrollIntoView(MainListBox.Items.Last());     //todo: this doesnt seem to work\n        }\n    }\n</code></pre>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13229911,"title":"itemscontrol mouseDragElementbehavior for new items not working","body":"<p>I found this solution <a href=\"http://stackoverflow.com/questions/6358774/using-mousedragelementbehavior-with-an-itemscontrol-and-canvas\">Using MouseDragElementBehavior with an ItemsControl and Canvas</a> by Jörg Reichardt. But it doesn't work for me.</p>\n\n<p>This is my code:</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding CardCollection}\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;Canvas Background=\"White\" AllowDrop=\"True\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;ContentControl Content=\"{Binding}\"&gt;\n                &lt;i:Interaction.Behaviors&gt;\n                    &lt;is:MouseDragElementBehavior ConstrainToParentBounds=\"True\" /&gt;\n                &lt;/i:Interaction.Behaviors&gt;\n            &lt;/ContentControl&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>The items are shown on the canvas but cannot be dragged or dropped. I create new items for the cardCollection in the viewmodel and the cardCollection is updated to the model via mvvm propertynotifychanged.</p>\n"},{"tags":["c#","html","wpf","xml","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13229525,"title":"C# HTML entities from XML string in DataGridView","body":"<p>I'm working with a Web Service that returns an XML string. I need to display the contents of the XML string in a DataGridView to users.</p>\n\n<p>The XML string resembles something like this:</p>\n\n<pre><code> &lt;Field id=\"13598\" type=\"1\"&gt;&amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;This &amp;lt;/strong&amp;gt;is our &amp;lt;em&amp;gt;response&amp;lt;/em&amp;gt;&amp;lt;/p&amp;gt;&lt;/Field&gt;\n</code></pre>\n\n<p>So far, I've managed to format output that's something like this which is displayed in my DataGridView:</p>\n\n<p>e.g.</p>\n\n<pre><code>&lt;p&gt;&lt;strong&gt;This &lt;/strong&gt;is our &lt;em&gt;statement&lt;/em&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Using <em>System.Net.WebUtility.HtmlDecode</em></p>\n\n<p>Is there a way for me to display the formatted text in the DataGridView? </p>\n\n<p>e.g.</p>\n\n<p><strong>This</strong> is our <em>statement</em> </p>\n\n<p>I'm hoping to achieve useability as the intended users of the program might not be familiar with HTML. </p>\n\n<p>I would've just removed the entities, but I need to retain them as they will be required for writing to an XML string later on as well, due to any editing. </p>\n\n<p>e.g.</p>\n\n<pre><code>&lt;p&gt;&lt;strong&gt;This&lt;/strong&gt; is our updated &lt;em&gt;statement&lt;/em&gt;&lt;/p&gt;\n</code></pre>\n\n<p>I've been toying with the idea of using a new form with a TextBox to enable editing as some of these strings might be much longer than this, and could contain other forms of formatting such as bullet points and the like. I'm not too sure how to go about with this. I'm not entirely sure if what I'm hoping to achieve is possible. If not, are there alternative methods for me to achieve this? </p>\n"},{"tags":["wpf","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13229414,"title":"Event after all columns have been created in WPFDataGrid?","body":"<p>I want to do something after all the columns have been generated in <code>WPFDataGrid</code>.and i need the <code>DisplayIndex</code> there,so i've used the <code>EndInit</code> of <code>DataGrid</code>,but it seems the <code>DisplayIndex</code> value has not been set yet.</p>\n\n<pre><code>public class AdvancedDatagridControl:DataGrid\n{\n.\n.\n.\n  public override void EndInit()\n  {\n     foreach (var column in this.Columns)\n     {\n        var colIndex=column.DisplayIndex; //DisplayIndex is -1\n     }\n  }\n}\n</code></pre>\n\n<p>What Event Can i use?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13229547,"title":"Something wrong with the class file","body":"<p>I using C# and WPF to build my app. So heres the problem....i got my mainWindow.xaml file with its mainWindow.cs file. I also create another class file Setting.cs. I try to take the check box from the mainWindow.xaml to the setting.cs and process it and then send back to the mainWindow.cs. But when i open it, it couldn't be close and the process i add in the setting.cs doesn't work. Is it something to do with the \"public static void\" ?</p>\n\n<p>Here's my Setting.cs:</p>\n\n<pre><code>public class Setting\n{\n\npublic static void loadSetting()\n    {\n       MainWindow win = new MainWindow();\n       XDocument document = XDocument.Load(\"UserSetting.xml\");\n\n        var query = from p in document.Descendants(\"user_Setting\")\n                    where p.Element(\"id\").Value == \"1\"\n                    select p;\n\n        XElement element = query.First();\n        element.SetElementValue(\"Keep_Login\",saveCheckBox(win.MyCheckBox);\n    }\n\npublic static void saveCheckBox(System.windows.Controls.CheckBox checkBox)\n   {\n        string status = \"\";\n        if (checkBox.IsChecked == true)\n            status = \"true\";\n        else if (checkBox.IsChecked == false)\n            status = \"false\";\n\n        return status;\n    }\n}\n</code></pre>\n\n<p>My MainWindow.cs:</p>\n\n<pre><code>public MainWindow()\n    {\n        InitializeComponent();\n        Setting.loadSetting(); \n    } \n</code></pre>\n"},{"tags":["wpf","data","virtualization","infragistics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13229609,"title":"Data Virtualization Loading Iusse","body":"<p>I've implemented Data Virtualization based on the article from by Paul McClean (http://www.codeproject.com/Articles/34405/WPF-Data-Virtualization) on a third party grid from Infragistic. Unfortunately it still loads all the pages / records. I've tried setting the ScrollingMode to \"Deferred\" but still not working. I'm not using ScrollViewer or such thing.</p>\n"},{"tags":["c#","wpf","winforms","visual-studio","icons"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13225933,"title":"The most easy way to use an Icon in every form of the project","body":"<p>I wanted to make my <code>Icon</code> universal for every <code>Form</code> of my <code>Visual Studio</code> project. I googled a lot. But solutions aren't as simple as I want. Yes, simpler was to <code>Inherit</code> <code>Form1</code>. But I have used this code and I think it's most simple.</p>\n\n<pre><code>public Form1()\n    {\n        InitializeComponent();\n        Icon icon = new Icon(\"resources\\\\icon.ico\");\n        this.Icon = icon;\n    }\n</code></pre>\n\n<p>And in other forms I did the same:</p>\n\n<pre><code>public Form2()\n    {\n        InitializeComponent();\n        Icon icon = new Icon(\"resources\\\\icon.ico\");\n        this.Icon = icon;\n    }\n</code></pre>\n\n<p>And it worked absolutely. But I an not sure about the performance and need help. What do you say, is the way harmful for performance of my software? As I'm using same Icon simultaneously.</p>\n"},{"tags":["wpf","styling","datagridcell"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13190394,"title":"Custom Styles on Cells of Datagrid in WPF","body":"<p>I have WPF Datagrid which has 4 x 4 matrix like that</p>\n\n<pre><code>  | A B C D\n------------\n1 | 6 8 9 0\n2 | 3 5 8 3 \n3 | 7 4 3 7  \n4 | 2 1 5 8\n</code></pre>\n\n<p>We have 4 rows and 4 columns. Now I want to apply custom styles on datagrid cells. Currently I am able to apply styles on column level or on grid level. But I want it on cell level. If I want to make A1 cell with Style1, A2 with Style2, D3 with Style6 etc.</p>\n\n<p>where ABCD are columns and 1|2|3|4| are row numbers.</p>\n\n<p>How to remove and apply styles on datagrid cells at runtime?</p>\n"},{"tags":["wpf","entity-framework-4","wpfdatagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13223339,"title":"DataGrid not displaying data from Entity Framework","body":"<p>Using <a href=\"http://msdn.microsoft.com/en-us/data/gg610409.aspx\" rel=\"nofollow\">this tutorial</a> I have tried to make use of a <code>DataGrid</code>. I have two projects: <code>Newsletter.DAL</code> and <code>Newsletter.UI</code>. In <code>Newsletter.DAL</code> i just use Entity Framework to connect to my SQL Express DB. In <code>Newsletter.UI</code> I added new Data Source by clicking <code>Data</code>-><code>Add New Data Source</code> and I chose <code>Object</code> type in the wizard. Next, I added reference to <code>Newsletter.DAL</code> and checked <code>Message</code> class (an entity that represents an email message).\nI dragged the <code>Message</code> entity from Data Sources to my window and the <code>Data Grid</code> appeared.\nThe following tag was also generated in the xaml:</p>\n\n<pre><code>&lt;CollectionViewSource x:Key=\"messageViewSource\" d:DesignSource=\"{d:DesignInstance my:Message, CreateList=True}\" /&gt;\n</code></pre>\n\n<p>My <code>Grid</code> got the <code>DataContext=\"{StaticResource messageViewSource}</code> attribute, so everything seems fine. However, no messages are displayed (I have some sample data in the table). Also, VS has some problems with the tags nested in DataGrid, f.e.:</p>\n\n<pre><code>&lt;DataGridTextColumn x:Name=\"messageIDColumn\" Binding=\"{Binding Path=MessageID}\" Header=\"Message ID\" Width=\"SizeToHeader\" /&gt;\n</code></pre>\n\n<p>it says </p>\n\n<blockquote>\n  <p>Cannot resolve property 'MessageID' in object of type\n  'System.Windows.Data.CollectionViewSource'</p>\n</blockquote>\n\n<p>What am I doing wrong? I'm new to WPF more complex usage, so I get into problems often.</p>\n\n<p>EDIT:</p>\n\n<p>The complete XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"Newsletter.UI.MessagesWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MessagesWindow\" Name=\"messagesWindow\" Height=\"576\" Width=\"1024\" WindowStartupLocation=\"CenterScreen\" Closed=\"MessagesWindowClosed\" mc:Ignorable=\"d\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:my=\"clr-namespace:Newsletter.DAL;assembly=Newsletter.DAL\" Loaded=\"messagesWindow_Loaded\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;Style TargetType=\"{x:Type Button}\"&gt;\n            &lt;Setter Property=\"Width\" Value=\"149\"/&gt;\n            &lt;Setter Property=\"Margin\" Value=\"10\"/&gt;\n        &lt;/Style&gt;\n        &lt;CollectionViewSource x:Key=\"messageViewSource\" d:DesignSource=\"{d:DesignInstance my:Message, CreateList=True}\" /&gt;\n    &lt;/Window.Resources&gt;\n    &lt;Grid DataContext=\"{StaticResource messageViewSource}\"&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"75\"/&gt;\n            &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;StackPanel Grid.Row=\"0\"  Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Grid&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition Height=\"*\"/&gt;\n                    &lt;RowDefinition Height=\"*\"/&gt;\n                &lt;/Grid.RowDefinitions&gt;\n                &lt;Button Name=\"saveButton\" Grid.Row=\"0\" Content=\"Save\"  Margin=\"10,10,10,5\"/&gt;\n                &lt;TextBox Name=\"searchTextBox\" Grid.Row=\"1\"  Margin=\"10,5,10,10\"/&gt;\n            &lt;/Grid&gt;\n            &lt;Button Name=\"recipientsButton\" Content=\"RECIPIENTS\" Click=\"RecipientsButtonClick\" /&gt;\n            &lt;Button Name=\"createButton\" Content=\"CREATE\" Click=\"CreateButtonClick\" /&gt;\n            &lt;Button Name=\"removeButton\" Content=\"REMOVE\" /&gt;\n            &lt;Button Name=\"editButton\" Content=\"EDIT\" /&gt;\n            &lt;Button Name=\"resendButton\" Content=\"RESEND\"/&gt;\n        &lt;/StackPanel&gt;\n        &lt;DataGrid AutoGenerateColumns=\"True\" EnableRowVirtualization=\"True\" Grid.Row=\"1\" ItemsSource=\"{Binding}\" Name=\"messageDataGrid\" RowDetailsVisibilityMode=\"VisibleWhenSelected\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn x:Name=\"contentColumn\" Binding=\"{Binding Path=Content}\" Header=\"Content\" Width=\"SizeToHeader\" /&gt;\n                &lt;DataGridTemplateColumn x:Name=\"dateColumn\" Header=\"Date\" Width=\"SizeToHeader\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;DatePicker SelectedDate=\"{Binding Path=Date, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}\" /&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                &lt;/DataGridTemplateColumn&gt;\n                &lt;DataGridCheckBoxColumn x:Name=\"hasAttachmentsColumn\" Binding=\"{Binding Path=HasAttachments}\" Header=\"Has Attachments\" Width=\"SizeToHeader\" /&gt;\n                &lt;DataGridTextColumn x:Name=\"messageIDColumn\" Binding=\"{Binding Path=MessageID}\" Header=\"Message ID\" Width=\"SizeToHeader\" /&gt;\n                &lt;DataGridTextColumn x:Name=\"senderIDColumn\" Binding=\"{Binding Path=SenderID}\" Header=\"Sender ID\" Width=\"SizeToHeader\" /&gt;\n                &lt;DataGridTextColumn x:Name=\"subjectColumn\" Binding=\"{Binding Path=Subject}\" Header=\"Subject\" Width=\"SizeToHeader\" /&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13229032,"title":"How to disable parent window while child window appear by disable closing button on parent window","body":"<p>I have designed one window in C#(wpf) on which three buttons are there \"file upload\",\"new\" and \"about\". when user clicked \"file upload\" button, the new window appear which gives information about the application. But at this time i want my parent window closing button to be disable so that when user tried to do anyting on parent window it should not allow until \"upload\" process will complete. Once the uploading process completed the close button will enable normally.During the process of uploading onl the button have to disable?</p>\n\n<p>If anyone knows how to do this then please let me know..</p>\n"},{"tags":["c#","wpf","asp.net-mvc","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13161841,"title":"Using WebMatrix.WebData.WebSecurity in a WPF application","body":"<p>I have an MVC4 internet project that uses the out of the box WebMatrix security. A requirement has come along to add a WPF front end to the same application. I have moved the model into a separate DLL and started building the WPF front end over the same entities.</p>\n\n<p>The only issue I am having is trying to integrate with the existing security model. I have added a system.web section into my WPF project's app.config as follows:</p>\n\n<pre><code>&lt;system.web&gt;\n  &lt;membership defaultProvider=\"SimpleMembershipProvider\"&gt;\n    &lt;providers&gt;\n      &lt;clear/&gt;\n      &lt;add name=\"SimpleMembershipProvider\" type=\"WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData\" /&gt;\n    &lt;/providers&gt;\n  &lt;/membership&gt;\n&lt;/system.web&gt;\n</code></pre>\n\n<p>Now when I call <code>WebSecurity.Login(\"Username\", \"Password\")</code> I get the following error:</p>\n\n<blockquote>\n  <p>You must call the \"WebSecurity.InitializeDatabaseConnection\" method before you call any other method of the \"WebSecurity\" class. This call should be placed in an _AppStart.cshtml file in the root of your site.</p>\n</blockquote>\n\n<p>I have tried calling the <code>InitializeSimpleMembershipAttribute();</code> code that comes with the MVC project in the start-up of my WPF application, but it makes no difference to the above error. </p>\n\n<p>I cannot find any examples on-line of how to do this, am going down a dead end here? </p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["wpf","performance","bing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":8457613,"title":"WPF Application with Bing Maps Control painfully slow on startup","body":"<p>I currently work on a WPF application that has mapping support. I use the Bing Maps WPF Control (from here: <a href=\"http://www.microsoft.com/download/en/details.aspx?id=27165\" rel=\"nofollow\">http://www.microsoft.com/download/en/details.aspx?id=27165</a>) to help with the mapping but now there is a pretty big problem:</p>\n\n<p>The application takes quite some time to start up because the Bing Maps Control retrieves all the initial data to display the map. </p>\n\n<p>The mapping part of my application is only rarely needed and so it would be pretty bad to have slow start up for a feature that is not even used every time so I initially set the control's visibility to \"Collapsed\" in the hope that then no requests would be made, but that doesn't help.</p>\n\n<p>Is there a way to explicitly initialize the Bing Maps control when I want to use it and not at application start up?</p>\n"},{"tags":["c#","wpf","video","filestream","mediaelement"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13228697,"title":"Is it possible to pass a FileStream object to an MediaElement?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7117589/using-mediaelement-to-play-video-from-stream\">Using MediaElement to play video from Stream</a>  </p>\n</blockquote>\n\n\n\n<p>Is it possible to pass a FileStream object to MediaElement?</p>\n\n<p>Currently i'm in a position where it is necessary to play video's that are being decrypted real-time before it is being shown. \nA solution where the video gets decrypted, saved on the hard drive and then feeded to MediaElement is a no-go.</p>\n\n<p>Any other solution's that are quite similar to the solution i'm looking for are welcome aswell.</p>\n\n<p>Thanks.</p>\n\n<p>PS : To be a little more specific, There will be encrypted video's stored locally, that are being downloaded from the server. Streaming video's isn't really a solution as it would increase the bandwidth usage.\nAnd sometimes video files can be quite big, talking about 1 to 2gigabytes if not more. However some systems are limited to only 2gigabytes of memory as we are using mini pc's as hosts.</p>\n"},{"tags":["wpf","xaml","mvvm","avalondock"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13219815,"title":"How can I prevent a panel from being closed?","body":"<p>I am using AvalonDock (V2) with a DocumentsSource:</p>\n\n<pre><code>&lt;a:DockingManager DocumentsSource=\"{Binding Items}\"/&gt;\n</code></pre>\n\n<p>I would like to disable the possibility to close a panel using a Style or something that works with a DocuemntsSource.</p>\n\n<p>If possible I would like to have the closing Element to dock in a collapsed manner to the DocumentManager instead of closing.</p>\n"},{"tags":["wpf","path"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13227844,"title":"How to group Paths in WPF?","body":"<p>I'm using paths to create a specific shape. What is the best way to group all the paths so I'll be able to use them later in another location without re-positioning the paths? </p>\n\n<p>Any suggestions will be great, thank you! </p>\n"},{"tags":["wpf","controls","window"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1750,"score":0,"question_id":1662119,"title":"How to get WPF window controls collection","body":"<p>I try to get all WPF window controls collections. In other words i try to get the same result, as it was in win forms app's: </p>\n\n<pre><code>form.Controls\n</code></pre>\n\n<p>I want to use values of these controlls when  i format an SQL query.\nIt's possible to get such control collection of WPF window?\nThanks</p>\n"},{"tags":["c#",".net","wpf","asynchronous","task-parallel-library"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":558,"score":3,"question_id":8594975,"title":"Why will an empty .NET Task not complete if started and waited for from a static constructor?","body":"<p>I cannot understand why the following code will not work:</p>\n\n<pre><code>var task = new Task(() =&gt; { });\ntask.Start();\nif (task.Wait(10000))\n{\n   logger.Info(\"Works\");\n}\nelse\n{  \n   logger.Info(\"Doesn't work\");\n}\n</code></pre>\n\n<p>The task status is stuck on \"Running\" after the timeout expires, although there is nothing to be done. Replacing <code>task.Start()</code> with <code>task.RunSynchronously()</code> will work however.</p>\n\n<p>Does anyone have an idea of what I may be doing wrong? </p>\n\n<p>A test project to replicate the issue is available here: <a href=\"http://erwinmayer.com/dl/TaskTestProject.zip\" rel=\"nofollow\">http://erwinmayer.com/dl/TaskTestProject.zip</a>. As far as I can see, it doesn't work if the method with the above code runs within the static constructor. But it works if called directly as a static class method.</p>\n\n<p>This recent MSDN blog post seems to highlight related issues with static constructors: <a href=\"http://blogs.msdn.com/b/pfxteam/archive/2011/05/03/10159682.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/pfxteam/archive/2011/05/03/10159682.aspx</a></p>\n"},{"tags":["wpf","delete","listbox","item"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1272,"score":0,"question_id":5472071,"title":"Delete an item in a listbox with a button, in wpf MVVM","body":"<p>i have a problem. It seems a simple thing but it isn't that easy. I have two listboxes, with objects in it. One is full with available objects and the other is empty, and i can fill this up with drag and drop. If you fill this empty listbox, the items are also added to a list of , this is a property of another object. But now my question is how i can easily delete an object in this listbox by clicking on a button. </p>\n\n<p>I tried something but it wouldn't run. \nHere is my xaml:</p>\n\n<pre><code>&lt;ListBox ItemsSource=\"{Binding AvailableQuestions}\"          \n         DisplayMemberPath=\"Description\" \n         dd:DragDrop.IsDragSource=\"True\" \n         dd:DragDrop.IsDropTarget=\"True\" Margin=\"0,34,0,339\" Background=\"#CDC5CBC5\"\n         dd:DragDrop.DropHandler=\"{Binding}\"/&gt;\n\n        &lt;ListBox SelectedItem=\"{Binding Path=SelectedQuestionDropList, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}\" ItemsSource=\"{Binding SelectedQuestions}\"\n                 DisplayMemberPath=\"Description\"\n                 dd:DragDrop.IsDragSource=\"True\" \n                 dd:DragDrop.IsDropTarget=\"True\" Margin=\"0,201,0,204\" Background=\"#CDC5CBC5\"\n                 dd:DragDrop.DropHandler=\"{Binding}\"  /&gt;\n\n &lt;Button Content=\"Delete\" Height=\"23\" \n         HorizontalAlignment=\"Left\" \n         Margin=\"513,322,0,0\"  \n         Name=\"button1\" \n         VerticalAlignment=\"Top\" Width=\"75\" Command=\"{Binding Commands}\"    \n         CommandParameter=\"Delete\" /&gt;\n</code></pre>\n\n<p>here is my viewmodel:</p>\n\n<pre><code>// other stuff and properties..\npublic ICommand Commands { get; set; }\n\npublic bool CanExecute(object parameter)\n{\n    return true;\n}\npublic event EventHandler CanExecuteChanged\n{\n    add { CommandManager.RequerySuggested += value; }\n    remove { CommandManager.RequerySuggested += value; }\n}\npublic void Execute(Object parameter)\n{\n    foreach (ExaminationQuestion exaq in this.Examination.ExaminationQuestions)\n    {\n        if (exaq.Question.Guid == SelectedQuestionDropList.Guid)\n        {\n            this.Examination.ExaminationQuestions.Remove(exaq);\n            SelectedQuestions.Remove(SelectedQuestionDropList);\n            OnPropertyChanged(\"SelectedQuestions\");\n        }\n    }               \n}\n</code></pre>\n\n<p>can somebody please help me out? </p>\n"},{"tags":["wpf","wpf-controls","wpf-usercontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13225376,"title":"2 State WPF Button not changing ImageSource","body":"<p>I am having trouble getting this button (with an image in its content) to correctly change the ImageSource on click.  Here is my Xaml and Code Behind.</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;Style x:Key=\"NoChromeButton\" TargetType=\"{x:Type Button}\"&gt;\n        &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n        &lt;Setter Property=\"BorderThickness\" Value=\"1\"/&gt;\n        &lt;Setter Property=\"Foreground\" Value=\"{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}\"/&gt;\n        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Center\"/&gt;\n        &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\"/&gt;\n        &lt;Setter Property=\"Padding\" Value=\"1\"/&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type Button}\"&gt;\n                    &lt;Grid x:Name=\"Chrome\" Background=\"{TemplateBinding Background}\" SnapsToDevicePixels=\"true\"&gt;\n                        &lt;ContentPresenter HorizontalAlignment=\"{TemplateBinding HorizontalContentAlignment}\" Margin=\"{TemplateBinding Padding}\" RecognizesAccessKey=\"True\" SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\" VerticalAlignment=\"{TemplateBinding VerticalContentAlignment}\"/&gt;\n                    &lt;/Grid&gt;\n                    &lt;ControlTemplate.Triggers&gt;\n                        &lt;Trigger Property=\"IsEnabled\" Value=\"false\"&gt;\n                            &lt;Setter Property=\"Foreground\" Value=\"#ADADAD\"/&gt;\n                            &lt;Setter Property=\"Opacity\" TargetName=\"Chrome\" Value=\"0.5\"/&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/ControlTemplate.Triggers&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n\n&lt;Grid&gt;\n    &lt;Button x:Name=\"DrawCircleButton\" Height=\"56\" Width=\"157\" \n    Margin=\"10,10,0,0\" VerticalAlignment=\"Top\" \n    HorizontalAlignment=\"Left\" Click=\"DrawCircleButtonClick\"\n            Style=\"{DynamicResource NoChromeButton}\"\n    &gt;\n        &lt;Image x:Name=\"imgButtonState\" &gt;\n            &lt;Image.Source&gt;\n                &lt;BitmapImage UriSource=\"Resources/off.gif\" /&gt;\n            &lt;/Image.Source&gt;\n        &lt;/Image&gt;\n    &lt;/Button&gt;\n    &lt;ScrollViewer Margin=\"0,50,0,0\"&gt;\n        &lt;TextBlock Name=\"textBlock1\" TextWrapping=\"Wrap\" FontSize=\"20\" FontWeight=\"Bold\" /&gt;\n    &lt;/ScrollViewer&gt;\n\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Code Behind:</p>\n\n<pre><code>private void DrawCircleButtonClick(object sender, RoutedEventArgs e)\n    {\n        var t = ButtonState;\n        ButtonState = t;\n    }\n\npublic bool ButtonState\n    {\n        get\n        {\n            return (bool)GetValue(ButtonStateProperty);\n        }\n        set\n        {\n            var t = new BitmapImage(new Uri(\"Resource/on.gif\", UriKind.Relative));\n\n            DrawCircleButton.Content = !value ? imgButtonState.Source = new BitmapImage(new Uri(\"on.gif\", UriKind.Relative)) : imgButtonState.Source = new BitmapImage(new Uri(\"off.gif\", UriKind.Relative));\n            SetValue(ButtonStateProperty, !value);\n        }\n    }\n\n    public static readonly DependencyProperty ButtonStateProperty = DependencyProperty.Register(\"ButtonState\", typeof(bool), typeof(bool));\n</code></pre>\n\n<p>So initially, the button is set to 'off'.  But as it gets clicked, it toggles between 'on' and 'off'.  I'm sure I did something wrong cause what gets displayed is text to the path of the images.  Any ideas?</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13217470,"title":"How to delete from a list? MVVM pattern orientated","body":"<p>So I've got a listview and it's itemsSource property bound to an ObservableCollection, placed on the view model. And a button the on view\nHow do I make it so the button deletes the item, selected on the listview, from the observableCollection?</p>\n"},{"tags":["wpf","mvvm","prism"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13216664,"title":"How do I open a new window from a view model and pass parameters to it in MVVM?","body":"<p>I have a window with a list, where clicking a list entry will show a new window for a detail view of that item</p>\n\n<p>What is the cleanest way to do this in MVVM? I thought of just doing a container.Resolve&lt;IViewType&gt;().Show() and have Unity create all the dependencies, but just calling Show() sounds un-MVVM. Should I create some sort of WindowService manager class or would this be overkill? What layer of code is it acceptable for code to call Show()?</p>\n\n<p>Secondly, how would I pass parameters (eg CustomerID and ProductID) from the initiating view-model to the new view-model that will be attached to the new window being shown?</p>\n"},{"tags":["wpf","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13227712,"title":"how to access all stack panel in DataGridTemplateColumn","body":"<p>how to access all stack panel in DataGridTemplateColumn?</p>\n\n<p>I'm using this code :</p>\n\n<pre><code>           &lt;DataGrid HeadersVisibility=\"None\"  Name=\"dgUser\" Grid.Row=\"0\" Grid.Column=\"0\" AutoGenerateColumns=\"False\" ItemsSource=\"{Binding}\"\n CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" CanUserSortColumns=\"False\"&gt;\n                                &lt;DataGrid.Columns&gt;\n                                    &lt;DataGridTemplateColumn Width=\"*\" Header=\"\" IsReadOnly=\"True\"&gt;\n                                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                                            &lt;DataTemplate&gt;\n                                                &lt;StackPanel Orientation=\"Horizontal\"  Margin=\"10,0,0,0\" Grid.Column=\"0\"  Name=\"spGuns\"&gt;\n                                                    &lt;TextBlock Margin=\"0,0,5,0\" Text=\"Count\"/&gt;\n                                                    &lt;TextBox Margin=\"0,0,5,0\" MinWidth=\"50\" Width=\"Auto\" Name=\"txtCount\" Text=\"{Binding Count}\"/&gt;\n                                                    &lt;TextBlock Margin=\"0,0,5,0\" Text=\"NameEn\"/&gt;\n                                                    &lt;TextBox Margin=\"0,0,5,0\" MinWidth=\"50\" Width=\"Auto\" Name=\"txtGunNameEn\" Text=\"{Binding NameEn}\"/&gt;\n                                                &lt;/StackPanel&gt;\n                                            &lt;/DataTemplate&gt;\n                                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                                    &lt;/DataGridTemplateColumn&gt;\n                                &lt;/DataGrid.Columns&gt;\n                            &lt;/DataGrid&gt;\n</code></pre>\n\n<p>data in datagrid :</p>\n\n<p><a href=\"http://www.imagetoo.com/?v=untitlfif.png\" rel=\"nofollow\">http://www.imagetoo.com/?v=untitlfif.png</a></p>\n\n<p>how to access all stack panel in DataGridTemplateColumn?</p>\n"},{"tags":["wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13225653,"title":"How to: datagrid cell size changed when windows size changed","body":"<p>Firstly, my window is set to 900px height and 600px width. It contains a datagrid with 4 columns. I've created a template for cells, the widths are, say, 100px. Now when I change the window sizes, I want cells' width to grow proportionally to size of windows. I tried to add datagrid sizes change event but it didn't work.</p>\n\n<p>How can I do this? Thanks!</p>\n\n<p><strong>Update</strong>: one more question: Have any way to make the sizes of a cell is the same whether they're empty or not.</p>\n"},{"tags":["wpf","about-box"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1597,"score":0,"question_id":3411952,"title":"About Window or About Box in WPF 3.5 (VS2008)","body":"<p>I am looking for About Window for WPF VS2008. Any Source code is available to download or one have to develop on his/her own. </p>\n\n<p>Thanks you,\nHarsha</p>\n"},{"tags":["wpf","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13226985,"title":"How to access control in DataGridTemplateColumn to get value?","body":"<p>How to access control in DataGridTemplateColumn to get value ?</p>\n\n<p>I'm using this code :</p>\n\n<pre><code>  &lt;DataGrid HeadersVisibility=\"None\"  Name=\"dgUser\" Grid.Row=\"0\" Grid.Column=\"0\" AutoGenerateColumns=\"False\" ItemsSource=\"{Binding}\"\n CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" CanUserSortColumns=\"False\"&gt;\n                                &lt;DataGrid.Columns&gt;\n                                    &lt;DataGridTemplateColumn Width=\"*\" Header=\"\" IsReadOnly=\"True\"&gt;\n                                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                                            &lt;DataTemplate&gt;\n                                                &lt;StackPanel Orientation=\"Horizontal\"  Margin=\"10,0,0,0\" Grid.Column=\"0\"  Name=\"partcount\"&gt;\n                                                    &lt;TextBlock Margin=\"0,0,5,0\" Text=\"Count\"/&gt;\n                                                    &lt;TextBox Margin=\"0,0,5,0\" MinWidth=\"50\" Width=\"Auto\" Name=\"txtcount\" Text=\"{Binding Count}\"/&gt;\n                                                &lt;/StackPanel&gt;\n                                            &lt;/DataTemplate&gt;\n                                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                                    &lt;/DataGridTemplateColumn&gt;\n       &lt;/DataGrid.Columns&gt;\n                            &lt;/DataGrid&gt;\n</code></pre>\n\n<p>how to access txtcount ?</p>\n"},{"tags":["wpf","visual-studio-2010","deployment","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13220396,"title":"Cannot publish because a project failed to build and Could not find file 'obj\\x86\\Debug\\MyApplication.exe' Errors","body":"<p>I am striving to get the source of my issue but no luck. I did check almost all suggestions to fix this problem when publishing project (publishing using right-click, checked DevExpress is not installed).</p>\n\n<p>-Regarding DevExpress the application have some of it's assemblies.\nUnfortunately I am still getting errors :<br/>\n<strong>- Cannot publish because a project failed <br/>\n- Could not find file 'obj\\x86\\Debug\\MyApplication.exe'</strong> </p>\n\n<p>I did send publishing diagnostic to the Output and get this :</p>\n\n<pre><code>Task \"GenerateApplicationManifest\" (TaskId:158)\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Common.targets(2580,9): error MSB3113: Could not find file 'obj\\x86\\Debug\\MyApplication.exe'.\nDone executing task \"GenerateApplicationManifest\" -- FAILED. (TaskId:158)\nDone building target \"GenerateApplicationManifest\" in project \"MyApplication.csproj\" -- FAILED.: (TargetId:194)\n</code></pre>\n\n<p>Can someone list all things I have to check to get this issue fixed ?</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":13139615,"title":"DataGrid column headers not aligned with data","body":"<p>I've got a DataGrid, which is quite simple as far as DataGrids go.  For some reason or other, the headers are not aligned with the rest of the data, as shown in the screenshot below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/0Neao.png\" alt=\"enter image description here\"></p>\n\n<p>I've searched the internet but cannot seem to find a solution for it.  Here is my DataGrid code:</p>\n\n<pre><code>Grid&gt;\n        &lt;DataGrid Name=\"dgAttributes\" \n                  ItemsSource=\"{Binding itemsSource}\" \n                  AutoGenerateColumns=\"False\" \n                  CanUserAddRows=\"False\" \n                  CanUserDeleteRows=\"False\" \n                  CanUserReorderColumns=\"False\" \n                  CanUserResizeColumns=\"False\" \n                  CanUserResizeRows=\"False\"\n                  CanUserSortColumns=\"False\"\n                  &gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"True\" Binding=\"{Binding Field}\" Header=\"Fields\"/&gt;\n                &lt;DataGridComboBoxColumn  Width=\"95\" IsReadOnly=\"False\" Header=\"Order\" ItemsSource=\"{Binding Source={StaticResource SortOrderProvider}}\" SelectedItemBinding=\"{Binding SortBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridCheckBoxColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding GroupBy}\" Header=\"Group By\"/&gt;\n                &lt;DataGridComboBoxColumn Width=\"85\" IsReadOnly=\"False\" Header=\"Aggregate\" ItemsSource=\"{Binding Source={StaticResource AggregateProvider}}\" SelectedItemBinding=\"{Binding AggregateBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding Having}\" Header=\"Having\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding DisplayOrder}\" Header=\"Display Order\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>It may also be worth mentioning that when I click on one of the Combobox cells, the headers align themselves properly.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12986543,"title":"How to get Checked rows values of a ListView in WPF","body":"<p>I have a <code>ListView</code> in WPF application with a <code>CheckBox</code>.</p>\n\n<p>I want to save the values of all Checked rows in a WPF List ...</p>\n\n<p>How can I achieve this?</p>\n\n<p><strong>My ListView</strong></p>\n\n<pre><code>&lt;ListView x:Name=\"listViewChapter\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" BorderThickness=\"0\" SelectionMode=\"Single\" Height=\"100\" Margin=\"22,234,17,28\" Grid.Row=\"1\"&gt;\n    &lt;ListView.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Center\" &gt;\n                    &lt;Label Name=\"lblChapterID\" VerticalAlignment=\"Center\"  Margin=\"0\" Content=\"{Binding ChapterID}\" Visibility=\"Hidden\" /&gt;\n                    &lt;CheckBox Name=\"chkChapterTitle\" VerticalAlignment=\"Center\" Margin=\"0,0,0,0\" Content=\"{Binding ChapterTittle}\" Checked=\"chkChapterTitle_Checked\" /&gt;\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n    &lt;/ListView.ItemTemplate&gt;\n&lt;/ListView&gt;\n</code></pre>\n"},{"tags":["c#","wpf","kinect-sdk"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13218700,"title":"IndexOutofRangeException while using WriteLine in nested Parallel.For loops","body":"<p>I am trying to write kinect depth data to a text file using nested Parallel.For loops with the following code. However, it gives <code>IndexOutofRangeException</code>. </p>\n\n<p>The code works perfect if using simple for loops but it hangs the UI since the depth format is set to <code>640x480</code> causing the loops to write <code>307200 lines</code> in the text file at <code>30fps</code>.</p>\n\n<p>Therefore, I switched to Parallel. For scheme. If I omit the writeLine command from the nested loops, the code works fine, which indicates that the <code>IndexOutofRangeException</code> is arising at the writeline command. I do not know how to troubleshoot this. Please advise. </p>\n\n<p>Any better workarounds to avoid UI freezing?  </p>\n\n<p>Thanks.</p>\n\n<pre><code>using (DepthImageFrame depthImageframe = d.OpenDepthImageFrame())\n            {\n                if (depthImageframe == null)\n                    return;\n                depthImageframe.CopyPixelDataTo(depthPixelData);\n\n                swDepth = new StreamWriter(@\"E:\\depthData.txt\", false);\n                int i = 0;\n\n                Parallel.For(0, depthImageframe.Width, delegate(int x)\n                {\n                    Parallel.For(0, depthImageframe.Height, delegate(int y)\n                    {\n                        p[i] = sensor.MapDepthToSkeletonPoint(depthImageframe.Format,\n                                x, y, depthPixelData[x + depthImageframe.Width * y]);\n                        swDepth.WriteLine(i + \",\" + p[k].X + \",\" + p[k].Y + \",\" + p[k].Z);\n                        i++;\n                    });\n                });            \n\n                swDepth.Close();\n\n            }\n        }\n</code></pre>\n"},{"tags":["c#","wpf","expander"],"answer_count":6,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":12730,"score":8,"question_id":680498,"title":"How to make WPF Expander Stretch?","body":"<p>The Expander control in WPF does not stretch to fill all the available space. Is there any solutions in XAML for this?</p>\n"},{"tags":["c#","wpf","object","wpf-controls","position"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13221982,"title":"WPF Canvas Is rectangle at position","body":"<p>How can I check if a rectangle object is at a specific position in a canvas? The only solution I found is going through all children in the canvas and check if their position matches, but I don't think that is a good solution. </p>\n\n<p>So I need something like <code>Canvas.IsRectangleAtPosition(Point x)</code>, is there anything like that? </p>\n\n<p>If not, how can I implement such a method?</p>\n\n<p>Kind regards</p>\n"},{"tags":["wpf","gridview","textbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2803,"score":0,"question_id":736789,"title":"How to read values from Gridview columns controls in WPF","body":"<p>I am using a WPF application, in which i placed a listview control which has 3 gridview columns. First Gridview column has a label Control and the remaining 2 gridview columns has textbox control.</p>\n\n<p>Now my problem is if the user enters a value in the first Gridview textbox column, the second gridview textbox column should be updated with some value. Is there any way to do that.</p>\n\n<p>I am filling the list view with a datatable from code behind file.</p>\n\n<p>And also is there any way to get the value of the label control in the 1st gridview column.</p>\n\n<p>Thanks in advance\nurs Frnd :)</p>\n"},{"tags":["c#","wpf","events","animation"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":6256,"score":2,"question_id":1225968,"title":"WPF - Storyboard completed event","body":"<p>I'm designing a game like this</p>\n\n<pre><code>class Anima\n{\n\tStoryboard story;\n\tRandom rand;\n\tCanvas canvas;\n\tEllipse target;\n\n\tpublic Anima() {\n\t\trand = new Random();\n\t\tcanvas = new Canvas();\n\t\ttarget = new Ellipse();\n\n\t\ttarget.Fill = Brushes.Red;\n\t\ttarget.Width = 50;\n\t\ttarget.Height = 50;\n\t\tCanvas.SetLeft(target, rand.NextDouble() * 300);\n\t\tCanvas.SetTop(target, rand.NextDouble() * 300);\n\t\tcanvas.Children.Add(target);\n\n\t\tstory = new Storyboard();\n\t\tstory.BeginTime = TimeSpan.FromMilliseconds(rand.Next(500, 5000));\n\n\t\tDoubleAnimation a = new DoubleAnimation();\n\t\ta.To = rand.NextDouble() * 300;\n\t\ta.Duration = new Duration(TimeSpan.FromMilliseconds(50));\n\n\t\tStoryboard.SetTarget(a, target);\n\t\tStoryboard.SetTargetProperty(a, new PropertyPath(Canvas.LeftProperty));\n\t\tstory.Children.Add(a);\n\n\t\tDoubleAnimation b = new DoubleAnimation();\n\t\tb.To = rand.NextDouble() * 300;\n\t\tb.Duration = new Duration(TimeSpan.FromMilliseconds(50));\n\n\t\tStoryboard.SetTarget(b, target);\n\t\tStoryboard.SetTargetProperty(b, new PropertyPath(Canvas.TopProperty));\n\t\tstory.Children.Add(b);\n\n\t\tstory.Completed += new EventHandler(story_Completed);\n\n\t\tWindow win = new Window();\n\n\t\twin.Loaded += delegate(object sender, RoutedEventArgs e) {\n\t\t\tstory.Begin();\n\t\t};\n\n\t\twin.Content = canvas;\n\t\twin.Show();\n\t}\n\n\tvoid story_Completed(object sender, EventArgs e) {\n\t\tint next = rand.Next(500, 5000);\n\t\tdouble left = rand.NextDouble() * 300;\n\t\tdouble top = rand.NextDouble() * 300;\n\n\t\tConsole.WriteLine(\"position: ({0:G6}, {1:G6})\", Canvas.GetLeft(target), Canvas.GetTop(target));\n\t\tConsole.WriteLine(\"state   : wait for \" + next + \" ms\");\n\t\tConsole.WriteLine(\"next    : ({0:G6}, {1:G6})\", left, top);\n\t\tConsole.WriteLine();\n\n\t\t(story.Children[0] as DoubleAnimation).To = left;\n\t\t(story.Children[1] as DoubleAnimation).To = top;\n\n\t\tstory.BeginTime = TimeSpan.FromMilliseconds(next);\n\t\tstory.Begin();\n\t}\n}\n</code></pre>\n\n<p>Everything is great, but I found that the ellipse didn't get the right position and make an error about 2% to 50%. It seems like the Storyboard.Completed event triggered before the end of animation.</p>\n\n<p>What's wrong with it?</p>\n"},{"tags":["wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":160,"score":0,"question_id":11417385,"title":"Exception has been thrown by the target of an invocation wpf","body":"<p>I am using read data method to continuously reading values from a system. also I am updating a rectangle based in the value of vector. it works nicely if I just display the textbox, however, when I am trying to add rect.Margin, it gives the \"Exception has been thrown by the target of an invocation\" error. here is my code:</p>\n\n<p>System.Threading.Thread myThread = new System.Threading.Thread(new System.Threading.ThreadStart(cn.readData));\nmyThread.Start();</p>\n\n<p>Dispatcher.BeginInvoke(DispatcherPriority.ApplicationIdle, new System.Threading.ThreadStart(delegate\n            {</p>\n\n<pre><code>            textBox1.Text = \"Tablet \"; \n            textBox2.Text = \"Index \"; \n            rect.Margin = new Thickness(Convert.ToInt32(vec.X), Convert.ToInt32(vec.Y), 0, 0);\n         }\n</code></pre>\n"},{"tags":["wpf","wpf-controls","wpf-usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1218,"score":1,"question_id":7737761,"title":"Exception has been thrown by the target of an invocation.","body":"<p>While I was trying to add Controls to my UserControl list it threw \"The calling thread cannot access this object because a different thread owns it.\" exception.</p>\n\n<pre><code>        panel_PanelHolder.Children.Clear();\n        panel_PanelHolder.Children.Add(usr_panel);\n</code></pre>\n\n<p>But when I used below code,</p>\n\n<pre><code>        Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(() =&gt;\n        {\n            panel_PanelHolder.Children.Clear();\n            panel_PanelHolder.Children.Add(usr_panel);\n        }));\n</code></pre>\n\n<p>It throws \"Exception has been thrown by the target of an invocation.\" exception.</p>\n\n<p>What I need is to clear controls, and add a control to the panel. I'm not sure how to fix this ASAP. I'm using a STA thread to manipulate WPF window controls dynamically. Can someone help me on this? thx..</p>\n"},{"tags":[".net","wpf","itemscontrol"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13224987,"title":"WPF ItemContainerGenerator One-to-Many Mapping","body":"<p>Is it possible to create an <a href=\"http://msdn.microsoft.com/en-us/library/ms611040.aspx\" rel=\"nofollow\">ItemContainerGenerator</a> that generates more than one visual item from each data item? I have a collection of custom objects that have two independent visuals that I would like to be added to the same ItemsControl. It is not desirable to display them as their original pairs so it will not be much use to create a template with a panel for each data item that contains the two visuals. However, the two visuals must remain linked to each other, as they respond to each other's events.</p>\n"},{"tags":[".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13214749,"title":"Entering date in d/mm format in TextBox","body":"<p>I've got a TextBox bound to a nullable DateTime property.</p>\n\n<p>I'm in Australia, so I want dates presented in the d/mm/yyyy format.</p>\n\n<p>On my Windows 7 box, I can enter the date in d/mm format, and it's converted correctly (eg. 1/11 converts to November 1st, 13/1 converts to January 13th etc.)</p>\n\n<p>On my Windows 8 box, the same input is interpreted as if it was in the US format, so 1/11 converts to January 11th, and 13/1 fails (since there is no 13th month). </p>\n\n<p>Both computers are set to use the Australian formats, and I have this code in the Application.StartUp event:</p>\n\n<pre><code>FrameworkElement.LanguageProperty.OverrideMetadata(GetType(FrameworkElement), New FrameworkPropertyMetadata(XmlLanguage.GetLanguage(CultureInfo.CurrentCulture.IetfLanguageTag)))\n</code></pre>\n\n<p>The Binding's StringFormat is set to d/MM/yyyy, and I've checked that this is correct by also binding a TextBlock to the same property that has its StringFormat set to D (the long date format, which gives values like 'Wednesday, 11 January, 2012').</p>\n\n<p>Does anyone have any ideas?</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":434,"score":1,"question_id":6764206,"title":"How to set custom text when copying BlockUIContainer from FlowDocument to clipboard?","body":"<p>I have flow document with embedded BlockUIContainers. I want to replace them with appropriate text when users copies text containing them to clipboard.</p>\n\n<p><strong>Upadate:</strong>\nI have following chat interface:\n<img src=\"http://i.stack.imgur.com/6WdNI.png\" alt=\"Chat\"></p>\n\n<p>Captions with time and username are done with <code>BlockUIContainer</code>s (I don't know how to do it using FlowDocument elements). When users selects some messages and copies them to clipboard, username and time are not copiet because they are TextBlocks. I want to intercept copy command and format chat text appropriately.</p>\n"},{"tags":["c#","wpf","3d-reconstruction"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":1007,"score":2,"question_id":5816701,"title":".NET integratable robust, fast solution for surface reconstruction from 3D point cloud","body":"<p>We have a .NET 4.0 C# WPF, machining simulation application. Right now we are stuck since we have to generate a 3D surface (mesh generation) from a point cloud. We have been searching, goggling, testing different libraries in order to find a solution that is fast, robust, correct and that can be integrated to our application but we had no luck. 3D imaging is not our line of business so we don't want to get into coding this part. A commercial solution with an affordable price can also be an answer for us.</p>\n\n<p>Until now we have tried: </p>\n\n<ol>\n<li><p><a href=\"http://vcg.sourceforge.net/index.php/Main_Page\" rel=\"nofollow\">VCGLib</a> through MeshLab UI but the algorithm they use (Ball Pivoting) didn't give a good result. </p></li>\n<li><p>A MatLab code based on PowerCrust algorithm (<a href=\"http://www.advancedmcode.org/surface-recostruction-from-scattered-points-cloud-mycrust-robust.html\" rel=\"nofollow\">MyCrust Robust</a>) and it gave a good result but we don't think that if we recode this code in C#, it will gave us the performance that we want. We need a solution that can be easily integrated to our project.</p></li>\n<li><p>While searching we have also came up with these <a href=\"http://www.den.rcast.u-tokyo.ac.jp/~yu-ohtake/software/index.html\" rel=\"nofollow\">sample applications</a>. We don't know the detail of the algorithm used in these applications (details are in an academic paper) but it generated a result with so many missing meshes. But may be it can help to someone else. </p></li>\n</ol>\n\n<p>Right now we are trying to learn <a href=\"http://www.cgal.org/\" rel=\"nofollow\">CGAL</a> and find out whether it can be an answer for us. But since installing Boost and compiling CGAL took two days for us we just started on working on it.</p>\n\n<p>Can anybody offer us a solution that can be in help to us?</p>\n\n<p>Thanks in advance </p>\n"},{"tags":["wpf","wpf-controls","bing-maps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13074617,"title":"Aligning images on WPF bing maps","body":"<p>Just ran into issue that aligning is not working for WPF Bing Maps if it's specified while creating image:</p>\n\n<pre><code>var element = new Image()\n        {\n            Source = ResourceManager.VesselIcon,\n            Opacity = 0.9,\n            Stretch = System.Windows.Media.Stretch.None,\n\n            VerticalAlignment = System.Windows.VerticalAlignment.Center, // Is not working\n            HorizontalAlignment = System.Windows.HorizontalAlignment.Center\n        };\n</code></pre>\n\n<p>Fortunatley WPF Bing Maps API do provide \"PositionOrigin\" structure. So one can specify alignment while adding shape to map itself:  </p>\n\n<pre><code>Location location = Helper.SomeLocation();\nthis.mapLayer.AddChild(element, location, PositionOrigin.Center);\n</code></pre>\n\n<p>Hope it will help somebody</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13223575,"title":"Why is Application.Current.Windows always empty in WPF app","body":"<p>I have a program which has a custom Main method (i.e. not auto generated from App.xaml) and everything is working with no issues except for one thing; I need to get the collection of all windows and the <code>WindowCollection</code> accessed via Application.Current.Windows is always empty (non-null but count == 0).</p>\n\n<p>Other properties of the Application instance such as MainWindow are available but for some reason this collection is never added to. Have I missed wiring something up?</p>\n\n<p>As a side note, is there an event anywhere that notifies whenever a new window is opened in a WPF app?</p>\n"},{"tags":[".net","wpf","silverlight","xaml"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2078,"score":3,"question_id":1821238,"title":"Embed a System.String in XAML","body":"<p>Is there a way to embed a string in XAML, give it and ID and refer to it later.</p>\n\n<p>I have tried:</p>\n\n<pre><code>    &lt;Window x:Class=\"WpfApp1.Window1\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:System=\"clr-namespace:System;assembly=mscorlib\"\n        Title=\"Window1\" Height=\"300\" Width=\"500\"&gt;\n        &lt;Grid&gt;\n            &lt;System:String&gt;Test&lt;/System:String&gt;\n        &lt;/Grid&gt;\n    &lt;/Window&gt;\n</code></pre>\n\n<p>And get error:<br>\nCannot add instance of type 'String' to a collection of type 'UIElementCollection'. Only items of type 'UIElement' are allowed.</p>\n\n<p>Could I do this if I nested the String somewhere else in the XAML? or inside a non UI element? Then do I just give it a Name attribute?</p>\n"},{"tags":["wpf","grid","devexpress","control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13222941,"title":"DevExpress WinForms - looking for a control like Grid in WPF","body":"<p>Does exists some Grid Control among DevExpress controls for WinForms that behave like the WPF Grid control ?</p>\n\n<p>I asked the support but until now did not get any response.</p>\n\n<p>I need the following features\n1. Rows and Columns\n2. RowSpan, ColumnSpan\n3. Fill the cells with child controls\n4. Stretching and aligning capabilities inside the cells\n5. DevExpress Skinnig and Theming</p>\n\n<p>Maybe extending of some similar control would be an option ?</p>\n"},{"tags":["wpf","surface"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13218651,"title":"SurfaceInkCanvas And TagVisualization","body":"<p>I have a surface application with SurfaceInkCanvas.\nNow, I want to do something when the tag is on the canvas (change color for instance).</p>\n\n<p>The problem is, the SurfaceInkCanvas catch the VisualizationAdded event, and draw point on the canvas - instead of Calling the VisualizationAdded event of the TagVisualizer.</p>\n\n<p>If I change the Panel.Zorder of the items, the tag event is catched but I can't draw on the canvas.</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["c#","wpf",".net-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13221204,"title":"How to enable/disable WPF button based on method return","body":"<p>I need to enable/disable a WPF button based on the return of a method.\n<br>I have a <code>HasPermission</code> method that tells me if the user can or not click on that button.</p>\n\n<p>I've seen that I could use <code>Command =&gt; CanExecute</code> to avoid the execution of the action. Seen here:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/7921280/how-to-enable-disable-a-button-in-wpf\">How to enable/disable a button in WPF?</a></p>\n\n<p>My question is, I have a lot of Windows in which I'll be checking for the permission, is this the best approach? Will I really have to write from <code>2</code> to <code>N</code> commands for every window I have?</p>\n\n<p>Is there any way to make this <code>global</code>? \n<br>For instance, could I create the generic commands (Search/Create/...) and then only get the window it was called from and pass it to my <code>HasPermission</code> method?</p>\n"},{"tags":["wpf","multibinding"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":11599508,"title":"WPF MultiBinding same converter with different binding path","body":"<p>I have ten UI Controls of the same type in a UI and all will be using same multi binding converter.</p>\n\n<p>The problem is I can not create a common style for multibinding which I can apply to all UI controls to avoid duplicate code, as each control will use a different binding property to pass as a Binding to converter.</p>\n\n<p>Is there any way in WPF we can avoid duplicate code for this scenario?</p>\n"},{"tags":["c#","wpf","treeview","treeviewitem"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13200590,"title":"Moving nodes around a TreeView","body":"<p>I'm trying to enable users to move <code>TreeViewItems</code> around a <code>TreeView</code> (specifically, by holding control and pressing arrow keys). I can move nodes into and out of other nodes, and I can move nodes up and down on the top level, but when I try to move nodes up within a subnode, it does nothing, and if I try to move nodes down within a subnode, I get the following exception:</p>\n\n<p>Element already has a logical parent. It must be detached from the old parent before it is attached to a new one.</p>\n\n<p>which occurs when I attempt to add the node back to its original collection (after removing it, of course). Here's the original implementation:</p>\n\n<pre><code>private TreeViewItem getParent(TreeViewItem item)\n{\n    for (int i=0; i&lt;fragment_tree.Items.Count; ++i)\n    {\n        TreeViewItem r = getParent((TreeViewItem)(fragment_tree.Items[i]), item);\n        if (r != null)\n        {\n            return r;\n        }\n    }\n    return null;\n}\nprivate TreeViewItem getParent(TreeViewItem test, TreeViewItem item)\n{\n    for (int i=0; i&lt;test.Items.Count; ++i)\n    {\n        if (test.Items[i] == item)\n        {\n            return test;\n        }\n    }\n    for (int i=0; i&lt;test.Items.Count; ++i)\n    {\n        TreeViewItem r = getParent((TreeViewItem)(test.Items[i]), item);\n        if (r != null)\n        {\n            return r;\n        }\n    }\n    return null;\n}\nprivate ItemCollection getContainingList(TreeViewItem item, out int id)\n{\n    return getContainingList(fragment_tree.Items, item, out id);\n}\nprivate ItemCollection getContainingList(ItemCollection test, TreeViewItem item, out int id)\n{\n    for (int i=0; i&lt;test.Count; ++i)\n    {\n        if (test[i] == item)\n        {\n            id = i;\n            return test;\n        }\n    }\n    for (int i=0; i&lt;test.Count; ++i)\n    {\n        ItemCollection r = getContainingList((TreeViewItem)(test[i]), out id);\n        if (r != null)\n        {\n            return r;\n        }\n    }\n    id = -1;\n    return null;\n}\nprivate void fragment_tree_PreviewKeyDown(object sender, KeyEventArgs e)\n{\n    TreeViewItem selected_item = (TreeViewItem)(fragment_tree.SelectedItem);\n    if (selected_item.Header is String)\n    {\n        if (e.KeyboardDevice.IsKeyDown(Key.LeftCtrl) || e.KeyboardDevice.IsKeyDown(Key.RightCtrl))\n        {\n            if (e.Key == Key.Up)\n            {\n                int id;\n                ItemCollection collection = getContainingList(selected_item, out id);\n                if (collection != null) // it'll never be null, but w/e\n                {\n                    if (id &gt; 0)\n                    {\n                        collection.RemoveAt(id);\n                        collection.Insert(id-1, selected_item);\n                        selected_item.IsSelected = true;\n                    }\n                }\n                e.Handled = true;\n            }\n            else if (e.Key == Key.Down)\n            {\n                int id;\n                ItemCollection collection = getContainingList(selected_item, out id);\n                if (collection != null) // it'll never be null, but w/e\n                {\n                    if (id &lt; collection.Count)\n                    {\n                        collection.RemoveAt(id);\n                        collection.Insert(id+1, selected_item); // here is the exception\n                        selected_item.IsSelected = true;\n                    }\n                }\n                e.Handled = true;\n            }\n            else if (e.Key == Key.Left)\n            {\n                TreeViewItem parent = getParent(selected_item);\n                if (parent != null)\n                {\n                    int id;\n                    ItemCollection collection = getContainingList(parent, out id);\n                    parent.Items.RemoveAt(id);\n                    collection.Insert(id, selected_item);\n                    selected_item.IsSelected = true;\n                }\n                e.Handled = true;\n            }\n            else if (e.Key == Key.Right)\n            {\n                int id;\n                ItemCollection collection = getContainingList(selected_item, out id);\n                if (id+1 &lt; collection.Count)\n                {\n                    TreeViewItem next_item = (TreeViewItem)(collection[id+1]);\n                    collection.RemoveAt(id);\n                    next_item.Items.Insert(0, selected_item);\n                    next_item.IsExpanded = true;\n                    selected_item.IsSelected = true;\n                }\n                e.Handled = true;\n            }\n        }\n    }\n</code></pre>\n\n<p>I tried making a deep clone of the selected <code>TreeViewItem</code> (though I'd rather not incur the overhead), and got some strange behavior. When I try to move an item up or down within it's subtree, it jumps out to the parent. When I try to move a node on the top level up or down, it deletes its neighbors. I feel as though there's something fundamental I'm missing</p>\n\n<pre><code>private TreeViewItem cloneTreeViewItem(TreeViewItem item)\n{\n    TreeViewItem r = new TreeViewItem();\n    r.Header = item.Header;\n    r.Tag = item.Tag;\n    for (int i=0; i&lt;item.Items.Count; ++i)\n    {\n        r.Items.Add(cloneTreeViewItem((TreeViewItem)(item.Items[i])));\n    }\n    return r;\n}\n\n....\nif (e.Key == Key.Up)\n{\n    int id;\n    ItemCollection collection = getContainingList(selected_item, out id);\n    if (collection != null) // it'll never be null, but w/e\n    {\n        if (id &gt; 0)\n        {\n            collection.RemoveAt(id);\n            TreeViewItem clone = cloneTreeViewItem(selected_item);\n            collection.Insert(id-1, clone);\n            clone.IsSelected = true;\n        }\n    }\n    e.Handled = true;\n}\nelse if (e.Key == Key.Down)\n{\n    int id;\n    ItemCollection collection = getContainingList(selected_item, out id);\n    if (collection != null) // it'll never be null, but w/e\n    {\n        if (id &lt; collection.Count)\n        {\n            collection.RemoveAt(id);\n            TreeViewItem clone = cloneTreeViewItem(selected_item);\n            collection.Insert(id+1, clone);\n            clone.IsSelected = true;\n        }\n    }\n    e.Handled = true;\n}\n.....\n</code></pre>\n\n<p>I did spend at least an hour researching this topic, I understand that the <code>TreeViewItem</code> must be detached from its logical parent, and I know from testing that the Parent of a <code>TreeViewItem</code> is always a <code>TreeView</code>, I just don't know how to detach it. I know you try to keep the site free of frivolous questions, and I hope mine isn't one. Any insight would be appreciated.</p>\n"},{"tags":["c#","wpf","data-binding","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13211776,"title":"I want to display in combobox the items that contain the text I searched for","body":"<p>I got combobox that contain names. My goal is to search with textbox for a string and than the names that start with this string will display in the combobox.</p>\n\n<p><strong>for example:</strong></p>\n\n<p>my combobox contain the next items:</p>\n\n<blockquote>\n  <p>\"Mark\" , \"Arik\", \"Michael\"</p>\n</blockquote>\n\n<p>when a user will write \"<code>Mi</code>\" in the textbox,  the combobox will display only \"<code>Michael</code>\".</p>\n\n<p>P.S there is no button. only textbox and combobox.</p>\n"},{"tags":["c#",".net","wpf","mef","caliburn.micro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13214429,"title":"ImportMany of MEF loading Contracts twice","body":"<p>I have two classes which Exports <code>IScreen</code>, but when I import the same using </p>\n\n<pre><code>[ImportMany(typeof(IScreen))]\nprivate IEnumerable&lt;Lazy&lt;IScreen,IJIMSMetadata&gt;&gt; _modules;\npublic IEnumerable&lt;Lazy&lt;IScreen, IJIMSMetadata&gt;&gt; Modules\n{\n        get { return _modules; }\n}\n</code></pre>\n\n<p>The Modules contain four instance of IScreen, but I have Exported only two.</p>\n\n<p>This is Container</p>\n\n<pre><code>container = new CompositionContainer(\n                new AggregateCatalog(AssemblySource.Instance.Select(x =&gt; new AssemblyCatalog(x)))                \n                );\n\n\nprotected override IEnumerable&lt;Assembly&gt; SelectAssemblies()\n{\n    string _modulePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location), \"Modules\");\n    var files = Directory.GetFiles(_modulePath, \"*.dll\", SearchOption.AllDirectories);\n\n    List&lt;Assembly&gt; assemblies = new List&lt;Assembly&gt;();\n    assemblies.Add(Assembly.GetExecutingAssembly());\n    foreach (var file in files)\n    {\n        assemblies.Add(Assembly.LoadFrom(file));\n    }\n    return assemblies;\n}\n</code></pre>\n"},{"tags":["wpf","xaml","canvas","centering"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13219321,"title":"Positioning an element inside the Canvas by its center (instead of the top left corner) using only XAML in WPF","body":"<p>The common question about positioning an element inside a <code>Canvas</code> is \"How to position the center of element (instead of the top left corner)\".</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/3423834/wpf-resizing-a-circle-keeping-the-center-point-instead-of-topleft\">WPF: Resizing a circle, keeping the center point instead of TopLeft?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/5422897/wpf-center-ellipse-at-x-y\">WPF Center Ellipse at X, Y</a></li>\n<li><a href=\"http://stackoverflow.com/questions/3682111/wpf-element-positioning-on-a-canvas\">WPF element positioning on a Canvas</a> </li>\n</ul>\n\n<p>Several solutions are presented, but they all have drawbacks.</p>\n\n<p>The easiest solution is to accommodate the element size during while setting the <code>Canvas.Left</code> and <code>Canvas.Top</code> properties programmatically. This works, but only once. This solution doesn't support bindings and it will break when the element size is changed. You also cannot set the <code>Canvas.Left</code> or <code>Canvas.Top</code> using </p>\n\n<p>Another set of solutions involve translate transformations utilizing either <code>RenderTransform</code> or <code>Margin</code>. These solutions require binding some property to the <code>-0.5 * Width</code> or <code>-0.5 * Height</code>. Such binding requires creating a custom <code>ValueConverter</code> and is impossible to create using only XAML.</p>\n\n<p><strong>So, is there a simple way to position an element inside canvas so that its <code>Canvas.Left</code> and <code>Canvas.Top</code> correspond to the element's center and both size and position properties can be bound to some other properties?</strong></p>\n"},{"tags":["wpf","user-interface","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13218977,"title":"button isEnabled = true doesn`t works without mouse click WPF MVVM","body":"<p>I have wpf applicaton based on MVVM pattern.\nI have annoying  issue and I can`t figure how can I solve it.</p>\n\n<p>My application is wizard application, When the user press \"Next\" I am starting some progress in another thread (backgroundworker), when the bgWorker is starting he set <code>CanMoveNext = false</code> which binded to Next button isEnabled property and when the bgworker is finish he set back CanMoveNext = true;</p>\n\n<p>When <code>CanMoveNext</code> get <code>IsEnabled = false</code> the UI show it immediately but after the isEnabled propery set back to true the UI do the refresh just after a mouse click or keyboard key press.</p>\n\n<p>After I<code>m changing the property I</code>m using <code>OnPropertyChanged()</code> method, I even tried use  <code>CommandManager.InvalidateRequerySuggested();</code> but it`s still not get refreshed without mouseclick.</p>\n\n<p>How can I solve this problem? </p>\n\n<p>Here is my code:</p>\n\n<pre><code>       public override bool CanMoveNext\n        {\n            get\n            {\n                return canMoveNext;\n            }\n            set\n            {\n                canMoveNext = value;\n                OnPropertyChanged(\"CanMoveNext\");\n            }\n        }\n\n\n\n    public void StartProgress()\n            {\n\n                CanMoveNext = false;\n                InitBGworkers(out bgStartPersonalWorker);\n    bgStartPersonalWorker.RunWorkerAsync();\n    }\n\n\n\n        void bgStartPersonalWorker_DoWork(object sender, DoWorkEventArgs e)\n        {\n            DoStuff();\n        }\n\n\n\n        void bgStartPersonalWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n                {\n     CanMoveNext = true;\n//Even  CommandManager.InvalidateRequerySuggested(); doen`t help\n                }\n</code></pre>\n\n<p>//Code from XAML</p>\n\n<pre><code>&lt;Button Content=\"{Binding ButtonNextCaption}\" IsEnabled=\"{Binding CanMoveNext, UpdateSourceTrigger=PropertyChanged}\" Command=\"{Binding Path=NavigateNextCommand}\" Margin=\"5,0,5,0\" Width=\"100\" Height=\"40\" FontSize=\"14\" FontWeight=\"Bold\"/&gt;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wpf","canvas","geometry"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1037,"score":2,"question_id":3682111,"title":"WPF element positioning on a Canvas","body":"<p>I have a point on a canvas that I want to place an ellipse. I want the centre of the ellipse to be over this point. At the moment the top left most edge of the ellipse is over this point.</p>\n\n<p>I know I can shift the ellipse programmatically on the canvas but I was wondering if there is a way to tell WPF to centre the element over the point instead of sizing it from the top left???</p>\n"},{"tags":["wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1863,"score":4,"question_id":5422897,"title":"WPF Center Ellipse at X, Y","body":"<p>I have an ItemsControl that draws thousands of Ellipses in a scatter plot on a Canvas. My problem is, if I position an Ellipse at the coordinates (4, 6) with a Height and Width of 10. The top left of the Ellipse is at (4, 6) and the shape extends down and to the right.</p>\n\n<p>What I'd like to do is center the Ellipses on specific coordinates in XAML without having to use adjustments in my ViewModel layer.</p>\n\n<p>Here's the working UserControl that has my graph:</p>\n\n<pre><code>&lt;Grid&gt;\n        &lt;ItemsControl ItemsSource=\"{Binding State.Data}\"&gt;\n\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;Canvas  ClipToBounds=\"False\"/&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n\n            &lt;ItemsControl.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ContentPresenter\"&gt;\n                    &lt;Setter Property=\"Canvas.Left\" Value=\"{Binding Path=X}\" /&gt;\n                    &lt;Setter Property=\"Canvas.Top\" Value=\"{Binding Path=Y}\" /&gt;\n                &lt;/Style&gt;\n            &lt;/ItemsControl.ItemContainerStyle&gt;\n\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Ellipse Fill=\"Red\"  VerticalAlignment=\"Center\" HorizontalAlignment=\"Center\"  Width=\"10\" Height=\"20\"/&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n\n        &lt;/ItemsControl&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>This works great except for the uncentered ellipses. Any ideas?</p>\n"},{"tags":["wpf","xaml","2d","resize","centering"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1984,"score":3,"question_id":3423834,"title":"WPF: Resizing a circle, keeping the center point instead of TopLeft?","body":"<p>I'd like to resize a circle on my canvas with the help of a slider. This circle can be moved around on the canvas by some drag&amp;drop stuff I did in code behind, so its position is not fixed.</p>\n\n<p>I have bound the slider's value to an ellipse's height and width. Unfortunately, when I use the slider, the circle gets resized with its top left point (actually the top left point of the rectangle it's sitting in) staying the same during the operation.</p>\n\n<p>I would like to resize it with its <strong>center</strong> point being constant during the operation. Is there an easy way to do this in XAML? BTW, I already tried ScaleTransform, but it didn't quite do what I wanted.</p>\n\n<p>Thanks a bunch! :-)</p>\n\n<p>Jan</p>\n\n<pre><code>&lt;Canvas x:Name=\"MyCanvas\"&gt;\n\n    &lt;!-- this is needed for some adorner stuff I do in code behind --&gt;\n    &lt;AdornerDecorator Canvas.Left=\"10\"\n                      Canvas.Top=\"10\"&gt;\n        &lt;Ellipse x:Name=\"myEllipse\"\n             Height=\"{Binding Path=Value, ElementName=mySlider}\"\n             Width=\"{Binding Path=Value, ElementName=mySlider}\"\n             Stroke=\"Aquamarine\"\n             Fill=\"AliceBlue\"\n             RenderTransformOrigin=\"0.5 0.5\"&gt;\n            &lt;Ellipse.RenderTransform&gt;\n                &lt;RotateTransform Angle=\"{Binding Path=Value, ElementName=myRotationSlider}\" /&gt;\n            &lt;/Ellipse.RenderTransform&gt;\n        &lt;/Ellipse&gt;\n    &lt;/AdornerDecorator&gt;\n\n    &lt;Slider x:Name=\"mySlider\"\n            Maximum=\"100\"\n            Minimum=\"0\"\n            Width=\"100\"\n            Value=\"10\"\n            Canvas.Left=\"150\"\n            Canvas.Top=\"10\" /&gt;\n    &lt;Slider x:Name=\"myRotationSlider\"\n            Maximum=\"360\"\n            Minimum=\"0\"\n            Width=\"100\"\n            Value=\"0\"\n            Canvas.Left=\"150\"\n            Canvas.Top=\"50\" /&gt;\n&lt;/Canvas&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13219187,"title":"Access ListView SelectedItems First Column Values","body":"<p>I'm slightly new to WPF, so please excuse any stupidity in the question.</p>\n\n<p>I have a Listview in my form, that the Columns and rows are generated at runtime from a method thats called.</p>\n\n<pre><code>        var servicesviewer = new GridView();\n        servicesviewer.Columns.Add(new GridViewColumn { Header = \"Service\", DisplayMemberBinding = new Binding(\"Service\") });\n        servicesviewer.Columns.Add(new GridViewColumn { Header = \"Status\", DisplayMemberBinding = new Binding(\"Status\") });\n        lViewServices.View = servicesviewer;\n</code></pre>\n\n<p>I would like to retrieve the values of the Service Column of the rows selected and perform some sort of operation with the values.</p>\n\n<pre><code>foreach (var items in lViewServices.SelectedItems) {\n}\n</code></pre>\n\n<p>I now have an object named  items, and when I insert a breakpoint at the foreach statement, I can see that items = {Service = \"ServiceName\", Status = \"StatusofService\"}</p>\n\n<p>My question, how in the world do I get just the value of the \"ServiceName\" from the items object?</p>\n\n<p>If I was doing this in WinForms, I would have normally just grabbed the text value of the SubItem of the ListView.  Don't know if thats bad practice, but I haven't found a comparible way to do that in WPF yet.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","visual-studio","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13218276,"title":"Can WPF control easily ported to Windows 8 RT platform?","body":"<p>Since VS cannot work on windows RT I guess some gurus will make one, but for own purpose, is it possible to use or easily port wpf code editor control like <a href=\"http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor\" rel=\"nofollow\">http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor</a> on windows RT ? What would be the steps ?</p>\n"},{"tags":["wpf","wpf-commands"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13214481,"title":"WPF command pattern","body":"<p>I have an application wide flag that is an app setting.</p>\n\n<pre><code>MyApp.Properties.Settings.Default.SoundMuted\n</code></pre>\n\n<p>The flag is if my apps sound is muted. I have a number of windows where sounds are being played through .Net’s sound player. I was thinking the flag would be wired up to a toolbar button with a command. I was thinking for muting notification to have my classes that play sound wire up to a class (e.g. <code>SoundManager</code>) hanging off the app that implements <code>NotifyPropertyChange</code>. Then if the user clicks the toolbar button, I would set the Muted property in my <code>SoundManager</code> and have all the soundplayer classes get the <code>PropertyChange</code> and mute.</p>\n\n<p>Is there a better pattern for this? Say I could wire all the soundplayers up to the command and that command would fire.</p>\n\n<p>Also is there some slick way to just wire that app setting as a bindable property in xaml?</p>\n"},{"tags":["c#","wpf","winforms","wpf-controls","activex"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13218455,"title":"How to use ActiveX in WPF Browser application?","body":"<p>i have project used  WPF WebBrowser application,can i do this in WPF WebBrowser application?</p>\n"},{"tags":["c#","wpf","storyboard"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13217221,"title":"SetTarget vs RegisterName/SetTargetName","body":"<p>Here's a simple program which animates the <code>Y2</code> property of a <code>Line</code> shape. Note that I use the <code>SetTarget</code> method to target the <code>Line</code>. This program works fine.</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Media.Animation;\nusing System.Windows.Shapes;\n\nnamespace SoGeneratingAnimatedLine\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            var canvas = new Canvas();\n\n            Content = canvas;\n\n            var sb = new Storyboard();\n\n            var line = new Line()\n            {\n                X1 = 10, Y1 = 10,\n                X2 = 90, Y2 = 10,\n                Stroke = Brushes.Black,\n                StrokeThickness = 2\n            };\n\n            canvas.Children.Add(line);\n\n            var animation = new DoubleAnimation(10, 90, new Duration(TimeSpan.FromMilliseconds(1000)));\n\n            sb.Children.Add(animation);\n\n            Storyboard.SetTarget(animation, line);\n            Storyboard.SetTargetProperty(animation, new PropertyPath(Line.Y2Property));\n\n            MouseDown += (s, e) =&gt; sb.Begin(this);\n        }\n    }\n}\n</code></pre>\n\n<p>Here's a similar program which animates the <code>EndPoint</code> of a <code>LineGeometry</code> which is the <code>Data</code> for a <code>Path</code>:</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Media.Animation;\nusing System.Windows.Shapes;\n\nnamespace SoGeneratingAnimatedLine\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            var canvas = new Canvas();\n\n            Content = canvas;\n\n            var sb = new Storyboard();\n\n            var lineGeometry = \n                new LineGeometry(new Point(10, 10), new Point(90, 10));\n\n            var path = new Path()\n            {\n                Stroke = Brushes.Black,\n                StrokeThickness = 2,\n                Data = lineGeometry\n            };\n\n            canvas.Children.Add(path);\n\n            var animation =\n                new PointAnimation(\n                    new Point(90, 10),\n                    new Point(90, 90),\n                    new Duration(TimeSpan.FromMilliseconds(1000)));\n\n            sb.Children.Add(animation);\n\n            Storyboard.SetTarget(animation, lineGeometry);\n            Storyboard.SetTargetProperty(animation, new PropertyPath(LineGeometry.EndPointProperty));\n\n            MouseDown += (s, e) =&gt; sb.Begin(this);\n        }\n    }\n}\n</code></pre>\n\n<p>This second version does <em>not</em> work. However, if I replace the line:</p>\n\n<pre><code>Storyboard.SetTarget(animation, lineGeometry);\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>RegisterName(\"geometry\", lineGeometry);\nStoryboard.SetTargetName(animation, \"geometry\");\n</code></pre>\n\n<p>then the animation runs.</p>\n\n<p>Why doesn't the <code>SetTarget</code> version of the second program work? When is it OK to use <code>SetTarget</code> instead of the <code>RegisterName</code>/<code>SetTargetName</code> combo? What's the difference in the two approaches?</p>\n"},{"tags":["wpf"],"answer_count":7,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":2211,"score":9,"question_id":438285,"title":"What are the top 3 main concepts in WPF?","body":"<p>What are the top 3 main concepts in WPF that you need to understand in order to write good WPF code? </p>\n"},{"tags":["c#","wpf","windows"],"answer_count":6,"favorite_count":5,"up_vote_count":18,"down_vote_count":1,"view_count":11143,"score":17,"question_id":588660,"title":"What is WPF and how does it compare to WinForms?","body":"<p>I've been looking at WPF, but I've never really worked in it (except for 15 minutes, which prompted this question). I looked at this <a href=\"http://stackoverflow.com/questions/193005/are-wpf-more-flashy-like-than-winforms\">post</a> but its really about the \"Flash\" of a WPF. So what is the difference between a Windows Forms application and a WPF application?</p>\n"},{"tags":["c#","wpf","udp","versant-vod"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13217917,"title":"Play Fast forward/Backward RSTP streams","body":"<p>For one of my projects I have to do play , fast forward/ play backwards for RSTP streams. Project is implemented using WPF(C#). Do you know any technology that I can approach and achieve my goals?</p>\n"},{"tags":["c#","wpf","visual-studio-2010","razor","razorgenerator"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13055228,"title":"why can't reference System.Web.WebPages and System.Web.Razor in a WPF project?","body":"<p>I need to use <code>Razor Generator</code> as described <a href=\"http://haacked.com/archive/2011/08/01/text-templating-using-razor-the-easy-way.aspx\" rel=\"nofollow\">here</a> in a <code>WPF</code> project but I can't add <strong>references</strong> to <code>System.Web.WebPages</code> and <code>System.Web.Razor</code> required by <code>RAZOR Generator</code>. are these dlls unavailable in <code>WPF</code> in general ? or I should change some <strong>configurations</strong> ?</p>\n"},{"tags":["wpf","xaml","wpfdatagrid","wpf-4.0","datagridheaderborder"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2354,"score":2,"question_id":3365350,"title":"WPF4 DataGridHeaderBorder in a xaml Style","body":"<p>Making a separate question, related to comments on the answer to <a href=\"http://stackoverflow.com/questions/2481946/wpf-4-what-happened-to-datagridcolumnheader\">http://stackoverflow.com/questions/2481946/wpf-4-what-happened-to-datagridcolumnheader</a></p>\n\n<p>It appears I can use DataGridHeaderBorder in a UserControl, stand-alone in a ResourceDictionary, but not in a Style's setter of a Template.</p>\n\n<pre><code>&lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n                    &gt;\n\n    &lt;!-- Works --&gt;\n    &lt;DataTemplate x:Key=\"yomama\"&gt;\n        &lt;DataGridColumnHeader /&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;!-- Compile Error: error MC3074: The tag 'DataGridHeaderBorder' does not exist in XML namespace 'http://schemas.microsoft.com/winfx/2006/xaml/presentation'. --&gt;\n    &lt;Style x:Key=\"{x:Type DataGridRowHeader}\"\n        TargetType=\"{x:Type DataGridRowHeader}\"&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type DataGridRowHeader}\"&gt;\n                    &lt;Grid&gt;\n                        &lt;DataGridHeaderBorder&gt;&lt;/DataGridHeaderBorder&gt;\n                    &lt;/Grid&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>I can get it to work if I use xmlns:dg=\"http://schemas.microsoft.com/wpf/2008/toolkit\", even though I'm not referencing WPFToolkit in the project.  I've verified I'm set to .NET4 and referencing PresentationFramework v4.</p>\n\n<p>Thanks for helping me remove the dg: hack.</p>\n"},{"tags":["c#","wpf","udp","vlc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13217636,"title":"TrickPlay in VLC","body":"<p>I have used vlc.Dotnet example ( <a href=\"http://vlcdotnet.codeplex.com/\" rel=\"nofollow\">http://vlcdotnet.codeplex.com/</a> ) to play UDP streams in my WPF project. Sample is working fine but I want to implement trick play options also (fast forward/play backward). if someone has done it or have a working sample, please reply. </p>\n"},{"tags":["c#","wpf","animation","storyboard"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13217094,"title":"How to set Storyboard.TargetProperty in C#?","body":"<p>I am developing wpf application in C#. The following xaml code is working fine for me.</p>\n\n<pre><code>&lt;VisualStateManager.VisualStateGroups&gt;\n    &lt;VisualStateGroup x:Name=\"VisualStateGroup\"&gt;\n        &lt;VisualState x:Name=\"DefaultVisualState\"&gt;\n            &lt;Storyboard/&gt;\n        &lt;/VisualState&gt;\n        &lt;VisualState x:Name=\"FocusVisualState\"&gt;\n            &lt;Storyboard&gt;\n                &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\" Storyboard.TargetName=\"CircleEllipse1\"&gt;\n                    &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FF0004FF\"/&gt;\n                &lt;/ColorAnimationUsingKeyFrames&gt;\n                &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(TextElement.Background).(SolidColorBrush.Color)\" Storyboard.TargetName=\"TextBlock1\"&gt;\n                    &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FFBCB0B0\"/&gt;\n                &lt;/ColorAnimationUsingKeyFrames&gt;\n            &lt;/Storyboard&gt;\n        &lt;/VisualState&gt;\n    &lt;/VisualStateGroup&gt;\n&lt;/VisualStateManager.VisualStateGroups&gt;\n</code></pre>\n\n<p>The same code I have written in C#</p>\n\n<pre><code>EasingColorKeyFrame easingColorKeyFrameObj = new EasingColorKeyFrame();\neasingColorKeyFrameObj.KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(1));\neasingColorKeyFrameObj.Value = Colors.Red;\nColorAnimationUsingKeyFrames colorAnimationUsingKeyFramesObj = new ColorAnimationUsingKeyFrames();\ncolorAnimationUsingKeyFramesObj.KeyFrames.Add(easingColorKeyFrameObj);\nStoryboard.SetTargetName(colorAnimationUsingKeyFramesObj, \"CircleEllipse1\");\nStoryboard.SetTargetProperty(\n    colorAnimationUsingKeyFramesObj, new PropertyPath(\"Color\"));\n\nStoryboard myStoryboard = new Storyboard();\nmyStoryboard.Children.Add(colorAnimationUsingKeyFramesObj);\n\nmyStoryboard.Begin(this, true);\n</code></pre>\n\n<p>In the above code how should I set the <code>Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\"</code> and <code>Storyboard.TargetProperty=\"(TextElement.Background).(SolidColorBrush.Color)\"</code> in C#</p>\n"},{"tags":["wpf","winforms","exception","activex","unhandled-exception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13217250,"title":"\"XamlParsException Was Unhandled\" when use activex in wpf","body":"<p>I wrote  wpf application with browser.In Activex ,I set serialport.open() then EnableDTR=true. I know for implement activex  in wpf , must use from WindowsFormsHost class and I used. I want to in login page that is start page , when click on button ,the serialport is opened and EnableDTR is true!! but when program is running, that show XamlParsException was Unhandled!!!!</p>\n\n<p>LoginPage.xaml</p>\n\n<pre><code> public partial class LoginPage : Page\n    {\n        AXCONTROL.UserControl1 _browser;\n        public LoginPage()\n        {\n            InitializeComponent();\n            WindowsFormsHost host = new WindowsFormsHost();\n            _browser = new AXCONTROL.UserControl1();\n            host.Child = _browser;\n            this._Grid.Children.Add(host );\n            this.BtnLogin.Click += new RoutedEventHandler(_btnlogin);\n        }\n        void _btnlogin(object sender, RoutedEventArgs e)\n        {\n            serialPort1.Open();\n            serialPort1.DtrEnable = true;\n        }\n}\n</code></pre>\n\n<p>XMLParsException was Unhandel</p>\n\n<pre><code>'The invocation of the constructor on type 'Parking_Project.LoginPage' that matches the specified binding constraints threw an exception.' Line number '5' and line position '7'.\n</code></pre>\n"},{"tags":["wpf","animation","graphics"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12393908,"title":"generating animated line","body":"<p>(x,y) =(10,20),(50,30),(20,20),(40,22),(45,20),(50,35),.........</p>\n\n<p>I want to create an animation with .Net.Normally I am using windows form. But if needed, i can use WPF.</p>\n\n<p>It starts with (10,20) point.Actually a line starts from (10,20) then goes to (50,30) point with 10ms delay. then, from (50,30) to (20,20) after 10ms and so on.</p>\n\n<p>This values will be read from a text file. I can simply make two ArrayList x&amp;y, to put values from the text file.I just Have to know how could i generate the animated line from this x,y with 10 ms delay from each node to another?</p>\n\n<p>If my question is difficult to understand, please let me know. I will try to make it easier.</p>\n\n<p>Thanks in Advance.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13215426,"title":"Animating a Line with PointAnimation","body":"<p>I was hoping to animate a <code>Line</code> using <code>PointAnimation</code>, but discovered that the endpoints of the line are not dependency properties, the individual <code>X</code> and <code>Y</code> components are.</p>\n\n<p>Would it be possible to subclass <code>Line</code>, adding dependency properties for the endpoints (e.g. <code>P1</code>, <code>P2</code>) and then animate instances of this class with <code>PointAnimation</code>?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13216890,"title":"WPF event that triggers after the mouse stops moving","body":"<p>I am writing a WPF application.\nI want to trigger an event once the mouse stops moving.</p>\n\n<p>This is how I tried to do it. I created a timer which counts down to 5 seconds. This timer is \"reset\" every time the mouse moves.\nThis idea is that the moment the mouse stops moving, the timer stops being reset, and counts down from 5 to zero, and then calls the tick event handler, which displays a message box.</p>\n\n<p>Well, it doesn't work as expected, and it floods me with alert messages. What am I doing wrong?</p>\n\n<pre><code>DispatcherTimer timer;\n\nprivate void Window_MouseMove(object sender, MouseEventArgs e)\n{\n    timer = new DispatcherTimer();\n    timer.Interval = new TimeSpan(0, 0, 5);\n    timer.Tick += new EventHandler(timer_Tick);\n    timer.Start();\n}\n\nvoid timer_Tick(object sender, EventArgs e)\n{\n    MessageBox.Show(\"Mouse stopped moving\");\n}\n</code></pre>\n"},{"tags":["c#","wpf","colors","storyboard"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13216838,"title":"How to change color of Ellipse through storyboard","body":"<p>I am developing wpf application. I am able to change the color of Ellipse through xaml. My xaml code is as follows.</p>\n\n<pre><code>&lt;VisualStateManager.VisualStateGroups&gt;\n    &lt;VisualStateGroup x:Name=\"VisualStateGroup\"&gt;\n        &lt;VisualState x:Name=\"DefaultVisualState\"&gt;\n            &lt;Storyboard/&gt;\n        &lt;/VisualState&gt;\n        &lt;VisualState x:Name=\"FocusVisualState\"&gt;\n            &lt;Storyboard&gt;\n                &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\" Storyboard.TargetName=\"CircleEllipse1\"&gt;\n                    &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FF0004FF\"/&gt;\n                &lt;/ColorAnimationUsingKeyFrames&gt;\n                &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(TextElement.Background).(SolidColorBrush.Color)\" Storyboard.TargetName=\"TextBlock1\"&gt;\n                    &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FFBCB0B0\"/&gt;\n                &lt;/ColorAnimationUsingKeyFrames&gt;\n            &lt;/Storyboard&gt;\n        &lt;/VisualState&gt;\n    &lt;/VisualStateGroup&gt;\n&lt;/VisualStateManager.VisualStateGroups&gt;\n</code></pre>\n\n<p>Now I want to change color of Ellipse in C# through storyboard. Following is my code</p>\n\n<pre><code>EasingColorKeyFrame easingColorKeyFrameObj = new EasingColorKeyFrame();\neasingColorKeyFrameObj.KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(1));\neasingColorKeyFrameObj.Value = Colors.Red;\nColorAnimationUsingKeyFrames colorAnimationUsingKeyFramesObj = \n                                                  new ColorAnimationUsingKeyFrames();\ncolorAnimationUsingKeyFramesObj.KeyFrames.Add(easingColorKeyFrameObj);\nStoryboard.SetTargetName(colorAnimationUsingKeyFramesObj, \"CircleEllipse1\");\nStoryboard.SetTargetProperty(\n    colorAnimationUsingKeyFramesObj, new PropertyPath(SolidColorBrush.ColorProperty));\nStoryboard myStoryboard = new Storyboard();\nmyStoryboard.Children.Add(colorAnimationUsingKeyFramesObj);\nmyStoryboard.Begin(this, true);\n</code></pre>\n\n<p>Why it is not working? Can you please provide me any code or link through which I can resolve the above issue?</p>\n"},{"tags":["wpf","button"],"answer_count":4,"favorite_count":5,"up_vote_count":16,"down_vote_count":0,"view_count":12065,"score":16,"question_id":432384,"title":"WPF - Create buttons with up and down arrows using standard buttons","body":"<p>I want to create some up and down buttons using the standard button\nbackground but with black arrows.</p>\n\n<p>What is the best way to accomplish this with WPF??</p>\n\n<p>Malcolm</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":54,"score":-2,"question_id":13215043,"title":"Display value of combobox in Datagrid in WPF","body":"<p>I have the following code:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;DataGrid x:Name=\"dgData\" HorizontalAlignment=\"Left\" Margin=\"133,96,0,0\" VerticalAlignment=\"Top\" Height=\"174\" Width=\"156\" AutoGenerateColumns=\"False\" Grid.Column=\"1\"&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridTemplateColumn Header=\"Status\" Width=\"100\"&gt;\n            &lt;DataGridTemplateColumn.CellTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;ComboBox Name=\"Combo1\" Height=\"22\" ItemsSource=\"{Binding SubjectSubList}\" SelectedItem=\"{Binding SubjectSubList}\"/&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/DataGridTemplateColumn.CellTemplate&gt;\n        &lt;/DataGridTemplateColumn&gt;\n    &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Code-behind:</p>\n\n<pre><code>public class TicketInfo\n{           \n    public List&lt;string&gt; SubjectSubList { get; set; }\n}\n\nstatic List&lt;string&gt; resolution = new List&lt;string&gt;();\nstatic List&lt;string&gt; codec = new List&lt;string&gt;();\n\nresolution.Add(\"1\");\nresolution.Add(\"2\");\n\ncodec.Add(\"3\");\ncodec.Add(\"4\");\n\nList&lt;TicketInfo&gt; ticketsList = new List&lt;TicketInfo&gt; \n{\n    new TicketInfo{ SubjectSubList=resolution},\n    new TicketInfo{ SubjectSubList=codec},               \n};\n</code></pre>\n\n<p>I am able to get the objects displayed separately in two different comboboxes, but I have NO idea now I can retrieve the value selected by the user. \"Selecteditem\" is bound, but how do I retrieve the values in code-behind?</p>\n\n<p>Any help is much appreciated.</p>\n"},{"tags":["wpf","xaml","windows-phone"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13141857,"title":"I wanna develop a WPF application with XAML on my desktop and then convert it as a windows phone application. Can I do that?","body":"<p>I am new to this. But I wanna develop a DESKTOP APPLICATION using WPF, XAML and then convert it into a windows phone application. But i dont have a clear idea about it... Can you please help</p>\n"},{"tags":["wpf","button","dialog"],"answer_count":12,"favorite_count":20,"up_vote_count":45,"down_vote_count":0,"view_count":41221,"score":45,"question_id":743906,"title":"How to hide close button in wpf window?","body":"<p>I'm writing a modal dialog in wpf.  How do I set a wpf window to not have a close button?  I'd still like for its WindowState to have a normal title bar.</p>\n\n<p>I found ResizeMode, WindowState, and WindowStyle, but none of those properties allow me to hide the close button but show the title bar, as in modal dialogs.</p>\n"},{"tags":["c#","wpf","winforms","activex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13216388,"title":"how to create activex in wpf?","body":"<p>I want to create activex in wpf application. can I do this work?\nI wrote wpf application for parking company. now i need that use activex in my program but I wrote my activex in windows application. \nPlease help me.</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13151603,"title":"C#/WPF - Get ScrollViewer scroll position?","body":"<p>Okay, so, everyone knows how to set the scroll position of a ScrollViewer. Entire essays and blog entries have been written about <code>ScrollViewer.ScrollToVerticalOffset()</code>, and there are a good few hundred questions with answers about it here.</p>\n\n<p>So, I enter:</p>\n\n<pre><code>myScrollViewer.ScrollToVerticalOffset(280);\n</code></pre>\n\n<p>... and it so kindly scrolls to that location.</p>\n\n<p>The question is, <em>what property now contains 280</em>, so I can retrieve it later?</p>\n\n<p>(Hint: <code>myScrollViewer.VerticalOffset</code> and <code>ContentVerticalOffset</code> are both 0; <code>myScrollViewer.ScrollInfo</code> just plain doesn't exist.)</p>\n\n<p>EDIT: Apparently I need a more detailed demonstration.</p>\n\n<pre><code>private void btnTest_Click(object sender, RoutedEventArgs e) {\n  double scrollTarget = 280;\n  MessageBox.Show(\"Target: \" + scrollTarget.ToString());\n  myScrollViewer.ScrollToVerticalOffset(scrollTarget);\n  MessageBox.Show(\"Now: \" + myScrollViewer.VerticalOffset);\n}\n</code></pre>\n\n<p>I must reiterate that this <strong>does scroll</strong> as intended. Goes right exactly where I want it to. But, <code>myScrollViewer.VerticalOffset</code> is set at 0.</p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":5,"favorite_count":5,"up_vote_count":10,"down_vote_count":1,"view_count":5956,"score":9,"question_id":6145888,"title":"How to bind an enum to a combobox control in WPF?","body":"<p>I am trying to find a simple example where the enums are shown as is. All examples I have seen tries to add nice looking display strings but I don't want that complexity.</p>\n\n<p>Basically I have a class that holds all the properties that I bind, by first setting the DataContext to this class, and then specifying the binding like this in the xaml file:</p>\n\n<pre><code>&lt;ComboBox ItemsSource=\"{Binding Path=EffectStyle}\"/&gt;\n</code></pre>\n\n<p>But this doesn't show the enum values in the <code>ComboBox</code> as items.</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13215746,"title":"Changing style in code, and affecting controls that use it?","body":"<p>This has been discussed a few times on SO already, but none of the suggested solutions seem to be working. I know now that styles are \"frozen\" or \"sealed\" at startup, so if you want to change them, you have to copy them or, in the case of trivial styles, just create them anew.</p>\n\n<p>So, my style changing function looks like this:</p>\n\n<pre><code>private void cmbFontSize_SelectionChanged(object sender, SelectionChangedEventArgs e)\n{\n    double newSize = double.Parse(cmbFontSize.SelectedValue.ToString());\n    double newPad = newSize * 0.5;\n\n    Style newBlockStyle = new Style();\n    newBlockStyle.Setters.Add(new Setter(TextBlock.PaddingProperty, new Thickness(0, newPad, 0, newPad)));\n    newBlockStyle.Setters.Add(new Setter(TextBlock.FontSizeProperty, newSize));\n    newBlockStyle.Setters.Add(new Setter(System.Windows.Controls.Control.FontSizeProperty, newSize));\n\n    System.Windows.Application.Current.Resources[\"BlockStyle\"] = newBlockStyle;\n}\n</code></pre>\n\n<p>And the initial style setup looks like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n  &lt;Style x:Key=\"BlockStyle\" TargetType=\"{x:Type TextBlock}\"&gt;\n    &lt;Setter Property=\"Padding\" Value=\"0,5\" /&gt;\n    &lt;Setter Property=\"FontSize\" Value=\"22\" /&gt;\n  &lt;/Style&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>With the necessary standard lines to merge them into App.xaml. On application load, this gets applied perfectly to my custom class:</p>\n\n<pre><code>public class VerseBlock : TextBlock\n{\n    public VerseBlock() : base() \n    {\n        object style = Application.Current.Resources[\"BlockStyle\"];\n        if (style != null &amp;&amp; style.GetType() == typeof(Style)) \n        {\n            this.Style = (Style)style;\n        }\n    }\n}\n</code></pre>\n\n<p>Note that <code>VerseBlocks</code> are created <em>exclusively</em> in C# code, and have absolutely no XAML to mess with.</p>\n\n<p>Now, I've gotten it to the point that the program doesn't crash when the font size selector is changed. Instead it... just doesn't do anything. I know that the style is being overwritten, because any <em>new</em> <code>VerseBlocks</code> will be whatever size I have selected, but I'm trying to impact all <code>VerseBlocks</code> without having to iterate over each one. So the question is, how can I make that style change retroactive?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10345166/changing-xaml-style-dynamically-in-code-behind-so-that-controls-applying-that-st\">This topic</a> seems to have mostly a solution, except for the fact that it assumes the use of XAML rather than C#.</p>\n"},{"tags":["c#","wpf","windows-8"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13215574,"title":"How can I clear a TextBox?","body":"<p>I have a pretty decent background in Java and C++, but I'm struggling to do something trivial in C#. I have two <code>TextBoxes</code>: <code>MessageBox</code> and <code>SenderBox</code>. I want to send the text from <code>SenderBox</code> to <code>MessageBox</code> (which is easy), but I want to clear <code>SenderBox</code> once that is done. The following is basically the code that is fired when you press Enter to send the text:</p>\n\n<pre><code>string temp = SenderBox.Text;\nSenderBox.Text = \"cleared\";\nMessageBox.Text = temp;\n</code></pre>\n\n<p>Most programming languages are somewhat procedural or at least execute in some orderly way. Why does C#/WPF for Windows 8 apps seem to defy this standard? You would expect temp to be set equal to the <em>value</em> of <code>SenderBox</code>, first of all. If you look at the code, <code>temp</code> <strong>should not</strong> equal \"cleared\" unless that's what <code>SenderBox</code> contains. At that point (line 1), it doesn't. I tried to create a <code>send(msg)</code> function to dereference the weird string, but that didn't change a thing. The following code runs as expected:</p>\n\n<pre><code>string x = \"abc\";\nstring y = x;\ny = \"123\";\nMessageBox.Text = x;\n</code></pre>\n\n<p>Can someone enlighten me? Not sure what's going on here.</p>\n"},{"tags":["wpf","visual-studio-2012",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13214579,"title":"XAML exception on DockPanel's border brush?","body":"<p>'Provide value on 'System.Windows.Baml2006.TypeConverterMarkupExtension' threw an exception.' Line number '12' and line position '18'.</p>\n\n<pre><code>&lt;Window x:Class=\"Gasoline.Style.BaseWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"BaseWindow\" Height=\"300\" Width=\"300\" ResizeMode=\"NoResize\" WindowStyle=\"None\" BorderBrush=\"Black\"&gt;\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"26\"/&gt;\n            &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;DockPanel LastChildFill=\"False\" Height=\"26\"&gt;\n            &lt;DockPanel.Background&gt;\n                &lt;ImageBrush ImageSource=\"/Resources/FrameTitle.png\"/&gt;\n            &lt;/DockPanel.Background&gt;\n\n\n        &lt;/DockPanel&gt;\n\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>And the line in cause is:  </p>\n\n<pre><code>&lt;ImageBrush ImageSource=\"/Resources/FrameTitle.png\"/&gt;\n</code></pre>\n\n<p>What am I doing wrong here?<br>\nAs soon as I give the brush an image source (even through the properties window, which creates a different value), it throws that error when I start up the application.<br>\nThe designer works fine.</p>\n"},{"tags":[".net","wpf","listview","listbox","wpf-controls"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1251,"score":3,"question_id":4704009,"title":"Gaps between items in my ListBox","body":"<p>When I create <code>ListBox</code> with horizontal items ordering for example like this:</p>\n\n<pre><code>&lt;DockPanel&gt;\n    &lt;ListBox&gt;\n        &lt;ListBox.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;VirtualizingStackPanel Orientation=\"Horizontal\" /&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListBox.ItemsPanel&gt;\n        &lt;ListBoxItem&gt;\n            &lt;Button Content=\"Hello\" /&gt;\n        &lt;/ListBoxItem&gt;\n        &lt;ListBoxItem&gt;\n            &lt;Button Content=\"Hello\" /&gt;\n        &lt;/ListBoxItem&gt;\n    &lt;/ListBox&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p>I have small gaps between buttons in the list as indicated by the arrows on following picture:</p>\n\n<p><img src=\"http://i.stack.imgur.com/9vO81.jpg\" alt=\"Picture showing gaps\"></p>\n\n<p>How can I get rid of those gaps please ? I need to have items in <code>ListBox</code> just next to each other. I have tried changing <code>ItemTemplate</code> of the <code>ListBox</code> but it did not help.</p>\n"},{"tags":["wpf","winforms","powershell","mmc","mmc3"],"answer_count":6,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":2119,"score":12,"question_id":473306,"title":"Benefits of developing MMC snap-ins instead of traditional GUI apps","body":"<p>What are the benefits of developing MMC snap-ins instead of traditional GUI apps? AFAIK the MMC snap-ins can be loaded remotely to control some server applications but I have never dived deep in this approach. What are the pros and cons of MMC snap-in approach over traditional Win Forms (or WPF) GUI applications?</p>\n\n<p>And btw lately PowerShell is getting a lot of attention and again AFAIK there are some relation between MMC snap-ins and PowerShell script but I don't know any further. Any ideas?</p>\n"},{"tags":["c#","wpf","xml","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13214055,"title":"Bind XML to Datagrid Programmatically","body":"<p>I've found many examples of how to do this through XAML, but I can't seem to find any help on how to do this through C#. The reason that I want it to be done via C# is that I want he columns (and thus bindings) to be created dynamically based on definitions set in the XML.</p>\n\n<p><a href=\"http://miteshsureja.blogspot.com/2011/11/binding-wpf-datagrid-with-xml-file.html\" rel=\"nofollow\">A good blog post on how to do it via XAML.</a></p>\n\n<p>I have currently the following:</p>\n\n<pre><code>//Return the XML document as an XElement\nXElement selectedSheet = GetSelectedSheet();\n\ndgrdXML.Columns.Clear();\n\n//GetColumnNames returns the columns names as expected.\nforeach (string column in selectedSheet.GetColumnNames())\n{\n    DataGridTextColumn dataGridColumn = new DataGridTextColumn();\n    dataGridColumn.Binding = new Binding(column);\n    dataGridColumn.Header = column;          \n    dgrdXML.Columns.Add(dataGridColumn);\n}\n\ndgrdXML.DataContext = selectedSheet.GetParentElement(); //Selects portion of XML that I wish to bind to.\n\ndgrdXML.Items.Refresh();\n</code></pre>\n\n<p>It works just fine for setting up column names, but it doesn't actually bind anything.</p>\n\n<p>Given the XML document (which is assigned to \"selectedSheet\"):</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Library&gt;\n    &lt;Definitions&gt;\n        &lt;ParentNode value=\"Parent\"/&gt;\n        &lt;ChildNode value=\"Child\"/&gt;\n        &lt;Attributes&gt;\n            &lt;Attribute name=\"A\"/&gt;\n            &lt;Attribute name=\"B\"/&gt;\n            &lt;Attribute name=\"C\"/&gt;\n        &lt;/Attributes&gt;\n    &lt;/Definitions&gt;\n    &lt;Parent&gt;\n        &lt;Child A=\"foo\" B=\"foofoo\" C=\"foobar\"/&gt;\n        &lt;Child A=\"bar\" B=\"barbar\" C=\"foobar\"/&gt;\n    &lt;/Parent&gt;\n&lt;/Library&gt;\n</code></pre>\n\n<p>It creates columns A, B, and C in the datagrid--as it should.</p>\n\n<p>Further, dtgrdXML.DataContext has the value upon ending the posted code:</p>\n\n<pre><code>{&lt;Parent&gt;\n  &lt;Child A=\"foo\" B=\"foofoo\" C=\"foobar\" /&gt;\n  &lt;Child A=\"bar\" B=\"barbar\" C=\"foobar\" /&gt;\n&lt;/Parent&gt;}\n</code></pre>\n\n<p>(As seen via the Text Visualizer in Visual Studio)</p>\n\n<p>Based on the XAML examples that I've found it <em>seems</em> like I've done this correctly in C#, but the data doesn't actually appear in the datagrid. What am I doing wrong? How can I fix it?</p>\n"},{"tags":["c#","wpf","visual-studio-2010","sql-server-ce"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":882,"score":2,"question_id":5661190,"title":"Cannot find SQLCE 4.0 in Data Source","body":"<p>I have both SQLCE 3.5 and 4.0 installed. In VS2010 WPF, when I add new connection and want to create a database with SQLCE 4.0, I only see Microsoft SQL Server Compact 3.5, but not 4.0.\nWhy?</p>\n\n<p>This is a WPF desktop application, not a Web Project.</p>\n"},{"tags":["wpf","xaml","resourcedictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13210352,"title":"WPF UserControl Resources","body":"<p>I made a ResourceDictionary in a WPF User Control Assembly.\nWant to be able to use this across this UserControl and have all the styles in this separated file. (This is a UserControl Assembly and not the main assembly)</p>\n\n<p><em>I think it should be a simple question.</em></p>\n\n<p><strong>The ResourceDictionary :</strong></p>\n\n<pre><code>&lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;    \n    &lt;Style x:Key=\"c1BtnX1\"&gt;\n        &lt;Setter Property=\"Background\" Value=\"Bisque\"&gt;&lt;/Setter&gt;\n    &lt;/Style&gt;    \n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p><strong>It's Address is :</strong></p>\n\n<p>The User Control Assembly Resources/mainResX.xaml\nand the View is in the same assembly/Views/view.xaml</p>\n\n<p>The usage I think could be :</p>\n\n<pre><code>        &lt;Border Style=\"{StaticResource ResourceKey=c1BtnX1}\" BorderBrush=\"Black\"  Width=\"20\" Height=\"20\"&gt;\n            &lt;TextBlock Text=\"X\" /&gt;\n        &lt;/Border&gt;\n</code></pre>\n\n<p>Also I tried the below code inside the UserControl, to define Per Control Resources but this way also seems it couldn't find the resources.</p>\n\n<pre><code> &lt;UserControl ... &gt;\n    &lt;UserControl.Resources&gt;\n        &lt;ResourceDictionary Source=\"../Resources/mainResX.xaml\" /&gt;            \n    &lt;/UserControl.Resources&gt;\n</code></pre>\n\n<p>Where and How should I place/Define this ?</p>\n"},{"tags":["wpf","animation","usercontrols","triggers","styles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13210907,"title":"Collapse Visibility of WPF UserControl after Opacity Animation completed","body":"<p>I have a UserControl where I am animating it's Opacity property. Now I want to set the control's Visibility to 'Collapsed' once the Opacity is reduced to '0'.\nFollowing is the style I have added to the UserControl:</p>\n\n<pre><code>&lt;UserControl.Style&gt;\n    &lt;Style TargetType=\"{x:Type UserControl}\"&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"Opacity\" Value=\"0\"&gt;\n                &lt;Setter Property=\"Visibility\" Value=\"Collapsed\" /&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/UserControl.Style&gt;\n</code></pre>\n\n<p>However the trigger is not firing when the when opacity is 0. Please guide appropriately.</p>\n\n<p>Upon request, I have added some more code as follows:\nNote:The UserControl is actually meant to behave as a BusyIndicator.</p>\n\n<pre><code>&lt;UserControl x:Class=\"BusyIndicatorDemo.BusyIndicator\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         Name=\"BusyIndicatorUC\"\n         mc:Ignorable=\"d\"&gt;\n&lt;UserControl.Style&gt;\n    &lt;Style TargetType=\"{x:Type UserControl}\"&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"Opacity\" Value=\"0\"&gt;\n                &lt;Setter Property=\"Visibility\" Value=\"Collapsed\" /&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/UserControl.Style&gt;\n&lt;UserControl.Resources&gt;\n    &lt;Storyboard x:Key=\"storyboard\"&gt;\n        &lt;DoubleAnimation Storyboard.TargetProperty=\"(Image.RenderTransform).(RotateTransform.Angle)\" From=\"0\" To=\"360\" Duration=\"0:0:5\" RepeatBehavior=\"Forever\" /&gt;\n    &lt;/Storyboard&gt;\n    &lt;Storyboard x:Key=\"fadeIn\"&gt;\n        &lt;DoubleAnimation Storyboard.TargetProperty=\"Opacity\" From=\"0\" To=\"1\" Duration=\"0:0:1\" /&gt;\n    &lt;/Storyboard&gt;\n    &lt;Storyboard x:Key=\"fadeOut\"&gt;\n        &lt;DoubleAnimation Storyboard.TargetProperty=\"Opacity\" From=\"1\" To=\"0\" Duration=\"0:0:1\" /&gt;\n    &lt;/Storyboard&gt;\n    &lt;Storyboard x:Key=\"dotsStorboard\"&gt;\n        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"dotsTextBlock\" Storyboard.TargetProperty=\"Text\" Duration=\"00:00:01.2\" RepeatBehavior=\"Forever\"&gt;\n            &lt;DiscreteObjectKeyFrame KeyTime=\"00:00:00.0\" Value=\"\" /&gt;\n            &lt;DiscreteObjectKeyFrame KeyTime=\"00:00:00.3\" Value=\".\" /&gt;\n            &lt;DiscreteObjectKeyFrame KeyTime=\"00:00:00.6\" Value=\". .\" /&gt;\n            &lt;DiscreteObjectKeyFrame KeyTime=\"00:00:00.9\" Value=\". . .\" /&gt;\n        &lt;/ObjectAnimationUsingKeyFrames&gt;\n    &lt;/Storyboard&gt;\n\n    &lt;Style x:Key=\"Spinner\" TargetType=\"Image\"&gt;\n        &lt;Setter Property=\"IsEnabled\" Value=\"{Binding ElementName=BusyIndicatorUC, Path=IsBusy, UpdateSourceTrigger=PropertyChanged}\" /&gt;\n        &lt;Setter Property=\"Image.RenderTransform\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;RotateTransform Angle=\"0\" /&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n&lt;/UserControl.Resources&gt;\n\n&lt;Grid Name=\"RootGrid\"&gt;\n    &lt;Rectangle Opacity=\"0.3\" RadiusX=\"10\" RadiusY=\"10\" Margin=\"0\"&gt;\n        &lt;Rectangle.Fill&gt;\n            &lt;RadialGradientBrush&gt;\n                &lt;GradientStop Color=\"#FF6C6C6C\" Offset=\"1\"/&gt;\n                &lt;GradientStop Color=\"White\"/&gt;\n                &lt;GradientStop Color=\"#FFADADAD\" Offset=\"0.545\"/&gt;\n                &lt;GradientStop Color=\"#FF818181\" Offset=\"0.818\"/&gt;\n            &lt;/RadialGradientBrush&gt;\n        &lt;/Rectangle.Fill&gt;\n    &lt;/Rectangle&gt;\n    &lt;Grid Name=\"busyIndicatorHolder\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n        &lt;Rectangle Fill=\"Black\" Opacity=\"1\" RadiusX=\"10\" RadiusY=\"10\" Height=\"25\" Margin=\"15,0,10,0\"&gt;\n            &lt;Rectangle.Effect&gt;\n                &lt;DropShadowEffect Color=\"Black\" ShadowDepth=\"0\" BlurRadius=\"25\"/&gt;\n            &lt;/Rectangle.Effect&gt;\n        &lt;/Rectangle&gt;\n        &lt;StackPanel Orientation=\"Horizontal\" Name=\"ContentSP\" Margin=\"5\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n            &lt;Image Name=\"logo\" Margin=\"2\" RenderTransformOrigin=\"0.5,0.5\" Source=\"E:\\Images\\clip_icon.png\" RenderOptions.BitmapScalingMode=\"HighQuality\" Height=\"45\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Style=\"{StaticResource Spinner}\" /&gt;\n            &lt;TextBlock Name=\"busyIndicatorTextBlock\" Margin=\"5,0,0,0\" Padding=\"0,0,5,0\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Foreground=\"White\" /&gt;\n            &lt;TextBlock Name=\"dotsTextBlock\" Margin=\"0,0,20,0\" Width=\"17\" Visibility=\"Collapsed\" Text=\". . .\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Foreground=\"White\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/Grid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>The 'fadeIn' and 'fadeOut' storyboard animations are played from the code-behind. So these opacity animations work perfect except that the Style Opacity Trigger won't fire.\nHope the additional provided info is sufficient.</p>\n"},{"tags":["wpf","prism","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13211443,"title":"What does Microsoft.Practices.ServiceLocation.ServiceLocator do?","body":"<p>I know this sounds lame, but MSDN seems to have a bunch of empty information on it. Like this link <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.practices.servicelocation.servicelocator%28v=pandp.51%29.aspx\" rel=\"nofollow\">ServiceLocator</a>. I just rolled onto a project with Unity and Prism. I have found it in some code where a WPF UserControl is passed in like this</p>\n\n<pre><code>var alert = ServiceLocator.Current.GetInstance&lt;AlertControl&gt;();\n</code></pre>\n\n<p>Is this like Unity's resolve?</p>\n"},{"tags":["wpf","binding","itemscontrol","gridsplitter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":13002365,"title":"How to insert a GridSplitter row between each item in a bound dynamic collection","body":"<p>I have a one column grid, with rows of varying heights in a WPF application. The items in the grid are dynamically generated, and will be added and removed at run-time.</p>\n\n<p>For each row that is added, I would like a GridSplitter row to be inserted between each element.</p>\n\n<p>I currently bind the model data via an ItemControl, and use AttachedProperties to obtain the element row count (obviously the eventual solution will have a higher number of rows to include the GridSplitters):</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding MyModel}\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;Grid local:GridHelpers.RowCount=\"{Binding MyModel.RowCount}\" local:GridHelpers.ColumnCount=\"1\"/&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>The MyModel variable is an ObservableCollection which contains ViewModel objects. The RowCount is a member variable which returns the number of elements in the collection.</p>\n\n<p>How can I insert a GridSplitter between each of the rows?</p>\n\n<p>I would like each element and GridSplitter to be generated from a template. However, if the GridSplitter is contained within a template, it doesn't work due to the presence of a ContentPresenter as its parent rather than a Grid. I'm running out of ideas, apart from creating my own UI element which has its own splitter component written from scratch. There must be an other way surely!</p>\n\n<p>Many thanks for your help.</p>\n"},{"tags":["wpf","adorner","visual-tree","adornerlayer","adornerdecorator"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13209695,"title":"Why AdornerLayers are always the top most layers? Is there a way to change it?","body":"<ol>\n<li>Why is that the adorner layer is always rendered as the top most layer in an application (under AdornerDecorator - refer screenshot)? </li>\n<li>Is there a way to change the layer/level on to which the adorners can be drawn? </li>\n</ol>\n\n<p>In the following screenshot, AdornerLayer is added to AdornerDecorator and the Adorners (MyAdorners) are added to this AdornerLayer. But the AdornerLayer is retrieved like this, </p>\n\n<pre><code>        AdornerLayer layer1 = AdornerLayer.GetAdornerLayer(button1);\n        layer1.Add(new MyAdorner(button1));\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ey34U.png\" alt=\"AdornerLayer - Outline\"></p>\n"},{"tags":["wpf","javafx-2","javafx"],"answer_count":3,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":3465,"score":9,"question_id":2016470,"title":"How does JavaFX compare to WPF?","body":"<p>I'm mostly a C# programmer, I stopped writing Java about 10 years ago, but I try to keep up with the technology in Java by reading articles, talking with friends, etc.</p>\n\n<p>I've heard about the new rich GUI framework called JavaFX, but couldn't find any resource comparing it with non-Java parallels.</p>\n\n<p>Since I'm very familiar with C# and WPF, I'd like to get a feel about how similar or different the two technologies are.</p>\n\n<p>EDIT: Seeing as there's no answers coming, I'll try to be more specific:</p>\n\n<ol>\n<li>WPF uses XAML to create the visual tree, does JavaFX have something similar?</li>\n<li>WPF is best used with binding to a view model in an MVVM pattern, does JavaFX also make extensive use of binding?</li>\n<li>WPF utilizes the GPU for rendering, does JavaFX do the same?</li>\n<li>How does Silverlight compare to JavaFX when run through a browser on a net pc?</li>\n</ol>\n\n<p>... More to come...</p>\n\n<p>I'm changing this to community wiki so that the comparisons can keep getting updated (hopefully).</p>\n"},{"tags":["c#","wpf","dialog","window","modal-dialog"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13209526,"title":"Main window disappears behind other application's windows after a sub window uses ShowDialog on a third window","body":"<p>I have noticed this very odd behavior in a WPF application.</p>\n\n<p>I have a <code>MainWindow</code>, which is shown using <code>Show()</code> from <code>App.OnStartup</code>. Said <code>MainWindow</code> can open a (non-modal) <code>SubWindow</code>, also using <code>Show()</code>. <code>SubWindow</code>'s <code>Owner</code> is set to <code>MainWindow</code>.</p>\n\n<p>When <code>SubWindow</code> is closed, <code>MainWindow</code> is visible again (good).</p>\n\n<p>Some actions can cause the <code>SubWindow</code> to open a third window as a modal dialog, using <code>ShowDialog()</code> (<code>Owner</code> is set to <code>SubWindow</code>). When that modal dialog is opened and closed at least once during the lifetime of a <code>SubWindow</code>, then the weird thing happens.</p>\n\n<p>After closing <code>SubWindow</code>, <code>MainWindow</code> does not come into view. Instead, whatever random window is <em>behind</em> <code>MainWindow</code> comes into view. Can anyone explain to me why this happens, and how to fix it?</p>\n\n<p>It makes no difference whether the modal dialog is a normal <code>Window</code> displayed using <code>ShowDialog()</code>, or a message box shown using <code>MessageBox.Show()</code>.</p>\n\n<hr>\n\n<p>Here is some <em>minimal</em> code to reproduce this. Create a new WPF application in visual studio, and paste this into the pre-generated MainWindow.xaml.cs</p>\n\n<p>Then, press a key on the keyboard to open only one window, close it, behavior as expected. Press two keys, close both, then the very first window is behind Visual Studio (presumably).</p>\n\n<pre><code>public MainWindow()\n{\n    InitializeComponent();\n    this.PreviewKeyDown += (sender, e) =&gt;\n    {\n        if (this.Owner is MainWindow)\n        {\n            // we're the SubWindow\n\n            MessageBox.Show(\"I am a modal dialog\");\n\n            // code below produces the exact same behavior as the message box\n\n            //var dialog = new MainWindow();\n            //dialog.Owner = this;\n            //dialog.ShowDialog();\n        }\n        else\n        {\n            // we're the initial MainWindow created by App.\n            var subWindow = new MainWindow();\n            subWindow.Owner = this;\n            subWindow.Show();\n        }\n    };\n}\n</code></pre>\n"},{"tags":["wpf","data-binding","datatrigger","xceed-datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":532,"score":-1,"question_id":8598356,"title":"WPF Xceed datagrid - datatrigger on cell's content makes me lose data on load...however re","body":"<p>I am using the <a href=\"http://en.wikipedia.org/wiki/Xceed\" rel=\"nofollow\">Xceed</a> datagrid for WPF. Today I was trying to change the background of the whole row if one of its column \"SA\" has the some value or not null. I wrote the following piece of code in <a href=\"http://en.wikipedia.org/wiki/Extensible_Application_Markup_Language\" rel=\"nofollow\">XAML</a> with a converter function in code behind:</p>\n\n<pre><code>&lt;xcdg:DataGridControl.Resources&gt;\n    &lt;Style TargetType=\"{x:Type xcdg:DataRow}\"&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding RelativeSource={RelativeSource Self}, Converter={StaticResource newConverter}, Path=Cells[SA].Content}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Background\" Value=\"LightGreen\" /&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/xcdg:DataGridControl.Resources&gt;\n</code></pre>\n\n<p>To my surprise, as soon as I load the grid for the first time, the data in the SA column is nowhere to be seen. However, once I scroll down a bit, till the point that row which is supposed to have data for the column is not visible, and then when I scroll up again to see that row, I can see the value in that column as well as the background changed. </p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["wpf","multithreading","user-interface"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":122,"score":0,"question_id":7272683,"title":"Updating UI when XML changes","body":"<p>I have a UI in a window, which is bound to an XML file. I need to update the UI whenever I manually go and change my XML file.</p>\n\n<p>Following is the <a href=\"http://whatis.techtarget.com/fileformat/WAML-XPlore-Web-Application-Markup-Language-Alfega-Technologies-Inc\" rel=\"nofollow\">WAML</a> file:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfApplication1.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;XmlDataProvider x:Key=\"dataSource\" Source=\"Data/Media.xml\"&gt;\n        &lt;/XmlDataProvider&gt;\n    &lt;/Window.Resources&gt;\n    &lt;Grid&gt;\n        &lt;ListBox Name=\"listBox1\" DataContext=\"{Binding Source={StaticResource dataSource}, XPath=/Media/Book/@Title, Mode=OneWay}\" /&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The following is the XML file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;Media&gt;\n    &lt;Book Author='John' Title='Fish are my aaaa friends' /&gt;\n    &lt;Book Author='Dave' Title='Fish are my enemies' /&gt;\n    &lt;Book Author='Jane' Title='Fish are my food' /&gt;\n&lt;/Media&gt; \n</code></pre>\n\n<p>I have a window object in the service layer. To initialise it, I did the following: </p>\n\n<p><code>winobj.DataContext = node.OuterXml; winobj.Show();</code> where <code>node</code> is my XML string which I get from the server. If I ask you to update this winobj or reset its datacontext so that the UI is updated, how will you do it?</p>\n\n<p>My UI is bound in the following way.</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;XmlDataProvider x:Key=\"Data\" XPath=\"//WindowUpdate\" /&gt;\n&lt;/Window.Resources&gt;\n&lt;Label Content=\"{Binding Source={StaticResource Data},\n       XPath=Window/Children/Label[@id\\=\\'lblInterval\\']/@text}\" ...\n</code></pre>\n"},{"tags":["c#","wpf","kinect","picking","nui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13208877,"title":"Picking a framework element with Kinect (Like Ellipse or Rectangle)","body":"<p>I (literally) want to catch a framework element using NUI of Kinect. Assuming that I have an ellipse on my Grid (or Canvas), I should be able to pick an ellipse using my program.</p>\n\n<p>In order to do this, I thought that I have to determine the exact position of the element, like <code>Transform.Position</code> in Unity, but I couldn't find such a thing in WPF.</p>\n\n<p>Here is my XAML code, </p>\n\n<pre><code>&lt;Grid VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\"&gt;\n    &lt;my:KinectSensorChooser HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" Name=\"kinectSensorChooser1\" /&gt;\n    &lt;my:KinectColorViewer Stretch=\"Fill\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"  Name=\"kinectColorViewer1\" Kinect=\"{Binding Path=Kinect, ElementName=kinectSensorChooser1}\" /&gt;\n    &lt;Ellipse Height=\"114\"  Name=\"ellipse1\" Stroke=\"Black\" Fill=\"Black\" VerticalAlignment=\"Top\" Width=\"120\" /&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>So my question is about finding the that  element on the Grid. Having a Cursor or any element that represents the user's hand is not a problem. But after that, I'll have to detect the collision between my cursor and these elements and that the part that troubles me. An event like ElementHover or ElementPicked would also help but i guess i'm gonna have to write something like that myself.</p>\n\n<p>By the way, it's about an \"Engineering Education Software\" project that aims to develop virtual environments for engineering exercises like expensive or dangerous experiments.</p>\n"},{"tags":[".net","wpf","vb.net","exception-handling","dependency-properties"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13206673,"title":"Dependency property value not assigned while setting value through Styles using dynamic resource","body":"<pre><code>Public Class UITreeview\n    Inherits System.Windows.Controls.TreeView\n\nPublic Shared ExpandAllproperty As DependencyProperty\nShared Sub New()\n        DefaultStyleKeyProperty.OverrideMetadata(GetType(UITreeview), New FrameworkPropertyMetadata(GetType(UITreeview)))\n        UITreeview.ExpandAllproperty = UITreeViewItem.IsExpandedProperty.AddOwner(GetType(UITreeview), New FrameworkPropertyMetadata(True, FrameworkPropertyMetadataOptions.Inherits))\n    End Sub\nPublic Property ExpandAll As Boolean\n        Get\n            Return Me.GetValue(ExpandAllproperty)\n        End Get\n        Set(value As Boolean)\n            Me.SetValue(ExpandAllproperty, value)\n        End Set\n    End Property \n....\nEnd Class\n</code></pre>\n\n<p>i have created my own dependency property,which i set using style</p>\n\n<pre><code>&lt;Style  TargetType=\"{x:Type UINat:UITreeview}\"&gt;\n    &lt;Setter Property=\"ExpandAll\" Value=\"False\" /&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>but unfortunately I'm getting an error:</p>\n\n<blockquote>\n  <p>System.ArgumentNullException: Value cannot be null. Parameter name: property.</p>\n</blockquote>\n\n<p>My objective is to control TreeviewItem.IsExpanded property from Resource XAML.</p>\n"},{"tags":[".net","wpf","validation","mvvm"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13209959,"title":"WPF how to filter data-binded element? MVVM related","body":"<p>I've got a textbox and it's Text property bound to a string(in the view model)</p>\n\n<p>Question: How do I make it so whatever is written in that textbox is exactly 10 characters long (or only in English letters, just an example).</p>\n\n<p>Problem is it is directly written to the viewModel's string variable. So my only idea is having a converter for this. But even if the converter returns nothing, how do I inform the user that something's wrong? (\"error - length != 10\" as an example)</p>\n"},{"tags":["wpf","vb.net",".net-4.0",".net-3.5","vb.net-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13210484,"title":".Net Framework 3.5 not showing image from webbrowser navigate","body":"<p>After hours of searching I am stumped on this problem, so I hope someone could help me out? So my program is a VERY simple concept. It's a WPF written in vb.net that uses a frame to call a page that shows a webpage image from a web browser. Now the kicker is that there is code behind the .xaml that directs the web browser to open a new browser if a link is clicked and hides the frame after 10 seconds. I got the code from here in C# and translated in in vb. </p>\n\n<p>So this program works great and is written in .Net Framework 4.0. However I had another program that I wanted to integrate this code into, which is written in .Net Framework 3.5 which will not show the same output as the program that was written in .Net Framework 4.0. Frustrated I wrote two examples of this program, zipped them and uploaded them so you may download them in order to assist me. </p>\n\n<p><a href=\"http://simpletechss.com/1stAidApp4.zip\" rel=\"nofollow\">http://simpletechss.com/1stAidApp4.zip</a> (shows 007 image from webbpage then hides after 10 seconds.)</p>\n\n<p><a href=\"http://simpletechss.com/1stAidApp35.zip\" rel=\"nofollow\">http://simpletechss.com/1stAidApp35.zip</a> (does not show 007 image from webbpage, then hides after 10 seconds.) \nvb\nSo again I am wondering why i cannot show the 007 image from webbpage in a WPF using .Net 3.5 but can in .Net 4.0? Where the code is the same in both programs and their are no syntax errors.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","wpf","wav","directsound","sharpdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13205647,"title":"How can I play a .wav file using SharpDX DirectSound in a C# WPF project?","body":"<p>I want to be able to precisely control the timing of .wav files played in my program. I also want to be able to play more than one .wav file at the same time. The SoundPlayer was not good enough because I can't play two sounds at once, and even when I play different sounds consecutively, there is about a 1/8th second delay between each sound, which is unacceptable for what I am doing. I cannot find a way to add a Device using SharpDX.</p>\n"},{"tags":["c#","wpf","animation","transform"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1782,"score":0,"question_id":6884984,"title":"WPF TranslateTransform","body":"<p>Im trying to use the TranslateTransform class to move a image on a Grid on Y axis. I need this movment to be smooth so i can not use SetMargin or SetCanvas. I try this in code behind:</p>\n\n<pre><code>public void MoveTo(Image target, double oldY, double newY)\n{\n    var trans = new TranslateTransform();\n    var anim2 = new DoubleAnimation(0, newY, TimeSpan.FromSeconds(2))\n                    {EasingFunction = new SineEase()};\n    target.RenderTransform = trans;\n    trans.BeginAnimation(TranslateTransform.YProperty, anim2);\n}\n</code></pre>\n\n<p>The object i want to use (a Image control) is placed on a Grid.\n For the first time everything works fine.\nThe problems comes when i try to move the object again using the same function.\nThe object (a Image control) first move to the start position (initial Y coordinate) then the animation begins.</p>\n\n<p>Is it not suposed for the TranslateTransform to change the coordinates (in my case the Margin property) too?</p>\n\n<p>Thank you.</p>\n"},{"tags":["wpf","xaml","usercontrols"],"answer_count":2,"favorite_count":9,"up_vote_count":32,"down_vote_count":0,"view_count":17296,"score":32,"question_id":887519,"title":"How can a WPF UserControl inherit a WPF UserControl?","body":"<p>The following WPF UserControl called <strong>DataTypeWholeNumber</strong> which works.</p>\n\n<p>Now I want to make a UserControl called <strong>DataTypeDateTime</strong> and <strong>DataTypeEmail</strong>, etc.</p>\n\n<p>Many of the Dependency Properties will be shared by all these controls and therefore I want to put <strong>their common methods into a BaseDataType</strong> and have each of these UserControls inherit from this base type.</p>\n\n<p>However, when I do that, I get the <strong><em>error: Partial Declaration may not have different base classes</em></strong>.</p>\n\n<p>So how can I implement inheritance with UserControls so shared functionality is all in the base class?</p>\n\n<pre><code>using System.Windows;\nusing System.Windows.Controls;\n\nnamespace TestDependencyProperty827.DataTypes\n{\n    public partial class DataTypeWholeNumber : BaseDataType\n    {\n        public DataTypeWholeNumber()\n        {\n            InitializeComponent();\n            DataContext = this;\n\n            //defaults\n            TheWidth = 200;\n        }\n\n        public string TheLabel\n        {\n            get\n            {\n                return (string)GetValue(TheLabelProperty);\n            }\n            set\n            {\n                SetValue(TheLabelProperty, value);\n            }\n        }\n\n        public static readonly DependencyProperty TheLabelProperty =\n            DependencyProperty.Register(\"TheLabel\", typeof(string), typeof(BaseDataType),\n            new FrameworkPropertyMetadata());\n\n\n        public string TheContent\n        {\n            get\n            {\n                return (string)GetValue(TheContentProperty);\n            }\n            set\n            {\n                SetValue(TheContentProperty, value);\n            }\n        }\n\n        public static readonly DependencyProperty TheContentProperty =\n            DependencyProperty.Register(\"TheContent\", typeof(string), typeof(BaseDataType),\n            new FrameworkPropertyMetadata());\n\n\n        public int TheWidth\n        {\n            get\n            {\n                return (int)GetValue(TheWidthProperty);\n            }\n            set\n            {\n                SetValue(TheWidthProperty, value);\n            }\n        }\n\n        public static readonly DependencyProperty TheWidthProperty =\n            DependencyProperty.Register(\"TheWidth\", typeof(int), typeof(DataTypeWholeNumber),\n            new FrameworkPropertyMetadata());\n\n\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","memory-management","printing","memorystream"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13209984,"title":"Out of memory exception while using MemoryStream","body":"<p>I have a program in WPF which prints about 1000 tiff files. The problem is I have to use <b>BitmapCacheOption.OnLoad</b> to be able to print document properly. Otherwise it gives me the follwing error message:</p>\n\n<p>I send byte array and PrintDialog to method which print documents as following:</p>\n\n<pre><code>  //consided that myFiles is a List of byte arrays\n  foreach (byte[] fileContent in myFiles)\n  {\n      if (fileContent != null)\n      {     \n           //dlgPrint is a PrintDialog                                                                                   \n           PrintDocument(fileContent, dlgPrint);\n           //pageNumber is an integer\n           pageNumber++;\n\n           if (pageNumber % 20 == 0)\n           {\n               GC.Collect();\n           }\n        }\n   }\n</code></pre>\n\n<p><b>PrinDocument</b> method is as below. <b>CreateBitmapOfTiff</b> method takes data of image convert it to System.Drawing.Bitmap and writes some strings on this image using Graphics object, returns this bitmap. The whole purpose of this method is writing strings on it. So I have to use System.Drawing.Bitmap. Please don't pay attention to this method just consider that I have to use System.Drawing.Bitmap</p>\n\n<pre><code>    //Print document to printer\n    private void PrintDocument(byte[] fileContent, PrintDialog dlgPrint)\n    {\n        //I create needed System.Drawing.Bitmap\n        System.Drawing.Bitmap tiffBitmap = CreateBitmapOfTiff(fileContent, \"someString\", \"someSAnothertring\");\n\n        byte[] imageContent = \n         (byte[])System.ComponentModel.TypeDescriptor.GetConverter(tiffBitmap).ConvertTo(tiffBitmap, typeof(byte[]));\n        tiffBitmap = null;\n\n        // or I write tiffBitmap.Save(ms, System.Drawing.Imaging.ImageFormat.Tiff);\n        // below in using block\n\n        FlowDocument flwDocument = new FlowDocument();\n        BitmapImage tiffBitmapImage = new BitmapImage();\n\n        using (MemoryStream ms = new MemoryStream(imageContent))\n        {\n            tiffBitmapImage.BeginInit();\n            tiffBitmapImage.StreamSource = ms;\n            //I don't use BitmapCacheOption.OnLoad because it consumed a lot more RAM\n            tiffBitmapImage.CacheOption = BitmapCacheOption.None;\n            tiffBitmapImage.EndInit();\n            imageContent = null;\n\n\n            Image image = new Image();\n            image.Source = tiffBitmapImage;\n            image.Width = 780;\n            image.Height = 1050;\n\n            tiffBitmapImage = null;\n\n\n            InlineUIContainer uiContainer = new InlineUIContainer(image);\n            image = null;\n            Paragraph paragraph = new Paragraph(uiContainer);\n            uiContainer = null;\n            flwDocument.ColumnWidth = 780;\n            flwDocument.PageWidth = 780;\n            flwDocument.PageHeight = 1050;\n            flwDocument.Blocks.Add(paragraph);\n            paragraph = null;\n            IDocumentPaginatorSource idpSource = flwDocument;\n            flwDocument = null;\n            DocumentPaginator docPaginator = idpSource.DocumentPaginator;\n            idpSource = null;\n\n            try\n            {\n                dlgPrint.PrintDocument(docPaginator, \"FusQ3\");\n                docPaginator = null;\n            }\n            catch (Exception)\n            {\n                throw new PrintDialogException(\"My custom error message.\");\n            }\n\n            ms.Close();\n        }\n    }\n</code></pre>\n\n<p>Now the problem is that my RAM slowly becomes full. For example if when I satart printing my ram usage is 1.30 GB after printing 500 documents the usage is approximately 1.70 GB. If I print 2000 documents it will be about 3.0 GB I think. But when I close my program usage is dropping to 1.30 GB again. I think that the problem source is MemoryStream. How can I empty this used memory. Or do you have any better option for printing System.Drawing.Bitmap using WPF.</p>\n\n<p>Any help will be appreciated. Thanks in advance.</p>\n"},{"tags":["wpf","barcode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":13209396,"title":"how to develop a barcode reader application in WPF?","body":"<p>I want to develop a POS and  user requirement is to used Bar-code reader but I don't know how\nto use it please help me if anyone know about that\nThanks in advance </p>\n"},{"tags":["c#",".net","wpf","observablecollection","inotifypropertychanged"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13203795,"title":"Binding multiple ObservableCollections to One ObservableCollection","body":"<p>Have a bunch of <code>ObservableCollection&lt;MeClass&gt; Result</code> and require to combine them all into another <code>ObservableCollection&lt;MeClass&gt; AllResults</code> so I can display it in a <code>listview</code>.</p>\n\n<p>Just not sure how to combine them all in one.</p>\n\n<p>I Created a new class to combine them all but not sure how they will get updated after I got the list once... So not really sure which direction to take.</p>\n\n<p>I know about <code>INotifyPropertyChanged</code> I'm just not sure how to combine them all and keep updating as everything changes.</p>\n"},{"tags":["c#","wpf","visual-studio-2010","visual-studio-2008","usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13207766,"title":"When trying to create an instance of UserControl, getting NullPointerException","body":"<p>When I'm trying to use a <code>UserControl</code> which is in the same solution, I'm getting <code>NullPointerException</code> in <code>InitializeComponent()</code> line.</p>\n\n<p>My <code>MainWindow.xaml.cs</code> file where I'm adding <code>UserControl</code>:</p>\n\n<pre><code>ViewStudentUc viewStudentUc = new ViewStudentUc();\nviewStudentGrid.Children.Add(viewStudentUc);\n</code></pre>\n\n<p>My <code>ViewStudentUc.xaml</code> file where I'm getting exception: </p>\n\n<pre><code>public ViewStudentUc()\n{\n    InitializeComponent();   //Where I'm getting NullPointerException.\n}\n</code></pre>\n\n<p>Why am I getting this exception and how can I remove it?</p>\n\n<p>This is the call stack. </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>SNS School Management.exe!SNS_School_Management.ViewStudentUc.ViewStudentUc() Line 25   C#\nSNS School Management.exe!SNS_School_Management.MainWindow.viewStudent_button_Click(object sender, System.Windows.RoutedEventArgs e) Line 39 + 0x15 bytes   C#\n[External Code] \n</code></pre>\n"},{"tags":["wpf","mvvm","caliburn.micro"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13197076,"title":"simple way to switch Viewmodels/Views in Caliburn.micro","body":"<p>A couple of days ago I asked <a href=\"http://stackoverflow.com/questions/13088358/mvvm-use-new-windows-or-views\">this question</a>, but tbh the answers have confused me even more. So I'll ask a simpler question:</p>\n\n<p>(I'm using Caliburn.Micro, this is a WPF app). Suppose you have a MainView/MainViewModel which has as children AView/AViewModel and BView/BViewModel. Your MainView is a grid, and one of the cells you want to populate with either AView or BView, depending on user choices. If I only wanted to show AView, I'd do the following:</p>\n\n<p>In MainView:</p>\n\n<pre><code>&lt;StackPanel Name=\"SP_Controls\" VerticalAlignment=\"Bottom\" Grid.Row=\"1\" Grid.Column=\"0\"&gt;\n    &lt;ContentControl Name=\"ViewModelToShow\" Margin=\"10\" /&gt;\n&lt;/StackPanel&gt; \n</code></pre>\n\n<p>and in the MainViewModel:</p>\n\n<pre><code>public AViewModel ViewModelToShow{get; set;}\n</code></pre>\n\n<p>My naive Idea now would be to do something like this:</p>\n\n<pre><code>private AViewModel _AVM;\nprivate BViewModel _BVM;\n\npublic ... ViewModelToShow{ get; set;}\n</code></pre>\n\n<p>and then in the code, e.g., set the viewmodel to show:</p>\n\n<pre><code>ViewModelToShow = _BVM; \n</code></pre>\n\n<p>My only problem are the \"...\", since each ViewModel is of a different class. Is there a way to do this with generics, or should I define a base class for my ViewModels to which I cast them? But if I do that, will they still be displayed properly. Thanks. </p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13207352,"title":"Binding Textbox IsEnabled to two different Radiobuttons at the same time","body":"<p>I have three Radiobuttons in my UI (WPF).\nBy selecting two of them, I want to make a Textbox Enabled. and by selecting the third one the Textbox should be disabled.\nshall I use Multibinding? If yes How?</p>\n"},{"tags":[".net","wpf",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13199498,"title":"Access resources of different assembly","body":"<p>My program has the following structure where the boxes represent assemblies and the arrows represent references:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BGddE.png\" alt=\"Assembly structure\"></p>\n\n<p>The <code>WpfElements</code> assembly contains a resource dictionary in its Resources.xaml, which contains some styles:</p>\n\n<pre><code>&lt;ResourceDictionary x:Key=\"DialogDockStyle\"&gt;\n    ...\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>The <code>WpfControls</code> assembly contains a window, which references these styles:</p>\n\n<pre><code>&lt;StackPanel ... Resources=\"{StaticResource DialogDockStyle}\"&gt;\n</code></pre>\n\n<p>The <code>Server</code> and <code>Client</code> assemblies are executables that instantiate this window and display it.</p>\n\n<p>This works great for the <code>Server</code>. The window is displayed and can be used. However, when the same code is run from the <code>Client</code>, an error occures instantiating the window:</p>\n\n<blockquote>\n  <p>The resource with the name \"DialogDockStyle\" cannot be found.</p>\n</blockquote>\n\n<p>It is a bit weird that is works from one assembly and not from the other. Is there anything I might have overseen to make it work from both assemblies?</p>\n"},{"tags":["c#","wpf","listbox","background-color","selecteditem"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":754,"score":2,"question_id":5519845,"title":"Change the Selected Color Listbox","body":"<p>I want to change the Selected Background and have it display a gradient with round corners. I've searched Google and found that some people do change the selected color by overriding the default color. Is there any way I can do this? I was thinking is there any way to display a round cornered border as the background when an item is selected?</p>\n"},{"tags":["wpf","gridview","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5097,"score":2,"question_id":1501161,"title":"GridView dynamic column width in WPF","body":"<pre><code>&lt;Window x:Class=\"GridViewSample.Window1\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nTitle=\"Window1\" &gt;\n&lt;Grid&gt;\n\t&lt;Grid.RowDefinitions&gt;\n\t\t&lt;RowDefinition/&gt;\n\t\t&lt;RowDefinition/&gt;\n\t&lt;/Grid.RowDefinitions&gt;\n\t&lt;ListView Name=\"CheckoutList\" Margin=\"0,0,8,0\"&gt;\n\t\t&lt;ListView.View&gt;\n\t\t\t&lt;GridView x:Name=\"CheckOutGridView\"&gt;\n\t\t\t\t&lt;GridView.ColumnHeaderContainerStyle&gt;\n\t\t\t\t\t&lt;Style TargetType=\"{x:Type GridViewColumnHeader}\"&gt;\n\t\t\t\t\t\t&lt;Setter Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n\t\t\t\t\t&lt;/Style&gt;\n\t\t\t\t&lt;/GridView.ColumnHeaderContainerStyle&gt;\n\t\t\t\t&lt;GridViewColumn&gt;\n\t\t\t\t\t&lt;GridViewColumn.CellTemplate&gt;\n\t\t\t\t\t\t&lt;DataTemplate&gt;\n\t\t\t\t\t\t\t&lt;TextBlock&gt; \n\t\t\t\t\t\t\t\t&lt;Hyperlink &gt;          \n\t\t\t\t\t\t\t\t\t&lt;TextBlock Text=\"{Binding Path=Text}\"/&gt; \n\t\t\t\t\t\t\t\t&lt;/Hyperlink&gt; \n\t\t\t\t\t\t\t&lt;/TextBlock&gt;\n\t\t\t\t\t\t&lt;/DataTemplate&gt;\n\t\t\t\t\t&lt;/GridViewColumn.CellTemplate&gt;\n\t\t\t\t&lt;/GridViewColumn&gt;\n\t\t\t\t&lt;GridViewColumn&gt;\n\t\t\t\t\t&lt;GridViewColumn.CellTemplate&gt;\n\t\t\t\t\t\t&lt;DataTemplate&gt;\n\t\t\t\t\t\t\t&lt;TextBlock&gt; \n\t\t\t\t\t\t\t\t&lt;Hyperlink&gt;          \n\t\t\t\t\t\t\t\t\t&lt;TextBlock Text=\"Remove\"/&gt; \n\t\t\t\t\t\t\t\t&lt;/Hyperlink&gt; \n\t\t\t\t\t\t\t&lt;/TextBlock&gt;\n\t\t\t\t\t\t&lt;/DataTemplate&gt;\n\t\t\t\t\t&lt;/GridViewColumn.CellTemplate&gt;\n\t\t\t\t&lt;/GridViewColumn&gt;\n\t\t\t&lt;/GridView&gt;\n\t\t&lt;/ListView.View&gt;\n\t&lt;/ListView&gt;\n\n\t&lt;StackPanel Grid.Row=\"1\"&gt;\n\t\t&lt;Button Width=\"100\" Height=\"25\" Click=\"Button_Click\" &gt;name&lt;/Button&gt;\n\t\t&lt;Button Width=\"100\" Height=\"25\" Click=\"Button_Click1\" &gt;long name&lt;/Button&gt;\n\t&lt;/StackPanel&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>public partial class Window1 : Window\n{\n\tclass TextObject\n\t{\n\t\tprivate string _text;\n\n\t\tpublic TextObject(string Text)\n\t\t{\n\t\t\t_text = Text;\n\t\t}\n\n\t\tpublic string Text\n\t\t{\n\t\t\tget { return _text; }\n\t\t\tset { _text = value; }\n\t\t}\n\t}\n\n\n\tpublic Window1()\n\t{\n\t\tInitializeComponent();\n\t}\n\n\tprivate void Button_Click(object sender, RoutedEventArgs e)\n\t{\n\t\tCheckoutList.Items.Add(new TextObject(\"name\"));\n\t}\n\n\tprivate void Button_Click1(object sender, RoutedEventArgs e)\n\t{\n\t\tCheckoutList.Items.Add(new TextObject(\"long name\"));\n\t}\n\n}\n</code></pre>\n\n<p>Given the above sample press name then long name.  How come the column doesn't resize to fit its contents?</p>\n"},{"tags":["wpf","performance","datagrid"],"answer_count":5,"favorite_count":15,"up_vote_count":21,"down_vote_count":0,"view_count":14893,"score":21,"question_id":697701,"title":"WPF Datagrid Performance","body":"<p>I am working with the WPF Toolkit data grid and it is scrolling extremely slow at the moment.  The grid has 84 columns and 805 rows. (Including 3 fixed columns and the header is fixed.)  Scrolling both horizontally and vertically is extremely slow.  Virtualization is turned on and I have enabled column virtualization and row virtualization explicitly in the xaml.  Is there anything to watch out for that can really effect performance, such as binding methods, or what xaml is in each celltemplate?</p>\n\n<p>One thing to note is I am dynamically adding the columns on creation of the datagrid.  Could that be effecting anything? (I also dynamically create the celltemplate at the same time so that my bindings are set right.)</p>\n\n<p>Below is the code from the template for most of the cells that get generated.  Basically for the columns I need to dynamically add (which is most of them), I loop through my list and add the columns using the AddColumn method, plus I dynamically build the template so that the binding statements properly index the right item in the collection for that column.  The template isn't too complex, just two TextBlocks, but I do bind four different properties on each.  It seems like I was able to squeeze out a little bit more performance by changes the bindings to OneWay:</p>\n\n<pre><code> private void AddColumn(string s, int index)\n    {\n        DataGridTemplateColumn column = new DataGridTemplateColumn();\n        column.Header = s;\n        //Set template for inner cell's two rectangles\n        column.CellTemplate = CreateFactViewModelTemplate(index);\n        //Set Style for header, ie rotate 90 degrees\n        column.HeaderStyle = (Style)dgMatrix.Resources[\"HeaderRotateStyle\"];\n        column.Width = DataGridLength.Auto;\n        dgMatrix.Columns.Add(column);\n    }\n\n\n    //this method builds the template for each column in order to properly bind the rectangles to their color\n    private static DataTemplate CreateFactViewModelTemplate(int index)\n    {\n        string xamlTemplateFormat =\n            @\"&lt;DataTemplate xmlns=\"\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\"\n            xmlns:x=\"\"http://schemas.microsoft.com/winfx/2006/xaml\"\"&gt;\n            &lt;Grid&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition /&gt;\n                &lt;ColumnDefinition /&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;TextBlock Grid.Column=\"\"0\"\" MinHeight=\"\"10\"\" MinWidth=\"\"10\"\" HorizontalAlignment=\"\"Stretch\"\" Padding=\"\"3 1 3 1\"\" TextAlignment=\"\"Center\"\" Foreground=\"\"{Binding Path=FactViewModels[~Index~].LeftForeColor,Mode=OneWay}\"\" Background=\"\"{Binding Path=FactViewModels[~Index~].LeftColor,Mode=OneWay}\"\" Text=\"\"{Binding Path=FactViewModels[~Index~].LeftScore,Mode=OneWay}\"\" /&gt;\n            &lt;TextBlock Grid.Column=\"\"1\"\" MinHeight=\"\"10\"\" MinWidth=\"\"10\"\" HorizontalAlignment=\"\"Stretch\"\" Padding=\"\"3 1 3 1\"\" TextAlignment=\"\"Center\"\" Foreground=\"\"{Binding Path=FactViewModels[~Index~].RightForeColor,Mode=OneWay}\"\" Background=\"\"{Binding Path=FactViewModels[~Index~].RightColor,Mode=OneWay}\"\" Text=\"\"{Binding Path=FactViewModels[~Index~].RightScore,Mode=OneWay}\"\" /&gt;\n            &lt;/Grid&gt;\n            &lt;/DataTemplate&gt;\";\n\n\n\n\n        string xamlTemplate = xamlTemplateFormat.Replace(\"~Index~\", index.ToString());\n\n        return (DataTemplate)XamlReader.Parse(xamlTemplate);\n    }\n</code></pre>\n"},{"tags":["c#",".net","wpf","performance"],"answer_count":3,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":3683,"score":10,"question_id":3022921,"title":"WPF DataGrid performance concerns","body":"<p>I am testing WPF DataGrid in hopes of replacing some winforms controls, and so far have been very pleased with the development process. Performance seems to be my biggest concern right now. My development workstation has just about the best cpu on the market running windows 7, with 6 gigs of DDR3 memory. The windows control i am replacing is considerably more responsive which is worrisome.</p>\n\n<p>My test is a basic implementation of DataGrid bound to ObservableCollection which gets updated once per second. It also includes Details area which is expandable to reveal more info about each row. Details area is just a stackpanel with a ItemsControl wrapping TextBlock (which repeats 6 times)</p>\n\n<p>My complaint is that if i try to scroll this collection, it is often jerky with lag, and if i try to expand each row as they come in, about 15% of clicks do not trigger buttons click event (DataGridTmplateColumn > CellTemplate > DataTemplate > Button)\nAlso scrolling is more jittery if some rows detail is expanded (with scroll bar that resizes it self as it goes up/down)</p>\n\n<p>what are some things to look for / optimize / avoid ? </p>\n\n<p><strong>update</strong></p>\n\n<p>here are some points i found helpful so far: </p>\n\n<ul>\n<li><p>rely as little as possible on dynamic layout. as each component contains many subcomponents and in dynamic layout world, all of them have to call Measure and Layout methods which can be cpu intensive. so instead of column width Auto (or no width specified), use fixed widths</p></li>\n<li><p>install <a href=\"http://msdn.microsoft.com/en-us/library/aa969767.aspx#installing_the_wpf_performance_suite\" rel=\"nofollow\">WPF Performance Suite</a> and get in touch with how your app is rendered. trully awesome app</p></li>\n<li><p>as Andrew pointed out ListView is a great alternative, for when you don't need advanced DataGrid features, such as updating the data back, or possibly Details View (which i am still hoping to reproduce)</p></li>\n<li><p>also <a href=\"http://stackoverflow.com/questions/2460557/itemscontrol-itemssource-mvvm-performance\">SuspendableObservableCollection</a> is ideal for when you're adding multiple items in very short period of time (i.e. 100 items in 0.01 second etc) </p></li>\n<li><p>after lots of testing, i found that BindingList is much faster than ObservableCollection . I posted performance profiler snapshots <a href=\"http://stackoverflow.com/questions/3305383/wpf-whats-the-most-efficient-fast-way-of-adding-items-to-a-listview\">here</a> of the same load handled by BindingList vs Observable collection, and the former takes less than half cpu time. (keep in mind that this is not just collection performance, but when paired with a ListView)</p></li>\n</ul>\n\n<p>my search still continues as something appears to be leaking memory in my app and slows it down to a halt after couple hours.</p>\n"},{"tags":["c#",".net","wpf","testing","ui-automation"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1602,"score":1,"question_id":6554494,"title":"How can I send a right-click event to an AutomationElement using WPF's UI automation?","body":"<p>Using WPF's built-in UI automation, it's easy (though pretty verbose) to send a left-click event to an AutomationElement (such as a Button):</p>\n\n<pre><code>InvokePattern invokePattern = (InvokePattern) element.GetCurrentPattern(InvokePattern.Pattern);\ninvokePattern.Invoke();\n</code></pre>\n\n<p>However, there seems to be no built-in way to send right-clicks to the same element. I've resigned myself to using P/Invoke to call <a href=\"http://msdn.microsoft.com/en-us/library/ms646310%28v=vs.85%29.aspx\" rel=\"nofollow\">SendInput</a>, but I can't get it to work. With the code below, when I call RightClick(), a context menu pops up right where the cursor is, rather than at the element I expect to be right-clicked. So it seems like it's ignoring the coordinates I hand in and just using the current cursor location.</p>\n\n<pre><code>public static void RightClick(this AutomationElement element)\n{\n    Point p = element.GetClickablePoint();\n\n    NativeStructs.Input input = new NativeStructs.Input\n    {\n        type = NativeEnums.SendInputEventType.Mouse,\n        mouseInput = new NativeStructs.MouseInput\n        {\n            dx = (int) p.X,\n            dy = (int) p.Y,\n            mouseData = 0,\n            dwFlags = NativeEnums.MouseEventFlags.Absolute | NativeEnums.MouseEventFlags.RightDown,\n            time = 0,\n            dwExtraInfo = IntPtr.Zero,\n        },\n    };\n\n    NativeMethods.SendInput(1, ref input, Marshal.SizeOf(input));\n\n    input.mouseInput.dwFlags = NativeEnums.MouseEventFlags.Absolute | NativeEnums.MouseEventFlags.RightUp;\n\n    NativeMethods.SendInput(1, ref input, Marshal.SizeOf(input));\n}\n\ninternal static class NativeMethods\n{\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern uint SendInput(uint nInputs, ref NativeStructs.Input pInputs, int cbSize);\n}\n\ninternal static class NativeStructs\n{\n    [StructLayout(LayoutKind.Sequential)]\n    internal struct Input\n    {\n        public NativeEnums.SendInputEventType type;\n        public MouseInput mouseInput;\n    }\n\n    [StructLayout(LayoutKind.Sequential)]\n    internal struct MouseInput\n    {\n        public int dx;\n        public int dy;\n        public uint mouseData;\n        public NativeEnums.MouseEventFlags dwFlags;\n        public uint time;\n        public IntPtr dwExtraInfo;\n    }\n}\n\ninternal static class NativeEnums\n{\n    internal enum SendInputEventType : int\n    {\n        Mouse = 0,\n        Keyboard = 1,\n        Hardware = 2,\n    }\n\n    [Flags]\n    internal enum MouseEventFlags : uint\n    {\n        Move = 0x0001,\n        LeftDown = 0x0002,\n        LeftUp = 0x0004,\n        RightDown = 0x0008,\n        RightUp = 0x0010,\n        MiddleDown = 0x0020,\n        MiddleUp = 0x0040,\n        XDown = 0x0080,\n        XUp = 0x0100,\n        Wheel = 0x0800,\n        Absolute = 0x8000,\n    }\n}\n</code></pre>\n"},{"tags":["wpf","ado.net","refactoring","modal-dialog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13202888,"title":"Separating WPF dialogs from data class","body":"<p>I have a small .NET 4 program using WPF, which heavily uses ADO.NET.  I am having to refactor the code now to separate the SQL data access/processing from the \"main window\" WPF window. Currently, there is a lot of data integrity checking in the DataSet-building code, which (potentially) throws up quite a few modal warning dialogs (like using MessageBox.Show()). I would like to \"do the right thing\" here and separate the data processing from the window displaying. (Or is that not so bad to have that modal dialog pop up from a purely \"number-crunching class\"?) How should I be doing this? Any pointers to articles/concepts would be appreciated - thanks.</p>\n"},{"tags":["asp.net","wpf","validation","requiredfieldvalidator"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":659,"score":1,"question_id":5622333,"title":"WPF Validators like the one in ASP.NET","body":"<p>How do we implement Validators in WPF application similar to the ASP.NET application like required field validator?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","wpf","mvvm","binding","usercontrols"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":140,"score":1,"question_id":12993908,"title":"Creating UserControl via MVVM pattern - DataContext and binding to parent","body":"<p>I use MVVM pattern so my own control contains View and ViewModel.<br>\nViewModel is connected with View by DataContext property. This makes problems with binding. Why? </p>\n\n<p>Assume this situation:<br>\nI created new user control - for example - \"SuperTextBox\". It have a property \"SuperValue\".<br>And now I do something like that:</p>\n\n<pre><code>&lt;Window&gt;\n    &lt;Window.DataContext&gt;\n        &lt;vm:WindowViewModel/&gt;\n    &lt;/Window.DataContext&gt;\n\n    &lt;local:SuperTextBox SuperValue=\"{Binding Test}\"/&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>I thought that \"binding process\" joins SuperTextBox.SuperValue with Window.DataContext.Test, but no, 'binding process\" joins SuperTextBox.SuperValue with SuperTextBox.DataContext.Test what is for me unnatural and misleading.</p>\n\n<p>Other controls like \"TextBox\" I can use in above way because they do not have their DataContext.</p>\n\n<p>How can I use MVVM pattern to creating UserControls keeping natural binding (to DataContext of parent control) ?</p>\n\n<p>Edit:</p>\n\n<p><strong>I got many answers how binding to parent, but I know this earlier. The problem is - how can I create UserControl via MVVM patern (having ViewModel) and stay natural binding - default to parent DataContext.</strong></p>\n\n<p>I want to have ViewMoldel and still can binding like this:</p>\n\n<pre><code>&lt;local:SuperTextBox SuperValue=\"{Binding Test}\"/&gt;\n</code></pre>\n\n<p>Is it possible?</p>\n"},{"tags":["c#","wpf","xaml","data-binding","datatemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13205206,"title":"Drag & Drop using Command in WPF","body":"<p>I have a <code>HierarchicalDataTemplate</code> in a resource file that defines the template for a <code>TreeView</code>, here is the (shortened) XAML code:</p>\n\n<pre><code>&lt;HierarchicalDataTemplate x:Key=\"BrowserDataTemplate\" DataType=\"{x:Type common:ILocation}\" ItemsSource=\"{Binding Locations}\"&gt;\n    &lt;ItemsControl&gt;\n        &lt;StackPanel&gt;\n             &lt;StackPanel.InputBindings&gt;\n                &lt;MouseBinding Command=\"{x:Static local:MapBrowser.SelectLocation}\" MouseAction=\"LeftClick\" \n                                          CommandParameter=\"{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type TreeViewItem}}}\"/&gt;\n            &lt;/StackPanel.InputBindings&gt;\n            &lt;Grid&gt;\n                &lt;Image Source=\"{StaticResource IconImage}\" /&gt;\n                &lt;TextBlock Text=\"{Binding Description}\" /&gt;\n            &lt;/Grid&gt;\n        &lt;/StackPanel&gt;\n    &lt;/ItemsControl&gt;\n&lt;/HierarchicalDataTemplate&gt;\n</code></pre>\n\n<p>Is it possible to add drag &amp; drop functionality by using commands (something similar to the MouseBinding above) or I really must use the event handlers?</p>\n"},{"tags":["c#",".net","wpf","3d","render"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13203959,"title":"Nearest-neighbor image sampling in 3D WPF","body":"<p>I'm desperately trying to render images onto a 3D surface in WPF using nearest-neighbor sampling.  Below is an example of what I currently have, in all its blurriness.  The ImageBrush is given a 64x64 texture.</p>\n\n<p><img src=\"http://i.imgur.com/kFZ5s.png\" alt=\"Sample image.\"></p>\n\n<p>I've tried decorating the XAML with <code>RenderOptions.BitmapScalingMode=\"NearestNeighbor\"</code> everywhere from the <code>Window</code> to the <code>ImageBrush</code> without fortune.  I've tried writing a custom pixel shader, and couldn't get a satisfactory result.  It even appears that I cannot set the texture sampler's filtering mode from within the shader code.  I've considered work-arounds, such as scaling up the source texture myself, but this would still leave artifacts at two of the edges where it begins interpolating into the next pixel.</p>\n\n<p>Bottom line: Is there any way I can accomplish the effect of nearest neighbor image sampling on a 3D model in WPF?</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13204536,"title":"Getting value of cell in DataGrid in WPF","body":"<p>For WinForms it's:</p>\n\n<pre><code>var value = DataGridView.Rows[0].Cells[0].Value\n</code></pre>\n\n<p>Is there any way to get it in WPF?</p>\n"},{"tags":["wpf","geolocation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13189939,"title":"using GPS sensor on ultrabook","body":"<p>I am developing a WPF application on an Intel Ultrabook.  As the Ultrabook already includes GPS sensors, how can I go about retrieving my current location inside my app using this sensor?</p>\n\n<p>I am not able to find any sample code to get me started.  Any guidance is appreciated.</p>\n"},{"tags":["wpf","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13200696,"title":"WPF DataGrid looses focus when tabbing on last cell","body":"<p>I have some buttons and a datagrid inside my window.</p>\n\n<pre><code>&lt;Button&gt;Save&lt;/Button&gt;\n&lt;Button&gt;Back&lt;/Button&gt;\n&lt;DataGrid x:Name=\"data\" ItemsSource=\"{Binding Scores}\" /&gt;\n</code></pre>\n\n<p>When I edit the NewItemPlaceholder-row, the new item is created when changing the first value (but no new NewItemPlaceholder-row). When I edit the last value and move on with Tab-key, a new row is generated.\nBut the cursor moves to Save Button instead of the first cell in that new row.</p>\n\n<p>How can I keep the focus on the grid?</p>\n\n<p>For completeness: I am using an ObservableCollection as ItemsSource.</p>\n"},{"tags":["c#","wpf","object","canvas"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13202661,"title":"WPF Canvas Create object","body":"<p>I am using WPF and C# and I have a canvas with rectangles on it (like a maze). Now i want to create a character who moves (with the help of an algorithm) through this maze. Therefore I created a new class called character, but my problem starts here: How do I create an object on the canvas which has an image, a position and which can access the methods and attributes from the character-class?\nSo the final thing should look like this:</p>\n\n<pre><code>private class MainWindow\n{\n\n   //Here the canvas is made visible and the rectangles are being drawn on the canvas\n\n   //Then a method should start to create the character and move him through the maze\n\n   //it should look like (character.move(1) so the character moves one step forward etc.)\n\n}\n\nprivate class Character\n{\n//here are the methods and attributes the character should have\n}\n</code></pre>\n\n<p>Thanks in advance and sorry for my bad english :)</p>\n"},{"tags":["wpf","binding","treeview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13186910,"title":"Using TreeVew to navigate to different pages","body":"<p>I would like to make a <code>Settings</code> window similar to the <code>Options</code> box in VS2012. I expect to write a XAML page for each set of settings. But how do I use a <code>TreeView</code> to choose which XAML page gets shown? Should the XAML page be part of the objects that are loaded in the tree?</p>\n\n<p>(I should say, how do I do this in an MVVM way... if possible.)</p>\n"},{"tags":["wpf","silverlight","microsoft-metro","transitions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13197382,"title":"Silverlight-like transition effects in WPF?","body":"<p>I have seen packages like MahApps (http://mahapps.com/MahApps.Metro/) which will allow WPF programs to have the look and feel of Metro.</p>\n\n<p>I've also seen some pretty good looking Silverlight programs created with that Metro theme in mind. For example, when you click a button a panel will slide/transition out over the time span of about a quarter of a second (I don't mean just a simple fade in, I mean the panel physically moving across the screen until it is at full size). My understanding is that this is achieved with storyboards.</p>\n\n<p>My question is whether it is possible in a WPF application to do these sort of transition / visual effects? Or is it something that is strictly in the realm of Silverlight?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13201286,"title":"How to bind to DataGridRow item from templated cell within that row in xaml?","body":"<p>What binding is used to bind an element defined in the cell template of a DataGridTemplateColumn to the bound data item of that cell's DataGridRow? </p>\n\n<p>For example, assume the DataGrid Items are objects that have a Name property.  What binding is required in the code below to bind the TextBlock Text to the \"Name\" property of the data item represented by the parent row?</p>\n\n<p>(And yes, in the example I could just use DataGridTextColumn, but I'm just simplifying for example sake.) </p>\n\n<pre><code>&lt;DataGrid ItemsSource=\"{Binding Items}\"&gt;\n  &lt;DataGrid.Columns&gt;\n    &lt;DataGridTemplateColumn Header=\"Name\"&gt;\n      &lt;DataGridTemplateColumn.CellTemplate&gt;\n        &lt;DataTemplate&gt;\n          &lt;TextBlock Text=\"{Binding ???}\"/&gt;\n        &lt;/DataTemplate&gt;\n      &lt;/DataGridTemplateColumn.CellTemplate&gt;\n    &lt;/DataGridTemplateColumn&gt;\n  &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n"},{"tags":["wpf","c#-4.0","imagesource"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13203147,"title":"Zoom in on image with code","body":"<p>How can I zoom in on an image with code and not use a mouse event? Should it be done?</p>\n\n<p>I need to do it without working with mouse wheel or mouse capture or ...</p>\n\n<p>I'am using it for a ScrollViewer  :</p>\n\n<pre><code>&lt;ScrollViewer Grid.Column=\"0\"&gt;\n  &lt;Image Name=\"myImage\" Source=\"Penguins.jpg\"/&gt;\n&lt;/ScrollViewer&gt;\n</code></pre>\n"},{"tags":["wpf","xaml","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13140431,"title":"TextOptions.TextFormattingMode affecting text with bold font weight","body":"<p><a href=\"http://stackoverflow.com/questions/13088971/setting-fontweight-to-bold-shrinks-text-size/13123422#13123422\">I've had a problem</a> where making the font weight of some text Bold made it smaller than the Normal font weighted text. I've worked out that this is because I've got the TextFormattingMode set to \"Display\"; the problem doesn't occur if the TextFormattingMode is set to \"Ideal\".</p>\n\n<p>For example, the following code:</p>\n\n<pre><code> &lt;Label FontFamily=\"Calibri\" FontSize=\"12\" FontWeight=\"Bold\" Content=\"This is some test text\" TextOptions.TextFormattingMode=\"Ideal\"/&gt;\n &lt;Label FontFamily=\"Calibri\" FontSize=\"12\" Content=\"This is some test text\" TextOptions.TextFormattingMode=\"Ideal\"/&gt;\n &lt;Label&gt;&lt;/Label&gt;\n &lt;Label FontFamily=\"Calibri\" FontSize=\"12\" FontWeight=\"Bold\" Content=\"This is some test text\" TextOptions.TextFormattingMode=\"Display\"/&gt;\n &lt;Label FontFamily=\"Calibri\" FontSize=\"12\" Content=\"This is some test text\" TextOptions.TextFormattingMode=\"Display\"/&gt;\n</code></pre>\n\n<p>Produces the following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/bDv0n.png\" alt=\"Results of XAML when running\"></p>\n\n<p>If I up the font size to about 14 for the last two labels the bold text becomes larger than the normal weighted text.</p>\n\n<p>My question is: is there a setting I can use to have 12 point bold text with the TextFormattingMode set to \"Display\" that is the same size / slightly larger than than the normal weighted text?</p>\n"},{"tags":["c#","wpf","multithreading","listbox","backgroundworker"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13202683,"title":"Updating Listbox in the background WPF","body":"<p>I am trying to make a hyper-terminal like program and i am having trouble getting the serial port to get a line and post it in the list box in the background. In the example below it will freeze the whole program while the the for loop runs 100 times and then spit out all 100 lines... i want it to update line by line and i am not sure why its doing it.</p>\n\n<p>I also tried backgroundworker but it seemed to do the same thing.</p>\n\n<p>Thanks in advance...</p>\n\n<pre><code>    static System.Threading.Thread thread;\n    public void button2_Click(object sender, RoutedEventArgs e)\n    {\n        if(Sp.IsOpen){\n            stop = false;\n\n            thread = new System.Threading.Thread(\n                new System.Threading.ThreadStart(\n                  delegate()\n                  {\n                    System.Windows.Threading.DispatcherOperation\n                      dispatcherOp = listBox1.Dispatcher.BeginInvoke(\n                      System.Windows.Threading.DispatcherPriority.Normal,\n                      new Action(\n                        delegate()\n                        {\n                            for(int y = 0; y &lt;100; y++)\n                            {\n                                String line = Sp.ReadLine();\n                                listBox1.Items.Add(line);\n                            }\n                        }\n                               ));\n\n              }\n          ));\n            thread.Start();\n\n\n        }else{\n            item.Content = (\"No Comm Ports are Open\");\n            item.IsSelected = true;\n            listBox1.Items.Add(item);\n        }\n\n    }\n</code></pre>\n"},{"tags":["wpf","xaml","data-binding","windows-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13202131,"title":"Bind ListBox selected color to SelectedItem's property","body":"<p>I have a <code>ListBox</code> control bound to an <code>ObservableCollection&lt;ToDoCategory&gt;</code> as <code>ItemsSource=\"{Binding Categories}</code>. Inside the <code>ToDoCategory</code> there are <code>CategoryName</code> and <code>CategoryColor</code> (both strings). <code>CategoryName</code> is bound inside the <code>ItemTemplate</code>. Now, what I would like to do is to change the color of category selected in the <code>ListBox</code> based on <code>CategoryColor</code>. I already have string to brush <code>IValueConverter</code> which returns <code>SolidColorBrush</code> for string. It is also correctly defined in the page resources. I know I need to change <code>ItemContainerStyle</code>. Currently, I have something like this:</p>\n\n<pre><code>&lt;Style x:Key=\"CategoryListBoxContainerStyle\" TargetType=\"ListBoxItem\"&gt;\nSetter Property=\"Template\"&gt;\n    &lt;Setter.Value&gt;\n        &lt;ControlTemplate TargetType=\"ListBoxItem\"&gt;\n            &lt;Border...&gt;\n            &lt;VisualStateManager.VisualStateGroups&gt;\n                &lt;VisualState x:Name=\"Selected\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"InnerGrid\"&gt;\n                            &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{Binding CategoryColor, Converter=StringToBrushConverter}\"/&gt;\n                        &lt;/ObjectAnimationUsingKeyFrames&gt;\n                        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Foreground\" Storyboard.TargetName=\"ContentPresenter\"&gt;\n                            &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource ListBoxItemSelectedForegroundThemeBrush}\"/&gt;\n                        &lt;/ObjectAnimationUsingKeyFrames&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/VisualState&gt;\n                .\n                .\n                .\n&lt;/style&gt;\n</code></pre>\n\n<p>This doesn't work. How do I bind the Background of the InnerGrid to <code>CategoryColor</code> from the <code>ToDoCategory</code>?</p>\n"},{"tags":["c#",".net","wpf","xaml","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13198263,"title":"Show/hide button with BooleanToVisibilityConverter does not work","body":"<p>In my application I want to show/hide a button according to the users authorization level.\nIf the user is a team leader the button should be shown. If the user is not a team leader it shouldn't be shown.</p>\n\n<p>I tried to resolve this issue using a <code>BooleanToVisibilityConverter</code> which is defined in my resource dictionary:\n</p>\n\n<pre><code>&lt;BooleanToVisibilityConverter x:Key=\"VisibilityConverter\" /&gt;\n</code></pre>\n\n<p>Implementation of the converter:</p>\n\n\n\n<pre><code>&lt;Button Grid.Row=\"1\" Grid.Column=\"5\"\nClick=\"TeamLeader_Click\" Visibility=\"{Binding IsTeamLeader, Converter={StaticResource\nVisibilityConverter}}\" Style=\"{StaticResource ButtonStyleMenu}\" /&gt;\n</code></pre>\n\n<p>In my code behind class I'm using a dependency property to change the visibility of the button.</p>\n\n\n\n<pre><code>public static readonly DependencyProperty IsTeamLeaderProperty =\nDependencyProperty.Register(\"IsTeamLeader\", typeof(bool),\ntypeof(MainMenu), new FrameworkPropertyMetadata(false));\n\npublic bool IsTeamLeader\n{\n    get { return (bool)GetValue(IsTeamLeaderProperty); }\n    set { SetValue(IsTeamLeaderProperty, value); }\n}\n</code></pre>\n\n<p>In the \"loaded event\" of my user control I initialize my property with <code>false</code> so the button should be collapsed.</p>\n\n\n\n<pre><code>private void ViewPage_Loaded(object sender, RoutedEventArgs e)\n{\n   this.IsTeamLeader = false;\n}\n</code></pre>\n\n<p>But this won't work. No matter which value the <code>IsTeamLeader</code> property has on startup the button is always visible.</p>\n\n<p>So can you please help me and give me a hint where I did the mistake? Is there a problem with the <code>BooleanToVisiblityConverter</code> or is there something wrong with my dependency property implementation? Or what?</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","wpf","xaml","binding","background"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7135,"score":1,"question_id":1962149,"title":"How can I bind a background color in WPF/XAML?","body":"<p>What do I have to change to the following code so that the background is red, neither of the 2 ways I tried worked:</p>\n\n<p><img src=\"http://www.deviantsart.com/upload/1okq25l.png\" alt=\"alt text\"></p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;Window x:Class=\"TestBackground88238.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n    &lt;StackPanel&gt;\n\n        &lt;TextBlock Text=\"{Binding Message}\" Background=\"{Binding Background}\"/&gt;\n\n        &lt;TextBlock Text=\"{Binding Message}\"&gt;\n            &lt;TextBlock.Background&gt;\n                &lt;SolidColorBrush Color=\"{Binding Background}\"/&gt;\n            &lt;/TextBlock.Background&gt;\n        &lt;/TextBlock&gt;\n\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>Code Behind:</strong></p>\n\n<pre><code>using System.Windows;\nusing System.ComponentModel;\n\nnamespace TestBackground88238\n{\n    public partial class Window1 : Window, INotifyPropertyChanged\n    {\n\n        #region ViewModelProperty: Background\n        private string _background;\n        public string Background\n        {\n            get\n            {\n                return _background;\n            }\n\n            set\n            {\n                _background = value;\n                OnPropertyChanged(\"Background\");\n            }\n        }\n        #endregion\n\n        #region ViewModelProperty: Message\n        private string _message;\n        public string Message\n        {\n            get\n            {\n                return _message;\n            }\n\n            set\n            {\n                _message = value;\n                OnPropertyChanged(\"Message\");\n            }\n        }\n        #endregion\n\n\n\n        public Window1()\n        {\n            InitializeComponent();\n            DataContext = this;\n\n            Background = \"Red\";\n            Message = \"This is the title, the background should be \" + Background + \".\";\n\n        }\n\n        #region INotifiedProperty Block\n        public event PropertyChangedEventHandler PropertyChanged;\n\n        protected void OnPropertyChanged(string propertyName)\n        {\n            PropertyChangedEventHandler handler = PropertyChanged;\n\n            if (handler != null)\n            {\n                handler(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }\n        #endregion\n\n    }\n}\n</code></pre>\n\n<h1>Update 1:</h1>\n\n<p>I tried Aviad's answer which didn't seem to work. I can do this manually with x:Name as shown here but I want to be able to bind the color to a INotifyPropertyChanged property, how can I do this?</p>\n\n<p><img src=\"http://www.deviantsart.com/upload/7tp48m.png\" alt=\"alt text\"></p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;Window x:Class=\"TestBackground88238.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n    &lt;StackPanel&gt;\n\n        &lt;TextBlock Text=\"{Binding Message}\" Background=\"{Binding Background}\"/&gt;\n\n        &lt;TextBlock x:Name=\"Message2\" Text=\"This one is manually orange.\"/&gt;\n\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>Code Behind:</strong></p>\n\n<pre><code>using System.Windows;\nusing System.ComponentModel;\nusing System.Windows.Media;\n\nnamespace TestBackground88238\n{\n    public partial class Window1 : Window, INotifyPropertyChanged\n    {\n\n        #region ViewModelProperty: Background\n        private Brush _background;\n        public Brush Background\n        {\n            get\n            {\n                return _background;\n            }\n\n            set\n            {\n                _background = value;\n                OnPropertyChanged(\"Background\");\n            }\n        }\n        #endregion\n\n        #region ViewModelProperty: Message\n        private string _message;\n        public string Message\n        {\n            get\n            {\n                return _message;\n            }\n\n            set\n            {\n                _message = value;\n                OnPropertyChanged(\"Message\");\n            }\n        }\n        #endregion\n\n        public Window1()\n        {\n            InitializeComponent();\n            DataContext = this;\n\n            Background = new SolidColorBrush(Colors.Red);\n            Message = \"This is the title, the background should be \" + Background + \".\";\n\n            Message2.Background = new SolidColorBrush(Colors.Orange);\n\n        }\n\n        #region INotifiedProperty Block\n        public event PropertyChangedEventHandler PropertyChanged;\n\n        protected void OnPropertyChanged(string propertyName)\n        {\n            PropertyChangedEventHandler handler = PropertyChanged;\n\n            if (handler != null)\n            {\n                handler(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }\n        #endregion\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","treeview","selecteditem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13202061,"title":"Bind to DataTemplateSelector on selected TreeViewItem","body":"<p>I would like to bind different DataTemplates to a selected TreeViewItem based on a Property of the Item/Subitem. However, as it seems, the\nContentTemplateSelector only gets called once at the initialization from the window (at this time it is always null), but not during runtime when a item actually gets selected.\nAny idea how to solve this?</p>\n\n<pre><code>&lt;Window.Resources&gt;\n ...\n    &lt;DataTemplate x:Key=\"ItemSelected\"&gt;\n        &lt;StackPanel&gt;\n            &lt;TextBox Text=\"{Binding Path=Name, Mode=TwoWay}\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;DataTemplate x:Key=\"SubItemSelected\" &gt;\n        &lt;StackPanel&gt;\n            &lt;TextBox Text=\"{Binding Parent.Name}\" /&gt;\n            &lt;TextBox Text=\"{Binding Path=Name, Mode=TwoWay}\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;DataTemplate x:Key=\"Default\" &gt;\n        &lt;StackPanel&gt;\n            &lt;TextBox /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;local:MyTemplateSelector \n             FirstTemp=\"{StaticResource ItemSelected}\"\n             SecondTemp=\"{StaticResource SubItemSelected}\"\n             Default=\"{StaticResource Default}\"\n             x:Key=\"MySelector\"/&gt;\n\n&lt;/Window.Resources&gt;\n\n\n&lt;Grid&gt;\n&lt;Treeview x:Name=\"myTreeView\"&gt;\n ...\n&lt;/Treeview&gt;\n\n &lt;ContentControl Grid.Column=\"2\" ContentTemplateSelector=\"{StaticResource ResourceKey=MySelector}\"  DataContext=\"{Binding ElementName=myTreeView, Path=SelectedItem}\" /&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p><strong>The selector:</strong></p>\n\n<pre><code>public class MyTemplateSelector : DataTemplateSelector\n    {\n        public DataTemplate FirstTemp { get; set; }\n        public DataTemplate SecondTemp { get; set; }\n        public DataTemplate Default { get; set; }\n\n        public override DataTemplate SelectTemplate(object item, DependencyObject container)\n        {\n\n            if (item == null)\n                return Default;\n        }\n\n     }\n</code></pre>\n"},{"tags":["c#","wpf","datagrid","scroll","selecteditem"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13201474,"title":"DataGrid.ScrollIntoView() does not work, using DataGridTemplateColumn and MVVM","body":"<p>UserControl <code>DataGrid</code> XAML:</p>\n\n<pre><code>&lt;DataGrid x:Name=\"NamingConventionDataGrid\" Width=\"{Binding ElementName=toolbar, Path=ActualWidth}\" MinHeight=\"100\"\n     HorizontalAlignment=\"Left\" DockPanel.Dock=\"Bottom\"\n     VerticalScrollBarVisibility=\"Auto\" HorizontalScrollBarVisibility=\"auto\" \n     CanUserResizeRows=\"False\" CanUserAddRows=\"False\" CanUserSortColumns=\"True\" CanUserDeleteRows=\"False\"\n     CanUserReorderColumns=\"False\" CanUserResizeColumns=\"False\" Background=\"White\" BorderThickness=\"1\"\n     VerticalGridLinesBrush=\"{StaticResource RowGrayBrush}\" HorizontalGridLinesBrush=\"{StaticResource RowGrayBrush}\"\n     RowBackground=\"White\" AlternatingRowBackground=\"{StaticResource RowGrayBrush}\" AlternationCount=\"2\"\n     ColumnHeaderStyle=\"{StaticResource DataGridColumnHeaderStyle}\"\n     SelectedItem=\"{Binding SelectedName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"\n     AutoGenerateColumns=\"False\" SelectionMode=\"Single\" SelectionUnit=\"FullRow\"\n     RowHeaderWidth=\"15\" RowHeaderStyle=\"{StaticResource DataGridRowHeaderStyle}\" \n     ItemsSource=\"{Binding ReferenceValues, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"\n     MaxHeight=\"230\" ScrollViewer.CanContentScroll=\"True\" ScrollViewer.HorizontalScrollBarVisibility=\"Auto\" &gt;\n</code></pre>\n\n<p>ViewModel Code: </p>\n\n<pre><code> ReferenceValues = tempRefs;\n\n SelectedName = ReferenceValues.FirstOrDefault();\n _view.NamingConventionDataGrid.SelectedItem = SelectedName;\n _view.NamingConventionDataGrid.UpdateLayout();\n _view.NamingConventionDataGrid.ScrollIntoView(SelectedName);\n</code></pre>\n\n<p>When I call the <code>ScrollIntoView()</code> with the <code>SelectedItem</code> object {Binding}, it selects the object (I know this because other things on the WPF application change), but it doesn't scroll to where the object is, and the <code>SelectedItem</code> object isn't highlighted like when you click on the <code>DataGrid</code>. Am I missing some code sonewhere that will let me do scroll to where the <code>SelectedItem</code> is and also highlight it as if a user had scrolled to the item and clicked on the row?</p>\n"},{"tags":["c#","wpf","xml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13198954,"title":"MVVM design trouble","body":"<p>My problem is operating with a list and a listview. The Listview's itemsSource property is bound to a list in my class(say List).</p>\n\n<p>I want to both modify existing items and add new items to the list. For this reason, I've made text boxes for each element in the class Contact(name, surname, ...)</p>\n\n<p>Now If I want to modify the selected item, I set the Text property of each textbox to this:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding ElementName=listView1, Path=SelectedItem.Name}\"/&gt;\n</code></pre>\n\n<p>If I want to create new element. I've got to do this:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding ElementName=tempContact, Path=Name}\"/&gt;\n</code></pre>\n\n<p>where tempContact is an instance of the Contact class that is lately added to the list via a button.</p>\n\n<p>Problem is I want to do both adding and modifying the elements of this list and I need an idea. Could anyone give me a hand?</p>\n"},{"tags":["wpf","xaml"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13156389,"title":"How to use percentages on sizing in WPF components?","body":"<p>I was using WPF rectangles and need to re size when re-sizing the window. I tried several helps posted several places like using the star(\"*\") after the size but didn't work. Any help regarding this matter? </p>\n\n<pre><code> &lt;StackPanel&gt;\n   &lt;Rectangle Height=\"5\"&gt;\n   &lt;Rectangle Height=\"495\"&gt;\n     &lt;Rectangle.Fill&gt;\n       &lt;LinearGradientBrush StartPoint=\"0.5,0\" EndPoint=\"0.5,1\"&gt;\n         &lt;GradientStop Color=\"#F7F6EF\" Offset=\"0.0\"&gt;&lt;/GradientStop&gt;\n         &lt;GradientStop Color=\"#E5DABE\" Offset=\"1.0\"&gt;&lt;/GradientStop&gt;\n       &lt;/LinearGradientBrush&gt;\n     &lt;/Rectangle.Fill&gt;\n   &lt;/Rectangle&gt;\n &lt;/StackPanel&gt;\n</code></pre>\n"},{"tags":["wpf","mvvm","prism"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13198654,"title":"How do I solve the following design in the MVVM paradigm? (newb)","body":"<p>I'm still starting out with MVVM and read through all the MSDN Prism examples but I'd nonetheless like some guidance with the following design problem which I feel will help me latch onto the Prism concepts and reinforce what I just learnt</p>\n\n<p>I have a multi-window application - each window has a filter drop down control. The value of this filter control will affect the display of other controls within that same window, eg grids, charts etc.</p>\n\n<p>Certain interactions (eg double clicking a row on a grid) will spawn another window which will have its own separate filter control, which will similarly affect the display of other controls only within that window</p>\n\n<p>How do I implement this behavior of the filter driving the display of other user controls it has no idea of and have it restrict its behavior to only the window hosting it? How do I keep these interactions loosely coupled? </p>\n\n<p>I'm thinking I need to use the EventAggregator and for the filter control to publish an update event when the selection changes? Am I thinking about this the right way? Would each window need a separate EventAggregator?</p>\n"},{"tags":["c#","wpf","grid","viewport3d"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3096,"score":0,"question_id":1841489,"title":"Viewport 3D WPF C#","body":"<p>Can you please show how to set and save the background color of the viewport3D. Whenever I save no background is visible only model, I tried the grid but that gets everything in the grid? Any help will do?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13200785,"title":"Color Picker for Metro Style app?","body":"<p>I am trying to add ColorPicker to my metro style app. \nAfter making a little research , i have found that Extended WPF Toolkit contains ColorPicker. \nBut when i try to add the .dll file to my project via \"Add Reference\" it says:</p>\n\n<p><em>\"The project targets .NETCore while the file reference targets .NETFramework. This is not a supported scenario.\"</em></p>\n\n<p>My question is , How to add this .dll file? Is it possible to compile this .dll so that is targets .NETCore? \nAnd \nIs there any other(simple) way to implement a Color Picker in Metro Style App? </p>\n\n<p>(I am completely new with the concepts of wpf. Please correct me if i made any mistake. )</p>\n"},{"tags":["c#","wpf","process","oauth","webbrowser"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":515,"score":6,"question_id":9703299,"title":"How to close tab in external web browser?","body":"<p>I am writing a desktop application and in one part I go through OAuth 2.0 flow. </p>\n\n<p>The steps are:</p>\n\n<ol>\n<li>Start process - open web browser with login page.</li>\n<li>User logs in and authorize my app.</li>\n<li>In a background I search for process with a specific name, save it (name) in app.</li>\n<li>At the end I close the web browser.</li>\n</ol>\n\n<p>The problem is that if user had previously opened some tabs in web browser - in point 1. new tab is added and in point 4. everything is closed (web browser with all tabs).</p>\n\n<p>Can you tell me if there is a way to close a single tab in web browser? \nOr maybe there is other/easier way to go through OAuth?</p>\n\n<p>As a manual solution I will simply show info to the user “Now you can close this tab”, however I would like to do it automatically.</p>\n\n<p>This is C# .Net 4.0 WPF project.</p>\n\n<pre><code>string strAuthUrl = \"http://accounts.example.com/login\",\n       strAuthCode = string.Empty;\n\n// Request authorization from the user (by opening a browser window):\nProcessStartInfo startInfo = new ProcessStartInfo(strAuthUrl);\nstartInfo.CreateNoWindow = false;\n\n//1.        \nProcess.Start(startInfo);   \n//2. - is happening in web browser\n//3.        \ndo\n{\n    foreach (Process proc in Process.GetProcesses())\n    {\n        if (proc.MainWindowTitle.StartsWith(\"Success code=\"))\n        {\n            strAuthCode = proc.MainWindowTitle.ToString().Substring(13, 30);\n//4.\n            try\n            {\n\n                // Close process by sending a close message to its main window.\n                proc.CloseMainWindow();\n                // Free resources associated with process.\n                proc.Close();\n                // Wait 500 milisecs for exit\n                proc.WaitForExit(500);\n\n                //if proc has not exited so far - kill it\n                if (proc.HasExited == false)\n                {\n                    proc.Kill();\n                    proc.WaitForExit();\n                }\n            }\n            catch (Exception ex)\n            {\n                //Do something with exception\n            }\n\n            break;\n        }\n    }\n}\nwhile (string.IsNullOrEmpty(strAuthCode));\n</code></pre>\n\n<p>Thanks for your suggestions.</p>\n"},{"tags":["c#",".net","wpf","dll"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13200880,"title":"Get actual dll path in .Net","body":"<p>I have a dll named JIMS.Printing.dll which is placed inside the Reporting folder of the main application JIMS.exe.</p>\n\n<p>But I am getting an error when calling some files inside the Templates folder inside JIMS.Printing.dll code inside of Reporting which running JIMS.exe</p>\n\n<pre><code>JIMS.exe\n---------&gt;Reporting\n-------------------&gt;JIMS.Printing.dll\n-------------------&gt;Templates\n-----------------------------&gt; Files\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>string _templatePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetAssembly(typeof(JIMS.Printing.PrintInvoice)).Location), \"Templates\");\n</code></pre>\n\n<p>Code from JIMS.Printing.dll</p>\n\n<p>JIMS.exe looking for Files inside JIMS.exe Path\\Templates\\file,\nBut actually the file is in JIMS.Printing.dll Path\\Templates\\files</p>\n"},{"tags":["wpf",".net-3.5","styles"],"answer_count":2,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":20764,"score":17,"question_id":639809,"title":"How do I group items in a WPF ListView","body":"<p>I have a ListView that I want to group results into, however the examples I am finding are not working. How can I group my results?</p>\n\n<p>I want to group on the Status property in my custom object.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>&lt;ListView IsSynchronizedWithCurrentItem=\"True\"\n          ItemsSource=\"{Binding}\"\n          HorizontalContentAlignment=\"Stretch\"\n          ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"\n          Background=\"Transparent\" SelectionChanged=\"ListView_SelectionChanged\"\n          Name=\"lstShelvedOrders\"&gt;\n\n        &lt;ListView.GroupStyle&gt;\n            &lt;GroupStyle&gt;\n                &lt;GroupStyle.HeaderTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBlock FontWeight=\"Bold\" FontSize=\"15\"\n                         Text=\"{Binding Path=Status}\"/&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/GroupStyle.HeaderTemplate&gt;\n            &lt;/GroupStyle&gt;\n        &lt;/ListView.GroupStyle&gt;\n\n        &lt;ListView.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n                &lt;Setter Property=\"BorderThickness\" Value=\"1\" /&gt;\n                &lt;Setter Property=\"Width\" Value=\"Auto\" /&gt;\n                &lt;Setter Property=\"FontSize\" Value=\"10.4\"  /&gt;               \n            &lt;/Style&gt;\n        &lt;/ListView.ItemContainerStyle&gt;\n\n        &lt;ListView.View&gt;\n            &lt;GridView&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Number}\" Header=\"Shelve ID\"  /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Customer}\" Header=\"Customer\" /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=PurchaseOrderNo}\" Header=\"PO Number\" /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=SubmittedBy}\" Header=\"Shelved By\"  /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=OrderDate, StringFormat=MMM dd\\, yyyy}\" Header=\"Date\"  /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=CustomerTerms.Description}\" Header=\"Order Terms\"  /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=ShippingMethod.Description}\" Header=\"Shipping\"  /&gt;\n                &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=TotalPrice, StringFormat=c}\" Header=\"Order Total\"  /&gt;\n            &lt;/GridView&gt;\n        &lt;/ListView.View&gt;\n    &lt;/ListView&gt;\n\n void ShelvedOrderList_DataContextChanged(object sender, System.Windows.DependencyPropertyChangedEventArgs e)\n {\n     AddGrouping();\n }\n\n private void AddGrouping()\n {\n     if ( lstShelvedOrders.ItemsSource == null)\n     {\n         return;\n     }\n\n     CollectionView myView = (CollectionView)CollectionViewSource.GetDefaultView(lstShelvedOrders.ItemsSource);\n     PropertyGroupDescription groupDescription = new PropertyGroupDescription(\"Status\");\n     myView.GroupDescriptions.Add(groupDescription);\n }\n</code></pre>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":256,"score":0,"question_id":11085788,"title":"How to get selectedItem from ListView from a button click in the listView Item","body":"<p>I have a list view item which has a button and displays properties on an object. I have the command property set up for the button using the mvvm pattern which fires correctly. </p>\n\n<p>My issues is that when a press the button it does not also get the selected item, I am guessing that it has not fired the selectedItem event.</p>\n\n<p>Is it possible to force this event when the button is pressed?</p>\n\n<pre><code> &lt;Button \n         Height=\"20\"\n         Width=\"20\"\n         Grid.Column=\"3\"\n         Grid.Row=\"0\"\n         Command=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.RemoveClick}\"\n         CommandParameter=\"{Binding SelectedItem, ElementName=serverListView, Mode=TwoWay}\"&gt;\n</code></pre>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13198789,"title":"Non-Expanding TextBox / ScrollViewer","body":"<p>I am attempting to place a TextBox control in a sizeable panel (using the GridSplitter).</p>\n\n<p>The first issue I experienced was that the TextBox was automatically sizing as the text being entred became lengthy.  I found a solution on this site that wraps the TextBox with a Border and then sets the Width of the TextBox to that of the Border (as displayed in the XAML below).  This appears to be working.  I mention this in case it is the cause of the issue that I am seeking help on.</p>\n\n<p>The current issue is that the TextBox resizes up but the ScrollViewer kicks in immediately when the panel is resized down.  What I would like to see is the ScrollViewer kick in when the TextBox is sized down to the minimum width (and not before).</p>\n\n<p>The complete XAML that I am currently using is below.</p>\n\n<pre><code>&lt;Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" x:Class=\"NonExpandingTextBoxDemo.MainWindow\" Height=\"350\" Title=\"MainWindow\" Width=\"525\"&gt;\n  &lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n      &lt;ColumnDefinition Width=\"Auto\" /&gt;\n      &lt;ColumnDefinition Width=\"Auto\" /&gt;\n      &lt;ColumnDefinition Width=\"*\" /&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Grid.RowDefinitions&gt;\n      &lt;RowDefinition Height=\"*\" /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;ScrollViewer Grid.Column=\"0\" Grid.Row=\"0\" HorizontalAlignment=\"Stretch\" HorizontalScrollBarVisibility=\"Auto\" VerticalAlignment=\"Stretch\" VerticalScrollBarVisibility=\"Auto\"&gt;\n      &lt;Border HorizontalAlignment=\"Stretch\" Margin=\"20, 20, 20, 20\" MinWidth=\"100\" VerticalAlignment=\"Center\"&gt;\n        &lt;TextBox Width=\"{Binding Mode=OneWay, Path=ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type Border}, Mode=FindAncestor}}\" /&gt;\n      &lt;/Border&gt;\n    &lt;/ScrollViewer&gt;\n    &lt;GridSplitter Grid.Column=\"1\" Grid.Row=\"0\" ResizeBehavior=\"PreviousAndNext\" VerticalAlignment=\"Stretch\" Width=\"3\" /&gt;\n    &lt;TextBlock Grid.Column=\"2\" Grid.Row=\"0\" HorizontalAlignment=\"Center\" Text=\"Right Panel\" VerticalAlignment=\"Center\" /&gt;\n  &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The question is what am I missing?  I have tried several things but nothing seems to work.</p>\n\n<p>Thank you in advance for any guidance on this issue.</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13144461,"title":"WPF textbox binding not working when using stringformat","body":"<p>Here is my problem:</p>\n\n<p>I had a textbox that was using textbox preview and doing some validation on the text entered. The textbox is bound to a double property. Originally when a user entered a number with a decimal it would crash because when it is updating after every key stroke when the number was 1. it was automatically changed to 1 (removing the decimal) and when adding the next number after the decimal it would think the position to insert the new character is position 3 but since the decimal was automatically removed there is no longer a position 3  it errors out. I fixed this by adding <code>StringFormat={}{0:d}</code> to the xaml. This worked fine except for the fact that when everything loads for the first time the original value no longer shows up (the value from the database). But if I remove only the StringFormat the value will load but then I have the crashing problem again. </p>\n\n<p>Any ideas?</p>\n\n<pre><code> &lt;TextBox Grid.Column=\"1\" Margin=\"0\" VerticalAlignment=\"Top\"\n                             Controls:TextBoxMask.NumericType=\"Double\"\n                             Text=\"{Binding Path=Model.Processor.BulkShiftInMilliseconds, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:d}}\"/&gt;\n</code></pre>\n"},{"tags":["c#","wpf","drawing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":83,"score":1,"question_id":13199514,"title":"Drawing line \"slowly\" programmatically with wpf","body":"<p>I have multiple points and I want to draw lines connecting that points with WPF, but I want to see them drawing slowly, and I need to do that programmatically, how can I do that?<br/>\nThanks.</p>\n"},{"tags":[".net","wpf","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13125498,"title":"Ideas on how to implement bulk edit with the Wpf DataGrid?","body":"<p>(Major question update)</p>\n\n<p>Goal: the ability to select a range of cells (or rows). Update one cell and have that update cascade to all applicable cells (e.g. cells in the same column )</p>\n\n<p>Would also like the Excel behavior of using Enter to commit and move to next cell without losing the selected range.</p>\n\n<p>Tried doing this with the Wpf Datagrid control.. and the result is a kludge..</p>\n\n<ul>\n<li>The datagrid supports multi-selection using Ctrl / Shift.</li>\n<li>However on entering edit mode (irrespective of SelectionMode and Unit), all other rows are deselected leaving the one being edited as the sole selection. Worked around this by hooking into Mouse-Preview events and caching multiselection if any. Added an IsSelected property to my row ViewModels and used them to modify selected rows at will.</li>\n<li>Edits are committed only after the user tabs out. Used binding with UpdateSourceTrigger set to PropertyChanged. Applied current edit to cached multiselection using a ContainerVm which listened to PropertyChangeNotifications from the RowViewModels.</li>\n<li>DataGrid events were not helpful - by the time BeginningEdit is called, the selection was already modified by the MouseDown handler in DataGridCell.</li>\n</ul>\n\n<p>So Grid events and styling haven't helped. Nor has the ViewModel approach. Another option to try out is to write a derivation of DataGridCell and plug it in somehow.</p>\n\n<p>Ideas ?</p>\n"},{"tags":["wpf","binding","xelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13198905,"title":"How to keep bindings when serializing a WPF usercontrol into an XElement","body":"<p>I'm trying to serialize a custom WPF user control that features a grid with a textblock that is bound to a dependency property named \"Frequency\". The snippet that defines the textblock is as follows (the definition of the user control is quite lengthy to post it here!):</p>\n\n<pre><code>&lt;TextBlock x:Name=\"FrequencyText\" Grid.Row=\"1\" Grid.Column=\"1\" Grid.ColumnSpan=\"2\"\n                               FontFamily=\"Arial Rounded MT\"\n                               Foreground=\"White\" FontSize=\"10\" FontWeight=\"DemiBold\" Margin=\"3\"\n                               TextBlock.Text=\"{Binding Frequency, ElementName=FrequencyButtonControlA, Path=Frequency}\"\n                               TextAlignment=\"Center\" VerticalAlignment=\"Center\" HorizontalAlignment=\"Left\" /&gt;\n</code></pre>\n\n<p>I'm working on an editor tool that enables the user to arrange some custom controls into a canvas and change their properties and I need to provide the user with the capability to clone an existing element. In order to do this, I'm serializing the control into an XElement and instantiating a new one afterwards. The code to perform the serialization is as follows:</p>\n\n<pre><code>var contentXaml = (commsPanelItem.Content != null) ? XamlWriter.Save(commsPanelItem.Content) : string.Empty;\nvar serializedItem = new XElement(\n\"CommsPanelItem\",\nnew XElement(\"Type\", commsPanelItem.GetType().ToString()),\nnew XElement(\"Left\", Canvas.GetLeft(commsPanelItem.UIElement)),\nnew XElement(\"Top\", Canvas.GetTop(commsPanelItem.UIElement)),\nnew XElement(\"Width\", commsPanelItem.Width),\nnew XElement(\"Height\", commsPanelItem.Height),\nnew XElement(\"zIndex\", Panel.GetZIndex(commsPanelItem.UIElement)),\nnew XElement(\"Content\", contentXaml),\ncommsPanelItem.GetAttributesForSavingPanelInConfigurator() as XElement);\nreturn serializedItem;\n</code></pre>\n\n<p>The problem I'm having is that, when serializing the textblock, the \"Text\" field doesn't preserve the binding to the \"Frequency\" dependency property, it just gets exported with the value assigned by the user (\"131.5\" in the following example):</p>\n\n<pre><code>TextBlock Text=\"131.5\" FontFamily=\"Arial Rounded MT\" FontWeight=\"SemiBold\" FontSize=\"10\" Foreground=\"#FFFFFFFF\" TextAlignment=\"Center\" Name=\"FrequencyText\" Margin=\"3,3,3,3\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Center\" Grid.Column=\"1\" Grid.Row=\"1\" Grid.ColumnSpan=\"2\"\n</code></pre>\n\n<p>My question is: is there any way to be able to serialize dependency property's binding instead of the actual value?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13197428,"title":"render wpf control on screen one by one with some delay","body":"<p>I am trying a little animation in my wpf application.<br>There is a WPF Form that contain 5 rectangular shape <code>Border</code> and i want then to load with little delay.<br></p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>&lt;StackPanel&gt;\n&lt;Border name=\"Border1\"/&gt;\n&lt;Border name=\"Border2\"/&gt;\n&lt;Border name=\"Border3\"/&gt;\n&lt;Border name=\"Border4\"/&gt;\n&lt;Border name=\"Border5\"/&gt;\n&lt;/stackpanel&gt;\n</code></pre>\n\n<p>I just want to render them on screen one by one with some delay.</p>\n"},{"tags":["c#","wpf","object","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":28,"score":-2,"question_id":13198623,"title":"C# WPF application datagrid error: object reference not set to an instance","body":"<p>I am a newbie with datagrids in WPF C#.\nI have two datagrids on two different tab controls.\nNow one of them works (which means I am able to dynamically create and add columns and access datagrid1 and its methods)\nWhile with other one datagrid2 I am not able to do the above in any private methods. (I copy pasted datagrid1 properties and renamed it datagrid2)\nHowever with datagrid2, when I use inside the Windows_Loaded method, I am able to do these things.\nWhat am I doing wrong?\nHere's the code:</p>\n\n<pre><code>&lt;my3:DataGrid AutoGenerateColumns=\"False\" CanUserAddRows=\"False\" \nCanUserDeleteRows=\"False\" Block.TextAlignment=\"Center\" HeadersVisibility=\"Column\"  \nAlternationCount=\"2\" ItemsSource=\"{Binding}\" IsReadOnly=\"True\" \nAlternatingRowBackground=\"LightYellow\" Margin=\"6,57.772,12.489,6\" Name=\"datagrid2\" \nxmlns:my3=\"http://schemas.microsoft.com/wpf/2008/toolkit\"&gt;\n&lt;/my3:DataGrid&gt;\n</code></pre>\n"},{"tags":[".net","wpf","wpf-usercontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13197528,"title":"Put a border on the grid in WPF","body":"<p>Is there a way to put a border on the grid without surrounding the grid the Border element?</p>\n\n<pre><code>&lt;Border Margin=\"{Binding ElementName=thisUserControl, Path=PrintMargin}\"\n        BorderThickness=\"{Binding ElementName=thisUserControl, \n                             Path=PrintMarginThickness}\"\n        BorderBrush=\"LightGray\"&gt;\n    &lt;Grid x:Name=\"mainGrid\"\n          Background=\"{Binding ElementName=thisUserControl, Path=Background}\" /&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p>Could I use something like \"BitmapEffect\" on the grid or stuff like this?\nI just need to display or not a border named \"PrintMargin\" on my WpfUserControl...</p>\n\n<p>This border should or not be visible and also perhaps I need to control its <strong>Thickness</strong> and maybe <strong>Color</strong>(Brush)...</p>\n"},{"tags":["c#","wpf","listview","styles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13198580,"title":"Remove black border style from ListView Selected item","body":"<p>I am trying to create a custom control like the one described in at: <a href=\"http://stackoverflow.com/a/13188979/637142\">http://stackoverflow.com/a/13188979/637142</a></p>\n\n<p>So far I have a listview as:</p>\n\n<pre><code>&lt;ListView Name=\"listBox1\"&gt;\n\n        &lt;!-- Place items horizontaly --&gt;\n        &lt;ListView.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\" &gt;&lt;/StackPanel&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListView.ItemsPanel&gt;\n\n        &lt;ListView.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n                &lt;Style.Resources&gt;                        \n                    &lt;!-- Background for Selected ListViewItem --&gt;\n                    &lt;SolidColorBrush x:Key=\"{x:Static SystemColors.HighlightBrushKey}\"\n                             Color=\"Yellow\"/&gt;\n                &lt;/Style.Resources&gt;\n            &lt;/Style&gt;\n        &lt;/ListView.ItemContainerStyle&gt;\n\n        &lt;!-- The items on the listview  --&gt;\n        &lt;ListView.Items&gt;\n            &lt;TextBlock Margin=\"5\"&gt;Test1&lt;/TextBlock&gt;\n            &lt;TextBlock Margin=\"5\"&gt;Test2&lt;/TextBlock&gt;\n            &lt;TextBlock Margin=\"5\"&gt;Test3&lt;/TextBlock&gt;\n        &lt;/ListView.Items&gt;\n\n&lt;/ListView&gt;\n</code></pre>\n\n<p>The only problem that I have now is when the user selects a item with the arrow keys. For example if I select a item with the mouse this is how it looks:</p>\n\n<p><img src=\"http://i.stack.imgur.com/yzxyw.png\" alt=\"enter image description here\"></p>\n\n<p>But if I select the same item with the arrow keys this is how it looks:</p>\n\n<p><img src=\"http://i.stack.imgur.com/LNbos.png\" alt=\"enter image description here\"></p>\n\n<p><strong>How can I remove the black dotted border from the selected item!</strong> </p>\n\n<p>I do not want to add the previewKeyDown event and then handle it like</p>\n\n<pre><code> if (e.Key == Key.Left)\n {\n         listBox1.SelectedIndex--;\n         e.Handled = true;\n }\n else if (e.Key == Key.Right)\n {\n         listBox1.SelectedIndex++;\n         e.Handled = true;\n }\n</code></pre>\n\n<p>Because I will also like to be able to select multiple items with the shift key.</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":3201,"score":7,"question_id":4080037,"title":"WPF DataGrid AutoSize Issue","body":"<p>I`ve recently been trying to get text wrapping working within a WPF (C/4.0) DataGrid, and no matter which solution I implement (All use some form of TextBlock inside a template with wrapping) it confuses the auto height of the grid and results in excessive white space (Set to Yellow for visibility sake) at the bottom of the grid.</p>\n\n<p>My Code: (Commented code is alternate solution to text wrapping, but still results in excessive space)</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;DataGrid Grid.Row=\"0\" AutoGenerateColumns=\"False\" ColumnWidth=\"*\" Name=\"dgFamilyHistories\" IsReadOnly=\"True\" \n                          HorizontalScrollBarVisibility=\"Disabled\" \n                      ItemsSource=\"{Binding Path=Patient.FamilyHistories}\" RowDetailsVisibilityMode=\"Visible\"\n                      GridLinesVisibility=\"All\"&gt;\n        &lt;DataGrid.Resources&gt;\n            &lt;Style TargetType=\"{x:Type DataGridRow}\"&gt;\n                &lt;Setter Property=\"Height\" Value=\"Auto\"/&gt;\n            &lt;/Style&gt;\n            &lt;!--&lt;Style TargetType=\"{x:Type DataGridCell}\"&gt;\n                &lt;Setter Property=\"Template\"&gt;\n                    &lt;Setter.Value&gt;\n                        &lt;ControlTemplate TargetType=\"{x:Type DataGridCell}\"&gt;\n                            &lt;Border Name=\"border\"&gt;\n                                &lt;ContentControl Content=\"{TemplateBinding Content}\"&gt;\n                                    &lt;ContentControl.ContentTemplate&gt;\n                                        &lt;DataTemplate&gt;\n                                            &lt;DockPanel&gt;\n                                                &lt;TextBlock TextWrapping=\"WrapWithOverflow\" TextTrimming=\"CharacterEllipsis\"  \n                                                         Width=\"Auto\" Height=\"Auto\" Text=\"{Binding Text}\"/&gt;\n                                            &lt;/DockPanel&gt;\n                                        &lt;/DataTemplate&gt;\n                                    &lt;/ContentControl.ContentTemplate&gt;\n                                &lt;/ContentControl&gt;\n                            &lt;/Border&gt;\n                        &lt;/ControlTemplate&gt;\n                    &lt;/Setter.Value&gt;\n                &lt;/Setter&gt;\n            &lt;/Style&gt;--&gt;\n        &lt;/DataGrid.Resources&gt;\n        &lt;DataGrid.Background&gt;\n            &lt;SolidColorBrush Color=\"Yellow\" /&gt;\n        &lt;/DataGrid.Background&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn Header=\"Date\" Binding=\"{Binding DateEntered, StringFormat={}{0:dd/MM/yyyy}}\" Width=\"85\"/&gt;\n            &lt;!--&lt;DataGridTextColumn Header=\"Relation\" Binding=\"{Binding Relation}\"/&gt;--&gt;\n            &lt;DataGridTemplateColumn Header=\"Relation\"&gt;\n                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock TextTrimming=\"CharacterEllipsis\" TextWrapping=\"Wrap\" Text=\"{Binding Path=Relation}\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;/DataGridTemplateColumn&gt;\n            &lt;!--&lt;DataGridTextColumn Header=\"Illness\" Binding=\"{Binding Illness}\"/&gt;--&gt;\n            &lt;DataGridTemplateColumn Header=\"Illness\"&gt;\n                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock TextTrimming=\"CharacterEllipsis\" TextWrapping=\"Wrap\" Text=\"{Binding Path=Illness}\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;/DataGridTemplateColumn&gt;\n            &lt;!--&lt;DataGridTextColumn Header=\"Health\" Binding=\"{Binding Health}\"/&gt;--&gt;\n            &lt;DataGridTemplateColumn Header=\"Health\"&gt;\n                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock TextTrimming=\"CharacterEllipsis\" TextWrapping=\"Wrap\" Text=\"{Binding Path=Health}\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTextColumn Header=\"Birth Date\" Binding=\"{Binding DateOfBirth, StringFormat={}{0:dd/MM/yyyy}}\" Width=\"85\"/&gt;\n            &lt;DataGridTextColumn Header=\"Death Date\" Binding=\"{Binding DateOfDeath, StringFormat={}{0:dd/MM/yyyy}}\" Width=\"85\"/&gt;\n            &lt;!--&lt;DataGridTextColumn Header=\"Death Cause\" Binding=\"{Binding CauseOfDeath}\"/&gt;--&gt;\n            &lt;DataGridTemplateColumn Header=\"Death Cause\"&gt;\n                        &lt;DataGridTemplateColumn.CellTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock TextTrimming=\"CharacterEllipsis\" TextWrapping=\"Wrap\" Text=\"{Binding Path=CauseOfDeath}\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTextColumn Header=\"Age\" Binding=\"{Binding Age}\" Width=\"50\"/&gt;\n        &lt;/DataGrid.Columns&gt;\n        &lt;DataGrid.RowDetailsTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;Label Name=\"lblDetails\" Content=\"{Binding Path=Comments}\" ContentStringFormat=\"{}Comments: {0}\" Margin=\"15,0,0,0\"/&gt;\n                &lt;DataTemplate.Triggers&gt;\n                    &lt;DataTrigger Binding=\"{Binding Path=Comments, Converter={Converters:IsNullStringConverter}}\" Value=\"True\"&gt;\n                        &lt;Setter TargetName=\"lblDetails\" Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n                    &lt;/DataTrigger&gt;\n                &lt;/DataTemplate.Triggers&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/DataGrid.RowDetailsTemplate&gt;\n    &lt;/DataGrid&gt;\n    &lt;DockPanel Grid.Row=\"1\" Background=\"Blue\"&gt;\n\n    &lt;/DockPanel&gt;\n&lt;/Grid&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13194168,"title":"Create new ViewB + ViewmodelB in other ViewModelA and show them in ViewA","body":"<p>I use MVVM. I have a ViewA with a Grid in xaml and a ViewModelA. In the ViewModelA I have a Method that looks like this which is called on a Button click:</p>\n\n<pre><code>public void ButtonClickMethod()\n{\n    ViewB viewB = new ViewB();\n    viewB.DataContext = new ViewBViewModel();\n}\n</code></pre>\n\n<p>How do I add all the created viewBs into the Grid on my ViewA, so I can see them there? Or is my solution wrong in general maybe?</p>\n\n<p><strong>EDIT :</strong></p>\n\n<p>I now used a <code>ObservableCollection&lt;ViewB&gt;</code> in my ViewModelA which notifies on changes in my ViewA xaml at </p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding ObservableCollection&lt;ViewB&gt;}\" /&gt;\n</code></pre>\n\n<p>The only problem is the ViewBs shown in the ItemControl should be dragable. Therefore I used expression blend's </p>\n\n<p><code>Interaction.GetBehaviors(ViewB).Add(new MouseDragElementBehavior() { });</code></p>\n\n<p>when i create a new ViewB. But it doesn't work.</p>\n\n<p><strong>EDIT2 :</strong></p>\n\n<p>I tried this solution but it doesn't work for me :( <a href=\"http://stackoverflow.com/questions/6358774/using-mousedragelementbehavior-with-an-itemscontrol-and-canvas\">Using MouseDragElementBehavior with an ItemsControl and Canvas</a></p>\n"},{"tags":["wpf","openxml-sdk","wordprocessingml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13195139,"title":"Insert RTF string into Ms Word using Open XML","body":"<p>I have a table in SQL Server that contains RTF code like this:</p>\n\n<pre><code>{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Tahoma;}}\n\\viewkind4\\uc1\\pard\\f0\\fs17 Lintel Inspection\n\\par }\n</code></pre>\n\n<p>I then have a template word document that I need to insert this into and just wondering how to do that using OpenXML SDK?</p>\n\n<p>I know a bit like \"altChunks\" is used but not sure how.</p>\n\n<p>Any coding reference also works. I had searched around but with no luck.</p>\n"},{"tags":["wpf","datetime","localization"],"answer_count":5,"favorite_count":12,"up_vote_count":31,"down_vote_count":0,"view_count":10747,"score":31,"question_id":520115,"title":"StringFormat Localization problem","body":"<p>In WPF 3.5SP1 i use the last feature StringFormat in DataBindings:</p>\n\n<pre><code> &lt;TextBlock Text=\"{Binding Path=Model.SelectedNoteBook.OriginalDate, StringFormat='f'}\"\n                                   FontSize=\"20\"\n                                   TextTrimming=\"CharacterEllipsis\" /&gt;\n</code></pre>\n\n<p>The problem I face is that the date is always formated in English...although my system is in French ? How can i force the date to follow system date ?</p>\n\n<p>thankd\nJonathan</p>\n"},{"tags":["wpf","animation","effect"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":561,"score":0,"question_id":3430659,"title":"Is there a WPF Typewriter effect?","body":"<p>Is there any equivalent to Flash's Typewriter effects in WPF?</p>\n"},{"tags":["c#",".net","wpf","app-config","enterprise-library"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195135,"title":"App.Config Resolution Failure","body":"<p>I have a C# WPF application that is experiencing a weird issue.   The app uses the MS Enterprise Library (Logging) which is configured using the app.config.  My deployed files hence are: </p>\n\n<p>(names changed, filename lengths correct)</p>\n\n<p>XXXXXXXXXXX.EXE</p>\n\n<p>XXXXXXXXXXX.EXE.CONFIG</p>\n\n<p>Normally this works just fine.  However, in one bizarre situation the app is  launched by another program that calls the EXE based on it's shortname (XXXXXX~X.EXE).  The EXE starts but then proceeds to look for an app.config that doesn't exist (XXXXXX~X.EXE.CONFIG ) and the Logging class fails to initialize.</p>\n\n<p>I can't change the program that launches us so I'm trying to figure out ways guarding against this in my WPF code.  Thoughts are...</p>\n\n<p>1) Rename my EXE and create a man in the middle EXE.</p>\n\n<p>2) Detect how my EXE was launched and relaunch it correctly.</p>\n\n<p>3) Some kind of AppDomain / ConfigurationManager repointing  ( Is this possible? )</p>\n\n<p>4) Use the installer to clone the App.Config to the short file name version (confirmed works)</p>\n\n<p>Has anyone ever seen this before and have any suggestions / insight?</p>\n"},{"tags":["wpf","resharper"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13176248,"title":"WPF merged resource dictionaries in every user control - bad idea?","body":"<p>I keep my app's resources in a separate DLL and reference them in my main EXE using something like this in App.xaml:-</p>\n\n<pre><code>&lt;ResourceDictionary.MergedDictionaries&gt;\n    &lt;ResourceDictionary Source=\"pack://application:,,,/MyThemesAssembly;component/Themes/Generic.xaml\"/&gt;\n&lt;/ResourceDictionary.MergedDictionaries&gt;\n</code></pre>\n\n<p>When I edit a window that's in the main EXE project, the VS2010 designer doesn't recognise any resources from the other assembly, so I don't see any styling applied (not really an issue as I always work in the XAML view). However Resharper doesn't recognise these external resource names either, resulting in lots of squiggles under resource names when I'm editing XAML.</p>\n\n<p>I've found that I can fix both the VS designer and Resharper by including the above XAML in each window and user control, but is this going to have an adverse effect on memory and/or performance? Will each window get a separate copy of the resources?</p>\n"},{"tags":["wpf","button"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":3524,"score":5,"question_id":1975144,"title":"Wpf - Default Button not Working as Expected","body":"<p>I'm having a problem with the default <code>Button</code> in the xaml code below:</p>\n\n<pre><code>&lt;Window x:Class=\"WebSiteMon.Results.Views.GraphicSizeSelectPopUp\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:commonWPF=\"http://rubenhak.com/common/wpf\"\n        xmlns:WPF=\"clr-namespace:Bennedik.Validation.Integration.WPF;assembly=Bennedik.Validation.Integration.WPF\" \n        ResizeMode=\"NoResize\" WindowStyle=\"ThreeDBorderWindow\" SizeToContent=\"WidthAndHeight\"&gt;\n&lt;Window.Resources&gt;\n    &lt;Style TargetType=\"{x:Type TextBox}\"&gt;\n        &lt;Setter Property=\"Validation.ErrorTemplate\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate&gt;\n                    &lt;Border BorderBrush=\"Red\" BorderThickness=\"2\" &gt;\n                        &lt;AdornedElementPlaceholder /&gt;\n                    &lt;/Border&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"Validation.HasError\" Value=\"true\"&gt;\n                &lt;Setter Property=\"ToolTip\"\n        Value=\"{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors)[0].ErrorContent}\"/&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n&lt;WPF:ErrorProvider x:Name=\"UrlDataErrorProvider\" RulesetName=\"RuleSetA\" &gt;\n    &lt;Grid Background=\"{DynamicResource WindowBackgroundBrush}\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"25\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n        &lt;/Grid.RowDefinitions&gt;\n\n        &lt;RadioButton Grid.ColumnSpan=\"2\" Margin=\"10\" Name=\"radioButton1\" Content=\"640 x 480 pixels\" \n                 Command=\"{Binding SelectSizeRb}\"  CommandParameter=\"640,480\"/&gt;\n        &lt;RadioButton Grid.ColumnSpan=\"2\" Margin=\"10\" Name=\"radioButton2\" Content=\"800 x 600 pixels\" \n                 Command=\"{Binding SelectSizeRb}\"  CommandParameter=\"800,600\" Grid.Row=\"1\" IsChecked=\"True\" /&gt;\n        &lt;RadioButton Grid.ColumnSpan=\"2\" Margin=\"10\" Name=\"radioButton3\" Content=\"1024 x 768 pixels\" \n                 Command=\"{Binding SelectSizeRb}\"  CommandParameter=\"1024,768\" Grid.Row=\"2\" /&gt;\n        &lt;RadioButton Grid.ColumnSpan=\"2\" Margin=\"10\" Name=\"radioButton4\"  \n                 Command=\"{Binding SelectSizeRb}\"  CommandParameter=\"0,0\" Grid.Row=\"3\" /&gt;\n\n        &lt;Button Grid.Column=\"1\" Grid.ColumnSpan=\"1\" Grid.Row=\"5\" Margin=\"5\" Name=\"BtnOk\" IsDefault=\"True\"&gt;Ok&lt;/Button&gt;\n        &lt;Button Grid.Column=\"2\" Grid.ColumnSpan=\"1\" Grid.Row=\"5\" Margin=\"5\" Name=\"BtnCancel\" IsCancel=\"True\"&gt;Cancel&lt;/Button&gt;\n\n    &lt;/Grid&gt;\n&lt;/WPF:ErrorProvider&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>I call the above window using the following code:</p>\n\n<pre><code>var p = new GraphicSizeSelectPopUp();\nvar result = p.ShowDialog() ?? false;\np.Close();\n</code></pre>\n\n<p>I'm using this as a <code>Popup</code> window in my application to get some info from the user. My problem is the when I click on the <code>OK</code> button, nothing happens.  The <code>Cancel</code> button works exactly as expected, meaning that control returns in the calling program from the <code>ShowDialog</code> method.  </p>\n\n<p>As I understand WPF (still newbie), all I have to do is set the <code>IsDefault</code> property to true for the default button to do the same.  However, this is not what I'm seeing.  When I set a breakpoint on the line after the <code>ShowDialog</code> method, it is not hit when I press the okay button.  Only when I press the <code>Cancel</code> button or close the window.</p>\n\n<p>Suggestions for the uninformed?</p>\n"},{"tags":["c#","wpf","data-binding","treeview","recursive-databinding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13196892,"title":"Recursive databinding on treeview","body":"<p>I want to view a folder structure in a treeview using a databinding. \nThe folder class just has a property list of children and a property name.</p>\n\n<p>If something changes it will fire the according event.\nThis is it:</p>\n\n<pre><code>    public class Folder : INotifyPropertyChanged, INotifyCollectionChanged\n    {    \n        public event PropertyChangedEventHandler PropertyChanged;           \n        public event NotifyCollectionChangedEventHandler CollectionChanged; \n\n        public Folder(string name)\n        {\n            this.Name = name;\n            this.ContentFolders = new List&lt;Folder&gt;();\n        }\n\n        public List&lt;Folder&gt; ContentFolders { get; set; }\n\n        public void AddFolder(Folder f)\n        {\n            this.ContentFolders.Add(f);\n\n            if (this.CollectionChanged != null)\n            {\n                this.NotifyCollectionChanged(\n                      new NotifyCollectionChangedEventArgs(\n                          NotifyCollectionChangedAction.Add, f));\n            }\n            this.PropertyChanged(this, new PropertyChangedEventArgs(\"ContentFolders\"));\n        }\n\n        private void NotifyCollectionChanged(NotifyCollectionChangedEventArgs e)\n        {\n            lock (CollectionChanged)\n            {\n                if (CollectionChanged != null)\n                {\n                    Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() =&gt; CollectionChanged(this, e)));\n                }\n            }\n        }\n\n        private string name;\n\n        public string Name\n        {\n            get\n            {\n                return this.name;\n            }\n            set\n            {\n                if (this.name != value)\n                {\n                    this.name = value;\n                    if (PropertyChanged != null)\n                    {\n                        PropertyChanged(\n                            this, new PropertyChangedEventArgs(\"Name\"));\n                    }\n                }\n            }\n        }\n\n    }\n</code></pre>\n\n<p>This is my GUI, which shows the root folder in a treeview:</p>\n\n<pre><code>    &lt;Window x:Class=\"WpfApplication2.MyWindow\" xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n            xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" xmlns:WpfApplication2=\"clr-namespace:WpfApplication2\"\n            Title=\"MyWindow\" Height=\"300\" Width=\"300\" xmlns:u=\"clr-namespace:UpdateControls.XAML;assembly=UpdateControls.XAML\"&gt;\n      &lt;StackPanel&gt;\n        &lt;StackPanel.Resources&gt;\n          &lt;HierarchicalDataTemplate DataType=\"{x:Type WpfApplication2:Folder}\"\n                                    ItemsSource=\"{Binding Path=ContentFolders}\"&gt;\n            &lt;TextBlock Text=\"{Binding Path=Name}\" /&gt;\n          &lt;/HierarchicalDataTemplate&gt;\n        &lt;/StackPanel.Resources&gt;\n        &lt;TreeView Name=\"TreeviewScenario\"&gt;\n          &lt;TreeViewItem Header=\"{Binding Path=RootFolder.Name}\"\n                        ItemsSource=\"{Binding Path=RootFolder.ContentFolders}\" /&gt;\n        &lt;/TreeView&gt;\n        &lt;Button Content=\"Add Folder\" Click=\"Button_Click\" /&gt;\n      &lt;/StackPanel&gt;\n    &lt;/Window&gt;\n</code></pre>\n\n<p>The according MyWindow.xaml.cs class has a property Folder and adds some content. It has also a method for the button to add a new folder if it becomes clicked.</p>\n\n<pre><code>public partial class MyWindow : Window\n{\n    public Folder RootFolder { get; set; }\n\n    public MyWindow()\n    {\n        this.RootFolder = new Folder(\"root\");\n        this.RootFolder.ContentFolders.Add(new Folder(\"1\"));\n        this.RootFolder.ContentFolders.Add(new Folder(\"12\"));\n        this.RootFolder.ContentFolders.Add(new Folder(\"13\"));\n        this.RootFolder.ContentFolders.Add(new Folder(\"14\"));\n        this.RootFolder.ContentFolders.Add(new Folder(\"15\"));\n\n        Folder aFolder = new Folder(\"aFolder\");\n        aFolder.ContentFolders.Add(new Folder(\"2\"));\n        aFolder.ContentFolders.Add(new Folder(\"21\"));\n        aFolder.ContentFolders.Add(new Folder(\"22\"));\n        aFolder.ContentFolders.Add(new Folder(\"23\"));\n        aFolder.ContentFolders.Add(new Folder(\"24\"));\n\n        this.RootFolder.ContentFolders.Add(aFolder);\n\n        this.DataContext = this;\n        InitializeComponent();\n    }\n\n    private void Button_Click(object sender, RoutedEventArgs e)\n    {\n        Folder c = new Folder(\"a new Folder\");\n        this.RootFolder.AddFolder(c);\n    }\n}\n</code></pre>\n\n<p>The Gui will be calles by a simple Main method with:</p>\n\n<pre><code>    new MyWindow();\n</code></pre>\n\n<p>If I start, the treeview looks fine, it has all the items, which have been added in the MyWindow.xaml.cs. </p>\n\n<p>But If I click the button, no new items will be shown. If I click the button before I expand the treeview, the new items will be there...</p>\n\n<p>So the view seems not to be updated...</p>\n\n<p>Can anybody see, what I have done wrong?</p>\n"},{"tags":["c#","wpf","wpf-controls","wpftoolkit","data-visualization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":265,"score":0,"question_id":8761126,"title":"How to show a chart (line series) starting from zero?","body":"<p>I'm using DataVisualization from WPF Toolkit.</p>\n\n<p>I'm using LineSeries to show the data in the graph. But there's an inconvenience.</p>\n\n<p>Is possible that the line start in zero? I have drawed a red line, I'd like to show it.</p>\n\n<p>This is the code what I'm using:</p>\n\n<pre><code>            &lt;ChartTools:Chart x:Name=\"SubobjectivesChart\" Background=\"LightSteelBlue\"&gt;\n                &lt;ChartTools:Chart.Axes&gt;\n                    &lt;ChartTools:LinearAxis Orientation=\"Y\" ShowGridLines=\"True\"  Minimum=\"0\" Maximum=\"1\" /&gt;\n                &lt;/ChartTools:Chart.Axes&gt;\n\n                &lt;ChartTools:Chart.Series&gt;\n                    &lt;ChartTools:ColumnSeries Title=\"Exam\" ItemsSource=\"{Binding Subobjectives}\" Background=\"Black\" IndependentValueBinding=\"{Binding Exercise}\" DependentValueBinding=\"{Binding Average}\" &gt;\n                    &lt;/ChartTools:ColumnSeries&gt;\n                &lt;/ChartTools:Chart.Series&gt;\n            &lt;/ChartTools:Chart&gt;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ixV63.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","datatemplate","stackpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13195494,"title":"How to create a DataTemplate with a StackPanel of a variable number of StackPanels","body":"<p>I am trying to create a DataTamplate which should contain a StackPanel with a certain number of StackPanels.</p>\n\n<pre><code>        &lt;DataTemplate x:Key=\"DataTemplate\"&gt;\n        &lt;StackPanel Orientation=\"Vertical\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Rectangle Fill=\"Aqua\" Margin=\"2\" Height=\"100\" Width=\"50\"  VerticalAlignment=\"Top\" HorizontalAlignment=\"Left\"/&gt;\n            &lt;/StackPanel&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n</code></pre>\n\n<p>The code snippet above is just for a better understanding of my desired result, as the elements in the imbricated StackPanel will be binded.</p>\n\n<p>This generates the following error message:\nVisualTree of ItemsPanelTemplate must be a single element.</p>\n\n<p>Any alternatives that could work?</p>\n"},{"tags":["wpf","visual-studio-2010","datagrid","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12816502,"title":"WPF datagrid selectionchanged column","body":"<p>i have a datagrid with selectionchanged event handler. inside the datagrid i also provide the checkbox. whenever i click any rows inside my datagrid, my checkbox won't get checked. The checkbox will get checked if i click on the checkbox column. is that possible to know which column did user clicked on whenever they click on datagrid? </p>\n"},{"tags":["c#","wpf","datagrid","mouseevent"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":50,"score":3,"question_id":13179509,"title":"WPF DataGrid PreviewMouseDown not handling right click as expected","body":"<p>I have a DataGrid set up with a PreviewMouseDown event in a User Control. The idea is that when a user moves their mouse into a cell, it sets an Action to run based on the cell's contents, and the Action will run when the user clicks, regardless of which mouse button.<br>\nMy event handler(C#):</p>\n\n<pre><code>private void LadderMouseClick(object sender, System.Windows.Input.MouseButtonEventArgs e)  {\n        if (m_ActiveAction != null) {\n            m_ActiveAction();\n        }\n        e.Handled = true;\n    }\n</code></pre>\n\n<p>My DataGrid(XAML):  </p>\n\n<pre><code>&lt;DataGrid AutoGenerateColumns=\"False\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" CanUserReorderColumns=\"False\" CanUserResizeColumns=\"False\" CanUserSortColumns=\"False\"  EnableRowVirtualization=\"True\"  ItemsSource=\"{Binding Source={StaticResource sourceCollection}}\" Name=\"DataGrid\" RowDetailsVisibilityMode=\"Collapsed\" IsReadOnly=\"True\" Height=\"600\" MouseLeave=\"DataGrid_MouseLeave\" MouseEnter=\"DataGrid_MouseEnter\" PreviewMouseDown=\"LadderMouseClick\" PreviewMouseDoubleClick=\"LadderMouseDoubleClick\" VerticalScrollBarVisibility=\"Hidden\" SelectionUnit=\"Cell\" SelectionMode=\"Single\"&gt;\n</code></pre>\n\n<p>This works, and runs the action properly when a user either right or left clicks over the DataGrid. The problem, however, is that when the user right clicks, the cell their mouse is in becomes selected(a black border appears around the cell); this doesn't happen when they left click.</p>\n\n<p>Why are they behaving differently? Shouldn't they be handled the same way? Is there something really simple I'm missing? </p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:<br>\nI've so far tried DataGrid.UnselectAll(), DataGrid.UnselectAllCells(), DataGrid.SelectedIndex = -1, and DataGrid.CurrentCell = default(DataGridCellInfo). None of them have worked for me.</p>\n\n<p>EDIT #2:<br>\nIf it helps, I'm using DataGridTemplateColumns with TextBlocks to display my data. Could this be causing this behaviour?</p>\n\n<p>SOLUTION:<br>\nThis was solved by <a href=\"http://stackoverflow.com/users/564495/peter-hansen\">Peter Hansen</a>'s suggestion which was to add a PreviewMouseRightButtonDown event to the DataGrid as well as the PreviewMouseDown event.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12975654,"title":"System.Windows.Application class instance won't show second window","body":"<p>I have a WPF desktop application where I want to check if I can connect to my database with EF before launching the main window. So I try to connect to database and if exception occurs, I simply show a window where I ask the user to enter correct database connection string.</p>\n\n<p>After user enters the connection string, I retry connecting to database and if it connects I want to launch my main window and let the application start.</p>\n\n<p>EDIT: I changed my code a liitle bit, but still doesn't work. I think it is about closing one window and then trying to show another window in Application class. <strong>It works if ServerConfigurationWin is not shown.</strong></p>\n\n<p>However what happens is, after I display the database configuration window to user, <strong>the application calls the StartupUri window's constructor declared in App.xaml file but nothing shows on screen.</strong></p>\n\n<p>Thanks.</p>\n\n<p>Here is my App code:</p>\n\n<pre><code>public partial class App : Application\n{\n    protected override void OnStartup(StartupEventArgs e)\n    {\n        base.OnStartup(e);\n\n        bool success = false;\n        while (!success)\n        {\n            try\n            {\n                DemirbasContext context = new DemirbasContext();\n                DbInitializer initializer = new DbInitializer();\n                Database.SetInitializer&lt;DemirbasContext&gt;(initializer);\n                context.Database.Initialize(false);\n                success = true;\n            }\n            catch (ProviderIncompatibleException)\n            {\n                ServerConfigurationWin configurationWin = new ServerConfigurationWin();\n                if (!configurationWin.ShowThemAll())\n                {\n                    // ShowThemAll() returns that operation is canceled.\n                    App.Current.Shutdown();\n                    return;\n                }\n                success = false;\n            }\n        }\n    }\n\n    public App()\n    {\n\n    }\n\n    void App_DispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)\n    {\n        // Process unhandled exception do stuff below\n        Console.WriteLine(\"***Message***\");\n        Console.WriteLine(e.Exception.Message);\n        Console.WriteLine(\"***Stack Trace***\");\n        Console.WriteLine(e.Exception.StackTrace);\n        Console.WriteLine(\"***Target Site***\");\n        Console.WriteLine(e.Exception.TargetSite);\n        // Prevent default unhandled exception processing\n        e.Handled = true;\n    }\n}\n</code></pre>\n\n<p>App.xaml:</p>\n\n<pre><code>&lt;Application x:Class=\"Demirbas.App\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         DispatcherUnhandledException=\"App_DispatcherUnhandledException\"\n         StartupUri=\"Enterance.xaml\"&gt;\n&lt;Application.Resources&gt;\n    &lt;Style TargetType=\"Button\"&gt;\n        &lt;Setter Property=\"Height\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Width\" Value=\"75\" /&gt;\n        &lt;Setter Property=\"MinWidth\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5,0\" /&gt;\n        &lt;Setter Property=\"Padding\" Value=\"0\" /&gt;\n    &lt;/Style&gt;\n    &lt;Style TargetType=\"Label\"&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5,0\" /&gt;\n    &lt;/Style&gt;\n\n&lt;/Application.Resources&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["wpf","prism"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13196331,"title":"WPF DataTrigger and button using PRISM","body":"<p>I have a question about clarifiying the Data Context in WPF. I have a PRISM based application. I am attempting to put a DataTrigger on a Button control. This Button control is configured to use a PRISM command interpreter.</p>\n\n<pre><code>&lt;Button \n   Grid.Column=\"0\"                             \n   Content=\"{Resx AdvancedTroubleShootingButtonLabel}\" \n   prism:Click.Command=\"{Binding AdvancedTroubleShootingCommand}\"\n &gt;\n   &lt;Button.Resources&gt;\n     &lt;Style \n       TargetType=\"{x:Type Button}\"  BasedOn=\"{StaticResource CDMWrappedButtonStyle}\"&gt;\n\n       &lt;Style.Triggers&gt;\n\n         &lt;DataTrigger Binding=\"{Binding Path=SizerVisible, ElementName=SecuritySizer}\" Value=\"False\" &gt;\n            &lt;Setter Property=\"Button.IsEnabled\" Value=\"True\" /&gt;\n         &lt;/DataTrigger&gt;\n\n         &lt;DataTrigger Binding=\"{Binding Path=SizerVisible, ElementName=SecuritySizer}\" Value=\"True\" &gt;\n           &lt;Setter Property=\"Button.IsEnabled\" Value=\"False\" /&gt;\n         &lt;/DataTrigger&gt;\n       &lt;/Style.Triggers&gt;\n\n     &lt;/Style&gt;\n   &lt;/Button.Resources&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>My assumption was that the DataTriggers would use the specified elementName for the Datacontext of the Trigger. When I test this XAML the trigers do not run. If I remove the PRISM command syntax (and hook into the standard Button click event) and test, then the triggers fire. </p>\n\n<p>What I would like to know is why would the PRISM command handler [syntax] cause the triggers to not use the DataContext identified in the Trigger script?</p>\n"},{"tags":["wpf","binding","styles","datatrigger"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13067952,"title":"WPF Style DataTrigger based on DependencyProperty binding","body":"<p>I'm working on a WPF form designer where you can drag and drop controls like Labels, TextBox, ComboBox to a design surface, then through a Property Grid user can set data bindings for each control. I have a requirement to show a red background for those controls that don't have a Binding set for a given property.</p>\n\n<p>My original idea was to create a HasBindingConverter that would take the calling element itself and examine if it has a binding to a certain property. In this case <code>TextBox.TextProperty</code></p>\n\n<pre><code>public class HasBindingConverter: IValueConverter\n{\n    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)\n    {\n        FrameworkElement fe = value as FrameworkElement;\n        if(fe != null)\n        {\n            Binding binding = BindingOperations.GetBinding(fe, TextBox.TextProperty);\n            return binding != null;\n        }\n        return false;\n    }\n\n    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)\n    {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Then I added a Style associated to TextBox control type to the Resources section of my form which is a UserControl:</p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;Style TargetType=\"TextBox\"&gt;\n        &lt;Style.Resources&gt;\n            &lt;Converters:HasBindingConverter x:Key=\"HasBindingConv\"/&gt;\n        &lt;/Style.Resources&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger\n            Binding=\"{Binding,\n            RelativeSource={RelativeSource Self},\n            Converter={StaticResource HasBindingConv}}\"\n            Value=\"False\"&gt;\n                &lt;Setter Property=\"TextBox.Background\" Value=\"Red\" /&gt;\n                &lt;/DataTrigger&gt;\n &lt;DataTrigger Binding=\"{Binding \n            RelativeSource={RelativeSource Self},\n            Converter={StaticResource HasBindingConv}}\"\n            Value=\"True\"&gt;\n                &lt;Setter Property=\"TextBox.Background\" Value=\"White\" /&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>So if TextBox does not have a Data Binding set for the TextBox.TextProperty then it will set its background to red. This part works fine, the problem is that when user sets the TextBox.TextProperty binding for this control my Converter is never invoked again so the background remains red.</p>\n\n<p>Anyone knows how to invoke the trigger after setting the binding for this control? Or any other suggestions, I may be approaching the problem in a wrong way.</p>\n\n<p>Thanks!</p>\n"},{"tags":["wpf","animation","binding","triggers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13194362,"title":"Binding not working when using DoubleAnimation","body":"<p>I'm working on a Blend to VS2012 to Blend WPF test.  I have databound the returned int from a simple model to the content of a textbox, and it works fine, unless I have a DoubleAnimation triggered by the same button.</p>\n\n<p>In my XAML I have the button with it's command databound:</p>\n\n<pre><code>&lt;Button x:Name=\"calcButton\" Command=\"{Binding sumValues}\" \nContent=\"Calculate\" Margin=\"0,8,8,0\" \nVerticalAlignment=\"Top\" Height=\"34\" \nHorizontalAlignment=\"Right\" Width=\"85\"/&gt;\n</code></pre>\n\n<p>In my View Model I have my code as usual:</p>\n\n<pre><code>public ICommand sumValues {get {return new RelayCommand(SumValues); } }\n\n    private void SumValues()\n    {\n        SummedValue = mathModel.SumValues(sumNumberOne, sumNumberTwo).ToString();\n    }\n</code></pre>\n\n<p>This works fine unless in Blend I set a trigger action, with the button firing off a double animation.</p>\n\n<pre><code>&lt;EventTrigger RoutedEvent=\"ButtonBase.Click\" SourceName=\"calcButton\"&gt;\n        &lt;BeginStoryboard x:Name=\"ResultAnimateIn_BeginStoryboard\" \nStoryboard=\"{StaticResource ResultAnimateIn}\"/&gt;\n        &lt;/EventTrigger&gt;\n</code></pre>\n\n<p>Any ideas?  I can post the entire project if it'll help?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","wpf","3d"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":349,"score":8,"question_id":12772795,"title":"3d object not rendered","body":"<p>I have a WPF application that has a main window. In that I have a frame, the frame content is a page.</p>\n\n<p>Now in page is 4 viewport3D that contain Viewport2DVisual3D and in that I have image element.</p>\n\n<p><strong>Problem :</strong> on some PCs my application runs well but on some PCs my application doesn't render viewport3d or it doesn't render the frame. Dunno but it doesn't show anything in main window.</p>\n\n<p>The problem occurs on an Acer laptop <a href=\"http://www.acer.co.uk/ac/en/GB/content/model/LX.RAZ02.097\" rel=\"nofollow\">Model</a>.</p>\n\n<p>Rendered :\n<img src=\"http://i.stack.imgur.com/s7KKm.jpg\" alt=\"True Image\"></p>\n\n<p>Not Rendered :\n<img src=\"http://i.stack.imgur.com/r9rOy.jpg\" alt=\"enter image description here\"></p>\n\n<p>EDIT:\nThis issue occurred again when I placed the frame in a grid. (I show this page in a frame, that frame is the main content of my window: when I place the frame in a grid it didn't show objects)\nSeems This Occure on laptop with shared graphics</p>\n\n<p>EDIT 2: </p>\n\n<pre><code>&lt;Page x:Class=\"MainPage\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n              Loaded=\"Page_Loaded_1\"\n        x:Name=\"myMainPage\" FlowDirection=\"RightToLeft\"  &gt;\n\n    &lt;Page.Resources&gt;\n\n        &lt;Style  TargetType=\"ContentControl\" x:Key=\"MenuItemsStyle\"&gt;\n            &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate&gt;\n\n                        &lt;Viewport3D VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\" ClipToBounds=\"False\"&gt;\n                            &lt;Viewport3D.Camera&gt;\n                                &lt;PerspectiveCamera x:Name=\"myCam\" FieldOfView=\"90\" Position=\"{Binding ElementName=myMainWindow, Path=CameraHeight}\" NearPlaneDistance=\"1\" FarPlaneDistance=\"10\"/&gt;\n                            &lt;/Viewport3D.Camera&gt;\n\n                            &lt;ModelVisual3D&gt;\n                                &lt;ModelVisual3D.Content&gt;\n                                    &lt;Model3DGroup&gt;\n                                        &lt;DirectionalLight Color=\"#FFFFFFFF\" Direction=\"0,0,-1\"/&gt;\n                                    &lt;/Model3DGroup&gt;\n                                &lt;/ModelVisual3D.Content&gt;\n                            &lt;/ModelVisual3D&gt;\n\n                            &lt;Viewport2DVisual3D x:Name=\"V2d3d\"&gt;\n\n                                &lt;Viewport2DVisual3D.Transform&gt;\n                                    &lt;Transform3DGroup&gt;\n                                        &lt;RotateTransform3D &gt;\n                                            &lt;RotateTransform3D.Rotation&gt;\n                                                &lt;AxisAngleRotation3D Axis=\"0,1,0\" Angle=\"0\" x:Name=\"aar3D\"/&gt;\n                                            &lt;/RotateTransform3D.Rotation&gt;\n                                        &lt;/RotateTransform3D&gt;\n                                    &lt;/Transform3DGroup&gt;\n                                &lt;/Viewport2DVisual3D.Transform&gt;\n\n                                &lt;Viewport2DVisual3D.Material&gt;\n                                    &lt;DiffuseMaterial Viewport2DVisual3D.IsVisualHostMaterial=\"True\" Brush=\"White\"/&gt;\n                                &lt;/Viewport2DVisual3D.Material&gt;\n                                                              &lt;Viewport2DVisual3D.Geometry&gt;\n                                    &lt;MeshGeometry3D Positions=\"{Binding   ElementName=myMainWindow, Path=MeshPosions}\"\n                            TextureCoordinates=\"0,0 0,1 1,1 1,0\" TriangleIndices=\"0 1 2 0 2 3\"/&gt;\n                                &lt;/Viewport2DVisual3D.Geometry&gt;\n                                &lt;Border Name=\"mainBorder\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\"&gt;\n                                    &lt;Border.Style&gt;\n                                        &lt;Style TargetType=\"Border\"&gt;\n                                            &lt;Setter Property=\"BorderThickness\" Value=\"1.2\"/&gt;\n                                            &lt;Setter Property=\"Background\" &gt;\n                                                &lt;Setter.Value&gt;\n                                                    &lt;SolidColorBrush Color=\"Transparent\"/&gt;\n                                                &lt;/Setter.Value&gt;\n                                            &lt;/Setter&gt;\n                                            &lt;Setter Property=\"BorderBrush\" &gt;\n                                                &lt;Setter.Value&gt;\n                                                    &lt;SolidColorBrush Color=\"Transparent\"/&gt;\n                                                &lt;/Setter.Value&gt;\n                                            &lt;/Setter&gt;\n                                                                              &lt;/Style&gt;\n                                    &lt;/Border.Style&gt;\n                                    &lt;ContentPresenter VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\"\n                                                      Content=\"{TemplateBinding ContentControl.Content}\"&gt;\n                                        &lt;ContentPresenter.Triggers&gt;\n                                            &lt;EventTrigger RoutedEvent=\"ContentPresenter.MouseLeftButtonDown\"&gt;\n                                              // Axis Animation\n                                            &lt;/EventTrigger&gt;\n                                        &lt;/ContentPresenter.Triggers&gt;\n                                    &lt;/ContentPresenter&gt;\n                                &lt;/Border&gt;\n                            &lt;/Viewport2DVisual3D&gt;\n                        &lt;/Viewport3D&gt;\n\n                    &lt;/ControlTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n            &lt;Style.Triggers&gt;\n                &lt;EventTrigger RoutedEvent=\"ContentControl.MouseLeftButtonDown\" &gt;\n                  //Axis Animation\n                &lt;/EventTrigger&gt;\n                &lt;EventTrigger RoutedEvent=\"ContentControl.MouseEnter\"&gt;\n                   //ScaleAnimation\n                               &lt;/EventTrigger&gt;\n                &lt;EventTrigger RoutedEvent=\"ContentControl.MouseLeave\"&gt;\n                   //ScaleAnimation\n                &lt;/EventTrigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n\n    &lt;/Page.Resources&gt;\n\n    &lt;Page.Triggers&gt;\n        &lt;EventTrigger RoutedEvent=\"Loaded\"&gt;\n            //Load Object Scale And Fade In\n        &lt;/EventTrigger&gt;\n    &lt;/Page.Triggers&gt;\n\n    &lt;Grid Name=\"MainGrid\"&gt;\n\n\n                 &lt;Canvas Name=\"MainCanvas\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\" FlowDirection=\"LeftToRight\"&gt;\n            &lt;ContentControl Opacity=\"0\" Name=\"MenuItem1\" Style=\"{StaticResource MenuItemsStyle}\" \n                            MouseDown=\"MenuItem1_MouseDown\" Panel.ZIndex=\"1\" &gt;\n                &lt;Image Source=\"/IsargaranProject;component/Images/isargari.jpg\"/&gt;\n                &lt;ContentControl.RenderTransform&gt;\n                    &lt;ScaleTransform ScaleX=\"0.7\" ScaleY=\"0.7\"  x:Name=\"MenuItem1ST\"/&gt;\n                &lt;/ContentControl.RenderTransform&gt;\n            &lt;/ContentControl&gt;\n        &lt;/Canvas&gt;\n\n    &lt;/Grid&gt;\n&lt;/Page&gt;\n</code></pre>\n"},{"tags":["wpf","combobox","highlight"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13195759,"title":"Programmatically highlight combobox item","body":"<p>Is there any way to highlight comboboxitem programmatically?</p>\n\n<p>Property IsHighlighted has no setter((. Changing style is not enought.</p>\n"},{"tags":["wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13194945,"title":"WPF Storyboard Event Binding","body":"<p>I am new to using WPF Storyboards, here is my code:</p>\n\n<pre><code>   &lt;StackPanel&gt;\n\n    &lt;Border Grid.Row=\"0\" Background=\"Black\" Height=\"40\" Name=\"Border1\"&gt;&lt;/Border&gt;\n\n    &lt;Grid Height=\"0\" Name=\"MyGrid\" Background=\"Green\"&gt;\n        &lt;Grid.Triggers&gt;\n            &lt;EventTrigger RoutedEvent=\"UserControl.Loaded\"&gt;\n                &lt;BeginStoryboard&gt;\n                    &lt;Storyboard&gt;\n                        &lt;DoubleAnimation Storyboard.TargetName=\"MyGrid\" \n                    Storyboard.TargetProperty=\"Height\" From=\"0\" To=\"40\" \n                    Duration=\"0:0:1\" BeginTime=\"0:0:0\"/&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/BeginStoryboard&gt;\n            &lt;/EventTrigger&gt;\n        &lt;/Grid.Triggers&gt;\n    &lt;/Grid&gt;\n\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>I would like to change the event that triggers the storyboard to start to Border1.MouseEnter.</p>\n\n<p>Is this possible?</p>\n\n<p>Thanx</p>\n"},{"tags":["wpf","datagrid","datagridtemplatecolumn"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":22,"score":0,"question_id":13195445,"title":"New row's DataContext not initialized in WPF DataGrid when using DataGridTemplateColumn","body":"<p>I have a DataGridTemplateColumn in the first position of my grid, that shows an editable combobox. The grid is bound to an observable collection.</p>\n\n<pre><code>&lt;DataGridTemplateColumn Header=\"Name\" &gt;\n    &lt;DataGridTemplateColumn.CellTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;ComboBox IsEditable=\"True\" Text=\"{Binding Name, UpdateSourceTrigger=PropertyChanged}\" ItemsSource=\"{Binding Names}\"/&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n&lt;/DataGridTemplateColumn&gt;\n</code></pre>\n\n<p>When adding a new row, by typing the value of the templated column, the grid should initialize a new instance of my datacontext, like it would when I start typing on another cell. When switching to the next cell and start typing, the datacontext is initialized and therefore the first entered value is deleted.</p>\n\n<p>What do I have to call when the text of this customized column changes, to let the grid initialize a new datacontext?</p>\n"},{"tags":["c#","wpf","animation","visualstatemanager"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13195113,"title":"Animation in wpf application through C#","body":"<p>I am developing wpf application. I have the following two visual states in xaml</p>\n\n<pre><code>&lt;VisualStateManager.VisualStateGroups&gt;\n            &lt;VisualStateGroup x:Name=\"VisualStateGroup\"&gt;\n                &lt;VisualState x:Name=\"DefaultVisualState\"&gt;\n                    &lt;Storyboard/&gt;\n                &lt;/VisualState&gt;\n                &lt;VisualState x:Name=\"FocusVisualState\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\" Storyboard.TargetName=\"CircleEllipse1\"&gt;\n                            &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FF0004FF\"/&gt;\n                        &lt;/ColorAnimationUsingKeyFrames&gt;\n                        &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(TextElement.Background).(SolidColorBrush.Color)\" Storyboard.TargetName=\"TextBlock1\"&gt;\n                            &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FFBCB0B0\"/&gt;\n                        &lt;/ColorAnimationUsingKeyFrames&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/VisualState&gt;\n            &lt;/VisualStateGroup&gt;\n        &lt;/VisualStateManager.VisualStateGroups&gt;\n</code></pre>\n\n<p>I want to apply this visual states for various Ellipse and TextBlock dynamically. So I need to convert them into C#. How should I convert this xaml code in C# ? Can you please provide me equivalent C# code for this ?</p>\n"},{"tags":["wpf","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13193890,"title":"Multiple Row Selection In WPF DataGrid Programmatically","body":"<p>Hi i have a wpf datagrid that has two columns say</p>\n\n<pre><code>key    Value\n1       abc\n2       xyz\n3       pqr\n</code></pre>\n\n<p>I have there checkbox with value equivalent to key in columns. If a check the relevant key, the corrosponding row must be selected. Multiple checkbox checked select multiple rows in datagrid.</p>\n"},{"tags":["wpf","window"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13194244,"title":"How to set startup location of WPF window with respect to its owner?","body":"<p>I have been looking to find a way to spawn a WPF window in a location specific to its owner. I want the window to spawn on the top left corner of the owner. Is it possible? If so then how can this be achieved?</p>\n\n<p>Just to clarify the scenario, i am developing a tool in WPF which is executed using a c++ dll (using ShellExecuteA)</p>\n\n<p>Thanks.</p>\n"},{"tags":["wpf","silverlight","xaml","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13181788,"title":"WPF dependency property precedence & reference type Default Values","body":"<p>If I create a custom control like this: </p>\n\n<pre><code>public class MyControl : ContentControl\n{\n   public static readonly DependencyProperty ItemsProperty =               \n         DependencyProperty.Register(\n                \"Items\", \n                typeof(ObservableCollection&lt;object&gt;), \n                typeof(MyControl), \n                new PropertyMetadata(null));\n\n   public MyControl()\n   {   \n       // Setup a default value to empty collection\n       // so users of MyControl can call MyControl.Items.Add()\n       Items = new ObservableCollection&lt;object&gt;();\n   }\n\n   public ObservableCollection&lt;object&gt; Items\n   { \n      get { return (ObservableCollection&lt;object&gt;)GetValue(ItemsProperty); } \n      set { SetValue(ItemsProperty, value); } \n   } \n}\n</code></pre>\n\n<p>And then allow the user to bind to it in Xaml like this: </p>\n\n<pre><code>&lt;DataTemplate&gt;\n    &lt;MyControl Items=\"{Binding ItemsOnViewModel}\"/&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Then the binding never works! This is due to the <a href=\"http://msdn.microsoft.com/en-us/library/ms743230.aspx#listing\" rel=\"nofollow\">Dependency Property Precedence</a>, which puts CLR Set values above Template bindings!</p>\n\n<p>So, I understand why this isn't working, but I wonder if there is a solution. Is it possible to provide a default value of ItemsProperty to new ObservableCollection for lazy consumers of MyControl that just want to add Items programmatically, while allowing MVVM power-users of My Control to bind to the same property via a DataTemplate? </p>\n\n<p>This is for Silverlight &amp; WPF. DynamicResource setter in a style seemed like a solution but that won't work for Silverlight :(</p>\n\n<p><strong>Update:</strong> </p>\n\n<p>I can confirm <strong><code>SetCurrentValue(ItemsProperty, new ObservableCollection&lt;object&gt;());</code></strong> does exactly what I want - in WPF. It writes the default value, but it can be overridden by template-bindings. <strong>Can anyone suggest a Silverlight equivalent?</strong> Easier said than done! :s</p>\n\n<p><strong>Another Update:</strong></p>\n\n<p>Apparently you can simulate SetCurrentValue in .NET3.5 using value coercion, and you can simulate value coercion in Silverlight using these techniques. Perhaps there is a (long-winded) workaround here. </p>\n\n<p><a href=\"http://arbel.net/2009/11/04/local-values-in-dependencyobjects/\" rel=\"nofollow\">SetCurrentValue workaround for .NET3.5 using Value Coercion</a><br>\n<a href=\"http://drwpf.com/blog/2010/05/05/value-coercion-for-the-masses/\" rel=\"nofollow\">Value Coercion workaround for Silverlight</a></p>\n"},{"tags":["c#","wpf","printing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13193834,"title":"Why PageScalingFactor doesn't affect anything?","body":"<p>I try to dynamically create and silently print a document.\nThe problem is that I need to scale document to fit page.  I try to use PrintTicket.PageScalingFactor but it doesn't work: when printer prints the document there is no difference between PageScalingFactor=50 and PageScalingFactor=250. PageScalingFactor doesn't affect anything.\nHere's a code fragment:\nCreating PrintTickets:</p>\n\n<pre><code>PrintTicket tkt = new PrintTicket();\n\ntkt.Collation = Collation.Uncollated;\ntkt.CopyCount = 1;\ntkt.DeviceFontSubstitution = DeviceFontSubstitution.On;\ntkt.Duplexing = Duplexing.OneSided;\ntkt.InputBin = InputBin.AutoSelect;\ntkt.OutputColor = OutputColor.Monochrome;\ntkt.PageMediaSize = new PageMediaSize(PageMediaSizeName.ISOA9);\ntkt.PageMediaType = PageMediaType.Unknown;\ntkt.PageOrder = PageOrder.Standard;\ntkt.PageOrientation = PageOrientation.Portrait;\ntkt.PageResolution = new PageResolution(PageQualitativeResolution.Draft);\ntkt.PageScalingFactor = 40;\ntkt.PagesPerSheet = 1;\ntkt.TrueTypeFontMode = TrueTypeFontMode.DownloadAsOutlineFont;\n\n\nStackPanel myPanel = new StackPanel();\nmyPanel.Margin = new Thickness(15);\n</code></pre>\n\n<p>setting up PrintQueue and filling StackPanel with data doesn't matter\nPrinting:</p>\n\n<pre><code>myPanel.Measure(new Size(dialog.PrintableAreaWidth,\n                         dialog.PrintableAreaHeight));\nmyPanel.Arrange(new Rect(new Point(0, 0),\n                myPanel.DesiredSize));\n\ndial2.PrintVisual(myPanel, \"A Great Image.\");\n</code></pre>\n\n<p>I set PageScalingFactor 40, 100, 250 - output is the same.\nWhat should I do?</p>\n"},{"tags":["wpf","focus"],"answer_count":6,"favorite_count":12,"up_vote_count":26,"down_vote_count":0,"view_count":8209,"score":26,"question_id":817610,"title":"WPF and initial focus","body":"<p>It seems that when a WPF application starts, nothing has focus.</p>\n\n<p>This is really weird. Every other framework I've used does just what you'd expect: puts initial focus on the first control in the tab order. But I've confirmed that it's WPF, not just my app -- if I create a new Window, and just put a TextBox in it, and run the app, the TextBox doesn't have focus until I click on it or press Tab. Yuck.</p>\n\n<p>My actual app is more complicated than just a TextBox. I have several layers of UserControls within UserControls. One of those UserControls has Focusable=\"True\" and KeyDown/KeyUp handlers, and I want it to have the focus as soon as my window opens. I'm still somewhat of a WPF novice, though, and I'm not having much luck figuring out how to do this.</p>\n\n<p>If I start my app and press the Tab key, then focus goes to my focusable control, and it starts working the way I want. But I don't want my users to have to hit Tab before they can start using the window.</p>\n\n<p>I've played around with FocusManager.FocusedElement, but I'm not sure which control to set it on (the top-level Window? the parent that contains the focusable control? the focusable control itself?) or what to set it to.</p>\n\n<p>What do I need to do to get my deeply-nested control to have initial focus as soon as the window opens? Or better yet, to focus the first focusable control in the tab order?</p>\n"},{"tags":["c#","wpf","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13193930,"title":"Performing equivalent of XAML DataBinding in code","body":"<p>I'm using a multi select tree view as found <a href=\"http://dotnetlearning.wordpress.com/2010/10/14/multi-selection-tree-view/\" rel=\"nofollow\">here</a></p>\n\n<p>The current way data is set is:</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;TabItem.Resources&gt;\n    &lt;!-- Data Binding to Artists.xml --&gt;\n    &lt;XmlDataProvider x:Key=\"myData\" Source=\"DataSource/Data.xml\" XPath=\"/Suppliers\" /&gt;\n    &lt;!-- Template for \"Album\" --&gt;\n    &lt;HierarchicalDataTemplate x:Key=\"ResinSystem_hdt\"&gt;\n        &lt;TextBlock Text=\"{Binding XPath=@Name}\" /&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n    &lt;!-- Template for \"Artist\" --&gt;\n    &lt;HierarchicalDataTemplate x:Key=\"Supplier_hdt\"\n        ItemTemplate=\"{StaticResource ResinSystem_hdt}\"\n        ItemsSource=\"{Binding XPath=ResinSystems/ResinSystem}\"&gt;\n        &lt;TextBlock Text=\"{Binding XPath=@Name}\" /&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n&lt;/TabItem.Resources&gt;\n\n\n&lt;Grid&gt;\n&lt;my:MultipleSelectionTreeView  \n x:Name=\"multipleselectionTree\"\n Grid.Row=\"0\"\n SelectionMode=\"KeyboardModifiersMode\"\n ItemsSource=\"{Binding Source={StaticResource myData}, XPath=Supplier}\"\n ItemTemplate=\"{StaticResource Supplier_hdt}\"/&gt;\n</code></pre>\n\n<p>Instead of linking the control to an XML file, I want to be able to link it to an XML string generated in code. </p>\n\n<p>I'm having problems converting the XAML statements into working code. </p>\n\n<p>So far I have this:</p>\n\n<p>XML Snippet (Hard coded currently to prove concept)</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Suppliers&gt;\n  &lt;Supplier Name=\"Isola\"&gt;\n    &lt;ResinSystems&gt;\n      &lt;ResinSystem Name=\"370HR\" /&gt;\n    &lt;/ResinSystems&gt;\n  &lt;/Supplier&gt;\n&lt;/Suppliers&gt;\n</code></pre>\n\n<p>XAML</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;TabItem.Resources&gt;\n &lt;HierarchicalDataTemplate x:Key=\"Thickness_hdt\"&gt;\n     &lt;TextBlock Text=\"{Binding XPath=@Name}\" /&gt;\n &lt;/HierarchicalDataTemplate&gt;\n\n &lt;HierarchicalDataTemplate x:Key=\"ResinSystem_hdt\"\n                            ItemTemplate=\"{StaticResource Thickness_hdt}\"\n                                          ItemsSource=\"{Binding XPath=Thicknesses/Thickness}\"&gt;\n    &lt;TextBlock Text=\"{Binding XPath=@Name}\" /&gt;\n &lt;/HierarchicalDataTemplate&gt;\n &lt;HierarchicalDataTemplate x:Key=\"Supplier_hdt\"\n                                          ItemTemplate=\"{StaticResource ResinSystem_hdt}\"\n    ItemsSource=\"{Binding XPath=ResinSystems/ResinSystem}\"&gt;\n    &lt;TextBlock Text=\"{Binding XPath=@Name}\" /&gt;\n &lt;/HierarchicalDataTemplate&gt;\n&lt;/TabItem.Resources&gt;\n\n&lt;my:GX3MultipleSelectionTreeView  \n            x:Name=\"multipleselectionTree\"\n            Grid.Row=\"0\"\n            SelectionMode=\"KeyboardModifiersMode\"\n            ItemTemplate=\"{StaticResource Supplier_hdt}\"/&gt;\n</code></pre>\n\n<p>Code Behind:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>XmlDataProvider coreXMLProvider = new XmlDataProvider();\ncoreXMLProvider.XPath = \"/Suppliers\";\nXmlDocument coreXMLDocument = new XmlDocument();\ncoreXMLDocument.LoadXml(\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;&lt;Suppliers&gt;&lt;Supplier Name=\\\"Isola\\\"&gt;&lt;ResinSystems&gt;&lt;ResinSystem Name=\\\"370HR\\\" /&gt;&lt;/ResinSystems&gt;&lt;/Supplier&gt;&lt;/Suppliers&gt;\");\ncoreXMLProvider.Document = coreXMLDocument;\nmultipleselectionTree.DataContext = coreXMLProvider;\n</code></pre>\n\n<p>When running this I get no data appearing in the <code>TreeView</code>. Any ideas?</p>\n\n<p>Please let me know if you need any more information.</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13192491,"title":"WPF simulate Application.Activated event","body":"<p>I want to use <code>Application.Activated</code> event in WPF but I have no Application object or Windows neither. \nCan other elements use this event or Is there a chance to simulate activated event?</p>\n"},{"tags":["c#","wpf","binding","interface","relativesource"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13194231,"title":"Is possible to make a WPF RelativeSource binding with AncestorType pointing to a base type?","body":"<p>I want to bind a property to the parent container view having a ViewModel in its DataContext.</p>\n\n<p>This code works perfectly well when the parent is a direct instance of <strong>ConcreteClassView</strong>:</p>\n\n<pre><code>Property=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ty:ConcreteClassView}}, Path=DataContext.Name}\"\n</code></pre>\n\n<p>However, the parent is not found when trying to locate it via a base class or a interface.\nSample:</p>\n\n<pre><code>PropertyB=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ty:BaseClassView}}, Path=DataContext.Name}\"\n\nPropertyB=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ty:INamedElementView}}, Path=DataContext.Name}\"\n</code></pre>\n\n<p>Giving that:</p>\n\n<pre><code>class ConcreteClassView : BaseClassView, INamedElementView { }\n</code></pre>\n\n<p>Ok, Let's assume that <strong>FindAncestor</strong>, <strong>AncestorType</strong> needs the concrete type to work. </p>\n\n<p><em>But there is any workaround to locate ancestors just based on base classes or implementing a given Interface?</em> </p>\n\n<p>Thxs.</p>\n"},{"tags":["c#","wpf","binding","listbox","expander"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13170783,"title":"Bind based on a condition","body":"<p>Hi. I'm running into issues with having a <code>RadExpander</code> in a <code>RadListBox</code>. Basically, I have exactly something like <a href=\"http://stackoverflow.com/a/1183404/640607\">here</a> or <a href=\"http://stackoverflow.com/a/11199811/640607\">here</a>.</p>\n\n<p>I have a <code>OneWayToSource</code> binding, but I want the binding to happen only when the <code>RadExpander</code> is expanded and not when it is collapsed.</p>\n\n<p>Is there a way I can conditionally bind the two UI Elements?</p>\n\n<p><strong>EDIT</strong>: (Sample code which makes some of the downvoters happy)</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;DataTemplate x:Key=\"ListBoxItemTemplate\" DataType=\"{x:Type telerik:RadListBoxItem}\"&gt;\n    &lt;!--&lt;DataTemplate.Triggers&gt;\n        &lt;DataTrigger Binding=\"{Binding ElementName=listExpander, Path=IsExpanded, Mode=TwoWay}\" Value=\"True\"&gt;\n            &lt;Setter Property=\"IsSelected\" Value=\"True\" /&gt;\n        &lt;/DataTrigger&gt;\n    &lt;/DataTemplate.Triggers&gt;--&gt;\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition /&gt;\n            &lt;ColumnDefinition /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"Auto\" /&gt;\n            &lt;RowDefinition Height=\"Auto\" /&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;telerik:RadExpander x:Name=\"listExpander\"\n                             IsExpanded=\"{Binding Mode=TwoWay, IsAsync=True, Path=IsSelected, RelativeSource={RelativeSource AncestorType=telerik:RadListBoxItem, Mode=FindAncestor}}\"\n                             VerticalContentAlignment=\"Top\" ToolTip=\"Double click on the List name to edit it\"&gt;\n            &lt;telerik:RadExpander.Header&gt;\n                &lt;Grid&gt;\n                    &lt;TextBlock x:Name=\"listNameCaption\" MouseDown=\"listName_txtblk_MouseDown\"\n                               Text=\"{Binding ListName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\" Style=\"{StaticResource HighlightedDetailsStyleForTextBlock}\" /&gt;\n                    &lt;TextBox LostFocus=\"listName_txtbox_LostFocus\" Visibility=\"Collapsed\"\n                             Text=\"{Binding ListName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"\n                             Style=\"{StaticResource HighlightedDetailsStyleForTextBox}\" /&gt;\n                &lt;/Grid&gt;\n            &lt;/telerik:RadExpander.Header&gt;\n            &lt;telerik:RadExpander.Content&gt;\n                &lt;Grid&gt;\n                    &lt;Grid.ColumnDefinitions&gt;\n                        &lt;ColumnDefinition /&gt;\n                    &lt;/Grid.ColumnDefinitions&gt;\n                    &lt;Grid.RowDefinitions&gt;\n                        &lt;RowDefinition Height=\"Auto\" /&gt;\n                        &lt;RowDefinition Height=\"Auto\" /&gt;\n                        &lt;RowDefinition Height=\"Auto\" /&gt;\n                    &lt;/Grid.RowDefinitions&gt;\n                    &lt;Border BorderBrush=\"#FFDADADA\" BorderThickness=\"0,0,1,1\" MinHeight=\"20\" MinWidth=\"200\" CornerRadius=\"3\" Margin=\"5\"&gt;\n                        &lt;Border BorderBrush=\"#B2ADBDD1\" BorderThickness=\"1\" CornerRadius=\"2\"&gt;\n                            &lt;StackPanel&gt;\n                                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"List Type:\" FontStyle=\"Italic\" /&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"{Binding ListType}\" /&gt;\n                                &lt;/StackPanel&gt;\n                                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"Tree:\" FontStyle=\"Italic\" /&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"{Binding TreeName}\" /&gt;\n                                &lt;/StackPanel&gt;\n                                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"Discount Date:\" FontStyle=\"Italic\" /&gt;\n                                    &lt;Label FontFamily=\"Segoe UI\" FontSize=\"11\" Content=\"{Binding DiscountDate}\" /&gt;\n                                &lt;/StackPanel&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/Border&gt;\n                    &lt;/Border&gt;\n                &lt;/Grid&gt;\n            &lt;/telerik:RadExpander.Content&gt;\n            &lt;!--&lt;telerik:RadExpander.Style&gt;\n                &lt;Style TargetType=\"{x:Type telerik:RadExpander}\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsExpanded\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem, Mode=FindAncestor}, Path=IsSelected}\" Value=\"True\"/&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/telerik:RadExpander.Style&gt;--&gt;\n        &lt;/telerik:RadExpander&gt;\n    &lt;/Grid&gt;\n&lt;/DataTemplate&gt;\n\n&lt;telerik:RadListBox x:Name=\"allListBox\"\n                    Style=\"{StaticResource ListBoxStyle}\"\n                    ItemsSource=\"{Binding Lists, Mode=TwoWay}\"\n                    ItemTemplate=\"{StaticResource ListBoxItemTemplate}\"\n                    SelectedItem=\"{Binding SelectedListItem, Mode=TwoWay}\"&gt;\n    &lt;telerik:RadListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel Orientation=\"Vertical\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/telerik:RadListBox.ItemsPanel&gt;\n&lt;/telerik:RadListBox&gt;\n</code></pre>\n\n<p><strong>EDIT 2</strong>:</p>\n\n<p>Fixed it, but from code behind. Wish there was a cleaner way where we could just say: \"RadExpander - you bind to RadListBoxItem's IsSelected property only if you have IsExpanded=True\" from XAML.</p>\n\n<p>This is the work-around code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private void ListItemExpanded(object sender, RadRoutedEventArgs e)\n{\n    var listItem = sender as RadExpander;\n    if(listItem == null)\n        return;\n\n    if (!listItem.IsExpanded) return;\n\n\n    var parent = VisualTreeHelper.GetParent(listItem);\n    while (parent != null &amp;&amp; !(parent is RadListBoxItem))\n    {\n        parent = VisualTreeHelper.GetParent(parent);\n    } \n\n    if(parent == null)\n        return;\n\n    var listBoxItem = parent as RadListBoxItem;\n    if (!listBoxItem.IsSelected)\n        listBoxItem.IsSelected = true;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;telerik:RadExpander x:Name=\"listExpander\" Expanded=\"ListItemExpanded\" VerticalContentAlignment=\"Top\" ToolTip=\"Double click on the List name to edit it\"&gt;\n</code></pre>\n"},{"tags":["wpf","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13193202,"title":"How to bind a textbox.Text property in WPF MMVM design","body":"<p>So I'm trying to learn the MVVM design patter in WPF, I want to do the following:</p>\n\n<p>In external class I've got a ObservableCollection _students that is bound to a listview on the WPF window using MVVM design pattern. The listview shows only the Student's name and Age.</p>\n\n<pre><code>public class Student\n{\n    public string Name { get; set; }\n    public int Age { get; set; }\n    public string Course { get; set; }\n    public DateTime JoiningDate { get; set; }\n}\n\n\npublic class ViewModel : INotifyPropertyChanged\n{\n    private ObservableCollection&lt;Student&gt; _students;\n\n    protected void NotifyPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged!=null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n\n    public ObservableCollection&lt;Student&gt; Students\n    {\n        get\n        {\n            return _students;\n        }\n        set\n        {\n            _students = value;\n            NotifyPropertyChanged(\"Students\");\n        }\n    }\n</code></pre>\n\n<p>All good, but I want to put a TextBox and set it to show the listview's selected item's course property. This means I must</p>\n\n<ol>\n<li>get the listview's selected index (ok)</li>\n<li>bind the textbox.Text property to Students[that index].Course</li>\n</ol>\n\n<p>I'm stuck at 2. Any help?</p>\n"},{"tags":["c#","wpf","xml","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13192963,"title":"How to write the create new xml if the xml file is not found in my WPF project?","body":"<p>I currently using an WPF app. Right now, i want to save my data into the XML file. If the xml file is not found in the project, then create a new one. Does anyone can teach me how?</p>\n\n<p>i think the code will be something like this</p>\n\n<pre><code>public MainWindow()\n    {\n        InitializeComponent();\n        loadXML();\n     }\n\npublic void loadXML()\n{\n    xDocument doc = xDocument.load(\"MyXmlFile.xml\");\n\n    if(doc.exist== false)\n    {\n     //create new xml\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","multithreading","dispatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13192247,"title":"View is not updated when on a separate thread","body":"<p>I am trying to load some data in a separate thread, then add the loaded data to an ObservableCollection and update the view through ba binding.</p>\n\n<p>First, I was doing the following:</p>\n\n<pre><code>public OverviewViewModel()\n{\n    Thread thread = new Thread(new ThreadStart(delegate\n    {\n        TheTVDB theTvdb = new TheTVDB();\n        foreach (TVSeries tvSeries in theTvdb.SearchSeries(\"Dexter\"))\n        {\n            this.Overview.Add(tvSeries);\n        }\n    }));\n    thread.SetApartmentState(ApartmentState.STA);\n    thread.Start();\n}\n</code></pre>\n\n<p>This gave the following error:</p>\n\n<blockquote>\n  <p>This type of CollectionView does not support changes to its\n  SourceCollection from a thread different from the Dispatcher thread.</p>\n</blockquote>\n\n<p>So I read on this forum that I should use the Dispatcher, so I put <code>this.Overview.Add(tvSeries)</code> into a call to the Dispatcher.</p>\n\n<pre><code>Dispatcher.CurrentDispatcher.BeginInvoke((Action)delegate\n{\n    this.Overview.Add(tvSeries);\n},\nDispatcherPriority.Normal);\n</code></pre>\n\n<p>Now, it doesn't crash anymore but the view is not updated. Nothing happens, the view is just empty. I have tested the functionality by running it on the main thread. Then the view is updated correctly.</p>\n\n<p>Does anyone know why the view is not updated and how I can fix this?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The below approach seems to work and it seems to do everything asynchronously. Can anyone confirm that this is the right approach for doing things asyncronously?</p>\n\n<pre><code>Dispatcher.CurrentDispatcher.BeginInvoke(new Action(delegate\n{\n    TheTVDB theTvdb = new TheTVDB();\n    foreach (TVSeries tvSeries in theTvdb.SearchSeries(\"Dexter\"))\n    {\n        this.Overview.Add(tvSeries);\n    }\n}),\nDispatcherPriority.Background);\n</code></pre>\n"},{"tags":["wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13192823,"title":"Update the WPF DataGrid Column Header Text via code behind","body":"<p>How can i change the WPF DataGrid Column Header Text via code behind?\ni tried the code below but its not working.</p>\n\n<pre><code>this.sampleDataGrid.Columns[0].Header = \"New Header\"; \nthis.sampleDataGrid.Refresh();\n</code></pre>\n"},{"tags":["wpf","user-interface","ui-automation"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13192569,"title":"MS UI automation - Custom DataGrid","body":"<p>currently i am working on automating one of my .net based application using WPF(in Excel vba).UI spy is not recognizing one of the control(Grid) as an object.Is there any way to select an item from Grid which is not identified by UI spy. </p>\n\n<p>Thanks in advance\nRegards</p>\n"},{"tags":["c#","wpf","datagrid","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13190651,"title":"WPF DataGrid column header separator missing","body":"<p>I have a WPF <code>Datagrid</code>. I changed the column header style of it. I'm setting <code>BackgroundProperty</code> and <code>ForegroundProperty</code> in column header style like this:</p>\n\n<pre><code>Style newHeaderStyle = new System.Windows.Style();\nnewHeaderStyle.Setters.Add(new Setter(Control.BackgroundProperty, Backgroundbrush));\nnewHeaderStyle.Setters.Add(new Setter(Control.ForegroundProperty, Foregroundbrush));\nDataGrid.ColumnHeaderStyle = newHeaderStyle;\n</code></pre>\n\n<p>After this my <code>DataGrid</code> column header separator is missing and column headers looks like they're attached to each other.</p>\n\n<p>Give me a simple code to make separator visible. </p>\n"},{"tags":["wpf","powerpoint"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":3791,"score":2,"question_id":594052,"title":"PowerPoint and WPF","body":"<p>I really need a way of loading a .ppt document in my wpf application. Can anyone give me a hint, code sample?</p>\n"},{"tags":["wpf","focus","control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13191740,"title":"WPF: Controlling focus in a custom control","body":"<p>I am developing a custom control (say BoxControl) which will have many controls in it like a textbox, few buttons etc. </p>\n\n<p>I will have many BoxControls in a row and while navigating via tabs, I want it to behave like when a BoxControl gets focus, it always passes the focus to its textbox and when its textbox loses the focus, the entire BoxControl loses the focu and passes the focus to next BoxControl.</p>\n\n<p>Any ideas how can it be done?</p>\n"},{"tags":["wpf","geometry","shapes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13191174,"title":"Should I use Geometry.Freeze here?","body":"<p>When a WPF item is frozen, the docs says it cannot be changed. I'm just not very sure what <em>\"change\"</em> mean by in this context.</p>\n\n<p>For example, if I create an instance of a shape and then freeze it, is it possible to do things like rotate or translate it even though it is frozen?</p>\n"},{"tags":["wpf","textbox","focus","control","richtextbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13186202,"title":"Focusing Controls Inside RichTextboxes","body":"<p>I have a textbox inside of my RichTextbox control. (The texboxt contains certain expressions that cannot otherwise be done in richtextbox itself.)  I am having trouble focusing/navigating into the element when the caret is adjacent to the object.  The caret is just skipping over the object.  Is there any way to notice the object and focus on to it (in this case focus into the textbox)?</p>\n\n<p>Actually, I should be more specific, the 'textbox' is actually a UserControl that can contain multiple texboxes and other symbols so it's not just a simple wpf 'textbox'.  But essentially it behaves like a textbox.</p>\n\n<p>Thanks.</p>\n\n<pre><code>        &lt;RichTextBox Name=\"rtb\" Grid.Row=\"1\" &gt;\n        &lt;ed:EnabledFlowDoc x:Name=\"efdMath\" TextBlock.BaselineOffset=\"-10\"\n                           FontFamily=\"Palatino Linotype\"&gt;\n            &lt;Paragraph TextBlock.BaselineOffset=\"10\" TextInput=\"Paragraph_TextInput_1\"&gt;\n                Text . . .\n                &lt;InlineUIContainer BaselineAlignment=\"Center\"&gt;\n                    &lt;TextBox /&gt;\n                &lt;/InlineUIContainer&gt;\n                &lt;InlineUIContainer BaselineAlignment=\"Center\"&gt;\n                    &lt;TextBox /&gt;\n                &lt;/InlineUIContainer&gt;\n\n            &lt;/Paragraph&gt;\n        &lt;/ed:EnabledFlowDoc&gt;\n    &lt;/RichTextBox&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13179562,"title":"Create curved Control in WPF","body":"<p>it is possible in WPF to create a control (e.g. button) looks like this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZwkIu.png\" alt=\"curved control\"></p>\n\n<p>Actually, I want to draw 4 buttons so that they are positioned as a circle. </p>\n"},{"tags":["wpf","silverlight","mvvm-light"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":87,"score":4,"question_id":13115474,"title":"MVVM Light - Relay Command Parameter value coming intermittently","body":"<p>I am using a silverlight application. Trying to bind a button's click command to a relay command in ViewModel and passing some parameters to it. Code for my View is :</p>\n\n<pre><code>&lt;Button x:Name=\"button\" Content=\"Button\" VerticalAlignment=\"Top\" Margin=\"173,0,152,0\"&gt;\n        &lt;i:Interaction.Triggers&gt;\n            &lt;i:EventTrigger EventName=\"Click\"&gt;\n                &lt;i:InvokeCommandAction CommandParameter=\"{Binding ActualWidth, ElementName=button, Mode=TwoWay}\" Command=\"{Binding CRelayDecimal, Mode=OneWay}\"/&gt;\n            &lt;/i:EventTrigger&gt;\n        &lt;/i:Interaction.Triggers&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>A button is passing it's ActualWidth as parameter for command's parameter. My ViewModel  code is:</p>\n\n<pre><code>public Page1()\n{\n    InitializeComponent();\n    CRelayDecimal = new RelayCommand&lt;Object&gt;(this.GetDecimal);\n}\n\npublic RelayCommand&lt;Object&gt; CRelayDecimal { get; private set; }\n\nprivate void GetDecimal(Object Obj)\n{\n    var value = (double)Obj;\n}\n</code></pre>\n\n<p>Now, the problem I see here is that most of the time passed parameter value I receive is  0.0. Intermittently, I've seen value to be precise value (like.. 75.0) that it should be.</p>\n\n<p>Is there any other way of doing it ? </p>\n\n<p>Thanks you all for your help in advance. </p>\n\n<p>Thanks and Regards</p>\n\n<p>Nishant Rana</p>\n"},{"tags":["c#","wpf","data-binding","mvvm","prism"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13144348,"title":"UI Not updating from ObservableCollection called by a command from a seperate ViewModel","body":"<pre><code>private ObservableCollection&lt;ProjectItem&gt; _projectItems;\n\npublic ObservableCollection&lt;ProjectItem&gt; DataItems\n    {\n        get { return _projectItems; }\n    }\n\npublic ProjectsPanelViewViewModel()\n    {\n        _projectItems = new ObservableCollection&lt;ProjectItem&gt;();\n        _createProjectCommand = new DelegateCommand(OnCreateProjectCommand);\n        _saveProjectCommand = new DelegateCommand(OnSaveProjectCommand);\n    }\n\nprivate void OnCreateProjectCommand()\n    {\n        _addProjectViewModel = new AddProjectViewModel();\n        AddProjectView view = new AddProjectView();\n        view.Show();\n    }\n\n    private void OnSaveProjectCommand()\n    {\n        ProjectItemViewModel _vm = new ProjectItemViewModel();\n        _vm.ProjectName = ProjectName;\n        _vm.ProjectDescription = ProjectDescription;\n        var item = new ProjectItem(_vm);\n        _projectItems.Add(item);\n    }\n</code></pre>\n\n<p>XAML </p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n    &lt;VM:ProjectsPanelViewViewModel/&gt;\n&lt;/UserControl.DataContext&gt;\n&lt;StackPanel Name=\"ProjectsPanel\" Style=\"{DynamicResource FullLengthPanelStyle}\" &gt;\n    &lt;StackPanel Name=\"ProjectsHeader\" Orientation=\"Horizontal\" Margin=\"0,0,0,5\"&gt;\n        &lt;Label Style=\"{StaticResource TitleLabelStyleBlue}\"&gt;projects&lt;/Label&gt;\n        &lt;Button Name=\"AddProjects\" Margin=\"10,5,0,0\" Style=\"{StaticResource CircularGreyButtonStyle}\" Content=\"+\" ToolTip=\"Add a new project\" Command=\"{Binding CreateProjectCommand}\"/&gt;\n        &lt;Button Name=\"ExpandProjects\" Margin=\"10,5,0,0\" Style=\"{StaticResource CircularGreyButtonStyle}\" Content=\"&gt;\" ToolTip=\"Expand projects\"/&gt;\n    &lt;/StackPanel&gt;\n\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Visible\"&gt;\n            &lt;ItemsControl ItemsSource=\"{Binding DataItems}\"/&gt;\n    &lt;/ScrollViewer&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>When the OnCreateProjectCommand Opens it creates a window with 2 string fields, this then has a button that executes the OnSaveProjectCommand. The commands are executed fine, however the UI does not pick up that the new item has been added to the collection. (When debugging it is in there). If however you change the code from the OnSaveProjectCommand and put it into the OnCreateProjectCommand, and hardcode the simple string values, the UI is updated correctly from the observable collection.</p>\n\n<p>Can anyone give me some guidance as to why this is not working, and also the correct way that I should be spawning up a new window from this command. Should this be done with State Based view navigation from prism? We are already using this for modularisation and commanding. </p>\n\n<p>Thanks for the advice. </p>\n"},{"tags":["c#","wpf","xml","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13190342,"title":"How to save WPF user setting in XML?","body":"<p>I'm a WPF newbie. I'm building a simple WPF app which require the user to login using the C# language. In the login page, user allow to tick on the \"Remember me\" and the \"Sign me in automatically\" check box but if the app closes, the setting will be reset to default. So, what I want is after every time the user ticks the checkbox and close the app, the setting must be saved. </p>\n\n<p>As what I found online, there are some ways to save the user setting. Can someone provide me a step-by-step tutorial or a link about saving the user setting into the XML?</p>\n\n<p>P.S. I have some Linq experience. Linq to XML method is preferable by me.</p>\n"},{"tags":["wpf","mvvm","dialog"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13188570,"title":"Open window as Dialog in MVVM","body":"<p>Hi Team,<br>\n               I was following the sample MVVM WPF application from msdn. Everything seems tobe fine and closely a good sample to follow, but I was looking for opening a child window as Dialog from Menu -->open  and thought a text input assing the input control to my child window tab and to the text control in usercontrol customer add, but couldn't find a solution. <a href=\"http://msdn.microsoft.com/en-us/magazine/dd419663.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/magazine/dd419663.aspx</a> link  for the source any help on this would be of gr8 help.</p>\n"},{"tags":["c#","wpf","design-patterns","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13190010,"title":"Best practice for selecting a type from UI","body":"<p>First, I am new to WPF and MVVM. I have an Interface like this</p>\n\n<pre><code>Interface IItemType\n{\n  bool save()\n}\n</code></pre>\n\n<p>and I have three concrete classes which they are inherited from this Interface</p>\n\n<pre><code>Public Class Type1:IItemType\n{\n   public bool save()\n   {\n     //save something with method 1\n   }\n}\n\nPublic Class Type2:IItemType\n{\n   public bool save()\n   {\n     //save something with method 2\n   }\n}\n</code></pre>\n\n<p>I have three RadioButtons (they can extend in future to 4,5 or more) in my View which I want to choose the Save Method (Class <code>Type1</code> or <code>Type2</code>) by selecting one of these RadioButtons. \nThe question is how can I bind these Radios to my ViewModel to not violating the pattern designs like OCP and etc (as In future I want to add more types and Radios)?</p>\n\n<p>Meet the MVVM best practice design?</p>\n\n<p>** EDIT **</p>\n\n<p>Imagine I have the following Property</p>\n\n<pre><code>Public IItemType CurrentType { get; set; }\n</code></pre>\n\n<p>I want to put the Class <code>Type1</code> into CurrentType property when the first Radio is selected\nand put the Class <code>Type2</code> into CurrentType property when the second Radio is selected and so on.</p>\n"},{"tags":["c#",".net","wpf","json"],"answer_count":6,"favorite_count":3,"up_vote_count":12,"down_vote_count":0,"view_count":18046,"score":12,"question_id":2859753,"title":"What is simpliest C# function to parse Json String into object?","body":"<p>What is simpliest C# function to parse Json String into object and display it (C# xaml WPF)? (for example object wit 2 arrays -  arrA and arrB) </p>\n"},{"tags":[".net","wpf","control","datatemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13067555,"title":"WPF Control Authoring with multiple Templates","body":"<p>I am trying to create a custom WPF control that has multiple UI elements to be displayed in different situations at different times, so they cannot be sensibly created in the same visual tree. I created dependency properties for each element, of type <code>UIElement</code>. This worked well.</p>\n\n<p>When it came to styling control, it didn't work so well. Although I can define a style for the control that sets my custom properties, the style is only instantiated once. So if multiple instances of my custom control use the same style, only the last one to be defined gets the visual tree. I understand that this is because the style sets the <code>UIElement</code> directly rather than using a template, and it is the template infrastructure that makes multiple instances of the tree defined within it (see <a href=\"http://stackoverflow.com/a/8702180/1453269\">http://stackoverflow.com/a/8702180/1453269</a>)</p>\n\n<p>My question is, how can I define a control that takes multiple templates in such a way that they will be applied? I have tried creating dependency objects of type <code>DataTemplate</code>. If I use a <code>ContentPresenter</code> to display the template, it just displays the type name of DataTemplate as text. I want it to apply the template values to my first dependency properties in a manner consistent with the rest of WPF. I had assumed there is a way to leverage the templating infrastructure in WPF, but I can't find how to do that.</p>\n"},{"tags":["c#",".net","wpf","wpfdatagrid","datagridcell"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":316,"score":2,"question_id":9978119,"title":"Select DataGridCell from DataGrid","body":"<p>I have a <code>DataGrid</code> WPF control and I want to get a specific <code>DataGridCell</code>. I know the  row and column indices. How can i do?</p>\n\n<p>Thanks.</p>\n\n<p>I need <code>DataGridCell</code> because I have to access to its Content. So, if I have (for example) a column of <code>DataGridTextColum</code> my Content will be a <code>TextBlock</code> object.</p>\n"},{"tags":["c#",".net","wpf","data-binding","datagrid"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":293,"score":0,"question_id":11536635,"title":"Can't iterate through cells in a C# DataGrid to change their background colour","body":"<p>I want to iterate through the cells in my DataGrid so I can highlight some of the cells using <a href=\"http://en.allexperts.com/q/C-3307/2008/3/Change-Datagrid-cell-color.htm\" rel=\"nofollow\">this code</a>:</p>\n\n<pre><code>//Loop through all rows.\nfor (int x = 0; x &lt; yourGridName.Rows.Count; x++) {\n  //Loop through all cells in that row and change its color.\n  for (int y = 0; y &lt; yourGridName.Rows[x].Cells.Count; y++) {\n    yourGridName.Rows[x].Cells[y].Style.BackColor = System.Drawing.Color.Red;\n  }\n}\n</code></pre>\n\n<p>I have defined my DataGrid in WPF as follows:</p>\n\n<pre><code>&lt;DataGrid AutoGenerateColumns=\"False\"\n  EnableRowVirtualization=\"True\" ItemsSource=\"{Binding}\"\n  Margin=\"12,236,12,0\" Name=\"conflictedDevicesDataGrid\"\n  RowDetailsVisibilityMode=\"VisibleWhenSelected\" Grid.ColumnSpan=\"2\"\n  AlternatingRowBackground=\"#2FFF0000\" IsManipulationEnabled=\"False\"&gt;\n  &lt;DataGrid.Columns&gt;\n        ....\n  &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Then I populated it with this code:</p>\n\n<pre><code>var conflictedDevicesDataTable = new DataTable();\nconflictedDevicesDataTable.Rows.Add(new object[] {\n  \"CSV\",roc.scadaNode, roc.deviceName, roc.deviceDescription, roc.rocChannel,\n  roc.rocAddress, roc.rocGroup, roc.configuration, roc.revision\n});\n...\nconflictedDevicesDataGrid.ItemsSource = conflictedDevicesDataTable.DefaultView;\n</code></pre>\n\n<p>However when I try and iterate through the columns and rows via:</p>\n\n<pre><code>conflictedDevicesDataGrid.Rows[x]\n</code></pre>\n\n<p>Rows is not an item, I can iterate through columns but not rows. Every example I find on Google says to iterate through a datagrid via .Rows[x] but I cannot seem to do this. How else can I iterate through each cell in my DataGrid and programmatically change the background colour?</p>\n"},{"tags":["wpf","encapsulation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13186582,"title":"Encapsulation on WPF","body":"<p>\"Code complete 2\" said in a customers class, the list's interfaces should be hidden if they are not used,</p>\n\n<p>but in WPF data binding in datagrid or Listbox, usually use itemssource = customers,</p>\n\n<p>if customers inherits from list, then list's interfaces can not be hidden...</p>\n\n<p>Are these two conflict? How to solve this.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13189597,"title":"How to get .cer file from a post type webresponse in WPF using MVVM","body":"<p>I'm developing my first WPF app using MVVM. In this all the webservices are <code>POST</code> type. <br>Here when I call one webservice, they are returning a certification file and I tried to get that certification file as follows: </p>\n\n<pre><code>Uri myUri = new Uri(Address);\nRequest = (HttpWebRequest)WebRequest.Create(myUri);\nRequest.Method = \"POST\";\nRequest.ContentType =\"application/x-www-form-urlencoded\";\nbyte[] bytePostdata = Encoding.UTF8.GetBytes(InputParams);\nRequest.ContentLength = bytePostdata.Length;\nStream ReqStream = Request.GetRequestStream();\nReqStream.Write(bytePostdata, 0, bytePostdata.Length);\n// Close the Stream object.\nReqStream.Close();                \nResponse = (HttpWebResponse)Request.GetResponse();\nStream ReceiveStream = Response.GetResponseStream();\n// Pipes the stream to a higher level stream reader with the required encoding format.\nStreamReader ReadStream = new StreamReader(ReceiveStream);\n</code></pre>\n\n<p>In the above code, <code>ReadStream</code> object contains the response of <code>webservice</code> nothing but certification file. Here please help me how to get that certification file and the key in that file.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13186983,"title":"auto resize application in other computer wpf c#","body":"<p>i created an application in wpf c# with an 17\" lcd monitor... now when i build my application and try to run to other computer like my friend's 10\" netbook. the size of my main form is ok but the child window and other main control buttons are still big. it didnt fit the screen... hmmm... note: all of my child windows are created with this xaml header like this:</p>\n\n<pre><code>    Background=\"Transparent\" \n    AllowsTransparency=\"True\" \n    WindowStyle=\"None\"        \n    WindowStartupLocation=\"CenterScreen\" \n    ShowInTaskbar=\"False\" \n    DataContext=\"{Binding RelativeSource={RelativeSource Self}}\"\n</code></pre>\n"},{"tags":["c#","wpf","input","textbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13187522,"title":"Use images in textbox","body":"<p>I am creating a control that displays a hex value (For example FFAA-CA10-56D7) . Right now the value consists of images. The value of the control looks like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/HdLX7.png\" alt=\"enter image description here\"></p>\n\n<p>For a read only control I have no problems. I am able to place the appropriate images according to the value. So if I have to set the value to <code>FF</code> for example I will iterate through the characters on the string and then place the corresponding image.</p>\n\n<p><strong>Now the problem is</strong> with read-write controls. It will be nice if I could use the same font. Right now I append images as the user types values. <strong>But it is not friendly</strong>. What if the user wants to select 3 characters by dragging the mouse?. Or how could I perform the shift+arrow key combination that will select multiple characters.  </p>\n\n<p><strong>So in short</strong> I will like to keep the same look and feel of the control and I do not want to replace the images for a textbox. What approach do you guys recommend so that I can keep the same look and feel. </p>\n\n<p><strong>Things I have tried:</strong></p>\n\n<p>I tried to create my custom font from those png's. But haven't been successful on finding the right program that will enable me to create a font from png images.</p>\n"},{"tags":["wpf","wpf-controls","thumb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3812,"score":0,"question_id":1161411,"title":"Resizing Thumb Template Control on Canvas in WPF","body":"<p>I've dynamically placed a user control on a <code>Canvas</code> as the <code>VisualTree</code> root in a <code>Thumb</code> control. I can move the thumb control correctly, but can only correctly re-size the control while resizing from the east, southeast, and south rectangles defined in the user control.</p>\n\n<pre><code>//Instantiate a new Thumb control to be placed on the canvas.\nvar myThumb = new Thumb();\nmyThumb.Name = \"myThumb\";\n\n//Instantiate a new ThumbTemplate and ElementFactory with my user control.\nvar myThumbTemplate = new ControlTemplate(typeof(Thumb));\nmyThumbTemplate.VisualTree = new FrameworkElementFactory(typeof(MyUserControl), \"myUserControl\");\n\n//Set the thumb template to the newly instantiated template.\nmyThumb.Template = myThumbTemplate;\n\n//Point the DragDelta and DragCompleted events to local methods.\nmyThumb.DragDelta += new DragDeltaEventHandler(myThumb_DragDelta);\nmyThumb.DragCompleted += new DragCompletedEventHandler(myThumb_DragCompleted);\n\n//Add the thumb to the canvas control.\nthis.myCanvas.Children.Add(myThumb);\nCanvas.SetZIndex(myThumb, 1);\nCanvas.SetTop(myThumb, 75);\nCanvas.SetLeft(myThumb, 50);\n</code></pre>\n\n<p>In the <code>DragDelta</code> method, this approach works to resize the user control from the east resizing rectangle:</p>\n\n<pre><code>var myThumb = sender as Thumb;\nif (myThumb != null)\n{\n    var myUserControl = myThumb.Template.FindName(\"myUserControl\", myThumb) as MyUserControl;\n    if (myUserControl != null)\n    {\n        myUserControl.Width = myUserControl.OldWidth + e.HorizontalChange;\n    } \n}\n</code></pre>\n\n<p>But wherever I attempt to do that plus set the <code>Canvas.Top</code> of the <code>Thumb</code> control  (Ie. from the North re-size rectangle), I don't get the results I expected:</p>\n\n<pre><code>double top = Canvas.GetTop(finderThumb) + e.VerticalChange;\nmyUserControl.Height = myUserControl.OldHeight - e.VerticalChange;\nCanvas.SetTop(myThumb, top);\n</code></pre>\n\n<p>What happens then is that the control moves up and down in the canvas control but only ever re-sizes by one pixel, regardless of the Vertical or Horizontal Change. Any ideas as to why this happens and suggestions for resolving the issue? Thanks!</p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13188268,"title":"More Binding To ListView","body":"<p>Original question was here.\n<a href=\"http://stackoverflow.com/questions/13150067/binding-to-a-listview\">Binding To A ListView</a></p>\n\n<p>I have fixed one issue and now see the column names. However, I can't figure out the binding.  </p>\n\n<p>The error from the output window:</p>\n\n<pre><code> System.Windows.Data Error: 4 : Cannot find source for binding with reference \n'ElementName=This'. BindingExpression:Path=LogView.LogEntries; DataItem=null; target \nelement is 'ListView' (Name='LoggingListView'); target property is 'ItemsSource' (type     'IEnumerable')\n</code></pre>\n\n<p>Snippet of the XAML with my latest attempt from LogFileWindow.XAML. I can post more but trying to keep the clutter down:</p>\n\n<pre><code>   &lt;ListView Name=\"LoggingListView\" ItemsSource=\"{Binding ElementName=This,  Path=LogView.LogEntries}  \"&gt;\n                        &lt;ListView.View&gt;\n                        &lt;GridView&gt;\n                            &lt;GridViewColumn Header=\"Date\" DisplayMemberBinding=\"{Binding Path=Date}\"&gt;&lt;/GridViewColumn&gt;\n                            &lt;GridViewColumn Header=\"Time\" DisplayMemberBinding=\"{Binding Path=Time}\"&gt;&lt;/GridViewColumn&gt;\n                            &lt;GridViewColumn Header=\"Event\" DisplayMemberBinding=\"{Binding Path=Event}\"&gt;&lt;/GridViewColumn&gt;\n                        &lt;/GridView&gt;\n                        &lt;/ListView.View&gt;\n                    &lt;/ListView&gt;\n</code></pre>\n\n<p>The C# ViewModel:</p>\n\n<pre><code>public class LogEntryViewModel : INotifyPropertyChanged\n{\n   public LogEntryViewModel(LogFileEntry le)\n    {\n        _date = le.Date;\n        _time = le.Time;\n        _event = le.Event;\n    }     \n    #region Members\n    private string _date;\n    public string Date\n    {\n        get { return _date; }\n        set {_date = value;\n        RaisePropertyChanged(\"Date\");           \n        }\n    }\n\n    private string _time;\n    public string Time\n    {\n        get { return _time; }\n        set\n        {\n            _time = value;\n            RaisePropertyChanged(\"Time\");\n\n        }\n    }\n\n    private string _event;\n    public string Event\n    {\n        get { return _event; }\n        set { _event = value;\n        RaisePropertyChanged(\"Event\");\n        }\n    }\n    private LogFileEntry _le;\n    #endregion\n\n    #region INotifyPropertyChanged Members\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    #endregion\n\n    private void RaisePropertyChanged(string propertyName)\n    {\n        // take a copy to prevent thread issues\n        PropertyChangedEventHandler handler = PropertyChanged;\n        if (handler != null)\n        {\n            handler(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n}\n\npublic class LogViewModel :ObservableCollection&lt;LogEntryViewModel&gt;\n{\n       private ObservableCollection&lt;LogEntryViewModel&gt; _LogEntries;\n    public ObservableCollection&lt;LogEntryViewModel&gt; LogEntries = new    \n  ObservableCollection&lt;LogEntryViewModel&gt;();\n\n}\n</code></pre>\n\n<p>Partial Class declaration and code-behind where I am trying to use it:</p>\n\n<pre><code>public partial class LogFileWindow : Window\n{\n    public  LogViewModel LogView = new LogViewModel();\n</code></pre>\n\n<p>}</p>\n"},{"tags":["wpf","data-binding","treeview","contextmenu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13114791,"title":"WPF: Preventing the ContextMenu from appearing on child TreeViewItems","body":"<p>I am trying to make design a WPF TreeView where the ContextMenu activates on particular nodes.</p>\n\n<p>In my example, despite my best efforts, I cannot keep the ContextMenu of a BarNode from appearing when it's children 'FooNode's are clicked.</p>\n\n<p><strong>C#:</strong></p>\n\n<pre><code>public abstract class NodeBase\n{\n    public NodeBase[] ChildNodes { get; set; }\n}\n\npublic class FooNode : NodeBase\n{\n\n}\n\npublic class BarNode : NodeBase\n{\n}\n\npublic class ExampleModel : BaseModel\n{\n    private NodeBase[] _nodes;\n\n    public NodeBase[] Nodes\n    {\n        get\n        {\n            _nodes = new NodeBase[]\n                {\n                    new FooNode(), \n                    new BarNode()\n                        {\n                            ChildNodes = new NodeBase[]\n                            {\n                                new FooNode(),\n                                new FooNode()\n                            }\n                        }\n                };\n            return _nodes;\n        }\n    }\n\n    public ExampleModel()\n    {\n\n    }\n}\n\npublic class TreeViewStyleSelector : StyleSelector\n{\n    public Style FooNodeStyle { get; set; }\n\n    public Style BarNodeStyle { get; set; }\n\n    public override Style SelectStyle(object item, DependencyObject container)\n    {\n        var fooNode = item as FooNode;\n        if (fooNode != null)\n        {\n            return FooNodeStyle;\n        }\n\n        var barNode = item as BarNode;\n        if (barNode != null)\n        {\n            return BarNodeStyle;\n        }\n\n        return base.SelectStyle(item, container);\n    }\n}\n</code></pre>\n\n<p><strong>XAML</strong></p>\n\n<pre><code>&lt;Window\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:Nodes=\"clr-namespace:UnderstandingWPFTreeView.Nodes\"\n        xmlns:Models=\"clr-namespace:UnderstandingWPFTreeView.Models\"\n        xmlns:Common=\"clr-namespace:UnderstandingWPFTreeView.Common\" \n    x:Class=\"UnderstandingWPFTreeView.MainWindow\" \n        Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n\n    &lt;Window.DataContext&gt;\n        &lt;Models:ExampleModel/&gt;\n    &lt;/Window.DataContext&gt;\n\n    &lt;Window.Resources&gt;\n        &lt;ContextMenu x:Key=\"testContextMenu\"&gt;\n            &lt;MenuItem Header=\"Test Context Item\"&gt;&lt;/MenuItem&gt;\n            &lt;MenuItem Header=\"Test Context Item\"&gt;&lt;/MenuItem&gt;\n        &lt;/ContextMenu&gt;\n\n        &lt;Style TargetType=\"{x:Type TreeViewItem}\"  x:Key=\"FooNodeStyle\"&gt;\n        &lt;/Style&gt;\n\n        &lt;Style TargetType=\"{x:Type TreeViewItem}\"  x:Key=\"BarNodeStyle\"&gt;\n            &lt;Setter Property=\"ContextMenu\" Value=\"{StaticResource testContextMenu}\" /&gt;\n        &lt;/Style&gt;\n\n        &lt;Common:TreeViewStyleSelector\n                x:Key=\"treeViewStyleSelector\"\n                FooNodeStyle=\"{StaticResource ResourceKey=FooNodeStyle}\"\n                BarNodeStyle=\"{StaticResource ResourceKey=BarNodeStyle}\" /&gt;\n\n    &lt;/Window.Resources&gt;\n\n    &lt;StackPanel HorizontalAlignment=\"Left\" Height=\"320\" VerticalAlignment=\"Top\" Width=\"517\"&gt;\n        &lt;TreeView Height=\"100\"&gt;\n            &lt;TreeView.Resources&gt;\n                &lt;HierarchicalDataTemplate DataType=\"{x:Type Nodes:BarNode}\" ItemsSource=\"{Binding Path=ChildNodes}\"&gt;\n                    &lt;TextBlock Text=\"Bar\" /&gt;\n                &lt;/HierarchicalDataTemplate&gt;\n\n                &lt;HierarchicalDataTemplate DataType=\"{x:Type Nodes:FooNode}\" ItemsSource=\"{Binding Path=ChildNodes}\"&gt;\n                    &lt;TextBlock Text=\"Foo\" /&gt;\n                &lt;/HierarchicalDataTemplate&gt;\n            &lt;/TreeView.Resources&gt;\n\n            &lt;TreeViewItem Header=\"Testing\" ItemsSource=\"{Binding Nodes}\" ItemContainerStyleSelector=\"{StaticResource ResourceKey=treeViewStyleSelector}\"/&gt;\n        &lt;/TreeView&gt;\n    &lt;/StackPanel&gt;\n\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf","multithreading","gui","dispatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1172,"score":2,"question_id":6180650,"title":"Getting UI dispatcher in class library","body":"<p>I'd like to design a class library and plan to use mutli-threading (i.e. <code>BackgroundWorker</code>). I will have to watch out for the thread context, from which updates are made for fields, if I plan to bind them to the GUI of the library consuming frontend. It's not a good idea to pass the reference of the GUI dispatcher to the library, as I read. But how can I get access to the dispatcher of the application that will use the library? Is this possible?</p>\n\n<p>I tried <code>Application.Current.Dispatcher</code> and added a reference to <code>WindowBase</code> (as I didn't have the possibility to add <code>System.Windows</code>), but still can't resolve the dispatcher object.</p>\n"},{"tags":["wpf","web-services","silverlight-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13187855,"title":"Domain service Error in Wpf , works fine in silverlight","body":"<p>I am trying to consume web service in WPF application using add reference in VS2010. \n..?wsdl</p>\n\n<p>I know it's very famous error, but not sure why I am not able get the solution.</p>\n\n<p>I have tried the couple of ways suggested in <a href=\"http://stackoverflow.com/a/2477046\">Stack Overflow</a>, none worked.</p>\n\n<p>When I try to invoke any of the method, service works fine in Silverlight, but in WPF, it throws me the below error:</p>\n\n<pre><code>The HTTP request is unauthorized with client authentication scheme 'Anonymous'. \n</code></pre>\n\n<p>The authentication header received from the server was 'Negotiate, Basic realm=\"\"'.</p>\n\n<p>Server stack trace: </p>\n\n<blockquote>\n  <p>at\n  System.ServiceModel.Channels.HttpChannelUtilities.ValidateAuthentication(HttpWebRequest\n  request, HttpWebResponse response, WebException responseException,\n  HttpChannelFactory factory)    at\n  System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest\n  request, HttpWebResponse response, HttpChannelFactory factory,\n  WebException responseException, ChannelBinding channelBinding)    at\n  System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan\n  timeout)    at\n  System.ServiceModel.Channels.RequestChannel.Request(Message message,\n  TimeSpan timeout)    at\n  System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message\n  message, TimeSpan timeout)    at\n  System.ServiceModel.Channels.ServiceChannel.Call(String action,\n  Boolean oneway, ProxyOperationRuntime operation, Object[] ins,\n  Object[] outs, TimeSpan timeout)    at\n  System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage\n  methodCall, ProxyOperationRuntime operation)    at\n  System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage\n  message)</p>\n</blockquote>\n\n<p>My <code>app.config</code>:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n        &lt;basicHttpBinding&gt;               \n            &lt;binding name=\"abcdonWSServiceSoapBinding\" closeTimeout=\"00:01:00\"\n                openTimeout=\"00:01:00\" receiveTimeout=\"00:10:00\" sendTimeout=\"00:01:00\"\n                allowCookies=\"false\" bypassProxyOnLocal=\"false\" hostNameComparisonMode=\"StrongWildcard\"\n                maxBufferSize=\"65536\" maxBufferPoolSize=\"524288\" maxReceivedMessageSize=\"65536\"\n                messageEncoding=\"Text\" textEncoding=\"utf-8\" transferMode=\"Buffered\"\n                useDefaultWebProxy=\"true\"&gt;\n                &lt;readerQuotas maxDepth=\"32\" maxStringContentLength=\"8192\" maxArrayLength=\"16384\"\n                    maxBytesPerRead=\"4096\" maxNameTableCharCount=\"16384\" /&gt;\n              &lt;security mode=\"None\"&gt;\n                &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\"\n                    realm=\"\" /&gt;\n                &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n              &lt;/security&gt;\n            &lt;/binding&gt;\n        &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;client&gt;            \n        &lt;endpoint address=\"http://......../.../svc/abcdon-ws\"\n            binding=\"basicHttpBinding\" bindingConfiguration=\"abcdWSServiceSoapBinding\"\n            contract=\"abcdWS.abcdonWebService\" name=\"abcdonWebServicePort\" /&gt;\n    &lt;/client&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Any Help is really appreciated.</p>\n"},{"tags":["c#",".net","wpf","3d"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":165,"score":1,"question_id":8616266,"title":"Center of a ModelVisual3D","body":"<p>I have a ModelVisual3D with some cubes in it. If I want to rotate the whole group by its center, how do I do that? </p>\n\n<p>Here is my code:</p>\n\n<pre><code>RotateTransform3D rt;\nAxisAngleRotation3D ar;\nTransform3DGroup grp;\n\nrt = new RotateTransform3D();\nar = new AxisAngleRotation3D();                     \n\nar.Axis = new Vector3D(1, 0, 0);\nar.Angle = x; //x a value 0-360\nrt.Rotation = ar;\nrt.CenterX = //*Here i need the center of the ModelVisual3D X*\nrt.CenterY = //*Here i need the center of the ModelVisual3D Y*\nrt.CenterZ = //*Here i need the center of the ModelVisual3D Z*\n\ngrp = new Transform3DGroup();\ngrp.Children.Add(rt);\n\ncubes.Transform = grp; //cubes is the ModelVisual3D object that i want to rotate\n</code></pre>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13188006,"title":"Different itemssource for different combobox in Datagrid","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13182777/different-values-for-different-comboboxes-in-datagrid\">Different values for different comboboxes in Datagrid</a>  </p>\n</blockquote>\n\n\n\n<p>I have two comboboxes added to a <code>DataGrid</code> using the code below:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;DataGrid x:Name=\"dData\" HorizontalAlignment=\"Left\" Margin=\"76,105,0,0\" VerticalAlignment=\"Top\" Height=\"191\" Width=\"313\" Grid.ColumnSpan=\"2\" AutoGenerateColumns=\"False\"&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridTextColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\" Header=\"Hello\"/&gt;\n        &lt;DataGridTemplateColumn Header=\"Status\" Width=\"100\"&gt;\n            &lt;DataGridTemplateColumn.CellTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;ComboBox Name=\"Combo1\" Height=\"22\"/&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/DataGridTemplateColumn.CellTemplate&gt;\n        &lt;/DataGridTemplateColumn&gt;\n    &lt;/DataGrid.Columns&gt;\n    &lt;ComboBox Name=\"Combo1\"/&gt;\n    &lt;ComboBox Name=\"Combo2\"/&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Now, how do I add two different itemsources to these two columns?</p>\n\n<p><img src=\"http://i.stack.imgur.com/maIQN.png\" alt=\"enter image description here\"></p>\n"},{"tags":["wpf","wcf","silverlight","duplex"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13187953,"title":"Consuming a WCF Polling Duplex Service in WPF","body":"<p>I'm using the WCF Polling Duplex Service in silverlight but when I try to add a new wsDualHttpBinding for WPF, I'm getting the error message below. Is there any sample configuration file or a tutorial of a Duplex WCF serving both WPF and Silverlight? Google didn't work out so far.</p>\n\n<blockquote>\n  <p>The remote server returned an unexpected response: (405) Method Not\n  Allowed.</p>\n</blockquote>\n"},{"tags":["c#","wpf","ninject","composite-primary-key","navigationservice"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13181901,"title":"NavigationService navigates to non-existing object when GoBack() is called","body":"<p>I am working on a WPF web application with a MainPage which is using ninject to load pages. </p>\n\n<p>Basically I am woundering if there is a way to tell NavigationService that an Id has changed because a user updated a value in a composite key.</p>\n\n<p>I'll do my best to explain a little more. My MultiTagPage has a MultiTagViewModel and it shows a multitagvalue consisting of (MultiTagDef, Key, Value). There is also a DataGrid with other values with the same key and MultiTagDef. If you dubble click on one of those values the corresponding multitagvalue is showed instead. </p>\n\n<p>In the database the multitagvalues are stored with composite keys (Multitagdef.Name, key, value). So if somebody updates a multitagvalue the Id is changed (say from (A, B, C) to (A, B, D)) and saved, then if the user proceeds to another multitagvalue in the datagrid (A, B, E) and perhaps deletes that object then the navigationservice try to load (A, B, C) instead of (A, B, D).</p>\n\n<p>The architecture is designed for objects which has an ID column which, of course, never changes. Unfortunately adding an ID column is not an option in this case. So does anyone have a suggestion of how to solve this? Should I try to reload the page everytime somebody saves or could I tell the NavigationService that the current object now has changed ID?</p>\n\n<p>Now, code:</p>\n\n<p>From MainPage:</p>\n\n<pre><code>public partial class MainPage : IUIService\n{\n    public static readonly DependencyProperty MainModelProperty = PropertyHelper.Register&lt;MainPage&gt;(x =&gt; x.MainModel);\n\n    public MainModel MainModel\n    {\n        get { return (MainModel)GetValue(MainModelProperty); }\n        set { SetValue(MainModelProperty, value); }\n    }\n\n    private static readonly ILog log = LogManager.GetLogger(typeof(MainPage));\n\n    public MainPage()\n    {\n        // Make doubly sure...\n        ShowsNavigationUI = false;\n\n        InitializeComponent();\n\n        App.Kernel.Rebind&lt;IUIService&gt;().ToConstant(this);\n\n        MainModel = App.Kernel.Get&lt;MainModel&gt;();\n        WindowTitle = MainModel.Title;\n\n        ContentFrame.Navigating += Navigating;\n        ContentFrame.Navigated += Navigated;\n        ContentFrame.NavigationFailed += NavigationFailed;\n    }\n\n    private void Navigating(object sender, NavigatingCancelEventArgs args)\n    {\n        object dataContext = null;\n        if(ContentFrame.Content is FrameworkElement) {\n            dataContext = ((FrameworkElement)ContentFrame.Content).DataContext;\n        } else if(ContentFrame.Content is FrameworkContentElement) {\n            dataContext = ((FrameworkContentElement)ContentFrame.Content).DataContext;\n        }\n\n        if(dataContext is ISaveable &amp;&amp; ((ISaveable)dataContext).NeedsSave) {\n            if(MessageControl.UnsavedSync() != MessageControl.Button.Yes) {\n                args.Cancel = true;\n            }\n        }\n    }\n\n    private void Navigated(object sender, NavigationEventArgs e)\n    {\n        var mi = e.ExtraData as MenuItemModel;\n\n        if(mi == null) {\n            var page = e.Content as IMenuItemPage;\n\n            if(page != null) {\n                mi = page.MenuItem;\n            }\n\n            if(mi == null) {\n                log.DebugFormat(\"Navigated to {0} ({1}) without menu item\", e.Content, e.Uri);\n                return;\n            }\n        }\n\n        MainModel.CurrentMenuItem = mi;\n\n        if(mi.Type != MenuItemType.Folder) {\n            Settings.Default.AddRecentMenuItem(new RecentMenuItem(mi.MenuItem));\n        }\n    }\n\n    #region Generic Edit command\n\n    private void EditCanExecute(object sender, CanExecuteRoutedEventArgs e)\n    {\n        e.Handled = true;\n        e.CanExecute = false;\n\n        var param = Unwrap(e.Parameter);\n        var paramType = GetEditType(param);\n        if(paramType == null || !editPages.ContainsKey(paramType)) {\n            return;\n        }\n\n        e.CanExecute = ToConstructorArgument(param) != null;\n    }\n\n    private void EditExecuted(object sender, ExecutedRoutedEventArgs e)\n    {\n        Edit(e.Parameter);\n    }\n\n    private void Edit(object param)\n    {\n        var paramType = GetEditType(param);\n        if(paramType == null || !editPages.ContainsKey(paramType)) {\n            log.WarnFormat(\"Page for param {0} (type {1}) not found\", param, paramType);\n            return;\n        }\n\n        if(param is IList) {\n            var list = (IList)param;\n            if(list.Count &gt; 1000) {\n                Show(\"Too many items selected\", \"Please select no more than 1000 items at a time\", messageTheme: MessageTheme.Warning);\n                return;\n            }\n        }\n\n        var arg = ToConstructorArgument(param);\n        if(arg == null) {\n            log.Warn(\"Unexpected parameter \" + param + \" supplied to EditExecuted\");\n            return;\n        }\n\n        var pageType = editPages[paramType];\n\n        try {\n            log.DebugFormat(\"Got a parameter of type {0}, navigating to edit page {1}\", param.GetType(), pageType);\n\n            Navigate(MakePage(pageType, arg));\n        } catch(Exception ex) {\n            log.Error(\"Unable to load edit page for parameter \" + param, ex);\n        }\n    }\n\n\n    private static Page MakePage(Type pageType, params IParameter[] p)\n    {\n        var page = (Page)App.Kernel.Get(pageType, p);\n        var dp = ClientUtil.GetViewModelProperty(page.GetType());\n        if(dp != null) {\n            page.Loaded += (o, args) =&gt; {\n                var skrap = App.Kernel.Get(dp.PropertyType, p);\n                page.SetValue(dp, App.Kernel.Get(dp.PropertyType, p));\n            };\n            page.Unloaded += (o, args) =&gt; {\n                try {\n                    page.ClearValue(dp);\n                } catch(Exception e) {\n                    // Often happens when datagrid is in edit mode when navigating away from page:\n                    // http://connect.microsoft.com/VisualStudio/feedback/details/571967/wpf-datagrid-causes-crash-with-sorting-is-not-allowed-during-an-addnew-or-edititem-transaction\n                    log.Warn(\"Error while unloading page\", e);\n                }\n            };\n\n            ViewModelBehavior.SetUpdateUIError(page, true);\n        }\n\n        return page;\n    }\n\n    #endregion\n\n    #region Navigate command\n\n    private void NavigateCanExecute(object sender, CanExecuteRoutedEventArgs e)\n    {\n        e.CanExecute = e.Parameter is Type;\n        e.Handled = true;\n    }\n\n    private void NavigateExecuted(object sender, ExecutedRoutedEventArgs e)\n    {\n        var type = e.Parameter as Type;\n        if(type == null) {\n            return;\n        }\n\n        Navigate(MakePage(type));\n        e.Handled = true;\n    }\n\n    #endregion\n\n    #region IUIService implementation \n\n    public void Navigate(Type type, params Tuple&lt;string, object&gt;[] parameters)\n    {\n        Navigate(MakePage(type, parameters.Select(x =&gt; new ConstructorArgument(x.Item1, x.Item2)).ToArray()));\n    }\n\n    public void Navigate(Type type, MenuItemModel menuItem, params Tuple&lt;string, object&gt;[] parameters)\n    {\n        Navigate(MakePage(type, parameters.Select(x =&gt; new ConstructorArgument(x.Item1, x.Item2))\n            .Prepend(new ConstructorArgument(\"menuItem\", menuItem))\n            .Prepend(new ConstructorArgument(\"props\", menuItem.Params))\n            .ToArray()), \n            menuItem);\n    }\n\n    public void Navigate(Page content, object extraData = null)\n    {\n        if(ContentFrame != null) {\n            if(ContentFrame.Content is DependencyObject) {\n                foreach(var dg in WpfUtil.FindDescendants&lt;DataGrid&gt;((DependencyObject)ContentFrame.Content)) {\n                    while(!dg.CommitEdit()) { /* Keep committing */ }\n                }\n            }\n\n            ContentFrame.Navigate(content, extraData);\n        }\n    }\n\n    public bool NavigateBack()\n    {\n        if(ContentFrame != null &amp;&amp; ContentFrame.CanGoBack) {\n            ContentFrame.GoBack();\n            return true;\n        } \n\n        if(NavigationService != null &amp;&amp; NavigationService.CanGoBack) {\n            NavigationService.GoBack();\n            return true;\n        }\n\n        return false;\n    }\n\n}\n</code></pre>\n\n<p>Please tell me if you need more information.</p>\n"},{"tags":["wpf","encryption","web-config","app-config"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13186841,"title":"Encrypt app.config over client machines","body":"<p>I have a wpf application and it is installed on client machines\nwhere i have to encrpyt the connection strings in the app.config</p>\n\n<p>I encrypted the app.config from the VS CMD with these steps\nEncryption:</p>\n\n<p>1: copy App.Config App.Config.original</p>\n\n<p>2: rename App.config web.config</p>\n\n<p>3: aspnet_regiis -pef connectionStrings . -prov DataProtectionConfigurationProvider</p>\n\n<p>4: rename web.config App.config</p>\n\n<p>when I copied the encrypted string from this machine to client it did't worked.\nWhat is the best way to encrypt the connection strings over client machines.</p>\n"},{"tags":["c#","wpf","asynchronous","async-await","async-ctp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13185802,"title":"How to make the whole application responsive rather than the individual UI Controls using async and await?","body":"<p>I am using <code>async</code> and <code>await</code> keywords to make an app responsive</p>\n\n<p>I have the following code in the <code>View</code> when the property is raised in the <code>ViewModel</code>.</p>\n\n<p><strong>VIEW: Button Click Event</strong></p>\n\n<pre><code>    private async void button1_Click(object sender, RoutedEventArgs e)\n    {\n        button1.IsEnabled = false;\n\n        // Property Change\n        _viewModel.Words = await Task.Factory.StartNew(() =&gt; File.ReadAllLines(\"Words.txt\").ToList()); // takes time to read about 3 - 4 seconds\n\n        switch (_viewModel.RadioButtonWordOrderSelection)\n        {\n            case MainWindowViewModel.RadioButtonWordOrderSelections.NormalOrder:\n                break;\n\n            case MainWindowViewModel.RadioButtonWordOrderSelections.ReverseOrder:\n                await Task.Factory.StartNew(() =&gt;\n                                                {\n                                                    var words = _viewModel.Words.ToList();\n                                                    words.Reverse();\n                                                    // Property Change\n                                                    _viewModel.Words = words;\n                                                });\n                break;\n\n            case MainWindowViewModel.RadioButtonWordOrderSelections.Shuffle:\n                await Task.Factory.StartNew(() =&gt;\n                                                {\n                                                    // Property Change\n                                                    _viewModel.Words = _viewModel.Words.Shuffle().ToList();\n                                                });\n                break;\n        }\n\n        await Task.Factory.StartNew(() =&gt; DownloadSomething(_viewModel.Words)); // takes time to read about 30 - 40 seconds\n\n        button1.IsEnabled = true;\n    }\n</code></pre>\n\n<p><code>_viewModel.Progress</code> gets updated in the <code>View</code></p>\n\n<p><strong>VIEW: Private Method Takes 30 - 40 seconds To Complete</strong></p>\n\n<pre><code>    private void DownloadSomething(IEnumerable&lt;string&gt; words)\n    {\n        // Property Change\n        _viewModel.Progress = 0;\n\n        foreach (var word in words)\n        {\n            // Property Change\n            _viewModel.Word = word;\n            try\n            {\n                // Some code WebClient download code here\n            }\n            catch (Exception e)\n            {\n                //Trace.WriteLine(e.Message);\n            }\n\n            // Property Change\n            _viewModel.Progress++;\n        }\n    }\n</code></pre>\n\n<p><strong>VIEW: Property Change Event Handled</strong></p>\n\n<pre><code>    void _viewModel_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)\n    {\n        try\n        {\n            switch(e.PropertyName)\n            {\n                case \"Progress\":\n                    // Since its a different Thread\n                    // http://msdn.microsoft.com/en-us/magazine/cc163328.aspx\n                    // Sets the Value on a ProgressBar Control.\n                    // This will work as its using the dispatcher\n\n                    // The following works\n                    //Dispatcher.Invoke(\n                    //    DispatcherPriority.Normal, \n                    //    new Action&lt;double&gt;(SetProgressValue), \n                    //    _viewModel.Progress);\n\n                    // from http://stackoverflow.com/questions/2982498/wpf-dispatcher-the-calling-thread-cannot-access-this-object-because-a-differen\n                    progress1.Dispatcher.Invoke(\n                        DispatcherPriority.Normal, \n                        new Action(() =&gt;\n                        {\n                            progress1.Value = _viewModel.Progress;\n                        })\n                    );\n\n                    // This will throw an exception \n                    // (it's on the wrong thread)\n                    //progress1.Value = _viewModel.Progress;\n                    break;\n\n                case \"Words\":\n                    // Since its a different Thread\n                    // http://msdn.microsoft.com/en-us/magazine/cc163328.aspx\n                    // Sets the Max Value on a ProgressBar Control.\n                    // This will work as its using the dispatcher\n\n                    // The following Works\n                    //Dispatcher.Invoke(\n                    //    DispatcherPriority.Normal,\n                    //    new Action&lt;double&gt;(SetProgressMaxValue),\n                    //    _viewModel.Words.Count);\n\n                    // from http://stackoverflow.com/questions/2982498/wpf-dispatcher-the-calling-thread-cannot-access-this-object-because-a-differen\n                    progress1.Dispatcher.Invoke(\n                        DispatcherPriority.Normal, \n                        new Action(() =&gt;\n                        {\n                            progress1.Maximum = _viewModel.Words.Count;\n                        })\n                    );\n\n                    // This will throw an exception \n                    // (it's on the wrong thread)\n                    //progress1.Maximum = _viewModel.Words.Count;\n                    break;\n\n                case \"Word\":\n                    // Since its a different Thread\n                    // http://msdn.microsoft.com/en-us/magazine/cc163328.aspx\n                    // Sets the Contant on a Label Control.\n                    // This will work as its using the dispatcher\n\n                    // The following Works\n                    //Dispatcher.Invoke(\n                    //    DispatcherPriority.Normal,\n                    //    new Action&lt;string&gt;(SetLastWordValue),\n                    //    _viewModel.Word);\n\n                    // from http://stackoverflow.com/questions/2982498/wpf-dispatcher-the-calling-thread-cannot-access-this-object-because-a-differen\n                    labelLastWord.Dispatcher.Invoke(\n                        DispatcherPriority.Normal, \n                        new Action(() =&gt;\n                        {\n                            labelLastWord.Content = _viewModel.Word;\n                        })\n                    );\n\n                    // This will throw an exception \n                    // (it's on the wrong thread)\n                    //labelLastWord.Content = _viewModel.Word;\n                    break;\n\n                case \"RadioButtonWordOrderSelection\":\n                    break;\n\n                default:\n                    throw new NotImplementedException(\"[Not implemented for 'Property Name': \" + e.PropertyName + \"]\");\n            }\n        }\n        catch(Exception ex)\n        {\n            MessageBox.Show(ex.Message + \"\\n\" + ex.StackTrace);\n        }\n    }\n</code></pre>\n\n<p>The UI updates perfectly for the progressBar1 and labelLastWord! I am facing a problem though, when  progressBar1 and labelLastWord is updating the rest of the UI is frozen.</p>\n\n<p>Is there a work around to fix this?</p>\n\n<p>I greatly appreciate any help!</p>\n"},{"tags":["c#","wpf","ribbon-control","wpf-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":13174403,"title":"Change Theme of .NET 4.5 WPF Ribbon","body":"<p>I am trying to <code>change the theme</code> of the new <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.ribbon.ribbon.aspx\" rel=\"nofollow\">WPF Ribbon Control</a> from .NET Framework 4.5 and I am stuck.</p>\n\n<p>I only managed to change <strong>some brushes</strong> (Background, Foreground, Border ...) but I seem to be <code>unable to change the bright overlay and shadows</code>.</p>\n\n<p>I am happy to use a <code>resource dictionary</code> but I don’t know which <code>properties</code> I need to set.</p>\n\n<p>I hope you can point me in the right direction, thank you much for your help!</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13185855,"title":"Application Testing Best Place to put Events","body":"<p>In trying to follow MVVM with WPF I ran across a case where I am not sure where to put code for testing. All lines in the btnReset_Click Method UI commands so I don't know if they belong in the view model but I also don't want to put code in my code behind. I have listed out two options I have thought of but am also open to another solution as well. </p>\n\n<pre><code>Public class  Main : Window\n    {\n      private void btnReset_Click(object sender, RoutedEventArgs e)\n            {\n                DynamicStackPanel.Children.Clear();\n                controls.Clear();\n                txtUsername.Text = string.Empty;\n                txtPassword.Text = string.Empty;\n                txtResponse.Text = string.Empty;\n                cbxTestEnvironment.SelectedValue = string.Empty;\n                cbxOperation.SelectedItem = null;\n                cbxTestEnvironment.SelectedItem = null;\n            }\n    }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>public class MainViewModel : DependencyObject\n    {\n\n    public MainViewModel : DependancyObject\n    {\n          public MainViewModel(UtilityMain win)\n        {\n          win.btnReset.Click +=btnReset_Click;\n\n        }\n\n\n\n private void btnReset_Click(object sender, RoutedEventArgs e)\n        {\n            DynamicStackPanel.Children.Clear();\n            controls.Clear();\n            txtUsername.Text = string.Empty;\n            txtPassword.Text = string.Empty;\n            txtResponse.Text = string.Empty;\n            cbxTestEnvironment.SelectedValue = string.Empty;\n            cbxOperation.SelectedItem = null;\n            cbxTestEnvironment.SelectedItem = null;\n        }\n}\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":652,"score":2,"question_id":5474173,"title":"i want to clear all values in grid not (datagrid) children in wpf","body":"<p>i want to clear all values in grid children example if one of my grid children is textbox I want to reset it or clear it fro grid name not from textbox ? how? not clear the grid but clear the text in the textbox </p>\n"},{"tags":["wpf","textbox","rounded-corners"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13185766,"title":"Why does this XAML produce textboxes that resize with the window?","body":"<p>I am trying to create some rounded textboxes, and I have found some XAML here on this site, and it works well at creating the textboxes I want.  However, if I resize my window, either in the designer or at run time, the height and width of the textboxes change with it, and they get distorted and useless.</p>\n\n<p>I'm still learning WPF, so I'm sure I am missing something simple.  Thanks for any help.</p>\n\n<pre><code>&lt;Window x:Name=\"mainWindow\" x:Class=\"CMDB_Express.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"CMDB Express\" Height=\"289\" Width=\"600\" SizeToContent=\"Height\" MinHeight=\"289\"&gt;\n&lt;Window.Resources&gt;\n    &lt;ControlTemplate x:Key=\"TextBoxBaseControlTemplate\" TargetType=\"{x:Type TextBoxBase}\"&gt;\n        &lt;Border Background=\"{TemplateBinding Background}\"\n                x:Name=\"Bd\" BorderBrush=\"Black\"\n                BorderThickness=\"{TemplateBinding BorderThickness}\" CornerRadius=\"10\"&gt;\n        &lt;/Border&gt;\n    &lt;/ControlTemplate&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid&gt;\n    &lt;TextBox Name=\"txtDOE\" KeyboardNavigation.TabIndex=\"0\" Template=\"{StaticResource TextBoxBaseControlTemplate}\" Margin=\"139,59,339,159\" FontFamily=\"Segoe UI\" FontSize=\"18\" VerticalContentAlignment=\"Center\" MaxLength=\"7\" /&gt;\n    &lt;Label x:Name=\"lblDOE\" Content=\"DOE Number: \" HorizontalAlignment=\"Left\" Margin=\"10,72,0,0\" VerticalAlignment=\"Top\" FontFamily=\"Segoe UI\" Height=\"33\" FontSize=\"18\"/&gt;\n    &lt;TextBox Name=\"txtCustodian\" KeyboardNavigation.TabIndex=\"1\" Template=\"{StaticResource TextBoxBaseControlTemplate}\" Margin=\"139,121,339,97\" FontFamily=\"Segoe UI\" FontSize=\"16\" VerticalContentAlignment=\"Center\" /&gt;\n    &lt;Label x:Name=\"lblCustodian\" Content=\"Custodian: \" HorizontalAlignment=\"Left\" Margin=\"35,134,0,0\" VerticalAlignment=\"Top\" FontFamily=\"Segoe UI\" Height=\"33\" FontSize=\"18\"/&gt;\n    &lt;TextBox Name=\"txtBuilding\" KeyboardNavigation.TabIndex=\"2\" Template=\"{StaticResource TextBoxBaseControlTemplate}\" Margin=\"396,59,75,159\" FontFamily=\"Segoe UI\" FontSize=\"16\" VerticalContentAlignment=\"Center\" /&gt;\n    &lt;Label x:Name=\"lblBuilding\" Content=\"Building: \" HorizontalAlignment=\"Left\" Margin=\"307,72,0,0\" VerticalAlignment=\"Top\" FontFamily=\"Segoe UI\" Height=\"33\" FontSize=\"18\"/&gt;\n    &lt;TextBox Name=\"txtRoom\" KeyboardNavigation.TabIndex=\"3\" Template=\"{StaticResource TextBoxBaseControlTemplate}\" Margin=\"396,121,75,97\" FontFamily=\"Segoe UI\" FontSize=\"16\" VerticalContentAlignment=\"Center\" /&gt;\n    &lt;Label x:Name=\"lblRoom\" Content=\"Room: \" HorizontalAlignment=\"Left\" Margin=\"325,134,0,0\" VerticalAlignment=\"Top\" FontFamily=\"Segoe UI\" Height=\"33\" FontSize=\"18\"/&gt;\n    &lt;TextBox x:Name=\"txtDnsName\" KeyboardNavigation.TabIndex=\"1\" Template=\"{StaticResource TextBoxBaseControlTemplate}\" Margin=\"139,183,339,35\" FontFamily=\"Segoe UI\" FontSize=\"16\" VerticalContentAlignment=\"Center\" /&gt;\n    &lt;Label x:Name=\"lblDnsName\" Content=\"DNS Name: \" HorizontalAlignment=\"Left\" Margin=\"35,196,0,0\" VerticalAlignment=\"Top\" FontFamily=\"Segoe UI\" Height=\"33\" FontSize=\"18\"/&gt;\n    &lt;Expander x:Name=\"expAdvanced\" Header=\"Advanced...\" HorizontalAlignment=\"Left\" Margin=\"262,234,0,0\" VerticalAlignment=\"Top\"&gt;\n        &lt;Grid Background=\"#FFE5E5E5\"&gt;\n            &lt;Label x:Name=\"lblExpanded\" Content=\"EXPANDED!\"/&gt;\n        &lt;/Grid&gt;\n    &lt;/Expander&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13180433,"title":"Binding to DP of DO in Resources doesn't work with no errors?","body":"<p>I'm trying to create a class that will manage a collection of objects that are based off of an input of a different collection of objects. The resulting collection is specific to my user interface, while the input collection is just collection of data objects (models).</p>\n\n<p>I wanted to be able to bind the input collection to a property of my DataContext. So, it seemed like it would be nice to do it in XAML and not in the code behind. I tried implementing DepedencyObject and creating a DP for the input collection. I also implemented IEnumerable in my GraphPlotManager dependency object so I could bind other controls items source to it.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>&lt;local:GraphPlotManager x:Key=\"plotManager\"\n                                 GraphObjects=\"{Binding GraphObjects}\"&gt;\n</code></pre>\n\n<p>and with a DataContextSpy</p>\n\n<pre><code>&lt;common:DataContextSpy x:Key=\"spy2\" /&gt;\n&lt;local:GraphPlotManager x:Key=\"plotManager\"\n                                 GraphObjects=\"{Binding Source={StaticResource spy2}, Path=DataContext.GraphObjects}\" /&gt;\n</code></pre>\n\n<p>the constructor of my plot manager is called, but the dependency property is never set or modified and no errors are shown in the output window. What gives?</p>\n\n<p>Edit: here's the DP code (I used the snippet, and only added an OnChanged handler)</p>\n\n<pre><code>public ObservableCollection&lt;GraphObjectViewModel&gt; GraphObjects\n{\n    get { return (ObservableCollection&lt;GraphObjectViewModel&gt;)GetValue(GraphObjectsProperty); }\n    set { SetValue(GraphObjectsProperty, value); }\n}\n\npublic static readonly DependencyProperty GraphObjectsProperty =\n    DependencyProperty.Register(\"GraphObjects\", typeof(ObservableCollection&lt;GraphObjectViewModel&gt;), typeof(GraphPlotManager), new UIPropertyMetadata(null, OnGraphObjectsChanged));\n\nprivate static void OnGraphObjectsChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)\n{\n    // this code never gets hit and the Collection is still null as far as I can tell\n}\n</code></pre>\n\n<p>Edit2: After will's suggestion I cranked the data binding output verbosity all the way up, here's what I got using the spy:</p>\n\n<pre><code>System.Windows.Data Information: 10 : Cannot retrieve value using the binding and no valid fallback value exists; using default instead. BindingExpression:Path=DataContext.GraphObjects; DataItem='DataContextSpy' (HashCode=44673241); target element is 'GraphPlotManager' (HashCode=565144); target property is 'GraphObjects' (type 'ObservableCollection`1')\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>It works without the spy if my manager inherits from Freezable, but not if I do not inherit freezable, even with the DataContextSpy. I'm not sure if I need the spy in this case or not. Is it possible to work without my GraphPlotManager inheriting freezable?</p>\n"},{"tags":["wpf","datagrid","focus","cursor","celleditingtemplate"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":2663,"score":3,"question_id":4989122,"title":"WPF: CellEditingTemplate how can I set focus on the inner control by double click or on click","body":"<p>I wrote a usercontrol of DataGrid with CellEditingTemplate. The DataTemplate of this editing-Template is a TextBox, and the cursor will go into the textbox by three times click, what can i do, if i want set the cursor on the textbox by double click or one click?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>&lt;Window x:Class=\"MultiLineEditDataGrid.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"clr-namespace:MultiLineEditDataGrid\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n&lt;Grid DataContext=\"{Binding Source={x:Static Application.Current}, Path=CompanyManager}\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"270\"/&gt;\n        &lt;RowDefinition Height=\"30\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;DataGrid ItemsSource=\"{Binding Companies}\" CanUserAddRows=\"False\" AutoGenerateColumns=\"False\"&gt;\n        &lt;DataGrid.Resources&gt;\n            &lt;DataTemplate x:Key=\"cellTemplate\"&gt;\n                &lt;TextBlock Text=\"{Binding Description}\"/&gt;\n            &lt;/DataTemplate&gt;\n            &lt;DataTemplate x:Key=\"cellEditingTemplate\"&gt;\n                &lt;local:MultiLineTextBox Text=\"{Binding Description}\"/&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/DataGrid.Resources&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn Header=\"Company\" Binding=\"{Binding Name}\"/&gt;\n            &lt;DataGridTemplateColumn Header=\"Description\" \n                                    CellTemplate=\"{StaticResource cellTemplate}\" \n                                    CellEditingTemplate=\"{StaticResource cellEditingTemplate}\"/&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n    &lt;Button Grid.Row=\"1\" Content=\"Add\" Command=\"{Binding AddCommand}\"/&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>MultiLineTextBox is the TextBox which i inherit from textbox, and override OnKeyDown method.</p>\n\n<p>MultiLineTextBox's code:</p>\n\n<pre><code>public class MultiLineTextBox : TextBox\n{\n    /// &lt;summary&gt;\n    /// On Key Down.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    protected override void OnKeyDown ( KeyEventArgs e )\n    {\n        base.OnKeyDown ( e );\n        string oldText = Text;\n        ModifierKeys keys = Keyboard.Modifiers;\n        if ( e.Key == Key.Enter )\n        {\n            if ( ( Keyboard.Modifiers &amp; ModifierKeys.Control ).Equals ( ModifierKeys.Control ) )\n            {\n                int index = SelectionStart;\n                oldText = oldText.Insert ( index, Environment.NewLine );\n                Text = oldText;\n                Select ( index + 1, 0 );\n                e.Handled = true;\n            }\n            else\n            {\n                e.Handled = false;\n            }\n        }\n        else if ( e.Key == Key.Escape )\n        {\n            Text = oldText;\n            e.Handled = false;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","data-binding","mvvm","wpf-controls","mvvm-light"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13182640,"title":"MVVM Light ViewModelLocator Breaks Lookless Control Event Sequence","body":"<p><strong>UPDATE TO QUESTION - I've discovered the MVVM Light ViewModelLocator is causing the trouble.  Question updated to reflect.</strong></p>\n\n<p>I have a problem with events firing improperly on a lookless control when using the MVVM Light ViewModelLocator.  It took me a long time to figure out it was the <code>ViewModelLocator</code>, but something about setting up the Model this way breaks the event sequence.</p>\n\n<p>When I've removed all references to the <code>ViewModelLocator</code> everything works when simply setting the <code>DataContext</code> in the <code>MainWindow.xaml.cs</code> to an instance of the <code>MainViewModel.cs</code>:</p>\n\n<p><strong>MainWindows.xaml.cs</strong></p>\n\n<pre><code>DataContext = new MainViewModel();\n</code></pre>\n\n<p><strong>MainViewModel.cs</strong></p>\n\n<pre><code>public MainViewModel()\n{\n    _dataService = new DataService();\n    _dataService.GetCategories(\n        (categories, error) =&gt;\n        {\n            if (error != null)\n            {\n                return;\n            }\n\n            Categories = categories;\n        });\n}\n</code></pre>\n\n<p>I'm still using the <code>DataService</code> from MVVM Light and the rest of my code is 100% the same.  All that I've done is remove the referecnes to the <code>ViewModelLocator</code>.</p>\n\n<p>My <code>MainWindow.xaml</code> looks like this (note that the <code>DataContext</code> line would be removed for the \"non-ViewModelLocator\" version):</p>\n\n<pre><code>&lt;Window ...\n        DataContext=\"{Binding Main, Source={StaticResource Locator}}\"&gt;\n    &lt;Grid x:Name=\"LayoutRoot\"&gt;\n        &lt;Viewbox&gt;\n            &lt;Grid Width=\"1920\" Height=\"1080\"&gt;\n                ...                \n                &lt;view:AttractControl x:Name=\"AttractContent\" ItemsSource=\"{Binding Categories}\" IsHitTestVisible=\"False\" /&gt;\n                ...\n            &lt;/Grid&gt;\n        &lt;/Viewbox&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The <code>AttractControl.xaml</code>, for both versions, is defined as below (trimmed to what I think is just the important bits):</p>\n\n<p><strong>AttractControl.xaml</strong></p>\n\n<pre><code>&lt;UserControl ...&gt;\n    &lt;Grid Background=\"White\"&gt;\n        &lt;ctrl:AutoScrollCarousel\n            ItemsSource=\"{Binding ItemsSource, RelativeSource={RelativeSource AncestorType={x:Type view:AttractControl}, Mode=FindAncestor}}\"\n            SelectedItem=\"{Binding SelectedItem, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type view:AttractControl}, Mode=FindAncestor}}\"\n            ...&gt;\n            &lt;ctrl:AutoScrollCarousel.ItemsPanel&gt;\n                ...\n            &lt;/ctrl:AutoScrollCarousel.ItemsPanel&gt;\n            &lt;ctrl:AutoScrollCarousel.ItemTemplate&gt;\n                ....\n            &lt;/ctrl:AutoScrollCarousel.ItemTemplate&gt;\n        &lt;/ctrl:AutoScrollCarousel&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p><strong>When I set the <code>DataContext</code> myself, not using the <code>ViewModelLocator</code></strong>... as the code behind works it magic the <code>ItemsSource</code> and <code>SelectedItem</code> properties start to change.  The <code>ItemsSource</code> changes in (1) AttractControl and then (2) AutoScrolCarousel.  Then <code>SelectedItem</code> fires in (1) AttractControl and then (2) AutoScrollCarousel.  Great!  Makes sense.  </p>\n\n<p><strong>But when using the <code>ViewModelLocator</code> version</strong>... the <code>SelectedItem</code> event fires twice in a row in AutoScrollCarousel -- it never does in AttractControl.</p>\n\n<p>I am not understanding why changing how the <code>DataContext</code> is set, via the <code>ViewModelLocator</code> or not, breaks this event order when everything else is exactly the same.</p>\n\n<p>Is there something additional I need to do with my data bindings (Paths, Ancestors, ???) in order to properly re-sequence the order of events?</p>\n\n<p>I believe the issue comes up from this function, the ItemsSourceChanged callback in my lookless control:</p>\n\n<pre><code>private static void OnItemsSourceChanged(DependencyObject sender, DependencyPropertyChangedEventArgs args)\n{\n    var carousel = (AutoScrollCarousel)sender;\n    if (args.NewValue is IEnumerable)\n    {\n        var list = args.NewValue as IEnumerable;\n        IEnumerator enumerator = list.GetEnumerator();\n        if (enumerator.MoveNext())\n        {\n            carousel.SelectedItem = enumerator.Current;\n        }\n\n        carousel.UpdateUI(list);\n    }\n}\n</code></pre>\n\n<p>It appears that updating <code>SelectedItem</code> here is causing different behavior when I alter the <code>DataContext</code>.</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","wpf","code-review"],"answer_count":5,"favorite_count":5,"up_vote_count":14,"down_vote_count":0,"view_count":1502,"score":14,"question_id":7063902,"title":"Better way to trigger OnPropertyChanged","body":"<p>We have a WPF Project that follows the MVVM pattern.</p>\n\n<p>In the View Model there is a lot of code that looks like this:</p>\n\n<pre><code>    private string m_Fieldname;\n    public string Fieldname\n    {\n        get { return m_Fieldname; }\n        set\n        {\n            m_Fieldname = value;\n            OnPropertyChanged(\"Fieldname\");\n        }\n    }\n</code></pre>\n\n<p>Is there a way to do this that would require less code?</p>\n\n<p>Would be nice with something like this:</p>\n\n<pre><code>[NotifyWhenChanged]\npublic string Fieldname { get; set ; }\n</code></pre>\n"},{"tags":["wpf","textbox","rounded-corners"],"answer_count":2,"favorite_count":3,"up_vote_count":9,"down_vote_count":1,"view_count":8082,"score":8,"question_id":4779777,"title":"WPF rounded corner textbox","body":"<p>I don't know WPF and am now learning it. I was looking for rounded corners <code>TextBox</code> in WPF. So I searched Google and found a piece of <code>XAML</code> :</p>\n\n<pre><code> &lt;!–Rounded Corner TextBoxes–&gt;\n&lt;ControlTemplate x:Key=”RoundTxtBoxBaseControlTemplate” TargetType=”{x:Type Control}”&gt;\n&lt;Border Background=”{TemplateBinding Background}” x:Name=”Bd” BorderBrush=”{TemplateBinding BorderBrush}”\nBorderThickness=”{TemplateBinding BorderThickness}” CornerRadius=”6″&gt;\n&lt;ScrollViewer x:Name=”PART_ContentHost”/&gt;\n&lt;/Border&gt;\n&lt;ControlTemplate.Triggers&gt;\n&lt;Trigger Property=”IsEnabled” Value=”False”&gt;\n&lt;Setter Property=”Background” Value=”{DynamicResource {x:Static SystemColors.ControlBrushKey}}” TargetName=”Bd”/&gt;\n&lt;Setter Property=”Foreground” Value=”{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}”/&gt;\n&lt;/Trigger&gt;\n&lt;Trigger Property=”Width” Value=”Auto”&gt;\n&lt;Setter Property=”MinWidth” Value=”100″/&gt;\n&lt;/Trigger&gt;\n&lt;Trigger Property=”Height” Value=”Auto”&gt;\n&lt;Setter Property=”MinHeight” Value=”20″/&gt;\n&lt;/Trigger&gt;\n&lt;/ControlTemplate.Triggers&gt;\n&lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>So please tell me where to paste this <code>XAML</code>. Please help me in detail. I am a beginner in WPF.</p>\n"},{"tags":["c#",".net","wpf","multithreading","task-parallel-library"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13185184,"title":"Task.Wait vs Task.RunSyncronously where task has call to WPF Dispatcher.Invoke","body":"<p>I have a <code>Task</code> that I am starting and wish to wait for completion in a WPF app. Inside this task I invoke an <code>Action</code> on the dispatcher.</p>\n\n<p>If I use <code>Task.Wait()</code> it appears to hang as if the method never finished. Also, breakpoints inside the Dispatcher.Invoke are never hit.</p>\n\n<p>If I use <code>Task.RunSyncronously()</code> it appears to work correctly and breakpoints inside the Dispatcher are hit.</p>\n\n<p>Why is there a difference?</p>\n\n<p>Code sample below:</p>\n\n<pre><code>Task task = new Task(LoadStuff);\n\n    // never returns\n    task.Start();\n    task.Wait();\n\n    // vs\n\n    // works\n    task.RunSyncronously()\n\n\nprivate void LoadStuff()\n{\n    ObservableCollection&lt;StuffObj&gt; stuff = Stuff.Load(arg1, true);\n\n    DispatchHelper.RunOnDispatcher(() =&gt;\n    {\n        ...\n    });\n}\n\npublic static class DispatchHelper\n{\n    public static void RunOnDispatcher(Action action)\n    {\n        Application.Current.Dispatcher.Invoke(action);\n    }\n}\n</code></pre>\n"},{"tags":["wpf","layout"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13184676,"title":"WPF MeasureOverride is not called on custom panel resize (Width => MinHeight)","body":"<p>I've made custom layout panel. I've implemented MeasureOverride and ArrangeOverride methods.</p>\n\n<p>Here is how I'm using my panel.</p>\n\n<pre><code>&lt;Window\n    x:Class=\"TestWindow.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:TestPanel=\"clr-namespace:TestPanel;assembly=TestPanel\"\n    Title=\"MainWindow\"\n    Width=\"706\"\n    Height=\"200\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;Style TargetType=\"Button\"&gt;\n            &lt;Setter Property=\"Height\" Value=\"40\" /&gt;\n            &lt;Setter Property=\"MinWidth\" Value=\"120\" /&gt;\n            &lt;Setter Property=\"HorizontalAlignment\" Value=\"Stretch\" /&gt;\n            &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\" /&gt;\n        &lt;/Style&gt;\n    &lt;/Window.Resources&gt;\n    &lt;ScrollViewer&gt;\n        &lt;Border BorderBrush=\"Red\" BorderThickness=\"1\"&gt;\n            &lt;TestPanel:ShrinkPanel Background=\"Aqua\" MaxColumns=\"4\"&gt;\n                &lt;Button Content=\"Text 1\" /&gt;\n                &lt;Button Content=\"Text 2\" /&gt;\n                &lt;Button Content=\"Text 3\" Height=\"75\" /&gt;\n                &lt;Button Content=\"Text 4\" /&gt;\n                &lt;Button Content=\"Text 5\" /&gt;\n                &lt;Button Content=\"Text 6\" Height=\"100\" /&gt;\n                &lt;Button Content=\"Text 7\" /&gt;\n                &lt;Button Content=\"Text 8\" /&gt;\n                &lt;Button Content=\"Text 9\" Height=\"75\" /&gt;\n            &lt;/TestPanel:ShrinkPanel&gt;\n        &lt;/Border&gt;\n    &lt;/ScrollViewer&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Everything works fine, except MeasureOverride is not called when my panel is resized. Height property is always NaN, while ActualHeight changes, but does not cause measurement.</p>\n\n<p>How can I force Measure on resize?</p>\n\n<p>I've subscribed to SizeChanged event and called MeasureOverride like this</p>\n\n<pre><code>private void This_SizeChanged(object sender, SizeChangedEventArgs e)\n{\n    Measure(e.NewSize);\n}\n</code></pre>\n\n<p>but this code does not seem to be used anywhere in the framework. I think specifying minimum allowed Height depending on Width should be a very common task.</p>\n\n<p>So, what is the right way to remeasure and thus set DesiredSize (or MinHeight/MinWidth?!) on resize.</p>\n"},{"tags":["c#","wpf","visual-studio","slider"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13184308,"title":"WPF slider style","body":"<p>I'm kinda new to WPF, and I'm trying to add an style to my slider,\nbut there are so many options that I aways get confused.</p>\n\n<p>could someone make, or give me a start on how to make a slider look like this:\n<img src=\"http://i.stack.imgur.com/T8yqI.png\" alt=\"Slider\">\ngreen = passsed, gray rest of track</p>\n\n<p>And I'm trying to use it for showing while playing a song, so gray = remaining,\nwhat's the easiest way to implement that while your dragging it skips to that part of the song.</p>\n\n<p>I'm using NAudio, I got the trackbar sliding (by time remaining) while the song is playing by doing:</p>\n\n<pre><code>private void dispatcherTimer_Tick(object sender, EventArgs e) {\n   LabelCurrentTime.Content = _musicManager.getPlayTime();\n   double totalseconds = _musicManager.totalSeconds();\n   double currentseconds = _musicManager.currentSeconds();\n   if (totalseconds &gt; 0 &amp;&amp; currentseconds &gt; 0)\n      Trackbar.Value = ((((Trackbar.Width / totalseconds) * currentseconds)) / totalseconds) * 10;\n}\n</code></pre>\n\n<p>with in xaml:</p>\n\n<pre><code>&lt;Slider x:Name=\"Trackbar\" Height=\"25\" Canvas.Left=\"50\" Canvas.Top=\"10\" Width=\"408\" Maximum=\"10\"/&gt;\n</code></pre>\n"},{"tags":["c#","wpf","resources",".net-assembly","ildasm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13184376,"title":"How to insert a file g.resources into an Assembly","body":"<p>I need to modify an assembly changing one resource. I've already extracted the resource and modified it but now I cannot find the way to embed it again into the assembly. I've tried with ildasm but seems like it wants a .res resource file and I just have a xxx.g.resources file.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","forms","printing","position"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13184670,"title":"Printing on a paper at exact positions. Should i use WPF?","body":"<p>I want to be able to print a form from a win forms application. The restriction though lies in the face that I have to print it on a pre printed form with specific locations for text and I should not overflow the text. Would using WPF be a good idea for that? Or any suggestion on what can be used for precise placement of text on paper to be printed exactly at the same place irrespective of the printer.</p>\n"},{"tags":["c#","wpf","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13160140,"title":"Event in the wrong thread?","body":"<p>I have a question about threading.</p>\n\n<p>I have a WPF application, that should show the status of some queries. For this I have created a class, that runs multiple queries in multiple thread (backgroundworker). I've also created an event, so I can react while the queries are running.</p>\n\n<pre><code>    private void cmdStart(object sender, RoutedEventArgs e)\n    {\n        QuerySetup qs = new QuerySetup();\n        //Filling qs with some data\n        //...\n        SqlProxy sql = new SqlProxy();\n        sql.QueryCompleted += new SqlProxy.QueryCompletedEventHandler(sql_QueryCompleted);\n\n        //Starts the backgroundworker\n        sql.RunSQL(qs);\n    }\n\n    private void sql_QueryCompleted(QueryResult qr)\n    {\n        lstStatus.Items.Clear();\n        lstStatus.Items.Add(qr.RuntimeTotal);\n        //... and some more...\n    }\n</code></pre>\n\n<p>Now I get an error message that tells me, that I can't access lstStatus because it's owned by a different thread. </p>\n\n<p>But why? Shouldn't the event be in the same thread as the GUI? How can I solve my problem?</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":13182777,"title":"Different values for different comboboxes in Datagrid","body":"<p>Bear with me, as I'm new to WPF.I have a datagrid which contains comboboxes.</p>\n\n<pre><code>&lt;DataGrid x:Name=\"dgData\" AutoGenerateColumns=\"False\" Margin=\"131,93,13,101\" Grid.Column=\"1\" SelectionChanged=\"dgData_SelectionChanged\"&gt;\n        &lt;DataGrid.Columns&gt;\n\n            &lt;DataGridTextColumn Binding=\"{Binding Subject}\" Header=\"Subject\" Width=\"100\"/&gt;\n\n            &lt;DataGridComboBoxColumn Header=\"Subject\" x:Name=\"comboboxColumn1\"/&gt;\n\n        &lt;/DataGrid.Columns&gt;\n &lt;/DataGrid&gt;\n</code></pre>\n\n<p>And I use the following code to load different itemsources depending on which combobox is clicked on by the user:</p>\n\n<pre><code>   private void dgData_SelectionChanged(object sender, SelectionChangedEventArgs e)\n    {\n\n\n        if (dgData.SelectedIndex == 0)\n        {\n            comboboxColumn1.ItemsSource = resolution;\n        } else if (dgData.SelectedIndex == 1)\n        {\n            comboboxColumn1.ItemsSource = codec;    \n        }\n    }\n</code></pre>\n\n<p>How I bind dgData:</p>\n\n<pre><code>  List&lt;TicketInfo&gt; ticketsList = new List&lt;TicketInfo&gt; \n        {\n            new TicketInfo{ Subject=\"File\", Status=\"Open\"},\n            new TicketInfo{ Subject=\"Resolution\", Status=\"Assigned\"},\n\n        };\n        dgData.ItemsSource = ticketsList;\n\n  public class TicketInfo\n         {\n            public string Subject { get; set; }\n            public string Status { get; set; }\n         }\n</code></pre>\n\n<p>Now I also need to retrieve the value of the combobox once the user chooses the value. Is there a more elegant way to load different items in different comboboxes and retrieving the value?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13184641,"title":"How to access a ComboBox in Datagrid programatically","body":"<p>I have a <code>DataGrid</code> as such added in XML as the code bellow. Now, how do I access the <code>ComboBox</code> named <code>Combo1</code> programatically? I am not able to access it normally using the name <code>Combo1</code>. I want to be able to retrieve it's value, or change itemssource etc.</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;DataGrid x:Name=\"dgData\" AutoGenerateColumns=\"False\" Margin=\"133,94,23,116\" Grid.Column=\"1\" SelectionChanged=\"dgData_SelectionChanged\"&gt;\n       &lt;DataGrid.Columns&gt;\n           &lt;DataGridTextColumn Binding=\"{Binding Subject}\" Header=\"Subject\" Width=\"*\"/&gt;\n           &lt;DataGridTemplateColumn Header=\"Status\" Width=\"100\"&gt;\n               &lt;DataGridTemplateColumn.CellTemplate&gt;\n                   &lt;DataTemplate&gt;\n                       &lt;ComboBox Name=\"Combo1\" Height=\"22\" ItemsSource=\"{StaticResource StatusList}\" SelectedItem=\"{Binding Status}\"/&gt;\n                   &lt;/DataTemplate&gt;\n               &lt;/DataGridTemplateColumn.CellTemplate&gt;\n           &lt;/DataGridTemplateColumn&gt;\n       &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13183812,"title":"Load usercontrol into tabcontrol","body":"<p>I want to put two usercontrols into the tabcontrol, but only when I click on a button the usercontrol will load the data</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Button Click=\"Button_Click_1\" /&gt;\n&lt;Button Click=\"Button_Click_2\" /&gt;\n&lt;TabControl&gt;\n    &lt;ItemsControl Name=\"tab1\"&gt;\n        &lt;local:UserControl1 Loaded=\"UserControl1_Loaded\"&gt;&lt;/local:UserControl1&gt;\n    &lt;/ItemsControl&gt;\n    &lt;ItemsControl Name=\"tab2\"&gt;\n         &lt;local:UserControl1 Loaded=\"UserControl2_Loaded\"&gt;&lt;/local:UserControl1&gt;\n    &lt;/ItemsControl&gt;\n&lt;/TabControl&gt;\n</code></pre>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13184311,"title":"App class and MainWindow class relationship","body":"<p>In a WPF project, what kind of relationship MainWindow class has with App class? the reason I'm asking is because in a project designed base on MVVM, I do see some tasks which could be handled by MainWindows.xaml.cs or its code behind instead are implemented in App class. </p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13184254,"title":"GridUnitType.Star?","body":"<p>How does this star unit type works? I have read <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.gridunittype.aspx\" rel=\"nofollow\">msdn definition</a>. But could not really get how it defines the size of an object. </p>\n"},{"tags":["wpf","binding","explicit","updatesourcetrigger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6806,"score":1,"question_id":1516588,"title":"Binding UpdateSourceTrigger=Explicit, updates source at program startup","body":"<p>I have following code:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfApplication1.Window1\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nTitle=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n&lt;Grid&gt;\n    &lt;TextBox Text=\"{Binding Path=Name, \n                            Mode=OneWayToSource, \n                            UpdateSourceTrigger=Explicit, \n                            FallbackValue=default text}\" \n             KeyUp=\"TextBox_KeyUp\" \n             x:Name=\"textBox1\"/&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>    public partial class Window1 : Window\n{\n    public Window1()\n    {\n        InitializeComponent();\n    }\n\n    private void TextBox_KeyUp(object sender, KeyEventArgs e)\n    {\n        if (e.Key == Key.Enter)\n        {\n            BindingExpression exp = this.textBox1.GetBindingExpression(TextBox.TextProperty);\n            exp.UpdateSource();\n        }\n    }\n}\n\n\n\n    public class ViewModel\n{\n    public string Name\n    {\n        set\n        {\n            Debug.WriteLine(\"setting name: \" + value);\n        }\n    }\n}\n\n\n\n    public partial class App : Application\n{\n    protected override void OnStartup(StartupEventArgs e)\n    {\n        base.OnStartup(e);\n\n        Window1 window = new Window1();\n        window.DataContext = new ViewModel();\n        window.Show();\n    }\n}\n</code></pre>\n\n<p>I want to update source only when \"Enter\" key is pressed in textbox. This works fine. However binding updates source at program startup. How can I avoid this? Am I missing something?</p>\n"},{"tags":["c#","wpf","datagrid","scrolling","readonly"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13182950,"title":"DataGrid Set ReadOnly and allow scrolling?","body":"<p>I have a <code>DataGrid</code>, where I currently set to <code>ReadOnly</code> when I don't want the user to change anything, then I have a button for the user to click to allow Modify, which then changes <code>IsReadOnly</code> to false</p>\n\n<p>but the problem now is that when the <code>DataGrid.IsReadOnly = true</code>, the scrolling is disabled. How do I make it so that the DataGrid <code>IsReadOnly=true</code> or similar and still be able to scroll the <code>DataGrid</code>?</p>\n\n<p>DataGrid Style:</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;DataGrid.Style&gt;\n  &lt;Style TargetType=\"{x:Type DataGrid}\"&gt;\n    &lt;Style.Triggers&gt;\n      &lt;MultiDataTrigger&gt;\n        &lt;MultiDataTrigger.Conditions&gt;\n          &lt;Condition Binding=\"{Binding ReadOnly}\" Value=\"True\"/&gt;\n          &lt;Condition Binding=\"{Binding Reordering}\" Value=\"False\"/&gt;\n        &lt;/MultiDataTrigger.Conditions&gt;\n        &lt;MultiDataTrigger.Setters&gt;\n          &lt;Setter Property=\"IsReadOnly\" Value=\"True\" /&gt;\n          &lt;Setter Property=\"IsHitTestVisible\" Value=\"False\" /&gt;\n          &lt;Setter Property=\"Foreground\" Value=\"Gray\" /&gt;\n        &lt;/MultiDataTrigger.Setters&gt;\n      &lt;/MultiDataTrigger&gt;\n      &lt;MultiDataTrigger&gt;\n        &lt;MultiDataTrigger.Conditions&gt;\n          &lt;Condition Binding=\"{Binding ReadOnly}\" Value=\"True\"/&gt;\n          &lt;Condition Binding=\"{Binding Reordering}\" Value=\"True\"/&gt;\n        &lt;/MultiDataTrigger.Conditions&gt;\n        &lt;MultiDataTrigger.Setters&gt;\n          &lt;Setter Property=\"IsHitTestVisible\" Value=\"False\" /&gt;\n          &lt;Setter Property=\"IsReadOnly\" Value=\"True\" /&gt;\n        &lt;/MultiDataTrigger.Setters&gt;\n      &lt;/MultiDataTrigger&gt;\n      &lt;MultiDataTrigger&gt;\n        &lt;MultiDataTrigger.Conditions&gt;\n          &lt;Condition Binding=\"{Binding ReadOnly}\" Value=\"False\"/&gt;\n        &lt;/MultiDataTrigger.Conditions&gt;\n        &lt;MultiDataTrigger.Setters&gt;\n          &lt;Setter Property=\"IsHitTestVisible\" Value=\"True\" /&gt;\n          &lt;Setter Property=\"IsReadOnly\" Value=\"False\" /&gt;\n        &lt;/MultiDataTrigger.Setters&gt;\n      &lt;/MultiDataTrigger&gt;\n    &lt;/Style.Triggers&gt;\n  &lt;/Style&gt;\n&lt;/DataGrid.Style&gt;\n</code></pre>\n"},{"tags":["wpf","mvvm","resize","expander"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13183315,"title":"Problems with resize on Expander WPF","body":"<p>Hi guys i'm using WPF with mvvm on a solution and i have an issue.\nI have this object that i am using on a viewModel:</p>\n\n<pre><code>public class SuperCharacter : INotifyPropertyChanged\n{\n    public List&lt;Character&gt; Characters { get; set; }\n    public string Name { get; set; }\n    private Character charactersExp;\n    private const string currentCharacterExpandedString = \"CurrentCharacterExp\";\n    public Character CurrentCharacterExpanded\n    {\n        get { return this.charactersExp; }\n        set\n        {\n            this.charactersExp = value;\n            this.OnPropertyChanged(currentCharacterExpandedString);\n        }\n    }\n\n    public string CalcSize { get; set; }\n\n    public void OnPropertyChanged(string propertyName)\n    {\n\n\n        if (this.PropertyChanged != null)\n        {\n            this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n}\n</code></pre>\n\n<p>And i have this view:</p>\n\n<pre><code>    Window.Resources&gt;\n\n\n    &lt;DataTemplate x:Key=\"TrackPointUserSavedSearchDtoTemplate\" DataType=\"{x:Type src:Character}\"&gt;\n        &lt;StackPanel &gt;\n            &lt;TextBlock x:Name=\"caption\" Margin=\"1\" \n        Text=\"{Binding First}\" MaxWidth=\"{Binding ElementName=image, Path=ActualWidth}\" MaxHeight=\"40\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;DataTemplate x:Key=\"DynamicUserSaveSearchesTemplate\" DataType=\"{x:Type src:Character}\"&gt;\n        &lt;ContentPresenter x:Name=\"content\" ContentTemplate=\"{StaticResource TrackPointUserSavedSearchDtoTemplate    }\"/&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;DataTemplate x:Key=\"IconoTrackPointUSTemplate\" DataType=\"{x:Type src:SuperCharacter}\"&gt;\n        &lt;ScrollViewer Grid.Row=\"2\" HorizontalScrollBarVisibility=\"Auto\" VerticalScrollBarVisibility=\"Auto\"&gt;\n            &lt;Expander Height=\"180\" Margin=\"12,0,0,-127\" &gt;\n\n                &lt;Expander.Header&gt;\n                    &lt;Binding Path=\"Name\"&gt;&lt;/Binding&gt;\n                &lt;/Expander.Header&gt;                   \n\n                    &lt;ListView Name=\"ProblemListView\" HorizontalContentAlignment=\"Stretch\"  ItemsSource=\"{Binding Characters}\" SelectedItem=\"{Binding CurrentCharacterExpanded}\"  ItemTemplate=\"{StaticResource DynamicUserSaveSearchesTemplate}\" Panel.ZIndex=\"20\"&gt;\n                    &lt;/ListView&gt;                       \n            &lt;/Expander&gt;\n        &lt;/ScrollViewer&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;DataTemplate x:Key=\"DynamicTrackPointUSTemplate\" DataType=\"{x:Type src:SuperCharacter}\" &gt;\n        &lt;ContentPresenter x:Name=\"content\" ContentTemplate=\"{StaticResource IconoTrackPointUSTemplate    }\"/&gt;\n    &lt;/DataTemplate&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"42\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;           \n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Label Content=\"Entitty's TrackPoint list:\" Margin=\"12,5,76,9\" Name=\"labelName\" /&gt;\n    &lt;ListView Grid.Row=\"1\" ItemsSource=\"{Binding SuperCharacters}\" SelectedItem=\"{Binding CurrentSuperCharacterExpanded}\" ItemTemplate=\"{StaticResource DynamicTrackPointUSTemplate}\"&gt;\n    &lt;/ListView&gt;\n&lt;Grid/&gt;\n</code></pre>\n\n<p>The problem is when i expand the Expander the elements from the Listview call ProblemListView are below to next expander.</p>\n\n<p>I like to know how can i make this expander list look correct? if i expand an expander the problemListView show correctly.</p>\n\n<p>Just remember that the list is dynamic and can have different numbers of elements</p>\n"},{"tags":["wpf","tabcontrol"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2561,"score":1,"question_id":242356,"title":"How to automatically extend the tab control as items are added to it without creating a scroll bar?","body":"<p>I am using a WPF user control (tab control) to add tab items dynamically in the simplified code below:</p>\n\n<pre><code>....\nforeach (string id in ids)\n{\n    TabControl.Items.Add(CreateTabItem(id));\n}\n\nprivate TabItem CreateTabItem(string name)\n{\n    StackPanel txtBlock = new TextBlock();\n    txtblock.Text = name;\n    txtBlock.HorizontalAlignment = Horizontalalignment.Center;\n    panel.Children.Add(txtBlock);\n\n    TabItem item = new TabItem();\n    item.Header = panel;\n\n    &lt;SomeControl&gt; control = new &lt;SomeControl&gt;();\n    item.Content = control;\n    return item;\n }\n</code></pre>\n\n<p>In the xaml file I specified the following to stack all my tab items to the left column:</p>\n\n<pre><code>MinWidth=\"100\" MinHeight=\"300\" TabStripPlacement=\"Left\"\n</code></pre>\n\n<p>How do I make my tab control automatically extending (ie. stretching) its height to show all the tab items as I add them in?  For now, I have to manually extend the height of the display window to see all the tab items.  Your insights/tips are greatly appreciated.</p>\n\n<p>PS:  if you know how to make the vertical scroll bar appears (without adding scroll bar to my control) as soon as the tab items exceed the window height, I can settle for that if there are no answers for my original intent.</p>\n"},{"tags":["c#",".net","wpf","visualbrush","rendertargetbitmap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12433638,"title":"How do I make RenderTargetBitmap and VisualBrush play nice together?","body":"<p>My requirements:</p>\n\n<ul>\n<li>a persistent <code>UserControl</code> that handles logic for a custom image, such as a map or drawing</li>\n<li>a set of containers to implement caching on the image during zoom or pan movements</li>\n<li><code>VisualBrush</code> copies of the <code>UserControl</code> that I can add to the containers for use with Effects</li>\n</ul>\n\n<p>I currently implement image caching with a RenderTargetBitmap, but that seems to have trouble with the <code>VisualBrush</code>-covered <code>Rectangle</code> objects I'm using.</p>\n\n<p><strong>My question</strong>: What can I add/change in this code to get the <code>VisualBrush</code> objects to render correctly after <code>RenderTargetBitmap</code> uses them? What strange thing is <code>RenderTargetBitmap</code> doing that makes the <code>VisualBrush</code> invisible?</p>\n\n<p>This is a problem that I have been unable to reproduce without a decent amount of code.</p>\n\n<p>In my xaml file I have:</p>\n\n<pre><code>&lt;Window x:Class=\"ElementRender.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Height=\"350\" Width=\"525\"&gt;\n  &lt;Grid&gt;\n    &lt;Grid Name=\"_contentContainer\"&gt;\n      &lt;Rectangle Fill=\"White\"/&gt;\n      &lt;Grid Name=\"_content\"&gt;\n        &lt;Grid Name=\"_back\"/&gt;\n        &lt;Grid Name=\"_body\"/&gt;\n      &lt;/Grid&gt;\n    &lt;/Grid&gt;\n    &lt;StackPanel VerticalAlignment=\"Bottom\" Orientation=\"Horizontal\"&gt;\n      &lt;Button Content=\"New\" Name=\"New\"/&gt;\n      &lt;Button Content=\"Move\" Name=\"Move\"/&gt;\n      &lt;Button Content=\"Update\" Name=\"Update\"/&gt;\n    &lt;/StackPanel&gt;\n  &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>and the .xaml.cs:</p>\n\n<pre><code>using System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Shapes;\n\npublic partial class MainWindow : Window\n{\n\n  private const int imageWidth = 150;\n  private const int imageHeight = 150;\n  private readonly UserControl Control;\n\n  public MainWindow()\n  {\n     InitializeComponent();\n\n     // User Control setup\n     Control = new UserControl() {\n        Width = imageWidth, Height = imageHeight,\n        Content = BuildImage()\n     };\n     _body.Children.Add(SoftCopy(Control));\n\n     // event setup\n     Move.Click += (sender, e) =&gt; _content.RenderTransform = new TranslateTransform(50, 50);\n     New.Click += (sender, e) =&gt; {\n        HardCopy();\n        _content.RenderTransform = null;\n        Control.Content = BuildImage();\n     };\n  }\n\n  private FrameworkElement BuildImage()\n  {\n     return new Rectangle{Fill=Brushes.Blue};\n  }\n  private void HardCopy()\n  {\n     int width = (int) _contentContainer.ActualWidth;\n     int height = (int) _contentContainer.ActualHeight;\n\n     // render the current image\n     var rtb = new RenderTargetBitmap(width, height, 96, 96, PixelFormats.Pbgra32);\n     DrawingVisual dv = new DrawingVisual();\n     using (var context = dv.RenderOpen())\n     {\n        var brush = new VisualBrush(_contentContainer) { Opacity = .5 };\n        context.DrawRectangle(brush, null, new Rect(0, 0, width, height));\n     }\n     rtb.Render(dv);\n     var lastRender = new Image\n     {\n        Source = rtb,\n        Stretch = Stretch.None,\n        HorizontalAlignment = HorizontalAlignment.Center,\n        VerticalAlignment = VerticalAlignment.Center,\n        Width = width,\n        Height = height\n     };\n     _back.Children.Clear();\n     _back.Children.Add(lastRender);\n  }\n  private FrameworkElement SoftCopy(FrameworkElement element)\n  {\n     return new Rectangle{Fill= new VisualBrush(element), Width=element.Width, Height=element.Height};\n  }\n}\n</code></pre>\n\n<p>A few helping notes about the code:</p>\n\n<ul>\n<li>the xaml's <code>_contentContainer</code> works with <code>HardCopy()</code> to copy the current images into the image cache, <code>_back</code>.</li>\n<li><code>SoftCopy</code> returns a FrameworkElement that looks exactly like the one past in, but without any transforms, effects, or visual parents. This is very important.</li>\n<li><code>BuildImage</code> simulates building a new image to be pasted over the cache after the initial image has been transformed somehow.</li>\n</ul>\n\n<p>If you build and run the application removing the <code>SoftCopy()</code> from the <code>_body.Children.Add(SoftCopy(Control));</code>, you see the effect that I want to get: the new element is pasted above the old element, and the old element seems to retain its transform.</p>\n\n<p>Alternatively, if you cut out the line <code>var rtb = new RenderTargetBitmap(width, height, 96, 96, PixelFormats.Pbgra32);</code> from <code>HardCopy</code>, the caching function is broken, but the SoftCopy is displayed correctly.</p>\n\n<p>However, if you run the application as-is, you notice that the new BlueRectangle (as rendered through a VisualBrush) doesn't display at all, until you hit the \"New\" button again, pushing the image to the cache, and still not showing you the new created image.</p>\n"},{"tags":["wpf","nullable","binding",".net-3.5","empty-string"],"answer_count":3,"favorite_count":4,"up_vote_count":20,"down_vote_count":0,"view_count":7041,"score":20,"question_id":1895453,"title":"Set value to null in WPF binding","body":"<p>please take a look at the following line</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding Price}\"/&gt;\n</code></pre>\n\n<p>This Price property from above is a <code>Decimal?</code> (Nullable decimal).</p>\n\n<p>I want that if user deletes the content of the textbox (i.e. enters empty string, it should automatcally update source with null (Nothing in VB).</p>\n\n<p>Any ideas on how I can do it 'Xamly'?</p>\n"},{"tags":["c#","wpf","list","enumeration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13181955,"title":"C# wpf List: How to enumerate n level List<>","body":"<p>A class System.Windows.Media.Media3D.Model3DGroup : Model3D</p>\n\n<p>If I've done</p>\n\n<pre><code>  ...\n  model3DGroup1.Add(model3DGroup0);\n  model3DGroup2.Add(model3DGroup1);\n  model3DGroup3.Add(model3DGroup2);\n  model3DGroup4.Add(model3DGroup3);\n  ...\n  model3DGroupN.Add(model3DGroupN_Minus_One);\n</code></pre>\n\n<p>How will I enumerate these N level <strong>Model3DGroup</strong> s form <code>model3DGroupN</code> if above code is not known to me? How to know the per level child elements? The number of childs may not be one.</p>\n"},{"tags":["c#","wpf","events"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13177595,"title":"Dynamically passing and using data to a WPF application without restarting it","body":"<p>It's my first post on StackOverflow, so please be patient with me :)</p>\n\n<p>I'm looking out for a way to pass a value to an already running application. The application should be able to accept this value and use it for further operations during its lifetime. I'd prefer not to logoff/restart the application in order to use the updated value.</p>\n\n<p>The scenario would be something like this:</p>\n\n<p>The application uses MachineName to initialize and populate some objects while it is being instantiated. Once it is up and running, I would like to pass a different workstation name to the application (possibly from command line) and the application should be able to use this MachineName and use it further down the line. I dont mind if I have perform same operations again to initialize the required objects with new MachineName name.</p>\n\n<p>The application in question is a WPF app with C#. It's also using some WCF services as well. I was thinking to use a common registry key to store the workstation name and this registry key needs to be used/updated in the application. So it should be the first point of contact. But I'm not sure if this is a better approach. Any ideas please?</p>\n"},{"tags":[".net","wpf","xaml","treeview","hierarchy"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1648,"score":8,"question_id":2169386,"title":"Can I bind a WPF TreeView to a single root node?","body":"<p>Say I have a binary tree, where the root of the data structure is just a tree node. For each node, the children are accessible through the <code>Children</code> property. Here's what I tried. The <code>TreeRoot</code> is a property of the inherited data context, but it's a single node (not a collection).</p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;HierarchicalDataTemplate x:Key=\"TreeNodeTemplate\" ItemsSource=\"{Binding Children}\"&gt;\n        &lt;TextBlock Text=\"{Binding Name}\" /&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n&lt;/UserControl.Resources&gt;\n\n&lt;Grid&gt;\n    &lt;TreeView ItemsSource=\"{Binding TreeRoot}\" ItemTemplate=\"{StaticResource TreeNodeTemplate}\" /&gt;\n&lt;/Grid&gt;\n</code></pre>\n"},{"tags":["wpf","printing","richtextbox","preview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3203,"score":0,"question_id":371435,"title":"Printing/Previewing WPF RichTextBox - ApplicationCommands.PrintPreview?","body":"<p>I'm really loving the WPF RichTextBox, and all of the out-of-the-box functionality it comes with... but printing is something that I'm having trouble with. I <em>can</em> print (from code) using a PrintDialog and passing in my RichTextBox as a Visual (or by using the \"Document\")...</p>\n\n<p>But my question is, is there a simple way to use the application commands:</p>\n\n<ul>\n<li>ApplicationCommands.Print</li>\n<li>ApplicationCommands.PrintPreview</li>\n</ul>\n\n<p>With a WPF RichTextBox? Also, how would I go about letting the user change the page layout and such?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13179892,"title":"Creating a Visual Studio properties window for multiple object in WPF/C#","body":"<p>I'm creating a program where the user is creating a list of actions.  The possible actions all have multiple properties that need to be specified.  I'd like to display those properties in a list box, similar to how Visual Studio displays object properties in design mode.  Strings get textboxes, bools get checkboxes, etc.  I've figured out how to display the object's members in the list, but I'm struggling to figure out how to create callbacks for each control.  Heres the basic structure:</p>\n\n<pre><code>    void createPropertyList(object move)\n    {\n        Type type = move.GetType();\n        FieldInfo[] fields = type.GetFields();\n        propertyListBox.Items.Clear();\n\n        foreach (var field in fields)\n        {\n            string name = field.Name;\n            object temp = field.GetValue(move);\n\n            if (temp is double)\n            {\n                double value = (double)temp;\n                Label l = new Label();\n                l.Content = name;\n\n                TextBox t = new TextBox();\n                t.Text = value.ToString(\"0.0000\");                    \n\n                // put it in a grid, format it, blah blah blah    \n\n                propertyListBox.Items.Add(grid);\n            }\n\n            // reflect on other types\n        }\n    }\n</code></pre>\n\n<p>I assume there's going to be a lambda involved, but how do I revert the FieldInfo array to actually reference those members so I can put the user's input back into the object?</p>\n"},{"tags":["c#","wpf","binding","c#-4.5"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13180289,"title":"Why are changing object properties are detected but the refreshing object isn't","body":"<p>I've been playing about with data binding and using the INotifiedProperty interface (including the new .Net 4.5 CallerMemberName attribute). </p>\n\n<p>All is working well but I can't understand why updating an object's property refreshes the label it's bound to but refreshing the object itself doesn't re-fresh the label. </p>\n\n<p>For example, if I have the following Window:</p>\n\n<pre><code>&lt;Grid Name=\"TestGrid\"&gt;\n    &lt;!-- Grid definitions here --&gt;\n\n    &lt;Label Grid.Column=\"0\" Grid.Row=\"0\"&gt;The value is :&lt;/Label&gt;\n    &lt;Label Grid.Column=\"1\" Grid.Row=\"0\" Content=\"{Binding TestVal1}\"/&gt;\n\n    &lt;Button Grid.Column=\"0\" Grid.Row=\"1\" Click=\"Button_Click_1\"&gt;Refresh&lt;/Button&gt;\n    &lt;Button Grid.Column=\"1\" Grid.Row=\"1\" Click=\"Button_Click_2\"&gt;New class instance&lt;/Button&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>With the following code behind it:</p>\n\n<pre><code>public MainWindow()\n    {\n        InitializeComponent();\n\n        TestGrid.DataContext = TestClass1;\n    }\n\n    public TestClass TestClass1 = new TestClass();\n\n    private void Button_Click_1(object sender, RoutedEventArgs e)\n    {\n        TestClass1.ChangeTestVal1();\n    }\n\n    private void Button_Click_2(object sender, RoutedEventArgs e)\n    {\n        TestClass1 = new TestClass();\n    }\n</code></pre>\n\n<p>Which is bound the following class:</p>\n\n<pre><code>public class TestClass : INotifyPropertyChanged\n{\n    public TestClass()\n    {\n        ChangeTestVal1();\n    }\n\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    internal void OnPropertyChanged([CallerMemberName] String caller = null)\n    {\n        var handler = PropertyChanged;\n        if (handler != null)\n        {\n            handler(this, new PropertyChangedEventArgs(caller));\n        }\n    }\n\n    private string _TestVal1;\n    public string TestVal1\n    {\n        get { return _TestVal1; }\n        set\n        {\n            if (value != _TestVal1)\n            {\n                _TestVal1 = value;\n                OnPropertyChanged();\n            }\n        }\n    }\n\n    public void ChangeTestVal1()\n    {\n        TestVal1 = \"TestVal1 = \" + DateTime.Now.ToString(\"dd-MMM-yyyy HH:mm:ss\");\n    }\n</code></pre>\n\n<p>The result of is that clicking the \"Refresh\" button works and clicking the \"New class instance\" doesn't. </p>\n\n<p>My question is, I know I can add \"TestGrid.DataContext = TestClass1\" to the code for the second button to get it to work but surely it should detect the instance of the TestClass changing when it's refreshed? Am I setting the binding up incorrectly?</p>\n"},{"tags":["c#","wpf","interpolation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13180037,"title":"How to interpolate N points in WPF","body":"<p>The idea is simple, supose i have a collection of 2D points that have N items. I want a path that interpolate that points in a soft way. </p>\n\n<p>I tried using Cubic Bezier but the problem is that it take only 3 point, if i want using N point where N % 3 = 1 or N % 3 = 2 then dosent works, beside even using N % 3 = 0 in the intersection of both Beizers is not soft (make a peak). Using Quadratic Bezier do not work because it is a curve, for example if N = 2, then draws a cuadratic curve betwen both points.</p>\n\n<p>I would like to know a way for do this, if is easy and efficient better.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":7889724,"title":"How to remove the dotted outline for the header of Expander control in WPF (C#)?","body":"<p>How to remove the dotted outline for the header of Expander control in WPF (C#)?</p>\n\n<p>I tried by making FocusVisualStyle to null but no luck. Is there any other approach?</p>\n\n<pre><code>&lt;UserControl x:Class=\"MyControl\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Height=\"373\" Width=\"669\"&gt;\n    &lt;Expander FocusVisualStyle=\"{x:Null}\" Expanded=\"expander1_Expanded\" Focusable=\"False\" Foreground=\"DarkBlue\" Header=\"My Header\" Height=\"219\" Name=\"expander1\" Width=\"525\"&gt;\n\n.....\n</code></pre>\n"},{"tags":["c#","wpf","xaml","animation","expression-blend"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":259,"score":1,"question_id":10425654,"title":"How to change EasingDoubleKeyFrame value at Runtime?","body":"<p>I am trying to make a <em>TranslateTransform</em> animation.  In the animation, I need my object to remain at the center of the window.  I know WPF animation is Freezable.  I am using a converter, but it initializes values at startup.  Is there any way to set the value of <em>EasingDoubleKeyFrame</em> at runtime?</p>\n\n<p>Here is my XAML code:</p>\n\n<pre><code>&lt;Storyboard x:Key=\"Storyboard1\"&gt;\n    &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)\" Storyboard.TargetName=\"grid\"&gt;\n        &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"{Binding Width, Converter={StaticResource Minus}, ElementName=grid}\"/&gt;\n        &lt;EasingDoubleKeyFrame KeyTime=\"0:0:1\" Value=\"{Binding Width, Converter={StaticResource EnteringValueConverter}, ElementName=grid}\"/&gt;\n    &lt;/DoubleAnimationUsingKeyFrames&gt;\n&lt;/Storyboard&gt;\n</code></pre>\n"},{"tags":["c#","wpf","initialization","resourcedictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3239,"score":1,"question_id":5299529,"title":"Initializing static resource from code in C# WPF app","body":"<p>I have two WPF windows. Main one contains a grid bound to <code>ObservableCollection&lt;Person&gt;</code>. I can add and remove objects (people) from the list. I also have another window that I can show when I modify a person.</p>\n\n<p>Person has three properties: Name, LastName and Age and properly implements INotifyPropertyChanged. In the new window I have 3 textboxes that are bound to a static resource Person called \"person\".</p>\n\n<p>When I initialize new window I provide Person object to the constructor and then I want this person properties to be shown in the three textboxes.</p>\n\n<p>When the code below looks like this everything works properly:</p>\n\n<pre><code>public ModifyPerson(Person modPerson)  \n{  \n    // ... some code  \n    Person p = this.Resources[\"person\"] as Person;  \n    p.Name = modPerson.Name;  \n    p.LastName = modPerson.LastName;  \n    p.Age = modPerson.Age;  \n}  \n</code></pre>\n\n<p>However I prefer doing it like this:</p>\n\n<pre><code>public ModifyPerson(Person modPerson)  \n{  \n    // ... some code  \n    this.Resources[\"person\"] = modPerson;  \n}\n</code></pre>\n\n<p>But then it does not work. (The resource is assigned properly, but the textboxes do not present the values of modPerson properties.</p>\n\n<p>How can that be solved?</p>\n"},{"tags":["c#","wpf","computational-geometry","wpf-3d"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13152441,"title":"Computing a hole in a triangulated polygon mesh","body":"<p>I'm working on a visualizer in WPF which has a function to display a cutting plane through a 3-D shape. For example, a 3-d geometry like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/kT9ZG.png\" alt=\"Full Geometry\"></p>\n\n<p>... is cut with a plane. After cutting, the algorithm identifies all the unique outlines along the cutting plane and populates a list of line segments, in either CW or CCW winding order. Any simple polygon is easy to triangulate and render using the Cutting Ears algorithm, like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/iaI7O.png\" alt=\"Cut Plane Image\"> <img src=\"http://i.stack.imgur.com/ArSZ5.png\" alt=\"enter image description here\"></p>\n\n<p>Given an input of the triangulation on the right, and the inner polyline visible on the plane surface on the left, is there an algorithm which can reconfigure the triangulation to construct a hole outlined by the polyline? </p>\n\n<p>If there are algorithms already rolled in C# or another CLR language, I'd love to learn about them. I'm using the Point3D lists called for by WPF to describe MeshGeometry3D triangle meshes, but I can obviously fill any data structure if needed or spin my own class by studying other language code or pseudocode. </p>\n\n<p>EDIT: See the accepted answer; I'm making use of the C# implementation of <a href=\"http://code.google.com/p/poly2tri/\" rel=\"nofollow\">Poly2Tri</a>, a Constrained Delaunay Triangulation. However, (images not to scale) the Poly2Tri algorithm (center) failed with a 780-segment polyline, while Cutting Ears (right) did not, until I stripped the inputs of their precision, supplying single precision values upcast as doubles instead of doubles. It now produces a different triangulation than Cutting Ears but respects the boundaries of the outer polyline.</p>\n\n<p><img src=\"http://i.stack.imgur.com/sCh5U.jpg\" alt=\"ComplexPoly\"> <img src=\"http://i.stack.imgur.com/ujKic.jpg\" alt=\"ComplexCDT\"> <img src=\"http://i.stack.imgur.com/MlQkb.jpg\" alt=\"ComplexEars\"></p>\n"},{"tags":["wpf","xaml","tooltip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13178134,"title":"How to bind the visibility of tooltip to the text in textblock?","body":"<pre><code>   &lt;DataGrid x:Name=\"dgRecords1\"  CanUserAddRows=\"False\" ColumnHeaderStyle=\"{DynamicResource DataGridColumnHeaderStyle1}\" IsReadOnly=\"True\"\n                     Style=\"{DynamicResource StyleDatagrid}\" SelectionChanged=\"dgRecords1_SelectionChanged\" Height=\"251\" Margin=\"41,173,168,0\" Width=\"569\"&gt;                    \n                &lt;DataGrid.RowStyle&gt; \n                    &lt;Style TargetType=\"DataGridRow\"&gt;                            \n                        &lt;Setter Property=\"ToolTip\"&gt;                               \n                            &lt;Setter.Value&gt;\n                                &lt;Border Width=\"200\" Height=\"80\" BorderBrush=\"Black\" BorderThickness=\"1\" Background=\"AliceBlue\"&gt;\n                                    &lt;StackPanel Orientation=\"Vertical\"&gt;\n                                        &lt;StackPanel Height=\"30\" Background=\"Black\"&gt;\n                                            &lt;TextBlock Text=\"Email Sent To\" FontSize=\"14\" FontWeight=\"Bold\" Foreground=\"White\"/&gt;\n                                        &lt;/StackPanel&gt;\n                                        &lt;StackPanel&gt;\n                                            &lt;TextBlock TextWrapping=\"Wrap\" FontWeight=\"Bold\" Text=\"{Binding SentToList}\" /&gt;\n                                        &lt;/StackPanel&gt;\n                                    &lt;/StackPanel&gt;\n                                &lt;/Border&gt;                                    \n                            &lt;/Setter.Value&gt;                                  \n                        &lt;/Setter&gt;                                      \n                    &lt;/Style&gt;                        \n                &lt;/DataGrid.RowStyle&gt;\n</code></pre>\n\n<p>In the code above, </p>\n\n<pre><code>   &lt;TextBlock TextWrapping=\"Wrap\" FontWeight=\"Bold\" Text=\"{Binding SentToList}\" /&gt;\n</code></pre>\n\n<p>I want to check whether there is something in this textblock, if there is nothing,i need to make the tooltip invisible. Is there some way of doing it using Triggers?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":129,"score":1,"question_id":11120415,"title":"Listview selectionmode not funtioning correctly","body":"<p>For some reason if I have a listview that has checkboxes included it will not allow multiple selection using the shift key.</p>\n\n<p>As far as I am aware I am using this correctly:</p>\n\n<pre><code>&lt;ListView SelectionMode=\"Multiple\" /&gt;\n</code></pre>\n\n<p>Please note I have removed all of the other settings in the code due to it being unneeded in this example.</p>\n\n<p>I have also done Extended.</p>\n"},{"tags":["c#","wpf","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":66,"score":-2,"question_id":13177989,"title":"Combo Box selecting multiple items","body":"<p>Can someone explain this Behaviour?</p>\n\n<p><img src=\"http://i.stack.imgur.com/LTIcD.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>Not only Does <code>MouseOver</code> Highlight multiple items(Not Intended), but when i <code>Select</code> the item (That the mouse is over) The Code goes to Selection_Changed event which changes the picture on the right of it (as intended) but While loading the picture, an error message appears that says that there's invalid characters in the path.</p>\n\n<hr>\n\n<pre><code>BD.Shape xShape = new BD.Shape();\ncomboBoxShapes.ItemsSource = xShape.GetListOfShapes();\n</code></pre>\n\n<hr>\n\n<pre><code> public List&lt;String&gt; GetListOfShapes()\n    {\n        List&lt;String&gt; iList = new List&lt;String&gt;();\n        try\n        {\n            GetConnectionString iGet = new GetConnectionString();\n            System.Data.OleDb.OleDbConnection iConnect = new System.Data.OleDb.OleDbConnection();\n            iConnect.ConnectionString = iGet.ConnectionString();\n            iConnect.Open();\n            System.Data.OleDb.OleDbCommand iCommand = new System.Data.OleDb.OleDbCommand();\n            iCommand.Connection = iConnect;\n            iCommand.CommandText = \"Select ShapeName from Shapes \";\n            System.Data.OleDb.OleDbDataReader iRead = iCommand.ExecuteReader();\n            while (iRead.Read())\n            {\n                Shape iShape = new Shape();\n                iShape.ShapeName = iRead[\"ShapeName\"].ToString();\n                iList.Add(iShape.ShapeName);\n            }\n\n        }\n        catch\n        {\n            MessageBox.Show(\"Someone better call batman or something `\\\\(^_^)_/`\");\n        }\n        return iList;\n    }\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/0L2Xh.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>Please note that if i select anything else with a dash <code>-</code> in it it only selects one item. There are no hidden / invalid characters.... </p>\n"},{"tags":["c#",".net","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13178034,"title":"Failing to clear previously displayed labels on radiobutton click in wpf","body":"<p>I am working on dynamic generation of labels based on radiobutton click. Well I have been succesful in doing it but everytime I click a button, it generates labels but doesnt clear the previous state. Here is the code:</p>\n\n<p><strong>XAML:</strong> </p>\n\n<pre><code>&lt;Grid Grid.Row=\"0\"&gt;                     \n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\" &gt;\n                        &lt;RadioButton Content=\"{Binding RadioBase}\" Margin=\"0,10,0,0\" IsChecked=\"{Binding BaseCheck}\" GroupName=\"SlotGroup\" /&gt;                            \n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;           \n    &lt;/Grid&gt;\n\n&lt;Grid Grid.Row=\"1\"&gt;            \n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\" Grid.Column=\"0\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel&gt;\n                        &lt;ItemsControl Visibility=\"{Binding IsRegisterItemsVisible, Converter={StaticResource BoolToVisibilityConv}}\" ItemsSource=\"{Binding RegisterLabels}\"&gt;\n                            &lt;ItemsControl.ItemTemplate&gt;\n                                &lt;DataTemplate&gt;\n                                    &lt;StackPanel HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Margin=\"50,20,0,0\"&gt;\n                                        &lt;TextBlock Text=\"{Binding}\"/&gt;\n                                    &lt;/StackPanel&gt;\n                                &lt;/DataTemplate&gt;\n                            &lt;/ItemsControl.ItemTemplate&gt;\n                        &lt;/ItemsControl&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;            \n    &lt;/Grid&gt;\n</code></pre>\n\n<p><strong>FPGARadioWidgetViewModel Class:</strong> DataContext of this class is set here</p>\n\n<pre><code>public ObservableCollection&lt;FPGAViewModel&gt; Children { get; set; }\n\n    public FPGARadioWidgetViewModel()\n    {\n        Children = new ObservableCollection&lt;FPGAViewModel&gt;();\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x0\", ID = 0 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x40\", ID = 1 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x80\", ID = 2 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0xc0\", ID = 3 });            \n    }\n</code></pre>\n\n<p><strong>FPGAViewModel Class:</strong></p>\n\n<pre><code>private bool sBaseCheck;\n    public bool BaseCheck\n    {\n        get { return this.sBaseCheck; }\n        set\n        {\n            this.sBaseCheck = value;\n            Generatelabels(this, ID);\n            this.OnPropertyChanged(\"BaseCheck\");\n        }\n    }\n\n    private static void Generatelabels(FPGAViewModel currentItem, int index)\n    {\n        int m_baseRegister = 0;\n\n        if (index == 0)\n        {                \n            for (int i = 0; i &lt; 0x40 / 8; i++)\n            {\n                int reg = (i * 8) + m_baseRegister;\n                currentItem.RegisterLabels[i] = \"Reg 0x\" + reg.ToString(\"X\");\n                currentItem.IsRegisterItemsVisible = true;\n            }\n        }\n        else if (index == 1)\n        {\n            m_baseRegister = 0x40 * index;\n            for (int i = 0; i &lt; 0x40 / 8; i++)\n            {\n                int reg = (i * 8) + m_baseRegister;\n                currentItem.RegisterLabels[i] = \"Reg 0x\" + reg.ToString(\"X\");\n                currentItem.IsRegisterItemsVisible = true;\n            }\n        }\n        // Similarly for Index 2 and Index = 3\n    }\n\n    private string[] registerLabels = new string[8];\n    public string[] RegisterLabels { get { return registerLabels; } }\n\n    private bool isRegisterItemsVisible = false;\n    public bool IsRegisterItemsVisible\n    {\n        get { return isRegisterItemsVisible; }\n        set\n        {\n            isRegisterItemsVisible = value;\n            OnPropertyChanged(\"IsRegisterItemsVisible\");\n            OnPropertyChanged(\"RegisterLabels\");\n        }\n    }       \n</code></pre>\n\n<p>On radiobutton click, it displays 8 labels. When i click second radiobutton, it displays another 8 and doesn't clear the previous 8. Basically at one time only 8 labels of selected radiobutton must be displayed. How can that be achieved?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13176924,"title":"Ink canvas byte array image binding","body":"<p>I have a ink canvas, where user can draw on it, and I save it as byte array into database as image:</p>\n\n<pre><code>using (MemoryStream ms = new MemoryStream())\n{\n    if (icPad.Strokes.Count &gt; 0)\n    {\n        icPad.Strokes.Save(ms, true);\n        picture = ms.ToArray();\n</code></pre>\n\n<p>How can I retrieve bind the byte array into image?</p>\n\n<p>Edited:</p>\n\n<p>I use this code below to convert to BitmapImage:</p>\n\n<pre><code>    if (imageData == null || imageData.Length == 0) return null;\n\n    var image = new BitmapImage();\n    try\n    {\n        using (var mem = new MemoryStream(imageData))\n        {\n            mem.Position = 0;\n            image.BeginInit();\n            image.CreateOptions = BitmapCreateOptions.PreservePixelFormat;\n            image.CacheOption = BitmapCacheOption.OnLoad;\n            image.UriSource = null;\n            image.StreamSource = mem;\n            image.EndInit();\n        }\n\n        image.Freeze();\n\n    }\n    catch (Exception ex)\n    {\n\n    }\n\n    return image;\n}\n</code></pre>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>No imaging component suitable to complete this operation was found.</p>\n</blockquote>\n"},{"tags":["wpf","windows-phone-7","silverlight-toolkit","wrappanel"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":868,"score":2,"question_id":8258410,"title":"How to set WrapPanel itemsource to list?","body":"<p>I want to show in WrapPanel a list of images. How can I do that or maybe I shall use other control ?</p>\n"},{"tags":["wpf","datagrid","clipboard"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13178363,"title":"WPF Datagrid: copy additional rows to clipboard","body":"<p>I am working with the WPF Datagrid and I am trying to enhance/change the copy &amp; paste mechanism.</p>\n\n<p>When the user selects some cells and then hit CTRL + C, the underlying controls is able to catch the <strong>CopyingRowClipboardContent</strong> event.</p>\n\n<pre><code> this.mainDataGrid.CopyingRowClipboardContent \n              += this.DatagridOnCopyingRowClipboardContent;\n</code></pre>\n\n<p>In this method, some cells are added to both the header and the rows, hence resulting in a \"wider\" grid.</p>\n\n<pre><code>    private void DatagridOnCopyingRowClipboardContent(\n        object sender, \n        DataGridRowClipboardEventArgs dataGridRowClipboardEventArgs)\n    {\n        // this is fired every time a row is copied\n        var allContent = dataGridRowClipboardEventArgs.ClipboardRowContent;\n\n        allContent.Insert(0, new DataGridClipboardCellContent(\n                                            null, \n                                            this.mainDataGrid.Columns[0], \n                                            \"new cell\"));\n    }\n</code></pre>\n\n<p>At this point I am stuck because I am trying to add an additional row <strong>before</strong> the header and <strong>two after</strong> the last row (see image below).</p>\n\n<p>Any ideas? Suggestions?</p>\n\n<p>Please note I am not interested in an MVVM way of doing it here.</p>\n\n<p><img src=\"http://i.stack.imgur.com/lgX2i.png\" alt=\"enter image description here\"></p>\n"},{"tags":["wpf","wpf-controls","slider"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":232,"score":0,"question_id":11710636,"title":"custom slider in wpf","body":"<p>In bottom lines I describe that how these sliders operate:\nWhen the pins of slider move to top, for minimum pin , the color of whole of the place under this pin becomes red for colored slider and white for black&amp;white slider and for maximum pin , when this pin move to bottom, color of whole of the place top of this pin becomes blue for colored slider and black for black&amp;white slider\nHow I can change color before thumb of slider? (means this part of the text: for minimum pin , the color of whole of the place under this pin becomes red for colored slider and white for black&amp;white slider) </p>\n\n<p><img src=\"http://i.stack.imgur.com/N4vk7.png\" alt=\"image\"></p>\n"},{"tags":["wpf","binding","mvvm","treeview","xmldataprovider"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":182,"score":3,"question_id":8413148,"title":"Binding against the XmlDataProvider fails?","body":"<p>I have some Problems with Binding of a XmlDataProvider to the WPF TreeView.</p>\n\n<p>The TreeView is XAML-Defined like this:</p>\n\n<pre><code>&lt;TreeView ItemsSource=\"{Binding Path=SelectedSystemVersionHistory}\"/&gt;\n</code></pre>\n\n<p>and I have a HierarchicalDataTemplate in the Parent Grid Resource of the TreeView for the Nodes in the XML File:</p>\n\n<pre><code>&lt;HierarchicalDataTemplate DataType=\"Documentation\" ItemsSource=\"{Binding XPath=*}\"&gt;\n  &lt;TextBlock Text=\"{Binding XPath=@SoftwarePackage}\"/&gt;\n&lt;/HierarchiclaDataTemplate&gt;\n</code></pre>\n\n<p>My ViewModel has this Property:</p>\n\n<pre><code>public XmlDataProvider SelectedSystemVersionHistory\n{\n  get\n  {\n    String file = GetHistoryFile(); //returns full Filepath\n    return new XmlDataProvider()\n    {\n      source = new Uri(file, UriKind.Absolute),\n      XPath= \"History\"\n    };\n  }\n}\n</code></pre>\n\n<p>And the Xml looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"yes\" encoding=\"utf-8\"&gt;\n  &lt;History&gt;\n    &lt;Documentation SoftwarePackage=\"SoftwarePackageName\"&gt;\n      &lt;Entry&gt;...&lt;/Entry&gt;\n    &lt;/Documentation&gt;\n  &lt;/History&gt;\n</code></pre>\n\n<p>The Problem is the TreeView doesn't show anything, so what is wrong?\nI'm working on this for days now... :o(\nthank u for your help.</p>\n"},{"tags":["wpf","datagrid","hyperlink"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13057671,"title":"Hyperlink in WPF DataGrid stopping row from being selected","body":"<p>I have a DataGrid with a template column with a Hyperlink as template</p>\n\n<pre><code>&lt;DataGridTemplateColumn.CellTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;TextBlock&gt;\n            &lt;Hyperlink Command=\"{Binding Path=OpenCommand}\"&gt;\n                &lt;TextBlock Text=\"{Binding Path=Description}\" /&gt;\n            &lt;/Hyperlink&gt;\n        &lt;/TextBlock&gt;\n    &lt;/DataTemplate&gt;\n&lt;/DataGridTemplateColumn.CellTemplate&gt;\n</code></pre>\n\n<p>The DataGrid also have a contextmenu with commands for the selected row. When the user right clicks a row in any other columns than the hyperlink column, the row gets selected and context menu is displayed. The problem I have is when the user right clicks on the hyperlink, in order to see commands for that row, the row does not automatically gets selected.</p>\n\n<p>Question: How can I make the Hyperlink ignore the right mouse click, and let the datagrid take care of the event and select the row just like in the other columns?</p>\n"},{"tags":["c#",".net","wpf","exception","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":844,"score":1,"question_id":4041714,"title":"Exception: The specified Visual is not an ancestor of this Visual","body":"<p>The following method thrwos an exception in the line:</p>\n\n<pre><code>Point childPosition = vb.TransformToAncestor(surfaceWindow).Transform(new Point(0, 0));\n</code></pre>\n\n<p>But if you look at the code, the vb is surely a child of surfaceWindow. So why isn't this working?</p>\n\n<pre><code>if (!isExpanded())\n            {\n                Viewbox vb = new Viewbox();\n\n                ClassMetricView metricView = new ClassMetricView();\n                metricView.Width = 300;\n                metricView.Height = 300;\n                metricView.ClassName = this.name;\n                metricView.NumberOfMetrics = 6;\n                metricView.LOC = this.getLoc();\n                metricView.FanIn = this.getFanIn();\n                metricView.FanOut = this.getFanOut();\n                metricView.buildComponent();\n                vb.Child = metricView;\n                vb.AddHandler(StackPanel.SizeChangedEvent, new System.Windows.SizeChangedEventHandler(SizeChangedHandler));\n\n                surfaceWindow.ClassScatter.Items.Add(vb);\n                this.setExpanded(true);\n\n                //Create line to connect these UI elements\n\n                Point parentPosition = surfaceWindow.RootContainer.TransformToAncestor(surfaceWindow).Transform(new Point(0, 0));\n                Point childPosition = vb.TransformToAncestor(surfaceWindow).Transform(new Point(0, 0));\n                Line line = new Line();\n                line.X1 = parentPosition.X;\n                line.Y1 = parentPosition.Y;\n                line.X2 = childPosition.X;\n                line.Y2 = childPosition.Y;\n                line.Stroke = System.Windows.Media.Brushes.Black;\n                line.StrokeThickness = 2;\n                surfaceWindow.RootGrid.Children.Add(line);\n            }\n</code></pre>\n\n<p>EDIT: I found maybe an answer to my problem:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/2837293\">Error when using TransformToAncestor: \"The specified Visual is not an ancestor of this Visual.\"</a></p>\n\n<p>the problem is, I don't understand the solution. Can anyone explain?</p>\n\n<p>EDIT 2: I tried to implement this dispatcher. But still the same exception is thrown. Any hints would be really great!</p>\n\n<pre><code> public void expand(SurfaceWindow1 surfaceWindow)\n        {\n            _surfaceWindow = surfaceWindow;\n            Logging.Logger.getInstance().log(\"Expand class \" + name);\n\n            if (!isExpanded())\n            {\n                Viewbox vb = new Viewbox();\n\n                ClassMetricView metricView = new ClassMetricView();\n                metricView.Width = 300;\n                metricView.Height = 300;\n                metricView.ClassName = this.name;\n                metricView.NumberOfMetrics = 5;\n                metricView.NumberOfRevisions = 6;\n                metricView.MetricsName = new string[] { \"LOC\", \"FanIn\", \"FanOut\", \"NOM\", \"McCabe\"};\n                int[,] values = { { 10, 10, 10, 10, 10}, {20, 20, 20, 20, 20}, {30, 30, 30, 30, 30}, {40, 40, 40, 40, 40}, {50, 50, 50, 50, 50}, {60, 60, 60, 60, 60} };\n                metricView.Metrics = values;\n                metricView.buildComponent();\n                vb.Child = metricView;\n                vb.AddHandler(StackPanel.SizeChangedEvent, new System.Windows.SizeChangedEventHandler(SizeChangedHandler));\n\n                surfaceWindow.ClassScatter.Items.Add(vb);\n                this.setExpanded(true);\n\n                //Create line to connect these UI elements\n                System.Threading.Thread thread = new System.Threading.Thread(\n    new System.Threading.ThreadStart(\n      delegate()\n      {\n          vb.Dispatcher.Invoke(\n            System.Windows.Threading.DispatcherPriority.Normal,\n            new Action(\n              delegate()\n              {\n                  SetStatus(vb);\n              }\n          ));\n      }\n  ));\n\n                thread.Start();\n            }\n        }\n\n        private void SetStatus(Viewbox vb)\n        {\n\n            Point parentPosition = _surfaceWindow.RootContainer.TransformToAncestor(_surfaceWindow).Transform(new Point(0, 0));\n            Point childPosition = vb.TransformToAncestor(Window.GetWindow(vb)).Transform(new Point(0, 0));\n            //Point childPosition = new Point(0, 0);\n\n            Line line = new Line();\n            line.X1 = parentPosition.X;\n            line.Y1 = parentPosition.Y;\n            line.X2 = childPosition.X;\n            line.Y2 = childPosition.Y;\n            line.Stroke = System.Windows.Media.Brushes.Black;\n            line.StrokeThickness = 2;\n            _surfaceWindow.RootGrid.Children.Add(line);\n\n            Console.WriteLine(\"Draw line with position: \" + line.X1 + \"/\" + line.Y1 + \"/\" + line.X2 + \"/\" + line.Y2);\n        }\n</code></pre>\n"},{"tags":["c#","wpf","animation","telerik"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13138783,"title":"Reverse Page Animation example provided by Telerik","body":"<p>Update: I was able to figure this out. Took me a couple of hours but solved it. Below is Left and Right for animation.</p>\n\n<p>I was looking through a link and came upon an example project that Telerik provided. I just wanted to know if there's a way to reverse the animation. I believe right now it's animating from right to left. I would like the opposite direction. Here's the animation method provided by Telerik.</p>\n\n<p>Animate Right to Left</p>\n\n<pre><code>public void BeginRight(FrameworkElement mockItem1, Grid container, FrameworkElement newPage)\n   {\n    this.Container = container;\n    this.PageWidth = container.ActualWidth;\n    this.item1 = mockItem1;\n    this.item2 = newPage;\n\n   this.Container.Children.Add(this.item1);\n\n   var width = PageWidth;\n\n   var scaleFactor = 0.8;\n    var halfSrink = (1.0 - scaleFactor) / 2;\n\n   this.Container.Children.Add(this.mask1);\n    this.Container.Children.Add(this.mask2);\n\n   var scaleDownSpline = new Spline(0.504000008106232, 0.256000012159348, 0.458999991416931, 1);\n    var moveSpline = new Spline(0.247999995946884, 0, 1, 1);\n    var scaleUpSpline = new Spline(0.321000009775162, 0, 0.45100000500679, 1);\n    var spacing = 15.0;\n\n   this.animation = this.item1\n     .Animate()\n     .With(this.mask1)\n      .EnsureDefaultTransforms()\n      .Origin(0, 0.5)\n      .Scale(0, 1, 0.2, 1, 0.7, scaleFactor)\n       .Splines(2, scaleDownSpline)\n      .MoveX(0.7, 0, 1.365, (-width * (scaleFactor - halfSrink)) - spacing, 1.9, (-width * scaleFactor) - spacing)\n       .Splines(1, moveSpline)\n       .Splines(2, scaleUpSpline)\n     .Without(this.item1)\n      .Opacity(0, 0, 0.2, 0, 0.7, 1)\n       .Splines(1, scaleDownSpline)\n     .Animate(this.mask2)\n      .Opacity(1.35, 1, 1.9, 0)\n       .Splines(scaleUpSpline)\n     .With(this.item2)\n      .EnsureDefaultTransforms()\n      .Origin(0.5, 0.5)\n      .Scale(0, scaleFactor, 1.365, scaleFactor, 1.9, 1)\n       .Splines(1, moveSpline)\n       .Splines(2, scaleUpSpline)\n      .MoveX(0.0, ((scaleFactor + halfSrink) * width) + spacing, 0.2, ((scaleFactor + halfSrink) * width) + spacing, 0.7, ((scaleFactor - halfSrink) * width) + spacing, 1.365, 0)\n       .Splines(2, scaleDownSpline)\n       .Splines(3, moveSpline)\n     .Instance;\n\n   this.animation.SpeedRatio = 755.0 / width * 1.5;\n\n   this.isRunning = true;\n\n   this.animation.Completed += (sender, e) =&gt;\n    {\n                 this.TransitionAnimationCompleted(this, new TransitionEventArgs(item2));\n\n    Container.Children.Remove(mask1);\n     Container.Children.Remove(mask2);\n     RemoveVisualBrush();\n     Container.Children.Remove(item1);\n     item1 = null;\n     item2 = null;\n    };\n\n   this.animation.Begin();\n   }\n</code></pre>\n\n<p>Animate Left to Right</p>\n\n<pre><code>public void BeginLeft(FrameworkElement mockItem1, Grid container, FrameworkElement newPage)\n    {\n       this.Container = container;\n        this.PageWidth = container.ActualWidth;\n        this.item1 = mockItem1;\n        this.item2 = newPage;\n\n        this.Container.Children.Add(this.item1);\n\n        var width = PageWidth;\n\n        var scaleFactor = 0.8;\n        var halfSrink = (1.0 - scaleFactor) / 2;\n\n        this.Container.Children.Add(this.mask1);\n        this.Container.Children.Add(this.mask2);\n\n        var scaleDownSpline = new Spline(0.504000008106232, 0.256000012159348, 0.458999991416931, 1);\n        var moveSpline = new Spline(0.247999995946884, 0, 1, 1);\n        var scaleUpSpline = new Spline(0.321000009775162, 0, 0.45100000500679, 1);\n        var spacing = 15.0;\n\n        this.animation = this.item1\n            .Animate()\n            .With(this.mask1)\n                .EnsureDefaultTransforms()\n                .Origin(0.5, 0.5) \n                .Scale(0, 1, 0.2, 1, 0.7, scaleFactor)\n                    .Splines(2, scaleDownSpline)\n                    .MoveX(0.7, 0, 1.365, (width * (scaleFactor - halfSrink)) + spacing, 1.9, (width + scaleFactor) + spacing) \n                    .Splines(1, moveSpline)\n                    .Splines(2, scaleUpSpline)\n            .Without(this.item1)\n                .Opacity(0, 0, 0.2, 0, 0.7, 1)\n                    .Splines(1, scaleDownSpline)\n            .Animate(this.mask2)\n                .Opacity(1.35, 1, 1.9, 0)\n                    .Splines(scaleUpSpline)\n            .With(this.item2)\n                .EnsureDefaultTransforms()\n                .Origin(0, 0.5) \n                .Scale(0, scaleFactor, 1.365, scaleFactor, 1.9, 1)\n                    .Splines(1, moveSpline)\n                    .Splines(2, scaleUpSpline)\n                    .MoveX(0.0, -((scaleFactor + halfSrink) * width) - spacing, 0.2, -((scaleFactor + halfSrink) * width) - spacing, 0.7, -((scaleFactor - halfSrink) * width) - spacing, 1.365, 0) \n                    .Splines(2, scaleDownSpline)\n                    .Splines(3, moveSpline)\n            .Instance;\n\n        this.animation.SpeedRatio = 755.0 / width * 1.5;\n\n        this.isRunning = true;\n\n        this.animation.Completed += (sender, e) =&gt;\n        {\n            this.TransitionAnimationCompleted(this, new TransitionEventArgs(item2));\n\n            Container.Children.Remove(mask1);\n            Container.Children.Remove(mask2);\n            RemoveVisualBrush();\n            Container.Children.Remove(item1);\n            item1 = null;\n            item2 = null;\n        };\n\n        this.animation.Begin();\n    }\n</code></pre>\n"},{"tags":["wpf","grid","alignment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13177187,"title":"WPF Grid Column not aligning image correctly","body":"<p>The final column of the below grid view is not displaying in the center vertically, though the first image is and they use the same lookup method to find the image source (A resource dictionary object locator class I have). The final image (CurrencyImg) has the bottom of the image aligned with the middle of the row, so it stretches out of view upwards and doesn't fill the lower half of the row. Confused!</p>\n\n<pre><code>&lt;Grid Name=\"grdCustomer\" &gt;\n                        &lt;Grid.ColumnDefinitions&gt;\n                            &lt;ColumnDefinition Width=\"300\" /&gt;\n                            &lt;ColumnDefinition Width=\"220\" /&gt;\n                            &lt;ColumnDefinition Width=\"50\" /&gt;\n                            &lt;ColumnDefinition Width=\"*\" /&gt;\n                            &lt;ColumnDefinition Width=\"30\" /&gt;\n                            &lt;ColumnDefinition Width=\"30\" /&gt;\n                        &lt;/Grid.ColumnDefinitions&gt;\n\n                        &lt;Grid.RowDefinitions&gt;\n                            &lt;RowDefinition Height=\"18\"/&gt;\n                        &lt;/Grid.RowDefinitions&gt;\n\n                        &lt;Image Source=\"{y:ImageStaticResource {Binding IconString}}\" Margin=\"0,0,0,0\" VerticalAlignment=\"Center\" &gt;&lt;/Image&gt;\n                        &lt;TextBlock Grid.Column=\"1\" Text=\"{Binding CustomerDesc}\" VerticalAlignment=\"Center\" /&gt;\n                        &lt;TextBlock Name=\"tbTxnCount\" Grid.Column=\"2\" Text=\"{Binding TxnCount}\" VerticalAlignment=\"Center\" /&gt;\n                        &lt;TextBlock Name=\"tbAmount\" Style=\"{StaticResource myCustStyleColor}\" Grid.Column=\"3\" Text=\"{Binding Amount}\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Center\"  /&gt;\n                        &lt;TextBlock Name=\"tbCurrency\" Grid.Column=\"4\" Text=\"{Binding Currency}\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Center\"  /&gt;\n                        &lt;Image Name=\"imgCurrency\"  Grid.Column=\"5\" Margin=\"0,0,0,0\"  Source=\"{y:ImageStaticResource {Binding CurrencyImg}}\" VerticalAlignment=\"Center\" /&gt;\n                    &lt;/Grid&gt;\n</code></pre>\n"},{"tags":["c#","wpf","dispatchertimer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13177183,"title":"get a value Returned from a Dispatcher timer Event handler?","body":"<p>how do i get a value returned from a event handler at  a calling position??\nwhat i would like to do is something like this</p>\n\n<pre><code>             \"\"  int a = timer.Elapsed += new ElapsedEventHandler((sender, e) =&gt; \n                on_time_event(sender, e, draw, shoul_l));   \"\"\n\n\n                timer_start = true;\n                timer.Interval = 2000;\n                timer.Start();\n                timer.Elapsed += new ElapsedEventHandler((sender, e) =&gt; \n                on_time_event(sender, e, draw, shoul_l));\n\n\n                private int on_time_event(object sender, ElapsedEventArgs e,  \n                DrawingContext dcrt, System.Windows.Point Shoudery_lefty)\n                 {\n                  .\n                  .\n                  .\n                  .\n                   return a_value;\n                  }\n</code></pre>\n"},{"tags":["c#","wpf","windows-phone","fill","ellipse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13177529,"title":"WPF Ellipse with BackgroundColor and Image","body":"<p>I'm developing a Windows Phone application and I have some Ellipses. Is it possible to have a background image on them AND a background color?</p>\n\n<p>When I looked for it, VS only allows me to change the Fill property with an image but didn't allow me to keep the Color on Fill + the Image.</p>\n"},{"tags":["c#",".net","wpf","pdf","flowdocument"],"answer_count":4,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":646,"score":3,"question_id":9182137,"title":"What's the best way to convert a FlowDocument into PDF","body":"<p>How would ya'll recommend that I convert a FlowDocument to PDF to be attached to an EMail?</p>\n\n<p>The FlowDocument is dynamic, not static.</p>\n\n<p>I would prefer to be able to store the PDF in memory as a byte[], rather than on disk, but that is negotiable.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["wpf","pdf","flowdocument","xps","doc"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":2041,"score":3,"question_id":5349490,"title":"How to save the content of flowDocument in PDF and Word?","body":"<p>Is there a way of saving the content of flowdocument control in .pdf and .doc format not just XPS?</p>\n\n<p><strong>Not a 3rd party control</strong></p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13176623,"title":"Insert properties to class in runtime","body":"<p>I'm trying to insert properties dynamically to a class.\nI need to load properties from database and show it in PropertyGrid, but I want to it to be build in run time, it means that I want to insert property definition to database and to load it to a class(My Class) in runtime.</p>\n\n<p>e.g - if the data base contains row that define property (e.g Name of type string)\nthe class should something like this:</p>\n\n<pre><code>public MyClass\n{\n   public string Name{get; set;}\n}\n</code></pre>\n\n<p>I also tried to do it using dynamic but it failed.\nany ideas?\nThank you.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13153470,"title":"WPF brownian motion: updating state with a thread","body":"<p>Here's a little Brownian motion demo in WPF:</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Shapes;\nusing System.Windows.Threading;\nusing System.Threading;\n\nnamespace WpfBrownianMotion\n{\n    static class MiscUtils\n    {\n        public static double Clamp(this double n, int low, double high)\n        {\n            return Math.Min(Math.Max(n, low), high);\n        }\n    }\n\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            Width = 500;\n            Height = 500;\n\n            var canvas = new Canvas();\n\n            Content = canvas;\n\n            var transform = new TranslateTransform(250, 250);\n\n            var circle = new Ellipse()\n            {\n                Width = 25,\n                Height = 25,\n                Fill = Brushes.PowderBlue,\n                RenderTransform = transform\n            };\n\n            canvas.Children.Add(circle);\n\n            var random = new Random();\n\n            var thread =\n                new Thread(\n                    () =&gt;\n                    {\n                        while (true)\n                        {\n                            Dispatcher.Invoke(\n                                DispatcherPriority.Normal,\n                                (ThreadStart)delegate()\n                                {\n                                    transform.X += -1 + random.Next(3);\n                                    transform.Y += -1 + random.Next(3);\n\n                                    transform.X = transform.X.Clamp(0, 499);\n                                    transform.Y = transform.Y.Clamp(0, 499);\n                                });\n                        }\n                    });\n\n            thread.Start();\n\n            Closed += (s, e) =&gt; thread.Abort();\n        }\n    }\n}\n</code></pre>\n\n<p>My question is this. In cases like this where the standard WPF animation facility isn't being used, is the above approach using <code>Thread</code> and <code>Dispatcher</code> the recommended approach to take?</p>\n\n<p>In general, I sometimes have states that need to be updated and rendered and the animation facility isn't a good fit. So I need a way to do the update and rendering in a separate thread. Just wondering if the above approach is the Right Thing.</p>\n"},{"tags":["wpf","mvvm","listbox"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13176948,"title":"In WPF MVVM, how do you transfer an item from one listbox to another using a double-click?","body":"<p>I want to double-click to copy an item from a \"shopping list\" to a \"shopping cart\" list box. Right now, my model just has ObservableCollection of strings for each list, but eventually the objects will get more complex.</p>\n\n<p>The ViewModel is mapped to the view using a DataTemplate. Right now, I just have a \"Session\" property on my ViewModel that is exposing my Session object in my Model that contains both ObservableCollections.</p>\n\n<p>I tried this...</p>\n\n<pre><code>&lt;ListBox Name=\"listBoxShopList\" ItemsSource=\"{Binding Path=Session.Products}\"&gt;\n  &lt;ListBox.ItemContainerStyle&gt;\n    &lt;Style TargetType=\"{x:Type ListBoxItem}\" BasedOn=\"{StaticResource {x:Type ListBoxItem}}\"&gt;\n      &lt;EventSetter Event=\"MouseDoubleClick\" Handler=\"ListBoxItemMouseDoubleClick\"/&gt;\n    &lt;/Style&gt;\n  &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n&lt;ListBox Name=\"listBoxCart\" ItemsSource=\"{Binding Path=Session.CartItems, UpdateSourceTrigger=PropertyChanged}\"/&gt;\n</code></pre>\n\n<p>From code-behind I do get the event and I can get the SelectedItem. But being new to MVVM, I cannot figure out how to add the item to the \"Cart\" collection. It seems like I should be able to access the ViewModel Session.CartItems directly since the View can. Is a parameterized command the way to go? If so, any recommended articles?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13175872,"title":"Image byte array binding","body":"<p>I have a byte array to image converter:</p>\n\n<p>Wpf:</p>\n\n<pre><code>&lt;Image Source=\"{Binding Images, Converter={StaticResource ImgConverter}}\" Name=\"imgIImages\"\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>imgImages.Source = bImages;\n</code></pre>\n\n<p>How can I bind the bSignauture byte array to the image?</p>\n"},{"tags":["c#",".net","wpf","mvvm","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13176441,"title":"Failing to store File In Combobox and Read the Data, Size in WPF","body":"<p>I am a C++ developer and recently started working on C# WPF app. I am following MVVM. Well I am working on Combobox and buttons. Basically I have a browse button to load a binfile and store it in combobox and when I click TEST button, i should read the data present in file, get the size of it.</p>\n\n<p><strong>Here is the XAML:</strong></p>\n\n<pre><code>&lt;ComboBox Name=\"ClockYHZBox\" &gt;              \n          &lt;ComboBoxItem Content=\"{Binding FirmwarePath}\" /&gt;\n&lt;/ComboBox&gt;\n&lt;Button Content=\"Browse\" Command=\"{Binding WriteFilePathCommand}\" Name=\"RunPCMPDM0\" /&gt;\n\n&lt;Button Content=\"Test\" Command=\"{Binding WriteDataTestCommand}\" /&gt;\n</code></pre>\n\n<p><strong>ViewModel Class:</strong></p>\n\n<pre><code>private string _selectedFirmware;\n    public string FirmwarePath\n    {\n        get; set;\n    }\n\n// This method gets called when BROWSE Button is pressed\nprivate void ExecuteWriteFileDialog()\n    {\n        var dialog = new OpenFileDialog { InitialDirectory = _defaultPath };\n        dialog.DefaultExt = \".bin\";\n        dialog.Filter = \"BIN Files (*.bin)|*.bin\";\n        dialog.ShowDialog();\n        FirmwarePath = dialog.FileName; // Firmware path has the path           \n    }       \n\n// Method gets called when TEST Button is Pressed\npublic void mSleepTestCommandExecuted()\n    {\n        int cmd = (22 &lt;&lt; 8) | 0x06; \n        System.IO.StreamReader sr = new System.IO.StreamReader(FirmwarePath);\n\n        string textdata = sr.ReadToEnd();\n        int fileSize = (int)new System.IO.FileInfo(FirmwarePath).Length;\n\n        Byte[] buffer = new Byte[256];            \n\n        // This gives me the size and data, But i am failing to do\n        // further operation of storing value in BUFFER\n        // and MEMCPY which is shown below in C++ Code          \n    }\n</code></pre>\n\n<p>This is how I had done in my C++ application:</p>\n\n<pre><code>MemoryBlock binFile;\nm_wdbFile-&gt;getCurrentFile().loadFileAsData(binFile); //m_wbdFile is a filedialog object\nBYTE *buffer = NULL;\nint  fileSize = binFile.getSize();\nbuffer = (BYTE *)calloc(sizeof(BYTE), fileSize + 2);    \nmemcpy(buffer+2, binFile.getData(), fileSize);\n</code></pre>\n\n<p>As you can see above, it opens the file, stores the size in <code>fileSize</code>, allocates block of memory to buffer and so on. How can I achieve it? I would appreciate your help :)</p>\n"},{"tags":["c#","wpf","kinect","drawingcontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13176167,"title":"Accessing Draw Context in Dispather timer gives exception","body":"<p>what i am trying to do is first find the angle of the shoulder joint till now i have managed to do that.what i wanted to do now is  when the angle comes in the range  between 70 and 90  a time starts  for 3 sec and in each sec it should check whether the angle is still in the range if it is  then show on screen ok otherwise  restart the timer after displaying the message you have no completed the time limit\nPlease please em very new to wold of  C# and kinect  any help in this regard will b helpful\nthe link to an image  of a problem em facing is:\n<a href=\"http://i46.tinypic.com/2nu4ygw.jpg\" rel=\"nofollow\">http://i46.tinypic.com/2nu4ygw.jpg</a> </p>\n\n<p>Please help!!</p>\n\n<pre><code>       System.Windows.Point shoul_l = this.point_toScreen(sh_left.Position, sen);\n        draw.DrawText(new FormattedText(angle.ToString(\"0\"), new \n        System.Globalization.CultureInfo(\"en-us\"),\n          System.Windows.FlowDirection.LeftToRight,\n         new Typeface(\"Verdana\"), 16,System.Windows.Media.Brushes.OrangeRed),\n         new System.Windows.Point(shoul_l.X+10, shoul_l.Y +20));\n\n        if (timer_start == false)\n        {\n        if (angle &gt; 70 &amp;&amp; angle &lt; 90)\n        {\n                timer_start = true;\n                timer.Interval = 2000;\n                timer.Start();\n                timer.Elapsed += new ElapsedEventHandler((sender, e) =&gt;   \\    \n                on_time_event(sender, e, draw,shoul_l));\n\n        }\n        }\n\n\n}   \nvoid on_time_event(object sender, ElapsedEventArgs e, DrawingContext dcrt, \n\n System.Windows.Point Shoudery_lefty)\n {\n     --index;\n     if (index != 0)\n     {\n         dcrt.DrawText(new FormattedText(index.ToString(), new   \n      System.Globalization.CultureInfo(\"en-us\"),\n           System.Windows.FlowDirection.LeftToRight,\n          new Typeface(\"Verdana\"), 16, System.Windows.Media.Brushes.OrangeRed),\n          new System.Windows.Point(Shoudery_lefty.X+50,Shoudery_lefty.Y+50));\n      //  MessageBox.Show(index.ToString());\n     }\n     else\n     {\n         timer.Stop();\n     }\n   }\n</code></pre>\n\n<p>i get an exception in this part of the code </p>\n\n<pre><code>      dcrt.DrawText(new FormattedText(index.ToString(), new   \n      System.Globalization.CultureInfo(\"en-us\"),\n      System.Windows.FlowDirection.LeftToRight,\n      new Typeface(\"Verdana\"), 16, System.Windows.Media.Brushes.OrangeRed),\n      new System.Windows.Point(Shoudery_lefty.X+50,Shoudery_lefty.Y+50));\n</code></pre>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13175280,"title":"WPF disposing of view and viewmodel correctly","body":"<p>I've written an Outlook add-in (OL2010). It has a menu on the ribbon bar with various icons that open new windows that do stuff (hope that's not too in-depth ;)).  An example of one of the icon <code>Click</code> handlers is below.</p>\n\n<pre><code>public void OnViewMyTracksClick(Office.IRibbonControl control)\n{\n    try {\n    MyTracksViewModel viewModel = new MyTracksViewModel();\n    MyTracksView view = new MyTracksView();\n    view.DataContext = viewModel;\n    view.Show();\n    }\n    catch (Exception ex)\n    {\n        Log.Error(\"xxxxx\", \"Error on button click: \" + ex.Message + Environment.NewLine + ex.InnerException);\n    }\n}\n</code></pre>\n\n<p>In Outlook, if I click the button to open this view, I see the memory usage of <code>Outlook.exe</code> increase by 10mb (the window and it's accompanying data). When I close the view, none of that memory is reclaimed. If I click the button again, another 10mb is added, and again, none is released when I close the view.</p>\n\n<p>I thought that this is because I'm creating a new viewmodel everytime, so I added some code to check if it was already instantiated (the view and viewmodel are now registered at the class level, rather that within the method, so that I don't create a new one each time) - <code>_allTracksVM</code> is an instantiation of <code>AllTracksViewModel</code>. <code>_allTracksV</code> is the view.</p>\n\n<pre><code>public void OnViewAllTracksClick(Office.IRibbonControl control)\n{\n    try {\n        if (_allTracksVM == null)\n        {\n            _allTracksVM = new AllTracksViewModel();\n\n        }\n        _allTracksV = new AllTracksView();\n        _allTracksV.DataContext = _allTracksVM;\n        _allTracksV.Show();\n    }\n    catch (Exception ex)\n    {\n        Log.Error(\"xxxxx\", \"Error on button click: \" + ex.Message + Environment.NewLine + ex.InnerException);\n    }\n}\n</code></pre>\n\n<p>This didn't seem to make any difference. I then added an <code>EventHandler</code> that would fire when the view was closed:</p>\n\n<pre><code>_allTracksV.Closing += new System.ComponentModel.CancelEventHandler(this.view_RequestClose);\n</code></pre>\n\n<p>And this set both the objects to null (you can probably tell i'm grabbing at straws at this point):</p>\n\n<pre><code>void view_RequestClose(object sender, EventArgs e)\n{\n    _allTracksVM = null;\n    _allTracksV = null;\n}\n</code></pre>\n\n<p>The memory remains allocated. How can I dispose of the objects correctly (or perhaps I should be instantiating them differently), so that they don't consume another chunk of memory each time they are opened?</p>\n\n<p>Thanks</p>\n\n<p>Mick</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":9,"up_vote_count":9,"down_vote_count":1,"view_count":520,"score":8,"question_id":7964445,"title":"Responsive UI Tips","body":"<p>I would just like a few tips when i want to create a responsive UI.</p>\n\n<p>I know how to use: </p>\n\n<pre><code>Dispatcher\nTask\nBackgroundWorker\nThreads\n</code></pre>\n\n<p>I am looking for more advance tips, like binding tips... When i have 50+ controls on my UI that needs to update.</p>\n\n<pre><code>PriorityBinding\nPopulating ComboBoxes\nPopulating ListBoxes, ListViews\n</code></pre>\n\n<p>When processing data in the background...\nBest practices maybe when it comes to long running proccess.</p>\n\n<p>What else can i do to make my UI 100% responsive.</p>\n"},{"tags":["c#","wpf","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13172282,"title":"How to hide a combo box in an externally controlled application","body":"<p>I have an application A (.NET/WPF), which controls application B via WinAPI calls.</p>\n\n<p>According to the requirements, application A must always be the topmost window. This means that</p>\n\n<ul>\n<li>if the window of application A is located at the same position as the window of application B,</li>\n<li>then the window of application A should be visible, and</li>\n<li>the window of application B must not be visible.</li>\n</ul>\n\n<p>This requirement is satisfied in all cases except one. When application A programmatically selects an element from a combo box in application B, that combo box becomes visible for a moment. After an element is selected, it is hidden again.</p>\n\n<p>But the combo box being visible (even for a few moments) is a violation of the requirements.</p>\n\n<p>How can I make sure that the window of appliation A is <strong>always</strong> the topmost window (even during selection of a combo box item) ?</p>\n\n<p>Note: Application A takes back focus (activates itself) every 200 milliseconds. I tried to reduce that interval to 100 milliseconds, but it didn't help.</p>\n\n<p><strong>Update 1:</strong> The combo box item is selected using following WinAPI calls.</p>\n\n<pre><code>SendMessage(Self.MyFlightComboBox, CB_SHOWDROPDOWN, WPARAM(true), 0);\n\nItemIndex := SendMessage(Self.MyFlightComboBox, CB_FINDSTRING, -1, integer(@MyValue[1]));\n\nOutputDebugString(PChar('ItemIndex: ' + IntToStr(ItemIndex)));\n\n\nSendMessage(Self.MyFlightComboBox, CB_SETCURSEL, ItemIndex, 0);\nSendMessage(Self.MyFlightComboBox, CN_COMMAND, MakeWParam(0, CBN_SELCHANGE), 0);\n\n\nSendMessage(Self.MyFlightComboBox, WM_LBUTTONDOWN, 0, -1);\nSendMessage(Self.MyFlightComboBox, WM_LBUTTONUP, 0, -1);\n</code></pre>\n"},{"tags":["wpf","silverlight","windows-8","winrt"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":11055329,"title":"Displaying an 8x8 Grid in Windows 8 / WPF / Silverlight","body":"<p>I want to display an 8x8 Grid in Windows 8 metro app. To do this:  </p>\n\n<ol>\n<li>I created a <code>Grid</code>, and added 8 row definitions and 8 column definitions.  </li>\n<li>I then add a <code>Rectangle</code> with a black border to each of the grid cells.   </li>\n<li>Then in the <code>MeasureOverride</code> method, I check the <code>availableSize</code>. Since my grid needs to be square (aspect ratio = 1.0), I compute the minimum of <code>availableSize.Width, availableSize.Height</code> and return a new Size equal to <code>(minimum, minimum)</code>. </li>\n</ol>\n\n<p>However this does not work. The resulting grid's size is equal to <code>availableSize</code>, and not the size I return from my <code>MeasureOverride</code> method. If I modify the <code>MeaureOverride</code>, so that I set <code>Height</code> of <code>RowDefinition</code>s to <code>minimum</code>, and <code>Width</code> of <code>ColumnDefinition</code>s to <code>minimum</code>, then it works. But I saw some videos and they say you should not be explicitly setting <code>Height</code> &amp; <code>Width</code> properties of anything. </p>\n\n<p>So, is there a <strong>better</strong> way to accomplish what I want?</p>\n"},{"tags":["c#","wpf","sharepoint2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13174819,"title":"wpf sharepoint 2010 file picker","body":"<p>Is there any free control available like openfiledialog in winforms that allows you to pick files from sharepoint 2010? I have sharepoint 2010 foundation installed in a Windows 2008 R2 server. I want to allow users to browse and select files from a Wpf app. It is possible to write something like this using client object model. Just want to know if someone has already created a control like this already so that I don't reinvent the wheel.</p>\n\n<p>In case there isn't any can anyone please give me some directions on how to create one with treeview structure on left like openfile dialog?</p>\n\n<p>Edit: Added C# Tag</p>\n"},{"tags":["wpf","entity-framework-4","system.data.sqlite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13175188,"title":"How to use sqlite in a WPF application(Entity Framework)","body":"<p>I am using sqlite database instead of sql server 2008 in my WPF project.</p>\n\n<p>I am using Entity Framwork for performing CRUD operations.</p>\n\n<p>Work perfectly fine in my machine. </p>\n\n<p>But when I published and ran on other machine application doesn't work </p>\n\n<p>The problem is that the application tries to connect to the database which doesn't exist on that machine.</p>\n\n<pre><code>&lt;add name=\"PersonalExpenseDBEntities\" connectionString=\"metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SQLite;provider connection string=&amp;quot;data source=E:\\sqlLite\\db\\PersonalExpenseDB.s3db&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n</code></pre>\n\n<p>As you can see datasource is referring to database file</p>\n\n<pre><code>data source=E:\\sqlLite\\db\\PersonalExpenseDB.s3db\n</code></pre>\n\n<p>which was present on my machine but isn't on other machine.</p>\n\n<p>So, naturally it doesn't find the database file on other machine and gives me error</p>\n\n<p>My question is: How to make the database local to the application? i.e. when i publish the app, database file should be copied and made local to the application.</p>\n\n<p>The error i get is</p>\n\n<pre><code>System.Data.EntityException: The underlying provider failed on Open. ---&gt; System.Data.SQLite.SQLiteException: Unable to open the database file at System.Data.SQLite.SQLite3.Open(String strFilename, SQLiteOpenFlagsEnum flags, Int32 maxPoolSize, Boolean usePool) at System.Data.SQLite.SQLiteConnection.Open() at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean&amp; closeStoreConnectionOnFailure) --- End of inner exception stack trace --- at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean&amp; closeStoreConnectionOnFailure) at System.Data.EntityClient.EntityConnection.Open() at System.Data.Objects.ObjectContext.EnsureConnection() at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.Execute(MergeOption mergeOption) at SqlLiteDatabase.List.Window_Loaded(Object sender, RoutedEventArgs e) at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs) at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised) at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args) at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e) at System.Windows.BroadcastEventHelper.BroadcastEvent(DependencyObject root, RoutedEvent routedEvent) at System.Windows.BroadcastEventHelper.BroadcastLoadedEvent(Object root) at MS.Internal.LoadedOrUnloadedOperation.DoWork() at System.Windows.Media.MediaContext.FireLoadedPendingCallbacks() at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks() at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) at System.Windows.Media.MediaContext.Resize(ICompositionTarget resizedCompositionTarget) at System.Windows.Interop.HwndTarget.OnResize() at System.Windows.Interop.HwndTarget.HandleMessage(WindowMessage msg, IntPtr wparam, IntPtr lparam) at System.Windows.Interop.HwndSource.HwndTargetFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs) at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) at MS.Win32.UnsafeNativeMethods.ShowWindow(HandleRef hWnd, Int32 nCmdShow) at System.Windows.Window.ShowHelper(Object booleanBox) at System.Windows.Window.Show() at System.Windows.Window.ShowDialog() at SqlLiteDatabase.MainWindow.button1_Click(Object sender, RoutedEventArgs e)\n</code></pre>\n"},{"tags":["c#","wpf","ribbon"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":525,"score":0,"question_id":1634483,"title":"Office RibbonUI ApplicationMenu Icon","body":"<p>I'm having weird issues with the LargeImageSource for the Application menu (using Office2007Blue theme)</p>\n\n<p>My image is 48x48 but it appears to be scaling down to 10x10.  It's not using SmallImageSource at all.</p>\n\n<pre><code>&lt;r:Ribbon.ApplicationMenu&gt;\n            &lt;r:RibbonApplicationMenu&gt;\n                &lt;r:RibbonApplicationMenu.Command&gt;\n                    &lt;r:RibbonCommand\n                        SmallImageSource=\"images/icon.png\"\n                        LargeImageSource=\"images/icon.png\"\n                        ToolTipTitle=\"Application Menu\"\n                        ToolTipDescription=\"Click here to open files or close the application.\" /&gt;\n                &lt;/r:RibbonApplicationMenu.Command&gt;\n                &lt;r:RibbonApplicationMenuItem&gt;\n                    &lt;r:RibbonApplicationMenuItem.Command&gt;\n                        &lt;r:RibbonCommand \n                            LabelTitle=\"_Close\" \n                            LabelDescription=\"Close the Application\"\n                            /&gt;\n                    &lt;/r:RibbonApplicationMenuItem.Command&gt;\n                &lt;/r:RibbonApplicationMenuItem&gt;\n            &lt;/r:RibbonApplicationMenu&gt;\n        &lt;/r:Ribbon.ApplicationMenu&gt;\n</code></pre>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":448,"score":0,"question_id":11199482,"title":"WPF bind listview selected item to expander expanded","body":"<p>I've just started testing the water with WPF and I'm trying to bind the expanded property of an expander and the selected property of a listview item together so that when a list view item is selected the expander expands or going down another road trying to set the listview item to selected on expand of the expander</p>\n\n<p>so far I've got </p>\n\n<pre><code>&lt;ListView HorizontalAlignment=\"Stretch\"  Name=\"listView1\" VerticalAlignment=\"Stretch\" SelectionMode=\"Single\" &gt;\n        &lt;ListView.Resources&gt;\n            &lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n                &lt;Setter Property=\"IsSelected\" Value=\"{Binding Path=IsExpanded, Mode=TwoWay}\"/&gt;\n            &lt;/Style&gt;\n        &lt;/ListView.Resources&gt;\n        &lt;ListView.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;Expander&gt;\n                        &lt;TextBlock Text=\"{Binding Name}\"&gt;&lt;/TextBlock&gt;\n                &lt;/Expander&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ListView.ItemTemplate&gt;            \n    &lt;/ListView&gt;\n</code></pre>\n\n<p>But I can't figure out how to reference the expander in the binding. Any help or a nudge in the right direction would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","silverlight","silverlight-5.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13123011,"title":"how to add png for a image in code for silverlight?","body":"<p>Try to create a image in code as below:</p>\n\n<pre><code>sp = new StackPanel() { Orientation = Orientation.Horizontal };\nImage myImage = new Image() { HorizontalAlignment = HorizontalAlignment.Left, Width = 16, Height = 16, Margin = new Thickness(1, 0, 0, 0) };\nMyImage.Source = new BitmapImage(new Uri(\"/MyAssembly;component/folder/image1.png\", UriKind.RelativeOrAbsolute));\nsp.Children.Add(MyImage);\n</code></pre>\n\n<p>then run the app, the image does not display. Check the data with Fiddler and got 404 error. The source for above image is something like:</p>\n\n<pre><code>http://localhost:80/MyAssembly;component/folder/image1.png\n</code></pre>\n\n<p>but this image is complied into an assembly MyAssembly. </p>\n\n<p>It is okay to get the image xaml from the assembly with following markup:</p>\n\n<pre><code>&lt;Image Source=\"/MyAssembly;component/folder/image1.png\"/&gt;\n</code></pre>\n\n<p>Confused. Not sure why. How to get dynamic image in code?</p>\n\n<p><strong>Updated:</strong> Thanks for information form Clemens. Try following code:</p>\n\n<pre><code>sp = new StackPanel() { Orientation = Orientation.Horizontal };\nImageSourceConverter converter = new ImageSourceConverter();\nImage myImage = new Image() { HorizontalAlignment = HorizontalAlignment.Left, Width = 16, Height = 16, Margin = new Thickness(1, 0, 0, 0) }; \nMyImage.Source = (ImageSource)converter.ConvertFromString(\"/MyAssembly;component/folder/image1.png\");\nsp.Children.Add(MyImage);\n</code></pre>\n\n<p>the result same as before. message from Fiddler:\nThe resource you are looking for has been removed, had its name changed, or is temporarily unavailable.</p>\n\n<p>The resource for this still is</p>\n\n<pre><code> http://localhost:80/MyAssembly;component/folder/image1.png.\n</code></pre>\n"},{"tags":["wpf","datatemplate","routed-commands","wpf-commands"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":10208057,"title":"Programmatically wire event handler of a control in a datatemplate","body":"<p>I have clickable image/rectangle controls throughout my application and prefer to wire them in code:</p>\n\n<pre><code>clickableimagecontrol.MouseUp += MouseUp_Handler\n</code></pre>\n\n<p>I am struggling to understand how to do the same with datatemplates. I basically need to find the spot where the template is applied to each item, so I can insert my hooks.</p>\n\n<p>I know WPF recommends using Commands of some type, but that requires more boiler-plate code, not to mention that image/rectangles don't support commands so I'd have to redo the whole thing with styled button controls instead.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["wpf","excel","styles","vsto","windows-installer"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13159722,"title":"VSTO Office (Excel) Add-In - WPF XAML Style, ResourceDictionary","body":"<p>I want to deploy my VSTO Office Excel-Add-In with the Windows Installer.\nI created the Installer and installed the Add-In on a Virtual PC, to test it.\nNow i have the Problem, that the Styles not working, but if i debug or run it in Visual Studio it does work.</p>\n\n<p>For example, i created a Style like this:</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type Button}\"&gt;\n     &lt;Style.Setters&gt;\n        &lt;Setter Property=\"Background\" Value=\"Snow\" /&gt;\n        &lt;Setter Property=\"Width\" Value=\"50\" /&gt;\n        &lt;Setter Property=\"Height\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5\" /&gt;\n     &lt;/Style.Setters&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Now i merge the ResourceDictionary (with the style in it) with the ResourceDictionary of the Window:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n      &lt;ResourceDictionary&gt;\n         &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"/assembly;component/UI/Resources/Style.xaml\" /&gt;\n         &lt;/ResourceDictionary.MergedDictionaries&gt;\n      &lt;/ResourceDictionary&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>It does only works after the Setup, when i use Keys for the Styles and set the Style directly to the Control.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13170620,"title":"Can i set the window border color in WPF?","body":"<p>May i know how to set the window style or color? The image below is my WPF\n<img src=\"http://i.stack.imgur.com/iq0xc.jpg\" alt=\"enter image description here\"></p>\n\n<p>I want to set my window become something like the app below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/43N63.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks.</p>\n"},{"tags":["wpf","performance"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":11575142,"title":"WPF Application takes too much CPU for some users","body":"<p>I have a WPF application written in VS2010 Express for .Net 4. Some testers report that the application takes alot of CPU (~80%-100%) whenever the application window is visible and 0% when not visible. This is not the case on my computer, nor on the other computers i have tested. What I see is that it takes a bunch of CPU for the first few seconds after opening the window, but then goes down to a few percent.</p>\n\n<p>My suspicion is that this is an issue with the rendering of the WPF window. But i can not understand why it only occurs for some users. </p>\n\n<p>I understand that this is not much to go on, but if anyone have an idea where to start looking for the cause of this performance issue, it would be much appreciated.  </p>\n\n<p>Thank you!</p>\n"},{"tags":["c#",".net","wpf","wpf-controls","contextmenu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13172324,"title":"Get Contextmenu's Parent Control. WPF app","body":"<p>I have a ComboBox control inside Context menu for some Label Control that I have added in Code behind in wpf application.  There are many Labels on the page that have Contextmenu. Basically it is like this <strong>LABEL contains ContextMenu</strong> and <strong>ContextMenu conntains Combobox</strong>. On Combobox's SelectionChanged event I want to know which label's contextmenu's Combobox has generated this event?  </p>\n"},{"tags":["wpf","panel","itemscontrol","itemssource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13117220,"title":"Custom Panel InternalChildren order differs from bound ItemsSource","body":"<p>I'm writing a custom ItemsControl and Panel that arranges items vertically in the order in which they were added to the ItemsSource bound to the ItemsControl.  <strong>Note that this is just a prototype of the final Panel, whose arrangement will be a bit more complex.  As such I'm not interested in alternate Panel suggestions.</strong></p>\n\n<p>The ItemsControl trickle-feeds the Panel items from the bound collection, so items in the collection don't all appear \"simultaneously\" (the Panel raises an event to say it is ready, which the ItemsControl captures to release the next item).  The problem is that for some reason the ArrangeOverride on the Panel sometimes decides items should be added in the middle of the already rendered visuals, causing things to jump around.</p>\n\n<p>At the moment I'm simply clicking an Add button on my test view to add items to the end of the bound ItemsSource collection.  So items can be added/removed from the bound collection while this trickle feeding is happening.  By the time the Panel renders these \"new\" items, they are being added in seemingly random locations.</p>\n\n<p>I've got <code>Trace.Write</code>s all over the code so that I can see that the items are successfully added to the end of the collection, and to confirm that the InternalChildren are being randomly inserted in the middle.  I even went as far as implementing a CollectionViewSource to enforce order on the items.  Even then the InternalChildren was giving a different order to the underlying ItemsSource.</p>\n\n<p>The only thing I can think of is that somehow adding items during the trickle-feeding is causing some sort of race condition, but it's all on the UI thread and I still can't understand why the order would be  correct on the ItemsControl but not on the Panel.</p>\n\n<p>How can I synchronise the order of the InternalChildren on the Panel with the bound ItemsControl so that the Visuals are displayed in the correct order?</p>\n\n<p><strong>Update</strong></p>\n\n<p>As requested, here's some code.  There's a lot of it in the full solution so I'll try to only post the relevant bits here.  As such this code won't run, but it should give you an idea.  I've removed all the <code>Trace.WriteLine</code> code, and a lot of the additional code I don't think is important for solving the problem at hand.</p>\n\n<p>I have a <code>StaggeredReleaseCollection&lt;T&gt;</code> which extends <code>ObservableCollection&lt;T&gt;</code>.  Items added to the collection are held in a seperate \"HeldItems\" collection until they are ready to be moved into the inherited \"Items\" collection by way of a \"Kick\" method (on <code>IFlushableCollection</code>).</p>\n\n<pre><code>public class StaggeredReleaseCollection&lt;T&gt; : ObservableCollection&lt;T&gt;, IFlushableCollection\n    {\n        public event EventHandler&lt;PreviewEventArgs&gt; PreviewKick;\n        public event EventHandler HeldItemsEmptied;\n\n        ExtendedObservableCollection&lt;T&gt; _heldItems;\n        ReadOnlyObservableCollection&lt;T&gt; _readOnlyHeldItems;\n\n        public StaggeredReleaseCollection()\n        {\n            //Initialise data\n            _heldItems = new ExtendedObservableCollection&lt;T&gt;();\n            _readOnlyHeldItems = new ReadOnlyObservableCollection&lt;T&gt;(_heldItems);\n\n            _heldItems.CollectionChanged += (s, e) =&gt;\n            {\n                //Check if held items is being emptied\n                if (e.Action == NotifyCollectionChangedAction.Remove &amp;&amp; !_heldItems.Any())\n                {\n                    //Raise event if required\n                    if (HeldItemsEmptied != null) HeldItemsEmptied(this, new EventArgs());\n                }\n            };\n        }\n\n        /// &lt;summary&gt;\n        /// Kick's the first held item into the Items collection (if there is one)\n        /// &lt;/summary&gt;\n        public void Kick()\n        {\n            if (_heldItems.Any())\n            {\n                //Fire preview event\n                if (PreviewKick != null)\n                {\n                    PreviewEventArgs args = new PreviewEventArgs();\n                    PreviewKick(this, args);\n                    if (args.IsHandled) return;\n                }\n\n                //Move held item to Items\n                T item = _heldItems[0];\n                _heldItems.RemoveAt(0);\n                Items.Add(item);\n\n                //Notify that an item was added\n                OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, item));\n            }\n        }\n    }\n</code></pre>\n\n<p>I also have a <code>VerticalStackFlushPanel</code> which is the prototype Panel I'm building.  This Panel should lay all the items vertically down it's surface.  When an item is added, a Phase1 animation begins.  When this is complete an event is raised so that the next item can be added.</p>\n\n<pre><code>public class VerticalStackFlushPanel : FlushPanel\n{\n    /// &lt;summary&gt;\n    /// Layout vertically\n    /// &lt;/summary&gt;\n    protected override Size MeasureOverride(Size availableSize)\n    {\n        Size desiredSize = new Size();\n        for (int i = 0; i &lt; InternalChildren.Count; i++)\n        {\n            UIElement uie = InternalChildren[i];\n            uie.Measure(availableSize);\n            desiredSize.Height += uie.DesiredSize.Height;\n        }\n        return desiredSize;\n    }\n\n    /// &lt;summary&gt;\n    /// Arrange the child elements to their final position\n    /// &lt;/summary&gt;\n    protected override Size ArrangeOverride(Size finalSize)\n    {\n        double top = 0d;\n        for (int i = 0; i &lt; InternalChildren.Count; i++)\n        {\n            UIElement uie = InternalChildren[i];\n            uie.Arrange(new Rect(0D, top, finalSize.Width, uie.DesiredSize.Height));\n            top += uie.DesiredSize.Height;\n        }\n        return finalSize;\n    }\n\n    public override void BeginPhase1Animation(DependencyObject visualAdded)\n    {\n        //Generate animation\n        var da = new DoubleAnimation()\n        {\n            From = 0d,\n            To = 1d,\n            Duration = new Duration(TimeSpan.FromSeconds(1)),\n        };\n\n        //Attach completion handler\n        AttachPhase1AnimationCompletionHander(visualAdded, da);\n\n        //Start animation\n        (visualAdded as IAnimatable).BeginAnimation(OpacityProperty, da);\n    }\n\n    public override void BeginPhase2Animation(DependencyObject visualAdded)\n    {\n        TextBlock tb = FindVisualChild&lt;TextBlock&gt;(visualAdded);\n        if (tb != null)\n        {\n            //Generate animation\n            var ca = new ColorAnimation(Colors.Red, new Duration(TimeSpan.FromSeconds(0.5)));\n            SolidColorBrush b = new SolidColorBrush(Colors.Black);\n\n            //Set foreground\n            tb.Foreground = b;\n\n            //Start animation\n            b.BeginAnimation(SolidColorBrush.ColorProperty, ca);\n\n            //Generate second animation\n            AnimateTransformations(tb);\n        }\n    }\n}\n</code></pre>\n\n<p>The abstract <code>FlushPanel</code> on which <code>VerticalStackFlushPanel</code> is based handles the raising of the Phase 1 animation event.  For some reason, OnVisualChildrenChanged doesn't fire during the Kick() method the <code>StaggeredReleaseCollection</code> unless I explicitly raise the OnCollectionChanged event myself (maybe that's a red flag?).</p>\n\n<pre><code>public abstract class FlushPanel : Panel\n{\n\n    /// &lt;summary&gt;\n    /// An event that is fired when phase 1 of an animation is complete\n    /// &lt;/summary&gt;\n    public event EventHandler&lt;EventArgs&lt;object&gt;&gt; ItemAnimationPhase1Complete;\n\n    /// &lt;summary&gt;\n    /// Invoked when the &lt;see cref=\"T:System.Windows.Media.VisualCollection\"/&gt; of a visual object is modified.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"visualAdded\"&gt;The &lt;see cref=\"T:System.Windows.Media.Visual\"/&gt; that was added to the collection.&lt;/param&gt;\n    /// &lt;param name=\"visualRemoved\"&gt;The &lt;see cref=\"T:System.Windows.Media.Visual\"/&gt; that was removed from the collection.&lt;/param&gt;\n    protected override void OnVisualChildrenChanged(DependencyObject visualAdded, DependencyObject visualRemoved)\n    {\n        base.OnVisualChildrenChanged(visualAdded, visualRemoved);\n\n        if (visualAdded != null &amp;&amp; visualAdded is IAnimatable) BeginPhase1Animation(visualAdded);\n    }\n\n    /// &lt;summary&gt;\n    /// Begin an animation for Phase 1.  Use &lt;seealso cref=\"AttachPhase1AnimationCompletionHander\"/&gt; to attach the completed event handler before the animation is started.\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;An animation that can be used to determine Phase 1 animation is complete&lt;/returns&gt;\n    public abstract void BeginPhase1Animation(DependencyObject visualAdded);\n\n    /// &lt;summary&gt;\n    /// Generate an animation for Phase 2\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;An animation that can be used to determine Phase 2 animation is complete&lt;/returns&gt;\n    public abstract void BeginPhase2Animation(DependencyObject visualAdded);\n\n    /// &lt;summary&gt;\n    /// Attaches an animation completion handler for the Phase 1 Animation that fires an event when the animation is complete.\n    /// &lt;/summary&gt;\n    /// &lt;remarks&gt;\n    /// This event is for when this panel is used on the &lt;see cref=\"StaggeredReleaseItemsControl\"/&gt;, which uses it to kick the next item onto the panel.\n    /// &lt;/remarks&gt;\n    public void AttachPhase1AnimationCompletionHander(DependencyObject visualAdded, AnimationTimeline animation)\n    {\n        if (animation != null) animation.Completed += (s, e) =&gt;\n        {\n            //Raise event\n            if (ItemAnimationPhase1Complete != null) ItemAnimationPhase1Complete(this, new EventArgs&lt;object&gt;(visualAdded));\n\n            //Start next phase\n            BeginPhase2Animation(visualAdded);\n        };\n    }\n}\n</code></pre>\n\n<p>The <code>StaggeredReleaseItemsControl</code> knows how to handle <code>IFlushableCollection</code> and <code>FlushPanel</code> (which <code>StaggeredReleaseCollection&lt;T&gt;</code> and <code>VerticalStackFlushPanel</code> are based on).  If it finds instances of these at runtime, it coordinates kicking items from the <code>StaggeredReleaseCollection&lt;T&gt;</code> into the <code>VerticalStackFlushPanel</code>, waits for the Phase1 animation to complete, then kicks the next item etc.</p>\n\n<p>It usually prevents new items from being kicked before the end of a Phase1 animation, however I've disabled that part to speed up testing.</p>\n\n<pre><code>public class StaggeredReleaseItemsControl : ItemsControl\n{\n    FlushPanel _flushPanel;\n    IFlushableCollection _collection;\n\n    /// &lt;summary&gt;\n    /// A flag to track when a Phase 1 animation is underway, to prevent kicking new items\n    /// &lt;/summary&gt;\n    bool _isItemAnimationPhase1InProgress;\n\n    static StaggeredReleaseItemsControl()\n    {\n        DefaultStyleKeyProperty.OverrideMetadata(typeof(StaggeredReleaseItemsControl), new FrameworkPropertyMetadata(typeof(StaggeredReleaseItemsControl)));\n    }\n\n    public override void OnApplyTemplate()\n    {\n        _flushPanel = FindVisualChild&lt;FlushPanel&gt;(this);\n        if (_flushPanel != null)\n        {\n            //Capture when Phase 1 animation is completed\n            _flushPanel.ItemAnimationPhase1Complete += (s, e) =&gt;\n            {\n                _isItemAnimationPhase1InProgress = false;\n\n                //Kick collection so next item falls out (and starts it's own Phase 1 animation)\n                if (_collection != null) _collection.Kick();\n            };\n        }\n        base.OnApplyTemplate();\n    }\n\n    protected override void OnItemsSourceChanged(System.Collections.IEnumerable oldValue, System.Collections.IEnumerable newValue)\n    {\n        base.OnItemsSourceChanged(oldValue, newValue);\n\n        //Grab reference to collection\n        if (newValue is IFlushableCollection)\n        {\n            //Grab collection\n            _collection = newValue as IFlushableCollection;\n\n            if (_collection != null)\n            {\n                //NOTE:\n                //Commented out to speed up testing\n                ////Capture preview kick event\n                //_collection.PreviewKick += (s, e) =&gt;\n                //{\n                //    if (e.IsHandled) return;\n\n                //    //Swallow Kick if there is already a Phase 1 animation in progress\n                //    e.IsHandled = _isItemAnimationPhase1InProgress;\n\n                //    //Set flag\n                //    _isItemAnimationPhase1InProgress = true;\n                //};\n\n                //Capture held items empty event\n                _collection.HeldItemsEmptied += (s, e) =&gt;\n                {\n                    _isItemAnimationPhase1InProgress = false;\n                };\n\n                //Kickstart (if required)\n                if (AutoKickStart) _collection.Kick();\n\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>The <code>Generic.xaml</code> file puts together a standard template.</p>\n\n<pre><code>&lt;ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:si=\"clr-namespace:AnimatedQueueTest2010.StaggeredItemControlTest.Controls\"\n&gt;\n    &lt;!--StaggeredReleaseItemControl Style--&gt;\n    &lt;Style TargetType=\"{x:Type si:StaggeredReleaseItemsControl}\" BasedOn=\"{StaticResource {x:Type ItemsControl}}\"&gt;\n        &lt;Setter Property=\"FontSize\" Value=\"20\" /&gt;\n        &lt;Setter Property=\"ItemsPanel\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;si:VerticalStackFlushPanel/&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>My test view is fairly simple.</p>\n\n<pre><code>&lt;Window \n    x:Class=\"AnimatedQueueTest2010.StaggeredItemControlTest.Views.StaggeredItemControlTestView\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"clr-namespace:AnimatedQueueTest2010.StaggeredItemControlTest.Controls\"\n    xmlns:cm=\"clr-namespace:System.ComponentModel;assembly=WindowsBase\"\n    Title=\"StaggeredItemControlTestView\" \n    Width=\"640\" Height=\"480\" \n&gt;\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition /&gt;\n            &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n\n        &lt;local:StaggeredReleaseItemsControl x:Name=\"ic\" ItemsSource=\"{Binding ViewModel.Names}\" /&gt;\n\n        &lt;StackPanel Grid.Row=\"1\" Orientation=\"Horizontal\"&gt;\n            &lt;StackPanel.Resources&gt;\n                &lt;Style TargetType=\"Button\"&gt;\n                    &lt;Setter Property=\"MinWidth\" Value=\"80\"/&gt;\n                    &lt;Setter Property=\"MinHeight\" Value=\"20\"/&gt;\n                &lt;/Style&gt;\n            &lt;/StackPanel.Resources&gt;\n            &lt;Button x:Name=\"btnKick\" Content=\"Kick\" Click=\"btnKick_Click\"/&gt;\n            &lt;Button x:Name=\"btnAdd\" Content=\"Add\" Click=\"btnAdd_Click\"/&gt;\n        &lt;/StackPanel&gt;\n\n    &lt;/Grid&gt;\n\n&lt;/Window&gt;\n</code></pre>\n\n<p>My ViewModel defines the initial state.</p>\n\n<pre><code>public class StaggeredItemControlTestViewModel : INotifyPropertyChanged\n{\n    public StaggeredReleaseCollection&lt;string&gt; Names { get; set; }\n\n    public StaggeredItemControlTestViewModel()\n    {\n        Names = new StaggeredReleaseCollection&lt;string&gt;() { \"Carl\", \"Chris\", \"Sam\", \"Erin\" };\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n}\n</code></pre>\n\n<p>And the code behind is for me to interact with it.</p>\n\n<pre><code>public partial class StaggeredItemControlTestView : Window\n{\n    List&lt;string&gt; GenesisPeople = new List&lt;string&gt;() { \"Rob\", \"Mike\", \"Cate\", \"Andrew\", \"Dave\", \"Janet\", \"Julie\" };\n    Random random = new Random((int)(DateTime.Now.Ticks % int.MaxValue));\n\n    public StaggeredItemControlTestViewModel ViewModel { get; set; }\n\n    public StaggeredItemControlTestView()\n    {\n        InitializeComponent();\n        ViewModel = new StaggeredItemControlTestViewModel();\n        DataContext = this;\n    }\n\n    private void btnKick_Click(object sender, RoutedEventArgs e)\n    {\n        ViewModel.Names.Kick();\n    }\n\n    private void btnAdd_Click(object sender, RoutedEventArgs e)\n    {\n        //Get a random name\n        //NOTE: Use a new string here to ensure it's not reusing the same object pointer\n        string nextName = new string(GenesisPeople[random.Next(GenesisPeople.Count)].ToCharArray());\n\n        //Add to ViewModel\n        ViewModel.Names.Add(nextName);\n    }\n}\n</code></pre>\n\n<p>As it runs, I click the \"Add\" button several times, then the \"Kick\" button several times, and so on.  As I said before, the collections are being trickle-fed the items in the correct order.  However during the <code>ArrangeOveride</code>, the InternalChildren collection occasionally reports newly added items as being in the middle of the collection instead of the end.  Given that items are only added one at a time normally, I can't understand why this is the case.</p>\n\n<p>Why is InternalChildren on the Panel showing a different order to the bound <code>StaggeredReleaseCollection&lt;T&gt;</code>?</p>\n"},{"tags":["wpf","mvvm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13173133,"title":"WPF how to include resource","body":"<p>So as I was reading how to use a MVVM design in my project looking into a sample-MVVM-concept project I found this:</p>\n\n<pre><code>&lt;Window x:Class=\"MVVMDemo.UserRegistrationView\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:viewmodel=\"clr-namespace:MVVMDemo\"\nTitle=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n&lt;Window.Resources&gt;\n    &lt;viewmodel:ViewModel x:Key=\"ViewModel\"/&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid DataContext=\"{Binding Source={StaticResource ViewModel}}\"&gt;\n</code></pre>\n\n<p>I create a new project add this:</p>\n\n<pre><code>    xmlns:viewmodel=\"clr-namespace:MVVMDemo\"\nTitle=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n&lt;Window.Resources&gt;\n    &lt;viewmodel:ViewModel x:Key=\"ViewModel\"/&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>and \"DataContext=\"{Binding Source={StaticResource ViewModel}}\"\" to the Grid clause.</p>\n\n<p>But I get strange errors. What is the problem? How do I fix it?</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13172391,"title":"exception in wpf project that use AxControlls","body":"<p>I wrote wpf Browser Application and I use AxControls. In AxControlls , set codes for lomp is on or off. in wpf project I open serial port and enable Dtr and etc!! but in run time when breakpoint arrives to this line , gives exception. this is:\n\"Request for the permission of type 'System.Security.Permissions.SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.\"</p>\n\n<p><img src=\"http://i.stack.imgur.com/xtUW3.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","data-binding","sql-server-ce","objectdataprovider"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13171141,"title":"SQL Server CE - Data Source Path Misdirection by ObjectDataProvider","body":"<p>I am a newbie to C# database programming, and now implementing a simple database insert record program following this <a href=\"http://www.codeproject.com/Articles/30905/WPF-DataGrid-Practical-Examples\" rel=\"nofollow\">tutorial</a>. When I follow the tutorial, binding the DataGrid.ItemSource directly to the MainWindow's DataContext and setting the DataContext to the DataSet's DefaultView in the code behind, it works just fine. </p>\n\n<p>However, when I try to step it up and create a DataProvider, bind it with the MainWindow through ObjectDataProvider, it gives me the SqlCeException on the ObjectDataProvider saying \"<strong>The database file cannot be found. Check the path to the database. [ Data Source = C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\GuestInfo.sdf ]</strong>\" Apparently, the ObjectDataProvider cause the connection to look for the data source elsewhere rather than in my project. (My project and the GuestInfo.sdf is in drive F:) How can I direct the DataProvider to the right Data Source?</p>\n\n<p>Ps. Setting the connection string in app.config has no effect on this whatsoever, and I decided to delete it from my project. </p>\n\n<p>Working Code:\n(MainWindow.xaml.cs)</p>\n\n<pre><code>    private GuestInfoDataSet dataset;\n    private GuestTableAdapter adapter;\n\n    public MainWindow()\n    {\n        InitializeComponent();\n\n        dataset = new GuestInfoDataSet();\n        adapter = new GuestTableAdapter();\n        adapter.Fill(dataset.Guest);\n        this.DataContext = dataset.Guest.DefaultView;\n    }\n</code></pre>\n\n<p>(MainWindow.xaml)</p>\n\n<pre><code>&lt;Window x:Class=\"GuestInfoInput.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"clr-namespace:GuestInfoInput\"\n    Title=\"MainWindow\" Height=\"600\" Width=\"800\"&gt;\n    &lt;Grid&gt;\n        &lt;DataGrid Name=\"dataGrid\" ItemsSource=\"{Binding}\"&gt;&lt;/DataGrid&gt;\n     &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Not working code:\n(GuestDataProvider.cs)</p>\n\n<pre><code>    private GuestInfoDataSet dataset;\n    private GuestTableAdapter adapter;\n\n    public GuestDataProvider()\n    {\n        dataset = new GuestInfoDataSet();\n        adapter = new GuestTableAdapter();\n        adapter.Fill(dataset.Guest);\n    }\n\n    public DataView GetGuests()\n    {\n        return dataset.Guest.DefaultView;\n    }\n</code></pre>\n\n<p>(MainWindow.xaml)</p>\n\n<pre><code>&lt;Window x:Class=\"GuestInfoInput.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"clr-namespace:GuestInfoInput\"\n    Title=\"MainWindow\" Height=\"600\" Width=\"800\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;ObjectDataProvider x:Key=\"GuestDataProvider\"\n                        ObjectType=\"{x:Type local:GuestDataProvider}\"/&gt;\n        &lt;ObjectDataProvider x:Key=\"Guests\" \n                        ObjectInstance=\"GuestDataProvider\"\n                        MethodName=\"GetGuests\"/&gt;\n    &lt;/Window.Resources&gt;\n    &lt;Grid DataContext=\"{Binding Source={StaticResource Guests}}\"&gt;\n        &lt;DataGrid Name=\"dataGrid\" ItemsSource=\"{Binding}\"&gt;&lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Note: SqlCeException was thrown from the first ObjectDataProvider.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The problem is CERTAINLY with ObjectDataProvider since I tried using the GuestDataProvider directly in the MainWindow.xaml.cs and it works just fine!</p>\n\n<p>Working Code (ver 2):\n(MainWindow.xaml.cs)</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n        GuestDataProvider db = new GuestDataProvider();\n        this.dataGrid.ItemsSource = db.GetGuests();\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","prism","mef"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13144048,"title":"Handling exceptions in Prism 4 modules","body":"<p>I've gone through a number of threads here about this topic with no success. It seems that in the App.xaml.cs of our WPF application, handling DispatcherUnhandledExceptions and AppDomain.CurrentDomain.UnhandledException don't catch everything.</p>\n\n<p>In this specific instance we have 7 prism modules. My exception handling code is below (almost identical for UnhandledException):</p>\n\n<pre><code>private void OnDispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)\n    {\n        try\n        {\n            var ex = e.Exception.InnerException ?? e.Exception;\n            var logManager = new LogManager();\n            logManager.Error(ex);\n\n\n            if (!EventLog.SourceExists(ex.Source))\n                EventLog.CreateEventSource(ex.Source, \"AppName\");\n            EventLog.WriteEntry(ex.Source, ex.InnerException.ToString());\n\n            var emb = new ExceptionMessageBox(ex);\n            emb.ShowDialog();\n            e.Handled = true;\n\n        }\n        catch (Exception)\n        { }\n    }\n</code></pre>\n\n<p><strong>The problem seems to be the unhandled exceptions occurring in the modules.</strong> \nThey aren't caught by the code above and they cause the application to crash without logging or displaying any sort of message.</p>\n\n<p>Does anyone have experience with this?</p>\n"},{"tags":["wpf","xaml","mvvm","routed-commands"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":11354282,"title":"How to get a RoutedCommand to a new ViewModel?","body":"<p>I have a relatively straightforward hierarchical data master-detail WPF window, developed using MVVM, where the Window points to a ViewModel which exposes as one of its properties the ViewModel for the detail view:</p>\n\n<pre><code>Public Class MasterViewModel\nInherits ViewModelBase ' Contains an implementation of CommandSink\nPrivate WithEvents _ViewerSelection As DetailViewModel\nPublic Property ViewerSelection As DetailViewModel\n    Set(value As DetailViewModel)\n        _ViewerSelection = value\n        RaisePropertyChanged(\"ViewerSelection\")\n    End Set\n    Get\n        Return _ViewerSelection\n    End Get\nEnd Property\n</code></pre>\n\n<p><code>ViewModelBase</code> contains an implementation of Josh Smith's <a href=\"http://www.codeproject.com/Articles/28093/Using-RoutedCommands-with-a-ViewModel-in-WPF\" rel=\"nofollow\">VMCommanding</a> code, which I ported to Visual Basic using the Roslyn stuff. </p>\n\n<p>The XAML for the Window looks basically like this, with irrelevant details and a lot of closing brackets ommitted. </p>\n\n<p>Selecting an item in the \"Master\" <code>ListBox</code> sets the <code>DataContext</code> of the \"Detail\" <code>ListBox</code> to a corresponding DetailViewModel. Selecting a second item in that list box changes the <code>DataContext</code> of the \"Detail\" box to the corresponding DetailViewModel of the selection. For performance reasons, once selected, the DetailViewModel is retained and switched in and out of the <code>DataContext</code> of the \"Detail\" box. </p>\n\n<p>Selecting an item in the \"Detail\" <code>ListBox</code> triggers a RoutedCommand which is supposed to be caught by the ViewModel selected in the \"Master\" box. However, the <code>RoutedCommand</code>s never change their focus to the correct DetailViewModel; the command is always caught by the DetailViewModel corresponding to the first \"Master\" ListBox selection. </p>\n\n<p>What do I need to do differently? </p>\n\n<pre><code>&lt;dx:DXWindow \nxmlns:i=\"clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity\" \nxmlns:local=\"clr-namespace:MyProject\" \nTitle=\"{Binding ProjectTitle}\" \nlocal:CommandSinkBinding.CommandSink=\"{Binding}\"&gt;\n&lt;dx:DXWindow.Resources&gt;\n         &lt;local:MasterViewModel x:Key=\"MViewM\"/&gt;\n&lt;/dx:DXWindow.Resources&gt;\n&lt;dx:DXWindow.DataContext&gt;\n    &lt;Binding Source=\"{StaticResource MViewM}\" /&gt;\n&lt;/dx:DXWindow.DataContext&gt;\n&lt;Grid&gt;\n        &lt;ListBox ItemsSource=\"{Binding MasterListBox}\"&gt;\n        &lt;-- Selecting an item in the top list box causes a change to the DataContext\n        &lt;ListBox ItemTemplate=\"{StaticResource MaterialDataTemplate}\" \n                Name=\"DetailListBox\" \n                DataContext=\"{Binding ViewerSelection}\" \n                ItemsSource=\"{Binding Materials}\" \n                local:CommandSinkBinding.CommandSink=\"{Binding}\" \n                SelectionMode=\"Multiple\"&gt;\n            &lt;ListBox.CommandBindings&gt;\n                &lt;local:CommandSinkBinding  Command=\"local:DetailVM.Filter\"/&gt;\n            &lt;/ListBox.CommandBindings&gt;\n            &lt;i:Interaction.Triggers&gt;\n                &lt;i:EventTrigger EventName=\"SelectionChanged\"&gt;\n                    &lt;i:InvokeCommandAction Command=\"local:DetailVM.Filter\" CommandParameter=\"{Binding ElementName=DetailListBox, Path=SelectedItems}\"/&gt;\n                &lt;/i:EventTrigger&gt;\n            &lt;/i:Interaction.Triggers&gt;\n        &lt;/ListBox&gt;\n</code></pre>\n"},{"tags":["c#","wpf","datagrid","wpfdatagrid","stackpanel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13168067,"title":"How to anchor a wpf data grid which is inside a stack panel a fixed distance from the main window's four corners","body":"<p>I have the following wpf layout given to me by my employer. It makes use of multiple nested stack panels.\nI'm trying to anchor a data grid which is inside a stack panel a fixed distance away from the main window's four corners. And whenever the grid contains data of which some of it is hidden because of the parent window's size, it is supposed to display scroll bars which must disappear if not needed.</p>\n\n<hr>\n\n<p>I set the data grid's and the stack panel's width to Auto so that it  fills the width and that makes the horizontal and vertical scroll    bars behave as i want them to. BUT the grid doesn't have the required    height.</p>\n\n<hr>\n\n<p>But when i try to set the data grid's height property to auto both the horizontal and vertical scroll bars disappear resulting in hidden data.\nI tried setting the data grids height property to a fixed size and updating it whenever the window is resized but the scroll bars are still hidden how can i fix this?</p>\n\n<pre><code>&lt;UserControl x:Class=\"WpfApplication1.UserControl1\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             mc:Ignorable=\"d\" \n             d:DesignHeight=\"441\" d:DesignWidth=\"300\"&gt;\n    &lt;Grid&gt;\n        &lt;StackPanel Margin=\"0\" Name=\"stackPanel1\"&gt;\n            &lt;ListBox Height=\"100\" Name=\"listBox1\" Width=\"253\" /&gt;\n            &lt;Button Content=\"Button\" Height=\"23\" Name=\"button1\" Width=\"256\" Click=\"button1_Click\" /&gt;\n            &lt;StackPanel Name=\"stackPanel2\"&gt;\n                &lt;StackPanel Height=\"34\" Name=\"stackPanel3\" Width=\"249\" /&gt;\n                &lt;DataGrid AutoGenerateColumns=\"False\" Name=\"dataGrid1\" Height=\"282\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/StackPanel&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n\n&lt;Window\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:my=\"clr-namespace:WpfApplication1\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"WpfApplication1.MainWindow\"\n        Title=\"MainWindow\" Height=\"502\" Width=\"525\" StateChanged=\"Window_StateChanged\"&gt;\n    &lt;Grid Margin=\"0\"&gt;\n        &lt;my:UserControl1 x:Name=\"userControl11\" Loaded=\"userControl11_Loaded\" /&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf","datagrid","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13170876,"title":"Get selected value of ComboBoxColumn in Datagrid (WPF)","body":"<p>I implemented a DataGridComboBoxColumn in a Datagrid using XAML. I can access comboboxColumn1 programatically, but how can I get the selected item upon value change?</p>\n\n<pre><code> &lt;DataGrid x:Name=\"dgData\" AutoGenerateColumns=\"False\" Margin=\"131,93,13,101\" Grid.Column=\"1\" SelectionChanged=\"dgData_SelectionChanged\"&gt;\n       &lt;DataGrid.Columns&gt;\n\n            &lt;DataGridComboBoxColumn Header=\"Subject\" x:Name=\"comboboxColumn1\"/&gt;\n\n       &lt;/DataGrid.Columns&gt;\n &lt;/DataGrid&gt;\n</code></pre>\n"},{"tags":["c#","wpf","winforms","stathread"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3103,"score":4,"question_id":216634,"title":"WPF with Windows Forms - STAThread","body":"<p>I am a newbie to WPF and have a couple of questions about WPF and Windows Forms integration.</p>\n\n<p>I have an existing  Visual C#  Windows Forms application. I would like to integrate it with a WPF window, that can be shown on a button click. This was not possible as WPF expects the calling thread  to be a STAThread and by default WinForm assumes that the thread is an MTAThread. I tried spawning a new thread with an apartment state of STAThread for calling the WPF UI but that did not work. I tried using the Dispatcher.BeginInvoke method and Background Worker  as well, but none of them resolved the issue.</p>\n\n<p>1) Can we make a call to WPF window/control without marking the Main as an STAThread? If it is possible, Can anyone please point me to a proper direction? \n2) If the only way to accomplish this is by making the Main Thread an STAThread, will there be any impact to the general performance/responsiveness of the application.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13170842,"title":"WPF Window minimize / maximize behavior not consistent","body":"<p>I am dabbling in WPF for the first time and decided I wanted to create a basic application to run in the system tray. I added a winforms NotifyIcon and am able to minimize to the tray and hide the window, so that all is working fine.</p>\n\n<p>Here is where things get weird.</p>\n\n<p>I decided to hide the application from the task bar at all times and to show the notifyicon in the system tray at all times. I added click event handlers so that clicking the notifyicon when the window was up would cause it to hide, and then clicking when it was down would cause it to display, pretty standard stuff.</p>\n\n<p>Lastly, the window starts off minimized to the tray.</p>\n\n<p>So, I start my application and all i have is a system tray icon. I click it, and the window displays as you'd expect. I click the notifyicon again and the window disappears, again just as you'd suspect. I click it a third time and instead of my window popping up, I get just the title bar (icon in the upper left, minimize / close buttons etc in the upper right) in the lower left corner. I believe this is the \"collapsed\" behavior. The last thing that makes this weird is that I am using WindowLayout = none so my window doesnt even have a title bar.. and yet one shows up in the lower left corner. </p>\n\n<p>If I click a 4th time, the bar disappears. And so on.</p>\n\n<p>So the hiding / displaying is working the first time and after that it goes weird. </p>\n\n<p>Really scratching my head on this one. Anybody seen anything like this or have any suggestions?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/12088892/impossible-to-restore-application-hidden-programmatically\">Impossible to restore application hidden programmatically</a>\nThis dude explains almost exactly the behavior I am seeing but unfortunately he didnt have his question answered.</p>\n\n<p>Here is the XAML:</p>\n\n<pre><code>    &lt;Window x:Class=\"Tagalong.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Tagalong Beta .1\" Height=\"350\" Width=\"500\" Icon=\"content/tagalong_icon.ico\"     \n    ResizeMode=\"CanMinimize\" Topmost=\"True\"\n    WindowStyle=\"None\" Background=\"Transparent\" AllowsTransparency=\"True\" ShowInTaskbar=\"false\" &gt;\n    &lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\" /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"250\"  /&gt;\n        &lt;ColumnDefinition Width=\"250\" /&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Border Name=\"LeftPane\" Grid.Row=\"0\" Grid.Column=\"0\" BorderBrush=\"Black\"\n    BorderThickness=\"1.5\" Height=\"350\" Width=\"250\" CornerRadius=\"10\"  Background=\"Blue\" &gt;\n        &lt;Grid&gt;\n        &lt;/Grid&gt;\n    &lt;/Border&gt;\n    &lt;Border Name=\"RightPane\" BorderBrush=\"Black\" Grid.Row=\"0\" Grid.Column=\"1\"  \n    BorderThickness=\"1.5\" Height=\"350\" Width=\"250\" CornerRadius=\"10\" Background=\"Green\"&gt;\n        &lt;Grid&gt;\n        &lt;/Grid&gt;\n    &lt;/Border&gt;\n    &lt;/Grid&gt;\n    &lt;/Window&gt;\n</code></pre>\n\n<p>Here is the C#:</p>\n\n<pre><code>    void InitializeSystemTrayOptions()\n    {\n        notifyIcon = new NotifyIcon();\n        notifyIcon.Icon = new System.Drawing.Icon(@\"C:\\dev\\desktop\\Tagalong\\Tagalong\\tagalong_icon.ico\");\n\n        notifyIcon.MouseClick += new System.Windows.Forms.MouseEventHandler(notifyIcon_MouseClick);\n\n        notifyIcon.Visible = true;\n\n        this.Visibility = Visibility.Hidden; \n        this.WindowState = WindowState.Minimized;\n    }\n\n\n    void notifyIcon_MouseClick(object sender, System.Windows.Forms.MouseEventArgs e)\n    {\n        if (e.Button == MouseButtons.Left)\n        {\n            if (this.WindowState == WindowState.Normal)\n            {\n                this.WindowState = WindowState.Minimized;\n                this.Visibility = Visibility.Hidden;\n            }\n            else if (this.WindowState == WindowState.Minimized)\n            {\n                this.WindowState = WindowState.Normal;\n                this.Visibility = Visibility.Visible;\n            }\n        }\n    }\n\n    private NotifyIcon notifyIcon;\n</code></pre>\n"},{"tags":["c#",".net","wpf","wpf-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13170578,"title":"Determine when a page has finished loading when using WebBrowser view in WPF (Windows.Controls.WebBrowser)","body":"<p>I've used the \"LoadCompleted\" event and basically once the event is received, I need to take a screenshot of the screen (which I've built). The problem is once this event goes out, the screenshot is just blank (page hasn't loaded yet) and only if I put a delay of 5-10 seconds, the screenshot will work</p>\n\n<p>Now how can I determine when the webpage is fully rendered? That all the aspects are loaded and so on</p>\n"},{"tags":["c#","wpf","datatable","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13151419,"title":"How to add a checkbox beside the rows in datatable to be able to select each row","body":"<p>I use the SqlCeDataAdapter to fill the table data. But after that I want to add checkboxes for users to select certain rows, then get the list of the primary keys and do certain operations. I can't seem to figure out how to do it</p>\n\n<p>I'm using windows forms (WPF) and I'm using DataGridView to display the DataTable. .NetFramework 4.0</p>\n"},{"tags":["c#","transformation","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13169442,"title":"Helix scale based mesh parenting using Transform3DGroup","body":"<p>I am using <a href=\"https://helixtoolkit.codeplex.com/\" rel=\"nofollow\">https://helixtoolkit.codeplex.com/</a> as a 3D framework.</p>\n\n<p>I want to move <strong>black mesh</strong> relative to the <strong>green mesh</strong> as shown in the attached image below. I want to make green mesh parent to the black mesh as the change in scale of the green mesh also will result in motion of the black mesh. It could be partial parenting or may be more. I need 3D rotation and 3D transition + transition along green mesh's length axis for the black mesh relative to the green mesh itself.</p>\n\n<p>Suppose a variable <code>green_mesh_scale</code> causing scale for the green mesh along its length axis. The black mesh will use that variable in order to move along green mesh's length axis.</p>\n\n<p>How to go about it.</p>\n\n<p>I've done as follows:</p>\n\n<pre><code>GeometryModel3D GreenMesh, BlackMesh;\n...\n\ndouble green_mesh_scale = e.NewValue;\n\nTransform3DGroup forGreen = new Transform3DGroup();\nTransform3DGroup forBlack = new Transform3DGroup();\n\nforGreen.Children.Add(new ScaleTransform3D(new Vector3D(1, green_mesh_scale , 1)));\n// ... transforms for rotation n transition\nGreenMesh.Transform =  forGreen ;\n\nforBlack = forGreen;\nforBlack.Children.Add(new TranslateTransform3D(new Vector3D(0, green_mesh_scale, 0)));\nBlackMesh.Transform = forBlack;   \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/LlTXF.jpg\" alt=\"Black mesh is moving relative to the change in scale of the green mesh\"></p>\n\n<p>The problem with this is the scale transform will also be applied to the black mesh. I think i just need to avoid the scale part.</p>\n\n<p>I tried keeping all the transforms but scale, on another <code>Transform3DGroup</code> variable but that also not behaving as expected.</p>\n\n<p>Can <code>MatrixTransform3D</code> be used here some how?</p>\n\n<p>Also please suggest if this question can be posted somewhere else in stackexchange.</p>\n"},{"tags":["wpf","caliburn.micro"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":164,"score":1,"question_id":10721794,"title":"Selecting multiple records in DataGrid with Caliburn.Micro","body":"<p>I have a WPF application using Caliburn.Micro. </p>\n\n<p>The DataGrid has an attribute SelectedItem=\"{Binding Path=SelectedUsageRecord}\"</p>\n\n<p>As you can see, SelectedItem is bound to SelectedUsageRecord property. But I need to be able to handle selecting multiple records. Is this possible to bind multiple records to a collection property? I don't see anything like \"SelectedItems\"...\nThanks.</p>\n"},{"tags":["wpf","datagrid","scroll","refresh","wpfdatagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13169811,"title":"WPF DataGrid - maintain scroll position after refresh","body":"<p>Anyone knows how to maintain the vertical scroll position after the Refresh command?</p>\n\n<p>My Datagrid receives binding from a List of objects.</p>\n\n<p>Many thanks, and sorry for my english.</p>\n"},{"tags":["c#","wpf","xaml","styles","togglebutton"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13168740,"title":"'[Unknown]' property does not point to a DependencyObject in path '(0).(1)[3].(2)'","body":"<p>How can I fix this exception caused by the folling style?</p>\n\n<pre><code>        &lt;Style x:Key=\"OnOffSwitchToggleButton\" TargetType=\"{x:Type ToggleButton}\"&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate TargetType=\"{x:Type ToggleButton}\"&gt;\n                        &lt;Grid Margin=\"0,0,0,-0.033\"&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition Width=\"0.456*\"/&gt;\n                                &lt;ColumnDefinition Width=\"0.544*\"/&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;VisualStateManager.VisualStateGroups&gt;\n                                &lt;VisualStateGroup x:Name=\"CommonStates\"&gt;\n                                    &lt;VisualState x:Name=\"Normal\"&gt;\n                                        &lt;Storyboard&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)\" Storyboard.TargetName=\"Switch\"&gt;\n                                                &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"0.083\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\" Storyboard.TargetName=\"path1\"&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"White\"/&gt;\n                                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                                        &lt;/Storyboard&gt;\n                                    &lt;/VisualState&gt;\n                                    &lt;VisualState x:Name=\"MouseOver\"&gt;\n                                        &lt;Storyboard&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Effect).(DropShadowEffect.Opacity)\" Storyboard.TargetName=\"path\"&gt;\n                                                &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"1\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                        &lt;/Storyboard&gt;\n                                    &lt;/VisualState&gt;\n                                    &lt;VisualState x:Name=\"Pressed\"/&gt;\n                                    &lt;VisualState x:Name=\"Disabled\"/&gt;\n                                &lt;/VisualStateGroup&gt;\n                                &lt;VisualStateGroup x:Name=\"CheckStates\"&gt;\n                                    &lt;VisualState x:Name=\"Checked\"&gt;\n                                        &lt;Storyboard&gt;\n                                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Fill).(SolidColorBrush.Color)\" Storyboard.TargetName=\"path\"&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0:0:0.2\" Value=\"#FF39B54A\"/&gt;\n                                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Shape.Stroke).(SolidColorBrush.Color)\" Storyboard.TargetName=\"path\"&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0:0:0.2\" Value=\"#FF319D40\"/&gt;\n                                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(TextElement.Foreground).(SolidColorBrush.Color)\" Storyboard.TargetName=\"label\"&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#00999999\"/&gt;\n                                                &lt;DiscreteColorKeyFrame KeyTime=\"0:0:0.2\" Value=\"#0039B54A\"/&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0:0:0.3\" Value=\"White\"/&gt;\n                                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                                            &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"(ContentControl.Content)\" Storyboard.TargetName=\"label\"&gt;\n                                                &lt;DiscreteObjectKeyFrame KeyTime=\"0:0:0.2\" Value=\"ON\"/&gt;\n                                            &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                            &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"(FrameworkElement.HorizontalAlignment)\" Storyboard.TargetName=\"Switch\"&gt;\n                                                &lt;DiscreteObjectKeyFrame KeyTime=\"0:0:0.2\" Value=\"{x:Static HorizontalAlignment.Left}\"/&gt;\n                                            &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)\" Storyboard.TargetName=\"Switch\"&gt;\n                                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"39.965\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)\" Storyboard.TargetName=\"label\"&gt;\n                                                &lt;DiscreteDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"-19.224\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                        &lt;/Storyboard&gt;\n                                    &lt;/VisualState&gt;\n                                    &lt;VisualState x:Name=\"Unchecked\"&gt;\n                                        &lt;Storyboard&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)\" Storyboard.TargetName=\"Switch\"&gt;\n                                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"0\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)\" Storyboard.TargetName=\"label\"&gt;\n                                                &lt;EasingDoubleKeyFrame KeyTime=\"0\" Value=\"0\"/&gt;\n                                                &lt;DiscreteDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"0\"/&gt;\n                                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(TextElement.Foreground).(SolidColorBrush.Color)\" Storyboard.TargetName=\"label\"&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#00999999\"/&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0:0:0.2\" Value=\"#00999999\"/&gt;\n                                                &lt;EasingColorKeyFrame KeyTime=\"0:0:0.3\" Value=\"#FF999999\"/&gt;\n                                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                                        &lt;/Storyboard&gt;\n                                    &lt;/VisualState&gt;\n                                    &lt;VisualState x:Name=\"Indeterminate\"/&gt;\n                                &lt;/VisualStateGroup&gt;\n                            &lt;/VisualStateManager.VisualStateGroups&gt;\n                            &lt;Canvas x:Name=\"_switch\" UseLayoutRounding=\"False\" Height=\"30\" Width=\"70\" d:LayoutOverrides=\"VerticalMargin\" Grid.ColumnSpan=\"2\"&gt;\n                                &lt;Canvas x:Name=\"Background\" Height=\"30\" Canvas.Left=\"0\" Canvas.Top=\"0\" Width=\"70\" RenderTransformOrigin=\"0.5,0.5\"&gt;\n                                    &lt;Canvas.RenderTransform&gt;\n                                        &lt;TransformGroup&gt;\n                                            &lt;ScaleTransform/&gt;\n                                            &lt;SkewTransform/&gt;\n                                            &lt;RotateTransform/&gt;\n                                            &lt;TranslateTransform/&gt;\n                                        &lt;/TransformGroup&gt;\n                                    &lt;/Canvas.RenderTransform&gt;\n                                    &lt;Path x:Name=\"path\" Height=\"30\" Canvas.Left=\"0\" Canvas.Top=\"0\" Width=\"70\" Data=\"F1M55.0161,-0.966799999999999L14.9831,-0.966799999999999C6.7081,-0.966799999999999,0.00010000000000332,5.7412,0.00010000000000332,14.0162C0.00010000000000332,22.2922,6.7081,29.0002,14.9831,29.0002L55.0161,29.0002C63.2911,29.0002,70.0001,22.2922,70.0001,14.0162C70.0001,5.7412,63.2911,-0.966799999999999,55.0161,-0.966799999999999\" Fill=\"#FFEDEDED\" Stretch=\"Fill\" Stroke=\"#FFCCCCCC\"&gt;\n                                        &lt;Path.Effect&gt;\n                                            &lt;DropShadowEffect ShadowDepth=\"0\" Color=\"#FF00ADEF\" Opacity=\"0\"/&gt;\n                                        &lt;/Path.Effect&gt;\n                                    &lt;/Path&gt;\n                                &lt;/Canvas&gt;\n                                &lt;Grid x:Name=\"Switch\" Height=\"22\" Canvas.Left=\"4.815\" Canvas.Top=\"3.568\" Width=\"22\" RenderTransformOrigin=\"0.5,0.5\"&gt;\n                                    &lt;Grid.RenderTransform&gt;\n                                        &lt;TransformGroup&gt;\n                                            &lt;ScaleTransform/&gt;\n                                            &lt;SkewTransform/&gt;\n                                            &lt;RotateTransform/&gt;\n                                            &lt;TranslateTransform/&gt;\n                                        &lt;/TransformGroup&gt;\n                                    &lt;/Grid.RenderTransform&gt;\n                                    &lt;Grid.Effect&gt;\n                                        &lt;DropShadowEffect BlurRadius=\"3\" ShadowDepth=\"0\" Opacity=\"0.5\"/&gt;\n                                    &lt;/Grid.Effect&gt;\n                                    &lt;Path x:Name=\"path1\" Data=\"F1M14.9614,27.0166C7.7934,27.0166,1.9614,21.1846,1.9614,14.0166C1.9614,6.8486,7.7934,1.0166,14.9614,1.0166C22.1294,1.0166,27.9614,6.8486,27.9614,14.0166C27.9614,21.1846,22.1294,27.0166,14.9614,27.0166\" Height=\"22\" Stretch=\"Fill\" Width=\"22\" Margin=\"0\" Fill=\"White\"/&gt;\n                                &lt;/Grid&gt;\n                            &lt;/Canvas&gt;\n                            &lt;Label x:Name=\"label\" Content=\"OFF\" Grid.Column=\"1\" Margin=\"-2.506,2,0,0\" HorizontalAlignment=\"Left\" Padding=\"0\" VerticalAlignment=\"Center\" FontFamily=\"Avenir 45\" FontSize=\"14.667\" Foreground=\"#FF999999\" RenderTransformOrigin=\"0.5,0.5\"&gt;\n                                &lt;Label.RenderTransform&gt;\n                                    &lt;TransformGroup&gt;\n                                        &lt;ScaleTransform/&gt;\n                                        &lt;SkewTransform/&gt;\n                                        &lt;RotateTransform/&gt;\n                                        &lt;TranslateTransform/&gt;\n                                    &lt;/TransformGroup&gt;\n                                &lt;/Label.RenderTransform&gt;\n                            &lt;/Label&gt;\n                        &lt;/Grid&gt;\n                    &lt;/ControlTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n            &lt;Setter Property=\"HorizontalAlignment\" Value=\"Left\"/&gt;\n        &lt;/Style&gt;\n</code></pre>\n\n<p>I'm applying this style to a toggle button which is inside a Grid cell:</p>\n\n<pre><code>&lt;ToggleButton Grid.Column=\"1\" IsChecked=\"{Binding Path=ObjectStatus}\" Style=\"{StaticResource ResourceKey=OnOffSwitchToggleButton}\" Margin=\"5,0,0,0\"/&gt;\n</code></pre>\n\n<p>I have another toggle button inside a devexpress GridControl and this exception does not appear.</p>\n"},{"tags":["wpf","winforms","bug","form-load"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13161947,"title":"Explain critical bug in Visual Studio 2010 and up, WinForms and WPF","body":"<p>Try putting the following code inside <code>Load</code> event handler for WinForms or <code>Loaded</code> for WPF.</p>\n\n<pre><code>Dim doc As New XmlDocument\nDim nsmgr As New XmlNamespaceManager(Nothing) 'this line throws an exception\n</code></pre>\n\n<p>Problem is that exception is not thrown, and stack corruption happens. It may have different side effects, depending on the IDE - see below.</p>\n\n<ul>\n<li>Affected IDEs are: 2008, 2010 and 2012 (those I could test). 2010 resets stack state, and returns from sub/handler, like nothing happened (but without proceeding with other statements there). 2012 may warn a user about a failed application and an attempt to run in <code>compatibility mode</code>. Next time after that it runs the same as 2010. 2008 properly throws an exception, but only on default configuration (AnyCPU). Switching platform target to x86 makes the problem reappear in 2008 as well.</li>\n<li>Affected frameworks are WinForms and WPF. Console apps and ASP.NET\nseem to work fine. .NET v2.0-4.5.</li>\n<li>Affected scope is only <code>Load</code> event so far.\nPutting this code into a button makes it work.</li>\n<li>Affected build\nconfiguration = any. Tried on default <code>Debug</code> and <code>Release</code>.</li>\n</ul>\n\n<p>Why I consider it a bug is because it can leave objects in an unstable state - they did not finish initializing, which is not an expected behavior. What's critical about it is that nobody will know it happened, as it does not throw an exception. Depending on your design, you may end up with incorrect data in your database, which in the worst case may lead to severe consequences.</p>\n\n<p>Does anyone have a good explanation to why this may be happening and if there is a workaround?</p>\n"},{"tags":[".net","wpf","printing","flowdocument"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13167473,"title":"How to print very large object in wpf","body":"<p>I need to print very large and complicated object - virtualizet in two dimension matrix what have two tables at left and top side and at the middle represent the intersections of tables.\nEach table can have more than 5000 records. So i made a control for all this things.\nIt's work pretty good. But customer wants to print it. When matrix too big for one page i should devide into peaces and print each part.</p>\n\n<p>I can devide matrix by paper size and build flowdocument for each part. But it's smells with a lot of problems. Especially that's tables has custom count of the columns, so all of the columns cannot be placed at one document.</p>\n\n<p>So, i hope that's exists any easiest way to implement this. (except print from excel)</p>\n"},{"tags":["c#","wpf","mvvm","prism"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13169390,"title":"Object Ref not set to instance by Region Manager","body":"<pre><code>&lt;Window x:Class=\"Agile_Project_Management_Tool_2012.TheShell.Shell\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:UI=\"clr-namespace:Agile_Project_Management_Tool_2012.UI_Components\" \n    xmlns:prism=\"http://www.codeplex.com/prism\"\n    xmlns:inf=\"clr-namespace:AgileProj.Infrastructure;assembly=AgileProj.Infrastructure\"\n    xmlns:behaviors=\"clr-namespace:AgileProj.Infrastructure.Behaviours;assembly=AgileProj.Infrastructure\"\n    behaviors:RegionPopupBehaviors.CreatePopupRegionWithName=\"{x:Static inf:RegionNames.PopupBoxRegion}\"\n    Title=\"Shell\" Background=\"#d2d2d2\"  WindowStyle=\"None\" Width=\"1280\" Height=\"768\" WindowStartupLocation=\"CenterScreen\" ResizeMode=\"NoResize\"&gt;\n\n&lt;DockPanel LastChildFill=\"True\"  &gt;\n\n    &lt;ItemsControl DockPanel.Dock=\"Top\"&gt;\n        &lt;UI:TitleBar /&gt;\n    &lt;/ItemsControl&gt;\n\n    &lt;ContentControl prism:RegionManager.RegionName=\"{x:Static inf:RegionNames.ContentRegion}\"&gt;\n\n    &lt;/ContentControl&gt;\n\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p></p>\n\n<p>Having an error on this line of code...\n    behaviors:RegionPopupBehaviors.CreatePopupRegionWithName=\"{x:Static inf:RegionNames.PopupBoxRegion}\"</p>\n\n<p>But i cant seem to see the issue. Is it because im not calling the 2nd setter that is a DP within the object? </p>\n\n<p>When i execute this...</p>\n\n<pre><code> private void OnCreateProjectCommand()\n    {\n\n        _regionManager.RequestNavigate(RegionNames.PopupBoxRegion, new Uri(\"/ProjectItem\", UriKind.Relative));\n       // WindowState = WindowState.Open;\n\n        //_addProjectViewModel = new AddProjectViewModel();\n        //AddProjectView view = new AddProjectView();\n        //view.Show();\n\n    }\n</code></pre>\n\n<p>It pops open the new window, but the contents is just System.object.</p>\n\n<p>Thanks for your help with this .</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":28170,"score":19,"question_id":1118496,"title":"Using Image control in WPF to display System.Drawing.Bitmap","body":"<p>How do I assign an in-memory <code>Bitmap</code> object to an <code>Image</code> control in WPF ?</p>\n"},{"tags":["wpf","datatemplate","textblock","keydown"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13169193,"title":"DataTemplate's TextBlock's KeyDown handler is not called","body":"<p>I have following data template defined:</p>\n\n<pre><code>        &lt;DataTemplate x:Key=\"hierarchicalTreeNodeTemplate\"&gt;\n            &lt;TextBlock Text=\"{Binding Name}\" \n                       MouseLeftButtonDown=\"treeViewTextBlock_MouseLeftButtonDown\" \n                       KeyDown=\"treeViewTextBlock_KeyDown\"\n                       /&gt;\n        &lt;/DataTemplate&gt;\n</code></pre>\n\n<p>This data template is used to render some of WPF TreeViewItems.\nFor some reason, the MouseLeftButtonDown handler is called as expected when user clicks on a tree item that happened to be a TextBlock, but the KeyDown handler is not called when the same item is selected and any keyboard key is pressed.\nAny ideas what could be wrong here?\nThanks.</p>\n"},{"tags":["wpf","data-binding","wpf-controls","wpf-usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13169223,"title":"WPF Binding to user control from ItemsControl","body":"<p>I have an issue that I can't find a resolution to. To demonstrate I have a test user control (TestTabControl) containing the following XAML:</p>\n\n<pre><code>   &lt;TabControl ItemsSource=\"{Binding ElementName=groupControl, Path=ItemsSource}\"&gt;\n        &lt;TabControl.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/TabControl.ItemTemplate&gt;\n        &lt;TabControl.ContentTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;StackPanel&gt;\n                    &lt;TextBlock x:Name=\"TestBlock\" Text=\"{Binding Name}\"/&gt;\n                    &lt;control:ChildControl ParentName=\"{Binding Name}\" /&gt;\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/TabControl.ContentTemplate&gt;\n    &lt;/TabControl&gt;\n</code></pre>\n\n<p>The ItemsSource property of this control is a dependency property which receives an ObservableCollection of items of this class:</p>\n\n<pre><code>public class ParentClass : ObservableObject\n{\n    private string name;\n\n    public string Name\n    {\n        get { return name; }\n        set\n        {\n            if (name == value)\n                return;\n            name = value;\n            OnPropertyChanged(this, new PropertyChangedEventArgs(\"Name\"));\n        }\n    }\n}\n</code></pre>\n\n<p>The ChildControl control referenced in the ContentTemplate of the user control is another UserControl that has a dependency property called ParentName which simply sets a TextBlock on the control.</p>\n\n<p>The result of this test project is a Tab Control which sets its TabItem headers correctly to be the Names of each instance in the ItemsSource. The TextBlock in the ContentTemplate (named TestBlock) also displays each Name correctly. But the ChildControl instances on each TabItem are only set to to the value of the first item in the collection sent to ItemsSource. </p>\n\n<p>For example, if there are 3 instances of the ParentClass with names Parent1, Parent2 and Parent3, there would be three tabs with headers of Parent1, Parent2, Parent3... but on each Tab, the value displayed by the ChildControl is Parent1 on all of the tabs.</p>\n\n<p>Can anyone shed any light on what I'm doing wrong?</p>\n"},{"tags":["wpf","treeview","datatemplate","textblock","keydown"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13168996,"title":"Processing KeyDown event on a TextBlock defined as part of a DataTemplate of a TreeeViewItem","body":"<p>I have a WPF TreeView instance. It defines HierarchicalDataTemplate as its ItemTemplate. The HierarchicalDataTemplate defines ContenTemplateSelector that in some cases returns a DataTemplate which is a TextBlock. I need to find a way to tap into the KeyDown event of the TextBlock.\nWhat is the best way of doing that?\nThanks.</p>\n"},{"tags":["c#","wpf","wpf-usercontrols"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":208,"score":2,"question_id":13015023,"title":"WPF & C#: Create an override for a datagrid within a user control?","body":"<p>I have a large WPF application where I have a datagrid within a user control and I need to create an override for OnCreateAutomationPeer. I am having trouble doing that and the event never seems to fire. In my code-behind I have something similar to</p>\n\n<pre><code>public partial class DocChecklistView :  UserControl, IDataModuleView {     \n\n        protected override System.Windows.Automation.Peers.AutomationPeer OnCreateAutomationPeer()\n        {                \n            return null;\n        }\n\n        public CDocumentChecklistView() {\n            InitializeComponent();\n        }\n}\n</code></pre>\n\n<p>The XAML is pretty standard with code like</p>\n\n<pre><code>&lt;UserControl&gt;\n &lt;Grid&gt;\n        &lt;toolkit:DataGrid  ItemsSource=\"{Binding Source={StaticResource DocumentsVS}}\" AutoGenerateColumns=\"False\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"\n                FontSize=\"16\" Name=\"_dgDocuments\" Style=\"{StaticResource EklektosDataGridStyle}\" . . . &gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>And in the above, the toolkit:DataGrid is set to the namespace for the WPFToolkit. The DataGrid works as designed, I've just never done an override within a user control and the code I have above never fires - a breakpoint there is never reached.</p>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#","wpf","resources"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13086315,"title":"Execute files included in Resource folder","body":"<p>In WPF application where I have included some files in resources, I want to execute them on a button click. How do I specify a path in <code>Process.Start()</code>.       </p>\n\n<pre><code>private void button1_Click_2(object sender, RoutedEventArgs e)\n{\n    Process.Start(\"test.txt\");    \n}\n</code></pre>\n\n<p>Or is there any other way?</p>\n\n<hr>\n\n<pre><code>private void button1_Click_2(object sender, RoutedEventArgs e)\n{\n    string path = System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) + @\"\\test.txt\";\n    if (File.Exists(path))\n    {\n        Process.Start(new ProcessStartInfo(path));\n    }\n    else\n    {\n        MessageBox.Show(\"No file found\"+path);\n    }\n</code></pre>\n\n<p>I added a message box and it showed No files found. :(</p>\n\n<p>EDIT:\nI Tried to check the path after publishing and this what i got.\nNo File Found  With a Path - C:\\Users\\Administrator\\AppData\\Local\\Apps\\2.0... test.txt</p>\n\n<p>Before I published the Application I got a path which id\nNo File Found at ..project..\\bin\\Debug\\test.txt which is obvious since my Resource file not included there its Under a Resource Folder and not Debug when i add a test file in debug it open without any problem.</p>\n\n<p>Can someone Help throwing some light on this case. </p>\n\n<p>EDIT:</p>\n\n<p>I want to open a file from Resource directory @ C:\\Users\\Administrator\\Documents\\Visual Studio 2010\\Projects\\FastFix\\FastFix\\Resources Which would be included in my project when i am going to publish it is going to run as a standalone application without installation.</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13167687,"title":"Sharing content between two windows at the same time","body":"<p>I'm trying to have the content of two windows be shared, but it doesn't seem to be working as i would expect.</p>\n\n<p>Here is a simple example showing this:</p>\n\n<pre><code>class TestClass\n{\n    [STAThread]\n    public static void Main(string[] args)\n    {\n        Application app = new Application();\n\n        TextBox t = new TextBox();\n        t.Text = \"test\";\n\n        Window w1 = new Window();\n        w1.Content = t;\n        w1.Show();\n\n        Window w2 = new Window();\n        w2.Content = t;\n        w2.Show();\n\n\n        app.Run();\n    }\n}\n</code></pre>\n\n<p>If i step through the program in debug mode, i can see that <code>w1</code> has the textbox, but as soon as the call <code>w2.Content = t;</code> then <code>w1</code> loses the textbox... and it then shows up in only <code>w2</code>.</p>\n\n<p>I also tried using binding in Xmal, where both windows pointed to the same ViewModel (with a property named MySharedContent)</p>\n\n<p><code>Content=\"{Binding Path=MySharedContent}\"</code></p>\n\n<p>but it doesn't work.</p>\n\n<p>Is this possible? Am i doing something stupid? I was thinking that both windows would have a pointer to the content for rendering... but it almost seems like they can't share the same instance?</p>\n\n<p>EDIT:</p>\n\n<p>So the basic answer is that a UI element (textbox, usercontrol, etc) can only have 1 parent. Thus i need to have two separate UI elements that share the same associated data. Got it (thanks everyone for the help, up-votes for everyone)</p>\n"},{"tags":["c#","wpf","arrays","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13168153,"title":"C# Wpf datagrid issue when declaring length of array","body":"<p>For making it clear, I have 3 arrays. ArrX, ArrY, ArrZ</p>\n\n<p>These will be put into the array: GridArr</p>\n\n<p>What Im trying to do, is a wpf app that will gather information, sort the wanted info into Arr1, Arr2 and Arr3. Put them right inside the GridArr. So it can get loaded into the datagrid. The user can edit and then get the changed values into the same array it once came from. (ArrX, ArrY, ArrZ)</p>\n\n<p>Datagrid visual example:</p>\n\n<pre><code>Test    | Dest    | Testy\nArrX[0] | ArrY[0] | ArrZ[0]\nArrX[1] | ArrY[1] | ArrZ[1]\nArrX[2] | ArrY[2] | ArrZ[2]\n</code></pre>\n\n<p>ArrX will be values into Test.\nArrY to Dest etc.</p>\n\n<p>The problem is that I must declare the size of GridArr. And I made a function to return the right size for GridArr, however I cant manage to declare it without having to put the array inside a class (without getting an error), and if GridArr is inside a class I have no clue how I should manage to get the new users edited values into ArrX, ArrY and ArrZ.</p>\n\n<pre><code>    string[] ArrX = { \"test\", \"\", \"asd\" };\n    int[] ArrY = { 1, 2, 3 };\n    int[] ArrZ = {111, 2212, 32323};\n\n\n    private LootData[] GridArr = new LootData[ArrX.Length]; /* Error occurs.\n    What should I do to declare it´s length without writing for example 3 */\n\n    public MainWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, RoutedEventArgs e)\n    {\n            GridArr[0] = new LootData(ArrX[0], ArrY[0], ArrZ[0]);//Code LootData below\n            GridArr[1] = new LootData(ArrX[1], ArrY[1], ArrZ[1]);\n            GridArr[2] = new LootData(ArrX[2], ArrY[2], ArrZ[2]);\n\n            dataGrid1.ItemsSource = null;\n            dataGrid1.ItemsSource = arr;\n    }\n</code></pre>\n\n<p>The LootData class, incase someone wants to know what´s behind there.</p>\n\n<pre><code>class LootData\n{\n    private string name;\n    private int dest;\n    private int id;\n\n    public LootData(string Name, int Dest, int Id)\n    {\n        name = Name;\n        dest = Dest;\n        id = Id;\n    }\n\n    public string Name \n    {\n        get { return name; } \n        set { name = value; } \n    }\n\n    public int Dest\n    {\n        get { return dest; }\n        set { dest = value; }\n    }\n\n    public int Id\n    {\n        get { return id; }\n        set { id = value; }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","wpf-controls","datatemplate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13166726,"title":"Access XAML Control In DataTemplate From CodeBehind?","body":"<p>I have a control that I am unable to access in the codebehind, and I believe it is because it is defined in a DataTempalte.</p>\n\n<p>The overall control is a slide show carousel.  Each slide can be an Image or a MediaElement (video), the contents of which are defined in an ItemSource binding.  The carousel is on a timer to switch from one slide to the next.  Each time the slide changes I fire an event to that effect.</p>\n\n<p>When I hit a slide with a video I'd like to stop the slide timer (done that) and start the video, which is where I've run into a problem.  I can not access the <code>MediaPlayer</code> element <code>Name</code> from my codebehind.  My assumption at this point is because it is a DataTemplate.</p>\n\n<p>Is this assumption correct?  If so, how can I get access to this control from the codebehind, or (more to the point) have it start playing when the slide comes up?</p>\n\n<pre><code>&lt;ctrl:AutoScrollCarousel ...&gt;\n    &lt;ctrl:AutoScrollCarousel.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ctrl:AutoScrollCarousel.ItemsPanel&gt;\n    &lt;ctrl:AutoScrollCarousel.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;Border x:Name=\"Border\" VerticalAlignment=\"Center\"\n                    Width=\"{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type UserControl},Mode=FindAncestor}}\"&gt;\n                &lt;Grid Background=\"White\"&gt;\n                    ...\n                    &lt;Image Source=\"{Binding ContentImage}\" Grid.Row=\"1\" Grid.Column=\"1\" Stretch=\"UniformToFill\"\n                            HorizontalAlignment=\"Center\"\n                            Visibility=\"{Binding ContentImage, Converter={StaticResource VisibilityConverter}}\" /&gt;\n\n                    &lt;MediaElement Name=\"MediaPlayer\" Source=\"{Binding ContentVideo}\" Grid.Row=\"1\" Grid.Column=\"1\" Stretch=\"UniformToFill\" LoadedBehavior=\"Play\"\n                                    Visibility=\"{Binding ContentVideo, Converter={StaticResource VisibilityConverter}}\" MediaEnded=\"MediaPlayer_MediaEnded\" /&gt;\n\n                    &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"1\" Text=\"{Binding Title}\" Foreground=\"Black\"\n                                FontFamily=\"Segoe UI\" FontWeight=\"Light\" HorizontalAlignment=\"Left\" FontSize=\"75\" Margin=\"0\" VerticalAlignment=\"Center\" /&gt;\n\n                    &lt;TextBlock Grid.Row=\"2\" Grid.Column=\"1\" Text=\"{Binding ContentHeadline}\" Foreground=\"Black\"\n                                FontFamily=\"Segoe UI\" FontWeight=\"Light\" HorizontalAlignment=\"Left\" FontSize=\"50\" VerticalAlignment=\"Center\"\n                                TextWrapping=\"Wrap\"&gt;\n                    &lt;/TextBlock&gt;\n                &lt;/Grid&gt;\n            &lt;/Border&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ctrl:AutoScrollCarousel.ItemTemplate&gt;\n&lt;/ctrl:AutoScrollCarousel&gt;\n</code></pre>\n"},{"tags":["wpf","validation","data-binding"],"answer_count":9,"favorite_count":26,"up_vote_count":41,"down_vote_count":0,"view_count":19656,"score":41,"question_id":127477,"title":"Detecting WPF Validation Errors","body":"<p>In WPF you can setup validation based on errors thrown in your Data Layer during Data Binding using the ExceptionValidationRule or DataErrorValidationRule.</p>\n\n<p>Suppose you had a bunch of controls set up this way and you had a Save button.  When the user clicks the Save button, you need to make sure there are no validation errors before proceeding with the save.  If there are validation errors, you want to holler at them.</p>\n\n<p>In WPF, how do you find out if any of your Data Bound controls have validation errors set?</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":5,"favorite_count":0,"up_vote_count":11,"down_vote_count":2,"view_count":2337,"score":9,"question_id":8203329,"title":"Moving to next control on Enter keypress in WPF","body":"<p>I want to move to the next control when I press the Enter key instead of the Tab key in a WPF MVVM application. How can I achieve this?</p>\n"},{"tags":["c#","wpf","writablebitmap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13167237,"title":"Manipulating pixels WritableBitmapEx","body":"<p>What is fast approach to manipulate pixels in WritableBitmap (i also use WritableBitmapEx extensions)? SetPixel is very slow method for things like filling a background for my Paint-like application and also it does some weird things like memory corruption (don't know why). </p>\n"},{"tags":["c#","wpf","properties","frameworks","element"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13131116,"title":"property was already registered by 'FrameworkElement'","body":"<p>I am writing two dependency properties and I keep getting the \"[Property] was already registered by 'FrameworkElement'\" error in the design window of VS11.  Here is a snippet of my code</p>\n\n<pre><code>        public static readonly DependencyProperty IsEditingNumberProperty =\n        DependencyProperty.Register(\"IsEditingNumbers\", typeof(bool), typeof(FrameworkElement),\n        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender));\n</code></pre>\n\n<p>the problem seems to be the 3rd parameter (owner parameter typeof(FrameworkElement)).  If I set the 3rd parameter to the class the contains two dependency properties, the error goes away, but I cannot use the properties directly from xaml.  I would have to add ownership for each dependency property before I use it.</p>\n\n<p>Actually, It does render correctly, but only when I first open it.  Immediately after the first render it will give me an exception.  At runtime, it seems to work perfectly.</p>\n\n<p>Am I doing something wrong and is there a way to get rid of this annoying error?</p>\n\n<p>---- Edit -----</p>\n\n<p>Here is my custom class (includes 2 of the Dependency Properties):</p>\n\n<pre><code>public partial class EditableTextBox : UserControl\n{\n    #region Dependency Properties\n    public static readonly DependencyProperty IsEditingNumberProperty =\n        DependencyProperty.Register(\"IsEditingNumber\", typeof(bool), typeof(FrameworkElement),\n        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender));\n\n    public static readonly DependencyProperty TextProperty =\n        DependencyProperty.Register(\"Text\", typeof(string), typeof(FrameworkElement),\n        new FrameworkPropertyMetadata(\"0\", FrameworkPropertyMetadataOptions.AffectsRender) \n        { \n            CoerceValueCallback = new CoerceValueCallback((sender,value) =&gt;\n                {\n                    return expressionRestaraint.Match((string)value).Value;\n                })\n        });\n    #endregion\n\n    public static Regex expressionRestaraint = new Regex(\"[-a-zA-z0-9+*.\\\\(\\\\)\\\\[\\\\]\\\\{\\\\}]*\");\n\n    public string Text\n    {\n        get { (string)GetValue(TextProperty); }\n        set \n        { \n            SetValue(TextProperty, value);\n            tbxValue.Text = (string)GetValue(TextProperty);\n        }\n    }\n\n    public bool IsEditingNumber\n    {\n        get \n        { \n            return (bool)GetValue(IsEditingNumberProperty); \n        }\n        set \n        {\n            bool old = (bool)GetValue(IsEditingNumberProperty);\n            if (old != value)\n            {\n                if (!value)\n                    stopEditing();\n                else\n                    startEditing();\n\n                SetValue(IsEditingNumberProperty, value);\n            }\n        }\n    } . . .\n</code></pre>\n\n<p>Use in Main Class:</p>\n\n<pre><code>&lt;Window x:Class=\"VisualMathExpression.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:edit=\"clr-namespace:VisualMathExpression.EditableTextBox\"\n    xmlns:all=\"clr-namespace:VisualMathExpression\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n&lt;StackPanel&gt;\n    &lt;edit:EditableTextBox HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"\n                          Text=\"af\" IsEditingNumber=\"True\" /&gt; . . .\n</code></pre>\n\n<p>--- Edit ---\nWrapper fixed (problem that cause xaml property not to change when ownership belonged to the declared class)</p>\n\n<pre><code>    public partial class EditableTextBox : UserControl\n{\n    #region Dependency Properties\n    public static readonly DependencyProperty IsEditingNumberProperty =\n        DependencyProperty.Register(\"IsEditingNumber\", typeof(bool), typeof(EditableTextBox),\n        new FrameworkPropertyMetadata(true, FrameworkPropertyMetadataOptions.AffectsRender) \n        { \n            PropertyChangedCallback = new PropertyChangedCallback((sender, arg) =&gt;\n                {\n                    EditableTextBox ed = sender as EditableTextBox;\n                    if (!(bool)arg.NewValue)\n                        ed.stopEditing();\n                    else\n                        ed.startEditing();\n                }),\n        });\n\n    public static readonly DependencyProperty TextProperty =\n        DependencyProperty.Register(\"Text\", typeof(string), typeof(EditableTextBox),\n        new FrameworkPropertyMetadata(\"0\", FrameworkPropertyMetadataOptions.AffectsRender) \n        { \n            PropertyChangedCallback = new PropertyChangedCallback((sender,arg) =&gt;\n                {\n                    EditableTextBox ed = sender as EditableTextBox;\n                    ed.tbxValue.Text = arg.NewValue as string;\n                }),\n            CoerceValueCallback = new CoerceValueCallback((sender,value) =&gt;\n                {\n                    return expressionRestaraint.Match((string)value).Value;\n                })\n        });\n    #endregion\n\n    public static Regex expressionRestaraint = new Regex(\"[-a-zA-z0-9+*.\\\\(\\\\)\\\\[\\\\]\\\\{\\\\}]*\");\n\n    public string Text\n    {\n        get { return (string)GetValue(TextProperty); }\n        set { SetValue(TextProperty, value); }\n    }\n\n    public bool IsEditingNumber\n    {\n        get { return (bool)GetValue(IsEditingNumberProperty); }\n        set { SetValue(IsEditingNumberProperty, value); }\n    }\n</code></pre>\n"},{"tags":["wpf","custom-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13166844,"title":"WPF: Cannot create an instance of all control in a user control","body":"<p>I use custom control in my WPF application. This custom control includes logic and resource dictionary. \nIn my application I have login window and main window. Application first loads login window  </p>\n\n<pre><code>&lt;Application x:Class=\"Dest.App\"\n             ....\n             StartupUri=\"Login.xaml\"&gt;\n&lt;/Application&gt;\n</code></pre>\n\n<p>Custom control I use in my main window  </p>\n\n<pre><code>&lt;time:Calendar CloseAppointment=\"OnDeleteAppointment\" AddAppointment=\"OnAddAppointment\" Appointments=\"{Binding Path=Model}\" /&gt;\n</code></pre>\n\n<p>Also in MainWindow I load resource dictionary from assembly  </p>\n\n<pre><code>&lt;ResourceDictionary&gt;\n  &lt;ResourceDictionary.MergedDictionaries&gt;\n    &lt;ResourceDictionary Source=\"pack://application:,,,/WpfCalendar;component/Dictionary.xaml\"/&gt;\n  &lt;/ResourceDictionary.MergedDictionaries&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>Visual Studio loads custom control without any exceptions. But when I load application and successfully login, viewmodel of the login view calls main windows  </p>\n\n<pre><code> MainWindow mainWindow = new MainWindow();\n mainWindow.Show();\n</code></pre>\n\n<p>Constructor of the main window  </p>\n\n<pre><code>public MainWindow()\n{\n   InitializeComponent();    \n   m_MainViewModel = new MainViewModel();\n   this.DataContext = m_MainViewModel;\n}\n</code></pre>\n\n<p>I receive an exception  </p>\n\n<p><a href=\"http://oi48.tinypic.com/11ljskh.jpg\" rel=\"nofollow\">Exception</a>\n<br /></p>\n\n<p>Exception details </p>\n\n<blockquote>\n  <p>at WpfCalendar.Logic.Calendar.FilterAppointments() in\n  D:\\development\\Dental\n  Soft\\LotusScheduler\\WpfScheduler\\WpfCalendar\\Logic\\Calendar.cs:line\n  122 at\n  WpfCalendar.Logic.Calendar.OnAppointmentsChanged(DependencyPropertyChangedEventArgs\n  e) in D:\\development\\Dental\n  Soft\\LotusScheduler\\WpfScheduler\\WpfCalendar\\Logic\\Calendar.cs:line\n  109 at\n  WpfCalendar.Logic.Calendar.OnAppointmentsChanged(DependencyObject d,\n  DependencyPropertyChangedEventArgs e) in D:\\development\\Dental\n  Soft\\LotusScheduler\\WpfScheduler\\WpfCalendar\\Logic\\Calendar.cs:line\n  100 at\n  System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs\n  e) at\n  System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs\n  e) at\n  System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs\n  args) at\n  System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex\n  entryIndex, DependencyProperty dp, PropertyMetadata metadata,\n  EffectiveValueEntry oldEntry, EffectiveValueEntry&amp; newEntry, Boolean\n  coerceWithDeferredReference, Boolean coerceWithCurrentValue,\n  OperationType operationType) at\n  System.Windows.DependencyObject.InvalidateProperty(DependencyProperty\n  dp, Boolean preserveCurrentValue) at\n  System.Windows.Data.BindingExpressionBase.Invalidate(Boolean\n  isASubPropertyChange) at\n  System.Windows.Data.BindingExpression.TransferValue(Object newValue,\n  Boolean isASubPropertyChange) at\n  System.Windows.Data.BindingExpression.Activate(Object item) at\n  System.Windows.Data.BindingExpression.AttachToContext(AttachAttempt\n  attempt) at\n  System.Windows.Data.BindingExpression.MS.Internal.Data.IDataBindEngineClient.AttachToContext(Boolean\n  lastChance) at MS.Internal.Data.DataBindEngine.Task.Run(Boolean\n  lastChance) at MS.Internal.Data.DataBindEngine.Run(Object arg) at\n  MS.Internal.Data.DataBindEngine.OnLayoutUpdated(Object sender,\n  EventArgs e) at\n  System.Windows.ContextLayoutManager.fireLayoutUpdateEvent() at\n  System.Windows.ContextLayoutManager.UpdateLayout() at\n  System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)\n  at System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()\n  at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks() at\n  System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object\n  resizedCompositionTarget) at\n  System.Windows.Media.MediaContext.RenderMessageHandler(Object\n  resizedCompositionTarget) at\n  System.Windows.Media.MediaContext.Resize(ICompositionTarget\n  resizedCompositionTarget) at\n  System.Windows.Interop.HwndTarget.OnResize() at\n  System.Windows.Interop.HwndTarget.HandleMessage(WindowMessage msg,\n  IntPtr wparam, IntPtr lparam) at\n  System.Windows.Interop.HwndSource.HwndTargetFilterMessage(IntPtr hwnd,\n  Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) at\n  MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam,\n  IntPtr lParam, Boolean&amp; handled) at\n  MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o) at\n  System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate\n  callback, Object args, Int32 numArgs) at\n  MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object\n  source, Delegate method, Object args, Int32 numArgs, Delegate\n  catchHandler) at\n  System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority\n  priority, TimeSpan timeout, Delegate method, Object args, Int32\n  numArgs) at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32\n  msg, IntPtr wParam, IntPtr lParam) at\n  MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr\n  hWnd, Int32 msg, IntPtr wParam, IntPtr lParam) at\n  MS.Win32.HwndSubclass.DefWndProcWrapper(IntPtr hwnd, Int32 msg, IntPtr\n  wParam, IntPtr lParam) at\n  MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr\n  hWnd, Int32 msg, IntPtr wParam, IntPtr lParam) at\n  MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr\n  wParam, IntPtr lParam) at\n  MS.Win32.UnsafeNativeMethods.SetWindowPos(HandleRef hWnd, HandleRef\n  hWndInsertAfter, Int32 x, Int32 y, Int32 cx, Int32 cy, Int32 flags) at\n  System.Windows.Window.SetupInitialState(Double requestedTop, Double\n  requestedLeft, Double requestedWidth, Double requestedHeight) at\n  System.Windows.Window.CreateSourceWindow(Boolean duringShow) at\n  System.Windows.Window.CreateSourceWindowDuringShow() at\n  System.Windows.Window.SafeCreateWindowDuringShow() at\n  System.Windows.Window.ShowHelper(Object booleanBox) at\n  System.Windows.Window.Show() at\n  ViewModel.LoginingViewModel.Login(Object parameter) in\n  D:\\development\\Dental\n  Soft\\Lotus\\AMS\\Dentist\\ViewModel\\LoginingViewModel.cs:line 162 at\n  ViewModel.LoginingViewModel.b__0(Object param) in\n  D:\\development\\Dental\n  Soft\\Lotus\\AMS\\Dentist\\ViewModel\\LoginingViewModel.cs:line 115 at\n  ViewModel.CommonCommand.Execute(Object parameter) in\n  D:\\development\\Dental\n  Soft\\Lotus\\AMS\\Dentist\\Commands\\CommonCommand.cs:line 59 at\n  MS.Internal.Commands.CommandHelpers.CriticalExecuteCommandSource(ICommandSource\n  commandSource, Boolean userInitiated) at\n  System.Windows.Controls.Primitives.ButtonBase.OnClick() at\n  System.Windows.Controls.Button.OnClick() at\n  System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs\n  e) at System.Windows.UIElement.OnMouseLeftButtonUpThunk(Object sender,\n  MouseButtonEventArgs e) at\n  System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate\n  genericHandler, Object genericTarget) at\n  System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object\n  target) at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object\n  target, RoutedEventArgs routedEventArgs) at\n  System.Windows.EventRoute.InvokeHandlersImpl(Object source,\n  RoutedEventArgs args, Boolean reRaised) at\n  System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender,\n  RoutedEventArgs args, RoutedEvent newEvent) at\n  System.Windows.UIElement.OnMouseUpThunk(Object sender,\n  MouseButtonEventArgs e) at\n  System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate\n  genericHandler, Object genericTarget) at\n  System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object\n  target) at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object\n  target, RoutedEventArgs routedEventArgs) at\n  System.Windows.EventRoute.InvokeHandlersImpl(Object source,\n  RoutedEventArgs args, Boolean reRaised) at\n  System.Windows.UIElement.RaiseEventImpl(DependencyObject sender,\n  RoutedEventArgs args) at\n  System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args) at\n  System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean\n  trusted) at System.Windows.Input.InputManager.ProcessStagingArea() at\n  System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)\n  at System.Windows.Input.InputProviderSite.ReportInput(InputReport\n  inputReport) at\n  System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd,\n  InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x,\n  Int32 y, Int32 wheel) at\n  System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr\n  hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean&amp;\n  handled) at\n  System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd,\n  Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) at\n  MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam,\n  IntPtr lParam, Boolean&amp; handled) at\n  MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o) at\n  System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate\n  callback, Object args, Int32 numArgs) at\n  MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object\n  source, Delegate method, Object args, Int32 numArgs, Delegate\n  catchHandler) at\n  System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority\n  priority, TimeSpan timeout, Delegate method, Object args, Int32\n  numArgs) at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32\n  msg, IntPtr wParam, IntPtr lParam) at\n  MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg) at\n  System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame\n  frame) at\n  System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\n  at System.Windows.Threading.Dispatcher.Run() at\n  System.Windows.Application.RunDispatcher(Object ignore) at\n  System.Windows.Application.RunInternal(Window window) at\n  System.Windows.Application.Run(Window window) at\n  System.Windows.Application.Run() at Dentist.App.Main() in\n  D:\\development\\Dental\n  Soft\\Lotus\\AMS\\Dentist\\obj\\x86\\Debug\\App.g.cs:line 0 at\n  System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[]\n  args) at System.AppDomain.ExecuteAssembly(String assemblyFile,\n  Evidence assemblySecurity, String[] args) at\n  Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() at\n  System.Threading.ThreadHelper.ThreadStart_Context(Object state) at\n  System.Threading.ExecutionContext.RunInternal(ExecutionContext\n  executionContext, ContextCallback callback, Object state, Boolean\n  preserveSyncCtx) at\n  System.Threading.ExecutionContext.Run(ExecutionContext\n  executionContext, ContextCallback callback, Object state, Boolean\n  preserveSyncCtx) at\n  System.Threading.ExecutionContext.Run(ExecutionContext\n  executionContext, ContextCallback callback, Object state) at\n  System.Threading.ThreadHelper.ThreadStart()</p>\n</blockquote>\n\n<p>Part of the resource dictionary with problem controls  </p>\n\n<pre><code>&lt;Border BorderBrush=\"#A5BFE1\" BorderThickness=\"0,1,1,1\" Background=\"White\" Grid.Column=\"1\" Grid.Row=\"0\" &gt;\n    &lt;TextBlock x:Name=\"DayHeader\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n    &lt;TextBlock.ToolTip&gt;\n        &lt;ToolTip&gt;\n            &lt;StackPanel&gt;\n                &lt;TextBlock FontWeight=\"Bold\" Text=\"{x:Static Properties:Resources.CalendarSelectedDayTitle}\" /&gt;\n                &lt;TextBlock Text=\"{x:Static Properties:Resources.CalendarSelectedDayDescription}\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/ToolTip&gt;\n    &lt;/TextBlock.ToolTip&gt;\n        &lt;/TextBlock&gt;\n&lt;/Border&gt;\n&lt;time:Scroll x:Name=\"scrollViewer\" CustomVerticalOffset=\"640.0\" Grid.Row=\"2\" Grid.Column=\"0\" Grid.ColumnSpan=\"2\"&gt;\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"60\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n\n        &lt;time:TimeRibbon Grid.Column=\"0\"&gt;&lt;/time:TimeRibbon&gt;\n        &lt;time:SchedulerDay Grid.Column=\"1\" x:Name=\"Day\"&gt;&lt;/time:SchedulerDay&gt;\n    &lt;/Grid&gt;\n&lt;/time:Scroll&gt;\n</code></pre>\n\n<p>Constructor of the Calendar control (that throw exception)  </p>\n\n<pre><code>public Calendar()\n{\n    DefaultStyleKeyProperty.OverrideMetadata(typeof(Calendar), new FrameworkPropertyMetadata(typeof(Calendar)));\n\n    CommandManager.RegisterClassCommandBinding(typeof(Calendar), \n        new CommandBinding(NextDay, new ExecutedRoutedEventHandler(OnExecutedNextDay), \n            new CanExecuteRoutedEventHandler(OnCanExecuteNextDay)));\n\n    CommandManager.RegisterClassCommandBinding(typeof(Calendar),\n        new CommandBinding(PreviousDay, new ExecutedRoutedEventHandler(OnExecutedPreviousDay),\n            new CanExecuteRoutedEventHandler(OnCanExecutePreviousDay)));\n}\n</code></pre>\n\n<p>But when set in app.xaml the first window MainWindow, not LoginWindow everything works properly without any excetions!  </p>\n\n<p>Please advise what can be cause of the problem?  </p>\n\n<p>Thank you  </p>\n"},{"tags":["wpf","wpfdatagrid","datatemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13166767,"title":"TabItem DataTemplate with DataGrid inside","body":"<p>I'm using datatemplate to show my custom class as TabControl item. This datatemplate contains DataGrid. In xaml I've added handler to Loaded event of this datagrid. \nAnd I have a following problem: when I'm adding first tab to tabcontrol, loaded event (of datagrid) will be raised as expected. But, then when I will try to add next tabs to this tabcontrol this event not be raised at all. This event is only raised for first tab of tabcontrol, but I need to handle it for all tabs. </p>\n\n<p>Thanks. </p>\n"},{"tags":["wpf","mvvm","observablecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13144320,"title":"WPF MVVM observable collection not updating GUI","body":"<p>Im designing an MVVM WPF app, and have a ViewModel which has a property called SelectedCustomer, of type Customer. This object has a property called SummaryDetails of type ObservableCollection which renders into a ListView, line by line. </p>\n\n<p>To do this, I have created a separate property on the ViewModel called CustomerSummaryDetails which contains simply a get, that returns the collection contained within the customer I mentioned above. </p>\n\n<p>In the XAML I have bound the ItemsSource to the CustomerSummaryDetails Property.</p>\n\n<p>This was so I didnt have to bind to SelectedCustomer.SummaryDetails which isn't as clean. </p>\n\n<p>The SelectedCustomer property has a get and a set method, and the set calls OnPropertyChanged for the OTHER property, CustomerSummaryDetails, letting the XAML know that the underlying collection has changed and to update.</p>\n\n<p>The problem is though that when I update an item within the collection, it is not reflecting on the GUI, despite all the right events being called. I have stepped in and the set method of the SelectedCustomer is being called, and I then follow the OnPropertyChanged(\"CustomerSummaryDetails\") call which goes into the \"get\" method of the CustomerSummaryDetails property as expected. I have delved into the value of the returned collection at this point, and the value within the list is the updated value, however nothing is getting reflected on the GUI, so I am puzzled as it seems the GUI is calling the get method to update it on the OnPropertyChanged() call, but it is not reflecting visually.</p>\n\n<p>UPDATE - CODE INCLUDED</p>\n\n<p>Sorry for not including code, I thought it would be easier to just describe but here are the main ViewModel properties</p>\n\n<pre><code> public CustomerSummaryViewModel SelectedCustomer\n        {\n            get { return _selectedCustomer; }\n            set\n            {\n                _selectedCustomer = value;\n                OnPropertyChanged(\"CustomerSummaryDetails\");\n            }\n        }\n\n        public ObservableCollection&lt;RbcUICustomerSummary&gt; CustomerSummaryDetails\n        {\n            get { return _selectedCustomer.SummaryDetails; }\n        }\n\n        public ItemSummaryViewModel SelectedItem\n        {\n            get { return _selectedItem; }\n            set\n            {\n                _selectedItem = value;\n                OnPropertyChanged(\"SelectedItem\");\n            }\n        }    \n</code></pre>\n\n<p>XAML below</p>\n\n<pre><code>    &lt;ListView x:Name=\"lvCustomerSummary\" Margin=\"10,10,10,10\" Background=\"#F4F8FB\" ItemsSource=\"{Binding CustomerSummaryDetails}\" MouseDoubleClick=\"lvCustomerSummary_MouseDoubleClick\" ItemContainerStyle=\"{StaticResource myHeaderStyleColor}\" VirtualizingStackPanel.IsVirtualizing=\"False\" VirtualizingStackPanel.VirtualizationMode=\"Recycling\"&gt;\n            &lt;ListView.View&gt;\n            &lt;GridView ColumnHeaderContainerStyle=\"{StaticResource myHeaderStyle}\"&gt;\n                    &lt;GridView.Columns&gt;\n                    &lt;GridViewColumn Header=\"\"  &gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate &gt;\n                                &lt;Grid&gt;\n                                    &lt;Image Source=\"{z:ImageStaticResource {Binding IconSelect}}\" Width=\"20\" Height=\"20\" /&gt;\n                                &lt;/Grid&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"200\" Header=\"SubCustType\" DisplayMemberBinding=\"{Binding SubCustType}\" &gt;\n                    &lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"200\" Header=\"SubCustValue\"  DisplayMemberBinding=\"{Binding SubCustValue}\"&gt;\n                    &lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Header=\"\"  &gt;\n                        &lt;GridViewColumn.CellTemplate&gt;\n                            &lt;DataTemplate &gt;\n                                &lt;Grid&gt;\n                                    &lt;Image Source=\"{z:ImageStaticResource {Binding IconFlag}}\" Width=\"20\" Height=\"20\" /&gt;\n                                &lt;/Grid&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/GridViewColumn.CellTemplate&gt;\n                    &lt;/GridViewColumn&gt;\n                &lt;/GridView.Columns&gt;\n            &lt;/GridView&gt;\n        &lt;/ListView.View&gt;\n    &lt;/ListView&gt;\n</code></pre>\n\n<p>And finally the Updater method which does the actual update</p>\n\n<pre><code> private void DisplayCustomerComment(string commentEnt)\n        {            \n            if (_queueViewModel.SelectedCustomer == null) return;\n\n            var selCust = _queueViewModel.SelectedCustomer;\n\n            foreach (var t in\n                selCust.SummaryDetails.Where(t =&gt; t.SubCustType == AppString.CustomerSummary.Comment))\n            {\n                t.SubCustValue = commentEnt;\n                break;\n            }\n\n            _queueViewModel.SelectedCustomer = selCust;\n        }\n</code></pre>\n"},{"tags":["wpf","xaml","windows-8","visual-studio-2012","winrt-xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13163719,"title":"Label is not a valid XAML element?","body":"<p>I tried to run my C#/XAML app again this morning (earlier problems noted here: <a href=\"http://stackoverflow.com/questions/13150291/why-did-my-xaml-suddenly-crash\">Why did my XAML suddenly crash?</a>).</p>\n\n<p>This time, I at least got some specific err msgs, namely \"The member \"ShowGridLines\" is not recognized or is not accessible.\" and \"Label is not supported in a Windows App project.\"</p>\n\n<p>Here is the complete XAML:</p>\n\n<pre><code>&lt;Page\n    x:Class=\"TimeAndSpaceLines.View.SectionN\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:TimeAndSpaceLines.View\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"&gt;\n\n    &lt;Grid MinHeight=\"600\" ShowGridLines=\"True\" Background=\"{StaticResource ApplicationPageBackgroundThemeBrush}\"&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"320\"&gt;&lt;/ColumnDefinition&gt;\n                &lt;ColumnDefinition MaxWidth=\"800\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;Grid.RowDefinitions&gt;\n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n&lt;RowDefinition/&gt;                    \n\n            &lt;/Grid.RowDefinitions&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Label MinWidth=\"40\" Content=\"From\"&gt;&lt;/Label&gt;\n                &lt;TextBox x:Name=\"textBoxFromDate\" MinWidth=\"120\"&gt;\n                &lt;/TextBox&gt;\n            &lt;/StackPanel&gt;\n            &lt;StackPanel Grid.Row=\"1\" Orientation=\"Horizontal\"&gt;\n                &lt;Label MinWidth=\"40\"&gt;at\n                &lt;/Label&gt;\n                &lt;TextBox x:Name=\"textBoxFromTime\" MinWidth=\"120\" Grid.Row=\"1\"&gt;\n                &lt;/TextBox&gt;\n            &lt;/StackPanel&gt;\n            &lt;StackPanel Grid.Row=\"2\" Orientation=\"Horizontal\"&gt;\n                &lt;Label MinWidth=\"40\"&gt;To\n                &lt;/Label&gt;\n                &lt;TextBox x:Name=\"textBoxToDate\" MinWidth=\"120\"&gt;\n                &lt;/TextBox&gt;\n            &lt;/StackPanel&gt;\n            &lt;StackPanel Grid.Row=\"3\" Orientation=\"Horizontal\"&gt;\n                &lt;Label MinWidth=\"40\"&gt;at\n                &lt;/Label&gt;\n                &lt;TextBox x:Name=\"textBoxToTime\" MinWidth=\"120\" Grid.Row=\"1\"&gt;\n                &lt;/TextBox&gt;\n            &lt;/StackPanel&gt;\n            &lt;Button\n         x:Name=\"buttonFindLocForDateRange\"\n         MaxWidth=\"200\"\n         Grid.Row=\"4\"\n         Content=\"Find Location for Date Range\"&gt;\n            &lt;/Button&gt;\n            &lt;Label\n         x:Name=\"labelPerson1_Red\"\n         Grid.Row=\"5\"\n         Content=\"(Person1_Red)\"\n         Foreground=\"Red\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson2_Orange\"\n         Grid.Row=\"6\"\n         Content=\"(Person2_Orange)\"\n         Foreground=\"Orange\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson3_Yellow\"\n         Grid.Row=\"7\"\n         Content=\"(Person3_Yellow)\"\n         Foreground=\"Yellow\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson4_Green\"\n         Grid.Row=\"8\"\n         Content=\"(Person4_Green)\"\n         Foreground=\"Green\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson5_Blue\"\n         Grid.Row=\"9\"\n         Content=\"(Person5_Blue)\"\n         Foreground=\"Blue\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson6_Indigo\"\n         Grid.Row=\"10\"\n         Content=\"(Person6_Indigo)\"\n         Foreground=\"Indigo\"&gt;\n            &lt;/Label&gt;\n            &lt;Label\n         x:Name=\"labelPerson7_Violet\"\n         Grid.Row=\"11\"\n         Content=\"(Person7_Violet)\"\n         Foreground=\"Violet\"&gt;\n            &lt;/Label&gt;\n            &lt;StackPanel Grid.Column=\"1\" Orientation=\"Horizontal\"&gt;\n                &lt;Image&gt;\n                &lt;/Image&gt;\n                &lt;Label&gt;Prev\n                &lt;/Label&gt;\n                &lt;Label x:Name=\"labelSectionN\" Content=\"(Section N)\"&gt;\n                &lt;/Label&gt;\n                &lt;Label&gt;Next\n                &lt;/Label&gt;\n            &lt;/StackPanel&gt;\n            &lt;!-- Add a Bing Map component: Grid.Column=\"1\" Grid.Row=\"1\" Grid.RowCount=\"11\" --&gt;\n        &lt;/Grid&gt;\n&lt;/Page&gt;\n</code></pre>\n\n<p>Note: with the only difference being that the initial and namespace portion of the XAML is simply this:</p>\n\n<pre><code>&lt;Page\n  xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n  xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n</code></pre>\n\n<p>...and that there is no Background=\"{StaticResource ApplicationPageBackgroundThemeBrush}\" in the Grid properties, this XAML displays as it should (very ugly for now, but that's to be expected at this point) in Kaxaml.</p>\n"},{"tags":["wpf","xaml","command"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13155153,"title":"How can i get \"Click\" event work with my WPF button when I use EventTrigger from the Expression Blend Interactivity assembly?","body":"<p>I'm attempting to use a Command, defined in my view model with EventTriggers as defined in xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"</p>\n\n<p>I have changed the control from a Microsoft.Surface.Presentation.Controls.SurfaceSlider-derived control to a regular WPF Button. With the Button, the same ConfirmOrderCommand gets fired if I use the EventName=\"MouseEnter\", but if I use EventName=\"Click\" nothing happens. The XAML for the Button is here.</p>\n\n<pre><code>&lt;Button Name=\"ConfirmButton\"\n          IsEnabled=\"{Binding IsEnabled}\"\n          Style=\"{StaticResource  ConfirmButtonStyle}\"\n          &gt;\n    &lt;i:Interaction.Triggers&gt;\n      &lt;i:EventTrigger EventName=\"Click\"&gt;\n        &lt;i:InvokeCommandAction Command=\"{Binding ConfirmOrderCommand}\"/&gt;\n      &lt;/i:EventTrigger&gt;\n    &lt;/i:Interaction.Triggers&gt;\n  &lt;/Button&gt;\n</code></pre>\n\n<p>I want the user to be able to click the button to fire the command. Can I get the Click event to work for a Button, or do I need to look for another event? I've also failed to get MouseLeftButtonUp to work.</p>\n"},{"tags":[".net","wpf","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13166297,"title":"error message \" 'y' is not declared.\" in vb.net","body":"<p>I'm having a weird problem. I have some code in Visual Studio 2012 express edition in a WPF app written with VisualBasic.Net. </p>\n\n<pre><code>Private Sub txtColProvGenCompany_TextChanged(sender As Object, e As TextChangedEventArgs) Handles txtColProvGenCompany.TextChanged\n\n    ProvNewEditing()\nEnd Sub\n</code></pre>\n\n<p>But when I try to run the application it says that it can't build because the <code>y</code> from <code>txtConProvGenCompan***y***.TextChanged</code>. The error message is </p>\n\n<blockquote>\n  <p><code>y</code> is not declared. it may be inaccessible due to its protection level</p>\n</blockquote>\n\n<p>and shows only that character underlined in my code.</p>\n\n<p>any ideas?   </p>\n"},{"tags":["wpf","wpf-controls","media"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":181,"score":1,"question_id":8797368,"title":"MediaKit cant render some H264 video on my project but it can elsewhere","body":"<p>I'm trying to use the MediaUriElement from WPF media kit, it works fine for every format I've tested except with the H264 format.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GukRb.png\" alt=\"Left: My application, Right: WPF Mediakit Sample application, Video codec: Codec H264 - MPEG-4 AVC (part 10)(avc1), FrameRate: 29.969000, Res:320x240\"></p>\n\n<p>Picture: Left: My application, Right: WPF Mediakit Sample application</p>\n\n<p>Whats strange is that WPF mediakit in my application can play file that is: </p>\n\n<pre><code>Codec H264 - MPEG-4 AVC (part 10)(avc1), FrameRate: 24.000384, Res: 1920x872\n</code></pre>\n\n<p>But it cant play: (i'm using this video as an example, it cant play other similar videos)</p>\n\n<pre><code>Codec H264 - MPEG-4 AVC (part 10)(avc1), FrameRate: 29.969000, Res: 320x240\n</code></pre>\n\n<p>I spent a fair while looking through the source code for the WPFMediakit sample application, but i couldn't figure out what they did diffrently.</p>\n\n<p>I have K light codec installed and Windows media player can play the videos.</p>\n\n<p>If you need other information I'll be happy to provide them.</p>\n"},{"tags":["c#","wpf","mvvm","binding"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5172,"score":3,"question_id":2643545,"title":"WPF MVVM: how to bind GridViewColumn to ViewModel-Collection?","body":"<p>In my View I got a ListView bound to a CollectionView in my ViewModel, for example like this:</p>\n\n<pre><code>&lt;ListView ItemsSource=\"{Binding MyCollection}\" IsSynchronizedWithCurrentItem=\"true\"&gt;\n  &lt;ListView.View&gt;\n    &lt;GridView&gt;\n      &lt;GridViewColumn Header=\"Title\" DisplayMemberBinding=\"{Binding Path=Title}\"/&gt;\n      &lt;GridViewColumn Header=\"Name\" DisplayMemberBinding=\"{Binding Path=Name}\"/&gt;\n      &lt;GridViewColumn Header=\"Phone\" DisplayMemberBinding=\"{Binding Path=Phone}\"/&gt;\n      &lt;GridViewColumn Header=\"E-mail\" DisplayMemberBinding=\"{Binding Path=EMail}\"/&gt;\n    &lt;/GridView&gt;\n  &lt;/ListView.View&gt;\n&lt;/ListView&gt;\n</code></pre>\n\n<p>Right now these GridViewColumns are fixed, but I'd like to be able to change them from the ViewModel. I'd guess I'll have to bind the GridViewColumn-collection to something in the ViewModel, but what, and how?<br>\nThe ViewModel does know nothing of WPF, so I got no clue how to achieve this in MVVM.</p>\n\n<p>any help here?</p>\n"},{"tags":["c#","wpf","graph","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":221,"score":1,"question_id":11667162,"title":"Set range for values for graph axes using DynamicDataDisplay","body":"<p>I am creating a application where in I want to plot a graph with DateTime as X-axis and numbers from 0-100 as Y-axis.</p>\n\n<p>I have used the following code </p>\n\n<p></p>\n\n<pre><code>     &lt;d3:ChartPlotter.HorizontalAxis&gt;\n        &lt;d3:HorizontalDateTimeAxis Name=\"dateAxis\"/&gt;\n     &lt;/d3:ChartPlotter.HorizontalAxis&gt;\n     &lt;d3:ChartPlotter.VerticalAxis&gt;\n        &lt;d3:VerticalIntegerAxis Name=\"countAxis\"  /&gt;   \n     &lt;/d3:ChartPlotter.VerticalAxis&gt;\n\n\n     &lt;d3:Header FontFamily=\"Times New Roman\" Foreground=\"SteelBlue\"  Content=\"Radiation Monitoring System\"/&gt;\n     &lt;d3:VerticalAxis FontFamily=\"Times New Roman\" Foreground=\"SteelBlue\" Content=\"Radiation Number\" HorizontalAlignment=\"Center\"  VerticalAlignment=\"Top\" Height=\"346\" Width=\"179\" /&gt;\n     &lt;d3:HorizontalAxis FontFamily=\"Times New Roman\" Foreground=\"SteelBlue\" Content=\"Real time\" HorizontalAlignment=\"Center\" /&gt;\n\n  &lt;/d3:ChartPlotter&gt;\n</code></pre>\n\n<p>How am I suppose to set the Y-axisvalues between 0 - 100 ?</p>\n\n<p>Also I need to set the content of Y-axis as we see in the normal graphs.(rotated 270 degrees)</p>\n"},{"tags":["c#","wpf","datetime","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12703786,"title":"D3 - Dynamic Data Display WPF datetime axis internal format","body":"<p>I am using a Dynamic Data Display WPF chart. I am trying to set the visible datarect for the Viewport2D in a chart with a datetime axis for x- axis. How do I convert a date into a valid double value for the DataRect which I need to assign to the Visible property on the Viewport2D?</p>\n"},{"tags":["c#","wpf","charts","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13142173,"title":"DynamicDataDisplay ChartPlotter remove all plots","body":"<p>In my WPF application I have a D3 ChartPlotter where I was able to plot 4 LineGraphs. This is the XAML code:</p>\n\n<pre><code>&lt;d3:ChartPlotter Name=\"plotter\"&gt;\n    &lt;d3:ChartPlotter.HorizontalAxis&gt;\n        &lt;d3:HorizontalAxis Name=\"timeAxis\" /&gt;\n    &lt;/d3:ChartPlotter.HorizontalAxis&gt;\n    &lt;d3:ChartPlotter.VerticalAxis&gt;\n        &lt;d3:VerticalAxis Name=\"accelerationAxis\" /&gt;\n    &lt;/d3:ChartPlotter.VerticalAxis&gt;\n&lt;/d3:ChartPlotter&gt;\n</code></pre>\n\n<p>where <code>d3</code> is the namespace for DinamicDataDisplay, and this is (relevant part of) the code behind.</p>\n\n<pre><code>var x = new List&lt;int&gt;();\nvar y = new List&lt;int&gt;();\nfor (var t = 0; t &lt;= 10; t = t + 1) { \n    x.Add(t);\n    y.Add(Math.Pow(t,2));\n}\n\nvar xCoord = new EnumerableDataSource&lt;int&gt;(x);\nxCoord.SetXMapping(t =&gt; t);\nvar yCoord = new EnumerableDataSource&lt;int&gt;(y);\nyCoord.SetYMapping(k =&gt; k);\n\nCompositeDataSource plotterPoints = new CompositeDataSource(xCoord, yCoord);\n\nplotter.AddLineGraph(plotterPoints, Brushes.Red.Color , 2, \"MyPlot\");\n</code></pre>\n\n<p>What I want to do now is remove this plot and redraw it using a different set of points. Unfortunately I'm unable to find anything that goes in that direction both in the (poor) documentation of D3 and in the web.</p>\n\n<p>Any suggestion about what to do or where to look?</p>\n\n<p>Thanks!</p>\n"},{"tags":["wpf","thread-safety","observablecollection","icollectionview"],"answer_count":1,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":2655,"score":6,"question_id":7687000,"title":"Fast performing and thread safe observable collection","body":"<p>Observable collections raise notifications for each action performed on them. Firstly they dont have bulk add or remove calls, secondly they are not thread safe.</p>\n\n<p>Doesnt this make them slower? Cant we have a faster alternative? Some say ICollectionView wrapped around an <code>ObservableCollection</code> is fast? How <strong>true</strong> is this claim.</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":12897815,"title":"WebBrowser control doesn't populate on first iteration if loading two controls","body":"<p>The issue I am having is I have a WebBrowser control called \"Browser.\" The browser is populated from a different controls created by MEF:</p>\n\n<pre><code> //Apply Button that cretes the HTML that is loaded into the Browser\n btnCreateHTMLPreview(object sender, RoutedEventArgs e)\n {\n   //Clears the content of the observable collection\n   contents.Clear();\n\n   //usedControls is an observable collection of all loaded controls in the stack panel\n   foreach(var control in usedControls)\n      control.CreateHTML();\n }\n\n //Code in the MEF Control that creates the HTML that is will be loaded into the browser\n CreateHTML()\n {\n   string tempStuff = null;\n   tempStuff += \"&lt;h1&gt;\" + MyControl.lblHeader.Content + \"&lt;/h1&gt;\\n\";\n   tempStuff += MyControl.txtTextGoesHere.Text + \"\\n\";\n\n   //Give the HTML back to the Application\n   parent.AcceptReport(tempStuff);\n }\n\n //Application side where it accepts the HTML and loads it into the Browser\n AcceptHTML(string passedInContent)\n {\n   //Observable collection that holds the content of all possible MEF Controls\n   contents.Add(passedInContent);\n\n   string tempStuffForBrowser = null;\n   tempStuffForBrowser = \"&lt;html&gt;\\n\";\n   tempStuffForBrowser += \"&lt;body&gt;\\n\";\n\n   //Add the content that was saved earlier\n   foreach (var strInd in contents)\n      tempStuffForBrowser += strInd;\n\n   tempStuffForBrowser = \"&lt;html&gt;\\n\";\n   tempStuffForBrowser += \"&lt;body&gt;\\n\";\n\n   Browser.NavigateToString(tempStuffForBrowser);\n }\n</code></pre>\n\n<p>I did my best above to try and provide the meat of how I am populating the html and add that back into the browser. If there is anything that is unclear please just let me know.</p>\n\n<p>If I have just one control added so that \"content\" only has the one control in it when I click the button to load the html, it works just fine and loads it in.  However if I have more than one control loaded, I have to click that button twice to get it to show. I found this extremely bizarre. My attempt to solve this was to check and see if there was content in the Browser before leaving the event, but I am unsure how to do this. If anyone has any suggestions or any other ideas on how to solve this problem please let me know.</p>\n"},{"tags":["c#","wpf","binding","checkbox","inotifypropertychanged"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13164045,"title":"How to visually update checkboxes in UI that are bounded to boolean isChecked variable in WPF c#?","body":"<p>So I have a TreeView that has heirarchical data templates that have CheckBoxes in the lowest layer. These CheckBoxes are bound to a \"isChecked\" boolean value in the ViewModel. What I have been attempting to do is load the various variables indicating to me which checkboxes to check, change the boolean isChecked in the model to true, therefore resulting in the specific CheckBoxes in the TreeView being update visually. Here is my code for reference:</p>\n\n<p>XAML: (of TreeView I am working with)</p>\n\n<pre><code>&lt;DockPanel Name=\"test1\" Margin=\"10,10,0,10\" VerticalAlignment=\"Stretch\" Grid.Row=\"3\" Grid.RowSpan=\"7\" Grid.Column=\"0\"&gt;\n        &lt;DockPanel.Resources&gt;\n            &lt;local:CheckBoxCommand x:Key=\"cbc\"&gt;&lt;/local:CheckBoxCommand&gt;\n            &lt;src:TreeViewFilter x:Key=\"MyList\" /&gt;\n\n            &lt;HierarchicalDataTemplate DataType=\"{x:Type src:TreeViewParent}\" ItemsSource=\"{Binding Path=OrderAttributes}\"&gt;\n                &lt;TextBlock Text=\"{Binding Path=NameAndCount}\" FontSize=\"24\"/&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n\n            &lt;HierarchicalDataTemplate DataType=\"{x:Type src:OrderAttribute}\" ItemsSource=\"{Binding Path=OrderAttributes}\"&gt;\n                &lt;StackPanel Name=\"test\" Orientation=\"Horizontal\" VerticalAlignment=\"Center\"&gt;\n                    &lt;CheckBox Command=\"{StaticResource cbc}\"\n                              CommandParameter=\"{Binding Path=NameAndParent}\" Visibility=\"{Binding Path=CheckBoxVisible}\" IsChecked=\"{Binding Path=isChecked, Mode=TwoWay}\" VerticalAlignment=\"Center\"&gt;\n                    &lt;/CheckBox&gt;\n                    &lt;TextBlock Text=\"{Binding Path=NameAndCount}\" FontSize=\"16\"/&gt;\n                    &lt;/StackPanel&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n\n        &lt;/DockPanel.Resources&gt;\n        &lt;TreeView Name=\"treeView1\" BorderThickness=\"2\" ItemsSource=\"{Binding Source={StaticResource MyList}, UpdateSourceTrigger=PropertyChanged}\" TreeViewItem.Selected=\"filterByBatchStatus\"/&gt;\n    &lt;/DockPanel&gt;\n</code></pre>\n\n<p>C# code in ViewModel (pertaining to the problem):</p>\n\n<pre><code>public event PropertyChangedEventHandler PropertyChanged2;\n\nprotected void FirePropertyChanged2(string CheckBoxChecked)\n    {\n        if (PropertyChanged2 != null)\n        {\n            PropertyChanged2(this, new PropertyChangedEventArgs(CheckBoxChecked));\n        }\n    }\n\npublic static bool cbc;\n\npublic bool CheckBoxChecked\n    {\n        get { return (bool)GetValue(CheckBoxCheckedProperty); }\n        set { SetValue(CheckBoxCheckedProperty, value); }\n    }\n\npublic static readonly DependencyProperty CheckBoxCheckedProperty =\n        DependencyProperty.Register(\"CheckBoxChecked\", typeof(bool), typeof(OrderAttribute), new UIPropertyMetadata((bool)false));\n\nbool _isChecked;\n    public bool isChecked\n    {\n        get { return _isChecked; }\n\n        set\n        {\n            if (_isChecked != value)\n            {\n                _isChecked = value;\n                FirePropertyChanged2(\"CheckBoxChecked\");\n            }\n        }\n    }\n</code></pre>\n\n<p>If I load the values, update the booleans, and then expand the tree (So I can visually see them), the correct checkboxes are checked and everything works fine. The Problem comes into play when I load different checkboxes after initially visually seeing the first loaded checkboxes, change the booleans, then the Checkboxes do not change according, (dont change at all). </p>\n\n<p>The part that stumps me is that if i do multiple loads, change the booleans over and over, WITHOUT expanding the tree and VISUALLY SEEING the boxes, and then expand the tree, the correct boxes are checked. As soon as I can visually expand and see the checkboxes, any post loading does not update the checkboxes, regardless if whether or not I expand or unexpand the tree.</p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13161203,"title":"How to add Rectangle to menu item in WPF?","body":"<p>I was customizing the menu item with a rectangle. I need to remove all the characteristics in the default menu item and add the custom rectangle into the menu. I wasn't sure what property of menu item should be override? Any help?</p>\n"},{"tags":["c#","wpf","telerik","radgridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13134068,"title":"radgridview jump","body":"<p>I have this xaml:</p>\n\n<pre><code>&lt;Window x:Class=\"WPFExample.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"clr-namespace:WPFExample\"\n    xmlns:telerik=\"http://schemas.telerik.com/2008/xaml/presentation\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"\n    xmlns:sys=\"clr-namespace:System;assembly=mscorlib\"&gt;\n&lt;Window.Resources&gt;\n    &lt;x:ArrayExtension Type=\"{x:Type local:Model}\" x:Key=\"Models\"&gt;\n        &lt;local:Model StringProp=\"Some value\" Int32Prop=\"3\" /&gt;\n        &lt;local:Model StringProp=\"Another one\" Int32Prop=\"12\" /&gt;\n        &lt;local:Model StringProp=\"The same\" Int32Prop=\"132\" /&gt;\n        &lt;local:Model StringProp=\"Tired...\" Int32Prop=\"-5\" /&gt;\n        &lt;local:Model StringProp=\"End it\" Int32Prop=\"43\" /&gt;\n        &lt;local:Model StringProp=\"...\" Int32Prop=\"11\" /&gt;\n        &lt;local:Model StringProp=\"the end.\" Int32Prop=\"12\" /&gt;\n    &lt;/x:ArrayExtension&gt;\n&lt;/Window.Resources&gt;\n&lt;ScrollViewer ScrollViewer.VerticalScrollBarVisibility=\"Auto\"&gt;\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;telerik:RadGridView  x:Name=\"grid\" ItemsSource=\"{StaticResource Models}\"&gt;\n            &lt;telerik:RadGridView.Columns&gt;\n                &lt;telerik:GridViewColumn &gt;\n                    &lt;telerik:GridViewColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;ComboBox Width=\"200\"&gt;\n                                &lt;ComboBox.Items&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                &lt;/ComboBox.Items&gt;\n                            &lt;/ComboBox&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/telerik:GridViewColumn.CellTemplate&gt;\n                &lt;/telerik:GridViewColumn&gt;\n            &lt;/telerik:RadGridView.Columns&gt;\n        &lt;/telerik:RadGridView&gt;\n\n        &lt;telerik:RadGridView x:Name=\"grid1\" Grid.Row=\"1\" ItemsSource=\"{StaticResource Models}\"&gt;\n            &lt;telerik:RadGridView.Columns&gt;\n                &lt;telerik:GridViewDataColumn&gt;\n                    &lt;telerik:GridViewDataColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;ComboBox Width=\"200\"&gt;\n                                &lt;ComboBox.Items&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                &lt;/ComboBox.Items&gt;\n                            &lt;/ComboBox&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/telerik:GridViewDataColumn.CellTemplate&gt;\n                &lt;/telerik:GridViewDataColumn&gt;\n            &lt;/telerik:RadGridView.Columns&gt;\n        &lt;/telerik:RadGridView&gt;\n\n        &lt;telerik:RadGridView x:Name=\"grid2\" Grid.Row=\"2\" ItemsSource=\"{StaticResource Models}\"&gt;\n            &lt;telerik:RadGridView.Columns&gt;\n                &lt;telerik:GridViewDataColumn&gt;\n                    &lt;telerik:GridViewDataColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;ComboBox Width=\"200\"&gt;\n                                &lt;ComboBox.Items&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                    &lt;sys:String&gt;String 1&lt;/sys:String&gt;\n                                &lt;/ComboBox.Items&gt;\n                            &lt;/ComboBox&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/telerik:GridViewDataColumn.CellTemplate&gt;\n                &lt;/telerik:GridViewDataColumn&gt;\n            &lt;/telerik:RadGridView.Columns&gt;\n        &lt;/telerik:RadGridView&gt;\n    &lt;/Grid&gt;\n&lt;/ScrollViewer&gt;\n</code></pre>\n\n<p></p>\n\n<p>It's just simple window with three radgridviews, all of a kind.</p>\n\n<p>Problem: if one of radgridviews not entirely visible and i click on combobox within this radgridview, then it first jumps into view, and just then combobox click processed. How can i remove this behaviour, coz i don't need radgridview to be fully visible?</p>\n\n<p>Thank you.</p>\n"},{"tags":["wpf","triggers","datatrigger"],"answer_count":3,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":775,"score":12,"question_id":6499124,"title":"What's the difference between a Trigger and a DataTrigger?","body":"<p>They seem the same. Is there a significant difference? I think I am missing something.</p>\n"},{"tags":["c#","wpf","icommand"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13037231,"title":"Re-evaluating CanExecute on property change","body":"<p>I am trying to implement ICommandSource on a custom control (similar to a button). Currently the implementation is mostly like it is displayed on the msdn page for ICommandSource and as it shows in the ButtonBase source code.</p>\n\n<p>CanExecute fires on load of the control but doesn't fire when any property has changed. The same command being passed to a regular button works just fine. When the property that is supposed to change changes, CanExecute fires and the button is enabled. The command is a Delegate Command. </p>\n\n<p>I have tried CommandManager.InvalidateRequerySuggested(); but that has not worked. </p>\n\n<p>Any ideas?</p>\n\n<p>Here's the implementation in the custom control:</p>\n\n<pre><code>private static void OnCommandChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\n{\n    CollapsibleSplitButton csb = (CollapsibleSplitButton)d;\n    csb.OnCommandChanged((ICommand)e.OldValue, (ICommand)e.NewValue);\n}\n\nprivate void OnCommandChanged(ICommand oldCommand, ICommand newCommand)\n{\n    if (oldCommand != null) UnhookCommand(oldCommand);\n    if (newCommand != null) HookCommand(newCommand);\n}\n\nprivate void UnhookCommand(ICommand command)\n{\n    command.CanExecuteChanged -= OnCanExecuteChanged;\n    UpdateCanExecute();\n}\n\nprivate void HookCommand(ICommand command)\n{\n    command.CanExecuteChanged += OnCanExecuteChanged;\n    UpdateCanExecute();\n}\nprivate void OnCanExecuteChanged(object sender, EventArgs e)\n{\n    UpdateCanExecute();\n}\n\nprivate void UpdateCanExecute()\n{\n    if (Command != null)\n        CanExecute = Command.CanExecute(CommandParameter);\n    else\n        CanExecute = true;\n}\n\nprotected override bool IsEnabledCore\n{\n    get { return base.IsEnabledCore &amp;&amp; CanExecute; }\n}\n</code></pre>\n\n<p>Where I setup the Command I have:</p>\n\n<pre><code>...\n    MyCommand = new DelegatingCommand(DoStuff, CanDoStuff);\n...\n\nprivate bool CanDoStuff()\n{\n    return (DueDate == null);\n}\n\nprivate void DoStuff() {//do stuff}\n</code></pre>\n"},{"tags":["c#","wpf","usercontrols"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13163945,"title":"Overriding UserControl Properties in WPF","body":"<p>I'm brand new to <strong>WPF</strong>, so I'm a bit at a loss for how to do this. I created a very simple visual <code>UserControl</code> today that consists of a grid, displaying a circle with two dotted lines crossing through it. The intent is to display a circle of a given radius size. I'd <em>like</em> to be able to hide Height and Width, and use a custom property called <code>RadiusSize</code> to set the size of the control.</p>\n\n<p>The Code Behind defines the <code>RadiusSize</code> dependency property, as such:</p>\n\n<pre><code>public static readonly DependencyProperty RadiusSizeProperty =\n    DependencyProperty.Register(\"RadiusSize\", typeof(double), typeof(Radius));\n\npublic double RadiusSize\n{\n    get { return (double)GetValue(RadiusSizeProperty); }\n    set \n    { \n        SetValue(RadiusSizeProperty, value);\n        Height = value * 2;\n        Width = value * 2;\n        RaisePropertyChanged(\"RadiusSize\");\n    }\n}\n</code></pre>\n\n<p>There's no visible change to the Height or Width property when setting up the XAML for a given <code>Radius</code> control and passing it a <code>RadiusSize</code> unfortunately. If removed, they just default to <code>Auto</code>. Is what I want to do possible?</p>\n"},{"tags":["c#","wpf","mvvm","datatemplate"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":346,"score":5,"question_id":9133389,"title":"DataTemplates in WPF","body":"<p>I have a general question about data templates in WPF.  Let's say I have an abstract class called \"Question,\" and various subclasses like \"MathQuestion,\" \"GeographyQuestion,\" etc.  In some contexts, rendering the questions as a \"Question\" using the \"Question\" data template is good enough, but let's say that I have a list of random Question objects of varying subclasses that I want to display in-turn.  I want to display them to the user using their specific data templates rather than their generic Question data template, but since I don't know that at design time, is there anyway to tell WPF, \"hey, here's a list of Quesitons, but use reflection to figure out their specific types and use THAT data template?\"</p>\n\n<p>What I've thought of so far: I thought that in addition to having my question collection, I could create another collection of the specific types using reflection and somehow bind that to \"blah,\" then I'd get the desired affect, but you can only bind to DependencyProperties in WPF, so I'm not sure what I'd bind to.  I really don't like this idea, and my gut tells me there's a more elegant way to approach this problem.</p>\n\n<p>I'm not looking for specific code here, just a general strategy to accomplish what I'm trying to do.  Also, I'm using MVVM for the most part if that helps.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","visual-studio-2012","gmap.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13162703,"title":"trying to add Gmap.Net control to toolbox","body":"<p>I have a WPF application targetting .Net framework 4.5 in Visual Studio 2012.</p>\n\n<p>I have added references to GMap.NET.Core and System.Data.SQLLite.</p>\n\n<p>In my App.config I have added</p>\n\n<pre><code>   &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt; \n        &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\"/&gt;\n    &lt;/startup&gt;\n</code></pre>\n\n<p>I open my Map.xaml page in VS, open the toolbox, right click, hit choose items.</p>\n\n<p>Change tab to .NET Framework Components, Browse, select GMap.Net.WindowsForms.dll.  I see the entry for GMapControl pop up in the list, it's checked, I hit OK, I am then presented with the following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/nFeNO.png\" alt=\"enter image description here\"></p>\n\n<p>I never end up seeing the control in my toolbox.  Help!</p>\n\n<p>Edit: If I right click and hit <code>Show All</code>, I do see the control, it's just greyed out.</p>\n"},{"tags":["asp.net","wpf","mouse","multipoint"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12576865,"title":"A multipoint mouse WPF inside web browser?","body":"<p>I am trying to embed a WPF with multipoint mouse SDK registered inside the web browser using asp.net. I've tried to register the page instead of window but it seems like only enable to register only to window.</p>\n\n<p>Can i have a WPF window with limited width and height inside the web browser ?</p>\n\n<p>I'm still quite fresh in development so thanks and sorry if there's any relevant information or answer which have already been posted.</p>\n"},{"tags":["wpf","slimdx","directx-10","d3dimage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13163399,"title":"Resizing a WPF window while using SlimDX ( DirectX 10 ) can cause my model to disappear","body":"<p>I've had this issue for about 2 days now ( well that's how long I have been working on it! ).  I am using WPF and D3DImage to render a 3D model but using DirectX 10 via SlimDX.  Mostly everything is coming along fine but when I resize the window, the image can disappear!  It will come back if I minimise or click in the window ( which forces a render ).</p>\n\n<p>The problem is just forcing a render in resize isn't solving the problem!  It's a terrible user experience for their model to disappear ( even if it will come back ) and the only thing that has \"fixed\" this is to add Thread.Sleep(5) before coming out of the Resized Event handler.</p>\n\n<p>From what I have read this could be a timing issue between the CPU and GPU and I was just wondering if anyone else has ever had a similar problem as this?  If so does anyone have any ideas of how to fix it?</p>\n\n<p>Due to the models being Multisampled and using D3DImage the rendering is a 3-stage process.</p>\n\n<p>1 - Render to our Multisampled Render target.\n2 - Use this texture as a source for a shader and render to a quad\n3 - Take this texture and resolve it to a single-sampled texture which will be the appropriate format for a D3DImage.</p>\n\n<p>I'm hoping someone can understand any of what I'm writing ( I'm a useless describer! ) but either way this might pave the way for someone suffering a similar issue!  I am ( personally ) ok with the idea of sleeping for 5ms after a resize ( not on a standard render ) but I am told this looks more like a filthy hack than a solution * sigh *</p>\n\n<p>Thanks for reading :3</p>\n"},{"tags":["c#",".net","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13162806,"title":"Operator '+' cannot be applied to operands of type 'byte[]' and 'int'","body":"<p>I am a C++ developer and recently moved to C#. Now I am dealing with a textbox in my WPF app where I need to set the test of the textbox. Here is the code:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;TextBox Name=\"Data11\" MaxLength=\"2\" Grid.Column=\"0\" Text=\"{Binding Data11}\" /&gt;\n&lt;TextBox Name=\"Data12\" MaxLength=\"2\" Grid.Column=\"1\" Text=\"{Binding Data12}\" /&gt;\n</code></pre>\n\n<p>ViewModel Class:</p>\n\n<pre><code>private string _Data11;\n    public string Data11\n    {\n        get\n        {\n            return _Data11;\n        }\n\n        set\n        {\n            _Data11 = value;\n            OnPropertyChanged(\"Data11\");\n        }\n    }\n\n// Description of Data12\nprivate string _Data12;\npublic string Data12\n{\n    get\n    {\n        return _Data12;\n    }\n\n    set\n    {\n        _Data12 = value;\n        OnPropertyChanged(\"Data12\");\n    }\n}\n</code></pre>\n\n<p>Now on this textbox I need to set the text. Basically In my C++ app I had done it as follows:</p>\n\n<pre><code>m_matchData11-&gt;setText(String(String::toHexString((buffer+0), 1)), false);\nm_matchData12-&gt;setText(String(String::toHexString((buffer+1+4), 1)), false);\n</code></pre>\n\n<p>If you notice above, <strong>ToHexString</strong> Creates a string containing a hex dump of a block of binary data. I tried doing this in My WPF app as follows:</p>\n\n<pre><code>Data11 = BitConverter.ToString(buffer, 1);\nData12 = BitConverter.ToString((buffer + 4), 1);\n</code></pre>\n\n<p>Although first statement seems to work fine, second one throws the following error:</p>\n\n<p><code>Operator '+' cannot be applied to operands of type 'byte[]' and 'int'</code></p>\n\n<p>How can I achieve it? :)</p>\n"},{"tags":["c#","wpf","contextmenu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13147344,"title":"C# override default ContextMenu Style (WPF)","body":"<p>I am having a problem trying to change the style of the default ContextMenu in WPF.\nI not want to override de ContextMenu, I simple want to override the ContextMenu STYLE.\nIn all the sites, says that I must create each MenuItem of the ContextMenu, but I want to use the defaults MenuItems, and only change the style and add a border in the background.\nHow can I do it?</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type ContextMenu}\"&gt;\n    &lt;Setter Property=\"SnapsToDevicePixels\" Value=\"True\" /&gt;\n    &lt;Setter Property=\"OverridesDefaultStyle\" Value=\"True\" /&gt;\n    &lt;Setter Property=\"Grid.IsSharedSizeScope\" Value=\"true\" /&gt;\n    &lt;Setter Property=\"HasDropShadow\" Value=\"True\" /&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type ContextMenu}\"&gt;\n                &lt;Border x:Name=\"Border\" Background=\"#000\" BorderThickness=\"1\"&gt;\n                    &lt;ScrollViewer x:Name=\"ScrollViewer\"&gt;\n                        &lt;ItemsPresenter /&gt;\n                    &lt;/ScrollViewer&gt;\n                &lt;/Border&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["wpf","border","window-style"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":311,"score":1,"question_id":6935557,"title":"In WPF, how do I create a dialog-like window (i.e. gray background with no border around the client area)?","body":"<p>I'm trying to create a simple 'dialog'-type window in WPF.  However, for this specific instance, I do not want the client area to have a border, or even a background for that matter.  I just want my controls to appear over the background of the window the way they do with a simple MessageBox.</p>\n\n<p>I played with the different values for <code>WindowStyle</code> but they all called out the client area with a color.  I also tried simply setting the client's <code>Background</code> to transparent, but that didn't work either just rendering it in black.</p>\n\n<p>Here's a crappy Photoshop job showing what I'm after:</p>\n\n<p><em><strong>Note</em></strong>: <em>I'm not after the messagebox contents themselves--e.g. the icon, buttons and message, etc.--I'm only asking about how to suppress the client area from appearing in</em> <strong><em>any</em></strong> <em>window.  I just happened to use a messagebox as an example as someone linked to it in their answer.</em></p>\n\n<p><img src=\"http://i.stack.imgur.com/EwZ16.png\" alt=\"No client area\"></p>\n\n<p>As you can see (or rather can't) there is no visible demarcation of the client area.</p>\n\n<p>Used to be so simple in WinForms, but WPF has me stumped.  Anyone?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":12,"score":0,"question_id":13162537,"title":"Bind Application FontColor to Setting","body":"<p>Is it possible to Bind the Default Application FontColor to a Setting?</p>\n\n<p>I'am making an application to run in an application, the thing is i get a Fontcolor from the main application and now i have to make all TextBlocks the same color. \nThis is what i got so far but this isn't binded to a setting.</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type TextBlock}\"&gt;\n        &lt;Setter Property=\"Control.Foreground\" Value=\"Red\"/&gt;\n    &lt;/Style&gt;\n</code></pre>\n"},{"tags":["c#","wpf","listview","filter","observablecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13161373,"title":"How to filter ObservableCollection from various textbox (Multiple Criteria)?","body":"<p>I have a <code>ListView</code> that I'm filling with an <code>ObservableCollection</code> </p>\n\n<p>I'm filtering the list from text entered in a <code>TextBox</code></p>\n\n<p>Here's a section of the code I'm using:</p>\n\n<pre><code>    private void Filter_TextChanged(object sender, TextChangedEventArgs e)\n    {\n           view = CollectionViewSource.GetDefaultView(Elementos_Lista.ItemsSource);\n           view.Filter = null;\n           view.Filter = new Predicate&lt;object&gt;(FilterList);\n    }\n</code></pre>\n\n<p>This works okay if I want to filter a list by just one criteria, but whenever I want to mix more than 1 textbox to do the filtering it always filters based on the ItemsSource, and not the current result set, meaning that there's no accumulation of criteria.</p>\n\n<p>Here's my FilterList method.</p>\n\n<pre><code> ItemDetail item = obj as ItemDetail;  \n if (item == null) return false;\n string  textFilter = txtFilter.Text; \n if (textFilter.Trim().Length == 0) return true; //this returns the unfiltered results.\n if ((item.problema.ToLower().Contains(textFilter.ToLower()))) return true;  \n return false;  \n</code></pre>\n\n<p>Is there a way to filter the ObservableCollection (view) by multiple criteria, that aren't always provided at the same time?.</p>\n\n<p>I have tried to change the FilterList method to evaluate various textboxes, but I would have to make an IF statement to check all the possibilities of matching the criteria.</p>\n\n<pre><code>(filter1=value , filter2=value) OR \n(filter1=value , filter2=empty) OR \n(filter1=empty , filter2=value)\n</code></pre>\n\n<p>And since I'm planning to filter by at least 5 different controls, that wouldn't be fun at all.</p>\n\n<p>Example:</p>\n\n<pre><code>List:\nMaria, Age:26\nJesus, Age:15\nAngela, Age:15\n</code></pre>\n\n<p>First Filter</p>\n\n<pre><code>Filters:\nName: //Empty\nAge: 15\n\nResult:\nJesus, Age:15\nAngela, Age:15\n</code></pre>\n\n<p>Second Filter:</p>\n\n<pre><code>Filters:\nName: Jesus\nAge: 15\n\nResult:\nJesus, Age:15\n</code></pre>\n\n<p>What I'm trying to do is to apply filters to the already filtered collection, and not the original one, and this approach overwrites the applied filter with the next one.</p>\n"},{"tags":["wpf","xaml","crash","visual-studio-2012","designer"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13158862,"title":"Microsoft.Expression.DesignHost.Isolation.Remoting.RemoteException - Type universe cannot resolve assembly","body":"<p>I'm posting this to basically continue a thread that was closed:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/13131161/error-trying-to-open-a-vs-2010-project-in-vs-2012-type-universe-cannot-resolve\">\"Error trying to open a VS 2010 project in VS 2012 : Type universe cannot resolve assembly\"</a> by <a href=\"http://stackoverflow.com/users/1766173/user1766173\">user1766173</a></p>\n\n<p>I've dug deeper into the issue and narrowed some things down, so hopefully the discussion can be resumed. </p>\n\n<p>I'm using VS 2012 (and I don't have 2010 to compare to). My solution, <code>\"TWConsole\"</code>, was working fine on Friday, and as of Tuesday it was not. Both versions compile and run fine, but in the designer, no XAML file in the project can be opened without crashing. However, opening an XAML from a different project within the same solution works fine. Everything I've googled regarding this issue results in someone dealing with a 3rd party assembly. </p>\n\n<p>However, in my case the assembly that can't be resolved is my own--the one generated by the build. </p>\n\n<p>Interestingly, I've found that by \"secretly\" replacing the TWConsole.exe in the bin\\Debug folder with from last monday's build, everything works! ... that is, until I rebuild the solution, and that exe gets replaced, and then the XAML designer begins crashing. </p>\n\n<p>So there's something relating to new code I've added that is somehow \"infecting\" the main assembly. In the meantime before anyone can come to my rescue with a solution, I will start with the last-working solution and just add one line of code at a time until the problem surfaces, so as to pin-point the exact cause.</p>\n\n<p>Thanks</p>\n\n<p>EDIT: \nI've been able to narrow down the source of the problem to one line of code:</p>\n\n<pre><code>public static bool GetFavWashPkgs(out List&lt;WashPkg&gt; wPkgs)\n</code></pre>\n\n<p>If I remove the \"out\" keyword, then compile, the designer crashing problem is resolved. Same applies to the \"ref\" keyword--also a no-no in this case. I have tried for an hour to re-create this anomaly in a more basic test, using a test class and test function, but to no avail. All I can report is that this \"sensitive\" function is overloaded, the custom class WashPkg has the attribute [serializable()], and the class in which this function resides is static. If I modify the function declaration so that the type of List is int instead of WashPkg, the problem is also resolved. \nSo at this point it's still a mystery as to why the designer doesn't like that function declaration.</p>\n"},{"tags":["wpf","validation","wpf-usercontrols","adornerdecorator"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13111380,"title":"Validated Textbox in a UserControl","body":"<p>I have created a UserControl - a Labeled TextBox which is working pretty well, except for the validation template. When there's an error the validation control template shows up but it fills the whole space including the Label. I only want it to be as big as the TextBox. How to fix this?</p>\n\n<p>Here's the xaml:</p>\n\n<pre><code>&lt;UserControl x:Class=\"Infrastructure.CustomControls.LabelTextBox\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             x:Name=\"LTB\"&gt;\n\n    &lt;Grid HorizontalAlignment=\"{Binding}\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"Auto\"/&gt;\n            &lt;ColumnDefinition Width=\"*\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n\n        &lt;TextBlock x:Name=\"tbl\" FontFamily=\"{Binding}\" FontSize=\"{Binding}\" Text=\"{Binding ElementName=LTB, Path=LabelText}\" Height=\"{Binding ElementName=LTB, Path=LabelHeight}\" \n                   Width=\"{Binding ElementName=LTB, Path=LabelWidth}\" VerticalAlignment=\"Center\"/&gt;\n        &lt;TextBox x:Name=\"tbx\" Grid.Column=\"1\" FontFamily=\"{Binding}\" FontSize=\"{Binding}\" IsReadOnly=\"{Binding ElementName=LTB, Path=IsReadOnly}\" MaxLength=\"{Binding ElementName=LTB, Path=TextMaxLength}\" \n                 Text=\"{Binding ElementName=LTB, Path=Text}\" Height=\"{Binding ElementName=LTB, Path=TextHeight}\" Width=\"{Binding ElementName=LTB, Path=TextWidth}\" VerticalAlignment=\"Center\"&gt;\n            &lt;Validation.ErrorTemplate&gt;\n                &lt;ControlTemplate&gt;\n                    &lt;DockPanel LastChildFill=\"True\" ToolTip=\"{Binding ElementName=aep, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}\"&gt;\n                        &lt;TextBlock DockPanel.Dock=\"Right\" Foreground=\"Red\" FontSize=\"14pt\" Text=\"*\" Margin=\"-15,0,0,0\" FontWeight=\"Bold\"/&gt;\n                        &lt;Border BorderBrush=\"Red\" BorderThickness=\"1\"&gt;\n                            &lt;AdornedElementPlaceholder Name=\"aep\"/&gt;\n                        &lt;/Border&gt;\n                    &lt;/DockPanel&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Validation.ErrorTemplate&gt;\n        &lt;/TextBox&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n"},{"tags":["c#","wpf","data-binding"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13161959,"title":"Bind a WPF control to a ObeservableCollection modified by a background thread","body":"<p>This is a continuation of my <a href=\"http://stackoverflow.com/questions/13131305/threading-serial-port-query-and-using-the-result-in-a-listview-control\">previous question</a>\nHere's my mainwindow.cs </p>\n\n<pre><code>   public partial class MainWindow : Window\n{\n    ObservableCollection&lt;string&gt; store;\n    public MainWindow()\n    {\n     SerialPort _serialPort = new SerialPort(SerialCom.findCOMPort(), 115200, Parity.None, 8, StopBits.One);\n     _serialPort.Handshake = Handshake.None;\n     string[] query = new string[3] { \"t02\", \"t03\", \"t04\" };\n     store = new ObservableCollection&lt;string&gt; { \" \", \" \", \" \" };\n     this.DataContext = this;\n     Thread thread = new Thread(delegate(){Process(store,query,_serialPort);});\n     thread.IsBackground = true;\n     try\n     {\n        thread.Start(); //catch sudden serial port closure exception\n     }\n     catch (Exception)\n     {\n        thread.Abort();\n     }\n   }\n\n public static void Process(ObservableCollection&lt;string&gt; store, string[] query, SerialPort _serialPort)\n {          \n     while (true)\n     {             \n         for (int i = 0; i &lt; 3; i++)\n         {\n             string add = SerialCom.returnData(query[i], _serialPort);\n             if (store[i] != add)\n             {\n                 store.Insert(i,add);\n             }\n         }             \n         Thread.Sleep(300);\n\n     }\n }\n</code></pre>\n\n<p>I have a WPF listview control in my XAML page. I would like to bind that control to the ObservableCollection being changed in the non UI thread. It seems like the fly in the ointment is the infinite loop I have to query the device while the program is running.In addition, since ObservableCollection implements INotifyPropertyChanged, when I bind the collection to the control, the control should automatically update without any other code in code behind or XAML?</p>\n"},{"tags":["wpf","textblock","textwrapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13161966,"title":"WPF TextWrapping on white spaces","body":"<p>I am using a TextBlock in WPF, on which I want to use TextWrapping, What I have done in XAML is as follows.</p>\n\n<pre><code>&lt;TextBlock TextWrapping=\"Wrap\" Grid.Column=\"0\" Grid.ColumnSpan=\"4\" Grid.Row=\"0\" Margin=\"5,5,5,5\"&gt;\n                                &lt;TextBlock.Text&gt;\n                                    This is just a test. This is just a test.\n                                &lt;/TextBlock.Text&gt;\n                            &lt;/TextBlock&gt;\n</code></pre>\n\n<p>When I run this code it shows output like this </p>\n\n<pre><code>This is just a test. Th\nis is just a test.\n</code></pre>\n\n<p>But I only want wrapping on white spaces like</p>\n\n<pre><code>This is just a test.\nThis is just a test.\n</code></pre>\n\n<p>I am unable to find why WPF is showing this behavior, I have tried <code>WrapWithOverflow</code> and <code>IsHyphenationEnabled=true</code> with no success. Please help me out?</p>\n"},{"tags":["wpf","textbox","resize","border"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4979,"score":1,"question_id":997760,"title":"WPF Textbox & Borders - curious resizing behavior","body":"<p>The following XAML produces a window with strange behavior around the textbox:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfSandbox.CuriousExample\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"CuriousExample\" Height=\"300\" Width=\"300\"&gt;\n    &lt;DockPanel Margin=\"15\"&gt;\n        &lt;TextBox BorderThickness=\"1\" BorderBrush=\"#FF000000\"&gt;&lt;/TextBox&gt;\n    &lt;/DockPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>What happens, at least during my limited testing, is that the textbox renders with an inset border pattern (top/left is black, right/bottom is grey). However, when you resize to any position except the original, the entire textbox border goes to black. Whenever you return the window to the exact number of on-screen pixels the form had when it first loaded, it's inset again.</p>\n\n<p>I'm guessing it isn't pixel snapping as I can easily correct the problem with this code:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfSandbox.CuriousExample\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"CuriousExample\" Height=\"300\" Width=\"300\"&gt;\n    &lt;DockPanel Margin=\"15\"&gt;\n        &lt;Border BorderThickness=\"1\" BorderBrush=\"#FF000000\"&gt;\n            &lt;TextBox BorderThickness=\"0\" &gt;&lt;/TextBox&gt;\n        &lt;/Border&gt;\n    &lt;/DockPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Anyone care to venture an explanation as to what I'm seeing? Or is it all in my head?</p>\n\n<p>Like I said, the above workaround can resolve this problem - just trying to understand what is happening here.</p>\n\n<p>Thanks,</p>\n\n<p>-Scott</p>\n"},{"tags":["wpf","xaml","popup","eventtrigger"],"answer_count":3,"favorite_count":7,"up_vote_count":20,"down_vote_count":0,"view_count":36859,"score":20,"question_id":361209,"title":"How to open a WPF Popup when another control is clicked, using XAML markup only?","body":"<p>I've got two controls, a TextBlock and a PopUp. When the user clicks (MouseDown) on the textblock, I want to display the popup. I would think that I could do this with an EventTrigger on the Popup, but I can't use setters in an EventTrigger, I can only start storyboards. I want to do this strictly in XAML, because the two controls are in a template and I don't know how I'd find the popup in code.</p>\n\n<p>This is what conceptually I want to do, but can't because you can't put a setter in an EventTrigger (like you can with a DataTrigger):</p>\n\n<pre><code>&lt;TextBlock x:Name=\"CCD\"&gt;Some text&lt;/TextBlock&gt;\n\n&lt;Popup&gt;\n    &lt;Popup.Style&gt;\n        &lt;Style&gt;\n            &lt;Style.Triggers&gt;\n                &lt;EventTrigger SourceName=\"CCD\" RoutedEvent=\"MouseDown\"&gt;\n                    &lt;Setter Property=\"Popup.IsOpen\" Value=\"True\" /&gt;\n                &lt;/EventTrigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/Popup.Style&gt;\n...\n</code></pre>\n\n<p>What is the best way to show a popup strictly in XAML when an event happens on a different control?</p>\n"},{"tags":["c#",".net","wpf","dynamic","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13161085,"title":"Failing to generate dynamic textbox on radiobutton click in WPF","body":"<p>I am working on a WPF app where i have to generate 4 radiobuttons first and once I am done with it, I need to generate textboxes and labels on each button click. </p>\n\n<ul>\n<li>Generate 4 Radiobuttons with different <code>Content</code></li>\n<li>On clicking each button, generate 8 labels with different <code>Content</code> based on clicked button and generate 64 textboxes which are read only in such a way that each label has 8 textboxes associated with it. i.e. 8 x 8</li>\n</ul>\n\n<p>I have been successful to some extent by doing it as follows:</p>\n\n<p><strong>XAML:</strong> </p>\n\n<p>In my xaml, I have divided the grid in 2 rows. The first row will have 4 radiobuttons. The second row will be divided into 2 columns where 1st columns will have 8 dynamic labels and 2nd column will have 64 textboxes. i.e. 8 in each row.</p>\n\n<pre><code>&lt;Grid Grid.Row=\"0\"&gt;                     \n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\" &gt;\n                        &lt;RadioButton Content=\"{Binding RadioBase}\" Margin=\"0,10,0,0\" IsChecked=\"{Binding BaseCheck}\" GroupName=\"SlotGroup\" /&gt;                            \n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n\n        &lt;Button Content=\"Refresh Regs\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Grid.Row=\"1\" Margin=\"0\" Width=\"100\" Height=\"25\" /&gt;\n    &lt;/Grid&gt;\n\n&lt;Grid Grid.Row=\"1\"&gt;            \n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\" Grid.Column=\"0\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel&gt;\n                        &lt;ItemsControl Visibility=\"{Binding IsRegisterItemsVisible, Converter={StaticResource BoolToVisibilityConv}}\" ItemsSource=\"{Binding RegisterLabels}\"&gt;\n                            &lt;ItemsControl.ItemTemplate&gt;\n                                &lt;DataTemplate&gt;\n                                    &lt;StackPanel HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" Margin=\"50,20,0,0\"&gt;\n                                        &lt;TextBlock Text=\"{Binding}\"/&gt;\n                                    &lt;/StackPanel&gt;\n                                &lt;/DataTemplate&gt;\n                            &lt;/ItemsControl.ItemTemplate&gt;\n                        &lt;/ItemsControl&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\" Grid.Column=\"1\"&gt;\n            // Textbox here\n        &lt;/ItemsControl&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p><strong>FPGARadioWidgetViewModel Class:</strong> DataContext of this class is set here</p>\n\n<pre><code>public ObservableCollection&lt;FPGAViewModel&gt; Children { get; set; }\n\n    public FPGARadioWidgetViewModel()\n    {\n        Children = new ObservableCollection&lt;FPGAViewModel&gt;();\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x0\", ID = 0 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x40\", ID = 1 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x80\", ID = 2 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0xc0\", ID = 3 });            \n    }\n</code></pre>\n\n<p><strong>FPGAViewModel Class:</strong></p>\n\n<pre><code>private bool sBaseCheck;\n    public bool BaseCheck\n    {\n        get { return this.sBaseCheck; }\n        set\n        {\n            this.sBaseCheck = value;\n            Generatelabels(this, ID);\n            this.OnPropertyChanged(\"BaseCheck\");\n        }\n    }\n\n    private static void Generatelabels(FPGAViewModel currentItem, int index)\n    {\n        int m_baseRegister = 0;\n\n        if (index == 0)\n        {                \n            for (int i = 0; i &lt; 0x40 / 8; i++)\n            {\n                int reg = (i * 8) + m_baseRegister;\n                currentItem.RegisterLabels[i] = \"Reg 0x\" + reg.ToString(\"X\");\n                currentItem.IsRegisterItemsVisible = true;\n            }\n        }\n        else if (index == 1)\n        {\n            m_baseRegister = 0x40 * index;\n            for (int i = 0; i &lt; 0x40 / 8; i++)\n            {\n                int reg = (i * 8) + m_baseRegister;\n                currentItem.RegisterLabels[i] = \"Reg 0x\" + reg.ToString(\"X\");\n                currentItem.IsRegisterItemsVisible = true;\n            }\n        }\n        // Similarly for Index 2 and Index = 3\n    }\n\n    private string[] registerLabels = new string[8];\n    public string[] RegisterLabels { get { return registerLabels; } }\n\n    private bool isRegisterItemsVisible = false;\n    public bool IsRegisterItemsVisible\n    {\n        get { return isRegisterItemsVisible; }\n        set\n        {\n            isRegisterItemsVisible = value;\n            OnPropertyChanged(\"IsRegisterItemsVisible\");\n            OnPropertyChanged(\"RegisterLabels\");\n        }\n    }        \n\n    private string _RadioBase;\n    public string RadioBase\n    {\n        get; set;\n    }\n\n    private int _ID;\n    public int ID\n    {\n        get; set;\n    }\n</code></pre>\n\n<p>So if you notice the above viewmodel class, Index gives me the radiobutton clicked and I am able to generate labels with different values based on calculation. Hexadecimal conversion is done.</p>\n\n<p>Here is the requirement:</p>\n\n<ul>\n<li><p>When I click a radiobutton, the labels are getting displayed in <code>Grid.Column=\"0\"</code> but i want the textbox also to get placed accordingly. As described earlier, each button click will display 64 boxes, 8 for each label. Textbox must get displayed in <code>Grid.Column=\"1\"</code>.</p></li>\n<li><p>When i click a radibutton, label are displayed. When i click the next button, labels are displayed again. but the previous displayed labels are not cleared. I want to clear them before displaying new labels.</p></li>\n<li><p>On startup, 1st radiobutton must be checked and associated label + textbox must be displayed. </p></li>\n</ul>\n\n<p>Sample code I did in C++ where I was able to create textboxes:</p>\n\n<pre><code>for(i = 0; i &lt; 0x40; i++)\n{\n    m_registerGetValue[i] = new TextEditor();\n    m_registerGetValue[i]-&gt;setReadOnly(true);\n    addAndMakeVisible(m_registerGetValue[i]);\n}\n</code></pre>\n\n<p>Here is the screenshot: <img src=\"http://i.stack.imgur.com/QmWNp.jpg\" alt=\"For further details\">\nPlease help :)</p>\n"},{"tags":["c#","wpf","prism","mef","prism-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13147553,"title":"Region or ItemsSource for large data set in ListBox","body":"<p>I'm having trouble figuring out what the best solution is given the following situation. I'm using Prism 4.1, MEF, and .Net 4.0.</p>\n\n<p>I have an object <code>Project</code> that could have a large number (~1000) of <code>Line</code> objects. I'm deciding whether it is better to expose an <code>ObservableCollection&lt;LineViewModel&gt;</code> from my <code>ProjectViewModel</code> and manually create the Line viewmodels there OR set the ListBox as it's own region and activate views that way. </p>\n\n<p>I'd still want my <code>LineViewModel</code> to have Prism's shared services (IEventAggregator, etc.) injected, but I don't know how to do that when I manually create the <code>LineViewModel</code>. Any suggestions or thoughts?</p>\n\n<p>EDIT: My initial thoughts:</p>\n\n<p><strong>Project:</strong></p>\n\n<pre><code>public class Project\n{\n    public List&lt;Line&gt; Lines { get; set; }\n}\n</code></pre>\n\n<p><strong>ProjectViewModel:</strong></p>\n\n<pre><code>[Export(typeof(ProjectViewModel))]\n[PartCreationPolicy(CreationPolicy.NonShared)]\npublic class ProjectViewModel : NotificationObject, IRegionMemberLifetime\n{\n    private Project _localProject;\n\n    /* \n        HERE WILL BE SOME PROPERTIES LIKE COST, PRICE THAT ARE CUMULATIVE FROM THE Lines \n     */\n\n    public ObservableCollection&lt;LineViewModel&gt; Lines { get; private set; }\n\n    private readonly IEventAggregator _eventAggregator;\n\n    [ImportingConstructor]\n    public ProjectViewModel(IEventAggregator eventAggregator)\n    {\n        _eventAggregator = eventAggregator;\n        _eventAggregator.GetEvent&lt;ProjectLoaded&gt;().Subscribe(SetupProject, false);\n        Lines = new ObservableCollection&lt;LineViewModel&gt;();\n    }\n\n    private void SetupProject(Project project)\n    {\n        _localProject = project;\n\n        foreach(var l in _localProject.Lines)\n        {\n            LineViewModel lvm = new LineViewModel(l);\n            lvm.PropertyChanged += // Some handler here\n            Lines.Add(lvm);\n        }\n    }\n\n    public bool KeepAlive\n    {\n        get { return false; }\n    }\n}\n</code></pre>\n\n<p><strong>LineViewModel:</strong></p>\n\n<pre><code>public class LineViewModel : NotificationObject\n{\n    private Line _localLine;\n\n    public decimal Cost\n    {\n        get { return _localLine.Cost; }\n        set\n        {\n            _localLine.Cost = value;\n            RaisePropertyChanged(() =&gt; Cost);\n        }\n    }\n\n    public LineViewModel(Line incoming)\n    {\n        _localLine = incoming;\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","grid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13161186,"title":"WPF custom grid not showing content","body":"<p>I have a control, which I have inherited from Grid</p>\n\n<pre><code>&lt;Grid x:Class=\"User_Controls.CustomGrid\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n         mc:Ignorable=\"d\" x:Name=\"LayoutRoot\" \n         &gt;\n\n&lt;TextBlock&gt;Test&lt;/TextBlock&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>The code behind is, at the moment, blank</p>\n\n<pre><code> public partial class CustomGrid : Grid\n{\npublic CustomGrid(){}    \n}\n</code></pre>\n\n<p>I have an instance of CustomGrid inside another grid, on a page. </p>\n\n<pre><code>&lt;Grid Grid.Column=\"4\" Grid.Row=\"2\" Style=\"{StaticResource MenuItemStyle}\"&gt;\n            &lt;src:LiveTile  x:Name=\"liveTile1\" /&gt;    \n        &lt;/Grid&gt;\n</code></pre>\n\n<p>When I run the project, the value in the textfield isn't displayed. I've tried taking the control out of the parent grid, messing with fonts and vertical/horizontal alignments.</p>\n\n<p>any idea why I cant see the value? </p>\n"},{"tags":[".net","wpf","datagrid","scrollbar","virtualization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13160491,"title":"DataGrid scrollbar thumb changes size during scrolling","body":"<p>I have a grid that has rows in varying heights. I noticed that when I scroll down the grid, the scrollbar thumb changes its height.</p>\n\n<p>After some investigations I discovered that this is caused by UI virtualization: the grid doesn't create all the items so it doesn't know the total height of the grid, so instead it determines the total height by calculating the average row height of the rows it did create, and multiply this by the row count. This causes the thumb to change its size during scrolling since the virtualization creates new items and destroys the ones that are no longer displayed, which makes the grid think the total grid size has changed.</p>\n\n<p><strong>My question</strong>: Is there a way I can set the scroll thumb size myself using my own heuristics? Preferably with a non-intrusive way so I won't have to re-template my control. Disabling virtualization is not an option.</p>\n\n<p><img src=\"http://i.stack.imgur.com/HTQlx.png\" alt=\"\">\n<img src=\"http://i.stack.imgur.com/oIJ62.png\" alt=\"\"></p>\n\n<p>Note: I'm using DevExpress DataGrid, but this behavior also happens for WPF DataGrid.</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13159254,"title":"Save a WPF Web Browser's Content to an Excel File","body":"<p>I wanted to know if there is a way I can get the content of a Web Browser control and save it in a format that would open in Excel?  Currently I have an application that gets data from the user and converts it to a table and displays it in html in a WPF Web Browser control.  I can export this controls content successfully as a PDF document as follows:</p>\n\n<pre><code>string fileName = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + \".html\";\n\nFile.WriteAllText(fileName, generateHtml());\n\n//Creates a new instance of the Microsoft office interop for using MS Word\nMicrosoft.Office.Interop.Word.Application app = new Microsoft.Office.Interop.Word.Application();\napp.Visible = false;\nMicrosoft.Office.Interop.Word.Document doc = app.Documents.Open(fileName);\ndoc.SaveAs(\"C:\\\\Temp\\\\testExport.pdf\", 17);\napp.Quit();\n</code></pre>\n\n<p>This works fine for exporting a PDF file, the issue I am having is that I can't for the life of me get this to work with an excel file.  So far I am trying to do it like so:</p>\n\n<pre><code>  string filePath = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + \".html\";\n\n  File.WriteAllText(filePath, generateHtml());\n\n  //Creates a new instance of Microsoft office interop for using MS Excel\n  Microsoft.Office.Interop.Excel.Application excelApp = new Microsoft.Office.Interop.Excel.Application();\n  //Create a new instance of a workbook\n  Microsoft.Office.Interop.Excel.Workbook excelWorkBook = excelApp.Workbooks.Add();\n  //Don't Show MS Excel\n  excelApp.Visible = false;\n  //Open a file at location\n  Microsoft.Office.Interop.Excel.Workbook excelWorkBook2 = excelApp.Workbooks.Open(filePath);\n  //Convert that file to an XLSX document\n  excelWorkBook2.SaveAs(\"C:\\\\Temp\\\\testExport.xlsx\", Microsoft.Office.Interop.Excel.XlFileFormat.xlXMLSpreadsheet, Missing.Value, Missing.Value, false, false, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange, Microsoft.Office.Interop.Excel.XlSaveConflictResolution.xlUserResolution, true, Missing.Value, Missing.Value, Missing.Value);\n  //Close excel\n  excelApp.Quit();\n</code></pre>\n\n<p>However when I try and open the file that this generates I get the following error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Nc0rM.png\" alt=\"enter image description here\"></p>\n"},{"tags":["wpf","c#-4.0","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13160148,"title":"How to change background color of row in datagrid in wpf?","body":"<p>I want to change the background of row in datagrid if the value of a row item exceeds a certain value.</p>\n"},{"tags":["wpf","mvvm","navigation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13160069,"title":"MVVM Page Navigation","body":"<p>Have begun a WPF app following mvvm pattern and have hit an issue. I have a Customers page which has a number of searches and returns a list of customers. When I double click a record I want to be able to navigate to the Customer view so user can view/edit details. </p>\n\n<p>Is this possible without using MVVMLight or WAF or PRISM(as I have struggled for a bit getting head into PRISM fully!!!) without forcing my view model to have knowledge of my application?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","visual-studio-2010","dependency-properties","contentpresenter"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13144750,"title":"ContentPresenter of extended Window class not showing content at design-time","body":"<p>I am currently writing a Dialog class (lookless control) which extends Window, and am assigning a default ControlTemplate to that class using a XAML style.</p>\n\n<p>I want the 'Buttons' section of my Dialog template to be replacable, yet pre-populate it with a set of default buttons if nothing else is specified. This is why I added a <strong>dependency property</strong> called <code>ButtonContent</code> to my class. </p>\n\n<p>The <code>DefaultButtons</code> (see XAML below) are <strong>rendered correctly when I run the application</strong>, but <strong>Visual Studio 2010's design preview does not render the content</strong>. Why is this not happening?</p>\n\n<p>My dialog class looks like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class Dialog : Window\n{\n    public FrameworkElement ButtonContent\n    {\n        get { return (FrameworkElement)GetValue(ButtonContentProperty); }\n        set { SetValue(ButtonContentProperty, value); }\n    }\n\n    public static readonly DependencyProperty ButtonContentProperty =\n        DependencyProperty.Register(\"ButtonContent\", typeof(FrameworkElement), typeof(Dialog), new UIPropertyMetadata(null));\n\n    static Dialog()\n    {\n        DefaultStyleKeyProperty.OverrideMetadata(typeof(Dialog), new FrameworkPropertyMetadata(typeof(Dialog)));\n    }\n}\n</code></pre>\n\n<p>This is my XAML:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Style TargetType=\"{x:Type Dialogs:Dialog}\"&gt;\n    &lt;Setter Property=\"DataContext\" Value=\"{Binding RelativeSource={RelativeSource Self}}\"/&gt;     \n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type Dialogs:Dialog}\"&gt;\n                &lt;StackPanel&gt;\n                    &lt;ContentPresenter Content=\"{TemplateBinding ButtonContent}\"/&gt;\n                    &lt;TextBlock&gt;This text is rendered correctly&lt;/TextBlock&gt;\n                &lt;/StackPanel&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n\n    &lt;Setter Property=\"ButtonContent\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;!-- This stuff here is not shown in VS2010's preview --&gt;\n            &lt;UniformGrid Name=\"DefaultButtons\" Rows=\"1\" Columns=\"2\"&gt;\n                &lt;Button&gt;Button 1&lt;/Button&gt;\n                &lt;Button&gt;Button 2&lt;/Button&gt;\n            &lt;/UniformGrid&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>When I launch the app, it looks like this:</p>\n\n<p><img src=\"http://i48.tinypic.com/1t6fbp.png\" alt=\"As rendered by the app\"></p>\n\n<p>The VS2010 designer renders this:</p>\n\n<p><img src=\"http://i50.tinypic.com/nxw9bk.png\" alt=\"As rendered by VS2010\"></p>\n\n<hr>\n\n<p><strong>Edit:</strong> As described in the comments, placing the above style in Themes\\Generic.xaml instead of my resource dictionary included from App.xaml does not change anything.</p>\n\n<hr>\n\n<p><strong>Edit 2:</strong> If I explicitly override the default <code>ButtonContent</code> like this, the designer also does not show anything. At runtime, everything works perfectly:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Dialogs:Dialog x:Class=\"Dialogs.TestDialog\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:Dialogs=\"clr-namespace:Dialogs\"&gt;\n    &lt;Dialogs:Dialog.ButtonContent&gt;\n        &lt;Button&gt;Also not shown at design time&lt;/Button&gt;\n    &lt;/Dialogs:Dialog.ButtonContent&gt;\n&lt;/Dialogs:Dialog&gt; \n</code></pre>\n\n<hr>\n\n<p><strong>Edit 3:</strong> If I add the <code>ButtonContent</code> property to a <code>UserControl</code> instead of my <code>Dialog</code> class that extends <code>Window</code>, the <code>ButtonContent</code> is displayed correctly within the user control... also, VS2010 seems to apply the style defined above to <em>any</em> window, not just those of class <code>Dialog</code>, although I have set the TargetType appropriately... weird!</p>\n"},{"tags":["c#","wpf","mvvm","prism","prism-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13139934,"title":"PRISM 4 + MVVM + WPF + InteractionRequest for Dialogs with details","body":"<p>I am currently working on a project that is using PRISM 4 + MVVM in a WPF 4 application.  I have been reading up on InteractionRequest and there seems to be little information on how to implement it so that the dialog is a stylable user control and has textbox and other controls in it.  All the samples I find are just dialog windows with text in them.  </p>\n\n<p>What I am looking to do is have a listview that when a user selects an item it opens a dialog box where they can edit the details and either save or cancel.</p>\n\n<p>Is this the correct approach with WPF?  Should I be doing something other than InteractionRequest?  I generally do web applications so WPF is a bit new to me.</p>\n\n<p>Any assistance would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13152735,"title":"How to Print without displaying a print popup in WPF","body":"<pre><code>private void btnPrint_Click(object sender, RoutedEventArgs e)\n        {\n            PrintDialog dialog = new PrintDialog();\n            if (dialog.ShowDialog() == true)\n            {\n                StackPanel stpanel;\n                stpanel = PrintStakPanel;\n                stpanel.Measure(new Size(Double.PositiveInfinity, Double.PositiveInfinity));\n                Size grdSize = stpanel.DesiredSize;\n                Point grdPoint = new Point((dialog.PrintableAreaWidth - grdSize.Width) / 2, (dialog.PrintableAreaHeight - grdSize.Height) / 2);\n                stpanel.Arrange(new Rect(grdPoint, grdSize));\n                Grid.SetRow(stpanel, 0);\n                dialog.PrintVisual(stpanel, \"Cinema Ticket\");\n\n            }\n        }\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","architecture","preferences"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13159460,"title":"How to create a program architecture for user preferences using MVVM","body":"<p>I am trying to create a preference window for users, which they can manipulate (change preferences).\nI want to implement it in a proper way so do you have any suggestions for a good code architecture? By the way I am using the MVVM pattern for C# with WPF.</p>\n\n<p>Like, using a preferences class  in which all settings will be saved... or something like that.</p>\n\n<p>Thank you</p>\n"},{"tags":["wpf","binding","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13141972,"title":"WPF DataGrid binding list of string as row","body":"<p>I do not want use class properties for binding.</p>\n\n<p>Why it doesn't work? How I can fix this. I get empty rows. I have also manually defined columns for dataGrid.</p>\n\n<pre><code> private void Insert(IList&lt;string&gt; row, DataGrid dG)\n        {\n            ObservableCollection&lt;IList&lt;string&gt;&gt; data = dG.ItemsSource as ObservableCollection&lt;IList&lt;string&gt;&gt;;\n            data.Add(row);\n            dG.ItemsSource = data;\n        }\n</code></pre>\n\n<p>Sorry for My english.</p>\n\n<p>Regards.</p>\n"},{"tags":["wpf","binding","ribbon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13159658,"title":"WPF RibbonWindow and Binding","body":"<p>I have a RibbonWindow (.NET 4.5) with two listbox: \none is in the body of the window while the other is in  RibbonApplicationMenu.AuxiliaryPaneContent.</p>\n\n<p>Both of them have the ItemSource bind to</p>\n\n<pre><code>{Binding RelativeSource={RelativeSource AncestorType={x:Type RibbonWindow}, Mode=FindAncestor}, Path=MyProperty, UpdateSourceTrigger=PropertyChanged}\n</code></pre>\n\n<p>The problem is that only the listbox in the body works while the one in the menu gives the error \"System.Windows.Data Error: 4 : Cannot find source for binding with reference...\"</p>\n\n<p>Why it works in this way?\nHow can I fix the binding?</p>\n\n<p>PS: the binding does not work also if I set the binding ElementName to the name of the window</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13159333,"title":"Control validation in wpf which is inside a resource style C#","body":"<p>I'm using navigation window in wpf which has a style applied on it. Inside that style there are textboxes. I use MVVM pattern and my model implements IDataErrorInfo and returns error for these textboxes. Everything releated to data binding works just fine, but validation highlighting fails. There is no problem with styles, I have set special style for validation error for these textboxes. When I use the same not inside resource, then valdiation works correct.</p>\n"},{"tags":["wpf","xaml","expander"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3349,"score":2,"question_id":1396153,"title":"Preventing a WPF Expander from expanding when header is clicked","body":"<p>How can I prevent a WPF <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.expander.aspx\" rel=\"nofollow\"><code>Expander</code></a> from expanding when its header is clicked? I would like my <code>Expander</code> to expand or collapse only when the expand button itself is clicked.</p>\n\n<p>I imagine the answer has something to do with canceling a bubbled event. If possible I would like to implement the solution in XAML while avoiding retemplating the entire <code>Expander</code>.</p>\n"},{"tags":["wpf","twitterizer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13088435,"title":"how to get public timeline in twitterizer for WPF","body":"<p>I can get users tweets in my WPF application. I tried publictimeline with all overloaded methods but all are giving same problem System.NullReferenceException but when i try to get public tweets(public timeline); it fails. Below is my code.\n    using Twitterizer;</p>\n\n<pre><code>            TwitterResponse&lt;TwitterStatusCollection&gt; myTweets;\n            TwitterResponse&lt;TwitterStatusCollection&gt; publicTweets;\n            myTweets = TwitterTimeline.HomeTimeline(tokens);\n\n            foreach (var item in myTweets.ResponseObject)\n            {\n                String textStatus = item.Text;\n                myTweetsTB.AppendText(textStatus + Environment.NewLine);\n            }\n            publicTweets = TwitterTimeline.PublicTimeline();\n            foreach (var item in publicTweets.ResponseObject)\n            {\n                if (item != null)\n                {\n                    string textStatus = item.Text;\n                    publicTweetsTB.AppendText(textStatus + Environment.NewLine);\n                }\n                else return;\n            }\n</code></pre>\n"},{"tags":["c#","wpf","wpf-controls","contextmenu"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13157384,"title":"How to add Combobox as ContextMenu Item for Label Control. WPF app","body":"<p>I want to add combobox as ContextMenu item for some label control in wpf application in my code behind. How can I do it? I searched a lot over web but nothing comes productive.</p>\n"},{"tags":["c#","wpf","visual-studio-2010","visual-studio","visual-studio-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13155686,"title":"How to stop visual studio from changing properties of controls in WPF form when I add a new control to form using Designer?","body":"<p>I'm using visual studio ultimate 2010. In WPF form, I've a grid which contains many controls. Whenever I try to add a new control to the grid using designer, visual studio changes properties of all other controls in some way, like Grid.Row, Grid.Column property. Because of this I've to change those properties back manually. How can I stop visual studio from changing properties of certain controls in the wpf form? Is there any way that I can lock some controls in WPF form so that their properties doesn't change.\nEasy solution would be appreciated.\nThank You.</p>\n\n<p>I've seen some questions related to this but didn't find a good solution for this.</p>\n"},{"tags":["wpf","sqlite","c#-4.0","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13158448,"title":"SQLite and Entity Framework in Wpf App","body":"<p>Iam using SQLite and Entity Framework in my wpf app. It works fine in development machine, but when I deployed it to the other machine it doesn't work. I got the following error message</p>\n\n<pre><code>System.Data.EntityException: The underlying provider failed on Open. ---&gt;     \nSystem.Data.SQLite.SQLiteException: Unable to open the database file\nat System.Data.SQLite.SQLite3.Open(String strFilename, SQLiteOpenFlagsEnum flags, Int32  \nmaxPoolSize, Boolean usePool)\n</code></pre>\n\n<p>Can you give me suggesstion about \"How to publish wpf app with SQLite and entity framework?\"</p>\n"},{"tags":["c#","wpf","styles","errortemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13157250,"title":"WPF error template border dont show all text","body":"<p>I have some error checkings in my WPF application. Error message is shown next to the textbox but when is the textbox at the right side of application, it doesnt show all error text.</p>\n\n<p>The result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/r3vuv.png\" alt=\"Error message\"></p>\n\n<p>This is mine error template style:</p>\n\n<pre><code>&lt;ControlTemplate x:Key=\"errorTemplateStyle\"&gt;\n    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n        &lt;Border BorderThickness=\"1\" BorderBrush=\"#FFdc000c\" CornerRadius=\"0.7\"\n            VerticalAlignment=\"Top\"&gt;\n            &lt;Grid&gt;\n                &lt;Polygon x:Name=\"toolTipCorner\"\n                     Grid.ZIndex=\"2\"\n                     Margin=\"-1\"\n                     Points=\"6,6 6,0 0,0\" \n                     Fill=\"#FFdc000c\" \n                     HorizontalAlignment=\"Right\" \n                     VerticalAlignment=\"Top\"\n                     IsHitTestVisible=\"True\"/&gt;\n                &lt;Polyline Grid.ZIndex=\"3\"\n                      Points=\"7,7 0,0\" Margin=\"-1\" HorizontalAlignment=\"Right\" \n                      StrokeThickness=\"1.5\"\n                      StrokeEndLineCap=\"Round\"\n                      StrokeStartLineCap=\"Round\"\n                      Stroke=\"White\"\n                      VerticalAlignment=\"Top\"\n                      IsHitTestVisible=\"True\"/&gt;\n                &lt;AdornedElementPlaceholder x:Name=\"adorner\"/&gt;\n            &lt;/Grid&gt;\n        &lt;/Border&gt;\n        &lt;Border x:Name=\"errorBorder\" Background=\"#FFdc000c\" Margin=\"1,0,0,0\"\n            Opacity=\"0\" CornerRadius=\"1.5\"\n            IsHitTestVisible=\"False\"\n            MinHeight=\"24\" MaxWidth=\"267\"&gt;\n            &lt;Border.Effect&gt;\n                &lt;DropShadowEffect ShadowDepth=\"2.25\" \n                              Color=\"Black\" \n                              Opacity=\"0.4\"\n                              Direction=\"315\"\n                              BlurRadius=\"4\"/&gt;\n            &lt;/Border.Effect&gt;\n            &lt;TextBlock Text=\"{Binding ElementName=adorner,\n                                  Path=AdornedElement.(Validation.Errors)[0].ErrorContent}\"\n                   Foreground=\"White\" Margin=\"8,3,8,3\" TextWrapping=\"Wrap\"/&gt;\n        &lt;/Border&gt;\n    &lt;/StackPanel&gt;\n    &lt;ControlTemplate.Triggers&gt;\n        &lt;DataTrigger Value=\"True\"&gt;\n            &lt;DataTrigger.Binding&gt;\n                &lt;MultiBinding Converter=\"{StaticResource BooleanOrConverter}\"&gt;\n                    &lt;Binding ElementName=\"adorner\" Path=\"AdornedElement.IsKeyboardFocused\" /&gt;\n                    &lt;Binding ElementName=\"toolTipCorner\" Path=\"IsMouseOver\"/&gt;\n                &lt;/MultiBinding&gt;\n            &lt;/DataTrigger.Binding&gt;\n            &lt;DataTrigger.EnterActions&gt;\n                &lt;BeginStoryboard x:Name=\"fadeInStoryboard\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.15\"\n                                     Storyboard.TargetName=\"errorBorder\"\n                                     Storyboard.TargetProperty=\"Opacity\"\n                                     To=\"1\"/&gt;\n                        &lt;ThicknessAnimation Duration=\"00:00:00.15\"\n                                        Storyboard.TargetName=\"errorBorder\"\n                                        Storyboard.TargetProperty=\"Margin\"\n                                        FillBehavior=\"HoldEnd\"\n                                        From=\"1,0,0,0\"\n                                        To=\"5,0,0,0\"&gt;\n                            &lt;ThicknessAnimation.EasingFunction&gt;\n                                &lt;BackEase EasingMode=\"EaseOut\" Amplitude=\"2\"/&gt;\n                            &lt;/ThicknessAnimation.EasingFunction&gt;\n                        &lt;/ThicknessAnimation&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/BeginStoryboard&gt;\n            &lt;/DataTrigger.EnterActions&gt;\n            &lt;DataTrigger.ExitActions&gt;\n                &lt;StopStoryboard BeginStoryboardName=\"fadeInStoryboard\"/&gt;\n                &lt;BeginStoryboard x:Name=\"fadeOutStoryBoard\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00\"\n                                     Storyboard.TargetName=\"errorBorder\"\n                                     Storyboard.TargetProperty=\"Opacity\"\n                                     To=\"0\"/&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/BeginStoryboard&gt;\n            &lt;/DataTrigger.ExitActions&gt;\n        &lt;/DataTrigger&gt;\n    &lt;/ControlTemplate.Triggers&gt;\n&lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>Can you help me how to show all error message?</p>\n\n<p>Thanks Jakub</p>\n"},{"tags":["c#","wpf","wpf-listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13157074,"title":"how to find elements that are generated by a ListViewItem DataTemplate in WPF","body":"<p>I have a ListView in WPF Application with CheckBox inside.</p>\n\n<p>I am filling that ListView by DataTable with ChapterID and ChapterTitles</p>\n\n<pre><code>&lt;ListView x:Name=\"listViewChapter\" IsSynchronizedWithCurrentItem=\"True\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" BorderThickness=\"0\" SelectionMode=\"Multiple\" Margin=\"0,2,-1,3\" TabIndex=\"17\" Grid.ColumnSpan=\"2\"&gt;\n                &lt;ListView.GroupStyle&gt;\n                    &lt;GroupStyle&gt;\n                        &lt;GroupStyle.Panel&gt;\n                            &lt;ItemsPanelTemplate&gt;\n                                &lt;UniformGrid Columns=\"3\" /&gt;\n                            &lt;/ItemsPanelTemplate&gt;\n                        &lt;/GroupStyle.Panel&gt;\n                    &lt;/GroupStyle&gt;\n                &lt;/ListView.GroupStyle&gt;\n                &lt;ListView.ItemTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;StackPanel Orientation=\"Vertical\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Center\"&gt;\n                            &lt;CheckBox Name=\"chkChapterTitle\" VerticalAlignment=\"Center\" Margin=\"0,0,0,0\" Tag=\"{Binding ChapterID}\" Content=\"{Binding ChapterTittle}\" Checked=\"chkChapterTitle_Checked\" Unchecked=\"chkChapterTitle_Unchecked\" IsChecked=\"{Binding RelativeSource={RelativeSource AncestorType=ListViewItem},Path=IsSelected}\" /&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/ListView.ItemTemplate&gt;\n            &lt;/ListView&gt;\n</code></pre>\n\n<p>Now i want to access inside CheckBoxes checked that...</p>\n\n<p>My Code is...</p>\n\n<pre><code>        private void ToCheckChapters()\n    {\n        for (int i = 0; i &lt; listViewChapter.Items.Count; i++)\n        {\n\n            // Get a all list items from listbox\n            ListViewItem ListBoxItemObj = (ListViewItem)listViewChapter.ItemContainerGenerator.ContainerFromItem(listViewChapter.Items[i]);\n            //bool check = ListBoxItemObj.HasContent;\n            // find a ContentPresenter of that list item.. [Call FindVisualChild Method]\n            ContentPresenter ContentPresenterObj = FindVisualChild&lt;ContentPresenter&gt;(ListBoxItemObj);\n\n                // call FindName on the DataTemplate of that ContentPresenter\n                DataTemplate DataTemplateObj = ContentPresenterObj.ContentTemplate;\n                CheckBox Chk = (CheckBox)DataTemplateObj.FindName(\"chkChapterTitle\", ContentPresenterObj);\n                Chk.IsChecked = true;\n        }\n    }\n\n    private childItem FindVisualChild&lt;childItem&gt;(DependencyObject obj)\n    where childItem : DependencyObject\n    {\n        for (int i = 0; i &lt; VisualTreeHelper.GetChildrenCount(obj); i++)\n        {\n            DependencyObject child = VisualTreeHelper.GetChild(obj, i);\n            if (child != null &amp;&amp; child is childItem)\n                return (childItem)child;\n            else\n            {\n                childItem childOfChild = FindVisualChild&lt;childItem&gt;(child);\n                if (childOfChild != null)\n                    return childOfChild;\n            }\n        }\n        return null;\n    }\n</code></pre>\n\n<p>But in this code ContentPresenterObj is always null...</p>\n"},{"tags":["c#","wpf","xaml","binding"],"answer_count":6,"favorite_count":4,"up_vote_count":16,"down_vote_count":0,"view_count":3038,"score":16,"question_id":4875751,"title":"OneWayToSource Binding seems broken in .NET 4.0","body":"<p><code>OneWayToSource</code> Binding seems broken in .NET 4.0</p>\n\n<p>I have this simple piece of Xaml</p>\n\n<pre><code>&lt;StackPanel&gt;\n    &lt;TextBox Text=\"{Binding TextProperty, Mode=OneWayToSource}\"/&gt;\n    &lt;Button/&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>And my code behind looks like this</p>\n\n<pre><code>public MainWindow()\n{\n    InitializeComponent();\n    this.DataContext = this;\n}\nprivate string m_textProperty;\npublic string TextProperty\n{\n    get\n    {\n        return \"Should not be used in OneWayToSource Binding\";\n    }\n    set\n    {\n        m_textProperty = value;\n    }\n}\n</code></pre>\n\n<p><strong>In .NET 3.5</strong> this works as you might except. Put some text in the <code>TextBox</code>, press Tab to make it lose Focus, and the <code>TextProperty</code> updates with whatever text that was entered in the <code>TextBox</code></p>\n\n<p><strong>In .NET 4.0</strong>, if I type some text in the <code>TextBox</code> and then press Tab to make it lose Focus, the <code>TextBox</code> reverts to the value for <code>TextProperty</code> (meaning <strong>\"Should not be used in OneWayToSource Binding\"</strong>). Is this re-reading intended for a <code>OneWayToSource</code> Binding in .NET 4.0? I just want the <code>TextBox</code> to push its value into the <code>TextProperty</code> and not the other way around.</p>\n\n<p><strong>Update</strong><br>\nAdding a Bounty to this question as this has become a mayor inconvenience in my project and I would like to know the reason that this has changed. It seems that <code>get</code> is called after the Binding has updated the source. Is this the desired behavior for a <code>OneWayToSource</code> Binding in .NET 4.0?</p>\n\n<p><strong>If Yes</strong></p>\n\n<ul>\n<li>What was the problem with the way it worked in 3.5?</li>\n<li>In what scenarios is this new behavior better?</li>\n</ul>\n\n<p><strong>Or</strong> is this in fact a bug that we can hope to get fixed in a future release?</p>\n"},{"tags":["c#","wpf","silverlight","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13155397,"title":"How to hide xaml ui element in debug","body":"<p>I create a textbox in xaml to monitor a value. this is useful when developing but i would like to hide it when running in release compile. i know i can hide the texbox by setting visibility, but i would like to automate it.</p>\n\n<p>thanks.</p>\n"},{"tags":["wpf","mvvm","properties","source","setter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13152964,"title":"C# Property setter source","body":"<p>I have many .xaml files with TextBox bound to the same property in a model (MVVM). The textbox has UpdateSourceTrigger=PropertyChanged attribute set. The same property can also be modified from some backend code instead of being modified by user through the .xaml UI dialog. There is a requirement that if the property value is \"changed\" from the .xaml UI dialog, it toggles a flag to indicate that the user has changed the value. However, changes made from the backend code will not be toggle this flag. What is the best way to satisfy the above requirement given the fact that there are many .xaml files involved? I am thinking that if there is a way to find out the source in the property setter, then I will have a centralized mechanism to check if the value change comes from the bound TextBox and toggles the external flag. This will be a perfect solution without having to change all the .xaml files involved.</p>\n\n<p>Any comment and insight is appreciated.</p>\n\n<p>Cheers!</p>\n"},{"tags":["wpf","mvvm","observablecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13157060,"title":"Bind ObservableCollection to a Collection","body":"<p>I made a solution wich contains 4 projects, UI, BL, DAL and BO.</p>\n\n<ul>\n<li>UI : usercontrols, windows.</li>\n<li>BL : some logics, and a static class.</li>\n<li>Dal : a static class repository.</li>\n<li>BO : my objects ( Person, ...)</li>\n</ul>\n\n<p>The first 3 projects have reference to BO project, and UI refer to BL and BL to DAL.\nIn BL project I have a <strong>Collection</strong>, and in my UI (in a ViewModel) I have an <strong>ObservableCollection</strong>, the problem is the binding between these 2 Collections, for example, when I want to add a person, I have to do like that :</p>\n\n<pre><code>BL.Persons.Add( new Person() { Name = \"Paul\"});\nthis.Persons = new ObservableCollection&lt;Person&gt;(BL.Persons);\n</code></pre>\n\n<p>it works, but I'm not sure if it's the best way.</p>\n"},{"tags":["c#","wpf","silverlight","microsoft-metro"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13156508,"title":"Grid auto width","body":"<p>The question is simple as 1x1 and I suppose the answer is also that simple.</p>\n\n<p>I would like to fit my grid's width and height to it's content. So if I change the content's size from code I would like the grid to have the same size.</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>    &lt;Grid x:Name=\"ContainerGrid\" Background=\"Cyan\" MouseDown=\"ContainerGrid_Tapped_1\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"Auto\" /&gt;\n            &lt;ColumnDefinition Width=\"Auto\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"Auto\"/&gt;\n            &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;StackPanel Grid.Column=\"0\" Grid.Row=\"1\"&gt;\n            &lt;Rectangle x:Name=\"small\" Fill=\"Red\" Width=\"100\" Height=\"100\" Visibility=\"Visible\"/&gt;\n            &lt;Rectangle x:Name=\"big\" Fill=\"Green\" Width=\"500\" Height=\"500\" Visibility=\"Collapsed\"/&gt;\n        &lt;/StackPanel&gt;\n        &lt;Grid x:Name=\"SelectedCheckMark\"  Grid.Column=\"1\" Grid.Row=\"0\" Visibility=\"{Binding ElementName=big,Path=Visibility}\"&gt;\n            &lt;Path x:Name=\"SelectedEarmark\" Data=\"M0,0 L40,0 L40,40 z\" \n                  Fill=\"BlueViolet\" Stretch=\"Fill\"/&gt;\n            &lt;Path Data=\"F1 M133.1,17.9 L137.2,13.2 L144.6,19.6 L156.4,5.8 L161.2,9.9 L145.6,28.4 z\" \n                  Fill=\"White\" FlowDirection=\"LeftToRight\" \n                  HorizontalAlignment=\"Right\" Height=\"15\"  Stretch=\"Fill\" VerticalAlignment=\"Top\" Width=\"15\"/&gt;\n        &lt;/Grid&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>Code behind relevant part:</p>\n\n<pre><code>    private void ContainerGrid_Tapped_1(object sender, MouseButtonEventArgs e)\n    {\n        //Set opoosite visibility\n        small.Visibility = (small.Visibility == Visibility.Visible) ? Visibility.Collapsed : Visibility.Visible;\n        big.Visibility = (big.Visibility == Visibility.Visible) ? Visibility.Collapsed : Visibility.Visible;\n    }\n</code></pre>\n\n<p>I would like that no Cyan color could be seen in any state of the grid. However now the width of the ContainerGrid does not fit to it's content.</p>\n\n<p>What I've missed?</p>\n"},{"tags":["c#","wpf","themes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13156199,"title":"WPF options classic theme","body":"<p>I have the following resources XML in my grid:</p>\n\n<pre><code>&lt;Grid.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"/PresentationFramework.Classic;component/themes/classic.xaml\" /&gt;\n        &lt;/ResourceDictionary.MergedDictionaries&gt;\n    &lt;/ResourceDictionary&gt;\n&lt;/Grid.Resources&gt;\n</code></pre>\n\n<p>And this works, I load in the classic theme. But the classic theme button backgrounds are very white? Is there any way I can change the default background color of buttons in this theme?</p>\n"},{"tags":["wpf","templates"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13119879,"title":"Create a reusable user control with custom templates","body":"<p>I made a user control, and in my control I have \"Title\", graphically \"Title\" is a TextBlock, but I want those who use mon control will have the option to change it, so, the first idea is the create a property \"TitleTemplate\" that inherits from \"DataTemplate\", I'm just following the wpf logic, but I cant find any tutorial that can help me.</p>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13155751,"title":"Exception in WPF DataGrid if VirtualStackPanel is used","body":"<p>I'm using C# with .Net 4.0 and WPF DataGrid.\nSometimes I have the following exception during program execution.\nThe exception will be thrown if I change the value of some columns. Virtualization for DataGrid is activated (but only for rows, column virtualization is set to false).\nNow I need to know if it's a bug inside .Net.</p>\n\n<pre><code>An unhandled exception occured in GUI. Stack Trace - \"System.NullReferenceException:     \nObject reference not set to an instance of an object.\nat System.Windows.Controls.DataGridCell.OnCoerceIsReadOnly(DependencyObject d, Object    \nbaseValue)\nat System.Windows.DependencyObject.ProcessCoerceValue(DependencyProperty dp,   \nPropertyMetadata metadata, EntryIndex&amp; entryIndex, Int32&amp; targetIndex,   \nEffectiveValueEntry&amp; newEntry, EffectiveValueEntry&amp; oldEntry, Object&amp; oldValue, Object    \nbaseValue, Object controlValue, CoerceValueCallback coerceValueCallback, Boolean   \ncoerceWithDeferredReference, Boolean coerceWithCurrentValue, Boolean \nskipBaseValueChecks)\nat System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex,    \nDependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry,   \nEffectiveValueEntry&amp; newEntry, Boolean coerceWithDeferredReference, Boolean \ncoerceWithCurrentValue, OperationType operationType)\nat System.Windows.DependencyObject.CoerceValue(DependencyProperty dp)\nat System.Windows.Controls.DataGridHelper.TransferProperty(DependencyObject d,  \nDependencyProperty p)\nat System.Windows.Controls.DataGridCell.PrepareCell(Object item, DataGridRow ownerRow,    \nInt32 index)\nat System.Windows.Controls.Primitives.DataGridCellsPresenter.PrepareContainerForItemOverride( \nDependencyObject element, Object item)\nat System.Windows.Controls.ItemsControl.MS.Internal.Controls.IGeneratorHost.PrepareItemContainer(DependencyObject container, Object item)\nat  \nSystem.Windows.Controls.ItemContainerGenerator.System.Windows.Controls.Primitives.IItemContainerGenerator.PrepareItemContainer(DependencyObject container)\nat System.Windows.Controls.DataGridCellsPanel.InsertContainer(Int32 childIndex, UIElement container, Boolean isRecycled)\nat System.Windows.Controls.DataGridCellsPanel.AddContainerFromGenerator(Int32 childIndex, UIElement child, Boolean newlyRealized)\nat System.Windows.Controls.DataGridCellsPanel.GenerateChild(IItemContainerGenerator generator, Size constraint, DataGridColumn column, Int32&amp; childIndex, Size&amp; childSize)\nat System.Windows.Controls.DataGridCellsPanel.GenerateChildren(IItemContainerGenerator generator, Int32 startIndex, Int32 endIndex, Size constraint)\nat System.Windows.Controls.DataGridCellsPanel.GenerateAndMeasureChildrenForRealizedColumns(Size constraint)\nat System.Windows.Controls.DataGridCellsPanel.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\nat System.Windows.Controls.ItemsPresenter.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.Controls.Control.MeasureOverride(Size constraint)\nat System.Windows.Controls.Primitives.DataGridCellsPresenter.MeasureOverride(Size availableSize)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\nat System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\nat System.Windows.Controls.Grid.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.Controls.Border.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.Controls.Control.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.Controls.VirtualizingStackPanel.MeasureOverride(Size constraint)\nat System.Windows.Controls.Primitives.DataGridRowsPresenter.MeasureOverride(Size constraint)\nat System.Windows.FrameworkElement.MeasureCore(Size availableSize)\nat System.Windows.UIElement.Measure(Size availableSize)\nat System.Windows.ContextLayoutManager.UpdateLayout()\nat System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)\nat System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()\nat System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks()\nat System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)\nat System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)\nat System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\nat MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)\"\n</code></pre>\n"},{"tags":["c#","wpf","listview","gridview"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":139,"score":1,"question_id":12901530,"title":"using MVVM how to add selected listview item to another","body":"<p>I'm using MVVM. I have two listview. The first listview is fine, i'm able to populate it, it's an IEnuerable. What I want to achieve is when the items (row) in the first listview is clicked, I would like to add the selected to the second listview. Can anyone advise on this. </p>\n"},{"tags":["c#","wpf","contextmenu"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13157035,"title":"ContextMenu Header not working correctly","body":"<p>I need to have a ContextMenu on the rows of my DataGrid but i have Problems displaying the correct Text in the Header:</p>\n\n<p>This Works:</p>\n\n<pre><code> &lt;DataGrid.ContextMenu&gt;\n        &lt;ContextMenu Width=\"200\"&gt;\n            &lt;MenuItem Command=\"{Binding UseAsPatternCommand}\" Width=\"300\" Header = \"Use as Pattern\" &gt;\n\n            &lt;/MenuItem&gt;\n        &lt;/ContextMenu&gt;\n        &lt;/DataGrid.ContextMenu&gt;\n</code></pre>\n\n<p>This Dosn't:</p>\n\n<pre><code>&lt;DataGrid.ContextMenu&gt;\n        &lt;ContextMenu Width=\"200\"&gt;\n            &lt;MenuItem Command=\"{Binding UseAsPatternCommand}\" Width=\"300\" &gt;\n                    &lt;MenuItem.Header&gt;\n                        &lt;TextBlock Text=\"Use As Pattern\" VerticalAlignment=\"Center\" HorizontalAlignment=\"Center\"&gt;&lt;/TextBlock&gt;\n                    &lt;/MenuItem.Header&gt;\n\n                &lt;/MenuItem&gt;\n        &lt;/ContextMenu&gt;\n        &lt;/DataGrid.ContextMenu&gt;\n</code></pre>\n\n<p>And also this dosn't (Using LocalizationExtension):</p>\n\n<pre><code>    &lt;DataGrid.ContextMenu&gt;\n        &lt;ContextMenu Width=\"200\"&gt;\n            &lt;MenuItem Command=\"{Binding UseAsPatternCommand}\" Width=\"300\"  Header=\"{lex:Loc Pattern}\"&gt;\n            &lt;/MenuItem&gt;\n        &lt;/ContextMenu&gt;\n</code></pre>\n\n<p>Whats wrong with my code?</p>\n"},{"tags":["c#","wpf","onclick"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1106,"score":1,"question_id":5857004,"title":"Form close pop up window on click anywhere","body":"<p>I new to WPF C# and I'm looking for some direction. I have a text box that pops up on an error, I want the user to be able to click any where on the form to close this window.  I'm not really sure of what search terms to use or where to start.  Any help or smart ass comments like, \"have you heard of google\" are appreciated :)</p>\n\n<p>like,\nif mouse clicked\nhide();</p>\n\n<p>Thanks,\nrd42</p>\n\n<p>My final solution: </p>\n\n<pre><code>private void Button_Click(object sender, RoutedEventArgs e)\n{\n    this.Hide();\n}\n</code></pre>\n"},{"tags":["wpf","popup"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":465,"score":5,"question_id":7603457,"title":"Popup Never Closes","body":"<p>WPF is really getting me out of my nerves here. I configured a popup with some complex content (grid, buttons etc..). I set its StaysOpen property to False and IsOpen to True on a textbox MouseDown preview event. </p>\n\n<p>Ths thing is that it opens but never closes when clicking anywhere outside the window.</p>\n\n<p>Any suggestions? </p>\n\n<p>Thanks!</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>My popup has buttons inside. When I click one of those, the popup closes when I click outside of it. Is some weird stuff happening to the events routing?</p>\n"},{"tags":["wpf","datagrid"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":9037,"score":3,"question_id":884017,"title":"How can I bind Wpf DataGridColumn to an object?","body":"<p>I want to bind the columns of my WPF DataGrid to some objects in a Dictionary like this:</p>\n\n<p>Binding Path=Objects[i] </p>\n\n<p>where Objects is my Dictionary of objects, so that each cell will represent an Object element. How can I do that?</p>\n\n<p>I suppose that I need to create a template for my cell, which I did, but how to get the result of column binding in my template? I know that by default the content of a DataGridCell is a TextBlock and it's Text property is set through column binding result, but if that result is an object I guess that I have to create a ContentTemplate. How do I do that, as the stuff I tried is not displaying anything.</p>\n\n<p>Here it is what I tried:</p>\n\n<pre><code>&lt;Style x:Key=\"CellStyle\" TargetType=\"{x:Type dg:DataGridCell}\"&gt;\n    &lt;Setter Property=\"Template\"&gt; ---it should realy be ContentTemplate?\n      &lt;Setter.Value&gt;\n        &lt;ControlTemplate&gt;\n          &lt;controls:DataGridCellControl CurrentObject=\"{Binding }\"/&gt; -- I would expect to get the object like this for this column path : Path=Objects[i] but is not working\n        &lt;/ControlTemplate&gt;\n      &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n  &lt;/Style&gt;\n</code></pre>\n\n<p>So, to make myself completly clear, i want to get in CurrentObject property of my DataGridCellControl the current object that should result if I set the column binding in my data grid like this Path=Objects[i].</p>\n\n<p>Thank you for any suggestion,</p>\n\n<p>John.</p>\n"},{"tags":["sql","wpf","query","designer","builder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13156142,"title":"WPF query builder control","body":"<p>I wonder if there is any sql query builder out there meeting these conditions:</p>\n\n<ol>\n<li>Available as WPF control so that it can be integrated in my WPF app</li>\n<li>At least support of MS SQL Server and Oracle</li>\n<li>Visual representation and drag/drop support (tables, columns)</li>\n<li>SQL expression as a result property (no fancy \"user-friendly\" meta concept)</li>\n<li>Possibility to edit the SQL expression manually (with changes to the visual representation)</li>\n<li>No need to build up a metadata model before </li>\n</ol>\n\n<p>I already spend some time on the web with the following results </p>\n\n<ol>\n<li>ActiveQueryBuilder is functionally perfect but does not fit 1. (lacks WPF support)  [http://www.activequerybuilder.com/index.html?from=about&amp;edition=net]</li>\n<li>KorzhEasyQueryNET does not fit 5. (SQL is not written back to visual) and 6. (metadata model needed) [http://devtools.korzh.com]</li>\n<li>Query Objects is not a component but a standalone tool [http://www.query-objects.com/]</li>\n</ol>\n\n<p>So, is anybody out who knows of an alternative?</p>\n\n<p>Regards</p>\n"},{"tags":["wpf","entity-framework","validation","data-annotation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13156048,"title":"Database first and Wpf Entity Framework validation","body":"<p>I need to validate some user input in a c-sharp wpf desktop application. I'm using Entity framework with database-first approach. This is the class generated from the database by the Entity framework:</p>\n\n<pre><code>namespace TestValidation\n{\n    using System;\n    using System.Collections.Generic;\n\n    public partial class person\n    {\n        public string Name { get; set; }\n        public string Surname { get; set; }\n    }\n}\n</code></pre>\n\n<p>I'm trying to use a buddy class with DataAnnotations to implement validation:</p>\n\n<pre><code>using System.ComponentModel.DataAnnotations;\n\n    namespace TestValidation\n    {\n        [MetadataType(typeof(person_validation))]\n        public partial class person\n        {\n            public class person_validation\n            {\n                [Required]\n                public string Name { get; set; }\n            }\n        }\n    }\n</code></pre>\n\n<p>This is my xaml form:</p>\n\n<pre><code>&lt;Window\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:local=\"clr-namespace:TestValidation\" mc:Ignorable=\"d\" x:Class=\"TestValidation.MainWindow\"\n        Title=\"MainWindow\" Height=\"350\" Width=\"525\" Loaded=\"Window_Loaded_1\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;CollectionViewSource x:Key=\"personViewSource\" d:DesignSource=\"{d:DesignInstance {x:Type local:person}, CreateList=True}\"/&gt;\n    &lt;/Window.Resources&gt;\n    &lt;Grid&gt;\n        &lt;Grid x:Name=\"grid1\" DataContext=\"{StaticResource personViewSource}\" HorizontalAlignment=\"Left\" Margin=\"129,95,0,0\" VerticalAlignment=\"Top\"&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"Auto\"/&gt;\n                &lt;ColumnDefinition Width=\"Auto\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;Grid.RowDefinitions&gt;\n                &lt;RowDefinition Height=\"Auto\"/&gt;\n            &lt;/Grid.RowDefinitions&gt;\n            &lt;Label Content=\"Name:\" Grid.Column=\"0\" HorizontalAlignment=\"Left\" Margin=\"3\" Grid.Row=\"0\" VerticalAlignment=\"Center\"/&gt;\n            &lt;TextBox x:Name=\"nameTextBox\" Grid.Column=\"1\" HorizontalAlignment=\"Left\" Height=\"23\" Margin=\"3\" Grid.Row=\"0\" Text=\"{Binding Name, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}\" VerticalAlignment=\"Center\" Width=\"120\"/&gt;\n        &lt;/Grid&gt;\n        &lt;Button Content=\"Button\" HorizontalAlignment=\"Left\" Margin=\"162,217,0,0\" VerticalAlignment=\"Top\" Width=\"75\" Click=\"Button_Click_1\"/&gt;\n\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The validation of the property \"Name\" doesn't work. Where is the problem?\nthx</p>\n"},{"tags":["wpf","design-patterns","mvvm"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13156040,"title":"Nice and simple definition of WPF's MVVM","body":"<p>What is the basic definition of the Model, View and ViewModel objects in WPF's MVVM design pattern? What are their responsibilities, what each of them should and shouldn't do?</p>\n"},{"tags":["c#","wpf","silverlight","html5","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":120,"score":-4,"question_id":13155575,"title":"Is C#, XAML, Sliverlight, WPF going to die?","body":"<p>I really do not know what is going on, for once I felt like Microsoft made something I did like which is XAML. </p>\n\n<p>Now, we are all seeing that Microsoft has a new spoiled child HTML5/JS.</p>\n\n<p>Leaving the fact that I do not like that my application will be in clear text. I really do not understand why would Microsoft would such thing. </p>\n\n<p>Is it for other platforms compatibility? </p>\n\n<p>Why would any body now bother learn Silverlight or WPF as they are fading away?</p>\n\n<p>I know that Microsoft would say </p>\n\n<blockquote>\n  <p>\"Do not panic, we are still going to support the product\"</p>\n</blockquote>\n\n<p>but this is just to absorb the rage of the existing WPF/SL developers. </p>\n\n<p>And if anything history had shown us that all companies would say such thing before dumping the technology.</p>\n\n<p>My Question is: is HTML5/JS is going to take over C# and its technologies (Silverlight,WPF, XAML)?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13155015,"title":"ScreenShot as Button content","body":"<p>I want to do something similar to Microsoft Powerpoint: I want to capture the current screen (or one grid from the current window), and then to set it as the content of the button (like powerpoint where there is a preview of the slides at the side bar).</p>\n\n<p>What is the best way to do that? My current idea is to save it to PNG and then reload it as an image at the content of the button, but I'm sure there is a better way.</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13155112,"title":"Error:The calling thread cannot access this object because a different thread owns it","body":"<p>I have a Threading.timer that show a ballon in a special time.</p>\n\n<p>I use this code for show Balloon</p>\n\n<pre><code> var thread = new Thread(new ThreadStart(DisplayFormThread));\n\n        thread.SetApartmentState(ApartmentState.STA);\n        thread.Start();\n        thread.Join();\n\n private void DisplayFormThread()\n{\n    try\n    {\n        Show();\n    }\n    catch (Exception ex)\n    {\n        //  Log.Write(ex);\n    }\n}\n</code></pre>\n\n<p>it is my class for show ballon .</p>\n\n<pre><code> if (!Application.Current.Dispatcher.CheckAccess())\n    {\n        var action = new Action(() =&gt; ShowCustomBalloon(balloon, animation, timeout));\n        Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, action);\n        return;\n    }\n\n    if (balloon == null) throw new ArgumentNullException(\"balloon\");\n    if (timeout.HasValue &amp;&amp; timeout &lt; 500)\n    {\n        string msg = \"Invalid timeout of {0} milliseconds. Timeout must be at least 500 ms\";\n        msg = String.Format(msg, timeout);\n        throw new ArgumentOutOfRangeException(\"timeout\", msg);\n    }\n\n    Popup popup = new Popup();\n    popup.AllowsTransparency = true;\n    popup.PopupAnimation = animation;\n    popup.Child = balloon;\n    popup.Placement = PlacementMode.AbsolutePoint;\n    popup.StaysOpen = true;\n\n    Point position = new Point(SystemParameters.WorkArea.Width - ((UserControl)balloon).Width,\n             SystemParameters.WorkArea.Height - ((UserControl)balloon).Height);\n    popup.HorizontalOffset = position.X - 1;\n    popup.VerticalOffset = position.Y - 1;\n    //display item\n    popup.IsOpen = true;\n</code></pre>\n\n<p>when i show the balloon i get error :<strong>The calling thread cannot access this object because a different thread owns it</strong></p>\n\n<p>in this code i get error :</p>\n\n<blockquote>\n  <p>popup.Child = balloon;</p>\n</blockquote>\n"},{"tags":["c#","wpf","navigationwindow"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13155218,"title":"WPF NavigationWindow Pages and NavigationWindow.Template","body":"<p>I made a NavigationWindow display pages.And is OK. However when I add a background music like this:</p>\n\n<pre><code>&lt;NavigationWindow.Template&gt;\n    &lt;ControlTemplate TargetType=\"NavigationWindow\"&gt;\n        &lt;Canvas Name=\"MusicCanvas\" Background=\"Red\" Visibility=\"Hidden\"&gt;\n            &lt;MediaElement Name=\"MusicElement\" LoadedBehavior=\"Manual\" Visibility=\"Hidden\"&gt;\n                &lt;MediaElement.Triggers&gt;\n                    &lt;EventTrigger  RoutedEvent=\"NavigationWindow.Loaded\"&gt;\n                        &lt;EventTrigger.Actions&gt;\n                            &lt;BeginStoryboard&gt;\n                                &lt;Storyboard&gt;\n                                    &lt;MediaTimeline RepeatBehavior=\"Forever\" Source=\"../../Resource/xxxx.mp3\"&gt;\n                                    &lt;/MediaTimeline&gt;\n                                &lt;/Storyboard&gt;\n                            &lt;/BeginStoryboard&gt;\n                        &lt;/EventTrigger.Actions&gt;\n                    &lt;/EventTrigger&gt;\n                &lt;/MediaElement.Triggers&gt;\n            &lt;/MediaElement&gt;\n        &lt;/Canvas&gt;\n    &lt;/ControlTemplate&gt;\n&lt;/NavigationWindow.Template&gt;\n</code></pre>\n\n<p>it wouldn't display anything,but black. The canvas was hidden.\nI want to display my pages,how can I do with it? Thanks.</p>\n\n<p>Note: The result of debug is my pages is loaded but not displayed.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13154900,"title":"WPF System.ExecutionEngineException when adding PageFunction.Return handler","body":"<p>I have simple window in wpf application</p>\n\n<pre><code>&lt;Window ... &gt;\n     &lt;Frame  Name=\"contentFrame\" Margin=\"0 60 0 0\" Source=\"ContentPage.xaml\" NavigationUIVisibility=\"Hidden\"/&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>and simple page function named SettingsPage (public partial class SettingsPage : PageFunction in code-behind) . At some point i execute code in window code-behind</p>\n\n<pre><code>    SettingsPage settingsPage = new SettingsPage();\n    settingsPage.Return += settingsPage_Return;\n    contentFrame.NavigationService.Navigate(settingsPage);\n</code></pre>\n\n<p>where </p>\n\n<pre><code>public void settingsPage_Return(object sender, ReturnEventArgs&lt;bool&gt; e)\n    {\n        String test=\"test\";\n    }\n</code></pre>\n\n<p>In page function i execute code</p>\n\n<pre><code>OnReturn(false);\n</code></pre>\n\n<p>and getting System.ExecutionEngineException. \nI need to catch SettingsPage close event and i maked it when created delegate inside SettingsPage and manually raised it, \nbut i dont understand why standart WPF functionality not working.\nAnyone know why WPF raise error in this situation?</p>\n"},{"tags":["wpf","xls","fixeddocument"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13155133,"title":"How to Convert from fixeddocument to xls","body":"<p>How do I Convert from fixeddocument to xls?</p>\n\n<p>Is there is a way to convert from a fixeddocument to xls? I am using a fixeddocument to print xps but now I need the \"save as xls\" option.</p>\n\n<p>Do I have to loop through all the controls in the fixeddocument in order to convert it into xls one row at a time? Or is there a better way? I need to keep the formatting and layout as is. </p>\n\n<p>I am not looking for a third party control.</p>\n"},{"tags":["c#","wpf","image","thumbnails","dpi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13144615,"title":"RenderTargetBitmap renders image of a wrong size","body":"<p>My task is to show the user a thumbnail of each page of his XPS document. I need all the images to be small, so I render them with <em>dpi</em> set to 72.0 (I have googled that size of an A4 sheet with dpi 72.0 is 635x896). Basically, I do the following:</p>\n\n<pre><code>        List&lt;BitmapImage&gt; thumbnails = new List&lt;BitmapImage&gt;();\n        documentPaginator.ComputePageCount();\n        int pageCount = documentPaginator.PageCount;\n        for (int i = 0; i &lt; pageCount; i++)\n        {\n            DocumentPage documentPage = documentPaginator.GetPage(i);\n            bool isLandscape = documentPage.Size.Width &gt; documentPage.Size.Height;\n            Visual pageVisual = documentPage.Visual;\n            //I want all the documents to be less or equals to A4\n            //private const double A4_SHEET_WIDTH = 635;\n            //private const double A4_SHEET_HEIGHT = 896;\n            //A4 sheet size in px, considering 72 dpi\n            RenderTargetBitmap targetBitmap = new RenderTargetBitmap(\n            (int)(System.Math.Min(documentPage.Size.Width, A4_SHEET_WIDTH)),\n            (int)(System.Math.Min(documentPage.Size.Height, A4_SHEET_HEIGHT)),\n            72.0, 72.0,\n            PixelFormats.Pbgra32);\n            targetBitmap.Render(pageVisual);\n            BitmapFrame frame = BitmapFrame.Create(targetBitmap);\n            PngBitmapEncoder encoder = new PngBitmapEncoder();\n            encoder.Frames.Add(frame);\n            BitmapImage image = new BitmapImage();\n            using (System.IO.MemoryStream ms = new System.IO.MemoryStream())\n            {\n                encoder.Save(ms);\n                image.BeginInit();\n                image.CacheOption = BitmapCacheOption.OnLoad;\n                image.StreamSource = ms;\n                if (isLandscape)\n                {\n                    image.Rotation = Rotation.Rotate270;\n                }\n                image.EndInit();\n            }\n            thumbnails.Add(image);\n        }\n</code></pre>\n\n<p>But when I render a document page (A4) its size is actually <strong>846x1194</strong> instead of the one I expected. I tried to make the dpi lower (48.0) and the image's size has grown even bigger (I guess, I just do not quite undrestand what dpi is and how it affects the document). I tried to make <em>dpi=96.0</em>, and the size went smaller. I set one of images from the collection of instances of the class <code>BitmapImage</code> generated by the code above as source for the <code>Image</code> control (I am creating a WPF application) and in case dpi is set to 96.0 my program looks like this:  </p>\n\n<p><img src=\"http://i.stack.imgur.com/0W5Pl.png\" alt=\"Thumbnail displayed incorrectly\"><br>\nAs you can see, part of the page is not shown at all, it does not fit inside the <code>Image</code> control, even though the size of the control is set to <em>635x896</em> that's why according to the code above, the image must be displayed correctly and all the text must fit.<br>\nWhat result do I expect in a nutshell: I am trying to create thumbnails of the pages of a document, but I want them to be smaller, relative to some number (I am sorry, I am not quite sure how do I say such stuff in English, basically if the document's page width is 1200 px I want it to be <code>1200/n</code>, where <em>n</em> is the \"some number\" that I mentioned earlier), but if the shrinked image's size is still bigger than <em>635x896</em> I want the size to be <em>635x896</em>.<br>\nThanks in advance. And also I am sorry for my bad English.</p>\n"},{"tags":["c#","wpf","dynamic-data-display"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":877,"score":0,"question_id":11048533,"title":"Dynamic Data Display : Change X-Axis date time format for graph","body":"<p>I am working on wpf application where I am using <a href=\"http://dynamicdatadisplay.codeplex.com/\" rel=\"nofollow\">Dynamic Data Display</a> to show Graph. It works fine.</p>\n\n<p><strong>Problem :</strong></p>\n\n<p>please check this :</p>\n\n<p><img src=\"http://i.stack.imgur.com/I8SFW.jpg\" alt=\"enter image description here\"></p>\n\n<p>How can I use 12 hour time format instead of 24 hours? please suggest.</p>\n\n<p><strong>UPDATE :</strong></p>\n\n<p>This is my XAML for graph :</p>\n\n<pre><code> &lt;d3:ChartPlotter Name=\"plotter\" Margin=\"3,121,5,0\" Grid.RowSpan=\"2\" Height=\"373\" VerticalAlignment=\"Top\" VerticalContentAlignment=\"Stretch\" LegendVisible=\"False\"&gt;\n    &lt;d3:ChartPlotter.HorizontalAxis&gt;\n        &lt;d3:HorizontalDateTimeAxis Name=\"dateAxis\" /&gt;                                    \n    &lt;/d3:ChartPlotter.HorizontalAxis&gt;                                                               \n    &lt;d3:VerticalAxisTitle FontFamily=\"Georgia\" Content=\"Sensor Readings\" /&gt;\n    &lt;d3:HorizontalAxisTitle FontFamily=\"Georgia\" Content=\"Date\" /&gt;\n&lt;/d3:ChartPlotter&gt;\n</code></pre>\n\n<p>CS :</p>\n\n<pre><code>var dates = (from dr in datDs.Tables[0].AsEnumerable()\n                 select new\n                 {\n                     date = dr.Field&lt;DateTime&gt;(\"DateRecorded\")\n                 }.date).ToList();\n\nvar datesDataSource = new EnumerableDataSource&lt;DateTime&gt;(dates);\ndatesDataSource.SetXMapping(x =&gt; dateAxis.ConvertToDouble(x));\n</code></pre>\n"},{"tags":["c#","wpf","xaml","devexpress","multiselectlist"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13142364,"title":"Push some ObservableCollection items in a GridControl into another ObservableCollection XAML","body":"<p>I'd like to bind an ObservableCollection to a DevExpress GridControl but it's not working...</p>\n\n<p>My XAML code:</p>\n\n<pre><code>     &lt;dxg:GridColumn Header=\"Categorie\" FieldName=\"SelectetProgrammCategorieIds\"&gt;\n                    &lt;dxg:GridColumn.EditSettings&gt;\n                        &lt;dxe:ComboBoxEditSettings ItemsSource=\"{Binding AlleCategorien, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}\" ValueMember=\"ID\" DisplayMember=\"Name\"&gt;\n                            &lt;dxe:ComboBoxEditSettings.StyleSettings&gt;\n                                &lt;dxe:CheckedComboBoxStyleSettings/&gt;\n                            &lt;/dxe:ComboBoxEditSettings.StyleSettings&gt;\n                        &lt;/dxe:ComboBoxEditSettings&gt;\n                    &lt;/dxg:GridColumn.EditSettings&gt;\n                &lt;/dxg:GridColumn&gt;\n</code></pre>\n\n<p>SelectetProgrammCategorieIds is an OBC and AlleCategorien is my list with All Categories. I want do separate and load some marked items from AlleCategorien into SelectetProgrammCategorieIds</p>\n\n<p>greetings Venson</p>\n"},{"tags":["c#","wpf","mvvm","wpfdatagrid","caliburn.micro"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13086777,"title":"Caliburn.Micro and DataGrid: Reliable approach for detecting individual cell changes?","body":"<p>I have an MVVM-based WPF application that relies on <em>Caliburn.Micro</em>.</p>\n\n<p>In one view, I am displaying a <code>DataGrid</code> and a <code>Button</code>. The <code>DataGrid</code> displays a collection of items, where the item class derives from <code>PropertyChangedBase</code>.<br>\nThe button should be enabled or disabled based on the contents in the editable <code>DataGrid</code> cells. What is the most reliable approach to achieve this with <em>Caliburn.Micro</em>?</p>\n\n<p>Schematically, this is what my code looks right now:</p>\n\n<pre><code>public class ItemViewModel : PropertyChangedBase { }\n\n...\n\npublic class ItemsViewModel : PropertyChangedBase\n{\n    private IObservableCollection&lt;ItemViewModel&gt; _items;\n\n    // This is the DataGrid in ItemsView\n    public IObservableCollection&lt;ItemViewModel&gt; Items\n    {\n        get { return _items; }\n        set\n        {\n            _items = value;\n            NotifyOfPropertyChange(() =&gt; Items);\n        }\n    }\n\n    // This is the button in ItemsView\n    public void DoWork() { }\n\n    // This is the button enable \"switch\" in ItemsView\n    public bool CanDoWork\n    {\n        get { return Items.All(item =&gt; item.NotifiableProperty == some_state); }\n    }\n}\n</code></pre>\n\n<p>As the code stands, there is <em>no</em> notification to <code>ItemsViewModel.CanDoWork</code> when one <code>NotifiableProperty</code> is changed, for example when the user edits one cell in the <code>ItemsView</code>´s <code>DataGrid</code>. Hence, the <code>DoWork</code> button enable state will never be changed.</p>\n\n<p>One possible workaround is to add an (anonymous) event handler to every item in the <code>Items</code> collection:</p>\n\n<pre><code>foreach (var item in Items)\n    item.PropertyChanged += \n        (sender, args) =&gt; NotifyOfPropertyChange(() =&gt; CanDoWork);\n</code></pre>\n\n<p>but then I also need to keep track of when (if) items are added or removed from the <code>Items</code> collection, or if the <code>Items</code> collection is re-initialized altogether.</p>\n\n<p>Is there a more elegant and reliable solution to this problem? I am sure there is, but so far I have not been able to find it.</p>\n"},{"tags":["wpf","visual-studio","xaml","workflow-foundation-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13152186,"title":"How can I use types from a third party x64 dll in xamlx designer?","body":"<p>The problem is that VS2010sp1 is a 32bit app and won't load 64bit assemblies.</p>\n\n<p>I have made custom activities that reference types as InArgument/OutArguments from a 64bit 3rd party dll. (Or more generally, I have designer components that involve types from a 64bit dll that should be placed on a VS hosted WPF designer)</p>\n\n<p>These components cannot be then used in VS xaml/xamlx designers because VS is a 32bit app. How can this limitation be overcome, without asking the supplier to rebuild for AnyCPU?</p>\n"},{"tags":[".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13132180,"title":"ItemsControl and DataTemplate","body":"<p>Seems that it takes some time for a datatemplate to be set into a newly created item. This is simiar to <a href=\"http://stackoverflow.com/questions/2269319/how-can-i-retrieve-the-datatemplate-and-specific-objects-of-an-item-in-an-item\">How can I retrieve the DataTemplate (and specific objects) of an item in an ItemsControl?</a> but that doesnt provide a satisfactory answer as well.</p>\n\n<pre><code>var newIndex = this.Items.Add(new object()); // new \"data\"\nvar newContainer = (ContentPresenter) this.ItemContainerGenerator.ContainerFromIndex(newIndex);\nvar uiElem = newContainer.FindName(\"txt\");\n</code></pre>\n\n<p>The call to findname will return null, and so VisualTreeHelper.GetChildrenCount = 0. If I give it some time, the template is bound and all is well, but that's non-deterministic. Does anyone know of an event or a way to force the template to be bound immediately?</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13142600,"title":"Stackoverflow with WPF Calendar when using DisplayDateStart binding","body":"<p>I have a little problem.</p>\n\n<p>My small WPF Project with a normal Calendar get a System.StackOverflowException Exception, when I try to use  <code>DisplayDateStart=\"{Binding DisplayDate.Date.Date.Now, ElementName=MeinCalendar, Mode=OneWay}\"</code> Binding.</p>\n\n<p>I can start my Project without any errors, but when I click the Back and Next button a few times.Calendar throws the <code>System.StackOverflowException</code> Exception.</p>\n\n<p>When I start the project without Binding this Exception is not more there.</p>\n\n<p>How can I fix this bug?</p>\n\n<pre><code>&lt;Window x:Class=\"WpfMVVMtest.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n&lt;Calendar  x:Name=\"calendar\" DisplayDateStart=\"{Binding DisplayDate.Date.Now, ElementName=calendar, Mode=OneWay}\" &gt;&lt;/Calendar&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["wpf","stringformat"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13149679,"title":"wpf string format integer 1234 to 12:34 only in XAML","body":"<p>I have 1234 value and I have to show it as 0012:34 and when user clicks on that text box to edit the value, it should display only 1234  and when tabs out it should go back to 0012:34. If I use a converter, it does not change the format when got focus. I have this text box inside a data template and cannot access it in code behind also, meaning, I cannot do the formatting in Got_Focus event. Can anyone help with the formatting please?\nI can use int or string as the datatype.</p>\n\n<p>Thanks,\nRosy</p>\n"},{"tags":["c#","wpf","wpftoolkit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13152082,"title":"Error while Programmatically adding chart control in WPF","body":"<p>I am trying to programmatic-ally add a Chart in WPF and then add a Bar graph to it, however I get an error which states that chart.cs or DataPointSeries.cs is missing. I have added the Toolkit dll. Also if I remove the Bar1.Itemsource code the chart works but with no graph but with a legend. Any ideas?</p>\n\n<pre><code>Chart Ch1 = new Chart();\n\n\nBarSeries Bar1 = new BarSeries();\nList&lt;KeyValuePair&lt;string, int&gt;&gt; valueList = new List&lt;KeyValuePair&lt;string, int&gt;&gt;();\nvalueList.Add(new KeyValuePair&lt;string, int&gt;(\"Tom\", 2220));\nvalueList.Add(new KeyValuePair&lt;string, int&gt;(\"Jim\", 23330));\n\nBar1.ItemsSource = valueList;\n\nBar1.IndependentValuePath = \"Key\";\nBar1.IndependentValuePath = \"Value\";   \n\n\nCh1.Name = \"BarChart\";\nCh1.Series.Add(Bar1);\n\nGrid Backgrid = new Grid();\nBackgrid.Children.Add(Ch1);\n</code></pre>\n"},{"tags":["c#",".net","wpf","mvvm","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13151938,"title":"Failing to store combobox item using a string variable in WPF","body":"<p>I am a C++ developer and just started working on WPF. Following MVVM, I am working on comboboxes where I have to add items in it. Well adding items in it seems to be quite easy but I have come across a simple issue where I am not able to figure out what to do. Here is the code:</p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;ComboBox Grid.Row=\"0\" ItemsSource=\"{Binding DaughterBoardBoxList}\" SelectedItem=\"{Binding SelectedDaughterBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" /&gt;\n&lt;ComboBox Grid.Row=\"1\" ItemsSource=\"{Binding DaughterVersionBoxList}\" SelectedItem=\"{Binding SelectedDaughterVersionBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" /&gt;\n&lt;ComboBox Grid.Row=\"2\" ItemsSource=\"{Binding DaughterSerialBoxList}\" SelectedItem=\"{Binding SelectedDaughterSerialBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" /&gt;\n</code></pre>\n\n<p><strong>ViewModel Class:</strong></p>\n\n<pre><code>public ObservableCollection&lt;string&gt; DaughterBoardBoxList\n    {\n        get { return _DBoardBoxList; }\n        set\n        {\n            _DBoardBoxList = value;\n            OnPropertyChanged(\"DaughterBoardBoxList\");\n        }\n    }\n\n    public string _SelectedDBoardBoxList;\n    public string SelectedDaughterBoardBoxList\n    {\n        get { return _SelectedDBoardBoxList; }\n        set\n        {\n            _SelectedDBoardBoxList = value;\n            OnPropertyChanged(\"SelectedDaughterBoardBoxList\");\n        }\n    }\n\n// Similarly for other 2 comboboxes\n</code></pre>\n\n<p>I have added items in each combobox as follows: </p>\n\n<ul>\n<li>DaughterBoardBoxItems = \"S1010013\", \"S1010014\", \"S1010015\" etc</li>\n<li>DaughterVersionBoxItems =  \"001A\", \"001B\", \"001C\" etc</li>\n<li>DaughterSerialBoxItems = 1 to 499</li>\n</ul>\n\n<p>I Have added from 1 - 499 as follows: </p>\n\n<pre><code>for (int j = 1; j &lt; 500; j++)\n{\n      _DSerialBoxList.Add(j.ToString());\n} \n</code></pre>\n\n<p>Now on performing some operation I need to execute few statements which are as follows:</p>\n\n<pre><code>String daughterBoard = \"S1010015001A0477\"; // Hardcoded value for check\nString boardName = daughterBoard.Substring(0, 8);\nDaughterBoardBoxList = boardName;\n\nString version = daughterBoard.Substring(8, 12);\nDaughterVersionBoxList = version;\n\nint serialvalue = Convert.ToInt32(daughterBoard.Substring(12, 16));\nString serialNo = Convert.ToString(serialvalue);\nDaughterSerialBoxList = serialNo;\n\nlonglabel += daughterBoard;\n</code></pre>\n\n<p>When I execute the above code, it throws me exception at <code>String version = daughterBoard.Substring(8, 12);</code> as <code>Argumentoutofrange. Index and length must refer to a location within the string.</code></p>\n\n<p>Requirement:</p>\n\n<ul>\n<li><p>Now this where I am confused how do I set the values present in <code>boardName</code>, <code>version</code> and <code>serialNo</code> in the combobox without having to face any exception. I don think combobox has settext property. Is their an other alternative solution to achieve this?</p></li>\n<li><p>Even though I enter values from 0 to 499, it should appear as 4 digit value i.e. if 77 is added, it should appear as 0077. As I have mentioned in the above code.</p></li>\n</ul>\n\n<p>Please help :)</p>\n"},{"tags":["wpf","xaml","resourcedictionary","prism-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12066125,"title":"How to set a relative path/Uri in ResourceDictionary's source","body":"<p>I am trying to refer to a MergedDictionaries.SharedStyles project which has all Styles that has to be used allover application. So here i have different styles under different folders as Resource Dictionaries. so finally i have Merged them into AllSharedStyles.xaml and have that at Styles project level.</p>\n\n<p>Now I have another ResourceDictionary at Solution level &lt;> which refers to AllSharedStyles.xaml resource dictionary &lt;&lt;>>. This ResourceDictionary is added as a link to all my modules in solution. </p>\n\n<p>Issue here is In my SharedResourceDictionary i am having following MergedDictionaries</p>\n\n<pre><code>&lt;ResourceDictionary.MergedDictionaries&gt;\n    &lt;ResourceDictionary Source=\"/MergedDictionaries.SharedStyles;component/AllSharedStyles.xaml\" /&gt;\n    &lt;ResourceDictionary Source=\"/View/LocalResource.xaml\" /&gt; \n&lt;/ResourceDictionary.MergedDictionaries&gt;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/Qbdly.png\" alt=\"Project architecture\"></p>\n\n<p>I have refered to common Resource first then my local inorder to override(only if required) any styles specific to module.</p>\n\n<p>Now  when i run the application it complains </p>\n\n<pre><code>'Set property 'System.Windows.ResourceDictionary.Source' threw an exception.' Line number '5' and line position '10'.\n</code></pre>\n\n<p>Thats the error message.</p>\n\n<p>With my understanding it is looking for proper reference. I also tried using Pack URL ref: <a href=\"http://msdn.microsoft.com/en-us/library/aa970069.aspx\" rel=\"nofollow\">Pack URLss</a>.\nHere is the pack url:</p>\n\n<pre><code> &lt;ResourceDictionary Source=\"pack://application:,,,/MergedResourceDictionaries.Styles;component/component/AllSharedStyles.xaml\" /&gt;\n</code></pre>\n\n<p>So any suggestions on How to have a relative path here????</p>\n\n<p>Sorry for my description/projection of problem</p>\n"},{"tags":["wpf","mvvm","prism","prism-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13151857,"title":"How to access parent usercontrol's datacontext.property in injected usercontrol using prism WPF","body":"<p>Hi I am working with WPF PRISM architecture.</p>\n\n<p>I have two usercontrols:\nUCParent--UCParentVM\nUCChild  -- UCChildVM\nBoth have their own viewmodels.\nNow that I  have injected UCChild into UCParent. But I want to access a property (\"UCParent.DataContext.ProeprtyForChild\") in the Parent usercontrol UCParent. How do I able to get the parent's DataContext.Property?</p>\n\n<p>I Tried some relative source and element name binding. I think i am getting them completely wrong. So any clues?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","wpf","datagrid","checkbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3648,"score":1,"question_id":5224181,"title":"How to Add Check Box in Datagrid WPF c#","body":"<p>Hi i want to add check box in datagrid view.i have writen test code but fails.\nWhat i am trying to do is Add a CheckBox in datagrid with the items i add into it\nwith select all and select none option.</p>\n\n<p>I donot know how to do it so i need some help.I am confused with a thing that if we add then dynamically how would we track which checkbox was checked or un checked.</p>\n\n<p>I have current code </p>\n\n<pre><code>    public partial class MainWindow : Window\n    {\n        List&lt;checkedBoxIte&gt; item = new List&lt;checkedBoxIte&gt;();\n        public MainWindow()\n        {\n            InitializeComponent();\n            for (int i = 0; i &lt; 5; i++)\n            {\n                checkedBoxIte ite = new checkedBoxIte();\n                ite.sr = i.ToString();\n                ite.ch = new CheckBox();\n                item.Add(ite);\n            }\n            dataGrid1.ItemsSource = item\n        }\n    }\n    public class checkedBoxIte\n    {\n       public string sr {get;set;}\n       public CheckBox ch { get; set; }\n    }\n</code></pre>\n\n<p>but i know it is stupidest thing to add checkbox like this but it was just a try\nAbove class contains two attributes later on it would have more but all will be strings</p>\n"},{"tags":["c#","wpf","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":13100975,"title":"WPF WebBrowser Control and security message","body":"<p>I use the WPF WebBrowser as follow. When I use this in a new autonom Application, I became the following message at top of the browser:\n<img src=\"http://i.stack.imgur.com/Gdvml.png\" alt=\"enter image description here\"></p>\n\n<p>on english:</p>\n\n<p>showing active content that access to the computer has restricted this file for security reasons. Click here for more options ...</p>\n\n<p>When I use the same code in a existing application on the same machine (the exactly same code - as a seperate window), the Message is not shown. \nDoes someone can help me, why this message is not shown when I use the webbrowser-Control (copied the code) in an existing application? - Thanks.</p>\n\n<p>CodeBehind:</p>\n\n<pre><code>public partial class MainWindow : Window {\n    public MainWindow() {\n        InitializeComponent();\n    }\n\n    private void Button_Click_1(object sender, RoutedEventArgs e) {\n        var path = @\"C:\\temp\\WpfApplication1\\MHTBody_5f9d8e2b-9dee-42a6-959c-0edfc43b5daf.proconactNavigating.mht\";\n        this.webBrowser.Navigate(path);\n    }\n}\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfApplication1.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"1674.761\" Width=\"900.637\"&gt;\n    &lt;Grid&gt;\n        &lt;Button Height=\"20\" VerticalAlignment=\"Top\" Click=\"Button_Click_1\" /&gt;\n        &lt;WebBrowser x:Name=\"webBrowser\" Margin=\"0,31,0,0\" /&gt;\n\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>New Informations:</strong></p>\n\n<p>When I add in the sample-Application (in the new autonom application), where the MainWindow is in and the securitybar is shown Settings to the application and access this, before I open the MainWindow, the securitybar will not be shown anymore and it will take long more time to load the mht.</p>\n\n<p>Concret: </p>\n\n<p>When I dot this, it will not show the securitybar:</p>\n\n<pre><code>public partial class App : Application {\n    protected override void OnStartup(StartupEventArgs e) {\n        var x = Settings.Default.test;\n        base.OnStartup(e);\n    }\n}\n</code></pre>\n"},{"tags":["wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13151190,"title":"Reusable/Terse Way of Transitioning Between Views/ViewModels in WPF without code-behind","body":"<p><strong>THE WHAT</strong></p>\n\n<p>It's bugged me for months, but I finally figured out a generic way to transition between views in WPF--a way that allows me to use whatever animation I want to for the transitions.  And no, the VisualStateManager doesn't help at all here--it's only good for transitions within the same view.</p>\n"},{"tags":["c#","wpf","windows-8","mahapps.metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13148987,"title":"How to add AnimatedTabControl in MahApps.Metro?","body":"<p>I have started learning <code>MahApps.Metro</code>. I read the documentation and got a problem. How to add <code>AnimatedTabControl</code>?</p>\n\n<p>I've included <code>ResourceDictionaries</code>:</p>\n\n<pre><code>    &lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n        &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Colours.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Accents/Purple.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseDark.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/FlatButton.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedTabControl.xaml\" /&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml\" /&gt;\n        &lt;/ResourceDictionary.MergedDictionaries&gt;\n    &lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>After that I started to develop the window:</p>\n\n<pre><code>&lt;Controls:MetroWindow x:Class=\"MyProject.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:Controls=\"clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro\"\n        xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"\n        xmlns:behaviours=\"clr-namespace:MahApps.Metro.Behaviours;assembly=MahApps.Metro\"\n        Title=\"MyProject\" ShowIconOnTitleBar=\"True\" SaveWindowPosition=\"True\" Height=\"350\" Width=\"525\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;ResourceDictionary Source=\"Styles\\MetroStyles.xaml\" /&gt;\n    &lt;/Window.Resources&gt;\n\n    &lt;Controls:MetroWindow.WindowCommands&gt;\n        &lt;Controls:WindowCommands&gt;\n            &lt;Button Content=\"about\" /&gt;\n            &lt;Button Content=\"settings\" /&gt;\n        &lt;/Controls:WindowCommands&gt;\n    &lt;/Controls:MetroWindow.WindowCommands&gt;\n\n    &lt;Grid&gt;\n        &lt;Controls:TransitioningContentControl x:Name=\"Transitioning\" Transition=\"RightReplaceTransition\"&gt;\n\n        &lt;/Controls:TransitioningContentControl&gt;\n    &lt;/Grid&gt;\n&lt;/Controls:MetroWindow&gt;\n</code></pre>\n\n<p><code>Metro</code> window works fine but I have no idea how to add <code>AnimatedTabControl</code>... It's not included in <code>Controls:</code> namespace.</p>\n\n<p>I want to do something like that:<br />\n<img src=\"http://i.stack.imgur.com/te6vI.gif\" alt=\"Tabs\"></p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13150355,"title":"How to minimize the WPF application into the bottom right corner of desktop?","body":"<p>Does anyone know how to minimize the wpf window into the bottom right corner by click on some button? I want this happen when i click on the X button. </p>\n\n<p>Thanks.</p>\n"},{"tags":["wpf","xaml","windows-8","winrt-xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13150291,"title":"Why did my XAML suddenly crash?","body":"<p>I added a \"Basic Page\" to my project in a folder (\"View\") that I created within the project.</p>\n\n<p>At first all was well, but \"all of a sudden\" the design view failed and displayed:</p>\n\n<p><em>System.ObjectDisposedException\nSafe handle has been closed</em></p>\n\n<p>This is the XAML (I hadn't changed a thing in the default XAML generated yet):</p>\n\n<pre><code>&lt;common:LayoutAwarePage\n    x:Name=\"pageRoot\"\n    x:Class=\"TimeAndSpaceLines.View.SectionPage\"\n    DataContext=\"{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:TimeAndSpaceLines.View\"\n    xmlns:common=\"using:TimeAndSpaceLines.Common\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"&gt;\n\n    &lt;Page.Resources&gt;\n\n        &lt;!-- TODO: Delete this line if the key AppName is declared in App.xaml --&gt;\n        &lt;x:String x:Key=\"AppName\"&gt;My Application&lt;/x:String&gt;\n    &lt;/Page.Resources&gt;\n\n    &lt;!--\n        This grid acts as a root panel for the page that defines two rows:\n        * Row 0 contains the back button and page title\n        * Row 1 contains the rest of the page layout\n    --&gt;\n    &lt;Grid Style=\"{StaticResource LayoutRootStyle}\"&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"140\"/&gt;\n            &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n\n        &lt;!-- Back button and page title --&gt;\n        &lt;Grid&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"Auto\"/&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;Button x:Name=\"backButton\" Click=\"GoBack\" IsEnabled=\"{Binding Frame.CanGoBack, ElementName=pageRoot}\" Style=\"{StaticResource BackButtonStyle}\"/&gt;\n            &lt;TextBlock x:Name=\"pageTitle\" Grid.Column=\"1\" Text=\"{StaticResource AppName}\" Style=\"{StaticResource PageHeaderTextStyle}\"/&gt;\n        &lt;/Grid&gt;\n\n        &lt;VisualStateManager.VisualStateGroups&gt;\n\n            &lt;!-- Visual states reflect the application's view state --&gt;\n            &lt;VisualStateGroup x:Name=\"ApplicationViewStates\"&gt;\n                &lt;VisualState x:Name=\"FullScreenLandscape\"/&gt;\n                &lt;VisualState x:Name=\"Filled\"/&gt;\n\n                &lt;!-- The entire page respects the narrower 100-pixel margin convention for portrait --&gt;\n                &lt;VisualState x:Name=\"FullScreenPortrait\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"backButton\" Storyboard.TargetProperty=\"Style\"&gt;\n                            &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource PortraitBackButtonStyle}\"/&gt;\n                        &lt;/ObjectAnimationUsingKeyFrames&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/VisualState&gt;\n\n                &lt;!-- The back button and title have different styles when snapped --&gt;\n                &lt;VisualState x:Name=\"Snapped\"&gt;\n                    &lt;Storyboard&gt;\n                        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"backButton\" Storyboard.TargetProperty=\"Style\"&gt;\n                            &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource SnappedBackButtonStyle}\"/&gt;\n                        &lt;/ObjectAnimationUsingKeyFrames&gt;\n                        &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"pageTitle\" Storyboard.TargetProperty=\"Style\"&gt;\n                            &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource SnappedPageHeaderTextStyle}\"/&gt;\n                        &lt;/ObjectAnimationUsingKeyFrames&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/VisualState&gt;\n            &lt;/VisualStateGroup&gt;\n        &lt;/VisualStateManager.VisualStateGroups&gt;\n    &lt;/Grid&gt;\n&lt;/common:LayoutAwarePage&gt;\n</code></pre>\n\n<p>Note: I did try removing the \"appname\" line according to the \"TODO\" (it <em>is</em> in app.xaml) but that made no difference. The app builds successfully via F6, but attempts to reload the designer fail.</p>\n\n<p>A second attempt, this time using a Blank xaml page, and then pasting in some XAML I had cobbled together in Kaxaml, also fails, this time with the err msg: \"<em>System.Exception\nPackage could not be registered. (Exception from HRESULT: 0x80073CF6)</em>\"</p>\n\n<p>This XAML is (truncated):</p>\n\n<pre><code>&lt;Page\n    x:Class=\"TimeAndSpaceLines.View.SectionN\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:TimeAndSpaceLines.View\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"&gt;\n\n    &lt;Grid MinHeight=\"600\" ShowGridLines=\"True\" Background=\"{StaticResource ApplicationPageBackgroundThemeBrush}\"&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition Width=\"320\"&gt;\n                    &lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition MaxWidth=\"800\"&gt;\n                    &lt;/ColumnDefinition&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition&gt;\n                    &lt;/RowDefinition&gt;\n    . . .\n</code></pre>\n\n<p>???</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13150067,"title":"Binding To A ListView","body":"<p>This has been asked before. I have tried several things and read a lot of posts but can't get this working. What happens is the window opens and I don't see columns in the <code>listview</code>. Instead I see <code>System.Windows.Controls.Gridview Columns=3</code></p>\n\n<p>The XAML and code-behind. I can post the <code>ViewModel</code> if necessary </p>\n\n<p><sup><strong>XAML</strong></sup> \n</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Window x:Class=\"DataBinding.LogFileWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:local=\"clr-namespace:DataBinding\"\n        Title=\"LogFileWindow\" Height=\"556.183\" Width=\"717.987\"&gt;\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\" HorizontalScrollBarVisibility=\"Auto\"&gt;\n    &lt;Grid&gt;\n\n\n                &lt;TabPanel Margin=\"12,131,128.6,12.4\" Width=\"Auto\" Grid.RowSpan=\"2\"&gt;\n            &lt;TabControl Margin=\"10,10,-270,-223.8\"&gt;\n                &lt;TabItem Header=\"Logging Log\"&gt;\n                        &lt;ListView Name=\"LoggingListView\" ItemsSource=\"{Binding LogEntries}\"&gt;\n                            &lt;GridView&gt;\n                                &lt;GridViewColumn Header=\"Date\" DisplayMemberBinding=\"{Binding Path=Date}\"&gt;&lt;/GridViewColumn&gt;\n                                &lt;GridViewColumn Header=\"Time\" DisplayMemberBinding=\"{Binding Path=Time}\"&gt;&lt;/GridViewColumn&gt;\n                                &lt;GridViewColumn Header=\"Event\" DisplayMemberBinding=\"{Binding Path=Event}\"&gt;&lt;/GridViewColumn&gt;\n                            &lt;/GridView&gt;\n                        &lt;/ListView&gt;\n                &lt;/TabItem&gt;\n                &lt;TabItem Header=\"Accounting Log\"&gt;\n                    &lt;ListView Name=\"AccountingListView\" ItemsSource=\"{Binding}\" Margin=\"0,0,-14.6,38.2\"&gt;&lt;/ListView&gt;\n                &lt;/TabItem&gt;\n                &lt;TabItem Header=\"NVRAM Log\"&gt;\n                    &lt;ListView Name=\"NVRAMListView\" ItemsSource=\"{Binding}\"&gt;&lt;/ListView&gt;\n                &lt;/TabItem&gt;\n            &lt;/TabControl&gt;\n        &lt;/TabPanel&gt;\n\n    &lt;/Grid&gt;\n</code></pre>\n\n<p><strong><sup>C#</sup></strong>\n</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>     public MainWindow()\n        {   \n            //create a new logging log file\n            LoggingLog logfile = new LoggingLog();\n\n            //add some entries\n            // these are not real dates and times but that doesn't matter much.\n\n\n            for (int i = 0; i &lt; 20; i++)\n            {\n                LogFileEntry le = new LogFileEntry();\n                le.Date = String.Format(\"Date{0}\", i);\n                le.Time = String.Format(\"Time{0}\", i);\n                le.Event = String.Format(\"Event{0}\", i);\n              logfile.LogEntryList.Add(le);\n            }\n\n            //now load the viewmodel\n\n            LogViewModel logviewmodel = new LogViewModel();\n            foreach (LogFileEntry le in logfile.LogEntryList)\n            {\n                logviewmodel.Add(new LogEntryViewModel(le));\n\n            }\n\n            //now set the datacontext on the window\n            LogFileWindow lfwindow = new LogFileWindow();\n            lfwindow.LogEntries = logviewmodel;\n            lfwindow.LoggingListView.DataContext = logviewmodel;\n\n            InitializeComponent();\n            lfwindow.Show();\n        }\n</code></pre>\n"},{"tags":["wpf","datatemplate","tabcontrol","itemtemplate"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2833,"score":2,"question_id":601826,"title":"multiple userControl instances in tabControl","body":"<p>I have a tabControl that is bound to an observable collection. \nIn the headerTemplate, I would like to bind to a string property, and in the contentTemplate I have placed a user-control.</p>\n\n<p>Here's the code for the MainWindow.xaml:</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.Resources&gt;            \n        &lt;DataTemplate x:Key=\"contentTemplate\"&gt;\n                &lt;local:UserControl1 /&gt;\n        &lt;/DataTemplate&gt;\n\n        &lt;DataTemplate x:Key=\"itemTemplate\"&gt;\n                &lt;Label Content=\"{Binding Path=Name}\" /&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/Grid.Resources&gt;\n\n    &lt;TabControl IsSynchronizedWithCurrentItem=\"True\" \n                ItemsSource=\"{Binding Path=Pages}\"\n                ItemTemplate=\"{StaticResource itemTemplate}\"\n                ContentTemplate=\"{StaticResource contentTemplate}\"/&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>And its code behind:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n\n        this.DataContext = new MainWindowViewModel();\n    }        \n}\n\npublic class MainWindowViewModel\n{\n    public ObservableCollection&lt;PageViewModel&gt; Pages { get; set; }\n\n    public MainWindowViewModel()\n    {\n        this.Pages = new ObservableCollection&lt;PageViewModel&gt;();\n        this.Pages.Add(new PageViewModel(\"first\"));\n        this.Pages.Add(new PageViewModel(\"second\"));\n    }\n}\n\npublic class PageViewModel\n{\n    public string Name { get; set; }\n\n    public PageViewModel(string name)\n    {\n        this.Name = name;\n    }\n}\n</code></pre>\n\n<p>So the problem in this scenario (having specified an itemTemplate as well as a controlTemplate) is that I only get <strong>one</strong> instance for the user-control, where I want to have an instance for each item that is bound to. </p>\n"},{"tags":["wpf","mvvm","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13149656,"title":"WPF - How to list Objects in a DataGrid or ListView in a strange way?","body":"<p>I have an observable collection with some objects in it. These objects have 4 strings a piece in them. I want to be able to display this data in a datagrid, but not like you'd think. If I let it auto generate columns, then I get a column for each field. What I need is a set amount of columns, for my items to be added as a custom template into each cell. It should start at the top left, and continue to the right, and restart at the end of every row.</p>\n\n<p>For example: Let's say I have 10 items, and 3 columns. I should automatically have 3 rows with 3 columns a piece, and 1 item on the bottom row. These items will consist of 4 textblocks that display the data correctly.</p>\n\n<p>I cannot figure out how to make a datagrid behave this way. I'm starting to think that another control may work better, but I'm unsure. If anyone can help with the datagrid, or point me in the right direction with another control, I'd really appreciate it.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","wpf",".net-3.5"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1587,"score":4,"question_id":1470143,"title":"Convert BitmapImage to grayscale, and keep alpha channel","body":"<p>I'm having an issue with converting a BitmapImage (WPF) to grayscale, whilst keeping the alpha channel. The source image is a PNG.</p>\n\n<p>The MSDN article <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.formatconvertedbitmap.aspx\" rel=\"nofollow\">here</a> works fine, but it removes the alpha channel.</p>\n\n<p>Is there any quick and effective way of converting a BitmapImage to a grayscale?</p>\n"},{"tags":["c#","wpf","pdf","printing","reporting-services"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":138,"score":2,"question_id":12697711,"title":"Printing PDF files in WPF with customized PrintTicket","body":"<p>In a current project I need to print reports I received from SSRS in Pdf format. So far I have learned that Pdf and WPF are not friends at all. But there is even more to the requirements: </p>\n\n<ul>\n<li>Pdfs should be printed to a printer without displaying a print\ndialog.     </li>\n<li>Some reports require paper from a particular InputBin (so this must<br>\nbe configurable)</li>\n</ul>\n\n<p>I have seen quite a lot approaches to this. Also I investigated some WPF – PDF Libraries, but none of them cover these requirements. </p>\n\n<p>The solution I have is to get the report as Imagesource from SSRS, then creating an <code>Image</code> WPF Control for each source. Afterwards creating a <code>FixedDocument</code> with each page containing the <code>Image</code> Control created.</p>\n\n<p>This works, however, the files created are quite large and it takes too long to print them. Therefore printing a native PDF file approach would be better.</p>\n\n<p>What I want is this:</p>\n\n<pre><code>var bytes = GetSomeReportFromReportingServices();\nvar pdfDocuments = new PdfDocument(bytes);\n\nvar printQueue = LocalPrintServer.GetDefaultPrintQueue();\nvar printTicket = printQueue.DefaultPrintTicket();\n\n//Extension method to set the input bin\nprintTicket.SetInputBin(\"SomeInputBinDifferentFromDefault\");\n\n//Set some other PrintTicket Properties\n//[...]\n\npdfDocument.Print(printQueue, printTicket);\n</code></pre>\n\n<p>Easy as that. All I want is to configure a PrintTicket and printing that pdf to a printer. Is there some Library/ component out there capable of doing something like that?</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13149786,"title":"Row seprator on empty listview","body":"<p>How can I have a default row separator on <code>ListView</code> by default even when the it is empty?</p>\n\n<p>By default it is empty. Do I have to do any style for that?</p>\n"},{"tags":["wpf","desktop-application","privileges","user-accounts","restriction"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13148419,"title":"Approach for providing restricted privilege to application users","body":"<p>I have a desktop application developed in WPF that has several views displayed as MDI child to the Shell. It is not developed in a Composite/Modularized approach. When the application opens, all the views are ready to be accessed. The application has an Admin user and several Operators.  </p>\n\n<p>The requirement is that the Admin user will assign some restricted privileges to the Operators which will specify –  </p>\n\n<ol>\n<li>Which Operators can access/open which Views, and </li>\n<li>Which Operators can perform which actions in the allowed Views  </li>\n</ol>\n\n<p>My thought up to this point is to –  </p>\n\n<ol>\n<li>Storing the operator-privilege information in the database</li>\n<li>On loading, storing the currently logged-in user’s privilege info at somewhere application-level</li>\n<li>For the Shell, checking the privilege info at application-level and setting visibility bindings to different View-access buttons according to the info</li>\n<li>For individual Views, checking the privilege info at ViewModel-level  and setting visibility bindings to the action buttons according to the info  </li>\n</ol>\n\n<p>Is there a better approach for implementing such a scenario?</p>\n"},{"tags":["wpf","vb.net","string-formatting","stringformat"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":8667997,"title":"StringFormat (\"0214\" to \"02:14\")","body":"<p>I have a String \"0214\" i would like te present this as 02:14 is this possible in wpf with stringFormat and binding.</p>\n\n<p>If it would be an integer i could do it like bellow but the problem is that the \"0\" disapears and becomes Int \"214\" But this is not good for placing in the database because it requires 4 numbers.</p>\n\n<pre><code>&lt;GridViewColumn Header=\"Start\" DisplayMemberBinding=\"{Binding Start, StringFormat={}{0:00\\:00}}\"/&gt;\n</code></pre>\n\n<p>output: '02:14' </p>\n"},{"tags":["wpf","data-binding","togglebutton"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13147086,"title":"WPF ToggleButton.IsChecked binding does not work","body":"<p>is there an issue with two way binding to the IsChecked property on a ToggleButton in .NET 3.5?  </p>\n\n<p>I have this XAML:  </p>\n\n<pre><code> &lt;ToggleButton \n                    Name=\"tbMeo\"\n                    Command=\"{Binding FilterOnSatelliteTypeCmd}\" \n                    IsChecked=\"{Binding ShowMeoDataOnly, Mode=TwoWay}\"\n                    ToolTip=\"Show MEO data only\"&gt;\n                    &lt;Image Source=\"../images/32x32/Filter_Meo.png\" Height=\"16\" /&gt;\n                &lt;/ToggleButton&gt;\n</code></pre>\n\n<p>I have a ViewModel with the following property:</p>\n\n<pre><code> private bool _showMeoDataOnly;\n    public bool ShowMeoDataOnly\n    {\n        get { return _showMeoDataOnly; }\n        set\n        {\n            if (_showMeoDataOnly != value)\n            {\n                _showMeoDataOnly = value;\n                RaisePropertyChangedEvent(\"ShowMeoDataOnly\");\n            }\n        }\n    }\n</code></pre>\n\n<p>If I click on the ToggleButton, the value of ShowMeoDataOnly is set accordingly.  However, if I set ShowMeoDataOnly to true from code behind, the ToggleButton's visual state does not change to indicate that IsChecked is true.  However, if I manually set the ToggleButton's IsChecked property instead of setting ShowMeoDataOnly to true in code behind, the button's visual state changes accordingly.</p>\n\n<p>Unfortunately, switching over to .NET 4/4.5 is not an option right now, so I cannot confirm if this is a .NET 3.5 problem.  </p>\n\n<p>Is there anything wrong with my code?</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13148076,"title":"Error importing namespace into XAML file","body":"<p>I'm getting this error when I try to import a particular namespace to my custom user control. The line causing this error is the import: 'xmlns:c=\"clr-namespace:Wifi.Toolbar'. If I remove this line the error disappears.</p>\n\n<p>WifiCollaborateToolbarView.xaml(1,1): error MC3000: 'Data at the root level is invalid. Line 1, position 1.' XML is not valid.</p>\n\n<p>Windows 7<br>\nVisual Studio 2010 SP1<br>\n.NET 4.0</p>\n\n<p>Here is the XAML file:</p>\n\n<pre><code>&lt;UserControl x:Class=\"Wifi.Toolbar.WifiCollaborateToolbarView\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n             xmlns:c=\"clr-namespace:Wifi.Toolbar\"&gt;\n\n    &lt;UserControl.Resources&gt;\n        &lt;ResourceDictionary&gt;\n            &lt;ResourceDictionary.MergedDictionaries&gt;\n                &lt;ResourceDictionary Source=\"CollaborateStyles.xaml\"/&gt;\n            &lt;/ResourceDictionary.MergedDictionaries&gt;\n        &lt;/ResourceDictionary&gt;\n    &lt;/UserControl.Resources&gt;\n\n    &lt;Grid x:Name=\"GridTopLevel\" SnapsToDevicePixels=\"True\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n\n        &lt;c:CollaborateButton x:Name=\"ButtonName\"\n                             Grid.Column=\"0\" \n                             Style=\"{StaticResource MpCollaborateButtonStyle}\"/&gt;\n\n\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Here is the class that I am trying to import into this file. It exists in the same assembly as the XAML file.</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Wifi.Toolbar\n{\n    [TemplatePart(Name=\"PART_Icon\", Type=typeof(Image))]\n    [TemplatePart(Name=\"PART_Caption\", Type=typeof(TextBlock))]\n    public class CollaborateButton : Button\n    {\n        private Image part_icon;\n        private TextBlock part_caption;\n\n        public CollaborateButton()\n        {\n\n        }\n\n        public override void OnApplyTemplate()\n        {\n            ...\n        }\n\n        protected override Size MeasureOverride(Size availableSize)\n        {\n            ...\n        }\n\n        protected override Size ArrangeOverride(Size finalSize)\n        {\n            ...            \n        }\n    }   \n}\n</code></pre>\n\n<p>The button Template  </p>\n\n<pre><code>&lt;Style x:Key=\"MpCollaborateButtonStyle\" TargetType=\"{x:Type c:CollaborateButton}\"&gt;\n        &lt;Setter Property=\"Height\" Value=\"24\" /&gt;\n        &lt;Setter Property=\"BorderThickness\" Value=\"1\" /&gt;\n        &lt;Setter Property=\"BorderBrush\" Value=\"{StaticResource MpCollaborateButtonNormalStrokeBrush}\" /&gt;\n        &lt;Setter Property=\"Background\" Value=\"{StaticResource MpButtonNormalFillBrush}\" /&gt;\n        &lt;Setter Property=\"SnapsToDevicePixels\" Value=\"True\" /&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type Button}\"&gt;\n                    &lt;Border x:Name=\"Bd\"\n                            SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\"\n                            MinWidth=\"{TemplateBinding MinWidth}\"\n                            Height=\"{TemplateBinding Height}\"\n                            BorderThickness=\"{TemplateBinding BorderThickness}\"\n                            BorderBrush=\"{TemplateBinding BorderBrush}\"\n                            Background=\"{TemplateBinding Background}\"&gt;\n\n                        &lt;Grid Margin=\"6,0,12,0\"&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition Width=\"Auto\" /&gt;\n                                &lt;ColumnDefinition Width=\"*\" /&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n\n                            &lt;Image x:Name=\"PART_Icon\"\n                                   Grid.Column=\"0\"\n                                   Margin=\"0,0,7,0\" \n                                   Width=\"16\" \n                                   Height=\"16\" \n                                   Source=\"Images/Collaboration_MeetingName_16x16.png\" /&gt;\n\n                            &lt;TextBlock x:Name=\"PART_Caption\"\n                                       Grid.Column=\"2\"\n                                       Text=\"This is some really long text that is only for testing purposes. Isn't this fun?\"\n                                       Style=\"{StaticResource MpCollaborateTextBlock}\"/&gt;\n\n                        &lt;/Grid&gt;\n                    &lt;/Border&gt;\n\n                    &lt;ControlTemplate.Triggers&gt;\n                        &lt;Trigger Property=\"IsPressed\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"{StaticResource MpButtonDownFillBrush}\" /&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/ControlTemplate.Triggers&gt;\n\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n</code></pre>\n"},{"tags":[".net","wpf","multithreading","backgroundworker","delegatecommand"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13147894,"title":"Why this DelegateCommand does not refresh correctly the CanExecute with background workers?","body":"<p>Using a DelegateCommand in WPF I'm facing the following issue:</p>\n\n<p>Executing the Command1 in a background worker prevents the window from refreshing correctly the CanExecute of the buttons, if the command is executed on the UI thread everything works as expected. Clicking outside the button the CanExecute is correcyly refreshed. Any hint? </p>\n\n<p>(Down it's the code of the DelegateCommand, sorry if it's too large. As far as I know this is a common implementation of a DelegateCommand)</p>\n\n<p>XAML:</p>\n\n<pre><code> &lt;Window x:Class=\"BackgroundWorkTest.MainWindow\"\n     xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n     xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n     Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;StackPanel&gt;\n          &lt;Button Command=\"{Binding Command1}\" Content=\"1\" /&gt;\n          &lt;Button Command=\"{Binding Command2}\" Content=\"2\" /&gt;\n    &lt;/StackPanel&gt;\n &lt;/Window&gt;\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>using System.ComponentModel;\nusing System.Windows;\nusing System.Windows.Input;\nusing Utils.Wpf;\n\nnamespace BackgroundWorkTest\n{\npublic partial class MainWindow : Window\n{\n    private bool _canCommand1 = true;\n    private bool _canCommand2 = true;\n\n    private readonly BackgroundWorker _backgroundWorker;\n\n    public ICommand Command1 { get; private set; }\n    public ICommand Command2 { get; private set; }\n\n    public MainWindow()\n    {\n        this.Command1 = new DelegateCommand(this.ExecuteCommand1, this.CanCommand1);\n        this.Command2 = new DelegateCommand(this.ExecuteCommand2, this.CanCommand2);\n\n        _backgroundWorker = new BackgroundWorker();\n        _backgroundWorker.DoWork += _backgroundWorker_DoWork;\n        _backgroundWorker.RunWorkerCompleted += _backgroundWorker_RunWorkerCompleted;\n\n        InitializeComponent();\n\n        this.DataContext = this;\n    }\n\n    private void _backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        System.Threading.Thread.Sleep(2000);\n    }\n\n    private void _backgroundWorker_DoWork(object sender, DoWorkEventArgs e)\n    {\n        System.Threading.Thread.Sleep(2000);\n        _canCommand2 = true;\n        _canCommand1 = false;\n    }\n\n    private bool CanCommand2()\n    {\n        return _canCommand2;\n    }\n\n    private void ExecuteCommand2()\n    {\n        _canCommand2 = false;\n        _canCommand1 = true;\n    }\n\n    private bool CanCommand1()\n    {\n        return _canCommand1;\n    }\n\n    private void ExecuteCommand1()\n    {\n        _backgroundWorker.RunWorkerAsync();\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>DelegateCommand C#:</p>\n\n<pre><code>    public class DelegateCommand : ICommand\n{\n    #region Constructors\n\n    /// &lt;summary&gt;\n    ///     Constructor\n    /// &lt;/summary&gt;\n    public DelegateCommand(Action executeMethod)\n        : this(executeMethod, null, false)\n    {\n    }\n\n    /// &lt;summary&gt;\n    ///     Constructor\n    /// &lt;/summary&gt;\n    public DelegateCommand(Action executeMethod, Func&lt;bool&gt; canExecuteMethod)\n        : this(executeMethod, canExecuteMethod, false)\n    {\n    }\n\n    /// &lt;summary&gt;\n    ///     Constructor\n    /// &lt;/summary&gt;\n    public DelegateCommand(Action executeMethod, Func&lt;bool&gt; canExecuteMethod, bool isAutomaticRequeryDisabled)\n    {\n        if (executeMethod == null)\n        {\n            throw new ArgumentNullException(\"executeMethod\");\n        }\n\n        this._executeMethod = executeMethod;\n        this._canExecuteMethod = canExecuteMethod;\n        this._isAutomaticRequeryDisabled = isAutomaticRequeryDisabled;\n    }\n\n    #endregion\n\n    #region Public Methods\n\n    /// &lt;summary&gt;\n    ///     Method to determine if the command can be executed\n    /// &lt;/summary&gt;\n    public bool CanExecute()\n    {\n        if (this._canExecuteMethod != null)\n        {\n            return this._canExecuteMethod();\n        }\n        return true;\n    }\n\n    /// &lt;summary&gt;\n    ///     Execution of the command\n    /// &lt;/summary&gt;\n    public void Execute()\n    {\n        if (this._executeMethod != null)\n        {\n            this._executeMethod();\n        }\n    }\n\n    /// &lt;summary&gt;\n    ///     Property to enable or disable CommandManager's automatic requery on this command\n    /// &lt;/summary&gt;\n    public bool IsAutomaticRequeryDisabled\n    {\n        get\n        {\n            return this._isAutomaticRequeryDisabled;\n        }\n        set\n        {\n            if (this._isAutomaticRequeryDisabled != value)\n            {\n                if (value)\n                {\n                    CommandManagerHelper.RemoveHandlersFromRequerySuggested(this._canExecuteChangedHandlers);\n                }\n                else\n                {\n                    CommandManagerHelper.AddHandlersToRequerySuggested(this._canExecuteChangedHandlers);\n                }\n                this._isAutomaticRequeryDisabled = value;\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    ///     Raises the CanExecuteChaged event\n    /// &lt;/summary&gt;\n    public void RaiseCanExecuteChanged()\n    {\n        this.OnCanExecuteChanged();\n    }\n\n    /// &lt;summary&gt;\n    ///     Protected virtual method to raise CanExecuteChanged event\n    /// &lt;/summary&gt;\n    protected virtual void OnCanExecuteChanged()\n    {\n        CommandManagerHelper.CallWeakReferenceHandlers(this._canExecuteChangedHandlers);\n    }\n\n    #endregion\n\n    #region ICommand Members\n\n    /// &lt;summary&gt;\n    ///     ICommand.CanExecuteChanged implementation\n    /// &lt;/summary&gt;\n    public event EventHandler CanExecuteChanged\n    {\n        add\n        {\n            if (!this._isAutomaticRequeryDisabled)\n            {\n                CommandManager.RequerySuggested += value;\n            }\n            CommandManagerHelper.AddWeakReferenceHandler(ref this._canExecuteChangedHandlers, value, 2);\n        }\n        remove\n        {\n            if (!this._isAutomaticRequeryDisabled)\n            {\n                CommandManager.RequerySuggested -= value;\n            }\n            CommandManagerHelper.RemoveWeakReferenceHandler(this._canExecuteChangedHandlers, value);\n        }\n    }\n\n    bool ICommand.CanExecute(object parameter)\n    {\n        return this.CanExecute();\n    }\n\n    void ICommand.Execute(object parameter)\n    {\n        this.Execute();\n    }\n\n    #endregion\n\n    #region Data\n\n    private readonly Action _executeMethod;\n    private readonly Func&lt;bool&gt; _canExecuteMethod;\n    private bool _isAutomaticRequeryDisabled;\n    private List&lt;WeakReference&gt; _canExecuteChangedHandlers;\n\n    #endregion\n}\n</code></pre>\n\n<p>And the CommandManager:</p>\n\n<pre><code>    internal class CommandManagerHelper\n{\n    internal static void CallWeakReferenceHandlers(List&lt;WeakReference&gt; handlers)\n    {\n        if (handlers != null)\n        {\n            // Take a snapshot of the handlers before we call out to them since the handlers\n            // could cause the array to me modified while we are reading it.\n\n            EventHandler[] callees = new EventHandler[handlers.Count];\n            int count = 0;\n\n            for (int i = handlers.Count - 1; i &gt;= 0; i--)\n            {\n                WeakReference reference = handlers[i];\n                EventHandler handler = reference.Target as EventHandler;\n                if (handler == null)\n                {\n                    // Clean up old handlers that have been collected\n                    handlers.RemoveAt(i);\n                }\n                else\n                {\n                    callees[count] = handler;\n                    count++;\n                }\n            }\n\n            // Call the handlers that we snapshotted\n            for (int i = 0; i &lt; count; i++)\n            {\n                EventHandler handler = callees[i];\n                handler(null, EventArgs.Empty);\n            }\n        }\n    }\n\n    internal static void AddHandlersToRequerySuggested(List&lt;WeakReference&gt; handlers)\n    {\n        if (handlers != null)\n        {\n            foreach (WeakReference handlerRef in handlers)\n            {\n                EventHandler handler = handlerRef.Target as EventHandler;\n                if (handler != null)\n                {\n                    CommandManager.RequerySuggested += handler;\n                }\n            }\n        }\n    }\n\n    internal static void RemoveHandlersFromRequerySuggested(List&lt;WeakReference&gt; handlers)\n    {\n        if (handlers != null)\n        {\n            foreach (WeakReference handlerRef in handlers)\n            {\n                EventHandler handler = handlerRef.Target as EventHandler;\n                if (handler != null)\n                {\n                    CommandManager.RequerySuggested -= handler;\n                }\n            }\n        }\n    }\n\n    internal static void AddWeakReferenceHandler(ref List&lt;WeakReference&gt; handlers, EventHandler handler)\n    {\n        AddWeakReferenceHandler(ref handlers, handler, -1);\n    }\n\n    internal static void AddWeakReferenceHandler(ref List&lt;WeakReference&gt; handlers, EventHandler handler, int defaultListSize)\n    {\n        if (handlers == null)\n        {\n            handlers = (defaultListSize &gt; 0 ? new List&lt;WeakReference&gt;(defaultListSize) : new List&lt;WeakReference&gt;());\n        }\n\n        handlers.Add(new WeakReference(handler));\n    }\n\n    internal static void RemoveWeakReferenceHandler(List&lt;WeakReference&gt; handlers, EventHandler handler)\n    {\n        if (handlers != null)\n        {\n            for (int i = handlers.Count - 1; i &gt;= 0; i--)\n            {\n                WeakReference reference = handlers[i];\n                EventHandler existingHandler = reference.Target as EventHandler;\n                if ((existingHandler == null) || (existingHandler == handler))\n                {\n                    // Clean up old handlers that have been collected\n                    // in addition to the handler that is to be removed.\n                    handlers.RemoveAt(i);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13131164,"title":"Underline a group of textblocks or inlines","body":"<p>Short version: I would like to underline anything underlineable that sits inside a DependencyObject, eg in this case I can set Font size and colour but I cannot set it to be underlined:</p>\n\n<pre><code>&lt;StackPanel TextElement.FontWeight=\"Bold\" TextElement.Foreground=\"Red\" Inline.TextDecorations=\"Underline\"&gt;\n    &lt;TextBlock Text=\"This \"&gt;\n    &lt;/TextBlock&gt;\n    &lt;TextBlock&gt;&lt;Run Text=\"is \"&gt;&lt;/Run&gt;&lt;Run Text=\"a test\"&gt;&lt;/Run&gt;&lt;/TextBlock&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>So how can I specify on one location that I would like all of the text underlined?</p>\n\n<p>Long Version: I am creating a hyperlink control that works like a ContentPresenter. The programmer using my hyperlink control can place content into the control and specify a DataTemplate to present their content. On MouseOver I want a trigger to set the font to red and underline the text. I can get it to change the colour to red very easily but the underlining is proving to be an issue.</p>\n\n<pre><code>&lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n    &lt;Setter Property=\"Inline.TextDecorations\" Value=\"Underline\"&gt;&lt;/Setter&gt;\n    &lt;Setter Property=\"TextElement.Foreground\" Value=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type local:ContentHyperlink}}, Path=ActiveColor}\"&gt;&lt;/Setter&gt;\n&lt;/Trigger&gt;\n</code></pre>\n"},{"tags":["c#","wpf","orm","massive"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13144011,"title":"Massive ORM remove column SQLite","body":"<p>I am using the Massive ORM for a wpf application. I have screen with listview and needs to be populated with two tables (one being master data). E.g. I am populating the list of Employees and Salaries along with the Department name in a single listview. The employee table consists of the department ID only. I should be able to update the Salaries of the employees. I have populated the listview with join. But when I try to update the entire list it throws me error that department name column is not available which is obvious.</p>\n\n<p>Question</p>\n\n<p>How can I remove a column from the 'dynamic' list?</p>\n\n<p>Is there a better way to update all the rows using Massive ORM?</p>\n\n<p>Thank you\nShankara Narayanan.</p>\n"},{"tags":["c#","wpf","wpf-controls","wpfdatagrid"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":13076559,"title":"Add Checkbox Column to a DataGrid","body":"<p>i´m trying to add a checkboxcolum in a datagrid control in WPF.</p>\n\n<p>I´ve done this in Windows.Forms and it works very well.</p>\n\n<p>So now i want to write my new program in WPF for the future.</p>\n\n<p>My way that i want to do:\nThe Data will come from a Database as a Dataset.</p>\n\n<p>Some fields have values that i want to display as a checkbox.\nNow i´ve set the datagrid autocreatecolumn true, the data will be displayed.</p>\n\n<p>Now i want to delete the column that displays the value and will add a checkbox column.</p>\n\n<p>Is that possible or should i create the columns via datatemplate?</p>\n"},{"tags":["wpf","xaml","contextmenu"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13071341,"title":"Hide certain XAML defined context menu items unless shift was pressed","body":"<p>I have a DataTemplate that defines the context menu:</p>\n\n<pre><code>&lt;DataTemplate&gt;\n    &lt;TextBlock&gt;\n        &lt;TextBlock.ContextMenu&gt;\n            &lt;ContextMenu&gt;\n                &lt;MenuItem Command=\"{Binding SendToRecycleBin}\" Header=\"Delete\"&gt;\n            &lt;/ContextMenu&gt;\n        &lt;/TextBlock.ContextMenu&gt;\n    &lt;/TextBlock&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>I want to add another menu item to the context menu that is only shown if the user held down Shift while opening the Context Menu, using only XAML (maybe create a new attached property App.PowerUserOnly?):</p>\n\n<pre><code>&lt;MenuItem Command=\"{Binding Delete}\" Header=\"Permanently Delete\"\n                                     local:App.PowerUserOnly=\"true\"&gt;\n</code></pre>\n\n<p>Can this be done in XAML only (if so, how?), or do you have to use code behind?</p>\n\n<p>Edit:\nThe Windows shell also shows advanced options when Shift was held down while opening the context menu.  I'm trying to emulate that behavior.  For instance, one of the advanced options for an application is to run it as a different user.</p>\n\n<p>I simplified my code to help test out people's suggestions.  The project is created in VS2010 with the default WPF Application, named ShiftContextMenu.  The App.xaml and App.xaml.cs files are unmodified.</p>\n\n<p>MainWindow.xaml:</p>\n\n<pre><code>&lt;Window x:Class=\"ShiftContextMenu.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;DataTemplate x:Key=\"DummyItemTemplate\"&gt;\n            &lt;TextBlock Text=\"{Binding Name}\"&gt;\n                &lt;TextBlock.ContextMenu&gt;\n                    &lt;ContextMenu&gt;\n                        &lt;MenuItem Command=\"{Binding SendToRecycleBin}\" Header=\"Delete\" /&gt;\n                        &lt;MenuItem Command=\"{Binding Delete}\" Header=\"Permanently Delete\" /&gt;\n                    &lt;/ContextMenu&gt;\n                &lt;/TextBlock.ContextMenu&gt;\n            &lt;/TextBlock&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/Window.Resources&gt;\n    &lt;TreeView Name=\"tvMain\" ItemTemplate=\"{StaticResource DummyItemTemplate}\" ItemsSource=\"{Binding DummyItems}\" /&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>MainWindow.xaml.cs:</p>\n\n<pre><code>using System.Collections.Generic;\nusing System.Windows;\nusing System.Collections.ObjectModel;\n\nnamespace ShiftContextMenu\n{\n    /// &lt;summary&gt;\n    /// Interaction logic for MainWindow.xaml\n    /// &lt;/summary&gt;\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            DummyItem[] dummyItems = new DummyItem[] {\n                new DummyItem(\"First\"),\n                new DummyItem(\"Second\"),\n                new DummyItem(\"Third\")\n            };\n            DummyItems = new ReadOnlyCollection&lt;DummyItem&gt;(new List&lt;DummyItem&gt;(dummyItems));\n            this.DataContext = this;\n            InitializeComponent();\n        }\n\n        public ReadOnlyCollection&lt;DummyItem&gt; DummyItems { get; protected set; }\n    }\n}\n</code></pre>\n\n<p>ViewModelBase.cs:</p>\n\n<pre><code>using System.ComponentModel;\n\nnamespace ShiftContextMenu\n{\n    public class ViewModelBase : INotifyPropertyChanged\n    {\n        protected PropertyChangedEventHandler _propertyChangedEvent;\n\n        protected void SendPropertyChanged(string propertyName)\n        {\n            if (_propertyChangedEvent != null)\n            {\n                _propertyChangedEvent(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }\n\n        public event PropertyChangedEventHandler PropertyChanged\n        {\n            add\n            {\n                _propertyChangedEvent += value;\n            }\n            remove\n            {\n                _propertyChangedEvent -= value;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>DummyItem.cs:</p>\n\n<pre><code>using System;\nusing System.Windows.Input;\nusing System.Windows;\n\nnamespace ShiftContextMenu\n{\n    public class DummyItem : ViewModelBase\n    {\n        public string Name { get; protected set; }\n\n        public DummyItem(string name)\n        {\n            Name = name;\n            _sendToRecycleBinCommand = new SendToRecycleBinCommand();\n            _deleteCommand = new DeleteCommand();\n        }\n\n        protected SendToRecycleBinCommand _sendToRecycleBinCommand;\n        protected DeleteCommand _deleteCommand;\n\n        public ICommand SendToRecycleBin { get { return _sendToRecycleBinCommand; } }\n        public ICommand Delete { get { return _deleteCommand; } }\n\n        protected class SendToRecycleBinCommand : ICommand\n        {\n            public void Execute(object parameter)\n            {\n                MessageBox.Show(\"Send To Recycle Bin\");\n            }\n\n            public bool CanExecute(object parameter)\n            {\n                return true;\n            }\n\n            public event EventHandler CanExecuteChanged { add { } remove { } }\n        }\n\n        protected class DeleteCommand : ICommand\n        {\n            public void Execute(object parameter)\n            {\n                MessageBox.Show(\"Permanently Delete\");\n            }\n\n            public bool CanExecute(object parameter)\n            {\n                return true;\n            }\n\n            public event EventHandler CanExecuteChanged { add { } remove { } }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":22,"score":0,"question_id":13147196,"title":"DataGridTemplateColumn binding converter","body":"<p>I am using the following code :\nWhere is my mistake? What's the solution?\n    \n        </p>\n\n<pre><code>        &lt;MyClass:CheckForVis  x:Key=\"_CheckForVis\"/&gt;\n\n    &lt;/Window.Resources&gt;\n        &lt;DataGrid Name=\"dg\" AutoGenerateColumns=\"False\"\n CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" CanUserSortColumns=\"False\" \n                                 ItemsSource=\"{Binding ElementName=tempWin, Path=TitleClass}\" &gt;\n\n            &lt;DataGrid.Columns&gt;\n\n                &lt;DataGridTemplateColumn Visibility=\"{Binding ElementName=tempWin, Path=TitleClass,Converter={StaticResource _CheckForVis}}\" Width=\"*\" Header=\"Input\" IsReadOnly=\"True\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"  Margin=\"10,0,0,0\" Grid.Column=\"0\"  Name=\"partMojudi\"&gt;\n                                &lt;TextBlock Width=\"Auto\" Name=\"txtInput\" Text=\"{Binding input}\"/&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                &lt;/DataGridTemplateColumn&gt;\n\n        &lt;/DataGrid&gt;\n\n        &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Why not right? \nWhere is my mistake? What's the solution?</p>\n"},{"tags":["wpf","mvvm","navigation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13146038,"title":"Binding to ViewModels that are displayed using a ContentPresenter and DataTemplates?","body":"<p>I am currently using an <code>ItemsControl</code> at the top of my application that contains a few buttons, bound to a list of ViewModelBases. These VMs are the pages of my app. When clicked, they set the current page to the appropriate page. A content presenter shows the current view model, and a <code>DataTemplate</code> converts it into the correct view.</p>\n\n<p>How can I use Data Binding in these views? Since the view is being created by the ViewModel, doesn't that mean I can't create a new instance of that view model in the view? How can it find the correct instance to bind to? Or, is it automatically bound?</p>\n"},{"tags":["wpf","treeview","contextmenu"],"answer_count":7,"favorite_count":9,"up_vote_count":34,"down_vote_count":0,"view_count":21576,"score":34,"question_id":592373,"title":"Select TreeView Node on right click before displaying ContextMenu","body":"<p>I whould like to select a WPF TreeView Node on right click, right before the ContextMenu displayed.</p>\n\n<p>For WinForms I could use code like this <a href=\"http://stackoverflow.com/questions/2527/c-treeview-context-menus\">http://stackoverflow.com/questions/2527/c-treeview-context-menus</a>, what are the WPF alternatives?</p>\n"},{"tags":["c#","wpf","events","gui"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13146286,"title":"Is there any event that fires when any of my UI elements changes in WPF/C#?","body":"<p>I have a WPF app with lots of textboxes and comboboxes that make up the UI.  I have a 'Save' button that I want to turn red whenever any of those textboxes or comboboxes content changes.  Is there a single event that I can handle so that I don't have to write </p>\n\n<pre><code>btnSave.Foreground = Brushes.Red\n</code></pre>\n\n<p>for the _TextChanged event for every textbox?</p>\n"},{"tags":["wpf","dynamic","navigation","treeview","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13146179,"title":"How do I access a windows control (checkbox) that is created dynamically in a WPF treeview?","body":"<p>I have a WPF Tree View with hierarchical data templates that loads objects and displays them fine. Within the children of the treeview, I am showing the \"Name\" of the object in the Tree View using a TextBlock, along with a Check Box next to it. Here is my code for reference: </p>\n\n<pre><code>&lt;DockPanel Name=\"test1\" Margin=\"10,10,0,10\" VerticalAlignment=\"Stretch\" Grid.Row=\"3\" Grid.RowSpan=\"7\" Grid.Column=\"0\"&gt;\n        &lt;DockPanel.Resources&gt;\n            &lt;local:CheckBoxCommand x:Key=\"cbc\"&gt;&lt;/local:CheckBoxCommand&gt;\n            &lt;src:TreeViewFilter x:Key=\"MyList\" /&gt;\n\n            &lt;HierarchicalDataTemplate DataType=\"{x:Type src:TreeViewParent}\" ItemsSource=\"{Binding Path=OrderAttributes}\"&gt;\n                &lt;TextBlock Text=\"{Binding Path=NameAndCount}\" FontSize=\"24\"/&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n\n            &lt;HierarchicalDataTemplate DataType=\"{x:Type src:OrderAttribute}\" ItemsSource=\"{Binding Path=OrderAttributes}\"&gt;\n                &lt;StackPanel Name=\"test\" Orientation=\"Horizontal\" VerticalAlignment=\"Center\"&gt;\n                    &lt;CheckBox Command=\"{StaticResource cbc}\"\n                              CommandParameter=\"{Binding Path=NameAndParent}\" Visibility=\"{Binding Path=CheckBoxVisible}\" VerticalAlignment=\"Center\"&gt;\n                    &lt;/CheckBox&gt;\n                    &lt;TextBlock Text=\"{Binding Path=NameAndCount}\" FontSize=\"16\"/&gt;\n                    &lt;/StackPanel&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n\n        &lt;/DockPanel.Resources&gt;\n        &lt;TreeView Name=\"treeView1\" BorderThickness=\"2\" ItemsSource=\"{Binding Source={StaticResource MyList}, UpdateSourceTrigger=PropertyChanged}\" TreeViewItem.Selected=\"filterByBatchStatus\"/&gt;\n    &lt;/DockPanel&gt;\n</code></pre>\n\n<p>When A user checks a checkbox in the tree, certain stuff happens in my application based on which checkbox is checked. The way I know which checkbox is being checked is by passing a paramater through a command, and that parameter is bound to the \"NameAndParent\" of the object. All of this works fine.</p>\n\n<p>My problem begins when I give the user the option to save which checkboxes have been checked and I save the \"Name\" of each object next to the checked box into an XML. As you can see, I am only saving the \"Name\" of the object, but this name has no hook to the checkbox, So I can't go back and \"find\" the associated checkbox.</p>\n\n<p>When I give the user the option to load one of these saved files, I want to traverse the tree and check the boxes that were saved. The problem is that the checkboxes DONT HAVE A NAME, OR UID, and I cant assign them one through binding because that is not allowed.</p>\n\n<p>Is there anyway to traverse the tree view and somehow compare the saved name to the name of each element child in the tree, and then check that specific checkbox, Or is this something that has to be programmed in a different way?</p>\n"},{"tags":["c#","wpf","video","directshow","capture"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":811,"score":2,"question_id":6203651,"title":"Directshow recording/preview problem","body":"<p>I have a project where I need to record a video using DirectShow from a webcam, but I need to be able to stop recording while the preview continues to run.</p>\n\n<p>I am using WPFMediaKit </p>\n\n<p><a href=\"http://wpfmediakit.codeplex.com/\" rel=\"nofollow\">http://wpfmediakit.codeplex.com/</a></p>\n\n<p>The problem is that when I record a video the pause function also pauses the preview pane in the application</p>\n\n<p>I am new to DirectShow, any suggestions how is can address this issue or a solution</p>\n\n<p>Thank you very much.</p>\n\n<p>P.S I use C# &amp; WPF</p>\n"},{"tags":["c#","wpf","animation","text"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13145702,"title":"possible to pulse text by smoothly changing fontweight in WPF?","body":"<p>I would like to add a fade in/out effect to some text (aka, a WPF Run object). I don't want it to toggle Bold/notBold all at once. I want it to animate between Bold and normal. Is this possible?</p>\n"},{"tags":["wpf","wpf-controls","treeviewitem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13144542,"title":"treeview crazy scroll behaviour","body":"<p>i am trying to write my own treeview with virtualization and so i managed to set up a style for my class that derives from treeview. In that style i wrapped itemspresenter with a scrollviewer. Furthermore i also set CanContentScroll=true for UI-virtualization.</p>\n\n<p>something like this to cut it short:</p>\n\n<pre><code>&lt;Style&gt;\n   &lt;Setter Property=\"VirtualizingStackPanel.IsVirtualizing\" Value=\"True\"/&gt;\n   &lt;Setter Property=\"Template\"&gt;\n   &lt;ControlTemplate&gt;\n    &lt;ScrollViewer CanContentScroll=\"True\"&gt;\n                    &lt;ItemsPresenter/&gt;\n    &lt;/ScrollViewer&gt;\n   &lt;/ControlTemplate&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Then i created a new class that inherits from TreeViewItem and i also override default TreeViewItem template so that TreeView must use myTreeViewItem style.</p>\n\n<p>Style of myTreeViewItem looks something like this:</p>\n\n<pre><code>&lt;Style&gt;\n   &lt;Setter Property=\"Template\"&gt;\n   &lt;ControlTemplate&gt;\n     &lt;Grid&gt;\n       &lt;RowDefintion Height=\"Auto\"/&gt;\n       &lt;RowDefintion/&gt;\n       &lt;TextBlock Text=\"Header\" Grid.Row=\"0\"/&gt;\n       &lt;ItemsPresenter Grid.Row=\"1\"/&gt;\n     &lt;/Grid&gt;\n   &lt;/ControlTemplate&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Filling the ItemsSource of myTreeView with some Data works and so does displaying those root level items with virtualization. But when i double click one of my treeViewItem (i wrote trigger to expand my itemsPresenter in myTreeViewItem), the scroller is not working properly anymore. It is only scrolling through root level itemsbut not through second level (second level are those from itemsPresenter in myTreeViewItem).</p>\n\n<p>How can i fix the scroller and not lose virtualization? please help and sorry for my english :)</p>\n"},{"tags":["c#","wpf","xaml","binding","converter"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13126224,"title":"lighten background color on button click per binding with converter","body":"<p>I want to lighten a buttons background on click. So I did the following:</p>\n\n<pre><code>&lt;converter:ColorLightConverter x:Key=\"colorLightConverter\" /&gt;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>&lt;Style BasedOn=\"{StaticResource default}\" TargetType=\"{x:Type controls:Button}\"&gt;            \n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type controls:Button}\"&gt;\n                    &lt;ControlTemplate.Triggers&gt;                            \n                        &lt;Trigger Property=\"IsPressed\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\"&gt;\n                                &lt;Setter.Value&gt;\n                                    &lt;SolidColorBrush Color=\"{Binding Path=Background.Color, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource colorLightConverter}}\" /&gt;\n                                &lt;/Setter.Value&gt;\n                            &lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/ControlTemplate.Triggers&gt;\n                    &lt;Border Background=\"{TemplateBinding Background}\"\n                            BorderBrush=\"Transparent\"\n                            BorderThickness=\"0\"&gt;\n                        ...                            \n                    &lt;/Border&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p><strong>The converter:</strong></p>\n\n<pre><code>class ColorLightConverter : IValueConverter\n    {\n        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n        {\n            Color color = (Color)value;\n            System.Drawing.Color lightColor = ControlPaint.Light(System.Drawing.Color.FromArgb(color.A, color.R, color.G, color.B));\n\n            return Color.FromArgb(lightColor.A, lightColor.R, lightColor.G, lightColor.B);\n        }\n\n        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n        {\n            throw new NotImplementedException();\n        }\n    }\n</code></pre>\n\n<p>But the converter isn't called when I click the button. I think there is anything wrong with the binding, but I can't see the error...</p>\n\n<p>Can you help me?</p>\n\n<p>Maybe I'm completely wrong. What I basically want to do: When clicking the button, take the current background color and lighten it. Not more...</p>\n\n<h1>Update 1:</h1>\n\n<p>I tried the following:</p>\n\n<p><strong>Changed the binding a bit:</strong></p>\n\n<pre><code>&lt;Trigger Property=\"IsPressed\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"{Binding Path=Background.Color, RelativeSource={RelativeSource Self}, Converter={StaticResource colorLightConverter}}\" /&gt;\n                        &lt;/Trigger&gt;\n</code></pre>\n\n<p><strong>Changed the converter (now it returns a SolidColorBrush):</strong></p>\n\n<pre><code>class ColorLightConverter : IValueConverter\n    {\n        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n        {\n            Color color = (Color)value;\n            System.Drawing.Color lightColor = ControlPaint.Light(System.Drawing.Color.FromArgb(color.A, color.R, color.G, color.B));\n\n            return new SolidColorBrush(Color.FromArgb(lightColor.A, lightColor.R, lightColor.G, lightColor.B));\n        }\n\n        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n        {\n            throw new NotImplementedException();\n        }\n    }\n</code></pre>\n\n<p>Now the converter is called, but it is called again and again, so a stackoverflow exception is thrown after a few seconds. Where comes this indefinite loop from? I'm really a bit confused at the moment...</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13142948,"title":"WPF: How to limit width of all columns combined in DataGrid?","body":"<p>I have a DataGrid which gets its data from an sql table. I have set AutoGenerateColumns to true.</p>\n\n<p>When I click a button the data in the DataGrid is exported to a pdf-file.</p>\n\n<p>However when the width of all columns combined in the DataGrid is bigger than about 800 the table is bigger than the page inside the pdf.</p>\n\n<p>I have set the DataGrid's MaxWidth-Property to 800. When I resize a column I can drag the cursor outside of the DataGrid and a horizontal scrollbar appears.</p>\n\n<p>Is there a way to limit the maximum size of all columns combined to 800 so that I can not make the column bigger than the DataGrid?</p>\n"},{"tags":["wpf","listview"],"answer_count":2,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":4630,"score":10,"question_id":660528,"title":"How to display row numbers in a ListView?","body":"<p>The obvious solution would be to have a row number property on a ModelView element, but the drawback is that you have to re-generate those when you add records or change sort order.</p>\n\n<p>Is there an <strong>elegant</strong> solution?</p>\n"},{"tags":["c#",".net","wpf","task-parallel-library"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13124329,"title":"Event on Task Result is done","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5971686/how-to-create-a-task-tpl-running-a-sta-thread\">How to create a task (TPL) running a STA thread?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm using the following code:</p>\n\n<pre><code>var task = Task.Factory.StartNew&lt;List&lt;NewTwitterStatus&gt;&gt;(\n        () =&gt; GetTweets(securityKeys),  \n        TaskCreationOptions.LongRunning);\n\nDispatcher.BeginInvoke(DispatcherPriority.Background,\n    new Action(() =&gt;\n    {\n        var result = task.Result; // ERROR!!! The calling thread cannot access this object because a different thread owns it.\n        RecentTweetList.ItemsSource = result;\n        Visibility = result.Any() ? Visibility.Visible : Visibility.Hidden;\n    }));\n</code></pre>\n\n<p>And I'm getting the error:</p>\n\n<pre><code>var result = task.Result; // ERROR!!! The calling thread cannot access this object because a different thread owns it.\n</code></pre>\n\n<p>What do I need to do to resolve this problem?</p>\n"},{"tags":["c#","wpf","3d","transformation","helix"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13144481,"title":"C# wpf helix scale based mesh parenting using Transform3DGroup","body":"<p>I am using <a href=\"https://helixtoolkit.codeplex.com/\" rel=\"nofollow\">https://helixtoolkit.codeplex.com/</a> as a 3D framework.</p>\n\n<p>I want to move <strong>black mesh</strong> relative to the <strong>green mesh</strong> as shown in the attached image below. I want to make green mesh parent to the black mesh as the change in scale of the green mesh also will result in motion of the black mesh. It could be partial parenting or may be more. I need 3D rotation and 3D transition + transition along green mesh's length axis for the black mesh relative to the green mesh itself.</p>\n\n<p>Suppose a variable <code>green_mesh_scale</code> causing scale for the green mesh along its length axis. The black mesh will use that variable in order to move along green mesh's length axis.</p>\n\n<p>How to go about it.</p>\n\n<p>I've done as follows:</p>\n\n<pre><code>GeometryModel3D GreenMesh, BlackMesh;\n...\n\ndouble green_mesh_scale = e.NewValue;\n\nTransform3DGroup forGreen = new Transform3DGroup();\nTransform3DGroup forBlack = new Transform3DGroup();\n\nforGreen.Children.Add(new ScaleTransform3D(new Vector3D(1, green_mesh_scale , 1)));\n// ... transforms for rotation n transition\nGreenMesh.Transform =  forGreen ;\n\nforBlack = forGreen;\nforBlack.Children.Add(new TranslateTransform3D(new Vector3D(0, green_mesh_scale, 0)));\nBlackMesh.Transform = forBlack;   \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/LlTXF.jpg\" alt=\"Black mesh is moving relative to the change in scale of the green mesh\"></p>\n\n<p>The problem with this is the scale transform will also be applied to the black mesh. I think i just need to avoid the scale part.</p>\n\n<p>I tried keeping all the transforms but scale, on another <code>Transform3DGroup</code> variable but that also not behaving as expected.</p>\n\n<p>Can <code>MatrixTransform3D</code> be used here some how?</p>\n\n<p>Also please suggest if this question can be posted somewhere else in stackexchange.</p>\n"},{"tags":["c#","wpf",".net-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1568,"score":5,"question_id":2820649,"title":"WPF Properties Panel simliar to Visual Studio's","body":"<p>Just wondering is their any examples or elements which can look very similar to the Properties panel used in Visual Studio?  My guess the one in Visual Studio 2010 is built upon WPF, almost definitely a treeview?</p>\n"},{"tags":["wpf","xaml","mvvm","charts","wpftoolkit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12482990,"title":"Binding chart LegendItem checkbox to series visibility in WPF","body":"<p>My WPFToolKit chart contains a few series.  I've templated the legend itself, and also templated the LegendItem by creating a style resource:</p>\n\n<pre><code>&lt;Style x:Key=\"CustomLegendItemStyle\" TargetType=\"{x:Type charting:LegendItem}\"&gt;\n    &lt;Setter Property=\"IsTabStop\" Value=\"False\" /&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type charting:LegendItem}\"&gt;\n                &lt;Border Background=\"{TemplateBinding Background}\" BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"{TemplateBinding BorderThickness}\"&gt;\n                    &lt;DockPanel LastChildFill=\"True\"&gt;\n                        &lt;Ellipse Width=\"10\" Height=\"10\" Fill=\"{Binding Background}\" Stroke=\"{Binding Background}\" StrokeThickness=\"1\" Margin=\"0,0,3,0\" DockPanel.Dock=\"Left\"/&gt;\n                        &lt;CheckBox IsChecked=\"{Binding Path=Visibility,Converter={StaticResource VisToBoolConverter},Mode=TwoWay}\" /&gt;\n                        &lt;TextBlock DockPanel.Dock=\"Right\" Text=\"(num)\" /&gt;\n                        &lt;datavis:Title Content=\"{TemplateBinding Content}\" Margin=\"10 0\" /&gt;\n                    &lt;/DockPanel&gt;\n                &lt;/Border&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n\n&lt;Style TargetType=\"{x:Type charting:LineSeries}\"&gt;\n    &lt;Setter Property=\"LegendItemStyle\" Value=\"{StaticResource CustomLegendItemStyle}\" /&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>This creates a checkbox in the LegendItem, which is supposed to be controlling the visibility of the series.  But it doesn't.  I've created properties on the ViewModel too (which default to true/visible), and which the LineSeries Visibility binds to</p>\n\n<pre><code>&lt;charting:LineSeries ... Visibility=\"{Binding DisplayLoad,Converter={StaticResource BoolToVisConverter},Mode=TwoWay}\" /&gt;\n</code></pre>\n\n<p>But the two don't hook up.  If I change the checkbox binding path to StoopidUser, I get a binding error in the output window telling me that StoopidUser property not found on object <code>LineDataPoint</code>, which has me a bit stumped.  I've checked right through and can't see (a) why it's a LineDataPoint (b) how to get to the series from it.</p>\n\n<p>Can you see what's wrong?</p>\n"},{"tags":[".net","wpf","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13009078,"title":"Dynamically creating regions with Prism","body":"<p>I am creating an app with Prism and am running into a bit of a roadblock.</p>\n\n<p>I have a tab control that is a prism region and has an ItemsSource collection that we are binding a model to. This model contains the data needed to set the tab caption, a view name, and a random id (Guid in this case) that we use to generate a dynamic prism region to be a container in the tab content with its own prism regions and can be navigated to.</p>\n\n<pre><code>+Prism region(tab control)\n|+ Prism region (dynamically created with Guid name)\n |+ Inserted view\n  |+ Prism region\n  |+ Prism region\n  |+ Prism region\n|+ Prism region (dynamically created with Guid name)    |\n |+ Inserted view\n  |+ Prism region\n  |+ Prism region\n  |+ Prism region\n</code></pre>\n\n<p>The hiccup I am running into is the region we are trying to generate does not appear to be registered within the region manager even though we appear to be registering them correctly.</p>\n\n<p>A series of searches and questions around the team have not brought any working solutions unfortunately.</p>\n\n<p>I am wondering if anyone has tried this before or if there are any good resources on dynamically generating prism regions in code and registering them.</p>\n"},{"tags":["c#","wpf","datagrid","master-detail","datatemplateselector"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13143094,"title":"datagrid detail view only for derived type","body":"<p>I have two classes</p>\n\n<pre><code>public class Employee{}\npublic class ContractEmployee: Employee{}\n</code></pre>\n\n<p>I have a list of employee which could contain both types</p>\n\n<pre><code>public List&lt;Employee&gt; allemployees{get;set;}\n</code></pre>\n\n<p>I want to display the employees in a datagrid. However, I want detail view for only ContractEmployee. This means the rows corresponding to ContractEmployee will show the \"+\" sign for expanding to see the details of ContractEmployee. However, I the grid should not show Employee types with the \"+\" sign.</p>\n\n<p>How can I do this in the XAML? I just need the idea, not the code.</p>\n"},{"tags":["c#","wpf","entity-framework","serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13142992,"title":"Deep Clone Entity Without Serialization","body":"<p>I need to deep clone an Entity (To use an existing Entity as pattern for a new one). I found several approaches, but all include Serialization. Since our Entities derive from ObservableObject of the MVVM Toolkit that is not Serializeable we can't use those approaches.</p>\n\n<p>What would be the best way to do so?</p>\n\n<p>We are usinng .net 4.5 and EF5 and WPF.</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13142787,"title":"Align label to the middle of dock panel","body":"<p>I have a dock panel, with one label in the middle and another button on the far right.</p>\n\n<p>Because of the button the label cannot align to the middle when the windows is maximized.</p>\n\n<p>WPF:</p>\n\n<pre><code>&lt;DockPanel Height=\"40\" HorizontalAlignment=\"Stretch\" Margin=\"-1,-2,0,0\" Name=\"dockPanel1\" VerticalAlignment=\"Stretch\" Width=\"Auto\" OpacityMask=\"{x:Null}\"&gt;\n            &lt;Label FontSize=\"18\" Content=\"Sales\" FontWeight=\"Bold\" FontFamily=\"Arial\" Width=\"883\" Height=\"42\" HorizontalAlignment=\"Center\" HorizontalContentAlignment=\"Center\" Foreground=\"White\" DockPanel.Dock=\"Left\" VerticalAlignment=\"Center\" VerticalContentAlignment=\"Center\"&gt;&lt;/Label&gt;\n            &lt;Button FontSize=\"18\" Height=\"47\" Width=\"123\" Name=\"btnStart\" Foreground=\"White\" BorderBrush=\"{x:Null}\" FlowDirection=\"LeftToRight\" HorizontalContentAlignment=\"Center\" FontFamily=\"Arial Rounded MT\" ClickMode=\"Press\" DockPanel.Dock=\"Right\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Center\" Padding=\"0\" Content=\"Start\" BorderThickness=\"0\" Focusable=\"False\"&gt;\n        &lt;/DockPanel&gt;\n</code></pre>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13141200,"title":"Disable button mouse over effect","body":"<p>I have a wppf button with a background image.</p>\n\n<p>When I mouse over background will be empty and a button is shown.</p>\n\n<p>How can I disable mouse effect?</p>\n\n<pre><code>&lt;Button BorderBrush=\"{x:Null}\" Content=\"Reset\" BorderThickness=\"0\"Foreground=\"White\" Focusable=\"False\"&gt;\n                        &lt;Button.Background&gt;\n                            &lt;ImageBrush ImageSource=\"button.png\" /&gt;\n                        &lt;/Button.Background&gt;\n</code></pre>\n"},{"tags":["c#","wpf","drag-and-drop","wpfdatagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13142871,"title":"Drag and drop issues in WPF 4 DataGrid","body":"<p>I've got a WPF application with a couple of datagrids which I want to use. And I want to be able to use drag and drop to move data rows between the datagrids. However, the \"main\" datagrid is too wide, so it has scrollbars (both vertical and horizontal). </p>\n\n<p>The problem:\nIf I drag and drop a row to another datagrid everything works just fine, however, if i decide to scroll in ANY manner other than tapping the arrows (i.e drag the scrollbars) the application seems to think that I actually want to drag and drop the scrollbar. I bet someone else has stumbled upon this problem, and would be really grateful for some help here. :)</p>\n\n<p>I only want the datarows to be draggable, not the grid itself.</p>\n\n<p><strong>This is the code I have that handles the MouseMove event:</strong></p>\n\n<pre><code>        private void dgMainGrid_MouseMove(object sender, MouseEventArgs e)\n    {\n            DataGrid dataGrid = sender as DataGrid;\n\n            sel = \"\";\n\n            int selectedIndex = dataGrid.SelectedIndex;\n            if (selectedIndex &gt; -1 &amp;&amp; e.LeftButton == MouseButtonState.Pressed)\n            {\n                int maxCount = dgMainGrid.SelectedItems.Count;\n\n                for (int i = 0; i &lt;= maxCount - 1; i++)\n                {\n                    DataRowView row = (DataRowView)dgMainGrid.SelectedItems[i];\n                    sel += row[\"ShpID\"].ToString() + \";\";\n                }\n\n                DragDrop.DoDragDrop(dataGrid, sel, DragDropEffects.Move);\n            }\n    }\n</code></pre>\n"},{"tags":["wpf","media","mediaelement","playlist"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":697,"score":3,"question_id":5204899,"title":"24/7 computer, problem with mediaelement WPF, turns black after 3h","body":"<p>I have a computer that are going to run a WPF program 24/7 and play a playlist of images and videos.\nWhen I start my program everything works perfectly, but after maybe 2-3h the mediaelement windows is black.</p>\n\n<p>When I start the program, it takes all the filenames in a folder and puts it in a listbox</p>\n\n<pre><code> Dim root As String = MediaDir &amp; \"media\"\n    Dim dir As New System.IO.DirectoryInfo(root)\n    Dim fileList = dir.GetFiles(\"*.*\", System.IO.SearchOption.AllDirectories)\n\n    Dim fileQuery = From file In fileList _\n                    Where file.Extension = \".jpg\" _\n                    Or file.Extension = \".avi\" _\n                    Or file.Extension = \".mov\" _\n                    Order By file.Name _\n                    Select file\n\n    For Each file In fileQuery\n        listbox1.Items.Add(file.FullName)\n    Next\n    i = 0\n    Media_Org.Source = New Uri(listbox1.Items(i), UriKind.Relative)\n</code></pre>\n\n<p>The next part is that I use MediaEnded to load the next one</p>\n\n<pre><code>    Private Sub Media_Org_MediaEnded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Media_Org.MediaEnded\n\n            i = i + 1\n            If i = listbox1.Items.Count Then\n                i = 0\n            End If\n            Media_Org.Source = New Uri(listbox1.Items(i), UriKind.Relative)\nEnd Sub\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>\"Another problem I have is that the cpu goes up to 60-70% when I play videos\"</p>\n"},{"tags":["wpf","expander","groupstyle","itemspresenter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13142841,"title":"Applying a GroupStyle to the Expander.Content Items Presenter in WPF","body":"<p>I'm binding a WPF <code>DataGrid</code> to a <code>CollectionViewSource</code> with Two <code>PropertyGroupDescription</code>s.  As a workaround to virtualizing the grid (which is quite troublesome as soon as grouping comes into play), I'd like to set the <code>Expander</code>'s <code>IsExpanded</code> property to false so the Data Loads instantly.  </p>\n\n<p>When I expand one of the primary grouping headers, if there are less than ~700 child items, I get decent preformance, but when there are thousands of items, the UI freezes.  I'd like to toggle the SECONDARY group's IsExpanded property so that I get a nice display when it's feasible and nice performance when it's neccessary.  I can use a <code>Converter</code> to check if the <code>ItemCount</code> is greater than or less than 700 in order to toggle the <code>IsExpanded</code> property to [True | False].</p>\n\n<p>I'm having trouble with the rest of the implementation.</p>\n\n<p><strong>Can I use the <code>Expander.Content</code> or <code>ItemsPresenter</code> to set <code>GroupStyle</code> Style Templates?</strong></p>\n\n<pre class=\"lang-xaml prettyprint-override\"><code>&lt;Style x:Key=\"DoubleContainerStyle\" TargetType=\"{x:Type GroupItem}\"&gt;\n  &lt;Setter Property=\"Template\"&gt;\n    &lt;Setter.Value&gt;\n      &lt;ControlTemplate TargetType=\"{x:Type GroupItem}\"&gt;\n        &lt;Expander IsExpanded=\"False\" &gt;\n          &lt;Expander.Header&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n              &lt;TextBlock Text=\"{Binding Path=Name, Converter={StaticResource enumNameItemsConverter}}\"/&gt;\n              &lt;TextBlock x:Name=\"PrimaryRecordCount\" Text=\"{Binding Path=ItemCount}\" /&gt;\n            &lt;/StackPanel&gt;\n          &lt;/Expander.Header&gt;\n          &lt;Expander.Content&gt;\n            &lt;ItemsPresenter&gt;\n              &lt;ItemsPresenter.Style&gt;\n                &lt;Style&gt;\n                  &lt;Setter Property=\"Template\"&gt;\n                    &lt;Setter.Value&gt;\n                      &lt;ControlTemplate TargetType=\"{x:Type GroupItem}\"&gt;\n                        &lt;Expander IsExpanded=\"{Binding Path=Text, Source=PrimaryRecordCount, Converter={StaticResource intThresholdtoBoolConverter}}\" &gt;\n                          &lt;Expander.Header&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\" &gt;\n                              &lt;TextBlock Text=\"Secondary Grouping\" /&gt;\n                            &lt;/StackPanel&gt;\n                          &lt;/Expander.Header&gt;\n                          &lt;Expander.Content&gt;\n                            &lt;ItemsPresenter /&gt;\n                          &lt;/Expander.Content&gt;\n                        &lt;/Expander&gt;\n                      &lt;/ControlTemplate&gt;\n                    &lt;/Setter.Value&gt;\n                  &lt;/Setter&gt;\n                &lt;/Style&gt;\n              &lt;/ItemsPresenter.Style&gt;\n            &lt;/ItemsPresenter&gt;\n          &lt;/Expander.Content&gt;\n        &lt;/Expander&gt;\n      &lt;/ControlTemplate&gt;\n    &lt;/Setter.Value&gt;\n  &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>In case it's helpful, I'm setting the static resource style to my grid like so:</p>\n\n<pre class=\"lang-xaml prettyprint-override\"><code>&lt;DataGrid.GroupStyle&gt;\n    &lt;GroupStyle ContainerStyle=\"{StaticResource QuickContainerStyle}\" /&gt;\n&lt;/DataGrid.GroupStyle&gt;\n</code></pre>\n\n<p>Thanks very much in advance for any help or advice you can offer.  If any of the other relevant code would be helpful I can update this post.</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":50,"score":1,"question_id":13142395,"title":"PresentationFontCache using 50% CPU, how to code to prevent this","body":"<p>I've written a XAML/C# program for doing some simple math calculations and displaying the results on the screen.  </p>\n\n<p>It uses some story boarding, and simple color changes, which is why I don't understand why <code>PresentationFontCache</code> sometimes goes crazy and hogs the CPU.  </p>\n\n<p>Is there a way to prevent <code>PresentationFontCache</code> from running in code?  I'm only using about 3 different fonts so I don't really need this to run.  </p>\n\n<p>A code based solution is needed, since I can't go to every user's machine to disable it via services.</p>\n"},{"tags":["wpf","windows","windows-xp","mediaelement"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13142739,"title":"Unable to play MedialElement in Windows XP","body":"<p>I have a WPF application which has a MediaElement control. The software runs perfectly ok in Windows 7 but runs into trouble when I try to run in Windows XP. In Windows XP, the software runs but won't play the media files. At first I thought, this is a codec issue, however the Media Player in XP can play the files. By the way I am copying the Debug folder to Windows XP and executing the application from there.</p>\n\n<p><em>I am kind of stuck here. Would really appreciate, if you can share your thoughts/solution.</em></p>\n"},{"tags":["wpf","triggers","datatemplateselector","datatemplates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13136816,"title":"Change Data template dynamically","body":"<p>I have a item control which is bound to Tasks. Each task has task state. I have defined different data templates for each task state, and also data template selector.</p>\n\n<p>Problem is that I am not able to figure out how to trigger data template selector when task state is changed dynamically.</p>\n\n<p><strong>I want to know how to use data triggers together with data templates.</strong></p>\n\n<p>If this will not work out, i will explore other alternatives such as<br>\n1. Attached Property bound to task state. Any change will dynamically set data template.<br>\n2. Visual State Manager  </p>\n"},{"tags":["wpf","infragistics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13085378,"title":"XamDataGrid support for ITypedList","body":"<p>In both cases the docs just mention that any <code>IEnumerable</code> will do. I have a custom object that implements <code>INotifyPropertyChanged</code> and <code>ITypedList</code> and I am bindind it to <code>XamGrid.ItemSource</code> and it works. However, it doesn't work with <code>XamDataGrid.DataSource</code>. I want the grid to reflect the changes to the custom collection.</p>\n\n<p>I know about the solution with <code>DataSet</code> adapter. Are there any other solutions?</p>\n"},{"tags":["wpf","iis","deployment","xbap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13016194,"title":"xbap cannot find it's DLLs until I run the file directly","body":"<p>Lately, when I deploy my xbap, if I browse to the url where IIS hosts it, I see a 'file not found' http error message on some of the DLLs it is trying to download from the Application Files folder.</p>\n\n<p>This will continue to be a problem until I double click the .xbap file in explorer to launch it.  Then I can browse through http:// to the xbap without any problems!</p>\n\n<p>How do I address this behavior?</p>\n"},{"tags":["wpf","performance","drawingbrush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":916,"score":1,"question_id":1337846,"title":"DrawingBrush Performance","body":"<p>Are there any differences when it comes to performance between the following three border objects?</p>\n\n<pre><code>&lt;Border Grid.Column=\"0\" Grid.ColumnSpan=\"2\" Opacity=\"1\"&gt;\n  &lt;Border.Background&gt;\n    &lt;DrawingBrush&gt;\n      &lt;DrawingBrush.Drawing&gt;\n        &lt;DrawingGroup&gt;\n          &lt;GeometryDrawing Brush=\"Red\"&gt;\n            &lt;GeometryDrawing.Geometry&gt;\n              &lt;GeometryGroup&gt;\n                &lt;RectangleGeometry Rect=\"0,0 100,1000\" /&gt;\n                &lt;LineGeometry StartPoint=\"0,0\" EndPoint=\"100,1000\"/&gt;\n                &lt;LineGeometry StartPoint=\"100,0\" EndPoint=\"0,1000\"/&gt;\n              &lt;/GeometryGroup&gt;\n            &lt;/GeometryDrawing.Geometry&gt;\n            &lt;GeometryDrawing.Pen&gt;\n              &lt;Pen Thickness=\"20\" Brush=\"Black\"/&gt;\n            &lt;/GeometryDrawing.Pen&gt;\n          &lt;/GeometryDrawing&gt;\n        &lt;/DrawingGroup&gt;\n      &lt;/DrawingBrush.Drawing&gt;\n    &lt;/DrawingBrush&gt;\n  &lt;/Border.Background&gt;\n&lt;/Border&gt;\n\n&lt;Border Grid.Column=\"0\" Grid.ColumnSpan=\"2\" Opacity=\"1\"&gt;\n  &lt;Border.Background&gt;\n    &lt;DrawingBrush&gt;\n      &lt;DrawingBrush.Drawing&gt;\n        &lt;DrawingGroup&gt;\n          &lt;GeometryDrawing Brush=\"Red\"&gt;\n            &lt;GeometryDrawing.Geometry&gt;\n              &lt;RectangleGeometry Rect=\"0,0 100,1000\" /&gt;\n            &lt;/GeometryDrawing.Geometry&gt;\n            &lt;GeometryDrawing.Pen&gt;\n              &lt;Pen Thickness=\"20\" Brush=\"Black\"/&gt;\n            &lt;/GeometryDrawing.Pen&gt;\n          &lt;/GeometryDrawing&gt;\n          &lt;GeometryDrawing&gt;\n            &lt;GeometryDrawing.Geometry&gt;\n              &lt;LineGeometry StartPoint=\"0,0\" EndPoint=\"100,1000\"/&gt;\n            &lt;/GeometryDrawing.Geometry&gt;\n            &lt;GeometryDrawing.Pen&gt;\n              &lt;Pen Thickness=\"20\" Brush=\"Black\"/&gt;\n            &lt;/GeometryDrawing.Pen&gt;\n          &lt;/GeometryDrawing&gt;\n          &lt;GeometryDrawing&gt;\n            &lt;GeometryDrawing.Geometry&gt;\n              &lt;LineGeometry StartPoint=\"100,0\" EndPoint=\"0,1000\"/&gt;\n            &lt;/GeometryDrawing.Geometry&gt;\n            &lt;GeometryDrawing.Pen&gt;\n              &lt;Pen Thickness=\"20\" Brush=\"Black\"/&gt;\n            &lt;/GeometryDrawing.Pen&gt;\n          &lt;/GeometryDrawing&gt;\n        &lt;/DrawingGroup&gt;\n      &lt;/DrawingBrush.Drawing&gt;\n    &lt;/DrawingBrush&gt;\n  &lt;/Border.Background&gt;\n&lt;/Border&gt;\n\n&lt;Border Grid.Column=\"3\" Grid.ColumnSpan=\"2\" Opacity=\"1\"&gt;\n  &lt;Image Stretch=\"Uniform\"&gt;\n    &lt;Image.Source&gt;\n      &lt;DrawingImage&gt;\n        &lt;DrawingImage.Drawing&gt;\n          &lt;DrawingGroup&gt;\n            &lt;GeometryDrawing Brush=\"Red\"&gt;\n              &lt;GeometryDrawing.Geometry&gt;\n                &lt;GeometryGroup&gt;\n                  &lt;RectangleGeometry Rect=\"0,0 100,1000\" /&gt;\n                  &lt;LineGeometry StartPoint=\"0,0\" EndPoint=\"100,1000\"/&gt;\n                  &lt;LineGeometry StartPoint=\"100,0\" EndPoint=\"0,1000\"/&gt;\n                &lt;/GeometryGroup&gt;\n              &lt;/GeometryDrawing.Geometry&gt;\n              &lt;GeometryDrawing.Pen&gt;\n                &lt;Pen Thickness=\"20\" Brush=\"Black\"/&gt;\n              &lt;/GeometryDrawing.Pen&gt;\n            &lt;/GeometryDrawing&gt;\n          &lt;/DrawingGroup&gt;\n        &lt;/DrawingImage.Drawing&gt;\n      &lt;/DrawingImage&gt;\n    &lt;/Image.Source&gt;\n  &lt;/Image&gt;\n&lt;/Border&gt;\n</code></pre>\n"},{"tags":["c#","wpf","silverlight"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13141685,"title":"How to get items in a specific range (3 - 7) from list?","body":"<p>What would be the most efficient way to select all the items in a specific range from a list and put it in a new one?</p>\n\n<p>List xmlList = new List();</p>\n\n<p>This is my List, and I would like to put all the DataClass items between the range (3 - 7) in a new List.</p>\n\n<p>What would be the most efficient way? A foreach loop that that count++ everytime untill he reaches the items between a the range and add those items to the new list?</p>\n\n<p>Kind regards,\nNiels</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13140607,"title":"How to include Listener type class in the WPF/MVVM pattern?","body":"<p>Imagine you have Listener class that will connect on app start to some server with Connect method, then it starts to listen to messages and on every received message it raises event OnRecievedMessage. Based on these messages you need to update viewmodels which in turn update views. What's more you have to run Listen() method on new thread in order to don't block UI, so event OnRecievedMessage will also run on this new thread.</p>\n\n<p>How would you incorporate such class in structure of WPF/MVVM application and how to connect it with viewmodel?</p>\n"},{"tags":["wpf","ribbon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13138584,"title":"WPF RibbonWindow tab bar style","body":"<p>I would like to create a RibbonWindow Application using WPF and where tab bar has the same look &amp; feel that the Window title bar. Like Office 2010 does:</p>\n\n<p><img src=\"http://i.stack.imgur.com/GxX6m.png\" alt=\"\"></p>\n\n<p>In my application, the tab bar has a colour blue-gray which is the default when adding Ribbon control:</p>\n\n<p><img src=\"http://i.stack.imgur.com/fZRdS.png\" alt=\"\"></p>\n\n<p>May I ask you your help on how to have this same layout please?</p>\n"},{"tags":["wpf","brush"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":2099,"score":7,"question_id":936786,"title":"WPF SolidColorBrush dilemma","body":"<p>Does anyone know how to convert a string that represents a color into a SolidColorBrush in wpf?</p>\n\n<p>For e.g:</p>\n\n<p>string colorRed = \"Red\";\nSolidColorBrush fromStringToColor = new SolidColorBrush(colorRed);</p>\n\n<p>That's sort of what I'm trying to accomplish.\nAny ideas?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","wpf","xaml","binding","datagridcomboboxcolumn"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12939817,"title":"DataGridComboBoxColumn Binding with 2 lists","body":"<p>I have trouble with binding the values of a ComboBox in my DataGrid:</p>\n\n<pre><code> &lt;DataGrid Grid.Row=\"1\" Grid.Column=\"0\" ItemsSource=\"{Binding ListeGrilleTarifaire}\" Name=\"dg_ForfaitCommune\" AutoGenerateColumns=\"False\" CanUserAddRows=\"True\" CanUserDeleteRows=\"False\" Visibility=\"{Binding accesGrilleForfaitCommune}\"&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridComboBoxColumn Header=\"{x:Static trad:Langues.lblPays}\" ItemsSource=\"{Binding ListePrixUnitaires}\" SelectedItemBinding=\"{Binding tarifDestination_PAYS,Mode=TwoWay}\" Width=\"80\" /&gt;\n    &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<ul>\n<li><p>My DataGrid ItemsSource is an object of type 'ListeGrilleTarifaire'</p></li>\n<li><p>ListeGrilleTarifaire is a list (property) of the object ViewModelGrilleTarifaire. ViewModelGrilleTarifaire is the the DataContext of my user control (where is located my DataGrid).</p></li>\n</ul>\n\n<p>What I would like to have is:</p>\n\n<ol>\n<li><p>my combobox to list values contained in the list ListePays (<code>List&lt;string&gt;</code>) defined in the ViewModelGrilleTarifaire class.</p></li>\n<li><p>The value of ListeGrilleTarifaire.tarifDestination_PAYS has to be automatically binded in the combobox when the DataGrid load ListeGrilleTarifaire objects (in short... it has to bind)</p></li>\n</ol>\n\n<p>Any help would be welcome!!</p>\n\n<p>Thank you!</p>\n\n<p>a.</p>\n"},{"tags":["wpf","treeview","mouseevent","treeviewitem"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3688,"score":3,"question_id":2280049,"title":"Why is the TreeViewItem's MouseDoubleClick event being raised multiple times per double click?","body":"<p>XAML</p>\n\n<pre><code>&lt;TreeView Name=\"GroupView\" ItemsSource=\"{Binding Documents}\"&gt;\n            &lt;TreeView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"{x:Type TreeViewItem}\"&gt;\n                    &lt;EventSetter Event=\"MouseDoubleClick\" Handler=\"OnTreeNodeDoubleClick\"/&gt;\n                &lt;/Style&gt;\n            &lt;/TreeView.ItemContainerStyle&gt;\n            ....\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>Code-Behind</p>\n\n<pre><code>private void OnTreeNodeDoubleClick(object sender, MouseButtonEventArgs mouseEvtArgs)\n       {\n           Console.WriteLine(\"{3} MouseDoubleClick Clicks={0} ChangedButton={1} Source={2} Handled={4} ButtonState={5}\",\n               mouseEvtArgs.ClickCount, mouseEvtArgs.ChangedButton, mouseEvtArgs.OriginalSource,\n               mouseEvtArgs.Timestamp, mouseEvtArgs.Handled, mouseEvtArgs.ButtonState);\n       }\n</code></pre>\n\n<p>I find that for one double click, the event handler is called multiple times. I'm trying to open up a document in tab on a double-click on the corresponding tree node; so I'd need to filter out the extra calls.</p>\n\n<pre><code>23479156 MouseDoubleClick Clicks=1 ChangedButton=Left Source=System.Windows.Controls.TextBlock Handled=False ButtonState=Pressed\n23479156 MouseDoubleClick Clicks=1 ChangedButton=Left Source=System.Windows.Controls.TextBlock Handled=False ButtonState=Pressed\n</code></pre>\n\n<p>In my slightly-complicated app, it is being raised 4 times per double-click. On a simple repro-app, it is being raised 2 times per double click. Also all the event argument parameters are the same too, so I can't distinguish the last one of a set.</p>\n\n<p>Any ideas why this is the way it is?</p>\n"},{"tags":["c#","wpf","winforms","printdialog","windowsformsintegration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13140069,"title":"Call PrintDialog.ShowDialog() in a WPF UserControl which is hosted in WinForms Application","body":"<p>I have a WPF UserControl which use the System.Windows.Controls.PrintDialog:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;UserControl x:Class=\"WpfControlLibrary1.UserControl1\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;    \n   &lt;Button Click=\"Button_Click\"/&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>CodeBehind:</p>\n\n<pre><code>namespace WpfControlLibrary1\n{\n   using System.Windows;\n   using System.Windows.Controls;\n\n   public partial class UserControl1 : UserControl\n   {\n      public UserControl1()\n      {\n         InitializeComponent();\n      }\n\n      private void Button_Click(object sender, RoutedEventArgs e)\n      {\n         var printer = new PrintDialog();\n         printer.ShowDialog();\n      }\n   }\n}\n</code></pre>\n\n<p>If I use now this UserControl in a WPF Appplication the PrintDialog-Windows appears as modal dialog. (Like described in msdn)</p>\n\n<p>But if I use the UserControl in a Wondows-Forms application, the dialog appears as a NON-Modal dialog.</p>\n\n<p>Anyone an idea how I can call the PrintDialog as modal dialog when I host the usercontrol in a Windows-Forms application?</p>\n\n<p>Thanking you in anticipation\nrhe1980</p>\n"},{"tags":["c#","wpf","windows-8","microsoft-metro"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":183,"score":0,"question_id":13139761,"title":"Metro vs WPF for Windows 8 development?","body":"<p>I'm trying to get my head around the future of development for Windows 8. My understanding is that developing Metro apps will mean they are strictly Windows 8 only.</p>\n\n<p>But there are technologies out there, see <a href=\"http://stackoverflow.com/questions/6391888/how-to-build-a-metro-app-in-wpf\">How to build a Metro App in WPF</a>, which means WPF could be used to make something have that Metro look and feel.</p>\n\n<p>So am I right in understanding that a WPF app could be developed - and run on Windows 7 - but also run on Windows 8? If only Metro apps can be run from the new Start screen in Windows 8, does that mean traditional style apps can still be run through the desktop mode?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wpf","class","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13137111,"title":"Failing To Access Members of Other ViewModel Class in WPF","body":"<p>I am working on set of radiobuttons which are dynamicaly generated in my app. I seem to be facing a issue when it comes to access the class members. Here is what I have done till now:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;GroupBox Header=\"Daughter Cards\" Height=\"Auto\" HorizontalAlignment=\"Stretch\" Margin=\"20,5,20,20\" Name=\"groupBox2\" VerticalAlignment=\"Stretch\" Width=\"Auto\"&gt;\n            &lt;Grid&gt;                   \n                &lt;Grid Grid.Column=\"0\"&gt;\n                    &lt;ItemsControl ItemsSource=\"{Binding SlotChildren}\"&gt;\n                        &lt;ItemsControl.ItemsPanel&gt;\n                            &lt;ItemsPanelTemplate&gt;\n                                &lt;UniformGrid Columns=\"3\" Rows=\"8\" /&gt;\n                            &lt;/ItemsPanelTemplate&gt;\n                        &lt;/ItemsControl.ItemsPanel&gt;\n\n                        &lt;ItemsControl.ItemTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;RadioButton Content=\"{Binding SlotButtons}\" Margin=\"0,10,0,0\" IsChecked=\"{Binding IsChecked}\" GroupName=\"SlotGroup\" Height=\"15\" Width=\"80\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/ItemsControl.ItemTemplate&gt;\n                    &lt;/ItemsControl&gt;\n                &lt;/Grid&gt;                \n\n                &lt;Grid Grid.Column=\"1\"&gt;                                                  \n                        &lt;ComboBox Grid.Row=\"0\" ItemsSource=\"{Binding DaughterBoardBoxList}\" SelectedItem=\"{Binding SelectedDaughterBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox5\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;\n                        &lt;ComboBox Grid.Row=\"1\" ItemsSource=\"{Binding DaughterVersionBoxList}\" SelectedItem=\"{Binding SelectedDaughterVersionBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox6\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;\n                        &lt;ComboBox Grid.Row=\"2\" ItemsSource=\"{Binding DaughterSerialBoxList}\" SelectedItem=\"{Binding SelectedDaughterSerialBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox7\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;\n\n                        &lt;Button Grid.Row=\"1\" Command=\"{Binding GetStringCommand}\" Content=\"Get String\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"RefreshDaughterCards\" VerticalAlignment=\"Center\" Width=\"90\" /&gt;\n                        &lt;Button Grid.Row=\"2\" Command=\"{Binding SetStringCommand}\" Content=\"Set String\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"WriteEEPROMDCBtn\" VerticalAlignment=\"Center\" Width=\"90\" /&gt;\n                        &lt;Label Content=\"{Binding DaughterStatus}\" Height=\"25\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"DaughterCardLabel\" VerticalAlignment=\"Center\" Width=\"170\" /&gt;\n                    &lt;/Grid&gt;                                       \n                &lt;/Grid&gt; \n        &lt;/GroupBox&gt;\n</code></pre>\n\n<p>EEPROMViewModel Class:</p>\n\n<pre><code>public ObservableCollection&lt;EEPROMSlotViewModel&gt; SlotChildren { get; set; }\n\npublic EEPROMViewModel ()\n{\n        SlotChildren = new ObservableCollection&lt;EEPROMSlotViewModel&gt;();\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"0 : None\", ID = 0 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"1 : None\", ID = 1 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"2 : None\", ID = 2 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"3 : None\", ID = 3 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"4 : None\", ID = 4 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"5 : None\", ID = 5 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { ParentVM = this, SlotButtons = \"6 : None\", ID = 6 });\n }\n</code></pre>\n\n<p>generates 7 radiobuttons with ID related to each.</p>\n\n<p>EEPROMSlotViewModel Class:</p>\n\n<pre><code>private string _SlotButtons;\n    public string SlotButtons\n    {\n        get; set;\n    }\n\n    private EEPROMViewModel _parentVm;\n    public EEPROMViewModel ParentVM\n    {\n        get; set;\n    }\n\n    private int _ID;\n    public int ID\n    {\n        get; set;\n    }\n\n    private bool _isChecked;\n    public bool IsChecked\n    {\n        get; set;\n    }\n</code></pre>\n\n<p>thus whenever I select a radiobutton and click <code>SETSTRING</code> button, the following code gets executed:</p>\n\n<pre><code>EEPROMSlotViewModel mSlotVM = new EEPROMSlotViewModel();\n\n        string label;\n        if (mSlotVM.ID == 0) //Accessing the 1st radiobutton clicked\n        {\n            label = string.Empty;\n            mSlotVM.getShortName(0, label);\n            if (label == string.Empty)\n            {\n                label = \"None\";\n            }\n\n            mSlotVM.SlotButtons = Convert.ToString(0 + \":\" + label); // Setting CONTENT of radiobutton selected \n        }\n</code></pre>\n\n<p>Lets say I clicked 1st radio button, ID is supposed to be 0. It calls <code>getShortName()</code> method which does the following:</p>\n\n<pre><code>ParentVM.SelectedDaughterBoardBoxList = ParentVM.DaughterBoardBoxList[0];\nParentVM.SelectedDaughterVersionBoxList = ParentVM.DaughterVersionBoxList[0];\nParentVM.SelectedDaughterSerialBoxList = ParentVM.DaughterSerialBoxList[0];\nshortlabel = \"Hello\";\n</code></pre>\n\n<p>I am facing few issues here:</p>\n\n<ul>\n<li>Is <code>mSlotVM</code> right way to access other class members/function?? </li>\n<li>Once control enters <code>getShortname()</code>, it throws the excetion as follows: <code>Object reference not set to an instance of an object.</code> at\n<code>ParentVM.DaughterBoardBoxList[0];</code>.</li>\n<li>Even if I comment the first 3 statements in getShortName(), When getShortName gets called and once the control comes back, value of\n<code>label</code> is \"\", i should be \"hello\".</li>\n</ul>\n\n<p>I feel <code>mSlotVm</code> this is the reason behind the exception. Please help :)</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13128168,"title":"Trouble populating a combobox","body":"<p>I've got a model class like so:</p>\n\n<pre><code>public class AttributesModel\n    {\n        public SortOrder SortBy { get; set; }\n\n        public enum SortOrder\n        {\n            Unsorted,\n            Ascending,\n            Descending\n        }\n\n        public AttributesModel(string field)\n        {\n            Field = field;\n        }\n    }\n</code></pre>\n\n<p>And a DataGrid which contains a Combobox as one of the columns, like so:</p>\n\n<pre><code>&lt;DataGridTemplateColumn Width=\"Auto\" IsReadOnly=\"False\" Header=\"Order\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;ComboBox ItemsSource=\"{Binding Path=AttributesModel}\" DisplayMemberPath=\"SortBy\" SelectedValuePath=\"SortBy\" SelectedValue=\"{Binding Path=AttributesModel}\"/&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n</code></pre>\n\n<p>The class containing the DataGrid also has the following as the constructor:</p>\n\n<pre><code>DataContext = this;\nitemsSource = new ObservableCollection&lt;AttributesModel&gt;(parentDatabaseTable.ListFields.Select(f =&gt; new AttributesModel(f)));\n</code></pre>\n\n<p>For some reason, all the fields in my DataGrid are populating except for the combobox.  Please note that I haven't included code for the other fields in the model class, or columns in the DataGrid for simplicity and readability.  They all get populated successfully, except for the combobox column.  Any ideas?</p>\n"},{"tags":["wpf","binding",".net-4.0","textbox","converter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13138125,"title":"TextBox bound to DateTime via converter formats itself while typing","body":"<p>I have a TextBox bound to a DateTime using a converter that implements Convert and ConvertBack. UpdateSourceTrigger is set to PropertyChanged so that validation is done as the user types. Here is the problem:</p>\n\n<ol>\n<li>User types a character</li>\n<li>Converter parses this to a DateTime</li>\n<li>Property in ViewModel is updated and validated</li>\n<li>Converter then converts this DateTime back into a string and changes the string in the text box</li>\n</ol>\n\n<p>This is undesirable as the text can change to a full date while the user has only typed part of a date. How can I stop the UI from doing this? Note that this has only become a problem since upgrading from .NET 3.5 to 4.0 because of this feature:</p>\n\n<p><a href=\"http://karlshifflett.wordpress.com/2009/05/27/wpf-4-0-data-binding-change-great-feature/\" rel=\"nofollow\">http://karlshifflett.wordpress.com/2009/05/27/wpf-4-0-data-binding-change-great-feature/</a></p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["wpf","wcf","xbap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13138915,"title":"Problems calling a WCF service from a WPF xbap client app in another host","body":"<p>I am new to WCF, I have developed a WCF service that returns a string with a required value, I publish it in IIS on the same computer and then I created a WPF client app, I tested it in Debug mode and worked fine, I tried publishing the client app in the IIS and tested it in the same machine and everything was ok, It's a full trust app.</p>\n\n<p>The problem is when I try to execute the client app in another machine, the thing is that from the machine I can access the service:</p>\n\n<pre><code>http://ip_address/OASWS.Utilities/Service1.svc\n</code></pre>\n\n<p>and there is no problem, and I can execute the app:</p>\n\n<pre><code>http://address/OASWS.Utilities.BrowserClient/UtilitiesBrowserClient.xbap\n</code></pre>\n\n<p>and the application is executed with no problems, but when the app tries to execute any function from the service I get the following error inmediatly:</p>\n\n<pre><code>Startup URI: http://ip_address/OASWS.Utilities.BrowserClient/UtilitiesBrowserClient.xbap\n\nApplication identity: http://ip_address/OASWS.Utilities.BrowserClient/UtilitiesBrowserClient.xbap#UtilitiesBrowserClient.xbap, Version=1.0.0.5, Culture=neutral, PublicKeyToken=5273a5e76684b5e7, processorArchitecture=msil/UtilitiesBrowserClient.exe, Version=1.0.0.5, Culture=neutral, PublicKeyToken=5273a5e76684b5e7, processorArchitecture=msil, type=win32\n</code></pre>\n\n<p>System.Runtime.Serialization.SerializationException: type 'System.ServiceModel.Channels.ReceivedFault' from assembly 'System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' is not marked as serializable.\n   at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)\n   at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n   at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo)\n   at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)\n   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)\n   at System.Runtime.Remoting.Channels.CrossAppDomainSerializer.SerializeObject(Object obj, MemoryStream stm)\n   at System.AppDomain.Serialize(Object o)\n   at System.AppDomain.MarshalObject(Object o)</p>\n\n<p>And I don't have a clue on what  could be happening or where does that error comes from, because the only this the service returns is a simple string.</p>\n\n<p>Does anyone have any idea?</p>\n\n<p>Thanks!!</p>\n"},{"tags":["c#","wpf","binding","treeview","relativesource"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":13008426,"title":"Bind to Parent Object Property with RelativeSource","body":"<p>I've built a WPF based Treeview with</p>\n\n<p>Item<br>\n-Subitem</p>\n\n<p>If Subitem is selected, I would like to display also Properties of Item.</p>\n\n<pre><code>&lt;StackPanel Grid.Column=\"2\" DataContext=\"{Binding ElementName=myTreeView, Path=SelectedItem}\"&gt;\n  &lt;TextBox Text=\"{Binding Path=Name, Mode=TwoWay}\" /&gt;\n  &lt;TextBox Text=\"{Binding RelativeSource={???} Path=Name, Mode=TwoWay}\" /&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>I guess I need to use a RelativeSource statement, but not quite sure how to do so.</p>\n"},{"tags":["wpf","design-patterns","mvvm","patterns"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13138352,"title":"How ViewModel can notify View that it should close itself?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/501886/wpf-mvvm-newbie-how-should-the-viewmodel-close-the-form\">WPF MVVM Newbie - how should the ViewModel close the form?</a>  </p>\n</blockquote>\n\n\n\n<p>I understand that the question sounds like MVVM pattern doesn't fit the situation. So, it would be better to implement, say, MVP.\nBut what if the whole application sits on MVVM and the solution has two dll's specific for MVVM (Models.dll, ViewModels.dll)?</p>\n"},{"tags":["wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13138299,"title":"WPF font quality","body":"<p>I'm developing a WPF app but I've noticed that at certain font sizes the text doesn't render as nicely as the samples you see in Control Panel -> Fonts. I'm using large Segoe UI fonts (<code>FontSize=\"36\"</code>), and the effect is more noticeable on the upright lines, e.g. a letter \"U\" might be slightly thicker on one side than the other.\n).</p>\n\n<p>The font quality improves at certain font sizes, e.g. <code>FontSize=\"48\"</code> (which I believe is the equivalent of 36pt), but using a limited number of font sizes isn't always practical.</p>\n\n<p>I can improve the font quality by applying the following properties to the TextBlock:-</p>\n\n<pre><code>TextOptions.TextFormattingMode=\"Display\" TextOptions.TextRenderingMode=\"ClearType\"\n</code></pre>\n\n<p>Given the improvement in quality I'm curious to know why WPF doesn't do this for all text, or is it down to performance? I was thinking of creating a global style to apply this to all controls, or will this cause a problem?</p>\n\n<p>(I tried uploading a screenshot but SO must store images at a low quality, and you couldn't really make out the font problem).</p>\n"},{"tags":["wpf","xaml","visual-studio-2012",".net-assembly","universe"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":109,"score":0,"question_id":13131161,"title":"Error trying to open a VS 2010 project in VS 2012 : Type universe cannot resolve assembly","body":"<p>I got a WPF solution developped with Visual Studio 2010. There is two projects in this solution : A windows desktop application and a Class library. The name of the Class Library is \"VinitySoftCommon\". When I try to open my project with Visual Studio 2012, everything goes well until I try to edit the XAML in designer. When I open my XAML file, the window appear normally, but if I click on a component of the window, I get this error from the designer :</p>\n\n<pre><code>Microsoft.Expression.DesignHost.Isolation.Remoting.RemoteException\n\nL'Universe de type ne peut pas résoudre l'assembly VinitySoftCommon, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.\n   à System.Reflection.Adds.SimpleUniverse.ResolveAssembly(AssemblyName name)\n   à Microsoft.MetadataReader.MetadataOnlyModule.&lt;GetType&gt;b__6b(AssemblyName assemblyName)\n   à System.TypeNameParser.ResolveAssembly(String asmName, Func`2 assemblyResolver, Boolean throwOnError, StackCrawlMark&amp; stackMark)\n   à System.TypeNameParser.ConstructType(Func`2 assemblyResolver, Func`4 typeResolver, etc, etc, etc....\n</code></pre>\n\n<p>The reference to VinitySoftCommon in my main project seems ok. But anyway, the problem is present in XAML files of VinitySoftCommon itself as well... I made a lot of searches but could not find an answer to this specific problem. I dont have Blend for Visual Studio installed on my computer. I only have Expression Blend 4 + Sketchflow but I dont use it.</p>\n"},{"tags":[".net","wpf","datagrid","header","angle"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13137684,"title":"wpf datagrid angled header style","body":"<p>I am creating the DataGrid angle header style based on <a href=\"http://blogs.msdn.com/b/wpfsdk/archive/2010/01/06/angled-headers-in-the-datagrid.aspx\" rel=\"nofollow\">Margaret Parsons article</a>.\nNow it is looking like this:</p>\n\n<pre><code>&lt;Style x:Key=\"DataGridColumnHeaderAngle\" \n       TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n    &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\" /&gt;\n    &lt;Setter Property=\"Template\"&gt;\n      &lt;Setter.Value&gt;\n        &lt;ControlTemplate TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n          &lt;Grid x:Name=\"HeaderGrid\" ShowGridLines=\"True\" \n              Width=\"30\"&gt;\n            &lt;Rectangle Name=\"HeaderRect\" Fill=\"Azure\" Stroke=\"Black\" \n                       Width=\"{TemplateBinding Width}\"\n                       Height=\"{TemplateBinding Height}\"&gt;\n              &lt;Rectangle.RenderTransform&gt;\n                &lt;SkewTransform CenterX=\"0\" AngleX=\"-60\" AngleY=\"0\"\n                     CenterY=\"{Binding RelativeSource={RelativeSource TemplatedParent}, \n                              Path=ActualHeight }\"/&gt;\n                &lt;/Rectangle.RenderTransform&gt;\n            &lt;/Rectangle&gt;\n\n            &lt;TextBlock Text=\"{TemplateBinding Content}\"\n                   Background=\"Aqua\"\n                   VerticalAlignment=\"Bottom\" HorizontalAlignment=\"Left\"&gt;\n                &lt;TextBlock.LayoutTransform&gt;\n                  &lt;RotateTransform Angle=\"-30\"/&gt;\n                &lt;/TextBlock.LayoutTransform&gt;\n                &lt;TextBlock.RenderTransform&gt;\n                  &lt;TranslateTransform  X=\"20\"/&gt;\n                &lt;/TextBlock.RenderTransform&gt;\n            &lt;/TextBlock&gt;\n\n            &lt;!--ContentPresenter Content=\"{TemplateBinding Content}\" Width=\"200\"\n                          VerticalAlignment=\"Bottom\" HorizontalAlignment=\"Left\"&gt;\n              &lt;ContentPresenter.LayoutTransform&gt;\n                &lt;RotateTransform Angle=\"-30\"/&gt;\n              &lt;/ContentPresenter.LayoutTransform&gt;\n              &lt;ContentPresenter.RenderTransform&gt;\n                &lt;TranslateTransform  X=\"18\"/&gt;\n              &lt;/ContentPresenter.RenderTransform&gt;\n            &lt;/ContentPresenter--&gt;\n\n          &lt;/Grid&gt;\n        &lt;/ControlTemplate&gt;\n      &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n  &lt;/Style&gt;\n</code></pre>\n\n<p><code>ContentPresenter</code> was changed to colored <code>TextBlock</code> for the purpose of seeing its borders.</p>\n\n<p>My problem: by default Column width is equal to header text width so cell place usage is not optimal.\nWhen I reduce column (<code>HeaderGrid</code>) width (by binding/converter or manually) the header text width is also decreased</p>\n\n<p><a href=\"http://i.stack.imgur.com/W1WNd.jpg\" rel=\"nofollow\">See image</a></p>\n\n<p>Is there any way to decrease column width without headers text cutting?</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1654,"score":3,"question_id":9665335,"title":"Properties does not exist in the current context","body":"<p>I have to store some strings in the Settings file of my project. However, I am not able to access the Settings file to store the strings.</p>\n\n<p>I definitely have accessed Properties file in an earlier project without facing any problems to store values.</p>\n\n<p><code>Properties.Settings.Default.test = ...</code><br/>\n<code>MyApp.Properties.Settings.Default.test = ...</code></p>\n\n<p>But here in the current project, I am constantly being driven mad by getting the <code>Properties does not exist in the current context</code>\nIs there any setting or something that has changed because of which <code>Properties</code> does not appear in Intellisense?</p>\n"},{"tags":[".net","wpf","data-binding","relativesource"],"answer_count":9,"favorite_count":86,"up_vote_count":154,"down_vote_count":0,"view_count":103174,"score":154,"question_id":84278,"title":"How do I use WPF bindings with RelativeSource?","body":"<p>How do I use <code>RelativeSource</code> with WPF bindings and what are the different use-cases?</p>\n"},{"tags":["wpf","resources","save"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":10428042,"title":"Progrmmatically save Resource Dictionary to Disk","body":"<p>I need to use a resource dictionary located in my local machine. My WPF application will add/remove items dynamically to that dictionary using Add() or Remove() methods. Once done I need to save the updated resource dictionary again to the disk.</p>\n\n<p>I don't find a direct way for this. Is there anything like ResurceDictionary.Save()?</p>\n"},{"tags":["c#","wpf","visual-studio","events","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13109253,"title":"Windows 8 PointerEntered for elements which are placed under another elements","body":"<p>I have a graphic application. To make interface a have made my own UserControl elements and placed them on top of each other using absolute positioning.</p>\n\n<p>For example I have such structure:</p>\n\n<pre><code>&lt;Canvas&gt;\n        &lt;local:UserControl1 Canvas.Left=\"50\" Canvas.Top=\"50\" PointerEntered=\"onPointerEntered\"/&gt;\n        &lt;local:UserControl2 Canvas.Left=\"50\" Canvas.Top=\"50\" PointerEntered=\"onPointerEntered\"/&gt;\n&lt;/Canvas&gt;\n</code></pre>\n\n<p>UserControl2 has transparent background and UserControl1 is visible through it.\nI'm trying to catch PointerEntered event for both: UserControl1 and UserControl2.\nBut because of UserControl2 being placed over UserControl1, PointerEntered  is fired only for UserControl2 object, but I need to catch this event for both.</p>\n\n<p>How can I solve this problem?</p>\n"},{"tags":["wpf","video","avi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13137417,"title":"wpf Mediaelement avi file does not display visual component, only audio track","body":"<p>I'm working on a WPF application and I'd like to allow user to play a video (it's gonna be always the same video), but as part of my testing process, I'm trying this with a .mp4 and .avi files. </p>\n\n<p>It turns out that .mp4 is playing ok, but .avi throws an exception:\n<strong><em>ErrorException = {\"Exception from HRESULT: 0xC00D109B\"}</em></strong>\nAlthough .avi audio track is played, but no visual component is showed.</p>\n\n<p>I'm developping in windows7, Platform target of my WPF app is x86. \nAny help would be appreciated and thank you in advance,</p>\n\n<p>Mary.</p>\n"},{"tags":["wpf","bing-maps","bing-maps-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13137330,"title":"How to organise pushpin with WPF bing map control","body":"<p>I am building a Desktop touch application using the WPF bing maps control.\nI have seen that you can add  element directly as an item to the map control or if using MVVM we can use the MapItemControls and define a binding to a collection of Location.</p>\n\n<p>For my scenario I will display on the map different type of information like :</p>\n\n<ul>\n<li><p>Location of customer projects in different Location . projects are organise by type ( Big project, medium project, Validated project )</p></li>\n<li><p>Location of customer sales offices</p></li>\n</ul>\n\n<p>PushpPins will be visualy identified differently based on Project type and Sales Office.</p>\n\n<p>The question I have, is about the way to organise those pushpins on the map .</p>\n\n<p>Do I have to go to a single ObservableCollection of Location which will contains Projects Location and Sales area and display them all in a single maplayer ?</p>\n\n<p>Do I better go to create a MapLayer for each PushPin type and bind them to respective collection ?\n  \n   </p>\n\n<p>What is the best ?</p>\n\n<p>regards\nserge</p>\n"},{"tags":["c#",".net","wpf","dynamic","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13133800,"title":"Program Crashes When Dynamically generated radiobuttons are created in WPF","body":"<p>I am a C++ developer and I recently moved to C#. I am working on a wpf app using MVVM pattern. I have a groupboxbox in my xaml file which I have divided into two columns. One column contains the dynamically generated set of radiobuttons and other colums contains a label and many comboboxes.</p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;GroupBox Header=\"Daughter Cards\" Height=\"Auto\" HorizontalAlignment=\"Stretch\" Margin=\"20,5,20,20\" Name=\"groupBox2\" VerticalAlignment=\"Stretch\" Width=\"Auto\"&gt;\n            &lt;Grid&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition /&gt;                        \n                    &lt;ColumnDefinition Width=\"220\" /&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n\n                &lt;Grid Grid.Column=\"0\"&gt;\n                    &lt;ItemsControl ItemsSource=\"{Binding SlotChildren}\"&gt;\n                        &lt;ItemsControl.ItemsPanel&gt;\n                            &lt;ItemsPanelTemplate&gt;\n                                &lt;UniformGrid /&gt;\n                            &lt;/ItemsPanelTemplate&gt;\n                        &lt;/ItemsControl.ItemsPanel&gt;\n\n                        &lt;ItemsControl.ItemTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;RadioButton Content=\"{Binding SlotButtons}\" Margin=\"0,10,0,0\" IsChecked=\"{Binding IsChecked}\" GroupName=\"SlotGroup\" Height=\"15\" Width=\"80\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/ItemsControl.ItemTemplate&gt;\n                    &lt;/ItemsControl&gt;\n                &lt;/Grid&gt;                \n\n                &lt;Grid Grid.Column=\"1\"&gt;                        \n                        &lt;ComboBox ItemsSource=\"{Binding DaughterBoardBoxList}\" SelectedItem=\"{Binding SelectedDaughterBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox5\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;\n                        &lt;ComboBox ItemsSource=\"{Binding DaughterVersionBoxList}\" SelectedItem=\"{Binding SelectedDaughterVersionBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox6\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;\n                        &lt;ComboBox ItemsSource=\"{Binding DaughterSerialBoxList}\" SelectedItem=\"{Binding SelectedDaughterSerialBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"comboBox7\" VerticalAlignment=\"Center\" Width=\"158\" /&gt;                        \n                        &lt;Label Content=\"{Binding DaughterStatus}\" Height=\"25\" HorizontalAlignment=\"Center\" Margin=\"0\" Name=\"DaughterCardLabel\" VerticalAlignment=\"Center\" Width=\"170\" /&gt;\n                        &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding I2CAddressList}\" SelectedItem=\"{Binding SelectedI2CAddressList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"0\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox1\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                        &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding BoardBoxList}\" SelectedItem=\"{Binding SelectedBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"1\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox2\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                        &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding VersionBoxList}\" SelectedItem=\"{Binding SelectedVersionBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"2\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox3\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                        &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding SerialBoxList}\" SelectedItem=\"{Binding SelectedSerialBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"3\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox4\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;                \n                &lt;/Grid&gt;                                       \n            &lt;/Grid&gt; \n&lt;/GroupBox&gt;\n</code></pre>\n\n<p><strong>EEPROMViewModel Class:</strong> DataContext of xaml is set to this class. In the same class:</p>\n\n<pre><code>Byte[] sendBuf = new Byte[256];\n    Byte[] readBuf = new Byte[256];\n\n    public ObservableCollection&lt;EEPROMSlotViewModel&gt; SlotChildren { get; set; }\n\n    public ObservableCollection&lt;string&gt; _I2CAddressList;\n    public ObservableCollection&lt;string&gt; _BoardBoxList;\n    public ObservableCollection&lt;string&gt; _VersionBoxList;\n    public ObservableCollection&lt;string&gt; _SerialBoxList;\n    public ObservableCollection&lt;string&gt; _DBoardBoxList;\n    public ObservableCollection&lt;string&gt; _DVersionBoxList;\n    public ObservableCollection&lt;string&gt; _DSerialBoxList;       \n\n    public EEPROMViewModel()\n    {              \n\n        SlotChildren = new ObservableCollection&lt;EEPROMSlotViewModel&gt;();\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"0 : None\", ID = 0 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"1 : None\", ID = 1 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"2 : None\", ID = 2 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"3 : None\", ID = 3 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"4 : None\", ID = 4 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"5 : None\", ID = 5 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"6 : None\", ID = 6 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"7 : None\", ID = 7 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"8 : None\", ID = 8 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"9 : None\", ID = 9 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"10 : None\", ID = 10 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"11 : None\", ID = 11 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"12 : None\", ID = 12 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"13 : None\", ID = 13 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"14 : None\", ID = 14 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"15 : None\", ID = 15 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"16 : None\", ID = 16 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"17 : None\", ID = 17 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"18 : None\", ID = 18 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"19 : None\", ID = 19 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"20 : None\", ID = 20 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"21 : None\", ID = 21 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"22 : None\", ID = 22 });\n        SlotChildren.Add(new EEPROMSlotViewModel() { SlotButtons = \"23 : None\", ID = 23 });\n\n        var myboard = new[]\n        {      \n               \"\",\n               \"S1010012\",   // redhook\n               \"S1010018\",   // bavaria\n               \"S1010020\"    // flying dog\n        };\n\n        var myVariant = new[]\n        { \n               \"\",    \n               \"001A\",\n               \"001B\",\n               \"001C\",\n               \"002A\",\n               \"002B\",\n               \"002C\",\n               \"003A\",\n               \"003B\",\n               \"003C\",\n        };      \n\n        _I2CAddressList = new ObservableCollection&lt;string&gt;();\n        _BoardBoxList = new ObservableCollection&lt;string&gt;(myboard);\n        _VersionBoxList = new ObservableCollection&lt;string&gt;(myVariant);\n        _SerialBoxList = new ObservableCollection&lt;string&gt;();\n\n        for (int i = 1; i &lt; 200; i++)\n        {\n            _SerialBoxList.Add(i.ToString());\n        }\n\n        //List of I2C Address\n        _I2CAddressList.Add(\"0x50\");\n        _I2CAddressList.Add(\"0x53\");\n\n        this.SelectedI2CAddressList = this._I2CAddressList[1];\n        this.SelectedBoardBoxList = this.BoardBoxList[2];\n        this.SelectedVersionBoxList = this.VersionBoxList[2];\n        this.SelectedSerialBoxList = this.SerialBoxList[0];                       \n\n        var myDBoards = new[]\n        { \n               \"\",    \n               \"S1010013\",\n               \"S1010014\",\n               \"S1010015\",\n               \"S1010017\",\n               \"S1010019\",\n               \"S1010021\",\n               \"S1010023\",\n               \"S1010026\",\n               \"S1110029\",\n        };\n\n        _DBoardBoxList = new ObservableCollection&lt;string&gt;(myDBoards);\n        _DVersionBoxList = new ObservableCollection&lt;string&gt;(myVariant);\n        _DSerialBoxList = new ObservableCollection&lt;string&gt;();\n\n        for (int j = 1; j &lt; 500; j++)\n        {\n            _DSerialBoxList.Add(j.ToString());\n        }                     \n\n    }              \n\n    public ObservableCollection&lt;string&gt; I2CAddressList\n    {\n        get { return _I2CAddressList; }\n        set\n        {\n            _I2CAddressList = value;\n            OnPropertyChanged(\"I2CAddressList\");\n        }\n    }\n\n    private string _SelectedI2CAddressList;\n    public string SelectedI2CAddressList\n    {\n        get { return _SelectedI2CAddressList; }\n        set\n        {\n            _SelectedI2CAddressList = value;\n            OnPropertyChanged(\"SelectedI2CAddressList\");\n        }\n    }\n\n    public ObservableCollection&lt;string&gt; BoardBoxList\n    {\n        get { return _BoardBoxList; }\n        set\n        {\n            _BoardBoxList = value;\n            OnPropertyChanged(\"BoardBoxList\");\n        }\n    }\n\n    private string _SelectedBoardBoxList;\n    public string SelectedBoardBoxList\n    {\n        get { return _SelectedBoardBoxList; }\n        set\n        {\n            _SelectedBoardBoxList = value;\n            OnPropertyChanged(\"SelectedBoardBoxList\");\n        }\n    }\n\n    public ObservableCollection&lt;string&gt; VersionBoxList\n    {\n        get { return _VersionBoxList; }\n        set\n        {\n            _VersionBoxList = value;\n            OnPropertyChanged(\"VersionBoxList\");\n        }\n    }\n\n    private string _SelectedVersionBoxList;\n    public string SelectedVersionBoxList\n    {\n        get { return _SelectedVersionBoxList; }\n        set\n        {\n            _SelectedVersionBoxList = value;\n            OnPropertyChanged(\"SelectedVersionBoxList\");\n        }\n    }\n\n    public ObservableCollection&lt;string&gt; SerialBoxList\n    {\n        get { return _SerialBoxList; }\n        set\n        {\n            _SerialBoxList = value;\n            OnPropertyChanged(\"SerialBoxList\");\n        }\n    }\n\n    private string _SelectedSerialBoxList;\n    public string SelectedSerialBoxList\n    {\n        get { return _SelectedSerialBoxList; }\n        set\n        {\n            _SelectedSerialBoxList = value;\n            OnPropertyChanged(\"SelectedSerialBoxList\");\n        }\n    }        \n\n    char[] version = \n        {\n                'A', 'U', 'D', 'I', 'E', 'N', 'C', 'E',         // name\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // reserved,  firmware size\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // board number\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // variant, version, serial\n                '0', '0', '0', '0', '0', '0', '0', '0'          // date code, reserved\n        };        \n\n    public ObservableCollection&lt;string&gt; DaughterBoardBoxList\n    {\n        get { return _DBoardBoxList; }\n        set\n        {\n            _DBoardBoxList = value;\n            OnPropertyChanged(\"DaughterBoardBoxList\");\n        }\n    }\n\n    public string _SelectedDBoardBoxList;\n    public string SelectedDaughterBoardBoxList\n    {\n        get { return _SelectedDBoardBoxList; }\n        set\n        {\n            _SelectedDBoardBoxList = value;\n            OnPropertyChanged(\"SelectedDaughterBoardBoxList\");\n        }\n    }\n\n    public ObservableCollection&lt;string&gt; DaughterVersionBoxList\n    {\n        get { return _DVersionBoxList; }\n        set\n        {\n            _DVersionBoxList = value;\n            OnPropertyChanged(\"DaughterVersionBoxList\");\n        }\n    }\n\n    public string _SelectedDVersionBoxList;\n    public string SelectedDaughterVersionBoxList\n    {\n        get { return _SelectedDVersionBoxList; }\n        set\n        {\n            _SelectedDVersionBoxList = value;\n            OnPropertyChanged(\"SelectedDaughterVersionBoxList\");\n        }\n    }\n\n    public ObservableCollection&lt;string&gt; DaughterSerialBoxList\n    {\n        get { return _DSerialBoxList; }\n        set\n        {\n            _DSerialBoxList = value;\n            OnPropertyChanged(\"DaughterSerialBoxList\");\n        }\n    }\n\n    private string _SelectedDSerialBoxList;\n    public string SelectedDaughterSerialBoxList\n    {\n        get { return _SelectedDSerialBoxList; }\n        set\n        {\n            _SelectedDSerialBoxList = value;\n            OnPropertyChanged(\"SelectedDaughterSerialBoxList\");\n        }\n    }\n\n    private string _DaughterStatus = \"Not Retrieved yet\";\n    public string DaughterStatus\n    {\n        get { return _DaughterStatus; }\n        set\n        {\n            _DaughterStatus = value;\n            OnPropertyChanged(\"DaughterStatus\");\n        }\n    }          \n</code></pre>\n\n<p><strong>EEPROMSlotViewModel Class:</strong>  </p>\n\n<pre><code>EEPROMViewModel mVMModel = new EEPROMViewModel();\nprivate string _SlotButtons;\n    public string SlotButtons\n    {\n        get; set;\n    }\n\n    private int _ID;\n    public int ID\n    {\n        get; set;\n    }\n\n    private bool _isChecked;\n    public bool IsChecked\n    {\n        get { return _isChecked; }\n        set\n        {\n            _isChecked = value;\n            OnSlotClick(ID);\n            OnPropertyChanged(\"IsChecked\");\n        }\n    }\n\npublic void OnSlotClick(int Index)\n    {\n        string label = string.Empty;\n        if (Index &gt;= 0 &amp;&amp; Index &lt; 24)\n        {\n            //getShortName(Index, label);\n            if (label == string.Empty)\n            {\n                SlotButtons = Convert.ToString(Index + \" : None\");\n            }\n            else\n            {\n                SlotButtons = Convert.ToString(Index + \" :\" + label);\n            }\n        }\n\n        if (label != string.Empty)\n        {\n            label += \" - \";\n            //getLongName(Index, label);\n        }\n        else\n        {\n            label = \"No device found at this slot\";\n        }\n\n        mVMModel.DaughterStatus = label; // displays it in the label\n    }\n</code></pre>\n\n<p>When I am trying to run the application, it crashes and throws an exception as stackoverflow. The problem seems to be present in <strong>EEPROMSlotViewModel</strong> when I ccheck any radiobutton and the articular method gets called.</p>\n\n<p>Whats the mistake I am doing here? :( \nPlease help :)</p>\n"},{"tags":["wpf","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13135715,"title":"separating visual studio WPF designer panels","body":"<p>Is there any way to completely separate (as in to have them on different windows on different screens) the XAML and Design tabs of the WPF designer in Visual Studio? I've been looking vut haven't found it..</p>\n"},{"tags":["c#",".net","wpf","memory-management","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13135047,"title":"Failing to copy memory in my wpf app","body":"<p>I am a C++ developer and I recently started working on WPF. I am working on series of comboboxes and a button. here is the code:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;GroupBox Header=\"EEPROM Version Strings\" Grid.Column=\"1\" Height=\"Auto\" HorizontalAlignment=\"Stretch\" Margin=\"10,0,10,0\" Name=\"groupBox1\" VerticalAlignment=\"Stretch\" Width=\"Auto\"&gt;\n            &lt;Grid&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition /&gt;\n                    &lt;RowDefinition /&gt;\n                    &lt;RowDefinition /&gt;\n                    &lt;RowDefinition /&gt;\n                    &lt;RowDefinition /&gt;\n                &lt;/Grid.RowDefinitions&gt;\n                &lt;Button Content=\"Write EEPROM\" Command=\"{Binding WriteEEPROMCommand}\" Grid.Row=\"4\" Height=\"23\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"WriteEEPROMVersionStrings\" VerticalAlignment=\"Center\" Width=\"116\" /&gt;\n                &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding I2CAddressList}\" SelectedItem=\"{Binding SelectedI2CAddressList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"0\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox1\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding BoardBoxList}\" SelectedItem=\"{Binding SelectedBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"1\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox2\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding VersionBoxList}\" SelectedItem=\"{Binding SelectedVersionBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"2\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox3\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n                &lt;ComboBox Height=\"23\" ItemsSource=\"{Binding SerialBoxList}\" SelectedItem=\"{Binding SelectedSerialBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Grid.Row=\"3\" HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"comboBox4\" VerticalAlignment=\"Center\" Width=\"200\" /&gt;\n            &lt;/Grid&gt;                    \n        &lt;/GroupBox&gt;\n</code></pre>\n\n<p>Since I am using MVVM, Here is my ViewModel Class:</p>\n\n<pre><code>Byte[] sendBuf = new Byte[256];\n    Byte[] readBuf = new Byte[256];       \n\n    public ObservableCollection&lt;string&gt; _I2CAddressList;\n    public ObservableCollection&lt;string&gt; _BoardBoxList;\n    public ObservableCollection&lt;string&gt; _VersionBoxList;\n    public ObservableCollection&lt;string&gt; _SerialBoxList;\n</code></pre>\n\n<p>In Constructor:</p>\n\n<pre><code>var myboard = new[]\n        {      \n               \"\",\n               \"S1010012\",   // redhook\n               \"S1010018\",   // bavaria\n               \"S1010020\"    // flying dog\n        };\n\n        var myVariant = new[]\n        { \n               \"\",    \n               \"001A\",\n               \"001B\",\n               \"001C\",\n               \"002A\",\n               \"002B\",\n               \"002C\",\n               \"003A\",\n               \"003B\",\n               \"003C\",\n        };      \n\n        _I2CAddressList = new ObservableCollection&lt;string&gt;();\n        _BoardBoxList = new ObservableCollection&lt;string&gt;(myboard);\n        _VersionBoxList = new ObservableCollection&lt;string&gt;(myVariant);\n        _SerialBoxList = new ObservableCollection&lt;string&gt;();\n\n        for (int i = 1; i &lt; 200; i++)\n        {\n            _SerialBoxList.Add(i.ToString());\n        }\n\n        //List of I2C Address\n        _I2CAddressList.Add(\"0x50\");\n        _I2CAddressList.Add(\"0x53\");\n\n        this.SelectedI2CAddressList = this._I2CAddressList[1];\n        this.SelectedBoardBoxList = this.BoardBoxList[2];\n        this.SelectedVersionBoxList = this.VersionBoxList[2];\n        this.SelectedSerialBoxList = this.SerialBoxList[0];\n</code></pre>\n\n<p>Here goes the combobox and button property:</p>\n\n<pre><code>public ObservableCollection&lt;string&gt; I2CAddressList\n    {\n        get { return _I2CAddressList; }\n        set\n        {\n            _I2CAddressList = value;\n            OnPropertyChanged(\"I2CAddressList\");\n        }\n    }\n\n    private string _SelectedI2CAddressList;\n    public string SelectedI2CAddressList\n    {\n        get { return _SelectedI2CAddressList; }\n        set\n        {\n            _SelectedI2CAddressList = value;\n            OnPropertyChanged(\"SelectedI2CAddressList\");\n        }\n    }        \n\n    // Similar property for other comboboxes\n\n    private ICommand mWriteEEPROMCommand;\n    public ICommand WriteEEPROMCommand\n    {\n        get\n        {\n            if (mWriteEEPROMCommand == null)\n                mWriteEEPROMCommand = new DelegateCommand(new Action(mWriteEEPROMCommandExecuted), new Func&lt;bool&gt;(mWriteEEPROMCommandCanExecute));\n\n            return mWriteEEPROMCommand;\n        }\n        set\n        {\n            mWriteEEPROMCommand = value;\n        }\n    }\n\n    public bool mWriteEEPROMCommandCanExecute()\n    {\n        return true;\n    }\n\n    char[] version = \n        {\n                'A', 'U', 'D', 'I', 'E', 'N', 'C', 'E',         // name\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // reserved,  firmware size\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // board number\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // variant, version, serial\n                '0', '0', '0', '0', '0', '0', '0', '0'          // date code, reserved\n        };               \n\n    public void mWriteEEPROMCommandExecuted()\n    {\n        int temp, memloc = 0;\n        int cmd = 0x0A53;\n\n        // fill in the I2C address\n        if ((I2CAddressList.IndexOf(_SelectedI2CAddressList) + 1) == 1)\n        {\n            cmd = 0x0A50;\n        }\n\n        // fill in the address to write to -- 0\n        sendBuf[memloc++] = 0;\n        sendBuf[memloc++] = 0;   \n\n        // fill in the audience header\n        for (int i = 0; i &lt; 8; i++)\n        {\n            sendBuf[i + memloc] = Convert.ToByte(version[i]);       // the first 8 bytes\n        }               \n        memloc += 16;                                               // the 8 copied, plus 8 reserved bytes\n\n        temp = (BoardBoxList.IndexOf(_SelectedBoardBoxList) + 1);\n        if (temp &gt;= 1 &amp;&amp; temp &lt;= 3) \n        {\n            // How to perform the memory operation here\n        }\n\n        memloc += 8;            // move regardless if this was set\n    }\n</code></pre>\n\n<p>I am not able to figure out how can i perform the memory operation on <code>myboard</code>. Although I was able to do it on <code>version</code>. This is how I had done it in C++ code</p>\n\n<pre><code>sendBuf[memloc++] = 0;\n    sendBuf[memloc++] = 0;\n\n    // fill in the audience header\n    memcpy(sendBuf+memloc, version, 8); // the first 8 bytes\n    memloc += 16;\n\ntemp = m_boardBox-&gt;getSelectedId();\n    if(temp &gt;= 1 &amp;&amp; temp &lt;= 3) // a valid board selection\n        memcpy(sendBuf+memloc, boards[temp], 8);\n    memloc += 8;\n</code></pre>\n\n<p>where boards is like this: </p>\n\n<pre><code>static const signed char boards[][9] = {\n{},                                           // left blank to indicate no selection\n{ 'S', '1', '0', '1', '0', '0', '1', '2', 0 },   // redhook\n{ 'S', '1', '0', '1', '0', '0', '1', '8', 0 },   // bavaria\n{ 'S', '1', '0', '1', '0', '0', '2', '0', 0 },   // flying dog\n</code></pre>\n\n<p>};</p>\n\n<p>Thus when I click WRITEEEPROM Button, the series of code is executed. I have been succesful to someextent but when I came across how to copy memory for array of strings, i couldnt solve it. I have shown the C++ sample above :) </p>\n\n<p>How can I achieve it???</p>\n"},{"tags":["c#","wpf","arraylist"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13135777,"title":"How to sort the array list by subsequent number in wpf?","body":"<pre><code>ArrayList SortItems = new ArrayList();\n        SortItems.Add(\"Item1\");\n        SortItems.Add(\"Item2\");\n        SortItems.Add(\"Item3\");\n        SortItems.Add(\"Item4\");\n        SortItems.Add(\"Item5\");\n        SortItems.Add(\"Item6\");\n        SortItems.Add(\"Item7\");\n        SortItems.Add(\"Item8\");\n        SortItems.Add(\"Item9\");\n        SortItems.Add(\"Item10\");\n        SortItems.Add(\"Item11\");\n\n        SortItems.Sort();\n</code></pre>\n\n<p>If i run this program, i will get the below result</p>\n\n<p><img src=\"http://i.stack.imgur.com/iIw3k.png\" alt=\"enter image description here\"></p>\n\n<p>But i want to sort the list like <strong>Item1,Item2,Item3,Item4,Item5,Item6,Item7,Item8,Item9,Item10,Item11</strong></p>\n"},{"tags":["c#",".net","wpf","uri"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13132564,"title":"Get XML from resources, or site","body":"<p>I have some problem with URI into two last code rows: I try get XML from application resources, and from site. Before it, I executed the same operations with the image - everything worked fine. Exception message in a comments.</p>\n\n<pre><code>// Get image from site: \n// \"pack://siteoforigin:,,,/http://www.designdownloader.com/item/pngs/user_f036/user_f036-20111114102144-00003.png\"\n\n// Get image from building resources (Build Action = Resources).\nUri uri_male_default = new Uri(\"pack://application:,,,/male.png\");\n\n// Get image from site: \n// \"pack://siteoforigin:,,,/http://www.designdownloader.com/item/pngl/user_f046/user_f046-20111114102341-00003.png\"\n\n// Get image from building resources (Build Action = Resources).\nUri uri_female_default = new Uri(\"pack://application:,,,/myImages/famale.png\"); \n\n// Create images (it's works fine):\nimg_male_default = new BitmapImage(uri_male_default);\nimg_female_default = new BitmapImage(uri_female_default);\n\n//The next both cases ain't working:\n// NotSupportedException: URI prefix isn't recognized.     \nXElement xml_1 = XElement.Load(\"pack://application:,,,/SettingsX.xml\"); // Get XML from building resources (Build Action = Resources).\nXElement xml_2 = XElement.Load(\"pack://siteoforigin:,,,/https://skydrive.live.com/?cid=51b3145b64e05fef&amp;id=51B3145B64E05FEF%21550\");\n</code></pre>\n\n<p>The <code>XElement.Load</code> get an URI as parameter. Why I can't to do it with XML? </p>\n\n<p>Best Regards, \nAndrey.</p>\n"},{"tags":["wpf","listbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13135898,"title":"Modify Behavior of an WPF ListBox","body":"<p>I'm trying to make a control similar to the Surface Library Container (http://msdn.microsoft.com/en-us/library/ff727734.aspx) without the drag and drop operation. The user will select an item by clicking over an image. The application is for Pixelsense, but I've tried to disable the drag operations from the LibraryContainer but I've cannot achieve that so I've started to design my own.</p>\n\n<p>It works quite well but I have an interaction trouble. I dont't want to show the scrollbar, but I want the user scroll the content by moving their finger inside the control, even if its finger is over an image.</p>\n\n<p>I know I can do that modifying the interaction behavior but I don't know how to do it.</p>\n\n<p>Below is the code of my control.</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"groupTemplate\" DataType=\"shared:Product\"&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBlock Text=\"{Binding Name}\" Foreground=\"Black\" Margin=\"5,0\"/&gt;\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n\n&lt;ListBox x:Name=\"list\" Grid.Row=\"1\" SelectionMode=\"Multiple\" Margin=\"10,5\" ItemsSource=\"{Binding Source={StaticResource  groups}}\"      ScrollViewer.VerticalScrollBarVisibility=\"Disabled\" ScrollViewer.HorizontalScrollBarVisibility=\"Hidden\"&gt;\n&lt;ListBox.GroupStyle&gt;\n        &lt;GroupStyle HeaderTemplate=\"{StaticResource groupTemplate}\"&gt;\n            &lt;GroupStyle.Panel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"/&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/GroupStyle.Panel&gt;\n        &lt;/GroupStyle&gt;\n    &lt;/ListBox.GroupStyle&gt;\n    &lt;ListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;WrapPanel Orientation=\"Horizontal\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListBox.ItemsPanel&gt;\n    &lt;ListBox.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;ListBox Background=\"Transparent\" SelectionMode=\"Multiple\" SelectionChanged=\"SurfaceListBox_SelectionChanged\" ItemsSource=\"{Binding SubProducts}\" Width=\"{Binding Path=SubProducts, Converter={StaticResource ListBoxWidthConverter}}\" ScrollViewer.VerticalScrollBarVisibility=\"Disabled\" ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"&gt;\n                &lt;ListBox.ItemsPanel&gt;\n                    &lt;ItemsPanelTemplate&gt;\n                        &lt;WrapPanel Orientation=\"Horizontal\"&gt;                                    \n                        &lt;/WrapPanel&gt;\n                    &lt;/ItemsPanelTemplate&gt;\n                &lt;/ListBox.ItemsPanel&gt;\n                &lt;ListBox.ItemTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;Grid Width=\"69\" Height=\"69\"&gt;\n                            &lt;Image Source=\"{Binding ImagePath,  Converter={StaticResource ImageConverter}, IsAsync=True}\" Stretch=\"UniformToFill\"/&gt;\n                            &lt;TextBlock Text=\"{Binding Name}\" FontSize=\"14\" VerticalAlignment=\"Bottom\" HorizontalAlignment=\"Center\" TextWrapping=\"Wrap\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/ListBox.ItemTemplate&gt;\n                &lt;ListBox.ItemContainerStyle&gt;\n                    &lt;Style TargetType=\"{x:Type ListBoxItem}\"&gt;\n                        &lt;Setter Property=\"Template\"&gt;\n                            &lt;Setter.Value&gt;\n                                &lt;ControlTemplate TargetType=\"{x:Type ListBoxItem}\"&gt;\n                                    &lt;ContentPresenter Margin=\"5,5\"/&gt;\n                                &lt;/ControlTemplate&gt;\n                            &lt;/Setter.Value&gt;\n                        &lt;/Setter&gt;\n                        &lt;Style.Triggers&gt;\n                            &lt;Trigger Property=\"IsSelected\" Value=\"False\"&gt;\n                                &lt;Trigger.Setters&gt;\n                                    &lt;Setter Property=\"Opacity\" Value=\"0.25\"/&gt;\n                                &lt;/Trigger.Setters&gt;\n                            &lt;/Trigger&gt;\n                            &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                                &lt;Trigger.Setters&gt;\n                                    &lt;Setter Property=\"Opacity\" Value=\"1\"/&gt;\n                                &lt;/Trigger.Setters&gt;\n                            &lt;/Trigger&gt;\n                        &lt;/Style.Triggers&gt;\n                    &lt;/Style&gt;\n                &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;/ListBox&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListBox.ItemTemplate&gt;\n    &lt;ListBox.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"{x:Type ListBoxItem}\"&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate TargetType=\"{x:Type ListBoxItem}\"&gt;\n                        &lt;ContentPresenter Margin=\"0,5\"/&gt;\n                    &lt;/ControlTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n</code></pre>\n"},{"tags":["wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1331,"score":1,"question_id":5753350,"title":"Custom listbox with move fwd/bwd buttons","body":"<p>I have a custom list box with left/right repeat buttons to scroll its content with content template as below:</p>\n\n<pre><code>&lt;ControlTemplate x:Key=\"ListBoxTemplate\" TargetType=\"{x:Type ListBox}\"&gt;\n    &lt;DockPanel&gt;\n        &lt;RepeatButton x:Name=\"LineLeftButton\" DockPanel.Dock=\"Left\" Width=\"20\" \n              Content=\"&amp;lt;\"      \n              Command=\"{x:Static ScrollBar.LineLeftCommand}\"      \n              CommandTarget=\"{Binding ElementName=scrollviewer}\"/&gt;\n        &lt;RepeatButton x:Name=\"LineRightButton\" DockPanel.Dock=\"Right\" Width=\"20\" \n              Content=\"&amp;gt;\" \n              Command=\"{x:Static ScrollBar.LineRightCommand}\"      \n              CommandTarget=\"{Binding ElementName=scrollviewer}\"/&gt;\n        &lt;Border BorderThickness=\"1\" BorderBrush=\"Gray\" Background=\"White\"&gt;\n            &lt;ScrollViewer x:Name=\"scrollviewer\"&gt;\n                &lt;ItemsPresenter/&gt;\n            &lt;/ScrollViewer&gt;\n        &lt;/Border&gt;\n    &lt;/DockPanel&gt;\n&lt;/ControlTemplate&gt;\n    &lt;ListBox Height=\"25\" x:Name=\"listBox\" Template=\"{StaticResource ListBoxTemplate}\" \n         VerticalAlignment=\"Stretch\"   \n         ScrollViewer.HorizontalScrollBarVisibility=\"Hidden\" \n         ScrollViewer.VerticalScrollBarVisibility=\"Disabled\"&gt;\n        &lt;ListBox.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;VirtualizingStackPanel Orientation=\"Horizontal\"/&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListBox.ItemsPanel&gt; \n    &lt;/ListBox&gt;\n</code></pre>\n\n<p>it works fine. I would like the buttons to appear only when the content is scrollable, how would I do that in xaml ? </p>\n"},{"tags":["wpf","binding"],"answer_count":4,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":3867,"score":4,"question_id":2552853,"title":"how to bind multiple value in WPF?","body":"<p>hai am using the below binding to bind my value 'Name' to textblock1.</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding Name}\" /&gt;\n</code></pre>\n\n<p>now the problem is i want to bind another value called 'ID' with that same textblock1</p>\n\n<p>is it possible to bind value like using    Name + ID like that??? :)</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13135235,"title":"Disable text box when Check box is Unchecked during run time in C#","body":"<p>I have a CheckBox and a TextBox. During the runtime,<br>\nif the CheckBox is Checked then the TextBox is enabled. </p>\n\n<p>I did it using following code</p>\n\n<pre><code>private void checkTime_Checked(object sender, RoutedEventArgs e)\n{\n    if (checkTime.IsChecked == true)\n    {\n        txtTime_SR.IsEnabled = true;\n    }\n}\n</code></pre>\n\n<p>What I need to do is, to disable the TextBox when the CheckBox is Unchecked during runtime.</p>\n\n<p>Any idea of doing this ?</p>\n"},{"tags":[".net","wpf","pdf","pdf-viewer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13133172,"title":"PDF Multi viewer .net plugin","body":"<p>I want a mutli page pdf viewer which can show multiple pages on to the single screen, automatically their height and width  should get adjusted according to the no of pages i want to show from the pdf document.</p>\n\n<p>Is there any plugin available? free or paid version anything will do.. i will use the plugin for my wpf application.</p>\n"},{"tags":["wpf","3d"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":141,"score":4,"question_id":12765841,"title":"Wireframe rendering in WPF","body":"<p>I have to write a wireframe 3D renderer in a big WPF app that does many things   But WPF has no native ability to do this. </p>\n\n<p>Some people use \"3D Tools for WPF\" by Microsoft, specifically its ScreenSpaceLines3D class. But on the web there are complaints about slow performance and various bugs with that class, and the class library doesn't seem to have been maintained since 2007!</p>\n\n<p>Others have suggested the LinesVisual3D class from the Helix 3D toolkit, but apparently that's buggy, too ( <a href=\"http://helixtoolkit.codeplex.com/workitem/9957\" rel=\"nofollow\">http://helixtoolkit.codeplex.com/workitem/9957</a> )</p>\n\n<p>Charles Petzold has a 3D library - does anyone know it's reasonably robust?</p>\n\n<p>So do I have any good options here? For example, is there a good way to do OpenGL3D in a WPF window? Are there other good WPF libraries that can do this reliably?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13134705,"title":"WPF 4.0 Combo box Display Message When binding data is null","body":"<p>I have Two Combo boxes named <strong>category</strong> and <strong>sub-category</strong>. I want to display specific data in <strong>sub-category</strong> combo box based on <strong>category</strong> combo box  selection. But sometimes when I select some <strong>category</strong>, it doesn't have any value to show in <strong>sub-category</strong>. At that time I need to display an error message like <strong>No Records Found</strong>. </p>\n\n<p>Is there some method to do so?  </p>\n"},{"tags":["wpf","windows-7","bing-maps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13123888,"title":"Drawing on Bing Map Control","body":"<p>I am writing an software which runs on windows 7 tablet in WPF (with Bing Maps).</p>\n\n<p>I want to draw when the mouse is dragged, I wanted to use this guide: <a href=\"http://ngjon.wordpress.com/2010/02/05/interactive-drawing-on-the-silverlight-map-control/\" rel=\"nofollow\">Drawing on bing maps</a> But I can't find the mouseTap event on the Map control. I guess it's only avaliable in the Silverlight version. How Should I trace the mouse? </p>\n\n<p>Also, I need to freeze the map (because touching it right now changing the display of the map). Is there an easy way to do that?</p>\n"},{"tags":["wpf","prism"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":11633321,"title":"WPF/Prism: Nested views and toolbar","body":"<p>I have a WPF/prism application similar to the mockup shown below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/fwuFw.jpg\" alt=\"Layout\"></p>\n\n<p>Both TabControls contain a separate Prism region, the second one being nested into the first one. Now the toolbar should activate/deactive items depending on which view is currently active.</p>\n\n<p>The toolbar is currently defined in the shell.</p>\n\n<p>I tried using some sort of registry, where each ViewModel could register the toolbar commands it supports. However I then realized that the toolbar cannot know which view (and therefore which viewmodel) is active.</p>\n\n<p>The problem is in the nesting, without that I could probably achieve what I wanted by binding the TabControl.SelectedItem property to the toolbar and use my registry from above.</p>\n\n<p>Maybe there is a better way to do this? Or a way to let the toolbar find out which view is active?</p>\n\n<p><strong>edit:</strong> I now tried to use ActiveAware ViewModels as descriped in this article: <a href=\"http://www.codeproject.com/Articles/56826/ViewModel-Active-Awareness-in-a-Prism-Based-Applic\" rel=\"nofollow\">http://www.codeproject.com/Articles/56826/ViewModel-Active-Awareness-in-a-Prism-Based-Applic</a>, however I now have the problem that when I switch from Tab \"One\" to Tab \"Two\" and back, the nested tab's \"First Tab\" GotFocus event is not fired, meaning the toolbar will represent the wrong view.</p>\n\n<p>Maybe this is the way to go?</p>\n\n<p><strong>edit 2:</strong> The problem seems to be that the second tabcontrol is not inside it's own scoped region. I'm using the ViewDiscovery approach to add views to my regions, so I'm not explicity creating the regionmanager in a scope. SyncActiveState seems to work only with scoped regions, as the first tabcontrol viewmodels correctly get updated when switching views.</p>\n\n<p>Is there a way to use XAML to create a scoped region instead of a normal one?</p>\n"},{"tags":[".net","wpf",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13125682,"title":"StoryBoard DoubleAnimation huge CPU usage","body":"<p>Have TextBlock with DoubleAnimation in StoryBoard.<br/>\nOn Windows 7 - <strong>1-2%</strong> CPU usage all the time.<br/>\nOn Windows XP SP3 - <strong>10-15%</strong> CPU usage.</p>\n\n<pre><code>&lt;TextBlock Grid.Column=\"1\" Height=\"Auto\" Margin=\"10,0,0,0\" TextWrapping=\"Wrap\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Center\" PreviewMouseDown=\"incomMessages_SelectionChanged\"&gt;\n     &lt;TextBlock.Text&gt;\n          &lt;Binding Mode=\"OneTime\" Converter=\"{StaticResource Converter}\" ConverterParameter=\"NameAndId\"/&gt;\n     &lt;/TextBlock.Text&gt;\n     &lt;TextBlock.Style&gt;\n          &lt;Style&gt;    \n               &lt;Style.Triggers&gt;\n                    &lt;DataTrigger Binding=\"{Binding IsNew}\" Value=\"True\"&gt;\n                         &lt;DataTrigger.EnterActions&gt;\n                              &lt;BeginStoryboard Name=\"Blink\"&gt;\n                                   &lt;Storyboard BeginTime=\"00:00:01\" RepeatBehavior=\"Forever\"&gt;\n                                        &lt;DoubleAnimation Storyboard.TargetProperty=\"(TextBlock.Opacity)\" From=\"0\" To=\"1\" Duration=\"0:0:1\" RepeatBehavior=\"Forever\" AutoReverse=\"True\"/&gt;\n                                    &lt;/Storyboard&gt;\n                               &lt;/BeginStoryboard&gt;\n                          &lt;/DataTrigger.EnterActions&gt;\n                     &lt;/DataTrigger&gt;\n                &lt;/Style.Triggers&gt;\n           &lt;/Style&gt;\n     &lt;/TextBlock.Style&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Am i doing something wrong or it is WPF feature?</p>\n"},{"tags":[".net","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13130755,"title":"Make my Style specific to a single instance","body":"<p>My wpf application has this Style:</p>\n\n<p>Xaml:</p>\n\n<pre><code>&lt;Style x:Key=\"customTableViewDataRowStyle\" TargetType=\"{x:Type xcdg:DataRow}\"&gt;\n</code></pre>\n\n<p>C#</p>\n\n<pre><code>this.Resources.Add(typeof(DataRow), this.FindResource(\"customTableViewDataRowStyle\"));\n</code></pre>\n\n<p>It modifies the look of a Row in an Xceed Datagrid.</p>\n\n<p>This all works great!</p>\n\n<p>But I went and added another Xceed Datagrid to my app and it is using the style too.</p>\n\n<p>Is there a way to not have it do that?  Can I make it only affect specific grids?</p>\n"},{"tags":["c#","c++",".net","wpf","arrays"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":82,"score":5,"question_id":13132690,"title":"Failing to use Array.Copy() in my WPF App","body":"<p>I am a C++ developer and recently started working on WPF. Well I am using Array.Copy() in my app and looks like I am not able to completely get the desired result. </p>\n\n<p>I had done in my C++ app as follows:</p>\n\n<pre><code>static const signed char version[40] = {\n'A', 'U', 'D', 'I', 'E', 'N', 'C', 'E',   // name\n 0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,   // reserved,  firmware size\n 0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,   // board number\n 0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,   // variant, version, serial\n 0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0 ,  0     // date code, reserved\n};\n\nunsigned char sendBuf[256] = {};\nint memloc = 0;\nsendBuf[memloc++] = 0;\nsendBuf[memloc++] = 0;\n\n// fill in the audience header\nmemcpy(sendBuf+memloc, version, 8); // the first 8 bytes\nmemloc += 16; // the 8 copied, plus 8 reserved bytes\n</code></pre>\n\n<p>I did the similar operation in my WPF (C#) app as follows:</p>\n\n<pre><code>Byte[] sendBuf = new Byte[256];\n\nchar[] version = \n        {\n                'A', 'U', 'D', 'I', 'E', 'N', 'C', 'E',         // name\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // reserved,  firmware size\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // board number\n                '0', '0', '0', '0', '0', '0', '0', '0' ,        // variant, version, serial\n                '0', '0', '0', '0', '0', '0', '0', '0'          // date code, reserved\n        };\n\n// fill in the address to write to -- 0\n        sendBuf[memloc++] = 0;\n        sendBuf[memloc++] = 0;\n\n        // fill in the audience header\n        Array.Copy(sendBuf + memloc, version, 8);   // the first 8 bytes\n        memloc += 16;\n</code></pre>\n\n<p>But it throws me an error at <code>Array.Copy(sendBuf + memloc, version, 8);</code> as <code>Operator '+' cannot be applied to operands of type 'byte[]' and 'int'</code>. </p>\n\n<p>How can achieve this???? :) please help :)</p>\n"},{"tags":["c#","wpf","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13133537,"title":"save checkbox value in access database with vb.net 2010 (wpf c#)","body":"<p>guy how can i insert the value of checkbox in access database or any database.</p>\n\n<p>i tried any of this sql statement but it still give me error: <strong>OleDbException was Unhandled. Data type mismatch in criteria expression.</strong> and it's pointing to myData = myCommand.ExecuteReader();</p>\n\n<p>note that allowviewpsr is a boolean type of field in ms access database or the one with YES/NO. :) chkviewpsr is mycheckbox</p>\n\n<pre><code>SQL = \"UPDATE `RUsers` SET `allowviewpsr` = '\" + chkviewpsr.IsChecked.Value + \"' WHERE `idnum`= '\" + txtblkuserid.Text  + \"' AND `fullname`= '\" + txtblkusername.Text + \"'\";\n</code></pre>\n\n<p>also this:</p>\n\n<pre><code>SQL = \"UPDATE `RUsers` SET `allowviewpsr` = '\" + chkviewpsr.IsChecked + \"' WHERE `idnum`= '\" + txtblkuserid.Text  + \"' AND `fullname`= '\" + txtblkusername.Text + \"'\";\n</code></pre>\n\n<p>and also this:</p>\n\n<pre><code>SQL = \"UPDATE `RUsers` SET `allowviewpsr` = '\" + chkviewpsr + \"' WHERE `idnum`= '\" + txtblkuserid.Text  + \"' AND `fullname`= '\" + txtblkusername.Text + \"'\";\n</code></pre>\n\n<p>and here's my connector:</p>\n\n<pre><code>myCommand.CommandText = SQL;\nmyCommand.Connection = MyNewOleDbConnection;\nmyAdapter.SelectCommand = myCommand;\nmyData = myCommand.ExecuteReader();\n</code></pre>\n\n<p><strong>EDITED:</strong>\nhi anandkumar thanks for the quick replay i tried NonQuery but it gives same error as above</p>\n\n<pre><code>SQL = \"UPDATE `RWMUsers` SET `allowviewpsr` = '\" + chkviewpsr.IsChecked.Value + \"' WHERE `idnum`= '\" + txtblkuserid.Text  + \"' AND `fullname`= '\" + txtblkusername.Text + \"'\";\nmyCommand.CommandText = SQL;\nmyCommand.Connection = MyNewOleDbConnection;\nmyAdapter.UpdateCommand = myCommand;\nmyCommand.ExecuteNonQuery();\n</code></pre>\n\n<p><strong>Snapshot of my Access Database</strong> :(</p>\n\n<p><img src=\"http://i.stack.imgur.com/3fq3E.png\" alt=\"enter image description here\"></p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12988108,"title":"Cannot set the ShowsNavigationUI property of a wpf page using style","body":"<p>I'm new to WPF and I'm trying to figure out what's wrong with this code block?</p>\n\n<pre><code>   &lt;Style x:Key=\"PageStyle\" TargetType=\"Page\"&gt;\n        &lt;Setter Property=\"ShowsNavigationUI\" Value=\"False\" /&gt;\n   &lt;/Style&gt; \n</code></pre>\n\n<p>the Error list in VS says: \nException has been thrown by a target of an invocation.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13133152,"title":"How to Clear ComboBox items in SelectionChanged Event of another combobox","body":"<p>i have two ComboBoxes in WPF Application...</p>\n\n<p>in first ComboBox SelectionChanged Event i want to clear Second CombBox items....</p>\n\n<pre><code>private void cmbBoard_SelectionChanged(object sender, SelectionChangedEventArgs e)\n{\n    cmbClass.DataContext = this;\n    cmbClass.Items.Clear();\n\n    CVariables.StrSQLQueryPub = \"select ClassID,Class from QB_Class WHERE BoardID='\" + strBoardId + \"' ORDER BY Class\";\n    CFunctions.fnToFillDataTable(CFunctions.Con, CVariables.StrSQLQueryPub);\n    DataTable dt = CVariables.DTable;\n\n    cmbClass.ItemsSource = dt.DefaultView;\n    cmbClass.DisplayMemberPath = \"Class\";\n    cmbClass.SelectedValuePath = \"ClassID\";\n}\n</code></pre>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13084809,"title":"Windows presentation foundation tool or sdk to load pdf and dwg files","body":"<p>I have a request from the customer to make a tool that loads png, jpg, tiff, pdf, dwg file formats. Buying a tool or sdk or something to help me build this is an option, as long as it is not a per unit price. Does anybody know a good tool (apart from Atalasoft DotImage, they don't want that.. not sure why..). </p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13131305,"title":"Threading serial port query and using the result in a ListView control","body":"<p>I have a device in which if I send a properly formatted string; I get a string back. I would like to use this returned string in a WPF ListView control but I'm having trouble infinitely querying the device on the other end of the serial port. I would like to refresh the data every 3 or so seconds.<br>\nHere is the application logic:</p>\n\n<pre><code>            public static void queryDevice()\n        {\n            SerialPort _serialPort = new SerialPort(\"COM3\", 115200, Parity.None, 8, StopBits.One);\n            _serialPort.Handshake = Handshake.None;\n            ObservableCollection&lt;string&gt; store= new ObservableCollection&lt;string&gt; { \" \", \" \", \" \" };\n            string[] query = new string[3] { \"t02\", \"t03\", \"t04\" };\n            while (true)\n            {\n                for (int i = 0; i &lt; 3; i++)\n                {\n                    string add = SerialCom.returnData(query[i], _serialPort);//returns data depending on which query was sent\n                    if (store[i] != add)\n                    {\n                        store.Add(add);\n                    }\n                }\n                Thread.wait(300);\n\n            }\n        }\n</code></pre>\n\n<p>I'm trying to find the best way to thread this code as putting this code in the UI thread locks the UI thread up. I am planning to use the ObservableCollection as the datasource for the ListView on that note. </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","xaml","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13132517,"title":"How can I stop a ListBox's ItemsSource from being cleared when its binding source becomes null?","body":"<p><strong>Background:</strong></p>\n\n<p>Consider this XAML snippet:</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"100\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;DataGrid\n        Grid.Row=\"0\"\n        x:Name=\"dataGrid\"\n        AutoGenerateColumns=\"False\"\n        ItemsSource=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}, Path=Bobs}\"\n        &gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn\n                Header=\"Name\"\n                Binding=\"{Binding Name}\"\n                MinWidth=\"75\"\n                /&gt;       \n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;   \n    &lt;ListBox\n        Grid.Row=\"1\"\n        x:Name=\"listBox\"\n        DisplayMemberPath=\"Name\"\n        ItemsSource=\"{Binding ElementName=dataGrid, Path=SelectedItem.Regions}\"\n        SelectionMode=\"Multiple\"\n        &gt;\n        &lt;Interactivity:Interaction.Behaviors&gt;\n            &lt;ListBoxBehaviors:SynchronizeSelectedItemsBehavior Selections=\"{Binding ElementName=dataGrid, Path=SelectedItem.SelectedRegions}\"/&gt;\n        &lt;/Interactivity:Interaction.Behaviors&gt;\n    &lt;/ListBox&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Let's say I have a separate control that, when toggled, sets the Grid's IsEnabled property to false. Doing that has the effect of disabling the DataGrid and ListBox controls within the grid.</p>\n\n<p>In .NET 4.0, an unfortunate side-effect of disabling a DataGrid is that the <a href=\"http://stackoverflow.com/questions/6610967/wpf-datagrid-retain-selection-when-disabling\">DataGrid unselects all cells</a>, so its SelectedItem is lost. This has the side-effect of firing the ListBox's ItemsSource binding, causing the ItemsSource to be cleared since the dataGrid's SelectedItem has become null.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>How can I alter the binding, or change my XAML, so that when the dataGrid's SelectedItem becomes null, the ListBox's items collection isn't cleared.</p>\n\n<p><strong>Addendums:</strong></p>\n\n<ol>\n<li>I realize that the unselect DataGrid behavior was removed in .NET 4.5 but upgrading isn't an option right now.</li>\n<li>I know there are solutions to circumventing the unselect DataGrid behavior; I want to know if it's possible to resolve my problem without using them.</li>\n</ol>\n"},{"tags":["wpf","xaml","styles","label"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":11133,"score":7,"question_id":1484072,"title":"Underline Label in WPF, using styles","body":"<p>I have the following style: </p>\n\n<pre><code>&lt;Style x:Key=\"ActionLabelStyle\" TargetType=\"{x:Type Label}\"&gt;\n    &lt;Setter Property=\"Margin\" Value=\"10,3\" /&gt;\n    &lt;Setter Property=\"Padding\" Value=\"0\" /&gt;\n    &lt;Setter Property=\"TextBlock.TextWrapping\" Value=\"Wrap\" /&gt;\n    &lt;Setter Property=\"FontFamily\" Value=\"Calibri\" /&gt;\n    &lt;Style.Triggers&gt;\n        &lt;MultiTrigger&gt;\n            &lt;MultiTrigger.Conditions&gt;\n                &lt;Condition Property=\"IsMouseOver\" Value=\"True\" /&gt;\n                &lt;Condition Property=\"IsEnabled\" Value=\"True\" /&gt;\n            &lt;/MultiTrigger.Conditions&gt;\n            &lt;Setter Property=\"Background\" Value=\"Red\" /&gt;\n            &lt;Setter Property=\"TextBlock.TextDecorations\" Value=\"Underline\" /&gt;\n        &lt;/MultiTrigger&gt;\n    &lt;/Style.Triggers&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>So basically, I want to have a label which is underlined when it is enabled and the mouse cursor is over it. The part of this style which is not working is the <code>&lt;Setter Property=\"TextBlock.TextDecorations\" Value=\"Underline\" /&gt;</code>. Now, what am I doing wrong here? Thanks for all the help. </p>\n"},{"tags":["wpf","xaml","triggers","focus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13130273,"title":"Hand focus to inner element in XAML","body":"<p>I have a custom element which looks like:</p>\n\n<pre><code>    &lt;Setter Property=\"Foreground\" Value=\"{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}\"/&gt;\n    &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n    &lt;Setter Property=\"Padding\" Value=\"0\"/&gt;\n    &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Left\"/&gt;\n    &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\"/&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type Label}\"&gt;\n                &lt;Grid&gt;\n                    &lt;TextBox Name=\"textBox\"\n                         Grid.ZIndex=\"1\"\n                         Padding=\"0,3,0,0\"\n                         Text=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type Label}}, Path=Content, UpdateSourceTrigger=PropertyChanged}\"\n                         Opacity=\"0\"\n                         IsEnabled=\"False\"\n                         Focusable=\"True\"\n                         /&gt;\n\n\n                    &lt;Border Name=\"boxBorder\"  BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"1\" Background=\"{TemplateBinding Background}\" Padding=\"3,0,0,0\" SnapsToDevicePixels=\"true\"&gt;\n                        &lt;ContentPresenter HorizontalAlignment=\"{TemplateBinding HorizontalContentAlignment}\" RecognizesAccessKey=\"True\" SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\" VerticalAlignment=\"{TemplateBinding VerticalContentAlignment}\"/&gt;\n                    &lt;/Border&gt;\n                &lt;/Grid&gt;\n</code></pre>\n\n<p>I want a label which you can double click and then turns into a input field (textbox). Therefore I have defined a double click event with:</p>\n\n<pre><code>    &lt;EventTrigger RoutedEvent=\"MouseDoubleClick\"&gt;\n                        &lt;BeginStoryboard&gt;\n                            &lt;Storyboard&gt;\n                                &lt;DoubleAnimation Storyboard.TargetName=\"textBox\"\n                                                 Storyboard.TargetProperty=\"Opacity\" To=\"1\" Duration=\"0\" /&gt;\n                                &lt;BooleanAnimationUsingKeyFrames Duration=\"0\" Storyboard.TargetName=\"textBox\"\n                                                                Storyboard.TargetProperty=\"IsEnabled\"&gt;\n                                    &lt;DiscreteBooleanKeyFrame Value=\"True\" KeyTime=\"0\" /&gt;\n                                &lt;/BooleanAnimationUsingKeyFrames&gt;\n\n                            &lt;/Storyboard&gt;\n                        &lt;/BeginStoryboard&gt;\n                    &lt;/EventTrigger&gt;\n</code></pre>\n\n<p>The double clicking works fine, but you have to perform a triple click to get the focus into the textbox. Just double clicking turns only the opacity to 1. I have not found a way how I can move the focus with the double click event to the textbox.</p>\n"},{"tags":["wpf","controltemplate","listboxitem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3103,"score":0,"question_id":337476,"title":"WPF: Update a label in a listbox item","body":"<p>I have a ListBox where the number of items is added based on and integer property set by a user. The items are created from a ControlTemplate resource that which is comprised of a Label and a TextBox inside of a DockPanel. The label is not data bound but I would like for it to have somewhat dynamic content based on the (index + 1) of the listboxitem for which it is contained. My question/problem is that I want to be able update the content of the label for each listbox item, but cannot access the label for some reason. I am unaware of any way to do this through data-binding of the label since the label is in a template and has no knowledge that it has a parent that is a listbox item. Can anyone help me clear up some of these confusions to get me back on the right track, please?</p>\n\n<pre><code>                &lt;ControlTemplate TargetType=\"{x:Type ListBoxItem}\"&gt;\n                    &lt;DockPanel Background=\"Transparent\" Height=\"28\" Name=\"playerDockPanel\" VerticalAlignment=\"Bottom\"&gt;\n                        &lt;Label Name=\"playerNameLabel\" DockPanel.Dock=\"Left\" Content=\"Player\"&gt;&lt;/Label&gt;\n                        &lt;TextBox Height=\"23\" Width =\"150\" Name=\"playerName\" DockPanel.Dock=\"Right\"/&gt;\n                    &lt;/DockPanel&gt;\n                &lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>I would like to be able to bind the content of the label in xaml, or update the content of the label in the code behind. I'm not sure what the best route would be.</p>\n"},{"tags":["c#","c++","wpf","uielement"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13123697,"title":"How to add a label that implements a c++ interface?","body":"<p>I have very limited C# experience, so maybe it's an commonly made mistake, however, I could not find the answer in any other topics.</p>\n\n<p>In my WPF applicationj I'm tried to create a label that inherists from a default WPF label and     implements an interface that is defined in a dll (managed c++). My goal would be to pass an instance of this object to c++ code and have it, without use of a seperate thread, update the UI.</p>\n\n<pre><code>using System;\nusing System.Windows.Controls;\nusing System.Windows;\n\nnamespace WPFTest\n{\n    //my class : default WPF Label, C++ interface (dll)\n    class ObservationResultLabel : Label, IObservationResult\n    {\n        Boolean od;\n\n        public Boolean ObjectIsDetected(){\n            return od;\n        }\n        public void setObservationResult(Boolean od){\n            this.od = od;\n            this.Dispatcher.Invoke((Action)(() =&gt;\n            {\n                this.InvalidateVisual();\n            }));\n        }\n        protected override void  OnRender(\n                System.Windows.Media.DrawingContext drawingContext){\n            if (od){\n                Visibility = Visibility.Visible;\n            }else{\n                Visibility = Visibility.Hidden;\n            }\n            base.OnRender(drawingContext);\n        }\n    }\n}\n</code></pre>\n\n<p>But when trying to build I get a \"A value of type 'ObservationResultLabel' cannot be added to a collection or dictionary of type 'UIElementCollection'.\" error. If I try the same thing with a C# interface, there's no error.</p>\n\n<p>Does anyone have any suggestion?</p>\n"},{"tags":["c#",".net","wpf","forms","wpf-controls"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":13127289,"title":"A way to add a WPF window into a C# Form Application","body":"<p>i want to make Form loading a splash screen with transparent background and a non rectangular shape with is click-through-able. is this possible ? how it's made ?</p>\n\n<p>i was wondering if there is a way of making the Form1 calling a WPF window ( as a kind of splash screen ) within the same vs project.</p>\n\n<p>i've tryed to rightclick the project in the project-explorer in VS -> add and then i was searching for WPF window. but the only thing that i am able to add is a \"wpf User Controll\".</p>\n\n<p>so far so good, but if i start the application then, it gives me an error saying i should ad a reference to System.Windows.markup.IQueryAmbient, but i cant find it in the list ( .NET )</p>\n\n<p>what am i doing wrong ? what is the propper way to implement a WPF window into a Forms application project ?</p>\n\n<p>thanks for all suggestions.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>this is the splash screen of Adobe Flash Professional CS6, and it pretty much explains exactly what i want to have. a non rectangular image with semi-transparent and full-transparent parts in it\n<a href=\"http://webalazar.com/wp-content/uploads/2012/09/Adobe-Flash-Professional-CS6.png\" rel=\"nofollow\">http://webalazar.com/wp-content/uploads/2012/09/Adobe-Flash-Professional-CS6.png</a></p>\n"},{"tags":["wpf","wpf-controls","itemscontrol","scrollviewer"],"answer_count":2,"favorite_count":4,"up_vote_count":31,"down_vote_count":0,"view_count":16156,"score":31,"question_id":2028459,"title":"WPF: ItemsControl with scrollbar (ScrollViewer)","body":"<p>I followed <a href=\"http://compilewith.net/2008/05/making-itemscontrol-scroll.html\" rel=\"nofollow\">this</a> small \"tutorial\" on how to add a scrollbar to an ItemsControl, and it works in Designer view, but not when I compile and execute the program (only the first few items show up, and no scrollbar to view more - even when VerticalScrollbarVisibility is set to \"Visible\" instead of \"Auto\").</p>\n\n<p>Any idea on how to solve this?</p>\n\n<hr>\n\n<p>This is the code I use to show my items (normally I work with Databinding, but to see the items in my Designer I added them manually):</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"itemCtrl\" Style=\"{DynamicResource UsersControlStyle}\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;StackPanel Orientation=\"Vertical\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Top\"&gt;\n            &lt;/StackPanel&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n\n    &lt;uc:UcSpeler /&gt;\n    &lt;uc:UcSpeler /&gt;\n    &lt;uc:UcSpeler /&gt;\n    &lt;uc:UcSpeler /&gt;\n    &lt;uc:UcSpeler /&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<hr>\n\n<p>And this is my Template:</p>\n\n<pre><code>&lt;Style x:Key=\"UsersControlStyle\" TargetType=\"{x:Type ItemsControl}\"&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type ItemsControl}\"&gt;\n                &lt;Border SnapsToDevicePixels=\"true\" Background=\"{TemplateBinding Background}\" BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"{TemplateBinding BorderThickness}\" Padding=\"{TemplateBinding Padding}\"&gt;\n                    &lt;ScrollViewer VerticalScrollBarVisibility=\"Visible\"&gt;\n                        &lt;ItemsPresenter SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\"/&gt;\n                    &lt;/ScrollViewer&gt;\n                &lt;/Border&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["c#","wpf","xml","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":13088931,"title":"how to trigger appropriate xaml page with button","body":"<p>i'm using example take from project \"japf_fr_slide_animation\". i've added button to trigger appropriate page but is stuck and dont know how to trigger them. Here are all the pages to the referenced project with the added buttons. Can anyone help on how I can trigger the pages based on the button? </p>\n\n<p>view1.xaml</p>\n\n<pre><code>&lt;UserControl x:Class=\"FirstTry.view1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Height=\"300\" Width=\"300\"&gt;\n    &lt;Grid Background=\"LightBlue\"&gt;\n        &lt;TextBlock HorizontalAlignment=\"Center\" VerticalAlignment=\"Top\" Text=\"view1\" /&gt;\n        &lt;Button Name=\"show2\" Content=\"show second xaml\" VerticalAlignment=\"Center\" Width=\"150\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>view2.xaml</p>\n\n<pre><code>&lt;UserControl x:Class=\"FirstTry.view2\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Height=\"300\" Width=\"300\"&gt;\n    &lt;Grid Background=\"LightCoral\"&gt;\n        &lt;TextBlock HorizontalAlignment=\"Center\" VerticalAlignment=\"Top\" Text=\"view2\"/&gt;\n        &lt;Button Name=\"show3\" Content=\"show third xaml\" VerticalAlignment=\"Center\" Width=\"150\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>view3.xaml</p>\n\n<pre><code>&lt;UserControl x:Class=\"FirstTry.view3\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Height=\"300\" Width=\"300\"&gt;\n    &lt;Grid Background=\"LightGreen\"&gt;\n        &lt;TextBlock HorizontalAlignment=\"Center\" VerticalAlignment=\"Top\" Text=\"view3\"/&gt;\n        &lt;Button Name=\"show1\" Content=\"show first xaml\" VerticalAlignment=\"Center\" Width=\"150\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Window1.xaml</p>\n\n<pre><code>&lt;Window x:Class=\"FirstTry.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" SizeToContent=\"WidthAndHeight\" ResizeMode=\"NoResize\"&gt;\n\n    &lt;Window.Resources&gt;\n        &lt;XmlDataProvider x:Key=\"views\"&gt;\n            &lt;x:XData&gt;\n                &lt;Views xmlns=\"\"&gt;\n                    &lt;View Title=\"View1\"&gt;\n                        &lt;Page Source=\"view1.xaml\"/&gt; \n                    &lt;/View&gt;\n                    &lt;View Title=\"View2\"&gt;\n                        &lt;Page Source=\"view2.xaml\"/&gt;\n                    &lt;/View&gt;\n                    &lt;View Title=\"View3\"&gt;\n                        &lt;Page Source=\"view3.xaml\"/&gt;\n                    &lt;/View&gt;\n                &lt;/Views&gt;\n            &lt;/x:XData&gt;\n        &lt;/XmlDataProvider&gt;\n\n        &lt;Storyboard x:Key=\"slideLeftToRight\"  \n                    TargetProperty=\"RenderTransform.(TranslateTransform.X)\"\n                    AccelerationRatio=\".4\"\n                    DecelerationRatio=\".4\"&gt;\n            &lt;DoubleAnimation Storyboard.TargetName=\"viewer\" Duration=\"0:0:0.6\" From=\"300\" To=\"0\"/&gt;\n            &lt;DoubleAnimation Storyboard.TargetName=\"bordervisual\" Duration=\"0:0:0.6\" From=\"0\" To=\"-300\"/&gt;\n        &lt;/Storyboard&gt;\n\n        &lt;Storyboard x:Key=\"slideRightToLeft\" \n                    TargetProperty=\"RenderTransform.(TranslateTransform.X)\"\n                    AccelerationRatio=\".4\"\n                    DecelerationRatio=\".4\"&gt;\n            &lt;DoubleAnimation Storyboard.TargetName=\"viewer\" Duration=\"0:0:0.6\" From=\"-300\" To=\"0\"/&gt;\n            &lt;DoubleAnimation Storyboard.TargetName=\"bordervisual\" Duration=\"0:0:0.6\" From=\"0\" To=\"300\"/&gt;\n        &lt;/Storyboard&gt;\n\n        &lt;VisualBrush x:Key=\"VisualBrush1\" Visual=\"{Binding ElementName=viewer}\"/&gt;\n\n    &lt;/Window.Resources&gt;\n\n    &lt;Grid&gt;\n        &lt;StackPanel&gt;\n\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;ListBox x:Name=\"viewList\" Height=\"20\" Width=\"300\" SelectedIndex=\"0\"\n                    ItemsSource=\"{Binding Source={StaticResource views}, XPath=Views/View}\"\n                    DisplayMemberPath=\"@Title\"                    \n                    SelectionChanged=\"viewList_SelectionChanged\"&gt;\n                    &lt;ListBox.ItemsPanel&gt;\n                        &lt;ItemsPanelTemplate&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"/&gt;\n                        &lt;/ItemsPanelTemplate&gt;\n                    &lt;/ListBox.ItemsPanel&gt;\n                &lt;/ListBox&gt;\n            &lt;/StackPanel&gt;\n\n            &lt;Grid Width=\"300\" Height=\"300\"&gt;\n\n\n\n                &lt;Border x:Name=\"bordervisual\" Width=\"300\"&gt;\n                    &lt;Rectangle x:Name=\"rectanglevisual\"/&gt;\n                    &lt;Border.RenderTransform&gt;\n                        &lt;TranslateTransform/&gt;\n                    &lt;/Border.RenderTransform&gt;\n                &lt;/Border&gt;\n\n                &lt;ItemsControl x:Name=\"viewer\" DataContext=\"{Binding Path=SelectedItem, ElementName=viewList}\"\n                    ItemsSource=\"{Binding XPath=Page}\"&gt;\n                    &lt;ItemsControl.ItemTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;Frame x:Name=\"frame\" Source=\"{Binding XPath=@Source}\"/&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/ItemsControl.ItemTemplate&gt;\n                    &lt;ItemsControl.RenderTransform&gt;\n                        &lt;TranslateTransform/&gt;\n                    &lt;/ItemsControl.RenderTransform&gt;\n                &lt;/ItemsControl&gt;\n            &lt;/Grid&gt;\n        &lt;/StackPanel&gt;       \n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Window1.xaml.cs</p>\n\n<pre><code>public partial class Window1 : Window\n    {\n        private static int oldSelectedIndex = 0;\n\n        public Window1()\n        {\n            InitializeComponent();\n        }\n\n        public RenderTargetBitmap RenderBitmap(FrameworkElement element)\n        {\n            double topLeft = 0;\n            double topRight = 0;\n            int width = (int)element.ActualWidth;\n            int height = (int)element.ActualHeight;\n            double dpiX = 96; // this is the magic number\n            double dpiY = 96; // this is the magic number\n\n            PixelFormat pixelFormat = PixelFormats.Default;\n            VisualBrush elementBrush = new VisualBrush(element);\n            DrawingVisual visual = new DrawingVisual();\n            DrawingContext dc = visual.RenderOpen();\n\n            dc.DrawRectangle(elementBrush, null, new Rect(topLeft, topRight, width, height));\n            dc.Close();\n\n            RenderTargetBitmap bitmap = new RenderTargetBitmap(width, height, dpiX, dpiY, pixelFormat);\n\n            bitmap.Render(visual);\n            return bitmap;\n        } \n\n        private void viewList_SelectionChanged(object sender, SelectionChangedEventArgs e)\n        {\n            XmlElement root = (XmlElement)viewer.DataContext;\n            XmlNodeList xnl = root.SelectNodes(\"Page\");\n\n            if (viewer.ActualHeight &gt; 0 &amp;&amp; viewer.ActualWidth &gt; 0)\n            {\n                RenderTargetBitmap rtb = RenderBitmap(viewer);\n                rectanglevisual.Fill = new ImageBrush(BitmapFrame.Create(rtb));\n            }\n\n            viewer.ItemsSource = xnl;\n\n            if (oldSelectedIndex &lt; viewList.SelectedIndex)\n            {\n                viewer.BeginStoryboard((Storyboard)this.Resources[\"slideLeftToRight\"]);\n            }\n            else\n            {\n                viewer.BeginStoryboard((Storyboard)this.Resources[\"slideRightToLeft\"]);\n            }\n\n            oldSelectedIndex = viewList.SelectedIndex;\n        }\n    }\n</code></pre>\n"},{"tags":["wpf","textbox","reactiveui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13073377,"title":"Can I bind a ReactiveCommand to MouseDown event on Textbox?","body":"<p>I'm trying to get the WPF ReactiveUI framework's new view ctor binding to bind a ReactiveCommand that is working on a Button click to wire up to a TextBox MouseDown/click event. The following doesn't work.</p>\n\n<pre><code>public partial class KeypadNumberView \n    : IKeypadNumberView\n    , IViewFor&lt;IOnScreenKeyboard&gt;\n{\n    public KeypadNumberView()\n    {\n        ViewModel = new KeyboardViewModel();\n\n        InitializeComponent();\n\n        this.Bind(ViewModel, x =&gt; x.EnteredText);\n        this.BindCommand(ViewModel, vm =&gt; vm.Delete, v =&gt; v.EnteredText, \"MouseDown\" ); // doesn't work\n        this.BindCommand(ViewModel, vm =&gt; vm.Delete); // &lt;== works\n</code></pre>\n"},{"tags":["wpf","window","dispose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13128829,"title":"How to dispose of dynamically loaded usercontrols/viewmodels when parent window is closed","body":"<p>We have a main window that launches a child window. That child window dynamically loads custom usercontrols. In the contructor of these usercontrols, I pass a master object which, from this master object, a usercontrol specific viewmodel is generated and assigned as its datacontext.</p>\n\n<p>All of this is working quite well. However, I jst discovered that when I close the child window at least some of my custom usercontrols are still active. How am I supposed to clean up my controls/viewmodels? Nothing seems to get called until the main window is closed. No destructor, no Dispatcher.ShutdownStarted, no dispose is available, no closing event, nothing I can find.</p>\n\n<p>Anyone know what is supposed to be done to properly clean up after the window is closed?</p>\n"},{"tags":["wpf","menu","menuitem","rendertransform"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13129401,"title":"How do I keep a scale transformation applied to a top level header from affecting the menu items below it?","body":"<p>How do I keep a <code>RenderTransform</code> applied to a top level header from affecting the menu items below it?</p>\n\n<p>Here is my main xaml:</p>\n\n<pre><code>&lt;Window\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \nxmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\"\nx:Class=\"WindowTransformScale.Window1\"\nx:Name=\"Window\"\nWidth=\"640\" Height=\"74\"&gt;\n\n\n&lt;Window.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"pack://application:,,,/WindowTransformScale;component/Themes/Generic.xaml\" /&gt;\n        &lt;/ResourceDictionary.MergedDictionaries&gt;\n\n        &lt;Style TargetType=\"{x:Type MenuItem}\" BasedOn=\"{StaticResource MenuItemButtonContextMenuStyle}\" /&gt;\n\n    &lt;/ResourceDictionary&gt;\n&lt;/Window.Resources&gt;\n\n&lt;Grid x:Name=\"LayoutRoot\"&gt;\n    &lt;Menu&gt;\n        &lt;MenuItem Header=\"Queue Selector\"&gt;\n            &lt;MenuItem.Icon&gt;\n                &lt;Image Source=\"/Images/Toolbar.queueselector.png\" Width=\"32\" Height=\"32\"/&gt;\n            &lt;/MenuItem.Icon&gt;\n            &lt;MenuItem Header=\"Call Queue\"&gt;\n                &lt;MenuItem.Icon&gt;\n                    &lt;Image Source=\"/Images/Toolbar.callQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                &lt;/MenuItem.Icon&gt;\n            &lt;/MenuItem&gt;\n            &lt;MenuItem Header=\"Incident Queue\"&gt;\n                &lt;MenuItem.Icon&gt;\n                    &lt;Image Source=\"/Images/Toolbar.IncidentQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                &lt;/MenuItem.Icon&gt;\n            &lt;/MenuItem&gt;\n            &lt;MenuItem Header=\"Unit Queue\"&gt;\n                &lt;MenuItem.Icon&gt;\n                    &lt;Image Source=\"/Images/Toolbar.UnitQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                &lt;/MenuItem.Icon&gt;\n            &lt;/MenuItem&gt;\n        &lt;/MenuItem&gt;\n\n        &lt;MenuItem Header=\"Queue Selector\"&gt;\n                &lt;MenuItem.Icon&gt;\n                    &lt;Image Source=\"/Images/Toolbar.queueselector.png\" Width=\"32\" Height=\"32\"/&gt;\n                &lt;/MenuItem.Icon&gt;\n                &lt;MenuItem Header=\"Call Queue\"&gt;\n                    &lt;MenuItem.Icon&gt;\n                        &lt;Image Source=\"/Images/Toolbar.callQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                    &lt;/MenuItem.Icon&gt;\n                &lt;/MenuItem&gt;\n                &lt;MenuItem Header=\"Incident Queue\"&gt;\n                    &lt;MenuItem.Icon&gt;\n                        &lt;Image Source=\"/Images/Toolbar.IncidentQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                    &lt;/MenuItem.Icon&gt;\n                &lt;/MenuItem&gt;\n                &lt;MenuItem Header=\"Unit Queue\"&gt;\n                    &lt;MenuItem.Icon&gt;\n                        &lt;Image Source=\"/Images/Toolbar.UnitQueue.png\" Margin=\"4\" Width=\"32\" Height=\"32\"/&gt;\n                    &lt;/MenuItem.Icon&gt;\n                &lt;/MenuItem&gt;\n         &lt;/MenuItem&gt;            \n    &lt;/Menu&gt;\n&lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Here is my resource xaml</p>\n\n<pre><code>&lt;ResourceDictionary \nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:scm=\"clr-namespace:System.ComponentModel;assembly=WindowsBase\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:sys=\"clr-namespace:System;assembly=mscorlib\"\nxmlns:ed=\"http://schemas.microsoft.com/expression/2010/drawing\"&gt;\n\n&lt;!--Base--&gt;\n&lt;Style x:Key=\"BaseControlStyle\"&gt;\n    &lt;Setter Property=\"Control.FontSize\" Value=\"12\"/&gt;\n    &lt;Setter Property=\"Control.FontFamily\" Value=\"Arial\"/&gt;\n    &lt;Setter Property=\"Control.Foreground\" Value=\"Black\" /&gt;\n&lt;/Style&gt;\n\n&lt;!--Start Menu Style--&gt;\n\n&lt;LinearGradientBrush x:Key=\"MenuItemSelectionFill\" EndPoint=\"0,1\" StartPoint=\"0,0\"&gt;\n    &lt;GradientStop Color=\"#34C5EBFF\" Offset=\"0\"/&gt;\n    &lt;GradientStop Color=\"#3481D8FF\" Offset=\"1\"/&gt;\n&lt;/LinearGradientBrush&gt;\n\n&lt;SolidColorBrush x:Key=\"WindowBackgroundBrush\" Color=\"#FFF\" /&gt;\n&lt;SolidColorBrush x:Key=\"SolidBorderBrush\" Color=\"#888\" /&gt;\n\n&lt;!-- TopLevelHeader --&gt;\n&lt;ControlTemplate x:Key=\"TopLevelHeaderTemplateKey\" TargetType=\"{x:Type MenuItem}\"&gt;\n\n\n\n            &lt;Grid x:Name=\"Grid\" RenderTransformOrigin=\"0.5, 0.5\"&gt;\n              &lt;Grid.RenderTransform&gt;\n                &lt;ScaleTransform/&gt;\n              &lt;/Grid.RenderTransform&gt;\n              &lt;Grid&gt;\n              &lt;Grid&gt;\n\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition Width=\"48\" SharedSizeGroup=\"MenuItemIconColumnGroup\"/&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n\n                &lt;ContentPresenter x:Name=\"Icon\" Margin=\"0\"  VerticalAlignment=\"Center\" ContentSource=\"Icon\" /&gt;\n\n                &lt;Popup Name=\"Popup\" Placement=\"Bottom\" IsOpen=\"{TemplateBinding IsSubmenuOpen}\" AllowsTransparency=\"True\" Focusable=\"False\"\n                   PopupAnimation=\"Fade\"&gt;\n\n\n                    &lt;Border Name=\"SubmenuBorder\" SnapsToDevicePixels=\"True\" Background=\"{StaticResource WindowBackgroundBrush}\"\n                    BorderBrush=\"{StaticResource SolidBorderBrush}\" BorderThickness=\"1\" &gt;\n                      &lt;StackPanel IsItemsHost=\"True\" KeyboardNavigation.DirectionalNavigation=\"Cycle\" /&gt;                                              \n                    &lt;/Border&gt;\n                &lt;/Popup&gt;\n            &lt;/Grid&gt;\n        &lt;/Grid&gt;\n    &lt;/Grid&gt;\n        &lt;ControlTemplate.Triggers&gt;\n            &lt;Trigger Property=\"IsSuspendingPopupAnimation\" Value=\"true\"&gt;\n                &lt;Setter TargetName=\"Popup\" Property=\"PopupAnimation\" Value=\"None\"/&gt;\n            &lt;/Trigger&gt;\n\n            &lt;Trigger SourceName=\"Popup\" Property=\"Popup.AllowsTransparency\" Value=\"True\"&gt;\n                &lt;Setter TargetName=\"SubmenuBorder\" Property=\"CornerRadius\" Value=\"0,0,4,4\"/&gt;\n                &lt;Setter TargetName=\"SubmenuBorder\" Property=\"Padding\" Value=\"0,0,0,3\"/&gt;\n            &lt;/Trigger&gt;\n\n            &lt;EventTrigger RoutedEvent=\"Mouse.MouseEnter\"&gt;\n            &lt;BeginStoryboard&gt;\n                &lt;Storyboard TargetName=\"Grid\"&gt;\n                    &lt;DoubleAnimation Duration=\"0:0:0.1\"\n                                     From=\"1\" To=\"1.25\"\n                                     Storyboard.TargetProperty=\"RenderTransform.ScaleX\" /&gt;\n                    &lt;DoubleAnimation Duration=\"0:0:0.1\"\n                                     From=\"1\" To=\"1.25\" \n                                     Storyboard.TargetProperty=\"RenderTransform.ScaleY\" /&gt;\n                &lt;/Storyboard&gt;\n            &lt;/BeginStoryboard&gt;\n        &lt;/EventTrigger&gt;\n\n        &lt;EventTrigger RoutedEvent=\"Mouse.MouseLeave\"&gt;\n            &lt;BeginStoryboard&gt;\n                &lt;Storyboard TargetName=\"Grid\"&gt;\n                    &lt;DoubleAnimation Duration=\"0:0:0.1\"\n                                     From=\"1.25\" To=\"1\"\n                                     Storyboard.TargetProperty=\"RenderTransform.ScaleX\" /&gt;\n                    &lt;DoubleAnimation Duration=\"0:0:0.1\"\n                                     From=\"1.25\" To=\"1\" \n                                     Storyboard.TargetProperty=\"RenderTransform.ScaleY\" /&gt;\n                &lt;/Storyboard&gt;\n            &lt;/BeginStoryboard&gt;\n        &lt;/EventTrigger&gt;\n        &lt;/ControlTemplate.Triggers&gt;\n\n&lt;/ControlTemplate&gt;\n\n\n&lt;!--Sub Menu Item--&gt;\n&lt;ControlTemplate x:Key=\"SubmenuItemTemplateKey\" TargetType=\"{x:Type MenuItem}\"&gt;\n    &lt;Grid&gt;\n        &lt;Rectangle x:Name=\"Bg\" Fill=\"{TemplateBinding Background}\" RadiusY=\"2\" RadiusX=\"2\" Stroke=\"{TemplateBinding BorderBrush}\" StrokeThickness=\"1\"/&gt;\n        &lt;Rectangle x:Name=\"InnerBorder\" Margin=\"5\" RadiusY=\"2\" RadiusX=\"2\"/&gt;\n        &lt;Grid&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"32\" SharedSizeGroup=\"MenuItemIconColumnGroup\"/&gt;\n                &lt;ColumnDefinition Width=\"*\" /&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n\n            &lt;ContentPresenter Grid.Column=\"0\" x:Name=\"Icon\" Margin=\"0\"  VerticalAlignment=\"Center\" ContentSource=\"Icon\"/&gt;\n            &lt;ContentPresenter Grid.Column=\"1\" Margin=\"10\" ContentSource=\"Header\" VerticalAlignment=\"Center\" RecognizesAccessKey=\"True\"/&gt;\n\n        &lt;/Grid&gt;\n    &lt;/Grid&gt;\n    &lt;ControlTemplate.Triggers&gt;\n      &lt;Trigger Property=\"Icon\" Value=\"{x:Null}\"&gt;\n        &lt;Setter Property=\"Visibility\" TargetName=\"Icon\" Value=\"Collapsed\"/&gt;\n      &lt;/Trigger&gt;\n      &lt;Trigger Property=\"IsHighlighted\" Value=\"true\"&gt;\n        &lt;Setter Property=\"Fill\" TargetName=\"Bg\" Value=\"{StaticResource MenuItemSelectionFill}\"/&gt;\n        &lt;Setter Property=\"Stroke\" TargetName=\"Bg\" Value=\"#8071CBF1\"/&gt;\n        &lt;Setter Property=\"Stroke\" TargetName=\"InnerBorder\" Value=\"#40FFFFFF\"/&gt;\n      &lt;/Trigger&gt;\n\n    &lt;/ControlTemplate.Triggers&gt;\n&lt;/ControlTemplate&gt;\n\n&lt;!--Menu Item Style--&gt;\n  &lt;Style TargetType=\"{x:Type MenuItem}\" BasedOn=\"{StaticResource BaseControlStyle}\"/&gt;\n\n&lt;Style x:Key=\"StandardMenuItemStyle\" TargetType=\"{x:Type MenuItem}\" BasedOn=\"{StaticResource BaseControlStyle}\"/&gt;\n\n&lt;Style x:Key=\"MenuItemButtonContextMenuStyle\" TargetType=\"{x:Type MenuItem}\" BasedOn=\"{StaticResource StandardMenuItemStyle}\"&gt;\n    &lt;Style.Triggers&gt;\n        &lt;Trigger Property=\"IsEnabled\" Value=\"False\"&gt;\n            &lt;Setter Property=\"Opacity\" Value=\"0.25\" /&gt;\n        &lt;/Trigger&gt;\n\n        &lt;Trigger Property=\"IsEnabled\" Value=\"True\"&gt;\n            &lt;Setter Property=\"Opacity\" Value=\"1\" /&gt;\n        &lt;/Trigger&gt;\n\n      &lt;Trigger Property=\"Role\" Value=\"TopLevelHeader\"&gt;\n        &lt;Setter Property=\"Template\" Value=\"{StaticResource TopLevelHeaderTemplateKey}\"/&gt;\n      &lt;/Trigger&gt;\n\n        &lt;Trigger Property=\"Role\" Value=\"SubmenuItem\"&gt;\n          &lt;Setter Property=\"Template\" Value=\"{StaticResource SubmenuItemTemplateKey}\"/&gt;\n\n        &lt;/Trigger&gt;\n\n    &lt;/Style.Triggers&gt;\n&lt;/Style&gt;\n\n&lt;!--End Menu Item Style--&gt;\n\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>Any help is greatly appreciated as I don't have a lot of hair left.</p>\n\n<p>W</p>\n"},{"tags":["wpf","validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13128486,"title":"Need to display validation error on a button?","body":"<p>I'm working on a poorly written WPF application and my team has been tasked with cleaning up as much of the garbage in the application as possible before we rewrite it.  I have the following item on a form I have to change:</p>\n\n<pre><code>&lt;StackPanel Grid.Column=\"1\" Grid.Row=\"0\"\n            Visibility=\"{Binding Path=IsInEditMode, Converter={StaticResource BoolToVisible}}\"&gt;\n    &lt;Button HorizontalAlignment=\"Right\" Margin=\"3\" \n        Content=\"{x:Static uir:EquipmentResources.EquipmentDetailChangeModelButtonLabel}\" \n        Style=\"{StaticResource LinkButton}\" \n        Command=\"{Binding OpenModelPickerCommand}\"\n        Visibility=\"{Binding Path=ClonedItem.IsCurrentModelAssigned, Converter={StaticResource BoolToVisible}}\" /&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>The form puts out a message from a resource file and appends text \"Mouse over red highlighted box for more details\"</p>\n\n<p>Naturally when the tester hits save without anything they get on error on this particular field. So now I have a bug report that there is no red box to mouse over. Is it possible to add ValidatesOnDataErrors or a validator decorator when it is a button and not a text box?</p>\n"},{"tags":["wpf","avalondock"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":193,"score":0,"question_id":12493117,"title":"WPF/AvalonDock v2.0 LayoutDocument","body":"<p>How can I add programmatically LayoutDocument with some of UIElements inside it? (like stackpanel, scrollviewer etc.) I'd like to add new LayoutDocument with stackpanel, canvas etc. to LayoutDocumentPane when user clicks \"New project\" button. May I somehow clone xaml code from one LayoutDocument and load it's to new one? And is it possible to bind Title LayoutDocument property to ViewModel Property? ( i get error it has to be dependency property )</p>\n"},{"tags":["c#","wpf","xaml","stackpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13128550,"title":"Thread-safe calls to WPF controls","body":"<p>I am just writing my first program using WPF and C#. My windows just contains a simple canvas control:</p>\n\n<pre><code>&lt;StackPanel Height=\"311\" HorizontalAlignment=\"Left\" Name=\"PitchPanel\" VerticalAlignment=\"Top\" Width=\"503\" Background=\"Black\" x:FieldModifier=\"public\"&gt;&lt;/StackPanel&gt;\n</code></pre>\n\n<p>This works fine and from the <code>Window.Loaded</code> event I can access this Canvas called <code>PitchPanel</code>.</p>\n\n<p>Now I have added a class called <code>Game</code> which is initialized like this:</p>\n\n<pre><code>public Game(System.Windows.Window Window, System.Windows.Controls.Canvas Canvas)\n{\n    this.Window = Window;\n    this.Canvas = Canvas;\n    this.GraphicsThread = new System.Threading.Thread(Draw);\n    this.GraphicsThread.SetApartmentState(System.Threading.ApartmentState.STA);\n    this.GraphicsThread.Priority = System.Threading.ThreadPriority.Highest;\n    this.GraphicsThread.Start();\n    //...\n}\n</code></pre>\n\n<p>As you can see, there is a thread called <code>GraphicsThread</code>. This should redraw the current game state at the highest possible rate like this:</p>\n\n<pre><code>private void Draw() //and calculate\n{\n   //... (Calculation of player positions occurs here)\n   for (int i = 0; i &lt; Players.Count; i++)\n   {\n       System.Windows.Shapes.Ellipse PlayerEllipse = new System.Windows.Shapes.Ellipse();\n       //... (Modifying the ellipse)\n       Window.Dispatcher.Invoke(new Action(\n       delegate()\n       {\n           this.Canvas.Children.Add(PlayerEllipse);\n       }));\n    }\n}\n</code></pre>\n\n<p>But although I have used a dispatcher which is invoked by the main window which is passed at the creation of the game instance, an unhandled exception occurs: <code>[System.Reflection.TargetInvocationException]</code>, the inner exceptions says that I cannot access the object as it is owned by another thread (the main thread).</p>\n\n<p>The Game is initialized in the Window_Loaded-event of the application:</p>\n\n<pre><code>GameInstance = new TeamBall.Game(this, PitchPanel);\n</code></pre>\n\n<p>I think this is the same principle as given in <a href=\"http://stackoverflow.com/a/2127027/778421\">this answer</a>.</p>\n\n<p>So why does this not work? Does anybody know how to make calls to a control from another thread?</p>\n"},{"tags":["c#","wpf","silverlight","xaml","dataform"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":169,"score":1,"question_id":10419105,"title":"Dataform OK/SAVE button stays disabled when editing a nested object","body":"<p>I have been working with a DataForm from the toolkit and now I realize that I apparently have problems with the IEditableObject interface. The dataform in bound to an object that has 2 sub-object. All the field for the parent object and the 2 sub objects are on the same form. When I modify a datafield from the parent object the \"OK\" button become enabled but when I play with 2 out of 3 fields from the sub-object the \"OK\" button remains disabled. I have tried to investigate the differences between the fields and they seem to be all the same has someone face the same issue?</p>\n\n<p>In the sample below the fields NumberWrapper and LabelWrapper belong to the parent object then Stc1Wrapper is an object that is part of the parent object the field label DOES trigger the ok button but the telephone number and transfer code field do not. The underlying implemention of the 3 fields of Stc1Wrapper all seem identical. I am stuck here I cannot find proper MSDN documentation on this dataform control since it comes from the toolkit which is unfortunate.</p>\n\n<pre><code>&lt;toolkit:DataForm Grid.Column=\"1\" \n                          Margin=\"0,94,0,0\" \n                          Width=\"350\"\n                          Name=\"EsnDataForm\" \n                          Header=\"Esn Item\"\n                          AutoGenerateFields=\"False\" \n                          CurrentItem=\"{Binding ElementName=MyGrid, Path=SelectedItem,Mode=TwoWay}\" \n                          AutoEdit=\"False\" \n                          AutoCommit=\"False\"\n                          CommandButtonsVisibility=\"Cancel,Edit,Commit\"\n                          CommitButtonContent=\"Save\"\n                          CancelButtonContent=\"Cancel\"&gt;\n            &lt;toolkit:DataForm.NewItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Grid&gt;\n                        &lt;Grid.RowDefinitions&gt;\n                            &lt;RowDefinition Height=\"32\" /&gt;\n                            &lt;RowDefinition Height=\"32\" /&gt;\n                            &lt;RowDefinition Height=\"32\" /&gt;\n                            &lt;RowDefinition Height=\"32\" /&gt;\n                        &lt;/Grid.RowDefinitions&gt;\n                        &lt;toolkit:DataField Label=\"Number\" IsReadOnly=\"True\" &gt;\n                            &lt;TextBox Text=\"{Binding NumberWrapper,Mode=TwoWay}\" MaxLength=\"9\" Width=\"120\" IsReadOnly=\"True\" /&gt;\n                        &lt;/toolkit:DataField&gt;\n                        &lt;toolkit:DataField Label=\"Label\" Grid.Row=\"1\" &gt;\n                            &lt;TextBox Name=\"NameBox\" Text=\"{Binding LabelWrapper,Mode=TwoWay}\" MaxLength=\"32\" Width=\"120\" /&gt;\n                        &lt;/toolkit:DataField&gt;\n                        &lt;toolkit:DataField Label=\"Sub Label\" Grid.Row=\"2\" &gt;\n                            &lt;TextBox Name=\"SubLabelBox\" Text=\"{Binding PrimaryPsapLabelWrapper,Mode=TwoWay}\" MaxLength=\"32\" Width=\"120\" /&gt;\n                        &lt;/toolkit:DataField&gt;&lt;toolkit:DataField Label=\"Label\" Margin=\"-50,1,1,1\" &gt;\n                            &lt;TextBox Name=\"Stc1LabelBox\" Text=\"{Binding Stc1Wrapper.LabelWrapper, Mode=TwoWay}\" MaxLength=\"32\" Width=\"120\" /&gt;\n                        &lt;/toolkit:DataField&gt;\n                        &lt;toolkit:DataField Label=\"Telephone Number\" Margin=\"-50,1,1,1\" &gt;\n                            &lt;TextBox Name=\"Stc1TelephoneBox\" Text=\"{Binding Stc1Wrapper.TnWrapper, Mode=TwoWay}\" MaxLength=\"10\" Width=\"120\" /&gt;\n                        &lt;/toolkit:DataField&gt;\n                        &lt;toolkit:DataField Label=\"Transfer Code\" Margin=\"-50,1,1,1\" &gt;\n                            &lt;TextBox Name=\"Stc1TransferCodeBox\" Text=\"{Binding Stc1Wrapper.TransferCodeWrapper, Mode=TwoWay}\" Width=\"120\" /&gt;\n                        &lt;/toolkit:DataField&gt;\n                    [...]\n\n    /// &lt;remarks/&gt;\n    [System.Xml.Serialization.XmlIgnore]\n    public string TransferCodeWrapper\n    {\n        get\n        {\n            return this.TransferCode;\n        }\n        set\n        {\n            ValidateRequired(\"TransferCodeWrapper\", value, \"Transfer Code is mandatory\");\n            ValidateRegularExpression(\"TransferCodeWrapper\", value, @\"^[\\*]\\d{1,3}$\", \"The format should be * followed by 1 to 3 digits\");\n            this.TransferCode = value;\n            this.RaisePropertyChanged(\"TransferCodeWrapper\");\n        }\n    }\n\n    /// &lt;remarks/&gt;\n    [System.Xml.Serialization.XmlIgnore]\n    public string TnWrapper\n    {\n        get\n        {\n            return this.Tn;\n        }\n        set\n        {\n            ValidateRequired(\"TnWrapper\", value, \"Telephone number is mandatory when Type is Telephone Number\");\n            ValidateRegularExpression(\"TnWrapper\", value, @\"^\\d{10}$\", \"The telephone number should be 10 digits\");\n            this.Tn = value;\n            this.RaisePropertyChanged(\"TnWrapper\");\n        }\n    }\n\n    /// &lt;remarks/&gt;\n    [System.Xml.Serialization.XmlIgnore]\n    public string LabelWrapper\n    {\n        get\n        {\n            return this.Label;\n        }\n        set\n        {\n            ValidateRequired(\"LabelWrapper\", value, \"Label is required\");\n            ValidateRegularExpression(\"LabelWrapper\", value, @\"^[\\w-_ ]$+\", \"Characters allowed (a-z,A-Z,0-9,-,_, )\");\n            this.Label = value;\n            this.RaisePropertyChanged(\"LabelWrapper\");\n        }\n    }\n</code></pre>\n"},{"tags":[".net","wpf","visual-studio-2010","crash"],"answer_count":8,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1084,"score":3,"question_id":4596642,"title":"Visual Studio soft-crashing when encountering XAML Errors in initialize","body":"<p>I've been having some serious issues with Visual Studio 2010 as of late. It's been crashing in a peculiar way when I encounter certain types of XAML errors during the <code>InitializeComponent()</code> of a control/window.</p>\n\n<p>The program breaks and visual studio gears up like it's catching an exception (because it is) and then stops midway displaying a broken highlight in my XAML file with no details as to <strong>what</strong> is wrong. Example:</p>\n\n<p><img src=\"http://i.stack.imgur.com/MW13N.png\" alt=\"alt text\"></p>\n\n<p>There is not pop outs, or details <strong>Anywhere</strong> about what is wrong, only a callstack that points to my <code>InitializeComponent()</code> call.</p>\n\n<p>Now normally I'd just do some trial and error to fix this problem, and find out where i messed up, but the real problem isn't my code. Visual Studio is rendered <em>completely useless</em> at this point. It reports my application still in \"Running\" mode. The Stop/Break/Restart buttons on the toolbar or in the menus don't do anything (but grey out).</p>\n\n<p>Closing the application does not stop this behaviour, closing visual studio gets it stuck in a massive loop where it yells at me complaining every file open is not in the debug project, then repeats this process when i have exausted every open file.</p>\n\n<p>I have to force-close <code>devenv.exe</code>, and after this happening 3-4 times in a row it's a lot of wasted time (as my projects are usually pretty big and studio can be quite slow @ loading).</p>\n\n<p><strong>To the point</strong> </p>\n\n<ol>\n<li>Has anyone else experienced this?</li>\n<li>How can I stop studio from locking up.</li>\n<li>Can I at LEAST get information out of this beast another way so i can fix my XAML error sooner rather than after 3-4 trial-and-error compiles yielding the same crash?</li>\n</ol>\n\n<p>Any &amp; All help would be appreciated.</p>\n\n<p>Visual Studio 2010 version: <code>10.0.30319.1RTM</code></p>\n\n<p><strong>Edit &amp; Update</strong></p>\n\n<p>FWIW, mostly the errors that cause this are <code>XamlParseExceptions</code> (I figured this out after i found what was wrong with my XAML). </p>\n\n<p><em>I think I need to be clearer though</em>, Im not looking for the solution to my code problem, as these are usually typos / small things, <strong>I'm looking for a solution to VStudio getting all buggered up as a result.</strong></p>\n\n<p>The particular error in the above image that 100% for sure caused this was a <code>XamlParseException</code> caused by forgetting a <code>Value</code> attribute on a data trigger.</p>\n\n<p>I've fixed that part but it still doesn't tell my why my studio becomes a lump of neutered program when a perfectly normal exception is thrown in the parsing of the XAML.</p>\n\n<p><strong>Code that will cause this issue (at least for me)</strong></p>\n\n<p>This is the base template WPF Application, with the following <code>Window.xaml</code> code. The problem is a missing <code>Value=\"True\"</code> on the <code>&lt;DataTrigger ...&gt;</code> in the template. It generates a <code>XamlParseException</code> and Visual Studio Crashes as described above when debugging it.</p>\n\n<pre><code>&lt;Window x:Class=\"XamlParseExplosion.MainWindow\"\n   xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n   xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n   Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n  &lt;Window.Resources&gt;\n   &lt;DataTemplate x:Key=\"BankListItemTemplate\"&gt;\n    &lt;Border x:Name=\"ItemBorder\" Width=\"250\" Margin=\"1\" BorderBrush=\"Blue\" BorderThickness=\"5,0,0,0\"&gt;\n     &lt;Grid&gt;\n      &lt;Label Content=\"{Binding Name}\" /&gt;\n     &lt;/Grid&gt;\n    &lt;/Border&gt;\n    &lt;DataTemplate.Triggers&gt;\n     &lt;DataTrigger Binding=\"{Binding IsDirty}\"&gt;\n      &lt;Setter TargetName=\"ItemBorder\" Property=\"BorderBrush\" Value=\"Red\" /&gt;\n     &lt;/DataTrigger&gt;\n    &lt;/DataTemplate.Triggers&gt;\n   &lt;/DataTemplate&gt;\n  &lt;/Window.Resources&gt;\n  &lt;Grid&gt;\n   &lt;ListView ItemTemplate=\"{StaticResource BankListItemTemplate}\" /&gt;\n  &lt;/Grid&gt;\n &lt;/Window&gt;\n</code></pre>\n\n<p><strong>Final Notes</strong></p>\n\n<p>The following solutions <strong>did not</strong> help me:</p>\n\n<ol>\n<li>Restarting Visual Studio</li>\n<li>Rebooting</li>\n<li>Reinstalling Visual Studio</li>\n<li>Disabling add-ins like ReSharper &amp; Reflector</li>\n</ol>\n\n<h2>Update (Way Later) w/ Answer</h2>\n\n<p>I want to add to this (as a pseudo answer) because I found out more information about this later that I want to pass along to people finding this question in google.</p>\n\n<p><strong>The Real Problem:</strong> XamlParseException was selected in Debug -> Exceptions to break when it occurs, because this happens during the WPF wireup vstudio cannot catch it correctly (normally it would fall down a couple more levels and be handled there where vstudio could handle it).</p>\n\n<p>Simply turn that off and life will be good again.</p>\n\n<p>I didn't want to put this as an answer because the answer provided by mazelo was correct too, when vstudio is run as Administrator it seems to be able to catch the exception properly and debug from there so I didn't want to take away his answered status because his solution does work.</p>\n"},{"tags":[".net","wpf","xaml",".net-4.5","wrappanel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13127905,"title":"Stretch WrapPanel items","body":"<p>I have WrapPanel and very similar items within it. Maybe WrapPanel is a wrong container, just describing what I have.</p>\n\n<p>I want all items have equal width; minimum width of 120. Also, I want items to stretch, that is the point.</p>\n\n<p>If WrapPanel width is 150 (less than 2*minimum) there will be one column and items' width will be 150.</p>\n\n<p>If WrapPanel width is 350 (less than 3*minimum) there will be two columns and items' width will be 175 (350/2).</p>\n\n<p>If WrapPanel width is 370 (less than 4*minimum) there will be three columns and items' width will be 123 (370/3). It can be also two items of 123 and one of 124, does not really matter.</p>\n\n<p>The question is how can I get this behavior?</p>\n"},{"tags":["c#","wpf","data-binding","string-formatting","iformatprovider"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12829213,"title":"Can I use IFormatProvider with a WPF Binding to a custom type?","body":"<p>I have a custom type (<code>SINumber</code>, which represents an SI number with appropriate units and prefix). I can bind to a <code>SINumber</code> fine and override <code>SINumber.ToString()</code>, but what is displayed is the result of calling SINumber.ToString().</p>\n\n<p>For example, SIMeasurement is of type <code>SINumber</code> with an SI value of 3099999.9046325684 Ω. Using the following Binding, I get an output of 3.09999990463257 MΩ. </p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding SINMeasurement}\"&gt;&lt;/TextBlock&gt;\n</code></pre>\n\n<p>The units (Ω) and prefix (M = mega) conversation are correct, the problem is with the number of numerals displayed. I want to be able to use a custom formatter (implementing <code>IFormatProvider</code>  <code>ICustomFormatter</code>?) to interpret the <code>StringFormat</code> from the Binding, and incorporate my SI-logic (changing prefix) to display <strong>3.10 MΩ</strong>. Below is an example of the Binding I would like to use, where the precision is customizable (0.00 in this case), and the location of the units are determined by the 'U'.</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding SINMeasurement, StringFormat='{}{0:0.00 U}'}\"&gt;&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Any thoughts? I don't want to use the hard-coded <code>SINumber.ToString()</code>, as the desired precision will vary in different locations within the application.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13127196,"title":"XmlTextReader blocks application","body":"<p>I use <code>XmlTextReader</code> reader to get some data online.</p>\n\n<p>During this stage application is like blocked.</p>\n\n<p>I have tried to use <code>BeginInvoke</code> but it doesn't help a lots.</p>\n\n<p>Or may be I need to implemented some kined of COMPLETED action....</p>\n\n<p>I don't know...</p>\n\n<p>Any clue how to resolve it?</p>\n\n<p>Thank you! </p>\n\n<pre><code>var searchUrl = \"http://weather.service.msn.com/find.aspx?outputview=search&amp;src=vista&amp;weasearchstr=\" + query;\n// Application is blocked here\nvar reader = new XmlTextReader(searchUrl);\n\nwhile (reader.Read())\n{\n</code></pre>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":13,"score":2,"question_id":13127139,"title":"appling style to windows of a WPF project","body":"<p>As test I changed the style of few elements by adding a new style in App.xaml (Application.Resources) and it is over writing a style defined in a window. </p>\n\n<p>Now, I am wondering if there is any exception in this? meaning that in a WPF application (let's assume we have 3 windows w1, w2, w3) can we apply the style defined in app.xaml only to windows 1 and 2 and then 3 keep its own style intact from its local ResourceDictionary block or any other source ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["wpf","silverlight","navigation","prism","regions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13071048,"title":"Prism: Navigation between Shells?","body":"<p>I want to create an application with Silverlight &amp; Prism where the user can navigate like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZKSLR.png\" alt=\"enter image description here\"></p>\n\n<p>The red rectangles depict regions with different Prism modules inside (6 different modules in this example).</p>\n\n<p>What is the best way to approach the following issues:</p>\n\n<ul>\n<li><p>AFAIK the regions in the shell do not change, but I cannot create the different layouts I want by using the same regions (e.g. once the modules are stacked horizontally and once vertically). Would having multiple shells be a good option here?</p></li>\n<li><p>I am aware of the Region Navigation Pipeline that can be used to switch between views in a region. Can this also be used to switch between different Shells?</p></li>\n<li><p>Navigating between shells feels wrong, but how else could I solve this?</p></li>\n</ul>\n\n<p>This seems like it would be a common scenario, but I can't find information on it. Most apps, even complex ones (i.e. <a href=\"http://blogs.msdn.com/b/erwinvandervalk/archive/2009/03/02/how-to-build-an-outlook-style-application.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/erwinvandervalk/archive/2009/03/02/how-to-build-an-outlook-style-application.aspx</a>, <a href=\"http://www.codeproject.com/Articles/165370/Creating-View-Switching-Applications-with-Prism-4\" rel=\"nofollow\">http://www.codeproject.com/Articles/165370/Creating-View-Switching-Applications-with-Prism-4</a>, StockTrader RI ) use only one shell with a layout that never changes, but what if the layout has to change?</p>\n"},{"tags":["wpf","module","prism","reload"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13069771,"title":"Update window data. WPF","body":"<p>I have a WPF project with PRISM. In my bootstrapper I have following code.</p>\n\n<pre><code>      protected override DependencyObject CreateShell()\n      {\n        Form1 form1= new Form1();\n        Form2 form2= new Form2();\n\n        var mainWindow = new MainWindow();\n        mainWindow.Show();\n        mainWindow.Activate();\n\n\n        RegionManager.SetRegionManager(form1, this.Container.Resolve&lt;IRegionManager&gt;());\n        RegionManager.SetRegionManager(form2, this.Container.Resolve&lt;IRegionManager&gt;());\n        RegionManager.UpdateRegions();\n\n        return mainWindow;\n    }\n\n    protected override IModuleCatalog GetModuleCatalog()\n    {\n        var moduleCatalog = new ModuleCatalog();\n        moduleCatalog.AddModule(typeof(MainModule));\n        moduleCatalog.AddModule(typeof(Form1Module), InitializationMode.OnDemand);\n        moduleCatalog.AddModule(typeof(Form2Module), InitializationMode.OnDemand);\n        return moduleCatalog;\n    }\n</code></pre>\n\n<p>On MainForm I have <code>ListBox</code> and button. When we select some item in the <code>ListBox</code> and click \"Show\" button the form1 is shown with some data and the mainWindow is hidden. Form1 also has button \"Go to Main\", when user clicks it I do <code>form1.Hide()</code> (hide form1 with data) and <code>mainWindow.Show()</code> (again show mainWindow).On mainWindow user selects another item from the <code>ListBox</code> and clicks \"Show\" - the form1 is shown and it should display new data because user selected new item on mainWindow but form1 displays old data (data which was shown when module for form1 was loaded for the first time). </p>\n\n<p>Example - on mainWindow we have the ListBox with the list of offices of some company, we select \"Office1\" and click \"Show\", this mainWindow hides and form1 loads, form1 displays the expenses list for \"Office1\". When I select another office on mainWindow, e.g. \"Office2\" form1 should display expenses for \"Office2\" but it displays expenses for \"Office1\".</p>\n\n<p>I do moduleManager.LoadModule(\"\") when user clicks \"Show\" button on mainWindow. I found the information that we can't reload module, it means the module is loaded only when we click \"Show\" button for the first time, but how can we update the data on the view?</p>\n"},{"tags":["wpf","dependency-properties","wizard","repaint","updates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13126675,"title":"Setting a button to \"enabled\" is not reflected in GUI","body":"<p>I implemented a UI with the help of AvalonWizard. I therein make the AllowFinishProperty of the wizard depend on a custom boolean DependencyProperty <code>computationDone</code> of a class <code>MyWindow : Window</code>. The intention is that only after some computation has been successfully done the window can be regularly closed. Before that happens it can just be aborted (by clicking the cancel button).</p>\n\n<p>The problem now is that although the property gets properly set - which I assert by using a PropertyChangedCallback in <code>computationDone</code> - the appearance of the finish button in the UI does not change from being disabled to being enabled.</p>\n\n<p>The only working approach I came up with was to make the window invisible and have a seperate thread making the window visible again. Here is my code for the PropertyChangedCallback method:</p>\n\n\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static void ComputationDoneChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\n{\n    // note: WizardPage 'pageFinish' contains the finish button\n    var @this = (MyWindow) d;\n    @this.pageFinish.AllowFinish = @this.ComputationDone;\n\n    /* non of these work:\n    @this.pageFinish.InvalidateVisual();\n    @this.pageFinish.InvalidateProperty(WizardPage.AllowFinsihProperty);\n    @this.pageFinish.InvalidateProperty(WizardPage.AllowCancelProperty);\n    @this.pageFinish.InvalidateMeasure();\n    @this.pageFinish.InvalidateArrange();\n    @this.wizard.InvalidateVisual();\n    @this.wizard.InvalidateProperty(Wizard.CancelButtonContentProperty);\n    @this.wizard.InvalidateProperty(Wizard.FinishButtonContentProperty);\n    @this.wizard.InvalidateMeasure();\n    @this.wizard.InvalidateArrange();\n    @this.pageExportFinish.Dispatcher.Invoke(DispatcherPriority.Render, EmptyDelegate);\n    @this.wizard.Dispatcher.Invoke(DispatcherPriority.Render, EmptyDelegate);\n    @this.Dispatcher.Invoke(new Action(() =&gt; @this.InvalidateVisual()));\n    @this.Dispatcher.Invoke(new Action(() =&gt; @this.wizard.InvalidateVisual()));\n    @this.Dispatcher.Invoke(new Action(() =&gt; @this.pageExportFinish.InvalidateVisual()));\n    @this.InvalidateVisual();\n    @this.Dispatcher.Invoke(new Action(@this.InvalidateVisual));\n    @this.Dispatcher.Invoke(DispatcherPriority.Loaded, EmptyDelegate);\n    */\n\n    // But this evil hack does!\n    @this.Visibility = Visibility.Hidden;\n    new Thread(delegate() {\n        while (@this.Visibility == Visibility.Visible) Thread.Sleep(1);\n        @this.Dispatcher.Invoke( new Action(() =&gt; @this.Visibility = Visibility.Visible), DispatcherPriority.Normal); \n    }).Start();\n}\n</code></pre>\n\n<p>Do you have a clue why a simple invalidation does not work? And what might be the reason for the UI not being updated in the first place?</p>\n"},{"tags":[".net","wpf","xaml","data-binding","itemssource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13126459,"title":"How to bind WPF ContextMenu ItemsSource?","body":"<p>I'm trying to bind Button's context menu this way:</p>\n\n<pre><code>&lt;Button.ContextMenu&gt;\n    &lt;ContextMenu ItemsSource=\"{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=Values}\"/&gt;\n&lt;/Button.ContextMenu&gt;\n</code></pre>\n\n<p>(UserControl has Values property).</p>\n\n<p>Why doesn't this work?\nHowever when I put this binding into other control like <code>&lt;TextBlock Text='{Binding ...}'/&gt;</code> it works OK.</p>\n\n<p>Another question, how do I debug binding problems in WPF?</p>\n"},{"tags":["wpf","silverlight","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12975996,"title":"How to solve this stretching issue in XAML?","body":"<p>I've got the following XAML (simplified):</p>\n\n<pre><code>&lt;Grid x:Name=\"parentGrid\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition/&gt;\n        &lt;RowDefinition/&gt;\n        &lt;RowDefinition/&gt;\n        &lt;RowDefinition/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;Grid Grid.Row=\"0\"&gt;\n        &lt;!-- content which fits its parent grid --&gt;\n    &lt;/Grid&gt;\n\n    &lt;Grid Grid.Row=\"1\"&gt;\n        &lt;!-- content which fits its parent grid --&gt;\n    &lt;/Grid&gt;\n\n    &lt;Grid Grid.Row=\"2\"&gt;\n        &lt;!-- content which fits its parent grid --&gt;\n    &lt;/Grid&gt;\n\n    &lt;Grid Grid.Row=\"3\"&gt;\n        &lt;!-- content which fits its parent grid --&gt;\n    &lt;/Grid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>That's a configurable container, which holds one to four of our dialogs. This container is reused a lot and the amount of containing dialogs always differs.</p>\n\n<p>The requirement is, that if there is just one dialog (so just the first grid is filled), it should stretch over the whole parent grid. If there are two grids filled, each container should fill the half of the parent grid. If there are three... and so forth.</p>\n\n<p>I couldn't get it work with neither <code>&lt;RowDefinition Height=\"Auto\"/&gt;</code> (default anyway) nor <code>&lt;RowDefinition Height=\"*\"/&gt;</code>. E.g if there is just one Grid filled, it doesn't fit the whole parent grid. If I remove three <code>RowDefinitions</code>, it works though.</p>\n\n<p>Additional information: the non-filled grids visibility is always set to <code>Visibility.Collapsed</code>.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13123231,"title":"How to Select comboBox values in Selection Changed event","body":"<pre><code>I have 3 ComboBoxes in WPF form...\n</code></pre>\n\n<p>When i am selecting 1st combox Box values its fill 2nd ComboBox...</p>\n\n<p>but while selecting 1st time comboxBox values its SelectionChanged Event is not working...\nAfter selecting 2nd time its working....</p>\n\n<pre><code> private void cmbBoard_SelectionChanged(object sender, SelectionChangedEventArgs e)\n    { cmbClass.ItemsSource = dt.DefaultView;\n                    cmbClass.DisplayMemberPath = \"Class\";\n                    cmbClass.SelectedValuePath = \"ClassID\";\n                    cmbClass.SelectedIndex = 0;\n    }\n</code></pre>\n"},{"tags":["c#","wpf","silverlight","dispatchertimer"],"answer_count":5,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":905,"score":6,"question_id":8374431,"title":"Performance for Timer vs DispatcherTimer","body":"<p>I don't have a specific scenario in mind, but this question just crossed my mind while I was thinking of scenarios where I may want to use a Timer over a DispatcherTimer.</p>\n\n<p>In the scenario where I have to perform come computationally intensive task whenever a timer event fires, and then make <em>minor</em> modifications to UI, would it be better in terms of performance to:</p>\n\n<ol>\n<li>use a regular Timer and then use the application's Dispatcher to\nchange the UI</li>\n<li>use a DispatcherTimer (and possibly do my computationally\nintensive work in some async background worker if necessary).</li>\n</ol>\n\n<p>My guess is that keeping the UI thread unblocked for as long as possible will enhance the user experience. If this <em>is</em> advisable, Are there any catches that I should be aware of in such a scenario?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I get the feeling my question was not clear enough, so I'm going to try and add a concrete, albeit made-up example.</p>\n\n<p>Let's say I have to read a large file every 2 minutes, and when I'm done, I have to add an item to a ListBox. Let's say reading/processing the file takes 10-15 seconds, during which I do no UI work. What would be the best approach for something like this?</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":2329491,"title":"WPF DataGrid Columns not lining up with headers","body":"<p>My WPF DataGrid columns are not lining up with the headers. Any idea why?</p>\n\n<p><a href=\"http://picasaweb.google.com/lh/photo/CahvlINknhL5ykIW2zCfIw?feat=directlink\" rel=\"nofollow\">http://picasaweb.google.com/lh/photo/CahvlINknhL5ykIW2zCfIw?feat=directlink</a></p>\n\n<p>More Info:</p>\n\n<p><a href=\"http://sweux.com/blogs/smoura/index.php/wpf/2009/04/27/wpf-toolkit-datagrid-part-ii-custom-styling/\" rel=\"nofollow\">http://sweux.com/blogs/smoura/index.php/wpf/2009/04/27/wpf-toolkit-datagrid-part-ii-custom-styling/</a></p>\n"},{"tags":["c#","wpf","binding"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13124776,"title":"Using ConvertBack function on OneWay binding instead of the Convert function","body":"<p>I have a converter that takes in a IEnumerable and returns one string with multiple lines. The convertback function does the opposite, takes in a string with multiple lines and returns a List. I'm using it in a few places and it works great. </p>\n\n<p>My question is, I now have locations where I want to use the Convert and ConvertBack functions in reverse (e.g. on a OneWay binding, it uses the ConvertBack function) Is this possible in XAML?</p>\n"},{"tags":["c#","wpf","static"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13124288,"title":"how to show a wpf window without having to create another instance","body":"<p>(I'm trying to create my own custom MSGBOX from wpf...)\nHow do I show another WPF Window without having this kind of code </p>\n\n<pre><code>WpfWindow w = new WpfWindow();\nw.SetBox(\"hellow world\");\nw.ShowDialog();\n</code></pre>\n\n<p>however i kind of found a way to lessen the CODE but i still need to create another instance (which is a waste of resources)</p>\n\n<pre><code>new WpfWindow().ShowBox(\"hellow world\");\n</code></pre>\n\n<p>the ShowBox(string msg) Method: </p>\n\n<pre><code>public bool? ShowBox()\n{\n    SetBox(msg);\n    return w.ShowDialog();\n}\n</code></pre>\n\n<p>I want to get rid of that \"<em>new</em>\" code snippet (if that's what you call it)</p>\n\n<p>so...in conclusion...I wanted to know how to make a <strong><em>Static</em></strong> WPF Window...</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13120834,"title":"\"First-chance exceptions\" at program shutdown","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/58380/avoiding-first-chance-exception-messages-when-the-exception-is-safely-handled\">Avoiding first chance exception messages when the exception is safely handled</a>  </p>\n</blockquote>\n\n\n\n<p>At the moment I am working on a WPF program which has to interact with DLLs programmed with C++. However, during some debugging I saw in the Debug-Output window the message <em>“First-chance exception at 0x7637c41f in *</em>*.exe: 0x0000071A: The remote procedure call was cancelled.”* just after I closed the program.</p>\n\n<p>Because I was unable to eliminate this exception, I started fresh with a brand new WPF project and enabled <em>“unmanaged code debugging”</em> and there it was the same exception without any other changes of the settings and even without any changes of the generated source code.</p>\n\n<p>Now I wonder if other people experienced the same issue and how I can resolve it.</p>\n\n<p>[EDIT]</p>\n\n<p>To reproduce this issue I only need to</p>\n\n<ol>\n<li>create a new WPF Application</li>\n<li>in WpfApplication1 Properties → Debug → Enable unmanaged code debugging</li>\n<li>Start Debugging</li>\n<li>Close MainWindow</li>\n<li>Look at Debug-Output (Debug → Windows → Output)</li>\n</ol>\n"},{"tags":["wpf","xaml","data-binding","hyperlink"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13071931,"title":"Hyperlink doesn't work properly with associated command","body":"<p>I have <code>Hyperlink</code> in a <code>Grid</code>. I bind command to hyperlink that Enables/Disables it. Then I disable it using the command. Then on its parent (<code>Grid</code>) I set <code>IsEnabled=False</code> property. After that I enable my Hyperlink with my command and enable Grid, but hyperlink doesn't activate!</p>\n\n<p>Here is sample:</p>\n\n<pre><code>Command testCommand = new Command();\n\npublic MainWindow() {\n  InitializeComponent();\n  hl.Command = testCommand;\n}\n\nprivate void Start(object sender, RoutedEventArgs e) {\n\n  //Disable Hyperlink\n  testCommand.Enabled = false;\n  //Disable Grid\n  grid.IsEnabled = false;\n  //Enable Hyperlink\n  testCommand.Enabled = true;\n  //Enable Grid\n  grid.IsEnabled = true;\n  //hl.IsEnabled = true; //if uncomment this all will be work\n}\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfApplication25.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\"\n        Height=\"172\"\n        Width=\"165\"&gt;\n  &lt;StackPanel&gt;\n    &lt;Grid x:Name=\"grid\"&gt;\n      &lt;TextBlock&gt;\n        &lt;Hyperlink x:Name=\"hl\"&gt;Test&lt;/Hyperlink&gt;\n      &lt;/TextBlock&gt;\n    &lt;/Grid&gt;\n    &lt;Button Content=\"Start\"\n            Name=\"button1\"\n            Click=\"Start\" /&gt;\n  &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>And register an ICommand:</p>\n\n<pre><code>public class Command : ICommand {\n  private bool enabled;\n  public bool Enabled {\n    get {\n      return enabled;\n    }\n    set {\n      enabled = value;\n      if (CanExecuteChanged != null)\n        CanExecuteChanged(this, EventArgs.Empty);\n    }\n  }\n  public bool CanExecute(object parameter) {\n    return Enabled;\n  }\n  public event EventHandler CanExecuteChanged;\n  public void Execute(object parameter) { }\n}\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>If Hyperlink is replaced with Button, it will be enabled even if its parent is disabled (grid.IsEnabled = false).</p>\n"},{"tags":["c#","wpf","data-binding","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1358,"score":0,"question_id":5645385,"title":"How to change the style of a button based on if else using DataTriggers in wpf mvvm","body":"<p>I want to change the style of the button on the basis of if else condition when first the wpf application is getting loaded. On application loaded using if, there will be one style of button and in else part, there will be another. How to achieve this using Datatriggers or else using MVVM pattern. </p>\n\n<p>Kindly Suggest?</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","image","bitmap","pixels","smooth"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1160,"score":5,"question_id":2381012,"title":"How can I stretch bitmap in WPF without smoothing pixels","body":"<p>I'm working on SEM image processing application, written in WPF. I have an image display control, derived from Canvas, which displays image &amp; overlays using DrawingVisuals (one for each \"layer\"). It also implements Zoom &amp; Pan using scale &amp; translate transform, applied on DrawingVisuals.</p>\n\n<p>When I zoom in the image to see individual pixels, they are displayed smooth, evidently using bilinear filtering to stretch the bitmap (no surprise, as WPF is rendered through Direct3D). However, for my use case, I would rather see individual pixels as sharp boxes, as usual in any image editor like Photoshop. That's why user of my app zooms the image -> to be able to operate on pixel level.</p>\n\n<p>Is there such option in WPF (other than manually stretching the bitmap before displaying it)? I was not able to find anything.</p>\n\n<p>thanks in advance,\nZbynek Vrastil\nCzech Republic</p>\n"},{"tags":["wpf","hyperlink"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":863,"score":0,"question_id":5215638,"title":"how to use hyperlink in wpf to get a file in network drive?","body":"<p>I have a web application...where I can get an excel file from network drive...using</p>\n\n<p>..So I am not using any impersonation.</p>\n\n<p>Do we have something similar to that in WPF ?</p>\n\n<p><strong>EDIT</strong>:\nI want to open excel file in network location...when user click a link or button. Also, i dont want to use any impersonation...as we dont have to impersonate in case of a-href.</p>\n"},{"tags":["c#",".net","wpf","winforms"],"answer_count":5,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1679,"score":7,"question_id":470846,"title":"Winforms WPF Interop - WPF content fails to paint","body":"<p>I have a Winform that uses an ElementHost to display a WPF UserControl. Once every 50 times or so when the form loads the WPF content fails to paint. You can see through the Winform chrome to whatever is beneath. Resizing the window gets the WPF content to show up.</p>\n\n<p>Is this a known issue? Can anyone suggest a workaround? </p>\n\n<p>Thanks\nScott</p>\n"},{"tags":["c#",".net","wpf","vb.net","decorator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13123239,"title":"3D border decorator in WPF","body":"<p>I need to give a 3D effect of a WPF control that I will use in an other WPF Control.</p>\n\n<pre><code>&lt;UserControl&gt;\n    &lt;ScrollViewer&gt;\n        &lt;Border BorderThickness=\"0\"&gt;\n            &lt;Border.Effect&gt;\n                &lt;DropShadowEffect Color=\"Black\"\n                                  ShadowDepth=\"3\"\n                                  Direction=\"270\" /&gt;\n            &lt;/Border.Effect&gt;\n            &lt;my:MyChildWpfControl x:Name=\"myControl\"/&gt;\n        &lt;/Border&gt;\n    &lt;/ScrollViewer&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Is there a way to <strong>directly</strong> put <code>myControl</code> into the <code>ScrollViewer</code>, <strong>without using Border child</strong> node?\nSomething about <em>decorators</em> and <em>adorners</em>... What is the simplest way to do it?</p>\n"},{"tags":["c#","wpf","prism","avalondock"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":500,"score":2,"question_id":10905238,"title":"AvalonDock with Prism Region Adapter","body":"<p>I have seen some questions on SO but none of them seemed applicable for me. I want to be able to use the great <a href=\"http://avalondock.codeplex.com/wikipage?title=Version2Concept&amp;referringTitle=Home\" rel=\"nofollow\">Avalondock 2.0</a> with Prism 4. However, all the sample region adapters for that is for Avalondock 1.x series, that I cannot get it working.</p>\n\n<p>Does anyone have sample code on how to create a Region Adapter for AvalonDock's LayoutDocumentPane and LayoutAnchorablePane?</p>\n"},{"tags":["wpf","xaml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13088971,"title":"Setting FontWeight to Bold shrinks text size","body":"<p>I've been setting up a resource dictionary to style all the controls in my WPF application and I've discovered some odd behaviour when setting the font weight for a label.</p>\n\n<p>I have to styles set up for labels, the first with normal font weight :</p>\n\n<pre><code>&lt;Style x:Key=\"Label\" TargetType=\"{x:Type Label}\"&gt;\n    &lt;Setter Property=\"VerticalAlignment\" Value=\"Center\"/&gt;\n    &lt;Setter Property=\"Margin\" Value=\"10,0\"/&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>and the second set to bold :</p>\n\n<pre><code>&lt;Style x:Key=\"LabelBold\" TargetType=\"{x:Type Label}\"&gt;\n    &lt;Setter Property=\"VerticalAlignment\" Value=\"Center\"/&gt;\n    &lt;Setter Property=\"Margin\" Value=\"10,0\"/&gt;\n    &lt;Setter Property=\"FontWeight\" Value=\"Bold\"/&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>The trouble is that when I use the bold weighted font, the text shrinks (or the text spacing) :</p>\n\n<p><img src=\"http://i.stack.imgur.com/y17VC.png\" alt=\"enter image description here\"></p>\n\n<p>I've searched about but I can't seem to see any reason for this, if anything I'd expect the text to expand because of the letter thickness increasing.\nIs this meant to happen and if so is there a way around it?</p>\n\n<p><strong>EDIT :</strong> The window is using the following fonts:</p>\n\n<pre><code>&lt;Setter Property=\"TextOptions.TextFormattingMode\" Value=\"Display\"/&gt;\n&lt;Setter Property=\"FontFamily\" Value=\"Calibri\"/&gt;\n&lt;Setter Property=\"FontSize\" Value=\"12\"/&gt;\n</code></pre>\n"},{"tags":["c#","wpf","silverlight"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13122061,"title":"How to access same List in Class from multiple .cs files?","body":"<p>A fairly simple question I guess.. I'm trying to access a list in a public Class (just an .CS file in my project.).</p>\n\n<p>In one .xaml.cs I access the class by using </p>\n\n<pre><code>DataClass dataClass = new DataClass();\n</code></pre>\n\n<p>When I try to access it in the other .xaml.cs file I used DataClass dataClass = new DataClass(); again. Of course this creates a NEW class (so all the information that is stored inside is not there.</p>\n\n<p>How can I access the Class without creating a new one?</p>\n\n<p>Kind regards,\nNiels</p>\n"},{"tags":["wpf","mvvm","asynchronous","viewmodel"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13121813,"title":"\"IsAsync\" has no effect for slow property?","body":"<p>I have a slow data source, so I create it asynchronously. Also, many properties of my viewmodel are themselves slow. Hence, I make them asynchronous too (binding to a Telerik property grid):</p>\n\n<pre><code>&lt;Grid&gt;\n  &lt;Grid.DataContext&gt;\n    &lt;ObjectDataProvider ObjectType=\"{x:Type viewModels:MyViewModel}\"\n      IsAsynchronous=\"True\" x:Name=\"myViewModel\" /&gt;\n  &lt;/Grid.DataContext&gt;\n  &lt;telerik:RadPropertyGrid x:Name=\"settings\" Item=\"{Binding IsAsync=True}\"&gt;\n    &lt;telerik:RadPropertyGrid.PropertyDefinitions&gt;\n      &lt;telerik:PropertyDefinition\n        Binding=\"{Binding Path=SlowProperty,IsAsync=True,Mode=TwoWay}\" /&gt;\n    &lt;/telerik:RadPropertyGrid.PropertyDefinitions&gt;\n  &lt;/telerik:RadPropertyGrid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>When debugging, I can see that the data source is indeed created in another thread, hence not blocking the UI. However, when I get into <code>SlowProperty</code> the debugger reveals that I'm still in the Main Thread - which is proven by the fact that the UI hangs until the property returns.</p>\n\n<p><strong>Q:</strong> What am I missing here? Isn't <code>IsAsync</code> sufficient for asynchronous properties?</p>\n\n<p><strong>Edit:</strong> It seems this works for a normal <code>TextBlock</code>. Is the <code>IsAsync</code> behavior dependent on the implementation of a control? (In this case I suspect a bug in the property grid.)</p>\n"},{"tags":["c#",".net","wpf","richtextbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13123199,"title":"WPF RichTextBox without wordwrap and nice scrollbar","body":"<p>I have a RichTextBox i'm trying to disable the word wrap, and have a horizontal scrollbar instead.</p>\n\n<p>I've read that the RichTextBox is just a FlowDocument and you have to set the PageWidth to make it scroll horizontally.</p>\n\n<p>I've tried setting the PageWidth to a high number <em>(65535)</em>, but then the horizontal scrollbar is visible all the time and wants to scroll the full 65535 width.</p>\n\n<p>I want the PageWidth to be binded to the width of the text. So it only scrolls to the end of the line.<br>\nHow could I do this?</p>\n"},{"tags":["c#","wpf","xaml","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13088168,"title":"How to set source for only one column","body":"<p>I've got a <code>DataGrid</code> whose main purpose is to allow the user to enter data in its cells.</p>\n\n<p>However, the first field in this grid should display the contents of a list.</p>\n\n<p>How would I go about setting the data source for just one column?</p>\n\n<p><strong>EDIT</strong>: I want to achieve something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/lR2Xe.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":347,"score":0,"question_id":10622511,"title":"ContextMenuOpening event not firing in WPF?","body":"<p>I have a resource dictionary inside which I have a context menu:</p>\n\n<pre><code>&lt;ResourceDictionary x:Class=\"MyApp.Components.MyContextMenu\"\n                    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n                    xmlns:local=\"clr-namespace:MyApp\"\n                    xmlns:components=\"clr-namespace:MyApp.Components\"&gt;\n    &lt;ContextMenu ContextMenuOpening=\"OnContextMenuOpening\"&gt;\n</code></pre>\n\n<p>and the resource dictionary XAML has this code behind:</p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace MyApp.Components\n{\n    public partial class MyContextMenu : ResourceDictionary\n    {\n        public MyContextMenu()\n        {\n            InitializeComponent();\n        }  \n\n        void OnContextMenuOpening(object sender, ContextMenuEventArgs e)\n        {\n            Console.WriteLine(\"here i am!\");\n        }\n    }\n}\n</code></pre>\n\n<p>The log is not appearing. I wonder why the event is not firing or getting to the right place -- is the problem because I have wrapped the context menu inside this resource dictionary?</p>\n\n<p><strong>Update:</strong> Interestingly if I remove the code-behind function, I get an error during compilation:</p>\n\n<blockquote>\n  <p>does not contain a definition for 'ContextMenu_OnContextMenuOpening'\n  and no extension method 'ContextMenu_OnContextMenuOpening' accepting a\n  first argument of type 'MyApp.Components.MyContextMenu' could be found\n  (are you missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<p><strong>Update 2:</strong> Looks like that both <code>Console.WriteLine</code> and <code>Debug.WriteLine</code> produce output, but only \"randomly\" and especially when I'm clicking near the bottom of the item. Some sort of collision detection not working maybe?</p>\n"},{"tags":["wpf","mvvm","module","mef","prism-4"],"answer_count":4,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2386,"score":9,"question_id":4947790,"title":"PRISM + MEF + MVVM -- Not sure where to really start?","body":"<p>What I'm using:</p>\n\n<ul>\n<li>Visual Studio 2010</li>\n<li>Microsoft .NET Framework 4</li>\n<li>Prism v4</li>\n</ul>\n\n<p>What I am trying to figure out is how to get started with Prism + MEF while maintaining the MVVM pattern. When I go into the Prism Quickstarts, it has a Prism + MEF, but the comments in the project specifically state that the Quickstart example does not implement MVVM. I'm not really sure what to mix/match so that my shell itself follows MVVM (and regions).</p>\n\n<p>Basically, I want to use MEF to be able to load Assemblies (Modules) at run-time. And, I want to setup regions in my Shell and have the Shell use MVVM (so I can databind things to the shell). Every example online is either Prism, Prism + MVVM, Prism + Unity, Silverlight examples, Prism + MEF, etc. But I can not find any WPF Prism + MEF + MVVM examples or information. I really have no idea how to setup my bootstrapping and such to get going.</p>\n\n<p>Once that part is done, I'm sure I'll figure out how to load other controls using MVVM into my shell. Any help would be great, especially resources that deal directly with this situation as apposed to something similar (i.e. Prism + Unity and without MEF). Thanks!</p>\n"},{"tags":["wpf","wpf-controls","ribbon","ribboncontrolslibrary"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":527,"score":1,"question_id":8031008,"title":"RibbonApplicationMenu: getting rid of the AuxiliaryPane","body":"<p>It so happened that the application I'm working on doesn't operate on documents, so there's no need in displaying the recently opened documents list in the application menu.<br>\nBut - annoyingly - there are no properties readily available in the <code>RibbonApplicationMenu</code> class to hide the unused <code>AuxiliaryPane</code> (for which, curiously, the property does exist, but is marked as \"internal\").<br>\nOf course, I can just leave it there - but that's... untidy.</p>\n\n<p>So, here's the solution I came up with.<br>\nHope it will be helpful for anyone else :-)  </p>\n\n<p>The general idea is to subclass the <code>RibbonApplicationMenu</code>, find the template child corresponding to the menu's Popup, and overrule its <code>Width</code> (after a number of frustrating experiments it became evident that doing that neither for <code>PART_AuxiliaryPaneContentPresenter</code> nor for <code>PART_FooterPaneContentPresenter</code> - nor for the both - could achieve anything).</p>\n\n<p>Well, without further ado, here's the code:</p>\n\n<pre><code>public class SlimRibbonApplicationMenu : RibbonApplicationMenu\n{\n    private const double DefaultPopupWidth = 180;\n\n    public double PopupWidth\n    {\n        get { return (double)GetValue(PopupWidthProperty); }\n        set { SetValue(PopupWidthProperty, value); }\n    }\n\n    public static readonly DependencyProperty PopupWidthProperty =\n        DependencyProperty.Register(\"PopupWidth\", typeof(double), \n        typeof(SlimRibbonApplicationMenu), new UIPropertyMetadata(DefaultPopupWidth));\n\n\n    public override void OnApplyTemplate()\n    {\n        base.OnApplyTemplate();\n        this.DropDownOpened += \n            new System.EventHandler(SlimRibbonApplicationMenu_DropDownOpened);\n    }\n\n    void SlimRibbonApplicationMenu_DropDownOpened(object sender, System.EventArgs e)\n    {\n        DependencyObject popupObj = base.GetTemplateChild(\"PART_Popup\");\n        Popup popupPanel = (Popup)popupObj;\n        popupPanel.Width = (double)GetValue(PopupWidthProperty);\n    }\n}\n</code></pre>\n\n<p>As a side note, I tried to find any way to resolve the desired width based on the max width of the ApplicationMenu's Items (rather than setting it explicitly through the DependencyProperty in XAML) - but to no avail.<br>\nGiven my despise to \"magic numbers\", any suggestion on <em>that</em> will be deeply appreciated.</p>\n"},{"tags":["wpf","layout","button"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3317,"score":0,"question_id":1565038,"title":"wpf button location","body":"<p>I am building an application.  I have a <code>Button</code> on a <code>Window</code>.  When I click the <code>Button</code>, I want \na new  <code>Window</code> to pop up.  But, the new <code>Window</code> must open under the <code>Button</code>.  As another way, when the <code>Window</code> pops up, the <code>Button</code> must been shown on the <code>Window</code>. How can I do that? Is that possible?</p>\n\n<p>Thanks in advance.Lilly</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>private void Topics_Click(object sender, RoutedEventArgs e)\n{\n     TreeView tree = new TreeView();\n     tree.Top = 250;\n     tree.Left = 30;\n     tree.Show();\n}\n</code></pre>\n"},{"tags":["c#",".net","wpf","events","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13121155,"title":"Changing wpf elements/controls from another class or static method in c#","body":"<p>I have a MainWindow that contains a text-block [statusTextblock] which has binding to a string [StatusText]. StatusTextblock needs to display combobox results from another window. I pass this data back to mainwindow when it changes in the other window and I've made a static method to change the string when this happens.</p>\n\n<p>However, the staticness of all this leaves me unable to change my textbox element at any point to the new value of StatusText.</p>\n\n<p>I thought about work arounds to bring the changes about when the user returned to Mainwindow but I've not succeeded. I tried the activate and uielement gotfocus event handler (i feel the 2nd one is still a possible fix).</p>\n\n<p>Mainwindow also happens to be always open if that matters. I also prefer doing things in code than xaml, but would be grateful for any help.</p>\n\n<p>Any ideas?</p>\n\n<p>MainWindow xaml, then program entry method, then static event to change statusText </p>\n\n<pre><code>&lt;TextBlock Margin=\"190,0,0,0\" HorizontalAlignment=\"Right\" Name=\"StatusTextBlock\" Text= {Binding}\" &gt;&lt;/TextBlock&gt;\n\npublic MainWindow() //Obviously more went here, but it's not relevent\n    {\n        StatusTextBlock.DataContext = statusText;\n    }\n\nstatic public void changeStatusText(string status)\n    {\n        statusText = status;\n    }\n</code></pre>\n"},{"tags":["c#","wpf","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13121274,"title":"BindingExpression.UpdateSource() throws Specified cast is not valid","body":"<p>I have some code which gets the binding expression of a combobox</p>\n\n<pre><code>bindingExpression = ((ComboBox)(((Grid)(control.Content)).Children[0])).GetBindingExpression( ComboBox.SelectedValueProperty );\n</code></pre>\n\n<p>the combobox is defined in xaml </p>\n\n<pre><code>&lt;ComboBox Style=\"{StaticResource UiEditorComboBoxStyle}\"\n                                  Name=\"comboBox_Business\" \n                                  DisplayMemberPath=\"Value.Name\" \n                                  SelectedValuePath=\"Value.BusinessId\"\n                                      &gt;\n                                &lt;ComboBox.SelectedValue&gt;\n                                    &lt;Binding Path=\"entity.BusinessId\" UpdateSourceTrigger=\"Explicit\" ValidatesOnDataErrors=\"True\" ValidatesOnExceptions=\"True\" Mode=\"TwoWay\"&gt;\n                                        &lt;Binding.ValidationRules&gt;\n                                            &lt;validators:ValidationRule_SelectedItem NotSelectedErrorMessage=\"A Business must be selected\"\n                                                                                NotSelectedErrorMessageTranslationKey=\"BusinessMustBeSelected\" /&gt;\n                                        &lt;/Binding.ValidationRules&gt;\n                                    &lt;/Binding&gt;\n                                &lt;/ComboBox.SelectedValue&gt;\n                            &lt;/ComboBox&gt;\n</code></pre>\n\n<p>When I call </p>\n\n<pre><code>bindingExpression.UpdateSource() \n</code></pre>\n\n<p>I get a 'specified cast is not valid' exception. I'm guessing it' something to do with the type of the property (Guid), but I can't figure out how to deal with it.</p>\n\n<p>The combobox values are bound to a dictionary</p>\n\n<p>any pointers?</p>\n\n<p>cheers,</p>\n\n<p>J</p>\n"},{"tags":["c#","wpf","dynamic","covariance","generic-collections"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13121397,"title":"Covariance in generic collections","body":"<p>I would like to do this </p>\n\n<pre><code>List&lt;anotherclass&gt; ls = new List&lt;anotherclass&gt; {new anotherclass{Name = \"me\"}};    \nmyGrid.ItemSource = ls;\n</code></pre>\n\n<p>at some other place</p>\n\n<pre><code>var d = myGrid.ItemSource as IEnumerable&lt;Object&gt;;    \nvar e = d as ICollection&lt;dynamic&gt;;\ne.Add(new anotherclass());\n</code></pre>\n\n<p>I need to access the itemsource at different areas of the program. I need to add items to the List without compile time type information. Casting to IEnumerable works, but because  I need to add items to the collection I need more than that, hence trying to cast it to a collection.</p>\n\n<p>How can it be possible?</p>\n"},{"tags":["wpf","mvvm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13121198,"title":"How to create workspace inside another workspace in tabcontrol","body":"<p>I want to create numbers of views and want it to load according to which button has been clicked in navigation view.</p>\n\n<p>i.e. if user click on Btn1 the new tabitem opens in a workspace, if user click Btn1.1 then new tabitems open inside tabitem1.</p>\n"},{"tags":["c#",".net","wpf","mvvm","radio-button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13119192,"title":"Failing to generate set of RadioButtons Dynamically with Different \"Content\"","body":"<p>I am a C++ Developer and recently shifted to C#. I am using MVVM pattern in my wpf app. I am working on dynamic generation of radiobuttons. Well the requirement is quiet simple, I need to generate 24 Radiobuttons in such a way that only one radiobutton is checked at one time. Here Is the code:</p>\n\n<p><strong>XAML:</strong> </p>\n\n<pre><code>&lt;Grid Grid.Row=\"1\"&gt;\n        &lt;GroupBox Header=\"Daughter Cards\" &gt;\n            &lt;Grid&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition /&gt;                        \n                    &lt;ColumnDefinition Width=\"220\" /&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n\n                &lt;Grid Grid.Column=\"0\"&gt;\n                    &lt;RadioButton Content=\"{Binding SlotButtons}\" Name=\"SLotButtons\" /&gt;\n                &lt;/Grid&gt; \n            &lt;/Grid&gt;\n         &lt;/GroupBox&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>In <code>Grid.Column=\"0\"</code> I want to generate 24 radiobuttons as i discussed above. </p>\n\n<p><strong>ViewModel:</strong></p>\n\n<pre><code>// Description of SlotButtons\n    private string _SlotButtons;\n    public string SlotButtons\n    {\n        get\n        {\n            return _SlotButtons;\n        }\n\n        set\n        {\n            _SlotButtons = value;\n            OnPropertyChanged(\"SlotButtons\");\n        }\n    }\n\n//For RadioButton Click\nprivate ICommand mSlotCommand;\n    public ICommand SlotCommand\n    {\n        get\n        {\n            if (mSlotCommand == null)\n                mSlotCommand = new DelegateCommand(new Action(mSlotCommandExecuted), new Func&lt;bool&gt;(mSlotCommandCanExecute));\n\n            return mSlotCommand;\n        }\n        set\n        {\n            mSlotCommand = value;\n        }\n    }\n\n    public bool mSlotCommandCanExecute()\n    {\n        return true;\n    }\n\n    public void mSlotCommandExecuted()\n    {\n       // Logic to implement on a specific radiobutton click using Index\n    }\n</code></pre>\n\n<p>I had done this in my C++ app as follows:</p>\n\n<pre><code>for(slot = 0; slot &lt; 24; slot++)\n{\n    m_slotButton[slot] = new ToggleButton(String(int(slot)) + String(\": None\"));\n    m_slotButton[slot]-&gt;addButtonListener(this);  // make this panel grab the button press      \n    addAndMakeVisible(m_slotButton[slot]);\n}\n</code></pre>\n\n<p>Now this is what i want to achieve:</p>\n\n<ol>\n<li>Generate 24 RadioButtons with content from <code>Content = 0: None</code> till <code>23: None</code>.</li>\n<li>Radiobuttons should be generated in such a way that we divide the row into 3 columns and add 8 radiobuttons in each column vertically.</li>\n<li>At any time, only one radiobutton must be checked and others must not be checked. There must be only one click command which handles all buttons with the help of respective indexes.</li>\n</ol>\n\n<p>Please help :)</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":13102716,"title":"Is there a way to display items of varying width in wpf wrappanel","body":"<p>I'm trying something like a windows 8 tiles and want to display tiles of varying width and/or height. <code>WrapPanel</code> makes each column equal width and height leaving blank spaces around the smaller items. Is there a way or a panel to display items much like a <code>StackPanel</code> where each items can have individual dimensions and wrap like a <code>WrapPanel</code>?</p>\n\n<p>Edit:\nThis is my <code>ItemsControl</code>. I replaced the Tile DataTemplate with a simple <code>Border</code> and <code>TextBlock</code>. Width is <code>auto</code> and Tiles looks fine except <code>WrapPanel</code> create equal sized cells.</p>\n\n<pre><code>            &lt;ItemsControl ItemsSource=\"{Binding Path=Contents}\" HorizontalContentAlignment=\"Left\"&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;WrapPanel Orientation=\"Vertical\" /&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;Border Background=\"#B1DBFC\" Height=\"200px\" BorderBrush=\"#404648\" Margin=\"5\"&gt;\n                        &lt;TextBlock VerticalAlignment=\"Center\" Text=\"{Binding Path=Name}\" /&gt;\n                    &lt;/Border&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/iI2zE.png\" alt=\"WrapPanel\"></p>\n\n<p>You can see from the image that the <code>width</code> of each column is the width of widest item.</p>\n\n<p>If I set the width explicitly on the border, things get more ugly.\n<img src=\"http://i.stack.imgur.com/YJEiF.png\" alt=\"Items with width set\"></p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13120253,"title":"Converitng Canvas to .png Image. Malfunctioning in WPF app","body":"<p>I have some method that converts System.Windows.Controls.Canvas Control to .png Image and save in  a directory. I Call this functions for some List &lt;Canvas&gt; and I get all the images in some directory. It is working fine but some times this function generates some of the images blank randomly also again calling this function generates all images perfectly. what could be reason behind this malfunctioning?\nBelow is the Function</p>\n\n<pre><code>  public bool GenerateICards(Canvas surface)\n        {\n            bool retVal = false;\n            try\n            {\n                // Save current canvas transform\n                Transform transform = surface.LayoutTransform;\n                // reset current transform (in case it is scaled or rotated)\n                surface.LayoutTransform = null;\n\n                // Get the size of canvas\n                Size size = new Size(surface.Width, surface.Height);\n\n                // Measure and arrange the surface\n                // VERY IMPORTANT\n                surface.Measure(size);\n                surface.Arrange(new Rect(size));\n\n                // Create a render bitmap and push the surface to it\n                RenderTargetBitmap renderBitmap =\n                  new RenderTargetBitmap(\n                    (int)size.Width,\n                    (int)size.Height,\n                    96d,\n                    96d,\n                    PixelFormats.Pbgra32);\n                renderBitmap.Render(surface);\n\n                // Create a file stream for saving image\n                using (FileStream outStream = new FileStream(SessionHelper.Path.PrintImage, FileMode.Create, FileAccess.Write, FileShare.None))\n                {\n                    // Use png encoder for our data\n                    PngBitmapEncoder encoder = new PngBitmapEncoder();\n                    // push the rendered bitmap to it\n                    encoder.Frames.Add(BitmapFrame.Create(renderBitmap));\n                    // save the data to the stream\n                    encoder.Save(outStream);\n                }\n                // Restore previously saved layout\n                surface.LayoutTransform = transform;\n                // i++;\n                retVal = true;\n            }\n            //}\n            catch (Exception)\n            {\n                ErrorLbl = \"Error occured while generating temporary images.\";\n            }\n            return retVal;\n        }\n</code></pre>\n"},{"tags":["wpf","listview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13056040,"title":"How do I wrap content in a WPF ListView?","body":"<p>I have a very simple WPF ListView that I'm using to list blocks of text.  I'd like it to scroll vertically, but the text should wrap so that there is no horizontal scroll.  All the examples I've seen are overly convoluted DataGridView nesting solutions.  This seems like such a simple use-case, however.  Here is my current code:</p>\n\n<pre><code>&lt;ListView  \n        Height=\"Auto\"\n        Width=\"Auto\"\n        Margin=\"0\"\n        Name=\"mLogListView\" \n        FontWeight=\"Bold\"\n        FontSize=\"16\"\n        SelectionMode=\"Single\"\n        ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"\n        HorizontalContentAlignment=\"Stretch\"/&gt;\n</code></pre>\n\n<p>I've tried setting the ScrollViewer.HorizontalScrollBarVisibility and HorizontalContentAlignment properties but the text simply runs off the end of the control and doesn't wrap.</p>\n\n<p>Each item is added to the <code>ListView.Items</code> collection and is a <code>ListViewItem</code> object.  The text is set to the item's <code>Content</code> property.</p>\n\n<p>Here is the code responsible for adding text times to the list:</p>\n\n<pre><code>ListViewItem item = new ListViewItem();            \nitem.Content = \"Item text is set here, but refuses to wrap in list view!\";\nmLogListView.Items.Add(item);\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["c#","wpf","memory-management","entity-framework-4.1","ef-code-first"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13104798,"title":"EF Code First object graph memory use in WPF app","body":"<p>I'm building an app to display the historical log of changes from a source control repository. The app is implemented in .NET 4 WPF and Entity Framework Code First.</p>\n\n<p>One of the problems I'm getting is that over time, as more log entries are added to the log, the application uses more and more memory and doesn't release references to the log entries.  Each log entry holds a list of \"changed files\" and for each changed file, the before and after version of the file.</p>\n\n<p>The UI displays a list of log entries and the diff between the old and new version of the currently selected <code>LogEntry</code> and <code>ChangedFile</code>. The data model is roughly as follows:</p>\n\n<pre><code>public class LogSubscription\n{\n    public List&lt;LogEntry&gt; Log { get; set; }\n}\n\npublic class LogEntry\n{\n    public List&lt;ChangedFile&gt; ChangedFiles { get; set; }\n}\n\npublic class ChangedFile\n{\n    public string OldVersion { get; set; }\n    public string NewVersion { get; set; }\n}\n</code></pre>\n\n<p>As I'm using EF Code First, the database is queried and the object model is built automatically by simply accessing the List properties.  What I'd like to do is somehow de-reference the <code>ChangedFiles</code> list after a certain time and have the database re-queried and the object model rebuilt as necessary (i.e. the user has clicked back onto the log entry).</p>\n\n<p>Is there any way to do this with EF Code First? Or should I be taking a different approach to control the memory used?</p>\n\n<p>The app and full source code is hosted on GitHub here: <a href=\"https://github.com/tomhunter-gh/SourceLog\" rel=\"nofollow\">https://github.com/tomhunter-gh/SourceLog</a></p>\n"},{"tags":["c#","wpf","google-maps","wpf-controls","bing-maps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13119301,"title":"integrate google maps with bing map wpf control","body":"<p>I was trying to integrate bing map wpf control with google map. I did that in windows phone few days back here is tutorial : <a href=\"http://www.codeproject.com/Articles/153467/Google-Maps-for-Windows-Phone-7-using-Bing-Map-Con\" rel=\"nofollow\">http://www.codeproject.com/Articles/153467/Google-Maps-for-Windows-Phone-7-using-Bing-Map-Con</a> which I followed.</p>\n\n<p>I tried similar to do that with wpf control. But its not working and giving error in xaml part.</p>\n\n<p>Its giving this error : <strong>The member \"TileSources\" is not recognized or is not accessible</strong> and this Error <strong>The attachable property 'TileSources' was not found in type 'MapTileLayer'.</strong></p>\n\n<p>I tried this too but no luck : <a href=\"http://stackoverflow.com/questions/11747160/load-custom-tiles-in-bing-maps-on-wpf\">Load custom tiles in Bing maps on WPF</a></p>\n\n<p>Have anyone done that before.</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","mvvm","textbox","wpfdatagrid"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13118991,"title":"How to set focus on datagrid when text Some text enter in Textbox?","body":"<blockquote>\n  <p>I have one textbox and Datagrid.</p>\n  \n  <p>when i enter some text in textbox then my datagrid itemsource is\n  filtered and i get some value in datagrid.</p>\n  \n  <p>But now i want when i enter some text in textbox then   datagrid\n  should get focus and using Arrow key i can change selected row  along\n  with that i want that at the same time i can also enter text in\n  textbox. </p>\n  \n  <p>i m not getting what can i do?</p>\n</blockquote>\n\n<p>can anyone have idea?\ni m using mvvm pattern..</p>\n"},{"tags":["wpf","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13120180,"title":"WPF Datagrid Popup Placement","body":"<p>I am showing a Popup when users double click a DataGrid row, is there a way to show this popup at the right of the SelectedItem?</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>&lt;Popup PlacementTarget=\"{Binding ElementName=dgWarnings}\" Placement=\"Right\" Name=\"InfoPopup\" PopupAnimation=\"Slide\" AllowsTransparency=\"True\" IsOpen=\"{Binding ShowInfo}\"&gt;        \n</code></pre>\n\n<p></p>\n\n<p>I obviously cannot bind to the selected item property as this is not a UI item.</p>\n\n<p>As I mentioned I would like to display it on the right hand side of the currently selected item in the datagrid.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13119936,"title":"Table with binding to data","body":"<p>I want to build table from a data-model via DataBinding and not found how to do it. I have a data like this:</p>\n\n<pre><code>1.type CustomObj with slots:\n- id\n- a\n- b    \n2. variable Content of type &lt;List of CustomObj&gt;\n\nHow to make a table like as below:\n\n+--------------------+--------------------+--------------------+\n|Identifier          |a slot              |b slot              |\n+--------------------+--------------------+--------------------+\n|'id from first eleme|'a from first elemen|b from first elemen |\n|t                   |t                   |t                   |\n+--------------------+--------------------+--------------------+\n|...                 |...                 |...                 |\n+--------------------+--------------------+--------------------+\n</code></pre>\n\n<p>I read about FlowDocument but not found how to build flow document from List via DataBinding.</p>\n"},{"tags":["c#","wpf","xaml","aero"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13085959,"title":"Get Aero Window Colour","body":"<p>I've made a pretty slick Windows 8-ish interface using WPF. It already turns out way better than I could wish for, but I was wondering the following:</p>\n\n<p>Is it somehow possible to retrieve the current window colour set by the user? You know, you can set the Aero colour when you right-click the desktop... My plan is to use that colour for a couple of canvas elements on my GUI.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13119584,"title":"Asynchrony with TAP (async/await) in WPF MVVM","body":"<p>I am looking for a best practice to the following setup.</p>\n\n<p>A View is data bound to ViewModel (through WPF). ViewModel updates View via INotifyPropertyChanged. Model updates ViewModel via events. The Model knows about stuff from the outside-world, like how to get stuff from the internet via WebClient, and how to retrieve data from a database.</p>\n\n<p>Getting and sending stuff to the outside-world should be done asynchronously in order for the UI (and by extension, the user) not to suffer from waiting on the outside-world.</p>\n\n<p>What would be the best practice way to go about this?  </p>\n\n<p><strong>1.</strong> The ViewModel should be responsible for calling model methods asynchronously.<br>\nThis would have the advantage of being able to write stuff like</p>\n\n<pre><code>GetWebPage(string url) {\n  var result = await Model.GetWebPageAsync(url);\n  Url = result.Url;\n}\n</code></pre>\n\n<p>in the ViewModel where <code>Url</code> is a ViewModel property with INotifyPropertyChanged to update the View.\nOr even </p>\n\n<pre><code>GetWebPage(string url) {\n  var result = await Model.GetWebPageAsync(url);\n  _view.Url = result.Url;\n}\n</code></pre>\n\n<p>where we can avoid the INotifyPropertyChanged all together. Which of these ways do you prefer?</p>\n\n<p>However, it might be more sensible to have the Model itself do the asynchronous work. We might want to be able to use the Model without the View and ViewModel, while still having it work asynchronously. Another argument is that, who knows better that the Model what stuff is best handled asynchronously.</p>\n\n<p><strong>2.</strong> The Model handles all the asynchronous stuff by itself. The ViewModel code becomes more like</p>\n\n<pre><code>GetWebPage(string url) {\n  Model.GetWebPage(url);\n}\n</code></pre>\n\n<p>and in the Model</p>\n\n<pre><code>GetWebPage(string url) {\n  var result = await Model.GetWebPageAsync(url);\n  if (UrlChanged != null);\n     UrlChanged(this, new UrlChangedEventArgs(url));\n}\n</code></pre>\n\n<p>that the ViewModel can subscribe to, and update the View accordingly.</p>\n\n<p>Which of the ways do you think is the best practice?</p>\n"},{"tags":["c#",".net","wpf","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":58,"score":-1,"question_id":13119683,"title":"Is it possible to run WPF Application on browser?","body":"<p>I am new to WPF. I wanted to know that is it possible to run a wpf application on a browser or do i have to create a different WPF Browser application ?</p>\n"},{"tags":["wpf","binding","custom-controls","dependency-properties"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13114763,"title":"Binding to a WPF custom control dependency property","body":"<p>I am having a hard time binding a property of a wpf custom control. \nHere is an excerp of my xaml custom datagrid cell whose datacontext is the list(of date):</p>\n\n<pre><code>&lt;DataGridTemplateColumn Header=\"Start\" MinWidth=\"100\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;timePicker:CustomTimePicker selectedTime=\"{Binding Path=startDate}\" MinWidth=\"100\" /&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n</code></pre>\n\n<p>As you can see, I try to bind the startDate Property of my List(Of Date) to the selectedTime dependency property in my custom wpf control TimePicker. \nHere is the definition of the customtimepicker class with the selectedDate dependency-property:</p>\n\n<pre><code>Public Class CustomTimePicker\n\nPrivate _hours As String\nPrivate _minutes As String\n\n\nPrivate _hoursChoices As List(Of String)\nPrivate _minutesChoices As List(Of String)\n\nPublic Shared selectedTimeProperty As DependencyProperty = DependencyProperty.Register(\"selectedTime\", GetType(Date), GetType(CustomTimePicker), New FrameworkPropertyMetadata(DateTime.MinValue, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, New PropertyChangedCallback(AddressOf CustomTimePicker.OnSelectedTimeChanged)))\n\nPublic Property selectedTime() As Date\n    Get\n        Return DirectCast(GetValue(selectedTimeProperty), Date)\n    End Get\n    Set(value As Date)\n        SetValue(selectedTimeProperty, value)\n    End Set\nEnd Property\n\nPublic Property hours As String\n    Get\n        Return _hours\n    End Get\n    Set(value As String)\n        _hours = value\n    End Set\nEnd Property\n\nPublic Property minutes As String\n    Get\n        Return _minutes\n    End Get\n    Set(value As String)\n        _minutes = value\n    End Set\nEnd Property\n\nPublic Property hoursChoices As List(Of String)\n    Get\n        Return _hoursChoices\n    End Get\n    Set(value As List(Of String))\n        _hoursChoices = value\n    End Set\nEnd Property\n\nPublic Property minutesChoices As List(Of String)\n    Get\n        Return _minutesChoices\n    End Get\n    Set(value As List(Of String))\n        _minutesChoices = value\n    End Set\nEnd Property\n\nProtected Shared Sub OnSelectedTimeChanged(ByVal obj As DependencyObject, ByVal args As DependencyPropertyChangedEventArgs)\n    Console.WriteLine(\"@@@@@@@\")\n    Console.WriteLine(CType(obj, CustomTimePicker).selectedTime.ToString)\nEnd Sub\n\nProtected Shared Sub OnCoerce()\n\nEnd Sub\n\nProtected Sub OnSelectedHourChanged(obj As Object, e As System.Windows.Controls.SelectionChangedEventArgs) Handles hourComboBox.SelectionChanged\n    Dim minute As Integer = 0\n\n    Dim result As Date = New Date(2000, 1, 1, hourComboBox.SelectedIndex, selectedTime.Minute, 0)\n    selectedTime = result\n\n    Console.WriteLine(\"---\")\n    Console.WriteLine(result.ToString)\n    Console.WriteLine(selectedTime.ToString)\n\nEnd Sub\n\nProtected Sub OnSelectedMinuteChanged(obj As Object, e As System.Windows.Controls.SelectionChangedEventArgs) Handles minutesComboBox.SelectionChanged\n    Dim minute As Integer = 0\n    Console.WriteLine(\"bbbbbb\")\n    Console.WriteLine(selectedTime.ToString)\n    Select Case minutesComboBox.SelectedIndex\n        Case 0\n            minute = 0\n        Case 1\n            minute = 15\n        Case 2\n            minute = 30\n        Case 3\n            minute = 45\n    End Select\n\n    Dim result As Date = New Date(2000, 1, 1, selectedTime.Hour, minute, 0)\n    selectedTime = result\nEnd Sub\n\n\nProtected Overrides Sub OnInitialized(e As System.EventArgs)\n    MyBase.OnInitialized(e)\n    _hoursChoices = New List(Of String)\n    _minutesChoices = New List(Of String)\n\n    Console.WriteLine(\"aaaaaaa\")\n    Console.WriteLine(selectedTime.ToString)\n\n    For i As Integer = 0 To 23\n        _hoursChoices.Add(i.ToString)\n    Next\n    _minutesChoices.Add(\"00\")\n    _minutesChoices.Add(\"15\")\n    _minutesChoices.Add(\"30\")\n    _minutesChoices.Add(\"45\")\n\n    hourComboBox.ItemsSource = hoursChoices\n    hourComboBox.DisplayMemberPath = hours\n    hourComboBox.SelectedValuePath = hours\n    hourComboBox.SelectedValue = hours\n\n    minutesComboBox.ItemsSource = minutesChoices\n    minutesComboBox.DisplayMemberPath = minutes\n    minutesComboBox.SelectedValuePath = minutes\n    minutesComboBox.SelectedValue = minutes\n\n\n\n    Select Case selectedTime.Minute\n        Case 0 To 14\n            minutesComboBox.SelectedIndex = 0\n        Case 15 To 29\n            minutesComboBox.SelectedIndex = 1\n        Case 30 To 44\n            minutesComboBox.SelectedIndex = 2\n        Case 45 To 59\n            minutesComboBox.SelectedIndex = 3\n    End Select\n\n    hourComboBox.SelectedIndex = selectedTime.Hour\n\nEnd Sub\n</code></pre>\n\n<p>End Class</p>\n\n<p>If I change the selectedTime property for example by</p>\n\n<pre><code>selectedTime = New Date(2000,1,1,23,59,0)\n</code></pre>\n\n<p>the value does not change in the datagrid. It is the same problem the other way around. I do not get the startTime values to the wpf control. </p>\n\n<p>It really seems like the binding is not working, even though the application compiles and runs error free.</p>\n\n<p>Can somebody help me?</p>\n\n<p>Kind regards </p>\n"},{"tags":["c#","wpf","module","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13068734,"title":"WPF Prism Load XML in module","body":"<p>i am experimenting with prism and the possibilities it brings to create applications divided into modules.\nIn one of my modules i want to load data from a XML file but can't get it to work so that </p>\n\n<pre><code>Uri uri = new Uri(resourceFile, UriKind.RelativeOrAbsolute);\nStreamResourceInfo info = Application.GetResourceStream(uri);\n</code></pre>\n\n<p>will  look for the file in the \"Data\" folder of my module project. Instead the file is successfully loaded if i put the \"Data\" folder with the XMl file inside the Shell project.</p>\n\n<p>What do i miss?</p>\n\n<p>Edit: value of resourceFile: \"Data/file.xml\"</p>\n"},{"tags":["c#","wpf","layout","resize"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13118837,"title":"WPF page resize","body":"<p>I am developing an application in Visual Studio using C# and WPF. I have made a basic structure of WPF Pages with navigation conntrols to move from one page to another. I can not make the Pages maximize on startup. I want to imitate this window behaviour \n - WindowStyle = \"None\" - make window borderless\n - WindowState = \"Maximized\" - make window fullscreen\nBasicaly I want my Pages to go full screen without borders. I'm not able to resize them. I use Pages instead of windows because I am making a weblike offline desktop app and have a lot of different screens that go from one to another and I want them to be displayed in one \"window\" and not have the user open and close windows to pass from one screen to another.</p>\n"},{"tags":["c#","wpf","mvvm","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13113467,"title":"Only bind certain properties of BindingList to DataGrid","body":"<p>Some background:</p>\n\n<pre><code>public class Base\n{\n    public string A { get; set; }\n    public double B { get; set; }\n    public DateTime C { get; set; }\n    public string D { get; set; }\n}\n\npublic class DerivedClass : Base\n{\n    public string E { get; set; }\n    public List&lt;string&gt; F { get; set; }\n    public List&lt;string&gt; G { get; set; }\n    public Image H { get; set; }\n}\n</code></pre>\n\n<p>The Base class is used as a base for several other classes which all have common properties. The derived classes add on properties specific to that derived class.</p>\n\n<p>In my View I have a DataGrid bound to my <code>DerivedClassViewModel</code>'s <code>BindingList&lt;DerivedClass&gt;</code>: </p>\n\n<pre><code>&lt;DataGrid Margin=\"318,0,0,0\" ItemsSource=\"{Binding BindingList}\"&gt;\n</code></pre>\n\n<p>This works nicely, I can add and remove items from the BindingList and the DataGrid automatically updates to reflect this. However, <code>DerivedClass</code> has several properties (the <code>List&lt;string&gt; F/H</code> for example) that I don't want to be displayed in the DataGrid. <strong>How do I bind only certain properties of DerivedClass to the DataGrid while still using <code>BindingList&lt;DerivedClass&gt;</code>?</strong></p>\n"},{"tags":["wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13118155,"title":"Design pattern for Viewmodel change triggering another viewmodel change?","body":"<p>In my WPF application, I have several models and viewmodels. Consider an example:</p>\n\n<p>The <code>SurfaceCondition</code> property of my <code>RoadViewmodel</code> changes. I want this to (asynchronously) trigger a change of the <code>Wheel</code> property of my <code>CarViewmodel</code>.</p>\n\n<p>I can think of several solutions, but I sense this particular problem has a well-recognized solution. Using messages? Putting a reference in the RoadViewmodel to the <code>CarViewmodel</code> and trigger an update through the property? Merging the viewmodels? WPF gurus out there, please enlighten me!</p>\n"},{"tags":["wpf","listbox","line"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13116732,"title":"Draw lines in layout using Listbox WPF","body":"<p>I need to draw lines in the container using ListBox control of WPF. The reason to use Listbox control being that i have a collection of objects which are basically custom Line objects exposing x1,y1 and x2,y2 points. So, once the line is drawn that would be added to the collection such that it can be displayed at the same time.</p>\n\n<p>The code which i'm using to draw lines in listbox is :</p>\n\n<pre><code>&lt;ListBox Grid.Row=\"0\" Grid.Column=\"0\" VerticalContentAlignment=\"Stretch\" HorizontalContentAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\" Grid.ColumnSpan=\"4\" Grid.RowSpan=\"4\" Name=\"listBoxLines\" Visibility=\"{Binding ElementName=RadioCaliperOn, Path=IsChecked, Converter={StaticResource booleanToVisibilityConverter}}\"  Style=\"{x:Null}\" Background=\"Transparent\" BorderThickness=\"0\" ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\" ScrollViewer.VerticalScrollBarVisibility=\"Disabled\" ItemsSource=\"{Binding Path=Calipers}\" &gt;\n                    &lt;ListBox.ItemsPanel&gt;\n                        &lt;ItemsPanelTemplate&gt;\n                            &lt;Canvas HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;&lt;/Canvas&gt;\n                            &lt;!--&lt;Grid HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;&lt;/Grid&gt;--&gt;\n                        &lt;/ItemsPanelTemplate&gt;\n                    &lt;/ListBox.ItemsPanel&gt;\n\n                    &lt;ListBox.Resources&gt;\n\n                        &lt;Style TargetType=\"ListBoxItem\"&gt;\n                            &lt;Style.Resources&gt;\n                                &lt;!-- Background of selected item when focussed --&gt;\n                                &lt;SolidColorBrush x:Key=\"{x:Static SystemColors.HighlightBrushKey}\" Color=\"Transparent\" /&gt;\n                                &lt;!-- Background of selected item when not focussed --&gt;\n                                &lt;SolidColorBrush x:Key=\"{x:Static SystemColors.ControlBrushKey}\" Color=\"Transparent\" /&gt;\n                            &lt;/Style.Resources&gt;\n                            &lt;Style.Setters&gt;\n                                &lt;!--&lt;Setter Property=\"Background\" Value=\"{StaticResource Brush_CZBscanImagePinkBorder}\"/&gt;--&gt;\n                                &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n                                &lt;Setter Property=\"Foreground\" Value=\"Transparent\"/&gt;\n                                &lt;Setter Property=\"BorderThickness\" Value=\"0\"/&gt;\n                                &lt;Setter Property=\"Margin\" Value=\"0\"/&gt;\n                                &lt;Setter Property=\"Padding\" Value=\"0\" /&gt;\n                                &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\"/&gt;\n                                &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Stretch\"/&gt;\n                                &lt;Setter Property=\"MinHeight\" Value=\"1\"/&gt;\n                                &lt;Setter Property=\"MinWidth\" Value=\"1\"/&gt;\n                                &lt;Setter Property=\"Height\" Value=\"Auto\"/&gt;\n                                &lt;Setter Property=\"Width\" Value=\"Auto\"/&gt;\n                            &lt;/Style.Setters&gt;\n                            &lt;Style.Triggers&gt;\n                                &lt;Trigger Property=\"IsSelected\" Value=\"true\"&gt;\n                                    &lt;Setter Property=\"Background\" Value=\"{StaticResource BrushTransparent}\"/&gt;\n                                    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource BrushTransparent}\"/&gt;\n                                &lt;/Trigger&gt;\n                            &lt;/Style.Triggers&gt;\n                        &lt;/Style&gt;\n                        &lt;Style TargetType=\"ListBox\"&gt;\n                            &lt;Style.Setters&gt;\n                                &lt;Setter Property=\"ListBox.BorderThickness\" Value=\"0\"&gt;&lt;/Setter&gt;\n                            &lt;/Style.Setters&gt;\n                        &lt;/Style&gt;\n                        &lt;Style TargetType=\"ScrollViewer\"&gt;\n                            &lt;Style.Setters&gt;\n                                &lt;Setter Property=\"ScrollViewer.HorizontalScrollBarVisibility\" Value=\"Disabled\"&gt;&lt;/Setter&gt;\n                                &lt;Setter Property=\"ScrollViewer.VerticalScrollBarVisibility\" Value=\"Disabled\"&gt;&lt;/Setter&gt;\n                            &lt;/Style.Setters&gt;\n                        &lt;/Style&gt;\n                    &lt;/ListBox.Resources&gt;\n\n\n                    &lt;ListBox.ItemTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;Line Cursor=\"Hand\" X1=\"{Binding Converter={StaticResource caliperToLineConverter}, ConverterParameter=X1}\" Y1=\"{Binding Converter={StaticResource caliperToLineConverter}, ConverterParameter=Y1}\" X2=\"{Binding Converter={StaticResource caliperToLineConverter}, ConverterParameter=X2}\" Y2=\"{Binding Converter={StaticResource caliperToLineConverter}, ConverterParameter=Y2}\" Stroke=\"{Binding Converter={StaticResource selectedCalliperColorConverter},RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ListBoxItem}}, Path=IsSelected}\" StrokeThickness=\"2\" Height=\"Auto\" Margin=\"0,0,0,0\" Stretch=\"Fill\"/&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/ListBox.ItemTemplate&gt;\n\n                &lt;/ListBox&gt;\n</code></pre>\n\n<p>The problem which i'm facing is that in case if there are any existing lines in the collection, then when i just mouse click my container to draw a line, the existing item of listbox gets selected and in turn i'm not able to draw any line. Please let me know the exact way or the approach that i can easily draw the lines with each line being an item of listbox. Thanks.</p>\n"},{"tags":["wpf","multithreading","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":10102757,"title":"What is alternative to C# WPF Dispatcher.Invoke(...) when using C function pointers and hooks?","body":"<p>How can do the same thing as C# WPF Dispatcher.Invoke(...) does in terms of C function pointers and Winapi hooks/messages?</p>\n\n<p>I want ask Windows C message loop to invoke my function pointer. I PostThreadMessage user defined message(WM_USER+XXX) from worker thread and invoke function  pointer in WH_GETMESSAGE hook. But seems my message is not handled or arrived to hook. Standard messages I post DO.</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13118415,"title":"UserControl.InputBindings handles mouse event - surrounding listbox item is not selected","body":"<p>I have a user controled defined in my view:</p>\n\n<pre><code>&lt;UserControl.InputBindings&gt;\n    &lt;MouseBinding Command=\"{Binding MyCommand}\" MouseAction=\"LeftClick\" /&gt;\n&lt;/UserControl.InputBindings&gt;\n</code></pre>\n\n<p>This UserControl is rendered inside a listbox item. </p>\n\n<p>When I click my user control, the command should be executed, but the listbox item should also get selected. I believe it's caused by the fact that the mousebinding handles my leftclick event, so the listbox will never get it. </p>\n\n<p>Is there a way to accomplish this? I don't want to use code behind on my view.</p>\n"},{"tags":["c#","wpf","datepicker"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":13049252,"title":"How to localize DatePicker's date format based on the language defined in Regional settings","body":"<p>I've an English windows 7 installed on my machine and the default language chosen is English (using \"Regional and language settings\"). When I read the <code>DateTimeFormat.ShortDatePattern</code> using the following C# statement:</p>\n\n<pre><code>System.Threading.Thread.CurrentThread.CurrentUICulture.DateTimeFormat.ShortDatePattern\n</code></pre>\n\n<p>I got this result </p>\n\n<pre><code>\"M/d/yyyy\"\n</code></pre>\n\n<p>I also tried this statement, and still got the same string.</p>\n\n<pre><code>System.Globalization.CultureInfo.CurrentUICulture.DateTimeFormat.ShortDatePattern  \n\"M/d/yyyy\"\n</code></pre>\n\n<p>However, now I changed the language from \"Regional and language settings\" and chose Danish language. Now if I switched to Format tab and under short date format it shows <code>\"M/d/åååå\"</code> which is localized to Danish language. This means that by changing the language the date time format also changes. </p>\n\n<p>However, in my application I still get the above English format string even though the loaded CurrentUICulture is correct i.e da-DK for Danish. I want to display the localized ShortDateFormat as is shown in Regional settings. Do I need to do the localization myself or is there any build in way to do that. Please let me know if I am missing something here. </p>\n\n<p>Edit:This information is added to further clarify the question based on the discussion with Peter. </p>\n\n<p>The Format combobox say Danish(Denmark). The format is read fine i.e Danish but the string still says M/d/yyyy instead of M/d/åååå. This is the exact string M/d/åååå that I want to display in my DatePicker control. In other words the watermark should display the localized ShortDatePattern. Still struggling...</p>\n"},{"tags":["c#",".net","wpf","mvvm","combobox"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13118073,"title":"How to Add Items in Combobox Efficiently in WPF","body":"<p>I am a C++ developer and have recently started learning WPF. I am working on a wpf app where I am using MVVM. I have comboboxes and I need to add items in it. Although I generally use ComboboxPropertyName.Add(\"\") to add items in it, I am looking for an efficient method which adds the items without much code length. Here is the code:</p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;ComboBox Height=\"23\" ItemsSource=\"{Binding BoardBoxList}\" SelectedItem=\"{Binding SelectedBoardBoxList, Mode=TwoWay}\" SelectedIndex=\"0\" Name=\"comboBox2\" /&gt;\n</code></pre>\n\n<p><strong>ViewModel Class:</strong></p>\n\n<pre><code>public ObservableCollection&lt;string&gt; BoardBoxList\n    {\n        get { return _BoardBoxList; }\n        set\n        {\n            _BoardBoxList = value;\n            OnPropertyChanged(\"BoardBoxList\");\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// _SelectedBoardBoxList\n    /// &lt;/summary&gt;\n    private string _SelectedBoardBoxList;\n    public string SelectedBoardBoxList\n    {\n        get { return _SelectedBoardBoxList; }\n        set\n        {\n            _SelectedBoardBoxList = value;\n            OnPropertyChanged(\"SelectedBoardBoxList\");\n        }\n    }\n</code></pre>\n\n<p>Here Is how I had added items in my combobox in C++:</p>\n\n<pre><code>static const signed char boards[][9] = {\n{},                                           // left blank to indicate no selection\n{ 'S', '1', '0', '1', '0', '0', '1', '2', 0 },   // redhook\n{ 'S', '1', '0', '1', '0', '0', '1', '8', 0 },   // bavaria\n{ 'S', '1', '0', '1', '0', '0', '2', '0', 0 },   // flying dog\n};\n\nm_boardBox = new ComboBox(String::empty);\nfor(int i = 1; i &lt; 4; i++)\n    m_boardBox-&gt;addItem(String((char*)(boards[i])), i); \nm_boardBox-&gt;setSelectedId(2); // select Bavaria by default\naddAndMakeVisible(m_boardBox);\n</code></pre>\n\n<p>If you notice above, you will find the loop adding items easily. This is how i wanna add items to my combobox.</p>\n\n<p>If I use <code>_BoardBoxList.Add(\"....\");</code> I will have to use many .Adds. Is their an efficient way where I can store the items in a list/collection and add them into the combobox in the form of <code>for loop</code> just like above?</p>\n\n<p>Please help :) </p>\n"},{"tags":["wpf","binding","checkbox","listbox","datatemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13118028,"title":"CheckBox as datatemplate in a ListBox reset IsChecked value when scrolling","body":"<p>I want to start using MVVM in my project so I have started to investigate it.\nWhile I was playing a bit with WPF I've encountered a bug that I couldn't find a solution to him by myself and while exploring internet.</p>\n\n<p>I have something like that(I can't paste my full code because its not in the same network):</p>\n\n<p>MainView.Xaml</p>\n\n<pre><code>&lt;ListBox ItemsSource=\"{Binding Persons}\"&gt;\n &lt;ListBox.ItemTemplate&gt;\n  &lt;DataTemplate&gt;\n   &lt;CheckBox Content=\"{Binding Name}\"&gt;\n    &lt;i:Interaction.Triggers&gt;\n     &lt;i:EventTrigger EventName=\"Checked\"&gt;\n        &lt;my:AddToInvitation /&gt;\n     &lt;/i:EventTrigger&gt;\n     &lt;i:EventTrigger EventName=\"Unchecked\"&gt;\n        &lt;my:RemoveFromInvitation /&gt;\n     &lt;/i:EventTrigger&gt;\n    &lt;/i:Interaction.Triggers&gt;\n   &lt;/CheckBox&gt;\n  &lt;/DataTemplate&gt;\n&lt;/ListBox.ItemTemplate&gt;\n</code></pre>\n\n<p></p>\n\n<p>MainViewModel.cs</p>\n\n<pre><code>public ObservableCollection&lt;PersonViewModel&gt; Persons { get; set; }\n\npublic MainViewModel()\n{\n  this.Persons = new ObservableCollection&lt;PersonViewModel&gt;();\n  for(int i=0;i&lt;1000;i++)\n  {\n     PersonViewModel personVM = new PersonViewModel (string.Format(\"Person - {0}\",i));\n     this.Persons.add(personVM);\n  }\n}\n</code></pre>\n\n<p>PersonViewModel.cs</p>\n\n<pre><code>private Person PersonObject { get; set; }\n\npublic string Name\n{\n  get\n  {\n     return this.PersonObject.Name;\n  }\n}\n\npublic PersonViewModel(string personName)\n{\n  this.PersonObject = new Person(personName);\n}\n</code></pre>\n\n<p>Person.cs</p>\n\n<pre><code>public string Name { get; set; }\n\npublic Person(string name)\n{\n   this.Name = name;\n}\n</code></pre>\n\n<p>Now if you try to paste it and run it, it will look just fine.\nThe problem is when you try the following instructions:</p>\n\n<pre><code>1) Check the first 10 persons in the ListBox.\n2) Scroll down the ListBox to the bottom of it.\n3) Leave the mouse when the list box is scrolled down.\n4) Scroll back up to the top of the ListBox.\n5) Poof! you'r checking disappeared.\n</code></pre>\n\n<p>Now the solution i have found to this is to add IsChecked property(Though I don't really need it) to the PersonViewModel and bind it to the CheckBox IsChecked DependencyProperty, but then I have added a functionality that lets the user to press a button and it will iterate over all the persons in the ListBox and change it IsChecked property to true(Button -> Select all).\nFollowing to the disappear Checks bug I have crossed another bug which I believe somehow is connected to the disappearing Checks - the actions that I have put to trigger when Check and Uncheck occurs would trigger only for some of the CheckBoxes when you select all.\nI tried to count how many times the actions would happen when I used the select all function and I found a connection between the height of the ListBox(Current Visible CheckBoxes) and the amount of the triggers that fired, furthermore I scrolled to the middle of the ListBox and used the SelectAll functionality and the triggers didn't fire until the loop encountered the first visible ChekBox that I can see in my ListBox.</p>\n\n<p>Its a bit hard to understand this bug if you don't try it, so please comment here only if you tried this.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["wpf","writeablebitmapex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12711555,"title":"Bit blit Bitmaps (WriteableBitmapEx Framework)","body":"<p>I've not fully understand the basics of Bit blit bitmaps.</p>\n\n<p>I'm using the WriteableBitmapEx framework (WPF). My bitmap represents a map and what I wanna achieve is to copy a (moving) symbol into that map.</p>\n\n<p>For actual copying, I use the function Blit:</p>\n\n<pre><code>  _bitmap.Blit(myObject.Value.Location.ToWindowsPoint(), symbol, rect, Colors.Cyan,\n                         WriteableBitmapExtensions.BlendMode.Additive);\n</code></pre>\n\n<p>where symbol is a png image(transparent background).</p>\n\n<p>This works in prinicpal but I do not understand how the color (Colors.Cyan) is applied by the blend mode. I've tried out all available blend modes but I've not succeeded in getting Cyan as the color of the symbol or I got the color but then the transparent background was also copied to the source bitmap (black background).</p>\n\n<p>Is 'Bliting' the wrong approach for my use case?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":40,"score":-2,"question_id":13117437,"title":"How to Get RowIndex of WPF dataGrid while Checked the CheckBox of a Datagrid Column","body":"<p>i have a wpf DataGrid with one CheckBox Column....</p>\n\n<p>Then How to get RowIndex of a wpf datagrid when i Checked or Unchecked CheckBox of WPF DataGrid Column...</p>\n"},{"tags":["c#","wpf","xaml","combobox","null"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":12991079,"title":"WPF ComboBox Binding works if previous record had no matching item in the ItemsSource collection and fails if it did","body":"<p>I have the following WPF Combobox:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;CollectionViewSource x:Key=\"performanceItemsource\" Source=\"{Binding Path=SelectedReport.Performances}\"  &gt;\n        &lt;CollectionViewSource.SortDescriptions&gt;\n            &lt;scm:SortDescription PropertyName=\"Name\"/&gt;\n        &lt;/CollectionViewSource.SortDescriptions&gt;\n    &lt;/CollectionViewSource&gt;\n&lt;/Window.Resources&gt;\n ...\n    &lt;ComboBox Name=\"cbxPlanPerf\" Grid.ColumnSpan=\"2\"\n      SelectedValuePath=\"MSDPortfolioID\" DisplayMemberPath=\"Name\" \n      SelectedValue=\"{Binding Path=PlanPerfID}\"\n      ItemsSource=\"{Binding Source={StaticResource performanceItemsource}}\"/&gt;\n</code></pre>\n\n<p>The Source for the <code>CollectionViewSource</code> is:</p>\n\n<pre><code>public List&lt;MSDExportProxy&gt; Performances\n{\n  get\n  {\n    if (Portfolio != null)\n    {\n      return (from a in Portfolio.Accounts where a.MSDPortfolioID != null select new MSDExportProxy(a))\n        .Concat&lt;MSDExportProxy&gt;(from g in Portfolio.Groups where g.MSDPortfolioID != null select new MSDExportProxy(g))\n        .Concat&lt;MSDExportProxy&gt;(from p in new[] { Portfolio } where p.MSDPortfolioID != null select new MSDExportProxy(p))\n        .ToList&lt;MSDExportProxy&gt;();\n    }\n    return new List&lt;MSDExportProxy&gt;();\n  }\n}\n</code></pre>\n\n<p>The bound property <code>PlanPerfID</code> is a string.  </p>\n\n<p>I move between records using a ListBox control.  The ComboBox works fine if the previous record had no items in its ComboBox.ItemsSource. If there were any items in the previous record's ComboBox.ItemsSource then the new record won't find its matching item in the <code>ItemsSource</code> collection.  I've tried setting the <code>ItemsSource</code> in both XAML and the code-behind, but nothing changes this odd behavior.  How can I get this darn thing to work?</p>\n"},{"tags":["wpf","validation","mvvm","idataerrorinfo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13113779,"title":"Implementing IDataErrorInfo in a view model","body":"<p>I have a ViewModel class with a Phone object as one of its properties , my main window data context is set to the ViewModel, do I need to implement IDataErrorInfo on the underlying Phone model class or the ViewModel class that contains the Phone property?</p>\n\n<p>Also what would be the correct way to bind the textbox I'm trying to validate to my ViewModel.NewPhone.StringProperty?</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13117535,"title":"In mvvm the view doesn't update","body":"<p>i am beginner in mvvm concept.so i tried one sample application.it contains two textbox are name and id, one submit button,one label.when i click submit button it combine the two strings from the textbox and display in label.</p>\n\n<p>i can submit the values and in viewmodel the property contain the result.but its not shown in view.why..?</p>\n\n<p>in view contains</p>\n\n<pre><code>&lt;grid&gt;\n&lt;TextBox Grid.Column=\"1\" Grid.Row=\"1\" Text=\"{Binding name}\"  Height=\"23\"  Margin=\"9\" Name=\"txtname\"  Width=\"120\" /&gt;\n&lt;TextBox Grid.Column=\"1\" Grid.Row=\"2\" Text=\"{Binding id}\" Height=\"23\"  Margin=\"9\" Name=\"txtid\"  Width=\"120\" /&gt;\n&lt;Button Command=\"{Binding submit}\" Content=\"submit\" Grid.Column=\"2\" Grid.Row=\"2\" Height=\"23\"   Name=\"btnsubmit\"  Width=\"75\" /&gt;\n&lt;Label Content=\"{Binding display}\" Grid.Row=\"3\" Height=\"38\" HorizontalAlignment=\"Left\"  Name=\"lbldisplay\"  Width=\"192\" /&gt;\n\n&lt;/grid&gt;\n</code></pre>\n\n<p>view.cs code is</p>\n\n<pre><code>public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = new DemoViewModel();\n    }\n</code></pre>\n\n<p>in my viewmodel contains two .cs file</p>\n\n<p>one is DemoViewModelInotify.cs.in this i write the code for inotifypropertychanged.\nanother one is DemoViewModel.cs.this contain the property and commands.</p>\n\n<pre><code>namespace mvvmdemonixon.ViewModel\n{\npublic  class DemoViewModel :DemoViewModelInotify\n{\n  public ICommand submit { get; set; }\n\n  public string name { get; set; }\n  public string display { get; set; }\n  public int id{get;set;}\n  public DemoModel model { get; set; }\n  public DemoViewModel()\n  {\n\n      submit = new DelegateCommand&lt;object&gt;(this.add);\n\n  }\n\n  public void add(object paramter)\n  {\n    string a=  mvvmdemonixon.Model.DemoModel.addstring(name, id);\n    display = a;\n  }\n\n}\n}\n</code></pre>\n\n<p>my model contains</p>\n\n<pre><code>namespace mvvmdemonixon.Model\n{\npublic  class DemoModel\n{\n   public static string addstring(string name1, int no1)\n   {\n       string display = \"The Student Name Is \" + name1 + \"and Id Is\" + no1 + \".\";\n       return display;\n   }\n\n}\n}\n</code></pre>\n\n<p>in my app.xaml.cs</p>\n\n<pre><code>private void OnStartup(object sender, StartupEventArgs e)\n    {\n        mvvmdemonixon.MainWindow view = new MainWindow();\n        view.DataContext = new mvvmdemonixon.ViewModel.DemoViewModel();\n        view.Show();\n    }\n</code></pre>\n\n<p>in my app xaml</p>\n\n<pre><code>&lt;Application x:Class=\"mvvmdemonixon.App\"\nStartup=\"OnStartup\"&gt;\n&lt;/Application&gt;\n</code></pre>\n\n<p>advance thanks..   </p>\n"},{"tags":["c#",".net","wpf","opacity","opacitymask"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13116971,"title":"Spotlight effect in wpf","body":"<p>Is there a way to achieve spotlight effect in wpf? \n<a href=\"http://www.youtube.com/watch?v=LgLw29c-qr8\" rel=\"nofollow\">http://www.youtube.com/watch?v=LgLw29c-qr8</a></p>\n\n<p>I can understand OpacityMask will let me do this, but how can I render an image (or a background) to a Canvas but will be shown as white in all except a region where a button is rendered? </p>\n\n<p>Here are a couple of images to explain my problem better, </p>\n\n<p>frame1 showing the button at the left edge of the screen masking a portion of canvas background. \n<img src=\"http://i.stack.imgur.com/Mwblp.png\" alt=\"frame1\"></p>\n\n<p>frame2 showing the button at the middle of the screen masking a different portion of canvas background. \n<img src=\"http://i.stack.imgur.com/LeN7R.png\" alt=\"frame2\"></p>\n\n<p>actual canvas background that has got masked\n<img src=\"http://i.stack.imgur.com/uOqHB.jpg\" alt=\"canvas backgroud\"></p>\n"},{"tags":["wpf","listview","styles","codeplex","alternating"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12937404,"title":"How to Add an Alternating Row Style to WhistlerBlue ListView","body":"<p>I have a ListView styled using the WhistlerBlue.xaml resource dictionary, as downlaoded from <a href=\"http://datagridthemesfromsl.codeplex.com/\" rel=\"nofollow\">Codeplex: WPF DataGrid Themes from Silverlight</a>.</p>\n\n<p>I want alternating (odd &amp; even) rows to have a different background colour.</p>\n\n<p>I have added the following code to the default WhistlerBlue <code>ListViewItem</code> style (within the  <code>ControlTemplate.Triggers</code> section):</p>\n\n<pre><code>     &lt;Trigger Property=\"ItemsControl.AlternationIndex\" Value=\"0\"&gt;\n          &lt;Setter Property=\"Background\" Value=\"White\"&gt;&lt;/Setter&gt;\n     &lt;/Trigger&gt;\n     &lt;Trigger Property=\"ItemsControl.AlternationIndex\" Value=\"1\"&gt;\n          &lt;Setter Property=\"Background\" Value=\"AliceBlue\"&gt;&lt;/Setter&gt;\n     &lt;/Trigger&gt;\n</code></pre>\n\n<p>I have also set the ListView style's <code>AlternatingCount</code> property to <code>2</code>, but the alternating style triggers are still not working.</p>\n\n<p>Any pointers would be greatly appreciated.</p>\n\n<p>I've pasted the complete ListViewItemStyle below.</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n    &lt;Setter Property=\"FocusVisualStyle\" Value=\"{StaticResource ListViewItemFocusVisual}\" /&gt;\n    &lt;Setter Property=\"BorderThickness\" Value=\"1\" /&gt;\n    &lt;Setter Property=\"Margin\" Value=\"0,0,0,1\" /&gt;\n    &lt;Setter Property=\"Padding\" Value=\"5,2,5,2\" /&gt;\n    &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\" /&gt;\n    &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\" /&gt;\n    &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\" /&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource OutsideFontColor}\"/&gt;\n    &lt;Setter Property=\"Padding\" Value=\"3\" /&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"{x:Type ListViewItem}\"&gt;\n                &lt;ControlTemplate.Resources&gt;\n                    &lt;Storyboard x:Key=\"HoverOn\"&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientOver\" Storyboard.TargetProperty=\"Opacity\" To=\"0.73\"/&gt;\n                    &lt;/Storyboard&gt;\n                    &lt;Storyboard x:Key=\"HoverOff\"&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientOver\" Storyboard.TargetProperty=\"Opacity\" To=\"0\"/&gt;\n                    &lt;/Storyboard&gt;\n                    &lt;Storyboard x:Key=\"SelectedOn\"&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientSelected\" Storyboard.TargetProperty=\"Opacity\" To=\"0.84\"/&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientSelectedDisabled\" Storyboard.TargetProperty=\"Opacity\" To=\"1\"/&gt;\n                    &lt;/Storyboard&gt;\n                    &lt;Storyboard x:Key=\"SelectedOff\"&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientSelected\" Storyboard.TargetProperty=\"Opacity\" To=\"0\"/&gt;\n                        &lt;DoubleAnimation Duration=\"00:00:00.00\" Storyboard.TargetName=\"BackgroundGradientSelectedDisabled\" Storyboard.TargetProperty=\"Opacity\" To=\"0\"/&gt;\n                    &lt;/Storyboard&gt;\n                &lt;/ControlTemplate.Resources&gt;\n                &lt;Border SnapsToDevicePixels=\"true\" BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"{TemplateBinding BorderThickness}\" CornerRadius=\"2\" x:Name=\"border\"&gt;\n                    &lt;Grid Margin=\"0\"&gt;\n                        &lt;Rectangle x:Name=\"BackgroundGradientOver\" Fill=\"{StaticResource hoverGradient}\" Stroke=\"{StaticResource hoverStroke}\" RadiusX=\"2\" RadiusY=\"2\" Opacity=\"0\"/&gt;\n                        &lt;Rectangle x:Name=\"BackgroundGradientSelectedDisabled\" Fill=\"{StaticResource grayGradient}\" Stroke=\"#7F8E8F8F\" RadiusX=\"2\" RadiusY=\"2\" Opacity=\"0\"/&gt;\n                        &lt;Rectangle x:Name=\"BackgroundGradientSelected\" Fill=\"{StaticResource BtnOverFill}\" Stroke=\"{StaticResource selectedStroke}\" RadiusX=\"2\" RadiusY=\"2\" Opacity=\"0\"/&gt;\n                        &lt;Rectangle x:Name=\"BackgroundHighlight\" Margin=\"1\" Stroke=\"#A0FFFFFF\" RadiusX=\"1\" RadiusY=\"1\"/&gt;\n                        &lt;GridViewRowPresenter SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\" Margin=\"0,2,0,2\" VerticalAlignment=\"Stretch\" /&gt;\n                    &lt;/Grid&gt;\n                &lt;/Border&gt;\n                &lt;ControlTemplate.Triggers&gt;\n                    &lt;Trigger Property=\"ItemsControl.AlternationIndex\" Value=\"0\"&gt;\n                        &lt;Setter Property=\"Background\" Value=\"White\"&gt;&lt;/Setter&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"ItemsControl.AlternationIndex\" Value=\"1\"&gt;\n                        &lt;Setter Property=\"Background\" Value=\"AliceBlue\"&gt;&lt;/Setter&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                        &lt;Trigger.ExitActions&gt;\n                            &lt;BeginStoryboard Storyboard=\"{StaticResource HoverOff}\" x:Name=\"HoverOff_BeginStoryboard\"/&gt;\n                        &lt;/Trigger.ExitActions&gt;\n                        &lt;Trigger.EnterActions&gt;\n                            &lt;BeginStoryboard Storyboard=\"{StaticResource HoverOn}\"/&gt;\n                        &lt;/Trigger.EnterActions&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"IsSelected\" Value=\"true\"&gt;\n                        &lt;Trigger.ExitActions&gt;\n                            &lt;BeginStoryboard x:Name=\"SelectedOff_BeginStoryboard\" Storyboard=\"{StaticResource SelectedOff}\"/&gt;\n                        &lt;/Trigger.ExitActions&gt;\n                        &lt;Trigger.EnterActions&gt;\n                            &lt;BeginStoryboard x:Name=\"SelectedOn_BeginStoryboard\" Storyboard=\"{StaticResource SelectedOn}\"/&gt;\n                        &lt;/Trigger.EnterActions&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"IsEnabled\" Value=\"false\"&gt;\n                        &lt;Setter Property=\"Foreground\" Value=\"{DynamicResource DisabledForegroundBrush}\" /&gt;\n                        &lt;Setter Property=\"Visibility\" TargetName=\"BackgroundGradientSelected\" Value=\"Hidden\"/&gt;\n                    &lt;/Trigger&gt;\n                    &lt;MultiTrigger&gt;\n                        &lt;MultiTrigger.Conditions&gt;\n                            &lt;Condition Property=\"IsSelected\" Value=\"true\" /&gt;\n                            &lt;Condition Property=\"Selector.IsSelectionActive\" Value=\"false\" /&gt;\n                        &lt;/MultiTrigger.Conditions&gt;\n                    &lt;/MultiTrigger&gt;\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"},{"tags":["c#","c++",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13116035,"title":"Failing to use String.Format to display Version String in WPF","body":"<p>I am a C++ developer and recently shifted to C#. I am working on a wpf app where I need to work on <code>String.Format</code>. In My C++ application, I had used <code>sprintf</code> to obtain the result but when it comes to C#, string.format helped me achieve it. Now I have come across a tricky situation where I need to achieve the similar thing but with different values. Here Is the C++ code:</p>\n\n<pre><code>char t_str[4] = {};\nfor(int i = 0; i &lt; 4; i++)\n{ \n    sprintf(t_str, \"%02X\", buffer[i]);\nm_apiResponse[i]-&gt;setText(String(t_str));\n}\n</code></pre>\n\n<p>where <code>buffer[0] = 20;\n                buffer[1] = 30;\n                buffer[2] = 40;\n                buffer[3] = 50;</code> and <code>m_apiResponse</code> is a textbox.</p>\n\n<p>Even though <code>string.format</code> was also helpful, I rather choose the easiset way of doing it. I had done this in my C# as follows:</p>\n\n<pre><code>Response1Box = buffer[0].ToString(\"X2\");\nResponse2Box = buffer[1].ToString(\"X2\");\nResponse3Box = buffer[2].ToString(\"X2\");\nResponse4Box = buffer[3].ToString(\"X2\");\n</code></pre>\n\n<p>It worked well and gave me the answer i wanted. But now I have come across a twisted version of it in my c++ app..... Here is the code:</p>\n\n<pre><code>unsigned char buffer[8] = {};\nchar verString[64] = {};\n\nm_msp430-&gt;WriteInternalCommand(cmd, 1, buffer);\nm_msp430-&gt;ReadInternalCommand(cmd, 4, buffer);\n\nsprintf(verString, \"FPGA 0x42 Version (dd/mm/yyyy ID): %02d/%02d/20%02d %02d\", ((buffer[3] &amp; 0xF8) &gt;&gt; 3), \n            (buffer[2] &amp; 0x0F), ((buffer[2] &amp; 0xF0) &gt;&gt; 4), (buffer[3] &amp; 0x07));\n\nm_versionString-&gt;setText(String(verString), false);\n</code></pre>\n\n<p>Here m_versionString is a label and once this statement is executed, it prints e.g. <code>FPGA 0x42 Version (dd/mm/yyyy ID): 00/00/2012 23</code>. I tried it in C# as follows:</p>\n\n<pre><code>// Description of VersionString label which displays\n    private string _VersionString;\n    public string VersionString\n    {\n        get\n        {\n            return _VersionString;\n        }\n\n        set\n        {\n            _VersionString = value;\n            OnPropertyChanged(\"VersionString\");\n        }\n    }\n\n    public void GetVersion()\n    {\n        int cmd = 0x0A42;\n        Byte[] buffer = new Byte[8];\n        Byte[] verString = new Byte[64];\n\n        mComm.WriteInternalCommand(cmd, 1, ref buffer);\n        mComm.ReadInternalCommand(cmd, 4, ref buffer);            \n\n        // Failing to figure out how to achieve it\n\n        VersionString = Convert.ToString(verString);\n    }\n</code></pre>\n\n<p>How can i perform these operations and display it on my VersionString?? :) Please help :)</p>\n"},{"tags":["c#","wpf","grid","containers","polygon"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13105402,"title":"Is there a way to use polygon as container?","body":"<p>Is there a way to use Polygon as Container (like grid or panel ) in WPF   ?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13116602,"title":"\"XamlParseException was unhandled\"","body":"<p>i am getting this exception every time i run the application. i dun know what it </p>\n\n<blockquote>\n  <p>XamlParseException was unhandled.</p>\n  \n  <p>'The invocation of the constructor on type 'chrm.MainWindow' that matches the specified\n      binding constraints threw an exception.' Line number '3' and line position '9'.</p>\n</blockquote>\n\n<p>My code </p>\n\n<p>GoogleChrome.cs</p>\n\n<pre><code>namespace chrm\n{\nclass GoogleChrome\n{\n    public List&lt;URL&gt; URLs = new List&lt;URL&gt;();\n    public IEnumerable&lt;URL&gt; GetHistory()\n    {\n        // Get Current Users App Data\n        string documentsFolder = Environment.GetFolderPath\n        (Environment.SpecialFolder.ApplicationData);\n        string[] tempstr = documentsFolder.Split('\\\\');\n        string tempstr1 = \"\";\n        documentsFolder += \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\";\n        if (tempstr[tempstr.Length - 1] != \"Local\")\n        {\n            for (int i = 0; i &lt; tempstr.Length - 1; i++)\n            {\n                tempstr1 += tempstr[i] + \"\\\\\";\n            }\n            documentsFolder = tempstr1 + \"Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\";\n        }\n\n\n        // Check if directory exists\n        if (Directory.Exists(documentsFolder))\n        {\n            return ExtractUserHistory(documentsFolder);\n\n        }\n        return null;\n    }\n\n\n    IEnumerable&lt;URL&gt; ExtractUserHistory(string folder)\n    {\n        // Get User history info\n        DataTable historyDT = ExtractFromTable(\"urls\", folder);\n\n        // Get visit Time/Data info\n        DataTable visitsDT = ExtractFromTable(\"visits\",\n        folder);\n\n        // Loop each history entry\n        foreach (DataRow row in historyDT.Rows)\n        {\n\n            // Obtain URL and Title strings\n            string url = row[\"url\"].ToString();\n            string title = row[\"title\"].ToString();\n\n            // Create new Entry\n            URL u = new URL(url.Replace('\\'', ' '),\n            title.Replace('\\'', ' '),\n            \"Google Chrome\");\n\n            // Add entry to list\n            URLs.Add(u);\n        }\n        // Clear URL History\n        DeleteFromTable(\"urls\", folder);\n        DeleteFromTable(\"visits\", folder);\n\n        return URLs;\n    }\n\n    void DeleteFromTable(string table, string folder)\n    {\n        SQLiteConnection sql_con;\n        SQLiteCommand sql_cmd;\n\n        // FireFox database file\n        string dbPath = folder + \"\\\\History\";\n\n        // If file exists\n        if (File.Exists(dbPath))\n        {\n            // Data connection\n            sql_con = new SQLiteConnection(\"Data Source=\" + dbPath +\n            \";Version=3;New=False;Compress=True;\");\n\n            // Open the Conn\n            sql_con.Open();\n\n            // Delete Query\n            string CommandText = \"delete from \" + table;\n\n            // Create command\n            sql_cmd = new SQLiteCommand(CommandText, sql_con);\n\n            sql_cmd.ExecuteNonQuery();\n\n            // Clean up\n            sql_con.Close();\n        }\n    }\n\n     DataTable ExtractFromTable(string table, string folder)\n    {\n        SQLiteConnection sql_con;\n        SQLiteCommand sql_cmd;\n        SQLiteDataAdapter DB;\n        DataTable DT = new DataTable();\n\n        // FireFox database file\n        string dbPath = folder + \"\\\\History\";\n\n        // If file exists\n        if (File.Exists(dbPath))\n        {\n            // Data connection\n            sql_con = new SQLiteConnection(\"Data Source=\" + dbPath +\n            \";Version=3;New=False;Compress=True;\");\n\n            // Open the Connection\n            sql_con.Open();\n            sql_cmd = sql_con.CreateCommand();\n\n            // Select Query\n            string CommandText = \"select * from \" + table;\n\n            // Populate Data Table\n            DB = new SQLiteDataAdapter(CommandText, sql_con);\n            DB.Fill(DT);\n\n            // Clean up\n            sql_con.Close();\n        }\n        return DT;\n    }\n}\n}\n</code></pre>\n\n<p>URL.cs</p>\n\n<pre><code>namespace chrm\n{\nclass URL\n{\n    string url;\n    string title;\n    string browser;\n    public URL(string url, string title, string browser)\n    {\n        this.url = url;\n        this.title = title;\n        this.browser = browser;\n    }\n\n    public string getData()\n    {\n        return browser + \" - \" + title + \" - \" + url;\n    }\n}\n}\n</code></pre>\n\n<p>and finally Mainwindow.xaml.cs</p>\n\n<pre><code>namespace chrm\n{\n/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    GoogleChrome ch = new GoogleChrome();\n    public MainWindow()\n    {\n\n        InitializeComponent();\n\n        ch.GetHistory();\n    }\n }\n}\n</code></pre>\n\n<p>when i put debug in cs file .. i see its not going in DataTable ExtractFromTable(string table, string folder). So i am getting the error in mainwindow only .</p>\n\n<p>what to do now?</p>\n\n<p>ok .. when i catch the exception it gives me </p>\n\n<blockquote>\n  <p>System.IO.FileLoadException: Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.\\r\\n   at chrm.GoogleChrome.ExtractFromTable(String table, String folder)\\r\\n   at chrm.GoogleChrome.ExtractUserHistory(String folder) in D:\\html5\\chrm\\chrm\\GoogleChrome.cs:line 45\\r\\n   at chrm.GoogleChrome.GetHistory() in D:\\html5\\chrm\\chrm\\GoogleChrome.cs:line 35\\r\\n   at chrm.MainWindow..ctor() in D:\\html5\\chrm\\chrm\\MainWindow.xaml.cs:line 33</p>\n</blockquote>\n\n<p>is it because dll i am using is v2.0 .. my app requires 4.0?</p>\n"},{"tags":["wpf","data-binding","icollectionview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12912057,"title":"Why is not ICollectionView refreshed?","body":"<p>I cant figureout why my ICollectionView is not refreshed. Can anyone explain what I'm doing wrong?</p>\n\n<p>I've made a viewmodel like this:</p>\n\n<pre><code>class ViewModel : INotifyPropertyChanged\n{\n    private ObservableCollection&lt;Entity&gt; m_entities = new ObservableCollection&lt;Entity&gt;();\n    public ICollectionView EntitiesView { get; private set; }\n    public ICollectionView HighCountView { get; private set; }\n\n    public ViewModel()\n    {\n        m_entities.Add(new Entity() { Id = 1, Name = \"Erik\", Description = \"The first\" });\n        m_entities.Add(new Entity() { Id = 2, Name = \"Olle\", Description = \"The second\" });\n        m_entities.Add(new Entity() { Id = 3, Name = \"Kim\", Description = \"The last\" });\n\n\n        EntitiesView = CollectionViewSource.GetDefaultView(m_entities);\n        EntitiesView.CurrentChanged += new EventHandler(EntitiesView_CurrentChanged);\n\n        HighCountView = new CollectionView(m_entities);\n        using (HighCountView.DeferRefresh())\n        {\n            HighCountView.Filter = e =&gt; ((Entity)e).Count &gt; 3;\n        }\n\n    }\n\n    private void EntitiesView_CurrentChanged(object sender, EventArgs e)\n    {\n        Entity current = EntitiesView.CurrentItem as Entity;\n        if(current!=null)\n        {\n            current.Count++;\n            HighCountView.Refresh();            // Do I need this line?\n            OnPropertyChanged(\"HighCountView\"); // or this?\n        }\n    }\n</code></pre>\n\n<p>...and in my window I use it as the datacontext, like this:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    private ViewModel vm = new ViewModel();\n    public MainWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void Window_Loaded(object sender, RoutedEventArgs e)\n    {\n        this.DataContext = vm;\n    }\n}\n</code></pre>\n\n<p>...and I'm doing my bindings in the XAML-code like this:</p>\n\n<pre><code>    &lt;ListBox Grid.Column=\"0\" x:Name=\"listView1\" DisplayMemberPath=\"Name\" ItemsSource=\"{Binding EntitiesView}\" IsSynchronizedWithCurrentItem=\"True\" /&gt;\n    &lt;ListView Grid.Column=\"1\" x:Name=\"listView2\" DisplayMemberPath=\"Name\" ItemsSource=\"{Binding HighCountView}\" IsSynchronizedWithCurrentItem=\"True\" /&gt;\n</code></pre>\n\n<p>The problem is that all three Entities is always shown in listView2 despite that I set the Filter-property. Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>To made the sample complete, here is the Entity-class.</p>\n\n<pre><code>class Entity : INotifyPropertyChanged\n{\n    private int m_id;\n    public int Id\n    {\n        bla bla.....\n    }\n\n    private string m_name;\n    public string Name\n    {\n        bla bla.....\n    }\n\n    private string m_description;\n    public string Description\n    {\n        bla bla.....\n    }\n\n\n    private int m_count;\n    public int Count\n    {\n        get { return m_count; }\n        set\n        {\n            if (value != m_count)\n            {\n                m_count = value;\n                OnPropertyChanged(\"Count\");\n            }\n        }\n    }\n\n    public void Update()\n    {\n        Description = \"Updated: \" + (++Count).ToString() + \" times.\";\n    }\n</code></pre>\n"},{"tags":["c#",".net","wpf","mvvm","radio-button"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13067237,"title":"Generate Labels Dynamically On clicking Dynamically generated RadioButton in WPF","body":"<p>I am a C++ developer and recently moved to wpf. I seem to have across a tricky situation where I have to dynamically generate labels based on radiobutton click. Here I will show you how I have generated 4 radio buttons first.</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Grid Grid.Row=\"0\"&gt;           \n\n        &lt;ItemsControl ItemsSource=\"{Binding Children}\"&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\"\n                    IsItemsHost=\"True\" /&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;RadioButton Content=\"{Binding RadioBase}\" Margin=\"0,10,0,0\" IsChecked=\"{Binding BaseCheck}\" Height=\"15\" Width=\"80\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"/&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;          \n\n    &lt;/Grid&gt;\n\n&lt;Grid Grid.Row=\"1\"&gt;\n    &lt;Label Content=\"{Binding name}\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" /&gt;      \n&lt;/Grid&gt;\n</code></pre>\n\n<p>ViewModel:</p>\n\n<pre><code>private bool sBaseCheck;\n    public bool BaseCheck\n    {\n        get { return this.sBaseCheck; }\n        set\n        {\n            this.sBaseCheck = value;                \n            this.OnPropertyChanged(\"BaseCheck\");\n        }\n    }\n\n    private int _ID;\n    public int ID\n    {\n        get\n        {\n            return _ID;\n        }\n\n        set\n        {\n            _ID = value;\n            OnPropertyChanged(\"ID\");\n        }\n    }\n\n    private string _NAme;\n    public string name\n    {\n        get\n        {\n            return _NAme;\n        }\n\n        set\n        {\n            _NAme= value;\n            OnPropertyChanged(\"name\");\n        }\n    }\n\n    private string _RadioBase;\n    public string RadioBase\n    {\n        get\n        {\n            return _RadioBase;\n        }\n\n        set\n        {\n            _RadioBase = value;\n            OnPropertyChanged(\"RadioBase\");\n        }\n    }\n</code></pre>\n\n<p>AnotherViewModel Class:</p>\n\n<pre><code>public ObservableCollection&lt;FPGAViewModel&gt; Children { get; set; }\n\n    public FPGARadioWidgetViewModel()\n    {\n        Children = new ObservableCollection&lt;FPGAViewModel&gt;();\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x0\", ID = 0 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x40\", ID = 1 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0x80\", ID = 2 });\n        Children.Add(new FPGAViewModel() { RadioBase = \"Base 0xc0\", ID = 3 });            \n    }\n</code></pre>\n\n<p>This gives me 4 radiobuttons with Content as given above. Now I want to generate 8 labels on each radiobutton click. I had done this in my C++ app as follows:</p>\n\n<pre><code>for(i = 0; i &lt; 0x40 / 8; i++)\n{\n    reg = (i * 8);\n    m_registerLabel[i] = new Label(String::empty, String(\"Reg 0x\") + String::toHexString(reg));\n    addAndMakeVisible(m_registerLabel[i]);\n}\n</code></pre>\n\n<p>if you notice, it will create 8 labels with value as <code>Reg 0x0, Reg 0x8, Reg 0x10, Reg 0x18</code> etc since reg is converted to hexstring. I want to generate something like this when I click <code>Base 0x0</code> on startup.</p>\n\n<p>How can i achieve this in my app???</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13116247,"title":"WPF Element Rotation inside a layout","body":"<p>I want to rotate a element inside a canvas using RotateTransfer object.It is rotating fine but\nsometime it is moving outside of the canvas.Can anyone suggest how to restrict rotation to outside of canvas.</p>\n"},{"tags":["wpf","data-binding","datagrid","itemssource","relativesource"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2853,"score":4,"question_id":3920040,"title":"Binding to DataContext outside current ItemsSource context","body":"<p>I have a DataSet bound to the Window.DataContext; I also have a DataGrid</p>\n\n<pre><code>&lt;DataGrid ItemsSource={Binding Tables[Items]}&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridTextBoxColumn Header={Binding Path=DataContext.Tables[Names]/Test, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}} /&gt;\n    &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Basically, I'm trying to bind the Header of that column to DataTable \"Names\", Column \"Test\", first row.</p>\n\n<p>However, I can't get it right.  Note that I can bind it fine outside the DataGrid.  The Grid's ItemsSource changes the data context and I don't know how to refer outside to the original DataContext.</p>\n\n<p>It seems that the binding succeeds; but the problem is that the current item (first row) of the Tables[Names] in the Window.DataContext got lost.</p>\n\n<p>If I make the DataSet static and access it via {x:Static local:dataset} then things work fine.  But I can't use static datasets because there will be multiple instances (multi-user).</p>\n\n<p>Can anyone please point me in the right direction?</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13107278,"title":"Print preview and prints its only printing first page","body":"<p>I have a WPF Form ,I need to print it ,i use DocumentViewer to print. but when I want to Print it or Preview , I only See the first page while i have more than one page </p>\n\n<pre><code>private void Print(object sender, RoutedEventArgs e)\n{\nPrintSettings printSettings = PrintSettings.Default;\nUIElement container = this.Content as UIElement;\nScrollViewer containerPanel = Helper.FindVisualChildren&lt;ScrollViewer&gt;(container).FirstOrDefault();\nvar origParentDirection = containerPanel.FlowDirection;\nvar origDirection = (containerPanel.Content as FrameworkElement).FlowDirection;\nif (containerPanel != null &amp;&amp; containerPanel.FlowDirection == FlowDirection.RightToLeft)\n{\ncontainerPanel.FlowDirection = FlowDirection.LeftToRight;\n(containerPanel.Content as FrameworkElement).FlowDirection = FlowDirection.RightToLeft;\n}\nvar window = new Window();\nstring tempFileName = System.IO.Path.GetTempFileName();\nSystem.IO.File.Delete(tempFileName);\nusing (XpsDocument xpsDocument = new XpsDocument(tempFileName, FileAccess.ReadWrite, System.IO.Packaging.CompressionOption.Fast))\n{\nXpsDocumentWriter writer = XpsDocument.CreateXpsDocumentWriter(xpsDocument);\n(containerPanel.Content as FrameworkElement).Margin = new Thickness(20);\nwriter.Write((containerPanel.Content as FrameworkElement), printSettings.PrintTicket);\nvar doc = xpsDocument.GetFixedDocumentSequence();\ndoc.PrintTicket = printSettings.PrintTicket;       \nwindow.FlowDirection = System.Windows.FlowDirection.RightToLeft;\nwindow.Content = new DocumentViewer { Document = doc };\nwindow.Margin = new Thickness(10);\nwindow.ShowDialog();\n}\n(containerPanel.Content as FrameworkElement).FlowDirection = origDirection;\ncontainerPanel.FlowDirection = origParentDirection;\n}\n</code></pre>\n"},{"tags":["c#","wpf","xaml","properties"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":995,"score":4,"question_id":5782864,"title":"Adding custom attributes to an element in XAML?","body":"<p>In html, there is nothing preventing you from creating custom attributes, since it is effectively xml such as</p>\n\n<pre><code>&lt;span myProperty=\"myValue\"&gt;&lt;/span&gt;\n</code></pre>\n\n<p>Then you can read that property via javascript.</p>\n\n<p>Can you do the same thing in wpf? For example:</p>\n\n<pre><code>&lt;Canvas MyProperty=\"MyValue\" Name=\"MyCanvas\" DataContext=\"{Binding}\" Background=\"Black\" Margin=\"181,0,0,0\"&gt;&lt;/Canvas&gt;\n</code></pre>\n\n<p>and If so how would you access that property? For example:</p>\n\n<pre><code>MyCanvas.MyProperty;\n</code></pre>\n"},{"tags":["wpf","adorner","adornerlayer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13107772,"title":"Clipping AdornerLayer","body":"<p>I have a <code>PanZoomImage</code> class defined like this:</p>\n\n<pre><code>&lt;Border Grid.Row=\"0\" Name=\"border\" ClipToBounds=\"True\"&gt;\n    &lt;Canvas Name=\"canvas\"&gt;\n        &lt;Image Name=\"image\" RenderOptions.BitmapScalingMode=\"NearestNeighbor\" Stretch=\"None\" \n           Source=\"{Binding Path=Source}\"\n           MouseLeftButtonDown=\"image_MouseLeftButtonDown\"\n           MouseLeftButtonUp=\"image_MouseLeftButtonUp\"\n           MouseMove=\"image_MouseMove\"\n           MouseWheel=\"image_MouseWheel\"\n           Loaded=\"image_Loaded\"&gt;\n        &lt;/Image&gt;\n    &lt;/Canvas&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p>Sometimes I want to display Adorners on the image so I have a property that gives me the <code>AdornerLayer</code> for the image:</p>\n\n<pre><code>public AdornerLayer Adorners\n{\n    get\n    {\n        return AdornerLayer.GetAdornerLayer(image);\n    }\n}\n</code></pre>\n\n<p>I use this property to add different adorners to the image. The problem is that when I pan or zoom the image, the aodrners are not clipped and are displayed outside the control that holds the <code>PanZoomImage</code>, like this:\n<img src=\"http://i.stack.imgur.com/m6ZxB.jpg\" alt=\"No clipping\"></p>\n\n<p>I tried several solutions:</p>\n\n<p>I tried setting <code>ClipToBounds=True</code> for the border, the canvas and the image.</p>\n\n<p>I tried setting <code>ClipToBounds=True</code> for the <code>AdornerLayer</code> and for each Adorner individually.</p>\n\n<p>I tried setting a Clip Geometry in Adorner's OnRender.</p>\n\n<p>I also noticed there's a <code>IsClipEnabled</code> property to Adorner but when I tried setting it to true, I kept getting a NullReferenceException (even though the Adorner was definitely not null)...</p>\n\n<p>Thanks!</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13114969,"title":"wpf \"emailto\" - with attachments","body":"<p>I am developing a WPF app in MVVM presentation pattern. I have a grid and I am trying to have an \"emailto\" hyperlink and when the user clicks that i am trying to export all the data to an excel and open the default email client with a draft new message window(email client could be Lotus/Outlook) and attach the excel as an attachment to the mail. I am able to define a \"Mailto\" hyperlink and when i click that i am able to open the draft message email window. But i am not sure how to send the excel as an attachment. Any help is greatly appreciated.</p>\n"},{"tags":["c#","wpf","events","mvvm","usercontrols"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":13114746,"title":"Bubbling Events from UserControl using MVVM in WPF..?","body":"<p>First of all, I want to let everyone know that I'm very new to the MVVM concept, and have looked pretty extensively for some explanation of what I want to do, but to no avail.</p>\n\n<p>In the program I'm working on, I have a UserControl with a few buttons on it, which need to control the navigation of the main window. I have 3 different \"pages\" I want to be able to switch between in my main window. Instead of pages, I decided (for whatever reason, correct me if this is not the best approach) to use a UserControl for each page, and switch the visibility to the correct one. I need the data to persist while switching, so I don't believe that creating new instances of the Usercontrols will work.</p>\n\n<p>My question is: How can I bubble the events from my \"NavBarView\" to the main window in a way that will allow me to switch the visibility, but in a MVVM way? I know I may be completely going about this the wrong way, and I'm happy to take any suggestions on a better way of achieving this navigation. </p>\n\n<p>I have to use WPF, so WinForms is not an option. Too much transparency and custom controls for WinForms.</p>\n"},{"tags":["wpf","events","textbox","textinput"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5265,"score":1,"question_id":1374710,"title":"WPF: Textbox not firing onTextInput event","body":"<p>So basically, I have a bunch of TextBoxes that the user gets to fill out. I've got a button that I want to keep disabled until all the TextBoxes have had text entered in them. Here is a sample XAML TextBox that I'm using:</p>\n\n<pre><code>&lt;TextBox Name=\"DelayedRecallScore\" TextInput=\"CheckTextBoxFilled\" Width=\"24\" /&gt;\n</code></pre>\n\n<p>And here is the function that I'm trying to trigger:</p>\n\n<pre><code>  //Disables the OK button until all score textboxes have content\n    private void CheckTextBoxFilled(object sender, RoutedEventArgs e)\n    {\n        /*\n        foreach (TextBox scorebox in TextBoxList)\n        {\n            if (string.IsNullOrEmpty(scorebox.Text))\n            {\n                Ok_Button.IsEnabled = false;\n                return;\n            }\n        }\n        Ok_Button.IsEnabled = true;\n         */\n        MessageBox.Show(\"THIS MAKES NO SENSE\");\n    }\n</code></pre>\n\n<p>The MessageBox is not showing up when TextInput should be getting triggered. As an experiment I tried triggering CheckTextBoxFilled() on PreviewTextInput, and it worked fine then, meaning that for whatever reason, the function just isn't getting called. I also have a validation function that is triggered by PreviewTextInput, which works as it should. At first I thought PreviewTextInput might somehow be interfering with TextInput, so I took PreviewTextInput off the TextBox, but that hasn't managed to fix anything.  I'm completely befuddled by why this might happen, so any help would be appreciated. </p>\n"},{"tags":["c#",".net","wpf","flash","air"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13113934,"title":"A way to combine Adobe AIR with .NET?","body":"<p>I was wondering if there is a possibility to combine an AIR application with a WinForms Application?</p>\n\n<p><strong>Example</strong></p>\n\n<p>I've made some nice animated loading screens / splash screens with <a href=\"http://www.adobe.com/products/air.html\" rel=\"nofollow\">Adobe AIR</a> and i want to use them with an .NET program, is that possible?</p>\n\n<p>I don't want to simply call the program executable file (<code>program.exe</code>) within Adobe AIR (<code>Air.exe</code>). I want to use the textfields inside air, and as I click on Submit, I want AIR to pass the information to the .NET <code>C#</code> form and do stuff with that.</p>\n\n<p>What is the proper way to do so, or what are alternative ways? (using <code>WPF</code> to embed a flash (<code>SWF</code>) inside <code>.NET</code>)</p>\n"},{"tags":["wpf","webcam","expression-encoder-sdk","windowsformhost"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13115270,"title":"Expression Encoder PreviewWindow Overlay in WPF?","body":"<p>I've made a simple Webcam capture application using Expression Encoder SDK in WPF. I'm trying to make a visual overlay (camera crosshairs) to the webcam feed. The problem is that, by using the WinFormHost in WPF, it seems to render itself over all WPF elements no matter how I arrange the order or the Z-index. It also does not abide to the opacity animation I have created for its container, forcing me to set its visibility every time the storyboard is triggered. Is there a work around for this? Or is there a way to render the webcam feed from the SDK to a WPF element and not use the WinFormHost altogether?</p>\n\n<p>My current code for rendering:</p>\n\n<pre><code> job = new LiveJob();\n\n deviceSource = job.AddDeviceSource(videoDevice, audioDevice);\n deviceSource.PreviewWindow = new PreviewWindow(new HandleRef(webcamPanel, webcamPanel.Handle));\n\n job.ActivateSource(deviceSource);\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code> &lt;WindowsFormsHost Margin=\"0,0,0,0\" Name=\"WinFormHost\" Background=\"Transparent\"&gt;\n    &lt;wf:Panel x:Name=\"webcamPanel\" Size=\"320,240\" /&gt;\n &lt;/WindowsFormsHost&gt;\n</code></pre>\n"},{"tags":["wpf","html5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13114891,"title":"Convert WPF Paths with Rotation and Scaling Transformations to HTML 5","body":"<p>I have a WPF drawing application that uses nothing but Paths for the graphics. No embedded images or freehand drawing.</p>\n\n<p>Given what little I know of HTML5 canvases I believe should be able to iterate through all the paths and generate the same drawing in HTML5. There are scaling and rotation transformations involved. I'm curious if anyone has done this and would like to share their code on the subject.</p>\n"},{"tags":["wpf","mediaelement","appcrash"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13114761,"title":"Media Player Solution","body":"<p>We need to develop an application, which can play six videos concurrently.\nwe develop a test project first.\nWith \nOS : Windows 7 64bit\nPlatform : .net framework 4.0\nLanguage : C#\nApplication Type : WPF\nCPU:i5-3450 3.10GHz\nRAM: 16GB</p>\n\n<p>This is a pretty simple project. Loop a fixed folder and random pick a video file then play using MediaElement.\nThis application will run without any problem, but two or three hours later it will crash with exception:\nAppCrash Module:KERNELBASE.dll\nbut unable to catch any exception, just crash.</p>\n\n<p>Is there anyone with the same problem ?\nAny solution ?</p>\n\n<p>if Test project is required pls let me know. Thanks</p>\n"},{"tags":["wpf","xaml","treeview","popup"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1561,"score":2,"question_id":1245728,"title":"WPF issue with TreeView and Popup controls","body":"<p>When using a Popup inside a TreeView in WPF I am running into an issue where the controls inside the popup become unusable. For example, using the following code the ToggleButton inside the popup can only be toggled once and then becomes unable to be toggled back. Is there any way to work around this issue?</p>\n\n<pre><code>&lt;Page xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n    &lt;Grid&gt;\n        &lt;TreeView&gt;\n            &lt;TreeViewItem&gt;\n                &lt;TreeViewItem.Header&gt;\n                    &lt;StackPanel&gt;\n                        &lt;ToggleButton&gt;\n                            Button outside popup\n                        &lt;/ToggleButton&gt;\n                        &lt;Popup IsOpen=\"True\"&gt;\n                            &lt;ToggleButton&gt;\n                                Button inside popup\n                            &lt;/ToggleButton&gt;\n                        &lt;/Popup&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/TreeViewItem.Header&gt;\n            &lt;/TreeViewItem&gt;\n        &lt;/TreeView&gt;\n    &lt;/Grid&gt;   \n&lt;/Page&gt;\n</code></pre>\n"},{"tags":["wpf","control","visibility"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13114136,"title":"WPF Control visibility dependent on config","body":"<p>I would like to build an app that will be used by different operators at different events. There are about 5 different events this app will be used. Not all the controls (buttons mainly but also textboxes, checkboxes etc) are needed for every use. So as not to confuse the operator at event \"C\" that only uses only a subset of the controls that are used at event \"A\", I would like a way to make any controls that aren't used in all events to be visible based on what event is set in the main applications config.</p>\n\n<p>I'm not sure whether having the Visible property bound to a converter that somehow? gets the current setting in the config or whether I should have some code behind that works it out.</p>\n\n<p>Ideally, I think if I could make a property and some code behind and inherit any controls that need this functionality from it, then it could be pretty much \"automatic\".</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13112288,"title":"CustomControl Property unable to set via dependency property","body":"<p>I have created custom control which contains combo box to display colors and one dependency property <code>SelectedIndex</code>. I have used this control in <code>mainwimdow.xaml</code> page and tried to set selected index value via dependency property declared in  <code>mainwimdow.xaml.cs</code> page. </p>\n\n<p>But when I set any value via dependency property it doesn't work and if I set custom controls property directly in <code>mainwimdow.xaml</code> page it works fine. So this means custom control is working fine only value is not setting via dependency property.</p>\n\n<p>Here is the code.</p>\n\n<p><code>MainWindow.xaml.cs</code>:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public static readonly DependencyProperty ConditionsSelectedIndexProperty = \n        DependencyProperty.Register(\n           \"ConditionsSelectedIndex\", \n           typeof(int), \n           typeof(MainWindow), \n           new UIPropertyMetadata(3));\n\n    public int ConditionsSelectedIndex\n    {\n        get { return (int)GetValue(ConditionsSelectedIndexProperty); }\n        set { SetValue(ConditionsSelectedIndexProperty, value); }\n    }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        SetCurrentValue(ConditionsSelectedIndexProperty, 5);\n    }\n}\n</code></pre>\n\n<p><code>MainWindow.xaml</code>:</p>\n\n<pre><code>&lt;controls:ColorComboBoxControl x:Name=\"cmbConditions\" \n          SelectedIndex=\"{Binding ConditionsSelectedIndex}\" \n          Grid.Row=\"0\" Grid.Column=\"0\" /&gt;\n</code></pre>\n\n<p>Following code works fine if I assign hardcoded value like</p>\n\n<pre><code>&lt;controls:ColorComboBoxControl x:Name=\"cmbConditions\" \n         SelectedIndex=\"5\" Grid.Row=\"0\" Grid.Column=\"0\" /&gt;\n</code></pre>\n\n<p>If I tried this to check dependency property is working or not then it's work</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding Path=ConditionsSelectedIndex}\"\n           Grid.Column=\"1\" Height=\"25\" Margin=\"42,143,77,143\" &gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>So both custom control and dependency property are working fine if tested independently. But its not working when tried to set custom control property via another dependency property.</p>\n"},{"tags":["c#","wpf","image"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13112756,"title":"Relative Images to program in wpf","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/347614/wpf-image-resources\">WPF image resources</a>  </p>\n</blockquote>\n\n\n\n<p>I would like my program to work on multiple computers and currently i am using paths like:</p>\n\n<pre><code>Icon=\"F:\\\\Project\\Project 1.01\\kinectprogram\\Images\\Kinect.ico\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Source = \"C:\\Users\\user\\Image.jpg\"\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>Source = \"kinectprogram\\Images\\Kinect.ico\"\n</code></pre>\n\n<p>to locate the image no errors or warning appear and the image displays until the program is run. How do I get the image to display once the program runs.</p>\n\n<p>I'm using visual studio 2012</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13112557,"title":"Passing a parameter to ICommand","body":"<p>I have a simple button that uses a command when executed, this is all working fine but I would like to pass a text parameter when the button is clicked. </p>\n\n<p>I think my XAML is ok, but I'm unsure how to edit my <code>RelayCommand</code> class to receive a parameter:</p>\n\n<pre><code>&lt;Button x:Name=\"AddCommand\" Content=\"Add\" \n    Command=\"{Binding AddPhoneCommand}\"\n    CommandParameter=\"{Binding Text, ElementName=txtAddPhone}\" /&gt;\n</code></pre>\n\n<pre class=\"lang-c# prettyprint-override\"><code>public class RelayCommand : ICommand\n{\n    private readonly Action _handler;\n    private bool _isEnabled;\n\n    public RelayCommand(Action handler)\n    {\n        _handler = handler;\n    }\n\n    public bool IsEnabled\n    {\n        get { return _isEnabled; }\n        set\n        {\n            if (value != _isEnabled)\n            {\n                _isEnabled = value;\n                if (CanExecuteChanged != null)\n                {\n                    CanExecuteChanged(this, EventArgs.Empty);\n                }\n            }\n        }\n    }\n\n    public bool CanExecute(object parameter)\n    {\n        return IsEnabled;\n    }\n\n    public event EventHandler CanExecuteChanged;\n\n    public void Execute(object parameter)\n    {\n        _handler();\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","bug"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12982889,"title":"Cannot locate resource","body":"<p>I don't know exactly if it is a bug but i am getting all the time runtime IOException error saying Cannot locate resource.</p>\n\n<p>I am loading some images in my app (c#, WPF) in canvas background depends on database state.\nThe problem is, that i cannot load LAST (alphabeting sorted) file. I have for example 15 images in folder. I can load 14 first without problems. But the last one all the time throw exception.</p>\n\n<p>I am 100% sure, that i HAVE the image in the folder (see !image-printscreen below).\nAnd how i wrote. 14 first i can load without any problem, only the last one throw exception.</p>\n\n<p>Is it a bug in WPF-c# or am I doing something wrong?</p>\n\n<p>code what is throwing exception:</p>\n\n<pre><code>canvas_status.Background = new ImageBrush(new BitmapImage(new Uri(BaseUriHelper.GetBaseUri(this), @\"Images\\\" + statusName + \".png\")));\n\ncanvas_name.Background = new ImageBrush(new BitmapImage(new Uri(BaseUriHelper.GetBaseUri(this), @\"Images\\\" + statusName + bulheadName + \".png\")));\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>IOException was unhalded\nCannot locate resource 'view/images/panel_uzavreno_d.png'.\n</code></pre>\n\n<p>image (for higher resolution click on image right mouse button and click on SHOW IMAGE or something like that):</p>\n\n<p><img src=\"http://i.imgur.com/SuBWl.jpg\" alt=\"printscreen\"></p>\n"},{"tags":["c#","wpf","listbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13111358,"title":"WPF listbox empty item template not showing","body":"<p>I am try to list some data in WPF listbox control. It is the first time I am using DataTemplate in WPF. Everything is working fine except when there is no data it is not showing 'No items to display'. Below is my code.</p>\n\n<pre><code>    &lt;ListBox Name=\"itemsCtrl\" Background=\"#FFE5E5E5\" BorderBrush=\"{x:Null}\" SelectionChanged=\"itemsCtrl_SelectionChanged\" Style=\"{StaticResource ListStyle}\"&gt;\n\n        &lt;ListBox.Resources&gt;\n            &lt;!-- Set SelectedItem Background here --&gt;\n            &lt;SolidColorBrush x:Key=\"{x:Static SystemColors.HighlightBrushKey}\" Color=\"#C2C2C2\"/&gt;\n            &lt;Style TargetType=\"{x:Type ListBoxItem}\"&gt;\n                &lt;Style.Triggers&gt;\n                    &lt;DataTrigger Binding=\"{Binding IsMouseOver,\n                                    RelativeSource={RelativeSource\n                                      Self}}\"\n                        Value=\"True\"&gt;\n                        &lt;Setter Property=\"Background\"\n                         Value=\"#C2C2C2\" /&gt;\n                    &lt;/DataTrigger&gt;\n                &lt;/Style.Triggers&gt;\n            &lt;/Style&gt;\n            &lt;Style TargetType=\"ListBox\" x:Key=\"ListStyle\" BasedOn=\"{StaticResource {x:Type ListBox}}\"&gt;\n                &lt;Style.Triggers&gt;\n                    &lt;DataTrigger \n    Binding=\"{Binding RelativeSource={x:Static RelativeSource.Self}, Path=Items.Count}\" \n    Value=\"0\"\n    &gt;\n                        &lt;Setter Property=\"Template\"&gt;\n                            &lt;Setter.Value&gt;\n                                &lt;ControlTemplate&gt;\n                                    &lt;TextBlock&gt;No items to display&lt;/TextBlock&gt;\n                                &lt;/ControlTemplate&gt;\n                            &lt;/Setter.Value&gt;\n                        &lt;/Setter&gt;\n                    &lt;/DataTrigger&gt;\n                &lt;/Style.Triggers&gt;\n            &lt;/Style&gt;\n        &lt;/ListBox.Resources&gt;\n\n        &lt;ListBox.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;StackPanel Cursor=\"Hand\" Name=\"hoverDataTemplate\" Orientation=\"Horizontal\" Width=\"370\" VerticalAlignment=\"Top\" Height=\"40\" HorizontalAlignment=\"Left\" &gt;\n                    &lt;Label VerticalContentAlignment=\"Center\" HorizontalAlignment=\"Left\" Padding=\"15,5,5,5\" Width=\"330\"  Content=\"{Binding Path=EVENT_TITLE}\" FontSize=\"12\"/&gt;\n                    &lt;Image Height=\"28\" Source=\"/pr;component/Images/black_next.png\" Stretch=\"Fill\" Width=\"28\" /&gt;\n\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ListBox.ItemTemplate&gt;\n    &lt;/ListBox&gt;\n</code></pre>\n\n<p>And I am binding data source as shown below.</p>\n\n<pre><code>    itemsCtrl.ItemsSource = dao.SelectDataTable(cmd).DefaultView;\n</code></pre>\n\n<p>When I set the style property of ListBox as ListStyle it is throwing an error</p>\n\n<pre><code>'Provide value on 'System.Windows.StaticResourceExtension' threw an exception.' Line number '292' and line position '22'.\n</code></pre>\n\n<p>Can anybody point out how to make it correct?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["wpf","styles","themes","generic.xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":205,"score":0,"question_id":11149167,"title":"Styles from generic.xaml are not applied","body":"<p>I made a class library assembly in which I created custom controls, and I defined the default styles in the generic.xaml file.</p>\n\n<p>It seems this is a quite common problem, as long as many people are posting about it.\nHowever I couldn't find any useful answer for my case.</p>\n\n<ul>\n<li>the generic.xaml is in the Themes folder.</li>\n<li>the generix.xaml file Build Action is set to Page.</li>\n<li>the ThemeInfo is properly defined in my AssemblyInfo.cs.</li>\n</ul>\n\n<p>In my test application, if I manually merge the generic.xaml file from my custom controls assembly into the application App.xaml file like this:</p>\n\n<pre><code>&lt;Application.Resources&gt;\n  &lt;ResourceDictionary&gt;\n    &lt;ResourceDictionary.MergedDictionaries&gt;\n      &lt;ResourceDictionary Source=\"/MyControlsAssembly;component/Themes/generic.xaml\"/&gt;\n    &lt;/ResourceDictionary.MergedDictionaries&gt;\n  &lt;/ResourceDictionary&gt;\n&lt;/Application.Resources&gt;\n</code></pre>\n\n<p>then the custom controls are properly themed, but if I do not manually merge the generic.xaml, the controls appear with the default Windows theme.</p>\n\n<p>Could you please tell me what am I forgetting and/or doing wrong ?</p>\n\n<p>Additional info:</p>\n\n<ul>\n<li><p>My ThemeInfo assembly attribute is defined as follow:</p>\n\n<p><code>[assembly: ThemeInfo(ResourceDictionaryLocation.SourceAssembly, ResourceDictionaryLocation.SourceAssembly)]</code></p>\n\n<p>(Note: the result is just the same with any combination of parameters for the ThemeInfo attribute)</p></li>\n<li><p>There are two others .xaml files beside the generic.xaml file in the Themes folder.</p></li>\n<li>There is a subfolder in the Themes folder that itself contains another .xaml file.</li>\n</ul>\n"},{"tags":["c#",".net","wpf","xaml","properties"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2478,"score":3,"question_id":1553780,"title":"WPF: Cannot set properties on property elements weirdness","body":"<pre><code>private TextBlock _caption = new TextBlock();\n\npublic TextBlock Caption  \n{  \n    get { return _caption; }  \n    set { _caption = value; }  \n}\n\n&lt;l:CustomPanel&gt;  \n    &lt;l:CustomPanel.Caption Text=\"Caption text\" FontSize=\"18\" Foreground=\"White\" /&gt;  \n&lt;/l:CustomPanel&gt;\n</code></pre>\n\n<p>Gives me the following error:<br />\n<b>Cannot set properties on property elements.</b></p>\n\n<p>If I use:</p>\n\n<pre><code>&lt;l:CustomPanel&gt;  \n    &lt;l:CustomPanel.Caption&gt;\n        &lt;TextBlock Text=\"Caption text\" FontSize=\"18\" Foreground=\"White\" /&gt; \n    &lt;/l:CustomPanel.Caption&gt;\n&lt;/l:CustomPanel&gt;\n</code></pre>\n\n<p>My TextBlock shows up fine but it's nested inside another TextBlock like so, it even seems to add itself outside of the Caption property:<br /></p>\n\n<pre><code>&lt;l:CustomPanel&gt;  \n    &lt;l:CustomPanel.Caption&gt;\n        &lt;TextBlock&gt;\n             &lt;InlineUIContainer&gt;\n                 &lt;TextBlock Text=\"Caption text\" FontSize=\"18\" Foreground=\"White\" /&gt; \n             &lt;/InlineUIContainer&gt;\n        &lt;/TextBlock&gt;\n    &lt;/l:CustomPanel.Caption&gt;\n\n    &lt;TextBlock&gt;\n         &lt;InlineUIContainer&gt;\n             &lt;TextBlock Text=\"Caption text\" FontSize=\"18\" Foreground=\"White\" /&gt; \n         &lt;/InlineUIContainer&gt;\n    &lt;/TextBlock&gt;\n&lt;/l:CustomPanel&gt;\n</code></pre>\n\n<p>As you might have already guessed, what i'd like my code to do is to set my Caption property from XAML on a custom panel, if this is possible.</p>\n\n<p>I've also tried the same code with a DependencyProperty to no avail.</p>\n\n<p>So, anyone that can help me with this problem?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":275,"score":0,"question_id":9457651,"title":"How do you open a new window in C#","body":"<p>I am creating a Kinect application and want to open a new window called 'Help' from the 'MainWindow.xaml.cs' file.</p>\n\n<p>I tried using the following code: </p>\n\n<pre><code>// The commented code is what I have tried.\npublic static void ThreadProc()\n{\n     // Window Help = new Window();\n     //Application.Run(new Window(Help);    \n\n     Application.Run(new Form()); \n}\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n\n    System.Threading.Thread t = new System.Threading.Thread(new System.Threading.ThreadStart(ThreadProc));\n\n    t.Start();\n}\n</code></pre>\n"},{"tags":["c#",".net","wpf","scrollbar","textblock"],"answer_count":3,"favorite_count":6,"up_vote_count":42,"down_vote_count":0,"view_count":32905,"score":42,"question_id":1192335,"title":"Automatic vertical scroll bar in WPF TextBlock?","body":"<p>I have a <code>TextBlock</code> in WPF. I write many lines to it, far exceeding its vertical height. I expected a vertical scroll bar to appear automatically when that happens, but it didn't. I tried to look for a scroll bar property in the Properties pane, but could not find one.</p>\n\n<p>How can I make vertical scroll bar created automatically for my <code>TextBlock</code> once its contents exceed its height?</p>\n\n<p>Clarification: I would rather do it from the designer and not by directly writing to the XAML.</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13098423,"title":"Building a wpf graph. What is the recommended approach for creating a canvas dot","body":"<p>I am trying to build my own graph control using wpf (c#).<br/>\nI am using a canvas.\nThe question is very basic, How should I draw a point on the graph (Canvas):</p>\n\n<ol>\n<li>as a single dot.</li>\n<li>as a circle with a radius of 1.</li>\n<li>as a rectangle with a length of 1.</li>\n<li>another method</li>\n</ol>\n\n<p>What is the recommended approach and why ?\nThanks.</p>\n"},{"tags":[".net","wpf","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":412,"score":0,"question_id":10512629,"title":"Dependency property error","body":"<p>I am learning dependency properties. I read many posts &amp; books but still I am not clear. </p>\n\n<p>The program shown below is which I wrote to learn. Some error in that, please help in resolving. I have questions.</p>\n\n<ol>\n<li>The main use of custom Dependency property element is for the notification of change?</li>\n<li>I found an 'IsDefaultProperty' code for <strong>Button</strong> in a WPF text book. It means '<strong>IsDefault</strong>' property is a dependency property?</li>\n<li>Why they shown that code? It means, internally, in Button class, its defined like that? \n(They showed internal code?) or they showed how to define as custom?</li>\n</ol>\n\n<p>Here is my code:</p>\n\n<pre><code>namespace DependencyProperties\n{\n    public class Contact\n    {\n        private int id=100;\n        private string name=\"shri\";\n        public static readonly DependencyProperty IsPresentProperty;\n\n        public int ID\n        {\n            get { return id; }\n        }\n        public string NAME\n        {\n            get { return name; }\n        }\n\n        static Contact()\n        {\n            IsPresentProperty = DependencyProperty.Register(\"IsPresent\", typeof(bool),typeof(Contact),new FrameworkPropertyMetadata(false,new PropertyChangedCallback(OnIsPresentChanged)));\n        }\n\n        public bool Present\n        {\n            get { return (bool)GetValue(Contact.IsPresentProperty); }\n            set { SetValue(Contact.IsPresentProperty, value); }\n        }\n\n        private static void OnIsPresentChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)\n        {  \n\n        }\n    }\n}\n</code></pre>\n\n<p>And I see the error:</p>\n\n<pre><code>&gt; Error: GetValue and SetValue does not exist in the current context\n</code></pre>\n"},{"tags":["c#",".net","wpf","control"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":329,"score":2,"question_id":7185163,"title":"High performance plot control in WPF","body":"<p>I am doing some work for which I need to develop a control, it should be a simple graph that shows several points and two edges.</p>\n\n<p>My problem is that I need to show up to 16k points, with an update rate of 30 Hz. Has anyone done something similar?, and has any advice?.</p>\n\n<p>For example whether to inherit from FrameworkElement or Control (ItemsControl in this case). If the control inherits from FrameworkElememt it may have a better performance drawing the points in the OnRender method but I would miss the Templating feature that comes from inheriting from Control.</p>\n\n<p>Or does there exist another control that can do this out there?</p>\n\n<p>Thanks in advance for your time.</p>\n"},{"tags":[".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":9154939,"title":"Updating UI with messages from thread","body":"<p>I think this might have been asked before, but I'm probably too stupid to understand the answers that were given so I need to ask again.</p>\n\n<p>I have a class which performs calculations on some data. During calculation I would like to output error notifications from data checks, status updates and the data line to the UI. I would like to do this in real time. The problem I am having when calling this from within the main application is that the UI (in WPF) freezes until all calculations are complete and then all messages are displayed in one go. That is problematic for calculations which take 20 to 30 seconds to finish.</p>\n\n<p>So I am trying to use threading. This is pretty much my first attempt at this stuff. I am doing something like:</p>\n\n<pre><code>private void btnStartCalculations_Click(object sender, RoutedEventArgs e)\n{\n        //initialise parameters for run\n        calculator = new Calculator(...);\n        //Subscribe to calculator events for update\n        kasenCalculator.OnStatusUpdate += new Calculator.UpdateEventHandler(calculator_OnStatusUpdate);\n        //kasenCalculator.OnErrorLogUpdate += new Calculator.ErrorLogUpdateEventhandler(calculator_OnErrorLogUpdate);\n        //kasenCalculator.OnDataReadUpdate += new Calculator.DataReadUpdateEventHandler(calculator_OnDataReadUpdate);\n\n        //Run\n        Thread thread = new Thread(calculator.Run);\n        thread.Start();\n}\n\nprivate void calculator_OnStatusUpdate(object sender, string Message)\n{\n        Dispatcher.Invoke(DispatcherPriority.Normal, new Action&lt;string&gt;(UpdateStatusWindow), Message);\n}\n\nprivate void calculator_OnDataReadUpdate(object sender, string Message)\n{\n        Dispatcher.Invoke(DispatcherPriority.Normal, new Action&lt;string&gt;(UpdateOriginalDataWindow), Message);\n}\n\nprivate void calculator_OnErrorLogUpdate(object sender, string Message)\n{\n        Dispatcher.Invoke(DispatcherPriority.Normal, new Action&lt;string&gt;(UpdateErrorLog), Message);\n}\n\nprivate void UpdateStatusWindow(string Message)\n{\n        TextBox statusWindow = this.txtStatus;\n\n        //Add status text\n        statusWindow.Text += Message + \"\\r\\n\";\n        //Scroll to bottom of window\n        statusWindow.CaretIndex = statusWindow.Text.Length;\n        statusWindow.ScrollToEnd();\n}\n\nprivate void UpdateOriginalDataWindow(string Message)\n{\n        this.txtOriginalData.Text += Message;\n}\n\nprivate void UpdateErrorLog(string Message)\n{\n        this.txtErrors.Text += Message + \"\\r\\n\";\n}\n</code></pre>\n\n<p>Which sort of works in that the UI <strong>is</strong> getting updated, but it is still not very responsive. I was wondering if I should use <code>BeginInvoke</code> instead of <code>Invoke</code>, but that just keeps all the updates back until the calculations have finished running and I might as well have execute in the main thread.</p>\n\n<p>Also, even though this is running, it is actually running a lot slower than I expected.</p>\n\n<p>Is this the right way to go about doing what I am trying to do?　If not, what is the correct way?</p>\n"},{"tags":["c#",".net","wpf","exception","exception-handling"],"answer_count":5,"favorite_count":22,"up_vote_count":54,"down_vote_count":0,"view_count":19156,"score":54,"question_id":1472498,"title":"WPF global exception handler","body":"<p>sometimes, under not reproducible circumstances, my WPF application crashes without any message. The application simply close instantly.</p>\n\n<p>Where is the best place to implement the global Try/Catch block. At least i have to implement a messagebox with: \"Sorry for the inconvenience ...\" </p>\n\n<p>Any help would be most welcome, thank you.</p>\n"},{"tags":[".net","wpf","asp.net-mvc","web-applications","xbap"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":155,"score":2,"question_id":12770054,"title":"WPF (XBAP) vs ASP.NET MVC on Intranet?","body":"<p>I need to make an application that will be used within an organization. They need it to be available on their network. I have considered two options ASP.NET MVC and WPF (web). </p>\n\n<p>WPF Web Browser applications can be accessed on IE and Firefox.</p>\n\n<p>What are the pros and cons of using ASP.NET MVC and WPF over the Intranet ? </p>\n\n<p>Should I go with ASP.NET MVC or WPF ?</p>\n"},{"tags":["c#",".net","wpf","tabcontrol","tabitem"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":409,"score":1,"question_id":9667052,"title":"TabControl Saving on selected tab item changed","body":"<p>I need to save data in distinct <code>TabItem</code> every time when user switches to another tabitem. </p>\n\n<p>I try to operate <code>TabControl.SelectionChanged</code> event, but there is no info about previously selected tab item. </p>\n\n<p>So, how to get moment when user switches from my TabItem to another?  </p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13110447,"title":"How to enlarge a label as the container is enlarged","body":"<p>I've got a custom UserControl in WPF, which has a stack panel docked to the top to replace the title bar functionality.</p>\n\n<p>The left part of the stack panel has a label, which contains a textblock for text wrapping in cases where the label would contain a long string.</p>\n\n<p>My problem arises when dragging the control.  I would naturally like the label's text to display more and more as the window is dragged. </p>\n\n<p>I would like the label to enlarge as the window is enlarged, but I am not sure how to approach this.</p>\n\n<p>This is the code I've written to achieve the titlebar in the screenshots:</p>\n\n<pre><code>&lt;Grid&gt;\n        &lt;DockPanel&gt;\n            &lt;StackPanel Name=\"titleBar\" DockPanel.Dock=\"Top\" Height=\"28\" FlowDirection=\"RightToLeft\" Orientation=\"Horizontal\" Background=\"AliceBlue\"&gt;\n                &lt;Button x:Name=\"btnClose\" Margin=\"0,0,5,0\" Click=\"btnClose_Click\"&gt;                  \n                &lt;/Button&gt;\n                &lt;Button x:Name=\"btnRunQuery\" ToolTip=\"Run Query\"&gt;                   \n                &lt;/Button&gt;\n                &lt;Button x:Name=\"btnFilter\" ToolTip=\"Toggle Filter\" Click=\"btnFilter_Click\"&gt;                    \n                &lt;/Button&gt;\n                &lt;Button x:Name=\"btnAttributes\"&gt;      \n                &lt;/Button&gt;\n                &lt;Button x:Name=\"btnAll\" Click=\"btnAll_Click\"&gt;ALL&lt;/Button&gt;\n                &lt;Label Name=\"lblTableName\" FontSize=\"14\" MaxWidth=\"150\"&gt;\n                    &lt;TextBlock Name=\"tbTableName\" TextTrimming=\"WordEllipsis\" TextWrapping=\"NoWrap\" FlowDirection=\"LeftToRight\"/&gt;\n                &lt;/Label&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DockPanel&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p><strong>EDIT:</strong> I'd also like to add that when the user control is rendered, I do not want the label's width to be more than 150. Hence the <code>MaxWidth=\"150\"</code> property.  However, I want the label to grow as the window is enlarged. </p>\n"},{"tags":["wpf","vb.net","image"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13110074,"title":"Way to use WPF Image without attaching image at runtime","body":"<p>I know how to attach an image to a XAML <code>&lt;Image&gt;</code> via VB.net runtime code. How would I do this the normal old way. (Attach the image within the IDE without using any code)</p>\n\n<p>Before WPF one would browse for the image (in the Visual Studio IDE) it would somehow place it in the project and it would work.</p>\n\n<p>Now I do this same thing, I can see the image in my Visual Studio IDE but during runtime the image appears blank.</p>\n\n<p>How would I use the VS IDE to correctly browse for the image so it will display at runtime? Perhaps im doing something wrong a bit of help or any guidance would be awesome</p>\n"},{"tags":["c#","wpf","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13103261,"title":"How can I pass a variable into a WPF Binding?","body":"<p>I'm writing a WPF application that displays the status of a certain time-consuming task.</p>\n\n<p>I have a TextBlock bound to the task's start time, and I have another TextBlock that is intended to display the amount of time spent on said task.</p>\n\n<p>Using simple binding with a converter, I was able to get the second TextBlock to display the TimeSpan properly, but I'm not too crazy about this solution. I would like for the second TextBlock to update the TimeSpan as time continues.</p>\n\n<p>For example, when the user loads the application, the second TextBlock would say \"5 minutes\", but 15 minutes later, it would still say \"5 minutes\", which is misleading.</p>\n\n<p>I was able to find this solution ( <a href=\"http://stackoverflow.com/questions/3354793/binding-to-datetime-now-update-the-value\">Binding to DateTime.Now. Update the value</a> ), which is painfully close to what I want, but not quite there.</p>\n\n<p>Is there any way I can pass the task's start time to this Ticker class and have the text update itself?</p>\n\n<p>EDIT: Here's what I have so far:<br>\nC#:<br>\n    public class Ticker : INotifyPropertyChanged\n    {\n        public static DateTime StartTime { get; set; }</p>\n\n<pre><code>    public Ticker()\n    {\n        Timer timer = new Timer();\n        timer.Interval = 1000;\n        timer.Elapsed += timer_Elapsed;\n        timer.Start();\n    }\n\n    public string TimeDifference\n    {\n        get\n        {\n            string timetaken = \"\";\n            try\n            {\n                TimeSpan ts = DateTime.Now - StartTime;\n                timetaken = (StartTime == default(DateTime)) ? \"StartTime not set!\" : ((ts.Days * 24) + ts.Hours).ToString(\"N0\") + \" hours, \" + ts.Minutes + \" minutes, \" + ts.Seconds + \" seconds\";\n            }\n            catch (Exception) { }\n\n            return timetaken;\n        }\n    }\n\n    private void timer_Elapsed(object sender, ElapsedEventArgs e)\n    {\n        if (PropertyChanged != null)\n            PropertyChanged(this, new PropertyChangedEventArgs(\"TimeDifference\"));\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n}\n</code></pre>\n\n<p>XAML:<br>\n<code>&lt;StackPanel Grid.Row=\"2\" Grid.Column=\"0\" Orientation=\"Horizontal\"&gt;<br>\n        &lt;TextBlock Text=\"Dataset started on:\"/&gt;<br>\n        &lt;TextBlock Name=\"starttimeLabel\" Text=\"10/23/2012 4:42:26 PM\"/&gt;<br>\n    &lt;/StackPanel&gt;<br>\n    &lt;StackPanel Grid.Row=\"2\" Grid.Column=\"1\" Orientation=\"Horizontal\"&gt;<br>\n        &lt;TextBlock Text=\"Time taken:\"/&gt;<br>\n        &lt;TextBlock Name=\"timespanLabel\" Text=\"{Binding Source={StaticResource ticker}, Path=TimeDifference, Mode=OneWay}\"/&gt;<br>\n    &lt;/StackPanel&gt;</code>  </p>\n\n<p>Lastly, in my StatusPanel's Loaded event, I have the following:<br>\nTicker.StartTime = Convert.ToDateTime(starttimeLabel.Text);</p>\n\n<p>I apologize for the atrocious formatting, but I tried following the instructions to no avail (insert 4 spaces for code blocks, then tried using <code>&lt;code&gt;&lt;/code&gt;</code>, etc.)</p>\n"},{"tags":["c#","wpf","windows-phone"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":269,"score":1,"question_id":12998739,"title":"How to check if DateTime.Now is between two given DateTimes for time part only?","body":"<p>For my app I need to know if <code>Now()</code> is between two values.</p>\n\n<p>The user can set a start- and an end-time so he will not disturbed by a notification (during the night for example).</p>\n\n<p>So if have got two <code>TimePicker</code>s (start- and end-time) that the user can set.</p>\n\n<p>Lets say the user sets <code>22:00</code> for the <code>StartTime</code> and <code>07:00</code> for the <code>EndTime</code> (this would cover the night).</p>\n\n<p>How can I check if the <code>DateTime.Now</code> is between the selected Start and End time?</p>\n\n<p><strong>EDIT:</strong>\nI only want this to work with the Hour and minutes part. So if the user sets the Start and End time this should work for every night.</p>\n"},{"tags":["wpf","xaml","ribbon","ribbon-control","visualtreehelper"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":542,"score":4,"question_id":4249502,"title":"WPF RibbonComboBox Height","body":"<p>Ok, I would have thought this was a simple question, but apparently it's got me confused.</p>\n\n<p>When I try to set the height of my RibbonComboBox, it's not moving actual size of it, just the box that surrounds it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/iAZDJ.jpg\" alt=\"alt text\"></p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;ribbon:RibbonComboBox                                                           \n    DisplayMemberPath=\"CompanyCode\" \n    Height=\"22\" \n    Margin=\"0,0,0,-30\" \n    VerticalAlignment=\"Bottom\" \n    Width=\"102\"&gt;\n  &lt;ribbon:RibbonGallery SelectedValue=\"{Binding Path=Companies.SelectedItem,\n                                                ValidatesOnDataErrors=true,\n                                                NotifyOnValidationError=true }\"&gt;\n    &lt;ribbon:RibbonGalleryCategory ItemsSource=\"{Binding Path=Companies.Items, \n                                                        NotifyOnValidationError=true, \n                                                        ValidatesOnDataErrors=true}\" /&gt;\n  &lt;/ribbon:RibbonGallery&gt;\n&lt;/ribbon:RibbonComboBox&gt;\n</code></pre>\n\n<p>I can change the height to 200 or 1 but the height never changes.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks,\nEroc</p>\n"},{"tags":["c#","wpf","events","delegates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13107914,"title":"Event call on TextBox lostFocus within a list view","body":"<p>I have a ListView bind to List, one of the column of the listview has cellTemplate with dataTemplate containing a textBox. i want an event to be called when the textBox loses Focus, it compares the text box's previous value and new value (if User has changed<img src=\"http://i.stack.imgur.com/mLMqu.png\" alt=\"enter image description here\">), if the new value is greator, it shows a warning,</p>\n"},{"tags":["wpf","silverlight"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13108283,"title":"Create wpf resource key from string","body":"<p>I have application where customer can create styles for some controls.</p>\n\n<p>Customer can enter any text as key.</p>\n\n<p>I need to remove or change in text all not allowed characters by '_' symbol.</p>\n\n<p>But i am not sure how to do it better. </p>\n\n<p>Should i create list of not allowed chars or any better way to create wpf resource key from any string? Maybe some existing encode methods already can be used? </p>\n"},{"tags":["c#","wpf","printing","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":476,"score":0,"question_id":6752557,"title":"WPF Webbrowser print after chaning settings and without user interaction","body":"<p>I have an application that prints to a label printer from a WebBrowser control. The idea being that when we print the HTML document gets printed according to various settings like paper size and orientation. Ever thing works fine when i do this:</p>\n\n<pre><code>public Boolean DrawHTML(String HTML)\n{\n  try\n  {\n    // Load HTML document as a string\n    //using (StringReader reader = new StringReader(HTML))\n    using (StreamReader reader = new StreamReader(HTML))\n    {\n      // Navigate to HTML document string\n      Web_Document.Navigate(reader.ReadToEnd());\n    }\n    return true;\n  }\n  catch (Exception ex)\n  {\n    MessageBox.Show(ex.Message + \":\\nFile:\\n\\n\" + HTML);\n    return false;\n  }\n}\n\npublic Boolean Print(String PrinterName, String PrintJobName, Boolean IsLandscape, int LabelCount,double LabelWidth, double LabelHeight)\n{\n  try\n  {\n    PrintQueueCollection _Printers = new PrintServer().GetPrintQueues(new[] {\n    EnumeratedPrintQueueTypes.Local, EnumeratedPrintQueueTypes.Connections});\n\n    foreach (PrintQueue Q in _Printers)\n    {\n      if (Q.FullName == PrinterName)\n      {\n        Q.UserPrintTicket.CopyCount = LabelCount;\n\n        if (IsLandscape)\n        {\n          Q.UserPrintTicket.PageOrientation = PageOrientation.Landscape;\n        }\n        else\n        {\n          Q.UserPrintTicket.PageOrientation = PageOrientation.Portrait;\n        }\n\n        Q.UserPrintTicket.PageBorderless = PageBorderless.Borderless;\n\n        double W = ((LabelWidth / 25.4) * 96);\n        double H = ((LabelHeight / 25.4) * 96);\n\n        Q.UserPrintTicket.PageMediaSize = new PageMediaSize(PageMediaSizeName.Unknown, W, H);\n\n        var writer = PrintQueue.CreateXpsDocumentWriter(Q);\n        writer.Write(Web_Document, Q.UserPrintTicket);\n\n\n\n        return true;\n      }\n    }\n    //Printer Not Found\n    return false;\n  }\n  catch (Exception)\n  {\n    //problem occured\n    return false;\n  }\n}   \n\n#endregion\n</code></pre>\n\n<p>}</p>\n\n<p>Everything works EXCEPT for 3 problems.</p>\n\n<ol>\n<li><p>If the HTML body does not contain scroll =\"no\" scroll bars will appear, which is fine, but the also print, which is not fine.</p></li>\n<li><p>The printing is REALLY bad. very blurry.  I think this happens when creating the visual.</p></li>\n<li><p>If the hosting frame is smaller than the html content this will ONLY print the visible content. I want to print the entire content.</p></li>\n</ol>\n\n<p>Any advice on how i can accomplish this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","margin"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13106272,"title":"Why can I not change the Margin?","body":"<p><img src=\"http://i.stack.imgur.com/FVwtk.png\" alt=\"enter image description here\">\nOn the top it says, \"Gets or <strong>sets</strong>...\", so then why is it not letting me change it?</p>\n"},{"tags":["c#",".net","wpf","dependency-properties","propertychanged"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1915,"score":2,"question_id":5795770,"title":"WPF: PropertyChangedCallback triggered only once","body":"<p>I have a user control, which exposes a DependencyProperty called VisibileItems\nEvery time that property gets updated, i need to trigger another event. \nTo achieve that, i added a FrameworkPropertyMetadata with PropertyChangedCallback event. </p>\n\n<p>For some reason, this event gets called only once, and doesn't trigger the next time VisibleItems is changed. </p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;cc:MyFilterList VisibleItems=\"{Binding CurrentTables}\"  /&gt;\n</code></pre>\n\n<p>CurrentTables is a DependencyProperty on MyViewModel. CurrentTables gets changed often. I can bind another WPF control to CurrentTables, and i see the changes in the UI. </p>\n\n<p>Here is the way i wired VisibleItems with PropertyChangedCallback </p>\n\n<pre><code>public static readonly DependencyProperty VisibleItemsProperty =\n    DependencyProperty.Register(\n    \"VisibleItems\",\n    typeof(IList),\n    typeof(MyFilterList),\n    new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender, new PropertyChangedCallback(VisiblePropertyChanged))\n\n    );\n\npublic IList VisibleItems {\n    get { return (IList)GetValue(VisibleItemsProperty); }\n    set { SetValue(VisibleItemsProperty, value); }\n}\n</code></pre>\n\n<p>by stepping into VisiblePropertyChanged, i can see that it gets triggered the first time CurrentTables gets set. but not subsequent times. </p>\n\n<p>UPDATE</p>\n\n<p>as some of you questioned the way CurrentTables is modified, it is re-assigned completely on change: </p>\n\n<pre><code>OnDBChange()...\nCurrentTables = new List&lt;string&gt;(MainDatabaseDataAdapter.GetTables(this.SelectedServer, this.SelectedDatabase));\n</code></pre>\n\n<p>this line gets called on every change, but my VisiblePropertyChanged handler gets called only the first time. </p>\n\n<p>UPDATE</p>\n\n<p>if i assign VisibleItems directly, the handler does get called every time! </p>\n\n<pre><code>TestFilterList.VisibleItems = new List&lt;string&gt;( Enumerable.Range(1, DateTime.Now.Second).ToList().Select(s =&gt; s.ToString()).ToList() );\n</code></pre>\n\n<p>So, it looks like the problem stems from the DependencyProperty (VisibleItems) watching another DependencyProperty (CurrentTables). Somehow the binding works on first property change, but not on subsequent ones?\nAttempting to inspect this issue with snoop as some of you suggested. </p>\n"},{"tags":[".net","wpf","c#-4.0","clickonce","voip"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":617,"score":1,"question_id":5101383,"title":"Does anyone know a good .Net VoIP library?","body":"<p>I have been searching for ages now for a good .Net based VoIP library.\nAfter having tried conaito and SIP.Net, I have still haven't found anything that truly fits my needs.</p>\n\n<p>Basically all of these are constructed using ActiveX. Unfortunately ActiveX and WPF don't play well together. And ClickOnce Deployment doesn't register Interop COM components.</p>\n\n<p>I need to find a good and pure .Net managed code implementation.</p>\n"},{"tags":["wpf","custom-controls","items"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13107573,"title":"Items in CustomControl Wpf","body":"<p><strong>i have a customcontrol</strong></p>\n\n<hr>\n\n<pre><code>    static CustomControl1()\n    {\n        DefaultStyleKeyProperty.OverrideMetadata(typeof(CustomControl1), new     FrameworkPropertyMetadata(typeof(CustomControl1)));\n    }\n\n    public List&lt;string&gt; MyProperty\n    {\n        get { return (List&lt;string&gt;)GetValue(MyPropertyProperty); }\n        set { SetValue(MyPropertyProperty, value); }\n    }\n    public static readonly DependencyProperty MyPropertyProperty =\n        DependencyProperty.Register(\"MyProperty\", typeof(List&lt;string&gt;), \n                                                   typeof(CustomControl1), \n                                                   new UIPropertyMetadata(new List&lt;string&gt;()));        \n</code></pre>\n\n<hr>\n\n<p>When I use more than one of the <strong>CustomControl1</strong> in my application and set value for each <strong>MyProperty</strong></p>\n\n<pre><code>  &lt;StackPanel HorizontalAlignment=\"Left\" Orientation=\"Vertical\" VerticalAlignment=\"Top\" Width=\"176\"&gt;\n        &lt;local:CustomControl1&gt;          \n            &lt;local:CustomControl1.MyProperty&gt;\n                &lt;System:String&gt;A&lt;/System:String&gt;\n                &lt;System:String&gt;B&lt;/System:String&gt;\n                &lt;System:String&gt;C&lt;/System:String&gt;\n                &lt;System:String&gt;D&lt;/System:String&gt;\n            &lt;/local:CustomControl1.MyProperty&gt;          \n        &lt;/local:CustomControl1&gt;\n        &lt;local:CustomControl1&gt;          \n            &lt;local:CustomControl1.MyProperty&gt;\n                &lt;System:String&gt;F&lt;/System:String&gt;\n                &lt;System:String&gt;E&lt;/System:String&gt;                    \n            &lt;/local:CustomControl1.MyProperty&gt;          \n        &lt;/local:CustomControl1&gt;\n    &lt;/StackPanel&gt;\n</code></pre>\n\n<p>when run solution , all values shown in each <strong>CustomControl1</strong>\nand in design mode only show value of last customcontrol1.</p>\n\n<p>So it looks as all of them share the same instance data.</p>\n"},{"tags":["c#","wpf","voip","sip"],"answer_count":3,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":1848,"score":8,"question_id":6080660,"title":"VoIP/SIP Soft Phone C# WPF","body":"<p>I need to write VoIP/SIP Soft Phone in C# using WPF interface with Audio support only.\nI need to have call transfer, call conference, and recording of conversations in mp3.</p>\n\n<p>I've looked at VoIP SDK from ABTO LLC, but it is slow at application startup (30 seconds to start application, I think it's related to loading activex part of this sdk).</p>\n\n<p>I've also looked at SIP.Net, but it's only for SIP and doesn't contain components for voice data transfer. </p>\n\n<p>I have very limited time only 2 months from zero to fully working app. </p>\n\n<p>What SDK can I use to accomplish this task?</p>\n\n<p>Windows 7 must be supported.</p>\n"},{"tags":["wpf","formatting","richtextbox"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":410,"score":3,"question_id":5048160,"title":"How to prevent certain kinds of formatting from getting pasted into WPF RichTextBox","body":"<p>I want to allow some simple formatting commands within a WPF RichTextBox but not others. </p>\n\n<p>I've created a toolbar that allows users to apply bold or italics, and use bulleted or numbered lists. (Basically, I only want to support the formatting commands that would be appropriate for a blog or wiki.)</p>\n\n<p>The problem is that users can perform cut and paste operations that insert text with foreground and background colors, among other kinds of disallowed formatting. This can lead to nasty usability issues like users pasting white text onto a white background.</p>\n\n<p>Is there any way to turn these advanced formatting features off? If not, is there a way I can intercept the paste operation and strip out the formatting I don't want?</p>\n"},{"tags":["wpf","silverlight","xaml","silverlight-4.0","silverlightcontrols"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":426,"score":1,"question_id":9262008,"title":"Dynamically change the Visual Behavior of a control in XAML","body":"<p>How to change the visual behavior dynamically through <code>VisualStateManager</code> without changing visual structure (Appearance) of an existing control.</p>\n\n<p>I have a scenario where i have a <code>DataTemplate</code> defined in <code>ItemsControl</code> to generate list of <code>CheckBoxes</code> and associated <code>TextBoxes</code>. </p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;DataTemplate&gt;\n  &lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n      &lt;ColumnDefinition Width=\"0.2*\" /&gt;\n      &lt;ColumnDefinition Width=\"0.8*\" /&gt;\n    &lt;/Grid.ColumnDefinitions&gt;                        \n    &lt;CheckBox Grid.Column=\"0\" x:Name=\"chkBox\" /&gt;\n    &lt;TextBox Grid.Column=\"1\" x:Name=\"txtBox\" /&gt;\n  &lt;/Grid&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>I wanted to hide associated <code>TextBoxes</code> initially but later when <code>CheckBox</code> is <code>Checked</code> the associated <code>TextBox</code> should appear. So i wrote <code>VisualStateManager</code> but i don't have exact idea how can i use it or achieve the desired behavior.</p>\n\n<p><strong>VisualStateManager:</strong></p>\n\n<pre><code>&lt;vsm:VisualStateManager.VisualStateGroups&gt;\n  &lt;vsm:VisualStateGroup x:Name=\"CheckStates\"&gt;\n    &lt;vsm:VisualState x:Name=\"Checked\"&gt;\n      &lt;Storyboard&gt;\n        &lt;ObjectAnimationUsingKeyFrames Duration=\"0\" Storyboard.TargetName=\"txtBox\" Storyboard.TargetProperty=\"Visibility\"&gt;\n          &lt;DiscreteObjectKeyFrame KeyTime=\"0\"&gt;\n            &lt;DiscreteObjectKeyFrame.Value&gt;\n              &lt;vsm:Visibility&gt;Collapsed&lt;/vsm:Visibility&gt;\n            &lt;/DiscreteObjectKeyFrame.Value&gt;\n          &lt;/DiscreteObjectKeyFrame&gt;\n         &lt;/ObjectAnimationUsingKeyFrames&gt;\n      &lt;/Storyboard&gt;\n      &lt;/vsm:VisualState&gt;\n      &lt;vsm:VisualState x:Name=\"Unchecked\"&gt;\n        &lt;Storyboard&gt;\n          &lt;ObjectAnimationUsingKeyFrames Duration=\"0\" Storyboard.TargetName=\"txtBox\" Storyboard.TargetProperty=\"Visibility\"&gt;\n          &lt;DiscreteObjectKeyFrame KeyTime=\"0\"&gt;\n            &lt;DiscreteObjectKeyFrame.Value&gt;\n              &lt;vsm:Visibility&gt;Visible&lt;/vsm:Visibility&gt;\n            &lt;/DiscreteObjectKeyFrame.Value&gt;\n          &lt;/DiscreteObjectKeyFrame&gt;\n        &lt;/ObjectAnimationUsingKeyFrames&gt;\n      &lt;/Storyboard&gt;\n    &lt;/vsm:VisualState&gt;\n  &lt;/vsm:VisualStateGroup&gt;\n&lt;/vsm:VisualStateManager.VisualStateGroups&gt;\n</code></pre>\n"},{"tags":["wpf","silverlight","xaml","layout","scrollviewer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4531,"score":1,"question_id":1649861,"title":"XAML ScrollViewer scroll bar hidden issue (Silverlight)","body":"<p>I’ve got this strange problem whereby the content within a scroll viewer increases in size, the scroll viewer then shows is horizontal scroll bar. However the grid the ScrollViewer is ultimately within doesn’t seem to resize enough to show the scroll bar.</p>\n\n<p>I’ve isolated the problem in this sample app, basically some xaml and some code behind to simulate the content size increase. </p>\n\n<p>Note how the right scroll bar is not correctly showing when you click the resize button, I’ve added some padding to show that its there but not in the correct place.</p>\n\n<p>If I remove the top row it seems to work.</p>\n\n<p>Any ideas and thanks in advance guys and girls?</p>\n\n<pre><code>&lt;UserControl x:Class=\"SilverlightApplication7.MainPage\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \nxmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \nmc:Ignorable=\"d\"\n&gt;\n&lt;Grid \n    ShowGridLines=\"True\" \n    HorizontalAlignment=\"Stretch\" \n    VerticalAlignment=\"Stretch\"\n&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition x:Name=\"DealHeaderRow\" Height=\"Auto\" /&gt;\n        &lt;RowDefinition Height=\"*\" /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition x:Name=\"DealBarColumn\" Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition x:Name=\"MarketViewerColumn\" Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition x:Name=\"DealEditorColumn\" Width=\"*\" &gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition x:Name=\"InfoColumn\" Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n    &lt;ContentControl \n        x:Name=\"DealBarRegionContentControl\"\n        Grid.Row=\"0\"\n        Grid.Column=\"0\" \n        Grid.RowSpan=\"2\"\n        VerticalContentAlignment=\"Stretch\"\n        HorizontalAlignment=\"Stretch\"\n        Margin=\"0\"&gt;\n        &lt;TextBlock Text=\"DealBarRegion\" Width=\"150\" /&gt;\n    &lt;/ContentControl&gt;\n\n    &lt;ContentControl \n        Grid.Row=\"0\"\n        Grid.Column=\"1\" \n        Grid.RowSpan=\"2\"\n        VerticalContentAlignment=\"Stretch\"\n        HorizontalAlignment=\"Stretch\"\n        HorizontalContentAlignment=\"Stretch\"&gt;\n        &lt;Border Background=\"#FF9AF172\"&gt;\n            &lt;TextBlock Text=\"MarketViewerRegion\"  Width=\"150\"  /&gt;\n        &lt;/Border&gt;\n    &lt;/ContentControl&gt;\n\n    &lt;ContentControl \n        Grid.Column=\"2\" \n        Grid.ColumnSpan=\"2\"\n        Grid.Row=\"0\"\n        HorizontalAlignment=\"Stretch\"\n        HorizontalContentAlignment=\"Stretch\" &gt;\n        &lt;Border Background=\"#FFC1FC9F\"&gt;\n            &lt;TextBlock Text=\"DealHeaderRegion\"  /&gt;\n        &lt;/Border&gt;\n    &lt;/ContentControl&gt;\n\n    &lt;ContentControl \n        Grid.Column=\"2\" \n        Grid.Row=\"1\" \n        VerticalAlignment=\"Top\"\n        HorizontalContentAlignment=\"Stretch\" \n        VerticalContentAlignment=\"Stretch\"&gt;\n        &lt;Border Background=\"MistyRose\" &gt;\n            &lt;TextBlock Text=\"DealEditorRegion\" /&gt;\n        &lt;/Border&gt;\n    &lt;/ContentControl&gt;\n\n    &lt;Grid\n        Grid.Column=\"3\" \n        Grid.Row=\"1\" \n    &gt;\n        &lt;ContentControl \n            x:Name=\"InfoRegionControl\" \n            VerticalContentAlignment=\"Stretch\"\n            HorizontalAlignment=\"Stretch\"&gt;\n            &lt;!-- without the padding here you can't see the scroll bar at all !! Its like the \n            scroll ScrollViewer isn't correctly calculating its width to include the scroll bar,\n            or the grid isn't sizing at the points its visible??--&gt;\n            &lt;Border Padding=\"0,0,9,0\" MinWidth=\"200\" x:Name=\"DealInfoControlPlaceHolder\"&gt;\n                &lt;ScrollViewer  \n                    HorizontalAlignment=\"Stretch\" \n                    HorizontalContentAlignment=\"Stretch\"\n                    VerticalScrollBarVisibility=\"Auto\" \n                    HorizontalScrollBarVisibility=\"Auto\"  \n                    &gt;\n                    &lt;StackPanel x:Name=\"ScrollContentPlaceHolder\"&gt;\n                        &lt;Button Click=\"Button_Click\" Content=\"Rezize Column\" x:Name=\"ResizeButton\" /&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/ScrollViewer&gt;\n            &lt;/Border&gt;\n        &lt;/ContentControl&gt;\n    &lt;/Grid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>And here is the code behind:</p>\n\n<pre><code>using System.Windows;\nusing System.Windows.Controls;\n\nnamespace SilverlightApplication7\n{\n    public partial class MainPage : UserControl\n    {\n        double _dealInfoControlPlaceHolderHeight = 0;\n        double _dealInfoControlPlaceHolderWidth = 0;\n\n        public MainPage()\n        {\n            InitializeComponent();\n\n            Loaded += (o, e) =&gt;\n            {\n                // cache the original width and height\n                _dealInfoControlPlaceHolderHeight = DealInfoControlPlaceHolder.Height;\n                _dealInfoControlPlaceHolderWidth = DealInfoControlPlaceHolder.Width;\n            };\n        }\n\n        private void Button_Click(object sender, RoutedEventArgs e)\n        {\n            if (ScrollContentPlaceHolder.Height == 1200)\n            {\n                ScrollContentPlaceHolder.Height = _dealInfoControlPlaceHolderHeight;\n                ScrollContentPlaceHolder.Width = _dealInfoControlPlaceHolderWidth;\n            }\n            else\n            {\n                ScrollContentPlaceHolder.Height = 1200;\n                ScrollContentPlaceHolder.Width = 250;\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","xaml","resources"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5597,"score":2,"question_id":3747972,"title":"WPF UserControl cannot find XAML resource in referencing project","body":"<p>In my WPF project i keep a user control in a separate library project. The user control accesses resources in a separate XAML file, like this:</p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"/Resources/ViewResources.xaml\" /&gt;\n        &lt;/ResourceDictionary.MergedDictionaries&gt;\n        &lt;!-- Local styles here --&gt;\n    &lt;/ResourceDictionary&gt;\n&lt;/UserControl.Resources&gt;\n</code></pre>\n\n<p>The resource file, ViewResources.xaml, resides in a folder in the control library project named Resources. It has the default build action (Page) and custom tool (MSBuild:Compile).</p>\n\n<p>The problem is when I reference the control library in my WPF application and use the user control. At runtime, I get the following XamlParseException:</p>\n\n<pre><code>Set property 'System.Windows.ResourceDictionary.Source' threw an exception.\n</code></pre>\n\n<p>...which wraps the IOException:</p>\n\n<pre><code>Cannot locate resource 'resources/viewresources.xaml'.\n</code></pre>\n\n<p>How can I fix this? I have tried to change the resource file's build action to \"content\" and have it copied to the output directory (that works for files and similar \"dumb\" resources). But to no avail. Also, it doesn't work property in the user control then.</p>\n\n<p>Is there a better way to specify the path?</p>\n\n<p>Will I have to move the resource file to the application project (I'd rather not, as it belongs in the user control's domain).</p>\n"},{"tags":["wpf","c#-4.0","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13106738,"title":"How do I expose the LoadCompleted method in the WebBrowser class in WPF C#?","body":"<p>How do I expose the LoadCompleted method in the WebBrowser class in WPF C#?</p>\n\n<p>I am trying to write a C# program in wpf that retrieves the content of a web page.</p>\n\n<p>The first thing I tried was to try the WebRequest and WebResponse classes.  This did not provide the actual displayed content.  WebResponse reveils the HTML code that is sent to the browser.  But I discovered that, while the page is being loaded by the browser, javascript can change what content is finally displayed in the browser.</p>\n\n<p>So I decided to use the WebBrowser class.</p>\n\n<p>Immediately I found that there are two WebBrowser classes.  Thee is the one that is documented for WinForms and there is another that is documented for WPF.  I need to understand the one documented for WPF.  What I think I neeed to know what to do is to retrieve code after the \"LoadCompleted\" method is caused.  But I do not know how to this and I cannot find any example demonstrating how this is done.</p>\n"},{"tags":["c#","wpf","mvvm","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13107064,"title":"How do I pass parameter to ViewModel's constructor in a WPF application?","body":"<p>I see people suggests using Messenger/EventAggregator to pass parameter to ViewModel when \"current\" target is changed, but it doesn't work on my case.</p>\n\n<p>Say I have a ViewModel class like this:</p>\n\n<pre><code>class CustomerViewModel\n{\n    CustomerViewModel(int customerId) {}\n}\n</code></pre>\n\n<p>And:</p>\n\n<ol>\n<li>I have views of same type in the application shell at the same time.</li>\n<li>For each view, there is a unique CustomerViewModel instance for it. Each CustomerViewModel instance can have different customerId.\n(which is similar to Visual Studio IDE, multiple document opened at\nthe same time)</li>\n</ol>\n\n<p>I don't want to write code like \"this.DataContext = new CustomerViewModel(id)\" in my View class. What's the MVVM way to handle such case?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","wpf","windows"],"answer_count":8,"favorite_count":5,"up_vote_count":11,"down_vote_count":0,"view_count":3616,"score":11,"question_id":6071372,"title":"Maximize WPF Window on the current screen","body":"<p>I have a windowless wpf application, whenever I set the window state as maximized it maximizes it on the primary display.</p>\n\n<p>What I would like to do is have it maximize on which ever display the application is running.</p>\n\n<p>So any idea how I would do this?</p>\n\n<p>My code at the moment is just</p>\n\n<pre><code>private void titleBarThumb_MouseDoubleClick(object sender, MouseButtonEventArgs e)\n        {\n            if (this.WindowState == System.Windows.WindowState.Normal)\n            {\n                this.WindowState = System.Windows.WindowState.Maximized;\n            }\n            else\n            {\n                this.WindowState = System.Windows.WindowState.Normal;\n            }\n        }\n</code></pre>\n"},{"tags":["c#","wpf","callback","invalidoperationexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":523,"score":1,"question_id":7065682,"title":"WCF InvalidOperationException when calling back in a callback","body":"<p>I have a service like this:</p>\n\n<pre><code>[ServiceContract(SessionMode = SessionMode.Required, CallbackContract=typeof(IMyServiceCallback))]\npublic interface IMyService\n{\n    [OperationContract]\n    bool CallService();\n}\n\npublic interface IMyServiceCallback\n{\n    [OperationContract(IsOneWay = true)]\n    void NotifyClient();\n}\n</code></pre>\n\n<p>In the implementation of NotifyClient() I attempt to make a call to CallService(). This results in an InvalidOperationException:</p>\n\n<blockquote>\n  <p>Additional information: This operation would deadlock because the reply cannot be received until the current Message completes processing. If you want to allow out-of-order message processing, specify ConcurrencyMode of Reentrant or Multiple on CallbackBehaviorAttribute.</p>\n</blockquote>\n\n<p>My service has ServiceBehavior set as follows:</p>\n\n<pre><code>[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession, ConcurrencyMode=ConcurrencyMode.Multiple, UseSynchronizationContext=false)]\n</code></pre>\n\n<p>and my callback has CallbackBehavior as:</p>\n\n<pre><code>[CallbackBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, UseSynchronizationContext=false)]\n</code></pre>\n\n<p>What could be causing this exception? I have also tried using ConcurrencyMode.Reentrant, but that doesn't help. I am able to get round the problem by invoking CallService() on a worker thread, but I would still like to know what is causing the exception.</p>\n\n<p>Thanks.</p>\n\n<p>Edit: added [OperationContract(IsOneWay = true)], but the problem remains.</p>\n"},{"tags":["wpf","arcgis","esri"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13044800,"title":"ArcGIS Runtime for wpf - PointDataSource mapTip","body":"<p>I have GraphicsLayer in my application and I use PointDataSource like itemsSource:</p>\n\n<pre><code>        trackEntryPointDataSource = new PointDataSource();\n        trackEntryPointDataSource.DataSpatialReference = \n                                  new SpatialReference((int)CommonEpsgCodes.JTSKEN);\n        trackEntryPointDataSource.XCoordinateBinding = \n                                  new System.Windows.Data.Binding(\"XJTSK\");\n        trackEntryPointDataSource.YCoordinateBinding = \n                                  new System.Windows.Data.Binding(\"YJTSK\");\n        SimpleRenderer srd = new SimpleRenderer();\n        srd.Symbol = new SimpleMarkerSymbol()\n        {\n            Color = new SolidColorBrush(Colors.Yellow)\n        };\n\n        EntriesLyr.GraphicsSource = trackEntryPointDataSource;\n        EntriesLyr.Renderer = srd;\n</code></pre>\n\n<p>Have someone any idea how to add MapTips to graphics symbols?</p>\n"},{"tags":["c#","wpf","file","file-io","directory"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13106420,"title":"create folder and copy set of files to local disk","body":"<p>i am trying to create a folder and copy some images into it using c# wpf application.</p>\n\n<pre><code>            curName = txt_PoemName.Text;\n            // Specify a \"currently active folder\" \n            string activeDir = @\"C:\\Program Files\\Default Company Name\\Setup2\\Poems\";\n\n            //Create a new subfolder under the current active folder \n            string newPath = System.IO.Path.Combine(activeDir, curName);\n\n            // Create the subfolder\n            System.IO.Directory.CreateDirectory(newPath);\n\n                foreach(DictionaryEntry entry in curPoem){\n                    string newFilePath = System.IO.Path.Combine(newPath, entry.Key.ToString() + Path.GetExtension(entry.Value.ToString()));\n                    System.IO.File.Copy(entry.Value.ToString(), newFilePath, true);\n                }\n</code></pre>\n\n<p>i have successfully created the folder and images. and also i can access them via application. but i cant see them in the location on my local disk. when i restart the machine , then application also cant see them.how can i solve this? </p>\n"},{"tags":["c#","wpf","datagrid","propertygrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13105018,"title":"How to display dynamic data in WPF Property Grid?","body":"<p>I display data in a datagrid and I want to create a filter with property grid. Each time different data is loaded into the datagrid. I need to create a filter for my datagrid. I like to display the filter in the WPF property grid. But, I cannot create a dynamic wpf property grid, because all objects in a property grid should be specified beforehand.\nAny ideas? Is it even possible to do this?\nHow to programmatically generate categories?\nThanks for the help.</p>\n"},{"tags":["wpf","datetime","charts","data-visualization"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":658,"score":1,"question_id":8710906,"title":"WPF charting DateTimeAxis issue?","body":"<p>I created a graph with column series by using data visualization and in that i've taken DateTimeAxis as x-axis and i've one combo box with time intervals and based on selection of combo box i need to bind intervals into my graph at runtime. The problem is i'm getting error if i select intervals randomly like </p>\n\n<pre><code>var xAxis = countChart.ActualAxes.OfType&lt;DateTimeAxis&gt;().FirstOrDefault(ax =&gt; ax.Orientation == AxisOrientation.X);\nxAxis.Minimum = DateTime.Parse(fromDt.ToString(\"HH:mm:ss\"));\nxAxis.Maximum = DateTime.Parse(toDt.ToString(\"HH:mm:ss\"));\n\n\"The minimum value must be smaller than or equal to the maximum value.\"\n</code></pre>\n\n<p>so how can i overcome my problem plz help me.</p>\n\n<p>Thanks,\n@Nagaraju.</p>\n"},{"tags":["wpf","focus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":311,"score":0,"question_id":5474209,"title":"Handling GotFocus when using BringIntoView in WPF","body":"<p>I am scrolling to different items in a control, and using .BringIntoView(Rect) rather than .Focus(), so I can buffer the size around the control, so when I focus on something, its not just at the very top or bottom of the main control. </p>\n\n<p>When calling Focus, one can catch GotFocus() to then fire an event when the control has received focus. But this does not fire when using BringIntoView().</p>\n\n<p>I would like to know when a control received focus so I can highlight it to the user so they know where their content went. Is there any way to when control.BringIntoView has completed so I can then do something to notify the user?</p>\n"},{"tags":["wpf","app.xaml"],"answer_count":4,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":2877,"score":5,"question_id":1052868,"title":"WPF - Shut-off autogen of Main in App.g.cs","body":"<p>I'm learning WPF.</p>\n\n<p>I want to provide my own Main method in my App.xaml.cs rather than getting one generated for me in App.g.cs. However I keep getting conflicts because I haven't found out how to stop an additional Main from being generated.</p>\n\n<p>Is there a setting in my project file or elsewhere that controls this? </p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13104637,"title":"Runtime conversion of an icon to an ImageSource","body":"<p>I have written an application which gets file icons from the OS and binds to them, but since <a href=\"http://msdn.microsoft.com/en-us/library/system.drawing.icon.aspx\" rel=\"nofollow\">System.Drawing.Icon</a> objects can't be used as <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.media.imagesource.aspx\" rel=\"nofollow\">ImageSource</a>'s in the <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.image.aspx\" rel=\"nofollow\">Image</a> control, i had to write a <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx\" rel=\"nofollow\">converter</a>. after searching a bit i arrived at the following code which i am using at the moment:  </p>\n\n<pre><code>public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n        {\n            Icon ico = (value as Icon);\n            Bitmap bits = ico.ToBitmap();\n            MemoryStream strm = new MemoryStream();\n            // add the stream to the image streams collection so we can get rid of it later\n            _imageStreams.Add(strm);\n            bits.Save(strm, System.Drawing.Imaging.ImageFormat.Png);\n            BitmapImage bitmap = new BitmapImage();\n            bitmap.BeginInit();\n            bitmap.StreamSource = strm;\n            bitmap.EndInit();\n            // freeze it here for performance\n            bitmap.Freeze();\n            return bitmap;\n        }\n</code></pre>\n\n<p>and i have three questions:<br>\n<strong>1.</strong> Is there a better solution you could suggest ?<br>\n<strong>2.</strong> What's the best way to ultimately close the memory streams used as the code here is called automatically by the binding system (never manually instantiated, as you might notice i am adding the streams to a collection where i call close on them in the destructor but i don't think it is a nice solution).<br>\n<strong>3.</strong> Related to the previous question, when i try to close the stream before the end of the function, the image appears empty even if you call <a href=\"http://msdn.microsoft.com/en-us/library/system.io.stream.flush.aspx\" rel=\"nofollow\">Stream.Flush()</a> before that.  </p>\n"},{"tags":["wpf","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13104160,"title":"Loading Screen Animation Stutter","body":"<p>I use a background worker to load a very large set of items while displaying a loading animation.  On the run worker completed event, I set all those loaded items to an observable collection and then toggle off the loading screen.  The problem is the progress bar is animating smoothly until the items are set to the observable collection, then it just stops animating.  I imagine this is because the rendering of those items interfere with the animation.  Is there any way to make the animation smooth during the rendering phase?  When running the application the times I get are:</p>\n\n<p>Loading = 1000 ms<br>\nSet properties = 43 ms<br>\nRendering = 5083 ms</p>\n\n<p>The rendering improves to 19 ms when I turn virtualizing on.  I leave it turned off to demonstrate a scenario of long rendering times.</p>\n\n<pre><code>    public ObservableCollection&lt;string&gt; Items { get; set; }\n    private IEnumerable&lt;string&gt; _items;\n    private BackgroundWorker _worker;\n    private long _loadTime;\n    private long _renderTime;\n    private long _setPropertiesTime;\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        Items = new ObservableCollection&lt;string&gt;();\n        _itemsGrid.DataContext = this;\n        _worker = new BackgroundWorker();\n        _worker.DoWork += DoWork;\n        _worker.RunWorkerCompleted += RunWorkerCompleted;\n    }\n\n    private void Button_Click_1(object sender, RoutedEventArgs e)\n    {\n        _renderLabel.Content = string.Empty;\n        _loadLabel.Content = string.Empty;\n        _loadingBorder.Visibility = Visibility.Visible;\n        _worker.RunWorkerAsync();            \n    }\n\n    void DoWork(object sender, DoWorkEventArgs e)\n    {\n        _items = LoadItems();            \n    }\n\n    void RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        var setItemsTimer = Stopwatch.StartNew();\n        Items.Clear();\n\n        foreach (var item in _items)\n        {\n            Items.Add(item);\n        }\n\n        setItemsTimer.Stop();\n        _setPropertiesTime = setItemsTimer.ElapsedMilliseconds;\n\n        var timer = Stopwatch.StartNew();\n\n        Application.Current.Dispatcher.BeginInvoke(DispatcherPriority.Loaded, new Action(() =&gt; \n        {\n            timer.Stop();\n            _loadLabel.Content = string.Format(\"Loading took {0} ms, Set properties took {1} ms\", _loadTime, _setPropertiesTime);\n            _renderLabel.Content = string.Format(\"Rendering took {0} ms\", timer.ElapsedMilliseconds);\n            _loadingBorder.Visibility = Visibility.Collapsed;\n        }));\n    }\n\n    IEnumerable&lt;string&gt; LoadItems()\n    {\n        var timer = Stopwatch.StartNew();\n        var items = new List&lt;string&gt;();\n        for (int i = 0; i &lt; 5000; i++)\n        {\n            items.Add(\"Testing\");\n        }\n\n        Thread.Sleep(1000);\n\n        timer.Stop();\n        _loadTime = timer.ElapsedMilliseconds;\n        return items;\n    }\n</code></pre>\n"},{"tags":["wpf","unity","prism","prism-4"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1929,"score":3,"question_id":5519304,"title":"Prism, ServiceLocator and Unity container hierarchy and multi-window WPF application","body":"<p>I want to build a WPF/Prism application where each top level window is in its own UI thread. That is fairly straight forward to do. I am using Unity as my DI container and would like to create a hierarchy of containers. In the simplest case, the root container will be at the application level and each window will have a child container. This is desirable as each window can have its own shared objects scoped by the child container.</p>\n\n<p>I would like each window to have their own region manager from Prism so that I don't have any cross threading issues as each Window will have its own UI thread. I see that the Region and RegionManager use the ServiceLocator.Current singleton. This is an issue because I would like the RegionManager to use the container it is scoped to which is not possible with a static singleton. Have any of you run into this issue and how would you work around it?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","xaml","styles","resourcedictionary"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":233,"score":2,"question_id":5800855,"title":"WPF DataGrid styling","body":"<p>I'm trying to style the WPF datagrid. I'm using the Whistler Blue theme (full source at <a href=\"http://pastebin.com/5nXpTw4G\" rel=\"nofollow\">http://pastebin.com/5nXpTw4G</a>), but although the column headers are styled, the selected row is not, it's just awful looking dark blue. I noticed from inspecting the visual tree with snoop that the controls in the templates for each cell/row aren't rendered.</p>\n\n<p><strong>EDIT:</strong> The WhistlerBlue theme source is available at <a href=\"http://wpfthemes.codeplex.com/SourceControl/changeset/view/63656#382026\" rel=\"nofollow\">http://wpfthemes.codeplex.com/SourceControl/changeset/view/63656#382026</a></p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":816,"score":0,"question_id":8475674,"title":"Loading merged ResourceDictionary from different assembly fails","body":"<p>I've put all of my application's ResourceDictionaries into a separate assembly and merged them into one ResourceDictionary which I want to include as a resource in my application:</p>\n\n<pre><code>&lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n    &lt;ResourceDictionary.MergedDictionaries&gt;\n        &lt;ResourceDictionary Source=\"InputStyles.xaml\"/&gt;\n        &lt;ResourceDictionary Source=\"DataGridStyles.xaml\"/&gt;\n        &lt;ResourceDictionary Source=\"ComboboxStyles.xaml\"/&gt;\n        &lt;ResourceDictionary Source=\"CheckboxStyles.xaml\"/&gt;\n        &lt;ResourceDictionary Source=\"TabControlStyles.xaml\"/&gt;\n        &lt;ResourceDictionary Source=\"ButtonStyles.xaml\"/&gt;\n    &lt;/ResourceDictionary.MergedDictionaries&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>Declaring resource:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;ResourceDictionary Source=\"pack://application:,,,/StyleAssembly;component/Styles.xaml\"/&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>Looking at the designer in VS all controls are displayed with the styles from the files but when I try to start the application I'm getting the following error:</p>\n\n<p>\"Cannot locate resource 'inputstyles.xaml'.\"</p>\n\n<p>The build action is set to 'Page' for all files and the build for both projects succeeds. What am I doing wrong?</p>\n"},{"tags":["c#","wpf","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13103463,"title":"How to bind a related object property to a TextBlock in DataGridTemplateColumn with WPF","body":"<p>I have two objects Exercise and Objective, each Exercise has one Objective.\nIn the code behind I set the ItemsSource of the Exercises DataGrid</p>\n\n<pre><code> dgExercicios.ItemsSource = Repositorio&lt;Exercicio&gt;.GetAll();\n</code></pre>\n\n<p>And in my XAML.</p>\n\n<pre><code>    &lt;DataGrid Name=\"dgExercicios\" CellStyle=\"{StaticResource CellStyle}\" CanUserSortColumns=\"True\" CanUserResizeColumns=\"True\" AutoGenerateColumns=\"False\"&gt;\n         &lt;DataGrid.Columns&gt;\n             &lt;!--This bind works (Exercice.Nome)--&gt;\n             &lt;DataGridTextColumn Header=\"Nome\" Binding=\"{Binding Nome}\" Width=\"200\"   /&gt;\n             &lt;!--This bind DONT works (I Trying to bind to Exercise.Objective.Descricao)--&gt;                     \n             &lt;DataGridTemplateColumn Header=\"Objetivo\"  Width=\"80\" &gt;\n                     &lt;DataGridTemplateColumn.CellTemplate&gt;\n                         &lt;DataTemplate  &gt;\n                             &lt;StackPanel&gt;\n                                 &lt;TextBlock Text=\"{Binding Path=Objective.Descricao}\" T /&gt;\n                              &lt;/StackPanel&gt;\n                          &lt;/DataTemplate&gt;\n                     &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                 &lt;/DataGridTemplateColumn&gt;\n          &lt;/DataGrid.Columns&gt;\n      &lt;/DataGrid&gt;\n</code></pre>\n\n<p>What I want to do is to bind the property Exercise.Objective.Descricao to the TextBlock on the Exercice.Nome</p>\n\n<p>Another question, will a DataGridTemplateColumn be needed in this case?</p>\n"},{"tags":["wpf","flash","plugins","webbrowser","powerpoint"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":207,"score":1,"question_id":6270801,"title":"WPF WebBrowser - Not opening Plugin Content","body":"<p>I am using a WPF Web Browser to show some PDF, Flash... files, the problem is that it works great in some computers, while on others it WebBrowser says it does not have the Flash plugin installed or the others...</p>\n\n<p>I always thought that the WPF WebControl would pick up all the plugins the IE had installed, but for some reason it is not working properly. The stangest thing is that it works on some testing machines, that aparently have the same configurations.</p>\n\n<p>Do you guys have any idea as to why this is happening?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","javascript","html","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13102676,"title":"WPF Invokescript not supported?","body":"<p>Iam trying to display somekind of help page in html within my wpf application and Ive loaded the html from my resourcers and it contains multiple javascript functions that i want to execute from c#.</p>\n\n<p>This is how it should be done:</p>\n\n<pre><code>webBrowser1.InvokeScript(\"MyFunction\");\n</code></pre>\n\n<p>This does not work at all, I get the error code:</p>\n\n<pre><code>Unknown name. (Exception from HRESULT: 0x80020006 (DISP_E_UNKNOWNNAME))\n</code></pre>\n\n<p>Microsoft has no help regarding this and googling didn`t do the trick either.  </p>\n\n<p><strong>Question:</strong> How do you invokescript in a wpf webbrowser?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13102314,"title":"WPF ComboBoxItem DataTrigger Does not Fire","body":"<p>I want combobox item should with different color based on coboboxitem value. e.g. if the item value is MTKG then the background for that item will be blue etc.</p>\n\n<p>right now it does not change the each item background. Could anyone tell what is wrong with this code.</p>\n\n<p>The following is my code :</p>\n\n<p>XAML file</p>\n\n<pre><code>&lt;Window x:Class=\"WPFDeskTopRemnderApp.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n        xmlns:xctk=\"http://schemas.xceed.com/wpf/xaml/toolkit\"\n        Title=\"\" Loaded=\"Window_Loaded\" WindowStyle=\"None\" \n        WindowStartupLocation=\"Manual\" ResizeMode=\"NoResize\" UseLayoutRounding=\"True\"\n        AllowsTransparency=\"True\" Background=\"#00000000\" SizeToContent=\"WidthAndHeight\"&gt;\n\n    &lt;Border CornerRadius=\"10,10,10,10\" Background=\"#FF961D36\"&gt;\n        &lt;Grid Width=\"548\" Background=\"#FF36A2AB\" Margin=\"6\" &gt;            \n            &lt;Label Height=\"Auto\" HorizontalAlignment=\"Left\" Margin=\"295,103,0,0\" Name=\"lblCategoryType\" VerticalAlignment=\"Top\" Width=\"Auto\"&gt;Task Category :&lt;/Label&gt;\n\n            &lt;ComboBox HorizontalAlignment=\"Left\" Margin=\"389,105,0,0\" Name=\"cmbCategoryType\" VerticalAlignment=\"Top\" Width=\"138\" &gt;\n                    &lt;Style TargetType=\"ComboBox\"&gt;\n                        &lt;Style.Triggers&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"IT\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"White\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"HR\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"Blue\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"ITSF\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"Gray\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"BH\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"DarkGray\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"AI\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"Blue\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                            &lt;DataTrigger Binding=\"{Binding Path=DeptName}\" Value=\"MKTG\"&gt;\n                                &lt;Setter Property=\"Background\" Value=\"DarkBlue\"&gt;&lt;/Setter&gt;\n                            &lt;/DataTrigger&gt;\n                        &lt;/Style.Triggers&gt;\n                    &lt;/Style&gt;\n                &lt;ComboBox.ItemTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;Grid  Width=\"160\" ShowGridLines=\"True\"&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition Width=\"40\"&gt;&lt;/ColumnDefinition&gt;\n                                &lt;ColumnDefinition Width=\"60\"&gt;&lt;/ColumnDefinition&gt;\n                                &lt;ColumnDefinition Width=\"50\"&gt;&lt;/ColumnDefinition&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n\n                            &lt;TextBlock Grid.Column=\"0\"  Text=\"{Binding EmpNo}\"\n                    Style=\"{StaticResource txtStyle}\"&gt;&lt;/TextBlock&gt;\n                            &lt;TextBlock Grid.Column=\"1\"  Background=\"{Binding EmpName}\"\n                    Style=\"{StaticResource txtStyle}\"&gt;&lt;/TextBlock&gt;\n                            &lt;TextBlock Grid.Column=\"2\"  Text=\"{Binding DeptName}\"\n                    Style=\"{StaticResource txtStyle}\"&gt;&lt;/TextBlock&gt;\n                        &lt;/Grid&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/ComboBox.ItemTemplate&gt;\n            &lt;/ComboBox&gt;\n\n         &lt;/Grid&gt;\n    &lt;/Border&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>Code Behind :</strong></p>\n\n<pre><code>public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n        }\n\n        private void Window_Loaded(object sender, RoutedEventArgs e)\n        {\n\n            PopulateCategoryType();\n        }\n\n        private void PopulateCategoryType()\n        {\n            ObservableCollection&lt;Empl&gt; _emp = new ObservableCollection&lt;Empl&gt;();\n\n            _emp.Add(new Empl() { EmpNo = 101, EmpName = \"Emp1\", DeptName = \"IT\" });\n            _emp.Add(new Empl() { EmpNo = 102, EmpName = \"Emp2\", DeptName = \"MKTG\" });\n            _emp.Add(new Empl() { EmpNo = 103, EmpName = \"Emp3\", DeptName = \"IT\" });\n            _emp.Add(new Empl() { EmpNo = 104, EmpName = \"Emp4\", DeptName = \"HR\" });\n            cmbCategoryType.Items.Clear();\n            cmbCategoryType.ItemsSource = _emp;\n        }\n}\n</code></pre>\n"},{"tags":["wpf","vb.net","timer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":187,"score":1,"question_id":9374724,"title":"Delayed Execution In VB.NET","body":"<p>I am in need to delay the execution of a line of code, say, by 5 seconds. But by doing</p>\n\n<p><code>System.Threading.Thread.Sleep(5000)</code></p>\n\n<p>the whole UI hangs and I don't want that to happen. Because I want to be able to display something in a Window that a user will be able to see. Does anyone know of an alternative of achieving this? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","vb.net","winforms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13102372,"title":"Creating Form Designer with HTML Possible?","body":"<p>I was wondering whether something like creating a design for a form through html codes exist in C#/VB.net/.NET Framework for applications (executables) only.</p>\n\n<p>I am aware of WPF but thats just too difficult and html is relatively easy.</p>\n\n<p>Any approach to do this so that the events can be attached (only basic one like click event of button) and setting properties of the html elements.</p>\n"},{"tags":["wpf","datagrid","rows"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5289,"score":0,"question_id":991107,"title":"Adding rows to wpf datagrid","body":"<p>I need to select a set of rows from one wpf toolkit datagrid and want to add it in another wpf toolkit datagrid. The code I used is as follows:</p>\n\n<pre><code>foreach(DataRowView row in MyFirstDataGrid.SelectedItems)\n{\n  MySecondDataGrid.Items.Add(row);\n}\n</code></pre>\n\n<p>But the problem here is, it just adds empty rows in the second datagrid without any contents.... Can anyone please help me in this issue????</p>\n\n<p>Thanks and Regards,\nSuba.</p>\n"},{"tags":["wpf","window","min-width","resize-crop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13102039,"title":"wpf-CanResizeWithGrip option does not consider the minwidth and minheight properties","body":"<p>I have a little problem, when I resize the window with the grip, the window can be smaller then the minimum size parameters.</p>\n\n<p>I tried this:</p>\n\n<pre><code>    private void wndMain_SizeChanged(object sender, SizeChangedEventArgs e)\n    {\n        // Check there is no Deviation in the height\n        if (e.NewSize.Height &lt; this.MinHeight)\n        {\n            this.Height = this.MinHeight;\n        }\n\n        // Check there is no Deviation in the width\n        if (e.NewSize.Width &lt; this.MinWidth)\n        {\n            this.Width = this.MinWidth;\n        }\n    }\n</code></pre>\n\n<p>But it looks terrible, Because the changing is haapened and resize again and again...</p>\n\n<p>there is an option to cancel the resize into the sizechanged event?\nthanks!</p>\n"},{"tags":["wpf","mvvm","events","view","viewmodel"],"answer_count":6,"favorite_count":8,"up_vote_count":14,"down_vote_count":0,"view_count":7221,"score":14,"question_id":1894329,"title":"WPF: how to signal an event from ViewModel to View without code in codebehind?","body":"<p>I have quite simple (I hope :)) problem: </p>\n\n<p>In MVVM, View usually listens on changes of ViewModel's properties. However, I would sometimes like to listen on event, so that, for example, View could start animation, or close window, when VM signals. </p>\n\n<p>Doing it via bool property with NotifyPropertyChanged (and starting animation only when it changes from false to true) is possible, but it feels like a hack, I'd much prefer to expose event, as it is semantically correct.</p>\n\n<p>Also, I'd like to do it without code in codebehind, as doing <code>viewModel.myEvent += handler</code> there would mean that I'd have manually unregister the event in order to allow View to be GC'd - WPF Views are already able to listen on properties 'weakly', and I'd much prefer to program only declaratively in View.</p>\n\n<p>The standard strong event subscription is also bad, because I need to switch multiple ViewModels for one View (because creating View every time takes too much CPU time).</p>\n\n<p>Thank you for ideas (if there is a standard solution, a link to msdn will suffice)!</p>\n"},{"tags":["wpf","mvvm","viewmodel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13101629,"title":"WPF MVVM customer -> address","body":"<p>In a WPF application following MVVM pattern I have a Customer class which has a property of type Address. </p>\n\n<p>In my CustomerViewModel I create a new datacontext and get my customer with this, I also have my bog standard properties, forename, surname, etc... but how would I hook my address object into the customer view model? Do I:</p>\n\n<ol>\n<li>Simply replicate all the address properties in my customerVM</li>\n<li>Create an AddressViewModel and hold a reference to this as my\nAddress property? If this is the way how would I get the datacontext\ninto the AddressViewModel instance?</li>\n</ol>\n"},{"tags":["c#","wpf","data-binding","microsoft-metro","datatemplate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13101449,"title":"XAML binding code not working","body":"<p>I have small problem.</p>\n\n<p>Code behind:</p>\n\n<pre><code>...\npublic struct Project\n{\n    string Name;\n    string Path;\n    public Project(string Name, string Path = \"\")\n    {\n       this.Name = Name;\n       this.Path = Path;\n    }\n}\n...\n</code></pre>\n\n<p>Resources code:</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"ItemProjectTemplate\"&gt;\n        &lt;StackPanel&gt;\n            &lt;Image Source=\"Assets/project.png\" Width=\"50\" Height=\"50\" /&gt;\n            &lt;TextBlock FontSize=\"22\" Text=\"{Binding Name}\" /&gt;\n        &lt;/StackPanel&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Normal code in Grid:</p>\n\n<pre><code>&lt;ListView Grid.Column=\"1\" HorizontalAlignment=\"Left\" Height=\"511\" \n     Margin=\"25,72,0,0\" Grid.Row=\"1\" VerticalAlignment=\"Top\" Width=\"423\"\n     x:Name=\"Projects\" ItemTemplate=\"{StaticResource ItemProjectTemplate}\" /&gt;\n</code></pre>\n\n<p>I have no problem with ListView source, which is being set in C# code, and also my template is being loaded. But this happens when I'm running my application:</p>\n\n<p><img src=\"http://i.stack.imgur.com/2FlWb.png\" alt=\"Project name is not being displayed\"></p>\n\n<p>As you can see the project name <code>(Project.Name</code>) is not being displayed, but in my ListView template is data binding, so it should work. Does anybody know why is my data binding for a text not working? Please help.</p>\n"},{"tags":[".net","wpf","gui","mahapps.metro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13101501,"title":"How to apply the tab switch animation when switching tabs programmatically (using MahApps.Metro style)","body":"<p>MahApps.Metro has a very nice swipe animation when switching the tabs. But I don't really need the tab headers and change the tabs on different user interaction. The thing is when I do <code>Tab_Control.SelectedItem = New_Tab;</code> the animation doesn't happen and it changes the tab suddenly. </p>\n\n<p>Any ideas?</p>\n"},{"tags":["wpf","mediaelement"],"answer_count":3,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2508,"score":9,"question_id":4338951,"title":"How do I determine if MediaElement is playing?","body":"<p>Seems simple enough, but I cannot figure out any way to determine what the state of a MediaElement is. There are various properties for some states (such as IsBuffering) but I can't find any for states such as Play, Pause, etc. Silverlight seems to have a CurrentState property that shows all these.</p>\n\n<p>Currently the way I'm determining whether a video is supposed to be playing is watching for various events and a timer that checks to see if any progress is being made. </p>\n\n<p>I'm new to MediaElement and WPF (I'm actually only using MediaElement in a WinForms app). Is there something I am missing?</p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13099292,"title":"To get value by its key, from other dictionary through XAML","body":"<p>I set <code>ObservableCollection&lt;Employe&gt;</code> as source for <code>ListBox.ItemsSource</code>, and set some <code>DataTemplate</code> for <code>ListBox.ItemsSource</code>. </p>\n\n<p>XAML for template:</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"tmpEmploye\"&gt;\n    &lt;Border BorderThickness=\"3\" BorderBrush=\"Gray\" CornerRadius=\"5\"&gt;\n        &lt;StackPanel Orientation=\"Vertical\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;TextBlock Text=\"{Binding Path=Surname}\" \n                           HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                           FontWeight=\"Bold\" TextWrapping=\"Wrap\"/&gt;\n                &lt;TextBlock Text=\"{Binding Path=Name}\" \n                           HorizontalAlignment=\"Stretch\" Margin=\"2\"/&gt;\n                &lt;TextBlock Text=\"{Binding Path=Patronymic}\" \n                           HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                           TextWrapping=\"Wrap\"/&gt;\n            &lt;/StackPanel&gt;\n            &lt;TextBlock Text=\"{Binding Path=Post}\" Foreground=\"Gray\" \n                       HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                       FontStyle=\"Italic\" TextWrapping=\"Wrap\"/&gt;\n        &lt;/StackPanel&gt;\n    &lt;/Border&gt;                               \n&lt;/DataTemplate&gt; \n</code></pre>\n\n<p>XAML for ListBox:</p>\n\n<pre><code>&lt;ListBox x:Name=\"lbEmployees\" x:FieldModifier=\"internal\" \n         ItemTemplate=\"{StaticResource tmpEmploye}\" HorizontalContentAlignment=\"Stretch\"/&gt;\n</code></pre>\n\n<p>Result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/UhgRm.png\" alt=\"enter image description here\"></p>\n\n<p>Look, the <code>Employee</code> class has a <code>Post</code> property, which is an index of record from <code>ObservableDictionary&lt;Int64, String&gt;</code> (my some class). You can see the '-1' values, but I need to get value for this key from my <code>ObservableDictionary&lt;Int64, String&gt;</code> object. Can I get necessary values and to display it through XAML code?</p>\n"},{"tags":["c#","wpf","button","calendar","disabled-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13086869,"title":"WPF Custom Calendar without Previous and Next buttons and no displaymode option","body":"<p>I am creating a 12 month calendar using the individual calendar controls for each month. Since I am controlling the calendars (Jan - Dec) via separate next year and previous year buttons, I want to remove the previous and next calendaritem buttons from the individual calendars and disable the ability to change the display mode. </p>\n\n<p>Since I am new to XAML and more comfortable with doing this in code, I would prefer to change the style at runtime but willing to learn how to make it happen via XAML but I am having a very difficult time finding an example of someone doing something like this.</p>\n\n<p>Hope someone can help.</p>\n"},{"tags":["wpf","xaml","flowdocument"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":8905103,"title":"How to center a Table or a List horizontally in a FlowDocument?","body":"<p>Below is sample code from a default WPF application's MainWindow.xaml. First and last 'Block's in the document are paragraphs and the middle one is a table. Table always appear at the left edge of its column and the area to the right of the table is blank. I would like to center the table in this space.</p>\n\n<p>I have tried putting the table inside a 'Section', a 'Paragraph' etc, but didn't have any luck. A Floater inside a paragraph works, but then the table flow into the next paragraph. Probably I can do this by using two empty columns on the left and right with some way to calculate their widths dynamically, but that looks overkill.</p>\n\n<p>Thanks\nJeevaka</p>\n\n<pre><code>&lt;Window x:Class=\"FlowDocument.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"700\" Width=\"700\"&gt;\n    &lt;FlowDocumentPageViewer&gt;\n        &lt;FlowDocument&gt;\n            &lt;Paragraph FontSize=\"24\"&gt;Moons of Saturn&lt;/Paragraph&gt;\n            &lt;Paragraph&gt;The moons of Saturn are numerous and diverse, ranging from tiny moonlets less than 1 kilometre across, to the enormous Titan, which is larger than the planet Mercury. Saturn has 62 moons with confirmed orbits, fifty-three of which have names, and only thirteen of which have diameters larger than 50 kilometres. Saturn has seven moons that are large enough to become spherical, and dense rings with complex orbital motions of their own. Particularly notable among Saturn's moons are Titan, the second largest moon in the Solar System, with a nitrogen-rich Earth-like atmosphere and a landscape including hydrocarbon lakes and dry river networks, and Enceladus, which emits jets of gas and dust and may harbor liquid water under its south pole region.&lt;/Paragraph&gt;\n            &lt;Table TextAlignment=\"Right\" BorderBrush=\"Black\" BorderThickness=\"1\" Background=\"Black\"&gt;\n                &lt;Table.Columns&gt;\n                    &lt;TableColumn Width=\"100\" &gt;&lt;/TableColumn&gt;\n                    &lt;TableColumn Width=\"100\"&gt;&lt;/TableColumn&gt;\n                &lt;/Table.Columns&gt;\n                &lt;TableRowGroup&gt;\n                    &lt;TableRow&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;Name&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;Diameter&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                    &lt;/TableRow&gt;\n                    &lt;TableRow&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;Mimas&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;396&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                    &lt;/TableRow&gt;\n                    &lt;TableRow&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;Enceladus&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;504&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                    &lt;/TableRow&gt;\n                    &lt;TableRow&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;Tethys&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                        &lt;TableCell Background=\"White\" Padding=\"5\"&gt;\n                            &lt;Paragraph&gt;1062&lt;/Paragraph&gt;\n                        &lt;/TableCell&gt;\n                    &lt;/TableRow&gt;\n                &lt;/TableRowGroup&gt;\n            &lt;/Table&gt;\n            &lt;Paragraph&gt;Twenty-four of Saturn's moons are regular satellites; they have prograde orbits not greatly inclined to Saturn's equatorial plane. They include the seven major satellites, four small moons which exist in a Trojan orbit with larger moons, two mutually co-orbital moons and two moons which act as shepherds of Saturn's F Ring. Two other known regular satellites orbit within gaps in Saturn's rings. The relatively large Hyperion is locked in a resonance with Titan. The remaining regular moons orbit near the outer edge of the A Ring, within G Ring and between the major moons Mimas and Enceladus. The regular satellites are traditionally named after Titans and Titanesses or other figures associated with the mythological Saturn.&lt;/Paragraph&gt;\n        &lt;/FlowDocument&gt;\n    &lt;/FlowDocumentPageViewer&gt;\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf","winforms","c#-4.0","user-interface"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13098766,"title":"Creating a Console like UI in Windows Forms","body":"<p>Hi I'm trying to create a console like interface using a richtextbox in WinForms using C#.</p>\n\n<p>The reason why I am using a richtextbox is I want a few features such as selection,copy-paste that are not present in a normal console application.</p>\n\n<p>I was wondering if it was possible to change the blinking cursor from the blinking \"|\" to a blinking \"_\"</p>\n\n<p>Even if I could hide the original \"|\", I could then implement a functionality on the onchange event of the richtextbox to display the blinking, \"_\"</p>\n\n<p>I also had another related question, but I don't know if I should put that here as well.</p>\n\n<p>Also, if it will be easier to implement something like this using WPF, I'm willing to move.</p>\n"},{"tags":["c#","wpf","windows","autocomplete","textbox"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3812,"score":2,"question_id":2534429,"title":"How to make a google-like auto complete textbox with C# in a WPF application?","body":"<p>I tried to find a solution but I didn't found what I was searching for. So here is my problem.\nI want a google like behaviour with a textbox. As I type \"dum\" it should find dummy in the database and display it as option under the textbox. It should be selectable.\nI don't use ASP.net or any other stuff. Just pure C#.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":[".net","wpf",".net-4.0","devexpress",".net-4.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":13081924,"title":".NET 4.5 breaking an app","body":"<p>I have a .NET app which works well with .NET 4.0 - I don't have its source though the app exposes its app.config</p>\n\n<p>But.</p>\n\n<p>I have installed the Visual Studio 2012 with .NET 4.5. Suddenly, the .NET 4.0 application is throwing exceptions at some places - I analyzed with Reflector that the exceptions are thrown in InitializeComponent() in the WPF part of the application.</p>\n\n<pre><code>   Uri resourceLocator = new Uri(\"/Some.Assembly;someuri/someuri/somefile.xaml\", UriKind.Relative);\n</code></pre>\n\n<p>And the exception is:</p>\n\n<pre><code>The invocation of the constructor on type 'DevExpress.Xpf.Grid.GridControl' that matches the specified binding constraints threw an exception.\n\nat System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)\nat System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)\nat System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)\nat System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)\n</code></pre>\n\n<p>Unfortunately I'm unable to tell if there's any inner exception.</p>\n\n<p>If I uninstall .NET 4.5 and install .NET 4.0, the exceptions are not thrown but I can't work with VS 2012. </p>\n\n<p>I've tried to add these lines into the app.config but without success.</p>\n\n<pre><code>&lt;startup useLegacyV2RuntimeActivationPolicy=\"true\" &gt;\n    &lt;supportedRuntime version=\"v4.0.30319\" sku=\".NETFramework,Version=v4.0\" /&gt;\n    &lt;requiredRuntime version=\"v4.0.30319\" /&gt;\n&lt;/startup&gt;\n</code></pre>\n\n<p>How does one force an app to use 4.0 and 4.0 only? Is it even possible? Is the .NET 4.5 somehow mingling with the 4.0 assemblies?</p>\n"},{"tags":["wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13098874,"title":"Streching of Border's width for ListBoxItem","body":"<p>I have wrote some class, named as Employe. Employees collection I set as source for ListBox WPF control. I have wrote such template for ItemTemplate:</p>\n\n<pre><code>&lt;ResourceDictionary&gt;\n    &lt;DataTemplate x:Key=\"tmpEmploye\"&gt;\n        &lt;Border BorderThickness=\"3\" BorderBrush=\"Gray\" CornerRadius=\"5\" \n                HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;\n            &lt;StackPanel Orientation=\"Vertical\"&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBlock Text=\"{Binding Path=Surname}\" \n                               HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                               FontWeight=\"Bold\" TextWrapping=\"Wrap\"/&gt;\n                    &lt;TextBlock Text=\"{Binding Path=Name}\" \n                               HorizontalAlignment=\"Stretch\" Margin=\"2\"/&gt;\n                    &lt;TextBlock Text=\"{Binding Path=Patronymic}\" \n                               HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                               TextWrapping=\"Wrap\"/&gt;\n                &lt;/StackPanel&gt;\n                &lt;TextBlock Text=\"{Binding Path=Post}\" Foreground=\"Gray\" \n                           HorizontalAlignment=\"Stretch\" Margin=\"2\" \n                           FontStyle=\"Italic\" TextWrapping=\"Wrap\"/&gt;\n            &lt;/StackPanel&gt;\n        &lt;/Border&gt;                               \n    &lt;/DataTemplate&gt;            \n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>Each item has border. The border must be expanded according width of ListBox. I set <code>HorizontalAlignment=\"Stretch\"</code> for Border, but it is not occured as I want. </p>\n\n<p><img src=\"http://i.stack.imgur.com/LZD1i.png\" alt=\"enter image description here\"></p>\n\n<p>How can I correct it?</p>\n"},{"tags":["wpf","tabcontrol","controltemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13091307,"title":"WPF Set controltemplate for only first level","body":"<p>I have a style for tabcontrol :</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type TabControl}\" x:Key=\"CloseableTabControl\"&gt;\n    &lt;Style.Resources&gt;\n        &lt;Style TargetType=\"{x:Type TabItem}\"&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate TargetType=\"{x:Type TabItem}\"&gt;\n</code></pre>\n\n<p>this have effect for all tabitem contained into tabcontrol, including item of child tabcontrol.</p>\n\n<p>I want that only first level tabitems have applicated the style.\nHow I can accomplish this?</p>\n"},{"tags":[".net","wpf","binding","treeview","datacontext"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13092384,"title":"Modifying object in Collection in SelectedItem of TreeView","body":"<p>Object Model:\nClient has many studies has many subjects has many records. The treeview holds the clients/studies/subjects and the records are in the MainDataGrid.</p>\n\n<p>Problem: When I modify one of the two-way binding properties on the Record object in the datagrid the setter on the Record object is never called. I am unsure how to approach the issue because I still don't understand enough about the wpf binding model/object model to figure out the reason for this.</p>\n\n<p>This is NOT an MVVM app. In the codebehind, during the _loaded event, I load some data and assign it to the TreeView's datacontext via a well-implemented ObservableCollection.\nOn the TreeView's SelectedItemChanged event, I load related records and hookup property-changed handlers.</p>\n\n<pre><code>&lt;Window x:Class=\"MainWindow\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:local=\"clr-namespace:HPA.Studies.MCA.Client\"\nTitle=\"Medra Coding Assistant\" Height=\"800\" Width=\"1250\" MouseRightButtonDown=\"HandleRightClick\"&gt;\n&lt;Window.Resources&gt;\n    &lt;local:HistoryTypeConverter x:Key=\"HistoryTypeConverter\" /&gt;\n    &lt;DataTemplate x:Key=\"MedraValuesTemplate\"&gt;\n        &lt;UniformGrid Columns=\"2\" Rows=\"5\"&gt;\n            &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"0\" Text=\"MedDRA LLT:\" /&gt;\n            &lt;TextBox Grid.Row=\"0\" Grid.Column=\"1\" Text=\"{Binding CodeValue2, Mode=TwoWay}\"/&gt;\n            &lt;TextBlock Grid.Row=\"1\" Grid.Column=\"0\" Text=\"MedDRA PT:\" /&gt;\n            &lt;TextBox Grid.Row=\"1\" Grid.Column=\"1\" Text=\"{Binding CodeValue1, Mode=TwoWay}\"/&gt;\n            &lt;TextBlock Grid.Row=\"2\" Grid.Column=\"0\" Text=\"MedDRA HLT:\" /&gt;\n            &lt;TextBox Grid.Row=\"2\" Grid.Column=\"1\" Text=\"{Binding CodeValue3, Mode=TwoWay}\"/&gt;\n            &lt;TextBlock Grid.Row=\"3\" Grid.Column=\"0\" Text=\"MedDRA HLGT:\" /&gt;\n            &lt;TextBox Grid.Row=\"3\" Grid.Column=\"1\" Text=\"{Binding CodeValue4, Mode=TwoWay}\"/&gt;\n            &lt;TextBlock Grid.Row=\"4\" Grid.Column=\"0\" Text=\"MedDRA SOC:\" /&gt;\n            &lt;TextBox Grid.Row=\"4\" Grid.Column=\"1\" Text=\"{Binding CodeValue5, Mode=TwoWay}\"/&gt;\n        &lt;/UniformGrid&gt;\n    &lt;/DataTemplate&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition /&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;RowDefinition Height=\"8*\"/&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;StackPanel Grid.Row=\"0\" Grid.ColumnSpan=\"3\"&gt;\n        &lt;TextBlock Text=\"Medra Coding Assistant\" FontSize=\"15\" FontWeight=\"Bold\" /&gt;\n        &lt;TextBlock Text=\"Available Batches:\" /&gt;\n    &lt;/StackPanel&gt;\n    &lt;Grid x:Name=\"BindingRootGrid\"  Grid.Row=\"1\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"2*\"/&gt;\n            &lt;ColumnDefinition Width=\"5*\"/&gt;\n            &lt;ColumnDefinition Width=\"4*\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;TreeView x:Name=\"tvClients\" Grid.Column=\"0\" ItemTemplate=\"{StaticResource NavigatorTemplate}\" ItemsSource=\"{Binding}\"&gt;\n        &lt;/TreeView&gt;\n        &lt;GridSplitter Grid.Column=\"1\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Left\" Width=\"6\" Panel.ZIndex=\"1\" /&gt;\n        &lt;DataGrid x:Name=\"MainDataGrid\" Grid.Column=\"1\" AutoGenerateColumns=\"False\"\n                  DataContext=\"{Binding ElementName=tvClients, Path=SelectedItem}\" ItemsSource=\"{Binding Path=Records}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridHyperlinkColumn Header=\"    \" /&gt;\n                &lt;DataGridTextColumn Header=\"Discrim\" Binding=\"{Binding Discriminator, Mode=OneWay}\" /&gt;\n                &lt;DataGridTextColumn Header=\"Field Name\" Binding=\"{Binding FieldName, Mode=OneWay}\" /&gt;\n                &lt;DataGridTextColumn Header=\"Field Value\" Binding=\"{Binding FieldValue, Mode=OneWay}\" Width=\"160\"&gt;\n                    &lt;DataGridTextColumn.ElementStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"TextBlock.TextWrapping\" Value=\"Wrap\" /&gt;\n                            &lt;Setter Property=\"TextBlock.TextAlignment\" Value=\"Center\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/DataGridTextColumn.ElementStyle&gt;\n                &lt;/DataGridTextColumn&gt;\n                &lt;DataGridTemplateColumn Header=\"MedDRA Value\" CellTemplate=\"{StaticResource MedraValuesTemplate}\" /&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n        &lt;GridSplitter Grid.Column=\"2\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Left\" Width=\"6\" Panel.ZIndex=\"1\" /&gt;\n        &lt;DataGrid x:Name=\"HistoryDataGrid\" Grid.Column=\"2\" AutoGenerateColumns=\"False\"\n                  DataContext=\"{Binding ElementName=MainDataGrid, Path=SelectedItem, Mode=OneWay}\" ItemsSource=\"{Binding Path=HistoryList}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"DateTime\" Binding=\"{Binding Path=TimeStamp, Mode=OneWay}\"/&gt;\n                &lt;DataGridTextColumn Header=\"Event Type\" Binding=\"{Binding Path=Description, Converter={StaticResource HistoryTypeConverter}, Mode=OneWay}\"/&gt;\n                &lt;DataGridTextColumn Header=\"Data\" Binding=\"{Binding Path=Data, Mode=OneWay}\" Width=\"80\"&gt;\n                    &lt;DataGridTextColumn.ElementStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"TextBlock.TextWrapping\" Value=\"Wrap\" /&gt;\n                            &lt;Setter Property=\"TextBlock.TextAlignment\" Value=\"Center\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/DataGridTextColumn.ElementStyle&gt;\n                &lt;/DataGridTextColumn&gt;\n                &lt;DataGridTextColumn Header=\"User\" Binding=\"{Binding Path=UserName, Mode=OneWay}\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n    &lt;Border Grid.Row=\"2\" Grid.ColumnSpan=\"3\"&gt;\n        &lt;TextBlock Text=\"Control Panel Goes here\" /&gt;\n    &lt;/Border&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>The Missing TreeView ItemTemplate:\n        \n        \n        \n            \n                \n                \n                    \n                        \n                    \n                \n            \n        \n    </p>\n\n<pre><code>&lt;HierarchicalDataTemplate x:Key=\"BatchesTemplate\" ItemsSource=\"{Binding Formats}\"&gt;\n    &lt;TextBlock Text=\"{Binding Path=BatchName}\" /&gt;\n    &lt;HierarchicalDataTemplate.ItemTemplate&gt;\n        &lt;HierarchicalDataTemplate&gt;\n            &lt;TextBlock Text=\"{Binding Name}\" /&gt;\n        &lt;/HierarchicalDataTemplate&gt;\n    &lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n&lt;/HierarchicalDataTemplate&gt;\n</code></pre>\n"},{"tags":["wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13095546,"title":"DataTemplating Binding not correct","body":"<p>I have the following code which Binds to properties within a ToolTip DataTemplate:</p>\n\n<pre><code>&lt;Window x:Class=\"WpfConcepts.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n       xmlns:telerikGrid=\"clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.GridView\"\n    xmlns:telerikData=\"clr-namespace:Telerik.Windows.Data;assembly=Telerik.Windows.Data\"\n    xmlns:telerikGridview=\"clr-namespace:Telerik.Windows.Controls.GridView;assembly=Telerik.Windows.Controls.GridView\"\n    xmlns:telerikInput=\"clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Input\" Width=\"200\" Height=\"480\"&gt;\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;  \n            &lt;ColumnDefinition Width=\"*\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;telerikGrid:RadGridView Grid.Column=\"0\" Grid.Row=\"0\" x:Name=\"FXRateGridView\" ItemsSource=\"{Binding CarList}\" ScrollViewer.HorizontalScrollBarVisibility=\"Visible\" ScrollViewer.VerticalScrollBarVisibility=\"Visible\" ColumnWidth=\"*\" MinColumnWidth=\"50\" AutoGenerateColumns=\"False\"&gt;\n            &lt;telerikGrid:RadGridView.Columns&gt;\n                &lt;telerikGrid:GridViewDataColumn&gt;\n                    &lt;telerikGrid:GridViewDataColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;TextBlock Text=\"{Binding Name}\"&gt;\n                                &lt;TextBlock.ToolTip&gt;\n                                    &lt;ToolTip&gt;\n                                        &lt;DataTemplate&gt;\n                                            &lt;StackPanel&gt;\n                                                &lt;TextBlock Text=\"{Binding Path=Colour}\"/&gt;\n                                            &lt;/StackPanel&gt;\n                                        &lt;/DataTemplate&gt;\n                                    &lt;/ToolTip&gt;\n                                &lt;/TextBlock.ToolTip&gt;\n                            &lt;/TextBlock&gt;\n                        &lt;/DataTemplate&gt; \n                    &lt;/telerikGrid:GridViewDataColumn.CellTemplate&gt;\n                &lt;/telerikGrid:GridViewDataColumn&gt;\n            &lt;/telerikGrid:RadGridView.Columns&gt;\n        &lt;/telerikGrid:RadGridView&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The tooltip displays as \"System.Window.DataTemplate\" which is not the desired effect since I'm expecting the Colour property value instead.\nIf I don't use a datatemplate within the ToolTip then I get the correct value, I assume my usage DataTemplate is not correct.</p>\n"},{"tags":["wpf","xaml","styles","application-settings"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1960,"score":5,"question_id":6156723,"title":"Error: 'Cannot create unknown type '{clr-namespace:NameSpace.Properties}Settings'.'","body":"<p>I have a bad-problem!!!\nI define my settings in style files in \"ResourceDictionary\" section, since 30 minutes ago, that worked, but now NO! Here is an example:</p>\n\n<pre><code>&lt;ResourceDictionary xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n                    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n                    xmlns:properties=\"clr-namespace:Kavand.UI.Properties\"&gt;\n    &lt;ResourceDictionary.MergedDictionaries&gt;\n        &lt;ResourceDictionary&gt;\n            &lt;properties:Settings x:Key=\"settings\" /&gt;\n        &lt;/ResourceDictionary&gt;\n    &lt;/ResourceDictionary.MergedDictionaries&gt;\n    &lt;Style x:Key=\"PopupMenu_StackPanel\"&gt;\n        &lt;Setter Property=\"TextBlock.FontSize\" Value=\"{Binding Source={StaticResource settings}, Path=Default.Font_Menu_Size}\" /&gt;\n        &lt;Setter Property=\"TextBlock.FontFamily\" Value=\"{Binding Source={StaticResource settings}, Path=Default.Font_Menu_Family}\" /&gt;\n        &lt;Setter Property=\"TextBlock.FontWeight\" Value=\"{Binding Source={StaticResource settings}, Path=Default.Font_Menu_Weight}\" /&gt;\n        &lt;Style.Resources&gt;\n            &lt;Style TargetType=\"{x:Type MenuItem}\" BasedOn=\"{StaticResource KavandMenuItem}\"&gt;\n                &lt;Style.Triggers&gt;\n                    &lt;Trigger Property=\"IsChecked\" Value=\"true\"&gt;\n                        &lt;Setter Property=\"IsEnabled\" Value=\"false\" /&gt;\n                    &lt;/Trigger&gt;\n                    &lt;MultiTrigger&gt;\n                        &lt;MultiTrigger.Conditions&gt;\n                            &lt;Condition Property=\"IsChecked\" Value=\"True\" /&gt;\n                            &lt;Condition Property=\"IsHighlighted\" Value=\"True\" /&gt;\n                        &lt;/MultiTrigger.Conditions&gt;\n                        &lt;Setter Property=\"Foreground\" Value=\"{DynamicResource K_Brush_Gray}\" /&gt;\n                    &lt;/MultiTrigger&gt;\n                &lt;/Style.Triggers&gt;\n            &lt;/Style&gt;\n        &lt;/Style.Resources&gt;\n    &lt;/Style&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>and when I run application, I give this error:</p>\n\n<blockquote>\n  <p>'Cannot create unknown type\n  '{clr-namespace:Kavand.UI.Properties}Settings'.'\n  Line number '6' and line position\n  '14'.</p>\n</blockquote>\n\n<p>Help me please... (crying)</p>\n"},{"tags":["c#","wpf","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13086456,"title":"Register double clicks on a row in a list view","body":"<p>I have the following list view in a user control. I would like to register a double click on the entire row. When a double click is registered, I would like to call an <code>ICommand</code> in my view model.</p>\n\n<p>Does anyone know how I can do this?</p>\n\n<p>I know there are other posts about this and I have tried the solutions found in them (using both MVVM Light and AttachedCommandBehavior) but either the double click is simply not registered or it tries to call the ICommand on my <code>TVSeries</code> object which is my model and which holds the data presented in the rows.</p>\n\n<p>This is my list view:</p>\n\n<p></p>\n\n<pre><code>&lt;ListView Height=\"456\"\n          HorizontalAlignment=\"Left\"\n          Margin=\"12,12,0,0\" \n          VerticalAlignment=\"Top\"\n          Width=\"488\"\n          ItemsSource=\"{Binding Path=Library}\"\n          SelectedItem=\"{Binding Path=SelectedTVSeries}\"&gt;\n\n    &lt;ListView.View&gt;\n\n        &lt;GridView&gt;\n\n            &lt;GridViewColumn Header=\"Name\"\n                            Width=\"Auto\"&gt;\n                &lt;GridViewColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBlock Text=\"{Binding Path=Name}\"\n                                   FontWeight=\"Bold\" /&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/GridViewColumn.CellTemplate&gt;\n            &lt;/GridViewColumn&gt;\n\n            &lt;GridViewColumn Header=\"Year\"\n                            Width=\"Auto\"&gt;\n                &lt;GridViewColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBlock Text=\"{Binding Path=Year}\" /&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/GridViewColumn.CellTemplate&gt;\n            &lt;/GridViewColumn&gt;\n\n            &lt;GridViewColumn Header=\"Genre\"\n                            Width=\"Auto\"&gt;\n                &lt;GridViewColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBlock Text=\"{Binding Path=Genre}\" /&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/GridViewColumn.CellTemplate&gt;\n            &lt;/GridViewColumn&gt;\n\n        &lt;/GridView&gt;\n\n    &lt;/ListView.View&gt;\n\n&lt;/ListView&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>When using <a href=\"http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/\" rel=\"nofollow\">AttachedCommandBehavior</a> I will get the following error:</p>\n\n<blockquote>\n  <p><strong>NullReferenceException was unhandled</strong></p>\n  \n  <p>Object reference not set to an instance of an object.</p>\n</blockquote>\n\n<p>The error occurs on the following lines (which are a part of AttachedCommandBehavior):</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>/// &lt;summary&gt;\n/// Executes the strategy\n/// &lt;/summary&gt;\npublic void Execute()\n{\n   strategy.Execute(CommandParameter);\n}\n</code></pre>\n\n<p>I use ACB like below. First I declare my style for the ListViewItem.</p>\n\n<p>&lt;-- language: xml --></p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;Style x:Key=\"LibraryListViewItemStyle\"\n           TargetType=\"{x:Type ListViewItem}\"&gt;\n        &lt;Setter Property=\"acb:CommandBehavior.Event\" Value=\"MouseDoubleClick\" /&gt;\n        &lt;Setter Property=\"acb:CommandBehavior.Action\" Value=\"{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedCommand}\" /&gt;\n        &lt;Setter Property=\"acb:CommandBehavior.CommandParameter\" Value=\"{Binding }\" /&gt;\n    &lt;/Style&gt;\n&lt;/UserControl.Resources&gt;\n</code></pre>\n\n<p>Then I set the <code>ItemContainerStyle</code> on my list view to the style.</p>\n\n<pre><code>&lt;ListView Height=\"456\"\n          HorizontalAlignment=\"Left\"\n          Margin=\"12,12,0,0\" \n          VerticalAlignment=\"Top\"\n          Width=\"488\"\n          ItemsSource=\"{Binding Path=Library}\"\n          SelectedItem=\"{Binding Path=SelectedTVSeries}\"\n          ItemContainerStyle=\"{StaticResource LibraryListViewItemStyle}\"&gt;\n\n...\n\n&lt;/ListView&gt;\n</code></pre>\n\n<p>Does anyone know how to fix this? This is really the closest I have been.</p>\n\n<p>** UPDATE: Solution**</p>\n\n<p>The above error occurred, because I have configured AttachedCommandBehavior to expect an action, but I had implemented a command. Changing from the following</p>\n\n<p><code>&lt;Setter Property=\"acb:CommandBehavior.Action\" Value=\"{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedCommand}\" /&gt;</code></p>\n\n<p>To the following</p>\n\n<p><code>&lt;Setter Property=\"acb:CommandBehavior.Command\" Value=\"{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedAction}\" /&gt;</code></p>\n\n<p>That solved the error.</p>\n\n<p>However, I found that I prefer using an action so I kept <code>acb:CommandBehavior.Action</code> and changed my implementation:</p>\n\n<pre><code>public Action&lt;object&gt; TVSeriesDoubleClickedAction\n{\n    get\n    {\n        return new Action&lt;object&gt;(tvSeries =&gt; Console.WriteLine(\"*** Double clicked fired: {0}\", ((TVSeries)tvSeries).Name));\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","wpfdatagrid","ellipse","datagridtemplatecolumn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13088252,"title":"WPF Unable to display Ellipse in DataGridTemplateColumn","body":"<p>I have an Ellipse in a DataGridTemplateColumn, the data it is bound to displays correctly in the next column but my ellipse column is always empty, nothing displayed.</p>\n\n<pre><code>&lt;DataGridTemplateColumn CanUserResize=\"False\" Header=\"StateEllipse\"&gt;\n    &lt;DataGridTemplateColumn.CellTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel&gt;\n                &lt;Ellipse Fill=\"{Binding Path=State, Converter={StaticResource StateToBrush}}\" Width=\"10\" Height=\"10\" /&gt;\n                &lt;TextBlock Text=\"{Binding Path=State}\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n&lt;/DataGridTemplateColumn&gt;\n&lt;DataGridTextColumn Header=\"State\" Binding=\"{Binding Path=State}\" /&gt;\n</code></pre>\n\n<p>My Converter looks like this :</p>\n\n<pre><code>using System;\nusing System.Globalization;\nusing System.Windows.Data;\nusing System.Windows.Media;\n\nnamespace ThisNS.NS.Converter\n{\n    [ValueConversion(typeof(int), typeof(Brush))]\n    public sealed class StateToBrush : IValueConverter\n    {\n\n    #region IValueConverter Members\n\n        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)\n        {\n            Color stateColor = Colors.Yellow;\n            switch ((int)value)\n            {\n                case 0:\n                    stateColor = Colors.Green;\n                    break;\n                case 1:\n                    stateColor = Colors.Red;\n                    break;\n            }\n            return new SolidColorBrush(Colors.Yellow);\n        }\n\n        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)\n        {\n            throw new NotImplementedException();\n        }\n\n    #endregion\n    }\n}\n</code></pre>\n\n<p>My second column that displays the State value is ok but the first one with the ellipse is always empty.</p>\n\n<p><strong>The converter is never called, so the binding is never binded.</strong></p>\n\n<p>Somebody has an idea/suggestion?</p>\n\n<p>Thank you.</p>\n"},{"tags":["wpf","templates","xaml","ribbon","title"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":663,"score":1,"question_id":7345422,"title":"Center WPF RibbonWindow Title via XAML Code","body":"<p>i've found some infos on stackoverflow regarding my problem, so I introduced the following xaml code to my window.\nNow everything is fine, while the wpf window hasn't quick launch icons or contextual tabs active.</p>\n\n<p>Is there a way to center the application title completely via XAML Code.\nThats my current one:</p>\n\n<pre><code>        &lt;ribbon:Ribbon.TitleTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;TextBlock TextAlignment=\"Center\" HorizontalAlignment=\"Stretch\" Width=\"{Binding ElementName=Window, Path=ActualWidth}\"&gt;ApplicationTitle\n                    &lt;TextBlock.Effect&gt;\n                       &lt;DropShadowEffect ShadowDepth=\"0\" Color=\"MintCream \" BlurRadius=\"10\"   /&gt;   \n                    &lt;/TextBlock.Effect&gt;\n                &lt;/TextBlock&gt;\n            &lt;/DataTemplate&gt;           \n        &lt;/ribbon:Ribbon.TitleTemplate&gt;\n</code></pre>\n"},{"tags":["c#","wpf","xaml","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13098792,"title":"ListView databinding not populating list items","body":"<p>im trying to bind a list-view with a generic list but it seems im doing something wrong.</p>\n\n<p>this is my collection</p>\n\n<pre><code>public ObservableCollection&lt;SharedFile&gt; searchResults;\n</code></pre>\n\n<p>this is the SharedFile Class</p>\n\n<pre><code>    public class SharedFile\n{\n    public string FileName { get; set; }\n    public long FileSize { get; set; }\n    public string FileLocation { get; set; }\n    public string Extention { get; set; }\n    public IPAddress publicFileIpAdress { get; set; }\n    public IPAddress privateFileIpAdress { get; set; }\n    public string FileUserName { get; set; }\n}\n</code></pre>\n\n<p>this is my xaml</p>\n\n<pre><code>        &lt;ListView Name=\"lsbSearchBox\" Grid.Row=\"1\" ItemsSource=\"{Binding Path=searchResults,ElementName=SearchPageRoot}\"&gt;\n        &lt;ListView.View&gt;\n            &lt;GridView&gt;\n                &lt;GridViewColumn Width=\"340\" Header=\"File Name\" DisplayMemberBinding=\"{Binding FileName}\" /&gt;\n                &lt;GridViewColumn Width=\"140\" Header=\"Size\" DisplayMemberBinding=\"{Binding FileSize}\"/&gt;\n                &lt;GridViewColumn Width=\"140\" Header=\"User Name\" DisplayMemberBinding=\"{Binding FileName}\"/&gt;\n            &lt;/GridView&gt;\n        &lt;/ListView.View&gt;\n    &lt;/ListView&gt;\n</code></pre>\n\n<p>after hitting the \"search\" button im filling the collection with data and at the end im setting the datacontext (but nothing happens)</p>\n\n<pre><code>lsbSearchBox.DataContext = this;\n</code></pre>\n\n<p>What am i doing wrong here ?</p>\n"},{"tags":["wpf","datagrid","datagridrowheader"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":34,"score":-2,"question_id":13091479,"title":"Add an empty DataGridRow","body":"<p><img src=\"http://i.stack.imgur.com/e9t12.png\" alt=\"enter image description here\"></p>\n\n<p>I use the WPF DataGrid. I want it to be filled in empty DataGridRows. (Like in the iTunes) Is there a parameter that does it automatically?</p>\n\n<p>I dont have code example.this is a Regular datagrid that contains info but you can\nsee in the image how it should look like..somw empty rows to fill the datagrid.\nhow can I do this?</p>\n"},{"tags":[".net","wpf","task-parallel-library"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":13012629,"title":"Catching exceptions in tasks","body":"<p>My base ViewModel, implemented a couple years ago, provides this extension method for running tasks while keeping the UI responsive*:</p>\n\n<pre><code>protected void Work(Action job)\n{\n    IsBusy = true;\n    var stackTrace = new StackTrace();\n    var task = Task.Factory.StartNew(job)\n        .ContinueWith(failedTask =&gt; HandleException(failedTask, stackTrace), \n                      TaskContinuationOptions.OnlyOnFaulted)\n        .ContinueWith(_ =&gt; { IsBusy = false; });\n}\n\nvoid HandleException(Task task, StackTrace stackTrace)\n{\n    Dispatcher.BeginInvoke(\n        () =&gt; { throw new Exception(task.Exception.InnerException.ToString() + \n                                    stackTrace); });\n}\n</code></pre>\n\n<p><code>IsBusy</code> is a property observed from the UI to display a progress bar.</p>\n\n<p>The idea behind <code>HandleExceptions</code> is that they are observed and then thrown in the UI thread, caught by a <code>try/catch</code> block in the <code>Main()</code> method and logged before displaying a friendly message to the user and safely closing the app. The stackTrace is passed so the log includes the caller information.</p>\n\n<p>However, I recently started getting reports of the application crashing without logging, nor friendly messages, with this Windows dialog:</p>\n\n<p><img src=\"http://i.stack.imgur.com/wQqAb.png\" alt=\"crash\"></p>\n\n<p>Looking at the Windows event log, we got this EventData:</p>\n\n<blockquote>\n  <p>Application: ASRC.ShareholderApplication.Loader.exe</p>\n  \n  <p>Framework Version: v4.0.30319</p>\n  \n  <p>Description: The process was terminated due to an unhandled exception.</p>\n  \n  <p>Exception Info: System.AggregateException</p>\n  \n  <p>Stack: at System.Threading.Tasks.TaskExceptionHolder.Finalize()</p>\n</blockquote>\n\n<p>Am I doing anything wrong with <code>ContinueWith()</code>?</p>\n\n<p>Is it possible for task exceptions to somehow stay unobserved?</p>\n\n<hr>\n\n<p><sub>\n*: I know about <code>BackgroundWorker</code>. This probably seemed like a better idea at the time, or had additional benefits.\n</sub></p>\n"},{"tags":["c#",".net","wpf","c#-4.0","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13014141,"title":"Deploying WPF Aplication with Custom Folder using Click Once?","body":"<p>I have developed a WPF Application and my solution includes 11 projects, some of the project has some custom folder like Templates,Images,Documents. When I build my application, I get all these folders in the bin directory, because I have set </p>\n\n<pre><code>Build Action : Content\nCopy to output Directory : Copy always\n</code></pre>\n\n<p>But when I publish my application using <code>ClickOnce</code>, these folders are not published to my <code>/publish</code> folder.</p>\n\n<p>Can anyone help me in sorting this out. I want these custom folders in the published folder.</p>\n"},{"tags":["c#","wpf","user-interface","inotifypropertychanged","expandoobject"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":198,"score":4,"question_id":12954279,"title":"UI does not update with list of ExpandoObject","body":"<p>I have implemented the dynamic dataGrid by following <a href=\"http://stackoverflow.com/questions/1983033/how-do-i-dynamically-generate-columns-in-a-wpf-datagrid\">this</a> link.</p>\n\n<p>I am using Converter to bind the values from <code>ExpandoObject</code>. The columns shows values like total units for schools.</p>\n\n<pre><code>Item      ItemCount DefaultSchool School1  School2 School3\n\nX-Item    200       100           50       50      0\n</code></pre>\n\n<p>Schools can be added dynamically at any time. Now if I add the School4 with 40 units, I want to deduct the same from default school (DefaultSchool = 60, School4 = 40).</p>\n\n<p>I can make this calculations in the converter and the ItemsSource also shows the updated value but it does not reflect on the UI.</p>\n\n<p>What I use the TextBox's <code>LostFocus</code> event with <code>MyDataGrid.Items.Refresh</code>, it does update the UI, but every time on lost focus, the UI will also flickers, just like a refreshing web page).</p>\n\n<p>I just need to update the current row. As I am using <code>ExpandoObject</code>, I can't use the <code>INotifyPropertyChanged</code> (I believe?), so what should be the best approach in this scenario?</p>\n\n<p>So how should I update the UI?</p>\n"},{"tags":["wpf","entity-framework","dependency-injection","unity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13098427,"title":"wpf architecture advice","body":"<p>I'm working on an app to be created in wpf. I want to structure the app with logical layers so have a solution with following projects:\nModel - entity framework classes representing db structure\nData - contains data context and the repository, unitwork, databasefactory classes and the interfaces for these.\nPresentation - actual wpf application with my views and view models.</p>\n\n<p>I wanted to implement unity based dependency injection to have my repositories injected into the view models but am stuck. Everytime i attempt to navigate to my view i get object not set to instance error, but doesn't indicate where.</p>\n\n<p>Does anyoneknow of a nice starter example that follows the pattern above? </p>\n\n<p>Thanks for any help you can offer.</p>\n"},{"tags":["c#","wpf","xaml","mvvm","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13097973,"title":"Why is Display being ignored?","body":"<p>I've got a DataGrid, which is bound to the following window and model class:</p>\n\n<pre><code>public partial class AttributesWindow\n    {\n        public ObservableCollection&lt;AttributesModel&gt; ItemsSource { get; set; }\n\n        private readonly List&lt;string&gt; _fields = new List&lt;string&gt;(new[] { \"Test1\", \"Test2\" });\n        public ObservableCollection&lt;AttributesModel&gt; itemsSource { get; set; }\n        private DatabaseTable parentDatabaseTable = null;\n\n        public AttributesWindow(DatabaseTable parentDatabaseTable)\n        {\n            this.parentDatabaseTable = parentDatabaseTable;\n            InitializeComponent();\n            DataContext = this;\n            itemsSource = new ObservableCollection&lt;AttributesModel&gt;(_fields.Select(f =&gt; new AttributesModel(f)));\n        }\n    }\n\npublic class AttributesModel\n    {\n        public string Field { get; private set; }\n\n        [Display(Name = \"Sort Order\")]\n        public SortOrder SortBy { get; set; }\n\n        [Display(Name = \"Group By\")]\n        public string GroupBy { get; set; }\n\n        [Display(Name = \"Having\")]\n        public string Having { get; set; }\n\n        [Display(Name = \"Display Order\")]\n        public string DisplayOrder { get; set; }\n\n        [Display(Name = \"Aggregate By\")]\n        public Aggregate AggregateBy { get; set; }\n\n        public enum Aggregate\n        {\n            None,\n            Sum,\n            Minimum,\n            Maximum,\n            Average\n        }\n\n        public enum SortOrder\n        {\n            Unsorted,\n            Ascending,\n            Descending\n        }\n\n        public AttributesModel(string field)\n        {\n            Field = field;\n        }\n    }\n</code></pre>\n\n<p>For some reason or other, the <code>[Display(Name = \"Sort Order\")]</code> properties are all being ignored, and the headers of my DataGrid are taking on the property names.</p>\n\n<pre><code>&lt;DataGrid Name=\"dgAttributes\" \n                  ItemsSource=\"{Binding itemsSource}\" \n                  AutoGenerateColumns=\"True\" \n                  CanUserAddRows=\"False\" \n                  CanUserDeleteRows=\"False\" \n                  CanUserReorderColumns=\"False\" \n                  CanUserResizeColumns=\"False\" \n                  CanUserResizeRows=\"False\"\n                  CanUserSortColumns=\"False\"\n                  ColumnWidth=\"Auto\"\n                  &gt;\n&lt;/DataGrid&gt;\n</code></pre>\n"},{"tags":["c#",".net","wpf","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13067895,"title":"How to bind ItemsSource to multiple collections?","body":"<p>I have a few sources that expose an <code>ObservableCollection&lt;MyData&gt;</code> property. Now I want to bind <code>ListBox.ItemsSource</code> to all of them and support <code>CollectionChanged</code> notifications, sorting and filtering. How to do that? <code>CompositeCollection</code> doesn't support filtering.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13079610,"title":"Equivalent of glOrtho in WPF","body":"<p>In OpenGL I can do this:</p>\n\n<pre><code>glOrtho(-10, 10, -10, 10, -1, 1)\n</code></pre>\n\n<p>to establish a coordinate system where x ranges from -10 to 10 and y ranges from -10 to 10.</p>\n\n<p>Is there a way to change the coordinate system of a canvas in WPF?</p>\n"},{"tags":["wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13065389,"title":"MediaElement not playing mp3","body":"<p>I'm trying to play mp3 file using MediaElement control.</p>\n\n<p>If I put this control directly on my main wpf window, it's working.</p>\n\n<p>But now I'm want to create a class and playing the mp3.  So I have a class :</p>\n\n<pre><code> class Player\n    {\n        private MediaElement media;\n        public MediaElement MyMedia\n        {\n            get { return media; }\n            set { media = value; }\n        }\n\n\n        public Player()\n        {\n            media = new MediaElement();\n            media.LoadedBehavior = MediaState.Manual;\n            media.Source = new Uri(@\"C:\\Users\\DELL\\Downloads\\Music\\yumeji.mp3\",UriKind.RelativeOrAbsolute);\n            media.Play();\n        }\n\n\n    }\n</code></pre>\n\n<p>But it's not working.</p>\n\n<p>EDIT:</p>\n\n<p>I use this code, </p>\n\n<pre><code>  MediaPlayer m = new MediaPlayer();\n  m.Open(new Uri(@\"C:\\Users\\DELL\\Downloads\\Music\\yumeji.mp3\"));\n  m.Play();\n</code></pre>\n\n<p>When i use this, it is play mysound for 3 second and then stop .</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13096933,"title":"FromArgb vs FromScRgb","body":"<p>Should these two expressions result in colors which are roughly the same?</p>\n\n<pre><code>Color.FromArgb(255, 255, 255, (byte)0.25 * 255))\n\nColor.FromScRgb(1.0f, 1.0f, 1.0f, 0.25f))\n</code></pre>\n\n<p>This test program demonstrates that they show up with seemingly different alpha values:</p>\n\n<pre><code>using System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Media;\nusing System.Windows.Shapes;\n\nnamespace Test_FromArgb_FromScRbg\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            var panel = new StackPanel();\n\n            Content = panel;\n\n            panel.Children.Add(\n                new Rectangle()\n                {\n                    Width = 100,\n                    Height = 100,\n                    Fill = new SolidColorBrush(\n                        Color.FromArgb(\n                            255, \n                            255, \n                            255, \n                            (byte)0.25 * 255))\n                });\n\n            panel.Children.Add(\n                new Rectangle()\n                {\n                    Width = 100,\n                    Height = 100,\n                    Fill = new SolidColorBrush(\n                        Color.FromScRgb(\n                            1.0f,\n                            1.0f,\n                            1.0f,\n                            0.25f))\n                });\n        }\n    }\n}\n</code></pre>\n\n<p>Here's what the demo program looks like on my system:</p>\n\n<p><img src=\"http://i.stack.imgur.com/IGW7m.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","wpf","events","button","click"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":13096688,"title":"Button click event to affect a different window","body":"<p>I have a WPF application (Window 1) with a ScrollViewer on it.  I have a second window that is apart of the same WPF application, that has a button on it.  </p>\n\n<p>When I click the button on the second window, I want it to add an item to the ScrollViewer on the first window.  </p>\n\n<p>How can I accomplish this?  Sorry if this is vague, I'm not sure how to ask this question.</p>\n"},{"tags":["wpf","listbox","styles"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2496,"score":1,"question_id":1412879,"title":"WPF: Apply ScrollBar Style to ListBox Template - Error object cannot be added to border","body":"<p>I thought this may be straightforward question but did not find any definitive answer while searching net or SO. </p>\n\n<p>I have created a <code>ScrollBar</code> style (using standard scroll bard template - Blend 2) </p>\n\n<p>I am not sure how to apply this style \"MyScrollStyle\" to a <code>ListBox</code> Template . </p>\n\n<p>I saw on <code>ListBox</code> template they have a <code>ScrollViewer</code> --> which should contain the <code>ScrollBar</code>.</p>\n\n<p>Assuming it is something simple as:</p>\n\n<pre><code>&lt;Setter Property =\"Template\" value=\"{Static Resource  MyScrollStyle}\"/&gt;\n</code></pre>\n\n<p>---Content Added---</p>\n\n<p>After going through lot of xaml in template edit I kind of understood how to apply style. I am trying to add the  scroll view style set in this example -http://blog.xamltemplates.net/wp-content/uploads/2008/12/scrollviewer.zip, to my list view template but it gives the following error:</p>\n\n<pre><code>System.Windows.Markup.XamlParseException was unhandled\n  Message=\"'ScrollViewer' object cannot be added to 'Border'. Exception has been thrown by the target of an invocation.  Error at object 'System.Windows.Controls.ScrollViewer' in markup file 'MenuModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null;component/resources/Resources.xaml' Line 19 Position 26.\"\n  Source=\"PresentationFramework\"\n  LineNumber=19\n  LinePosition=26\n  NameContext=\"1_T\"\n</code></pre>\n\n<p>Any help is appreciated</p>\n\n<p>Thank you,\nThe Mar</p>\n"},{"tags":["wpf","usercontrols","drag-and-drop"],"answer_count":7,"favorite_count":6,"up_vote_count":6,"down_vote_count":0,"view_count":7948,"score":6,"question_id":510572,"title":"How to enable user to drag/drop WPF user controls anywhere on the page?","body":"<p>Now that I can make useful user controls in WPF (thanks to <a href=\"http://stackoverflow.com/questions/507832/how-to-read-a-passed-parameter-in-a-wpf-usercontrol/508738#508738\">this stackoverflow answer</a>) I want to be able to put numerous user controls on one page in two columns and enable the user to be able to move them around according to preference, dragging the ones they use the most to the top, etc.</p>\n\n<p>Can anyone point me to code, tutorials, etc. which do this? I can imagine this has been made quite easy to do in WPF.</p>\n"},{"tags":["wpf","usercontrols"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1480,"score":3,"question_id":2757540,"title":"Access WPF user control value","body":"<p>I have 2 text box in WPF user control and button on WPF form. How can I access those textbox value on the button click event of that main form where I am using the WPF user control</p>\n"},{"tags":["c#","wpf","xaml","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13095733,"title":"Xdesproc xaml wpf does not work in vs 2012","body":"<p>Xaml does not preview in vs 2012 &amp; Xdesproc.exe dump the memory.</p>\n"},{"tags":["wpf","binding","datatemplate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":5678826,"title":"How to retrieve an element from a DataTemplate and bind to it?","body":"<p>I am trying to get a handle on an element within my DataTemplate in code.  I am creating a series of DataGridTemplateColumns in code which I then assign to a grid.\nI want to be able to retrieve the DataTemplate from the xaml, find my element and bind to  that particular element. </p>\n\n<p>Here is a short sample code what I am trying to achieve: </p>\n\n<pre><code>&lt;DataTemplate x:Key=\"dataTemplate\"&gt;\n    &lt;Grid TextBlock.Foreground=\"LightGreen\" Background=\"Yellow\"&gt;\n        &lt;TextBlock x:Name=\"txt\" /&gt;\n    &lt;/Grid&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n\n\n<pre><code>DataGridTemplateColumn col = new DataGridTemplateColumn();\ncol.Header = \"Last Name\";\nBinding b = new Binding(\"LastName\");\nDataTemplate dtemplate = (DataTemplate)FindResource(\"dataTemplate\");\nTextBlock textBlock = dtemplate.FindName(\"txt\", this);\ntextBlock.SetBinding(TextBlock.TextProperty, b);\ncol.CellTemplate = dtemplate;\n\ngrid.Columns.Add(col);\n</code></pre>\n\n<p><strong>Maybe to explain this further:</strong>\nI am trying to create a set of DataGridTemplateColumns on the fly and apply that to a Datagrid. Since I don't know the property to bind to until the time a source gets presented to me I cannot create a DataTemplate that nested within itself has this binding already build in.  Like:</p>\n\n<pre><code>&lt;TextBlock Text={Binding=LastName} ... &gt;\n</code></pre>\n\n<p>So I am forced to create a set of DataGridTemplateColumn in runtime, look for DataTemplate in my resources and THEN try to bind that column to a property (like LastName) on my datasource.</p>\n"},{"tags":["wpf","animation","stackpanel","codeplex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13094714,"title":"Animating a stackpanel using Artefact","body":"<p>I'm trying to get animation working using Artefact Animator: <a href=\"http://artefactanimator.codeplex.com/\" rel=\"nofollow\">Artefact on Codeplex</a></p>\n\n<p>The relevant XAML:</p>\n\n<pre><code>    &lt;Button x:Name=\"adminButton\"\n       Content=\"Admin Console\"\n       HorizontalAlignment=\"Left\"\n       Margin=\"25,215,0,0\"\n       VerticalAlignment=\"Top\"\n       Width=\"98\"\n       Click=\"adminPanelCall\"/&gt;\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>    &lt;StackPanel x:Name=\"adminPanel\"\n       Width=\"300\"\n       Background=\"#FFD4D4D4\"\n       Margin=\"750,0,0,0\" /&gt;\n</code></pre>\n\n<p>In the code behind I have:</p>\n\n<pre><code>private void adminPanelCall(object sender, RoutedEventArgs e)\n    {\n        ArtefactAnimator.AddEase(adminPanel, Margin.Left, 500, 1, AnimationTransitions.CubicEaseInOut, 0);\n    }\n</code></pre>\n\n<p>I'm referencing the WPF .dll and have made sure to include 'using Artefact.Animation;'  I'm guessing the property I'm trying to animate is not correct?</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["wpf","validation","listview","virtualization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":10598144,"title":"How do validation for virtualized listview?","body":"<p>I have some listView with userControl in ItemTemplate. This UserControl contains some textBoxes that I need to validate. Everything works fine till I enabled Virtualization for ListView. Now validation work only for visible items.</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["wpf","infragistics","xamdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12902703,"title":"how to implement xamcheckeditor disable style","body":"<p>when you bind bool value to xamdatagrid, the column will automatically use xamcheckeditor to display the data. I want to use an outer button to control the allowedit of a checkbox column, and when i change the allowedit property, the checkbox in the column will apply disable/enable style(turn gray)\nIn my resource dictionary, i write a style for xamcheckeditor:</p>\n\n<pre><code>&lt;ControlTemplate.Triggers&gt;\n    &lt;Trigger Property=\"IsReadOnly\" Value=\"True\"&gt;\n        &lt;Setter TargetName=\"PART_FocusSite\" Property =\"IsEnabled\" Value=\"False\" /&gt;\n     &lt;/Trigger&gt;\n&lt;/ControlTemplate.Triggers&gt;\n</code></pre>\n\n<p>So when the field is not editable, the checkbox would show as disabled.</p>\n\n<p>I also have a button to control the allowedit of the column, when the button get click, it will invoke:</p>\n\n<pre><code>grid.FieldsLayouts[0].Fields[\"Enabled\"].Settings.AllowEdit = true/false\n</code></pre>\n\n<p>But the enable/disabled action is not applied automatically, i have to click the filter to refresh the grid to get them applied...</p>\n\n<p>Please advise what should i do to implement once click the button to set the filed allowedit, the checkboxs will be enabled automatically.</p>\n\n<p>Thanks!</p>\n\n<p>Enzhou</p>\n"},{"tags":["c#","wpf","com"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13094577,"title":"WPF app inside a COM","body":"<p>I have an existing WPF app that takes a single command line argument, loads some data from a database based on that argument, allows a user to manipulate some of that data, and on exit generates an XML file.</p>\n\n<p>What I would like to do now is wrap that WPF app inside a COM (.dll) so that it can be launched from a new accounting system we are installing.  The new accounting software has a method in place to launch a COM passing in some XML or arguments and accept any returned XML data, but it has to be a COM, I can't make this work by launching an exe.</p>\n\n<p>Does anyone have any tips and/or links to some guidelines on making this work?</p>\n"},{"tags":["c#",".net","wpf","usercontrols","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13094508,"title":"Resize body of a WebBrowser as UserControl","body":"<p>I am developing a screen, and this screen I have a grid. Within this grid, I have a UserControl WebBrowser. I'm using this component to display XML formatted and syntax is highlighted (with color). The text to be displayed is done via Binding, so that the component is a UserControl, as was done for the same modifications accepted Binding (since the original does not accept content via Binding). But I'm experiencing the following problem: when the user resizes the screen of the program at a certain point, the body of the WebBrowser beyond the boundaries of the grid, making the screen is strange at the bottom of the Grid.\nI tested with other components, and this problem does not occur.</p>\n\n<p>Behold my UserControl:</p>\n\n<pre><code>&lt;UserControl x: Class = \"Geraes.Library.Core.GUI.WPF.Controls.XmlBrowserControl\" \nxmlns = \"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns: x = \"http://schemas.microsoft.com/winfx/2006/xaml\"\nx: Name = \"thisControl\"&gt;\n   &lt;Grid Margin=\"0,0,0,0\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\"&gt;\n     &lt;WebBrowser Name=\"WebBrowser\" VerticalAlignment=\"Stretch\" HorizontalAlignment=\"Stretch\" /&gt;\n   &lt;/ Grid&gt;\n&lt;/ UserControl&gt;\n</code></pre>\n\n<p>And here, how I use it:</p>\n\n<pre><code>&lt;ct:XmlBrowserControl XmlDoc=\"{Binding ContentString}\" Grid.Row=\"1\" /&gt;\n</code></pre>\n\n<p>Again, I can't understand why this is happening, since other components works as well inside this grid. </p>\n\n<p>Another thing: we're using WebBrowser because until this moment, it's the best component to show a XML formatted and with syntax-colour. But if you know another one than its better and easy to use, i'm accepting suggestions.\nAny help is welcome.</p>\n\n<p>Best regards, \nGustavo.</p>\n"},{"tags":["wpf","xaml","templates","calendar","control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13094399,"title":"Can you manipulate the calendar control template via code and not XAML, if so how?","body":"<p>Can you manipulate the calendar control template via code and not XAML, if so how?</p>\n\n<p>I have a calendar control that I would like to change the default template via C# and not XAML.</p>\n"},{"tags":["wpf","wpf-controls","wpftoolkit","wpf-usercontrols"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13059812,"title":"What is the string Fromat for alphabet in WPF?","body":"<p>I want to write a String.Fromat in alphabet can you please tell How to write it I know the pattern for currency but don't know the alphabet.Can i write StringFormat = \"{}{A-Z,a-z}\" for alphabet.....</p>\n\n<pre><code>    StringFormat=\"{}{0:C}\"\n</code></pre>\n\n<p>I am doing validation.I want to enter only Alphabets in textBox need First letter Uppercase rest of lower letter .When i enter any numeric value then it show me a error,but use any WPF Validation,but i don't know how to do use the StringFormat for alphabets</p>\n"},{"tags":["wpf","button","listbox","scroll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13094309,"title":"Paging ListBox in Wpf with buttons","body":"<p>I'm trying to set up a control (2 actually) for paging up and down in a ListBox. The Listbox is limited in size and you can only see the rest of the items if you use the scrollbar. I already have controls set up so that when you press an up or down arrow, it will go through each item one at a time. This can be very tedious if there are say, 235 items. Because this program is designed for touchscreen users, I need to make buttons that can page up and down on the ListBox. Is there some way to link these buttons to the scrollbar and set it up so that the selected item will be the item on top of the current page? I have looked at other questions on this site, and I was referred to horizontal paging (This is NOT what I'm looking to do). I couldn't find many other articles that would have helped me.</p>\n\n<p>Any help offered is much appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf",".net-4.0","scrolling"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3388,"score":0,"question_id":5975737,"title":"WPF DataGrid horizontal scrollbar not showing","body":"<p>I have created simple DataGrid with 4 columns, which go outside the bounds of DataGrid, and horizontal scrollbar is not showing. I tried setting width to each column but nothing changed. Here is my XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"WPFTest.Window1\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n    &lt;Grid&gt;\n        &lt;DataGrid Height=\"200\" Width=\"200\" HorizontalScrollBarVisibility=\"Visible\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Column 1\" /&gt;\n                &lt;DataGridTextColumn Header=\"Column 2\" /&gt;\n                &lt;DataGridTextColumn Header=\"Column 3\" /&gt;\n                &lt;DataGridTextColumn Header=\"Column 4\" /&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>And here is what I get:</p>\n\n<p><img src=\"http://i.stack.imgur.com/wpo1G.png\" alt=\"enter image description here\"></p>\n\n<p>I have also tried wrapping DataGrid with ScrollViewer. Nothing. How can I make scrollbar appear?</p>\n"},{"tags":["c#","wpf","xaml","mvvm","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13092218,"title":"Binding combobox in a DataGrid","body":"<p>I've got the following model class set as the source of my <code>DataGrid</code>:</p>\n\n<pre><code>public class AttributesModel\n    {\n        public string Field { get; private set; }\n\n        [Display(Name = \"Sort Order\")]\n        public SortOrder SortBy { get; set; }\n\n        [Display(Name = \"Group By\")]\n        public string GroupBy { get; set; }\n\n        [Display(Name = \"Having\")]\n        public string Having { get; set; }\n\n        [Display(Name = \"Display Order\")]\n        public string DisplayOrder { get; set; }\n\n        [Display(Name = \"Aggregate By\")]\n        public Aggregate AggregateBy { get; set; }\n\n        public enum Aggregate\n        {\n            None,\n            Sum,\n            Minimum,\n            Maximum,\n            Average\n        }\n\n        public enum SortOrder\n        {\n            Unsorted,\n            Ascending,\n            Descending\n        }\n\n        public AttributesModel(string field)\n        {\n            Field = field;\n        }\n    }\n</code></pre>\n\n<p>I'm basically trying to bind the columns in my DataGrid, with the prpoerties above.  They all work except for the <code>enums</code> which are set up for the combo box columns.</p>\n\n<p>I cannot seem to get the comboboxes to bind.  This is what I've tried:</p>\n\n<pre><code>&lt;DataGridComboBoxColumn Width=\"Auto\" CanUserResize=\"False\" CanUserReorder=\"False\" CanUserSort=\"False\" IsReadOnly=\"False\" ItemsSource=\"{Binding ElementName=AttributesWindow, Path=SortOrder}\"&gt;\n                    &lt;DataGridComboBoxColumn.Header&gt;Order&lt;/DataGridComboBoxColumn.Header&gt;\n                &lt;/DataGridComboBoxColumn&gt;\n</code></pre>\n"},{"tags":["wpf","infragistics","xamdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12680515,"title":"How to change the style of fix field splitter for xamdatagrid(infragistics)?","body":"<p>I am using Infragistics XamDataGrid to show my data, but the end user think the splitter is too wide which make them feel uncomfortable.</p>\n\n<p>Wondering how to change the style of that splitter to make its width smaller.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","usercontrols","multi-touch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13091088,"title":"Moving Two Controls at Once","body":"<p>I'm currently working on trying to simulate a virtual gamepad in my WPF 4.0 project.\nI wrote a custom control that registers for Touch Down/Move/Up.</p>\n\n<p>Up and Down are used to capture or release the TouchDevice.\nMove is used to calculate the direction and distance from center.</p>\n\n<p>The problem I've run into when testing on the tablet is that when I try to use both controls, the response time slows down significantly to the point that they don't move until further movement seizes.</p>\n\n<p>I've tried blocking multiple checks in the touch move by adding a flag that, once it's been calculated once, skips over it. The flag gets reset in my Update function (within the control). Same result.</p>\n\n<p>Just looking for suggestions on how I could go about fixing this issue.</p>\n\n<p>Edit: I'd still like suggestions, but I may have solved my issue in a different manner.</p>\n"},{"tags":[".net","wpf","surface-tablet","surface-rt"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":722,"score":2,"question_id":11104657,"title":"Microsoft Surface Tablet: Writing Apps for Both Devices?","body":"<p>I'm having trouble finding info right now; it might still be too early. But I'm curious if developers will be able to easily write an application that can target both the ARM and Intel versions of the tablet.</p>\n\n<p>I would guess that the ARM version of Windows will come with near full .NET support and that VS2012 would have new templates that can target both device types, no?</p>\n"},{"tags":["wpf","windows","xaml","xbap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":13093294,"title":"XAML, WPF and Windows 8","body":"<p>I'm hoping someone here can explain to me the difference between WPF and XAML exactly in this context:</p>\n\n<p>I have an application (an XBAP specifically) written in VB.NET using MVVM &amp;  Repository Pattern, implementing the the usual INotifyPropertyChanged, OLEDB etc etc.</p>\n\n<p>The front end of the application is written in XAML.</p>\n\n<p>From what I understand there is nothing specifically \"WPF\" about this application. In my view its XAML + VB.NET; where does the WPF come in? Given windows 8 and the \"death of Silverlight/WPF\" that I keep hearing about, what should I be doing to \"upgrade\" my application to ensure its future?</p>\n\n<p>I would greatly appreciate someone clearing up this confusion for me.</p>\n"},{"tags":["wpf","styles","stylesheet","groupbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13089885,"title":"WPF GroupBox Style not being applied on custom control","body":"<p>I have created a custom control so simply draw the border of a geroupbox in red if there is an error. for some reason when I use the control the foreground colour doesn't get set correctly it defaults to white instead of green. My code is as follows:</p>\n\n<pre><code>public class ErrorGroupBox : GroupBox\n{\n    static ErrorGroupBox()\n    {\n    }\n\n    public bool ErrorState\n    {\n        get { return (bool)GetValue(ErrorStateProperty); }\n        set { base.SetValue(ErrorStateProperty, value); }\n    }\n\n    public static readonly DependencyProperty ErrorStateProperty =\n      DependencyProperty.Register(\"ErrorState\", typeof(bool), typeof(ErrorGroupBox), new UIPropertyMetadata(false));\n}\n</code></pre>\n\n<p>The style is:</p>\n\n<pre><code>&lt;Style x:Name=\"ErrorGroupBox\" TargetType=\"local:ErrorGroupBox\"&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"Green\"/&gt;\n    &lt;Setter Property=\"BorderThickness\" Value=\"2\"/&gt;\n    &lt;Setter Property=\"FontFamily\" Value=\"Tahoma\"/&gt;\n    &lt;Setter Property=\"FontSize\" Value=\"13\"/&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"GroupBox\"&gt;\n                &lt;Grid SnapsToDevicePixels=\"True\" Margin=\"5\"&gt;\n                    &lt;Grid.ColumnDefinitions&gt;\n                        &lt;ColumnDefinition Width=\"6\"/&gt;\n                        &lt;ColumnDefinition Width=\"Auto\"/&gt;\n                        &lt;ColumnDefinition Width=\"*\"/&gt;\n                        &lt;ColumnDefinition Width=\"6\"/&gt;\n                    &lt;/Grid.ColumnDefinitions&gt;\n                    &lt;Grid.RowDefinitions&gt;\n                        &lt;RowDefinition Height=\"Auto\"/&gt;\n                        &lt;RowDefinition Height=\"Auto\"/&gt;\n                        &lt;RowDefinition Height=\"*\"/&gt;\n                        &lt;RowDefinition Height=\"6\"/&gt;\n                    &lt;/Grid.RowDefinitions&gt;\n\n                    &lt;!--&lt;Border Background=\"{TemplateBinding Background}\" BorderBrush=\"Transparent\" \n                         BorderThickness=\"{TemplateBinding BorderThickness}\" \n                         CornerRadius=\"4\" Grid.Column=\"1    \" Grid.ColumnSpan=\"4\" \n                         Grid.Row=\"1\" Grid.RowSpan=\"3\" HorizontalAlignment=\"Stretch\"/&gt;--&gt;\n\n                    &lt;!--The Title--&gt;\n                    &lt;Border x:Name=\"Header\" Grid.Column=\"2\" Grid.RowSpan=\"2\" HorizontalAlignment=\"Left\" \n                        Padding=\"3,1,3,0\" VerticalAlignment=\"Stretch\" &gt;\n                        &lt;Border.Effect&gt;\n                            &lt;DropShadowEffect BlurRadius=\"5\" Direction=\"334\"/&gt;\n                        &lt;/Border.Effect&gt;\n\n                        &lt;ContentPresenter SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\" \n                             Content=\"{TemplateBinding Header}\" \n                             ContentSource=\"Header\" \n                             ContentStringFormat=\"{TemplateBinding HeaderStringFormat}\" \n                             ContentTemplate=\"{TemplateBinding HeaderTemplate}\" \n                             RecognizesAccessKey=\"True\" Height=\"Auto\" \n                             VerticalAlignment=\"Center\"\n                             HorizontalAlignment=\"Center\"\n                             OpacityMask=\"#FF3844BD\" Margin=\"0,1,0,0\"&gt;\n                        &lt;/ContentPresenter&gt;\n                    &lt;/Border&gt;\n\n                    &lt;ContentPresenter Margin=\"5\" \n    SnapsToDevicePixels=\"{TemplateBinding SnapsToDevicePixels}\" \n    Content=\"{TemplateBinding Content}\" \n    ContentStringFormat=\"{TemplateBinding ContentStringFormat}\" \n    ContentTemplate=\"{TemplateBinding ContentTemplate}\" \n    Grid.Column=\"1\" Grid.ColumnSpan=\"2\" Grid.Row=\"2\" /&gt;\n                    &lt;Border BorderBrush=\"#BFBFBF\" BorderThickness=\"{TemplateBinding BorderThickness}\" \n                        CornerRadius=\"4\" Grid.ColumnSpan=\"3\" Grid.Row=\"1\" Grid.RowSpan=\"3\" RenderTransformOrigin=\"0.5,0.5\" Margin=\"0\"&gt;\n                        &lt;Border.OpacityMask&gt;\n                            &lt;MultiBinding ConverterParameter=\"7\" UpdateSourceTrigger=\"Default\"&gt;\n                                &lt;MultiBinding.Converter&gt;\n                                    &lt;BorderGapMaskConverter/&gt;\n                                &lt;/MultiBinding.Converter&gt;\n                                &lt;Binding Path=\"ActualWidth\" ElementName=\"Header\"/&gt;\n                                &lt;Binding Path=\"ActualWidth\" RelativeSource=\"{RelativeSource Self}\"/&gt;\n                                &lt;Binding Path=\"ActualHeight\" RelativeSource=\"{RelativeSource Self}\"/&gt;\n                            &lt;/MultiBinding&gt;\n                        &lt;/Border.OpacityMask&gt;\n                    &lt;/Border&gt;\n                &lt;/Grid&gt;\n                &lt;ControlTemplate.Triggers&gt;                    \n                    &lt;Trigger Property=\"local:ErrorGroupBox.ErrorState\" Value=\"True\"&gt;\n                        &lt;Setter Property=\"Foreground\" Value=\"Green\"/&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"local:ErrorGroupBox.ErrorState\" Value=\"False\"&gt;\n                        &lt;Setter Property=\"Foreground\" Value=\"Green\"/&gt;\n                    &lt;/Trigger&gt;\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>I use the control as follows:</p>\n\n<pre><code>    &lt;controls:ErrorGroupBox ErrorState=\"{Binding Error}\" Header=\"Test Type\" Margin=\"20,20,0,0\" Name=\"groupBox1\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Top\" Width=\"226\" Grid.Column=\"0\"&gt;\n</code></pre>\n"},{"tags":["c#","wpf","command","scintilla"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13091144,"title":"ScintillaNet and RoutedCommands","body":"<p>I am using a ScintillaNet edit control in my C# WPF application. In my main window I have a few RoutedCommands setup. The ScintillaNet control is hosted inside a WindowsFormsHost. The RoutedCommands are not working when the ScintillaNet control has focus.</p>\n\n<p>I tried capturing the key strokes and manually executing the RoutedCommands but CanExecute always fails:</p>\n\n<pre><code>WindowsFormsHost wfh = new WindowsFormsHost();\nScintilla editor = new Scintilla();\nwfh.Child = editor;\nwfh.Child.PreviewKeyDown += new System.Windows.Forms.PreviewKeyDownEventHandler(Child_PreviewKeyDown);\n\n....\n\nvoid Child_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e)\n{\n    if (e.KeyData == Keys.F5)\n        // Window1 is the main window class\n        // handle is a reference to the main window\n        if (Window1.CmdRun.CanExecute(wfh, handle)) {\n            Window1.CmdRun.Execute(wfh, handle);\n        }\n        else {\n            Console.WriteLine(\"CANT EXECUTE\");\n        }\n    }\n}\n</code></pre>\n\n<p>Can anyone tell me how to do this correctly?</p>\n\n<p>Thanks</p>\n"},{"tags":["wpf","caret","passwordbox"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1449,"score":3,"question_id":935769,"title":"WPF PasswordBox Caret","body":"<p>Is there a way to hide or move the PasswordBox's caret?</p>\n"},{"tags":["wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1884,"score":2,"question_id":3169328,"title":"How to get ComboBox.SelectedText in WPF","body":"<p>In WPF ComboBox does not have SelectedText property.</p>\n\n<p>Is there a way to achieve the same functionality as TextBox SelectedText has in WPF</p>\n"},{"tags":["wpf","mvvm","binding","textbox","listboxitem"],"answer_count":4,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":2768,"score":5,"question_id":2960098,"title":"Set ListBoxItem.IsSelected when child TextBox is Focused","body":"<p>I have a typical MVVM scenario:\nI have a ListBox that is binded to a List of StepsViewModels. \nI define a DataTemplate so that StepViewModels are rendered as StepViews.\nThe StepView UserControl have a set of labels and TextBoxs.</p>\n\n<p>What I want to do is to select the ListBoxItem that is wrapping the StepView when a textBox is focused. I've tried to create a style for my TextBoxs with the following trigger:</p>\n\n<pre><code>&lt;Trigger Property=\"IsFocused\" Value=\"true\"&gt;\n    &lt;Setter TargetName=\"{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBoxItem}}}\" Property=\"IsSelected\" Value=\"True\"/&gt;\n&lt;/Trigger&gt;\n</code></pre>\n\n<p>But I get an error telling me that TextBoxs don't have an IsSelected property. I now that but the Target is a ListBoxItem. \nHow can I make it work?</p>\n"},{"tags":["c#","wpf","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13092441,"title":"MVVM listview bind to dictionary selecteditem issue","body":"<p>I am using MVVM and I have a listview which is binded to a dictionary in my viewmodel. In my xaml, I've set up the selecteditem to set the correct selected item but unfortunately what I'm doing doesnt work. If I change it to selectedindex with the property datatype changed to int, I'm able to set it. Here's my view.</p>\n\n<p>View(xaml)</p>\n\n<pre><code>&lt;Grid Width=\"auto\" Grid.Column=\"0\" Grid.Row=\"1\" HorizontalAlignment=\"Left\" Margin=\"0,1,0,0\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"auto\"&gt;&lt;/RowDefinition&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"188\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;ListView Name=\"lstNewPatient\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Bottom\" \n         Height=\"auto\" Margin=\"0,0,0,0\" ItemsSource=\"{Binding Path=TestList}\" SelectedItem=\"{Binding Path=SelectedTestItem}\" \n         FontSize=\"11\" SelectionMode=\"Single\"&gt;\n        &lt;ListView.View&gt;\n            &lt;GridView&gt;\n                &lt;GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;Style&gt;\n                        &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                    &lt;/Style&gt;\n                &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n            &lt;/GridView&gt;\n        &lt;/ListView.View&gt;\n    &lt;/ListView&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>ViewModel</p>\n\n<pre><code>Dictionary&lt;int, string&gt; selectedTestItem= null;\npublic Dictionary&lt;int, string&gt; SelectedTestItem\n{\n    get \n    { \n        return selectedTestItem; \n    }\n    set\n    {\n        selectedTestItem = value;\n        OnPropertyChanged(\"SelectedTestItem\");\n    }\n}\n\nprivate Dictionary&lt;int, string&gt; TestList()\n{\n    var newTestList = new Dictionary&lt;int, string&gt;();\n\n    newTestList.Add(1, \"Apple\");\n    newTestList.Add(2, \"Car\");\n    newTestList.Add(3, \"Laptop\");\n\n\n    return newPtLevelList;\n}\n</code></pre>\n"},{"tags":["wpf","focus","usercontrols","focusmanager"],"answer_count":13,"favorite_count":9,"up_vote_count":25,"down_vote_count":0,"view_count":21216,"score":25,"question_id":673536,"title":"WPF - Can't set focus to a child of UserControl","body":"<p>I have a <code>UserControl</code> which contains a <code>TextBox</code>.  When my main window loads I want to set the focus to this textbox so I added <code>Focusable=\"True\" GotFocus=\"UC_GotFocus\"</code> to the <code>UserControl</code>s definition and <code>FocusManager.FocusedElement=\"{Binding ElementName=login}\"</code> to my main windows definition.  In the <code>UC_GotFocus</code> method i simply call <code>.Focus()</code> on the control i want to focus on but this doesn't work.</p>\n\n<p>All i need to do is have a <code>TextBox</code> in a <code>UserControl</code> receive focus when the application starts.</p>\n\n<p>Any help would be appreciated, thanks.</p>\n"},{"tags":["wpf","animation","focus","togglebutton"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":342,"score":0,"question_id":5948447,"title":"WPF: How to remove the focused animation of a togglebutton?","body":"<p>I have some toggle buttons in a listbox. When I uncheck a toggle button, an animation is run on the button, making him \"blink\" from grey to blue constantly.</p>\n\n<p>How could I stop this animation from being played, so that it stays gray, even while it is focused?</p>\n\n<p>Thanks in advance</p>\n\n<p>Mike</p>\n"},{"tags":["c#","wpf","autocomplete"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":927,"score":2,"question_id":3572299,"title":"autocompletebox focus in wpf","body":"<p>when I try to focus on my \"autocompletetextbox\" I failed I write <code>autocompletetextbox.focus()</code>\nbut the cursor still focus in another what should I do or write to enable to write in it or focus?</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2416,"score":6,"question_id":1095763,"title":"How to set a Wpf Window as the Owner of a Winforms Form","body":"<p>How to set a System.Windows.Window as the Owner of a System.Windows.Forms.Form?</p>\n\n<p>After I searched for this for a while only to realize that I already have the answer in one of my utils classes I decided to put the answer on stackoverflow. Hopefully someone finds this useful.</p>\n"},{"tags":["c#",".net","wpf","file-io"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":909,"score":0,"question_id":2532381,"title":"Opening a file from a pack URI in WPF","body":"<p>I am looking to open a .csv file from the application pack to do some unit testing. So what I would really love is some analog to File.ReadAllText(string path) which is instead X.ReadAllText(Uri uri). I haven't as yet been able to find this.</p>\n\n<p>Does anyone know if it is possible to read text / bytes (don't mind which) from a file in the pack without compiling this file to disk first? </p>\n\n<p>Oh and btw, File.ReadAllText(@\"pack://application:,,,/SpreadSheetEngine/Tests/Example.csv\") didn't work for me.. and I am already doing the \"var app = new Application()\" trick to make sure I have a pack started up during my unit test.</p>\n\n<p>Thanks in advance..</p>\n\n<p>Gav</p>\n"},{"tags":["c#","wpf","mvvm","caliburn.micro"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13088358,"title":"MVVM, use new Windows or Views?","body":"<p>After finishing some by-hand projects, my recent project implements the MVVM pattern using Claiburn.Micro - but I still struggle with some architectural problems. Mainly:</p>\n\n<p>My ViewModel contains a <code>BindableCollection</code> <code>ProfilesCollection</code> of <code>Profiles</code>. My view has a button to add new profiles. But since the profiles are complex I want the button click to open a new Window where I can fill in the details, and then return back to the main window. </p>\n\n<p>In my previous by hand approach I made the <code>ProfilesCollection</code> static so that it was accessible throughout the whole application, and as click event I just opened a new window, where I then stored the new profile in the static <code>Collection</code>.</p>\n\n<p>What would be the right MVVM approach? Create a new view/ viewmodel instead of a new window? How do I manage them, and how do I pass the <code>Profile</code> I create back to the MainViewModel? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","drag-and-drop","wsdl","scrollbar"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13091802,"title":"scrollbar initializes DragMove() in WPF","body":"<p>i built a weather app that gets the weather for major cities in the world. i used wsdl to download the weather data in xml and then i get the desired data from the elements by using XmlDocument class. i display this information in a textbox. i set the HorizontalScrollBarVisibility &amp; VerticalScrollBarVisibility of the textbox to auto so it displays a scrollbar should the text be too long. i have also implemented a _MouseLeftButtonDown listener because i have removed the title bar from my app. however everytime the scrollbar is displayed and i click it, the DragMove() method is called and thus i cannot scroll through the text. </p>\n\n<p>how can i prevent this from happening?</p>\n\n<p>here's my code, it only works with the GlobalWeather and Countries classes i converted from wsdl. if you want i can post the code or you can download the wsdl of these classes and convert it to .cs...</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Xml;\n\nnamespace WeatherApp\n{\n    /// &lt;summary&gt;\n    /// Interaktionslogik für Window1.xaml\n    /// &lt;/summary&gt;\n    public partial class Window1 : Window\n    {\n        // http://www.webservicex.net/globalweather.asmx?WSDL\n        private static GlobalWeather wetterObjekt;\n        //http://www.webservicex.net/ws/WSDetails.aspx?WSID=17&amp;CATID=7\n        Country country;\n        private static string wetter;\n        private static string wetterAktuell;\n        private static List&lt;string&gt; countryList;\n        private static List&lt;string&gt; cityList;\n\n        public Window1 ()\n        {            \n            InitializeComponent ();            \n            wetterAktuell = \"\";\n            wetter = \"\";\n            wetterObjekt = new GlobalWeather ();   \n            country = new Country ();\n            countryList = new List&lt;string&gt; ();\n            cityList = new List&lt;string&gt; ();\n            getCountries ();\n            string firstStr = \"(keins ausgewählt)\";\n            object firstItem = firstStr;\n            txtStadt.Items.Add(firstItem);\n            txtStadt.SelectedIndex = 0;\n            txtLand.SelectedIndex = 0;\n            txtWetter.IsEnabled = false;\n            txtLand.SelectionChanged += new SelectionChangedEventHandler ( txtLand_SelectionChanged );\n        }\n\n        private void txtLand_SelectionChanged ( object sender, SelectionChangedEventArgs e )\n        {\n            Console.WriteLine(cityList.Count);\n            if (cityList.Count &gt; 0)\n            {\n                txtStadt.Items.Clear();\n                cityList.Clear();\n                string firstStr = \"(keins ausgewählt)\";\n                object firstItem = firstStr;\n                txtStadt.Items.Add(firstItem);\n                txtStadt.SelectedIndex = 0;                \n            }\n            if ((string)(txtLand.SelectedValue) == \"(keins ausgewählt)\")\n            {\n                return;\n            }\n            else\n            {                \n                string land = \"\";\n                land = txtLand.SelectedValue.ToString();\n                getStadt(land);\n\n                //Console.WriteLine(wetterObjekt.GetCitiesByCountry(land));\n                //Console.WriteLine(land);\n            }\n        }\n\n        private void getStadt (string land)\n        {\n            XmlDocument document = new XmlDocument();\n            document.LoadXml(wetterObjekt.GetCitiesByCountry(land));\n            XmlNodeList nl = document.GetElementsByTagName(\"NewDataSet\");\n            for (int x = 0; x &lt; nl[0].ChildNodes.Count; x++)\n            {\n                for (int y = 1; y &lt; nl[0].ChildNodes[x].ChildNodes.Count; y += 2)\n                {\n                    cityList.Add(nl[0].ChildNodes[x].ChildNodes[y].InnerText);\n                }\n            }\n\n            cityList.Sort();\n\n            for (int x = 0; x &lt; cityList.Count; x++)\n            {\n                txtStadt.Items.Add(cityList[x]);\n\n            }\n        }\n\n        private void getCountries()\n        {\n            string countries = country.GetCountries ();\n            XmlDocument document = new XmlDocument ();\n            document.LoadXml ( countries );\n            XmlNodeList nl = document.GetElementsByTagName ( \"NewDataSet\" );\n            string firstStr = \"(keins ausgewählt)\";\n            object firstItem = firstStr;\n            txtLand.Items.Add(firstItem);\n            for ( int x = 0; x &lt; nl [0].ChildNodes.Count; x++ )\n            {\n                for ( int y = 0; y &lt; nl [0].ChildNodes [x].ChildNodes.Count; y++ )\n                {                    \n                    countryList.Add ( nl [0].ChildNodes [x].ChildNodes [y].InnerText );\n                }\n            }\n            for ( int i = 0; i &lt; countryList.Count; i++ )\n            {\n                txtLand.Items.Add ( countryList [i] );                \n            }\n        }\n\n        private void getWeather ( string stadt, string land )\n        {\n            try\n            {\n                wetter = wetterObjekt.GetWeather(stadt, land);\n                xmlParsen(wetter);\n                txtWetter.Text = wetterAktuell;\n            }\n            catch (System.Xml.XmlException e)\n            {\n                clearWetterTextBox();\n                txtWetter.Text = \"Keine Wetterdaten gefunden!\";\n                //Console.WriteLine(\"Keine Wetterdaten gefunden!\");\n            }\n        }\n\n        private void btnSchliessen_Click ( object sender, RoutedEventArgs e )\n        {\n            this.Close ();\n        }\n\n        private void xmlParsen (string wetter)\n        {\n            XmlDocument document = new XmlDocument ();\n            try\n            {\n                document.LoadXml(wetter);\n                XmlNodeList nl = document.GetElementsByTagName(\"CurrentWeather\");\n                for (int i = 0; i &lt; nl[0].ChildNodes.Count; i++)\n                {\n                    wetterAktuell = wetterAktuell + (nl[0].ChildNodes[i].Name + \": \" + nl[0].ChildNodes[i].InnerText) + \"\\n\";\n                }\n            }\n            catch (System.Xml.XmlException e)\n            {\n                throw new System.Xml.XmlException();\n            }            \n        }\n\n        private void btnGetWetter_Click ( object sender, RoutedEventArgs e )\n        {            \n            clearWetterTextBox ();\n            getWeather (txtStadt.Text, txtLand.Text);\n        }\n\n        private void clearWetterTextBox ()\n        {\n            wetterAktuell = \"\";\n            this.txtWetter.Clear ();\n        }\n\n        private void Window_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n        {            \n            DragMove();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["wpf","multi-touch"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12553011,"title":"WPF, Why manipulation is not reposnsive?","body":"<p>When manipulating a framework element on a canvas, it works fine, but, the manipulation events keeps get fired event after I raise my fingers, as a result the framework element will keep get manipulated <strong><em>after</em></strong> fingers are raised up from the screen.</p>\n\n<p>It behaves as a stream of events keeps arriving after figures raised up.</p>\n\n<p>Is there any reason that would buffer touch events ?! or is there any performance tips to consider when working with manipulation ?</p>\n\n<p>For example, shall I freeze the framework element before manipulate it ?</p>\n\n<p>p.s: I am not using ManipulationInertiaStarting event</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13091322,"title":"Delete Image Issue","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5116260/c-sharp-4-0-unlock-image-after-creating-bitmapimage\">C# 4.0 unlock image after creating BitmapImage</a>  </p>\n</blockquote>\n\n\n\n<p>I have this code to create an Image file in WPF.</p>\n\n<pre><code>var newimage = new System.Windows.Controls.Image\n{\n    Stretch = Stretch.Fill,\n    StretchDirection = StretchDirection.Both,\n    Width = Width,\n    Height = Height\n};\n\nvar logo2 = new BitmapImage();\nlogo2.BeginInit();\nlogo2.UriSource = uri;\nlogo2.EndInit();\nnewimage.Source = logo2;\n</code></pre>\n\n<p>After this some process have to delete ol file and create a new one but I'm facing an error </p>\n\n<blockquote>\n  <p>\"Cannot delete file because it is being used by another process\"</p>\n</blockquote>\n\n<p>What should I do to fix this issue?</p>\n\n<p>Thank you!</p>\n\n<hr>\n\n<p><strong>P.S.</strong></p>\n\n<p>I delete the file using this:</p>\n\n<pre><code>try\n{\n    if (File.Exists(fileName))\n    {\n        File.Delete(fileName);\n        Debug.WriteLine(\"FILE MANAGER: File \" + fileName + \" has been deleted.\");\n    }\n    return true;\n}\n</code></pre>\n"},{"tags":["wpf","wpfdatagrid","wpf-usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":530,"score":0,"question_id":8944822,"title":"Initial DataGrid Sorting","body":"<p>I have a user control that contains a WPF toolkit DataGrid. This control is used in many different places in my app. The grid has no knowledge as to the type of data that will show. Is there a way to initially sort the grid by the first column in ascending order no matter what data the grid is populated with? I don't think I can use a CollectionViewSource because i don't know the PropertyName of the property bound to the first column. </p>\n"},{"tags":[".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":536,"score":1,"question_id":1923013,"title":"WPF .Resx editor for localization","body":"<p>I am looking for a simple tool that allows the translators to edit .resx files, in order to translate the applications' texts.</p>\n\n<p>Visual Studio's Windows Resource Localization Editor is unable to edit these files, unlike Winforms applications.</p>\n\n<p>Any suggestions?</p>\n\n<p><hr></p>\n\n<p><strong>Edit</strong>: I've found a nice free <a href=\"http://www.codeproject.com/KB/aspnet/ZetaResourceEditor.aspx?msg=3220081\" rel=\"nofollow\">tool at CodeProject</a> that does excatly what I needed, including simultanously editing multiple resources files and adding keys to all files at once.<br/></p>\n"},{"tags":["c#","sql-server","wpf","linq","view"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13089863,"title":"Is SQL View faster than Table while using Linq?","body":"<p>My WPF application has a lookup screen for selecting customers. The customer table contain nearly 10,000 records. Its very slow when loading and filtering records using my Linq query(I am not doing any ordering of records). Is there a way to increase speed? Heard about using indexed views. Can someone please give some ideas?</p>\n\n<pre><code>lstCustomerData = dbContext.customers.Where(c =&gt; c.Status == \"Activated\").ToList();\n            dgCustomers.ItemsSource = lstCustomerData;\n</code></pre>\n\n<p>filtering:</p>\n\n<pre><code> string searchKey = TxtCustName.Text.Trim();\n\n            var list = (from c in lstCustomerData\n                        where (c.LastName == null ? \"\" : c.LastName.ToUpper()).Contains(searchKey.ToUpper())\n                        select c).ToList();\n            if (list != null)\n                dgCustomers.ItemsSource = list;\n</code></pre>\n"},{"tags":["wpf","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13089771,"title":"ConverterParameter Usage","body":"<p>I have a basic question regarding the usage of ConverterParameter. In the sense - I can always create a collection of types in my viewmodel and pass it to the converter during Binding. </p>\n\n<p>And then in my convert method - I can do multiple if check statements and return accordingly</p>\n\n<pre><code>public object Convert(object value, Type targetType, object parameter, CultureInfo culture)\n{\n\n}\n</code></pre>\n\n<p>So the question is what exactly are the scenarios of using a ConverterParameter which just justifies it usage. </p>\n\n<p>Please note - I am not asking how to use a ConverterParameter - i have done that - more interested when to use it</p>\n"},{"tags":["c#","wpf","dynamic","datagrid","datacontext"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13090056,"title":"finding DataGrid row datacontext type at runtime","body":"<p>I want to write a wrapper user control for the wpf datagrid. What I would like to do is to have a button in the usercontrol to add items to datagrid. On clicking the button a window should pop up where the user can enter data. </p>\n\n<p>Is it possible to find out the datacontext of the datagrid row to create an instance of the type.Pseudocode as follows.</p>\n\n<pre><code> OnAddItem()\n {\n      Type type = myGrid.GetDataContextTypeatRowLevel();\n      var obj = Activator.CreateInstance(type);\n      Window win = new Window();\n      win.DataContext = obj;\n      if(win.DoModal() == OK)\n      {\n         ((Collection)myGrid.Datacontext).Add(win.DataContext);\n      }\n\n  }\n</code></pre>\n\n<p>Is it possible? </p>\n"},{"tags":["wpf","multithreading","dispatcher","print-preview"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":249,"score":4,"question_id":11358647,"title":"How to access separate thread generated WPF UI elements from the Dispatcher thread?","body":"<p>I need to generate a print preview (a long one) using wpf UI elements like FixedDocument, FlowDocument, PageContent, BlockUIContainer and all those. To keep my UI responsive i'm doing this part on a separate Thread class thread (BackgroundWorker won't work since i need an STA thread). Everything is OK upto this point.<br>\nBut after displaying the print preview now i need to print, and clicking Print icon on the generated preview throws the infamous \"The calling thread cannot access this object because a different thread owns it.\" exception. So, is there any way around? </p>\n\n<p>EDIT (CODE):  </p>\n\n<pre><code>Dispatcher.CurrentDispatcher.Invoke(new Action(() =&gt;  \n    {  \n        Thread thread = new Thread(() =&gt;  \n            {  \n                FixedDocument document = renderFlowDocumentTemplate(report);  \n                PrintPreview preview = new PrintPreview();  \n                preview.WindowState = WindowState.Normal;  \n                preview.documentViewer.Document = document;  \n                preview.ShowDialog();  \n            });  \n        thread.SetApartmentState(ApartmentState.STA);  \n        thread.Start();  \n    }));`\n</code></pre>\n\n<p>Ok here, the RenderFlowDocumentTemplate() generates the print preview (which contains the UI elements) and fills the them with Report data. PrintPreview is a custom window that contains a DocumentViewer element that actually holds and displays the preview, and contains the Print icon, upon clicking which i'm supposd to get the PrintDialog window.  </p>\n\n<p>EDIT (XAML):  </p>\n\n<pre><code>&lt;cw:CustomWindow x:Class=\"MyApp.Reports.PrintPreview\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:cw=\"clr-namespace:MyApp.UI.CustomWindows;assembly=MyApp.UI.CustomWindows\"&gt;    \n    &lt;DocumentViewer Margin=\"0,30,0,0\" Name=\"documentViewer\"&gt;&lt;/DocumentViewer&gt;\n&lt;/cw:CustomWindow&gt;`\n</code></pre>\n"},{"tags":["c#",".net","wpf"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13087438,"title":"How to implement a SearchByID?","body":"<p>Good afternoon all!</p>\n\n<p>As a part of getting a better grip on some of the most aspects of object based programming, I've started to attempt something far larger than I have done in the past. Hereby I'm trying to learn about inheritance, code reuse, using classes far more extensively, and so on.\nFor this purpose I am trying to piece together all the parts required for a basic RPG/dungeon crawler.\nI know this has been done a billion times before, but I find that actually trying to code something like it takes you through a lot more problems than you might think, which is a great way to learn (I think).</p>\n\n<p>For now I have only loaded up a WPF application, since my interest is 95% on being able to piece together the working classes, routines, functions, etc. And not so much interested in how it will look. I am actually reading up on XNA, but since I am mostly trying to get a grip on the basic workings, I don't want to complicate those aspects with the graphical side of things just yet.</p>\n\n<p>The problem I am now facing is that when I would a character to attack or defend, it should know from which other character it came, or to which one it should be pointed. I figured I could either use a GUID, or a manually appointed ID. But the problem is that I don't really know how I can implement such a thing.\nThe thing that I figured was that I could maybe add a reference to an array (Character[]), and have a SearchByID function loop through them to find the right one, and return it. Like so:</p>\n\n<pre><code>internal Character SearchByID(string _ID)\n{\n   foreach(Character charToFind in Character[])\n   {\n       if(charToFind.ID == _ID)\n       return charToFind;\n   }\n}\n</code></pre>\n\n<p>This of course has to be altered a bit due to the return at the moment, but just to give you an idea.\nWhat I am stuck on is how to create the appropriate array outside of the \"Character\"-class? I can fill it up just fine, but how do I go about having it added above class level?\nThe way the \"Character\"-class is built up is that every new character instantiates from the Character class. The constructor then loads the appropriate values. But other than this, I see no possibility to initialize an array outside of this.</p>\n\n<p>If it is preferable to post the entire code that I have, that will be no problem at all!</p>\n\n<p>Thanks for any insights you may provide me with.</p>\n"},{"tags":["c#","c++",".net","wpf","string"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":110,"score":3,"question_id":13089296,"title":"Failing to use String.Format in C#","body":"<p>I am a C++ developer and shifted to wpf last week. Well I have used sprintf in my c++ apps many time and now I have across the need of having something equivalent to that in C#. Here is what I had done is C++:</p>\n\n<pre><code>char t_str[4] = {};\nfor(int i = 0; i &lt; 4; i++)\n{ \n    sprintf(t_str, \"%02X\", buffer[i]);\nm_apiResponse[i]-&gt;setText(String(t_str));\n}\n</code></pre>\n\n<p>where <code>buffer[0] = 20;\n                buffer[1] = 30;\n                buffer[2] = 40;\n                buffer[3] = 50;</code> and <code>m_apiResponse</code> is a textbox.</p>\n\n<p>I had done this in my C# as follows:</p>\n\n<pre><code>Byte[] t_str = new Byte[4];\nfor (int i = 0; i &lt; 4; i++)\n{\n         string bufstring = String.Format(\"{0:02}\", buffer[i]);\n         t_str = Encoding.UTF8.GetBytes(bufstring);\n}\n\nResponse1Box = Convert.ToString(t_str[0]);\nResponse2Box = Convert.ToString(t_str[1]);\nResponse3Box = Convert.ToString(t_str[2]);\nResponse4Box = Convert.ToString(t_str[3]);\n</code></pre>\n\n<p>where ResposeBox is a textbox which I have bind to:</p>\n\n<pre><code>// Description of Response1Box\n    private string _Response1Box;\n    public string Response1Box\n    {\n        get\n        {\n            return _Response1Box;\n        }\n\n        set\n        {\n            _Response1Box = value;\n            OnPropertyChanged(\"Response1Box\");\n        }\n    }\n</code></pre>\n\n<p><code>buffer[64]</code> is byte[]. </p>\n\n<p>Its not giving me the expected answer which my C++ method does. Is this the right way to do: <code>string bufstring = String.Format(\"{0:02}\", buffer[i]);\n             t_str = Encoding.UTF8.GetBytes(bufstring);</code> Where am i wrong???</p>\n\n<p>Please help :)</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13089947,"title":"KeyboardNavigation.TabNavigation order for WPF Application","body":"<p>I have a WPF Application that has bunch of Custom Controls and Expanders. I want to implement proper TabNavigation Order for each UI controls. I can use TabNavigation.Index property in all UI controls but I have many dynamic UI elements and I don't know how to adjust indices for those UI elements. The following sample MainWindow XAML and one CustomControl. </p>\n\n<p>MainWindow.xaml:</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"*\"/&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;!-- Main view (auto-sizing Grid) --&gt;\n    &lt;libControls:SizingPanel Grid.Row=\"1\" KeyboardNavigation.TabNavigation=\"Cycle\"\n                             Visibility=\"{Binding StatusMessage.IsVisible, Converter={StaticResource InvertedBoolToVisibility}}\"&gt;\n\n        &lt;!-- Hook SizeChanged for auto sizing grid; Need to be careful about how much we trigger this event because it can infinitely recurse --&gt;\n        &lt;Expander Name=\"Expander1\"\n                  Header=\"Expander1\" \n                  IsExpanded=\"True\" \n                  Style=\"{StaticResource ExpanderStyle}\"\n                  KeyboardNavigation.TabIndex=\"1\"&gt;\n            &lt;controls:CustomListControl x:Name=\"CustomControl\" KeyboardNavigation.TabIndex=\"2\"\n                                             DataContext=\"{Binding ListViewModel}\"/&gt;\n        &lt;/Expander&gt;\n\n        &lt;Expander Name=\"Expander2\"\n                  Header=\"Expander2\" \n                  Style=\"{StaticResource ExpanderStyle}\" \n                  IsExpanded=\"True\"\n                  libControls:SizingPanel.ExtraSpacePriority=\"1\"&gt;\n            &lt;controls:CustomListControl1 x:Name=\"CustomListControl1\"\n                                   DataContext=\"{Binding ListViewModel}\" \n                                   ResetScroll=\"{Binding ResetScroll, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"/&gt;\n        &lt;/Expander&gt;\n\n        &lt;Expander Name=\"Expander3\"\n                  Header=\"Expander3\" \n                  Style=\"{StaticResource ExpanderStyle}\" \n                  IsExpanded=\"True\"\n                  libControls:SizingPanel.ExtraSpacePriority=\"1\"&gt;\n            &lt;controls:CustomListControl2 x:Name=\"CustomList2\"\n                                   DataContext=\"{Binding ListViewModel}\" \n                                   ResetScroll=\"{Binding ResetScroll, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"/&gt;\n        &lt;/Expander&gt;\n    &lt;/libControls:SizingPanel&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>CustomListControl.xaml:</p>\n\n<pre><code>&lt;DockPanel LastChildFill=\"True\" KeyboardNavigation.TabNavigation=\"Continue\"&gt;\n    &lt;DockPanel&gt;\n        &lt;TextBlock&gt;\n            &lt;Hyperlink Command=\"{Binding HitMe}\"\n                       Name=\"HitMe\"&gt;\n                HitMe\n            &lt;/Hyperlink&gt;\n        &lt;/TextBlock&gt;\n        &lt;TextBlock&gt;\n            &lt;Hyperlink Command=\"{Binding Cancel}\"\n                       Name=\"Cancel\"&gt;\n                Cancel\n            &lt;/Hyperlink&gt;\n        &lt;/TextBlock&gt;\n    &lt;/DockPanel&gt;\n    &lt;DockPanel&gt;\n        &lt;Button&gt;\n\n        &lt;/Button&gt;\n        &lt;TextBox&gt;\n\n        &lt;/TextBox&gt;\n    &lt;/DockPanel&gt;\n\n    &lt;ListBox&gt;\n        &lt;!-- Adding bunch of elements dynamically \n             How to adjust TabNavigation Indices for all these dynamic elements???? --&gt;\n        &lt;!-- Data Template for each ListBox element that contains DockPanel with TextBlock and button --&gt;\n    &lt;/ListBox&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p>Within one expander I have custom control that contains set of textblocks, Buttons and ListBox and the elements of ListBox are being added dynamically by clicking add and cancel buttons. In this scenario, how do I adjust my tabnavigation indices?</p>\n\n<p>If I set TabNavigation.TabIndex to parent UI element, how do I make sure that Children will start from that index and continue in tree format. For example, parent has index = 1, then it's immediate children should have index = 2 and so on upto k children. \nNext sibling of parent, should start from the number of k+1 as index.</p>\n\n<p>Could you please help me with this? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","wpf","binding","staticresource"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13089912,"title":"WPF StaticResourceExtension limitation","body":"<p>In order to speed up rendering, I've taken all the commonly used images in my application and put them into a ResourceDictionary. The other problem was that the icon to be displayed will depend at runtime on the value of a property on each of the bound objects. Eg the property is called \"CurrencyImg\" and represents the currency of the object, and at runtime it needed to look up the dictionary by key and display the correct currency flag.</p>\n\n<p>The only way I found to do this was by creating a new class that extends StaticResourceExtension, code below. </p>\n\n<p>The problem now though is that I want to be able to update the dependencyproperty CurrencyImg when the user clicks on a \"convert USD\" button and to set all the flag properties to USD, and to have the values update instantly. I have gotten it working with Amount and CurrencyName fields which are just straight data bindings, but Im guessing that because Im using a STATIC resource binding for the CurrencyFlag, when I update the dependency property CurrencyImg, nothing gets fired to update the GUI. </p>\n\n<p>What is the solution, Ive seen another class DynamicResourceExtension but don't fully understand it and when I just substituted it in, it just crashed. Any thoughts?</p>\n\n<p>XAML is</p>\n\n<pre><code>&lt;Image Name=\"imgCurrency\"  Grid.Column=\"5\" Margin=\"0,0,0,0\"  Source=\"{y:ImageStaticResource {Binding CurrencyImg}}\" Height=\"25\" VerticalAlignment=\"Center\" /&gt;\n</code></pre>\n\n<p>Code is</p>\n\n<pre><code>public class ImageStaticResource : StaticResourceExtension\n{\n    public Binding Binding { get; set; }\n    private static readonly DependencyProperty DummyProperty;\n\n    public ImageStaticResource()\n    {\n    }\n\n    public ImageStaticResource(Binding binding)\n    {\n        Binding = binding;\n    }\n\n    static ImageStaticResource()\n    {\n        DummyProperty = DependencyProperty.RegisterAttached(\n            \"Dummy\", \n            typeof (Object), \n            typeof (DependencyObject),\n            new UIPropertyMetadata(null));\n    }\n\n    public override object ProvideValue(IServiceProvider serviceProvider)\n    {\n        var target = (IProvideValueTarget)serviceProvider.GetService(typeof(IProvideValueTarget)); \n        var targetObject = (FrameworkElement)target.TargetObject; \n\n        Binding.Source = targetObject.DataContext; \n        var DummyDO = new DependencyObject(); \n        BindingOperations.SetBinding(DummyDO, DummyProperty, Binding); \n\n        ResourceKey = DummyDO.GetValue(DummyProperty);\n\n        var resourceDictionary = new ResourceDictionary\n                                     {\n                                         Source = new Uri(\"pack://application:,,,/View/Images.xaml\")\n                                     };\n\n        var key = (string) ResourceKey;            \n        if (!resourceDictionary.Contains(key)) ResourceKey = \"Default\";\n\n        return base.ProvideValue(serviceProvider);\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","wpf","wpf-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13089541,"title":"Optimizing WPF 4.0 TreeView Scrolling performance","body":"<p>It's been too long since my last question so here is a new one !</p>\n\n<p>I'm having performance issues with a Virtualizing WPF TreeView during scrolling. Let's say I have arbitrary complex controls under my TreeViewItems that can take a long time - let's say 10ms - to be measured. Scrolling down the TreeView can quickly become very laggy, as the Layout pass is called for each scroll unit down.</p>\n\n<p>What would be your ideas to get a smooth scrolling in this case ?\nI tried two different approaches but I'm having issues with both. </p>\n\n<p>First one was to buffer the last MeasureOverride result and use it instead of calling MeasureOverride again unless size changed. It's working as long as I have only one hierarchy level in the tree. But as soon as I get more, some items are not rendered (although the size is correctly reserved). Invalidating the buffer will not be an issue.</p>\n\n<p>Second one was to replace ControlTemplate of controls under treeViewItems during scroll thanks to a Trigger, using a ControlTemplate very quick to render. Sadly, I'm getting strange exceptions when I stop scrolling regargind items already attached in the logical tree.</p>\n\n<p>Finally, I'm not in a multithreading environment and thus won't be able to use asynchronous bindings. :(</p>\n\n<p>Here is a very small example of the Tree I'd like to improve (It's the one implementing my first idea), I just put a Thread.Sleep(10) in the MeasureOverride of a ContentControl used to render my Items.</p>\n\n<pre><code>public class Item\n{\n    public string Index { get; set; }\n    public Item Parent { get; set; }\n\n    public IEnumerable&lt;Item&gt; Items\n    {\n        get\n        {\n            if (Parent == null)\n            {\n                for (int i = 0; i &lt; 10; i++)\n                {\n                    yield return new Item() { Parent = this, Index = this.Index + \".\" + i.ToString() };\n                }\n            }\n        }\n    }\n}\n\npublic class HeavyControl : ContentControl\n{\n    protected override Size MeasureOverride(Size constraint)\n    {\n        Thread.Sleep(10);\n        return base.MeasureOverride(constraint);\n    }\n}\n\n/// &lt;summary&gt;\n/// Logique d'interaction pour MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n    }\n\n    public IEnumerable&lt;Item&gt; Items\n    {\n        get\n        {\n            for (int i = 0; i &lt; 20; i++)\n            {\n                yield return new Item() { Index = i.ToString() };\n            }\n        }\n    }\n}\n\npublic class MyTreeView : TreeView\n{\n    protected override DependencyObject GetContainerForItemOverride()\n    {\n        return new MyTreeViewItem();\n    }\n}\n\npublic class MyTreeViewItem : TreeViewItem\n{\n    static MyTreeViewItem()\n    {\n        MyTreeViewItem.IsExpandedProperty.OverrideMetadata(typeof(MyTreeViewItem), new FrameworkPropertyMetadata(true));\n    }\n\n    public Size LastMeasure\n    {\n        get { return (Size)GetValue(LastMeasureProperty); }\n        set { SetValue(LastMeasureProperty, value); }\n    }\n\n    // Using a DependencyProperty as the backing store for LastMeasure.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty LastMeasureProperty =\n        DependencyProperty.Register(\"LastMeasure\", typeof(Size), typeof(MyTreeViewItem), new UIPropertyMetadata(default(Size)));\n\n    protected override Size MeasureOverride(Size constraint)\n    {\n        if (LastMeasure != default(Size))\n        {\n            if (this.VisualChildrenCount &gt; 0)\n            {\n                UIElement visualChild = (UIElement)this.GetVisualChild(0);\n                if (visualChild != null)\n                {\n                    visualChild.Measure(constraint);\n                }\n            }\n\n            return LastMeasure;\n        }\n        else\n        {\n            LastMeasure = base.MeasureOverride(constraint);\n            return LastMeasure;\n        }\n    }\n\n    protected override DependencyObject GetContainerForItemOverride()\n    {\n        return new MyTreeViewItem();\n    }\n}\n</code></pre>\n\n<p><strong>MainWindow.xaml</strong></p>\n\n<pre><code>&lt;Window x:Class=\"WpfApplication1.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:sys=\"clr-namespace:System;assembly=mscorlib\"\n    xmlns:local=\"clr-namespace:WpfApplication1\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n\n&lt;Window.Resources&gt;\n    &lt;HierarchicalDataTemplate DataType=\"{x:Type local:Item}\" ItemsSource=\"{Binding Items}\"&gt;\n        &lt;local:HeavyControl&gt;\n            &lt;TextBlock FontSize=\"20\" FontWeight=\"Bold\" Text=\"{Binding Index}\" /&gt;\n        &lt;/local:HeavyControl&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n&lt;/Window.Resources&gt;\n\n&lt;local:MyTreeView x:Name=\"treeView\" VirtualizingStackPanel.IsVirtualizing=\"True\" ItemsSource=\"{Binding Items}\" /&gt;\n\n&lt;/Window&gt;\n</code></pre>\n"},{"tags":["c#","wpf","silverlight","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13048167,"title":"WPF MVVM guidance for beginner","body":"<p>Trying to make a document viewer, like Acrobat, which consists of pages, and each page consists of thumbnail images (of varying sizes at users discretion). I’m not sure how to design the MVVM.\nAt the moment I have:</p>\n\n<p><strong>DocumentViewModel</strong>, <strong>PageViewModel</strong>, <strong>ThumbnailViewModel</strong></p>\n\n<blockquote>\n  <p>DocumentViewModel has ObservableCollection()  // keeps track of Pages</p>\n  \n  <p>PageViewModel has ObservableCollection() // keeps track of thumbnails to be displayed by document.</p>\n</blockquote>\n\n<p>However this design causes problems. For example, if there are 3 pages of thumbnails. And half of the thumbnails are removed from page 2, then page 3 thumbnails should automatically relocate to the newly available space on page 2. Each PageViewModel would have to have awareness about each other, which would be breaking the MVVM policies, no? Would it be better to have the 2 ObservableCollections, declared within DocumentViewModel?</p>\n\n<p>Any help, pointers, advice, guidance welcomed.</p>\n"},{"tags":["c#","wpf","xaml","binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":382,"score":0,"question_id":8152710,"title":"DataTemplate in ControlTemplate not updating Binding","body":"<p>I've created a control with 3 PART_s, one PART_ changes depending on the type bound to it, however values changed within the Control do not update the Binding, it seems to work as OneWay Binding.</p>\n\n<p>Here's part of the code I beleive is relevant:</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"BooleanDAView\" DataType=\"{x:Type sys:Boolean}\"&gt;\n    &lt;CheckBox IsChecked=\"{Binding ., Mode=TwoWay}\"/&gt;\n&lt;/DataTemplate&gt;\n&lt;DataTemplate x:Key=\"DateTimeDAView\" DataType=\"{x:Type sys:DateTime}\"&gt;\n    &lt;extToolkit:DateTimePicker Value=\"{Binding ., Mode=TwoWay}\"/&gt;\n&lt;/DataTemplate&gt;\n&lt;DataTemplate x:Key=\"Int32DAView\"  DataType=\"{x:Type sys:Int32}\"&gt;\n    &lt;extToolkit:IntegerUpDown Value=\"{Binding ., Mode=TwoWay}\"/&gt;\n&lt;/DataTemplate&gt;\n&lt;DataTemplate x:Key=\"StringDAView\"  DataType=\"{x:Type sys:String}\"&gt;\n    &lt;TextBox Text=\"{Binding ., Mode=TwoWay}\"/&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>....</p>\n\n<pre><code>&lt;ContentControl x:Name=\"PART_Content\"\n        Grid.Row=\"0\" Grid.Column=\"1\"\n        Margin=\"{TemplateBinding Padding}\"\n        VerticalAlignment=\"Center\"\n        VerticalContentAlignment=\"Center\"\n        Content=\"{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}\"\n        &gt;\n    &lt;ContentControl.ContentTemplateSelector&gt;\n        &lt;controls:TypeBasedDataTemplateSelector&gt;\n            &lt;controls:TypeBasedDataTemplateSelector.Templates&gt;\n                &lt;controls:TypedDictionary&gt;\n                    &lt;sys:String x:Key=\"{x:Type sys:Boolean}\"&gt;BooleanDAView&lt;/sys:String&gt;\n                    &lt;sys:String x:Key=\"{x:Type sys:DateTime}\"&gt;DateTimeDAView&lt;/sys:String&gt;\n                    &lt;sys:String x:Key=\"{x:Type sys:Int32}\"&gt;Int32DAView&lt;/sys:String&gt;\n                    &lt;sys:String x:Key=\"{x:Type sys:String}\"&gt;StringDAView&lt;/sys:String&gt;\n                &lt;/controls:TypedDictionary&gt;\n            &lt;/controls:TypeBasedDataTemplateSelector.Templates&gt;\n        &lt;/controls:TypeBasedDataTemplateSelector&gt;\n    &lt;/ContentControl.ContentTemplateSelector&gt;\n&lt;/ContentControl&gt;\n</code></pre>\n\n<p>For Content I've also tried ... <code>RelativeSource={RelativeSource AncestorType=local:DABaseControl}</code> but no change.</p>\n\n<p>If the DataTemplate Binding use <code>\"{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}\"</code> the template doesn't change once set.</p>\n\n<p>Or is there a better way to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13074439,"title":"access control within data template","body":"<p>Relevant: previous question\n<a href=\"http://stackoverflow.com/questions/13071442/assigning-different-click-handlers-to-a-global-control-template#comment17756609_13071442\">assigning different click handlers to a global control template</a></p>\n\n<p>I have the following xaml:</p>\n\n<pre><code>&lt;Expander Name=\"SharesExpander\" Template=\"{StaticResource SimpleExpanderTemp}\" Header=\"Shares\"&gt;\n    &lt;ItemsControl Name=\"SharesControl\" ItemsSource=\"{Binding Sharers}\"&gt;\n        &lt;ItemsControl.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;Expander Name=\"ShareExpander\" Template=\"{StaticResource SimpleExpanderTemp}\" Header=\"{Binding Name}\"&gt;\n                    &lt;local:FileTypesListBoxControl Margin=\"25,-10,-10,-10\" BorderThickness=\"10\" /&gt;\n                &lt;/Expander&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ItemsControl.ItemTemplate&gt;\n    &lt;/ItemsControl&gt;\n&lt;/Expander&gt;\n</code></pre>\n\n<p>I am trying to access the header button of the inner expander via code behind to add a click handler. </p>\n\n<p>I can retrieve the button for the outer expander using <code>SharesExpander.Template.FindName(\"ExpanderHeader\", SharesExpander)</code>, but I can't figure out how to get at the inner expander within the data template.  I have tried traversing the <code>VisualTree</code> and <code>LogicalTree</code>, but I always seem to end up back at the outer expander.  I can retrieve the outer expanders data template, and I can call <code>FindName</code> on that, but can't figure out what element to use as the second parameter.  Help!</p>\n\n<p>One attempt:</p>\n\n<pre><code>foreach (var item in SharesControl.Items)\n{\n    //test is always null\n    var test = SharesControl.ItemContainerGenerator.ContainerFromItem(item);\n}\n</code></pre>\n\n<p>Another attempt:</p>\n\n<pre><code>ControlTemplate controlTemplate = SharesControl.Template;\nvar control = controlTemplate.FindName(\"ShareExpander\", ?whatGoesHere);\n</code></pre>\n\n<p>yet again:</p>\n\n<pre><code>for (int i = 0; i &lt; 1; i++)\n{\n    //test again always null\n    var test = ContactSharesItemsControl.ItemContainerGenerator.ContainerFromIndex(i) as Expander;\n}\n</code></pre>\n"},{"tags":["wpf","visual-studio","projects-and-solutions"],"answer_count":5,"favorite_count":26,"up_vote_count":122,"down_vote_count":0,"view_count":56671,"score":122,"question_id":145752,"title":"What are the various \"Build action\" settings in VS.NET project properties and what do they do?","body":"<p>For the most part you just take whatever Visual Studio sets it for you as a default.. I'm referring to the BuildAction Property for each file selected in your solution explorer. There are a number of options and its difficult to know what each one of them will do.</p>\n"},{"tags":["wpf","datagrid","mvvm","binding","viewmodel"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2853,"score":0,"question_id":2472680,"title":"refresh datagrid on view from viewmodel","body":"<p>I have a datagrid on a view that is bound to a viewmodel. When I initialze the view, the datagrid is populated with data from the viewmodel (ObservableCollection) as it should. However, with I try to do a search against the data, the datagrid does not get refreshed from the viewmodel. When I breakpoint the code in my viewmodel, I can see the results in the ObservableCollection has changed per my search, but somehow that is not getting communicated back to the view. Here is my view and viewmodel (BTW, I am using VS2010 RTM):</p>\n\n<pre><code>namespace Attendance.ViewModels\n{\n    public class EmployeeSelectViewModel : ViewModel, INotifyPropertyChanged\n    {\n        #region Entity list and constructor\n    public EmployeeSelectViewModel()\n    {\n        {\n            Initialize();\n        }\n    }\n\n    private void Initialize()\n    {\n        if (employeeRpository == null)\n            employeeRpository = new EmployeeRepository();\n\n        ListOfEmployees = new ObservableCollection&lt;EmployeeDto&gt;(employeeRpository.GetEmployees(true));\n    }\n\n    private EmployeeRepository employeeRpository;\n\n    private ObservableCollection&lt;EmployeeDto&gt; listOfEmployees;\n    public ObservableCollection&lt;EmployeeDto&gt; ListOfEmployees\n    {\n        get { return listOfEmployees; }\n        set\n        {\n            if (listOfEmployees != value)\n            {\n                listOfEmployees = value;\n                NotifyPropertyChanged(\"ListOfEmployee\");\n            }\n        }\n    }\n\n    private EmployeeDto selectedEmployee;\n    public EmployeeDto SelectedEmployee\n    {\n        get { return selectedEmployee; }\n        set\n        {\n            if (selectedEmployee != value)\n            {\n                selectedEmployee = value;\n                NotifyPropertyChanged(\"SelectedEmployee\");\n            }\n        }\n    }\n\n    #endregion\n\n    #region UI control references\n\n    /// &lt;summary&gt;\n    /// search text property\n    /// &lt;/summary&gt;\n    private string searchText;\n    public string SearchText\n    {\n        get { return searchText; }\n        set\n        {\n            if (searchText != value)\n            {\n                searchText = value;\n                NotifyPropertyChanged(\"SearchText\");\n            }\n        }\n    }\n\n    public string Location { get; set; }\n\n    #endregion\n\n    #region Relay Commands\n\n    /// &lt;summary&gt;\n    /// new command\n    /// &lt;/summary&gt;\n    private ViewCommand newCommand;\n    public ViewCommand NewCommand\n    {\n        get\n        {\n            if (newCommand == null)\n                newCommand = new ViewCommand(param =&gt; this.NewEmployee());\n            return newCommand;\n        }\n    }\n    private void NewEmployee()\n    {\n        NavigationActions.NewEmployeeView();\n    }\n\n    /// &lt;summary&gt;\n    /// edit command\n    /// &lt;/summary&gt;\n    private ViewCommand editCommand;\n    public ViewCommand EditCommand\n    {\n        get\n        {\n            if (editCommand == null)\n            {\n                editCommand = new ViewCommand(param =&gt; this.EditEmployee());\n            }\n            return editCommand;\n        }\n    }\n\n    private void EditEmployee()\n    {\n        NavigationActions.OpenEmployeeView(SelectedEmployee);\n    }\n\n    /// &lt;summary&gt;\n    /// save command\n    /// &lt;/summary&gt;\n    private ViewCommand saveCommand;\n    public ViewCommand SaveCommand\n    {\n        get\n        {\n            if (saveCommand == null)\n            {\n                saveCommand = new ViewCommand(\n                        param =&gt; this.SaveEmployee(),\n                        param =&gt; this.CanSaveEmployee\n                        );\n            }\n            return saveCommand;\n        }\n    }\n\n    public void SaveEmployee()\n    {\n        employeeRpository.SaveChanges();\n    }\n\n    private bool CanSaveEmployee\n    {\n        get { return true; }\n    }\n\n    /// &lt;summary&gt;\n    /// clear search command\n    /// &lt;/summary&gt;\n    private ViewCommand clearSearchCommand;\n    public ViewCommand ClearSearchCommand\n    {\n        get\n        {\n            if (clearSearchCommand == null)\n                clearSearchCommand = new ViewCommand(param =&gt; this.ClearSearch());\n            return clearSearchCommand;\n        }\n    }\n\n    private void ClearSearch()\n    {\n        this.SearchText = string.Empty;\n        ListOfEmployees = new ObservableCollection&lt;EmployeeDto&gt;(employeeRpository.GetEmployees(true));\n    }\n\n    /// &lt;summary&gt;\n    /// search command\n    /// &lt;/summary&gt;\n    private ViewCommand searchCommand;\n    public ViewCommand SearchCommand\n    {\n        get\n        {\n            if (searchCommand == null)\n                searchCommand = new ViewCommand(param =&gt; this.SearchEmployee());\n            return searchCommand;\n        }\n    }\n\n    private void SearchEmployee()\n    {\n        if (this.SearchText == string.Empty || this.SearchText == null)\n        {\n            NavigationActions.ShowError(\"Search Employees.\", \"Please enter your search text ...\");\n            return;\n        }\n        ListOfEmployees = new ObservableCollection&lt;EmployeeDto&gt;(employeeRpository.GetEmployeesByQuery(SearchText, Location));\n    }\n\n    /// &lt;summary&gt;\n    /// exit command\n    /// &lt;/summary&gt;\n    private ViewCommand exitCommand;\n    public ViewCommand ExitCommand\n    {\n        get\n        {\n            if (exitCommand == null)\n            {\n                exitCommand = new ViewCommand(param =&gt; this.ExitWindow());\n            }\n            return exitCommand;\n        }\n    }\n\n    private void ExitWindow()\n    {\n        NavigationActions.CloseCurrentView();\n    }\n    #endregion\n\n\n    #region INotifyPropertyChanged Members\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    public void NotifyPropertyChanged(String info)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(info));\n        }\n    }\n\n    #endregion\n    }\n}\n\n&lt;Window x:Class=\"Attendance.Views.EmployeeSelectView\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:vm=\"clr-namespace:Attendance.ViewModels\"\n    Title=\"Employee Maintenance\" FocusManager.FocusedElement=\"{Binding ElementName=txtSearchCriteria}\"\n    Height=\"525\" Width=\"800\" WindowStartupLocation=\"CenterScreen\" WindowState=\"Normal\"\n    WindowStyle=\"SingleBorderWindow\" Icon=\"Images/gb_icon.png\"&gt;\n&lt;Window.DataContext&gt;\n    &lt;vm:EmployeeSelectViewModel /&gt;\n&lt;/Window.DataContext&gt;\n&lt;Window.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"Themes/DataGrid.Generic.xaml\" /&gt;\n        &lt;/ResourceDictionary.MergedDictionaries&gt;\n        &lt;!--xml data start--&gt;\n        &lt;XmlDataProvider x:Key=\"LocationData\" XPath=\"LocationList/LocationItem\" Source=\"XMLData/Location.xml\"/&gt;\n        &lt;!--xml data end--&gt;\n    &lt;/ResourceDictionary&gt;\n&lt;/Window.Resources&gt;\n&lt;Grid Width=\"775\"&gt;\n    &lt;DockPanel HorizontalAlignment=\"Left\" Width=\"770\"&gt;\n        &lt;!-- TOOLBAR --&gt;\n        &lt;DockPanel DockPanel.Dock=\"Top\" MinHeight=\"30\" Margin=\"5\"&gt;\n            &lt;ToolBar FontWeight=\"Bold\"&gt;\n                &lt;!-- NEW --&gt;\n                &lt;Button Name=\"btnNew\" Command=\"{Binding Path=NewCommand}\"&gt;\n                    &lt;Button.ToolTip&gt;\n                        &lt;StackPanel&gt;\n                            &lt;Label FontWeight=\"Bold\" Background=\"SteelBlue\" Foreground=\"White\"&gt;\n                                Create a new Customer\n                            &lt;/Label&gt;\n                            &lt;TextBlock Padding=\"10\" TextWrapping=\"WrapWithOverflow\" Width=\"200\"&gt;\n                            Create a new customer in a new Window tab.\n                            &lt;/TextBlock&gt;\n                            &lt;Line Stroke=\"SteelBlue\" StrokeThickness=\"1\" X2=\"200\" /&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;Image Margin=\"2\" Source=\"Images/new.png\"/&gt;\n                                &lt;Label&gt;Press F1 for more help&lt;/Label&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/Button.ToolTip&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;Image Source=\"Images/new.png\" Width=\"22\" Height=\"22\" Margin=\"2\"/&gt;\n                        &lt;Label VerticalAlignment=\"Center\"&gt;_New&lt;/Label&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Button&gt;\n                &lt;!-- EDIT --&gt;\n                &lt;Button Name=\"btnEdit\" Command=\"{Binding Path=EditCommand}\"&gt;\n                    &lt;Button.ToolTip&gt;\n                        &lt;StackPanel&gt;\n                            &lt;Label FontWeight=\"Bold\" Background=\"SteelBlue\" Foreground=\"White\"&gt;\n                                Edit the current record\n                            &lt;/Label&gt;\n                            &lt;TextBlock Padding=\"10\" TextWrapping=\"WrapWithOverflow\" Width=\"200\"&gt;\n                            Edit the current selected Customer.\n                            &lt;/TextBlock&gt;\n                            &lt;Line Stroke=\"SteelBlue\" StrokeThickness=\"1\" X2=\"200\" /&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;Image Margin=\"2\" Source=\"Images/dialog-information.png\"/&gt;\n                                &lt;Label&gt;Press F1 for more help&lt;/Label&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/Button.ToolTip&gt;\n\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;Image Source=\"Images/edit.png\" Width=\"22\" Height=\"22\" Margin=\"2\" /&gt;\n                        &lt;Label VerticalAlignment=\"Center\"&gt;_Edit&lt;/Label&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Button&gt;\n                &lt;!-- SEARCH --&gt;\n                &lt;Separator /&gt;\n                &lt;TextBox Name=\"txtSearchCriteria\" \n                    MinWidth=\"300\" Margin=\"5\"\n                    BorderThickness=\"1\" BorderBrush=\"LightGray\"\n                    FontWeight=\"Normal\" Foreground=\"Gray\" Text=\"{Binding Path=SearchText}\"&gt;\n                &lt;/TextBox&gt;\n                &lt;Button Name=\"btnSearch\" Command=\"{Binding Path=SearchCommand}\"&gt;\n                    &lt;Button.ToolTip&gt;\n                        &lt;StackPanel&gt;\n                            &lt;Label FontWeight=\"Bold\" Background=\"SteelBlue\" Foreground=\"White\"&gt;\n                                Search\n                            &lt;/Label&gt;\n                            &lt;TextBlock Padding=\"10\" TextWrapping=\"WrapWithOverflow\" Width=\"200\"&gt;\n                            Search a specific Customer.\n                            &lt;/TextBlock&gt;\n                            &lt;Line Stroke=\"SteelBlue\" StrokeThickness=\"1\" X2=\"200\" /&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;Image Margin=\"2\" Source=\"Images/find.png\"/&gt;\n                                &lt;Label&gt;Press F1 for more help&lt;/Label&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/Button.ToolTip&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;Image Source=\"Images/find.png\" Width=\"22\" Height=\"22\" Margin=\"2\" /&gt;\n                        &lt;Label VerticalAlignment=\"Center\"&gt;_Find&lt;/Label&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Button&gt;\n                &lt;Button Name=\"btnClearSearch\" Command=\"{Binding Path=ClearSearchCommand}\"&gt;\n                    &lt;Button.ToolTip&gt;\n                        &lt;StackPanel&gt;\n                            &lt;Label FontWeight=\"Bold\" Background=\"SteelBlue\" Foreground=\"White\"&gt;\n                                Search\n                            &lt;/Label&gt;\n                            &lt;TextBlock Padding=\"10\" TextWrapping=\"WrapWithOverflow\" Width=\"200\"&gt;\n                            Clear search results.\n                            &lt;/TextBlock&gt;\n                            &lt;Line Stroke=\"SteelBlue\" StrokeThickness=\"1\" X2=\"200\" /&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;Image Margin=\"2\" Source=\"Images/find.png\"/&gt;\n                                &lt;Label&gt;Press F1 for more help&lt;/Label&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/Button.ToolTip&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;Label VerticalAlignment=\"Center\"&gt;_Clear Search&lt;/Label&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Button&gt;\n                &lt;!-- EXIT --&gt;\n                &lt;Separator /&gt;\n                &lt;Button Name=\"btnExit\" Command=\"{Binding Path=ExitCommand}\"&gt;\n                    &lt;Button.ToolTip&gt;\n                        &lt;StackPanel&gt;\n                            &lt;Label FontWeight=\"Bold\" Background=\"SteelBlue\" Foreground=\"White\"&gt;\n                                Start the application\n                            &lt;/Label&gt;\n                            &lt;TextBlock Padding=\"10\" TextWrapping=\"WrapWithOverflow\" Width=\"200\"&gt;\n                            Start the main application with the M-V-MV pattern.\n                            &lt;/TextBlock&gt;\n                            &lt;Line Stroke=\"SteelBlue\" StrokeThickness=\"1\" X2=\"200\" /&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                                &lt;Image Margin=\"2\" Source=\"Images/dialog-information.png\"/&gt;\n                                &lt;Label&gt;Press F1 for more help&lt;/Label&gt;\n                            &lt;/StackPanel&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/Button.ToolTip&gt;\n\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;Image Source=\"Images/exit.png\" Width=\"22\" Height=\"22\" Margin=\"2\" /&gt;\n                        &lt;Label VerticalAlignment=\"Center\"&gt;_Exit&lt;/Label&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/Button&gt;\n            &lt;/ToolBar&gt;\n        &lt;/DockPanel&gt;\n        &lt;!-- LIST --&gt;\n        &lt;DockPanel DockPanel.Dock=\"Top\" MinHeight=\"30\" Margin=\"0,0,0,5\"&gt;\n            &lt;Label&gt;Location:&lt;/Label&gt;\n            &lt;ComboBox Name=\"cboLocation\" Grid.Column=\"1\" Grid.Row=\"4\" \n                                ItemsSource=\"{Binding Source={StaticResource LocationData}}\"\n                                DisplayMemberPath=\"location_text\" SelectedValuePath=\"location_value\" \n                                SelectedValue=\"{Binding Path=Location}\" \n                                HorizontalAlignment=\"Left\" Width=\"175\" Margin=\"4\" /&gt;\n        &lt;/DockPanel&gt;\n        &lt;DockPanel Margin=\"5\"&gt;\n            &lt;DataGrid ItemsSource=\"{Binding Path=ListOfEmployees}\" AutoGenerateColumns=\"False\" IsReadOnly=\"True\" \n                Name=\"dgEmployee\" SelectionMode=\"Single\" SelectionUnit=\"FullRow\" CanUserResizeColumns=\"True\" \n                SelectedItem=\"{Binding Path=SelectedEmployee}\" GridLinesVisibility=\"Horizontal\"&gt;\n                &lt;DataGrid.Columns&gt;\n                    &lt;DataGridTextColumn Header=\"Employee ID\" Width=\"SizeToCells\"  MinWidth=\"125\" Binding=\"{Binding EmployeeID}\" /&gt;\n                    &lt;DataGridTextColumn Header=\"First Name\" Width=\"SizeToCells\"  MinWidth=\"200\" Binding=\"{Binding FirstName}\" /&gt;\n                    &lt;DataGridTextColumn Header=\"Last Name\" Width=\"SizeToCells\"  MinWidth=\"200\" Binding=\"{Binding LastName}\" /&gt;\n                    &lt;DataGridTextColumn Header=\"Location\" Width=\"SizeToCells\"  MinWidth=\"125\" Binding=\"{Binding Location}\" /&gt;\n                    &lt;DataGridCheckBoxColumn x:Name=\"Active\" Header=\"Active\" Binding=\"{Binding active}\" MinWidth=\"75\" /&gt;\n                &lt;/DataGrid.Columns&gt;\n            &lt;/DataGrid&gt;\n        &lt;/DockPanel&gt;\n    &lt;/DockPanel&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#",".net","wpf","xaml","window"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12996216,"title":"Unable to get window width","body":"<p>I've got a WPF window, and I'm trying to get the <code>Width</code> property. No matter where I try to present the code, it always returns as <code>NaN</code>.  I have looked up on the internet and read that I should actually be using <code>ActualWidth</code> instead, but this returns 0 no matter what.</p>\n\n<p>How can I get rid of the lag and get an actual value for my window's width?</p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;Window x:Name=\"TableWindow\" x:Class=\"QueryBuilder.DatabaseTable\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        WindowStyle=\"None\" Background=\"Transparent\" SizeToContent=\"WidthAndHeight\" ResizeMode=\"CanResize\"&gt;\n    &lt;Grid&gt;\n        &lt;DockPanel&gt;\n            &lt;StackPanel Name=\"titleBar\" DockPanel.Dock=\"Top\" Height=\"28\" FlowDirection=\"RightToLeft\" Orientation=\"Horizontal\" Background=\"AliceBlue\"&gt;\n                &lt;Button x:Name=\"btnClose\" Margin=\"0,0,5,0\" Click=\"btnClose_Click\"&gt;\n                &lt;/Button&gt;\n                &lt;Button&gt;\n                &lt;/Button&gt;\n                &lt;Button&gt;\n                &lt;/Button&gt;\n                &lt;Button x:Name=\"btnAll\"&gt;ALL&lt;/Button&gt;\n                &lt;Label Name=\"lblTableName\" FontSize=\"15\" Margin=\"50,0,0,0\"&gt;&lt;/Label&gt;\n            &lt;/StackPanel&gt;\n            &lt;StackPanel Orientation=\"Vertical\" Name=\"spFields\"&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DockPanel&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>XAML.cs:</strong></p>\n\n<pre><code>public DatabaseTableWindow(string tableName, DataTable fields, string primaryKey)\n        {\n            InitializeComponent();\n            this.tableName = tableName;\n            this.fields = fields;\n            this.primaryKey = primaryKey;\n            lblTableName.Content = tableName;\n            double x = this.ActualWidth;\n        }\n</code></pre>\n"},{"tags":["c#","wpf","custom-controls"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13088070,"title":"Label content in custom UserControl not updating","body":"<p>I've created a custom UserControl which consists of 12 labels.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/rMIpS.png\" alt=\"enter image description here\"></p>\n\n<p>Now, when the program loads, the labels with \"Default\" as the content need to be changed.</p>\n\n<pre><code>// This is called in my main forms constructor, right before InitializeComponent()\npublic void ShowRigInfo()\n{\n    // This is here because if I try to call PopluateLabels, I get an \"Object not\n    // set to an instance of object\" error\n    grdRigInfo = new RigInfoGrid();\n\n    var contractor = SplitString(\"contractor\", _rigInfo);\n    var projectName = SplitString(\"projectname\", _rigInfo);\n    var location = SplitString(\"location\", _rigInfo);\n    var operatorName = SplitString(\"operator\", _rigInfo);\n    var rigName = SplitString(\"rigsite_name\", _rigInfo);\n    var rigManager = SplitString(\"rigmanager\", _rigInfo);\n\n    grdRigInfo.PopulateLabels(contractor, projectName, location, operatorName,\n                              rigName, rigManager);\n    }\n\n// A public method of my custom UserControl to update label content\npublic void PopulateLabels(string contractor, string project, string location, \n                           string operatorName, string rigName, string manager)\n{\n    lblContractor.Content = contractor;\n    lblProjectName.Content = project;\n    lblLocation.Content = location;\n    lblOperator.Content = operatorName;\n    lblRigName.Content = rigName;\n    lblRigManager.Content = manager;            \n}\n</code></pre>\n\n<p>My question is, how can I get the labels to update upon program start up?  Thanks for any and all help.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have tried to call <code>ShowRigInfo()</code> both before and after <code>InitializeComponent()</code> of my main form.  Neither of them changed the labels.</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>Okay, I solved this before I actually saw the answers.  What I did was moved my <code>ShowRigInfo()</code> into my custom UserControl, instead of my main form.  I don't know why I didn't do that from the start, but there it is.  I'll be looking into the DataBinding portion of the answers.  Thank you guys.</p>\n"},{"tags":["c#","wpf","multithreading"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":93,"score":4,"question_id":13088436,"title":"Preforming a block of code only once","body":"<p>The following code block, preforms loading of an object in C#.</p>\n\n<pre><code>public bool IsModelLoaded { get; set; }\npublic override MyObject Load()\n    {\n        if (!IsModelLoaded)\n        {\n            Model = MyService.LoadMyObject(Model);\n            IsModelLoaded = true;\n        }\n        return Model;\n    }\n</code></pre>\n\n<p>My intention is to run this block only once, and hence loading the Model only once.\nNevertheless, this code block runs twice from 2 different threads..</p>\n\n<p>How can I make sure that this block runs only once? (on multiplethreads).</p>\n\n<p>Thank You.</p>\n"},{"tags":["wpf","silverlight","xaml"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13088524,"title":"Using XAML resource to reduce repetition","body":"<p>I have a scenario where I'm passing in the same values to a multivalue converter for different buttons within a data template which all works fine. But was wondering way to make the code better by removing the repeatable elements, since I'm passing in the same content into \n\n<pre><code>&lt;telerik:RadButton.Visibility&gt;\n    &lt;MultiBinding Converter=\"{StaticResource multiValueToBooleanConverter}\" ConverterParameter=\"ViewCommentsDialog\"&gt;\n        &lt;Binding Path=\"DataContext.CanEdit\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n        &lt;Binding Path=\"DataContext.CanView\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n        &lt;Binding Path=\"Comment\"/&gt;\n        &lt;Binding Path=\"ExecutionId\"/&gt;\n    &lt;/MultiBinding&gt;\n&lt;/telerik:RadButton.Visibility&gt;\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>&lt;DataTemplate&gt;\n    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n        &lt;telerik:RadButton Margin=\"2\" Command=\"{Binding DataContext.ViewCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}\" CommandParameter=\"{Binding}\"&gt;\n            &lt;telerik:RadButton.Visibility&gt;\n                &lt;MultiBinding Converter=\"{StaticResource multiValueToBooleanConverter}\" ConverterParameter=\"ViewCommentsDialog\"&gt;\n                    &lt;Binding Path=\"DataContext.CanEdit\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"DataContext.CanView\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"Comment\"/&gt;\n                    &lt;Binding Path=\"ExecutionId\"/&gt;\n                &lt;/MultiBinding&gt;\n            &lt;/telerik:RadButton.Visibility&gt;\n            &lt;telerik:RadButton.Content&gt;\n                &lt;Image Width=\"20\" Height=\"20\" Source=\"pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comments.png\" /&gt;\n            &lt;/telerik:RadButton.Content&gt;\n        &lt;/telerik:RadButton&gt;\n        &lt;telerik:RadButton Margin=\"2\" Command=\"{Binding  DataContext.AddCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}\" CommandParameter=\"{Binding}\"&gt;\n            &lt;telerik:RadButton.Visibility&gt;\n                &lt;MultiBinding Converter=\"{StaticResource multiValueToBooleanConverter}\" ConverterParameter=\"AddCommentDialog\"&gt;\n                    &lt;Binding Path=\"DataContext.CanEdit\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"DataContext.CanView\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"Comment\"/&gt;\n                    &lt;Binding Path=\"ExecutionId\"/&gt;\n                &lt;/MultiBinding&gt;\n            &lt;/telerik:RadButton.Visibility&gt;\n            &lt;telerik:RadButton.Content&gt;\n                &lt;Image Width=\"20\" Height=\"20\" Source=\"pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comment-Add.png\" /&gt;\n            &lt;/telerik:RadButton.Content&gt;\n        &lt;/telerik:RadButton&gt;\n        &lt;telerik:RadButton Margin=\"2\" Command=\"{Binding DataContext.ViewBreaksCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}\" CommandParameter=\"{Binding}\"&gt;\n            &lt;telerik:RadButton.Visibility&gt;\n                &lt;MultiBinding Converter=\"{StaticResource multiValueToBooleanConverter}\" ConverterParameter=\"ViewBreaksDialog\"&gt;\n                    &lt;Binding Path=\"DataContext.CanEdit\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"DataContext.CanView\" RelativeSource=\"{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}\" /&gt;\n                    &lt;Binding Path=\"Comment\"/&gt;\n                    &lt;Binding Path=\"ExecutionId\"/&gt;\n                &lt;/MultiBinding&gt;\n            &lt;/telerik:RadButton.Visibility&gt;\n            &lt;telerik:RadButton.Content&gt;\n                &lt;Image Width=\"20\" Height=\"20\" Source=\"pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Folder-Bug.png\" /&gt;\n            &lt;/telerik:RadButton.Content&gt;\n        &lt;/telerik:RadButton&gt;\n    &lt;/StackPanel&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n"},{"tags":["wpf","binding","path","command"],"answer_count":2,"favorite_count":17,"up_vote_count":30,"down_vote_count":0,"view_count":36243,"score":30,"question_id":1350598,"title":"Passing two command parameters using a WPF binding","body":"<p>I have a command which I am executing from my XAML file using the following standard syntax:</p>\n\n<pre><code>&lt;Button Content=\"Zoom\" Command=\"{Binding MyViewModel.ZoomCommand}\"/&gt;\n</code></pre>\n\n<p>This worked fine until I realized that I needed TWO pieces of information from the view in order to make this operation complete the way users expect (the width and height of the canvas specfically).</p>\n\n<p>It seems like it's possible to pass an array as an argument to my command, but I don't see there being a way to specify the binding to my two canvas properties in the CommandParameter:</p>\n\n<pre><code>&lt;Button Content=\"Zoom\" Command=\"{Binding MyViewModel.ZoomCommand\" CommandParameter={Binding ElementName=MyCanvas, Path=Width}\"/&gt;\n</code></pre>\n\n<p>How do I pass both Width and Height to my command?  It doesn't seem like this is possible using commands from XAML and I need to wire up a click handler in my codebehind to get this information to pass to my zoom method.</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13088319,"title":"\"Binning\" items in an ObservableCollection into seperate ListBoxes","body":"<p>I've recently encountered a rather severe performance issue with how I'm \"binning\" items in my ObservableCollection into individual ListBoxes.  This works in it's current iteration and my issue arrises when the user wants to zoom in/out on the timeline.</p>\n\n<p>The zooming changes the amount of time each block on the timeline represents and will potentially require moving some elements in one ListBox into an adjacent ListBox.  It also will occasionally require the addition or removal of ListBoxes.</p>\n\n<p>I'm guessing the issue may be in how I go about reshuffling the entries in the OnZoomChanged method.  The other issue is that all of the entries appear to be redrawn each time one is added.  Both of these can pair up for making a decent big of lag during the update process (adding/zooming).  When I'm upwards of around 50-60 entries I really start to notice the performance hit on zooming.</p>\n\n<p>My ultimate goal here is to be able to sort entries that would be overlapping with each other into seperate bins (StackPanel/ListBox etc) and allow the user to still be able to browse through all of them if they so desire.  The entries are a fixed size (which is what creates the overlapping issue).</p>\n\n<p>Thanks for any insights/suggestions!</p>\n\n<p>Here's a breakdown of how everything is setup:</p>\n\n<p><strong>The View</strong> - granted this is a simplified version of the control.  The DateTime (GroupingTime) is used in my custom view for placement on the timeline (and this works).  Then the list of timeline entries (GroupEntries) is fed into the TimelineEntryControl to appropriately draw the entry in the ListBox.</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding TimelineEntries}\"&gt;\n  &lt;ItemsControl.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n      &lt;Views:CustomView&gt;\n        &lt;ListBox&gt;\n          &lt;ItemsControl.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n              &lt;Controls:TimelineEntryControl TimelineEntry=\"{Binding}\" Height=\"50\" Width=\"50\" Margin=\"0,0,0,12\"/&gt;\n            &lt;/DataTemplate&gt;\n          &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ListBox&gt;\n      &lt;/Views:CustomView&gt;\n    &lt;/DataTemplate&gt;\n  &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p><strong>The ViewModel</strong> - TimelineEntryViewModel</p>\n\n<pre><code>internal class TimelineEntryViewModel : ViewModel, IDisposable\n{\n  private readonly ObservableList&lt;TimelineEntry&gt; _groupEntries = new ObservableList&lt;TimelineEntry&gt;();\n  private readonly ObservableCollectionHandler&lt;TimelineEntry&gt; _groupEntriesHandler;\n\n  public TimelineEntryViewModel( TimelineViewModel timelineViewModel )\n  {\n    Tvm = timelineViewModel;\n    _groupEntriesHandler = new ObservableCollectionHandler&lt;TimelineEntry&gt;(_groupEntries, OnAdded, OnRemoved);\n    GroupEntries = _groupEntries.CreateView();\n    GroupEntries.SortDescriptions.Add( new SortDescription( \"TimeOccured\", ListSortDirection.Ascending) );\n  }\n\n  private void OnAdded( TimelineEntry tle )\n  {\n    GroupEntries.Refresh();\n  }\n\n  private void OnRemoved( TimelineEntry tle )\n  {\n    GroupEntries.Refresh();\n  }\n\n  public void AddEntry( TimelineEntry tle )\n  {\n    _groupEntries.Add( tle );\n  }\n\n  public void Dispose()\n  {\n    _groupEntriesHandler.Dispose();\n  }\n\n  public TimelineViewModel Tvm {get; private set;}\n  public DateTime GroupingTime {get; set;}\n  public ICollectionView GroupEntries {get; private set;}\n}\n</code></pre>\n\n<p><strong>The TimelineViewModel</strong> - the parts that govern the handling of the entries/zoom.  I use an eventAggregator to respond to specific messages that contain the information that goes into these entries and respond by creating the entry the calling the AddEntry function to place it in the appropriate location in the View.</p>\n\n<pre><code>internal sealed class TimelineViewModel : ViewModel, IDisposable\n{\n  private readonly ObservableList&lt;TimelineEntryViewModel&gt; _timelineEntries = new ObservableList&lt;TimelineEntryViewModel&gt;();\n  private readonly ObservableHandler _timelineEntriesHandler;\n\n  public TimelineViewModel ( )\n  {\n    // Omitting unnecessary code here\n    _timelineEntriesHandler = new ObservableHandler( _timelineEntries );\n    TimelineEntries = _timelineEntries.CreateView();\n    TimelineEntries.SortDescription.Add( new SortDescription( \"GroupingTime\", ListSortDirection.Ascending ) );\n    TimelineEntries.Refresh();\n  }\n\n  private void AddEntry( TimelineEntry tle )\n  {\n    var timeForNoOverlap = Projection.UnprojectDuration( 90 ); //This just gets the number of pixels needed for no overlap between panel groups.\n    if( _timelineEntries.Count == 0 )\n    {\n      _timelineEntries.Add( new TimelineEntryViewModel( this ) );\n      _timelineEntries[0].GroupingTime = tle.TimeOccured;\n      _timelineEntries[0].AddEntry( tle );\n    }\n    else if ( tle.TimeOccured &gt; _timelineEntries.Last().GroupingTime + timeForNoOverlap )\n    {\n      _timelineEntries.Add( new TimeLineViewModel( this );\n      _timelineEntries.Last().GroupingTime = tle.TimeOccured;\n      _timelineEntries.Last().AddEntry( tle );\n    }\n    else\n    {\n      foreach( TimelineEntryViewModel tevm in _timelineEntries )\n      {\n        if( tle.TimeOccured &gt;= tevm.GroupingTime &amp;&amp; tle.TimeOccured &lt;= tevm.GroupingTime + timeForNoOverlap)\n        {\n          tevm.AddEntry( tle );\n          break;\n        }\n      }\n    }\n    TimelineEntries.Refresh();\n  }\n\n  private void OnZoomChanged()\n  {\n    var tempEntries = new ObservableList&lt;TimelineEntryViewModel&gt;( _timelineEntries );\n\n    foreach( var group in _timelineEntries )\n      group.Dispose();\n    _timelineEntries.Clear();\n\n    foreach( var group in tempEntries )\n    {\n      foreach( var item in group.GroupEntries )\n        AddEntry( (TimelineEntry)item );\n    }\n\n    foreach( var group in tempEntries )\n      group.Dispose();\n    tempEntries.Clear();\n  }\n}\n</code></pre>\n"},{"tags":["wpf","mvvm","caliburn.micro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13087647,"title":"Caliburn.Micro and custom dependency properties not working","body":"<p>I am using the Caliburn.Micro framework for building my application. I am trying to create a custom chart control derived from the WPF toolkit chart, which needs to have 2 custom dependency properties added to it.</p>\n\n<p>For some reason, Caliburn.Micro is not binding correctly to the DP's that I created, but is working fine for existing ones. Is there something that I need to do for CM to recognize these additional properties?</p>\n\n<p>(In my example, the binding <code>Title=\"{Binding ChartSeriesType}\"</code> works correctly. The <code>ChartData</code> and <code>ChartType</code> are not being updated.)</p>\n\n<p>SampleChart.xaml.cs</p>\n\n<pre><code>public partial class SampleChart : Chart\n{\n    public ChartSeriesType ChartType\n    {\n        get { return (ChartSeriesType)GetValue(ChartTypeProperty); }\n        set\n        {\n            SetValue(ChartTypeProperty, value);\n            dataChaged();\n        }\n    }\n\n    // Using a DependencyProperty as the backing store for ChartType.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty ChartTypeProperty =\n        DependencyProperty.Register(\"ChartType\", typeof(ChartSeriesType), typeof(SampleChart), new UIPropertyMetadata(null));\n\n\n    public AgilityTableBase ChartData\n    {\n        get { return (AgilityTableBase)GetValue(ChartDataProperty); }\n        set\n        {\n            SetValue(ChartDataProperty, value);\n            dataChaged();\n        }\n    }\n\n    // Using a DependencyProperty as the backing store for ChartData.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty ChartDataProperty =\n        DependencyProperty.Register(\"ChartData\", typeof(AgilityTableBase), typeof(SampleChart), new UIPropertyMetadata(null));\n\n    private void dataChaged()\n    {\n        Console.WriteLine(\"data changed\");\n    } \n}\n</code></pre>\n\n<p>SampleChartView.xaml:</p>\n\n<pre><code>&lt;UserControl x:Class=\"Agility.Presentation.ReportViewing.SampleChartView\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" xmlns:cal=\"http://www.caliburnproject.org\"\n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n         xmlns:local=\"clr-namespace:Agility.Presentation.ReportViewing\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" d:DesignHeight=\"300\"\n         d:DesignWidth=\"300\" mc:Ignorable=\"d\"&gt;\n&lt;local:SampleChart Title=\"{Binding ChartSeriesType}\" ChartData=\"{Binding ReportTable}\" ChartType=\"{Binding ChartSeriesType}\" /&gt;\n</code></pre>\n\n<p></p>\n\n<p>SampleChartViewModel.cs:</p>\n\n<pre><code>public class SampleChartViewModel : PropertyChangedBase\n{\n    private ChartSeriesType _chartType;\n    private SampleTableBase _reportTable;\n\n    public SampleChartViewModel(SampleTableBase reportTable)\n    {\n        _reportTable = reportTable;\n    }\n\n    public SampleTableBase ReportTable\n    {\n        get { return _reportTable; }\n        set\n        {\n            _reportTable = value;\n            this.NotifyOfPropertyChange(() =&gt; ReportTable);\n        }\n    }\n\n    public ChartSeriesType ChartSeriesType\n    {\n        get { return _chartType; }\n        set\n        {\n            _chartType = value;\n            this.NotifyOfPropertyChange(() =&gt; ChartSeriesType);\n        }\n    }\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>The correct way to register the <code>ChartType DependencyProperty</code> is:</p>\n\n<pre><code>// Using a DependencyProperty as the backing store for ChartType.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty ChartTypeProperty =\n        DependencyProperty.Register(\"ChartType\", typeof(ChartSeriesType), typeof(AgilityChart), new UIPropertyMetadata(ChartSeriesType.Bar\n            , new PropertyChangedCallback(dataChanged)));\n\n    private static void dataChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\n    {\n        Console.WriteLine(\"data changed\");\n    } \n</code></pre>\n\n<p>Now, the <code>dataChanged()</code> method is being called.</p>\n"},{"tags":["wpf","dependency-injection","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13075471,"title":"Stuggling with WPF MVVM Unity, Generic Repository","body":"<p>How can I inject my CustomerRepository into my CustomerVM view model? In my view, a WPF Page I have:</p>\n\n<blockquote>\n<pre><code>&lt;Page.DataContext&gt;\n    &lt;viewModel:CustomerVM/&gt;\n&lt;/Page.DataContext&gt;\n</code></pre>\n</blockquote>\n\n<p>But my view model constructor obviously has parameter passed in, </p>\n\n<blockquote>\n<pre><code>    public CustomerVM(ICustomerRepository customerRepository)\n    {\n        //this._customerRepository = customerRepository;\n    }\n</code></pre>\n</blockquote>\n\n<p>I get </p>\n\n<blockquote>\n  <p>Type 'CustomerVM' is not usable as an object element because it is not\n  public or does not define a public parameterless constructor or a type\n  converter.</p>\n</blockquote>\n\n<p>Really struggling to heck.</p>\n\n<p>Any help appreciated.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13087617,"title":"Sort a editable ComboBox in XAML","body":"<p>I would like to sort a editable combobox in pure WPF, after the add of a new record. After some research I found some tips, which used a <code>CollectionViewSource.SortDescription</code>, but it dosent work for me correct. What am I doing worng? The DataContext of the Item which used my <code>DataTemplate</code> works fine, but the Binding between the <code>DataTemplate</code> and the Ressource Part to sort my entry list dosn't.</p>\n\n<hr>\n\n<p><strong>My XAML Part</strong></p>\n\n<pre><code>&lt;DataTemplate x:Key=\"Document\"&gt;\n    &lt;DataTemplate.Resources&gt;\n        &lt;CollectionViewSource x:Key=\"SortedLabels\" Source=\"{Binding Parent.Labels}\"&gt;\n            &lt;CollectionViewSource.SortDescriptions&gt;\n                &lt;scm:SortDescription PropertyName=\"Items\"/&gt;\n            &lt;/CollectionViewSource.SortDescriptions&gt;\n        &lt;/CollectionViewSource&gt;\n    &lt;/DataTemplate.Resources&gt;\n\n    &lt;Grid&gt;\n    ...\n        &lt;ComboBox Name=\"cbLabel\"\n                  ItemsSource=\"{Binding Source={StaticResource SortedLabels}}\"\n                  IsEditable=\"True\"\n                  LostFocus=\"cbLabel_LostFocus\"\n                  KeyUp=\"cbLabel_KeyUp\"\n                  Visibility=\"{Binding Path=IsUndiscovered, Converter={StaticResource ResourceKey=BooleanToVisibilityConverter}}\"/&gt;\n    ...\n    &lt;/Grid&gt;\n&lt;/DataTemplate&gt; \n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong>\nThe Collection <code>Parent.Labels</code> are from type <code>ObservableCollection&lt;String&gt;</code>.</p>\n"},{"tags":["wpf","data-binding","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12735535,"title":"DataBinding DataGrid to Custom Data Structure","body":"<p>So I am just joining the WPF club after dabbling in Winforms for a couple of years. I am definiately enjoing the databinding in WPF, but I am having trouble with the <code>DataGrid</code>.</p>\n\n<p>I have a highly-customized data structure that stores results from a SQL query, which I would like to continue to use in WPF. I have seen examples of binding to lists of objects, but not for anything dynamic like a SQL query.</p>\n\n<p>Is there some interface that I can make my data structure implement so the <code>DataGrid</code> can get the necessary information such as the row &amp; column count, headers, and the data?</p>\n"},{"tags":["wpf","focus","barcode-scanner"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1145,"score":0,"question_id":1493390,"title":"WPF Accept input without focus","body":"<p>I've created a screen in WPF that accepts input from a barcode scanner. I listen to PreviewTextInput event, and the KeyUp event, which let's me determine what the scanner \"typed\", and when it finished. It works great. You just have to have the form displayed and it will accept barcode scans.</p>\n\n<p>The problem is, I have other controls on the page, and they're causing issues. For example, when you push a button on the form, that button then has focus. Hitting the enter key from that point on results in the button event handler being fired. It doesn't automatically give up focus.</p>\n\n<p>Does anyone know an <strong>elegant</strong> solution to this type of problem? I'd rather not add code to every event handler to focus another element, but I will do that as a last resort.</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":45,"score":-1,"question_id":13086113,"title":"Event to know usercontrol's disposal?","body":"<p>if a window with usercontrol is getting closed, then i should call a method in the usercontrol i.e. nothing but when usercontrol is disposed. How do i do that?</p>\n"},{"tags":["wpf","parameters","command"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3468,"score":1,"question_id":5105233,"title":"Multiple Parameter to pass to Command WPF","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1350598/passing-two-command-parameters-using-a-wpf-binding\">Passing two command parameters using a WPF binding</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following hierarchy:</p>\n\n<pre><code>abstract class TicketBase\n{\n    public DateTime PublishedDate { get; set; }\n}\n\nclass TicketTypeA:TicketBase\n{\n     public string PropertyA { get; set; }\n}   \n\nclass TicketTypeB:TicketBase\n{\n     public string PropertyB { get; set; }\n}\n</code></pre>\n\n<p>In my VM I have a <code>List&lt;TicketBase&gt; Tickets</code>. When a user clicks a button on my app, they want to see a list of <em>previous</em> values of a certain property, e.g.:</p>\n\n<pre><code>&lt;Button Tag=\"{x:Type Types:TicketTypeA}\" \n        Command=\"{Binding ListHistoryCommand}\"\n        CommandParameter=\"{Binding Tag, RelativeSource={RelativeSource Self}}\" /&gt;\n</code></pre>\n\n<p>as you can see, I set my <code>Tag</code> property to TicketTypeA and pass that as parameter to my command: </p>\n\n<pre><code>private void ListHistory(object o)\n{\n   if (Tickets.Count == 0)\n       return;\n   Type ty = o as Type;\n   ValueHistory = new ObservableCollection&lt;TicketBase&gt;(GetTicketsOfType(ty).Select(t =&gt; t)); // &lt;- Need to return t.PropertyA here, but dynamically\n}\n\nIEnumerable&lt;TicketBase&gt; GetTicketsOfType(Type type)\n{\n    if (!typeof(TicketBase).IsAssignableFrom(type))\n        throw new ArgumentException(\"Parameter 'type' is not a TicketBase\");\n    return Tickets.Where(p =&gt; p.GetType() == type);\n}\n</code></pre>\n\n<p>(<code>ValueHistory</code> is another collection that I set as <code>ItemsSource</code> on my grid)</p>\n\n<p>However I need to also pass in the <em>property</em> name too, so that I can display just that property in the grid like so:</p>\n\n<pre><code>Published Time     |  PropertyA\n===================================================\n09:00              | &lt;value of PropertyA at 09:00&gt;\n08:55              | &lt;value of PropertyA at 08:55&gt;\n</code></pre>\n\n<p>So the question is basically what is the cleanest way to pass in the property name as another parameter into my command?</p>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13086674,"title":"Asynchronous update using MVVM?","body":"<p>My model contains a <em>large</em> data object that I update from code-behind (currently this happens on the UI thread but I intend to do this in a worker later on). One of my windows has a viewmodel for this model and outputs this data object using an <code>IValueConverter</code>. The problem is that this conversion takes several seconds. Hence, I need my window to fetch this updated data asynchronously. How can this be done?</p>\n\n<p><strong>MyControl.xaml:</strong></p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n   &lt;local:DataViewModel x:Name=\"dataViewModel\"/&gt;\n&lt;/UserControl.DataContext&gt;\n</code></pre>\n\n<p><strong>Then in code:</strong></p>\n\n<pre><code>// This triggers my value converter and blocks the UI for several seconds!\ndataViewModel.HeavyObject = data;\n</code></pre>\n\n<p>Where should the multi-threading code go? Should it be part of the viewmodel or my value converter?</p>\n"},{"tags":["c#","wpf","inkcanvas"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13087173,"title":"Create line joining two points on wpf InkCanvas","body":"<p>I have a wpf ink canvas. i need to draw a line that connects two points on it. The scenario is that when i click on inkcanvas, my line should start and at mousedown event or so, that straight line should get created. please help. thank you.</p>\n"},{"tags":[".net","wpf","twitterizer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13086738,"title":"How can I avoid asking twitter to grant access for my app everytime the user signs in to my WPF program using twitterizer?","body":"<p>I'm using twitterizer to signin to my wpf program. Every time when the program is executed, twitter generated pin is stored in a variable and then app runs. Is it possible to authenticate only once and then remember that approval? If possible, then how?</p>\n"},{"tags":["wpf","templates","mvvm","styles"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13086572,"title":"Styles and Templates at run time WPF","body":"<p>I have created a custom reusable control in WPF.\nI want that while using that, the consumer supplies the styles and templates for the items within the control.\nThis is not a trivial items control. I am using a third part graph control inside the component I am using. I want that when consuming my control the consumer mentions the styles and templates for nodes/edges. What is the best way to achieve this?</p>\n\n<p>regards,</p>\n"},{"tags":["wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13085665,"title":"Bind the tab header to a property from code","body":"<p>I am binding a collection to a TabControl using its ItemSource property.</p>\n\n<p>I'm programming WPF in code and not in XAML to get a deeper understanding.</p>\n\n<p>The problem I'm faced with is that if I want to bind the header of a TabItem to a property (\"EntityID\") the binding does not kick in.</p>\n\n<p>The code works if I set a value instead of a binding (code below in comments)</p>\n\n<pre><code>var binding = new Binding();\nbinding.Path = new PropertyPath(\"EntityID\");\n\nDataTemplate itemTemplate = new DataTemplate();\nvar label = new FrameworkElementFactory(typeof(Label));\n\n//label.SetValue(Label.ContentProperty,\"test\");\nlabel.SetBinding(Label.ContentProperty, binding);\n\nitemTemplate.VisualTree = label;\n\n_tabControl.ItemTemplate = itemTemplate;\n</code></pre>\n\n<p>Furthermore, if set the ContentTemplate instead of the ItemTemplate the binding works as well.</p>\n\n<p>How can I bind the tab header to a property of my ItemsSource from purely code?</p>\n"},{"tags":["wpf","popup","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13086173,"title":"wpf nested popups","body":"<p>I'm developing a custom control which has a button that opens a popup.\nWhen that popup contains another instance of my custom control (which also has a button that opens another popup, e.g. a calendar) some problems occur.\nThe second (nested) popup won't act as suspected. Clicks don't work, won't close, when parent popup is closed.\nAre there any specific best practices when using nested popups?</p>\n"},{"tags":["c#","wpf","pdf","thumbnails"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":49,"score":-1,"question_id":13086147,"title":"Creating thumbnails of a pdf document in C#","body":"<p>As the title says. I tried the <code>ABCPdf</code> library by Websupergoo, but using it you can either render a page to a file, and then read it and show to the user, or use the <code>Doc.GetBitmap()</code> method, which returns an instance of the <code>Bitmap</code> class. The first way is really slow, so is the second, because, I am creating a WPF application and I use the <code>Image</code> control in it, which accepts the <code>ImageSource</code> and there is no cast from <code>Bitmap</code> to <code>ImageSource</code>, so I have to convert <code>Bitmap</code> to <code>BitmapSource</code> and it takes a lot of time, especially if the document has 100+ pages.   </p>\n"},{"tags":["wpf","xaml","triggers","controltemplate","resourcedictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":13010024,"title":"Include XAML Trigger To ControlTemplate","body":"<p>I am pretty new with WPF and am doing some custom control stuff...\nMy problem is that the code in one file is going to be way to much, so i want\nto split the code in seperate files, so other people looking in that code aren´t going to be overwhelmed.</p>\n\n<p>Okay to my question...\nI got a ResourceDictionary... the \"Generic.xaml\"\nIn this file a got the template of an DataGrid:</p>\n\n<pre><code>    &lt;Style TargetType=\"{x:Type local:BADataGrid}\"&gt;\n    &lt;Style.Setters&gt;\n        &lt;Setter Property=\"Control.Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"local:BADataGrid\"&gt;\n                    &lt;Border BorderBrush=\"{TemplateBinding BorderBrush}\" \n                        BorderThickness=\"{TemplateBinding BorderThickness}\"\n                        Background=\"{TemplateBinding Background}\" \n                        Padding=\"{TemplateBinding Padding}\" \n                        SnapsToDevicePixels=\"True\"&gt;\n\n           &lt;!-- *SOME TEMPLATE CODE* --&gt;\n\n                    &lt;/Border&gt;\n                    &lt;ControlTemplate.Triggers&gt;\n                        &lt;Trigger Property=\"GridStyle\" Value=\"CUSTOMER\"&gt;\n                            &lt;Trigger.Setters&gt;\n                                &lt;Setter Property=\"ColumnHeaderStyle\"&gt;\n                                    &lt;Setter.Value&gt;\n                                        &lt;Style TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n                                            &lt;Setter Property=\"Background\"&gt;\n                                                &lt;Setter.Value&gt;\n                                                    &lt;ImageBrush&gt;\n                                                        &lt;ImageBrush.ImageSource&gt;\n                                                            &lt;Binding  Path=\"HeaderBackground\" RelativeSource=\"{RelativeSource AncestorType=local:BADataGrid}\"&gt;\n                                                                &lt;Binding.TargetNullValue&gt;\n                                                                    &lt;ImageSource&gt;\n                                                                        headerBack.png\n                                                                    &lt;/ImageSource&gt;\n                                                                &lt;/Binding.TargetNullValue&gt;\n                                                            &lt;/Binding&gt;\n                                                        &lt;/ImageBrush.ImageSource&gt;\n                                                    &lt;/ImageBrush&gt;\n                                                &lt;/Setter.Value&gt;\n                                            &lt;/Setter&gt;\n                                        &lt;/Style&gt;\n                                    &lt;/Setter.Value&gt;\n                                &lt;/Setter&gt;\n                            &lt;/Trigger.Setters&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/ControlTemplate.Triggers&gt;\n\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style.Setters&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Now I want the \"ControlTemplate.Triggers\" part of the code above in another .XAML File.</p>\n\n<p>Is this even possible?</p>\n"},{"tags":["wpf","list","xaml","bind"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13077597,"title":"bind list to object list property in xaml (wpf) (Application.Resources)","body":"<p>I've been searching a lot in the internet to solve this problem and couldn't find decent solution. this is the problem:(this is a WPF app, in VS2010)\nAssume i have this classes:</p>\n\n<pre><code>public class Airplane\n{\n   public string AirplaneName{get;set;}\n   public ObservableCollection&lt;People&gt; myPeopleList {get;set;}\n}\npublic class People\n{\n   public string Name{get;set;}\n   public string SeatNumber{get;set;}   \n}\n</code></pre>\n\n<p>Now I want to create an instance of Airplane class including the people list in the file App.xaml. That is, to create my own resource (Application.Resources). I tried this but I get an exception:</p>\n\n<pre><code>&lt;lcl:AirPlaneCollection x:Key=\"apCollection\" &gt;\n            &lt;lcl:Airplane  Name=\"airbus-780\" myPeopleList=\"{StaticResource pList}\" &gt;\n&lt;/lcl:AirPlaneCollection&gt;\n        &lt;lcl:PeopleCollection x:Key=\"pList\"&gt;\n            &lt;lcl:People  Name=\"name1\" SeatNumber=\"1\"/&gt;\n           &lt;lcl:People  Name=\"name2\" SeatNumber=\"2\"/&gt;\n        &lt;/lcl:PeopleCollection&gt;\n</code></pre>\n\n<p>AirPlaneCollection and PeopleCollection is just simple class that inherits from <code>ObservableCollection&lt;Airplane&gt;</code> and <code>ObservableCollection&lt;Poeple&gt;</code>\nwhen i try to use that resource (Application.Current.Resources[\"appCollection\"] it compile but i get an exception at run time.\nmy TreeView DataTemplate is performing well because if i instantiate the classes in the code-behind as regular lists(Add ect.) it works flawlessly..what am i doing wrong??\nthank in advanced.. </p>\n"},{"tags":["c#","wpf","mvvm","wpftoolkit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13084413,"title":"How to make input controls communicate with each other in MVVM (WPF)?","body":"<p>I'm working on a temperature converter as a test project. It has three up/down-controls that should communicate with each other. (The labels to the right are only for debugging.) When I change the temperatures by spinning (e.g. Celsius) its corresponding label updates correctly, but I also want the Kelvin and Fahrenheit values to change simultaneously. But they don't. Why not?</p>\n\n<p>The intention is that the model (TempModel) only should keep one value (Kelvin). The others should be calculated when needed. I have tried different approaches to get the Celsius and Fahrenheit values. In this case I have properties in the model that calculates its value from the private _Kelvin variable. It works at start up, but not when I am changing the values in runtime. </p>\n\n<p>I have also tried to do similar things with the properties in the view model.</p>\n\n<p>I believe the solution is fairly simple and has something to do with the bindings, but I still can't find it.  </p>\n\n<p>Here is what it looks like:\n<a href=\"http://s16.postimage.org/glcg9elth/Temp.png\" rel=\"nofollow\" title=\"User interface image\">User interface image</a></p>\n\n<p>Here is the view XAML code:</p>\n\n<pre><code>&lt;Window x:Class=\"Temperature.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:extToolkit=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit/extended\"\n    Title=\"Temperature converter\" Height=\"183\" Width=\"468\"&gt;\n&lt;Grid VerticalAlignment=\"Stretch\"&gt;\n    &lt;Label Content=\"Kelvin\" Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"10,10,0,0\" Name=\"label1\" VerticalAlignment=\"Top\" /&gt;\n    &lt;extToolkit:DoubleUpDown Name=\"_KelvinUD\" Increment=\"0.1\" FormatString=\"F2\" Value=\"{Binding Kelvin}\" HorizontalAlignment=\"Left\" Width=\"100\" VerticalAlignment=\"Top\" Margin=\"113,14,0,0\" /&gt;\n    &lt;Label Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"279,10,0,0\" Name=\"label4\" VerticalAlignment=\"Top\" Content=\"{Binding Kelvin}\" /&gt;\n\n    &lt;Label Content=\"Celsius\" Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"12,44,0,0\" Name=\"label2\" VerticalAlignment=\"Top\" /&gt;\n    &lt;extToolkit:DoubleUpDown Name=\"_CelsiusUD\" Increment=\"0.1\" FormatString=\"F2\" Value=\"{Binding Celsius}\" HorizontalAlignment=\"Left\" Width=\"100\" VerticalAlignment=\"Top\" Margin=\"113,48,0,0\" /&gt;\n    &lt;Label Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"279,44,0,0\" Name=\"label5\" VerticalAlignment=\"Top\" Content=\"{Binding Celsius}\" /&gt;\n\n    &lt;Label Content=\"Fahrenheit\" Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"12,78,0,0\" Name=\"label3\" VerticalAlignment=\"Top\" /&gt;\n    &lt;extToolkit:DoubleUpDown Name=\"_FarenheitUD\" Increment=\"0.1\" FormatString=\"F2\" Value=\"{Binding Fahrenheit}\" HorizontalAlignment=\"Left\" Width=\"100\" VerticalAlignment=\"Top\" Margin=\"113,82,0,0\" /&gt;\n    &lt;Label Height=\"28\" HorizontalAlignment=\"Left\" Margin=\"279,78,0,0\" Name=\"label6\" VerticalAlignment=\"Top\" Content=\"{Binding Fahrenheit}\" /&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>The code behind:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\n\nnamespace Temperature\n{\n    public partial class MainWindow : Window\n    {\n        private TempViewModel _viewModel = new TempViewModel();\n        TempViewModel ViewModel\n        {\n            get { return _viewModel; }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent();\n            base.DataContext = ViewModel;\n        }\n    }\n}\n</code></pre>\n\n<p>The model:</p>\n\n<pre><code>using System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.ComponentModel;\n\nnamespace Temperature\n{\n    public class TempModel\n    {\n        private double _kelvin;\n        public double Kelvin\n        {\n            get\n            {\n                return _kelvin;\n            }\n            set\n            {\n                _kelvin = value;\n                OnPropertyChanged(\"Kelvin\");\n            }\n        }\n\n        public double Celsius\n        {\n            get\n            {\n                return _kelvin - 273.15;\n            }\n            set\n            {\n                _kelvin = value + 273.15;\n                OnPropertyChanged(\"Celsius\");\n            }\n        }\n\n        public double Fahrenheit\n        {\n            get\n            {\n                return 9.0 / 5.0 * (_kelvin - 273.15) + 32;\n            }\n            set\n            { \n                _kelvin = 5.0 / 9.0 * (value - 32) + 273.15;\n                OnPropertyChanged(\"Fahrenheit\");\n            }\n        }\n\n        public event PropertyChangedEventHandler PropertyChanged;\n        private void OnPropertyChanged(string propertyName)\n        {\n            if (PropertyChanged != null)\n            {\n                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }\n\n    }\n}\n</code></pre>\n\n<p>The view model: </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace Temperature\n{\n    class TempViewModel\n    {\n        TempModel _tempModel;\n\n        public TempViewModel()\n        {\n            _tempModel = new TempModel \n            {\n                Kelvin = 300.15 // Initial value\n            };\n        }\n\n        public TempModel TempModel\n        {\n            get\n            {\n                return _tempModel;\n            }\n            set\n            {\n                _tempModel = value;\n            }\n        }\n\n        public double Kelvin\n        {\n            get\n            {\n                return _tempModel.Kelvin;\n            }\n            set\n            {\n                _tempModel.Kelvin = value;\n            }\n        }\n        public double Celsius\n        {\n            get\n            {\n                return _tempModel.Celsius;\n            }\n            set\n            {\n                _tempModel.Celsius = value;\n            }\n        }\n        public double Fahrenheit\n        {\n            get\n            {\n                return _tempModel.Fahrenheit;\n            }\n            set\n            {\n                _tempModel.Fahrenheit = value;\n            }\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13083872,"title":"c# - Get the url the user typed into the browser","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/593709/how-to-get-the-url-of-the-current-page-in-c-sharp\">How to get the URL of the current page in C#</a>  </p>\n</blockquote>\n\n\n\n<p>I want to develop an application which stores users browsing history in real time while my application running in background.</p>\n\n<p>e.g While my application running in background if user types url in chrome or firefox .. i want to store that url in database</p>\n\n<p>how to do that in C#?</p>\n"},{"tags":["wpf","silverlight","ms-access","lan","silverlight-oob"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12864059,"title":"Can we share Silverlight application with access Db over LAN","body":"<p>I am developing small institute management system as an academic project in my college.\nI am going to develop the project in silverlight 4 or 5. In this project I want to provide attendance facility; i.e students will able to log in application from their respective machine which will be connected to LAN. There will be no internet connection available.</p>\n\n<p>Can I develop this application which will not required internet connection once it is installed but can still accessible to different machine which are connected in a network over a LAN</p>\n\n<pre><code>1.How can I achive this?\n2. should I use silverlight out of browser app or simple silverlight app\n3. Is there any way to achive this using WPF?\n</code></pre>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13082241,"title":"Change WPF DataGrid cell Background color on CellEditEnding","body":"<p>I have <code>WPF</code> <code>DataGrid</code> and a <code>event handler</code> <code>CellEditEnding</code>, I want a simple <code>code</code> to change the background color of edited <code>cell</code> inside the <code>event handler</code>.</p>\n"},{"tags":["wpf","wpfdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13082345,"title":"WPF Datagrid TemplateColumn Control Enable and Disable","body":"<p>I have Datagrid with two TemplateColumn. </p>\n\n<p>First column is a Combobox and Second column with Extended IntergerUpDown control</p>\n\n<p>I need to Enable/Disable the IntegerUpDown control based on the Combox box SelectedItem value.</p>\n\n<p>Please help me how to accomplish this. Sample xaml below.</p>\n\n<pre><code>&lt;Grid&gt;&lt;DataGrid ItemsSource=\"{Binding List1}\" Name=\"x1\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTemplateColumn Header=\"ColorTemplate\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;ComboBox  ItemsSource=\"{Binding DataContext.List2, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type DataGrid}}}\" \n                                      DisplayMemberPath=\"Name\"  SelectedValue=\"{Binding ColourId}\" SelectedValuePath=\"Id\" Tag=\"{Binding Id}\"\n                                       HorizontalAlignment=\"Stretch\" x:Name=\"discussTemplate\" VerticalAlignment=\"Stretch\"\n                                         /&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                &lt;/DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn Header=\"UPDown\" Width=\"Auto\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;extToolkit:IntegerUpDown AllowSpin=\"True\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" Width=\"Auto\" Minimum=\"0\"\n                                                  x:Name=\"updown\"\n                                                  IsEnabled=\"????\" &gt;\n\n                            &lt;/extToolkit:IntegerUpDown&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                &lt;/DataGridTemplateColumn&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n</code></pre>\n"},{"tags":["wpf","multithreading","user-interface","concurrency"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":710,"score":1,"question_id":5266341,"title":"WPF UI thread freezes momentarily when a mouseup event triggers an animation","body":"<p>I have a WPF application that is constantly animating. One interaction (mouseup) and animation in particular seems to freeze the UI thread for long enough to be very noticable.</p>\n\n<p>Concurrency Visualizer shows me my UI thread is blocked for 300 - 500ms. It also shows the stack while it's blocked and the unblocking stack:</p>\n\n<p><strong>Main thread stack while frozen</strong>:<br>\nCategory = Synchronization<br>\nDelay = 495.2472 ms  </p>\n\n<pre><code>ntoskrnl.exe!SwapContext_PatchXRstor\nntoskrnl.exe!KiSwapContext\nntoskrnl.exe!KiCommitThreadWait\nntoskrnl.exe!KeWaitForSingleObject\nntoskrnl.exe!NtWaitForSingleObject\nntoskrnl.exe!KiSystemServiceCopyEnd\nntdll.dll!NtWaitForSingleObject\nkernelbase.dll!WaitForSingleObjectEx\nwpfgfx_v0400.dll!CMilConnection::SynchronizeChannel\nwpfgfx_v0400.dll!CMilChannel::SyncFlush\nwpfgfx_v0400.dll!MilComposition_SyncFlush\nclr.dll!DoNDirectCallWorker\npresentationcore.dll!System.Windows.Media.Composition.DUCE+Channel.**SyncFlush**\npresentationcore.dll!System.Windows.Media.MediaContext.NotifyChannelMessage\npresentationcore.dll!System.Windows.Media.MediaContextNotificationWindow.MessageFilter\nwindowsbase.dll!MS.Win32.HwndWrapper.WndProc\nwindowsbase.dll!MS.Win32.HwndSubclass.DispatcherCallbackOperation\nwindowsbase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall\nwindowsbase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen\nwindowsbase.dll!System.Windows.Threading.Dispatcher.WrappedInvoke\nwindowsbase.dll!System.Windows.Threading.Dispatcher.InvokeImpl\nwindowsbase.dll!MS.Win32.HwndSubclass.SubclassWndProc\nwindowsbase.dll!dynamicClass.IL_STUB_ReversePInvoke\nclr.dll!UMThunkStubAMD64\nuser32.dll!UserCallWinProcCheckWow\nuser32.dll!DispatchMessageWorker\nclr.dll!DoNDirectCall__PatchGetThreadCall\nwindowsbase.dll!dynamicClass.IL_STUB_PInvoke\nwindowsbase.dll!System.Windows.Threading.Dispatcher.PushFrameImpl\npresentationframework.dll!System.Windows.Application.RunInternal\npresentationframework.dll!System.Windows.Application.Run\nxqstream.windows.exe!IQ.IR.Stream.WPF.App.Main\n</code></pre>\n\n<p><strong>Unblocking Stack:</strong></p>\n\n<pre><code>ntoskrnl.exe! ?? ?? ::FNODOBFM::`string'\nntoskrnl.exe!NtSetEvent\nntoskrnl.exe!KiSystemServiceCopyEnd\nntdll.dll!ZwSetEvent\nkernelbase.dll!SetEvent\nwpfgfx_v0400.dll!CMilConnection::PostMessageToClient\nwpfgfx_v0400.dll!CMilServerChannel::SignalFinishedFlush\nwpfgfx_v0400.dll!CComposition::FlushChannels\nwpfgfx_v0400.dll!CPartitionThread::RenderPartition\nwpfgfx_v0400.dll!CPartitionThread::Run\nwpfgfx_v0400.dll!CPartitionThread::ThreadMain\n</code></pre>\n\n<p>The main thread is waiting on a background thread. That background thread is doing a number of things, but this stack takes up ~3/4 of the time:</p>\n\n<p><strong>Blocking thread's largest task:</strong>\nCategory = I/O<br>\nDelay = 347.5122 ms  </p>\n\n<pre><code>ntoskrnl.exe!SwapContext_PatchXRstor\nntoskrnl.exe!KiSwapContext\nntoskrnl.exe!KiCommitThreadWait\nntoskrnl.exe!KeWaitForSingleObject\ndxgmms1.sys!VIDMM_GLOBAL::CloseOneAllocation\ndxgmms1.sys!VidMmCloseAllocation\ndxgkrnl.sys!DXGDEVICE::DestroyAllocations\ndxgkrnl.sys!DXGDEVICE::ProcessTerminationList\ndxgkrnl.sys!DXGDEVICE::TerminateAllocations\ndxgkrnl.sys!DXGDEVICE::DestroyAllocation\ndxgkrnl.sys!DxgkDestroyAllocation\nwin32k.sys!NtGdiDdDDIDestroyAllocation\nntoskrnl.exe!KiSystemServiceCopyEnd\ngdi32.dll!ZwGdiDdDDIDestroyAllocation\nd3d9.dll!DeallocateCB\ndlumd64.dll![dlumd64.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\nnvd3dumx.dll![nvd3dumx.dll]\ndlumd64.dll![dlumd64.dll]\ndlumd64.dll![dlumd64.dll]\nd3d9.dll!DdBltLH\nd3d9.dll!CSwapChain::PresentMain\nd3d9.dll!CSwapChain::Present\nwpfgfx_v0400.dll!CD3DDeviceLevel1::PresentWithD3D\nwpfgfx_v0400.dll!CD3DDeviceLevel1::Present\nwpfgfx_v0400.dll!CHwDisplayRenderTarget::PresentInternal\nwpfgfx_v0400.dll!CHwDisplayRenderTarget::Present\nwpfgfx_v0400.dll!CHwHWNDRenderTarget::Present\nwpfgfx_v0400.dll!CDesktopRenderTarget::Present\nwpfgfx_v0400.dll!CDesktopHWNDRenderTarget::Present\nwpfgfx_v0400.dll!CSlaveHWndRenderTarget::Present\nwpfgfx_v0400.dll!CRenderTargetManager::Present\nwpfgfx_v0400.dll!CComposition::Present\nwpfgfx_v0400.dll!CPartitionThread::PresentPartition\nwpfgfx_v0400.dll!CPartitionThread::Run\nwpfgfx_v0400.dll!CPartitionThread::ThreadMain\n</code></pre>\n\n<p>I've read SyncFlush() is called after several MilCore functions and appears to cause the changes that have been sent to be processed immediately (credit to Ray Burns). </p>\n\n<p>I'd like to get rid of this freeze, but I'm also hoping to develop a better understanding of what WPF is doing in this situation so that I can build a better mental model of how WPF works.</p>\n"},{"tags":["c#","wpf","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13081725,"title":"How to Select All CheckBox of a Column by DataGrid Header CheckBox in WPF DataGrid","body":"<p>I have a DataGrid with one CheckBoxColumn. In the header of that CheckBoxColumn I have added a CheckBox to Select all CheckBoxes of that Datagrid Row.</p>\n\n<p>How can I achieve that?</p>\n\n<p>My XAML Code for WPF dataGrid:</p>\n\n<pre><code>    &lt;DataGrid AutoGenerateColumns=\"False\" CanUserAddRows=\"False\"  Grid.RowSpan=\"2\" Height=\"130\" HorizontalAlignment=\"Left\" IsReadOnly=\"False\" Margin=\"189,340,0,0\" Name=\"dgCandidate\" TabIndex=\"7\" VerticalAlignment=\"Top\" Width=\"466\" Grid.Row=\"1\" &gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn x:Name=\"colCandidateID\" Binding=\"{Binding CandidateID}\" Header=\"SlNo\" MinWidth=\"20\" IsReadOnly=\"True\" /&gt;\n            &lt;DataGridTextColumn x:Name=\"colRegistraion\" Binding=\"{Binding RegisterNo}\" Header=\"Reg. No.\" IsReadOnly=\"True\"  /&gt;\n            &lt;DataGridTextColumn x:Name=\"colCandidate\" Binding=\"{Binding CandidateName}\" Header=\"Name\" MinWidth=\"250\" IsReadOnly=\"True\"  /&gt;\n\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.Header&gt;\n                    &lt;CheckBox Name=\"chkSelectAll\" Checked=\"chkSelectAll_Checked\" Unchecked=\"chkSelectAll_Unchecked\"&gt;&lt;/CheckBox&gt;\n                &lt;/DataGridTemplateColumn.Header&gt;\n                &lt;DataGridTemplateColumn.CellTemplate &gt;\n                    &lt;DataTemplate &gt;\n                        &lt;CheckBox x:Name=\"colchkSelect1\" Checked=\"colchkSelect1_Checked\" Unchecked=\"colchkSelect1_Unchecked\" &gt;&lt;/CheckBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n\n        &lt;/DataGrid.Columns&gt;\n\n    &lt;/DataGrid&gt;\n</code></pre>\n"},{"tags":["wpf","devexpress"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13063521,"title":"How to apply custom theme in DevExpress?","body":"<p>I have created a custom theme using DevExpress theme editor and built the dll file and included it in the resources section.But how can I apply it to the application ??</p>\n"},{"tags":["c#","asp.net",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13081687,"title":"c# - Monitoring Email Activities of pc","body":"<p>I want to develop an application in wpf which monitors Email activities from my computer.</p>\n\n<p>e.g. After sending mail mail from my yahoo account from browser .. i want to show mail details like sender id , subject etc in datagrid in my WPF application.</p>\n\n<p>Is it possible in wpf C#? How to do that?</p>\n"},{"tags":["wpf",".net-4.0","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13081064,"title":"Datagrid Binding TextBox Memory Leak","body":"<p>I red many articles about datagrid leaking, and couldn't find right way.\nHere is some code to reproduce. It has datagrid and buttoon, each time you press button, it fills table with random numbers, and takes 10mb of memory, and doesn't release it.\nBinding to TextBlock doesn't cause memory leak, but i need textbox two way binding.</p>\n\n<pre><code>&lt;Window x:Class=\"test.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition&gt;&lt;/RowDefinition&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;DataGrid Name=\"dg\" Grid.Row=\"0\" AutoGenerateColumns=\"False\" ItemsSource=\"{Binding}\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text0}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text1}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text2}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text3}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text4}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text5}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text6}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text7}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text8}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n            &lt;DataGridTemplateColumn&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;TextBox Text=\"{Binding Text9}\"&gt;&lt;/TextBox&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n    &lt;Button Content=\"update\" Grid.Row=\"1\" Width=\"Auto\" Height=\"Auto\" Click=\"Button_Click\"&gt;&lt;/Button&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>namespace test\n{\n/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n\n\n    }\n\n    public ObservableCollection&lt;obj&gt; res;\n    private void Button_Click(object sender, RoutedEventArgs e)\n    {\n        res = new ObservableCollection&lt;obj&gt;();\n\n\n        for (var i = 0; i &lt; 20; i++)\n        {\n            res.Add(new obj\n            {\n                Text0 = ((new Random()).NextDouble() * 100).ToString(),\n                Text1 = ((new Random()).NextDouble() * 100).ToString(),\n                Text2 = ((new Random()).NextDouble() * 100).ToString(),\n                Text3 = ((new Random()).NextDouble() * 100).ToString(),\n                Text4 = ((new Random()).NextDouble() * 100).ToString(),\n                Text5 = ((new Random()).NextDouble() * 100).ToString(),\n                Text6 = ((new Random()).NextDouble() * 100).ToString(),\n                Text7 = ((new Random()).NextDouble() * 100).ToString(),\n                Text8 = ((new Random()).NextDouble() * 100).ToString(),\n                Text9 = ((new Random()).NextDouble() * 100).ToString(),\n            });\n        }\n        dg.DataContext = res;\n    }\n\n\n}\npublic class obj : INotifyPropertyChanged\n{\n    private string text0;\n    public string Text0\n    {\n        get\n        {\n            return text0;\n        }\n        set\n        {\n            text0 = value;\n            NotifyPropertyChanged(\"Text0\");\n        }\n    }\n    private string text1;\n    public string Text1\n    {\n        get\n        {\n            return text1;\n        }\n        set\n        {\n            text1 = value;\n            NotifyPropertyChanged(\"Text1\");\n        }\n    }\n    private string text2;\n    public string Text2\n    {\n        get\n        {\n            return text2;\n        }\n        set\n        {\n            text2 = value;\n            NotifyPropertyChanged(\"Text2\");\n        }\n    }\n    private string text3;\n    public string Text3\n    {\n        get\n        {\n            return text3;\n        }\n        set\n        {\n            text3 = value;\n            NotifyPropertyChanged(\"Text3\");\n        }\n    }\n    private string text4;\n    public string Text4\n    {\n        get\n        {\n            return text4;\n        }\n        set\n        {\n            text4 = value;\n            NotifyPropertyChanged(\"Text4\");\n        }\n    }\n    private string text5;\n    public string Text5\n    {\n        get\n        {\n            return text5;\n        }\n        set\n        {\n            text5 = value;\n            NotifyPropertyChanged(\"Text5\");\n        }\n    }\n    private string text6;\n    public string Text6\n    {\n        get\n        {\n            return text6;\n        }\n        set\n        {\n            text6 = value;\n            NotifyPropertyChanged(\"Text6\");\n        }\n    }\n    private string text7;\n    public string Text7\n    {\n        get\n        {\n            return text7;\n        }\n        set\n        {\n            text7 = value;\n            NotifyPropertyChanged(\"Text7\");\n        }\n    }\n    private string text8;\n    public string Text8\n    {\n        get\n        {\n            return text8;\n        }\n        set\n        {\n            text8 = value;\n            NotifyPropertyChanged(\"Text8\");\n        }\n    }\n    private string text9;\n    public string Text9\n    {\n        get\n        {\n            return text9;\n        }\n        set\n        {\n            text9 = value;\n            NotifyPropertyChanged(\"Text9\");\n        }\n    }\n\n    private void NotifyPropertyChanged(String info)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(info));\n        }\n    }\n    public event PropertyChangedEventHandler PropertyChanged;\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["wpf","wpfdatagrid"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":12970463,"title":"Split the column of datagrid in WPF","body":"<p><img src=\"http://i.stack.imgur.com/9C3RW.png\" alt=\"enter image description here\">I have a datagrid in my form which has columns for each of Question Types.\nI want that column to be split into two as i want to accept number of compulsory and number of optional questions for each of the question type in the subsequent columns.</p>\n\n<p>I have achieved this in winforms, thanks to stackoverflow.com.</p>\n\n<p>I am trying to achieve the same in WPF</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13071442,"title":"assigning different click handlers to a global control template","body":"<p>I am using a slightly modified version of this SimpleExpander so that my expander headers are clickable.</p>\n\n<p><a href=\"http://www.codeproject.com/Articles/248112/Templating-WPF-Expander-Control\" rel=\"nofollow\">http://www.codeproject.com/Articles/248112/Templating-WPF-Expander-Control</a></p>\n\n<p>Here is the relevant source code:</p>\n\n<pre><code>&lt;ControlTemplate x:Key=\"SimpleExpanderTemp\" TargetType=\"{x:Type Expander}\"&gt;\n\n            &lt;DockPanel&gt;\n\n                &lt;StackPanel DockPanel.Dock=\"Top\" Orientation=\"Horizontal\"&gt;\n                    &lt;ToggleButton x:Name=\"ExpanderButton\" /&gt;\n\n                    &lt;!-- button with hard coded click handler --&gt;\n                    &lt;Button Name=\"SharerHeader\" Click=\"SharerHeader_Click_1\"&gt; \n                        &lt;ContentPresenter Content=\"{TemplateBinding Header}\" /&gt;\n                    &lt;/Button&gt;\n                &lt;/StackPanel&gt;\n\n            &lt;/DockPanel&gt;\n        &lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>Works great.  Now I want to reuse this control template across my application, so I moved the code into my app.xaml.  However, my header is hardcoded to a click event, and I want to be able to set the click handler based on the page the expander is being used in.  How can I accomplish this?</p>\n"},{"tags":["c#","wpf","resources","triggers","textbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":313,"score":0,"question_id":6995635,"title":"Textbox style trigger with \"IsReadOnly\" not working","body":"<p>I've made an application resource with a style which should be triggered if the textbox has the \"IsReadOnly\" property. Looks like this:</p>\n\n<pre><code>&lt;Application.Resources&gt;\n\n    &lt;Style TargetType=\"{x:Type TextBox}\" &gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"IsReadOnly\" Value=\"True\"&gt;\n                &lt;Trigger.Setters&gt;\n                    &lt;Setter Property=\"Background\" Value=\"Black\" /&gt;\n                &lt;/Trigger.Setters&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n\n&lt;/Application.Resources&gt;\n</code></pre>\n\n<p>However, the program doesn't react to this. It works when I use IsEnabled=True. However IsEnabled=False doesn't work either. So, question: Do the triggers only work if you check for \"True\"? And is IsReadOnly not supported at all? If so: How do I know which control properties are actually supported?</p>\n"},{"tags":["wpf","gridview","listview","scrollviewer"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16061,"score":1,"question_id":277316,"title":"Vertical scroll bar does not appear when the gridview items exceeded the display height","body":"<p>I place the following statements in the second row of my grid in the xaml:</p>\n\n<pre><code>&lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\" Grid.Row=\"1\"&gt;\n     &lt;ListView Name=\"listView\" Margin=\"5\" Grid.Row=\"1\"&gt;\n\n                &lt;ListView.View&gt;\n                    &lt;GridView AllowsColumnReorder=\"True\"&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=DateTime}\" Header=\"Date Time\" Width=\"140\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Vehicle}\" Header=\"Vehicle\" Width=\"130\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=AlarmType}\" Header=\"Alarm Type\" Width=\"100\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Direction}\" Header=\"Direction\" Width=\"100\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Speed}\" Header=\"Speed\" Width=\"100\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Alarmed}\" Header=\"Alarmed\" Width=\"100\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=LoadType}\" Header=\"Load Type\" Width=\"100\"/&gt;\n                        &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Status}\" Header=\"Status\" Width=\"110\"/&gt;\n                    &lt;/GridView&gt;\n                &lt;/ListView.View&gt;\n            &lt;/ListView&gt;     \n        &lt;/ScrollViewer&gt;\n &lt;/Grid&gt;\n</code></pre>\n\n<p>I binded the listView.ItemSource to an ObservableCollection defined in the code to populate data to the list.  When the number of items added to the GridView exceeded the listview height, the vertical scroll bar did not appear as i specified in the XAML.  What did I do wrong?  Your input is greatly appreciated.  Thank you.</p>\n"},{"tags":["wpf","text","adornment"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1102,"score":5,"question_id":593391,"title":"WPF UIElements Inline with Text \"Adornments\"","body":"<p>In WPF how can I put regular UIElements inline with text?  For example a certain classification of text would replace a span of text with a dropdown containing specific options.</p>\n\n<p>I've used objects like Span, Bold, Hyperlink that do some light modifications to text inline, but I want to be able to do something more drastic, and custom.  Can I implement a similar Inline object to accomplish this?</p>\n\n<p>I am working on a project where I have a need for some advanced text visuals.  Specifically I want to do something similar to the Visual Studio 2010 WPF based source editor.</p>\n\n<p>I'll have a piece of text and various components will look at that text searching for pieces with special meaning.  When it finds a span of text it will record/mark that span.  Then another set of components will go over the classified text and add decorations based on their classifications.</p>\n\n<p>You can kind of think of this like smart tags for WPF.</p>\n\n<p>I really have no idea where to start, all the documentation on advanced text in WPF is about animating, custom brushes, convert to geometry, etc...</p>\n"},{"tags":["c#","wpf","datagrid","datagridcell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13081107,"title":"Change Background color of cell in WPF DataGrid","body":"<p>I need a simple <code>code snippet</code> to change the background color of <code>WPF</code> <code>DataGrid</code> <code>cell</code>. I have <code>column index</code> and <code>row index</code>. I want to change color inside <code>CellEditEnding</code> <code>event hadler</code>. I wrote <code>event handler</code>. Now I need the simple <code>code snippet</code> to change the <code>background color</code> of <code>cell</code>.</p>\n"},{"tags":["c#","wpf","image","xaml","system.drawing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13080480,"title":"How to rotate and resize a PNG image by two changing coordinates?","body":"<p>If there is a PNG image connects two coordinates (like a rope),</p>\n\n<pre><code>coordinateA.x;\ncoordinateA.y;\n\ncoordinateB.x;\ncoordinateB.y;\n</code></pre>\n\n<p><p></p>\n\n<p>The two coordinates will keep changing all the time, so the PNG image connects between two coordinates needs to resize and rotate. <p>\nAny sample code to make this easier?</p>\n"},{"tags":["c#","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1004,"score":1,"question_id":9849063,"title":"DataGrid to Excel? ","body":"<p>I've been searching all over for answers but I can't find any...</p>\n\n<p>I have a program created in WPF. It displays a <code>DataGrid</code> with data from a MySQL Database. What I want to do is to allow the user to export the contents of the <code>DataGrid</code> to an Excel file. Is this possible with WPF?</p>\n\n<p>When I use the method shown here: <a href=\"http://outcoldman.ru/en/blog/show/201\" rel=\"nofollow\">http://outcoldman.ru/en/blog/show/201</a></p>\n\n<p>The only row that gets imported to the xls file is the header.</p>\n"},{"tags":["c#","wpf","silverlight","data-binding","events"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":609,"score":1,"question_id":2529992,"title":"Why does KeyDown event not have access to the current value of bound variable?","body":"<p>In the example below:</p>\n\n<ul>\n<li>I start program, type text, click <strong>button</strong>, see text above. Press <strong>ENTER</strong> see text again.</li>\n</ul>\n\n<p>BUT:</p>\n\n<ul>\n<li>I start program, type text, press <strong>ENTER</strong>, see <strong>no</strong> text.</li>\n</ul>\n\n<p>It seems that the KeyDown event doesn't get access to the <strong>current</strong> value of the bound variable, as if it is always \"<strong>one behind</strong>\".</p>\n\n<p><strong>What do I have to change so that when I press ENTER I have access to the value that is in the textbox so I can add it to the chat window?</strong></p>\n\n<p><img src=\"http://www.deviantsart.com/upload/1l20kdl.png\" alt=\"alt text\"></p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;Window x:Class=\"TestScroll.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" Height=\"290\" Width=\"300\" Background=\"#eee\"&gt;\n    &lt;StackPanel Margin=\"10\"&gt;\n\n        &lt;ScrollViewer Height=\"200\" Width=\"260\" Margin=\"0 0 0 10\"\n                      VerticalScrollBarVisibility=\"Auto\"\n                      HorizontalScrollBarVisibility=\"Auto\"&gt;\n            &lt;TextBlock Text=\"{Binding TextContent}\"\n                       Background=\"#fff\"/&gt;\n        &lt;/ScrollViewer&gt;\n\n        &lt;StackPanel HorizontalAlignment=\"Left\" Orientation=\"Horizontal\"&gt;\n            &lt;TextBox x:Name=\"TheLineTextBox\" \n                     Text=\"{Binding TheLine}\" \n                     Width=\"205\" \n                     Margin=\"0 0 5 0\"\n                     KeyDown=\"TheLineTextBox_KeyDown\"/&gt;\n            &lt;Button Content=\"Enter\" Click=\"Button_Click\"/&gt;\n        &lt;/StackPanel&gt;\n\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>Code-Behind:</strong></p>\n\n<pre><code>using System;\nusing System.Windows;\nusing System.Windows.Input;\nusing System.ComponentModel;\n\nnamespace TestScroll\n{\n    public partial class Window1 : Window, INotifyPropertyChanged\n    {\n\n        #region ViewModelProperty: TextContent\n        private string _textContent;\n        public string TextContent\n        {\n            get\n            {\n                return _textContent;\n            }\n\n            set\n            {\n                _textContent = value;\n                OnPropertyChanged(\"TextContent\");\n            }\n        }\n        #endregion\n\n        #region ViewModelProperty: TheLine\n        private string _theLine;\n        public string TheLine\n        {\n            get\n            {\n                return _theLine;\n            }\n\n            set\n            {\n                _theLine = value;\n                OnPropertyChanged(\"TheLine\");\n            }\n        }\n        #endregion\n\n        public Window1()\n        {\n            InitializeComponent();\n            DataContext = this;\n            TheLineTextBox.Focus();\n\n        }\n\n        private void Button_Click(object sender, RoutedEventArgs e)\n        {\n            AddLine();\n        }\n\n        void AddLine()\n        {\n            TextContent += TheLine + Environment.NewLine;\n        }\n\n        private void TheLineTextBox_KeyDown(object sender, KeyEventArgs e)\n        {\n            if (e.Key == Key.Return)\n            {\n                AddLine();\n            }\n        }\n\n        #region INotifiedProperty Block\n        public event PropertyChangedEventHandler PropertyChanged;\n\n        protected void OnPropertyChanged(string propertyName)\n        {\n            PropertyChangedEventHandler handler = PropertyChanged;\n\n            if (handler != null)\n            {\n                handler(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }\n        #endregion\n    }\n}\n</code></pre>\n"},{"tags":["wpf","menu","menuitem"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1232,"score":4,"question_id":782110,"title":"Is there a way to programatically close a menuitem in WPF","body":"<p>I have a menu in wpf that has an input box and a button on it.  Once the user clicks the button I need to close the menu.</p>\n\n<p>Is there a way to do this?</p>\n\n<pre><code>    &lt;Menu x:Name=\"MainMenu\"&gt;\n        &lt;MenuItem Header=\"Main\"&gt;\n            &lt;MenuItem Header=\"SubMenu\" x:Name=\"SubMenu\"&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBox Width=\"50\" x:Name=\"TextBox\" /&gt;\n                    &lt;Button Content=\"Click Me and Close\" x:Name=\"Button\" IsDefault=\"True\"/&gt;\n                &lt;/StackPanel&gt;\n            &lt;/MenuItem&gt;\n        &lt;/MenuItem&gt;\n</code></pre>\n\n<p></p>\n\n<p>Thanks,\nJon</p>\n"},{"tags":["c#","wpf","animation"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":517,"score":0,"question_id":7841660,"title":"WPF Translating an XAML Animation to C# Code","body":"<p>I found a great WIPE animation here : <a href=\"http://www.wearerighteous.com/programming/slidewipe-transition-for-your-windows-in-wpf/\" rel=\"nofollow\">http://www.wearerighteous.com/programming/slidewipe-transition-for-your-windows-in-wpf/</a></p>\n\n<p>Basically, the code there is like this: </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Window.OpacityMask&gt;\n&lt;LinearGradientBrush StartPoint=\"0,0\" EndPoint=\"1,1\"&gt;\n    &lt;GradientStop Offset=\"0\" Color=\"Black\" x:Name=\"BlackStop\"/&gt;\n    &lt;GradientStop Offset=\"0\" Color=\"Transparent\" x:Name=\"TransparentStop\"/&gt;\n&lt;/LinearGradientBrush&gt; \n&lt;Window.OpacityMask&gt;\n    &lt;Window.Triggers&gt;\n    &lt;EventTrigger RoutedEvent=\"Window.Loaded\"&gt;\n        &lt;EventTrigger.Actions&gt;\n            &lt;BeginStoryboard&gt;\n                &lt;Storyboard&gt;\n                    &lt;DoubleAnimation Storyboard.TargetName=\"TransparentStop\"\n                      Storyboard.TargetProperty=\"Offset\" By=\"1\"  Duration=\"0:0:1\"/&gt;\n                    &lt;DoubleAnimation Storyboard.TargetName=\"BlackStop\"\n                      Storyboard.TargetProperty=\"Offset\" By=\"1\" Duration=\"0:0:1\"\n                      BeginTime=\"0:0:0.05\" /&gt;\n                &lt;/Storyboard&gt;\n            &lt;/BeginStoryboard&gt;\n        &lt;/EventTrigger.Actions&gt;\n    &lt;/EventTrigger&gt;\n&lt;/Window.Triggers&gt;\n</code></pre>\n\n<p>I tried to \"translate\" the animation in c# code and I can't seem to do it. I tried several versions, like : </p>\n\n<pre><code>public void WipeAnimation(FrameworkElement ObjectToAnimate)\n    { \n        LinearGradientBrush OpacityBrush = new LinearGradientBrush();\n        OpacityBrush.StartPoint = new Point(1,0);\n        OpacityBrush.EndPoint   = new Point(0,0);\n        GradientStop BlackStop = new GradientStop(Colors.Black, 0);\n        GradientStop TransparentStop = new GradientStop(Colors.Transparent, 0);\n        OpacityBrush.GradientStops.Add(t);\n        OpacityBrush.GradientStops.Add(t2);\n        ObjectToAnimate.OpacityMask = OpacityBrush;\n\n        Duration d = TimeSpan.FromSeconds(4);\n        Storyboard sb = new Storyboard() { Duration = d };\n        DoubleAnimation DA = new DoubleAnimation() {  By=1 , Duration = d };\n        DoubleAnimation DA2 = new DoubleAnimation() { By=1 , Duration = d };\n        sb.Children.Add(DA); sb.Children.Add(DA2);\n        Storyboard.SetTarget(DA,TransparentStop);\n        Storyboard.SetTarget(DA2,BlackStop);\n        Storyboard.SetTargetProperty(DA, new PropertyPath(\"Offset\"));\n        Storyboard.SetTargetProperty(DA2, new PropertyPath(\"Offset\"));\n        sb.Begin();\n    }\n</code></pre>\n\n<p>Or replacing in the SetTarget Rows like : </p>\n\n<pre><code>Storyboard.SetTarget(DA, (ObjectToAnimate.OpacityMask as LinearGradientBrush).GradientStops[1]);\n</code></pre>\n\n<p>But nothing happens to my FrameworkElement. I called it for a Window (just like in the example from the site), and the only think that happens is that it sets the OpacityMask. The animation starts and ends (I added a Completed Event to the Storyboard with a MessageBox just to see if it works). I don't know what other things to do.</p>\n\n<p>Please help! :( \nAny ideas?</p>\n\n<p><strong>EDIT:</strong>\nMaybe I explained the question bad. I'm trying to create the animation that I have in XAML, in C# code.... I've been trying for two days now, searching for a solution. I don't know why the C# version doesn't work ... </p>\n"},{"tags":["c#","wpf","ioexception"],"answer_count":8,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":3969,"score":6,"question_id":6518603,"title":"WPF IOException Cannot locate resource","body":"<p>WPF beginner here.</p>\n\n<p>I have a WPF application. The page that opens when the app runs in MainWindow.xaml, as set in the StartupUri attribute of the App.xaml file. This page opens fine. However, if I try to open any other windows using the Show or ShowDialog method I get an IOException in the InitializeComponent method saying \"Cannot locate resource 'Window1.xaml'\" (or whatever the file is called). This happens with every single window I create. I've searched online but all the solutions seem to say \"make sure the StartupUri attribute of the App.xaml is correct\" and mine is, hence MainWindow opening. Any idea what's going on? I'm sure it's something very simple. Thanks in advance for any help</p>\n"},{"tags":["c#","wpf","xaml","kinect","system.drawing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13080139,"title":"Kinect: How to draw bones with PNG picture instead of DrawLine?","body":"<p>Kinect: How to draw bones with PNG picture instead of DrawLine? <p></p>\n\n<p><img src=\"http://www.hotzehwc.com/Resource-Center/Wellness-101/skeleton2.aspx\" alt=\"I want the result like this\"></p>\n\n<p>I will get the joints positions from Kinect.</p>\n\n<pre><code>JointA.x;\nJointA.y;\n\nJointB.x;\nJointB.y;\n</code></pre>\n\n<p><p>\nThe joints positions will change, so the PNG connects between two joints needs to resize and rotate. <p>\nAny sample code to make this easier?</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":28,"score":-1,"question_id":13079530,"title":"Writeablebitmap exception in backgroundworker","body":"<p>I have the folowing code</p>\n\n<pre><code>public MainWindow()\n    {\n        InitializeComponent();\n\n        BackgroundWorker bw = new BackgroundWorker();\n        bw.DoWork += bw_DoWork;\n\n        BitmapSource bitmap = new BitmapImage(new Uri(\"C:\\\\test.bmp\"));\n\n        List&lt;object&gt; argumente = new List&lt;object&gt;();\n        argumente.Add(bitmap);\n\n        if (!bw.IsBusy)\n        {\n            bw.RunWorkerAsync(argumente);\n        }\n    }\n\n    void bw_DoWork(object sender, DoWorkEventArgs e)\n    {\n        List&lt;object&gt; qwerty = e.Argument as List&lt;object&gt;;\n        BitmapSource b = (BitmapSource)qwerty[0];\n\n    ---&gt;WriteableBitmap wb = new WriteableBitmap(b);\n    }\n</code></pre>\n\n<p>Last line gives me:\nAn exception of type 'System.InvalidOperationException' occurred in WindowsBase.dll but was not handled in user code.\nAdditional information: The calling thread cannot access this object because a different thread owns it.\nIf there is a handler for this exception, the program may be safely continued.</p>\n\n<p>Same thing happens if try to crop a bitmap.</p>\n"},{"tags":["wpf","window","render","suspend","borderless"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13079407,"title":"How to suspend WPF Window to render before not all desired properties are set?","body":"<p>I have quite a simple question regarding the rendering thread in WPF and dotNet4.0.\nHow can I avoid that the rendering thread is already starting to render before I have set all my dependency properties what I want to set. I like to set the new Height, Width and Left and Top Property of an WPF Window first completely before the rendering thread should start to render the new position and size of a window. </p>\n\n<p>Background: I am designing at the moment a borderless Window where I do all the logic of resizing and positioning. When I now try to resize the Window by mouse on the left top corner or even the left border, then I have to set a new window size (Height, Width) and at the same time I have to set the new position using the Left and Top property. Unfortunately the rendering thread is already starting to render even if still not all new property values are set. This leads to a flickering of the window in different position before it is set finally on the correct new position and looks not nice.</p>\n\n<p>I already researched a lot of question threads here, but no thread gives really the answer.\nPlease Help!</p>\n\n<p>Note: I think there is no code required, the problem is without code understandable and everyone can try this with the default window, to set is borderless.</p>\n"}]}
