{"total":375445,"page":1,"pagesize":100,"questions":[{"tags":["c#","winforms","telerik","radgridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13298001,"title":"How to override cell colors by cellFormatting Telerik","body":"<p>I'm on Telerik, &amp; i'm trying to format a col values. The column index  number <code>12</code> is already given a color(it works) and then I want to look for a particular value, if it's present then change the cell color. If the cell value is 4354 then change the cell color....but nothing is happening. \nWhat is the mistake in below code???</p>\n\n<p>I tried using CellPint, still it's not working:</p>\n\n<p>Cell Paint Code:</p>\n\n<pre><code> private void TelerikRadGridView_CellPaint(object sender, GridViewCellPaintEventArgs e)\n        {\n            GridDataCellElement dataCell = e.Cell as GridDataCellElement;\n\n            if (dataCell != null &amp;&amp; dataCell.ColumnInfo.FieldName == \"test1\")\n            {\n                double value = Convert.ToDouble(dataCell.Value);\n                if (value == 0)\n                {\n                    return;\n                }\n\n                Brush brush = value == 4354 ? Brushes.Red : Brushes.Green;\n                Size cellSize = e.Cell.Size;\n\n                using (Font font = new Font(\"Segoe UI\", 17))\n                {\n                    e.Graphics.DrawString(\"*\", font, brush, Point.Empty);\n                }\n            }\n        }\n</code></pre>\n\n<p><code>private int cellValue = 4354;</code></p>\n\n<pre><code>for (int i = 0; i &lt; TelerikRadGridView.Rows.Count; i++)\n {\n if (TelerikRadGridView.Rows[i].Cells[i].Value == (object)cellValue)\n      {\n            e.CellElement.BackColor = Color.Gold;\n         }\n   }\n</code></pre>\n\n<p>This is the complete code:</p>\n\n<pre><code>private int cellValue = 4354;\nprivate void TelerikRadGridView_CellFormatting(object sender, CellFormattingEventArgs e)\n    {\n\n        e.CellElement.ResetValue(LightVisualElement.DrawFillProperty, ValueResetFlags.Local);\n        e.CellElement.ResetValue(LightVisualElement.NumberOfColorsProperty, ValueResetFlags.Local);\n        e.CellElement.ResetValue(LightVisualElement.GradientStyleProperty, ValueResetFlags.Local);\n        e.CellElement.ResetValue(LightVisualElement.BackColorProperty, ValueResetFlags.Local);\n\n        if (dontRunHandler == false)\n            {\n                if (e.CellElement.ColumnIndex != 2 \n                &amp;&amp; e.CellElement.ColumnIndex != 3 \n                &amp;&amp; e.CellElement.ColumnIndex != 4\n                &amp;&amp; e.CellElement.ColumnIndex != 5 \n                &amp;&amp; e.CellElement.ColumnIndex != 7 \n                &amp;&amp; e.CellElement.ColumnIndex != 11 \n                &amp;&amp; e.CellElement.ColumnIndex != 12 \n                &amp;&amp; e.CellElement.ColumnIndex != 13) return;\n                e.CellElement.DrawFill = true;\n                e.CellElement.NumberOfColors = 1;\n                e.CellElement.BackColor = Color.LightSlateGray;\n                e.CellElement.GradientStyle = GradientStyles.Linear;\n            }\n            for (int i = 0; i &lt; TelerikRadGridView.Rows.Count; i++)\n            {\n                if (TelerikRadGridView.Rows[i].Cells[i].Value == (object)cellValue)\n                {\n                    e.CellElement.BackColor = Color.Gold;\n                }\n            }\n</code></pre>\n"},{"tags":["c#","json.net","newtonsoft"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1798,"score":5,"question_id":6348215,"title":"how to deserialize JSON into IEnumerable<BaseType> with Newtonsoft JSON.NET","body":"<p>given this JSON:</p>\n\n<pre><code>[\n  {\n    \"$id\": \"1\",\n    \"$type\": \"MyAssembly.ClassA, MyAssembly\",\n    \"Email\": \"me@here.com\",\n  },\n  {\n    \"$id\": \"2\",\n    \"$type\": \"MyAssembly.ClassB, MyAssembly\",\n    \"Email\": \"me@here.com\",\n  }\n]\n</code></pre>\n\n<p>and these classes:</p>\n\n<pre><code>public abstract class BaseClass\n{\n    public string Email;\n}\npublic class ClassA : BaseClass\n{\n}\npublic class ClassB : BaseClass\n{\n}\n</code></pre>\n\n<p>How can I deserialize the JSON into:</p>\n\n<pre><code>IEnumerable&lt;BaseClass&gt; deserialized;\n</code></pre>\n\n<p>I can't use <code>JsonConvert.Deserialize&lt;IEnumerable&lt;BaseClass&gt;&gt;()</code> because it complains that <code>BaseClass</code> is abstract.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","xaml","exception","gis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13298482,"title":"Gerneral Transform InvalidOperation Exception was unhandled by user code","body":"<p>I have ran into a problem that I am completely clueless about. I am receiving the following error message: </p>\n\n<blockquote>\n  <p>The specified Visual and the Visual do not share a common ancestor, so there is no valid transformation between the two visuals. </p>\n</blockquote>\n\n<p>This is being called when the user clicks on a point on the map. Any help would be appreciated. I have attached snippets of the error. If you need anymore code samples, just let me know. </p>\n\n<p><img src=\"http://i.stack.imgur.com/KBZuM.png\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/wzyU7.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","visual-studio-2010","visual-studio-2012","moq","excel-interop"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13202120,"title":"Moq & Interop Types: works in VS2012, fails in VS2010?","body":"<p>I have a .NET library project with about 500 unit tests. All these tests run fine in Visual Studio 2012. However, some of my tests fail in Visual Studio 2010. In these failing tests, I use <strong>Moq</strong> to mock several Interop Types from <code>Microsoft.Office.Interop.Excel</code>. The test fails immediately when attempting to access these mocked interop types:</p>\n\n<pre><code>Error: Missing method 'instance class Microsoft.Office.Interop.Excel.Range [ExcelAddIn.Core] Microsoft.Office.Interop.Excel.ListRow::get_Range()' from class 'Castle.Proxies.ListRowProxy'.\n</code></pre>\n\n<p>This exception implies that I forgot to setup the appropriate property getter on my mock. Which is not the case:</p>\n\n<pre><code>_listRowMock.Setup(m =&gt; m.Range).Returns(_rangeMock.Object);\n</code></pre>\n\n<p>Now I can imagine that Moq might not work too well with Interop Types. But what I find most puzzling is that these tests run fine in Visual Studio 2012, but fail in Visual Studio 2010. </p>\n\n<p>Why is my Visual Studio influencing the behavior of my code?</p>\n\n<p><strong>UPDATE: 3-11-2012</strong></p>\n\n<p>Ok, so I got it down to this:</p>\n\n<ul>\n<li>I have two projects; Core and Core.UnitTest. Core is the actual library while Core.UnitTest is a unit test project of the Core library.</li>\n<li>Both projects reference Microsoft.Office.Interop.Excel with Embed Interop Types enabled.</li>\n<li>Because EIT is enabled, both projects include their own \"view\" of the Microsoft.Office.Interop.Excel library. The view includes all classes, methods and properties that are used in their respective project.</li>\n<li>Because both projects use different classes, methods and properties of the Microsoft.Office.Interop.Excel, the embedded types of both libraries differ. E.g. ListRow in Core has an Index and Range property, whereas ListRow in Core.UnitTest only has the Range property.</li>\n<li>Although both types are different and do not share a common interface or super class, they are <strong><a href=\"http://msdn.microsoft.com/en-us/library/dd997297.aspx\" rel=\"nofollow\">equivalent</a></strong>. This means that the CLR will treat them as if they are the same and will allow you to use these types across assembly boundaries. E.g. an instance of ListRow from Core.UnitTest will work fine when passed to a method in the Core library. The shared Range property will function, whereas the missing Index property will throw a MissingMethodException on access.</li>\n<li>The aforementioned behavior even works with mocked types. An mocked object of  Mock[Excel.ListRow] will work fine when crossing the assembly boundary.</li>\n<li>Unfortunately, the behavior described in the previous point only works when I build my assemblies in Visual Studio <strong>2012</strong>. When I build my assemblies in Visual Studio <strong>2010</strong> and debug my code, I can see the mocked ListRow instance being passed into a method of my Core project. The moment the instance crosses the assembly boundary, all methods and properties of ListRow lose their implementation and throw MissingMethodExceptions.</li>\n<li>Now for the fun part, I actually managed to mitigate this issue by ensuring that both embedded types of ListRow are aligned. E.g. in order for the compiler to create the same view of ListRow in both projects, I made sure that I used the exact same methods and properties in my UnitTest project. This means adding dummy lines like: var dummy = listRow.Index. Once I had the compiler creating identical views of my embedded ListRow type, the instance was allowed to cross assembly boundaries without losing its implementation.</li>\n</ul>\n\n<p>The question still remains though: What causes this difference in behavior between Visual Studio 2010 and Visual Studio 2012?</p>\n"},{"tags":["c#","workflow"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13298384,"title":"InstanceStore WaitForEvents not firing when using WorkflowApplication with a WorkflowIdentity","body":"<p>I posted this question on the microsoft forum but wanted to post it here for additional exposure. I have searched everywhere for an example of what I'm trying to do with no luck.</p>\n\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en-US/wfprerelease/thread/8a424c0b-44f8-4670-8d64-9c7142117b55\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en-US/wfprerelease/thread/8a424c0b-44f8-4670-8d64-9c7142117b55</a></p>\n\n<p>Basically, I would like to use the WorkflowApplication along with the WorkflowIdentity and persistence store to accomplish durable delays.  I use WorkflowApplication because we have hundreds of workflows that need to be run dynamically so the WorkflowServiceHost is not really feasible in our scenario.</p>\n\n<p>I used the Microsoft provided example, AbsoluteDelay, as a starting point and it works perfectly.  The problem comes when I try to pass in a WorkflowIdentity to the constructor of the WorkflowApplication.</p>\n\n<p>Then, the WaitForEvents event on the InstanceStore does not fire because it is expecting the default Identity (id 1), not my new Identity (id 2). The line that does store.Execute creates a record in the IdentityOwnerTable with SurrogateIdentityId set to 1 instead of the id of my identity.</p>\n\n<p>How can I tell the InstanceStore to use my new Identity and not the default one? It seems as if it is something that can be passed through in the CreateWorkflowOwnerCommand metadata.</p>\n\n<pre><code>// Create the InstanceStore\nSqlWorkflowInstanceStore store = new SqlWorkflowInstanceStore(_workflowDB);\n\n// A well known property that is needed by WorkflowApplication and the InstanceStore\nprivate static readonly XName _workflowHostTypePropertyName = XNamespace.Get(\"urn:schemas-microsoft-com:System.Activities/4.0/properties\").GetName(\"WorkflowHostType\");\n\n// Create the XName for the workflow using the workflow's unique name\nXName wfHostTypeName = XName.Get(workflowName);\n\n// Configure a Default Owner for the instance store so instances can be re-loaded from WorkflowApplication\nprivate static InstanceHandle CreateInstanceStoreOwner(InstanceStore store, XName wfHostTypeName)\n{\n    InstanceHandle ownerHandle = store.CreateInstanceHandle();\n    CreateWorkflowOwnerWithIdentityCommand ownerCommand = new CreateWorkflowOwnerWithIdentityCommand()\n    { //changed from CreateWorkflowOwnerCommand (did not fix problem)\n        InstanceOwnerMetadata =\n        {\n            { _workflowHostTypePropertyName, new InstanceValue(wfHostTypeName) },\n            // Something here to identify the WorkflowIdentity ??\n        }\n    };\n    store.DefaultInstanceOwner = store.Execute(ownerHandle, ownerCommand, TimeSpan.FromSeconds(30)).InstanceOwner;\n    return ownerHandle;\n}\n\nprivate static void WaitForRunnableInstance(InstanceStore store, InstanceHandle ownerHandle)\n{\n    // Only fires when using default Identity\n    IEnumerable&lt;InstancePersistenceEvent&gt; events = store.WaitForEvents(ownerHandle, TimeSpan.MaxValue);\n    bool foundRunnable = false;\n    // Loop through the persistence events looking for the HasRunnableWorkflow event (in this sample, it corresponds with\n    // the workflow instance whose timer has expired and is ready to be resumed by the host). \n    foreach (InstancePersistenceEvent persistenceEvent in events)\n    {\n         if (persistenceEvent.Equals(HasRunnableWorkflowEvent.Value))\n         {\n             foundRunnable = true;\n             break;\n         }\n    }\n    if (!foundRunnable)\n    {\n        throw new ApplicationException(\"Unexpected: No runnable instances found in the instance store\");\n     }\n}\n</code></pre>\n"},{"tags":["c#","java","oop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":13298519,"title":"Component Oriented vs Object Oriented","body":"<p>What does it mean when someone says that C# is Component Oriented when Java is Object Oriented, when C# is Object Oriented also?</p>\n"},{"tags":["c#","multithreading","asynchronous","windows-8","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13296296,"title":"Running Async Method in Loop without Stackoverflow Exception","body":"<p>This piece of code keeps throwing a <code>stackoverflow exception</code> and I have a feeling it's either because of the <code>await</code> keyword causing the stack to fill up, or a thread availability issue. However, I'm not sure what the best way of remedying this would be. </p>\n\n<p>The <code>results</code> variable is just a collection of <code>StorageFiles</code> and if it's above 1020 or so, the exception is thrown; otherwise it's <em>usually</em> fine. </p>\n\n<pre><code>private async void GetMusicTest()\n{\n    var sfolder = await StorageFolder.GetFolderFromPathAsync(dir);\n\n    var query =  sfolder.CreateFileQueryWithOptions(queryOptions);\n\n    var results = await query.GetFilesAsync();\n\n    for (int i = 0; i &lt; results.Count; i++)\n    {\n        MusicProperties mp = await results[i].Properties.GetMusicPropertiesAsync();\n        Debug.WriteLine(mp.Title);\n    }\n}\n</code></pre>\n\n<p>This code works fine in a console application, but the error is thrown when used in a desktop WinForm app. </p>\n\n<p>Interestingly, if <code>result.Count()</code> is used instead, then the error is thrown after three iterations, whereas <code>results.Count</code> throws it after iterating through at least half of the collection, if not all (it seems to vary). They both return the same values. What's the best way looping through without causing a stackoverflow exception or using up all available threads?</p>\n"},{"tags":["c#",".net","xml","web-services","xdocument"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13298496,"title":"object returned from webservice call gets mangle with additional bytes in my conversion function","body":"<p>Concise...object returned from webservice call gets mangle with additional bytes in my conversion function.  </p>\n\n<p>Basically I have a webreference that I send an XDocument to</p>\n\n<pre><code>    System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding();\n    Byte[] baXml = encoding.GetBytes(xdoc.ToString());\n\n    object o = MEF_Test.NewSubmission(\"*********\", \"*********\", baXml);\n</code></pre>\n\n<p>The transmission is successful and I get back what I assume is the xml document and I am trying to go back to an XDocument. I convert my object to a byte array</p>\n\n<pre><code>    Byte[] baResponse = ObjectToByteArray(o);\n</code></pre>\n\n<p>I put this function in at the bottom but it may be where there error is at</p>\n\n<p>The object I get back is 10492 characters but gets bigger by 28 bytes to the size of 10520 after conversion</p>\n\n<pre><code>            string ss = Encoding.UTF8.GetString(baResponse);\n            string ss1 = ss.Substring(28);\n            XDocument xSubmissionResponse = XDocument.Parse(ss1);\n</code></pre>\n\n<p>In the screenshot you can see the extra characters and I attempt to get past them by getting the substring past them.  The string then looks good but then throws an exception about a hexadecimal value 0x0B further ahead in the string.</p>\n\n<p>Can anyone give this a look?  Thanks.</p>\n\n<p>--<a href=\"http://i.imgur.com/Tzw9i.png\" rel=\"nofollow\">Screenshot with as much info as possible</a></p>\n\n<p>I don't have the reputation to stick the image in I hope the link works.</p>\n\n<pre><code>    private static byte[] ObjectToByteArray(Object obj)\n    {\n       if (obj == null)\n          return null;\n       BinaryFormatter bf = new BinaryFormatter();\n       MemoryStream ms = new MemoryStream();\n       bf.Serialize(ms, obj);\n       return ms.ToArray();\n    }\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13298424,"title":"How to convert utf-8 to cp1252 in C#?","body":"<p>I need to convert a XML file that is being sent on utf-8 to cp1252. How is this possible?</p>\n\n<p>My consumer application only support ANSI characters in it's controls and not Unicode. It also does a memcopy of the bytes received.</p>\n"},{"tags":["c#",".net","sql-server","asp.net-mvc","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13298310,"title":"Insert default value via EntityFramework","body":"<p>I have default constraint on my caption field in database. In web app if caption is empty NULL value passed to database and database returns exception because samo field it cannot be null (Caption varchar(50) NOT NULL).</p>\n\n<p>So, what is easiest way to set some value (\"\" - empty string) or avoid to send NULL to database if value is really not provided. How I can set that in EntityFrameowrk, or maybe in data access layer...?</p>\n"},{"tags":["c#","parent-child"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13298308,"title":"How to automatically convert derived class object to new base class object?","body":"<p><code>B</code> is a class derived from <code>A</code>. I need to create a new object <code>A</code> from existing object <code>B</code>.</p>\n\n<p>I need this because in my application I use a lot of <code>A</code> instances which are much more light weigh than <code>B</code> (which holds a lot of reference data), otherwise I would run out of memory.</p>\n\n<p>How do I convert <code>B</code> to <code>A</code> without manually copying all <code>A</code>'s fields' values in a custom method?</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13295700,"title":"The value of DependencyProperty is not propagated from XAML to code behind","body":"<p>The problem is that DependencyProperty is not getting assigned to the value specified in XAML:</p>\n\n<p>I have two different user controls let's say UserControl1 and UserControl2 that define another user control which is common to both controls:</p>\n\n<p>UserControl1.xaml:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;modulename:MyUserControl ....somecode... DataOrientation=\"Horizontal\"&gt; \n&lt;/modulename:MyUserControl&gt;\n</code></pre>\n\n<p>UserControl2.xaml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;modulename:MyUserControl ....somecode... DataOrientation=\"Vertical\"&gt; \n&lt;/modulename:MyUserControl&gt;\n</code></pre>\n\n<p>The difference between both UserControls is that UserControl1 has to display the data using Horizontal orientation and UserControl2 has to display the data using Vertical Orientation.</p>\n\n<p>Inside of the MyUserControl's code behind I defined a Dependency Property as follows:</p>\n\n<pre><code>public static readonly DependencyProperty DataOrientationProperty = \nDependencyProperty.Register (\"DataOrientation\",typeof(String),typeof(MyUserControl));\n\npublic String DataOrientation \n{\n   get {return (String)GetValue(DataOrientationProperty);}\n   set { SetValue(DataOrientationProperty, value); }\n}\n</code></pre>\n\n<p>These are fragment of the code inside of MyUserControl.xaml:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>...\n&lt;StockPanel&gt;\n  &lt;Grid Name=\"MyGrid\" SizeChanged=\"MyGrid_SizeChanged\"&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n      &lt;ColumnDefinitions Width=\"*\"/&gt;\n      &lt;ColumnDefinitions Width=\"100\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n    &lt;ScrollViewer Name=\"MySV\" Grid.Column=\"0\" ....&gt;\n      &lt;Grid Name=\"DetailGrid\"/&gt;\n    &lt;/ScrollViewer&gt;\n\n    &lt;Grid Grid.Column=\"1\" .........&gt;\n    ......Some Option Data....\n   &lt;/Grid&gt;\n  &lt;/Grid&gt;\n &lt;/StockPanel&gt;\n</code></pre>\n\n<p>The idea is to change ColumnDefinitions to RowDefinitions and Grid.Column to Grid.Rows depending on the orientation flag: </p>\n\n<p>If the flag is \"Horizontal\", UserControl displays \"DetailsGrid\" and \"Option Data\" Grid side by side, meaning \"DetailGrid\" is in Column 0 and \"Option Data\" Grid in Column 1. </p>\n\n<p>If the flag is \"Vertical\" UserControl displays \"DetailGrid\" in Row 1 and \"Option Data\" in Row 0.</p>\n\n<p>Need some help on that issue.</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["c#","sharepoint"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13298409,"title":"\"Access is Denied\" when using BreakRoleInheritence method on Drop Off Library in ItemUpdating event receiver","body":"<p>I have an event receiver that is using the ItemUpdating event. I am trying to disinherit the item's permissions from parent and strip all permissions on the item upon being uploaded to the Drop Off Library. The reason for this is that the document contains sensitive information and should not be visible to anyone once it arrives in the Drop Off Library.</p>\n\n<p>The code below is throwing the following error when executing the CurrentListItem.BreakRoleInheritence(true) line upon reaching the Drop Off Library: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))</p>\n\n<pre><code>            SPSecurity.RunWithElevatedPrivileges(delegate()\n            {\n                using (SPSite oSiteCollection = new SPSite(properties.ListItem.Web.Url))\n                {\n                    using (SPWeb oWebsite = oSiteCollection.RootWeb)\n                    {\n                        SPListItem CurrentListItem = properties.ListItem;\n\n                        SPRoleAssignmentCollection SPRoleAssColn = CurrentListItem.RoleAssignments;\n\n                        oSiteCollection.AllowUnsafeUpdates = true;\n                        oWebsite.AllowUnsafeUpdates = true;\n\n                        CurrentListItem.BreakRoleInheritance(true);\n\n                        oSiteCollection.AllowUnsafeUpdates = true;\n                        oWebsite.AllowUnsafeUpdates = true;\n\n                        for (int i = SPRoleAssColn.Count - 1; i &gt;= 0; i--)\n                        {\n                            if (SPRoleAssColn[i].Member.Name != \"System Account\")\n                            {\n                                SPRoleAssColn.Remove(i);\n                            }\n                        }\n                    }\n                }\n            });\n</code></pre>\n\n<p>I have also done the following things:\n- made sure the Identity of the app pool is a site collection admin\n- tried to get the list item again using GetItemById (but this throws an error that the item does not exist, since the item has still not been published yet - we need to remove permissions before the document is published - and we cannot force a check-in otherwise the drop off library might process and move the document to the its target library)\n- tried getting the web and site options using guids\n- tried many different combinations of placements with AllowUnsafeUpdates\n- used the user token of a site collection admin to open the web objects</p>\n\n<p>For some reason, the code above works fine when the document reaches the target library (as we are removing all the permissions AGAIN once the document arrives at the destination). This happens because the document is moved from the drop off library to the target library using the System Account. </p>\n\n<p>Any thoughts on how to get around the \"Access is Denied\" error while utilizing a similar approach as above?</p>\n"},{"tags":["c#","listbox","asp.net-3.5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13298317,"title":"ListBox items empty when generated client-side","body":"<p>I'm adding items like this:</p>\n\n<pre><code>$('#listbox').append('&lt;option value=\"1\"&gt;\"1\"&lt;/option&gt;');\n</code></pre>\n\n<p>On the server-side <code>listbox.Items</code> are ALWAYS empty. How do I get the values added by client-side script?</p>\n\n<p>I'm using C# ASP .Net 3.5</p>\n"},{"tags":["c#","generics","boxing","unboxing"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13297944,"title":"Avoid boxing & unboxing in generic class","body":"<p>Below is some quick code to illustrate my question.  Any way to avoid this apparently unnecessary boxing/unboxing?</p>\n\n<pre><code>public class TestClass&lt;T&gt;\n{\n  public T TestMethod()\n  {\n    if (typeof(T) == typeof(bool))\n    {\n      return true; // doesn't work\n      return (T)(object)true; // works, but any way to avoid this?\n    }\n\n    return default(T);\n  }\n}\n</code></pre>\n"},{"tags":["c#","wcf","web-services","credentials","discovery"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":930,"score":2,"question_id":8792192,"title":"Add Service Reference, Multiple Credential Prompt","body":"<p>I started a new blank console app project in VS (I am using VS2010), and choose Add Service Reference to a web service protected with a username and password.</p>\n\n<p>When I click Go in the dialog box, I'm confronted with a Yes/No prompt to accept a certificate. I choose Yes, then I arrive at a Discovery Credential prompt asking for User Name and Password.</p>\n\n<p>If I key those in correctly several times (3+), I finally gain access to the WSDL. Or, oddly enough if I key them correctly once, then cancel, then go through the process again, my creds are accepted on the first attempt.</p>\n\n<p>I asked The Googles and found a few instances related to SQL reporting web services, and someone posted <a href=\"http://stackoverflow.com/questions/2255904/add-web-reference-prompts-for-credentials-with-discovery-credential-dialog-but\">here</a> about something similar, but no one seems to have a definitive answer.</p>\n\n<p>Can anyone explain this odd behavior? Is the service configured incorrectly or is this some sort of known issue with web services or WCF services? </p>\n"},{"tags":["c#",".net","winforms","c#-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13296801,"title":"How to validate combo box values in c#","body":"<p><img src=\"http://i.stack.imgur.com/0Bzc8.png\" alt=\"enter image description here\">I have 6 combo boxes in c# form that all fill from database from same column. i-e for making student result combo boxes fill subject names. now I want is how to delete Subject name from 2nd combo box if the Subject is already selected in the previous combo box.and i use combo box property to fill each combo box from database. </p>\n"},{"tags":["c#","wpf","treeviewitem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13298273,"title":"TreeView.HideSelection = false - equivalent in WPF","body":"<p>I am searching for a WPF TreeView equivalent of <code>TreeView.HideSelection = false</code>. Does someone have an idea?</p>\n"},{"tags":["c#","json","httpwebrequest","yahoo","jsonserializer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":273,"score":1,"question_id":11177016,"title":"Consuming Yahoo PlaceFinder JSON in C# using WebRequest","body":"<p>I thought I would post this here not so much as a question but to share with the community some code I wrote after not being able to find the answer here on StackOverflow. If someone would like to take a look at the code and improve it, that would be great, but not required. I have left out some code (try-catch blocks &amp; error handling) to make it a little bit easier to consume the concept and code.</p>\n"},{"tags":["c#",".net","dynamics-crm","dynamics-crm-2011"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":271,"score":1,"question_id":8619325,"title":"Deep cloning entity from one org to another","body":"<p>So, yet another fun task at hand.</p>\n\n<p>We have created a windows service to keep some records in sync between 2 CRM 2011 orgs in production.</p>\n\n<p>We have looked into deep cloning which is what we want, but it appears that it's deep cloning the EntityReference, not the actual Entity.</p>\n\n<p>Any ideas, advice, etc would be awesome.</p>\n"},{"tags":["c#",".net","windows-phone-7"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13283607,"title":"WP7 synchronous web request","body":"<p>I’m developing a Windows Phone 7.1 application, and trying to implement tombstoning.</p>\n\n<p>Due to the legal reasons I can’t save my view model. I’m only saving encrypted session ID, which can be used to load a view model data from the remote server.</p>\n\n<p>On resume, I need to verify the session ID, if it’s expired – I take user to the login page of my app, if it’s still OK, I reload view model data from the server.</p>\n\n<p>The problem is the HttpWebRequest lacks blocking API. Moreover, while inside page.OnNavigatedTo method after de-tombstoning, the method <a href=\"http://stackoverflow.com/a/10262218/126995\">described here</a> blocks forever.</p>\n\n<p>I’ve worked around the problem by presenting my own splash screen.</p>\n\n<p>However, I’d rather like to complete those RPC calls while the system-provided “Resuming…” splash screen is visible, i.e. before I return from page.OnNavigatedTo method.</p>\n\n<p>Any ideas how can I complete HTTP requests synchronously while inside page.OnNavigatedTo after de-tombstoning?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":45,"score":-2,"question_id":13297656,"title":"Dont understand the coding behind Assert.Areequal","body":"<p>Can anyone help me with this?</p>\n\n<pre><code> [TestMethod]\n    public void MakeDateConstructsADateTimeFromYearMonthAndDay()\n    {\n        Arrange\n        var controller = new DateController();\n        var expected = new DateTime(2014, 6, 30);\n\n        Act\n        var result = controller.MakeDate(2014, 6, 30);\n\n        Assert\n        Assert.AreEqual&lt;DateTime&gt;(expected, result);\n    }\n\n    [TestMethod]\n    public void MakeDateReturnsDefaultDateTimeIfInputDataInvalid()\n    {\n        /* HINT You need to use a try ... catch block in the MakeDate()\n         * method to trap the exception thrown by the DateTime constructor.\n         * See http://msdn.microsoft.com/en-us/library/xcfzdy4x(v=vs.110)/ \n         * for information on the exceptions thrown by the DateTime \n         * constructor.  \n         * See http://msdn.microsoft.com/en-us/library/ms173160(v=vs.110).aspx \n         * for information on exception handling in C#.  \n         * */\n        //Arrange\n        var controller = new DateController();//error\n        var expected = new DateTime();//error\n\n        //Act\n        //June has only 30 days so this will cause an exception\n        var result = controller.MakeDate(2014, 6, 31);\n\n        //Assert\n        Assert.AreEqual&lt;DateTime&gt;(expected, result);\n    }\n</code></pre>\n\n<p>Keep getting error stating Error Expected class, delegate, enum, interface, or struct\n//getting errors under 'void, datacontroller and datetime</p>\n"},{"tags":["c#","locking"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":59,"score":5,"question_id":13298168,"title":"C# to lock or not to lock","body":"<p>Fearing I already know the answer. I have a class that handles services calls and caching. To avoid multiple calls to the service with the same request, I can of course use a <strong>lock</strong> around the code block <em>but</em> a lot of these methods have varying arguments which make up the cache key. It seems a shame to wait for a lock code block to execute when it could be for a completely different cache key (or multiple different cache keys).</p>\n\n<p>I know I <em>could</em> do a lock on the cache key string itself but this is a no-no given that that string could potentially pop up anywhere.</p>\n\n<p>So, I can either perform potential unnecessary calls to the service without the lock OR add potentially unnecessary delays within the method by waiting for the lock. </p>\n\n<p>Are those my only 2 options or is there another?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","java","generics"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13298215,"title":"Can be C# generics be queried at run time?","body":"<hr>\n\n<p>So I'm currently working on porting a project from Java to C#, and I'm trying to figure something out.</p>\n\n<p>Currently, in Java, when we query something of the generic type, it erases the Generic type. And because of that, when we query something, we need to use Annotation so that we can get a collection and know what we get.</p>\n\n<p>In C#, is this the same issue? Can C# generics be queried at run time? If we do, do we need to use the attributes to solve the issue?</p>\n"},{"tags":["c#","books","website","tutorials"],"answer_count":6,"favorite_count":4,"up_vote_count":1,"down_vote_count":1,"view_count":1711,"score":0,"question_id":660177,"title":"C# Programming Tutorial Websites","body":"<p>All right, I have an interesting question.  I have a person in our company that isn't a tech guy at all.  He would like to learn C#, but he is constrained to using 56k at his house.  (The company is in the literal middle of nowhere.)  Are there any good websites that teach programming concepts from the ground up using C# that do not rely on videos and the like to teach them?  </p>\n\n<p>I learned C# in college, so I'm not sure on where a good website would be to teach a person programming from the ground up.  Do you have any suggestions?</p>\n\n<p>Barring that, are there any good books that you would recommend for starting out with C#?</p>\n"},{"tags":["c#","wpf","f#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13287437,"title":"C# WPF project with reference to F# ViewModel","body":"<p>I have project named FSharpProject in whick there is code like this:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>module FSharpProject.ViewModel\n\ntype A =\n    member x.a = 1\n</code></pre>\n\n<p>In other project(typical wpf application writing in C#) which have reference to FSharpProject I have xaml file like this:</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl x:Class=\"CSharpProjectView\"\n             x:Name=\"Root\"\n             xmlns:local=\"clr-namespace:CSharpProjectView\"\n             xmlns:data=\"clr-namespace:FSharpProject.ViewModel;assembly=FSharpProject\"            \n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n...\n&lt;DataTemplate x:Key=\"LogDataTemplate\" DataType=\"{data:A}\"&gt;\n                &lt;TextBlock Text=\"{Binding a}\" /&gt;                \n            &lt;/DataTemplate&gt;\n</code></pre>\n\n<p>But I get error that data:A type not found. </p>\n\n<hr>\n\n<p>UPD: It does not work: </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl x:Class=\"CSharpProjectView\"\n             x:Name=\"Root\"\n             xmlns:local=\"clr-namespace:CSharpProjectView\"\n             xmlns:data=\"clr-namespace:FSharpProject;assembly=FSharpProject\"            \n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n...\n&lt;DataTemplate x:Key=\"LogDataTemplate\" DataType=\"{data:ViewModel.A}\"&gt;\n                &lt;TextBlock Text=\"{Binding a}\" /&gt;                \n            &lt;/DataTemplate&gt;\n</code></pre>\n"},{"tags":["c#","gui","zune","microsoft-metro"],"answer_count":4,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":4859,"score":7,"question_id":6148168,"title":"Metro UI and C#","body":"<p>Does anyone have any code samples in C# that implements the Metro UI? This is similar to the interfaces used in Zune and MetroTwit.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","xml","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13297843,"title":"Alternative ways to convert datatable to cutomized xml","body":"<p>Is there a way i can create an XML from datatable without using  </p>\n\n<ol>\n<li><p>A <code>StringWriter</code>:</p>\n\n<pre><code>System.IO.StringWriter writer = new System.IO.StringWriter();\nyourDataTable.WriteXml(writer, XmlWriteMode.WriteSchema, true);\n</code></pre>\n\n<p>Doesn't work well for me as it gives descendants as column headers. I want first row as descendants.</p></li>\n<li><p>Iterating over DataColumns and DataRows.</p></li>\n</ol>\n\n<p>I was reading about LINQ-to-DataTable and LINQ-to-XML .</p>\n\n<p>Can LINQ query help me?</p>\n"},{"tags":["c#","class","extension-methods"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13298127,"title":"How can I have multiple extension methods on my own class, like this?","body":"<pre><code>string \"hello world\".toLower().toUpper().replace(\"o\", \"x\");\n</code></pre>\n\n<p>How do I make my own class be able to have extension methods like string in the example above?\nMaybe not that usefull, but I just cant figure out how to do it</p>\n"},{"tags":["c#","winforms","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13298187,"title":"C# Winform Messy/blurry text in Datagrid","body":"<p>I have one datagrid on my form and it's bound with DataTable\nI use this code</p>\n\n<pre><code>public void SetDataSource(DataTable dt)\n    {            \n        dgr.DataSource = null;\n        dgr.AutoGenerateColumns = false;            \n        dgr.DataSource = dt;                 \n    }\n</code></pre>\n\n<p>Everytime I click on header or wants to change combobox the text in cells looks like overriden again and again. Never seen it before, look (this is after the fifth click on header)</p>\n\n<p><img src=\"http://i.stack.imgur.com/2tdc8.png\" alt=\"enter image description here\"></p>\n\n<p>The datagrid is readonly, nothing special is set I tried \nRefresh method\nUpdate method\nUpdate datatable\nand many others things but I gave it up ..\nAny help will be appreciated</p>\n\n<p>Thank you\nPat</p>\n"},{"tags":["c#","charts","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13291517,"title":"chart X axis shifting","body":"<p>I'm having trouble trying to create a c# chart with an x axis that shifts.</p>\n\n<p>What i want is to add a new Y value and have the x axis shift to the left removing the first data point.</p>\n\n<p>I can add points to the right hand side fine,</p>\n\n<pre><code> DataPoint dp2 = new DataPoint(x, rnd.Next(100));\n chart1.Series[0].Points.Add(dp2);\n x++;\n</code></pre>\n\n<p>i can remove the first point on the left hand side fine</p>\n\n<pre><code>chart1.Series[0].Points.RemoveAt(0);\n</code></pre>\n\n<p>but if i try to do both it does not work, it adds blank spaces at the beginning of the graph and goes off out the right hand side rather than staying inside the graph area ?</p>\n\n<pre><code>DataPoint dp2 = new DataPoint(x, rnd.Next(100));\nchart1.Series[0].Points.RemoveAt(0);\nchart1.Series[0].Points.Add(dp2);\nx++;\n</code></pre>\n\n<p>full demo of my problem:- (make a chart, 3 buttons and 3 timers, paste my code over the top of form1.cs then connect the buttons (mouse click) &amp; timers (ticks 1000ms) events to my codes event handlers.)</p>\n\n<pre><code>using System;\nusing System.Windows.Forms;\nusing System.Windows.Forms.DataVisualization.Charting;\n\nnamespace test_chart2\n{\n    public partial class Form1 : Form\n    {\n        double x = 16;\n        Random rnd = new Random();\n        public Form1()\n        {\n            InitializeComponent();\n\n\n            DrawToGraph1();\n\n        }\n\n        private void DrawToGraph1()\n        {\n            chart1.Series[0].Points.Clear();\n            for (int g = 5; g &lt;= 15; g++)\n            {\n                DataPoint dp = new DataPoint(g, rnd.Next(100));\n                chart1.Series[0].Points.Add(dp);\n            }\n        }\n        private void timer1_Tick(object sender, EventArgs e)\n        {\n            DataPoint dp2 = new DataPoint(x, rnd.Next(100));\n            chart1.Series[0].Points.Add(dp2);\n            x++;\n        }\n        private void timer2_Tick(object sender, EventArgs e)\n        {\n            chart1.Series[0].Points.RemoveAt(0);\n        }\n\n        private void timer3_Tick(object sender, EventArgs e)\n        {\n            DataPoint dp2 = new DataPoint(x, rnd.Next(100));\n            chart1.Series[0].Points.RemoveAt(0);\n            chart1.Series[0].Points.Add(dp2);\n            x++;\n        }\n        private void button2_MouseClick(object sender, MouseEventArgs e)\n        {\n            timer1.Enabled = false;\n            timer2.Enabled = true;\n            timer3.Enabled = false;\n        }\n        private void button3_MouseClick(object sender, MouseEventArgs e)\n        {\n            timer1.Enabled = false;\n            timer2.Enabled = false;\n            timer3.Enabled = true;\n        }\n        private void button1_MouseClick(object sender, MouseEventArgs e)\n        {\n            timer1.Enabled = true;\n            timer2.Enabled = false;\n            timer3.Enabled = false;\n        }\n    }\n}\n</code></pre>\n\n<p>It does work if i use</p>\n\n<pre><code>series1.IsXValueIndexed = true;\n</code></pre>\n\n<p>but i cant use this as my project has a time X axis and when i use this option it does not produce a nice time line (the axis labels are not rounded to the nearest hour like they are normally) and it also causes alignment problems with my secondary X axis that shows the date at the top of the graph.</p>\n"},{"tags":["c#","parameters","constructor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13297702,"title":"Parameters not being passed up to main class","body":"<p>I currently have a problem where my program should show parameters from each class onto the form, however the class lowest in the hierarchy isn't showing. For example; I want it to show \"Charity Cyclist No. 1 riding a tricycle with 3 wheels and £300 sponsorship\" but it's only showing \"Charity Cyclist No. 1 riding a tricycle with 3 wheels\".</p>\n\n<p>Here is my Sponsorship class:</p>\n\n<pre><code>class Sponsorship : CharityCyclists\n{\n    private double fundsRaised;\n\n    public double FundsRaised\n    {\n        get { return fundsRaised; }\n        set { fundsRaised = value; }\n    }\n\n    public Sponsorship(String type, int number, String finished, int hours, int mins, int secs, string bicycle, int wheels, double fundsRaised) : base(type, number, finished, hours, mins, secs, bicycle, wheels, fundsRaised)\n    {\n        this.fundsRaised = fundsRaised;\n    }\n\n    public override string ToString()\n    {\n        return base.ToString() + \" and sponsorship amount: \" + fundsRaised;\n    }\n}\n</code></pre>\n\n<p>Here is my CharityCyclists class:</p>\n\n<pre><code>class CharityCyclists : Cyclists\n{\n\n    private string bicycle;\n    private int wheels;\n\n    public string Bicycle\n    {\n        get { return bicycle; }\n        set { bicycle = value; }\n    }\n\n    public int Wheels\n    {\n        get { return wheels; }\n        set { wheels = value; }\n    }\n\n\n    public CharityCyclists(string type, int number, string finished, int hours, int mins, int secs, string bicycle, int wheels, double fundsRaised) : base(type, number, finished, hours, mins, secs)\n    {\n        this.bicycle = bicycle;\n        this.wheels = wheels;\n    }\n\n    public override string ToString()\n    {\n        return base.ToString() + \" riding a \" + bicycle + \" with \" + wheels + \" wheels\";\n    }\n}\n</code></pre>\n\n<p>and my Cyclists class:</p>\n\n<pre><code>    public static int NumFinished\n    {\n        get { return Cyclists.numFinished; }\n        set { Cyclists.numFinished = value; }\n    }\n\n    public string Type\n    {\n        get { return type; }\n        set { type = value; }\n    }\n\n    public int Number\n    {\n        get { return number; }\n        set { number = value; }\n    }\n\n    public string Finished\n    {\n        get { return finished; }\n        set { finished = value; }\n    }\n\n    public int Hours\n    {\n        get { return hours; }\n        set { hours = value; }\n    }\n\n    public int Mins\n    {\n        get { return mins; }\n        set { mins = value; }\n    }\n\n    public int Secs\n    {\n        get { return secs; }\n        set { secs = value; }\n    }\n\n    public Cyclists(string type, int number, string finished, int hours, int mins, int secs)\n    {\n        this.type = type;\n        this.number = number;\n        this.finished = finished;\n        this.hours = hours;\n        this.mins = mins;\n        this.secs = secs;\n    }\n\n    public override string ToString()\n    {\n\n        return type + \" No. \" + number;\n    }\n\n    public Cyclists()\n    {\n\n    }\n</code></pre>\n\n<p>This is where they are added to the listbox on the form:</p>\n\n<pre><code>        Cyclists[] cyclistsList;\n        cyclistsList = new Cyclists[2];\n\n        cyclistsList[0] = new CharityCyclists(\"Novelty Charity Cyclist\", 1, \"Not Finished\", 0, 0, 0, \"Tricycle\", 2, 300);\n        cyclistsList[1] = new CompetitiveCyclists(\"Competitive Cyclist\", 1, \"Not Finished\", 0, 0, 0, 25, 2);\n\n        for (int i = 0; i &lt; MAX_CYCLISTS; i++)\n        {\n            lstCyclists.Items.Add(cyclistsList[i]);\n        }\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13297071,"title":"ASP:Dropdownlist OnSelectedIndexChanged Event Not Firing","body":"<p>I have a non-databound Dropdownlist inside of an UpdatePanel:</p>\n\n<pre><code>&lt;asp:UpdatePanel runat=\"server\" ID=\"FiltersUpdPnl\"&gt;\n    &lt;ContentTemplate&gt;\n        &lt;div class=\"filters\"&gt;\n            &lt;asp:Button runat=\"server\" ID=\"ExportBtn\" Text=\"Export Map to Image\" /&gt;\n            &lt;br /&gt;\n            Show: \n            &lt;asp:DropDownList runat=\"server\" ID=\"CapNumProjectsDDL\" AutoPostBack=\"true\" OnSelectedIndexChanged=\"ApplyFilters\" OnPreRender=\"CapNumProjectsDDL_PreRender\"&gt;\n                &lt;%--&lt;asp:ListItem Value=\"0\" Text=\"\" Selected=\"True\"&gt;&lt;/asp:ListItem&gt;--%&gt;\n                &lt;asp:ListItem Value=\"1\" Text=\"Capacity\"&gt;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Value=\"2\" Text=\"Number of Projects\"&gt;&lt;/asp:ListItem&gt;\n            &lt;/asp:DropDownList&gt;\n        &lt;/div&gt;\n    &lt;/ContentTemplate&gt;\n&lt;/asp:UpdatePanel&gt;\n</code></pre>\n\n<p>The event handler isn't terribly important, it just does stuff:</p>\n\n<pre><code>protected void ApplyFilters(object sender, EventArgs e)\n{\n    //Do Stuff relating to the selected Value\n}\n</code></pre>\n\n<p>When the page loads, \"Capacity\" is selected by default, as it's the first ListItem. When I switch off to \"Number of Projects\", the event handler fires as expected, executing the code. But when I switch back to \"Capacity\", the handler does NOT fire. The Postback is occurring, but I want it to specifically hit the event handler on both listitems.</p>\n\n<p>You can see that I have a commented-out \"0-value\" ListItem in there. When I uncomment that, both \"Capacity\" and \"Number of Projects\" will hit the event handler as expected.</p>\n\n<p>The issue is that when the page loads, it's loading the data relevant to the \"Capacity\" dropdown, so I want the \"Capacity\" ListItem to be showing, but be able to fire the event handler when selected.</p>\n\n<p>Am I missing something obvious here?</p>\n\n<p>E: I tried adding a handler for the DDL_Prerender event, setting the SelectedIndex to like 200 or something clearly not in the list, hoping it would de-select \"Capacity\", but that didn't work either.</p>\n\n<p>This is the Pre-render code:</p>\n\n<pre><code>protected void CapNumProjectsDDL_PreRender(object sender, EventArgs e)\n{\n    CapNumProjectsDDL.SelectedIndex = 200;\n}\n</code></pre>\n\n<p>This didn't change the way it worked.</p>\n"},{"tags":["c#","odp.net"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6,"score":2,"question_id":13298042,"title":"Oracledataadaptor Fillschema doesnot work with novalidate table constraint","body":"<p>I am using ODP.net for updating a table with C# winform. I get Dynamic SQL error if my oracle table constraint has novalidate. If I do not have that the delete/edit works fine. </p>\n\n<p>Please tell how to fix this issue other than below options\n1. setting primarykey manually in the code since the code is generic.\n2. Remove novalidate within constarint in oracle table.</p>\n\n<hr>\n\n<p>Oracle table constarint: </p>\n\n<pre><code>ALTER TABLE \"table1\" ADD CONSTRAINT \"PK_table1\" PRIMARY KEY (\"EMP_ID\") ENABLE NOVALIDATE;\n</code></pre>\n\n<p>C# code:</p>\n\n<pre><code>using Oracle.DataAccess.Client;\n\npublic partial class Form1 : Form\n    {\n        OracleConnection OraConn;\n        OracleDataAdapter FOraDataAdapt;\n        DataTable OraDataTable;\n        BindingSource FBindSource;\n        int RecNo;\n\n        public Form1()\n        {\n            InitializeComponent();\n            OraConn = new OracleConnection(\"Data Source=ORCL1;User Id=123;Password=123;\");\n        }\n\n        private void btnConnect_Click(object sender, EventArgs e)\n        {\n            try\n            {\n                OraConn.Open();\n\n                OracleCommand FOraCommand = new OracleCommand(\"select * from table1\", OraConn);\n                FOraDataAdapt = new OracleDataAdapter(FOraCommand);                   OracleCommandBuilder FOraCommandBuilder = new OracleCommandBuilder(FOraDataAdapt);\n                OraDataTable = new DataTable();\n\n                DataTable TableSchema = new DataTable();\n                FOraDataAdapt.Fill(OraDataTable);\n                FOraDataAdapt.FillSchema(TableSchema, System.Data.SchemaType.Source);\n\n                FBindSource = new BindingSource();\n                FBindSource.DataSource = OraDataTable;\n\n                grdView.DataSource = FBindSource; \n\n            }\n            catch (Exception Exp)\n            {\n                MessageBox.Show(Exp.Message);\n            }\n        }\n\n        private void btnDelete_Click(object sender, EventArgs e)\n        {\n            try\n            {\n                RecNo = FBindSource.Position;\n                FBindSource.RemoveAt(RecNo);\n                FOraDataAdapt.Update(OraDataTable);            \n                OraDataTable.Rows[RecNo].AcceptChanges();\n            }\n            catch (Exception Exp)\n            {\n                MessageBox.Show(Exp.Message);\n            }\n        }\n\n        private void btnModify_Click(object sender, EventArgs e)\n        {\n            RecNo = FBindSource.Position;\n            OraDataTable.Rows[RecNo].BeginEdit();\n        }\n\n        private void btnPost_Click(object sender, EventArgs e)\n        {\n            try\n            {\n                FBindSource.EndEdit();\n                FOraDataAdapt.Update(OraDataTable);\n                OraDataTable.Rows[RecNo].AcceptChanges();\n            }\n            catch (Exception Exp)\n            {\n                MessageBox.Show(Exp.Message);\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","xaml","treeview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13298121,"title":"How to make text wrap for a TreeView in wpf","body":"<p>I have spent most of the day trying to figure this out, I know that the problem is that the TextBlock thinks that it has infinite width, so the wrapping never occurs, I have tried a lot of bindings to set the width of the grid, ContentPane, etc; without any luck; this user control is hosted withing a ig:Dock of a larger application that can be dynamically re-sized, so I can't just set a width to the text, I believe I need some sort of binding... any help would be appreciated.</p>\n\n<pre><code>&lt;UserControl x:Class=\"VistaSTAR_Client.Views.XMLEditor\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n        xmlns:igDock=\"http://infragistics.com/DockManager\"\n        xmlns:ig=\"http://schemas.infragistics.com/xaml\"\n        mc:Ignorable=\"d\" \n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"&gt;\n\n    &lt;UserControl.Resources&gt;\n        &lt;SolidColorBrush x:Key=\"xmlValueBrush\" Color=\"Blue\" /&gt;\n        &lt;SolidColorBrush x:Key=\"xmAttributeBrush\" Color=\"Red\" /&gt;\n        &lt;SolidColorBrush x:Key=\"xmlTagBrush\" Color=\"DarkMagenta\" /&gt;\n        &lt;SolidColorBrush x:Key=\"xmlMarkBrush\" Color=\"Blue\" /&gt;\n        &lt;DataTemplate x:Key=\"attributeTemplate\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\" Margin=\"3,0,0,0\" HorizontalAlignment=\"Center\"&gt;\n                &lt;TextBlock Text=\"{Binding Path=Name}\" Foreground=\"{StaticResource xmAttributeBrush}\"/&gt;\n                &lt;TextBlock Text=\"=&amp;quot;\" Foreground=\"{StaticResource xmlMarkBrush}\"/&gt;\n                &lt;TextBlock Text=\"{Binding Path=Value}\" Foreground=\"{StaticResource xmlValueBrush}\"/&gt;\n                &lt;TextBlock Text=\"&amp;quot;\" Foreground=\"{StaticResource xmlMarkBrush}\"/&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n\n        &lt;HierarchicalDataTemplate x:Key=\"NodeTemplate\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\" Focusable=\"False\"&gt;\n                &lt;TextBlock x:Name=\"tbName\" Text=\"?\" /&gt;\n                &lt;ItemsControl ItemTemplate=\"{StaticResource attributeTemplate}\" ItemsSource=\"{Binding Path=Attributes}\" HorizontalAlignment=\"Center\"&gt;\n                    &lt;ItemsControl.ItemsPanel&gt;\n                        &lt;ItemsPanelTemplate&gt;\n                            &lt;StackPanel Orientation=\"Horizontal\"/&gt;\n                        &lt;/ItemsPanelTemplate&gt;\n                    &lt;/ItemsControl.ItemsPanel&gt;\n                &lt;/ItemsControl&gt;\n            &lt;/StackPanel&gt;\n            &lt;HierarchicalDataTemplate.ItemsSource&gt;\n                &lt;Binding XPath=\"child::node()\" /&gt;\n            &lt;/HierarchicalDataTemplate.ItemsSource&gt;\n            &lt;HierarchicalDataTemplate.Triggers&gt;\n                &lt;DataTrigger Binding=\"{Binding Path=NodeType}\" Value=\"Text\"&gt;\n                    &lt;Setter TargetName=\"tbName\" Property=\"Text\" Value=\"{Binding Path=Value}\"/&gt;\n                &lt;/DataTrigger&gt;\n                &lt;DataTrigger Binding=\"{Binding Path=NodeType}\" Value=\"Element\"&gt;\n                    &lt;Setter TargetName=\"tbName\" Property=\"Text\" Value=\"{Binding Path=Name}\"/&gt;\n                &lt;/DataTrigger&gt;\n            &lt;/HierarchicalDataTemplate.Triggers&gt;\n        &lt;/HierarchicalDataTemplate&gt;\n        &lt;XmlDataProvider x:Key=\"xmlDataProvider\"&gt;\n        &lt;/XmlDataProvider&gt;\n    &lt;/UserControl.Resources&gt;\n\n\n\n    &lt;Grid&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"*\" /&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;igDock:XamDockManager Name=\"XMLDockManager\" Theme=\"IGTheme\" LayoutMode=\"FillContainer\"&gt;\n            &lt;igDock:XamDockManager.Panes&gt;\n                &lt;igDock:SplitPane Width=\"Auto\" HorizontalAlignment=\"Stretch\"&gt;\n                    &lt;igDock:TabGroupPane Width=\"Auto\" HorizontalAlignment=\"Stretch\"&gt;\n                    &lt;igDock:ContentPane Name=\"XMLTreeView\" Header=\"Tree View\" Width=\"Auto\" HorizontalAlignment=\"Stretch\"&gt;\n                        &lt;TreeView Name=\"treeView1\" Background=\"AliceBlue\" HorizontalAlignment=\"Stretch\" Height=\"Auto\" Width=\"Auto\" Margin=\"5,5,5,5\"\n                            ItemsSource=\"{Binding Source={StaticResource xmlDataProvider}, XPath=*}\" ItemTemplate= \"{StaticResource NodeTemplate}\"/&gt;\n                    &lt;/igDock:ContentPane&gt;\n                    &lt;igDock:ContentPane Name=\"XML\" Header=\"Editor\"&gt;\n                        &lt;TextBox HorizontalAlignment=\"Stretch\" Name=\"text\" Text=\" \" TextWrapping=\"WrapWithOverflow\" Height=\"Auto\" Width=\"Auto\"\n                            VerticalScrollBarVisibility=\"Auto\" VerticalAlignment=\"Stretch\" AcceptsReturn=\"True\" AcceptsTab=\"True\" Margin=\"5,5,5,5\" Grid.Row=\"1\" /&gt;\n                    &lt;/igDock:ContentPane&gt;\n                    &lt;/igDock:TabGroupPane&gt;\n                &lt;/igDock:SplitPane&gt;\n            &lt;/igDock:XamDockManager.Panes&gt;\n        &lt;/igDock:XamDockManager&gt;\n\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n"},{"tags":["c#","windows-phone-7","push-notification","windows-phone-8"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13289045,"title":"Microsoft Push Notification Service And Windows Phone 7/8","body":"<p>I have few questions regarding MPNS(Microsoft Push Notification Service) For Windows Phone.</p>\n\n<p>As we know there are three types of Push Notifications in windows phone</p>\n\n<ol>\n<li>Toast Notification</li>\n<li>Shell Tile Notification</li>\n<li><p>Raw Data Notification</p></li>\n<li><p>Can we show Toast and Tile at the same time. Mean when toast is received via MPNS and it also updates my tile count too for my app tile.</p></li>\n<li><p>Suppose my app is not launched and its not in running state or its in background. If there is some toast or tile notification is received. And server send some payload in this push. Can we get that when app launched after the push and we can get this payload within our app.</p></li>\n<li><p>What is TTL(Time To Live) time of push or can we set that within our payload.</p></li>\n</ol>\n"},{"tags":["c#","wpf","treeview","selecteditem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13296805,"title":"Use different datatemplate by binding to different TreeView selectedItem","body":"<p>I have built a WPF MVVM TreeView that shows different Elements.</p>\n\n<ul>\n<li>CatA<br>\n-- SubItemA<br></li>\n<li>CatB<br>\n-- SubItemB<br></li>\n</ul>\n\n<p>Based on the category of the SubItem I would like to use a different data template.\nfor each type.</p>\n\n<p>So far I can connect to the selected Item, but I'm not sure how to manage the different data templates.</p>\n\n<pre><code>public class SubItem\n{\n    public string Type { get; set; }\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p><br></p>\n\n<pre><code>    &lt;StackPanel Grid.Column=\"2\" DataContext=\"{Binding ElementName=myTreeView, Path=SelectedItem}\"&gt;\n        &lt;TextBox Text=\"{Binding Parent.Name}\" /&gt;\n        &lt;TextBox Text=\"{Binding Path=Name, Mode=TwoWay}\" /&gt;\n    &lt;/StackPanel&gt;\n</code></pre>\n"},{"tags":["c#","ravendb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13271106,"title":"WhereGreaterThan returns no results in LuceneQuery (RavenDB)","body":"<p>I'm having an issue querying for values that are greater than a certain value with lucene.  My data is dynamic, so Linq is not an option.</p>\n\n<p>The problem, in short, is when I query with WhereGreaterThan I get zero results even though my Asset.Data has a price greater than a value.  This applies to WhereGreaterThanOrEquals, WhereLessThan, and WhereLessThanOrEquals as well.</p>\n\n<pre><code>public class AssetDataSearch : AbstractIndexCreationTask&lt;Asset&gt;\n{\n    public AssetDataSearch()\n    {\n        Map = (docs) =&gt; \n            from d in docs\n            select new\n            {\n                DataType = d.DataType,\n                _ = d.SearchableParameters.Select(s =&gt; CreateField(s.Key, s.Value))\n            };\n    }\n}\n\npublic class Test\n{\n    public void TestMethod()\n    {\n        var assets = new []\n        {\n            new Asset()\n            {\n                ID = Guid.NewGuid().ToString(),\n                Data = new ListingData()\n                {\n                    Beds = 5,\n                    Baths = 5,\n                    ListingType = ListingTypeEnum.Condo,\n                    Price = 100\n                }\n            },\n            new Asset()\n            {\n                ID = Guid.NewGuid().ToString(),\n                Data = new ListingData()\n                {\n                    LotSize = 55,\n                    SqFeet = 89,\n                    YearBuilt = 1965,\n                    Price = 200\n                }\n            },\n        };\n        RavenHelper.InitTestingStore();\n        using (var session = RavenDB.RavenUtility.OpenSession())\n        {\n            foreach(var a in assets)\n                session.Store(a);\n            session.SaveChanges();\n            var assetsInDb = session.Advanced.LuceneQuery&lt;Asset&gt;().WaitForNonStaleResults().ToArray();\n            var n = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereEquals(\"Price\", 100).ToArray(); // returns expected results\n            var gt = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereGreaterThan(\"Price\", 60).ToArray(); // returns nothing\n            var lt = session.Advanced.LuceneQuery&lt;Asset, AssetDataSearch&gt;().WhereLessThan(\"Price\", 60).ToArray();  // returns nothing\n        }\n     }\n }\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["c#","json","parsing","large-files"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13297563,"title":"Read and parse a Json File in C#","body":"<p>I have spent the best part of two days \"faffing\" about with code samples and etc., trying to read a very large JSON file into an array in c# so I can later split it up into a 2d array for processing.</p>\n\n<p>The problem I was having was I could not find any examples of people doing what I was trying to do. This meant I was just editing code a little an hoping for the best.</p>\n\n<p>I have managed to get somthing working that will:</p>\n\n<ul>\n<li>Read the file Miss out headers and only read values into array.</li>\n<li>Place a certain amount of values on each line of an array. (So I\ncould later split it an put into 2d array)</li>\n</ul>\n\n<p>This was done with the code below but it crashes the program after entering a few lines into the array. This might have to do with the file size.</p>\n\n<pre><code>if (fileExtension == \".json\") // If the file extension was a jave file the following load method will be use else it will move on to the next else if statment\n        {\n            int count = 0;\n            int count2 = 0;\n            int inOrOut = 0;\n            int nRecords=1; \n            JsonTextReader reader = new JsonTextReader(new StreamReader(txtLoaction.Text));\n            string[] rawData = new string[5];\n            while (reader.Read())\n            {\n                if (reader.Value != null)\n                    if (inOrOut == 1)\n                    {\n                        if (count == 6)\n                        {\n                            nRecords++;\n                            Array.Resize(ref rawData, nRecords);\n                            //textBox1.Text += \"\\r\\n\";\n                            count = 0;\n                        }\n                        rawData[count2] += reader.Value + \",\"; //+\"\\r\\n\"\n                        inOrOut = 0;\n                        count++;\n                        if (count2 == 500)\n                        {\n                            MessageBox.Show(rawData[499]);\n                        }\n                    }\n                    else\n                    {\n                        inOrOut = 1;\n                    }\n            } \n        }\n</code></pre>\n\n<p>A snippet of the JSON I am working with is:</p>\n\n<pre><code>[ \n    { \"millis\": \"1000\", \n      \"stamp\": \"1273010254\", \n      \"datetime\": \"2010/5/4 21:57:34\", \n      \"light\": \"333\", \n      \"temp\": \"78.32\", \n      \"vcc\": \"3.54\" }, \n] \n</code></pre>\n\n<p>I need the values out of this JSON.  For example, I need \"3.54\", but I would not want it to print the \"vcc\".</p>\n\n<p>I am hoping someone can show me how to read a JSON file in and only extract the data that I need and put it into an array or something that I can use to later put into an array.</p>\n"},{"tags":["c#","httpwebrequest","ftps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13296765,"title":"uploading file on secured FTP over https protocol c#","body":"<p>I have to upload and download files on FTP with HTTPS. \nIf I am thinking right I have to use HTTPWebRequest class since the ftp is using HTTPS protocol.</p>\n\n<p>Now I'm trying to download a file but all the response stream I'm getting is just the \"virtual  user 'XXX' logged in\".</p>\n\n<p>May be I'm not setting correct method type or something else is going wrong.</p>\n\n<pre><code> WebRequest ftp1 = HttpWebRequest.Create(u1);\n            ftp1.PreAuthenticate = true;\n            ftp1.Credentials = netCred;\n\n            ftp1.Method = WebRequestMethods.Ftp.DownloadFile;\n            try\n            {\n                response = (HttpWebResponse)ftp1.GetResponse();            \n                remoteStream = response.GetResponseStream();\n                localStream = File.Create(\"c:/TEST1.txt\");\n                int bytesProcessed = 0;\n                byte[] buffer = new byte[4096];\n                int bytesRead;\n\n                do\n                {\n                    // Read data (up to 1k) from the stream\n                    bytesRead = remoteStream.Read(buffer, 0, buffer.Length);\n\n                    // Write the data to the local file\n                    localStream.Write(buffer, 0, bytesRead);\n\n                    // Increment total bytes processed\n                    bytesProcessed += bytesRead;\n                } while (bytesRead &gt; 0);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e.Message);\n            }\n      finally\n      {\n        // Close the response and streams objects here \n        // to make sure they're closed even if an exception\n        // is thrown at some point\n        if (response != null) response.Close();\n        if (remoteStream != null) remoteStream.Close();\n        if (localStream != null) localStream.Close();\n      }\n</code></pre>\n"},{"tags":["c#","encryption"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":13296586,"title":"Simple string encryption/decryption with a small resulting string","body":"<p>I need to encrypt a string and then be able to decrypt it again.</p>\n\n<p>I implemented the solution <a href=\"http://stackoverflow.com/questions/10168240/encrypting-decrypting-a-string-in-c-sharp\">here</a> and it works well, but the resulting string is not suitable as it needs to be simple and short enough for a user to use.</p>\n\n<p>I am encrypting incrementing database ID's (from 1) and there won't be more than 500. Ideally I'd like the encrypted string to be not more than 6 characters in length.</p>\n\n<p>Any ideas appreciated..</p>\n\n<p><strong>edit:</strong> It's a lengthy form which the user can resume at a later date with this generated string</p>\n"},{"tags":["c#","dynamics-crm-2011","crm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13298012,"title":"Importing Contracts","body":"<p>Trying to import contracts from on-premise to online host.  I tweaked the SDK solution \"dataimport\" however I'm having trouble with the required lookup attribute \"CustomerIdName\".  It gives error 2147220654 \"A duplicate lookup reference was found\"</p>\n\n<p>Another mapping to lookup attribute contracttemplateid works just fine.  I think it has something to do with the fact this can map either to account or contact entity.  Source file (just 1 record row) and code below.  This is 1 column mapping based on the ImportWithCreate class included with the sdk solution.</p>\n\n<p>title,activeon,allotmenttypecode,expireson,billingstarton,billingendon,new_companyorindividual,CustomerIdName\nAcme Consulting Company,5/1/2000,1,1/23/2002,5/1/2000,1/23/2002,0,USF Admin</p>\n\n<pre><code>#region Column Eight Mappings\n            // Create a column mapping for a 'lookup' type field.\n            ColumnMapping colMapping8 = new ColumnMapping()\n            {\n                // Set source properties.\n                SourceAttributeName = \"CustomerIdName\",\n                SourceEntityName = \"Contract_1\",\n\n                // Set target properties.\n                TargetAttributeName = \"customerid\",\n                TargetEntityName = Contract.EntityLogicalName,\n\n                // Relate this column mapping with the data map.\n                ImportMapId =\n                    new EntityReference(ImportMap.EntityLogicalName, importMapId),\n\n                // Force this column to be processed.\n                ProcessCode =\n                    new OptionSetValue((int)ColumnMappingProcessCode.Process),\n            };\n\n            // Create the mapping.\n            Guid colMappingId8 = _serviceProxy.Create(colMapping8);\n\n            // Because we created a column mapping of type lookup, we need to specify lookup details in a lookupmapping.\n            // One lookupmapping will be for the parent account, and the other for the current record.\n            // This lookupmapping is important because without it the current record\n            // cannot be used as the parent of another record.\n\n            // Create a lookup mapping to the parent account.  \n            LookUpMapping parentLookupMapping8 = new LookUpMapping()\n            {\n                // Relate this mapping with its parent column mapping.\n                ColumnMappingId =\n                    new EntityReference(ColumnMapping.EntityLogicalName, colMappingId8),\n\n                // Force this column to be processed.\n                ProcessCode =\n                    new OptionSetValue((int)LookUpMappingProcessCode.Process),\n\n                // Set the lookup for an account entity by its name attribute.\n                LookUpEntityName = Account.EntityLogicalName,\n                //LookUpEntityName = Contact.EntityLogicalName,\n                LookUpAttributeName = \"name\",\n                LookUpSourceCode =\n                    new OptionSetValue((int)LookUpMappingLookUpSourceCode.System)\n            };\n\n            // Create the lookup mapping.\n            Guid parentLookupMappingId8 = _serviceProxy.Create(parentLookupMapping8);\n\n            // Create a lookup on the current record's \"src_name\" so that this record can\n            // be used as the parent account for another record being imported.\n            // Without this lookup, no record using this account as its parent will be imported.\n            LookUpMapping currentLookUpMapping8 = new LookUpMapping()\n            {\n                // Relate this lookup with its parent column mapping.\n                ColumnMappingId =\n                    new EntityReference(ColumnMapping.EntityLogicalName, colMappingId8),\n\n                // Force this column to be processed.\n                ProcessCode =\n                    new OptionSetValue((int)LookUpMappingProcessCode.Process),\n\n                // Set the lookup for the current record by its src_name attribute.\n                LookUpAttributeName = \"CustomerIdName\",\n                LookUpEntityName = \"Contract_1\",\n                LookUpSourceCode =\n                    new OptionSetValue((int)LookUpMappingLookUpSourceCode.Source)\n            };\n\n            // Create the lookup mapping\n            Guid currentLookupMappingId8 = _serviceProxy.Create(currentLookUpMapping8);\n            #endregion\n</code></pre>\n"},{"tags":["c#","xml-parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":41,"score":-4,"question_id":13297552,"title":"C# Parsing XML results","body":"<p>I was given a URL to a web service and the below is the results.\nI have never seen XML like this before, so my question is: How do </p>\n\n<pre><code>]&gt;&lt;Request AddExpandoFieldTypeSuffix=\"true\" SchemaVersion=\"14.0.0.0\" LibraryVersion=\"14.0.4762.1000\" ApplicationName=\"SL Library\" xmlns=\"http://schemas.microsoft.com/sharepoint/clientquery/2009\"&gt;\n  &lt;Actions&gt;\n    &lt;ObjectPath Id=\"97\" ObjectPathId=\"96\" /&gt;\n    &lt;Query Id=\"98\" ObjectPathId=\"96\"&gt;\n      &lt;Query SelectAllProperties=\"true\"&gt;\n        &lt;Properties /&gt;\n      &lt;/Query&gt;\n    &lt;/Query&gt;\n    &lt;ObjectPath Id=\"100\" ObjectPathId=\"99\" /&gt;\n    &lt;ObjectPath Id=\"102\" ObjectPathId=\"101\" /&gt;\n    &lt;ObjectIdentityQuery Id=\"103\" ObjectPathId=\"101\" /&gt;\n    &lt;Query Id=\"104\" ObjectPathId=\"101\"&gt;\n      &lt;Query SelectAllProperties=\"true\"&gt;\n        &lt;Properties /&gt;\n      &lt;/Query&gt;\n    &lt;/Query&gt;\n    &lt;ObjectPath Id=\"106\" ObjectPathId=\"105\" /&gt;\n    &lt;ObjectIdentityQuery Id=\"107\" ObjectPathId=\"105\" /&gt;\n    &lt;ObjectPath Id=\"109\" ObjectPathId=\"108\" /&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"110\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;Title&lt;/Parameter&gt;\n        &lt;Parameter Type=\"String\"&gt;MOP CSS&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"111\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;ContainsPII&lt;/Parameter&gt;\n        &lt;Parameter Type=\"String\"&gt;Yes&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"112\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;DocumentStatus&lt;/Parameter&gt;\n        &lt;Parameter Type=\"String\"&gt;Draft&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"113\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;OriginalDoc&lt;/Parameter&gt;\n        &lt;Parameter Type=\"String\"&gt;Yes&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"114\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;SecurityClassification&lt;/Parameter&gt;\n        &lt;Parameter Type=\"String\"&gt;None&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"115\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;ExamComponent&lt;/Parameter&gt;\n        &lt;Parameter Type=\"Array\"&gt;\n          &lt;Object TypeId=\"{f1d34cc0-9b50-4a78-be78-d5facfcccfb7}\"&gt;\n            &lt;Property Name=\"LookupId\" Type=\"Int32\"&gt;1&lt;/Property&gt;\n            &lt;Property Name=\"LookupValue\" Type=\"Null\" /&gt;\n          &lt;/Object&gt;\n        &lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"SetFieldValue\" Id=\"116\" ObjectPathId=\"108\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;ExamSubComponent&lt;/Parameter&gt;\n        &lt;Parameter Type=\"Array\"&gt;\n          &lt;Object TypeId=\"{f1d34cc0-9b50-4a78-be78-d5facfcccfb7}\"&gt;\n            &lt;Property Name=\"LookupId\" Type=\"Int32\"&gt;2&lt;/Property&gt;\n            &lt;Property Name=\"LookupValue\" Type=\"Null\" /&gt;\n          &lt;/Object&gt;\n        &lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Name=\"Update\" Id=\"117\" ObjectPathId=\"108\" /&gt;\n    &lt;Query Id=\"118\" ObjectPathId=\"108\"&gt;\n      &lt;Query SelectAllProperties=\"true\"&gt;\n        &lt;Properties&gt;\n          &lt;Property Name=\"Title\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"ContainsPII\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"DocumentStatus\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"OriginalDoc\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"SecurityClassification\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"ExamComponent\" ScalarProperty=\"true\" /&gt;\n          &lt;Property Name=\"ExamSubComponent\" ScalarProperty=\"true\" /&gt;\n        &lt;/Properties&gt;\n      &lt;/Query&gt;\n    &lt;/Query&gt;\n  &lt;/Actions&gt;\n  &lt;ObjectPaths&gt;\n    &lt;Property Id=\"96\" ParentId=\"1\" Name=\"Web\" /&gt;\n    &lt;Property Id=\"99\" ParentId=\"96\" Name=\"Lists\" /&gt;\n    &lt;Method Id=\"101\" ParentId=\"99\" Name=\"GetByTitle\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;Team Files&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Method Id=\"105\" ParentId=\"96\" Name=\"GetFileByServerRelativeUrl\"&gt;\n      &lt;Parameters&gt;\n        &lt;Parameter Type=\"String\"&gt;/867095/Team Files/copMain.css&lt;/Parameter&gt;\n      &lt;/Parameters&gt;\n    &lt;/Method&gt;\n    &lt;Property Id=\"108\" ParentId=\"105\" Name=\"ListItemAllFields\" /&gt;\n    &lt;StaticProperty Id=\"1\" TypeId=\"{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}\" Name=\"Current\" /&gt;\n  &lt;/ObjectPaths&gt;\n&lt;/Request&gt;)[]\n</code></pre>\n"},{"tags":["c#","asp.net","usercontrols","ascx"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":782,"score":0,"question_id":5437001,"title":"Allow .ASPX page to display before .ASCX control finishes loading?","body":"<p>I have an ASP.NET page with one control (.ascx) on it. The page (.aspx) onload assigns some text to a couple labels and passes a product ID to the .ascx control. The .ascx control, onload, takes that product ID from the .aspx page and hits the database several times, does several calculations, etc - basically takes a long time to load. </p>\n\n<p>So when I'm clicking a link to this .aspx page, it is taking 7-10 seconds for the page to load. I've narrowed it down to the calculations on the .ascx control being the culprit and I've optimized the code as much as I can ... but it's still taking too long.</p>\n\n<p>Is there a way to load the .aspx page BEFORE the control loads? (Maybe display a \"Loading...\" animation? Like used in an UpdateProgress?) </p>\n"},{"tags":["c#","multithreading","scope"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13297199,"title":"What is the scope of a singularity pattern class? (Multi-Threading involved)","body":"<p>For a project I am working on I'm implementing a class as a singularity. The class is responsible for detecting what stage (Dev, Test, Production, etc.) the system is running in, and returning certain values accordingly so our dev team won't have to worry about handling staging settings every time they use those values. In addition, it allows us to override what the stage is currently, for the purpose of pretending to be in a different stage.</p>\n\n<p>My concern has to deal with how the singularity will behave when multi-threading is involved. The code below outlines the basic setup that will be used. </p>\n\n<p>My question is, if program &amp; program2 could be running on different threads at the same time, will the OverrideStage() function (which changes a private variable in the instance) interfere with the other program's expected behavior?</p>\n\n<p>Example:</p>\n\n<p>1) Program starts, sets stage to DEV</p>\n\n<p>2) On another thread, Program2 starts, sets stage to PRODUCTION</p>\n\n<p>3) Back in Program, try to get a value, will the value be in DEV or PRODUCTION?</p>\n\n<pre><code>namespace TESTING\n{\n\nclass Program\n{\n    static void Run()\n    {\n\n        Staging stage = Staging.Instance;\n\n        stage.OverrideStage(Staging.DEV);\n            SqlConnection connDev = new SqlConnection(stage.ConnectionString(\"example\")); // Connection to development database\n            // Do Stuff\n        stage.EndOverride();\n            SqlConnection connBackToAuto = new SqlConnection(stage.ConnectionString(\"example\")); // Connection to detected stage database\n    }\n}\n\nclass Program2\n{             \n    static void Run()\n    {\n        Staging s = Staging.Instance;\n        s.OverrideStage(Staging.PRODUCTION);\n            SqlConnection connDev = new SqlConnection(s.ConnectionString(\"example\")); // Connection to production database\n            // Do stuff\n        s.EndOverride();\n    }\n}\n\n} // End namespace\n</code></pre>\n\n<p>I guess the question can be simplified to:</p>\n\n<p><strong>Are s and stage the same instance of Staging?</strong></p>\n"},{"tags":["c#","android","web-services","flash-builder","httpservice"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13297928,"title":"Using HTTP Service in flash builder to send data to C# webservice","body":"<p>this question could be completely redundant and I apologize for that. But I have this code in my android app using flash builder to send data to the webservice</p>\n\n<pre><code>  ResultsQuestion.addItem({\"ResultSEQ\":10000});\n  ResultsQuestion.addItem({\"QuestionID\":QuestionID});\n  ResultsQuestion.addItem({\"ResponsePromptID\":chk1.name});\n  ResultsQuestion.addItem({\"ResponseValue\":ResponseValue});\n  var service:HTTPService = new HTTPService();\n  service.url = \"http://localhost/InsertService/InsertService/Service1.asmx?\";\n  service.method=\"POST\";\n  service.send( ResultsQuestion);\n</code></pre>\n\n<p>And I want to insert this data returned into a SQLServer. And for that I have written this webservice.</p>\n\n<pre><code>public class InsertData\n{\n\n\n    private String questionid;\n    public String QuestionID\n    {\n        get\n        {\n            return questionid;\n        }\n        set\n        {\n            questionid = value;\n        }\n    }\n\n\n    private String responsepromptid;\n    public String ResponsePromptID\n    {\n        get\n        {\n            return responsepromptid;\n        }\n        set\n        {\n            responsepromptid = value;\n        }\n    }\n\n    private String resultseq;\n    public String ResultSEQ\n    {\n        get\n        {\n            return resultseq;\n        }\n        set\n        {\n            resultseq = value;\n        }\n    }\n    private String responsevalue;\n    public String ResponseValue\n    {\n        get\n        {\n            return responsevalue;\n        }\n        set\n        {\n            responsevalue = value;\n        }\n    }\n    public InsertData()\n    {\n        //\n        // TODO: Add constructor logic here\n        //\n    }\n}\n\n[System.Web.Services.WebService(\n   Namespace = \"http://www.rcu.msstate.edu\",\n   Description = \"Crud operations on the Entity Centre in the Courier database\")]\n\npublic class Service : System.Web.Services.WebService\n{\n    public Service()\n    {\n\n        //Uncomment the following line if using designed components \n        //InitializeComponent(); \n    }\n\n    [WebMethod]\n    //[XmlElement(Type = typeof(Centre))]\n    [XmlInclude(typeof(InsertData))]\n    public InsertData getQuestions()\n    {\n\n        String Message;\n        string MyConString = \"Data Source=.\\\\SQLEXPRESS;Server=rcu-sql02.rcu.msstate.edu;Database=MSTAR;User ID=dnnadmin;Password=r1c2u3@Admin;Trusted_Connection=False; \";\n        List&lt;InsertData&gt; returnedList = new List&lt;InsertData&gt;();\n        System.Data.SqlClient.SqlConnection DbConnection = new System.Data.SqlClient.SqlConnection(MyConString);\n        DbConnection.Open();\n        SqlCommand DbCommand = DbConnection.CreateCommand();\n        InsertData data = new InsertData();\n        DbCommand.CommandText = \"Insert into [dbo].[MSTAR_Results_Items] (ResultSEQ,QuestionID,ResponsePromptID,ResponseValue) values(@ResultSEQ,@QuestionID,@ResponsePromptID,@ResponseValue)\".ToString();\n        DbCommand.Parameters.AddWithValue(\"@ResultSEQ\", data.ResultSEQ);\n        DbCommand.Parameters.AddWithValue(\"@QuestionID\", data.QuestionID);\n        DbCommand.Parameters.AddWithValue(\"@ResponsePromptID\", data.ResponsePromptID);\n        DbCommand.Parameters.AddWithValue(\"@ResponseValue\", data.ResponseValue);\n\n        int result = DbCommand.ExecuteNonQuery();\n        if (result == 1)\n        {\n            Message=\"1\";\n\n        }\n        else\n        {\n            Message=\"2\"; ;\n        }\n        DbConnection.Close();\n        InsertData[] ArrayofCentre = new InsertData[10];\n        for (int i = 0; i &lt; returnedList.Count; i++)\n        {\n            ArrayofCentre[i] = (InsertData)returnedList[i];\n        }\n\n        return ArrayofCentre[Convert.ToInt32(Message)];        \n    }\n\n}\n</code></pre>\n\n<p>But, I don't see any data inserted and I don't see any error. So, I am not sure what is wrong. Probably this entire this is wrong. But, please tell me what is the problem with this code? And is there a way to see the data sent by my flex HTTPService? \nThank you so much!</p>\n"},{"tags":["c#","objective-c","monotouch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13296977,"title":"How to bind these in MonoTouch?","body":"<p>How does the ObjectiveC code below translate into MonoTouch?</p>\n\n<pre><code>@interface PSPDFBookmarkViewController : UITableViewController &lt;PSPDFStyleable&gt;\n- (instancetype)initWithDocument:(PSPDFDocument *)document;\n@property (nonatomic, weak) id&lt;PSPDFBookmarkViewControllerDelegate&gt; delegate;\n@property (nonatomic, assign) BOOL isInPopover;\n@end\n</code></pre>\n\n<ul>\n<li>I don't really know what to do with the <code>instancetype</code> thingy (what is this?)</li>\n<li>What is <code>id&lt;PSPDFBookmarkViewControllerDelegate&gt;</code>.</li>\n<li>What to do with the <code>PSPDFStyleable</code>?</li>\n</ul>\n\n<p>This is what I think would be the result:</p>\n\n<pre><code>[BaseType(typeof(UITableViewController)]\n    interface PSPDFBookmarkViewController\n    {\n    void InitWithDocument(PSPDFDocument document);\n    [NullAllowed]\n    PSPDFBookmarkViewControllerDelegate Delegate { get; set; }\n    bool IsInPopover { get; set; }\n    }\n</code></pre>\n\n<p>And what about this interface?</p>\n\n<pre><code>@interface PSPDFBookmarkViewController (SubclassingHooks)\n- (void)createBarButtonItems;\n@end\n</code></pre>\n\n<p>What is the <code>(SubclassingHooks)</code> about and what is its C# cousin?</p>\n"},{"tags":["c#","printer-properties","devmode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13297911,"title":"Setting PostScript Custom Page Size in C#","body":"<p>I am trying to do a project for printing large CAD drawings using SolidWorks.  My plotter drivers (Oce TDS860, HP Z5200ps PS3) support a paper size called PostScript Custom Page Size. The dimensions of this paper size can be set through the printer UI in SolidWorks or in Control Panel, of course, but I need to do this same thing in code.  After looking all over the 'net, and much experimenting, I HAVE LEARNED a few things:</p>\n\n<p>1) I need to modify the DEVMODE structure for this printer.<br/>\n2) The paper dimensions are in the standard section of DEVMODE.<br/>\n3) What unit of measure is used to store the dimensions - 1/10ths of a millimeter.<br/>\n4) That, because of the length of my drawings, a 32-bit int is required to store values,<br/>&nbsp;&nbsp;&nbsp;&nbsp;so the 'int' in the standard section of DEVMODE gets the big end truncated.<br/>\n5) The information I need to modify is in the 'extra' section of the DEVMODE structure.<br/>\n6) The DEVMODE is stored in the Windows registry value HKCU\\Printers\\DevModes2[MyPrinter]<br/>\n7) Which bytes in the 'extra' section are length and width.<br/>\n8) How to modify the length and width bytes and write them back to the registry.<br/>\n9) That the Windows Control Panel UI knows I have changed the registry values and shows the\n<br/>&nbsp;&nbsp;&nbsp;&nbsp;updated size in the UI.<br/>\n10) That Windows apps make their own copies of the Windows DEVMODE and work with that under\n<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;some conditions.<br/>\n11) That Win32API function SendMessageTimeout can be used with HWND_BROADCAST, <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM_SETTINGCHANGE, and WM_DEVMODECHANGE to notify Windows apps that the printer<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEVMODE and registry values have changed.</p>\n\n<p>But, what I haven't found is how to make it actually work.  SolidWorks remains blissfully unaware of my changes to the registry, even though the Control Panel UI seems to pick up on it.  Maybe I need to modify the DEVMODE in Windows memory?  Maybe I need to modify the SolidWorks DEVMODE? (If so, how do I get a copy of it?) Maybe I just need to force SolidWorks to recopy the Windows DEVMODE? (If so, how do I manage this?)  Comments? Suggestions?</p>\n"},{"tags":["c#",".net",".net-4.0"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13297855,"title":"How do I cast an object to a dynamic type?","body":"<p>All of my objects are composed from a base abstract class called <code>GameObject</code>.  All of these objects inherit from one or more interfaces, such as <code>IRenderable</code>, <code>IAnimatable</code>, <code>IMovable</code>, etc.</p>\n\n<p>I also have a list of these objects stored as <code>List&lt;GameObject&gt;</code>.  I'm trying to write a dynamic method that will return to me all of the objects that has inherited from a specific interface, like so:</p>\n\n<pre><code>List&lt;IRenderable&gt; renderableObjects = ObjectManager.GetAll&lt;IRenderable&gt;();\n</code></pre>\n\n<p>At first, I tried just returning a new list of game objects where each object's type matches the dynamic type, then casting the <code>List&lt;GameObject&gt;</code> to <code>List&lt;T&gt;</code>.  The compiler error I received said that I could not convert those types.</p>\n\n<p>So my second attempt involved casting each object individually, as shown below.</p>\n\n<pre><code>public List&lt;T&gt; GetAll&lt;T&gt;() {\n    List&lt;T&gt; list = new List&lt;T&gt;();\n\n    foreach( GameObject obj in this.gameObjects )\n        if( obj is T )\n            list.Add( (T)obj );\n\n     return list;\n}\n</code></pre>\n\n<p>However, this throws the same type of error; cannot convert type GameObject to T.  Am I missing something?  Is there another way to accomplish what I want?</p>\n"},{"tags":["c#","asp.net",".net","visual-studio-2010",".net-4.0"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13293796,"title":"How to string a value across two functions?","body":"<p>I am new to the world of c# so go easy on me! :] </p>\n\n<p>I am not even sure I am using the correct terminology. I figured this would be an easy google search but I am afraid I may not be wording this correctly. </p>\n\n<p>I am gathering data from a database. Like so: </p>\n\n<pre><code>        SqlConnection mySqlConnection = new SqlConnection(strings.settings.connectionString);\n        SqlCommand mySqlCommand = mySqlConnection.CreateCommand();\n        mySqlCommand.CommandText = \"SELECT FNAME, LNAME, ZIPCODE FROM database WHERE ID = @ID\";\n\n        mySqlCommand.Parameters.Add(\"@ID\", SqlDbType.Char).Value = txtID.Text;\n        mySqlConnection.Open();\n        SqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader(CommandBehavior.SingleRow);\n\n        if (mySqlDataReader.HasRows == false)\n        {\n            throw new Exception();\n        }\n\n        if (mySqlDataReader.Read())\n        {\n            txtFname.Text = mySqlDataReader[0].ToString();\n            txtLname.Text = mySqlDataReader[1].ToString();\n            lblZipcode.Text = mySqlDataReader[2].ToString(); \n            //need help on stringing the value ZIPCODE above.  \n        }\n</code></pre>\n\n<p>My question is: How can I string the Zipcode value to another function? I have been trying things like </p>\n\n<pre><code> string Zipcode = mySqlDataReader[2].ToString();\n</code></pre>\n\n<p>but I get stuck trying to figure out how to string that value so I can use it in a different function like so:</p>\n\n<pre><code> private void GetZipData()\n {\n   //Get that value\n }\n</code></pre>\n\n<p>Any help or a point in the right direction would be greatly appreciated!</p>\n"},{"tags":["c#","xaml","windows-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13297352,"title":"RichTextBlock - The name already exists in the tree","body":"<p>In my Windows 8 app, I have a RichTextColumns element on my page, contained in a flip view. I set the RichTextContent property of the RichTextColumns, on the selection changed event.</p>\n\n<p>Now, this works perfectly until I give the richtextcontent a name. I then get the error \"The name already exists in the tree\" when setting the richtextcontent, despite clearing the Children property.</p>\n\n<p>After some reading, this seems to be bug in Silverlight that still hasn't been fixed for Windows 8. Now, I need a name, because in the VisualState snapped group on my view, I set the richtext blocks column width. Without a name, I have no way of setting the rich text blocks width property.</p>\n\n<p>Does anyone know of a way round this? Either getting the richtextcontent to work with a name, or being able to resize the richtextblock on snap view without a name?</p>\n\n<p>EDIT</p>\n\n<p>I should point out, this works when I navigate to the item detail page from another page. When the flip view selection changed event fires the first time, it works fine. If I go back, and then click another item, it rebuilds the detail page and works. It only errors if I use the flip view left and right buttons to navigate to the next item in the group.</p>\n\n<p>As requested here is some code.</p>\n\n<p>My view looks like this:</p>\n\n<pre><code>&lt;common:RichTextColumns x:Name=\"richTextColumns\" Margin=\"117,0,117,47\"&gt;\n&lt;/common:RichTextColumns&gt;\n</code></pre>\n\n<p>Then in <code>&lt;VisualStateManager.VisualStateGroups&gt;</code> I have:</p>\n\n<pre><code>&lt;ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"richTextBlock\" Storyboard.TargetProperty=\"Width\"&gt;\n    &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"280\"/&gt;\n&lt;/ObjectAnimationUsingKeyFrames&gt;\n</code></pre>\n\n<p>In my code I find the rich text columns using <code>var flipViewItemContainer  = this.flipView.ItemContainerGenerator.ContainerFromItem(flipView.SelectedItem);</code> and then walking the visual tree using a helper I wrote:</p>\n\n<pre><code>var target = FindVisualChild&lt;RichTextColumns&gt;(flipViewItemContainer, \"richTextColumns\");\n</code></pre>\n\n<p>I then set the richtextcontent using:</p>\n\n<pre><code>target.RichTextContent = new RichTextBlock { Width = 560, Style = Application.Current.Resources[\"ItemRichTextStyle\"] as Style };\n</code></pre>\n\n<p>Now this works. But if I add a name to the rich text block, it errors:</p>\n\n<pre><code>target.RichTextContent = new RichTextBlock { Name = \"richTextBlock\", Width = 560, Style = Application.Current.Resources[\"ItemRichTextStyle\"] as Style };\n</code></pre>\n\n<p>You can see I use the name in the <code>Storyboard.TargetName</code> to change the width on snap.</p>\n\n<p>The only way round this I can think of, is to rebuild my content and create a new rich text block with the correct width, based on the ApplicationViewState, but that doesn't seem the right approach. </p>\n"},{"tags":["c#","asp.net","url","routing","webforms"],"answer_count":3,"favorite_count":1,"up_vote_count":18,"down_vote_count":0,"view_count":10735,"score":18,"question_id":5967103,"title":"A potentially dangerous Request.Path value was detected from the client (*)","body":"<p>I am recieving the rather self explanatory error:</p>\n\n<p>A potentially dangerous Request.Path value was detected from the client (*).</p>\n\n<p>the issue is that my url contains a *:</p>\n\n<p><a href=\"http://localhost:3286/Search/test\">http://localhost:3286/Search/test</a>*/0/1/10/1</p>\n\n<p>This url is used to populate a search page where 'test*' is the search term and the rest of the url relates to various other filters.</p>\n\n<p>My question is if there is a simple solution to allow me to add these special characters as search terms? </p>\n\n<p>I have tried including the following in the web.config but it has no effect on if the error message is displayed. </p>\n\n<p>Should I be manually encoding / decoding the special characters?</p>\n\n<p>Is there a best practice for doing this? I would like to try and avoid using a query string but i guess it is an option.</p>\n\n<p>The application itself is a c# asp.net webforms application that uses routing to produce the nice URL above.</p>\n\n<p>Any suggestions would be a great help.</p>\n"},{"tags":["c#","sql-server","entity-framework","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13297827,"title":"Use same EDMX for different Databases (Local & Server)","body":"<p>I'm working on a project where I have a local database (SQL CE) which is used as sort of a buffer while no connection to the server exists. On the server I want to use the same database-layout.</p>\n\n<p>Of course I want to use the same EDMX-File which is in a Common.dll available on the Server and the Client.</p>\n\n<p>In the Client I have a connection string with provider=System.Data.SqlServerCe.3.5 while it is provider=System.Data.SqlClient on the server.</p>\n\n<p>My problem comes when I want to save sth on the Server-side: \"The provider manifest given is not of type 'System.Data.SqlClient.SqlProviderManifest'.\"</p>\n\n<p>Is there even a chance to use the same EDMX-File on both parts?\nOr is there any best practice how to handle such a constellation?</p>\n\n<p>Thank you for your help!</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13297763,"title":"adding NULL to DropdownList-options","body":"<p>On my ASP.NET MVC4 application, I need a dropdown-list to select a Location and insert its ID into a table, say News.\nSome news apply to ALL Locations - therefore the LocationID in News is Nullable, to indicate this.</p>\n\n<p>So I need to add \"ALL Locations\" to the dropdown.</p>\n\n<p>This is how I imagined, it would work - but on the last line Value = DBNull.Value (or simple null) is not allowed. It only accepts an integer. I CANNOT use \"0\" as foreign key constraints on that table do not allow 0, because there is no ID=0 in Locations-table</p>\n\n<pre><code>var locations = db.Locations.Select(c =&gt; new { DisplayText = c.Location, Value = c.ID }).ToList();\nlocations.Insert(0, new { DisplayText = \"All Locations\", Value = DBNull.Value });\nreturn Json(new { Result = \"OK\", Options = locations});\n</code></pre>\n\n<p>How can I add this to the options-list?</p>\n"},{"tags":["c#","visual-studio-2012","csc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13297704,"title":"Visual Studio 2012 csc.exe Error. Executable not valid for OS","body":"<p>I am getting the following error when trying to compile and test any type of project in Visual Studio 2012 Professional. </p>\n\n<p>Error   1   The specified task executable \"Csc.exe\" could not be run. The specified executable is not a valid application for this OS platform.</p>\n\n<p>After testing multiple suggestions online nothing has fixed the problem. Anyone know what is causing this? Is there a new version of Csc.exe I need to get a hold of? I know this is the compiler just not sure what I need to do to fix the problem.</p>\n"},{"tags":["c#","collections","long-integer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13296233,"title":"Using Long Integer types with collection methods","body":"<p>I've encountered a problem, which is best illustrated with this code segment:</p>\n\n<pre><code>public static void Foo(long RemoveLocation) \n{\n    // Code body here...\n\n    // MyList is a List type collection object.\n    MyList.RemoveAt(RemoveLocation);\n}\n</code></pre>\n\n<p>Problem: RemoveLocation is a <code>long</code>.  The RemoveAt method takes only <code>int</code> types.  How do I get around this problem?</p>\n\n<p>Solutions I'd prefer to avoid (because it's crunch time on the project): </p>\n\n<ul>\n<li>Splitting <code>MyList</code> into two or more lists; that would require rewriting a lot of code.</li>\n<li>Using <code>int</code> instead of <code>long</code>.</li>\n</ul>\n"},{"tags":["c#","replace","find"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12849805,"title":"Read a file and replace test after a certain word","body":"<p>I have a few files, for example:</p>\n\n<pre><code>FileBegin Finance  Open 87547.25 Close 548484.54 EndDay 4 End\n</code></pre>\n\n<p>Another file example:</p>\n\n<pre><code>FileBegin Finance  Open 344.34 Close -3434.34 EndDay 5 End\n</code></pre>\n\n<p>I need to read the text in the file and replace only the numeric value after the word Open leaving the rest of the text before and after the word Open intact. I have been using this code:</p>\n\n<pre><code>    string fileToRead = \"c:\\\\file.txt\";\n    public void EditValue(string oldValue, string newValue, Control Item)\n    {\n        if (Item is TextBox)\n        {\n            string text = File.ReadAllText(fileToRead);\n            text = text.Replace(oldValue, newValue);\n            File.WriteAllText(activeSaveFile, text);\n        }\n     }\n</code></pre>\n\n<p>What would be the best way of going about replacing just the numeric value after the word <code>open</code>?</p>\n"},{"tags":["c#","json","serialization","deserialization","signalr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13297527,"title":"Sending base class over json and converting to parent class on client side","body":"<p>I have two classes <code>Group</code> and <code>Contact</code>.</p>\n\n<p>They both extend my base class <code>ChatTarget</code>.</p>\n\n<p>I am using Signalr to send these objects to my clients.  My server sends and my client endpoints expect a <code>ChatTarget</code> object.  On the server, I am able to cast back and forth from <code>Contact</code> or <code>Group</code> to <code>ChatTarget</code>.  </p>\n\n<p>After sending my <code>ChatTarget</code> down to my client, I am no longer able to convert a <code>ChatTarget</code> to any of its extended classes.  It appears that the json serialization is destroying the extended properties and maintaining only the base <code>ChatTarget</code> stuff.</p>\n\n<p>How can I retain the ability to cast a <code>ChatTarget</code> back on my client side?</p>\n"},{"tags":["c#",".net","enums","enum-flags"],"answer_count":4,"favorite_count":4,"up_vote_count":40,"down_vote_count":0,"view_count":877,"score":40,"question_id":13222671,"title":"Why are flag enums usually defined with hexadecimal values","body":"<p>A lot of times I see flag enum declarations that use hexadecimal values. For example:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Flags]\npublic enum MyEnum\n{\n    None  = 0x0,\n    Flag1 = 0x1,\n    Flag2 = 0x2,\n    Flag3 = 0x4,\n    Flag4 = 0x8,\n    Flag5 = 0x10\n}\n</code></pre>\n\n<p>When I declare an enum, I usually declare it like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Flags]\npublic enum MyEnum\n{\n    None  = 0,\n    Flag1 = 1,\n    Flag2 = 2,\n    Flag3 = 4,\n    Flag4 = 8,\n    Flag5 = 16\n}\n</code></pre>\n\n<p>Is there a reason or rationale to why some people choose to write the value in hexadecimal rather than decimal? The way I see it, it's easier to get confused when using hex values and accidentally write <code>Flag5 = 0x16</code> instead of <code>Flag5 = 0x10</code>.</p>\n"},{"tags":["c#","android","monodroid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13213695,"title":"How to get GCM error message 'NotRegistered' using PushSharp","body":"<p>I am trying to figure out how to get a Google GCM response (ie NotRegistered error) so that I may remove the GCM info from the users account.</p>\n\n<p>From <a href=\"http://developer.android.com/guide/google/gcm/gcm.html\" rel=\"nofollow\">GCM Archetecture Overview</a> (in regards to unregistering a device from GCM), they state \"It is only unregistered when the GCM server tries to send a message to the device and the device answers that the application is uninstalled or it does not have a broadcast receiver configured to receive com.google.android.c2dm.intent.RECEIVE intents. At that point, you server should mark the device as unregistered (the server will receive a NotRegistered error).\"</p>\n\n<p>Within PushSharp for Mono for Android; how do you get the Google Response when trying to send a message to the user and instead you receive a \"NotRegistered error\" from Google? To send a message, I have this code:</p>\n\n<pre><code>    var push = new PushService();\n\n    // setup channel settings: sender id, access key, registration package name\n    var settings = new GcmPushChannelSettings(&lt;&gt;, &lt;&gt;, &lt;PACKAGE&gt;);\n    push.StartGoogleCloudMessagingPushService(settings);\n    var android = NotificationFactory.AndroidGcm();\n    android = android.ForDeviceRegistrationId(GCM_Id); \n        push.QueueNotification(android.WithJson(\"{\\\"alert\\\":\\\"\" + message + \"\\\",\\\"URL\\\":\\\"\" + URL + \"\\\"}\")); \n</code></pre>\n\n<p>How do I get the response from Google to know if 1. the message went through 2. the app was uninstalled or 3. getting the NotRegistered error so that I may remove the GCM Id from the users account?</p>\n\n<p>Looking forward to any help I can get for this. The code above uses PushSharp for Mono for Android (MonoDroid) and it works flawlessly in sending a message to the user. <a href=\"https://github.com/Redth/PushSharp/\" rel=\"nofollow\">PushSharp</a> is amazing and I strongly recommend it for sending messages to your user via GCM.</p>\n"},{"tags":["c#",".net","generics","resharper","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13297689,"title":"Passing both List and Array as argument of IEnumerable","body":"<p>I want to make a method that can accept both <code>List&lt;byte&gt;</code> and array of bytes as argument (as Resharper suggested):</p>\n\n<pre><code>public static UInt16 GetSourceAddress(IEnumerable&lt;byte&gt; packet)\n{\n    return BitConverter.ToUInt16(new[] {packet[4], packet[5]}, 0);\n}\n</code></pre>\n\n<p>Bute I get the follwing compilation error:</p>\n\n<pre><code>Cannot apply indexing with [] to an expression of type 'System.Collections.Generic.IEnumerable&lt;byte&gt;'\n</code></pre>\n\n<p>I know I can just go ahead with two overloads with List and byte[], but what does this problem indicates? How to resolve it?</p>\n"},{"tags":["c#",".net","c#-4.0","task-parallel-library"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13240024,"title":"Long running Process using Task objects and a Monitor Thread","body":"<p>I am attempting to monitor a long running process. Right now the process created new Task objects for all the small pieces, but I need some way to monitor their progress to send status to a UI.</p>\n\n<pre><code>ExecutionContext ctx = new ExecutionContext()\n        {\n            Result = result,\n            LastCount = result.Values.Count\n        };\n\n        Task t = Task.Factory.StartNew(() =&gt;\n            {\n                foreach (var dataSlice in dataObjects)\n                {\n                   Task.Factory.StartNew(() =&gt;\n                   {\n                       // Do Some Work\n                   }, TaskCreationOptions.AttachedToParent);\n                }\n            });\n\n        ctx.ParentTask = t;\n\n\n        Task monitor = Task.Factory.StartNew( () =&gt;\n            {\n                ctx.LastCount = ctx.Result.Values.Count;\n\n            }, TaskCreationOptions.LongRunning);\n</code></pre>\n\n<p>My problem, or perhaps question is, if I force my monitor task to wait (via a SpinWait or Sleep) will it possibly lock part of the Tasks created above it? I need the monitor to check status every now and then, but I don't want it's wait condition to kill another task that needs to run.</p>\n\n<p>EDIT:</p>\n\n<p>So I found an interesting approach that's very similar to what Hans suggested in the comments below. It comes in two pieces. One Task to happen multiple times in the middle, and one completion task to do the final clean-up. Still in testing, but it looks promising.</p>\n\n<p>Here's what it looks like:</p>\n\n<pre><code>            Task t = new Task(() =&gt;\n            {\n                int i = 0;\n                for (int j = 0; j &lt; 200; j++)\n                {\n\n                    foreach (var session in sessions)\n                    {\n                        Task work = action.Invoke(SomeParameter);\n                        if (i == 50 || i == 0)\n                        {\n                            work.ContinueWith(task =&gt; Task.Factory.StartNew(UpdateAction));\n                            i = 1;\n                        }\n                        else\n                        {\n                            i++;\n                        }\n                    }\n                }\n            });\n\n        ctx.ParentTask = t;\n\n        t.ContinueWith(CompletionAction =&gt; Task.Factory.StartNew(() =&gt; CompleteExecution(SomeParameter)));\n\n        t.Start();\n</code></pre>\n"},{"tags":["c#",".net","data-binding","infopath"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3194,"score":0,"question_id":1214530,"title":"Dynamically populate an InfoPath DropownList with managed code","body":"<p>I have an InfoPath form with custom C# code, and a Sharepoint list.  I have a dropdownlist in the InfoPath form that I want to populate with a certain field from the Sharepoint list (I want the InfoPath dropdownlist to contain this field's value from every item in the Sharepoint list.  I can successfully get the list of values I need from Sharepoint in my managed code, but I do not see how I can get these values into the dropdownlist (either bind to the list, or add each item in the list one by one).  I thought I could modify the XML of the dropdownlist to insert my items, but the XML only contains the first item in the dropdownlist:  </p>\n\n<pre><code> &lt;my:RelatedRiskID xmlns:my=\"http://schemas.microsoft.com/office/infopath/2003/myXSD/2009-07-20T18:12:59\"&gt;Option 1&lt;/my:RelatedRiskID&gt;\n</code></pre>\n\n<p>I feel like this should be possible, but I can't find any resources on how to do it.  Thanks in advance for the help.</p>\n\n<ul>\n<li>Jared</li>\n</ul>\n"},{"tags":["c#","asp.net-mvc","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13297143,"title":"Caching Objects with Expensive Build & Allowing Updates","body":"<p>I am working on a caching manager for a MVC web application.  For this app, I have some very large objects that are costly to build.  During the application lifetime, I may need to create several of these objects, based upon user requests.  When built, the user will be working with the data in the objects, resulting in many read actions.  On occasion, I will need to update some minor data points in the cached object (create &amp; replace would take too much time).  </p>\n\n<p>Below is a cache manager class that I have created to help me in this.  Beyond basic thread safety, my goals were to:</p>\n\n<ol>\n<li>Allow multiple reads against the object, but lock all reads upon an\nupdate request </li>\n<li>Ensure that the object is only ever created 1 time if\nit does not already exist (keep in mind that its a long build\naction).</li>\n<li><p>Allow the cache to store many object, and maintain a lock\nper object (rather than one lock for all objects)</p>\n\n<pre><code>public class CacheManager \n{\n    private static readonly ObjectCache Cache = MemoryCache.Default;\n    private static readonly ConcurrentDictionary&lt;string, ReaderWriterLockSlim&gt;\n         Locks = new ConcurrentDictionary&lt;string, ReaderWriterLockSlim&gt;();\n    private const int CacheLengthInHours = 1;\n\n    public object AddOrGetExisting(string key, Func&lt;object&gt; factoryMethod)\n    {\n        Locks.GetOrAdd(key, new ReaderWriterLockSlim());\n\n        var policy = new CacheItemPolicy \n          { \n             AbsoluteExpiration = DateTimeOffset.Now.AddHours(CacheLengthInHours)\n          };\n        return Cache.AddOrGetExisting\n            (key, new Lazy&lt;object&gt;(factoryMethod), policy);\n    }\n\n    public object Get(string key)\n    {\n        var targetLock = AcquireLockObject(key);\n        if (targetLock != null)\n        {\n            targetLock.EnterReadLock();\n\n            try\n            {\n                var cacheItem = Cache.GetCacheItem(key);\n                if(cacheItem!= null)\n                    return cacheItem.Value;\n            }\n            finally \n            {\n                targetLock.ExitReadLock();\n            }\n        }\n\n        return null;\n    }\n\n    public void Update&lt;T&gt;(string key, Func&lt;T, object&gt; updateMethod)\n    {\n        var targetLock = AcquireLockObject(key);\n        var targetItem = (Lazy&lt;object&gt;) Get(key);\n\n        if (targetLock == null || key == null) return;\n        targetLock.EnterWriteLock();\n\n        try\n        {\n            updateMethod((T)targetItem.Value);\n        }\n        finally\n        {\n            targetLock.ExitWriteLock();\n        }\n    }\n\n    private ReaderWriterLockSlim AcquireLockObject(string key)\n    {\n        return Locks.ContainsKey(key) ? Locks[key] : null;\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>Am I accomplishing my goals while remaining thread safe?  Do you all see a better way to achieve my goals?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","oracle","sqlcommand"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13235392,"title":"Optional sql command parameters with Oracle Client","body":"<p>I'm trying to feed sqlcommand with more parameters than it uses. Because of that I'm getting exception ORA 01036. The description leads me to a fact that I can only pass parameters that will actually be used in the query.</p>\n\n<p>I cannot find it anywhere - is it really true? It seems pretty stupid and limited to me...</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":24,"score":-5,"question_id":13297621,"title":"C# and microsoft acces","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13297313/c-sharp-and-microsoft-access\">C# and Microsoft Access</a>  </p>\n</blockquote>\n\n\n\n<p>I have an excaption (OleDbException was unhundled)   Syntax error in query.İ will adding a new data to my databease table which table is I selected from combobox3. Please help please. </p>\n\n<pre><code>komutyaz = new OleDbCommand(\"insert into '\" + comboBox3.Items[comboBox3.SelectedIndex].ToString() + \"' (tc) values('\" + textBox1.Text + \"')\", baglankayıt);\n</code></pre>\n"},{"tags":["c#","javascript","jquery","client-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13297064,"title":"Open page in a new tab from C#","body":"<p>Does anybody know how to open an URL in a new tab from C# code?\nI have tried with </p>\n\n<pre><code>Response.Write(\"&lt;script type='text/javascript'&gt;window.location.href('../Documents/doc.pdf','_blank'); &lt;/script&gt;\");\n\n\nResponse.Write(\"&lt;script type='text/javascript'&gt;window.open('../Documents/doc.pdf','_blank'); &lt;/script&gt;\");\n\nResponse.Write(\"$('#pageContent_Send').click();\");\n</code></pre>\n\n<p>with</p>\n\n<pre><code>$(\"#pageContent_Send\").click(function () {\n        window.open(\"../Documents/doc.pdf\");\n        return false;\n    });\n</code></pre>\n\n<p>and it did not work, using \"window.open\" I get an \"Pop-up Blocker\" browser warning.</p>\n"},{"tags":["c#","asp.net","iframe","contentplaceholder"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":7939,"score":3,"question_id":5015070,"title":"Using iFrames In ASP.NET","body":"<p>I have an asp.net website with a master-page, can I use the iframe so my aspx pages will load inside the iframes. (Meaning it wont load the master-page)</p>\n\n<p>Kinda like my iframe will be the contentplaceholder or maybe the contentplaceholder will be inside it?</p>\n\n<p>Any Ideas?</p>\n"},{"tags":["c#","video","camera","aforge"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13297577,"title":"Aforge working with video card with multiple cameras","body":"<p>I can get Aforge to work with an USB web cam, but I have a video card that can connect to multiple cameras. How to I get Aforge to work with the video card ?</p>\n\n<p>My issue is I could not get the videoinputdevice to set to a working video input.</p>\n\n<p>The code is like this:</p>\n\n<pre><code>void init(){\n    FilterInfoCollection videoCaptureDevice = new FilterInfoCollection(FilterCategory.VideoInputDevice);\n\n    VideoCaptureDevice finalVideo = new VideoCaptureDevice(videoCaptureDevice[0].MonikerString);\n\n    finalVideo.NewFrame += new NewFrameEventHandler(finalVideo_NewFrame);\n\n    finalVideo.Start();\n}\n\npublic void finalVideo_NewFrame(object sender, NewFrameEventArgs eventArgs)\n{\n    Bitmap temp = (Bitmap)eventArgs.Frame.Clone();\n    pictureBox1.Image = temp;\n\n}\n</code></pre>\n\n<p>I also tried: </p>\n\n<pre><code>finalVideo = new VideoCaptureDevice();\n        finalVideo.CrossbarVideoInput = VideoInput.Default;\n</code></pre>\n\n<p>and it did not work either.</p>\n\n<p>Any help is highly appreciated.</p>\n"},{"tags":["c#","operators"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13297454,"title":"How to write over an operator?","body":"<pre><code>class Test\n{\n    public int a { get; set; }\n    public int b { get; set; }\n\n    public Test(int a, int b)\n    {\n        this.a = a;\n        this.b = b;\n    }\n\n    public static int operator +(Test a)\n    {\n        int test = a.a*a.b;\n        return test;\n    }\n\n    public void Testa()\n    {\n        Test t = new Test(5, 5);\n        Console.WriteLine((t.a + t.b));\n    }\n}\n</code></pre>\n\n<p>When I call the Testa() method I want the result to be 5*5, but I'm not sure how to use this method above were I write over the + operator</p>\n"},{"tags":["c#","json","json.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13287086,"title":"Using [JsonProperty] to match Json parameters to C# class properties which are type List","body":"<p>I'm trying to deserialize the following Json response (using Json.NET):</p>\n\n<pre><code>[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Yes\", \"1\":\"No\"} … ]\n</code></pre>\n\n<p>Into objects of this type:</p>\n\n<pre><code>    class Poll\n    {\n        [JsonProperty(\"pollid\")]\n        public int pollid { get; set; }\n        [JsonProperty(\"question\")]\n        public string question { get; set; }\n        [JsonProperty(\"start\")]\n        public DateTime start { get; set; }\n        [JsonProperty(\"end\")]\n        public DateTime end { get; set; }\n        [JsonProperty(\"category\")]\n        public string category { get; set; }\n\n        // PROBLEM AREA\n        [JsonProperty(\"0\")] // Json parameter names are 0 to 9. How can I 'match' these to the List elements?\n        public List&lt;string&gt; polloptions { get; set; }\n    }\n</code></pre>\n\n<p>How would I use the <code>[JsonProperty]</code> attribute when creating a List? (Assuming the Json parameter names to be contained in this List are \"0\" to \"9\"). I've spent the last few hours trying different methods without any luck.</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","xml","inheritance","serialization","xml-serialization"],"answer_count":9,"favorite_count":26,"up_vote_count":49,"down_vote_count":0,"view_count":21702,"score":49,"question_id":20084,"title":"XML Serialization and Inherited Types","body":"<p>following on from my <a href=\"http://stackoverflow.com/questions/19454/enforce-attribute-decoration-of-classesmethods\">previous question</a> I have been working on getting my object model to serialize to XML. But I have now run into a problem (quelle surprise!).</p>\n\n<p>The problem I have is that I have a collection, which is of a abstract base class type, which is populated by the concrete derived types.</p>\n\n<p>I thought it would be fine to just add the XML attributes to all of the classes involved and everything would be peachy. Sadly, thats not the case!</p>\n\n<p>So I have done some digging on Google and I now understand <em>why</em> it's not working.. In that <strong>the <em>XmlSerializer</em> is in fact doing some clever reflection in order to serialize objects to/from XML, and since its based on the abstract type, it cannot figure out what the hell it's talking to</strong>. Fine.</p>\n\n<p>I did come across <a href=\"http://www.codeproject.com/KB/XML/xmlserializerforunknown.aspx\">this page</a> on CodeProject, which looks like it may well help a lot (yet to read/consume fully), but I thought I would like to bring this problem to the StackOverflow table too, to see if you have any neat hacks/tricks in order to get this up and running in the quickest/lightest way possible :)</p>\n\n<p>There seems to be a lot of  \"Animal/Mammal\", \"Car/Bike/Truck\" examples but not a lot of fresh ideas!</p>\n\n<p>Thanks a lot people :)</p>\n\n<h3>EDIT:</h3>\n\n<p>One thing I should also add is that I <strong>DO NOT</strong> want to go down the <em>XmlInclude</em> route.. There is simply too much coupling with it, and this area of the system is under heavy development, so the it would be a real maintenence headache!</p>\n"},{"tags":["c#","winforms","forms","instances"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":13296891,"title":"Sending information to a textbox from a class to a form","body":"<p>I asked a question a couple of days ago about populating a listbox on a form from a class. It works and was great! However I now want to do the same with a textbox or a label. The answer from that question is below:</p>\n\n<blockquote>\n  <p>What you are doing is creating a new instance of the form - I presume\n  you are trying to add items in a listbox on an existing form?</p>\n  \n  <p>If so do this.</p>\n  \n  <p>Create a function on the form with the listbox like:</p>\n\n<pre><code>    public void addItemToListBox(string item)\n    {\n         listBox1.Items.Add(item);\n    }\n</code></pre>\n  \n  <p>Then, in the class (remember to add the using System.Windows.Forms\n  reference)</p>\n\n<pre><code>   public void doStuff()\n    {\n //Change Form1 to whatever your form is called\n foreach (Form frm in Application.OpenForms)\n {\n      if (frm.GetType() == typeof(Form1))\n      {\n           Form1 frmTemp = (Form1)frm;\n           frmTemp.addItemToListBox(\"blah\");\n\n      }\n }\n    }\n</code></pre>\n</blockquote>\n\n<p>This works well. Now I want to do the same with a textbox. I was wondering if someone could explain or if someone has a link on this? </p>\n\n<p>I have a form and a class. The form makes a new instance of the class and initiates a method in the class, say a maths equation 4+4; I want the answer, \"8\" to then be shown in a textbox or label on form1, from the method in the class. </p>\n"},{"tags":["c#","c#-4.0","xna","xna-4.0","game-engine"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13297457,"title":"FBX Model not displaying properly in XNA 4.0","body":"<p>I have a problem that XNA 4.0 is not displaying a 3D FBX model correctly.</p>\n\n<p>A friend created a model and when I open this in FBX Viewer it displays it correctly\n<a href=\"https://docs.google.com/open?id=0B54ow8GRluDUYTBubTQ4bjBramM\" rel=\"nofollow\">https://docs.google.com/open?id=0B54ow8GRluDUYTBubTQ4bjBramM</a></p>\n\n<p>But when I load it into XNA and click run, it displays as\n<a href=\"https://docs.google.com/open?id=0B54ow8GRluDUSE14TWMxcnBJWWc\" rel=\"nofollow\">https://docs.google.com/open?id=0B54ow8GRluDUSE14TWMxcnBJWWc</a></p>\n\n<pre><code>The code that i have for the drawing is\nforeach (ModelMesh mesh in model.Meshes)\n{\n    foreach (BasicEffect effect in mesh.Effects)\n    {\n         effect.Projection = projection;\n         effect.View = view;\n         effect.World = Matrix.CreateScale(1.0f) * Matrix.CreateRotationX(90) * Matrix.CreateTranslation(position);\n         effect.EnableDefaultLighting();\n     }\n     mesh.Draw();\n }\n</code></pre>\n\n<p>Any help to fix this will be very much appreciated.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","c++","str-replace","trim"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":59,"score":-7,"question_id":13297292,"title":"What are Trim() and strrepl() in C++ how can I use them in C#?","body":"<p>I am porting an old C++ code to C# environment. </p>\n\n<p>I came accross 2 functions trim() and strrepl().</p>\n\n<p>When I research them I dont find a lot of info. </p>\n\n<p>What are the equivalent in C# ? and how can I implement them?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13297119,"title":"C# Update DataGridView after SubmitChanges()","body":"<p>I've got this piece of code to update dataGridView after adding an Item. </p>\n\n<pre><code>dbContext.Item.InsertOnSubmit(new Item());\ndbContext.SubmitChanges();\ndataGridView1.DataSource = null;\ndataGridView1.DataSource = dbContext.Item;\n</code></pre>\n\n<p>It's a great mystery to me why nothing happens when I'm trying to use it more than once...</p>\n"},{"tags":["c#",".net","excel"],"answer_count":34,"favorite_count":239,"up_vote_count":341,"down_vote_count":2,"view_count":257512,"score":339,"question_id":151005,"title":"Create Excel (.XLS and .XLSX) file from C#","body":"<p>What is the best tool for creating an Excel Spreadsheet with C#?</p>\n\n<p>Ideally, I would like open source so I don't have to add any third party dependencies to my code, and I would like to avoid using Excel directly to create the file (using OLE Automation.)  </p>\n\n<p>The .CSV file solution is easy, and is the current way I am handling this, but I would like to control the output formats.</p>\n\n<hr>\n\n<p>EDIT:  I am still looking at these to see the best alternative for my solution.  Interop will work, but it requires Excel to be on the machine you are using.  Also the OLEDB method is intriguing, but may not yield much more than what I can achieve with CSV files.   I will look more into the 2003 xml format, but that also puts a > Excel 2003 requirement on the file.  </p>\n\n<p>I am currently looking at a port of the PEAR (PHP library) Excel Writer that will allow some pretty good XLS data and formatting and it is in the Excel_97 compatible format that all modern versions of Excel support.  The PEAR Excel Writer is here:  <a href=\"http://pear.php.net/package/Spreadsheet_Excel_Writer\" rel=\"nofollow\">PEAR - Excel Writer</a></p>\n"},{"tags":["c#","winforms","progress-bar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13293944,"title":"Progress bar form not fully loading","body":"<p>I'm writing a program that can take quite a bit to load(5-30 seconds).  I'm wanting to have a form that starts with a marquee style progress bar, so that the user knows there's something being done.</p>\n\n<pre><code>public FrmMain()\n{\n     var loading = new FrmLoading();\n     loading.Show();\n\n     InitializeComponent();\n\n     // other start up code here\n\n     loading.Close()\n}\n</code></pre>\n\n<p>Now, <code>loading</code> pops up just fine.  The problem is that the label and the progress bar show as nothing, and it almost looks like they are crashing.  I've looked into the <code>BackgroundWorker</code>, but, honestly, I don't fully comprehend how to make that work for me.  I tried to follow the tutorials and examples at:</p>\n\n<ul>\n<li><a href=\"http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/\" rel=\"nofollow\">BackgroundWorker Basics in C#</a></li>\n<li><a href=\"http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/\" rel=\"nofollow\">C# BackgroundWorker</a></li>\n<li><a href=\"http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/\" rel=\"nofollow\">ProgressBar</a></li>\n<li><a href=\"http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/\" rel=\"nofollow\">BackgroundWorker Class</a></li>\n</ul>\n\n<p>But my head just isn't grasping it.  Is there any other way to get the form to load properly?  Thanks for any and all help.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>My <code>BackgroundWorker</code> attempt included me creating a function which performed all the actions that were done in my <code>FrmMain</code>.  So, I had:</p>\n\n<pre><code>public FrmMain()\n{\n    Loading = new FrmLoading();\n    Loading.Show();\n\n    backgroundWorker1.RunWorkerAsync();\n}\n\nprivate void FormLoading()\n{\n     // Initialize and loading elements of the form\n     InitializeComponent();\n}\nprivate void BackgroundWorker1DoWork(object sender, DoWorkEventArgs e)\n{\n    FormLoading();\n}\n\nprivate void BackgroundWorker1RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n{\n    Loading.Close();\n}\n</code></pre>\n\n<p>But I kept getting <code>NullReferenceException</code> on the <code>backgroundWorker1.RunWorkerAsync();</code></p>\n"},{"tags":["c#","asp.net-mvc","nhibernate","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13296892,"title":"Finding where an old NHibernate DLL is referenced","body":"<p>I'm working on a ASP.NET MVC C# project and I'm getting the following error when launching the web app:</p>\n\n<p>Could not load file or assembly 'NHibernate, Version=2.1.0.1001, Culture=neutral, PublicKeyToken=aa95f207798dfdb4' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)</p>\n\n<p>Based on the error and some googling it seems clear that there is something referencing a NHibernate dll version 2.1.0.1001.  However, our project is using NHibernate version 2.1.2.4000 (old, I know).  I've searched the entire solution for any references to that version of NHibernate and cannot find one.  I'm assuming that another DLL that we're using is referencing it, but I don't know the best place to start to figure out which.</p>\n\n<p>Am I on target with what the issue likely is?  Any (hopefully free) dependency tools that anyone can recommend?</p>\n"},{"tags":["c#","richtextbox","scaling","dpi"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":8,"score":3,"question_id":13297050,"title":"Adjust RichTextBox font size under High DPI setting","body":"<p>My C# application includes grids with both simple text boxes and richtext boxes.  Often the richtext boxes contain rich text copied and pasted from elsewhere, and often the rtf markup includes hardcoded font size (\\fsXX, XX in half points).  In most cases the rich text font size is the same or close to the simple text font size>  </p>\n\n<p>When the DPI scaling is set to anything other than the default 96 the rich text is distorted as follows:</p>\n\n<p>a) When the application is NOT set to be DPI aware the richtext is shown smaller than the simple text and is blurry.</p>\n\n<p>b) When the application is set to be DPI aware the rich text is larger than the simple text.</p>\n\n<p>Is there a means to allow or force the richtext to scale with the simple text, short of editing the markup directly?</p>\n"},{"tags":["c#","winforms","data-binding",".net-4.0","infragistics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13291413,"title":"Make List<List<string>> suitable for binding","body":"<p>I have a <code>List&lt;List&lt;string&gt;&gt;</code> where the outer list will be the rows for a grid and the inner list the column values.</p>\n\n<p>How can I wrap the <code>List&lt;List&lt;string&gt;&gt;</code> so it's a suitable DataSource for the grid, which accepts <code>IList</code> or <code>IBindingList</code>?</p>\n\n<p>Effectively I want it to be seen as a <code>List&lt;MyObject&gt;</code> with the <code>MyObject</code> class having exposing the strings as public properties for binding.</p>\n\n<p>I can't change the list and it can have a very big number of rows so copying the data wouldn't be ideal.</p>\n\n<p>A simple example of the difference is the following code with a <code>DataGridView</code> dropped on a <code>WinForm</code>:</p>\n\n<pre><code> public class SupplierEntry\n    {\n        public string SupplierCode\n        {\n            get\n            {\n                return \"SUPPLIERCODE\";\n            }\n        }\n\n        public string SupplierTitle\n        {\n            get\n            {\n                return \"SUPPLIERTITLE\";\n            }\n        }\n    }\n\n    private void Test()\n    {\n        List&lt;string&gt; supplierEntryString = new List&lt;string&gt;();\n        supplierEntryString.Add(\"SUPPLIERCODE\");\n        supplierEntryString.Add(\"SUPPLIERTITLE\");            \n\n        List&lt;List&lt;string&gt;&gt; supplierListStrings = new List&lt;List&lt;string&gt;&gt;();\n        supplierListStrings.Add(supplierEntryString);\n\n        List&lt;SupplierEntry&gt; supplierListObjects = new List&lt;SupplierEntry&gt;();\n\n        SupplierEntry supplierEntryObject = new SupplierEntry();\n        supplierListObjects.Add(supplierEntryObject);\n\n        //this can't handle the nested collections, instead showing a Capacity and Count column \n        dataGridView1.DataSource = supplierListStrings;\n\n        //this works giving you a supplier code and title column\n        //dataGridView1.DataSource = supplierListObjects;\n    }\n</code></pre>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":10,"view_count":42,"score":-10,"question_id":13297313,"title":"C# and Microsoft Access","body":"<p>I have an exception wen i run this command.i will adding a new data to my database table which table is i selected from combobox3</p>\n\n<pre><code>komutyaz = new OleDbCommand(\"insert into '\"+comboBox3.Items[comboBox3.SelectedIndex].ToString()+\"' (tc) values('\"+textBox1.Text+\"')\", baglankayıt);\n</code></pre>\n"},{"tags":["c#",".net","account"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13296129,"title":"Detect if application is running under system account?","body":"<p>I could probably use <code>Environment.UserName</code> and compare that to 'system' to see if it matches, but that seems hacky and I'm not sure how it would work in a non English environment. Any other suggestions on how to check if the current executable is running as the system account?</p>\n"},{"tags":["c#","encryption"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1190,"score":1,"question_id":775924,"title":"c# encryption and decryption","body":"<p>C# 2005 \nI am using a simple encrypt and descrypt for a IP address. The app on the remote server will encrypt the ip address and the client will decrypt it. However, when the client descrypts the IP I only get some of the IP address back. The rest is rubbish.\nBefore: 123.456.78.98\nAfter: fheh&amp;^G.78.98</p>\n\n<p>Many thanks,</p>\n\n<pre><code> /// Encrypt the SIP IP address in the remote server\n        private void encryptSIP_IP(string sip_ip)\n        {\n            TripleDESCryptoServiceProvider encrypt = new TripleDESCryptoServiceProvider();\n\n        /// Private key\n        byte[] key = { 0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 0};\n\n        encrypt.Key = key;\n        byte[] byteSIP = System.Text.Encoding.Default.GetBytes(sip_ip);\n\n            ICryptoTransform encryptor = encrypt.CreateEncryptor();\n             byte[] encrypted_sip = encryptor.TransformFinalBlock(byteSIP, 0, byteSIP.Length);\n\n\n\n/// This will decrypt in the client application\n        private void decryptSIP_IP(byte[] encrypted_sip)\n        {\n            TripleDESCryptoServiceProvider decrypt = new TripleDESCryptoServiceProvider();\n            /// Private key\n            byte[] key = { 0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 0 };\n            decrypt.Key = key;\n            ICryptoTransform decryptor = decrypt.CreateDecryptor();\n\n            byte[] original = decryptor.TransformFinalBlock(encrypted_sip, 0, encrypted_sip.Length);\n            string ip = System.Text.Encoding.Default.GetString(original);\n        }\n        }\n</code></pre>\n"},{"tags":["c#","sql-server","entity-framework","entity-framework-5","ef-migrations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13296996,"title":"Entity Framework Migrations renaming tables and columns","body":"<p>I renamed a a couple entities and their navigation properties and generated a new Migration in EF 5. As is usual with renames in EF migrations, by default it was going to drop objects and recreate them. That isn't what I wanted so I pretty much had to build the migration file from scratch.</p>\n\n<pre><code>    public override void Up()\n    {\n        DropForeignKey(\"dbo.ReportSectionGroups\", \"Report_Id\", \"dbo.Reports\");\n        DropForeignKey(\"dbo.ReportSections\", \"Group_Id\", \"dbo.ReportSectionGroups\");\n        DropForeignKey(\"dbo.Editables\", \"Section_Id\", \"dbo.ReportSections\");\n        DropIndex(\"dbo.ReportSectionGroups\", new[] { \"Report_Id\" });\n        DropIndex(\"dbo.ReportSections\", new[] { \"Group_Id\" });\n        DropIndex(\"dbo.Editables\", new[] { \"Section_Id\" });\n\n        RenameTable(\"dbo.ReportSections\", \"dbo.ReportPages\");\n        RenameTable(\"dbo.ReportSectionGroups\", \"dbo.ReportSections\");\n        RenameColumn(\"dbo.ReportPages\", \"Group_Id\", \"Section_Id\");\n\n        AddForeignKey(\"dbo.ReportSections\", \"Report_Id\", \"dbo.Reports\", \"Id\");\n        AddForeignKey(\"dbo.ReportPages\", \"Section_Id\", \"dbo.ReportSections\", \"Id\");\n        AddForeignKey(\"dbo.Editables\", \"Page_Id\", \"dbo.ReportPages\", \"Id\");\n        CreateIndex(\"dbo.ReportSections\", \"Report_Id\");\n        CreateIndex(\"dbo.ReportPages\", \"Section_Id\");\n        CreateIndex(\"dbo.Editables\", \"Page_Id\");\n    }\n\n    public override void Down()\n    {\n        DropIndex(\"dbo.Editables\", \"Page_Id\");\n        DropIndex(\"dbo.ReportPages\", \"Section_Id\");\n        DropIndex(\"dbo.ReportSections\", \"Report_Id\");\n        DropForeignKey(\"dbo.Editables\", \"Page_Id\", \"dbo.ReportPages\");\n        DropForeignKey(\"dbo.ReportPages\", \"Section_Id\", \"dbo.ReportSections\");\n        DropForeignKey(\"dbo.ReportSections\", \"Report_Id\", \"dbo.Reports\");\n\n        RenameColumn(\"dbo.ReportPages\", \"Section_Id\", \"Group_Id\");\n        RenameTable(\"dbo.ReportSections\", \"dbo.ReportSectionGroups\");\n        RenameTable(\"dbo.ReportPages\", \"dbo.ReportSections\");\n\n        CreateIndex(\"dbo.Editables\", \"Section_Id\");\n        CreateIndex(\"dbo.ReportSections\", \"Group_Id\");\n        CreateIndex(\"dbo.ReportSectionGroups\", \"Report_Id\");\n        AddForeignKey(\"dbo.Editables\", \"Section_Id\", \"dbo.ReportSections\", \"Id\");\n        AddForeignKey(\"dbo.ReportSections\", \"Group_Id\", \"dbo.ReportSectionGroups\", \"Id\");\n        AddForeignKey(\"dbo.ReportSectionGroups\", \"Report_Id\", \"dbo.Reports\", \"Id\");\n    }\n</code></pre>\n\n<p>All I'm trying to do is rename <code>dbo.ReportSections</code> to <code>dbo.ReportPages</code> and then <code>dbo.ReportSectionGroups</code> to <code>dbo.ReportSections</code>. Then I need to rename the foreign key column on <code>dbo.ReportPages</code> from <code>Group_Id</code> to <code>Section_Id</code>.</p>\n\n<p>I am dropping the foreign keys and indexes linking the tables together, then I am renaming the tables and the foreign key column, then I'm adding the indexes and foreign keys again. I assumed this was going to work but I am getting a SQL error.</p>\n\n<blockquote>\n  <p>Msg 15248, Level 11, State 1, Procedure sp_rename, Line 215\n  Either the parameter @objname is ambiguous or the claimed @objtype (COLUMN) is wrong.\n  Msg 4902, Level 16, State 1, Line 10\n  Cannot find the object \"dbo.ReportSections\" because it does not exist or you do not have permissions.</p>\n</blockquote>\n\n<p>I'm not having an easy time figuring out what is wrong here. Any insight would be tremendously helpful.</p>\n"},{"tags":["c#","arrays","parent-child"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13297166,"title":"What happens when an array of base objects gets an instance of child objects as one of its cells?","body":"<p>I have an array of <code>Tiles[w,h]</code> and by mistake I could (without any obvious errors, so I guess this is okay to do) assign a child object <code>LibraryTile</code> to one of its cells. It shows up as LibraryTile in intellisense hover popup.</p>\n\n<p>I'm not sure if it will not bring any undesired effects, like increased memory consumption (it's a memberwise copy, not a reference), so I don't know if I should change my methods or if it is fine to leave them as is.</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","drag-and-drop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":18,"score":1,"question_id":13294955,"title":"Compare win-from control positions when dragging","body":"<p>I have a small program that contains one button called <code>button1</code>and one panel called <code>panel1</code>which has a color green. So far the program allows you to drag <code>button1</code> around the form. I am trying to expand this program so when <code>button1</code> is dropped on panel the panel will change color to red.</p>\n\n<p>The form:</p>\n\n<p><img src=\"http://i.stack.imgur.com/IPb0G.png\" alt=\"enter image description here\"></p>\n\n<p>The code so far:</p>\n\n<pre><code>System.Drawing.Point OldPosition; \n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_MouseDown(object sender, MouseEventArgs e)\n        {\n            //Only prepare if the button click down is the left button  \n            if (e.Button == MouseButtons.Left)\n            {\n                //Store the current mouse location  \n                OldPosition = e.Location;\n                //Change the mouse cursor if you want  \n                button1.Cursor = Cursors.Hand;\n            }  \n\n        }\n\n        private void button1_MouseMove(object sender, MouseEventArgs e)\n        {\n            //Only move if the left button still down  \n            if (e.Button == MouseButtons.Left)\n            {\n                button1.Location = new Point(button1.Location.X + (e.X - OldPosition.X), button1.Location.Y + (e.Y - OldPosition.Y));\n            } \n\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            panel1.BackColor = Color.Green;\n\n\n        }\n\n        private void panel1_MouseEnter(object sender, EventArgs e)\n        {\n            if (button1.Location == panel1.Location)\n\n                panel1.BackColor = Color.Red; //im not sure how to do this part\n\n        }\n</code></pre>\n"},{"tags":["c#",".net","assemblyresolve"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13296327,"title":"does .NET assemblyResolve event handler do version validation","body":"<p>I've some applications that rely on some shared components. I am moving these shared assemblies outside of application local directory to a shared directory. My goal is that each time a new version of shared assembly is released, I only have to place new version inside shared directory and do not have to change anything in my applications. I think assemblyResolve event is a good solution for this. I've a specific question to ask on the way the handler works. </p>\n\n<p>Suppose I attach this handler to resolve missing assemblies from a shared directory. I use just the assembly name to find the corresponding dll in the directory and load it using Assembly.LoadFrom(dllpath). </p>\n\n<p>My application references assembly: name:A,version:1.0,publickey:...\nThe assembly is upgraded to version:2.0\nI place the new assembly in the shared directory.</p>\n\n<p>Will the application pick up the new version properly? Does C# do any matching after the new assembly is loaded and returned from the handler? </p>\n\n<p>From my tests, it works fine. .NET ignores the version when registering the assembly returned from handler. I just want to make sure I am not wrong and there are no caveats</p>\n\n<p>thanks</p>\n"},{"tags":["c#","webbrowser-control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13296925,"title":"Find URL Responses? Alternative To Default WebBrowser Control?","body":"<p>Hello guys I have an issue bugging me for the past few weeks.</p>\n\n<p>What I'm trying to accomplish: I need a webbrowser control with the ability to change user agent (once at start) and referrer. But most important The ability to see the urls responses. What I mean by that for example if you navigate to a website you get back Images/Javascripts files/Dyanmic URLS in response I need access to those urls which some of them have dynamic variables (Regular Webbrowser Control will not show you those &amp; you can't access it in any way beside using fiddler core).</p>\n\n<p>I was able to do that with webbrowser + fiddlercore I can see and do what ever with those urls addresses. The problem was if you run few instances of this program (or sometimes once if the program has some automation to work with the url responses) It gets stuck or doesn't work. I tried fixing it and making it work but it's kind of a hacky solution that doesn't work right. I need a simple way to access those urls just as if you used httpwebrequest but as a webbrowser. Why I need it as a webbrowser? The way I work I need the execution of all the tracking pixels and scripts and images etc.. a normal webbrowser behaivor in httpwebrequest you can't just navigate and all the scripts will be execute as webbrowser, or can you?</p>\n"},{"tags":["c#","c#-3.0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13279362,"title":"How to stop the execution of a method after a specific time?","body":"<p>I need to stop the execution of a method if it has not completed within a limited period of time.</p>\n\n<p>To do this work I can use the <code>Thread.Abort</code> method in this way:</p>\n\n<pre><code>void RunWithTimeout(ThreadStart entryPoint, int timeout)\n{\n    var thread = new Thread(() =&gt;\n    {\n        try\n        {\n            entryPoint();\n        }\n        catch (ThreadAbortException)\n        {   }\n\n    }) { IsBackground = true };\n\n    thread.Start();\n\n    if (!thread.Join(timeout))\n        thread.Abort();\n}\n</code></pre>\n\n<p>Given that I'm using .NET 3.5, is there a better way?</p>\n\n<p>Edit: following the comments here my <code>entryPoint</code>, but I'm looking for a good way for any <code>entryPoint</code>.</p>\n\n<pre><code>void entryPoint()\n{\n   // I can't use ReceiveTimeout property\n   // there is not a ReceiveTimeout for the Compact Framework\n   socket.Receive(...);\n}\n</code></pre>\n"},{"tags":["c#","log4net","quartz.net-2.0","common.logging","log4net-configuration"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13277333,"title":"Quartz.Net - Common Logging with log4net","body":"<p>I'm trying to implement Quartz.Net. As long as there is no logging configured everything works (the debug output shows <em>\"no configuration section  found - suppressing logging output\"</em>).</p>\n\n<p>When logging is enabled I'll get the following error: <strong>Failed obtaining configuration for Common.Logging from configuration section 'common/logging'</strong>.</p>\n\n<p>Inner exeption: <strong>An error occurred creating the configuration section handler for common/logging: Unable to create type 'Common.Logging.Log4Net.Log4NetLoggerFactoryAdapter, Common.Logging.Log4net'</strong> </p>\n\n<p>I used several resources as <a href=\"http://netcommon.sourceforge.net/docs/1.2.0/reference/html/logging.html#logging-adapters-log4net\" rel=\"nofollow\">this one</a> to varify my configuration, but as far as I see it should be correct.</p>\n\n<p>My app.config:</p>\n\n<pre><code>  &lt;configSections&gt;\n    &lt;section name=\"quartz\" type=\"System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0,Culture=neutral, PublicKeyToken=b77a5c561934e089\" /&gt;\n    &lt;sectionGroup name=\"common\"&gt;\n      &lt;section name=\"logging\" type=\"Common.Logging.ConfigurationSectionHandler, Common.Logging\" /&gt;\n    &lt;/sectionGroup&gt;\n    &lt;section name=\"log4net\" type=\"log4net.Config.Log4NetConfigurationSectionHandler, log4net\" /&gt;\n  &lt;/configSections&gt;\n  &lt;common&gt;\n    &lt;logging&gt;\n      &lt;factoryAdapter type=\"Common.Logging.Log4Net.Log4NetLoggerFactoryAdapter, Common.Logging.Log4net\"&gt;\n        &lt;arg key=\"configType\" value=\"INLINE\" /&gt;\n      &lt;/factoryAdapter&gt;\n    &lt;/logging&gt;\n  &lt;/common&gt;  \n  &lt;log4net&gt;\n    &lt;appender name=\"ConsoleAppender\" type=\"log4net.Appender.ConsoleAppender\"&gt;\n      &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n        &lt;param name=\"ConversionPattern\" value=\"%-6p%d{yyyy-MM-dd hh:mm:ss} – %m%n\" /&gt;\n      &lt;/layout&gt;\n    &lt;/appender&gt;\n    &lt;root&gt;\n      &lt;level value=\"DEBUG\" /&gt;\n      &lt;appender-ref ref=\"ConsoleAppender\" /&gt;\n    &lt;/root&gt;\n  &lt;/log4net&gt;\n  &lt;quartz&gt;\n    &lt;add key=\"quartz.scheduler.instanceName\" value=\"Driver.Service.Scheduler\" /&gt;\n    &lt;add key=\"quartz.threadPool.type\" value=\"Quartz.Simpl.SimpleThreadPool, Quartz\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadCount\" value=\"10\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadPriority\" value=\"2\" /&gt;\n    &lt;add key=\"quartz.jobStore.misfireThreshold\" value=\"60000\" /&gt;\n    &lt;add key=\"quartz.jobStore.type\" value=\"Quartz.Simpl.RAMJobStore, Quartz\" /&gt;\n  &lt;/quartz&gt;\n</code></pre>\n\n<p>I referenced the following assemblies:<br>\nquartz.dll, version 2.01.100<br>\ncommon.logging.dll, version 2.0.0.0<br>\ncommon.logging.log4net.dll, version 2.0.0.0<br>\nlog4net.dll, version 1.2.10.0</p>\n\n<p>I cannot find a reason for the error given. All help is welcome, apparently I forget something...</p>\n"},{"tags":["c#","c++","windows","visual-studio-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13200181,"title":"C++ dll not found while C# dlls are all found(and works on my computer)","body":"<p>on a clean computer(no visual studio), I zipped up the Debug folder for someone else (which worked on my computer) and someone else tried to start the program and I got the error</p>\n\n<p>System.DllNotFoundException: Unable to load DLL 'HookHandler.dll': The specified module could not be found. (Exception from HRESULT: 0x8007007E)</p>\n\n<p>I then had him install \n<a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=8328\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=8328</a></p>\n\n<p>thinking that would help.  Any ideas why it is not finding the dll on his computer but finds it fine on my computer?</p>\n\n<p>EDIT: I should have noted HookHandler.dll sits in the same folder as the exe.  Again, it works on my computer when I run the exe and HookHandler is there in my folder.  I zip it up with HookHandler and gave it to someone else and it doesn't work and I verified HookHandler was there in his folder.</p>\n\n<p>For somereason, installing visual studio fixed the issue.  so it must be something HookHandler depends on so I need to try the ProcMon tool or depends.exe to see what HookHandler is depending on I guess.</p>\n\n<p>thanks,\nDean</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":11905153,"title":"Add a button inside chart control","body":"<p>I want a button that is placed inside the chart to export the graph to an excel file.\nI messed around with MapAreas but I couldn't figure out how to set the map area to an image or a control. Is there a different way to accomplish this feature? The button needs to be somehow attached to the graph.</p>\n"},{"tags":["c#","json.net","deserialization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13296824,"title":"Deserialize KeyValuePair<string, string> Json.Net","body":"<p>I need to deserialize a <code>string</code> like this</p>\n\n<pre>\n{\n  \"example\": {\n    \"id\": \"12345\",\n    \"name\": \"blabla\"\n  }\n}</pre>\n\n<p>into a <code>KeyValuePair&lt;string, string&gt;</code> or something similiar.</p>\n\n<p>I tried:</p>\n\n<pre><code>var pair = JsonConvert.DeserializeObject&lt;KeyValuePair&lt;string, string&gt;&gt;(d[\"example\"].ToString()); \n</code></pre>\n\n<p>(<code>d[\"example\"]</code> returns the json string like shown above)</p>\n\n<p>The result was an empty <code>KeyValuePair&lt;string, string&gt;</code>.</p>\n\n<p>Is there any way to solve this? </p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13296333,"title":"C# How to declare new Dictionary object based off a string array within a LINQ query","body":"<p>I have some code like this:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Xml.Linq;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string xml = @\"&lt;Root&gt;\n  &lt;Report1&gt;\n    &lt;Row&gt;\n      &lt;Field1&gt;data1-1&lt;/Field1&gt;\n      &lt;Field2&gt;data1-2&lt;/Field2&gt;\n      &lt;!-- many more fields --&gt;\n    &lt;/Row&gt;\n    &lt;Row&gt;\n      &lt;Field1&gt;data2-1&lt;/Field1&gt;\n      &lt;Field2&gt;data2-2&lt;/Field2&gt;\n      &lt;!-- many more fields --&gt;\n    &lt;/Row&gt;\n  &lt;/Report1&gt;\n&lt;/Root&gt;\";\n\n        XDocument doc = XDocument.Parse(xml);\n\n        var report1 = from report in doc.Root.Elements(\"Report1\").Elements(\"Row\")\n                      select new Dictionary&lt;string, string&gt;()\n                          {\n                              {\"Field1\", report.Elements(\"Field1\").First().Value},\n                              {\"Field2\", report.Elements(\"Field2\").First().Value}\n                          };\n\n        var i = 1;\n        foreach (Dictionary&lt;string, string&gt; dict in report1)\n        {\n            Console.WriteLine(String.Format(\"Row{0}: \", i));\n            Console.WriteLine(\"  Field1: {0}\", dict[\"Field1\"]);\n            Console.WriteLine(\"  Field2: {0}\", dict[\"Field2\"]);\n            i++;\n        }\n\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p>Would it be possible to define a string array or some other data structure that I could use to declare these dictionary objects? Here is some silly pseudo code help show my idea:</p>\n\n<p><strong>EDIT</strong> The variable fieldNames in the pseudo code below would be an array of names I expect, not based on the xml source field names. I will be ignoring any field names within the xml source that are not explicitly set in the fieldNames array.</p>\n\n<pre><code>var report1 = from report in doc.Root.Elements(\"Report1\").Elements(\"Row\")\n              select new Dictionary&lt;string, string&gt;()\n           {\n              foreach (var fieldName in fieldNames)\n              {\n                  {fieldName, report.Elements(fieldName).First().Value}\n              }\n           };\n</code></pre>\n"},{"tags":["c#","xna"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13273781,"title":"XNA-Moving rotated camera(view) relative to world","body":"<p>So I've been trying to get this to work but no luck so far, hopefully you can help. The thing is I have a camera in my project that the user can freely move with mouse and buttons. \nCurrently like so:\n<code>move = new Vector3(0, 0, -1) * moveSpeed;\n      move = new Vector3(0, 0, 1) * moveSpeed;\n...\n</code>\nAnd then I just add move vector to cameraPos vector: <code> cameraPos += move </code></p>\n\n<p>Then problem is if I rotate the camera and then try to move, for example down, it will not move straight down but in a certain angle. I am assuming this is due to moving on local axis. But what I want to do is to move on a world axis. Is something like that possible, or do I have to somehow calculate the angle and then move on more than one axis?</p>\n\n<p>Best regards!</p>\n\n<p>EDIT:\nI am rotating the camera where <code> cameraPos </code> is the current position of the camera and <code> rotation </code> is the current rotation of the camera. And this is the code to rotate the camera:</p>\n\n<pre><code>void Update()\n{\n    ...\n    if(pressed)\n    {\n        int newY = currentY - oldY;\n        pitch -= rotSpeed * newY;\n    }\n    Rotate();\n}\n\nvoid Rotate()\n{\n    rotation = Matrix.CreateRotationX(pitch);\n    Vector3 transformedReference = Vector3.Transform(cameraPos, rotation);\n    Vector3 lookAt = cameraPos + transformedReference;\n    view = Matrix.CreateLookAt(cameraPos, lookAt, Vector3.Up);\n\n    oldY = currentY;\n}\n</code></pre>\n\n<p>Ihope this is more readable.</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13295937,"title":"Preserving DropDownList settings","body":"<p>I have a webpage: <strong>Menu.aspx</strong>, where I have the following controls of relevance: </p>\n\n<ul>\n<li>a DropDownList with some values</li>\n<li>a button, which redirects me to a page called Edit.aspx.</li>\n</ul>\n\n<p>In my <strong>Edit.aspx</strong> page, I have a cancel button, which redirects the user back to the Menu page with the following C# method</p>\n\n<pre><code>protected void btnCancel_click(object sender, EventArgs e)\n{\n    Response.Redirect(\"Menu.aspx\");\n}\n</code></pre>\n\n<p>What I would like to do is when I redirect my user back to Menu.aspx, I preserve the value of the DropDownList that they selected.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT: Ideally, I want to achieve this without a QueryString (if Possible)</p>\n\n<p>EDIT2: I was thinking of something invovling a viewstate or postback but I'm unfamiliar with those.</p>\n"},{"tags":["c#","design-patterns","books"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":21,"score":-3,"question_id":13296846,"title":"book Mark Seemann \"Dependency Injection in .NET\" 2012 Manning Publications Co","body":"<p>What's you think about book \"Dependency Injection in .NET\"? \n( Mark Seemann \"Dependency Injection in .NET\" 2012 Manning Publications Co.)</p>\n\n<p>I want to buy it, I wonder if it's worth.</p>\n\n<p>Who has read this book?\nWho can it recommend?</p>\n"},{"tags":["c#","tridion","tridion-2011"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13295492,"title":"Tridion 2011: Changing a page's file name as it's being published","body":"<p>Good day!</p>\n\n<p>I allow my content editors to store CSS as very basic components (usually containing a single, multi-line field called \"code\" that they paste into), and these are then added as Component Presentations into a Page with a .css file extension. When creating the page, users are able to set a few configuration values: minify output (bool), file name prefix, and file name suffix. The intent of those last two is that if the user has selected to minify the CSS on its way out the door, the file name can be different sitting on the presentation server.</p>\n\n<p>I've got everything working except the modification of the file name. I don't want to change the file name in the CM; only as it resides out on the presentation server. I assume this can be done in a TBB placed into the CSS Page Template. I took a crack at it, but want to be sure that there's not something I'm missing. The following example is just the shorthand with some configurable values hard-coded for brevity.</p>\n\n<pre><code>// Create a reference to the Page object in the package.\nPage page = this.GetPage();\n\n// Retrieve a reference to the page's file name.\nstring currentFileName = Utilities.GetFilename(page.FileName);\n\n// Set the published file name on its way out the door.\npage.FileName = currentFileName + \"_min\";\n\n// ???\n// Profit.\n</code></pre>\n"},{"tags":["c#","regex","linqpad"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13295394,"title":"LINQPad Vs. .NET Regex Performance Mismatch","body":"<p>All, I have a series of SQL statements seperated in a <code>string</code> by 'GO' (case insensitive, so 'Go', 'go' et al. are also valid). If I have a statement like </p>\n\n<pre><code>string str = \"INSERT INTO People \\r\\n\" + \n                \"VALUES (3, 'Gandalf', 'The Gray'); \\r\\nGO\\r\\n\" + \n             \"INSERT INTO People \\r\\n\" + \n                \"VALUES (4, 'Legolas', 'Camus'); \\r\\nGO\";\n</code></pre>\n\n<p>I want to avoid a match on the 'go' in 'Legolas'. To do this I devised a regular expression in LINQPad with both <em>negative lookahead</em> and <em>positive lookbehind</em>, and have  </p>\n\n<pre><code>string str = \"INSERT INTO People \\r\\n\" + \n                \"VALUES (3, 'Gandalf', 'The Gray'); \\r\\nGO\\r\\n\" + \n             \"INSERT INTO People \\r\\n\" + \n                \"VALUES (4, 'Legolas', 'Camus'); \\r\\nGO\";\nRegex regGo = new Regex(@\"(?&lt;=\\b)(?i)GO(?!\\w+)\");\nMatchCollection matches = regGo.Matches(str);\nforeach (Match m in matches)\n{\n    m.Dump();\n}\n</code></pre>\n\n<p>Which does what I want, namely, it only matches a 'GO' (of any case) when it is a new 'GO' and not followed by anything. This works in LINQPad - i.e. returns the required result; but <strong>not</strong> in my C# app.</p>\n\n<p>Why the descrepancy and what am I doing wrong?</p>\n\n<p>Thanks for your time.</p>\n"}]}
{"total":375445,"page":2,"pagesize":100,"questions":[{"tags":["c#","windows","winforms","text-files"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13295866,"title":"program can't find file after install","body":"<p>i made a program that uses a pre-made text file that hold a list of sites.\nnow in some computer the program works fine but, in my friend computer it doesn't.</p>\n\n<p>i check the program on 2 of my windows 7 computers, and 1 xp and i don't have any errors.\nthis program was used for some time on XP, now my friend want to install it in his windows 7 computer at home, but the program doesn't find the file after he install the program.</p>\n\n<p>this is the error he get:</p>\n\n<pre><code>System.IO.FileNotFoundException: file not found 'C:\\Users\\eli\\AppData\\Roaming\\fourmlinks.txt'.\nfile name: 'C:\\Users\\eli\\AppData\\Roaming\\fourmlinks.txt'\n</code></pre>\n\n<p>the thing is that i ship the this file in main program folder (Application Files), and it still cant find it.</p>\n\n<p>this is the code i use to find the file when the program starts:</p>\n\n<pre><code>sring path = \"\";\npath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\fourmlinks.txt\";\n            System.OperatingSystem osInfo = System.Environment.OSVersion;\n            if (osInfo.Platform == PlatformID.Win32NT)\n            {\n                if (osInfo.Version.Major == 5 &amp;&amp; osInfo.Version.Minor != 0)\n                {\n                    //running XP\n                    //path = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + \"\\\\fourmlinks.txt\";\n                    path = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location) + \"\\\\fourmlinks.txt\";\n                }\n            } \n</code></pre>\n\n<p>you can see, that i tried to make sure it will work on windows 7 and, windows xp.</p>\n\n<p>NOTE:\ni don't mind changing the way i work with this file, or even loss this way and try completely different way that will work on the OS's (win 7 and XP). if u suggest me new way, i will be glad to give a try out.</p>\n\n<p>my questions:</p>\n\n<ol>\n<li>how is it possible that the program works in some computer and in some not?</li>\n<li>will you put the file in a different place other then the program folder?</li>\n</ol>\n\n<p>(sorry for my English)</p>\n"},{"tags":["c#","java","proxy","client-server","osb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13296785,"title":"How to call OSB Proxy from Java and C#","body":"<p>I need examples for both situation: how invoke OSB Proxy from Java Client and how invoke from C# Client. I am looking for simple examples and advanced best practices as well. </p>\n"},{"tags":["c#","c#-4.0","messaging","zeromq","pnrp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13292420,"title":"Brokerless Messaging C#","body":"<p>I have a number of WPF clients on the same corporate network. I want these clients to share messages with each other. I don't want to run a separate server process so a brokerless solution would seem best. I have considered using PNRP but this seems to require a PNRP service to be running on each client, I'm not sure I could guarantee all the clients would or could be running this. I have also had a look at ZeroMq which looks ideal it terms of simplicity and its very lightweight, however I would need to know the endpoints for a TCP/IP style communication and each client won't be aware of the others rather they need someway to discover each other. So essentially I want a multicast style of communication but without having to use multicast since this will require me to get a range of addresses set up within the corporate network and involve infrastructure etc. </p>\n\n<p>So I guess the question is are there any options I haven't considered that fit the bill?</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-web-api","custom-attributes","asp.net-mvc-migration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13296721,"title":"Using ExceptionFilterAttribute in upgraded MVC project","body":"<p>Is it possible to use ExceptionFilterAttribute in a project the was created with MVC2 and upgraded to MVC4?  It is not a Web API project, and I cannot seem to get the exception to catch using the ExceptionFilterAttribute.  Is there any way to make this happen or am I better off just sticking to inheriting from ActionFilterAttribute and implementing IExceptionFilter.  This is for an API section within our MVC project</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-4","jquery-ui-accordion"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13294611,"title":"MVC4 nested accordion with foreach loop","body":"<p>I'm trying to create a view using nested accordions and I'm not having much success so far.\nI need the top accordion to be a category that will list a name which is the second accordion.</p>\n\n<p>Another wrinkle in this is that I'm trying to use foreach to create a category accordion for each different category type, and then within that accordion, create an accordion for each name in the table.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>Historical(accordion)-&gt; museum(accordion)-&gt; description, state\n\nSports(accordion)-&gt;soccer(accordion)-&gt; description, state\n\n             -&gt;baseball(accordion)-&gt; description, state\n</code></pre>\n\n<p>Here is what I currently have but I'm not sure if this is the best way to go about it or not:</p>\n\n<pre><code>&lt;div id=\"accordioncat\"&gt;\n@foreach (var item in Model)\n{\n\n    &lt;h3&gt;@item.category&lt;/h3&gt;\n    &lt;div&gt;\n        &lt;h3&gt;@item.name&lt;/h3&gt;\n            &lt;div&gt;\n                &lt;p&gt;@item.description&lt;/p&gt;\n                &lt;p&gt;@item.state&lt;/p&gt;\n            &lt;/div&gt;\n     &lt;/div&gt;\n}\n\n&lt;/div&gt;\n</code></pre>\n\n<p>With my model I'm using an int for category to join it to category id in my category table, and same with state.\nHere is my model(this may need to be changed as well):</p>\n\n<pre><code>public class t_records\n{\n    [Key]\n    public int ID { get; set; }\n\n    [Display(Name=\"Name\")]\n    public string name { get; set; }\n\n    [Display(Name=\"Description\")]\n    public string description { get; set; }\n\n    public int state { get; set; }\n\n    public int category { get; set; }\n\n}\n</code></pre>\n"},{"tags":["c#","wpf","listview","data-binding","combobox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13296773,"title":"WPF ComboBox Slow After Context Changed","body":"<p>I have a control with a ListView and a set of controls to display properties of the selected item in the ListView.</p>\n\n<pre><code>&lt;ListView Name=\"ObjectList\" ItemsSource=\"{Binding Path=Objects}\" /&gt;\n</code></pre>\n\n<p>And then for the properties of the obects:</p>\n\n<pre><code>&lt;Grid Name=\"ObjectDetails\" DataContext=\"{Binding ElementName=ObjectList,   Path=SelectedItem}\"&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"110\" /&gt;\n        &lt;ColumnDefinition /&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition Height=\"35\" /&gt;\n        &lt;RowDefinition /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;Label Grid.Column=\"0\" Grid.Row=\"0\"&gt;Proerty 1&lt;/Label&gt;\n    &lt;ComboBox DataContext=\"{Binding Property1}\" Grid.Column=\"1\" Grid.Row=\"0\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItem}\" VerticalAlignment=\"Center\" HorizontalAlignment=\"Stretch\"/&gt;\n\n    &lt;Label Grid.Column=\"0\" Grid.Row=\"1\"&gt;Property 2&lt;/Label&gt;\n    &lt;ComboBox DataContext=\"{Binding Property2}\" Grid.Column=\"1\" Grid.Row=\"1\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItem}\" VerticalAlignment=\"Center\" HorizontalAlignment=\"Stretch\"/&gt;\n\n    [...more properties...]\n&lt;/Grid&gt;\n</code></pre>\n\n<p>When an item is added to the ListView and selected, the properties are displayed as expected, and the ComboBox expands immediately when clicked. After selecting a different item in the ListView the selections for all the ComboBox's are updated, but after clicking a ComboBox it takes around 5 seconds for it to expand. This delay happens for each ComboBox the first time it is clicked, but does not happen after subsequent clicks.</p>\n\n<p>Any suggestions as to what may be causing the delay?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net-mvc","unit-testing","asp.net-mvc-4","tdd"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":48,"score":1,"question_id":13296735,"title":"Ho to show value of TDD to a difficult Client","body":"<p>A client wants quality ASP.NET MVC 4 website but forces to cut corners to meet deadlines. In return the client is ready to compromise by talking out thing such as TDD and pair programming.</p>\n\n<p>I have already tried to make him aware on the quality going downwards. But it seems to be the least concern for the client.</p>\n\n<p>What things can I do to demonstrate how bad it will be if TDD is eliminated before the client starts eliminating other good practises for e.g DRY</p>\n"},{"tags":["c#","sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13296412,"title":"The update statement works in SSMS but not in code","body":"<p>I've been beating my head against the wall for 2 days now.  This update statement works when run in ssms</p>\n\n<pre><code>update dbo.DEMOGRAPHICS \nset ETHNICITY = (select distinct(ethnicity) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, GENDER = (select distinct(GENDER) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, MARITAL_STATUS = (select distinct(MARITAL_STATUS) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, RELIGION = (select distinct(RELIGION) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, VETERAN = (select distinct(VETERAN) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID =  'P000084716' and ACADEMIC_SESSION != '')\n, CITIZENSHIP = (select distinct(CITIZENSHIP) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716'and ACADEMIC_SESSION != '')\n,RETIRED = (select distinct(RETIRED) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '000084716' and ACADEMIC_SESSION != '')\n, LEGAL_RESIDENCE = (select distinct(LEGAL_RESIDENCE) from dbo.DEMOGRAPHICS where   PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\nwhere PEOPLE_CODE_ID = 'P000084716'  and ACADEMIC_SESSION = ''\n</code></pre>\n\n<p>but doing the update in the code doesn't</p>\n\n<pre><code>string updDemoRecords = @\"update dbo.DEMOGRAPHICS \nset ETHNICITY = (select distinct(ethnicity) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, GENDER = (select distinct(GENDER) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, MARITAL_STATUS = (select distinct(MARITAL_STATUS) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, RELIGION = (select distinct(RELIGION) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, VETERAN = (select distinct(VETERAN) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, CITIZENSHIP = (select distinct(CITIZENSHIP) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}'and ACADEMIC_SESSION != '')\n,RETIRED = (select distinct(RETIRED) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, LEGAL_RESIDENCE = (select distinct(LEGAL_RESIDENCE) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\nwhere PEOPLE_CODE_ID = '{0}'  and ACADEMIC_SESSION = ''\";\nupdDemoRecords = string.Format(updDemoRecords, peopleOrgCodeID);\npcCon = new SqlConnection(pcConnString);\nSqlCommand doUpdDemoRecords = new SqlCommand(updDemoRecords, pcCon);\npcCon.Open();\ndoUpdDemoRecords.ExecuteNonQuery();\npcCon.Close();\n</code></pre>\n\n<p>Tried it from a stored proc also and it doesn't update the relevant rows either.  It is sql server 2008 and c#.net</p>\n"},{"tags":["c#","generics"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2154,"score":1,"question_id":6451120,"title":"The type must be a reference type in order to use it as parameter 'T' in the generic type or method","body":"<p>I'm getting deeper into generics and now have a situation I need help with. I get a compile error on the 'Derived' class below as shown in the subject title. I see many other posts similar to this one but I'm not seeing the relationship. Can someone tell me how to resolve this?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\n\n\nnamespace Example\n{\n    public class ViewContext\n    {\n        ViewContext() { }\n    }\n\n    public interface IModel\n    {\n    }\n\n    public interface IView&lt;T&gt; where T : IModel \n    {\n        ViewContext ViewContext { get; set; }\n    }\n\n    public class SomeModel : IModel\n    {\n        public SomeModel() { }\n        public int ID { get; set; }\n    }\n\n    public class Base&lt;T&gt; where T : IModel\n    {\n\n        public Base(IView&lt;T&gt; view)\n        {\n        }\n    }\n\n    public class Derived&lt;SomeModel&gt; : Base&lt;SomeModel&gt; where SomeModel : IModel\n    {\n\n        public Derived(IView&lt;SomeModel&gt; view)\n            : base(view)\n        {\n            SomeModel m = (SomeModel)Activator.CreateInstance(typeof(SomeModel));\n            Service&lt;SomeModel&gt; s = new Service&lt;SomeModel&gt;();\n            s.Work(m);\n        }\n    }\n\n    public class Service&lt;SomeModel&gt; where SomeModel : IModel\n    {\n        public Service()\n        {\n        }\n\n        public void Work(SomeModel m)\n        {\n\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq-to-sql","windows-phone-7.1","datacontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13294817,"title":"DataContext SubmitChanges hook","body":"<p>I'm using LINQ to SQL to communicate with the database in a WP 7 app.</p>\n\n<p>Suppose there are 2 entities in my model: Checkpoint and Picture. Checkpoint has many pictures, and Picture belongs to a checkpoint. Very simple. Since DB size in Mango is restricted to 512 MB, I don't want to persist image bytes to the database (just metadata like title, creation date, etc). The raw bytes should be stored in Isolated Storage, instead.</p>\n\n<p>Is there a way to get notified when DataContext actually persists a Picture entity? That would allow me to trigger the code that would write image bytes to Isolated Storage.</p>\n\n<p>I built the entity classes myself and decorated them with mapping attributes. For example, here is the simplified definition of the Picture class.</p>\n\n<pre><code>    \n    [Table]\n    public class Picture\n    {\n        [Column]\n        public string Title { get; set; }\n    }\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","regex"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13296519,"title":"Regex with incomplete NMEA data","body":"<p>In the serial port data receive routine I may receive the following chunks of data (as far as I was able to determine):</p>\n\n<ul>\n<li>Complete 1 or many NMEA sentences</li>\n<li>Not even 1 complete NMEA sentence</li>\n<li>Incomplete sentences may be before and after complete sentence(s)</li>\n</ul>\n\n<p>I need to be able to capture complete sentence(s), incomplete sentence if they exist at the beginning and end.</p>\n\n<p>Regex for one complete NMEA sentence is</p>\n\n<pre><code> \\$.*\\*[0-9A-F]{2}\n</code></pre>\n\n<p>Example data, which represents 1 incomplete sentence on each end:</p>\n\n<pre><code>,23,04,13,01,,,,,,,1.78,1.51,0.94*07\n$GPGSV,4,1,13,23,70,010,18,20,63,152,33,13,50,294,24,39,39,208,*75\n$GPGSV,4,2,13,06,34,108,,30,34,070,13,32,34,133,13,07,27,221,35*75\n$GPGSV,4,3,13,04,27,294,23,10,13,312,,31,08,044,,01,07,187,14*77\n$GPGSV,4,4,13,02,01,330,*48\n$GPRMC,185959.400,A,4011.3487,N,04431.4365,E,0.56,176.00,081112,,,A*61\n$GPVTG,176.00,T,,M,0.56,N,1.03,K,A*3C\n$GPGGA,185959.600,4011.3487,N,04431.4365,E,1,6,1.51,1000.0,M,15.0,M,,*6F\n$GPGLL,4011.3487,N,04431.4365,E,185959.600,A,A*5C\n$GPGSA,A,3,20,07,23,04,13,01,,,,,,,1.78,1.51,0.94*07\n$GPGSV,4,1,13,23,7\n</code></pre>\n\n<p>Following string has no complete sentence at all, so it should give me both incomplete parts.</p>\n\n<pre><code>51,0.94*07\n$GPGSV,4,1,13,23,70\n</code></pre>\n\n<p>If possible in C#, I would like to use named capture groups in order to identify each optional captured group.</p>\n"},{"tags":["c#","asp.net","blogspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13296187,"title":"Getting main domain name from referring website","body":"<p>We are relying on refering urls when we pick up requests from users who installed our widget, it's just and iframe, similar to Google plus button, Facebook Like etc.</p>\n\n<p>Recently we noticed that Google's blogspot blogs can be accessed using multiple urls with different ending like:</p>\n\n<pre><code>*.blogspot.com\n*.blogspot.fr \n*.blogspot.co.uk \n...\n</code></pre>\n\n<p>Now our database is getting filled with duplicate websites.\nIs there any way to get real address every time like *.blogspot.com</p>\n\n<p>Are there any other websites that do such a thing, make themsalves available through different domains without redirecting to real one, or is blogspot specific?</p>\n\n<p>How does facebook handle this, do people that own blog on blogspot have different like count for different domain?</p>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":1863,"score":2,"question_id":10168240,"title":"Encrypting & Decrypting a String in C#","body":"<p>What is the most modern (best) way of satisfying the following in C#?</p>\n\n<pre><code>string encryptedString = SomeStaticClass.Encrypt(sourceString);\n\nstring decryptedString = SomeStaticClass.Decrypt(encryptedString);\n</code></pre>\n\n<p>BUT with a minimum of fuss involving salts, keys, mucking about with byte[], etc.</p>\n\n<p>Been Googling and confused at what I'm finding (you can see the list of similar SO Qs to see this is a deceptive question to ask).</p>\n"},{"tags":["c#","compact-framework","zxing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13289742,"title":"ZXing.Net Encode string to QR Code in CF","body":"<p>How could I encode my string into a QR Code using ZXing.Net (http://zxingnet.codeplex.com/)</p>\n\n<p>I can already decode, but having problems in encoding. It has an error that says: no encoder available for format AZTEC.</p>\n\n<p>and here is my code:</p>\n\n<pre><code>IBarcodeWriter writer = new BarcodeWriter();\nBitmap barcodeBitmap;\nvar result = writer.Encode(\"Hello\").ToBitmap();\nbarcodeBitmap = new Bitmap(result);\npictureBox1.Image = barcodeBitmap;\n</code></pre>\n"},{"tags":["c#","c#-4.0","linkedin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":16,"score":-2,"question_id":13296633,"title":"how to post a link or job in linkedin programmatically using DotNetOpenAuth or any others in c#?","body":"<p>I have followed the following post </p>\n\n<p><a href=\"http://stackoverflow.com/questions/10123785/how-to-multipart-post-form-data-to-linkedin-using-oauth-1-and-dotnetopenauth\">How to multipart post form data to LinkedIn using OAuth 1 and DotNetOpenAuth?</a></p>\n\n<p>Unfortunately it is also not working. Give an exception. </p>\n\n<p>I also followed  </p>\n\n<p><a href=\"http://stackoverflow.com/questions/6192644/dotnetopenauth-post-sample-with-json-body\">DotNetOpenAuth POST sample with JSON body</a>\nbut here i don't what it serviceBase in the following line\n HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(serviceBase + \"/Edit/6363241\");</p>\n\n<p>can any one help me. </p>\n"},{"tags":["c#",".net","vb.net","visual-studio","webforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13296010,"title":"How to remove dynamic control value?","body":"<p>Please see the code below:</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;div id=\"Div1\" runat=\"server\" /&gt;\n    &lt;asp:Button ID=\"Button1\" runat=\"server\" Text=\"Create a TextBox\" /&gt;\n    &lt;asp:Button ID=\"Button2\" runat=\"server\" Text=\"Erase TextBox Text\" /&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n..........................................\nprotected void Page_Load(object sender, EventArgs e)\n    {\n        if (IsPostBack)\n        {\n            if (Request.Params.ToString().IndexOf(\"Button1\") &gt; 0)\n            {\n                CreateTextBox();\n            }\n            else\n            {\n                if (Request.Params.ToString().IndexOf(\"Button2\") &gt; 0)\n                {\n                    TextBox txtbx = CreateTextBox();\n                    txtbx.Text = \"\";\n                }\n            }\n        }        \n    }\n\n    TextBox CreateTextBox()\n    {\n        TextBox txtbx = new TextBox();\n        Div1.Controls.Add(txtbx);\n\n        return txtbx;\n    }\n</code></pre>\n\n<p>On PostBack, I check if 'Button1' or 'Button2' was pressed.<br /><br />\nI press <strong>Button1</strong> and a TextBox is dynamically created.<br />\nI enter some text in the TextBox and press Button1 again. The TextBox is recreated and the text I entered is preserved on PostBack.<br /><br />\nWhen I press <strong>Button2</strong>, I want to recreate the TextBox, but I want to remove the text I previously entered. But even though I've specified <em>txtbx.Text = \"\"</em> the text is still preserved after PostBack.<br /><br />\nHow do I recreate the TextBox but remove the text entered?<br/>\n<em>(I want the text to be preserved if I push Button1, but not if I push Button2)</em></p>\n\n<p>Thank you.</p>\n"},{"tags":["c#",".net","f#","managed"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":13291415,"title":"Jetty for NET world","body":"<p>I am looking for the Jetty equivalent in the Net Framework world - managed code. Does it exist? I would like to use the library from an F#/C#/VB.net application. \n\"Don't deploy your application in Jetty, deploy Jetty in your application.\"</p>\n"},{"tags":["c#","token"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13296300,"title":"how to extract digits and letters","body":"<p>how can i make a function that extracts digits and letters from tokens,i am trying to work on a lexical analyzer in c sharp which extracts variables datatypes liberaries  from a cpp file\ni want my function to extract digits and letters i have managed to make functions that extract variables ,datatypes n libraries </p>\n\n<p>for example i want a combination of these two functions</p>\n\n<pre><code>bool IsDigit(char ch)\n{\n    return (ch &gt;='0' &amp;&amp; ch &lt;= '9');\n}\n\nbool IsAlpha(char ch)\n{\n    return (ch &gt;='a' &amp;&amp; ch &lt;= 'z'|| ch&gt;'A '&amp;&amp; ch&lt;'Z');\n\n}\n</code></pre>\n\n<p>any ideas??</p>\n"},{"tags":["c#","asp.net","html","webforms","beautify"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":839,"score":6,"question_id":5258921,"title":"ASP.net render HTML nicely (Beautify)","body":"<p>When I generate my controls in ASP.net they come out like this:</p>\n\n<pre><code>&lt;div id=\"ctl00_mainContent_ApprovalSelectPanel\" class=\"discussWrapper\"&gt;\n\n        &lt;span class=\"cbox highlighted\"&gt;&lt;input id=\"ctl00_mainContent_ctl00\" type=\"checkbox\" name=\"ctl00$mainContent$ctl00\" checked=\"checked\" value=\"70\" /&gt;&lt;label for=\"ctl00_mainContent_ctl00\"&gt;Buyer1&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl01\" type=\"checkbox\" name=\"ctl00$mainContent$ctl01\" value=\"75\" /&gt;&lt;label for=\"ctl00_mainContent_ctl01\"&gt;Buyer2&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl02\" type=\"checkbox\" name=\"ctl00$mainContent$ctl02\" value=\"280\" /&gt;&lt;label for=\"ctl00_mainContent_ctl02\"&gt;Client3&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl03\" type=\"checkbox\" name=\"ctl00$mainContent$ctl03\" value=\"281\" /&gt;&lt;label for=\"ctl00_mainContent_ctl03\"&gt;Client4&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl04\" type=\"checkbox\" name=\"ctl00$mainContent$ctl04\" value=\"283\" /&gt;&lt;label for=\"ctl00_mainContent_ctl04\"&gt;Client2&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl05\" type=\"checkbox\" name=\"ctl00$mainContent$ctl05\" value=\"289\" /&gt;&lt;label for=\"ctl00_mainContent_ctl05\"&gt;Client1&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl06\" type=\"checkbox\" name=\"ctl00$mainContent$ctl06\" value=\"346\" /&gt;&lt;label for=\"ctl00_mainContent_ctl06\"&gt;artworker1&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl07\" type=\"checkbox\" name=\"ctl00$mainContent$ctl07\" value=\"362\" /&gt;&lt;label for=\"ctl00_mainContent_ctl07\"&gt;buyer3&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl08\" type=\"checkbox\" name=\"ctl00$mainContent$ctl08\" value=\"367\" /&gt;&lt;label for=\"ctl00_mainContent_ctl08\"&gt;meeeee&lt;/label&gt;&lt;/span&gt;&lt;span class=\"cbox\"&gt;&lt;input id=\"ctl00_mainContent_ctl09\" type=\"checkbox\" name=\"ctl00$mainContent$ctl09\" value=\"368\" /&gt;&lt;label for=\"ctl00_mainContent_ctl09\"&gt;stake&lt;/label&gt;&lt;/span&gt;\n\n    &lt;/div&gt;  \n</code></pre>\n\n<p>Pretty ugly and hard to understand when you view the source.  This isn't a problem usually, but my site is offering visitors resources and tutorials where <em>looking at the source</em> is part of the experience.</p>\n\n<p>Is there any way to render these controls nicely?  Indented properly,  better id's and names etc?</p>\n"},{"tags":["c#","windows-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13296477,"title":"Windows 8 ListBox TextAlignment Not Working","body":"<p>I have a ListBox - ListBox.ItemTemplate - DataTemplate xaml setup and I'm trying to center the text in the ListBox (TextBlock)  .  The TextAlignment property doesn't seem to work.  Any ideas?    Here is my code:</p>\n\n<pre><code>  &lt;ListBox x:Name=\"listBox1\" HorizontalAlignment=\"Left\" Height=\"520\" Margin=\"190,220,0,0\" VerticalAlignment=\"Top\" Width=\"295\" SelectionChanged=\"listBox1_SelectionChanged\" FontSize=\"20\" FontWeight=\"Bold\" &gt;\n        &lt;ListBox.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;TextBlock Text=\"{Binding name}\" FontSize=\"25\" Foreground=\"Black\" TextAlignment=\"Center\"/&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ListBox.ItemTemplate&gt;\n    &lt;/ListBox&gt;\n</code></pre>\n"},{"tags":["c#","visual-studio-2010","resources","embedded-resource"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13296223,"title":"In Visual Studio's Designer, why don't any images show up in the Select Resource window?","body":"<p><img src=\"http://i.stack.imgur.com/5eH97.png\" alt=\"Why no images show up\"></p>\n\n<p>I got here by clicking on a <code>Button</code> on my <code>Form</code> in the designer, going to the Properties window, finding the Image property, and hitting the <code>...</code> button that appears to the right of the textbox.</p>\n\n<p>If I open up the Properties\\Resources.resx file in the designer, I see all the images in my project, yet I cannot view them in this list. I suppose I could import the images I want from a directory, but then I would have duplicates.</p>\n\n<p>How can I select from images in the resource file from this dialog? How can I get them to appear? Thanks.</p>\n"},{"tags":["c#","asp.net","ajaxcontroltoolkit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13295049,"title":"How to do : AjaxControlToolkit AjaxFileUpload throw exception OnUpdateComplete Event","body":"<p>I am using the AjaxFileUpload control in my project.\nBut in the OnUploadComplete event, I will save the file and do something in the database.</p>\n\n<p>If these two operation throw a exception, how can I make the AjaxFileUpload fail?\nInstead it show \"Uploaded\", how can I put a error message there?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","sharepoint2010","workflow","digital-signature","infopath2010"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13180253,"title":"How to reset digital signature of an InfoPath form during c# workflow in Sharepoint 2010?","body":"<blockquote>\n  <p>As the question says, I have an InfoPath form running on SP2010 using a c# workflow upon submission.  If the form is rejected during workflow, then I need to reset it. I have everything under control, EXCEPT how to reset digital signatures to null, nill, nada, nothing, non-extant! Any ideas? I'm looking at Google now, but at current, I'm not even sure of an om for digital signatures?</p>\n</blockquote>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":33,"score":-2,"question_id":13284629,"title":"How can I add a UserControl to a TabControl in another Window?","body":"<p>I have a <code>TabControl</code> in my <code>MainWindow</code>. I would like to create a <code>TabItem</code> in a different <code>Window</code>, and add this new <code>TabItem</code> to the <code>TabControl</code> in my <code>MainWindow</code>.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["c#","asp.net","httpwebrequest"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13286910,"title":"WebRequest and protocol agnostic URL","body":"<p>In a web application I have to first check if  an image exists and then display this image or a dummy image.</p>\n\n<p>I use the following code and it works for URLS like:</p>\n\n<ul>\n<li>\"<strong>http</strong>://www.somedomain.com/niceimage.png\"</li>\n<li>\"<strong>https</strong>://www.somedomain.com/niceimage.png\".</li>\n</ul>\n\n\n\n<pre><code>public virtual bool WebResourceExists(string url)\n{\n    WebHeaderCollection headers = null;\n    WebResponse response = null;\n    try\n    {\n        WebRequest request = WebRequest.Create(url);\n        request.Method = \"HEAD\";\n        response = request.GetResponse();\n        headers = response.Headers;\n        bool result = int.Parse(headers[\"Content-Length\"]) &gt; 0;\n        return result;\n    }\n    catch (System.Net.WebException)\n    {\n        return false;\n    }\n    catch (Exception e)\n    {\n        _log.Error(e);\n        return false;\n    }\n    finally\n    {\n        if (response != null)\n        {\n            response.Close();\n        }\n    }\n}\n</code></pre>\n\n<p>In some places the the method is called with protocol agnostic urls like <code>\"//www.somedomain.com/niceimage.png\"</code>. </p>\n\n<p>There is an exception thrown for such urls:</p>\n\n<blockquote>\n  <p><code>System.InvalidCastException: Unable to cast object of type\n  'System.Net.FileWebRequest' to type 'System.Net.HttpWebRequest'</code></p>\n</blockquote>\n\n<p>Is there a way to use protocol agnostic urls other then just prepending <code>\"http:\"</code> to the url?</p>\n"},{"tags":["c#","character-encoding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13296212,"title":"How to convert a string from koi8-r to windows-1251 in c#?","body":"<p>What I have</p>\n\n<pre><code>string str = \"уРБУЙВП ЧБН ЪБ ЧБЫХ РПНПЭШ\"; //cyrillic\n//I check this on \nsite == http://2cyr.com/decode/?lang=en\n\nstr == koi8-r\nif ( I decoder from the site)\n  readeble text == windows-1251;\n</code></pre>\n\n<p>How I can convert koi8 to windows-1251 ?</p>\n"},{"tags":["c#","jquery","ajax","asp.net-mvc","json"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13296229,"title":"How to pass a multi-dimensional array to ASP.NET MVC 3 JsonResult Controller","body":"<p>I have two javascript arrays that I need to pass into an MVC 3 controller and then input the values into a database. I have two lists of checkboxes and a change event for both list containers, to grab their checkbox id's and checked values and then add them to the arrays.</p>\n\n<pre><code>  @{\n        ViewBag.Title = \"JS Arrays in ASP.NET MVC 3\";\n    }\n\n&lt;script type=\"text/javascript\"&gt;\n    $(document).ready(function () {\n        $(\"#tabs\").tabs();\n    });\n&lt;/script&gt;\n&lt;p&gt;Use the form below to check items from the lists and save them to the database.&lt;/p&gt;\n\n&lt;div id=\"tabs\"&gt;\n    &lt;ul&gt;\n        &lt;li&gt;&lt;a href=\"#tabs-1\"&gt;Pre-Accept&lt;/a&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;a href=\"#tabs-2\"&gt;Post-Accept&lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;div id=\"tabs-1\"&gt;\n        &lt;div id=\"checklist1\"&gt;\n            &lt;table&gt;\n                &lt;tbody&gt;\n                    &lt;tr&gt;\n\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPreAccept.Transcripts\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Transcripts\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPreAccept.BiographicalInfo\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Biographical Info\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPreAccept.PersonalEssay\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Personal Essay\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n        &lt;br /&gt;\n        &lt;button id=\"savePreAccept\" onclick=\"saveAcceptList();\"&gt;Save Pre-Accept&lt;/button&gt;\n    &lt;/div&gt;\n    &lt;div id=\"tabs-2\"&gt;\n        &lt;div id=\"checklist2\"&gt;\n            &lt;table&gt;\n                &lt;tbody&gt;\n                    &lt;tr&gt;\n\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPostAccept.EnrollmentFee\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Enrollment Fee\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPostAccept.Photo\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Photo\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;input type=\"checkbox\" id=\"StudentPostAccept.TravelItinerary\" /&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;Travel Itinerary\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n        &lt;br /&gt;\n        &lt;button id=\"savePostAccept\" onclick=\"saveAcceptList();\"&gt;Save Post-Accept&lt;/button&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div id=\"results\"&gt;&lt;/div&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n    var preAcceptArray = { };\n    var postAcceptArray = { };\n\n    $(\" #checklist1 [type='checkbox']\").change(function() {                       \n        // add to the preAcceptArray\n        var id = $(this).attr('id');\n        var checked = $(this).is(':checked') ? 'True' : 'False';\n        preAcceptArray[id] = checked;\n\n        console.log(JSON.stringify(preAcceptArray));\n    });\n    $(\" #checklist2 [type='checkbox']\").change(function () {\n        // add to the postAcceptArray\n        var id = $(this).attr('id');\n        var checked = $(this).is(':checked') ? 'True' : 'False';\n        postAcceptArray[id] = checked;\n\n        console.log(JSON.stringify(postAcceptArray));\n    });\n\n    function saveAcceptList() {\n        $.post('/Home/UpdateLists', {\n                preAcceptList  : preAcceptArray,\n                postAcceptList : postAcceptArray\n            }, function(response) {\n                $(\"#results\").html(response);\n            }, \"json\");\n    }\n\n&lt;/script&gt;\n</code></pre>\n\n<p>Then on the controller side of things I have a JsonResult action that takes two parameters as input.</p>\n\n<pre><code> [HttpPost]\n    public JsonResult UpdateLists(string[][] preAcceptList, string[][] postAcceptList)\n    {\n        // do something with the lists             \n\n\n        // return the result\n        return Json(\"List(s) updated successfully.\", JsonRequestBehavior.AllowGet);\n    }\n</code></pre>\n\n<p>The problem is no matter what type of parameter I pass-in, I can't get the values from the ajax post. Should I be passing them in as JSON and then just parsing the JSON?</p>\n\n<p>I know I'm missing something and any help would be appreciated.</p>\n"},{"tags":["c#","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":33,"score":0,"question_id":13295967,"title":"How can I send information to the console in vs2012 C#","body":"<p>I would like to log some data when I am in a for loop. How can I have the data sent to the VS2012 console so I can view it later?</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13296137,"title":"What's a good way to store project related pictures?","body":"<p>I'm trying to get an array of <code>PictureBox</code> to display a list of pictures (in png file format).</p>\n\n<p>I tried to use the .NET <code>ImageList</code> control but it insists in re-sizing my pictures. It also does not support transparent background of those png files.</p>\n\n<p>I also tried to use the <code>Assembly</code> to retrieve my files like this:<br>\n<code>_imageStream = _assembly.GetManifestResourceStream(\"MyNamespace.MyImage.png\");</code>\nbut the code does not return me any resource files nor does it throw any run-time error.</p>\n\n<p>My question is, is there any other ways to do this? Or better yet, can I somehow make the <code>ImageList</code> control to NOT alter my picture? Thanks.</p>\n"},{"tags":["c#",".net","c#-4.0","opencv","emgucv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13296020,"title":"While want to make an instance of SIFTDetector: Get an Attempted to read or write protected memory exception Error","body":"<p>I am trying to use sift algorithm to make the keypoints and descriptors in c# by using opencv library.</p>\n\n<pre><code>     fileAddress = dlg.FileName;\n     cap = new Emgu.CV.Capture(dlg.FileName);\n     cap.SetCaptureProperty(Emgu.CV.CvEnum.CAP_PROP.CV_CAP_PROP_POS_FRAMES, 3945);\n     imGray = cap.QueryGrayFrame();\n     Emgu.CV.Features2D.SIFTDetector siftDet = new Emgu.CV.Features2D.SIFTDetector();\n     siftDet.DetectKeyPoints(imGray);\n     MessageBox.Show(\"test SIFT\");\n</code></pre>\n\n<p>but when it go through the line <strong>Emgu.CV.Features2D.SIFTDetector siftDet = new Emgu.CV.Features2D.SIFTDetector();</strong>  I face the error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/UrGpi.png\" alt=\"enter image description here\">  </p>\n\n<p>and view detail is as following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/qfqEm.png\" alt=\"enter image description here\">  </p>\n\n<p>How could I solve this exception?</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13295997,"title":"Hide modal window after Response.End() in asp.net","body":"<p>I have a button who does the following:</p>\n\n<pre><code>Response.Clear();\nResponse.Buffer = true;\nResponse.AddHeader(\"content-disposition\", \"attachment;filename=GridViewExport.csv\");\nResponse.Charset = \"\";\nResponse.ContentType = \"application/text\";\n//my content is created\nResponse.Output.Write(sb.ToString());\nResponse.Flush();\nResponse.End();\n</code></pre>\n\n<p>This is my button definition:</p>\n\n<pre><code>&lt;asp:Button ID=\"Button1\" runat=\"server\" onclick=\"Excel_Click\" Text=\"Export to Csv\" onclientclick=\"ShowModal();\"/&gt;\n</code></pre>\n\n<p>As you can see I call a javascript function, who does the following:</p>\n\n<pre><code>function ShowModal() {\n        var divmodal = document.getElementById(\"divModal\");\n\n        divmodal.style.display = '';\n    }\n</code></pre>\n\n<p>i.e. shows a modal window with the label \"Loading\"\nMy problem is when I download the file I get the csv generated but after that my modal window still appears, that's because the page isn't being refreshed</p>\n\n<p>Is there anything I can do?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","javascript","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13293369,"title":"adding razor statement in javascript","body":"<p>Im trying to add some C# code in my javascript. But I can't parse my var name into the C# code.</p>\n\n<p>What I want is this:</p>\n\n<pre><code>$.ready(function(){\n   var name = $(\"#input\");\n\n   @Class.text(name)\n});\n</code></pre>\n\n<p>But it wont allow me to parse the name.</p>\n\n<p>This is a short version of what i got, the @Class represent a more complex function</p>\n"},{"tags":["c#","regex","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13276990,"title":"RegExp Natural Sorting issue","body":"<p>I am working on an application that needs to display different columns of information naturally sorted. A while back I found <a href=\"http://www.codeproject.com/Articles/22517/Natural-Sort-Comparer\" rel=\"nofollow\">this</a> article that has a good description and code. I modified it some since we have columns that also show dates and ended up with this:</p>\n\n<pre><code>public class NaturalComparer : Comparer&lt;string&gt;, IDisposable\n{\n    private Dictionary&lt;string, string[]&gt; table;\n\n    public NaturalComparer()\n    {\n        table = new Dictionary&lt;string, string[]&gt;();\n    }\n\n    public void Dispose()\n    {\n        table.Clear();\n        table = null;\n    }\n\n    public override int Compare(string x, string y)\n    {\n        if (x == y)\n        {\n            return 0;\n        }\n\n            DateTime xValueD, yValueD;\n            if (DateTime.TryParse(x, out xValueD) &amp;&amp; DateTime.TryParse(y, out yValueD))\n                return xValueD.CompareTo(yValueD);\n\n\n        string[] x1, y1;\n        if (!table.TryGetValue(x, out x1))\n        {\n            x1 = Regex.Split(x.Replace(\" \", \"\"), \"([0-9]+)\");\n            table.Add(x, x1);\n        }\n        if (!table.TryGetValue(y, out y1))\n        {\n            y1 = Regex.Split(y.Replace(\" \", \"\"), \"([0-9]+)\");\n            table.Add(y, y1);\n        }\n\n        for (int i = 0; i &lt; x1.Length &amp;&amp; i &lt; y1.Length; i++)\n        {\n            if (x1[i] != y1[i])\n            {\n                return PartCompare(x1[i], y1[i]);\n            }\n        }\n        if (y1.Length &gt; x1.Length)\n        {\n            return 1;\n        }\n        else if (x1.Length &gt; y1.Length)\n        {\n            return -1;\n        }\n        else\n        {\n            return 0;\n        }\n    }\n\n    private static int PartCompare(string left, string right)\n    {\n        int x, y;\n        if (!int.TryParse(left, out x))\n        {\n            return left.CompareTo(right);\n        }\n\n        if (!int.TryParse(right, out y))\n        {\n            return left.CompareTo(right);\n        }\n\n        return x.CompareTo(y);\n    }\n}\n</code></pre>\n\n<p>Now it also needs to process a special type of string data and it is not doing what we need. The strings show information of ranges of data and they look like this:</p>\n\n<pre><code>string[] list = { \"Empty Values\",\"x&lt;0\" , \"1000.0 &lt; x &lt;=1500.0\", \"900.0 &lt; x &lt;= 1000.0\",\"3000.0 &lt; x &lt;= 3500.0\", \"800.0 &lt; x &lt;=900.0\" };\n</code></pre>\n\n<p>Sorted it should look like:</p>\n\n<pre><code>x &lt; 0\n800.0 &lt; x &lt;= 900.0\n900.0 &lt; x &lt;= 1000.0\n1000.0 &lt; x &lt;= 1500.0\n3000.0 &lt; x &lt;= 3500.0\nEmpty Values\n</code></pre>\n\n<p>However, it ends up with:</p>\n\n<pre><code>800.0 &lt; x &lt;= 900.0\n900.0 &lt; x &lt;= 1000.0\n1000.0 &lt; x &lt;= 1500.0\n3000.0 &lt; x &lt;= 3500.0\nEmpty Values\nx &lt; 0\n</code></pre>\n\n<p>So, logically I think it is doing what it is designed to do, because it picks on the letter and sorts based on that. I would like to keep it searching with regular expressions since it is fast. However, I have no idea how to set them up so it searches, and sorts, correctly. Any ideas, help, readings, or code would be appreciated.\nThanks</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13295881,"title":"Would I gain any performance by compiling a .Net Service Resource to a .dll?","body":"<p>I'm working on a project where I consume a SOAP service, that returns different database fields, which I then make a C# object out of, so I can register the data from the soap server (help desk) into our Team Foundation Server 2012 as a new work item. \nWould it be more efficient to instead of accessing the Service Reference directly from code, to create a .dll containing the referencing data?</p>\n\n<p>I'm thinking of using a command like this to generate the SOAP client:\n(From VS Command-line) </p>\n\n<pre><code>WSDL &lt;url&gt; // Generate the SOAP client code\n\ncsc /t:library &lt;code file generated in previous step&gt; // generate the .dll\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","entity-framework","jqgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13274096,"title":"Good programming principles while using EF/Code First/Repository Pattern/Table Per Type (TPT)?","body":"<p>Just curious.</p>\n\n<p>Say I have a Base entity and I'm deriving about 10 different child entities from it using the Table Per Type method. I also have a generic repository which can fetch me data from each of these child entities. I eventually want to map each of the child entities to a separate view model and link each of the view models to its own grid (JqGrid) on my website, with each grid having its own Create, Read, Update, Delete methods. I can do all of that, but I'm not sure what's the proper way to go about it while keeping code to a minimum.</p>\n\n<p>Right now, I have every field defined (from both the parent and child entity) in each of my view models. Is it better to have a \"parent\" view model and then deriving the child view models from it in order to mimic the inheritance structure of the entities? I wouldn't think so....having inheritance in view models doesn't make much sense to me.</p>\n\n<p>Also, I really don't want to duplicate CRUD operations for each grid. Is that considered good practice? Should each view model have its own set of CRUD operations in this case?</p>\n\n<p>Take 'Read' for instance. I'm basically returning JSON data based on the ID (key) field of the view model for each grid. And since all grids will have this ID column (part of the parent entity), should I only have one function that takes care of this for all grids? Should I be using reflections? Should I be making use of polymorphic properties of the parent/child entities?</p>\n\n<p>Or is it better to keep these operations separate for each grid?</p>\n\n<p>Hmmm..</p>\n"},{"tags":["c#",".net","json","serialization"],"answer_count":4,"favorite_count":6,"up_vote_count":30,"down_vote_count":0,"view_count":8024,"score":30,"question_id":1066550,"title":"Is there a tool to generate C# classes based off a JSON string?","body":"<p>I'm wondering if there is a tool out there that can take in a JSON string, analyze it, and generate a C# class file that can then be used to deserialize the json string into a C# object of that class.</p>\n\n<p>I'm looking for something similar to a code generator of sorts, but the input would be a JSON string, instead of a database table/view/whatever, and the output would be your typical C# class file.</p>\n\n<p>Anyone have any suggestions?</p>\n"},{"tags":["c#",".net","google","geocoding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13295482,"title":"Best way to do bulk geocode look-up with Google Maps API","body":"<p>Our company frequently receives large lists of addresses, upwards of 6000 that we need to geocode and put into our database. We already have a Google Maps API for Business License to get this done with. </p>\n\n<p>I'm working on creating an application to do a bulk geocode look-up after I parse and separate the relevant parts of the list to make the URL to send off to Google. The parser is already done for me. I've tried making a separate thread for each address and sending a request to Google in the individual thread, and this works for a small number addresses (about 10 to 100), but  not for larger numbers (above 500). I get lots of 403 errors. So this probably isn't a good way to go about this. I also don't know too much about network programming, so I'm trying to learn as I go here. </p>\n\n<p>So I'm wondering what the best way to do this might be. I can use VB.NET or C# to get this done; it doesn't matter too much. Thank you! </p>\n"},{"tags":["c#","list","arraylist"],"answer_count":5,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":37992,"score":6,"question_id":1596530,"title":"Multi-dimensional arraylist or list in C#?","body":"<p>Is is possible to create a multidimensional list in C#.\nI can create an multidimensional array like so:</p>\n\n<pre><code> string[,] results = new string[20, 2];\n</code></pre>\n\n<p>but I would like to be able to use some of the features in a list or arraylist like being able to add and delete elements.</p>\n"},{"tags":["c#","asp.net","module","dotnetnuke","manifest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13294920,"title":"DNN multiple modules on a single package","body":"<p>Is it possible to create a dotnetnuke (v5) package that contains multiple modules?\nI mean: there is a \"moduleDefinitions\" element on the manifest that looks like supporting more than one module, but adding another child to it doesn't sort any effect.</p>\n\n<p>The dnn manifest looks like:</p>\n\n<pre><code>&lt;dotnetnuke type=\"Package\" version=\"5.0\"&gt;\n&lt;packages&gt;\n    &lt;package name=\"MyModuleName\" type=\"Module\" version=\"01.00.00\"&gt;\n        &lt;friendlyName&gt;MyModuleName&lt;/friendlyName&gt;\n        &lt;components&gt;\n            &lt;component type=\"Module\"&gt;\n                &lt;desktopModule&gt;\n                    &lt;moduleName&gt;MyModuleName&lt;/moduleName&gt;\n                    &lt;foldername&gt;MyModuleName&lt;/foldername&gt;\n                    &lt;supportedFeatures /&gt;\n                    &lt;businessControllerClass /&gt;\n                    &lt;moduleDefinitions&gt;\n                        &lt;moduleDefinition&gt;...&lt;/moduleDefinition&gt;\n                        &lt;!-- this one is ignored --&gt;\n                        &lt;moduleDefinition&gt;...&lt;/moduleDefinition&gt;\n                    &lt;moduleDefinitions&gt;\n</code></pre>\n\n<p>Anyway I need to package two or more modules on the same package. Is it possible?</p>\n"},{"tags":["c#","sql-server-2008","microsoft-sync-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13295971,"title":"SQL Server built-in Change Tracking vs Sync Framework's C#/VB libraries","body":"<p>I went into a problem where using the following code did not change the scope_id value in the replica key map and scope_info table of Sync Framework 2.1 elements in my database, on a restored database on Windows XP 32-bit / SQL Server Express 2008 (x86). It DOES work on my other client that is Windows 7 64-bit / SQL Server Express 2008 (x86) :</p>\n\n<p>SqlSyncStoreRestore databaseRestore = new SqlSyncStoreRestore(clientConn);\n                            databaseRestore.PerformPostRestoreFixup();</p>\n\n<p>SUB QUESTION 1:\nIt does not work but does not throw any exception either, which makes it much harder to troubleshoot. It is executed from a small console application (target x86) I built on my x64 computer (using Visual Studio x86). I wonder if the 32/64 bit thing is the culprit. Any clue?? But then, this made me wonder:</p>\n\n<p>SUB QUESTION 2:\n\"Is there an SQL query equivalent to using PerformPostRestoreFixup() of Sync Framework's C#?\"</p>\n\n<p>I am fairly new to Sync Framework and I do not yet entirely see the whole picture of synchronization of Microsoft SQL Server databases. It came to my attention that the SyncOrchestrator/SqlSyncProvider combo does not use built-in SQL Change Tracking stuff. Incredibly surprising to me! It now made me haunted by an even more tormenting question:</p>\n\n<p>SUB QUESTION 3:\n Is the built-in SQL Server Change Tracking and Sync Framework two totally independent platform on which to build our synchronization scheme? I hope I am using the right words in English. In other words, is each of them completely unaware of the other??</p>\n\n<p>Thanks in advance for your help! I am soooo lost LOL!</p>\n\n<p>Kind Regards,</p>\n\n<p>Zyxy</p>\n"},{"tags":["c#","silverlight","xaml","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13295717,"title":"Set a Value Before Button is Pushed","body":"<p>I'm working with Silverlight 4, C# and XAML. I have an external control that filters my date and time, although it doesn't work as planned.</p>\n\n<p>It only updates my DateTime value when you tab out/lose focus or when you hit the search button twice. How could I make it so when you hit the search button the value updates right away?</p>\n\n<p>Here's the XAML code I'm using,</p>\n\n<pre><code>&lt;toolkit:NumericUpDown Grid.Column=\"2\" Margin=\"10\" Value=\"{Binding ElementName=DateTimeframeElement, Path=DateTimeframe.TimeFrameMeasure, Mode=TwoWay}\"/&gt;\n</code></pre>\n\n<p>Any help would be greatly appreciated,\nThanks,\nJason</p>\n\n<p>Ohh, sorry intellisense wasn't working for UpdateSourceTrigger because I wasn't using it properly, thank you!</p>\n"},{"tags":["c#","asp.net-mvc","forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13295136,"title":"Name attribute on ASP.NET MVC action","body":"<p>I have this action:</p>\n\n<pre><code>[HttpPost]\npublic ActionResult Test(Test test) \n{\n...\n}\n</code></pre>\n\n<p>With this class:</p>\n\n<pre><code>public class Test\n{\npublic string txtTest { get; set; }\n}\n</code></pre>\n\n<p>An html form has a text field named txtTest, and I can successfully call into my action above. What property name would allow me to do this:</p>\n\n<pre><code>public class Test\n{\n[SomeAttribute(Name = \"txtTest\")]\npublic string MyTest { get; set; }\n}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","generics","interface"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13255803,"title":"Interface that requires attribute to be implemented","body":"<p>Is there a way to create interface with attribute which has to be used by the class that implements interface?</p>\n\n<p>I.e. if class Foo implements interface IFoo, and IFoo is defined to must have ObserveMeAttribute, then Foo must have ObserveMe defined on it in order to implement IFoo.</p>\n\n<p>Edit:</p>\n\n<p>Attribute is called EntityTypeAttribute and is used to specify entity type for the view model, with usage:</p>\n\n<pre><code>[EntityType(typeof(User))]\npublic class UserViewModel\n{\n...\n}\n</code></pre>\n\n<p>Attribute is used in an extension method AddModel(T TModel) where attribute is read from TModel, and it's property Type entityType is used to create entity stub object.</p>\n"},{"tags":["c#","c++-cli","udpclient","asynccallback"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13288780,"title":"Performance benefit storing AsyncCallback in member variable against creating new one","body":"<p>I am using UdpClient (c++/cli), I start my listener using the obvious BeginReceive. </p>\n\n<pre><code>System::Void CUdpTransmitter::StartListener() {\n  ...\n  m_UdpClient-&gt;BeginReceive ( gcnew System::AsyncCallback(ReceiveCallback), this );\n}\n</code></pre>\n\n<p>ReceiveCallback should start new AsyncCallback at the end. Is there any performance benefit or any other reason to store the AsyncCallback in a member variable, rather than allocate a new one on each call? What about thread safety? Compare following variants:</p>\n\n<pre><code>System::Void CUdpTransmitter::ReceiveCallback1( System::IAsyncResult ^ asyncResult ) {\n  m_UdpClient-&gt;EndReceive();\n  // parse received data (not time consumpting)\n  ...\n  if (! exit) {\n    m_UdpClient-&gt;BeginReceive ( gcnew System::AsyncCallback(ReceiveCallback), self );\n  }\n}\npublic ref class CUdpTransmitter {\n  AsyncCallback ^ m_callback; // store AsyncCallback in a member variable, it will be initized in constructor... gcnew System::AsyncCallback(ReceiveCallback2)\n  System::Void CUdpTransmitter::ReceiveCallback2( System::IAsyncResult ^ asyncResult ) {\n    m_UdpClient-&gt;EndReceive();\n    // parse received data (not time consumpting)\n    ...\n    if (! exit) {\n      // start receiving, reuse the member variable and avoid gcnew\n      m_UdpClient-&gt;BeginReceive ( m_callback, self );\n    }\n  }\n}\n</code></pre>\n\n<p>Thanks for your time and your answers.</p>\n"},{"tags":["c#","json","winforms","desktop","restsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13295602,"title":"RestSharp POST not working","body":"<p>I'm building a client-server desktop app in C# and RestSharp seems to be tripping my program up somewhere. The oddest thing is that other POSTs are working to the same Node.js server app.</p>\n\n<p>Here's my code using RestSharp:</p>\n\n<pre><code>RestClient client = new RestClient(\"http://\"+Configuration.server);\nRestRequest request = new RestRequest(\"sync\", Method.POST);\n\nrequest.AddParameter(\"added\", Indexer.getAddedJson());\nrequest.AddParameter(\"removed\", Indexer.getRemovedJson());\n\nRestResponse&lt;StatusResponse&gt; response = (RestResponse&lt;StatusResponse&gt;)client.Execute&lt;StatusResponse&gt;(request);\ne.Result = response.Data;\n</code></pre>\n\n<p>This doesn't work - and by that I mean it doesn't make a call to the server at all. I've verified this using Fiddler too.</p>\n\n<p>But this does work:</p>\n\n<pre><code>using (var wb = new WebClient())\n{\n    var data = new NameValueCollection();\n    data[\"added\"] = Indexer.getAddedJson();\n    data[\"removed\"] = Indexer.getRemovedJson();\n\n    var resp = wb.UploadValues(\"http://\" + Configuration.server + \"/sync\", \"POST\", data);\n\n}\n</code></pre>\n\n<p>I can't figure out for the life of me what's going on. I don't want to stop using RestSharp just for this request, other POST requests are working just fine!</p>\n\n<p>It's not a deserialization problem, because response.Content is null. I'm getting a StatusResponse in the other calls as well so this is probably not the issue.</p>\n"},{"tags":["c#","xml","web-services","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13295821,"title":"Calling Oracle XML Gateway web service from .NET","body":"<p>I'm working on a .NET application (written in C#) that will process incoming XML files through the Oracle XML Gateway.</p>\n\n<p>I've created the proxy class through Visual Studio 2010 using a service reference pointed tot he WSDL Oracle provides. I can iterate the methods through Object Browser, so it seems to have worked.</p>\n\n<p>The problem is I can't get the webmethod to execute. Is there a trick to getting the gateway to process an inbound message?</p>\n"},{"tags":["c#","image","picturebox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13295501,"title":"swap pictureboxes with each other","body":"<p>I'm making a Bejeweled game and i'm getting some isseus.\nThe problem that i am working on now is that when i have selected 2 diamonds they need to swap positions.</p>\n\n<p>I am making pictureboxes with randomly images inside of them(1 to 7 colors).\nwhen i know the color i am making a picturebox for it </p>\n\n<pre><code>switch (diamant)\n{\n  case \"1\":\n    dia = new Diamant(this, \"Rood\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"2\":\n    dia = new Diamant(this, \"Groen\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"3\":\n    dia = new Diamant(this, \"Geel\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"4\":\n    dia = new Diamant(this, \"Paars\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"5\":\n    dia = new Diamant(this, \"Wit\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"6\":\n    dia = new Diamant(this, \"Oranje\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n  case \"7\":\n    dia = new Diamant(this, \"Blauw\", XWaarde, YWaarde, new Point(XWaarde, YWaarde));\n    break;\n}\n</code></pre>\n\n<p>I save them in a list and from there i want to change them from position i know which x and y position they both have.\nBut dont know how i need to start this swapping.</p>\n\n<p>Somebody can give me a idea to swap them.</p>\n\n<p>or is it better to make 64 (8 X 8) pictureboxes and than fill them with a color?</p>\n\n<p>kind regards,</p>\n\n<p>Maikel </p>\n"},{"tags":["c#",".net","uac"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12593157,"title":"How to run a non-admin process from admin c# application","body":"<p>I have a c# application that needs to do some things as an admin (some installation stuff) and then it needs to run another process as a non-admin. I haven't done anything with UAC before, but I assume there must be a way to do this, right?</p>\n\n<p>This also needs to be automated, so assume that the c# app is started with admin credentials.</p>\n\n<p>Basically the program will need to do something like this:</p>\n\n<pre><code>// MUST run this process as admin\nProcess adminInstall = new Process();\nadminInstall.StartInfo.FileName = \"install.bat\";\nadminInstall.Start();\nadminInstall.WaitForExit();\n\n// CANNOT run this process as admin\nProcess nonAdminProcess = new Process();\nnonAdminProcess.StartInfo.FileName = \"runner.cmd\";\nnonAdminProcess.StartInfo.UseShellExecute = false;\nnonAdminProcess.StartInfo.RedirectStandardOutput = true;\nnonAdminProcess.OutputDataReceived += new DataReceivedEventHandler(myHandler);\nnonAdminProcess.Start();\nnonAdminProcess.BeginOutputReadLine();\nnonAdminProcess.WaitForExit();\n</code></pre>\n"},{"tags":["c#","nhibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":15,"score":3,"question_id":13295765,"title":"Multiple many-to-one joins on same column erroneously results in SELECT being performed","body":"<p>I have a class which looks like this:</p>\n\n<pre><code>[Class(Table = \"SessionReportSummaries\", Mutable = false)]\npublic class SessionReportSummaries\n{        \n    [ManyToOne(Column = \"ClientId\", Fetch = FetchMode.Join)]\n    public Client Client { get; private set; }\n\n    [ManyToOne(Column = \"ClientId\", Fetch = FetchMode.Join)]\n    public ClientReportSummary ClientReportSummary { get; private set; }\n}\n</code></pre>\n\n<p>The SessionReportSummaries view has a ClientId column, and I’m trying to join both a Client object and a ClientReportSummary object using this column.</p>\n\n<p>Unfortunately, NHibernate only wants to join the first one defined in the class, and always performs a SELECT for the second one. So in this scenario NHibernate queries the database first with:</p>\n\n<pre><code>SELECT {stuff} FROM SessionReportSummaries ... left outer join Clients on this.ClientId=Clients.Id ...\n</code></pre>\n\n<p>(with lots of other joins), and then N of these:</p>\n\n<pre><code>SELECT {stuff} FROM ClientReportSummary WHERE ClientReportSummary.ClientId = '{id goes here}'\n</code></pre>\n\n<p>one for each of the N clients in question. This results in terrible performance.</p>\n\n<p>If I swap the positions of the Client and ClientReportSummary objects then NHibernate instead joins ClientReportSummary onto the SessionReportSummaries object, and performs a select for each Client object.</p>\n\n<p>Does anyone know how I can get NHibernate to perform a join for both of these?</p>\n"},{"tags":["c#","static-methods","local-variables"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":517,"score":6,"question_id":3399922,"title":"Variable sharing inside static method","body":"<p>I have a question about the variables inside the static method. \nDo the variables inside the static method share the same memory location or would they have separate memory?</p>\n\n<p>Here is an example.</p>\n\n<pre><code>public class XYZ\n{\n    Public Static int A(int value)\n    {\n      int b = value;\n      return b;\n    }\n}\n</code></pre>\n\n<p>If 3 different user calls execute the method A</p>\n\n<pre><code>XYZ.A(10);\nXYZ.A(20);\nXYZ.A(30);\n</code></pre>\n\n<p>at the same time. What would be the return values of each call?</p>\n\n<pre><code>XYZ.A(10)=?\nXYZ.A(20)=?\nXYZ.A(30)=?\n</code></pre>\n"},{"tags":["c#","wpf","winforms","directshow","directshow.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13295667,"title":"DirectShow Library-How to capture image using directshow library without showing the webcam live images on the PictureBox or Panel","body":"<p>I am using WPF application which is using DirectShow library and it is working fine for grabbing images or recording the live feed,but i wants that end user should not be able to see that any web cam is taking their picture i.e. i wants picture box or panel which is rendering the feed from the webcam should not be visible to the user and i should be able to capture the images or record the live feed.</p>\n\n<p>Please provide me any link or suggestion as i am beginner for the DirectShow library.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","entity-framework","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":125,"score":4,"question_id":13276806,"title":"Converting from IEnumerable<IEnumerable<string>> to ICollection<T>","body":"<p>I'm trying to convert an <code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code> to <code>ICollection&lt;Character&gt;</code> but struggling to figure out the right way to do it since the structure of one object is different than the structure of the other.</p>\n\n<p>The reason for conversion is to take a json deserialization and insert that into a database via Entity Framework. The json data isn't normalized and doesn't match the exact structure of the database. In the database I have a <code>movie</code> and a <code>person</code> that have a many-to-many relationship. The bridge table between them is <code>characters</code>. But the json just has a movie object with an array of people objects and each person with an array of the characters they play (<code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code>).</p>\n\n<p>Basically, I need to convert each movie's people and their characters to each movie's character and its respective person.</p>\n\n<pre><code>var movie = dataContractMovies.Select(m =&gt; new Movie {\n    Title = m.Title,\n    // not sure how to convert each Person and their characters\n    Characters = // Need to take each Person and their Characters in m.Cast and cast to a new Character and a new Person for which the Character belongs to\n});\n</code></pre>\n\n<p><strong>Convert From</strong></p>\n\n<pre><code>public class MovieDataContract {\n    [DataMember(Name = \"title\")]\n    public string Title { get; set; }\n\n    [DataMember(Name = \"abridged_cast\")]\n    public virtual IEnumerable&lt;Person&gt; Cast { get; set; }\n}\n\n[DataContract]\npublic class Person {\n    [DataMember(Name = \"name\")]\n    public string Name { get; set; }\n\n    [DataMember(Name = \"characters\")]\n    public IEnumerable&lt;string&gt; Characters { get; set; }\n} \n</code></pre>\n\n<p><strong>Convert To</strong></p>\n\n<pre><code>public partial class Movie {\n    public string Title { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Movie() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n\npublic partial class Character {\n    public string Name { get; set; }\n    public virtual Movie Movie { get; set; }\n    public virtual Person Person { get; set; }\n}\n\npublic partial class Person {\n    public string Name { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Person() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n</code></pre>\n\n<p><strong>UPDATE AND FURTHER QUESTION</strong></p>\n\n<p>What if I just added a <code>public IEnumerable&lt;Character&gt; Characters</code> to the <code>MovieDataContract</code>? Then I could just do something like this (in theory, haven't tested)...</p>\n\n<pre><code>Characters = m.Characters;\n</code></pre>\n\n<p>So my new <code>MovieDataContract</code> would look like this...</p>\n\n<pre><code>[DataContract]\npublic class MovieDataContract {\n    [DataMember(Name = \"title\")]\n    public string Title { get; set; }\n\n    [DataMember(Name = \"abridged_cast\")]\n    private IEnumerable&lt;Person&gt; _cast { get; set; }\n\n    public IEnumerable&lt;Character&gt; Characters { \n        get{  \n            foreach(var person in _cast) {\n                foreach(string name in person.characters) {\n                    yield return new Character { Name = name, Person = new Person { Name = person.name }}\n                }\n            }\n        } \n    }\n}\n</code></pre>\n"},{"tags":["c#","copy","command"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13293882,"title":"Using the copy command in c#, not respecting paths","body":"<p>I am trying to code something that will essentially concat a bunch of files together into 1 output file.</p>\n\n<p>my code is as follows</p>\n\n<pre><code>string[] destination = new string[this.lbFiles.Items.Count];\nthis.lbFiles.Items.CopyTo(destination, 0);\nstring result1 = ConvertStringArrayToString(destination);\nresult1 = result1.Remove(result1.Length - 3);\nstring outputfile = this.saveFileDialog1.FileName;\nstring copyarg = \"copy /b \" + result1 + quote + outputfile + quote;\nSystem.Diagnostics.Process.Start(\"CMD.exe\", copyarg);\n</code></pre>\n\n<p>So basically result1 = all the files i'm trying to concatenate.  with full paths and quotes.  and outputfile = the output file name i want to use with full path.</p>\n\n<p>My problem is, when I execute the code, it copys the files, but it doesnt use the output file name I have specified, and it outputs the file to the directory where the program exe is located, not the path I have specified.</p>\n\n<p>Any help?</p>\n"},{"tags":["c#","inotifypropertychanged"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13294662,"title":"PropertyChangedEventHandler How to get value?","body":"<p>So I've setup the event to a class</p>\n\n<pre><code>    void item_PropertyChanged(object sender, PropertyChangedEventArgs e)\n    {\n    }\n</code></pre>\n\n<p>And it's fired when a class's property gets changed, however I want to make the same change in a similar class. Take this as an example</p>\n\n<pre><code>class A: INotifyPropertyChanged\n{\n   //event handler declaration\n\n   string PhoneNumber;\n\n   string _name;\n   Public string Name {\n     get { return _name;}\n     set { _name = value; PropertyChanged(\"Name\");}\n   }\n}\n\nclass B\n{\n   string Name;\n   int age;\n}\n</code></pre>\n\n<p>and the event binding for class A;</p>\n\n<pre><code>    void item_PropertyChanged(object sender, PropertyChangedEventArgs e)\n    {\n    }\n</code></pre>\n\n<p>what I want is to copy the content of the Name property of A and assign it to an instance of B.</p>\n\n<p>What is the elegant way to do that? My problem is knowing which value of A has changed(in my class it's not only name, but more).</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2452,"score":2,"question_id":2922166,"title":"MVC and binding to List of Checkboxes","body":"<p>Here is my problem. I have a list of models that are displayed to the user. On the left is a checkbox for each model to indicate that the user wants to choose this model (in this case, we're building products a user can add to their shopping cart). The model has no concept of being chosen...it strictly has information about the product in question. </p>\n\n<p>I've talked with a few other developers after having gone through and the best I could come up with is getting the formcollection and string parsing the key values to determine whether the checkbox is checked or not. This doesn't seem ideal. I was thinking there would be something more strongly bound, but I can't figure out a way to do it. </p>\n\n<p>I tried creating another model that had a boolean property to represent being checked and a property of the model and passing a list of that model type to the view and creating a ActionResult on the controller that accepts a list of the new model / checked property, but it comes back null. Am I just thinking too much like web forms and should just continue on with parsing checkbox values?</p>\n\n<p>Here's what I've done for wrapping the models inside a collection:</p>\n\n<p><pre><code>\npublic class SelectableCollection[T] : IList[T] {} \npublic class SelectableTrack{ \n  public bool IsChecked{get;set;} \n  public bool CurrentTrack{get;set;} \n} \n</pre></code>\nFor the view, I inherit from </p>\n\n<pre><code>\nViewPage[SelectableCollection[SelectableTrack]] \n</code></pre>\n\n<p>For the controller, I have this as the ActionResult:</p>\n\n<pre><code>\n    [HttpPost] \n    public ActionResult SelectTracks(SelectableCollection sc) { \n\n       return new EmptyResult(); \n    } \n</code></pre>\n\n<p>But when I break inside the ActionResult, the collection is null. Any reason why it isn't coming through?</p>\n"},{"tags":["c#","global-hotkey"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13280093,"title":"Modifier Key Codes for Global Hotkey Registration","body":"<p>I am hooking a USB remote up to my software, and need to register global hotkeys to work with it. I have the code in place, and it is working as expected, but when I hook the remote up, I found that it requires a specific Left or Right Alt when dealing with the modifier keys.</p>\n\n<p>In other words, right now I have the global hotkey set up to accept ALT + SHIFT + 0 to run a specific function. When I hooked the remote up, I realized that their mapping requires the specific Key modifier to be identified. Thus, I need to search specifically for L-ALT + L-SHIFT + 0. I have searched for these modifier mappings, but have not been able to find anything that says what they are. I have only been able to find the modifiers for the general ALT key rather than the specific L-ALT modifier.</p>\n\n<p>Currently, I have my keys defined as such:</p>\n\n<pre><code>    public const int NOMOD = 0x0000;            //  No HotKey\n    public const int ALT = 0x0001;              //  ALT\n    public const int CTRL = 0x0002;             //  CTRL\n    public const int SHIFT = 0x0004;            //  SHIFT\n    public const int WIN = 0x0008;              //  WIN button\n    public const int WM_HOTKEY_MSG_ID = 0x0312; //  Windows message ID for HotKey\n</code></pre>\n\n<p>I have tried to find a mapping for what the code would be for L-Alt, L-CTRL, and L-Shift, but have been unsuccessful. They don't seem to be ASCII. Does anyone know the correct codes for these, or where I can find them? Thanks.</p>\n"},{"tags":["c#","asp.net","report-viewer2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13277395,"title":"When using Report Viewer and asked for datasource my data access class does not show up","body":"<p>I am new to using the report viewer control. </p>\n\n<p>The way I am currently creating a report is by calling a stored procedure and inserting input parameters to query a table in a database and to return a list of rows. </p>\n\n<p>The rows are inserted into a Data Table and the Data Table is returned.</p>\n\n<p>The data table is binded to a gridview which the user can view.</p>\n\n<p>Now my problem....</p>\n\n<p>I would like to use the report viewer to display the data instead of the gridview so the users can easily export the data and view a nice graph with it.</p>\n\n<p>The Stored Procedure is called from my data access class which is just a class I have in my project (it is not in a folder).</p>\n\n<p>When I go to create a report viewer and get asked for my datasource my data access class does not show up.  How can I get the results (the returned data table) from my stored procedure function to get inserted into the report viewer?</p>\n"},{"tags":["c#","unity","getter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":10230758,"title":"accessing data from a different class unity","body":"<p>Hey guys I am new to Unity and finding it really hard to adapt to the concept of things. My problem is that I have a method that returns a string , and another method in a different class which calls on the method to get that string any time I try implement this the string is never accessed from the other class. </p>\n\n<p>here is the method that returns the string </p>\n\n<pre><code>public string getString(){\n\n string hi  = \"why hello\";\n\n return hi;\n\n}\n</code></pre>\n\n<p>And here is the method which prints the above string when a button is clicked </p>\n\n<pre><code>void OnMouseUp(){\n\n\nfirstScript log = (firstScript)FindObjectOfType(typeof(firstScript));\n\n  string hello = log.getString()\n\nprint (hello);  \n}\n</code></pre>\n"},{"tags":["c#",".net","string.format"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":74,"score":6,"question_id":13276418,"title":"How string.Format handles null values?","body":"<p>In the following code below, why the two string.Format behave the same way? In the first one, no exception is thrown and in the second one an ArgumentNullException is thrown.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    Exception e = null;\n    string msgOne = string.Format(\"An exception occurred: {0}\", e);\n    string msgTwo = string.Format(\"Another exception occurred: {0}\", null);\n}\n</code></pre>\n\n<p>Could someone please help me understand the difference between the two?</p>\n"},{"tags":["c#","windows-phone-7","windows-phone-7.1","windows-phone","xap"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13251252,"title":"import xap file to windows phone project","body":"<p>I am new to windows phone. i need to deploy two xap files as one application to device. In fact we can say that i need to merge them. These two application should also interact between them. Can it be doable?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Firstly my question was the question above. But i understand that there is no way to launch another application inside the other one. So i think it would be meaningless to merge them if ever we could have done so. So i edited the question:</p>\n\n<p>I have one applications xap file and i need to develop another application which should call this applications first page when user clicks some button on develeping application.\nThe questions are: </p>\n\n<ul>\n<li>Can i import xap file into developing project or xap file of it?</li>\n<li>Can i import xap file as a library project to developing project?</li>\n<li>Can it be done without source code of the already developed application so that i can interact it from developing application?</li>\n</ul>\n"},{"tags":["c#","asp.net","webforms","asp.net-membership","roleprovider"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13070814,"title":"How to Custom Authorization from database","body":"<p>Normally use authorization settings to interact with the roles.</p>\n\n<pre><code>&lt;location path=\"Register.aspx\"&gt;\n  &lt;system.web&gt;\n    &lt;authorization&gt;\n      &lt;allow roles=\"Administrator\"/&gt;\n      &lt;deny users=\"?\"/&gt;\n    &lt;/authorization&gt;\n  &lt;/system.web&gt;\n&lt;/location&gt;\n</code></pre>\n\n<p>But I would like to have this setup in the database in a table</p>\n\n<pre><code>tblAuthorization\n-IdAuthorization (Identy(1,1))\n-IdCompany=5\n-IdRol=5 (Administrator”)\n-Path=”Register.aspx”\n</code></pre>\n\n<p>Is there a setting for a class to do this? There is something like Profile, RoleProvider ..</p>\n\n<pre><code>&lt;roleManager enabled=\"true\"  defaultProvider=\"MyAccessRolProvider\"&gt;\n   &lt;providers&gt;\n      &lt;clear /&gt;\n      &lt;add name=\"MyAccessRolProvider\" type=\"MyAccessRolProvider\" connectionStringName=\"MyConnectionString\" applicationName=\"/\" /&gt;\n      &lt;add name=\"AspNetWindowsTokenRoleProvider\" type=\"System.Web.Security.WindowsTokenRoleProvider\" applicationName=\"/\" /&gt;\n   &lt;/providers&gt;\n&lt;/roleManager&gt;\n</code></pre>\n\n<p>Right now the only I think that can to implement a validation in the Page_Load event\nAnd if it is invalid making a Redirect but I would do a little more \"Professional\"</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n   if (!IsPostBack)\n   {\n      if(!ValidateAuthorization())\n      {\n          Response.Redirect(\"Login.aspx\");\n      }\n   }\n}\n</code></pre>\n\n<p>Could help me with examples?</p>\n\n<p>Thank you very much in advance</p>\n"},{"tags":["c#","windows-services","service-broker","sqldependency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":262,"score":0,"question_id":7319743,"title":"SQL Server Notifications - My OnChange does not fire from a windows service","body":"<p>I would like to make use of SQL Server notifications to capture insert/update events at my database within a windows service. I am attempting to use the SQLDependency object. The MSDN articles make this seem pretty straight forward. So I have created a little example application to give it a try. when making changes to the  data into the table it does not raise the OnChange event it would seem. Can someone tell me what I'm missing? Thanks! a sample of my code is below.</p>\n\n<pre><code>private bool CanRequestNotifications()\n{\n    SqlClientPermission permit = new\n    SqlClientPermission(System.Security.Permissions.PermissionState.Unrestricted);\n    try\n    {\n        permit.Demand();\n        return true;\n    }\n    catch (System.Exception exc)\n    {\n        return false;\n    }\n}\n\nprivate void NotificationListener()\n{\n    string mailSQL;\n    SqlConnection sqlConn;\n    try\n    {\n        string connString = \"Data Source=xyz;Initial Catalog=abc;User ID=sa;Password=******\";\n        mailSQL = \"SELECT * FROM [tbl_test]\";\n\n        SqlDependency.Stop(connString);\n        SqlDependency.Start(connString);\n\n        sqlConn = new SqlConnection(connString);\n        SqlCommand sqlCmd = new SqlCommand(mailSQL, sqlConn);\n        this.GetNotificationData();\n        evtLog.WriteEntry(\"Error Stage: NotificationListener\" + \"Error desc:\" + \"Message\", EventLogEntryType.Error);\n    }\n    catch (Exception e)\n    {\n        // handle exception\n    }\n}\n\nprivate void GetNotificationData()\n{\n    DataSet myDataSet = new DataSet();\n    SqlCommand sqlCmd = new SqlCommand();\n    sqlCmd.Notification = null;\n\n    SqlDependency dependency = new SqlDependency(sqlCmd);\n    dependency.OnChange += new OnChangeEventHandler(dependency_OnChange);\n    evtLog.WriteEntry(\"Error Stage: GetNotificationData\" + \"Error desc:\" + \"Message\", EventLogEntryType.Error);\n}\n\nprivate void dependency_OnChange(object sender,SqlNotificationEventArgs e)\n{\n    SqlDependency dependency = (SqlDependency)sender;\n    dependency.OnChange -= dependency_OnChange;\n    this.GetNotificationData();\n    evtLog.WriteEntry(\"Error Stage: dependency_OnChange\" + \"Error desc:\" + \"Message\", EventLogEntryType.Error);\n}\n\nprotected override void OnStart(string[] args)\n{\n    CanRequestNotifications();\n    NotificationListener();\n}\n\nprotected override void OnStop()\n{\n    SqlDependency dependency = new SqlDependency();\n    dependency.OnChange -= dependency_OnChange;\n    SqlDependency.Stop(connString);\n}\n</code></pre>\n"},{"tags":["c#","unit-testing","moles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13276250,"title":"Mole HttpRequest.Files","body":"<p>I am unit testing a web application and I am using Moles to mock up a <code>HttpRequest</code>.  I am now trying to test some file upload functionality that uses <code>HttpRequest.Files</code>, so I am trying to find the correct way to mole out that functionality.  This is what I have tried so far, but calls to the <code>HttpRequest.Files.Count</code> are throwing a null reference exception.  I am guessing that I am not approaching something correctly in how I am constructing the <code>HttpFileCollection</code> object.  Can anyone provide some guidance or the correct way to mole out the <code>HttpFileCollection</code> object?</p>\n\n<pre><code> HttpRequest req = new HttpRequest(@\"C:\\SomeFile.txt\", \"http://localhost/VirtualPath/\", \"\");\n MHttpRequest mReq = new MHttpRequest(req)\n        {\n            InstanceBehavior = Microsoft.Moles.Framework.MoleBehaviors.Fallthrough,\n            FilesGet = () =&gt;\n                {\n                    HttpFileCollection collection = new HttpFileCollection();\n                    System.Web.Moles.MHttpFileCollection filecoll = new MHttpFileCollection(collection)\n                    {\n                        InstanceBehavior = Microsoft.Moles.Framework.MoleBehaviors.Fallthrough\n                    };\n\n                    System.Web.Moles.MHttpPostedFile file = new MHttpPostedFile();\n                    System.IO.MemoryStream ms = new System.IO.MemoryStream();\n                    Bitmap b = new Bitmap(100, 100);\n\n                    b.Save(ms, System.Drawing.Imaging.ImageFormat.Png);\n\n                    file.ContentLengthGet = () =&gt; { return (int)ms.Length; };\n                    file.ContentTypeGet = () =&gt; { return \"image/png\"; };\n                    file.FileNameGet = () =&gt; { return \"filename.png\"; };\n                    file.InputStreamGet = () =&gt; { return ms; };\n\n                    filecoll.ItemGetInt32 = value =&gt; { \n                        return file;\n                    };\n\n                    return filecoll;\n                }\n        };\n</code></pre>\n"},{"tags":["c#","codebehind","code-quality"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13295319,"title":"Instance field vs. passing method parameter","body":"<p>I've seen in some code different ways to pass around data within a class. Say for example we're in a user control (ASCX) and need to track something during various methods, e.g. the current domain object. One way is to create an instance (<code>currentPage</code>) in a field in the class and reference that in all the methods:</p>\n\n<pre><code>public partial class RelatedPagesListing : System.Web.UI.UserControl\n{\n    DomainPage currentPage = GetDomainPage();\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        SetLabels();\n        DoSomethingElse();\n        MoreStuffToDo();\n    }\n\n    private void SetLabels()\n    {\n        Literal1.Text = currentPage.GetName();\n        // other things with currentPage\n    }\n\n    private void DoSomethingElse()\n    {\n        // other things with currentPage\n    }\n\n    private void MoreStuffToDo()\n    {\n        // other things with currentPage\n    }\n}\n</code></pre>\n\n<p>Another way is to create that instance in the calling method (<code>Page_Load</code>) and pass it around as a parameter:</p>\n\n<pre><code>public partial class RelatedPagesListing : System.Web.UI.UserControl\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        DomainPage currentPage = GetDomainPage();\n        SetLabels(currentPage);\n        DoSomethingElse(currentPage);\n        MoreStuffToDo(currentPage);\n    }\n\n    private void SetLabels(DomainPage currentPage)\n    {\n        Literal1.Text = currentPage.GetName();\n        // other things with currentPage\n    }\n\n    private void DoSomethingElse(DomainPage currentPage)\n    {\n        // other things with currentPage\n    }\n\n    private void MoreStuffToDo(DomainPage currentPage)\n    {\n        // other things with currentPage\n    }\n}\n</code></pre>\n\n<p>I know the second way is better if I want to unit test or mock those method later as I can pass in that mocked value to each method as a parameter. However, other than this scenario, is one of the two ways considered bad code design?</p>\n"},{"tags":["c#","winforms","satellite-assembly"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13255599,"title":"How to get location of current culture's satellite assembly?","body":"<p>My C#/WF application uses some files, which are different for different languages. These file <strong>can not</strong> be placed as resources in satellite assemblies. I wish however to put them in the same directories as the satellite assemblies reside, but I need to know actually where the assembly resides (including the situation, when default language embedded in the binary file is used).</p>\n\n<p>For example, when application switches automatically to polish language, I wish to retreive location:</p>\n\n<p>D:\\&lt;app folder&gt;\\pl-PL\\</p>\n\n<p>Is there a way to do so? Please note, that I wish to retreive this information from the assembly and not by guessing the folder location.</p>\n\n<hr />\n\n<p>With help of Steve B, here's a solution:</p>\n\n<pre><code>string FindSatelliteAssemblyLocation(CultureInfo culture)\n{\n    if (culture == CultureInfo.InvariantCulture)\n        return Path.GetDirectoryName(Application.ExecutablePath);\n\n    try\n    {\n        Uri location = new Uri(Assembly.GetExecutingAssembly().GetSatelliteAssembly(culture).CodeBase);\n        return Path.GetDirectoryName(location.LocalPath);\n    }\n    catch\n    {\n        return FindSatelliteAssemblyLocation(culture.Parent);\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","ibm","clearquest"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":28,"score":1,"question_id":13294940,"title":"Clearquest query","body":"<p>I have been searching for a while and could not find a single example...</p>\n\n<p>Using C# and Clearquest API I would like to do something as simple as running a query \n(for example get a list of CR's by owner)</p>\n\n<p>If anyone could show a simple C# code I could start off with, it will be great...\nThanks!</p>\n"},{"tags":["c#","text","label","newline","windows-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13295116,"title":"Add NewLine to label's text design time","body":"<p>How can I add newline to label's text design time? There are some threads in stack for code-behind, but is there a thread about that for design time?</p>\n"},{"tags":["c#","html","asp.net-mvc","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13295259,"title":"Need stack views in Razor that allows me to hide the views or the fields","body":"<p>I have several partial views that I need to stack them on my web page.</p>\n\n<p>pv1  pv2</p>\n\n<p>pv3  pv4 </p>\n\n<p>pv5  pv6</p>\n\n<p>I also need to be able to hide any of them or even labels within each view.</p>\n\n<p>I tried using a table but I cannot get them to show up right.</p>\n\n<p>Here is an example of what I did:</p>\n\n<pre><code>&lt;h2&gt;AccountScreen&lt;/h2&gt;\n\n  &lt;table&gt;\n    &lt;tr&gt;\n      @Html.Partial(\"CustomerInfoPartialView\")\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      @Html.Partial(\"BalancePartialView\")\n    &lt;/tr&gt;\n  &lt;/table&gt;\n</code></pre>\n\n<p>That didn't turn out anything like I was hoping for, it was a mess.</p>\n\n<p>What should I use to stack my partial views and also be able to hide/show them programmatically?</p>\n"},{"tags":["c#","asp.net","oracle","connection-pooling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1054,"score":1,"question_id":2702003,"title":"ASP.NET Connection time out after being idle for a while","body":"<p>My ASP.NET website while trying to connect to the database for first time after a period of inactivity throws an time out exception.<br>\nI understand the connections in the connection pool get terminated after some idle time for some reason (Firewall or Oracle settings) and the pool or app doesn't have a clue about it.</p>\n\n<p>Is there any way to validate the connection beforehand so that the first try doesn't throw an exception?<br>\nI don't have much control over the DB or Firewall settings. So I have to deal with this is my application.(would prefer if there is any web.config settings)</p>\n\n<p>I am using: ASP.NET 2.0. Oracle server 11g, Microsoft Enterprise Library DAAB to do all my DB operations.\n<br><br><I>I did some search on this topic but didnt find any solid solution for this yet </i> :(</p>\n"},{"tags":["c#","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13294088,"title":"Get the next values I'm going to need on background threads before I need them","body":"<p>I'm hoping to find some advice on the best way to achieve fetching a bunch of id values (like a database Identity values) before I need them. I have a number of classes that require a unique id (int) and what I'd like to do is fetch the next available id (per class, per server) and have it cached locally ready. When an id is taken I want to get the next one ready etc.</p>\n\n<p>I've produced some code to demonstrate what I am trying to do. The code is terrible (it should contain locks etc.) but I think it gets the point across. Losing the odd id is not a problem - a duplicate id is (a problem). I'm happy with the guts of GetNextIdAsync - it calls a proc</p>\n\n<pre><code>this.Database.SqlQuery&lt;int&gt;(\"EXEC EntityNextIdentityValue @Key\", \n            new SqlParameter(\"Key\", key))).First();\n</code></pre>\n\n<p>on SQL Server that uses sp_getapplock to ensure each return value is unique (and incremental).</p>\n\n<pre><code>static class ClassId\n{\n    static private Dictionary&lt;string, int&gt; _ids = new Dictionary&lt;string,int&gt;();\n    static private Dictionary&lt;string, Thread&gt; _threads = new Dictionary&lt;string,Thread&gt;();\n\n    static ClassId()\n    {\n        //get the first NextId for all known classes\n        StartGetNextId(\"Class1\");\n        StartGetNextId(\"Class2\");\n        StartGetNextId(\"Class3\");\n    }\n\n    static public int NextId(string key)\n    {\n        //wait for a current call for nextId to finish\n        while (_threads.ContainsKey(key)) { }\n        //get the current nextId\n        int nextId = _ids[key];\n        //start the call for the next nextId\n        StartGetNextId(key);\n        //return the current nextId\n        return nextId;\n    }\n\n    static private void StartGetNextId(string key)\n    {\n        _threads.Add(key, new Thread(() =&gt; GetNextIdAsync(key)));\n        _threads[key].Start();\n    }\n\n    static private void GetNextIdAsync(string key)\n    {\n        //call the long running task to get the next available value\n        Thread.Sleep(1000);\n        if (_ids.ContainsKey(key)) _ids[key] += 1;\n        else _ids.Add(key, 1);\n        _threads.Remove(key);\n    }\n}\n</code></pre>\n\n<p>My question is - what is the best way to always have the next value I'm going to need before I need it? How should the class be arranged and where should the locks be? E.g. lock inside GetNextIdAsync() add the new thread but don't start it and change StartGetNextId() to call .Start()?</p>\n"},{"tags":["c#","winforms","mouse"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":8223,"score":7,"question_id":2411062,"title":"How to get control under mouse cursor?","body":"<p>I have form with few buttons and I want to know what button is under cursor now.</p>\n\n<p>P.S. Maybe it's duplicate, but I can't find answer to this question.</p>\n"},{"tags":["c#","asp.net",".net",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13293346,"title":"User Defined controls on web form","body":"<p>Using VS 2010, C#, .NET 3.5</p>\n\n<p>I have three User Defined Web Controls:</p>\n\n<p>Control 1 has a ListBox and A Button</p>\n\n<p>Control 2 has three <code>Text-Boxes</code> two <code>DropDownLists</code> and three <code>Buttons</code></p>\n\n<p>Control 3 has only a Table which is populated in code.</p>\n\n<p>I have two pages:</p>\n\n<p>Page 1 has Control 2 and Control 3</p>\n\n<p>Page 2 has Control 1, Control 2, and Control 3</p>\n\n<p>Functionality of Control 2 works perfectly on Page 1.</p>\n\n<p>However, on Page 2 when the submit button is clicked, both DropDownLists ALWAYS show <code>SelectedIndex = 0</code> and <code>SelectedValue = \"0\"</code>.</p>\n\n<p>All three Text Boxes and Buttons retain their value on both pages when the Submit Button on Control 2 is clicked. Only the DropDownLists fail to retain their value.</p>\n\n<p>For reference, here is the code in the Submit Button OnClick event:</p>\n\n<pre><code>    protected void btnSubmit_Click(object sender, EventArgs e)\n    {\n        clsLog.WriteLog(\"TrainingForm.ascx - Submit.\");\n        tcCategoryError.Text = \"&amp;nbsp;\";\n        tcDateError.Text = \"&amp;nbsp;\";\n        tcDescriptionError.Text = \"&amp;nbsp;\";\n        tcHoursError.Text = \"&amp;nbsp;\";\n        tcMethodError.Text = \"&amp;nbsp;\";\n        foreach (Control c in this.Controls)\n        {\n            LogControls(c);\n        }\n        c_iTID = Convert.ToInt32(hTID.Value);\n        c_szUserName = hUserName.Value;\n        bool bValid = true;\n        DateTime dtTrainingDate = DateTime.MinValue;\n        string szTrainingDescription = \"\";\n        decimal dHours = 0M;\n        int iCategoryID = 0;\n        int iMethodID = 0;\n        if (!DateTime.TryParse(txtTrainingDate.Text, out dtTrainingDate))\n        {\n            bValid = false;\n            tcDateError.Text = \"Please Enter Valid Training Date\";\n        }\n        if (!decimal.TryParse(txtTrainingHours.Text, out dHours))\n        {\n            bValid = false;\n            tcHoursError.Text = \"Please Enter Valid Training Hours\";\n        }\n        if (this.ddlCategory.SelectedValue == \"0\")\n        {\n            bValid = false;\n            tcCategoryError.Text = \"Please Select Training Category\";\n\n        }\n        else\n            iCategoryID = Convert.ToInt32(this.ddlCategory.SelectedValue);\n        if (this.ddlTrainingMethod.SelectedValue == \"0\")\n        {\n            bValid = false;\n            tcMethodError.Text = \"Please Select Training Method\";\n        }\n        else \n            iMethodID = Convert.ToInt32(this.ddlTrainingMethod.SelectedValue);\n        if (txtTrainingDescription.Text.Trim() == \"\")\n        {\n            bValid = false;\n            tcDescriptionError.Text = \"Please Enter Training description.\";\n        }\n        else\n            szTrainingDescription = txtTrainingDescription.Text.Trim();\n        if (bValid)\n        {\n            clsData.UpdateTraining(c_iTID, \"\", c_szUserName, dtTrainingDate, szTrainingDescription, iCategoryID, dHours, iMethodID);\n            TrainingID = 0;\n            ClearForm();\n        }\n        OnEvent(new MyEventArgs(c_szUserName));\n\n    }\n</code></pre>\n\n<p>Code to populate DropDowns (part of the User Defined Control)</p>\n\n<pre><code>    protected void BindddlCategory(int iCategoryID)\n    {\n        DataTable dt = clsData.GetTrainingCategories();\n        ddlCategory.Items.Clear();\n        ddlCategory.AppendDataBoundItems = true;\n        ddlCategory.Items.Add(new ListItem(\"Select Training Category\", \"0\"));\n        ddlCategory.DataSource = dt;\n        ddlCategory.DataTextField = \"TrainingCategory\";\n        ddlCategory.DataValueField = \"CID\";\n        ddlCategory.DataBind();\n        if (iCategoryID != 0)\n            ddlCategory.SelectedValue = iCategoryID.ToString();\n    }\n    protected void BindddlCategory()\n    {\n        BindddlCategory(0);\n    }\n    protected void BindddlTrainingMethod(int iMethodID)\n    {\n        DataTable dt = clsData.GetTrainingMethods();\n        ddlTrainingMethod.Items.Clear();\n        ddlTrainingMethod.AppendDataBoundItems = true;\n        ddlTrainingMethod.Items.Add(new ListItem(\"Select Training Method\", \"0\"));\n        ddlTrainingMethod.DataSource = dt;\n        ddlTrainingMethod.DataTextField = \"TrainingCategory\";\n        ddlTrainingMethod.DataValueField = \"CID\";\n        ddlTrainingMethod.DataBind();\n        if (iMethodID != 0)\n            ddlTrainingMethod.SelectedValue = iMethodID.ToString();\n    }\n    protected void BindddlTrainingMethod()\n    {\n        BindddlTrainingMethod(0);\n    }\n</code></pre>\n\n<p>FYI, the DDLs are NOT populated at Page load but implicitly populated when the event to show the form of the control is fired:</p>\n\n<pre><code>    public void ShowTrainingEntry(int iTrainingID)\n    {\n        clsLog.WriteLog(\"TrainingForm.ascx - ShowTrainingEntry(\" + iTrainingID.ToString() + \")\");\n        hTID.Value = iTrainingID.ToString();\n        hUserName.Value = UserName;\n        int iCategoryID = 0;\n        int iMethodID = 0;\n        if (iTrainingID != 0)\n        {\n            DataTable dt = clsData.GetTrainingRecord(iTrainingID);\n            if (dt.Rows.Count == 1)\n            {\n                txtTrainingDate.Text = Convert.ToDateTime(dt.Rows[0][\"TrainingDate\"]).ToString(\"MM/dd/yyyy\");\n                txtTrainingHours.Text = Convert.ToDecimal(dt.Rows[0][\"Hours\"]).ToString(\"N1\");\n                txtTrainingDescription.Text = dt.Rows[0][\"TrainingDescription\"].ToString();\n                int.TryParse(dt.Rows[0][\"CategoryCID\"].ToString(), out iCategoryID);\n                int.TryParse(dt.Rows[0][\"MethodCID\"].ToString(), out iMethodID);\n            }\n            ShowChangeMessage(iCategoryID == 0 | iMethodID == 0);\n            ShowDeleteButton(true);\n            ShowCancelButton(true);\n        }\n        BindddlCategory(iCategoryID);\n        BindddlTrainingMethod(iMethodID);\n        tblMain.Visible = true;\n    }\n</code></pre>\n\n<p>Anyone have any ideas on why this is happening?</p>\n\n<p>Thanks,\nJohn</p>\n"},{"tags":["c#","javascript","asp.net-mvc","controller"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13294914,"title":"Set a javascript variable from mvc controller","body":"<p>Is it possible to set a javascript variable from a c# controller?  We have a situation where we override our master page with a dumb downed version that doesn't require login for users.  However, our javascript timeout timer still runs.  I would like to in the controller method that overrides the master, to override the timeout to something huge.</p>\n\n<pre><code>public dumbDownController()\n{\n     ViewData[\"MasterPageOverride\"] = \"~/Views/Shared/_NoLogin.cshtml\";\n\n     //Somehow reset that timer below from 20 to like 9999. To simulate no timeout.\n\n     return View(\"Cities\", model);\n}\n</code></pre>\n\n<p>Then our javascript file has.</p>\n\n<pre><code>tb.sessionTimer = (function () {\n   var SESSION_TIMEOUT = 20;\n   var currentTimeoutCounter = SESSION_TIMEOUT * 60;\n ...\n lots more irrelevant to question\n ...\n }\n</code></pre>\n\n<p>Large app, so looking to barely change the javascript.  Would like to handle it from the controller.</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13290804,"title":"How do I change the Data source into Microsoft SQL Server in Visual C#?","body":"<p>I was using this <a href=\"http://razibdeb.wordpress.com/2011/01/23/sql-server-2008-basics-connection-with-vs2010/\" rel=\"nofollow\">tutorial</a> and I'm stuck in this <a href=\"http://razibdeb.files.wordpress.com/2011/01/ms-sql.png\" rel=\"nofollow\">part</a>. The guide tells me to choose 'Microsoft SQL Server', however this is not included in the options of my computer. I only have 'Microsoft Database File', 'Microsoft Server Compact', and 'Microsoft Database Server File'. </p>\n\n<p>How could I add the option 'Microsoft SQL Server'?</p>\n"},{"tags":["c#","roslyn-ctp","roslyn"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13287123,"title":"How do I programmatically add an assembly reference to a project?","body":"<p>I have been trying to use Roslyn to parse a solution file and programmatically add a custom assembly reference to each project in the solution.</p>\n\n<p>I tried using the following code snippet to do the same:</p>\n\n<pre><code>//The name of the DLL is customLib.dll\nvar reference = MetadataReference.CreateAssemblyReference(\"customLib\");\nproject = project.AddMetadataReference(reference);\n</code></pre>\n\n<p>However, it encounters a FileNotFoundException while creating the MetadataReference.</p>\n\n<p>So, my question is : <b>How do I specify the path at which Roslyn needs to check for the specified dll</b>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","windows"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13295308,"title":"How do I render an image directly on the desktop","body":"<p>as you see, there is a program in windows XP that names is \"Dancer\", a person is dancing when a song is playing..\nI want to create a program like this, an object will move when call that object.\nReally its a 3D-box that locate on Right-Down of desktop, when click on the box it will rotate..<br>\nHow i can do this?! i'm programming in C#, can I do this by c#?!</p>\n"},{"tags":["c#","azure","azure-worker-roles"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1069,"score":4,"question_id":4329451,"title":"Azure WorkerRole Stopping Immediately After Starting","body":"<p>I have an Azure WorkerRole that is stopping (no exceptions are being thrown) for no apparent reason. It stops in the same spot every time, but the code is simply executing a process that takes about 20 seconds to run. Can anyone postulate as to why this is happening? Is there a timeout on the OnStart() method that I'm not aware of?</p>\n\n<p>Here's a breakdown of what is happening in my worker role:</p>\n\n<p>OnStart() -> Diagnostics Configured</p>\n\n<p>Run() -></p>\n\n<ol>\n<li>A timer is set (60) to trigger the meat of the application</li>\n<li>A new thread is started to load some default settings (takes ~30 seconds)</li>\n</ol>\n\n<p>The code never gets to the meat of #1.</p>\n\n<p>For #1 above, I've tried it with and without a timer (no difference). For #2 above, I've tried it with and without starting a new thread (no difference). </p>\n\n<p>Here's the Debug output for my worker role:</p>\n\n<pre><code>WaWorkerHost.exe Information: 0 : deployment(108).ApiAzure.Workers.0 - Workers.OnStart()\nMicrosoft.WindowsAzure.ServiceRuntime Information: 202 : Role entrypoint . COMPLETED OnStart()\nThe thread 'Role Initialization Thread' (0x29fc) has exited with code 0 (0x0).\nMicrosoft.WindowsAzure.ServiceRuntime Information: 203 : Role entrypoint . CALLING   Run()\n'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Users\\Jason A. Kiesel\\Projects\\FS_CITYSOURCED\\WorkersAzure\\bin\\Stage\\WorkersAzure.csx\\roles\\Workers\\approot\\FreedomSpeaks.Logging.dll', Symbols loaded.\nMicrosoft.WindowsAzure.ServiceRuntime Warning: 204 : Role entrypoint . COMPLETED Run() ==&gt; ROLE RECYCLING INITIATED\nMicrosoft.WindowsAzure.ServiceRuntime Information: 503 : Role instance recycling is starting\nThe thread 'Role Start Thread' (0x1fa0) has exited with code 0 (0x0).\nThe thread '&lt;No Name&gt;' (0x1624) has exited with code 0 (0x0).\n'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Windows\\Microsoft.Net\\assembly\\GAC_64\\System.Data\\v4.0_4.0.0.0__b77a5c561934e089\\System.Data.dll'\n'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Windows\\Microsoft.Net\\assembly\\GAC_64\\System.Transactions\\v4.0_4.0.0.0__b77a5c561934e089\\System.Transactions.dll'\n'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Windows\\Microsoft.Net\\assembly\\GAC_64\\System.EnterpriseServices\\v4.0_4.0.0.0__b03f5f7f11d50a3a\\System.EnterpriseServices.dll'\n'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Windows\\Microsoft.Net\\assembly\\GAC_MSIL\\System.Numerics\\v4.0_4.0.0.0__b77a5c561934e089\\System.Numerics.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\nMicrosoft.WindowsAzure.ServiceRuntime Information: 205 : Role entrypoint . CALLING   OnStop()\nWaWorkerHost.exe Information: 0 : deployment(108).ApiAzure.Workers.0 - Workers.OnStop()\nMicrosoft.WindowsAzure.ServiceRuntime Information: 206 : Role entrypoint . COMPLETED OnStop()\nThe thread 'Role Stop Thread' (0x2dac) has exited with code 0 (0x0).\nThe program '[12228] WaWorkerHost.exe: Managed (v4.0.30319)' has exited with code -66053 (0xfffefdfb).\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":209,"score":0,"question_id":10364568,"title":"Connection timeout error while uploading bulk images","body":"<p>I have to upload 1000 to 1500 images at a time on server.. Code is as follows.</p>\n\n<pre><code>public void add_data()\n{\n DataSet ds = new DataSet();\n                ds = get_Data();\n                int p = 0;\n                if (ds.Tables.Count &gt; 0)\n                {\n                    if (ds.Tables[0].Rows.Count &gt; 0)\n                    {\n                        int cnt = ds.Tables[0].Rows.Count;\n                        while (cnt &gt; 0)\n                        {\n\n                            string url = Convert.ToString(ds.Tables[0].Rows[p][\"image_name\"]);\n                            string imagename = url.Substring(url.LastIndexOf('/') + 1);\n                            string file_name = imagename;\n\n                            save_file_from_url(file_name, url);\n                            p++;\n                            cnt = cnt - 1;\n                        }\n                    }\n                }\n}\n\n\n\npublic void save_file_from_url(string file_name, string url)\n    {\n        if (!File.Exists(file_name))\n        {\n\n            try\n            {\n                byte[] imgcontent;\n                //Convert live images into byte array to pass it for ftp server\n                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);\n                WebResponse response = request.GetResponse();\n\n                Stream stream = response.GetResponseStream();\n\n                using (BinaryReader br = new BinaryReader(stream))\n                {\n                    imgcontent = br.ReadBytes(500000);\n                    br.Close();\n                }\n                response.Close();\n\n                string CompleteDPath = \"www.xyz.com\";\n                string UName = \"abc\";\n                string PWD = \"pwd\";\n                WebRequest reqObj = WebRequest.Create(CompleteDPath + file_name);\n                reqObj.Method = WebRequestMethods.Ftp.UploadFile;\n                reqObj.Credentials = new NetworkCredential(UName, PWD);\n                reqObj.GetRequestStream().Write(imgcontent, 0, imgcontent.Length);\n                reqObj = null;\n\n\n            }\n            catch (Exception ex)\n            {\n                lblmessage.ForeColor = System.Drawing.Color.Red;\n                lblmessage.Text = ex.Message;\n            }\n        }\n    }\n</code></pre>\n\n<p>But it gives following error that</p>\n\n<p>The following error was encountered:</p>\n\n<pre><code>Read Timeout \n</code></pre>\n\n<p>The system returned:</p>\n\n<pre><code>[No Error]\n</code></pre>\n\n<p>A Timeout occurred while waiting to read data from the network. The network or server may be down or congested. Please retry your request.</p>\n\n<p>Your cache administrator is webmaster.</p>\n\n<p>What should i use? Please help!</p>\n"},{"tags":["c#","custom-controls","winrt","winrt-xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13292687,"title":"Custom control and TemplateBinding in WinRT","body":"<p>I'm trying to create a simple custom control that shows a circle. This control has a Radius property but unfortunately it doesn't apply to the control. Here is a template:</p>\n\n<pre><code>&lt;Style TargetType=\"local:SizedCircle\"&gt;\n    &lt;Setter Property=\"VerticalAlignment\" Value=\"Center\"/&gt;\n    &lt;Setter Property=\"HorizontalAlignment\" Value=\"Center\" /&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"local:SizedCircle\"&gt;\n                &lt;Border\n                    Background=\"{TemplateBinding Background}\"\n                    BorderBrush=\"{TemplateBinding BorderBrush}\"\n                    BorderThickness=\"{TemplateBinding BorderThickness}\"&gt;\n                    &lt;Ellipse Width=\"{TemplateBinding Radius}\" Height=\"{TemplateBinding Radius}\"&gt;\n                        &lt;Ellipse.Fill&gt;\n                            &lt;SolidColorBrush Color=\"Red\"/&gt;\n                        &lt;/Ellipse.Fill&gt;\n                    &lt;/Ellipse&gt;\n                &lt;/Border&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>And</p>\n\n<pre><code>    namespace CustomControls\n{\n    public sealed class SizedCircle : Control\n    {\n        public SizedCircle()\n        {\n            this.DefaultStyleKey = typeof(SizedCircle);\n        }\n\n        public string Radius\n        {\n            get { return (string)GetValue(RadiusProperty); }\n            set { SetValue(RadiusProperty, value); }\n        }\n\n        // Using a DependencyProperty as the backing store for Radius.  This enables animation, styling, binding, etc...\n        public static readonly DependencyProperty RadiusProperty =\n            DependencyProperty.Register(\"Radius\", typeof(string), typeof(SizedCircle), new PropertyMetadata(null));\n}\n}\n</code></pre>\n\n<p>Then I try to use this control:</p>\n\n<pre><code> &lt;local:SizedCircle Radius=\"50\" /&gt;\n</code></pre>\n\n<p>But I see nothing on the screen. This Radius property is not applyed. What am I douing wrong?</p>\n"},{"tags":["c#","asp.net","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13294314,"title":"How can I create SQL Query which Takes Parameters from URL in asp.net C#","body":"<p>my link is like </p>\n\n<pre><code>http://localhost/default.aspx?phone=9057897874&amp;order=124556\n</code></pre>\n\n<p>Here Is my basic Page for passing Parameter In URL from ASP.net</p>\n\n<pre><code>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeBehind=\"Default.aspx.cs\"     Inherits=\"WebApplication2._Default\" %&gt;\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"   \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" &gt;\n&lt;head runat=\"server\"&gt;\n&lt;title&gt;Untitled Page&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form method=\"get\" action=\"default.aspx\"&gt;\n\n&lt;label&gt;Phone No&lt;/label&gt;\n&lt;input type=\"text\" name=\"phone\" /&gt;\n&lt;br /&gt;\n&lt;label&gt;Order No&lt;/label&gt;\n&lt;input type=\"text\" name=\"order\" /&gt;\n&lt;br /&gt;\n&lt;input type=\"submit\" value=\"submit\" /&gt;\n&lt;br /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>my c# file where I can store the prameters in Variables </p>\n\n<pre><code>namespace WebApplication2\n {\npublic partial class _Default : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        string strQuery;\n\n        string phone = Request.QueryString[\"phone\"];\n        if (phone != null)\n        {\n            Response.Write(\"phone no is \");\n            Response.Write(phone);\n        }\n        else\n\n        {\n            Response.Write(\"You phone number is not correct\");\n        }\n\n        string order_no = Request.QueryString[\"order\"];\n        if (order_no != null)\n        {\n            Response.Write(\"Order No is \");\n            Response.Write(order_no);\n        }\n        else\n        {\n            Response.Write(\"You Order number is not correct\");\n        }\n\n//How I can Connect to Mysql Server\n\n        strQuery = \"SELECT order_status where orde01=''\" + order_no + \"'' and phone01=''\" + phone + \"''\";\n\n        Response.Write(strQuery);\n}\n}\n</code></pre>\n\n<p>I'm trying to doing something like this but it's only give me whole query as string.\nI am new on this topic.\nAny help will be appreciate\nThanks </p>\n"},{"tags":["c#","xml","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":61,"score":1,"question_id":13289320,"title":"C# Linq to XML add, update, delete","body":"<p>I have this code</p>\n\n<pre><code>        XElement newClient= new XElement(\"Client\",\n            new XElement(\"Name\", cmbClient.Text),\n            new XElement(\"Service\",\n                new XElement(\"ServName\", cmbService.Text)));\n        xmlDoc.Add(newClient);\n        xmlDoc.Save(\"Settings.xml\");\n</code></pre>\n\n<p>Which creates this</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Clients&gt;\n  &lt;Client&gt;\n    &lt;Name&gt;Client Name&lt;/Name&gt;\n    &lt;Services&gt;\n      &lt;ServName&gt;Service Name&lt;/ServName&gt;\n    &lt;/Services&gt;\n  &lt;/Client&gt;\n&lt;/Clients&gt;\n</code></pre>\n\n<p>If i press again Button1, then It will create another Client section, that's OK but what I want is:</p>\n\n<ol>\n<li>Create a new Client section if it does <strong>not</strong> exists. </li>\n<li>If Client exists, then <strong>add</strong> a ServName to it, instead of replacing\nwhat already has.</li>\n<li>If a service already exists on a client, then do nothing, because already exists.</li>\n</ol>\n\n<p>Any clue? I'm starting with linq to xml... thanks in advice!</p>\n"},{"tags":["c#",".net","iis","iis-express","directoryinfo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":16,"score":0,"question_id":13295260,"title":"Get full path to file while debugging using IIS Express","body":"<p>I have a .NET application that I am trying to debug and part of my application loads a file from my project.  This file is located at</p>\n\n<pre><code>C:\\Users\\USER_FOLDER\\Documents\\Visual Studio 2012\\Projects\\MY_PROJECT\\_templates\\myFile.html\n</code></pre>\n\n<p>In my code, I specify a relative path to the file and use the DirectoryInfo class to get the full directory path to my file:</p>\n\n<pre><code>string myFile = (new DirectoryInfo(\"_templates/myFile.html\")).FullName;\n</code></pre>\n\n<p>However, this returns the following path (extra \\'s as escape characters):</p>\n\n<pre><code>\"C:\\\\Program Files\\\\IIS Express\\\\_templates\\\\myFile.html\"\n</code></pre>\n\n<p>I was expecting the path that is returned when debugging in IIS Express would match the first path I listed, not the third.  Why is this?  Is there something else that I need to set up in my project to have it derive the paths properly?  I'm assuming that this would not happen if I deployed my code to a II7 site, but I haven't gotten to that testing level yet.</p>\n"},{"tags":["c#","wpf","codebehind"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2683,"score":0,"question_id":4002290,"title":"Setting Font of TextBox from code behind","body":"<p>This maybe a stupid question but how do I set the font of a <code>TextBox</code> from a <code>string</code> in the code behind? </p>\n\n<pre><code>// example\ntxtEditor.FontFamily = \"Consolas\";\n</code></pre>\n"},{"tags":["c#","windows-8","listboxitem","windows-store-apps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13295001,"title":"Changing the background color of a ListBoxItem","body":"<p>I'm writing a Windows Store app in C#, how would one go about changing the background color of a ListBoxItem? </p>\n"},{"tags":["c#","visual-studio-2010","unit-testing","slowcheetah","xml-transform"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12866620,"title":"Using xml transformations in unit tests","body":"<h2>Background:</h2>\n\n<p>Currently we have around 10 unit/integration test projects that hit a database to do tests.  Each test class that hits the database inherits from a class called <code>IntegrationTest</code> which is in a seperate dll called <code>TestBase</code>. <code>TestBase</code> contains a configuration file (nhibernate_log4net.cfg.xml) that houses the connection string to the database. </p>\n\n<p>Our development team is a group of about 7 or 8.  If two team members were to run the unit tests at the same time there would be conflicts because a lot of the tests are adding and deleting data that is common across many tests.  This would cause tests to fail erroneously between the two developers.</p>\n\n<h2>Layout:</h2>\n\n<p><strong>TestBase.dll</strong><br>\nIntegrationTest.cs  (Contains <strong>[DeploymentItem(\"nhibernate_log4net.cfg.xml\"]</strong>)<br>\nnhibernate_log4net.cfg.xml<br>\nnhibernate_log4net.cfg.Developer 1.xml  (Transformation file)<br>\nnhibernate_log4net.cfg.Developer 2.xml  (Transformation file)<br>\n...</p>\n\n<p><strong>UnitTest.dll</strong><br>\nReferences -> <strong>TestBase.dll</strong><br>\nMyUnitTest.cs (Inherits from IntegrationTest in <strong>TestBase.dll</strong>)  </p>\n\n<h2>Problem:</h2>\n\n<p>My idea was to use <code>SlowCheetah</code> xml transformations on the configuration file in the <code>TestBase</code> dll for each developer in the team but the transformed file does not get copied to the <strong>Out</strong> directory of the unit test. The base configuration file (non transformed one) is the one that gets copied out to the <strong>Out</strong> directory.  I have a feeling it's because of the <code>[DeploymentItem(\"nhibernate_log4net.cfg.xml\")</code> attribute I have to use to get the config file out there in the first place.</p>\n\n<p><strong>Is there any way to use xml transformations on an xml config file that is included in a separate dll than the unit testing project?</strong></p>\n"},{"tags":["c#","winforms","propertygrid","typeconverter"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":24,"score":0,"question_id":13295151,"title":"Why does TypeConverter.CanConvertFrom always provide 'string' in 'sourceType'?","body":"<p><BR>\nI have a PropertyGrid which I use for a class which has a property that I would like to populate using an existing list of suitable values.</p>\n\n<p>In order to achieve this I extend TypeConverter like this to show a drop down list:</p>\n\n<pre><code>public class BaseDefinitionTypeConverter : TypeConverter\n{\n    protected Dictionary&lt;string, BaseDefinitionWrapper&gt; mapping = new Dictionary&lt;string, BaseDefinitionWrapper&gt;();\n\n    public override bool GetStandardValuesSupported(ITypeDescriptorContext context) {\n        return true; // display drop\n    }\n\n    public override bool GetStandardValuesExclusive(ITypeDescriptorContext context) {\n        return true; // drop-down vs combo\n    }\n\n    public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context) {\n        mapping.Clear();\n\n        //Since everything is passed in as string a conversion is needed. \"mapping\" provides for that\n        foreach (BaseDefinitionWrapper baseDef in BaseDefinitionWrapper.allWrappers) {\n            mapping.Add(baseDef.ToString(), baseDef);\n        }\n\n        return new StandardValuesCollection(BaseDefinitionWrapper.allWrappers);\n    }\n\n    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType) {\n        //sourceType is ALWAYS string\n        return sourceType == typeof(string);\n    }\n\n    public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value) {\n        //returns the actual selected object to the property grid. value is ALWAYS string.\n        return mapping[value.ToString()];\n    }\n}\n</code></pre>\n\n<p>Used like:</p>\n\n<pre><code>[TypeConverter(typeof(BaseDefinitionTypeConverter))]\npublic BaseDefinitionTypeWrapper XYZ {\n  get; set;\n}\n</code></pre>\n\n<p>You can see that my backing list is BaseDefinitionWrapper.allWrappers.</p>\n\n<p>Question #1) Why is sourceType in CanConvertFrom and value in ConvertFrom always string although the StandardValuesCollection is of a different type? Seems like the PropertyGrid only uses the toString() method of an element in the drop down list and passes that on.</p>\n\n<p>I have the problem that the key value between the creation of the 'mapping' dictionary in \"GetStandardValues\" (baseDef.toString()) and the call to 'mapping' in \"ConvertFrom\" (value.ToString()) the actual value of the key (in the parameter 'value') can change(!) thus leading to an exception since the key could not be found. The object behind however does not change!</p>\n\n<p>Question #2) How can I get the selected object from the drop down list whitout having to convert it from string which is not always possible (see above)? Is there a way to get the selected index of this drop down box as some kind of workaround?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["c#",".net","recursion"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13294390,"title":"Recursive search of file/folder strucutre","body":"<p>I am trying to build a recursive search function for a web service that returns a list of files and folders. I created the two methods so they act as recursive search, it first goes and gets the top level contents, then it adds any files to the fileList, and any sub folders to the subFoldersList. We pass in the access level (in our case root) and then the path which you want the information for. If any folders were found it then removes the top folder because it has begun the search for that folder. Then it calls the processDirectories method, which passes back to getFiles the new path location starting the process all over again. Right now for testing my folder structure is below. When it goes to add the second file (profilepic.png) to the list. I get an error \"Collection was modified; enumeration operation may not execute.\" What is causing this error?</p>\n\n<pre><code>Photos\n    picture1.png\n    TestFolder\n        profilepic.png\n</code></pre>\n\n<p>my code:</p>\n\n<pre><code>    public static List&lt;string&gt; fileList = new List&lt;string&gt;();\n    public static List&lt;string&gt; subFolderList = new List&lt;string&gt;();\n\n    static void processDirectories(string access, string Folder)\n    {\n        getFiles(access, Folder);\n    }\n\n    static void getFiles(string access, string Folder)\n    {\n        var accessToken = new OAuthToken(token, secret);\n        var api = new DssAPI(ConsumerKey, ConsumerSecret, accessToken);\n        var folder = api.GetContents(access, Folder);//Get list from WebService\n\n        foreach (var item in folder.Contents)//Contents is an IEnumerable\n        {\n            if (item.IsDirectory == true)\n                subFolderList.Add(item.Path);\n            else\n                fileList.Add(item.Path);\n        }\n\n        foreach (var subFolder in subFolderList)\n        {\n            subFolderList.RemoveAt(0);\n            processDirectories(root, subFolder);\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","wpf","linq","entity-framework","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13295117,"title":"Error while creating an editable DataGrid","body":"<p>I've managed to stump myself with LINQ. I am trying to create an editable datagrid in a WPF app using a subset gathered from a LINQ query:</p>\n\n<pre><code>var LookUpEvents = from d in ThisData.Events.Local\n                   where d.StartDate.Value.Date &lt;= DateTime.Now.Date &amp;&amp;\n                   (d.EndDate.HasValue == false || d.EndDate.Value.Date &gt;= DateTime.Now.Date)\n                   select d;\nRangeEventGrid.ItemsSource = LookUpEvents;\nRangeEventGrid.Items.Refresh();\n</code></pre>\n\n<p>This query works, and the datagrid is populated however I am unable to edit the datagrid, when trying to this exception is thrown:</p>\n\n<pre><code>\"'EditItem' is not allowed for this view.\"\n   at System.Windows.Controls.ItemCollection.System.ComponentModel.IEditableCollectionView.EditItem(Object item)\n   at System.Windows.Controls.DataGrid.EditRowItem(Object rowItem)\n</code></pre>\n\n<p>When loading the full dataset using:</p>\n\n<pre><code>ThisData.Events.Load();\nFullEventGrid.ItemsSource = ThisData.Events.Local;\n</code></pre>\n\n<p>Everything works fine and the data is editable. The XAML used is identical (I have also tried swapping the bound datagrids and the full result remains editable and the query throws the exception still) and the only difference between these is the query. When I try to change the query I end up with a new exception:</p>\n\n<pre><code>The specified type member 'Date' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.\n</code></pre>\n\n<p>The query used for that:</p>\n\n<pre><code>var LookUpEvents = from d in ThisData.Events\n                   where d.StartDate.Value.Date &lt;= DateTime.Now.Date &amp;&amp;\n                   (d.EndDate.HasValue == false || d.EndDate.Value.Date &gt;= DateTime.Now.Date)\n                   select d;\nLookUpEvents.Load(); //Exception thrown here.\nRangeEventGrid.ItemsSource = LookUpEvents;\nRangeEventGrid.Items.Refresh();\n</code></pre>\n\n<p>The really weird thing about that exception (weird to me at least) is that I use DateTime comparison in other queries that do not throw any exceptions, for example this query in another place works fine:</p>\n\n<pre><code>var LookUpSessions = from d in ThisData.Sessions\n                     where d.EndTime.Hour &gt;= (DateTime.Now.Hour - 1) &amp;&amp; d.StartTime.Hour &lt;= (DateTime.Now.Hour + 2)\n                     &amp;&amp; d.Event.IsActive == true\n                     orderby d.StartTime.Hour, d.StartTime.Minute\n                     select d;\n</code></pre>\n\n<p>Is it not possible to bind a LINQ query result to a DataGrid to be editable? That seems like it'd be a huge oversight if that's the case. I feel like it's much more likely I'm just missing something basic since LINQ, WPF and EF are all brand new to me.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","facebook","facebook-graph-api","facebook-c#-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13287428,"title":"Post on my own Facebook page as admin C#","body":"<p>i have my facebook page for website. i want to post on it through website as admin. i am using facebook c# sdk. I found several methods to post on user behalf but not getting any way to post as admin. Can anybody explain an easy way to do this? Thanks...</p>\n"},{"tags":["c#","asp.net-mvc-4","fluentvalidation"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13267676,"title":"fluentvalidation does not show error or update Modelstate","body":"<p>This is my code I have setup with the latest fluent validation library.</p>\n\n<pre><code>public class ReleaseViewModelValidator : AbstractValidator&lt;ReleaseViewModel&gt; \n{ \n   public ReleaseViewModelValidator() {\n     RuleFor(r =&gt; r.Name).NotEmpty().Length(1, 30).WithMessage(\"Name must not be longer than 30 chars.\"); \n  } \n}\n\n[FluentValidation.Attributes.Validator(typeof(ReleaseViewModel))]\n public class ReleaseViewModel { public int ReleaseId { get; set; }\n\n[Remote(\"ReleaseExists\", \"Release\", ErrorMessage = \"This name already exists.\")]\npublic string Name { get; set; } \npublic DateTime CreatedAt { get; set; } }\n</code></pre>\n\n<p><strong>GlOBAL.ASAX:</strong> </p>\n\n<pre><code> FluentValidationModelValidatorProvider.Configure();\n</code></pre>\n\n<p><strong>VIEW:</strong> </p>\n\n<pre><code> model ILMD.Web.Models.ReleaseViewModel @* Remote Validation*@ &lt;script src=\"@Url.Content(\"~/Scripts/jquery.validate.unobtrusive.min.js\")\" type=\"text/javascript\"&gt;&lt;/script&gt;\n @using (Html.BeginForm(\"Create\", \"Release\")) \n {\n &lt;p class=\"editor-label\"&gt;@Html.LabelFor(model =&gt; model.Name)&lt;/p&gt; \n &lt;p class=\"editor-field\"&gt;@Html.EditorFor(model =&gt; model.Name)&lt;/p&gt; \n &lt;p class=\"editor-field\"&gt;@Html.ValidationMessageFor(model =&gt; model.Name)&lt;/p&gt; \n }\n</code></pre>\n\n<hr>\n\n<p>All my unit tests for the <code>ReleaseViewModelValidator</code> show green light. Fine.</p>\n\n<p>But less cool is that entering some live data like 31 chars or entering nothing I do not see any client side error message.</p>\n\n<p>Do I still have to include something in my partial view? The <code>ModelState</code> is also not correct its always true.  </p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":25,"score":-1,"question_id":13293595,"title":"Generate a byte sequence with fixed size from a string","body":"<p>I want to create a byte sequence with a fixed length out of a string which has a variable length. What is the best way to archive this. All bytes should be as different as possible.</p>\n\n<h3>The code is used for research for myself, nothing productive.</h3>\n\n<p>This has been my first approach for the generation of the bytes:</p>\n\n<pre><code>static byte[] GenerateBytes(string password, Int32 strength)\n{\n    Byte[] result = new byte[strength];\n    Byte[] pwBytes = Encoding.ASCII.GetBytes(password);\n    Int32 prime = GetLowerPrime(pwBytes.Length);\n\n    // Offset count to avoid values\n    Int32 count = prime;\n    Int32 sum = 0;\n    for (int i = 0; i &lt; result.Length; i++) {\n        sum += (result[i] = pwBytes[(count++ % pwBytes.Length)]);\n    }\n\n    count += prime;\n    Int32 pcount = prime;\n    for (int i = 0; i &lt; result.Length * 7; i++) {\n        result[(i % result.Length)] ^= (Byte)(pwBytes[(count++ % pwBytes.Length)] ^ ((pcount += pwBytes[(count % pwBytes.Length)]) % 255));\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>And generated some samples with 256 / 128 / 64 generated bytes and counted the unique bytes:</p>\n\n<pre><code>Password \"Short\":                170  103  60\nPassword \"LongerX\":              173  101  55\nPassword \"Really Long\":          169  100  57\nPassword \"Unbelivable Safe!0§$\": 162  101  56\nPassword \"MCV\":                  119  113  61\nPassword \"AAA\":                  50   51   50\nPassword \"BBB\":                  67   67   52\nPassword \"AAAAAA\":               48   48   48\n</code></pre>\n\n<p>I tried to change the prime selector a bit this improves the generation with short keys but has partly a impact on long ones. I also tracked some statistics of the bytes. Generated and each byte value is used between 9 and 30 times.</p>\n\n<h3>What do you think about the results? How can i improve the generation of the bytes?</h3>\n"},{"tags":["c#",".net","entity-framework","ef-code-first"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13294780,"title":"EF 5 Code First DbMigration automation","body":"<p>I'm using EF 5 with the Code First Approach.</p>\n\n<p>I'm having trouble setting the default <code>DateTime</code> value of a column to a <code>(getdateutc())</code></p>\n\n<p>What I want to do is have EF set up tables with this value speficied, and the only way I've found that it's possible is to use <code>DbMigrations</code> (Up and Down methods). Are the any other ways ? </p>\n\n<p>I have a base class looking like this</p>\n\n<pre><code> public abstract class BASE_AUDITED : BASE\n {              \n      [IgnoreDataMember, IgnoreMap]\n      public DateTime Created { get; set; }\n\n      [IgnoreDataMember, IgnoreMap]\n      public DateTime Modified { get; set; }\n\n      [MaxLength(50)]\n      [IgnoreDataMember, IgnoreMap]\n      public string CreatedBy { get; set; }\n\n      [MaxLength(50)]\n      [IgnoreDataMember, IgnoreMap]\n      public string ModifiedBy { get; set; }\n }\n\n public abstract class BASE \n {\n      [IgnoreMap]\n      public int id { get; set; }\n }\n</code></pre>\n\n<p>And a bunch of classes inheriting from it.\nWhat I'd like to do is be able to access the model (using <code>fluentAPI</code> for mapping)in the DBMigrations Up method, and write a loop there to take care of all the the objects inheriting from <code>Base_audited</code></p>\n\n<p>In other words I'm trying to avoid writing following code for each and every object I add, </p>\n\n<pre><code>AlterColumn(\"T70_AccountService.CONTACT\", \"TestClmn\", c =&gt; c.DateTime(nullable: false, defaultValueSql: \"(getutcdate())\"));\n</code></pre>\n\n<p>But rather have smth like this </p>\n\n<pre><code> var types = ReflectionHelper.TypesImplementingInterface(typeof (BASE_AUDITED));\n            foreach (var type in types)\n            {\n               var tableName = Context.FindTableNameFor(type);\n               AlterColumn(tableName , \"Created\", c =&gt; c.DateTime(nullable: false, defaultValueSql: \"(getutcdate())\"));\n               AlterColumn(tableName , \"Modified\", c =&gt; c.DateTime(nullable: false, defaultValueSql: \"(getutcdate())\"));\n\n            }\n</code></pre>\n\n<p>In short - I cannot find what table is the object mapped to in the DbMigrations Up method..</p>\n\n<pre><code> var tableName = Context.FindTableNameFor(type);\n</code></pre>\n"},{"tags":["c#","c++","sdk","sapi","speech"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2621,"score":1,"question_id":1737147,"title":"how to use Speech SDK 5.1","body":"<p>i recently downloaded Microsoft Speech SDk 5.1 and i want to learn that how to use it. Please suggest me some websites and links where i can find tutorials on using it from basic using C# or C++.</p>\n\n<p>thanx</p>\n\n<p>with regards :)</p>\n"},{"tags":["c#","java","assemblies","packages"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":58,"score":4,"question_id":13294831,"title":"Java package vs c# assemblies","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3629291/is-a-java-package-the-equivalent-of-a-net-assembly\">Is a Java package the equivalent of a .Net assembly?</a>  </p>\n</blockquote>\n\n\n\n<p>I was comparing the access modifiers in Java and C#.</p>\n\n<p>In java the default access allows access to the class being modified to everything in the package that the class is in.  In C# the internal access modifier allows access to the class being modified to everything in the assembly that the class is in. </p>\n\n<p>Are Java packages the same as C# assemblies, if not what is the difference.</p>\n"},{"tags":["c#",".net","visual-studio-2010","t4","visual-studio-sdk"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":26,"score":4,"question_id":13294889,"title":"T4 Template - How do you add an assembly reference programmatically?","body":"<p>I'm using the T4 TextTemplating service from a VSPackage:</p>\n\n<pre><code>var t4 = this.GetService(typeof(STextTemplating)) as ITextTemplating;\n</code></pre>\n\n<p>Normally if a template is referencing types in an external assembly you can use the <code>assembly</code> directive. However, I don't know the assembly until runtime, so is there anyway of adding assembly references to the T4 engine programmatically?</p>\n"},{"tags":["c#","loops","button"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13294789,"title":"Is there a way to change buttons created in the form editor using the given loop?","body":"<p>My form is composed of a 3x3 array and 9 buttons that were created using the form editor; each button is given an identifier such as btn1, btn2, all the way through to btn9. The methods DisableButton and EnableButton take a button as a parameter. Is there any way I could pass all the buttons to one method or the other using the for loops below?</p>\n\n<pre><code>        for (int r = 0; r &lt; myArray.GetLength(0); r++)\n        {\n            for (int c = 0; c &lt; myArray.GetLength(1); c++)\n            {\n                if (numericUpDown.Value &gt; myArray[r, c] || myArray[r, c] == 0)\n                    DisableButton(btn1);// new button parameter on each repeat\n                else\n                    EnableButton(btn1);                    \n            }\n        }\n</code></pre>\n\n<p>For the next repetition I want btn1 to change to btn2, then btn2 to btn3 and so on until each of the buttons are turned on or off.  </p>\n"},{"tags":["c#","entity-framework","nunit","dbcontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12882826,"title":"Why am I getting DbContext Has Changed exception when using NUnit?","body":"<p>I'm using Entity Framework 5 in my project. And I wanted to test some new funcionalities.</p>\n\n<p>What happened is that eventhough my db is UPDATED, (when I add a migration it does not add anything else) and eventhough if I run my project it runs just fine. When I try to test the project with NUNIT I get this exception:</p>\n\n<p><code>System.InvalidOperationException : The model backing the 'DbContext' context has changed since the database was created. Consider using Code First Migrations to update the database</code></p>\n\n<p>Has any of you have this problem? If so how can I solve it?</p>\n"},{"tags":["c#","serialization","deserialization","ntp","osi"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":13148546,"title":"Representation of bits and their serialisation in .Net","body":"<p>I am practising implementing some basic layer 7 protocols but I am unsure of the best way of serialising and deserialising bits in the .Net framework. </p>\n\n<p>According to the <a href=\"http://msdn.microsoft.com/en-us/library/47zceaw7%28v=vs.71%29.aspx\" rel=\"nofollow\">MSDN Data Type Summary</a>, there is no bit data type. I have no idea how I would go about creating such a data type or even if it's possible so I am left with serialising/deserialising to a byte / byte array.</p>\n\n<p>Given the following example from the top of an NTP packet:</p>\n\n<pre><code>     0-1         LeapIndicator (LI)      2 bits\n     2-4         VersionNumber (VN)      3 bits\n     5-7         Mode                    3 bits\n     8-15        Stratum                 8 bits\n</code></pre>\n\n<p>I would like to encode into 2 bytes so I can send via the socket.</p>\n\n<p>Also, I am currently using ints to represent the bits in enums, is it possible to use bits/hex or something a better than ints? For example the mode enum is defined as follows:</p>\n\n<pre><code>public enum Mode\n{\n    /*\n     +-------+--------------------------+\n     | Value | Meaning                  |\n     +-------+--------------------------+\n     | 0     | reserved                 |\n     | 1     | symmetric active         |\n     | 2     | symmetric passive        |\n     | 3     | client                   |\n     | 4     | server                   |\n     | 5     | broadcast                |\n     | 6     | NTP control message      |\n     | 7     | reserved for private use |\n     +-------+--------------------------+\n     */\n\n    Resevered = 0,\n    SymmetricActive = 1,\n    SymmetricPassive = 2,\n    Client = 3,\n    Server = 4,\n    Broadcast = 5,\n    ControlMessage = 6,\n    PrivateUse = 7\n}\n</code></pre>\n\n<p>Side Note: The code for this project will eventually be open sourced, please bare in mind that if you answer. If you do not wish for the code to be shared, please say :) A link will be placed in the code back to this question.</p>\n\n<p>Thanks in advance :)</p>\n\n<p>Update: In case people are wondering what the NTP packet structure looks like, taken directly from <a href=\"http://www.ietf.org/rfc/rfc5905.txt\" rel=\"nofollow\">RFC 5905, page 18</a></p>\n\n<pre><code>        0                   1                   2                   3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |LI | VN  |Mode |    Stratum     |     Poll      |  Precision   |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                         Root Delay                            |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                         Root Dispersion                       |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                          Reference ID                         |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                     Reference Timestamp (64)                  +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Origin Timestamp (64)                    +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Receive Timestamp (64)                   +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Transmit Timestamp (64)                  +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        .                                                               .\n        .                    Extension Field 1 (variable)               .\n        .                                                               .\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        .                                                               .\n        .                    Extension Field 2 (variable)               .\n        .                                                               .\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                          Key Identifier                       |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        |                            dgst (128)                         |\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n"},{"tags":["c#","relative-path","openfiledialog"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13294503,"title":"Get relative path from OpenFileDialog in C#","body":"<p>I am a beginner at programing and I´m writing my second Prog.\nI have a Question about how to get a relative path to my application Startup path.\nThe Program reads an .xml-file that has a path of a .jpg stored in it. It creates a Picturebox for every path and loads the respective image.\nThe problem I have is, that I have the images in my Dropbox to be able to use the Program on any PC that has Dropbox. When I use the OpenFileDialog on my main PC and save the Path of the .jpg to the xml it won´t work on my laptop because the Dropbox folder is on another drive as on my main PC.</p>\n\n<p>Does anyone have an idea, how to get around this Problem?</p>\n"},{"tags":["c#",".net","log4net","log4net-appender"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13286124,"title":"Header and footer coming two times more in log4net logs","body":"<p>Below is the Section of log4net from app.config</p>\n\n<blockquote>\n<pre><code>   &lt;configSections&gt;\n   &lt;section name=\"log4net\" type=\"log4net.Config.Log4NetConfigurationSectionHandler,     log4net\" /&gt;\n     &lt;/configSections&gt;      \n        &lt;log4net debug=\"true\"&gt;\n  &lt;appender name=\"LogFileAppender\" type=\"log4net.Appender.FileAppender\"&gt;\n     &lt;file type=\"log4net.Util.PatternString\" value=\"${TMP}\\SRG\\Logs\\Log_%env{USERNAME}_%date{yyyyMMdd}.log\" /&gt;\n     &lt;appendToFile value=\"true\" /&gt;\n     &lt;bufferSize value=\"20\" /&gt;\n     &lt;LockingModel type=\"log4net.Appender.FileAppender+MinimalLock\"/&gt;\n     &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n     &lt;header type=\"log4net.Util.PatternString\" value=\"[Log Starts]%newline\" /&gt;        \n     &lt;footer type=\"log4net.Util.PatternString\" value=\"[Log Ends]%newline\" /&gt;        \n     &lt;conversionPattern value=\"%date [%username] - %message%newline\" /&gt;\n     &lt;/layout&gt;\n   &lt;/appender&gt;  \n\n   &lt;logger name=\"SRGApplicationDebugLog\"&gt;\n     &lt;level value=\"DEBUG\" /&gt;\n     &lt;appender-ref ref=\"LogFileAppender\" /&gt;\n   &lt;/logger&gt;\n    &lt;/log4net&gt;  \n</code></pre>\n</blockquote>\n\n<p>Problem1 : I am getting header and footer <strong>two times extra</strong> whenever my application is started, but I need to avoid it.</p>\n\n<blockquote>\n  <p>[Log Starts]<br>\n     [Log Ends]<br>\n     [Log Starts]<br>\n     [Log Ends]<br>\n      [Log Starts]<br>\n     2012-11-08 12:25:03,376 [username] - Application started<br>\n     [Log Ends]  </p>\n</blockquote>\n\n<p>Problem2 : I am not getting from where is the <strong>two empty header footer pair</strong> is coming.</p>\n\n<blockquote>\n  <ol>\n  <li><p>I am creating logger like below:-<br>\n  _debugLogger = LogManager.GetLogger(\"SRGApplicationDebugLog\");<br>\n  XmlConfigurator.Configure();    </p></li>\n  <li><p>To use Logger:-<br>\n  _debugLogger.DebugFormat(logMessage);    </p></li>\n  <li><p>I have added this line explicitly in AssemblyInfo.cs for log4net<br>\n  [assembly: XmlConfigurator(Watch = true)]    </p></li>\n  </ol>\n</blockquote>\n\n<p>Question : Want to fix the problems in bold</p>\n"}]}
{"total":375446,"page":3,"pagesize":100,"questions":[{"tags":["c#","serialization","deserialization","ntp","osi"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":13148546,"title":"Representation of bits and their serialisation in .Net","body":"<p>I am practising implementing some basic layer 7 protocols but I am unsure of the best way of serialising and deserialising bits in the .Net framework. </p>\n\n<p>According to the <a href=\"http://msdn.microsoft.com/en-us/library/47zceaw7%28v=vs.71%29.aspx\" rel=\"nofollow\">MSDN Data Type Summary</a>, there is no bit data type. I have no idea how I would go about creating such a data type or even if it's possible so I am left with serialising/deserialising to a byte / byte array.</p>\n\n<p>Given the following example from the top of an NTP packet:</p>\n\n<pre><code>     0-1         LeapIndicator (LI)      2 bits\n     2-4         VersionNumber (VN)      3 bits\n     5-7         Mode                    3 bits\n     8-15        Stratum                 8 bits\n</code></pre>\n\n<p>I would like to encode into 2 bytes so I can send via the socket.</p>\n\n<p>Also, I am currently using ints to represent the bits in enums, is it possible to use bits/hex or something a better than ints? For example the mode enum is defined as follows:</p>\n\n<pre><code>public enum Mode\n{\n    /*\n     +-------+--------------------------+\n     | Value | Meaning                  |\n     +-------+--------------------------+\n     | 0     | reserved                 |\n     | 1     | symmetric active         |\n     | 2     | symmetric passive        |\n     | 3     | client                   |\n     | 4     | server                   |\n     | 5     | broadcast                |\n     | 6     | NTP control message      |\n     | 7     | reserved for private use |\n     +-------+--------------------------+\n     */\n\n    Resevered = 0,\n    SymmetricActive = 1,\n    SymmetricPassive = 2,\n    Client = 3,\n    Server = 4,\n    Broadcast = 5,\n    ControlMessage = 6,\n    PrivateUse = 7\n}\n</code></pre>\n\n<p>Side Note: The code for this project will eventually be open sourced, please bare in mind that if you answer. If you do not wish for the code to be shared, please say :) A link will be placed in the code back to this question.</p>\n\n<p>Thanks in advance :)</p>\n\n<p>Update: In case people are wondering what the NTP packet structure looks like, taken directly from <a href=\"http://www.ietf.org/rfc/rfc5905.txt\" rel=\"nofollow\">RFC 5905, page 18</a></p>\n\n<pre><code>        0                   1                   2                   3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |LI | VN  |Mode |    Stratum     |     Poll      |  Precision   |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                         Root Delay                            |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                         Root Dispersion                       |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                          Reference ID                         |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                     Reference Timestamp (64)                  +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Origin Timestamp (64)                    +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Receive Timestamp (64)                   +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        +                      Transmit Timestamp (64)                  +\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        .                                                               .\n        .                    Extension Field 1 (variable)               .\n        .                                                               .\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        .                                                               .\n        .                    Extension Field 2 (variable)               .\n        .                                                               .\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                          Key Identifier                       |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        |                                                               |\n        |                            dgst (128)                         |\n        |                                                               |\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n"},{"tags":["c#","relative-path","openfiledialog"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13294503,"title":"Get relative path from OpenFileDialog in C#","body":"<p>I am a beginner at programing and I´m writing my second Prog.\nI have a Question about how to get a relative path to my application Startup path.\nThe Program reads an .xml-file that has a path of a .jpg stored in it. It creates a Picturebox for every path and loads the respective image.\nThe problem I have is, that I have the images in my Dropbox to be able to use the Program on any PC that has Dropbox. When I use the OpenFileDialog on my main PC and save the Path of the .jpg to the xml it won´t work on my laptop because the Dropbox folder is on another drive as on my main PC.</p>\n\n<p>Does anyone have an idea, how to get around this Problem?</p>\n"},{"tags":["c#",".net","log4net","log4net-appender"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13286124,"title":"Header and footer coming two times more in log4net logs","body":"<p>Below is the Section of log4net from app.config</p>\n\n<blockquote>\n<pre><code>   &lt;configSections&gt;\n   &lt;section name=\"log4net\" type=\"log4net.Config.Log4NetConfigurationSectionHandler,     log4net\" /&gt;\n     &lt;/configSections&gt;      \n        &lt;log4net debug=\"true\"&gt;\n  &lt;appender name=\"LogFileAppender\" type=\"log4net.Appender.FileAppender\"&gt;\n     &lt;file type=\"log4net.Util.PatternString\" value=\"${TMP}\\SRG\\Logs\\Log_%env{USERNAME}_%date{yyyyMMdd}.log\" /&gt;\n     &lt;appendToFile value=\"true\" /&gt;\n     &lt;bufferSize value=\"20\" /&gt;\n     &lt;LockingModel type=\"log4net.Appender.FileAppender+MinimalLock\"/&gt;\n     &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n     &lt;header type=\"log4net.Util.PatternString\" value=\"[Log Starts]%newline\" /&gt;        \n     &lt;footer type=\"log4net.Util.PatternString\" value=\"[Log Ends]%newline\" /&gt;        \n     &lt;conversionPattern value=\"%date [%username] - %message%newline\" /&gt;\n     &lt;/layout&gt;\n   &lt;/appender&gt;  \n\n   &lt;logger name=\"SRGApplicationDebugLog\"&gt;\n     &lt;level value=\"DEBUG\" /&gt;\n     &lt;appender-ref ref=\"LogFileAppender\" /&gt;\n   &lt;/logger&gt;\n    &lt;/log4net&gt;  \n</code></pre>\n</blockquote>\n\n<p>Problem1 : I am getting header and footer <strong>two times extra</strong> whenever my application is started, but I need to avoid it.</p>\n\n<blockquote>\n  <p>[Log Starts]<br>\n     [Log Ends]<br>\n     [Log Starts]<br>\n     [Log Ends]<br>\n      [Log Starts]<br>\n     2012-11-08 12:25:03,376 [username] - Application started<br>\n     [Log Ends]  </p>\n</blockquote>\n\n<p>Problem2 : I am not getting from where is the <strong>two empty header footer pair</strong> is coming.</p>\n\n<blockquote>\n  <ol>\n  <li><p>I am creating logger like below:-<br>\n  _debugLogger = LogManager.GetLogger(\"SRGApplicationDebugLog\");<br>\n  XmlConfigurator.Configure();    </p></li>\n  <li><p>To use Logger:-<br>\n  _debugLogger.DebugFormat(logMessage);    </p></li>\n  <li><p>I have added this line explicitly in AssemblyInfo.cs for log4net<br>\n  [assembly: XmlConfigurator(Watch = true)]    </p></li>\n  </ol>\n</blockquote>\n\n<p>Question : Want to fix the problems in bold</p>\n"},{"tags":["c#","sql","database","api","concurrency"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":184,"score":3,"question_id":13224787,"title":"Database recommendations needed -> Columnar, Embedded (if possible), fast, fast, fast","body":"<p>I am searching for the ideal database structure/solution that meets most of my below requirements but so far I utterly failed. Can you please help?</p>\n\n<p>My tasks: I run a process in .Net 4.5 (C#) and generate (generally) value types that I want to use for further analysis in other applications and therefore like to either preserve in-memory or persist on disk. More below. The data is generated within different tasks/threads and thus a row based data format does not lend itself well to match this situation (because the data generated in different threads is generated at different times and is thus not aligned). Thus I thought a columnar data structure may be suitable but please correct me if I am wrong.</p>\n\n<p>Example:</p>\n\n<p>Tasks/Thread #1 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000001 233.23</p>\n\n<p>1000000002 233.34</p>\n\n<p>1000000006 234.23\n...</p>\n\n<p>Taks/Thread #2 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000002 33.32</p>\n\n<p>1000000005 34.34</p>\n\n<p>1000000015 54.32\n...</p>\n\n<p>I do not need to align the time stamps at the .Net run-time, I am first and foremost after preserving the data and to process the data within R or Python at a later point.</p>\n\n<p>My requirements:</p>\n\n<ul>\n<li><p>Fast writes, fast writes, fast writes: It can happen that I generate 100,000- 1,000,000 data points per second and need to persist (worst case) or retain in memory the data. Its ok to run the writes on its own thread so this process can lag the data generation process but limitation is 16gb RAM (64bit code), more below.</p></li>\n<li><p>Preference is for columnar db format as it lends itself well to how I want to query the data later but I am open to any other structure if it makes sense in regards to the examples above (document/key-value also ok if all other requirements are met, especially in terms of write speed). </p></li>\n<li><p>API that can be referenced from within .Net. Example: HDF5 may be considered capable by some but I find their .Net port horrible.Something that supports .Net a little better would be a plus but if all other requirements are met then I can deal with something similar to the HDF5 .Net port.  </p></li>\n<li><p>Concurrent writes if possible: As described earlier I like to write data concurrently from different tasks/threads.</p></li>\n<li><p>I am constrained by 16gb memory (run .Net process in 64bit) and thus I probably look for something that is not purely in-memory as I may sometimes generate more data than that. Something in-memory which persists at times or a pure persistence model is probably preferable. </p></li>\n<li><p>Preference for embedded but if a server in a client/server solution can run as a windows service then no issue. </p></li>\n<li><p>In terms of data access I have strong preference for a db solution for which interfaces from R and Python already exist because I like to use the Panda library within Python for time series alignments and other analysis and run analyses within R.</p></li>\n<li><p>If the API/library supports in addition SQL/SQL-like/Linq/ like queries that would be terrific but generally I just need the absolute bare bones such as load columnar data in between start and end date (given the \"key\"/index is in such format) because I analyze and run queries within R/Python.</p></li>\n<li><p>If it comes with a management console or data visualizer that would be a plus but not a must. </p></li>\n<li><p>Should be open source or priced within \"reach\" (no, KDB does not qualify in that regards ;-)</p></li>\n</ul>\n\n<p>OK, here is what I have so far, and again its all I got because most db solution simply fail already on the write performance requirement:</p>\n\n<ul>\n<li>Infobright and Db4o. I like what I read so far but I admit I have not checked into any performance stats</li>\n<li>Something done myself. I can easily store value types in binary format and index the data by datetime.ticks , I just would need to somehow write scripts to load/deserialize the data in Python/R. But it would be a massive tasks if I wanted to add concurrency, a query engine, and other goodies. Thus I look for something already out there. </li>\n</ul>\n"},{"tags":["c#","javascript","jquery","asp.net","internet-explorer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13290421,"title":"\"SCRIPT5 Access is denied\" error on IE9 when firing .click() from onchange","body":"<p>We want to reduce the number of steps it takes for a user to upload a file on our website; so we're using jQuery to open and postback files using the below markup (simplified):</p>\n\n<pre><code>&lt;a onclick=\"$('#uplRegistrationImage').click();\"&gt;\n    Change profile picture\n&lt;/a&gt;\n\n&lt;!-- Hidden to keep the UI clean --&gt;\n&lt;asp:FileUpload ID=\"uplRegistrationImage\" \n                runat=\"server\" \n                ClientIDMode=\"static\"\n                Style=\"display:none\"\n                onchange=\"$('#btnSubmitImage').click();\"    /&gt;\n\n&lt;asp:Button runat=\"server\" \n            ID=\"btnSubmitImage\" \n            ClientIDMode=\"static\" \n            Style=\"display:none\" \n            OnClick=\"btnSubmitImage_OnClick\" \n            UseSubmitBehavior=\"False\" /&gt;\n</code></pre>\n\n<p>This works absolutely fine in Firefox and Chrome; opening the file dialog when the link is clicked and firing the postback when a file is selected.</p>\n\n<p>However in IE9 after the file upload has loaded and a user has selected a file; insteaed of the OnChange working I get a \"SCRIPT5 Access is denied\" error.  I've tried setting an arbitrary timeout, setting intervals to check if a file is given to no avail.</p>\n\n<p>There are a number of other questions relating to this; however none appear to have a decent answer (One said set the file dialog to be transparent and hover behind a button!)</p>\n\n<p>Has anyone else resolved this? Or is it absolutely necessary that I provide a button for IE users?</p>\n"},{"tags":["c#","asp.net","gridview","checkbox","edit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13294391,"title":"Error when clicking edit in gridview","body":"<p>Error Message:</p>\n\n<blockquote>\n  <p>The variable name '@Bitnet' has already been declared. Variable names must be unique within a query batch or stored procedure.  When trying to edit gridview. </p>\n</blockquote>\n\n<p>I want to be able to update the checkbox field.  This gridview is based on a table join.</p>\n\n<pre><code>&lt;asp:Content ID=\"Content4\" runat=\"server\" contentplaceholderid=\"ContentPlaceHolder2\"&gt;\n&lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"False\"   DataKeyNames=\"INST_ID,BITNET\" DataSourceID=\"SqlDataSource1\" AllowPaging=\"True\" OnSelectedIndexChanged=\"GridView1_SelectedIndexChanged\"&gt;\n    &lt;Columns&gt;\n        &lt;asp:CommandField ShowEditButton=\"True\" /&gt;\n        &lt;asp:BoundField DataField=\"INST_ID\" HeaderText=\"INST_ID\" ReadOnly=\"True\" SortExpression=\"INST_ID\" /&gt;\n        &lt;asp:BoundField DataField=\"FirstName\" HeaderText=\"FirstName\" SortExpression=\"FirstName\" /&gt;\n        &lt;asp:BoundField DataField=\"LastName\" HeaderText=\"LastName\" SortExpression=\"LastName\" /&gt;\n        &lt;asp:BoundField DataField=\"Prefix\" HeaderText=\"Prefix\" SortExpression=\"Prefix\" /&gt;\n        &lt;asp:BoundField DataField=\"Title\" HeaderText=\"Title\" SortExpression=\"Title\" /&gt;\n        &lt;asp:BoundField DataField=\"Address1\" HeaderText=\"Address1\" SortExpression=\"Address1\" /&gt;\n        &lt;asp:BoundField DataField=\"City\" HeaderText=\"City\" SortExpression=\"City\" /&gt;\n        &lt;asp:BoundField DataField=\"State\" HeaderText=\"State\" SortExpression=\"State\" /&gt;\n        &lt;asp:BoundField DataField=\"Zip\" HeaderText=\"Zip\" SortExpression=\"Zip\" /&gt;\n        &lt;asp:BoundField DataField=\"Country\" HeaderText=\"Country\" SortExpression=\"Country\" /&gt;\n        &lt;asp:BoundField DataField=\"Phone\" HeaderText=\"Phone\" SortExpression=\"Phone\" /&gt;\n        &lt;asp:BoundField DataField=\"Fax\" HeaderText=\"Fax\" SortExpression=\"Fax\" /&gt;\n        &lt;asp:BoundField DataField=\"BITNET\" HeaderText=\"BITNET\" ReadOnly=\"True\" SortExpression=\"BITNET\" /&gt;\n        &lt;asp:TemplateField HeaderText=\"Active\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:CheckBox ID=\"Active\" runat=\"server\" Checked='&lt;%# Eval(\"Active\").ToString() == \"1\" ? true:false %&gt;' Enabled=\"false\" /&gt;\n            &lt;/ItemTemplate&gt;\n            &lt;EditItemTemplate&gt;\n                &lt;asp:CheckBox ID=\"Active\" runat=\"server\" Checked=\"true\" Enabled=\"false\" /&gt;\n            &lt;/EditItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n\n    &lt;/Columns&gt;\n&lt;/asp:GridView&gt;\n&lt;asp:SqlDataSource ID=\"SqlDataSource1\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:ASPLOGINConnectionString %&gt;\" SelectCommand=\"SELECT IALO.INST_ID, IALO.FirstName, IALO.LastName, IALO.Prefix, IALO.Title, IALO.Address1, IALO.City, IALO.State, IALO.Zip, IALO.Country, IALO.Phone, IALO.Fax, IALO.BITNET, IALO.Active FROM CEOTable INNER JOIN IALO ON CEOTable.Inst_ID = IALO.INST_ID WHERE (CEOTable.Bitnet = @Bitnet)\"&gt;\n     &lt;/asp:SqlDataSource&gt;\n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13294492,"title":"Using SizeF for user control dimensions","body":"<p>Hy,</p>\n\n<p>As the tittle says I am looking for a way to use SizeF instead of normal Size for setting and getting Control dimensions.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","profile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":609,"score":0,"question_id":11776294,"title":"ASP.NET MVC4 UserProfile","body":"<p>What is best practice to handle with user profiles in ASP.NET MVC4 ? </p>\n\n<p>I wanna add custom fields to my User Profile like Name, Surname, About and others is it ready solution for this ? </p>\n\n<p>Now my solution is : when creating new user account im creating automaticly a entry in my users table (primary key is user Guid) and there i kepp Name, Surname and point of my oplication  - photos, comments (1 user have many photos, 1 photo have many comments) - is it good solution - or i sit some automaticly magic from MS to do this user profile and link it to my data ? </p>\n"},{"tags":["c#","xml","capture","webservice-client"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13294230,"title":"How to capture XML when calling web service from win apps","body":"<p>in my solution i have three project. one is web service (ASMX), another is win form apps from where i am calling the web service. another class library where class has been design extending SoapExtension class.</p>\n\n<p>my objective is to capture response &amp; request xml when i am calling web service from my win form apps.i am getting <strong>object reference not set</strong> error when i am trying to capture xml.</p>\n\n<h2>here is my class library source code.</h2>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Web.Services;\nusing System.Web.Services.Protocols;\nusing System.IO;\nusing System.Net;\nusing System.Xml;\n\nnamespace SoapLogger\n{\npublic class TraceExtension : SoapExtension\n{\n    private Stream oldStream;\n    private Stream newStream;\n\n    private static XmlDocument xmlRequest;\n    /// &lt;summary&gt;\n    /// Gets the outgoing XML request sent to PayPal\n    /// &lt;/summary&gt;\n    public static XmlDocument XmlRequest\n    {\n        get { return xmlRequest; }\n    }\n\n    private static XmlDocument xmlResponse;\n    /// &lt;summary&gt;\n    /// Gets the incoming XML response sent from PayPal\n    /// &lt;/summary&gt;\n    public static XmlDocument XmlResponse\n    {\n        get { return xmlResponse; }\n    }\n\n    /// &lt;summary&gt;\n    /// Save the Stream representing the SOAP request\n    /// or SOAP response into a local memory buffer.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"stream\"&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public override Stream ChainStream(Stream stream)\n    {\n        oldStream = stream;\n        newStream = new MemoryStream();\n        return newStream;\n    }\n\n    /// &lt;summary&gt;\n    /// If the SoapMessageStage is such that the SoapRequest or\n    /// SoapResponse is still in the SOAP format to be sent or received,\n    /// save it to the xmlRequest or xmlResponse property.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"message\"&gt;\n    public override void ProcessMessage(SoapMessage message)\n    {\n        switch (message.Stage)\n        {\n            case SoapMessageStage.BeforeSerialize:\n                break;\n            case SoapMessageStage.AfterSerialize:\n                xmlRequest = GetSoapEnvelope(newStream);\n                CopyStream(newStream, oldStream);\n                break;\n            case SoapMessageStage.BeforeDeserialize:\n                CopyStream(oldStream, newStream);\n                xmlResponse = GetSoapEnvelope(newStream);\n                break;\n            case SoapMessageStage.AfterDeserialize:\n                break;\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Returns the XML representation of the Soap Envelope in the supplied stream.\n    /// Resets the position of stream to zero.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"stream\"&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private XmlDocument GetSoapEnvelope(Stream stream)\n    {\n        XmlDocument xml = new XmlDocument();\n        stream.Position = 0;\n        StreamReader reader = new StreamReader(stream);\n        xml.LoadXml(reader.ReadToEnd());\n        stream.Position = 0;\n        return xml;\n    }\n\n    /// &lt;summary&gt;\n    /// Copies a stream.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"from\"&gt;\n    /// &lt;param name=\"to\"&gt;\n    private void CopyStream(Stream from, Stream to)\n    {\n        TextReader reader = new StreamReader(from);\n        TextWriter writer = new StreamWriter(to);\n        writer.WriteLine(reader.ReadToEnd());\n        writer.Flush();\n    }\n    #region NoOp\n    /// &lt;summary&gt;\n    /// Included only because it must be implemented.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"methodInfo\"&gt;\n    /// &lt;param name=\"attribute\"&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public override object GetInitializer(LogicalMethodInfo methodInfo,\n        SoapExtensionAttribute attribute)\n    {\n        return null;\n    }\n\n    /// &lt;summary&gt;\n    /// Included only because it must be implemented.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"WebServiceType\"&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public override object GetInitializer(Type WebServiceType)\n    {\n        return null;\n    }\n\n    /// &lt;summary&gt;\n    /// Included only because it must be implemented.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"initializer\"&gt;\n    public override void Initialize(object initializer)\n    {\n    }\n    #endregion NoOp\n}\n}\n</code></pre>\n\n<h2>here i will show how i am calling web service from win apps</h2>\n\n<pre><code>    private void button1_Click(object sender, EventArgs e)\n    {\n\n        using (ServiceRef.TestServiceSoapClient oService = new ServiceRef.TestServiceSoapClient())\n        {\n            textBox1.Text = oService.HelloWorld(\"Sudip\");\n            var soapRequest = SoapLogger.TraceExtension.XmlRequest.InnerXml;\n            var soapResponse = SoapLogger.TraceExtension.XmlResponse.InnerXml;\n        }\n    }\n</code></pre>\n\n<p>this two line is giving object reference error</p>\n\n<pre><code>            var soapRequest = SoapLogger.TraceExtension.XmlRequest.InnerXml;\n            var soapResponse = SoapLogger.TraceExtension.XmlResponse.InnerXml;\n</code></pre>\n\n<p>i just could not figure out why i am getting error.</p>\n\n<p>in win form apps has one app.config where i register my class library assembly to capture the xml. here is my app.config details</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n&lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n        &lt;basicHttpBinding&gt;\n            &lt;binding name=\"TestServiceSoap\"/&gt;\n        &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;client&gt;\n        &lt;endpoint address=\"http://localhost:6804/Service1.asmx\" binding=\"basicHttpBinding\" bindingConfiguration=\"TestServiceSoap\" contract=\"ServiceRef.TestServiceSoap\" name=\"TestServiceSoap\"/&gt;\n    &lt;/client&gt;\n&lt;/system.serviceModel&gt;\n\n&lt;system.web&gt;\n&lt;compilation debug=\"true\" targetFramework=\"4.0\" /&gt;\n&lt;webServices&gt;\n  &lt;soapExtensionTypes&gt;\n    &lt;add type=\"SoapLogger.TraceExtension,SoapLogger\" priority=\"1\" group=\"0\" /&gt;\n  &lt;/soapExtensionTypes&gt;\n&lt;/webServices&gt;\n&lt;/system.web&gt;\n&lt;startup&gt;&lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt; &lt;/startup&gt;    \n&lt;/configuration&gt;\n</code></pre>\n\n<p>when i search google just to know how to capture request/response xml then i got this kind of many article. i followed many but nothing works.</p>\n\n<p>this url i followed to get the job done \n<a href=\"http://jramirezdev.net/blog/c-tip-capturar-los-mensajes-soap-de-un-servicio-asmx-que-hemos-referenciado\" rel=\"nofollow\">http://jramirezdev.net/blog/c-tip-capturar-los-mensajes-soap-de-un-servicio-asmx-que-hemos-referenciado</a></p>\n\n<p>what kind of mistake i am making not clear. i set the break point at every method in my class library method but when web service call no method got executed in the class library.\ni dont want to use any tool like wireshark,fiddler to capture the request/response xml rather want to do same thing programatically.</p>\n\n<p>so please guide me what is my mistake. why i am getting object reference not set error. please have a look at my code or go to the url link and tell me what is wrong in my approach.</p>\n"},{"tags":["c#","arrays","linq","multidimensional"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13278194,"title":"LINQ and Array.Copy","body":"<p>I have the following:</p>\n\n<pre><code>var list = new List&lt;double[]&gt;();\nlist.Add(new double[] { 300, 12, 22 });\nlist.Add(new double[] { 310, 13, 23 });\nlist.Add(new double[] { 320, 14, 24 });\nlist.Add(new double[] { 330, 15, 25 });\n</code></pre>\n\n<p>I would like to get from this a multidimensional array containing the first 2 columns:</p>\n\n<pre><code>double[,] a = { {300,12}, {310,13}, {320,14}, {330,15}}\n</code></pre>\n\n<p>Can I do this using linq? And how?</p>\n"},{"tags":["c#","gridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13294669,"title":"Avoid repetition of rows in a gridview when a new row is added","body":"<p>I have a gridview and i have some rows and i have a button to add new row but i dont want to repeat last rows in the gridview is it possible?? my addrow code is below</p>\n\n<pre><code> private void AddNewRow()\n    {\n        int rowIndex = 0;\n\n        if (ViewState[\"CurrentTable\"] != null)\n        {\n            DataTable dtCurrentTable = (DataTable)ViewState[\"CurrentTable\"];\n            DataRow drCurrentRow = null;\n            if (dtCurrentTable.Rows.Count &gt; 0)\n            {\n                for (int i = 1; i &lt;= dtCurrentTable.Rows.Count; i++)\n                {\n                    TextBox TextBoxName = (TextBox)grvStudentDetails.Rows[rowIndex].Cells[1].FindControl(\"txtName\");\n                    TextBox TextBoxAge = (TextBox)grvStudentDetails.Rows[rowIndex].Cells[2].FindControl(\"txtAge\");\n                    TextBox TextBoxAddress = (TextBox)grvStudentDetails.Rows[rowIndex].Cells[3].FindControl(\"txtAddress\");\n                    RadioButtonList RBLGender = (RadioButtonList)grvStudentDetails.Rows[rowIndex].Cells[4].FindControl(\"RBLGender\");\n\n                    drCurrentRow[\"RowNumber\"] = i + 1;\n\n                    dtCurrentTable.Rows[i - 1][\"Col1\"] = TextBoxName.Text;\n                    dtCurrentTable.Rows[i - 1][\"Col2\"] = TextBoxAge.Text;\n                    dtCurrentTable.Rows[i - 1][\"Col3\"] = TextBoxAddress.Text;\n                    dtCurrentTable.Rows[i - 1][\"Col4\"] = RBLGender.SelectedValue;\n\n                    rowIndex++;\n                }\n                dtCurrentTable.Rows.Add(drCurrentRow);\n                ViewState[\"CurrentTable\"] = dtCurrentTable;\n\n                grvStudentDetails.DataSource = dtCurrentTable;\n                grvStudentDetails.DataBind();\n            }\n        }\n        else\n        {\n            Response.Write(\"ViewState is null\");\n        }\n    }\n</code></pre>\n"},{"tags":["c#","asp.net",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13279200,"title":"Session becomes null?","body":"<p>When operating on a HttpSessionStateWrapper object, sometimes it becomes null in the middle of an operation.  In the following code sample, otherSession is NOT the current session. It's the session of a different user:</p>\n\n<pre><code>string id = otherSession == null ? \"\" : otherSession.SessionID; \n</code></pre>\n\n<p>The above line will occasionally fail with a NullReferenceException.  My guess is that after otherSession is checked for null but before the SessionID property is accessed, otherSession is set to null in another thread (not my own thread, but elsewhere in asp.net) so that when the SessionID property is accessed the NullReferenceException occurs. </p>\n\n<p>I am wondering </p>\n\n<ol>\n<li>What causes otherSession to be set to null?</li>\n<li>How can I replicate the circumstances that result in otherSession becoming null so I can ensure my handling of that scenario is adequate?</li>\n</ol>\n"},{"tags":["c#","dll","visual-studio-2012","dll-reference"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":131,"score":1,"question_id":13041340,"title":"VS2012 dll file not found at run time","body":"<p>I have a project that references a dll file. I simply added a reference by right clicking on the properties, selected add reference, and browsed for the dll. Intellisense recognizes the library and all it's classes/methods but when I run it I get this.</p>\n\n<p>An unhandled exception of type 'System.IO.FileNotFoundException' occurred in program.exe</p>\n\n<p>Additional information: Could not load file or assembly 'Api.dll' or one of its dependencies. The specified module could not be found.</p>\n\n<p>The file appears in the bin folder and is still at the location I browsed too. The program runs without errors if I don't use any classes or methods. The library doesn't have any dependencies I'm aware of.</p>\n\n<p><strong>Edit:</strong> found a lot of missing dependent DLL files using dependency walker that I thought were causing the problem. After putting all the dependent DLL's in the same folder and referencing it the problem persists</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1013,"score":1,"question_id":267364,"title":"WPF: Eliminate transparency between grid cells","body":"<p>I have a Grid in WPF. The Grid has a transparent background (necessary) and each of the cells potentially has a different colored solid background, or maybe no background. When I put arbitrary content in these cells, when two adjacent cells both have colored backgrounds (same or different color, it doesn't matter) there is often (and unpredictably) a thin transparent line separating them, allowing you to see through the grid at that line.</p>\n\n<p>Does anyone know how this could possibly be fixed?</p>\n\n<p>Edit: Meant to mention it in my question, but I've tried enabling SnapsToDevicePixels anywhere and everywhere I can, to no avail.</p>\n"},{"tags":["c#","dll","memory-address","queryinterface","nvapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13291783,"title":"How to get the id (memory address) of dll-function?","body":"<p>I want to use a function from nvapi in C# \"NvAPI_DRS_EnumProfiles\".\nI have to call QueryInterface(id) with the id of the function. \nEverything is working fine and i found the ids for the other functions i need on the web, \nbut i can't find the id of this single function, and i don't know how to get it. \nI tried so many things and even a c-program which print me the memory-address didn't work.</p>\n\n<p>My code looks something like this: <a href=\"http://www.drivenbynostalgia.com/files/SOP.cs\" rel=\"nofollow\">http://www.drivenbynostalgia.com/files/SOP.cs</a></p>\n\n<p>Thank you for your help :)</p>\n"},{"tags":["c#","packet","winpcap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13294179,"title":"Packet sniffing and modification","body":"<p>First, why do I need that? I have Wifi network. I want everyone that just connected to wifi first to redirect to login page and then if login is successful - redirect to the page requested. I thought to do that using PCap. But since WinPCap allows just to monitor packets, I can't stop packet from being sent to destination host. So the question is how can I sniff packet and change it content? As of beginning i want to capture HTTP packets only from specified network adapter.</p>\n"},{"tags":["c#",".net","dataview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13289735,"title":"Can I achieve a wildcard % in the middle of a DataView RowFilter command?","body":"<p>I have this row filter text: <code>\"[Name 1] = '\" + forename + \"%\" + surname + \"'\"</code> which fails, but if I put the <code>%</code> at the beginning or end it's OK. Is there any way to achieve the same result (i.e. \"any\" string in the middle of the names)?</p>\n\n<p>Full statement is:</p>\n\n<pre><code>dv = new DataView(MyDataTable, \n\"[Name 1] = '\" + forename + \"%\" + surname + \"'\", \n\"\", DataViewRowState.CurrentRows); \n</code></pre>\n"},{"tags":["c#","unix","ftp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13294134,"title":"C# - Write file over FTP - how to set rights?","body":"<p>I wrote a .net C# application that writes text files to a unix machine, where an application reads it. My application writes files just fine to the target folder, but the unix application throws an error saying it doesn't have permission to read the file. <br>\nWhen I send files using WinSCP, I can see the rights are rwxrwxrwx.<br>\nwhen my app sends files the rights are rw-r-----. <br>\nI assume this is the reason.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>public override void WriteFile(string directoryName, string fileName, string text) {\n     sshExec.RunCommand(@\"echo \"\"\" + text + @\"\"\" &gt; \" + directoryName + \"/\" + fileName);\n}\n</code></pre>\n\n<p>How do I set the rights so the other application can read the file?</p>\n"},{"tags":["c#","c++","visual-studio-2010","c#-4.0","c++-cli"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13293888,"title":"How to call a C# library from C++ using C++\\CLI and IJW","body":"<p><strong>Background:</strong> As part of a larger assignment I need to make a C# library accessible to unmanaged C++ and C code.  In an attempt to answer this question myself I have been learning C++/CLI the past few days/ weeks. </p>\n\n<p>There seems to be a number of different ways to achieve using a C# dll from unmanaged C++ and C. Some of the answers in brief appear to be: using Interlope services, Using .com. and regasm, Using PInvoke (which appears to go from C# to C++ only), and using IJW in the C++/CLR (which appears to be Interlope services). I am thinking it would be best to set up a library that is perhaps a CLR wrapper that uses IJW to call my C# dll on the behalf of native C++ and C code. </p>\n\n<p><strong>Specifics:</strong> I need to pass values of string as well as int to a C# dll from c++ code, and return void.</p>\n\n<p><strong>Relevance:</strong> Many companies have many excuses to mix and match C++, C and C#. Performance: unmanaged code is usually faster, interfaces: Managed interfaces are generally easier to maintain, deploy, and are often easier on the eyes, Managers tell us too. Legacy code forces us too. It was there (Like the mountain that we climbed). While examples of how to call a C++ library from C# are abundant. Examples of how to call C# libraries from C++ code are difficult to find via Googling especially if you want to see updated 4.0+ code.</p>\n\n<p><strong>Software:</strong> C#, C++/CLR, C++, C, Visual Studio 2010, and .NET 4.0</p>\n\n<p><strong>Question details:</strong> OK multi-part question:</p>\n\n<ol>\n<li><p>Is there an advantage to using com objects? Or the PInvoke? Or some other method? (I feel like the learning curve here will be just as steep, even though I do find more information on the topic in Google Land. IJW seems to promise what I want it to do. Should I give up on looking for an IJW solution and focus on this instead?) (Advantage/ disadvantage?)</p></li>\n<li><p>Am I correct in imagining that there is a solution where I write a wrapper that that utilizes IJW in the C++/CLR? Where can I find more information on this topic, and don’t say I didn’t Google enough/ or look at MSDN without telling me where you saw it there. (I think I prefer this option, in the effort to write clear and simple code.)</p></li>\n<li><p>A narrowing of question scope: I feel that my true issue and need is answering the smaller question that follows: How do I set up a C++/CLR library that an unmanaged C++ file can use within visual studio. I think that if I could simply instantiate a managed C++ class in unmanaged C++ code, then I might be able work out the rest (interfacing and wrapping etc.). I expect that my main folly is in trying to set up references/#includes etc. within Visual Studio, thought clearly I could have other misconceptions. Perhaps the answer to this whole thing could be just a link to a tutorial or instructions that help me with this. </p></li>\n</ol>\n\n<p><strong>Research:</strong> I have Googled and Binged over and over with some success. I have found many links that show you how to use an unmanaged library from C# code. And I will admit that there have been some links that show how to do it using com objects. Not many results were targeted at VS 2010.</p>\n\n<p><strong>References:</strong>\nI have read over and over many posts. I have tried to work through the most relevant ones. Some seem tantalizingly close to the answer, but I just can’t seem to get them to work. I suspect that the thing that I am missing is tantalizingly small, such as misusing the keyword ref, or missing a #include or using statement, or a misuse of namespace, or not actually using the IJW feature properly, or missing a setting that VS needs to handle the compilation correctly, etc. So you wonder, why not include the code? Well I feel like I am not at a place where I understand and expect the code I have to work. I want to be in a place where I understand it, when I get there maybe then I'll need help fixing it. I'll randomly include two of the links but I am not permitted to show them all at my current Hitpoint level.</p>\n\n<p>This calls code from C++ (managed) to C++/CLR which is not what I want but I read it anyway: <a href=\"http://www.codeproject.com/Articles/35437/Moving-Data-between-Managed-Code-and-Unmanaged-Cod\" rel=\"nofollow\">http://www.codeproject.com/Articles/35437/Moving-Data-between-Managed-Code-and-Unmanaged-Cod</a> </p>\n\n<p>This calls code from managed and unmanaged code in both directions going from C++ to Visual Basic and back via C++CLR, and of course I am interested in C#.: <a href=\"http://www.codeproject.com/Articles/9903/Calling-Managed-Code-from-Unmanaged-Code-and-vice\" rel=\"nofollow\">http://www.codeproject.com/Articles/9903/Calling-Managed-Code-from-Unmanaged-Code-and-vice</a></p>\n"},{"tags":["c#","silverlight"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13294385,"title":"Binding in silverlight 4 to a DataGridColumnHeader","body":"<p>My goal is to add a description viewer to the column headers of my datagrid.  I have a datagrid when the user selects a filter (outside the datagrid) I retrieve data from a database that contains the names of the columns and has a description that states the purpose of the columns'. I am creating a string array with both the name of the column and the columns purpose and setting the DatagridColumn's Header property equal to the array.  In xaml I have created a style that I have bound to the Columns Header style property.  In this style I am defining the template property of the header. In the template I have added a description viewer. Here is the Style markup.</p>\n\n<pre><code> &lt;Style x:Key=\"DataGridColumnHeaderStyle\" TargetType=\"sdk:DataGridColumnHeader\"&gt;\n        &lt;Setter Property=\"Foreground\" Value=\"#FF000000\" /&gt;\n        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Left\" /&gt;\n        &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\" /&gt;\n        &lt;Setter Property=\"IsTabStop\" Value=\"False\" /&gt;\n        &lt;Setter Property=\"SeparatorBrush\" Value=\"#FFC9CACA\" /&gt;\n        &lt;Setter Property=\"Padding\" Value=\"4\" /&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"sdk:DataGridColumnHeader\"&gt;\n                    &lt;Grid x:Name=\"Root\"&gt;\n                        &lt;Grid.ColumnDefinitions&gt;\n                            &lt;ColumnDefinition /&gt;\n                            &lt;ColumnDefinition Width=\"Auto\" /&gt;\n                        &lt;/Grid.ColumnDefinitions&gt;\n                        &lt;Grid Margin=\"{TemplateBinding Padding}\"\n                              HorizontalAlignment=\"{TemplateBinding HorizontalContentAlignment}\"\n                              VerticalAlignment=\"{TemplateBinding VerticalContentAlignment}\"&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition /&gt;\n                                &lt;ColumnDefinition Width=\"Auto\" /&gt;\n                                &lt;ColumnDefinition Width=\"Auto\" /&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;ContentPresenter DataContext=\"{TemplateBinding Content}\"  Content=\"{Binding Path=[0]}\" /&gt;\n                            &lt;Path x:Name=\"SortIcon\"\n                                  Grid.Column=\"1\"\n                                  Width=\"8\"\n                                  Margin=\"4,0,0,0\"\n                                  HorizontalAlignment=\"Left\"\n                                  VerticalAlignment=\"Center\"\n                                  Data=\"F1 M -5.215,6.099L 5.215,6.099L 0,0L -5.215,6.099 Z \"\n                                  Fill=\"#FF444444\"\n                                  Opacity=\"0\"\n                                  RenderTransformOrigin=\".5,.5\"\n                                  Stretch=\"Uniform\"&gt;\n                                &lt;Path.RenderTransform&gt;\n                                    &lt;ScaleTransform ScaleX=\".9\" ScaleY=\".9\" /&gt;\n                                &lt;/Path.RenderTransform&gt;\n                            &lt;/Path&gt;\n                                &lt;sdk:DescriptionViewer Grid.Column=\"2\" Margin=\"5,0,0,0\" DataContext=\"{TemplateBinding Content}\" Description=\"{Binding Path=[1]}\"  /&gt;\n                        &lt;/Grid&gt;\n                      &lt;/Grid&gt;\n                &lt;/ControlTemplate&gt;\n         &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>This does not work.  If I remove the Path=[0] from the Content binding in the content presenter I am not getting the correct object.  It is giving the name of the ViewModel that is bound to the page the datagrid is in.  If I set the Content equal to the Template binding I get the correct object but I cannot specify which array element I would like to display.  </p>\n\n<p>Does anyone know how you would pass an array to the header property and then have controls in the template display only certain elements of the array? Any advice would be appreciated.</p>\n"},{"tags":["c#",".net","visual-studio-2010","visual-studio","visual-studio-2012"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13273842,"title":"Code Contracts + Code Analysis","body":"<p>I think about starting to use <a href=\"http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx\" rel=\"nofollow\">Code Contracts</a> in my code base.</p>\n\n<p>I already use Code Analysis with all rules enabled and a goal of zero warnings.</p>\n\n<p>However, when using <code>Contract.Requires(parameter != null)</code> I get a warning from Code Analysis, namely CA1062:</p>\n\n<blockquote>\n  <p>CA1062 : Microsoft.Design : In externally visible method 'Foo', validate parameter 'parameter' before using it.</p>\n</blockquote>\n\n<p>That's unfortunate, I don't want to disable that rule as I find it useful. But I also don't want to suppress every false occurrence of it.</p>\n\n<p>Is there a solution?</p>\n\n<hr>\n\n<p>Yes, there is a solution:</p>\n\n<ol>\n<li>Disable CA1062 in Code Analysis</li>\n<li>Enable \"Perform Static Contract Checking\" in the Code Contracts pane of the project.</li>\n<li>Enable \"Implicit Non-Null Obligations\"</li>\n<li>Set Warning Level to \"hi\" (important, that was what I was missing!)</li>\n</ol>\n"},{"tags":["c#",".net","timezone","console-application","dst"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13293024,"title":"Use TimeZoneInfo class to account for time change in daylight savings time","body":"<p>I have some outdated code that attempts to account for the change in time caused by daylight savings that looks like this:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace ConsoleApplication2\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            for (int i = 1; i &lt;= 31; i++)\n            {\n                DateTime dt = new DateTime(1960, 3, i, 0, 0, 0);\n                Console.WriteLine(dt.ToUniversalTime());\n            }\n\n            Console.WriteLine();\n\n            for (int i = 1; i &lt;= 30; i++)\n            {\n                DateTime dt = new DateTime(1960, 4, i, 0, 0, 0);\n                Console.WriteLine(dt.ToUniversalTime());\n            }\n\n            Console.ReadKey();\n        }\n    }\n}\n</code></pre>\n\n<p>This code iterates through the days in March and April in 1960 and prints the datetime.\nHowever, this does not correctly account for the time change in 1960, I believe because the date of the time change was different then. I attempted to fix this using the TimeZoneInfo class. I changed the code to the following:</p>\n\n<pre><code>class Program\n    {\n        static void Main(string[] args)\n        {\n            for (int i = 1; i &lt;= 31; i++)\n            {\n                DateTime dt = new DateTime(1960, 3, i, 0, 0, 0);\n                var tz = TimeZoneInfo.Local;\n                var utcOffset = new DateTimeOffset(dt, TimeSpan.Zero);\n                //use timeZoneInfo class to account for dlst offset\n                Console.WriteLine(utcOffset.ToOffset(tz.GetUtcOffset(utcOffset)));\n            }\n\n            Console.WriteLine();\n\n            for (int i = 1; i &lt;= 30; i++)\n            {\n                DateTime dt = new DateTime(1960, 4, i, 0, 0, 0);\n                var tz = TimeZoneInfo.Local;\n                var utcOffset = new DateTimeOffset(dt, TimeSpan.Zero);\n                //use timeZoneInfo class to account for dlst offset\n                Console.WriteLine(utcOffset.ToOffset(tz.GetUtcOffset(utcOffset)));\n\n            }\n\n            Console.ReadKey();\n        }\n    }\n</code></pre>\n\n<p>Unfortunately, this is printing out:\n<img src=\"http://i.stack.imgur.com/eZz9C.png\" alt=\"enter image description here\"></p>\n\n<p>which shows that daylight savings is changing on April 3rd at 4 p.m., while it should be switching over at April 24th at 2:00 a.m. What am I missing to correctly account for daylight savings?</p>\n\n<p><strong>EDIT:</strong>\nMy current time zone is eastern.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":57,"score":5,"question_id":13276003,"title":"Thumbs on line corner points do not relocate points","body":"<p>I am developing a drawing application in which one can draw various types of lines. On the line corner points I have placed a thumb using an itemsControl. The thumbs should move that corner point when the user left mouse clicks on it and drags the mouse. What's happening now is that when I do this the point and thumb move a little bit, but then it loses mouse capture right away and doesn't move anymore. When I debug the first dragdelta event that gets fired correctly has a full visual tree traced up from the sending thumb to the itemscontrol and beyond, but sometimes when it fires the next time, the thumb's location has not been updated, and the containing content presenter has null parents in the visual tree. </p>\n\n<p>This is the portion of the xaml related to the line thumb points:</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"PART_LineRelocate\" ItemsSource=\"{Binding pointsObservableCollection}\"  Visibility=\"Collapsed\" &gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate DataType=\"{x:Type s:LineCornerPoint}\" &gt;\n           &lt;Grid&gt;\n              &lt;c:PointRelocateThumb VerticalAlignment=\"Center\" HorizontalAlignment=\"Center\" Focusable=\"True\"  x:Name=\"PART_PointRelocateThumb\" Cursor=\"Hand\"/&gt;\n           &lt;/Grid&gt;\n        &lt;/DataTemplate&gt;\n     &lt;/ItemsControl.ItemTemplate&gt;\n     &lt;ItemsControl.ItemsPanel&gt;\n         &lt;ItemsPanelTemplate&gt;\n            &lt;Canvas IsItemsHost=\"True\" /&gt;\n         &lt;/ItemsPanelTemplate&gt;\n     &lt;/ItemsControl.ItemsPanel&gt;\n     &lt;ItemsControl.ItemContainerStyle &gt;\n         &lt;Style &gt; \n            &lt;Style.Triggers&gt;\n                  &lt;DataTrigger Value=\"BrokenLinkLine\" Binding=\"{Binding RelativeSource={RelativeSource AncestorType={x:Type s:ToolLine}}, Path=indicator}\" &gt;\n                      &lt;Setter  Property=\"Canvas.Left\" Value=\"{Binding Corner.X}\" /&gt;\n                      &lt;Setter Property=\"Canvas.Top\" Value=\"{Binding Corner.Y}\"   /&gt;\n                  &lt;/DataTrigger&gt;\n\n                     ....More of these datatriggers for the different types of lines\n              &lt;/Style.Triggers&gt;\n         &lt;/Style&gt;\n   &lt;/ItemsControl.ItemContainerStyle&gt;\n</code></pre>\n\n<p></p>\n\n<p>The code for PointRelocateThumb:</p>\n\n<pre><code> public PointRelocateThumb()\n    {\n\n        base.DragDelta += new DragDeltaEventHandler(this.PointRelocateThumb_DragDelta);\n\n    }\n    void PointRelocateThumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e)\n    {\n        PointRelocateThumb prt = (PointRelocateThumb)sender;\n        LineCornerPoint lcp = (LineCornerPoint)prt.DataContext;\n        Point thumbPoint = new Point(Canvas.GetLeft((ContentPresenter)prt.TemplatedParent), Canvas.GetTop((ContentPresenter)prt.TemplatedParent));\n        ToolLine toolLine = null;\n        DrawingCanvas designer = null;\n        ItemsControl itemsControl = ItemsControl.ItemsControlFromItemContainer(prt.TemplatedParent);\n        if (itemsControl != null)\n            toolLine = itemsControl.DataContext as ToolLine;\n        if (toolLine != null)\n            designer = VisualTreeHelper.GetParent(toolLine) as DrawingCanvas;\n        if (toolLine != null &amp;&amp; designer != null &amp;&amp; toolLine.IsSelected)\n        {\n            thumbPoint = new Point(thumbPoint.X + Canvas.GetLeft(toolLine) + 3.5, thumbPoint.Y + Canvas.GetTop(toolLine) + 3.5);\n\n            toolLine.undoBounding();\n            if (System.String.Compare(toolLine.indicator, \"BrokenLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"LinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"OrthogonalLinkLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"BrokenLine\") == 0\n                || System.String.Compare(toolLine.indicator, \"Line\") == 0\n                || System.String.Compare(toolLine.indicator, \"Polygon\") == 0)\n            {\n                if (toolLine.pathFigure.StartPoint.Equals(thumbPoint))\n                {\n                    toolLine.pathFigure.StartPoint = new Point(modifyingToolLine.pathFigure.StartPoint.X + e.HorizontalChange, modifyingToolLine.pathFigure.StartPoint.Y + e.VerticalChange);                    }\n                else\n                {\n                    foreach (LineSegment ls in toolLine.pathSegmentCollection)\n\n                    {\n                        if (ls.Point.Equals(thumbPoint))\n                        {\n                            ls.Point = new Point(ls.Point.X + e.HorizontalChange, ls.Point.Y + e.VerticalChange);\n                            break;\n                        }\n\n                    }\n                }\n            }\n           toolLine.regenerateBoundingItem();\n        }\n        e.Handled = true;\n    } \n }\n</code></pre>\n\n<p>}</p>\n\n<p>Tooline is the line class. What undo binding does is that it makes it so that toolLine has Canvas.Left and Canvas.Top set to 0, but scales the points so that they are still located at the same point - i.e. by adding the old Canvas.Left and Canvas.Top values of the toolLine to each point in the line.</p>\n\n<p>The code for regenerate Bounding item is below:</p>\n\n<pre><code>public void regenerateBoundingItem()\n{\n     //Following line of code just regenerates the underlying path for the toolLine from the \n     //new pathsegmentCollection and pathFigure start point.  \n    regenerateThisLine();\n    double leftMostPoint = double.MaxValue, topMostPoint = double.MaxValue, bottomMostPoint = double.MinValue, rightMostPoint = double.MinValue;\n    getBoundingPoints(ref leftMostPoint, ref topMostPoint, ref bottomMostPoint, ref rightMostPoint);\n\n     //subtracts leftMost point and topMostPoint from each point in the line\n     scaleLinePoints(leftMostPoint, topMostPoint); \n     Canvas.SetLeft(this, leftMostPoint);\n     Canvas.SetTop(this, topMostPoint);\n     this.Width = rightMostPoint - leftMostPoint;\n     this.Height = bottomMostPoint-topMostPoint;\n      regenerateObservableCollection();\n      regenerateThisLine();\n}\nprivate void regenerateObservableCollection()\n{\n    if (this.pointsObservableCollection == null)\n        this.pointsObservableCollection = new ObservableCollection&lt;LineCornerPoint&gt;();\n    this.pointsObservableCollection.Clear();\n    LineCornerPoint startPt = new LineCornerPoint(new Point(this.pathFigure.StartPoint.X - 3.5, this.pathFigure.StartPoint.Y - 3.5));\n    this.pointsObservableCollection.Add(startPt);\n    if (System.String.Compare(indicator, \"BrokenLine\") == 0\n        || System.String.Compare(indicator, \"BrokenLinkLine\") == 0\n        || System.String.Compare(indicator, \"LinkLine\") == 0\n        || System.String.Compare(indicator, \"Polygon\") == 0\n       || System.String.Compare(indicator, \"Line\") == 0)\n    {\n        foreach (LineSegment ls in pathSegmentCollection)\n        {\n            LineCornerPoint pt = new LineCornerPoint(new Point(ls.Point.X - 3.5, ls.Point.Y - 3.5));\n            this.pointsObservableCollection.Add(pt);\n         }\n     }\n}\n</code></pre>\n\n<p>The template for PointRelocateThumb is an ellipse of width and height 7 - which explains why I have to offset all the thumb locations by 3.5.</p>\n"},{"tags":["c#",".net","outlook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13274078,"title":"Outlook 2003+ Embedding signatures with images to all sent emails","body":"<p>I have a Win Form application that does some boring accounting stuff and then sends it's data to some lucky recipients. I am using the Outlook 12.0 Interop objects and my applications environment ranges from office 2003 on XP to office 2007 on Win 7.</p>\n\n<p>My issue lies with sending the corporate signature with the sent emails.\nIt contains two images and I would like to embed these images so they appear to be part of the body (assuming the receiving mail client supports that).</p>\n\n<p>I have tried a few different methods of accomplishing this; but still no luck!</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li><p>Extracting the html data from the signatures folder, changing the\nhtml img tags src attribute to include 'file///'. This causes Outlook\nto replace the 'file///' with 'CID' and I assumed it would also embed\nthe image... we should never assume :|. This is the method I found\nworked best for getting the rest of the signature.</p></li>\n<li><p>(After creating a new MailItem) - Grabbing the HTMLBody of the MailItem\nand extracting the relevant part including the signature... This\ndidnt work due to the new MailItem object being very inconsistent\nwith it's signature. By that I mean sometimes the new item would\ninclude the signature and sometimes it wouldn't! :s I cannot figure out why it is not    always there, no other part of my code has changed!</p></li>\n</ul>\n\n<p>I read on another post here about the GetInspector property... Apparently just calling this will do 'Some stuff' and the signature will magically appear in your mail item... NO!</p>\n\n<p>Things I can't do:</p>\n\n<ul>\n<li>I cannot (as much as i would like to) shove the images online\nsomewhere and point to them in the emails html.</li>\n<li>I cannot use SMTP(It has to be through Outlook... sigh).</li>\n</ul>\n\n<p>I am thinking that the best way seems to be my original method of messing about with the CID, but I do not really know much about what Outlook is doing in the background so I am having trouble figuring out what else I need to do to get the images sent along with the email.</p>\n\n<p>Hoping someone out there has some idea about what I am doing wrong or what else I could try.</p>\n\n<p>Please let me know if code would be helpful and I will post, (Most of the code tried is from this site... I just cannot find the links again and am trying to avoid making this question tooooo long).</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","c++","switch-statement"],"answer_count":4,"favorite_count":0,"up_vote_count":14,"down_vote_count":1,"view_count":215,"score":13,"question_id":13239912,"title":"Differences between switch statements in C# and C++","body":"<p>I'm just starting out teaching myself C#, and in a tutorial on Switch statements, I read:</p>\n\n<blockquote>\n  <p>The behavior where the flow of execution is forbidden from flowing\n  from one case block to the next is one area in which C# differs from\n  C++. In C++ the processing of case statements is allowed to run from\n  one to another.</p>\n</blockquote>\n\n<p>Why does it stop after one case statement in C#? If you can use the <code>break</code> statement to stop at any point, is there any reason in C# vs. C++ to having it stop after a match is found? And if you wanted more than one case in C#, would you have to use another Switch statement?</p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":54,"score":6,"question_id":13274102,"title":"CodeContracts: false warning \"Possibly unboxing a null reference\"","body":"<p><img src=\"http://i.stack.imgur.com/dyPL2.png\" alt=\"enter image description here\"></p>\n\n<p>In the image above, you can see a warning from Code Contracts. I don't think this is legit, as <code>this</code> can never be <code>null</code>.</p>\n\n<p>Is this a bug or am I missing something?</p>\n\n<hr>\n\n<p>This property is a member of the following class:</p>\n\n<pre><code>public class NHibernateIQueryableQueryBase&lt;TEntity, TQuery, TQueryInterface&gt;\n    : IQuery&lt;TEntity&gt;, IFluentQueryInterface&lt;TEntity, TQueryInterface&gt;\n    where TQuery : NHibernateIQueryableQueryBase&lt;TEntity, TQuery,\n                                                 TQueryInterface&gt;,\n                   TQueryInterface\n    where TQueryInterface : IQuery&lt;TEntity&gt;\n</code></pre>\n\n<hr>\n\n<p>Update:<br>\nChanging the property to the following still shows the warning - on the line <code>return result;</code>:</p>\n\n<pre><code>public TQueryInterface And\n{\n    get\n    {\n        var result = this as TQuery;\n        return result;\n    }\n}\n</code></pre>\n"},{"tags":["c#","wcf","silverlight","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13294329,"title":"Error when start silverlight project","body":"<p>Error   1   Failed to get the MetadataWorkspace for the DbContext type 'RIAServicesLibraryTask.Web.Models.CityDbContext'.   RIAServicesLibraryTask (RIAServicesLibraryTask\\RIAServicesLibraryTask)</p>\n\n<p>I have got this error when I try to create project example from article \n<a href=\"http://www.codeproject.com/Articles/354715/Creating-a-WCF-RIA-Services-Class-Library-for-a-Si\" rel=\"nofollow\">http://www.codeproject.com/Articles/354715/Creating-a-WCF-RIA-Services-Class-Library-for-a-Si</a>\nI have own mssql server, config web.config RIAServicesLibraryTask.Web, and asp.net config web file. \nI use vs 2012 and get few libs from article project.\nThe problem is that I cannot understand how to fix or debug this problem. May be eny tell me how to show in browser silverlight error.\nSource files :\n<a href=\"http://depositfiles.com/files/c391j5zm1\" rel=\"nofollow\">http://depositfiles.com/files/c391j5zm1</a></p>\n"},{"tags":["c#","key","keyboard-shortcuts","keydown","modifier-key"],"answer_count":5,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":8811,"score":7,"question_id":1434867,"title":"How to use multiple modifier keys in C#","body":"<p>I am using a keydown event to detect keys pressed and have several key combinations for various operations.</p>\n\n<pre><code>if (e.KeyCode == Keys.C &amp;&amp; e.Modifiers == Keys.Control &amp;&amp; e.Modifiers == Keys.Shift)\n{\n    //Do work\n}\nelse if (e.KeyCode == Keys.V &amp;&amp; e.Modifiers == Keys.Control)\n{\n    //Paste\n}\n</code></pre>\n\n<p>For some reason the key combination in which I hit <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd> is not working. I have re ordered them, and placed it at the top thinking it might be interference from the <kbd>Ctrl</kbd> + <kbd>C</kbd>, and even removed the <kbd>Ctrl</kbd> + <kbd>C</kbd> to see if it was causing a problem. It still does not work. I know it's probably something very simple, but can't quite grasp what it is. All of my 1 modifier + 1 key combination's work fine, as soon as I add a second modifier is when it no longer works.</p>\n"},{"tags":["c#","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13292567,"title":"c# Regular expression for words in brackets with seperator","body":"<p>I need to parse a text and check if between all squared brackets is a <code>-</code> and befor and after the <code>-</code> must be at least one character. \nI tried the following code, but it doesn't work. The matchcount is to large.</p>\n\n<pre><code>Regex regex = new Regex(@\"[\\.*-.*]\");\nMatchCollection matches = regex.Matches(textBox.Text);\n</code></pre>\n\n<p>SampleText:</p>\n\n<pre><code>Node\n  (Entity [1-5])\n</code></pre>\n"},{"tags":["c#","events","design-patterns","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13081077,"title":"Is EventAggregator only for ViewModels in MVVM?","body":"<p>I read about the Event Aggregator pattern being implemented in an MVVM design can help to decouple the communication between the ViewModels. </p>\n\n<p>I thought the Event Aggregator is really a good idea. But on a second thought, is the Event Aggregator only used by the ViewModels? Can Models publish to and subscribe from events in the Event Aggregator?</p>\n\n<p>And through this, perhaps, data changes between the ViewModel and Model can then be related via the EventAggregator. This would then probably allow one ViewModel to retrieve information from multiple Models without having the ViewModel to store a reference to all the Models.</p>\n\n<p>If I were to do this, would it cause the whole architecture to be messy and eventually become an anti-pattern? What would be the best practice?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I thought I should explain a little on why I am asking this. I am seeing three possible problems: </p>\n\n<p><em>First</em>, so with DI, my ViewModel wraps the Model. My ViewModel can then communicate with my Model. However, not the other way round. So if my Model has some changes either on its own or externally, it needs a way to inform its ViewModel. </p>\n\n<p><em>Second</em>, apart from ViewModels having to communicate with other ViewModels, it seems to me that Models have to communicate with other Models as much, or even more, as ViewModels do. These lead to what I thought I could just get everything linked to the EventAggregator.</p>\n\n<p><em>Third</em>, I find that there are situations where a single ViewModel needs to pull information from multiple Models. But through a Dependency Injection via the ViewModel's constructor, it can only read from one Model.</p>\n"},{"tags":["c#","gridview","total","running-total"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13293952,"title":"grandtotal and runningtotal for multiple pages in gridview","body":"<p>I have a gridview with total at the footer. My paging allows only 25 records for each page. So when there are multiple pages there should be running total and the grand total. Could me anyone help me with the code. below are the code for the total for a column.</p>\n\n<pre><code>&lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"false\" AllowSorting=\"true\" ShowFooter=\"True\" OnPageIndexChanging=\"GridView1_PageIndexChanging\" OnDataBound=\"GridView1_DataBound\" OnRowDataBound=\"GridView1_RowDataBound\" OnRowCreated=\"GridView1_RowCreated\"&gt;\n&lt;asp:TemplateField ItemStyle-HorizontalAlign=\"Center\" HeaderStyle-Width=\"30px\"                                                                                                          HeaderStyle-VerticalAlign=\"Top\" ItemStyle-Wrap=\"True\"&gt;\n&lt;ItemTemplate&gt;\n&lt;asp:Label ID=\"lblcriteria\" runat=\"server\" Text='&lt;%# DataBinder.Eval(Container.DataItem,\"CRITERIA_N\") %&gt;' /&gt;\n&lt;/ItemTemplate&gt;&lt;/asp:TemplateField&gt;\n&lt;asp:TemplateField HeaderText=\"Period\" SortExpression=\"PERIOD_N\" ItemStyle-HorizontalAlign=\"Center\"\n HeaderStyle-VerticalAlign=\"Top\" ItemStyle-Wrap=\"True\"&gt;\n&lt;ItemTemplate&gt;\n&lt;asp:Label ID=\"lblPERIOD_N\" runat=\"server\" Text='&lt;%# DataBinder.Eval(Container.DataItem,\"PERIOD_N\") %&gt;' /&gt;&lt;/ItemTemplate&gt;&lt;/asp:TemplateField&gt;\n&lt;asp:TemplateField HeaderText=\"Receipts\" SortExpression=\"CHECK_AMT_A_USD\" ItemStyle-HorizontalAlign=\"Center\"\nHeaderStyle-VerticalAlign=\"Top\" HeaderStyle-Width=\"70px\"&gt;\n&lt;ItemTemplate&gt;\n&lt;asp:Label ID=\"lblReceipt\" runat=\"server\" Text='&lt;%# DataBinder.Eval(Container.DataItem,\"CHECK_AMT_A_USD\") %&gt;' /&gt;&lt;/ItemTemplate&gt;\n&lt;FooterTemplate&gt;\n&lt;asp:Label ID=\"lbltotReceipt\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n&lt;asp:Label ID=\"lblgrangtot\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n&lt;/FooterTemplate&gt;\n&lt;/asp:TemplateField&gt;\n&lt;/column&gt;\n</code></pre>\n\n<p>aspx.cs</p>\n\n<pre><code>protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)\n{\n    GridView grid = sender as GridView;\n    DataRowView tableData = e.Row.DataItem as DataRowView;\n    DataTable dt = Session[\"List\"] as DataTable;       \n\n    if (e.Row.RowType == DataControlRowType.Header)\n    {\n        totreceipt = 0; \n    }\n    if (e.Row.RowType == DataControlRowType.DataRow)\n    {\n        Label lblReceipt = (Label)e.Row.FindControl(\"lblReceipt\");\n        totreceipt += Convert.ToDecimal(tableData[\"CHECK_AMT_A_USD\"]);\n    }\n    if (e.Row.RowType == DataControlRowType.Footer)\n    {\n\n        Label lbltotReceipt = (Label)e.Row.FindControl(\"lbltotReceipt\");\n        lbltotReceipt.Text = string.Format(\"{0:N2}\", totreceipt);\n        e.Row.Cells[0].Text = \"Total:\";\n    }\n\n}\n</code></pre>\n\n<p>I couldn't go through the sample ones. Those are pretty confusing. So Kindly help with the coding. </p>\n"},{"tags":["c#","java","types"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13294181,"title":"java.lang.Long in C#","body":"<p>I'm developing a WCF JSON Web Service which receive data from an Android application.</p>\n\n<p>Some data could be null. On Android I'm using <a href=\"http://docs.oracle.com/javase/6/docs/api/java/lang/Long.html\" rel=\"nofollow\">java.lang.Long</a>, that could be <code>null</code>.</p>\n\n<p>On C#side, I'm using <code>long</code> that couldn't be <code>null</code>.</p>\n\n<p>Is there a <code>java.lang.Long</code> type in C#?</p>\n"},{"tags":["c#","asp.net","visual-studio-2012","wcf-data-services"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":13,"score":4,"question_id":13293874,"title":"change in config.DataServiceBehavior.MaxProtocolVersion from V3.0 to V2.0 cannot revert","body":"<p>I changed </p>\n\n<pre><code>config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3\n</code></pre>\n\n<p>from V3 to V2 to verify that JSON output is Verbose. However, when I change it back to V3, the output is still verbose, and I have to add </p>\n\n<pre><code>?$format=application/json;odata=verbose\n</code></pre>\n\n<p>in order to get JSON Light. Tips on how to get it back to the correct version?</p>\n"},{"tags":["c#","oracle","gac","odp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13294206,"title":"How to remap app.config for assembly Oracle.DataAccess from Version '2.112.2.0' to '2.112.3.0'","body":"<p>I am new to C#.</p>\n\n<p>I wrote a C# console application which uses ODP to connect with Oracle database using Oracle.DataAccess.Client namespace. My dev machine is using Oracle.DataAccess ver 2.112.2.0 and the dev server is also using Oracle.DataAccess ver 2.112.2.0 and the program works fine. The prod server using a higher version of Oracle.DataAccess ver 2.112.3.0 and the program does not run and I get the following exception.</p>\n\n<pre><code>Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Oracle.DataAccess, Version=2.112.2.0, Culture=neutral, PublicKeyToken=89b483f\n429c47342' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)\nFile name: 'Oracle.DataAccess, Version=2.112.2.0, Culture=neutral, PublicKeyToken=89b483f429c47342'\n   at OPSegmentTDs.Programu.Main(String[] args)\n\n\nI tried installing ODAC for Oracle client 11.2.0.3.0 on my dev machine and added the higher ver of Oracle.DataAccess reference 2.112.3.0 in my application and when I built it I got this warning but the program built successfully.\n\nConsider app.config remapping of assembly \"Oracle.DataAccess, Culture=neutral, PublicKeyToken=89b483f429c47342\" from Version \"2.112.2.0\" [] to Version \"2.112.3.0\" [C:\\Oracle\\OraODP1123\\product\\11.2.0\\client_2\\ODP.NET\\bin\\2.x\\Oracle.DataAccess.dll] to solve conflict and get rid of warning.\nc:\\WINDOWS\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets : warning MSB3247: Found conflicts between different versions of the same dependent assembly.\nC:\\WINDOWS\\Microsoft.NET\\Framework\\v3.5\\Csc.exe /noconfig /nowarn:1701,1702 /platform:AnyCPU /errorreport:prompt /warn:4 /define:DEBUG;TRACE /reference:C:\\Work\\Build\\GOLD\\GIS2002\\GISLib\\bin\\Debug\\GIS.dll /reference:C:\\Work\\Build\\09072012\\Linde.Niche.DB\\bin\\Debug\\Linde.Niche.DB.dll /reference:C:\\Work\\Build\\09072012\\Linde.Niche.DB.OP\\bin\\Debug\\Linde.Niche.DB.OP.dll /reference:C:\\Work\\Build\\09072012\\Linde.Niche\\bin\\Debug\\Linde.Niche.dll /reference:C:\\Work\\Build\\09072012\\OPLib\\OPLib\\bin\\Debug\\OPLib.dll /reference:C:\\Oracle\\OraODP1123\\product\\11.2.0\\client_2\\ODP.NET\\bin\\2.x\\Oracle.DataAccess.dll /reference:\"c:\\Program Files\\Reference Assemblies\\Microsoft\\Framework\\v3.5\\System.Core.dll\" /reference:\"c:\\Program Files\\Reference Assemblies\\Microsoft\\Framework\\v3.5\\System.Data.DataSetExtensions.dll\" /reference:C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.Data.dll /reference:C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.dll /reference:C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\System.Xml.dll /reference:\"c:\\Program Files\\Reference Assemblies\\Microsoft\\Framework\\v3.5\\System.Xml.Linq.dll\" /debug+ /debug:full /filealign:512 /optimize- /out:obj\\Debug\\OPSegmentTDs.exe /target:exe Program.cs Properties\\AssemblyInfo.cs\n</code></pre>\n\n<p>When I tried running the new build on my prod server the application is crashing with the same error</p>\n\n<pre><code>Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Oracle.DataAccess, Version=2.112.2.0, Culture=neutral, PublicKeyToken=89b483f\n429c47342' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)\nFile name: 'Oracle.DataAccess, Version=2.112.2.0, Culture=neutral, PublicKeyToken=89b483f429c47342'\n   at OPSegmentTDs.Programu.Main(String[] args)\n</code></pre>\n"},{"tags":["c#","winforms","janus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13289559,"title":"How to set the default value of a checked combo box in Windows form using c#","body":"<p>I just wanted to know how to set the default value of a checked combo box (Janus 3.5) as \"Please Select\". But I am finding hard time in finding the resolution of it. Please help!!</p>\n"},{"tags":["c#",".net","wcf","buffer-manager"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13294238,"title":"How can I clear the PooledBufferManager for my used once WCF HTTP client?","body":"<p>I have a WCF client application which makes a single service call with a very large response (1GB). I'm finding making this service call uses a lot of memory (500MB) which seems to never get reclaimed even though the response objects are no longer referenced by my code.</p>\n\n<p>I've used a memory profiler to see much of the memory usage lies in byte arrays created by PooledBufferManager instances.</p>\n\n<p>The proxy/client I am using has been auto generated by Visual Studio, so it is a class derived from System.ServiceModel.ClientBase&lt; TChannel >.</p>\n\n<p>I am using a custom binding with the following configuration:</p>\n\n<pre><code>  &lt;customBinding&gt;\n    &lt;binding name=\"foo\"\n             closeTimeout=\"00:01:00\"\n             openTimeout=\"00:01:00\"\n             receiveTimeout=\"00:01:00\"\n             sendTimeout=\"00:01:00\"&gt;\n      &lt;transactionFlow/&gt;\n      &lt;reliableSession ordered=\"true\" inactivityTimeout=\"00:02:00\"/&gt;\n      &lt;security authenticationMode=\"SecureConversation\" messageSecurityVersion=\"WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10\"&gt;\n        &lt;secureConversationBootstrap messageSecurityVersion=\"WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10\"&gt;\n          &lt;localClientSettings maxClockSkew=\"23:59:00\"/&gt;\n        &lt;/secureConversationBootstrap&gt;\n        &lt;localClientSettings maxClockSkew=\"23:59:00\"/&gt;\n      &lt;/security&gt;\n      &lt;mtomMessageEncoding&gt;\n        &lt;readerQuotas maxDepth=\"2147483647\" maxStringContentLength=\"2147483647\" maxArrayLength=\"2147483647\" maxBytesPerRead=\"2147483647\" maxNameTableCharCount=\"2147483647\"/&gt;\n      &lt;/mtomMessageEncoding&gt;\n      &lt;httpTransport maxBufferPoolSize=\"2147483647\" maxBufferSize=\"2147483647\" maxReceivedMessageSize=\"2147483647\"/&gt;\n    &lt;/binding&gt;\n  &lt;/customBinding&gt;\n</code></pre>\n\n<p>Reading around people talk about a few solutions to this:</p>\n\n<ul>\n<li>switching to streaming response mode instead of buffered, but I believe this is for TCP WCF connections, not for HTTP like mine.</li>\n<li>setting maxBufferPoolSize to zero to disable buffer pools. Setting this in the httpTransport element doesn't seem to have any effect for me.</li>\n<li>calling Clear() on the appropriate BufferManager/PooledBufferManager. I can't find the object to call this on from the context of the ClientBase derived instance I have. I did manage to find the appropriate PooledBufferManager instance using the debugger and digging many levels deep into private innerChannelFactory fields, but this isn't useful to interact with it from code.</li>\n<li>manually invoking GC.Collect() seems to reclaim about 50MB of the outstanding 500MB.</li>\n</ul>\n\n<p>What would be the best way to reclaim as much of this memory as possible used by this one time service call? I'm on the verge of making the service call in a dedicated process I can kill to reclaim the memory at this point.</p>\n"},{"tags":["c#","ado.net",".net-1.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13268444,"title":"Get Distinct values of a column in a DataTable","body":"<p>I have a datatable with multiple Columns.I want to store a column's distinct values and store it in ArrayList.How to get distinct values?</p>\n\n<p>I am using .net 1.1</p>\n"},{"tags":["c#","wpf","wpf-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13261775,"title":"Custom Control's OnMouseLeftButtonDown isn't called","body":"<p>I'm pretty new to WPF, and I'm trying to write a custom control that is basically a TextBlock, but also has a click event. I tried piecing the thing together from various sources, but it does not work.</p>\n\n<p>In the following code, I would expect that <code>OnMouseLeftButtonDown</code> is called when a mouse click is performed on the element. If that happens, I want to raise the <code>Click</code> event. Looking in the debugger, the function is never called.</p>\n\n<p>Did I misunderstand how this is supposed to work, or did some other error find it's way into my code?</p>\n\n<pre><code>namespace EP3_gui.Controls\n{\n    public class ClickableTextBlock : TextBlock\n    {\n        public ClickableTextBlock() : base()\n        { }\n\n        public ClickableTextBlock( Inline inline )\n            : base( inline )\n        { }\n\n        protected override void OnMouseLeftButtonDown( MouseButtonEventArgs e )\n        {\n            base.OnMouseLeftButtonDown( e );\n            RoutedEventArgs args = new RoutedEventArgs( ClickEvent );\n            RaiseEvent( args );\n        }\n\n        public static readonly RoutedEvent ClickEvent = EventManager.RegisterRoutedEvent(\n            \"Click\",\n            RoutingStrategy.Bubble,\n            typeof( RoutedEventHandler ),\n            typeof( ClickableTextBlock )\n        );\n\n        public event RoutedEventHandler Click\n        {\n            add { AddHandler( ClickEvent, value ); }\n            remove { RemoveHandler( ClickEvent, value ); }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13292841,"title":"WPF datagrid - custom scroll","body":"<p>We are struggling with the slowness of the datagrid in wpf. Regardless of which collection we are using - List, BindingList, ObservableCollection, custom ObservableCollection, it's still very slow when responding to collection update (Clear, Add) and render on the screen.</p>\n\n<p>The fastest solution we found is not to update the collection, but update the exsting objects in the collection, that DataGrid is bound to. In this case the grid is responding very fast, like old winforms grid.</p>\n\n<p>We are creating 65535 rows in the grid, that will be enough for all our grids. When it comes to update the grid, we update the required number of top rows, and set visibility = hidden for the rest. As I said it works exteremely fast. But There are 2 issues that we cannot solve:</p>\n\n<ol>\n<li>scroll bar, since we don't collapse the rows (it's slow)  - it's always is set for 65535 row. Is there any way to limit the scroll, or grid size to the actual visible rows count?</li>\n</ol>\n\n<p>Also, I noticed, that adding new rows into collection, if they don't need to be rendered immediately (they will be out of the visible area) is also very fast, so we can limit the minimum set to 50 rows (max visible rows), and then add/remove new rows as required. But this does not solve the problem with the scrolling.</p>\n\n<p>Any other solutions are welcome.\nForeseeing the advise to enable virtualization - yes, we are using virtualization (for rows which are enabled by default, and for columns). </p>\n"},{"tags":["c#","asp.net","selenium"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13294076,"title":"How to pass driver path on server?","body":"<pre><code>IWebDriver driver1 = new InternetExplorerDriver(\" '+ Server.MapPath(\"~\\\\IEDriverServer_Win32_2.25.2\\\\IEDriverServer.exe\") +' \");\n</code></pre>\n\n<p>Driver Not Found Error? \nI am using ASP.NET, C#. Any Help..</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","asp.net","data-binding","repeater"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13294095,"title":"Use Data from 2 Lists in ASP.Net Repeater","body":"<p>Is it possible, to bind two Lists to a Repeater(which creates a Table), to use Data from both Lists?<br>\nI have a List with actions and a List with Users. I would like to display some Information about the Action, and about the User who issued the Action. Can I combine the Information about the Action with the Information about the User?</p>\n\n<p>Here's a Sketch of the Table, how it should look like:  </p>\n\n<p>ID | Time | Info about Action | UserID | Full Name  |Info about User</p>\n\n<p>Jopi</p>\n"},{"tags":["c#","types","encapsulation",".net-assembly","projects"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13285547,"title":"c# encapsulation: Get types from other project","body":"<p>I need to explain a bit to get to the problem.</p>\n\n<p>I have 3 projects:</p>\n\n<p>Project 1 can see project 2 and 3.</p>\n\n<p>Project 2 can see project 3.</p>\n\n<p>Project 3 is a dll and the others are apps.</p>\n\n<p>I had to design a class with a lot of subclasses. The subclasses all have a method which is declared as abstract in the base, so they all have to use it. \nThey need to get distributed in all projects, because the code in methode directly interacts with the project.</p>\n\n<p>The abstract base classes are in Project 3, the subclasses are in 2 and 1.\nThere's the problem I have:</p>\n\n<p>This is the method I wrote: </p>\n\n<pre><code>   public static IEnumerable&lt;Type&gt; GetSubClasses(Type typ)\n   {\n       IEnumerable&lt;Type&gt; subclasses =\n       from type in Assembly.GetAssembly(typ).GetTypes()\n       where type.IsSubclassOf(typ) &amp;&amp; !type.IsAbstract\n       select type;\n       return subclasses;\n   }\n</code></pre>\n\n<p>I'm trying to get all subclasses of the type but when I do, I only get the subclasses from the current project. For example, if I try to get them from project1, I dont get the subclasses from project 2.</p>\n\n<p>How do I do that? I know I can get an assembly reference from project 2 but it has no GetAssembly(Type t) method, with the help of that I'm getting all the subclasses.\nIf it would be the same I just had to do the same there.</p>\n\n<p>My second question is, is there an easier way at all? It's a bit..\"large\" having those classes in many projects, maybe there's a solution to get them into one.\nLike I said, the code of the methode they all need to have, needs to directly interact with the project they are in.</p>\n"},{"tags":["c#","regex","parsing","webserver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13294007,"title":"Regular expressions not matching first instance of last character in pattern","body":"<p>Sorry for the confusing title but I'm not sure how better to explain it.</p>\n\n<p>I am building a simple web server for a school project that has to parse a custom scripting language. I have a line that looks like this:</p>\n\n<pre><code>&lt;p&gt;Here's the date: &lt;% pr date() %&gt;&lt;/p&gt;&lt;p&gt;Here's the date again: &lt;% pr date() %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>I'm using the following regular expression to try and pull out the &lt;% ... %> stuff...</p>\n\n<pre><code>&lt;% *(.*) *%&gt;\n</code></pre>\n\n<p>The problem is it is matching from the first open tag to the last closing tag, rather than from the first open tag to the first closing tag. So the resulting match is this:</p>\n\n<pre><code>&lt;% pr date() %&gt;&lt;/p&gt;&lt;p&gt;Here's the date again: &lt;% pr date() %&gt;\n</code></pre>\n\n<p>...instead of:</p>\n\n<pre><code>&lt;% pr date() %&gt;\n</code></pre>\n\n<p>I thought I could solve it by using something like this, but it doesn't seem to work:</p>\n\n<pre><code>&lt;% *([^(&lt;%)]*) *%&gt;\n</code></pre>\n\n<p>...but it doesn't seem to work. Any help is appreciated, thanks.</p>\n"},{"tags":["c#","windows","xna","cpu","fps"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":1,"view_count":1108,"score":3,"question_id":8553998,"title":"High CPU usage with XNA","body":"<p>I just noticed today, that when I compile and run a new XNA 4.0 game, one of CPU threads is running at 100% and the framerate drops to 54 FPS.</p>\n\n<p>The weird thing is that sometimes it works at 60 FPS, but then it just drops to 54 FPS.</p>\n\n<p>I haven't noticed this behaviour before, so I don't know if this is normal. I uninstalled my antivirus and reinstalled XNA Game Studio, XNA Redistributable and .NET Framework 4.</p>\n\n<p>If I set IsFixedTimeStep to false, the game runs at 60 FPS and CPU usage is minimal (1-2%). but as far as I know, this requires me to do velocity calculations using ElapsedGameTime, but I don't know how to do it, since I'm fairly new to XNA. But some say that setting it to false reduces jerky animations.</p>\n\n<p>I already checked <a href=\"http://forums.create.msdn.com/forums/t/46682.aspx\" rel=\"nofollow\">this forum thread</a>, but no one has found a good solution.</p>\n\n<p>Has anyone experienced this problem?</p>\n\n<p><strong>EDIT:</strong>\nI did some more research and I implemented a FPS counter (until now, I measured it with Fraps), and my counter shows the game running at 60 FPS (with IsFixedTimeStep = true), so this solves the FPS issue, but the high CPU usage remains. Is it possible that this happens to everyone?</p>\n"},{"tags":["c#","wpf","performance","filter","iteration"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1342,"score":2,"question_id":2771344,"title":"Is there a way to increase performance on my simple textfilter?","body":"<p>I'm writing a filter that will pick out items. I have a list of Objects. The objects contain a number, name and some other irrelevant items. At the moment, the list contains 200 items. When typing in a <code>textbox</code>, i'm looking if the string matches a part of the number/name of the objects in the list. If so, add them to the <code>listbox</code>. Here's the code for my textbox textchanged event : </p>\n\n<pre><code>private void txtTelnumber_TextChanged(object sender, TextChangedEventArgs e)\n    {\n        lstOverview.Items.Clear();\n        string data = \"\";\n        foreach (ucTelListItem telList in _allUsers)\n        {\n            data = telList.User.H323 + telList.user.E164;\n            if (data.Contains(txtTelnumber.Text))\n                lstOverview.Items.Add(telList);\n        }\n    }\n</code></pre>\n\n<p>I sometimes see a little delay when entering a character, especially when i go from 4 records to 200 records (so when i had a filter and 4 records matched, and i backspace and the whole list appears again).\nMy list is a list of usercontrols, cause I found it takes less time to load the usercontrols from a list, then to have to initialize a new usercontrol each time.</p>\n\n<p>Can I do something about the code, or is it just adding the <code>usercontrol</code> the <code>listbox</code> that causes the small delay (small delay = &lt;1 sec)?</p>\n\n<p>Thanks in advance.</p>\n\n<p><em>Edit</em>\nI've edited post, it's wpf. And putting items in a list and setting the itemssource isn't solving the problem.</p>\n"},{"tags":["c#","asp.net","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":277,"score":1,"question_id":9412866,"title":"WebService Call Exception: Thread was being aborted","body":"<p>Recently we've been getting System.Threading.ThreadAbortExceptions from an ASP.NET webservice that posts data to a payment server each night.</p>\n\n<p>The webservice is a standard .asmx page that gets called from another client.</p>\n\n<p>Inside the page I have a foreach loop that iterates through many payment rows in a database:</p>\n\n<pre><code>foreach (var obtRow in readyToBeCaptured)\n{    \n    try\n    {\n        status = dibs.GetPagePost(...);  \n        // handle status here\n    }\n    catch (ThreadAbortException tex)\n    {\n        SingletonLogger.Instance.Error(string.Format(\"Transactionhandler - Could not Capture, Thread was aborted. {0}\", tex.Message), tex);     \n    }\n    catch (Exception ex)\n    {\n        SingletonLogger.Instance.Error(string.Format(\"Transactionhandler - Could not Capture, statuscode: {0}, message: {1}.\", status, ex.Message), ex);             \n    }\n}\n</code></pre>\n\n<p>The strange thing is I get a log entry from catch(ThreadAbortException tex) block when this error occurs, but then the code breaks out and is caught in another try catch block further up the call tree. Ideally I would have the code inside the foreach loop to continue</p>\n\n<p>This is the GetPagePost method </p>\n\n<pre><code>private bool GetPagePost(string url, NameValueCollection nameValueCollection, string userName, string password)\n{\n    WebClient client = new WebClient();\n    if (userName != \"\")\n    {\n        client.Credentials = new NetworkCredential(userName, password);\n    }\n    foreach (string str in nameValueCollection.AllKeys)\n    {\n        this._callCollection.Add(str, nameValueCollection[str]);\n    }\n    StringBuilder builder = new StringBuilder();\n    builder.Append(\"DIBS.NET/1.2.0 ( \");\n    builder.Append(\"OS \").Append(Environment.OSVersion.Platform).Append(\" \").Append(Environment.OSVersion.Version).Append(\"; \");\n    builder.Append(\".NET CLR \").Append(Environment.Version).Append(\"; \");\n    builder.Append(\"User \").Append(Environment.UserName).Append(\"; \");\n    builder.Append(\"Domain \").Append(Environment.UserDomainName).Append(\"; \");\n    builder.Append(\" ) \");\n    client.Headers.Add(\"User-Agent\", builder.ToString());\n    try\n    {\n        byte[] bytes = client.UploadValues(url, \"POST\", nameValueCollection);\n        this._httpStatus = 200;\n        this._httpBody = Encoding.UTF8.GetString(bytes);\n        return true;\n    }\n    catch (WebException exception)\n    {\n        this._httpBody = exception.Message;\n        this._httpStatus = (int) exception.Status;\n    }\n    catch (UriFormatException exception2)\n    {\n        this._httpBody = exception2.Message;\n        this._httpStatus = -9999;\n    }\n    catch (Exception exception3)\n    {\n        this._httpBody = exception3.Message;\n        this._httpStatus = -99999;\n    }\n    return false;\n}} \n</code></pre>\n\n<p>Why is this error occuring and how can I prevent the code from breaking out of the foreach loop?\nI've been looking at a few other posts here on StackOverflow but they seem to relate to the usage of Reponse.Redirect which I don't use.</p>\n\n<p>Thanks </p>\n\n<p>/Jens</p>\n"},{"tags":["c#","silverlight","post"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":581,"score":4,"question_id":9175910,"title":"navigate and post data from silverlight","body":"<p>My project is silverlight navighation project (IN-Browser)\nI want to navigate to an Url such as :</p>\n\n<pre><code>System.Windows.Browser.HtmlPage.Window.Navigate(new Uri(string.Format(\"http://{0}:\n{1}/ReportProject.aspx#/Supplies/RequestGoods/RequestGoodsDashboard\", \nApplication.Current.Host.Source.Host, \nApplication.Current.Host.Source.Port)), \"_blank\", \"\");\n</code></pre>\n\n<p>and send many parameters with post method to target page</p>\n\n<p>how i can do this?</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13293511,"title":"How to ignore null properties in the search criteria","body":"<p>I have got a bad requirement to do; anyway I have to implement that in my application.</p>\n\n<p>I have a <code>Track</code> class</p>\n\n<pre><code>public class Track\n{\n    public string Name { get; set; }\n    public string City { get; set; }\n    public string Country { get; set; }\n}\n</code></pre>\n\n<p>and i have some test data</p>\n\n<pre><code>List&lt;Track&gt; Records = new List&lt;Track&gt;\n{ \n    new Track { City = \"a\", Name = \"a\",  Country = \"i\" }, // Track 1\n    new Track { City = \"b\", Name = \"b\",  Country = \"i\" }, // Track 2\n    new Track { City = \"a\", Name = null, Country = \"J\" }, // Track 3\n    new Track { City = \"c\", Name = \"a\",  Country = \"J\" }, // Track 4\n    new Track { City = \"b\", Name = \"a\",  Country = null}, // Track 5\n};\n</code></pre>\n\n<p>Requirement is i should query the data from <code>Records</code> based on values passed. If any of the property is <code>null</code> then search criteria should ignore that property. It should query based on <code>NonNull</code> properties.</p>\n\n<p><strong>Example</strong>:</p>\n\n<pre><code>If i query for City = a, Name = \"b\", Country = \"i\" then Result is: Track 1 &amp; Track 3\nIf i query for City = c, Name = \"p\", Country = \"w\" then Result is: Track 4\n</code></pre>\n\n<p><code>Name</code> &amp; <code>Country</code> have null values in <code>Track 3</code> &amp; <code>Track 5</code>.So it will ignore in search. Hope it is clear</p>\n\n<p>I finally land up with below logic</p>\n\n<pre><code>var filterRecords = new List&lt;Track&gt;();\nif (!Records.Any(t =&gt; string.IsNullOrWhiteSpace(t.City)))\n{\n    filterRecords = Records.Where(c =&gt; c.City == _city).ToList();  // Here _city is the method parameter.. assume \"a\"\n}\n\nif (!Records.Any(t =&gt; string.IsNullOrWhiteSpace(t.Country)))\n{\n    filterRecords = filterRecords.Where(c =&gt; c.City == _country).ToList();  // Here _country is the method parameter.. assume \"c\"\n}\n</code></pre>\n\n<p><code>Track</code> class has 12 properties. Checking for 12 times like above is not good sign.\nI would like to achieve this by using <code>LINQ</code> or any other which is simple.</p>\n\n<p>Any suggestions please?</p>\n"},{"tags":["c#","datatable"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":7137,"score":4,"question_id":4020270,"title":"copy rows from Datatable to another Datatable c#","body":"<p>how can I copy specific rows from datatable to another datatable in c#? more than on row </p>\n"},{"tags":["c#","security","token","information","privilege"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13293932,"title":"Privileges of an Application","body":"<p>Is there a way to get the privileges associated with a C# program?  If yes, how?</p>\n\n<p>I know that in C, you have to create a token and make use of the GetTokenInformation() method to get information about the token.</p>\n\n<p>Is there something similar in C#?</p>\n"},{"tags":["c#","c++","sharing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":73,"score":-1,"question_id":13275264,"title":"Sharing variables between C# and C++","body":"<p>I'm writing a software in c# which needs to call many times and by many threads a function in a c++ unmanaged dll. </p>\n\n<p>I have a C++ file like that:</p>\n\n<pre><code>// \"variables\"\n\nextern \"C\"\n{\n     __declspec(dllexport) int function1()\n    {\n        // some work depending on random and on the \"variables\"\n    }\n}\n</code></pre>\n\n<p>and a C# class like that</p>\n\n<pre><code>public class class1\n{\n    //  \"variables\" &lt;--- the \"same\" as the C++ file's ones \n    //  Dll import &lt;--- ok\n\n    public void method1()\n    {\n        int [] result;\n\n        for(int i=0; i&lt;many_times; i++)\n        {\n            result = new int[number_of_parallel_tasks];                \n\n            Parallel.For(0, number_of_parallel_tasks, delegate(int j)\n            { \n                 // I would like to do  result[j] = function1()  \n            });\n\n            //  choose best result\n            //  then update \"variables\" \n        }\n    }\n\n}\n</code></pre>\n\n<p>I wrote \"I would like to do ...\" because the c++ function needs at each round to have the \"variables\" updated, too.</p>\n\n<p>My question is:</p>\n\n<p>Is it possible to share memory between C++ and C# in order to avoid doubling the updates at each round?<br>\nI read about memory mapped files. Are that all I need, or do you know more appropriate solutions?<br>\nThank you.</p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13293323,"title":"Trying to take user input and write to a file","body":"<p>i'm having a problem where I am trying to save the geolocation of an address unto a file.  I am using hidden labels to transfer the information.</p>\n\n<p>on the client side button event I have: </p>\n\n<pre><code>   function save() {\n        document.getElementById(\"hidLat\").value = y;\n        document.getElementById(\"hidLon\").value = x;\n        &lt;% saveAddress s = save(); %&gt;\n   }\n</code></pre>\n\n<p>and in c# I have:</p>\n\n<pre><code>   protected saveAddress save()\n   {\n        saveAddress s = new saveAddress();\n        s.latitude = hidLat.Value;\n        s.longitude = hidLon.Value;\n\n        using (System.IO.StreamWriter file = new System.IO.StreamWriter(@\"C:\\\\savedAddresses.txt\", true))\n        {\n            file.WriteLine(s.latitude + \" \" + s.longitude);\n            file.Close();\n        }  \n\n        return s;\n   }\n</code></pre>\n\n<p>When I click on the button the file is created but nothing is saved into it.\nAm I doing this right or is there a better way to try and write the user input into a file?</p>\n"},{"tags":["c#","linq","plinq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13292817,"title":"Parallel Linq query fails to execute","body":"<p>Hello I have just started to try and understand Parallel Linq and with my first attempt I am having no success. I am using EF 4.0 and a repository pattern class that I created to query the data. I don't believe that the repository pattern is the problem but I could be mistaken.</p>\n\n<p>The database that I have isn't setup the way that I would like it but hey I inherited the system. The code that I am having the problem with is below:</p>\n\n<pre><code>            var gId = Sql.ToGuid(Request[\"ID\"]);\n\n            var lOrdersGridList = new OrdersGridList(); //Class that only contains properties\n\n            var lOrdersForContact = new BaseRepository&lt;ORDER&gt;()\n                .Find(i =&gt; i.ORDERS_CONTACTS.Where(b =&gt; b.CONTACT_ID == gId).Count() &gt; 0).AsParallel()\n                .Select(i =&gt;\n                    new OrdersGridList\n                        {\n                            ORDER_ID = i.ID,\n                            ORDER_NUM = i.ORDER_NUM,\n                            SHIPPING_ACCOUNT_ID = i.ORDERS_ACCOUNTS.Where(b =&gt;  b.ORDER_ID == i.ID &amp;&amp; b.ACCOUNT_ROLE == \"Ship To\").First().ACCOUNT_ID,\n                            SHIPPING_ACCOUNT_NAME = i.ORDERS_ACCOUNTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.ACCOUNT_ROLE == \"Ship To\").First().ACCOUNT.NAME,\n                            SHIPPING_CONTACT_ID = i.ORDERS_CONTACTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.CONTACT_ROLE == \"Ship To\").First().CONTACT_ID,\n                            SHIPPING_CONTACT_NAME = i.ORDERS_CONTACTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.CONTACT_ROLE == \"Ship To\")\n                                                                .Select(b =&gt; new { SHIPPING_CONTACT_NAME = (b.CONTACT.FIRST_NAME + ' ' + b.CONTACT.LAST_NAME) }).First().SHIPPING_CONTACT_NAME,\n                            NAME = i.NAME\n\n                        }).DefaultIfEmpty(lOrdersGridList).ToList&lt;OrdersGridList&gt;();\n\n\n            grdMain.DataSource = lOrdersForContact.ToDataTable().DefaultView; //ToDataTable extension function converts the List Object to a datatable.\n</code></pre>\n\n<p>If I run the Code without AsParallel the code executes with no problem however, once I add AsParallel I receive the following error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Y1Tpw.jpg\" alt=\"error message\"></p>\n\n<p>Also just in case you wanted to see this is the class that I am declaring as new for the Select Above:</p>\n\n<pre><code>public class OrdersGridList : EntityObject\n{\n    public string ORDER_NUM { get; set; }\n\n    public Guid ORDER_ID { get; set; }\n\n    public Guid SHIPPING_ACCOUNT_ID { get; set; }\n\n    public string SHIPPING_ACCOUNT_NAME { get; set; }\n\n    public Guid SHIPPING_CONTACT_ID { get; set; }\n\n    public string SHIPPING_CONTACT_NAME { get; set; }\n\n    public string NAME { get; set; }\n}\n</code></pre>\n\n<p>If I remove all of the relationships that are used to retrieve data in the select I don't receive any errors:</p>\n\n<pre><code>                var lOrdersForContact = new BaseRepository&lt;ORDER&gt;()\n                .Find(i =&gt; i.ORDERS_CONTACTS.Where(b =&gt; b.CONTACT_ID == gId).Count() &gt; 0).AsParallel()\n                .Select(i =&gt;\n                    new OrdersGridList\n                        {\n                            ORDER_ID = i.ID,\n                            ORDER_NUM = i.ORDER_NUM,\n                            //SHIPPING_ACCOUNT_ID = i.ORDERS_ACCOUNTS.Where(b =&gt;  b.ORDER_ID == i.ID &amp;&amp; b.ACCOUNT_ROLE == \"Ship To\").First().ACCOUNT_ID,\n                            //SHIPPING_ACCOUNT_NAME = i.ORDERS_ACCOUNTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.ACCOUNT_ROLE == \"Ship To\").First().ACCOUNT.NAME,\n                            //SHIPPING_CONTACT_ID = i.ORDERS_CONTACTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.CONTACT_ROLE == \"Ship To\").First().CONTACT_ID,\n                            //SHIPPING_CONTACT_NAME = i.ORDERS_CONTACTS.Where(b =&gt; b.ORDER_ID == i.ID &amp;&amp; b.CONTACT_ROLE == \"Ship To\")\n                            //                                    .Select(b =&gt; new { SHIPPING_CONTACT_NAME = (b.CONTACT.FIRST_NAME + ' ' + b.CONTACT.LAST_NAME) }).First().SHIPPING_CONTACT_NAME,\n                            NAME = i.NAME\n\n                        }).DefaultIfEmpty(lOrdersGridList).ToList&lt;OrdersGridList&gt;();\n</code></pre>\n\n<p>I would be more than happy to give more information if required. Any help you can provide on using PLinq I would appreciate it.</p>\n"},{"tags":["c#","winforms","treeview","datasource","dataview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":550,"score":1,"question_id":5685111,"title":"how to bind dataview to the treeview?","body":"<p>I'm having a dataview which is collection of id &amp; name. And i want  to bind that dataview to the treeview control in the form of hirarchy. And i want to show the name field as the display text on the node &amp; i want to bind id as a value member to the tree node.</p>\n\n<p>IS it possible? If yes then how to do this?</p>\n\n<p>thanks..</p>\n"},{"tags":["c#","windows-phone-7","cryptography","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13293420,"title":"Working with hmacsha256 in windows store app","body":"<p>I'm migrating/converting/rebuilding a Windows Phone 7.1 app to a Windows 8 Store App.</p>\n\n<p>One method I am using in de WP7 app is giving me trouble:</p>\n\n<pre><code>private byte[] GetSHA256Key(string data, string secretKey)\n{\n    byte[] value = Encoding.UTF8.GetBytes(data);\n    byte[] secretKeyBytes = Encoding.UTF8.GetBytes(secretKey);\n\n    HMACSHA256 hmacsha256 = new HMACSHA256(secretKeyBytes);\n\n    byte[] resultBytes = hmacsha256.ComputeHash(value);\n\n    return resultBytes;\n}\n</code></pre>\n\n<p>Looking at the documentation for Windows Store Apps I came up with this new code which I hoped would give the same result. But, no. I'm doing something wrong. But what?</p>\n\n<pre><code>private byte[] GetSHA256Key(string value, string secretKey)\n{\n        // Create a MacAlgorithmProvider object for the specified algorithm.\n        MacAlgorithmProvider objMacProv = MacAlgorithmProvider.OpenAlgorithm(MacAlgorithmNames.HmacSha256);\n\n        // Create a buffer that contains the message to be signed.\n        IBuffer valueBuffer = CryptographicBuffer.ConvertStringToBinary(value, BinaryStringEncoding.Utf8);\n\n        // Create a key to be signed with the message.\n        IBuffer buffKeyMaterial = CryptographicBuffer.ConvertStringToBinary(secretKey, BinaryStringEncoding.Utf8);\n        CryptographicKey cryptographicKey = objMacProv.CreateKey(buffKeyMaterial);\n\n        // Sign the key and message together.\n        IBuffer bufferProtected = CryptographicEngine.Sign(cryptographicKey, valueBuffer);\n\n        DataReader dataReader = DataReader.FromBuffer(bufferProtected);\n        byte[] bytes = new byte[bufferProtected.Length];\n        dataReader.ReadBytes(bytes);\n\n        return bytes;\n}\n</code></pre>\n\n<p>I'm not an expert on Cryptography. I'm not sure what I'm doing. Maybe there is somebody out there who can help me.</p>\n\n<p>Thanx,\nJP</p>\n"},{"tags":["c#","api","facebook"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":3406,"score":0,"question_id":4151713,"title":"using facebook api in my C# application","body":"<p>i am new to c# technology.\nI am trying to use facebook api in my application.</p>\n\n<p>can anyone tell me where i can find sdk for facebook for windows mobile platform.</p>\n"},{"tags":["c#","asp.net-webforms","model-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13139959,"title":"Webforms Model Binding and Complex Types","body":"<p>I have a webforms project and I'm using the new Model Binding on ASP.NET 4.5. I have a strongly typed FormView on my page that contains a DropDownList that will allow the user to select a related entity (think Product -> Category).</p>\n\n<p>Is there a way to set this up so that, on my InsertMethod, I can get direct access to the related entity (Product.Category, for example)? I need to check some validation rules on the related entities, and the only way I found to do that was to set up my DropDownList to return the Id of the related record, and then fetch it from the database. That seems rather inefficient.</p>\n\n<p>Edit: Damn, no one huh!? Well, that's what you get for being an early adopter of new technologies! :D</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1086,"score":0,"question_id":2981904,"title":"problem with HttpWebRequest.GetResponse perfomance in multithread applcation","body":"<p>I have very bad perfomance of HttpWebRequest.GetResponse method when it is called from different thread for different URLs.\nFor example if we have one thread and execute url1 it requires 3sec.\nIf we ececute url1 and url2 in parallet it requires 10sec, first request ended after 8sec and second after 10sec.</p>\n\n<p>If we exutet 10 URLs url1, url2, ... url0 it requires 1min 4 sec!!! first request ended after 50 secs!</p>\n\n<p>I use GetResponse method. \nI tried te set <code>DefaultConnectionLimit</code> but it doesn't help.\nIf use BeginGetRequest/EndGetResponse methods it works very fast but only if this methods called from one thread. If from different it is also very slowly. \nI need to execute Http requests from many threads at one time.</p>\n\n<p>the same code executed in each thread. If only one thread GetResponse method works very fast. \nAlso IP addreses in URLs are different for each thread.\nIf you compile and run the following code you will see that requests hanled one by one. Fist executed 3 secs, second 8 secs, third 15secs ....\ni.e. no gains from multithreading.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Net;\nusing System.IO;\nusing System.Xml;\nusing System.Reflection;\nusing System.Threading;\nusing System.Collections.Generic;\nusing System.Collections.Specialized;\nusing System.Collections;\n\nnamespace HttpRequestExample\n{\n\n    class HttpPerformer\n    {\n        private Thread thread = null;\n        HttpWebRequest httpRequest = null;\n\n        public void start(string url)\n        {\n            thread = new Thread(new ThreadStart(WorkerThread));\n            thread.Name = url;\n            thread.Start();\n\n        }\n\n        public void WorkerThread()\n        {\n            try\n            {\n                HttpWebRequest req = (HttpWebRequest)WebRequest.Create((string)thread.Name);\n                Console.WriteLine(DateTime.Now + \" : before get response \" + thread.Name);\n                HttpWebResponse resp = (HttpWebResponse)req.GetResponse();\n                Console.WriteLine(DateTime.Now + \" : after get response \" + thread.Name);\n\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(DateTime.Now + \" : Exception : \" + e.Message + thread.Name);\n            }\n        }\n    }\n\n    class HttpAccessUtils\n    {\n        public static bool SetAllowUnsafeHeaderParsing20()\n        {\n            //Get the assembly that contains the internal class \n            Assembly aNetAssembly = Assembly.GetAssembly(typeof(System.Net.Configuration.SettingsSection));\n            if (aNetAssembly != null)\n            {\n                //Use the assembly in order to get the internal type for the internal class \n                Type aSettingsType = aNetAssembly.GetType(\"System.Net.Configuration.SettingsSectionInternal\");\n                if (aSettingsType != null)\n                {\n                    //Use the internal static property to get an instance of the internal settings class. \n                    //If the static instance isn't created allready the property will create it for us. \n                    object anInstance = aSettingsType.InvokeMember(\"Section\",\n                    BindingFlags.Static | BindingFlags.GetProperty | BindingFlags.NonPublic, null, null, new object[] { });\n\n                    if (anInstance != null)\n                    {\n                        //Locate the private bool field that tells the framework is unsafe header parsing should be allowed or not \n                        FieldInfo aUseUnsafeHeaderParsing = aSettingsType.GetField(\"useUnsafeHeaderParsing\", BindingFlags.NonPublic | BindingFlags.Instance);\n                        if (aUseUnsafeHeaderParsing != null)\n                        {\n                            aUseUnsafeHeaderParsing.SetValue(anInstance, true);\n                            return true;\n                        }\n                    }\n                }\n            }\n            return false;\n        }\n    }\n\n    class Program\n    {\n\n        static void Main(string[] args)\n        {\n            HttpAccessUtils.SetAllowUnsafeHeaderParsing20();\n            ServicePointManager.UseNagleAlgorithm = true;\n            ServicePointManager.Expect100Continue = true;\n            ServicePointManager.CheckCertificateRevocationList = true;\n            ServicePointManager.DefaultConnectionLimit = 200; //ServicePointManager.DefaultPersistentConnectionLimit;\n            ServicePointManager.MaxServicePoints = 100;\n            Console.WriteLine(ServicePointManager.MaxServicePoints);\n\n\n            ArrayList a = new ArrayList(150);\n\n            for (int i = 100; i &lt; 220; i++)\n            {\n                a.Add(\"http://207.242.7.\" + i.ToString());\n            }\n\n            for (int i = 0; i &lt; a.Count; i++)\n            {\n                HttpPerformer hp = new HttpPerformer();\n                hp.start((string)a[i]);\n            }\n\n        }\n\n        static void performRequest(object url)\n        {\n            try\n            {\n                HttpWebRequest req = (HttpWebRequest)WebRequest.Create((string)url);\n                Console.WriteLine(DateTime.Now + \" : before get response \" + url);\n                HttpWebResponse resp = (HttpWebResponse)req.GetResponse();\n                Console.WriteLine(DateTime.Now + \" : after get response \" + url);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(DateTime.Now + \" : Exception : \" + e.Message + (string)url);\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>Сan anyone ever encountered such a problem? Thank you for any suggestions.</p>\n"},{"tags":["c#","mysql","database","dapper"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13291589,"title":"Dapper query with list of parameters","body":"<p>I am trying to run a query with Dapper with a known set of parameters, but with a list of values for those parameters.  A simple example of what I am trying to do would be:</p>\n\n<pre><code>DateTime endDate = DateTime.Now;\nDateTime startDate = endDate.AddHours(-24);\n\nstring query = \"select COUNT(*) from Test where Status = @Status AND DateCreated &lt;= @Hour;\";\nvar stuff = con.Query(query, (startDate).ByHourTo(endDate).Select(hour =&gt; new\n{\n     Status = 1,\n     Hour = hour,\n}));\n</code></pre>\n\n<p>Dapper throws an exception with 'Parameter '@Status' must be defined'. I know Dapper can process lists of parameters when doing bulk inserts and updates, but can it not do this for selects?</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":13293753,"title":"ASP.Net How can I respond to a request sent to my generic handler","body":"<p>Lets assume I have told a 3rd party to send a request to my generic handler based at {http://myIp/Myhandler.ashx}. How can I respond to the request that they send? I have the function process request which gives me access to the context object but how can this be used to ensure my response goes back to the same place that the request originated from and thus acting as a reply to their request. I tried constructing an HTTPResponse object and sending it to their server but this did not work. I am trying to reply to them with an OK message and give them a web address to redirect the user to. </p>\n\n<pre><code> public void ProcessRequest(HttpContext context)\n        {\n\n            string status = context.Request.Params[\"Status\"];\n            string statusDetail = context.Request.Params[\"StatusDetail\"];\n\n            switch (status.ToUpper())\n            {\n                case \"OK\":\n                    {\n                        StringBuilder content = new StringBuilder();\n\n                        content.Append(\"Status=\" + HttpUtility.UrlEncode(\"OK\"));\n                        content.Append(\"&amp;RedirectURL=\" + HttpUtility.UrlEncode(\"http://http://myip:myport/Error.aspx?Error=SUCCESS\"));\n                        content.Append(\"&amp;StatusDetail=\" + HttpUtility.UrlEncode(\"OK\"));\n\n\n                        HttpWebResponse response = SendPOSTRequest(\"http://theirip.page\", content.ToString(), \"\", \"\", true);\n}\n}\n</code></pre>\n"},{"tags":["c#","windows"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":38,"score":-1,"question_id":13293806,"title":"How to creat a program like \"Dancer\" program in win XP?","body":"<p>as you see, there is a program in windows XP that names is \"Dancer\", a person is dancing when a song is playing..<br>\nI want to create a program like this, an object will move when call that object.<br>\nReally its a 3D-box that locate on Right-Down of desktop.<br>\nHow i can do this?! in programming in C#, can I do this with c#?!</p>\n"},{"tags":["c#","multithreading","asynchronous","delegates","threadpool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13293229,"title":"At which time and in which context should I call ThreadPool.SetMinThreads","body":"<p>I have an ASP .NET MVC 2 - application, which calls functions of a C#-DLL. </p>\n\n<p>The DLL itself is multithreaded. In the worst case it uses up to 200 threads, which do not run very long.</p>\n\n<p>I use asynchronous delegates in order to generate the threads. In order to speed up the initialization of the delegates, I calculate the number of threads I need in advance and give it to the ThreadPool:</p>\n\n<pre><code>ThreadPool.SetMinThreads(my_num_threads, ...); \n</code></pre>\n\n<p>I just wonder, if I need to do this early enough, such that the ThreadPool has enough time to create the threads? Do I have to consider, <em>when</em> I set the size of the ThreadPool or are the threads available immediately after I call SetMinThreads?</p>\n\n<p>Furthermore, if I set the size outside the DLL in my ASP .NET MVC-application (before I call the DLL), will this setting be available/visible for the DLL?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-4","web-optimization"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13290977,"title":"MVC Bundling - Include .min file for a single bundle","body":"<p>I have a single file in my application that I only have a minified version of and I would like to create a bundle for it:</p>\n\n<pre><code>bundles.Add(new ScriptBundle(\"~/bundles/maskedinput\").Include(\n    \"~/Scripts/jquery.maskedinput-1.3.min.js\"));\n</code></pre>\n\n<p>The problem is that by default in debug mode, the bundling mechanism ignores .min files. I don't want to turn off this rule for all bundles, but I would like to disable it for this single bundle. Is this possible?</p>\n"},{"tags":["c#","wcf","web-services","soap","saml-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":829,"score":4,"question_id":10305882,"title":"WCF client consumes JAVA web service - should I use WCF or just create a custom parser/message factory?","body":"<p>We've a business partner who requires us to create a service request message with a SAML 2.0 assertion. The partner's supplied two certificates and a test harness for their JAVA webservice.</p>\n\n<p>I've created a WCF client with a <code>CustomBinding</code> to try and recreate the request and consume the service, but I'm getting so frustrated with the nuances of WCF (and the lack of intrinsic support for SAML 2.0) I'm wondering am I better off using something like a <code>WebClient</code> or <code>HttpWebRequest</code> and encrypting/building &amp; signing the XML web request and doing the same for the response. I know there's a lot of work involved on this but at least I'd be in full control.</p>\n\n<p>Your advice would be very much appreciated, what I'm working with is displayed below</p>\n\n<p><strong>Note: I was supplied with a SoapUI Test harness for the Java service</strong></p>\n\n<p><strong>The vendor supplied me with this request (ran though SOAPUI and extracted via Fiddler)</strong></p>\n\n<pre><code>&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\"&gt;\n  &lt;SOAP-ENV:Header xmlns:wsa=\"http://www.w3.org/2005/08/addressing\"&gt;\n    &lt;wsse:Security SOAP-ENV:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"&gt;\n      &lt;xenc:EncryptedKey Id=\"EncKeyId-29B98C291D1FDFB39113352984774895\"&gt;\n        &lt;xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-1_5\"/&gt;\n        &lt;ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n          &lt;wsse:SecurityTokenReference&gt;\n            &lt;ds:X509Data&gt;\n              &lt;ds:X509IssuerSerial&gt;\n                &lt;ds:X509IssuerName&gt;CN=test_server&lt;/ds:X509IssuerName&gt;\n                &lt;ds:X509SerialNumber&gt;12356789&lt;/ds:X509SerialNumber&gt;\n              &lt;/ds:X509IssuerSerial&gt;\n            &lt;/ds:X509Data&gt;\n          &lt;/wsse:SecurityTokenReference&gt;\n        &lt;/ds:KeyInfo&gt;\n        &lt;xenc:CipherData&gt;\n          &lt;xenc:CipherValue&gt;\n            &lt;!--Omitted --&gt;\n          &lt;/xenc:CipherValue&gt;\n        &lt;/xenc:CipherData&gt;\n        &lt;xenc:ReferenceList&gt;\n          &lt;xenc:DataReference URI=\"#EncDataId-3\"/&gt;\n        &lt;/xenc:ReferenceList&gt;\n      &lt;/xenc:EncryptedKey&gt;\n      &lt;wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"CertId-29B98C291D1FDFB39113352984773591\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;&lt;!--Omitted --&gt;&lt;/wsse:BinarySecurityToken&gt;\n      &lt;ds:Signature Id=\"Signature-1\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;ds:SignedInfo&gt;\n          &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n          &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n          &lt;ds:Reference URI=\"#id-2\"&gt;\n            &lt;ds:Transforms&gt;\n              &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;/ds:Transforms&gt;\n            &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n            &lt;ds:DigestValue&gt;\n              &lt;!--Omitted --&gt;\n            &lt;/ds:DigestValue&gt;\n          &lt;/ds:Reference&gt;\n        &lt;/ds:SignedInfo&gt;\n        &lt;ds:SignatureValue&gt;\n          &lt;!--Omitted --&gt;\n        &lt;/ds:SignatureValue&gt;\n        &lt;ds:KeyInfo Id=\"KeyId-29B98C291D1FDFB39113352984773792\"&gt;\n          &lt;wsse:SecurityTokenReference wsu:Id=\"STRId-29B98C291D1FDFB39113352984773893\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n            &lt;wsse:Reference URI=\"#CertId-29B98C291D1FDFB39113352984773591\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"/&gt;\n          &lt;/wsse:SecurityTokenReference&gt;\n        &lt;/ds:KeyInfo&gt;\n      &lt;/ds:Signature&gt;\n    &lt;/wsse:Security&gt;\n    &lt;saml:Assertion ID=\"_54d0c8395de26c3e44730df2c9e8d3e9\" IssueInstant=\"2012-02-17T10:40:36.806Z\" Version=\"2.0\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\"&gt;\n      &lt;saml:Issuer&gt;CN=test_client&lt;/saml:Issuer&gt;\n      &lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;SignedInfo&gt;\n          &lt;CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n          &lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n          &lt;Reference URI=\"#_54d0c8395de26c3e44730df2c9e8d3e9\"&gt;\n            &lt;Transforms&gt;\n              &lt;Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n              &lt;Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;/Transforms&gt;\n            &lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n            &lt;DigestValue&gt;\n              &lt;!--Omitted --&gt;\n            &lt;/DigestValue&gt;\n          &lt;/Reference&gt;\n        &lt;/SignedInfo&gt;\n        &lt;SignatureValue&gt;\n          &lt;!--Omitted --&gt;\n        &lt;/SignatureValue&gt;\n        &lt;KeyInfo&gt;\n          &lt;X509Data&gt;\n            &lt;X509Certificate&gt;\n              &lt;!--Omitted --&gt;\n            &lt;/X509Certificate&gt;\n          &lt;/X509Data&gt;\n        &lt;/KeyInfo&gt;\n      &lt;/Signature&gt;\n      &lt;saml:Subject&gt;\n        &lt;saml:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\"&gt;joe.bloggs@facility.ie&lt;/saml:NameID&gt;\n      &lt;/saml:Subject&gt;\n      &lt;saml:Conditions NotBefore=\"2012-02-17T10:40:21.806Z\" NotOnOrAfter=\"2012-02-17T10:41:06.806Z\"/&gt;\n    &lt;/saml:Assertion&gt;\n    &lt;wsa:Action SOAP-ENV:mustUnderstand=\"1\"&gt;http://www.xxxxxxx.xxx/ws/schemas/xxxxxx1/xxxx/xxxxxxxxxxxxxx&lt;/wsa:Action&gt;\n    &lt;wsa:MessageID SOAP-ENV:mustUnderstand=\"1\"&gt;uuid:bffc27ba-68d9-44e6-b1f0-e2f852df7715&lt;/wsa:MessageID&gt;\n  &lt;/SOAP-ENV:Header&gt;\n  &lt;SOAP-ENV:Body wsu:Id=\"id-2\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n    &lt;xenc:EncryptedData Id=\"EncDataId-3\" Type=\"http://www.w3.org/2001/04/xmlenc#Content\"&gt;\n      &lt;xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#tripledes-cbc\"/&gt;\n      &lt;ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;wsse:SecurityTokenReference xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"&gt;\n          &lt;wsse:Reference URI=\"#EncKeyId-29B98C291D1FDFB39113352984774895\"/&gt;\n        &lt;/wsse:SecurityTokenReference&gt;\n      &lt;/ds:KeyInfo&gt;\n      &lt;xenc:CipherData&gt;\n        &lt;xenc:CipherValue&gt;\n          &lt;!--Omitted --&gt;\n        &lt;/xenc:CipherValue&gt;\n      &lt;/xenc:CipherData&gt;\n    &lt;/xenc:EncryptedData&gt;\n  &lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n\n<p><strong>This is as close as I've gotten with my WCF client. Issues I can immediatley is that the <code>&lt;o:SecurityTokenReference&gt;</code> element should contain the Issuer and Serial, instead it contains a <code>KeyIdentifier</code> element?</strong></p>\n\n<pre><code>&lt;s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:a=\"http://www.w3.org/2005/08/addressing\" xmlns:u=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n  &lt;s:Header&gt;\n    &lt;a:Action s:mustUnderstand=\"1\" u:Id=\"_3\"/&gt;\n    &lt;a:MessageID u:Id=\"_4\"&gt;urn:uuid:fc8ef84b-dbf5-4150-a0c3-d4cc986333d1&lt;/a:MessageID&gt;\n    &lt;ActivityId CorrelationId=\"a9e1fec4-32bc-4633-909e-3d601c809b3c\" xmlns=\"http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics\"&gt;d1909115-8922-46f3-a96c-db15bf91c599&lt;/ActivityId&gt;\n    &lt;a:ReplyTo u:Id=\"_5\"&gt;\n      &lt;a:Address&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/a:Address&gt;\n    &lt;/a:ReplyTo&gt;\n    &lt;VsDebuggerCausalityData xmlns=\"http://schemas.microsoft.com/vstudio/diagnostics/servicemodelsink\"&gt;uIDPo27oY4/3mnBOry0YL4StqvcAAAAA0UM+eVt4fU2AOe9/B3lPDZNf/2HmAuNEvzAoW0eKVSUACQAA&lt;/VsDebuggerCausalityData&gt;\n    &lt;a:To s:mustUnderstand=\"1\" u:Id=\"_6\"&gt;https://localhost:8089/ws&lt;/a:To&gt;\n    &lt;o:Security s:mustUnderstand=\"1\" xmlns:o=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"&gt;\n      &lt;u:Timestamp u:Id=\"uuid-e5592f06-32af-40fb-996e-a0a469c7ed5e-2\"&gt;\n        &lt;u:Created&gt;2012-04-24T20:41:50.447Z&lt;/u:Created&gt;\n        &lt;u:Expires&gt;2012-04-24T20:46:50.447Z&lt;/u:Expires&gt;\n      &lt;/u:Timestamp&gt;\n      &lt;e:EncryptedKey Id=\"uuid-e5592f06-32af-40fb-996e-a0a469c7ed5e-1\" xmlns:e=\"http://www.w3.org/2001/04/xmlenc#\"&gt;\n        &lt;e:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-1_5\"/&gt;\n        &lt;KeyInfo xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n          &lt;o:SecurityTokenReference&gt;\n            &lt;o:KeyIdentifier ValueType=\"http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#ThumbprintSHA1\" EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"&gt;lU10DQn4lSpE4fRpE9gslm5QDt0=&lt;/o:KeyIdentifier&gt;\n          &lt;/o:SecurityTokenReference&gt;\n        &lt;/KeyInfo&gt;\n        &lt;e:CipherData&gt;\n          &lt;e:CipherValue&gt;\n            &lt;!--Omitted--&gt;\n          &lt;/e:CipherValue&gt;\n        &lt;/e:CipherData&gt;\n        &lt;e:ReferenceList&gt;\n          &lt;e:DataReference URI=\"#_2\"/&gt;\n          &lt;e:DataReference URI=\"#_7\"/&gt;\n          &lt;e:DataReference URI=\"#_8\"/&gt;\n        &lt;/e:ReferenceList&gt;\n      &lt;/e:EncryptedKey&gt;\n      &lt;o:BinarySecurityToken u:Id=\"uuid-fad0c01f-ab4b-4a5f-bec6-93aa8c2d5a52-1\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"&gt;&lt;!--Omitted--&gt;&lt;/o:BinarySecurityToken&gt;\n      &lt;e:EncryptedData Id=\"_7\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\" xmlns:e=\"http://www.w3.org/2001/04/xmlenc#\"&gt;\n        &lt;e:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#tripledes-cbc\"/&gt;\n        &lt;e:CipherData&gt;\n          &lt;e:CipherValue&gt;\n            &lt;!--Omitted--&gt;\n          &lt;/e:CipherValue&gt;\n        &lt;/e:CipherData&gt;\n      &lt;/e:EncryptedData&gt;\n      &lt;e:EncryptedData Id=\"_8\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\" xmlns:e=\"http://www.w3.org/2001/04/xmlenc#\"&gt;\n        &lt;e:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#tripledes-cbc\"/&gt;\n        &lt;e:CipherData&gt;\n          &lt;e:CipherValue&gt;&lt;!--Omitted--&gt;&lt;/e:CipherValue&gt;\n        &lt;/e:CipherData&gt;\n      &lt;/e:EncryptedData&gt;\n    &lt;/o:Security&gt;\n  &lt;/s:Header&gt;\n  &lt;s:Body u:Id=\"_1\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n    &lt;e:EncryptedData Id=\"_2\" Type=\"http://www.w3.org/2001/04/xmlenc#Content\" xmlns:e=\"http://www.w3.org/2001/04/xmlenc#\"&gt;\n      &lt;e:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#tripledes-cbc\"/&gt;\n      &lt;e:CipherData&gt;\n        &lt;e:CipherValue&gt;&lt;!--Omitted--&gt;&lt;/e:CipherValue&gt;\n      &lt;/e:CipherData&gt;\n    &lt;/e:EncryptedData&gt;\n  &lt;/s:Body&gt;\n&lt;/s:Envelope&gt;\n</code></pre>\n\n<p>Using this configuration for the WCF CustomBinding</p>\n\n<pre><code>&lt;system.serviceModel&gt;        \n        &lt;bindings&gt;\n          &lt;customBinding&gt;\n            &lt;binding name=\"WSHttpBinding_IEnquiryRequest\" &gt;\n              &lt;transactionFlow /&gt;\n              &lt;security defaultAlgorithmSuite=\"TripleDesRsa15\"\n                        authenticationMode=\"MutualCertificate\" \n                        messageSecurityVersion=\"WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10\" \n                        requireDerivedKeys=\"false\"\n                        &gt;\n\n                      &lt;secureConversationBootstrap authenticationMode=\"CertificateOverTransport\" \n                                           messageSecurityVersion=\"WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10\" \n                                           requireDerivedKeys=\"false\" /&gt;\n              &lt;/security&gt;\n              &lt;textMessageEncoding messageVersion=\"Soap11WSAddressing10\" /&gt;\n              &lt;!--&lt;mtomMessageEncoding messageVersion=\"Soap11WSAddressing10\" /&gt;--&gt;\n              &lt;httpsTransport requireClientCertificate=\"true\" /&gt;\n            &lt;/binding&gt;\n          &lt;/customBinding&gt;            \n        &lt;/bindings&gt;\n      &lt;behaviors&gt;\n        &lt;endpointBehaviors&gt;\n          &lt;behavior name=\"certBehaviour\"&gt;            \n              &lt;clientCredentials&gt;\n                &lt;!-- clientCertificate not defaultCertificate --&gt;\n                &lt;clientCertificate x509FindType=\"FindBySubjectName\" storeLocation=\"CurrentUser\" storeName=\"My\" findValue=\"test_client\" /&gt;\n                &lt;serviceCertificate&gt;\n                  &lt;defaultCertificate x509FindType=\"FindBySubjectName\" storeLocation=\"CurrentUser\" storeName=\"My\" findValue=\"test_server\"/&gt;\n                  &lt;authentication revocationMode=\"NoCheck\" certificateValidationMode=\"None\"  /&gt;\n                &lt;/serviceCertificate&gt;\n              &lt;/clientCredentials&gt;            \n          &lt;/behavior&gt;\n        &lt;/endpointBehaviors&gt;\n      &lt;/behaviors&gt;\n        &lt;client&gt;\n          &lt;endpoint\n               address=\"https://localhost:8089/pvs/ws\"\n               binding=\"customBinding\"\n               bindingConfiguration=\"WSHttpBinding_IEnquiryRequest\"\n               contract=\"XXXService.enquiryRequest\"\n               name=\"WSHttpBinding_IEnquiryRequest\"\n               behaviorConfiguration=\"certBehaviour\"\n               &gt;\n            &lt;identity&gt;\n              &lt;dns value=\"test_server\"/&gt;\n            &lt;/identity&gt;\n          &lt;/endpoint&gt;\n        &lt;/client&gt;\n    &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p><strong>I've no idea how to insert the SAML 2.0 assertion in there before it's signed. That and the Key Issuer/serial issue above is where my main problems lie with the request.</strong></p>\n\n<p>Any and all help appreciated</p>\n"},{"tags":["c#","performance","sortedlist"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":112,"score":9,"question_id":13292945,"title":"C# fast way to check and then insert into a sortedlist","body":"<p>Whenever I want to insert into a <code>SortedList</code>, I check to see if the item exists, then I insert. Is this performing the same search twice? Once to see if the item is there and again to find where to insert the item? Is there a way to optimize this to speed it up or is this just the way to do it, no changes necessary?</p>\n\n<pre><code>if( sortedList.ContainsKey( foo ) == false ){\n    sortedList.Add( foo, 0 );\n}\n</code></pre>\n"},{"tags":["c#","jquery","countdown"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13293745,"title":"jQuery countdown and C# repeater","body":"<p>I'm trying to make multiple countdowns, using jQuery in a C# web application.</p>\n\n<p>I have two different dates in my database, which I'm inserting into the javascript. This works fine, but the javascript is using the same date from the DB, and it's probaly because theres only one instance of the javascript, so I need some advice on how to solve this.</p>\n\n<p>Here is the full code.</p>\n\n<p>Markup:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"scripts/jquery.countdown.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n    $(function () {\n        var count = new Date('&lt;%=Datestring%&gt;');\n        var countdown = setInterval(function () {\n            $('.countdown').countdown({ until: count, format: 'DHMS' });\n            if (count == 0) {\n                window.location = 'http://google.com';\n            }\n            count--;\n        }, 1000);\n    });\n&lt;/script&gt;\n\n&lt;asp:Repeater ID=\"repAuctions\" runat=\"server\" OnItemDataBound=\"repAuctions_OnItemDataBound\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;div&gt;\n            &lt;asp:Literal ID=\"litHeading\" runat=\"server\" /&gt;\n            &lt;br/&gt;\n            &lt;asp:Literal ID=\"litCountDown\" runat=\"server\" /&gt;\n        &lt;/div&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:Repeater&gt;\n</code></pre>\n\n<p>Backend:</p>\n\n<pre><code>public string Datestring;\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        repAuctions.DataSource = AuctionsFactory.GetAllAuctions();\n        repAuctions.DataBind();\n    }\n\n    protected void repAuctions_OnItemDataBound(object sender, RepeaterItemEventArgs e)\n    {\n        var auction = (Auction)e.Item.DataItem;\n        var litCountDown = (Literal)e.Item.FindControl(\"litCountDown\");\n        var litHeading = (Literal)e.Item.FindControl(\"litHeading\");\n\n        string format = \"ddd MMM d yyyy HH:mm:ss\";\n        var countdowndate = (DateTime) auction.TimeLeft;\n        Datestring = countdowndate.ToString(format);\n\n        litHeading.Text = auction.Heading;\n        litCountDown.Text = auction.TimeLeft + \"&lt;span class='countdown'&gt;&lt;/span&gt;\";\n    }\n</code></pre>\n\n<p>Thanks in advance :)</p>\n"},{"tags":["c#","c++","com","unmanaged","managed"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13291267,"title":"Managed byte[] to unmanaged byte array using ATL/COM","body":"<p>I want to pass some image data from C# code to unmanaged C++ using ATL/COM</p>\n\n<p>From C# code side i do something like this:</p>\n\n<pre><code>void SendFrame([In, MarshalAs(UnmanagedType.SafeArray, SafeArraySubType=VarEnum.VT_UI1)] ref byte[] frameData);\n</code></pre>\n\n<p>But I'm not sure how should I handle this function in my C++ code.</p>\n\n<p>For now I have something like this:</p>\n\n<pre><code>_ATL_FUNC_INFO OnSendFrameDef = { CC_STDCALL, VT_EMPTY, 1, { VT_SAFEARRAY | VT_UI1 } };\n\nvoid __stdcall OnSendFrame(SAFEARRAY* ppData)\n{\n   BYTE* pData;\n   SafeArrayAccessData(ppData, (void **) &amp;pData);\n\n   // Doing some stuff with my pData\n\n   SafeArrayUnaccessData(ppData);\n}\n</code></pre>\n\n<p>Can anyone give me some suggestions how I can make this thing work?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wpf","winforms","c#-4.0","user-interface"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13098766,"title":"Creating a Console like UI in Windows Forms","body":"<p>Hi I'm trying to create a console like interface using a richtextbox in WinForms using C#.</p>\n\n<p>The reason why I am using a richtextbox is I want a few features such as selection,copy-paste that are not present in a normal console application.</p>\n\n<p>I was wondering if it was possible to change the blinking cursor from the blinking \"|\" to a blinking \"_\"</p>\n\n<p>Even if I could hide the original \"|\", I could then implement a functionality on the onchange event of the richtextbox to display the blinking, \"_\"</p>\n\n<p>I also had another related question, but I don't know if I should put that here as well.</p>\n\n<p>Also, if it will be easier to implement something like this using WPF, I'm willing to move.</p>\n"},{"tags":["c#","wcf","web-services","error-handling","windows-server-2003"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13279350,"title":"How do I disable the Visual C++ Runtime Error in a Web Server?","body":"<p>A production web service that runs WCF on a Windows Server 2003 machine was non-responsive.  I captured a memory dump file for analysis in <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=26798\" rel=\"nofollow\">DebugDiag 1.2</a>.</p>\n\n<p>DebugDiag revealed that a thread encountered an OutOfMemoryException.  Normally, we try to trap all exceptions, print them to the event log, and then return them as a WCF fault.</p>\n\n<p>This OutOfMemoryException was somehow not caught and resulted in a C++ error.  I accept that the .NET runtime was unable to handle this error.  When you're out of memory, you're out of memory.</p>\n\n<p>The analysis revealed that the that one of the threads was attempting to display the Visual C++ runtime error:</p>\n\n<blockquote>\n  <p>Microsoft Visual C++ Runtime Library Runtime Error!  Program: C:\\windows\\system32\\inetsrv\".</p>\n</blockquote>\n\n<p>The stack trace looked like this:</p>\n\n<pre><code>ntdll!KiFastSystemCallRet    \nntdll!ZwRaiseHardError+c    \nuser32!ServiceMessageBox+145    \nuser32!MessageBoxWorker+13e    \nuser32!MessageBoxTimeoutW+7a    \nuser32!MessageBoxTimeoutA+9c    \nuser32!MessageBoxExA+1b    \nuser32!MessageBoxA+45    \nmsvcr71!__crtMessageBoxA+f4   f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crtmbox.c @ 118 + 10 \nmsvcr71!_NMSG_WRITE+12e  f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crt0msg.c @ 240 + 10 \nmsvcr71!abort+7   f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\abort.c @ 48 \nkernel32!UnhandledExceptionFilter+12a    \nkernel32!BaseThreadStart+4a    \nkernel32!_except_handler3+61    \nntdll!ExecuteHandler2+26    \nntdll!ExecuteHandler+24    \nntdll!RtlRaiseException+3d    \nkernel32!RaiseException+53    \nmsvcr80!_CxxThrowException+46    \nmscorwks!ThrowOutOfMemory+24 \n</code></pre>\n\n<p>The documentation of <a href=\"http://msdn.microsoft.com/en-us/library/k089yyh0.aspx\" rel=\"nofollow\">abort</a> says:</p>\n\n<blockquote>\n  <p>In a single or multithreaded Windows-based application, abort calls\n  the Windows MessageBox function to create a message box to display the\n  message with an OK button. When the user clicks OK, the program aborts\n  immediately. The message can be suppressed by calling\n  <a href=\"http://msdn.microsoft.com/en-us/library/e631wekh%28v=vs.80%29.aspx\" rel=\"nofollow\">_set_abort_behavior</a> with the appropriate arguments.</p>\n</blockquote>\n\n<p>This message box hung the server.  One thread had triggered a GC, but this thread had disabled preemptive GC.  Most of the rest of the threads where blocking while waiting for the GC to complete.</p>\n\n<p><strong>How do I <a href=\"http://stackoverflow.com/questions/1938715/disable-microsoft-visual-c-runtime-error\">disable the Visual C++ Runtime Error dialog</a> for a web server?</strong></p>\n\n<p>-- EDIT --</p>\n\n<p>The OutOfMemoryException was thrown in one thread that was processing a large DataSet.  Once this was thrown, there was a cross-context exception thrown.  This resulted in the following stack trace in WinDbg:</p>\n\n<pre><code>1c54eee8 78158e89 e06d7363 00000001 00000003 kernel32!RaiseException+0x53 (FPO: [Non-Fpo])\n1c54ef20 7a14fd18 1c54ef30 7a37d92c 7a3c4aa8 **msvcr80**!_CxxThrowException+0x46 (FPO: [Non-Fpo])\n1c54ef34 7a1082db f74a69a8 79f38888 1c54f108 mscorwks!ThrowOutOfMemory+0x24 (FPO: [Non-Fpo])\n1c54f060 7a10a245 00000000 1c54f098 1c54f108 mscorwks!Thread::RaiseCrossContextException+0x408 (FPO: [Non-Fpo])\n1c54f114 79fd882b 00000002 79fd87f6 1c54f20c mscorwks!Thread::DoADCallBack+0x2a2 (FPO: [Non-Fpo])\n1c54f130 79e9846b 1c54f20c 1c54f1b8 79f7762b mscorwks!Thread::DoADCallBack+0x310 (FPO: [Non-Fpo])\n1c54f1c4 79e98391 1c54f20c f74a6bc8 23e78e00 mscorwks!Thread::ShouldChangeAbortToUnload+0xe3 (FPO: [Non-Fpo])\n1c54f200 79e9851d 1c54f20c 00000002 00000000 mscorwks!Thread::ShouldChangeAbortToUnload+0x30a (FPO: [Non-Fpo])\n1c54f228 79fd8f6c 00000002 7a0b68a2 1c54f264 mscorwks!Thread::ShouldChangeAbortToUnload+0x33e (FPO: [Non-Fpo])\n1c54f240 7a0b6b5b 00000002 7a0b68a2 1c54f264 mscorwks!ManagedThreadBase::ThreadPool+0x13 (FPO: [Non-Fpo])\n1c54f294 7a0b6b8d 00000000 00000000 04a47fe0 mscorwks!BindIoCompletionCallbackStubEx+0x95 (FPO: [Non-Fpo])\n1c54f2ac 79f3e605 00000000 00000000 04a47fe0 mscorwks!BindIoCompletionCallbackStub+0x13 (FPO: [Non-Fpo])\n1c54f314 79f920a5 00000000 00000000 7ffdc000 mscorwks!ThreadpoolMgr::CompletionPortThreadStart+0x430 (FPO: [Non-Fpo])\n1c54ffb8 77e64829 23e29018 00000000 00000000 mscorwks!Thread::intermediateThreadProc+0x49 (FPO: [Non-Fpo])\n1c54ffec 00000000 79f9205f 23e29018 00000000 kernel32!BaseThreadStart+0x34 (FPO: [Non-Fpo])\n</code></pre>\n\n<p>And <em>that</em> exception resulted in a call to the runtime to display this message:</p>\n\n<pre><code>1c54e340 7c82775b 773d7a4b 50000018 00000004 ntdll!KiFastSystemCallRet\n1c54e344 773d7a4b 50000018 00000004 00000003 ntdll!NtRaiseHardError+0xc\n1c54e3a0 773b8377 1d05ff70 1d052e48 00012010 user32!ServiceMessageBox+0x145\n1c54e4fc 7739eec9 1c54e508 00000028 00000000 user32!MessageBoxWorker+0x13e\n1c54e554 773d7d0d 00000000 1d05ff70 1d052e48 user32!MessageBoxTimeoutW+0x7a\n1c54e588 773c42c8 00000000 1c54e62c 7c37f480 user32!MessageBoxTimeoutA+0x9c\n1c54e5a8 773c42a4 00000000 1c54e62c 7c37f480 user32!MessageBoxExA+0x1b\n1c54e5c4 7c34c224 00000000 1c54e62c 7c37f480 user32!MessageBoxA+0x45\n1c54e5f8 7c348e6c 1c54e62c 7c37f480 00212010 msvcr71!__crtMessageBoxA+0xf4 [f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crtmbox.c @ 118]\n1c54e81c 7c34cf83 0000000a 00000000 1c54ead4 msvcr71!_NMSG_WRITE+0x12e [f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\crt0msg.c @ 240]\n1c54e854 77e761b7 1c54ead4 00000000 00000000 msvcr71!abort+0x7 [f:\\vs70builds\\3052\\vc\\crtbld\\crt\\src\\abort.c @ 48]\n1c54eaac 77e792a3 1c54ead4 77e61ac1 1c54eadc kernel32!UnhandledExceptionFilter+0x12a\n1c54eab4 77e61ac1 1c54eadc 00000000 1c54eadc kernel32!BaseThreadStart+0x4a\n1c54eadc 7c828752 1c54ee98 1c54ffdc 1c54ebb8 kernel32!_except_handler3+0x61\n1c54eb00 7c828723 1c54ee98 1c54ffdc 1c54ebb8 ntdll!ExecuteHandler2+0x26\n1c54eba8 7c82863c 1c549000 1c54ebb8 00010007 ntdll!ExecuteHandler+0x24\n1c54ee88 77e4bee7 1c54ee98 00000002 e06d7363 ntdll!RtlRaiseException+0x3d\n1c54eee8 78158e89 e06d7363 00000001 00000003 kernel32!RaiseException+0x53\n</code></pre>\n\n<p>I'm not sure why there are 2 versions of the Visual Studio Runtime Library on the stack.  That is unusual.  I see no evidence of other 3rd party DLLs on the stack.</p>\n"},{"tags":["c#","windows","shell","imagemagick","cmd"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13291537,"title":"Using portable imagemagick convert program","body":"<p>YO.</p>\n\n<p>Could I ask you wizards a question? How do I pass image filepaths to convert.exe, given I know all the file paths? ImageMagick is NOT installed, but just in my project folder. I don't think I'm supposed to pass the image filepaths through a cmd prompt. Here is my current attempt. I get no errors from it -- but a cmd prompt pops up quickly and disappears quickly -- I've printed the screen when it's up and <a href=\"http://imgur.com/ftQ7I\" rel=\"nofollow\">it's saying something about userparams</a>...which apparently has to do with ImageMagick somehow. I'm not sure what I'm doing wrong :</p>\n\n<pre><code>    string currDir = System.Environment.CurrentDirectory;\n    string convertPath = currDir + @\"\\ImageMagick\\convert.exe\";\n    string convertedDir = currDir + @\"\\ConvertedPDFs\\\";\n    string pdfFolder = currDir + @\"\\PDFs\\\";\n    string fileName = \"Appointment\";\n    //System.IO.Directory.CreateDirectory(currDir + @\"\\\" + convertedDirName);\n    string argumentForImageMagick;\n\n\n    argumentForImageMagick = pdfFolder + fileName + \".pdf\" + \" \" + convertedDir + fileName + \".png\";\n    ProcessStartInfo info = new ProcessStartInfo {Arguments = argumentForImageMagick , FileName = convertPath};\n    System.Diagnostics.Process.Start(info).WaitForExit();\n</code></pre>\n\n<p>When I print the argument and filepath for the ProcessStartInfo instance, I get</p>\n\n<blockquote>\n  <p>F:\\ImageMagickTest\\PDFs\\Appointment.pdf\n  F:\\ImageMagickTest\\ConvertedPDFs\\Appointment.png</p>\n</blockquote>\n\n<p>for the argument, and </p>\n\n<blockquote>\n  <p>F:\\ImageMagickTest\\ImageMagick\\convert.exe</p>\n</blockquote>\n\n<p>for the filepath.</p>\n\n<p>Do you have any idea which God I have angered, and what is going wrong? Thanks for your time!</p>\n\n<p>Simon</p>\n"},{"tags":["c#","wpf","process","redirectstandardoutput"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13293470,"title":"Is there any event to tell me a process is waiting for an input?","body":"<p>I am processing a Tex file by starting a process like this one:</p>\n\n<pre><code>process p1 = new Process();\np1.StartInfo.FileName = \"C:\\\\texlive\\\\2012\\\\bin\\\\win32\\\\pdflatex.exe\";\np1.StartInfo.Arguments = FileName;\np1.consuleProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;\np1.consuleProcess.StartInfo.CreateNoWindow = true;\np1.consuleProcess.StartInfo.RedirectStandardOutput = true;\np1.consuleProcess.StartInfo.UseShellExecute = false;\np1.consuleProcess.StartInfo.RedirectStandardInput = true;\np1.Start();\np1.consuleProcess.BeginOutputReadLine();\np1.consuleProcess.OutputDataReceived += new DataReceivedEventHandler(p1_OutputDataReceived);\n</code></pre>\n\n<p>I display the output strings in a TextBox by handling <em>OutputDataReceived</em> event. </p>\n\n<p>If there were an error in the Tex file, a line should be written in <em>StandardInput</em>. I think there is no event that can tell me, when the process is waiting for an input; So I thought, I can check <em>OutputDataReceived</em> event to see when the condition: <em>e.Data == \"?\"</em> is true. But, the problem is that the <em>StandardInput</em> needs an input, just before firing <em>OutputDataReceived</em>  event with <em>e.Data==\"?\"</em></p>\n\n<p>So, what can I do to see when the process is waiting for an input?</p>\n\n<p>thanks.</p>\n"},{"tags":["c#","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13180819,"title":"Programmatically Set APN Settings wp7","body":"<p>i started to devellop application to get setting system parameters of device automatically with windows phone 7</p>\n\n<p>my problem is how can setting APN and proxy of the device programmatically( windows API or program c#) in windows phone 7 or windows phone 8</p>\n\n<p>please if an expert in windows phone have an idea help me .</p>\n\n<p>thanks :)</p>\n"},{"tags":["c#",".net","outlook","vsto","add-in"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13293604,"title":"Outlook adds `<span style='color:blue'>` to HTML links","body":"<p>I am creating an Outlook add-in using C# that searches for a link in an HTML (new) email body signature when a user clicks on Send button in Outlook email. I am hooking into Application_ItemSend event. What's odd is that on my machine running XP/Outlook 2007 and in another Win7/Outlook 2007 machine, I am able to search for the link in the signature with no problems. But on some other Win7/Outlook 2007 machine, I am not able to search for the link because an additional span element is being inserted by Outlook.</p>\n\n<p>For example, I am searching for <code>&lt;a href=\"http://www.google.com\"&gt;</code>Link<code>&lt;/a&gt;</code> in an HTML (new) email body. The link above is being inserted by a default signature so I am expecting to find it all the time. On some machines I am able to, on some machines I am not able to because the link appears like this:\n<code>&lt;a href=\"http://www.google.com\"&gt;&lt;span style='color:blue'&gt;</code>Link<code>&lt;/span&gt;&lt;/a&gt;</code>\nI've rolled out a standard signature html file so the signatures for all machines are the same, but the issue still persists. I am still in the process of comparing the font/theme settings, but so far have seen no difference.</p>\n\n<p>Does anyone have an idea on what's happening here?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","c++"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13293073,"title":"Store a reference to an object","body":"<p>A bit of a weird question but I was wondering anyone could help...</p>\n\n<p>In C++, I could do something like this</p>\n\n<pre><code>class MyOtherClass\n{\n     private:\n         MyLogger* logger;\n     public:\n         MyOtherClass (MyLogger* logger)\n              : logger (logger)\n         {}\n};\n\nclass MyClass\n{\n     private:\n         MyLogger* logger;\n     public:\n         MyClass (MyLogger* logger)\n              : logger (logger)\n         {}\n};\n\nint main (int c, char** args)\n{\n    MyLogger* logger = new MyLogger ();\n    /* Code to set up logger */\n    MyOtherClass* myOtherClass = new MyOtherClass (logger);\n    MyClass* myClass = new MyClass (logger);\n}\n</code></pre>\n\n<p>So that each of the other objects (myOtherClass and myClass) would contain a pointer to logger, so they would be calling the same logger class. However, how would I achieve the same thing in C#? Is there a way to store a reference or pointer to a global object - I'm guessing that in C# if I do something like</p>\n\n<pre><code>public class MyClass\n{\n     private MyLogger logger = null;\n\n     public MyClass (MyLogger _logger)\n     {\n         logger = _logger;\n     }\n};\n</code></pre>\n\n<p>that its actually assigning the class variable logger to a copy of _logger? Or am I'm mixing things up :S</p>\n\n<p>Any help is very much appreciated, and thank you in advance!</p>\n"},{"tags":["c#",".net","odbc","oledb","greenplum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12776885,"title":"Connect to GreenPlum Database from .Net","body":"<p>I am trying to connect to greenplum database from a .net application. Greenplum supports odbc and oledb, but i am not sure how the connectionstring and all should be. can anybody help.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","xml","xcdatamodel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13292831,"title":"Save XML file in C# with use XCData","body":"<p>I have a string like this on C#:</p>\n\n<pre><code>string sxml=\"&lt;id&gt;xpto&lt;/id&gt;\"\n</code></pre>\n\n<p>and i wont save on xml file using XLinq:</p>\n\n<pre><code>XElement cursosXML = new XElement(\"MenuItem\", new XCData(sxml));\ncursosXML.save(\"C:\\\\xpto.xml\")\n</code></pre>\n\n<p>when i read my xml file appers: </p>\n\n<pre><code>&lt;MenuItem&gt;&lt;![CDATA[&lt;id&gt;xpto&lt;/id&gt;]]&gt;&lt;/MenuItem&gt;\n</code></pre>\n\n<p>but i do not wont <code>&lt;![CDATA[</code></p>\n\n<p>if i not use XCData appers:</p>\n\n<pre><code>&lt;MenuItem&gt;&amp;lt;xpto&amp;gt;3&amp;lt;&lt;/MenuItem&gt;\n</code></pre>\n\n<p>thanks.</p>\n"},{"tags":["c#",".net","mono","garbage-collection","interop"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13293133,"title":"Pinning Array of .NET objects","body":"<p>I would like to pin an array of .NET objects (including the objects) in order to allow a native function to do some processing on the objects. As far as I understood, GCHandle.Alloc() does not allow me to do this, because such an array contains references (and the objects might also contain references) which are not blittable.</p>\n\n<p>Is there any other option to achieve this? I would be okay with very hack-y suggestions or ones that require Mono.</p>\n"},{"tags":["c#","casting","int","double","rounding"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":82,"score":-2,"question_id":13292148,"title":"Casting a double as an int, does it round or just strip digits?","body":"<p>Doing some calculations with doubles which then need to be cast to an int. So i have a quick question, when casting a double say 7.5 to an int, it will return 7.</p>\n\n<p>Is this a product of rounding or just striping anything after the decimal point?</p>\n\n<p>If it is a product of rounding, is it smart ie 0.1 to 0.5 it rounds down and 0.6 to 0.9 it rounds up?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","sharepoint","powershell","sharepoint2010","powershell-v2.0"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13240033,"title":"C# Remote Powershell SharePoint 2010","body":"<p>I'm trying to run powershell commands on a remote sharepoint server from a c# console app.  This is the code I have so far.  It runs without errors but does nothing.  What am I doing wrong?</p>\n\n<p>Thanks</p>\n\n<p>server name, username password, and url were taken out</p>\n\n<pre><code>    public static string RunScript()\n    {\n\n       Runspace remoteRunspace = null;\n       openRunspace(\"http://server/wsman\",\n            \"http://schemas.microsoft.com/powershell/Microsoft.PowerShell\",\n            @\"domain\\user\",\n            \"password\",\n            ref remoteRunspace);\n       try\n       {\n           StringBuilder stringBuilder = new StringBuilder();\n           using (PowerShell powershell = PowerShell.Create())\n           {\n\n               powershell.Runspace = remoteRunspace;\n               powershell.AddScript(\"Add-PsSnapin Microsoft.SharePoint.PowerShell\");\n               powershell.AddScript(\"enable-SPFeature -identity \\\"2dfc204b-e9da-4c6c-8b4f-c2f7c593ad4e\\\" -url sharepointsite -Confirm:$False\");\n               powershell.Invoke();\n               Collection&lt;PSObject&gt; results = powershell.Invoke();\n               remoteRunspace.Close();\n               foreach (PSObject obj in results)\n               {\n                   stringBuilder.AppendLine(obj.ToString());\n               }\n           }\n\n           return stringBuilder.ToString();\n       }\n       catch (Exception e)\n       {\n\n           return \"\";\n\n       }\n\n\n     }\n\n    public static void  openRunspace(string uri, string schema, string username, string livePass, ref Runspace remoteRunspace)\n    {\n        System.Security.SecureString password = new System.Security.SecureString();\n        foreach (char c in livePass.ToCharArray())\n        {\n            password.AppendChar(c);\n        }\n        PSCredential psc = new PSCredential(username, password);\n        WSManConnectionInfo rri = new WSManConnectionInfo(new Uri(uri), schema, psc);\n        rri.AuthenticationMechanism = AuthenticationMechanism.Kerberos;\n        rri.ProxyAuthentication = AuthenticationMechanism.Negotiate;\n        remoteRunspace = RunspaceFactory.CreateRunspace(rri);\n        remoteRunspace.Open();\n    }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12531510,"title":"WM_MOUSEWHEEL message does not propagate to parent","body":"<p>I have a RichTextBox with ScrollBars set to None.  According to <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms645617%28v=vs.85%29.aspx\" rel=\"nofollow\">MSDN</a></p>\n\n<blockquote>\n  <p>The DefWindowProc function propagates the message to the window's\n  parent. There should be no internal forwarding of the message, since\n  DefWindowProc propagates it up the parent chain until it finds a\n  window that processes it.</p>\n</blockquote>\n\n<p>I interpret this as, I should not need to hook into the message pump (<a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.imessagefilter.aspx\" rel=\"nofollow\">IMessageFilter</a>) and manually forward WM_MOUSEWHEEL events to the parent Form containing the richtextbox.  When I am inside of RichTextBox and perform a mouse scroll, the Form does not scroll.  Why not?  How can I get the Form to scroll?</p>\n\n<p>Keep in mind that scrollbars are set to none for RichTextBox and enabled for the Form.  So why isn't the form getting the scroll event?</p>\n\n<pre><code>public partial class Form4 : Form\n{\n    public Form4()\n    {\n        InitializeComponent();\n        this.AutoScroll = true;\n        richTextBox1.ScrollBars = RichTextBoxScrollBars.None;\n    }\n}\n</code></pre>\n"},{"tags":["c#","winforms","combobox","lost-focus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13291945,"title":"Winforms combobox loses autocomplete value on lostfocus","body":"<p>I am having issues with the Winforms combo box losing the value found during an autocompletion when the user tabs to the next control.</p>\n\n<p>Here is a code sample (as an Nunit Test that will pop up a form):</p>\n\n<pre><code>[Test]\n[STAThread]\npublic void Testing_AsDropDownList()\n{\n    var comboBox = new ComboBox();\n    comboBox.DropDownStyle = ComboBoxStyle.DropDownList;\n    comboBox.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.ListItems;\n    comboBox.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.SuggestAppend;\n    comboBox.Items.Add(new ComboPair(\"aaa\", \"ItemAAA\"));\n    comboBox.Items.Add(new ComboPair(\"bbb1\", \"ItemBBB1\"));\n    comboBox.Items.Add(new ComboPair(\"bbb2\", \"ItemBBB2\"));\n    comboBox.Items.Add(new ComboPair(\"bbb3\", \"ItemBBB3\"));\n    comboBox.Items.Add(new ComboPair(\"ccc\", \"ItemCCC\"));\n    var textBox = new TextBox{ Multiline = true };        \n    comboBox.Leave += (sender, args) =&gt; textBox.Text = \"On Leave: \" + comboBox.SelectedItem;\n    comboBox.LostFocus += (sender, args) =&gt; textBox.Text += \" ... On LostFocus: \" + comboBox.SelectedItem;\n    var frm = new Form();\n    frm.Width = 300;\n    frm.Height = 100;\n    comboBox.Dock = System.Windows.Forms.DockStyle.Top;\n    textBox.Dock = System.Windows.Forms.DockStyle.Bottom;\n    frm.Controls.Add(comboBox);\n    frm.Controls.Add(textBox);\n    Application.EnableVisualStyles();\n    Application.Run(frm);\n}\n</code></pre>\n\n<p>In order to reproduce the bug, do the following steps:</p>\n\n<ol>\n<li>Run the test\nThe form will pop up with the combo box focused...</li>\n<li>Now type 'bbb3' to select the corresponding item with the autocompletion.\nYou will now see that the text box has been updated with 'bbb3' as your selected item.</li>\n<li>Now press TAB</li>\n</ol>\n\n<p>You will now see that the text box has the focus and the combo selection has changed to 'bbb1'.\nAlso note that in the the text box it shows you that the selected value was still 'bbb3' when the leave event was fired, but then it was 'bbb1' when the lost focus event fired.</p>\n\n<p>This same behaviour is seen if you click away from the combo box to make it loose focus for step 3.</p>\n\n<p>If you do anything else at step 3 it won't have this problem. i.e. if you:</p>\n\n<ul>\n<li>press 'enter'</li>\n<li>press 'up' then 'down' to get back to \"bbb3\"</li>\n<li>click the item</li>\n<li>etc.</li>\n</ul>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","internet-explorer-9","watin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13292751,"title":"MSIE 9: Replace the yellow download bar at the bottom by the normal popup","body":"<p>Is there some setting in MSIE, in the registry or some plugin/add-on that will let me get rid of the yellow download bar that pops up at the bottom of the window when I try to download something (with alternatives open, save, cancel and save-as), and instead have the MSIE-8 style popup dialog?</p>\n\n<p>This yellow bar makes it difficult to test a site using Watin. And actually I am currently not able to test downloading at all because of this yellow bar. In MSIE 8 it worked as expected since there was the normal popup dialog window.</p>\n\n<p>What is the solution?</p>\n"},{"tags":["c#",".net","xml","xml-parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13290108,"title":"XElement Iteration and adding it to parent","body":"<p>hi I have the following question ...please do help as I am very new to programming in C# with no previous  programming experience...</p>\n\n<p>In my code I am suppose to Iterate through XElement in a Xml file add that Xelement to a parent known as Capability....This is my code...</p>\n\n<pre><code>if (xElem.HasElements)\n        {\n\n            foreach (XElement xChild in xElem.Element(\"Elements\"))\n            {\n                Capability capChild = Parse(xChild);\n                capParent.Children.Add(capChild);\n            }\n        }\n</code></pre>\n\n<p>here the foreach loop gives an error</p>\n\n<p>\"Error  32  foreach statement cannot operate on variables of type 'System.Xml.Linq.XElement' because 'System.Xml.Linq.XElement' does not contain a public definition for 'GetEnumerator'........\"</p>\n\n<p>how can I carry out the functionality of finding if XElement has any child and adding it to the parent Capability...?  </p>\n"},{"tags":["c#",".net","winforms","parent-child","messages"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2580,"score":1,"question_id":2024506,"title":"How to pass messages from a child user-control to the parent","body":"<p>This is a Windows Forms / .Net C# question.</p>\n\n<p>I have a borderless windows whose transparency key and background color make it completely transparent.  Inside the window are a couple of user controls.</p>\n\n<p>I want to be able to move the window.  I know how to do this on the parent window, but my problem is that the child controls are the only thing visible and thus the only thing click-able.</p>\n\n<p>The question is: how can I pass certain messages up to the Parent so the Parent can move when the right mouse button is down and the mouse is moving on any one of the child controls?</p>\n\n<p>Or maybe you can suggest another way?</p>\n\n<p>Thanks for the help.</p>\n\n<p>Mark</p>\n"},{"tags":["c#","android"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13293277,"title":"How to save/retrieve data with android device sd-card, via USB Debugging mode?","body":"<p>Is there a way to save/retrieve files from an android device, via the USB debugging mode.\nThat means I want my application to get connected even if the Device is charging via the USB cable connected to the PC.</p>\n\n<p>I think the ADB (Android Debug Bridge) is capable of rendering this service, however I am not quite sure if it works, If it does how can I use it with C# to simply save and get some files from the SD-Card</p>\n"},{"tags":["c#",".net","webcam"],"answer_count":2,"favorite_count":10,"up_vote_count":11,"down_vote_count":0,"view_count":11399,"score":11,"question_id":236249,"title":"Simple .NET webcam library","body":"<p>Is there a simple library for .NET that has a simply API that let's you do something like;</p>\n\n<pre><code>// pseudo-code\nList&lt;Webcam&gt; cams = Webcam.GetAll();\nImage i = cams[0].GrabImage();\n</code></pre>\n\n<p>I've looked at DirectShow and WIA, both seem to be much more complicated than this. I've also looked at <a href=\"http://www.codeproject.com/KB/directx/directshownet.aspx\" rel=\"nofollow\">this CodeProject project</a>, but it really is much more complicated than what I need.</p>\n\n<p>The library should support image grabbing and video grabbing, and preferably live streaming of video.</p>\n\n<p>Edit: It is preferable if it is free (or at least very cheap), as this is a hobby project.</p>\n"},{"tags":["c#",".net","webcam"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":678,"score":0,"question_id":4678308,"title":"Is there an easy way to access the webcam from C#?","body":"<p>How can I access the webcam easily with VS2010 and C#?</p>\n\n<p>I tried to copy the avicap21.dll, but VS2010 can't import the library.</p>\n"},{"tags":["c#","visual-studio","plugins","code-snippets"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":239,"score":2,"question_id":3223134,"title":"Code snippet plugin","body":"<p>Are there any good code snippet plugins for visual studio? I want a plugin which can use a online snippet site (such as <a href=\"http://snipplr.com/\" rel=\"nofollow\">snipplr</a>). It should be easy to both find and upload snippets.</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13292959,"title":"newsletter mass send emails","body":"<p>Having a little trouble with my Newsletter...</p>\n\n<p>Let me explain:\nI have a sql table with my emails and nothing else and a sql table where i store the mails after they have been sendt, somehow the mails wont sent, but it will save the mails.</p>\n\n<p>it is all set up in a formview.</p>\n\n<pre><code>protected void btnSendNewsLetter_Click(object sender, EventArgs e)\n    {\n        TextBox subject = (TextBox)fvNewsletter.Row.FindControl(\"txtSubject\");\n        TextBox body = (TextBox)fvNewsletter.Row.FindControl(\"txtBody\");\n\n        string connection = WebConfigurationManager.ConnectionStrings[\"GreenCollaborationConnectionString\"].ConnectionString;\n\n        SqlConnection con = new SqlConnection(connection);\n\n        con.Open();\n\n        SqlCommand comm = new SqlCommand(\"Select Email from MailingList\", con);\n        SqlDataAdapter da1 = new SqlDataAdapter(comm);\n        GreenDataSet ds1 = new GreenDataSet();\n        da1.Fill(ds1);\n        if(ds1.Tables[0].Rows.Count &gt; 0)\n        {\n            for (int i = 0; i &lt;= ds1.Tables[0].Rows.Count - 1; i++)\n            {\n                string email = ds1.Tables[0].Rows[i].ItemArray[0].ToString();\n                System.Net.Mail.MailMessage mail = new System.Net.Mail.MailMessage();\n                mail.From = new MailAddress(\"noreply@GreenCollaboration.com\", \"GreenCollaboration\");\n                mail.To.Add(email);\n                mail.Subject = subject.Text;\n                mail.SubjectEncoding = System.Text.Encoding.UTF8;\n                mail.BodyEncoding = System.Text.Encoding.UTF8;\n                mail.IsBodyHtml = true;\n                mail.Body = body.Text;\n            }\n        }\n    }\n</code></pre>\n\n<p>i hope some1 can help me :)</p>\n"},{"tags":["c#",".net","webcam","directshow","video-capture"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":642,"score":2,"question_id":5660580,"title":"Is there a commercial/open source C# wrapper component for using a webcam in Windows?","body":"<p>I need to rapidly develop some software that uses a camera as an AV input.</p>\n\n<p>Assuming the drivers are installed for whatever the device that is giving the input I need to be able to capture images and to stream the camera in the winforms window. </p>\n\n<p>I couldn't find a component that I can use, maybe because I don't know the right name for it.</p>\n\n<p>Touchless is under a licence I can't use. If anyone knows of a good compoment/code I can use even if it's for a fee I will appreciate this.</p>\n"},{"tags":["c#","java","design"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":81,"score":4,"question_id":13292037,"title":"Designing an abstract base class. What types to use, abstract or concrete?","body":"<p>I am just jumping into C# from Java on the recommendation of my uncle. The Java geometry lib seems more complete than C#'s Drawing lib, so I am working on a simple bit of porting with a small bit of added functionality to begin into C#.</p>\n\n<p>However, I have run into a design issue and cannot discern which would be the better choice. To have multiple methods in the abstract base class that take concrete datatypes OR to have less methods that take the abstract base as its argument?</p>\n\n<pre><code>public abstract bool isOverlapping(GeometricObject2D o) {}\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>public abstract bool isOverlapping(Rectangle2D rect) {}\npublic abstract bool isOverlapping(Circle2D circ) {}\netc...\n</code></pre>\n\n<p>The argument I am having in my head tells me concrete arguments prevent logic errors, BUT, I have been taught to always use abstract datatypes if the use fits. </p>\n"},{"tags":["c#",".net","camera","webcam","image-capture"],"answer_count":6,"favorite_count":20,"up_vote_count":21,"down_vote_count":0,"view_count":23177,"score":21,"question_id":113426,"title":"How do I connect to a USB webcam in .NET?","body":"<p>I want to connect to a USB Webcam in .NET, specifically using C#. Being new to .NET I don't know what kind of support there is in the standard libraries for doing so. I found one example on the web that copies bitmaps through the clipboard, but that seems very hacky (and probably slow). Is there a better way?</p>\n"},{"tags":["c#","anonymous-types"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":39,"score":-4,"question_id":13285243,"title":"How to Return the Anonymous data type object from a method in c#","body":"<p>..................................</p>\n"},{"tags":["c#",".net","winapi","directshow"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":1144,"score":1,"question_id":7887910,"title":"take picture from webcam c#","body":"<p>I'm streaming video to my Window Form with DirectShowLib. I also want to save image when i press button \"Save\" for example. How to get picture from webcam with DirectShowLib methods or with WIN32 API methods? </p>\n"},{"tags":["c#","asp.net-mvc","jquery-ajax","asp.net-mvc-2","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13292065,"title":"When returning a partial view that's AJAXed in how do I instead show an error message","body":"<p>I've got some jquery that'll run ajax that runs a controller action that returns a partial view. In some cases i want to display one of several error messages (controlled by the controller), rather than replacing a DOM element with the result.</p>\n\n<p>How do I achieve this?</p>\n\n<p>Currently I have this:</p>\n\n<pre><code>$.ajax({\n    type: \"POST\",\n    cache: false,\n    url: '&lt;%= Url.Action(\"AddPostcodeToTerritory\", \"Territories\") %&gt;'\n}).done(function(data) {\n    $(\"#SelectedTerritoryPostcodeRows\").html(data);\n});\n</code></pre>\n\n<p>I have the element <code>SelectedTerritoryPostcodeRows</code> which normally gets the information, but I also want the controller to be able to give some error message which I want to display somewhere else.</p>\n"},{"tags":["c#","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13292722,"title":"Trouble adding OPTION to T-SQL Query syntax","body":"<p>for some reason I just can't get the syntax right on this for adding the OPTION</p>\n\n<pre><code>   Database db = DatabaseFactory.CreateDatabase(Config.DbConnectionString);\n\n    using (DbCommand cmd = db.GetSqlStringCommand(string.Format(@\"  SELECT  t.customerID,\n                                                                            t.Photo\n                                                                    FROM SomeTable t\n                                                                    WHERE t.PhotoID = (SELECT MAX(PhotoID) FROM SomeTable WHERE customerID = @{0} OPTION (OPTIMIZE FOR UNKNOWN)\n                                                                    GROUP BY CustomerID ) \", \"customerID\")))\n    {\n        try\n        {\n            db.AddInParameter(cmd, \"@customerID\", DbType.String, customerID);\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13293185,"title":"How to load navigation data in Entity framework Code first?","body":"<p>I have the following situation:</p>\n\n<p><a href=\"http://www.mediafire.com/view/?brjyqlj4rvjako9\" rel=\"nofollow\">http://www.mediafire.com/view/?brjyqlj4rvjako9</a></p>\n\n<p>When you read the picture in your browser you can see I have a three tables. The middle one is junction table.</p>\n\n<p>All works well except the field Room in middle table (Bookings table) that always has a NULL value:\n<a href=\"http://www.mediafire.com/view/?axz7ljskgcpl8cp\" rel=\"nofollow\">http://www.mediafire.com/view/?axz7ljskgcpl8cp</a></p>\n\n<p>So, I saw that it needs to be loaded by hand before I make a reading operation on it.\nHow is this done in Entity Framework Code First as my project is running on it?</p>\n\n<p>The relationship is many to many between guest and Room, Booking is a junction table.\nThank you</p>\n"},{"tags":["c#","asp.net","quickbooks"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13281979,"title":"\"remote server returned an error: (400) Bad Request.\" when I am adding new Customer to Quickbooks..","body":"<p>I got The \"remote server returned an error: (400) Bad Request.\" when I am adding new Customer to Quickbooks.. following code doesn't work.. why?</p>\n\n<pre><code>string Results = string.Empty;\n        string requestUrl = null;\n        requestUrl = \"https://apps.quickbooks.com/j/AppGateway\";\n\n\n        HttpWebRequest WebRequestObject = null;\n        StreamReader sr = null;\n        HttpWebResponse WebResponseObject = null;\n        StreamWriter stwr = null;\n\n\n        try\n        {\n            WebRequestObject = (HttpWebRequest)WebRequest.Create(requestUrl);\n            WebRequestObject.Method = \"POST\";\n            WebRequestObject.ContentType = \"application/x-qbxml\";\n            WebRequestObject.AllowAutoRedirect = false;\n            string post = @\"&lt;?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?&gt;\n&lt;?qbxml version=\"\"6.0\"\"?&gt;\n&lt;QBXML&gt;\n&lt;SignonMsgsRq&gt;\n&lt;SignonDesktopRq&gt;\n&lt;ClientDateTime&gt;%%CLIENT_DATE_TIME%%&lt;/ClientDateTime&gt;\n&lt;ApplicationLogin&gt;mydvqbapp.www.ipx2.com&lt;/ApplicationLogin&gt;\n&lt;ConnectionTicket&gt;TGT-142-6jCkNfIvWB$7Aw_ppW14jA&lt;/ConnectionTicket&gt;\n&lt;Language&gt;English&lt;/Language&gt;\n&lt;AppID&gt;APP_ID&lt;/AppID&gt;\n&lt;AppVer&gt;1&lt;/AppVer&gt;\n&lt;/SignonDesktopRq&gt;\n&lt;/SignonMsgsRq&gt;\n&lt;QBXMLMsgsRq onError=\"\"stopOnError\"\"&gt;\n&lt;CustomerAddRq&gt;\n&lt;CustomerAdd&gt; &lt;!-- required --&gt;\n&lt;Name &gt;Sample Name&lt;/Name&gt; &lt;!-- required --&gt;\n&lt;IsActive &gt;True&lt;/IsActive&gt; &lt;!-- optional --&gt;\n&lt;ClassRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/ClassRef&gt;\n&lt;ParentRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/ParentRef&gt;\n&lt;CompanyName &gt;Sample CompanyName&lt;/CompanyName&gt; &lt;!-- optional --&gt;\n&lt;Salutation &gt;Mr&lt;/Salutation&gt; &lt;!-- optional --&gt;\n&lt;FirstName &gt;Sam Firstname&lt;/FirstName&gt; &lt;!-- optional --&gt;\n&lt;MiddleName &gt;&lt;/MiddleName&gt; &lt;!-- optional --&gt;\n&lt;LastName &gt;Sam LastName&lt;/LastName&gt; &lt;!-- optional --&gt;\n&lt;JobTitle &gt;&lt;/JobTitle&gt; &lt;!-- optional --&gt;\n&lt;BillAddress&gt; &lt;!-- optional --&gt;\n&lt;Addr1 &gt;Sam Add1&lt;/Addr1&gt; &lt;!-- optional --&gt;\n&lt;Addr2 &gt;Sam Add2&lt;/Addr2&gt; &lt;!-- optional --&gt;\n&lt;Addr3 &gt;&lt;/Addr3&gt; &lt;!-- optional --&gt;\n&lt;Addr4 &gt;&lt;/Addr4&gt; &lt;!-- optional --&gt;\n&lt;Addr5 &gt;&lt;/Addr5&gt; &lt;!-- optional --&gt;\n&lt;City &gt;&lt;/City&gt; &lt;!-- optional --&gt;\n&lt;State &gt;&lt;/State&gt; &lt;!-- optional --&gt;\n&lt;PostalCode &gt;&lt;/PostalCode&gt; &lt;!-- optional --&gt;\n&lt;Country &gt;&lt;/Country&gt; &lt;!-- optional --&gt;\n&lt;Note &gt;&lt;/Note&gt; &lt;!-- optional --&gt;\n&lt;/BillAddress&gt;\n&lt;ShipAddress&gt; &lt;!-- optional --&gt;\n&lt;Addr1 &gt;&lt;/Addr1&gt; &lt;!-- optional --&gt;\n&lt;Addr2 &gt;&lt;/Addr2&gt; &lt;!-- optional --&gt;\n&lt;Addr3 &gt;&lt;/Addr3&gt; &lt;!-- optional --&gt;\n&lt;Addr4 &gt;&lt;/Addr4&gt; &lt;!-- optional --&gt;\n&lt;Addr5 &gt;&lt;/Addr5&gt; &lt;!-- optional --&gt;\n&lt;City &gt;&lt;/City&gt; &lt;!-- optional --&gt;\n&lt;State &gt;&lt;/State&gt; &lt;!-- optional --&gt;\n&lt;PostalCode &gt;&lt;/PostalCode&gt; &lt;!-- optional --&gt;\n&lt;Country &gt;&lt;/Country&gt; &lt;!-- optional --&gt;\n&lt;Note &gt;&lt;/Note&gt; &lt;!-- optional --&gt;\n&lt;/ShipAddress&gt;\n&lt;ShipToAddress&gt; &lt;!-- must occur 0 - 50 times --&gt;\n&lt;Name &gt;Test&lt;/Name&gt; &lt;!-- required --&gt;\n&lt;Addr1 &gt;&lt;/Addr1&gt; &lt;!-- optional --&gt;\n&lt;Addr2 &gt;&lt;/Addr2&gt; &lt;!-- optional --&gt;\n&lt;Addr3 &gt;&lt;/Addr3&gt; &lt;!-- optional --&gt;\n&lt;Addr4 &gt;&lt;/Addr4&gt; &lt;!-- optional --&gt;\n&lt;Addr5 &gt;&lt;/Addr5&gt; &lt;!-- optional --&gt;\n&lt;City &gt;&lt;/City&gt; &lt;!-- optional --&gt;\n&lt;State &gt;&lt;/State&gt; &lt;!-- optional --&gt;\n&lt;PostalCode &gt;&lt;/PostalCode&gt; &lt;!-- optional --&gt;\n&lt;Country &gt;&lt;/Country&gt; &lt;!-- optional --&gt;\n&lt;Note &gt;&lt;/Note&gt; &lt;!-- optional --&gt;\n&lt;DefaultShipTo &gt;&lt;/DefaultShipTo&gt; &lt;!-- optional --&gt;\n&lt;/ShipToAddress&gt;\n&lt;Phone &gt;&lt;/Phone&gt; &lt;!-- optional --&gt;\n&lt;AltPhone &gt;&lt;/AltPhone&gt; &lt;!-- optional --&gt;\n&lt;Fax &gt;&lt;/Fax&gt; &lt;!-- optional --&gt;\n&lt;Email &gt;&lt;/Email&gt; &lt;!-- optional --&gt;\n&lt;Cc &gt;&lt;/Cc&gt; &lt;!-- optional --&gt;\n&lt;Contact &gt;&lt;/Contact&gt; &lt;!-- optional --&gt;\n&lt;AltContact &gt;&lt;/AltContact&gt; &lt;!-- optional --&gt;\n&lt;AdditionalContactRef&gt; &lt;!-- must occur 0 - 8 times --&gt;\n&lt;ContactName &gt;&lt;/ContactName&gt; &lt;!-- required --&gt;\n&lt;ContactValue &gt;&lt;/ContactValue&gt; &lt;!-- required --&gt;\n&lt;/AdditionalContactRef&gt;\n&lt;Contacts&gt; &lt;!-- optional, may repeat --&gt;\n&lt;Salutation &gt;&lt;/Salutation&gt; &lt;!-- optional --&gt;\n&lt;FirstName &gt;&lt;/FirstName&gt; &lt;!-- required --&gt;\n&lt;MiddleName &gt;&lt;/MiddleName&gt; &lt;!-- optional --&gt;\n&lt;LastName &gt;&lt;/LastName&gt; &lt;!-- optional --&gt;\n&lt;JobTitle &gt;&lt;/JobTitle&gt; &lt;!-- optional --&gt;\n&lt;AdditionalContactRef&gt; &lt;!-- must occur 0 - 5 times --&gt;\n&lt;ContactName &gt;&lt;/ContactName&gt; &lt;!-- required --&gt;\n&lt;ContactValue &gt;&lt;/ContactValue&gt; &lt;!-- required --&gt;\n&lt;/AdditionalContactRef&gt;\n&lt;/Contacts&gt;\n&lt;CustomerTypeRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/CustomerTypeRef&gt;\n&lt;TermsRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/TermsRef&gt;\n&lt;SalesRepRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/SalesRepRef&gt;\n&lt;OpenBalance &gt;&lt;/OpenBalance&gt; &lt;!-- optional --&gt;\n&lt;OpenBalanceDate &gt;&lt;/OpenBalanceDate&gt; &lt;!-- optional --&gt;\n&lt;SalesTaxCodeRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/SalesTaxCodeRef&gt;\n&lt;ItemSalesTaxRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/ItemSalesTaxRef&gt;\n&lt;ResaleNumber &gt;&lt;/ResaleNumber&gt; &lt;!-- optional --&gt;\n&lt;AccountNumber &gt;&lt;/AccountNumber&gt; &lt;!-- optional --&gt;\n&lt;CreditLimit &gt;&lt;/CreditLimit&gt; &lt;!-- optional --&gt;\n&lt;PreferredPaymentMethodRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/PreferredPaymentMethodRef&gt;\n&lt;CreditCardInfo&gt; &lt;!-- optional --&gt;\n&lt;CreditCardNumber &gt;&lt;/CreditCardNumber&gt; &lt;!-- optional --&gt;\n&lt;ExpirationMonth &gt;&lt;/ExpirationMonth&gt; &lt;!-- optional --&gt;\n&lt;ExpirationYear &gt;&lt;/ExpirationYear&gt; &lt;!-- optional --&gt;\n&lt;NameOnCard &gt;&lt;/NameOnCard&gt; &lt;!-- optional --&gt;\n&lt;CreditCardAddress &gt;&lt;/CreditCardAddress&gt; &lt;!-- optional --&gt;\n&lt;CreditCardPostalCode &gt;&lt;/CreditCardPostalCode&gt; &lt;!-- optional --&gt;\n&lt;/CreditCardInfo&gt;\n&lt;!-- JobStatus may have one of the following values: Awarded, Closed, InProgress, None [DEFAULT], NotAwarded, Pending --&gt;\n&lt;JobStatus &gt;&lt;/JobStatus&gt; &lt;!-- optional --&gt;\n&lt;JobStartDate &gt;&lt;/JobStartDate&gt; &lt;!-- optional --&gt;\n&lt;JobProjectedEndDate &gt;&lt;/JobProjectedEndDate&gt; &lt;!-- optional --&gt;\n&lt;JobEndDate &gt;&lt;/JobEndDate&gt; &lt;!-- optional --&gt;\n&lt;JobDesc &gt;&lt;/JobDesc&gt; &lt;!-- optional --&gt;\n&lt;JobTypeRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/JobTypeRef&gt;\n&lt;Notes &gt;&lt;/Notes&gt; &lt;!-- optional --&gt;\n&lt;AdditionalNotes&gt; &lt;!-- optional, may repeat --&gt;\n&lt;Note &gt;&lt;/Note&gt; &lt;!-- required --&gt;\n&lt;/AdditionalNotes&gt;\n&lt;!-- PreferredDeliveryMethod may have one of the following values: None [Default], Email, Fax --&gt;\n&lt;PreferredDeliveryMethod &gt;ENUMTYPE&lt;/PreferredDeliveryMethod&gt; &lt;!-- optional --&gt;\n&lt;PriceLevelRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/PriceLevelRef&gt;\n&lt;ExternalGUID &gt;&lt;/ExternalGUID&gt; &lt;!-- optional --&gt;\n&lt;CurrencyRef&gt; &lt;!-- optional --&gt;\n&lt;ListID &gt;&lt;/ListID&gt; &lt;!-- optional --&gt;\n&lt;FullName &gt;&lt;/FullName&gt; &lt;!-- optional --&gt;\n&lt;/CurrencyRef&gt;\n&lt;/CustomerAdd&gt;\n&lt;IncludeRetElement &gt;&lt;/IncludeRetElement&gt; &lt;!-- optional, may repeat --&gt;\n&lt;/CustomerAddRq&gt;\n&lt;/QBXMLMsgsRq&gt;\n&lt;/QBXML&gt;\";\n            post = post.Replace(\"%%CLIENT_DATE_TIME%%\", DateTime.Now.ToString(\"yyyy-MM-ddTHH:mm:ss\"));\n\n            XmlDocument xmlDoc = new XmlDocument();\n            xmlDoc.LoadXml(post);\n            post = xmlDoc.InnerXml;\n            WebRequestObject.ContentLength = post.Length;\n            stwr = new StreamWriter(WebRequestObject.GetRequestStream());\n            stwr.Write(post);\n\n            stwr.Close();\n            WebResponseObject = (HttpWebResponse)WebRequestObject.GetResponse();\n            sr = new StreamReader(WebResponseObject.GetResponseStream());\n            Results = sr.ReadToEnd();\n        }\n        finally\n        {\n            try\n            {\n                lblMethod.Text = Results;\n                sr.Close();\n\n            }\n            catch(Exception ex)\n            {\n                lblMethod.Text = \"Error:&lt;br/&gt;\" + ex.Message;\n            }\n\n\n            try\n            {\n                WebResponseObject.Close();\n                WebRequestObject.Abort();\n                lblMethod.Text = lblMethod.Text + \"Sucessfully Connected\";\n            }\n            catch (Exception ex)\n            {\n                lblMethod.Text = \"Error:&lt;br/&gt;\" + ex.Message;\n            }\n        }\n    }\n</code></pre>\n\n<p>In above coding,\nI got a error location,\n\" WebResponseObject = (HttpWebResponse)WebRequestObject.GetResponse();\"</p>\n"},{"tags":["c#",".net","entity-framework-4","domain-driven-design","ddd-repositories"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13282610,"title":"Adding items to a collection using Entity Framework","body":"<p>I'm trying to follow the DDD Repository pattern with Entity Framework 4. But I'm having problems saving changes to collection properties of my aggregate roots. Consider my classes below. Item is my aggregate root which contains a collection of SubItem entities.</p>\n\n<pre><code>public class Item\n{\n    public int ItemId { get; set; }\n    public string Name { get; set; }\n    public ICollection&lt;SubItem&gt; SubItems { get; private set; }\n\n    public Item()\n    {\n        this.SubItems = new HashSet&lt;SubItem&gt;();\n    }\n}\n\npublic class SubItem\n{\n    public int ItemId { get; set; }\n    public int SubItemId { get; set; }\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p>Next I defined a repository interface for my aggregate root class</p>\n\n<pre><code>public interface IItemRespository\n{\n    Item Get(int id);\n    void Add(Item i);\n    void Save(Item i);\n}\n</code></pre>\n\n<p>Now here is my DbContext class that sets up the EF mapping.</p>\n\n<pre><code>public class ItemContext : System.Data.Entity.DbContext\n{\n    protected override void OnModelCreating(System.Data.Entity.DbModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;Item&gt;().HasKey(i =&gt; i.ItemId);\n        modelBuilder.Entity&lt;Item&gt;().Property(i =&gt; i.Name);\n\n        modelBuilder.Entity&lt;Item&gt;().HasMany(i =&gt; i.SubItems)\n            .WithRequired()\n            .HasForeignKey(si =&gt; si.ItemId);\n\n        modelBuilder.Entity&lt;SubItem&gt;().HasKey(i =&gt; i.SubItemId);\n        modelBuilder.Entity&lt;SubItem&gt;().Property(i =&gt; i.Name);\n    }\n}\n</code></pre>\n\n<p>Finally here's my implementation of IRepository using the DBContext</p>\n\n<pre><code>public class Repository : IItemRespository\n{\n    public void Save(Item i)\n    {\n        using (var context = new ItemContext())\n        {\n            context.Set&lt;Item&gt;().Attach(i);\n            context.SaveChanges();\n        }\n    }\n\n    public Item Get(int id)\n    {\n        using (var context = new ItemContext())\n        {\n            var result = (from x in context.Set&lt;Item&gt;() where x.ItemId == id select x).FirstOrDefault();\n            return result;\n        }\n    }\n\n    public void Add(Item i)\n    {\n        using (var context = new ItemContext())\n        {\n            context.Set&lt;Item&gt;().Add(i);\n            context.SaveChanges();\n        }\n    }\n}\n</code></pre>\n\n<p>The following code creates a new Item, adds it to the repository, adds some new SubItems, and then saves the changes.</p>\n\n<pre><code>IItemRespository repo = new Repository();\n\n//Create a new Item\nItem parent = new Item() { Name = \"Parent\" };\nrepo.Add(parent);\n\n//A long period of time may pass .. . .\n\n//later add sub items\nparent.SubItems.Add(new SubItem() { Name = \"Child 1\" });\nparent.SubItems.Add(new SubItem() { Name = \"Child 2\" });   \nparent.SubItems.Add(new SubItem() { Name = \"Child 3\" });\n\n//save the added sub items\nrepo.Save(parent);\n</code></pre>\n\n<p>I get the following exception when the Save() method tries to attach the item to the context.</p>\n\n<blockquote>\n  <p>A referential integrity constraint violation occurred: The property\n  values that define the referential constraints are not consistent\n  between principal and dependent objects in the relationship.</p>\n</blockquote>\n\n<p>I realized I'm creating a new context for each method in the repository. This is intentional. A long period of time may pass between when an Item is added and then later edited, and I don't want to keep the context or database connection open for the entire time.</p>\n\n<p>Now if I attach the newItem to the second context before adding the sub items as in the code below it works. </p>\n\n<pre><code>//Create a new item\nItem newItem = new Item() { Name = \"Parent\" };\n\nusing (ItemContext context1 = new ItemContext())\n{\n    //Create a new aggrgate\n    context1.Set&lt;Item&gt;().Add(newItem);\n    context1.SaveChanges();\n}\n\n//Long period of time may pass\n\nusing (ItemContext context2 = new ItemContext())\n{\n    context2.Set&lt;Item&gt;().Attach(newItem);\n\n    newItem.Name = \"Edited Name\";\n    newItem.SubItems.Add(new SubItem() { Name = \"Child 1\" });\n    newItem.SubItems.Add(new SubItem() { Name = \"Child 2\" });\n    newItem.SubItems.Add(new SubItem() { Name = \"Child 3\" });\n\n    context2.SaveChanges();\n}\n</code></pre>\n\n<p>However, if I want to be true to the repository pattern the code that edits Item shouldn't know anything about how the repository works or the ItemContext class. It should simply be able to make changes to an aggregate root entity, and then save those changes through a repository Save() method.</p>\n\n<p>So how do I modify my Save() method so that changes to Item.SubItems are saved correctly?</p>\n"},{"tags":["c#",".net","webcam"],"answer_count":3,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":1323,"score":10,"question_id":5885573,"title":"Getting input from webcam","body":"<p>Does .NET have a native support for getting input from webcam?<br/>\nIf not, what is the best/recommended way to get input from webcam using C#/.NET?</p>\n"}]}
{"total":375446,"page":4,"pagesize":100,"questions":[{"tags":["c#","android","asp.net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13279594,"title":"GridView Textbox with forced keypad","body":"<p>I have a GridView that has a column named <code>Run Time</code> and it uses TextBoxes <code>rTime</code>.  I'm going to be bewing this GridView on an andriod operating system and want it to pull a  keypad if someone clicks on the textbox.  This has worked before without the GridView, but I've been getting a <code>The name 'rTime' does not exist in the current context</code> error. Here is my aspx code: `\n    </p>\n\n<pre><code>   &lt;asp:TemplateField HeaderText=\"labelID\" Visible=\"false\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"ID\" runat=\"server\" Text='&lt;%# Eval(\"Id\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n\n    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labelfirstname\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"fName\") %&gt;' /&gt;\n\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n     &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labellastname\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"lName\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n     &lt;asp:TemplateField HeaderText=\"Run Time Needed\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;asp:Label ID=\"labelrTimeN\" Visible=\"true\" runat=\"server\" Text='&lt;%# Eval(\"rTimeN\") %&gt;' /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n    &lt;asp:TemplateField HeaderText=\"Run Time\"&gt;\n        &lt;ItemTemplate&gt;\n            &lt;div style=\"display:none\"&gt;&lt;asp:TextBox ID=\"rTime\" runat=\"server\" Height=\"16px\" \n        ontextchanged=\"TextBox1_TextChanged\" Width=\"108px\"&gt;&lt;/asp:TextBox&gt;&lt;/div&gt;\n    &lt;span class=\"style4\"&gt;&lt;strong&gt;Meter Run:&lt;/strong&gt;&lt;/span&gt;&lt;span class=\"style5\"&gt;&amp;nbsp;&lt;/span&gt;&lt;input onblur=\"document.getElementById('&lt;%=rTime.ClientID %&gt;').value = this.value\" \n    type=\"tel\" style=\"width: 100px; height: 31px;\" /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:TemplateField&gt;\n\n\n&lt;/Columns&gt;\n&lt;/asp:GridView&gt;`\n</code></pre>\n\n<p>Here is c#:</p>\n\n<pre><code>private bool isEditMode = false;\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n        if (!Page.IsPostBack)\n        {\n            BindData();\n        }\n        UpdatePanel1.Visible = false;\n    }\n    private void BindData()\n    {\n\n        string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=TestDB;Persist Security Info=True;User ID=v2soft;Password=passwordv2soft\";\n        SqlConnection myConnection = new SqlConnection(connectiongString);\n        SqlDataAdapter ad = new SqlDataAdapter(\"SELECT Id, fName, lName, rTimeN, rTime FROM bleaTest\", myConnection);\n        DataSet ds = new DataSet();\n        ad.Fill(ds);\n        GridView1.DataSource = ds;\n        GridView1.DataBind();\n\n    }\n\n\n\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        isEditMode = true;\n        UpdatePanel1.Visible = true;\n        BindData();\n    }\n    protected void TextBox1_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void Button2_Click(object sender, EventArgs e)\n    {\n        Update();\n    }\n    protected bool IsInEditMode\n    {\n\n        get { return this.isEditMode; }\n\n        set { this.isEditMode = value; }\n\n    }\n\n\n    private void Update()\n    {\n        StringBuilder sb = new StringBuilder();\n\n        foreach (GridViewRow row in GridView1.Rows)\n        {\n            sb.Append(\"UPDATE bleaTest SET rTime = '\");\n\n            sb.Append((row.FindControl(\"rTime\") as TextBox).Text);\n\n            sb.Append(\"'\");\n\n            sb.Append(\" WHERE id = \");\n\n            sb.Append(Convert.ToInt32((row.FindControl(\"ID\") as Label).Text));\n\n            sb.Append(\" \");\n\n        }\n        string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=TestDB;Persist Security Info=True;User ID=v2soft;Password=passwordv2soft\";\n        SqlConnection myConnection = new SqlConnection(connectiongString);\n        SqlCommand myCommand = new SqlCommand(sb.ToString(), myConnection);\n        myConnection.Open();\n        myCommand.ExecuteNonQuery();\n        myConnection.Close();\n\n        isEditMode = false;\n\n        BindData();\n\n        UpdatePanel1.Visible = false;\n\n    }\n    protected void gvUsers_RowDataBound(object sender, GridViewCommandEventArgs e)\n    {\n\n    }\n</code></pre>\n\n<p>Thank you in advance!!</p>\n"},{"tags":["c#","asp.net","application-name"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13270089,"title":"c# How to get a meaninful name of website or executable","body":"<p>We have an internal error reporting system (inside our functions dll) and one of the info pieces we send is the name of the application that caused it. </p>\n\n<p>Current code:</p>\n\n<pre><code>string applicationname= Assembly.GetCallingAssembly().GetName().Name;\n</code></pre>\n\n<p>The problem is when the error is send from one of our websites as it sends application names like \"App_Code.6p_c415d\".</p>\n\n<p>One possible way was determining if the app is an executable or a website dinamically (how do we do that?) and in the case of being a website get the folder containing it or so...</p>\n\n<p>But if you have better ways we are open to any idea ^^</p>\n"},{"tags":["c#","app-config"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13286916,"title":"C# applicationSettings: how to update app.config?","body":"<p>I am using .NET 4.0 and I would like to use the <code>app.config</code> file to store same parameter settings. I do the following. I use the <code>Settings</code> tab in the project properties to create my parameters. </p>\n\n<p>This add the information in the <code>app.config</code> file like this:</p>\n\n<pre><code>&lt;MyApp.Properties.Settings&gt;\n      &lt;setting name=\"param1\" serializeAs=\"String\"&gt;\n        &lt;value&gt;True&lt;/value&gt;\n      &lt;/setting&gt;\n&lt;MyApp.Properties.Settings&gt;\n</code></pre>\n\n<p>In my view model (in my code) I can access to the information in this way:</p>\n\n<pre><code>bool myBool = MyApp.Properties.Default.param1;\n</code></pre>\n\n<p>When I try to change the value in the config file, I try this:</p>\n\n<pre><code>Properties.Settings.Default.param1 = false;\n</code></pre>\n\n<p>But this causes an error, that <code>param1</code> is read-only.</p>\n\n<p>So how can I update my config file from my code?</p>\n"},{"tags":["c#",".net","wpf","webcam"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":697,"score":0,"question_id":8927355,"title":"Capturing webcam images,videos with C#","body":"<p>Actually i want to access webcam to capture pictures and record videos using C# and .Net.\nI have seen many examples in google.But all of them are using COM programming ,which i m not familiar with.I want to know if there is any built in library in .Net framework 4.0 for doing that.There are several opensource libraries for capturing images using C#.But i want to use the built in capabilities of .Net.Please help me...</p>\n"},{"tags":["c#",".net","winapi","internet","webcam"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":322,"score":-2,"question_id":9176926,"title":"How to share desktop using a webcam driver?","body":"<p>I want to create a desktop sharing app. I think the best way is to use a webcam emulation on the desktop and share the stream. But are there any free drivers that do that emulation?</p>\n\n<p>EDIT: Thanks for downvoting. I don't think the question was stupid.</p>\n"},{"tags":["c#","exception","for-loop","code-analysis"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":13292703,"title":"Why can't the C# compiler tell that this function always returns or throws?","body":"<p>I have the following (simplified) method:</p>\n\n<pre><code>public bool DoWorkWithRetry()\n{\n    for (int remainingTries = Constants.MaxRetries; remainingTries &gt;= 0; remainingTries--)\n    {\n        try\n        {\n            return DoWork();\n        }\n        catch (Exception ex)\n        {\n            if (remainingTries == 0)\n            {\n                throw new WorkException(\n                        String.Format(\"Failed after {0} retries.\", Constants.MaxRetries),\n                        ex);\n            }\n            // fall through to retry\n        }\n    }\n}\n</code></pre>\n\n<p>It seems pretty clear to me that this method either <em>returns</em> or <em>throws</em>. However, the C# compiler complains at me that <code>not all code paths return a value</code>.</p>\n\n<ul>\n<li>Is this a limitation of the C# compiler's code-analysis?</li>\n<li>Or is there some condition that I'm not seeing where the <code>for</code> loop could complete without either throwing or returning?</li>\n</ul>\n"},{"tags":["c#","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13292600,"title":"Delegate Conversion C# to VB","body":"<p>I am trying to convert some C# code to VB .Net and am having issues with some of the delgate conversions.</p>\n\n<p>BackupLibraries.cs</p>\n\n<pre><code>Public Class Backup\n{\npublic event EventHandler&lt;BackupPEventArgs&gt; Backup;\n\n...\nif (BackupProgress != null) BackupProgress(this, new BackupProgressEventArgs(percent_complete))\n...\n}\n\npublic class BackupEventArgs : EventArgs\n    {\n        private float percentage;\n\n        public BackupProgressEventArgs(float percentage)\n        {\n            this.percentage = percentage;\n        }\n\n        public float Percentage\n        {\n            get { return percentage; }\n        }\n    }\n</code></pre>\n\n<p>UnitTest.cs</p>\n\n<pre><code>public void BackupTest()\n{\nBackup bu = new Backup()\n        bu.BackupProgress += delegate(object sender, Backup.BackupEventArgs e)\n\n        {\n            Debug.WriteLine(\"Percentage: \" + e.Percentage.ToString());\n        };\n}\n</code></pre>\n\n<p>It's converting sb.Backup += delegate(object sender, SQLBackup.BackupProgressEventArgs e)\nand wiring it to the event in the other class  I am having issues on. </p>\n\n<p>In VB:</p>\n\n<p>Backuplibraries.vb</p>\n\n<pre><code>Public Class Backup\n\nPublic Event Backup As EventHandler(Of BackupEventArgs)\n\n...\nRaiseEvent Backup(Me, New BackupEventArgs(percent_complete))\n...\nEnd Class\n\nPublic Class BackupEventArgs\n            Inherits EventArgs\n</code></pre>\n\n<p>UnitTest.vb</p>\n\n<pre><code>Public Class BackupTest\n\nDim bu As New Backup()\n\nbu.BackupProgress = Sub(sender As Object, e As BackupEventArgs)\n                         Debug.WriteLine(e.Percentage.ToString())\n                         End Sub\n\nEnd Class\n</code></pre>\n\n<p>Of course </p>\n\n<pre><code>bu.BackupProgress = Sub(sender As Object, e As BackupEventArgs)\n                             Debug.WriteLine(e.Percentage.ToString())\n                             End Sub\n</code></pre>\n\n<p>is where the issue I am having with the conversion from C# to .Net is. </p>\n"},{"tags":["c#","sharepoint2010","openxml","excel-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13293080,"title":"SharePoint 2010 \"error\" opening Excel that was created through C#","body":"<p>Here's the situation: on a certain page within SharePoint, a user clicks a button in a webpart to create a report based on data in SharePoint. This report is an Excel document that is created through C# code. When the report is created, it will be uploaded to SharePoint. When the upload is done, the file will be automatically opened for the user so the file can be saved locally or printed or some other action.</p>\n\n<p>Here's a <strong>simplified</strong> version of how my code works:</p>\n\n<pre><code>//Prepare the data in a table\n//Normally there are multiple rows and columns here\nvar fileName = \"Report.xlsx\";\nvar table = new System.Web.UI.WebControls.Table();\ntable.Rows.Add(new TableRow());\ntable.Rows[0].Cells.Add(new TableCell());\ntable.Rows[0].Cells[0].Text = \"Some cell value\";\nCreateWorkbook(\"My Report\", fileName, table);\n\nprivate void CreateWorkbook(string name, string fileName, Table table)\n{\n    using (var doc = SpreadsheetDocument.Create(_tempfolder + fileName, SpreadsheetDocumentType.Workbook))\n    {\n        var sheetData = new SheetData();\n        var excelRow = new Row { RowIndex = 1 };\n\n        sheetData .AppendChild(excelRow);\n\n        //Normally there's a loop here going over all the rows and columns\n        var tableCellValue = table.Rows[0].Cells[0].Text;\n        var excelCell = CreateTextCell(\"A\", 1, tableCellValue);\n        excelRow.AppendChild(excelCell);\n\n        doc.AddWorkbookPart().AddNewPart&lt;WorksheetPart&gt;().Worksheet = new Worksheet(sheetData);\n        doc.WorkbookPart.Workbook = new Workbook(\n            new Sheets(\n                new Sheet\n                {\n                    Id = doc.WorkbookPart.GetIdOfPart(doc.WorkbookPart.WorksheetParts.First()),                    \n                    SheetId = 1,\n                    Name = name\n                }));\n        doc.WorkbookPart.Workbook.Save();\n        doc.Close();\n\n        //Upload the file to SharePoint\n        //Omitted as this is not the issue here\n    }\n}\n\nprivate static Cell CreateTextCell(string col, int row, string cellValue)\n{\n    var cell = new Cell { DataType = new EnumValue&lt;CellValues&gt;(CellValues.InlineString), CellReference = col + row };\n    var inlineString = new InlineString();\n    var text = new Text { Text = value };\n\n    inlineString.Append(l_objText);\n    cell.Append(inlineString);\n\n    return cell;\n}\n</code></pre>\n\n<p>Everything in the code works fine and the Excel-file is succesfully created and uploaded and after all this Excel opens up and then I get following message:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BIjG6.png\" alt=\"enter image description here\"></p>\n\n<blockquote>\n  <p><em>Excel found unreadable content in '...'. Do you want ti recover the contents of this workbook? If you trust the source of this workbook, click Yes.</em></p>\n</blockquote>\n\n<p>When I click Yes, Excel magically repairs and opens the content and everything is shown as normal. But where does this error come from? I have looked on the internet for this problem and in almost all the cases the source of this problem are macros, formulas and other exotic Excel-stuff. But in this case, only one cell is added with just a string-value.</p>\n\n<p>Does anyone know how to solve this issue?</p>\n"},{"tags":["c#","dynamic","ironruby","invalidcastexception"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":164,"score":1,"question_id":6984112,"title":"How to fix InvalidCastException for dynamic object?","body":"<pre><code>ScriptEngine rubyEngine;\n//...\ndynamic execution_result = rubyEngine.Execute(script, scope);\n\nif (execution_result != null &amp;&amp; !silent)\n    WriteResponce(execution_result.ToString());\n</code></pre>\n\n<p>This code generates <strong>InvalidCastException</strong>:</p>\n\n<blockquote>\n  <p>Unable to cast object of type 'SOMELIB.Graphics' to type\n  'SOMELIB.Object'.</p>\n</blockquote>\n\n<p>When the comparison occurs: </p>\n\n<blockquote>\n  <p>execution_result != null</p>\n</blockquote>\n\n<p>If this comparison is removed, then execution_result.ToString() throws the same exception.</p>\n\n<p>I have found a workaround:</p>\n\n<pre><code>if (execution_result is SOMELIB.Graphics)\n{\n    SOMELIB.Graphics g = execution_result as SOMELIB.Graphics;\n    WriteResponce(g.ToString());\n    return;\n}\n</code></pre>\n\n<p>but I don't understand why does this exception appear and how to fix it.</p>\n"},{"tags":["c#","asp.net","azure","windows-azure-storage"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13292891,"title":"How to solve this error for 'Windows Azure' Conversion ASP.NET 3.5 to 4.0?","body":"<p>I found an Error when I convert my Windows Azure(ASP.NET) project .NET 3.5 to 4.0.</p>\n\n<p>Getting error:\n SetConfigurationSettingPublisher needs to be called before FromConfigurationSetting can be used</p>\n\n<p>Source File: \n<code>storageAccount = CloudStorageAccount.FromConfigurationSetting(\"DataConnectionString\");</code></p>\n\n<p>Thanks\nNahid</p>\n"},{"tags":["c#","generics","reflection","runtime"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":13276447,"title":"Create type \"MyClass : OtherClass<MyClass> { }\" at runtime?","body":"<p>Is it possible in C# to create a type at runtime that inherits from a generic class where the template parameter for the base class is the current class being constructed? This will compile fine:</p>\n\n<pre><code>// I have this class:\npublic class OtherClass&lt;T&gt;\n    where T : OtherClass&lt;T&gt;\n{ }\n\n// I want to create this at runtime:\npublic class MyClass : OtherClass&lt;MyClass&gt;\n{ }\n</code></pre>\n\n<p>but I'm not sure how to create the <code>MyClass</code> using <code>System.Reflection.Emit.ModuleBuilder.TypeBuilder</code>:</p>\n\n<pre><code>AssemblyName asn = new AssemblyName(\"test.dll\");\nAssemblyBuilder asb = AppDomain.CurrentDomain.DefineDynamicAssembly(\n    asn, AssemblyBuilderAccess.RunAndSave, @\"D:\\test_assemblies\");\n\nModuleBuilder = modb = asb.DefineDynamicModule(\"test\", \"test.dll\");\n\nTypeBuilder tb = modb.DefineType(\n    \"test\",\n    TypeAttributes.Public | TypeAttributes.Class,\n    typeof(MyClass)); // How to specify inheritance?\n\n// populate properties, fields, methods, etc., emit...\n\ntb.CreateType();\n</code></pre>\n\n<p>Is this possible?</p>\n\n<p>Edit - Based on replies so far, I've tried this:</p>\n\n<pre><code>public class OtherClass&lt;T&gt;\n    where T : OtherClass&lt;T&gt;\n{ }\n\npublic static void CreateSimple()\n{\n    AssemblyName asn = new AssemblyName(\"test\");\n    AssemblyBuilder asb = AppDomain.CurrentDomain.DefineDynamicAssembly(\n        asn, AssemblyBuilderAccess.RunAndSave, @\"D:\\test_asms\");\n    ModuleBuilder modb = asb.DefineDynamicModule(\"test\", \"test.dll\");\n\n    try\n    {\n        TypeBuilder tb = modb.DefineType(\n            \"MyClass\",\n            TypeAttributes.Public | TypeAttributes.Class);\n\n        Type my = tb.CreateType();\n        tb.SetParent(typeof(OtherClass&lt;&gt;).MakeGenericType(my));\n\n        my = tb.CreateType();\n    }\n    catch (Exception e)\n    {\n        throw;\n    }\n}\n</code></pre>\n\n<p>but get this exception:</p>\n\n<pre><code>GenericArguments[0], 'MyClass', on 'MyProject.Factory+OtherClass`1[T]'\nviolates the constraint of type 'T'.\n</code></pre>\n"},{"tags":["c#","winforms","multithreading"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13292627,"title":"Getting Cannot access a disposed object, when trying to hide a form","body":"<p>I have a MDI based charting application. Each child form is a form that contains a chart. Each chart has its own data queue and a dedicated worker thread.</p>\n\n<p>In the worker thread DoWork method, I have a while loop controlled by a bool \"IsChartActive\", which will plot the data on the graph. To plot the data, I call Invoke on the chartForm itself and pass in a delegate to the method that should update the chart.</p>\n\n<p>When the user closes a chart form, instead of actually closing it, I stop the chart updates and want to hide the chart till the user wants to see it again.</p>\n\n<p>To do this I handle the FormClosing event, set Cancel = true, set \"IsChartActive = false\" and call ChartForm.Hide().</p>\n\n<p>But after this I get the \"Cannot access a disposed object\" exception in the DoWork method ( I assume this happens due to the background thread being already at the invoke statement when I set the \"IsChartActive = false\", so it will see the change in the next iteration), when calling invoke on the chart.</p>\n\n<p>Why am I getting this exception, even though the chart is not actually disposed but only hidden?</p>\n\n<pre><code>public void StopChartUpdates()\n        {\n            IsActive = false;\n            updateChartThread.CancelAsync();\n        }\n\n\nprivate void updateChartThread_DoWork(object sender, DoWorkEventArgs e)\n        {\n            while (IsActive &amp;&amp; !updateChartThread.CancellationPending)\n            {\n                try\n                {\n                    ChartView.Invoke(new Action(InvokeOnUiThread));\n\n                }\n                catch (ObjectDisposedException ex)\n                {\n                              //getting this error when calling invoke on ChartView\n                    Trace.WriteLine(\"Exception: \" + ex.Message);\n                }\n                Thread.Sleep(UpdateFrequency);\n            }\n        }\n\nprivate void InvokeOnUiThread()\n        {\n            try\n            {\n                       //update the chart\n            }\n            catch (Exception ex)\n            {\n                Trace.WriteLine(\"Exception: \" + ex.Message);\n            }\n        }\n\nprivate void ChartView_FormClosing(object sender, System.Windows.Forms.FormClosingEventArgs e)\n        {\n            StopChartUpdates();\n            if (e.CloseReason == CloseReason.UserClosing)\n            {\n                ChartView.Hide();\n                e.Cancel = true;\n            }\n        }\n</code></pre>\n"},{"tags":["c#","wpf","xaml","xamlparseexception"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13283478,"title":"XamlParseException after deleting settings (app.config)","body":"<p>I get that exception, after deleting settings in my project. It is a default settings that using ProjectName.Properties namespace. Also i deleted app.config from project.\nWhy i did that: i have been added serialize for reading my settings.xml instead of the old version.</p>\n\n<p>I think these settings are defined somewhere, but dont know it.</p>\n\n<p>This is text of exception, if it helps (translated in google translate):</p>\n\n<blockquote>\n  <p>Call the constructor for type\" GnomeExtractor.MainWindow \", satisfying the specified binding constraints, led to an exception.\" Row number \"6\" and the position in the \"9.\"</p>\n</blockquote>\n\n<p>I deleted these files <b>manually</b>:<br></p>\n\n<blockquote>\n  <p>Settings.settings<br>\n  Settings.Desighner.cs<br>\n  app.config</p>\n</blockquote>\n\n<p><strong>UPD:</strong> My MainWindow.xaml code at 6,9:</p>\n\n<pre><code>Title=\"Gnome Extractor\" Height=\"500\" Width=\"1000\" MinHeight=\"500\" MinWidth=\"1000\" \nLoaded=\"Window_Loaded\" Closing=\"Window_Closing\" Icon=\"/GnomeExtractor;component/Resources/GX icon.ico\"&gt;\n</code></pre>\n\n<p>If i delete this, i got error in row 5 now, but next code is my styles and i can quietly delete this and it did not has no effect. </p>\n\n<p><strong>I have rolled back</strong> my project to working version, and got this error when i delete app.config</p>\n\n<p><strong>/UPD</strong></p>\n\n<p>If you need more information, ask me about, please.</p>\n"},{"tags":["c#","wpf","wpf-usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13292896,"title":"endless dispatchertimer memory leak","body":"<p>I've have created usercontrol for displaying current time and date, refreshing every second. This timer, off course, must be endless. But i found that this timer gradually increase memory usage of the application. Any ideas about what the best way to realize control functionality... (Sorry for my english)\nIn code behind </p>\n\n<pre><code>    public DispatcherTimer timer;\n\n    public DateTimeUserControl()\n    {\n        InitializeComponent();\n\n        /////////////////////////////////////////////////////////////////////////////\n        timer = new DispatcherTimer();\n        timer.Interval = new TimeSpan(0, 0, 0, 1);\n        timer.Tick += new EventHandler(timer_Tick);\n        timer.Start();\n    }\n\n    void timer_Tick(object sender, EventArgs e)\n    {\n        hourTextBlock.Text = DateTime.Now.Hour.ToString();\n        colonTextBlock.Visibility = (colonTextBlock.Visibility == Visibility.Visible) ? Visibility.Hidden : Visibility.Visible;            \n        minuteTextBlock.Text = String.Format(\"{0:00}\", DateTime.Now.Minute);\n        dateTextBlock.Text = DateTime.Now.ToLongDateString();\n    }\n</code></pre>\n"},{"tags":["c#","winforms","scrolling","mousewheel"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":286,"score":4,"question_id":11034348,"title":"Mouse wheel event to work with hovered control","body":"<p>In my C# 3.5 Windows Forms application, I have a few SplitContainers. There is a list control inside each (dock fill). When the focus is on one of these controls and I move mouse wheel, the list, which is now focused, is scrolled.</p>\n\n<p>My task is to scroll the list, which is currently hovered by mouse, not the one which is selected. Is it possible in Windows Forms? If not, is it possible with PInvoke?</p>\n"},{"tags":["c#","datatable","dataset","case-sensitive"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13292771,"title":"Enable Case Sensitive when using DataTable.select","body":"<p>My database includes only </p>\n\n<blockquote>\n  <p>Truck</p>\n</blockquote>\n\n<p>however my below select statment returns the rows with 'Truck'</p>\n\n<pre><code>MyWebControl.Myfunction().Select(\"TransportationMode = '\" + TRUCK + \"'\");\n</code></pre>\n\n<p>How can I make this select statement case sensitive ?</p>\n"},{"tags":["c#","attributes","postsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13292620,"title":"PostSharp attribute contructor only being hit once","body":"<p>I have several methods that are using an attribute I built with the help of PostSharp. The attribute has 3 constructor overloads and each overload performs logic before the OnEntry() is called. The first time a method is hit with my attribute on it, it works fine. After that, the constructors are not being hit in my attribute and only the OnEntry() is firing. </p>\n\n<p>I need the constructors to be called each time the method with the attribute is called. Does anyone know a solution for this?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","xaml",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13286809,"title":"Controls visual state not updating?","body":"<p>I have done this a million times before with success but since upgrading to VS 2012 and using Blend Preview I have hit a problem.</p>\n\n<p>I have a button which I have set so that if the Mouse is over the border goes from 0% to 100% on the Alpha channel and if the button is pressed then the background also goes from 0% to 100% on the Alpha channel.</p>\n\n<p>here is the xaml code which is generated by blend preview.</p>\n\n<pre><code>&lt;ControlTemplate x:Key=\"ImageNTextButton\" TargetType=\"{x:Type local:GButton}\"&gt;\n        &lt;Grid&gt;\n            &lt;Grid.RowDefinitions&gt;\n                &lt;RowDefinition/&gt;\n                &lt;RowDefinition Height=\"Auto\"/&gt;\n            &lt;/Grid.RowDefinitions&gt;\n            &lt;VisualStateManager.VisualStateGroups&gt;\n                &lt;VisualStateGroup x:Name=\"CommonStates\"&gt;\n                    &lt;VisualState x:Name=\"MouseOver\"&gt;                            \n                        &lt;Storyboard&gt;\n                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Border.BorderBrush).(SolidColorBrush.Color)\" Storyboard.TargetName=\"border\"&gt;\n                                &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#FF00B9FF\"/&gt;\n                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                        &lt;/Storyboard&gt;                           \n                    &lt;/VisualState&gt;\n                    &lt;VisualState x:Name=\"Pressed\"&gt;\n                        &lt;Storyboard&gt;\n                            &lt;ColorAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Panel.Background).(SolidColorBrush.Color)\" Storyboard.TargetName=\"border\"&gt;\n                                &lt;EasingColorKeyFrame KeyTime=\"0\" Value=\"#8CCBCBCB\"/&gt;\n                            &lt;/ColorAnimationUsingKeyFrames&gt;\n                        &lt;/Storyboard&gt;\n                    &lt;/VisualState&gt;\n                    &lt;VisualState x:Name=\"Disabled\"/&gt;\n                &lt;/VisualStateGroup&gt;\n                &lt;VisualStateGroup x:Name=\"FocusStates\"&gt;\n                    &lt;VisualState x:Name=\"Focused\"/&gt;\n                &lt;/VisualStateGroup&gt;\n                &lt;VisualStateGroup x:Name=\"ValidationStates\"&gt;\n                    &lt;VisualState x:Name=\"InvalidFocused\"/&gt;\n                    &lt;VisualState x:Name=\"InvalidUnfocused\"/&gt;\n                &lt;/VisualStateGroup&gt;\n            &lt;/VisualStateManager.VisualStateGroups&gt;\n            &lt;Border x:Name=\"border\" HorizontalAlignment=\"Center\" Height=\"Auto\" VerticalAlignment=\"Center\" Width=\"Auto\" BorderThickness=\"{TemplateBinding BorderThickness}\" CornerRadius=\"3\" Background=\"#00CBCBCB\" BorderBrush=\"#0000B9FF\"&gt;\n                &lt;ContentPresenter HorizontalAlignment=\"Center\" Height=\"Auto\" VerticalAlignment=\"Center\" Margin=\"3\"/&gt;\n            &lt;/Border&gt;\n            &lt;TextBlock HorizontalAlignment=\"Center\" Grid.Row=\"1\" TextWrapping=\"Wrap\" Text=\"{TemplateBinding Text}\" VerticalAlignment=\"Top\"/&gt;\n        &lt;/Grid&gt;\n    &lt;/ControlTemplate&gt;\n</code></pre>\n\n<p>You will notice the TargetType of local:GButton</p>\n\n<p>code for GButton shouldn't affect it but I will post anyway</p>\n\n<pre><code>public class GButton : Button\n{\n    public static readonly DependencyProperty TextProperty = DependencyProperty.Register(\n        \"Text\", typeof(string), typeof(GButton), new PropertyMetadata(\"Button\"));\n\n    /// &lt;summary&gt;\n    /// The text displayed under button.\n    /// &lt;/summary&gt;\n    /// &lt;remarks&gt;The Text is specified in XAML as an absolute or relative path.&lt;/remarks&gt;\n    [Description(\"The text displayed in button\"), Category(\"Common Properties\")]\n    public string Text\n    {\n        get { return (string)this.GetValue(TextProperty); }\n        set { this.SetValue(TextProperty, value); }\n    }\n\n    public GButton() : base() { }\n}\n</code></pre>\n\n<p>If I move the mouse over the button the border changes as expected but if I move the mouse away the border remains as if the mouse if over.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","selenium","webdriver"],"answer_count":9,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":15957,"score":19,"question_id":6992993,"title":"Selenium c# Webdriver: Wait Until Element is Present","body":"<p>I want to make sure that an element is present before the webdriver starts doing stuff. </p>\n\n<p>I'm trying to get something like this to work: </p>\n\n<pre><code>WebDriverWait wait = new WebDriverWait(driver, new TimeSpan(0,0,5));\nwait.Until(By.Id(\"login\"));\n</code></pre>\n\n<p>I'm  mainly struggling how to setup up the anynomous function..</p>\n"},{"tags":["c#",".net","asp.net-mvc","rest","asp.net-web-api"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13284460,"title":"ASP.NET WebApi not receiving post data","body":"<p>I need to receive some string and binary data using WebApi. I have created a controller this way:</p>\n\n<pre><code>    [HttpPost]\n    public void Post(byte[] buffer)\n    {\n        // Some code goes here\n    }\n</code></pre>\n\n<p>Here's the routtings:</p>\n\n<pre><code>    routes.MapHttpRoute(\n        name: \"CuscarD95B\",\n        routeTemplate: \"D95B/{controller}\",\n        defaults: new { buffer = RouteParameter.Optional },\n        constraints: new { controller = @\"Cuscar\" }\n</code></pre>\n\n<p>Now when I try to post some data, buffer is always byte[0] (zero length array). No data is being passed to the controller. </p>\n\n<p>Any help would be appreciated. </p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","listview","virtual"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13292296,"title":"listview virtual mode item selection with clipboard","body":"<p>i am reading a file and populating a virtual list view</p>\n\n<p>i wrote a function (copies the selected item to clipboard once i double click)</p>\n\n<pre><code>    private void MessageView_MouseDoubleClick(object sender, MouseEventArgs e)\n    {\n\n        ListView.SelectedIndexCollection indexes = this.MessageView.SelectedIndices;\n\n        foreach (int index in indexes)\n        {\n            Clipboard.SetText(this.MessageView.Items[index].SubItems[0].Text);\n        }\n    }\n</code></pre>\n\n<p>However, the problem is that when I refresh the list, say read in another file - I get an error with \"Unhandled exception .... InvalidArgument=Value of 'xx' is not valid for 'index' Parameter name: index\" (xx refers row of the item I selected to be copied to clipboard)</p>\n\n<p>The problem seems to be throwing an error because the specific item to be copied in the clipboard is deleted, refreshed because of a new file being loaded. </p>\n\n<p>however, since this is a doubleclick event, shouldn't the clipboard have the stored text, and therefore have no need to read anything?</p>\n\n<p>how can i perform this function, copy a virtual list view to clipboard but also keeping the data there when i refresh the listview?</p>\n"},{"tags":["c#","asp.net","mono"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13222241,"title":"asp.net cannot find class","body":"<p>I have some asp.net that I developed and is working just fine on a windows machine but now I'm trying to run it on a machine running Ubuntu and Mono 2.4.4 and ASP.NET 2.0 and getting errors.</p>\n\n<p>I have some classes in my App_Code directory, such as <code>DatabaseSingleton.cs</code>, <code>Functions.cs</code> and <code>NotAllowedException.cs</code>. All of them are using the namespace <code>aspapp</code>.</p>\n\n<p>Anyway, when trying to run a file (<code>Login.aspx.cs</code>) that uses the <code>DatabaseSingleton</code> class, I get that <code>CS0103: The name 'DatabaseSingleton' does not exist in the current context</code>. However, in a different file that isn't using <code>DatabaseSingleton</code> but is using <code>NotAllowedException</code>, I get a similar but a different error: <code>CS0246: The type or namespace name 'NotAllowedException' could not be found. Are you missing a using directive or an assembly reference?</code>. All the files are in the namespace <code>aspapp</code> and has <code>using aspapp</code> in the files.</p>\n\n<p>Are there anything I need to add in the web.config to be able to access these files on mono?</p>\n"},{"tags":["c#","types"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12498982,"title":"IDataObject.GetData(string, true) fails if cross assemblies","body":"<p>I am calling IDataObject.GetData() and it is not working for derived classes. I am making the call in one assembly (DLL) and both classes are in a second assembly (DLL). Is there something else that must be done if this is across assemblies?</p>\n\n<p>By not working I mean it returns null. And for GetDataPresent it returns false.</p>\n\n<pre><code>bool returnsFalse = dea.Data.GetDataPresent(typeof (ODataBaseNode));\nbool returnsTrue = dea.Data.GetDataPresent(typeof (ODataEntitySetNode));\nreturnsFalse = dea.Data.GetDataPresent(typeof (ODataBaseNode).FullName, true);\nreturnsTrue = dea.Data.GetDataPresent(typeof (ODataEntitySetNode).FullName, true);\n\n// code in other DLL\npublic class ODataEntitySetNode : ODataBaseNode\n{\n</code></pre>\n\n<p>thanks - dave</p>\n"},{"tags":["c#",".net"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":891,"score":4,"question_id":3634715,"title":"writing a DSL for the .Net platform","body":"<p>I am thinking of writing a <a href=\"http://en.wikipedia.org/wiki/Domain-specific_language\" rel=\"nofollow\">DSL</a> to be run in the .Net environment. I am most likely to implement this in C#, though I am flexible on this.</p>\n\n<p>Is there a recommended online resources that show the main steps involved in writing a DSL for the .Net platform?</p>\n\n<p>Ideally, I would like a resource that would provide at least an overview on the following:</p>\n\n<ul>\n<li>'Spec'ing a DSL</li>\n<li>How to map the specs to the .Net framework</li>\n<li>Preferably a helloworld example of a trivial DSL implemented in a .Net language</li>\n</ul>\n\n<p><strong>[Edit]</strong></p>\n\n<p>Actually, I have just seen <a href=\"http://www.codeproject.com/KB/recipes/YourFirstDSL.aspx\" rel=\"nofollow\">this article</a> - but it is slightly dated. Does anyone have a view on whether the article is a good starting point or not (the .Net framework and C# seem to evolve at a very rapid pace)</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12895647,"title":"How to update a collection of xml Elements?","body":"<p>I'm a liitle bit green to the saving reeding xml and linq in c#. This is my code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>    public static void EditConfiguration (DesignConfiguration design)\n    {\n        XDocument configXml = XDocument.Load(configXMLFileName);\n        var updateData = configXml.Root.Elements(\"Design\").Where(element =&gt; (String)element.Attribute(\"name\") == design.DesignName).FirstOrDefault();\n\n        if (updateData != null)\n        {\n            var myElements = updateData.Elements();  //All the elements under th Design node \n            configXml.Save(configXMLFileName);    \n       }            \n    }\n</code></pre>\n\n<p>In the myElements variable there are such elements:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;C:\\Inetpub&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;True&lt;/CopyLookups&gt;\n&lt;CopyImages&gt;False&lt;/CopyImages&gt;\n&lt;ImageSourceFolder&gt;None&lt;/ImageSourceFolder&gt;\n&lt;ImageDesinationFolder&gt;None&lt;/ImageDesinationFolder&gt;\n</code></pre>\n\n<p>I want to update each of this elements with the value from the design configuration object. This wouldn't be so hard if i had one value in the object but there are values like so: </p>\n\n<p>design.SourceFolder\ndesign.DesitnationFolder </p>\n\n<p>etc (just like the elements). The object provides new values for above elements. It's obvious to me that I should use the foreach loop but the result when I'm using it is not the one I want...</p>\n\n<p>This is my foreach loop: </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>            foreach (var item in myElements )\n            {\n                item.SetElementValue(\"SourceFolder\", design.SourceFolder);\n            }\n</code></pre>\n\n<p>In the loop there is only one element for the presentation needs, but I wanted to put more of them in the loop. And this is what I get: </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;SourceFolder&gt;C:\\CSF_Packages&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;None&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;True&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/CopyLookups&gt;\n&lt;CopyImages&gt;False&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/CopyImages&gt;\n&lt;ImageSourceFolder&gt;C:\\Inetpub&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/ImageSourceFolder&gt;\n&lt;ImageDesinationFolder&gt;None&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/ImageDesinationFolder&gt;\n</code></pre>\n\n<p>I would like to have: </p>\n\n<pre><code>&lt;SourceFolder&gt;new_value_from the DesignConfiguration object from the SourceFolder property&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;new_value_from the DesignConfiguration object from the Desitnation Folder property&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;new_value_from the DesignConfiguration object from the CopyLookups property&lt;/CopyLookups&gt;\n</code></pre>\n\n<p>and so on...\nplease help a noobie in the stress :) Thank you very much. </p>\n"},{"tags":["c#","windows-phone-8"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13280863,"title":"live tile is not updating in Windows Phone","body":"<p>i am developing a windows phone app where application has an option to pin the application to home screen. And i am using ShellTileSchedule class to do schedule the update periodically. Some reason my app is not pushing any update to tile. My app data is completely local, no data is coming from outside.</p>\n\n<p>In my tile update, i am not updating any image on the lile, but only changing the data to display.</p>\n\n<pre><code> foreach (ShellTile tile in ShellTile.ActiveTiles)\n {\n            IconicTileData tileData = GetTileData();\n\n            tileSchedule = new ShellTileSchedule(tile, tileData);\n            tileSchedule.Interval = UpdateInterval.EveryHour;\n            tileSchedule.Recurrence = UpdateRecurrence.Interval;\n            tileSchedule.Count=GetUserData();\n            tileSchedule.StartTime = DateTime.Now;\n            tileSchedule.Start();\n\n            tile.Update(tileData);\n}\n</code></pre>\n\n<p>Any help in this regard? Or do i need to background agent to update the tile?</p>\n"},{"tags":["c#","asp.net","directory","getfiles","getdirectories"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3092,"score":0,"question_id":810602,"title":"Directory.GetFiles works, Directory.GetDirectories doesn't on the same directory","body":"<p>I have a simple file selector on my web application which uses Directory.GetFiles and Directory.GetDirectories to produce the UI.  This works perfectly on my localhost, but when I upload it to my Windows Server 2003 hosting I can only see files - on the same directory, GetFiles works but GetDirectories doesn't.</p>\n\n<p>The code is incredibly simple - the string dir is created by a Server.MapPath call, and then:</p>\n\n<pre><code>List&lt;string&gt; dirs = Directory.GetDirectories(dir).ToList();\nList&lt;string&gt; files = Directory.GetFiles(dir).ToList();\n</code></pre>\n\n<p>I have tried everything I can think of security-wise; even to the point of giving \"Everyone\" full access to all directories in the web root, and even this makes no difference.</p>\n\n<p>So if the issue is not with security, I would be very grateful of some suggestions for more things to try!</p>\n\n<p><strong>Update:</strong> I'm pretty dumb - the code that spat out the HTML contained some very old testing code that hadn't made any difference on local so hadn't been noticed and removed, but that caused every directory on the server to be ignored!  What was it?</p>\n\n<pre><code>if (!subDir.Contains(\".\")) { ...\n</code></pre>\n\n<p>On the server, all sites are in folders named by their domain - on local, they aren't.  Me == stupid.  Sorry everyone!</p>\n"},{"tags":["c#","ado.net","garbage-collection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13292464,"title":"Out of memory when copying large database with C# / ADO.Net Entities","body":"<p>Yet another How-to-free-memory question:</p>\n\n<p>I'm copying data between two databases which are currently identical but will soon be getting out of sync.  I have put together a skeleton app in C# using Reflection and ADO.Net Entities that does this:</p>\n\n<p>For each table in the source database: </p>\n\n<ul>\n<li>Clear the corresponding table in the destination database  </li>\n<li>For each object in the source table\n<ul>\n<li>For each property in the source object\n<ul>\n<li>If an identically-named property exists in the destination object, use Reflection to copy the source property to the destination property  </li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>This works great until I get to the big 900MB table that has user-uploaded files in it.</p>\n\n<p>The process of copying the blobs (up to 7 MB each) to my machine and back to the destination database uses up local memory.  However, that memory isn't getting freed, and the process dies once it's copied about 750 MB worth of data - with my program having 1500 MB of allocated space when the OutOfMemoryException is thrown, presumably two copies of everything that it's copied so far.</p>\n\n<p>I tried a naive approach first, doing a simple copy.  It worked on every table until I got to the big one.  I have tried forcing a <code>GC.Collect()</code> with no obvious change to the results.  I've also tried putting the actual copy into a separate function in hopes that the reference going out of scope would help it get GCed.  I even put a <code>Thread.Sleep</code> in to try to give background processes more time to run.  All of these have had no effect.</p>\n\n<p>Here's the relevant code as it exists right now:</p>\n\n<pre><code>public static void CopyFrom&lt;TSource, TDest&gt;(this ObjectSet&lt;TDest&gt; Dest, ObjectSet&lt;TSource&gt; Source, bool SaveChanges, ObjectContext context)\n    where TSource : class\n    where TDest : class {\n\n    int total = Source.Count();\n    int count = 0;\n    foreach (var src in Source) {\n        count++;\n        CopyObject(src, Dest);\n\n        if (SaveChanges &amp;&amp; context != null) {\n            context.SaveChanges();\n            GC.Collect();\n            if (count % 100 == 0) {\n                Thread.Sleep(2000);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I didn't include the CopyObject() function, it just uses reflection to evaluate the properties of src and put them into identically-named properties in a new object to be appended to Dest.</p>\n\n<p>SaveChanges is a Boolean variable passed in saying that this extra processing should be done, it's only true on the big table, false otherwise.</p>\n\n<p>So, my question: How can I modify this code to not run me out of memory?</p>\n"},{"tags":["c#","wcf","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13290146,"title":"async WCF method WebOperationContext is null after await","body":"<p>In the following example, the method is exposed as a WCF service operation and the service is hosted in IIS.\nOn entry into the function the WebOperationContext.Current is set as expected.  After the await has finished waiting, however, the WebOperationContext.Current is set to null.</p>\n\n<pre><code>        public async Task TestAsync()\n    {\n        //WebOperationContext.Current is set\n\n        Task t = new Task(()=&gt;Thread.Sleep(10000));\n\n        t.Start();\n\n        await t;\n\n        //WebOperationContext.Current is null\n    }\n</code></pre>\n\n<p>This would seem to be a shortcoming, so I wondered if anyone was aware of this and if there were any good ways around it.  I realise I could cache a reference to the conext in a local variable, but this doesn't seem great.</p>\n\n<p>Update</p>\n\n<p>One approach that works is </p>\n\n<pre><code>            public async Task TestAsync()\n    {\n        WebOperationContext ctx = WebOperationContext.Current;\n\n        Task t = new Task(()=&gt;Thread.Sleep(10000));\n\n        t.Start();\n\n        await t;\n\n        //ctx is set        \n    }\n</code></pre>\n\n<p>and also, as others have hinted at, I could do this</p>\n\n<pre><code>        public async Task TestAsync()\n    {\n        CallContext.LogicalSetData(\"WebOperationContext.Current\", WebOperationContext.Current);\n\n        Task t = new Task(()=&gt;Thread.Sleep(10000));\n\n        t.Start();\n\n        await t;\n\n        WebOperationContext ctx = (WebOperationContext)CallContext.LogicalGetData(\"WebOperationContext.Current\");\n    }\n</code></pre>\n\n<p>What would be the implications in terms of performance and thread safety of each?</p>\n"},{"tags":["c#","wpf","data-binding","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13276674,"title":"Get property type of dynamic object in C# (even when value is null)","body":"<p>I have a DynamicObject wrapper that is basically forwarding property values from another private object instance (amongst other things). But is there any way of returning the property-type dynamically as well?</p>\n\n<p>The reason I'm asking is because I'm having trouble with bindings in WPF trying to convert the view-value (<strong>string</strong> in my case with a textbox bound to a double property) to a presenter value of type <strong>object</strong> instead of <strong>double</strong> (which it would if the object was not dynamic and the property had a returntype of double).</p>\n\n<p>If there where something like TryGetMemberType it would be great...</p>\n"},{"tags":["c#","entity-framework","linq-to-entities","expression-trees"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13292123,"title":"Filter using Expression Trees","body":"<p>I need to query database and filter based on parameters passed into the function.  I am passing two date parameters (used as a date range), a name, and a status parameters.  All the parameters can have 'and' or 'or' conditions.  Basically, I would like to build an linq expression based on which parameters are populated and pass it to Entity Framework to return a result set.</p>\n\n<p>How can I do this with minimum 'if' statements?  If you could be kind enough to provide an explanation with your example code, that would be awesome.  I am trying to learn expression trees so an explanation would help.</p>\n\n<p>At this point I don't have much code.  That is why I have posted here.  I can list the method signature.  What exactly are you looking for?</p>\n\n<pre><code>public enum EmployeeStatus\n{\n    FullTime,\n    PartTime,\n    Contract\n}\n\npublic IEnumerable&lt;Employee&gt; FilterEmployees(DateTime? startDate, \n    DateTime? endDate, string employeeName, EmployeeStatus employeeStatus)\n{   }\n</code></pre>\n"},{"tags":["c#","exception","datetime","datetime-format"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13292458,"title":"C# DateTime ParseExact exception","body":"<p>I'm having problems with DateTime.ParseExact method which is throwing exceptions that my <strong><em>input string is not in correct format</em></strong>.</p>\n\n<p>Code follows : </p>\n\n<pre><code>class Program\n    {\n        static void Main(string[] args)\n        {\n            var rawDate = \"Thu, 08 nov 2012 15:19:18 0\";\n            var _format = \"ddd, dd MMM yyyy HH:mm:ss K\";\n            var date = DateTime.ParseExact(rawDate, _format, CultureInfo.InvariantCulture);\n        }\n    }\n</code></pre>\n\n<p>I found a few similar threads here on SO with exact date format and nobody reports any problem there. </p>\n\n<p>I followed this as my guide :</p>\n\n<pre><code>ddd = Three letter Day of week\nMMM = Three letter month\ndd = Two digit day of month 01-31  (use \"d\" for 1-31)\nHH = Hours using 24-hour clock. 00-24  (use \"H\" for 0-24)\nmm = Minutes. 00-59\nss = Seconds. 00-59\nK = Time zone information\nyyyy = 4-digit year\n</code></pre>\n\n<p>What can be cause of exceptions?</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["c#","reflection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13290369,"title":"Accessing private fields in the base and child classes using reflection","body":"<p>I have a simple program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\n\nnamespace PlayWithReflection\n{\nclass MyDisposable:IDisposable\n{\n    private  string _name;\n\n    public MyDisposable(string name)\n    {\n        this._name = name;\n    }\n\n    public string Name\n    {\n        get { return _name; }\n    }\n\n    public void Dispose()\n    {\n        Console.WriteLine(_name + \" is disposed\");\n    }\n}\n\nclass MyBaseClass : IDisposable\n{\n    protected MyDisposable _baseProtectedDisposableA = new MyDisposable(\"_baseProtectedDisposableA\");\n    private MyDisposable _baseDisposableB = new MyDisposable(\"_baseDisposableB\");\n\n    public MyDisposable BaseProtectedDisposableA\n    {\n        get { return _baseProtectedDisposableA; }\n    }\n\n    public MyDisposable BaseDisposableB\n    {\n        get { return _baseDisposableB; }\n    }\n\n    public void Dispose()\n    {\n        var fieldInfos = this.GetType().GetFields(BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.FlattenHierarchy);\n\n        foreach (var fieldInfo in fieldInfos)\n        {\n            var value = fieldInfo.GetValue(this);\n            if (value is IDisposable)\n            {\n                ((IDisposable)value).Dispose();\n                fieldInfo.SetValue(this, null);\n            }\n        }\n    }\n}\n\n\nclass MyClass : MyBaseClass\n{\n    private MyDisposable _disposableC = new MyDisposable(\"_disposableC\");\n    private MyDisposable _disposableD = new MyDisposable(\"_disposableD\");\n\n    public MyDisposable DisposableC\n    {\n        get { return _disposableC; }\n    }\n\n    public MyDisposable DisposableD\n    {\n        get { return _disposableD; }\n    }\n}\n\n\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        using(MyBaseClass instance = new MyClass())\n        {\n           Console.WriteLine(instance.BaseProtectedDisposableA.Name + \" is telling his name...\");\n           Console.WriteLine(\"--------------------------------------------------------\");\n        }\n\n        Console.ReadKey();\n    }\n}\n}\n</code></pre>\n\n<p>And it prints something like this:</p>\n\n<pre><code>_baseProtectedDisposableA is telling his name...\n-------------------------------------------------------\n_disposableC is disposed\n_disposableD is disposed\n_baseProtectedDisposableA is disposed\n</code></pre>\n\n<p>The question is how to make it print this one:</p>\n\n<pre><code>_baseProtectedDisposableA is telling his name...\n-------------------------------------------------------\n_disposableC is disposed\n_disposableD is disposed\n_baseProtectedDisposableA is disposed\n_baseDisposableB is disposed\n</code></pre>\n\n<p>Or, in other words, where is my private field _baseDisposableB, and how to make it be disposed?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","query","add-in","document"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13290800,"title":"How to get SQL Command text from Query Document in Visual Studio?","body":"<p>I am building a Visual Studio add-in and what I want to do is get the text of an SQL Command in a Query Document.\nFor example:</p>\n\n<ul>\n<li>A user opens Server Explorer and connects to a database</li>\n<li>He executes a 'New Query' command</li>\n<li>A new Query Document opens (Query visualiser or whatever you want to call it)</li>\n<li>He selects some columns in the Table visualiser panel and a code is generated in a Command  text panel</li>\n</ul>\n\n<p>What I want to do is to be able to get the generated text. I tried using the code suggested as a solution to similar issues, that I've found here, but it doesn't seem to work for me. The code I used is:</p>\n\n<pre><code>TextSelection s = (TextSelection)dte.ActiveDocument.Selection;\nTextDocument d = (TextDocument)dte.ActiveDocument.Object(\"TextDocument\");\n</code></pre>\n\n<p>This does not work because in the first case Selection is always null and in the second one Object is always null. This part of code only works if an open document is a .txt or file. I tried to find a class similar to QueryDocument or Query, but I failed.</p>\n\n<p>Do you have any suggestions? </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":58,"score":-1,"question_id":13290812,"title":"Iterating through a file structure","body":"<p>If I have a directory structure like so on a web service that sends me a list of files and folders in the directory I request. How would you go about iterating through the entire structure. There is no recursive search, so each directory has to be pulled one at a time. I can get the directories content I request but it doesnt list any sub-directories information. I was trying to think of a way to do this with a for loop or for each loop, but I havent been able to come up with anything. I didnt write the web service so I cant include recursive directory searching in it.</p>\n\n<pre><code>Pictures\n    photo1.png\n    photo2.png\n    TestFolder1\n        April.png\n        MyPictures\n             ProfilePic.png\n    TestFolder2\n        2012\n            August\n                Photos\n                    photo3.png\n                    photo4.png\n</code></pre>\n"},{"tags":["c#",".net","string"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":82,"score":5,"question_id":13291339,"title":"Convert string to unicode representation","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1615559/converting-unicode-strings-to-escaped-ascii-string\">Converting Unicode strings to escaped ascii string</a>  </p>\n</blockquote>\n\n\n\n<p>How can I convert <code>ä...</code> into something like  <code>\\u0131...</code> ?</p>\n\n<p>is there any Function for doing this ?</p>\n\n<p>p.s : </p>\n\n<p>beside this way :  [ sorry @Kendall Frey :-)]</p>\n\n<pre><code>char a = 'ä';\nstring escape = \"\\\\u\" + ((int)a).ToString(\"X\").PadLeft(4, '0');\n</code></pre>\n"},{"tags":["c#","windows","asp.net-mvc-2","azure"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":546,"score":2,"question_id":4672885,"title":"Windows Azure - Worker role - detect environment","body":"<p>Anyone know of a way to determine if a worker role is running in the production or staging environment? </p>\n\n<p>My worker role sends out daily email summaries of activities but if I have code in staging the email gets duplicated because I have two workers running. </p>\n\n<p>Thoughts? </p>\n"},{"tags":["c#","winforms","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13292355,"title":"Getting USB info using SetupDiGetDevicePropertyW","body":"<p>I am trying to get the SetupDiGetDevicePropertyW method to work but without success.</p>\n\n<p>The P/Invoke is declared as:</p>\n\n<pre><code>// Device Property\n[StructLayout(LayoutKind.Sequential)]\ninternal struct DEVPROPKEY\n{\n    public Guid fmtid;\n    public UInt32 pid;\n}\n/// &lt;summary&gt;\n/// Provides details about a single USB device.\n/// &lt;/summary&gt;\n[StructLayout(LayoutKind.Sequential, Pack = 1)]\ninternal struct DeviceInterfaceData\n{\n    public int Size;\n    public Guid InterfaceClassGuid;\n    public int Flags;\n    public UIntPtr Reserved;\n}\n\n[DllImport(\"setupapi.dll\", SetLastError = true)]\ninternal static extern bool SetupDiGetDevicePropertyW(\n        IntPtr deviceInfoSet,\n        ref DeviceInterfaceData DeviceInfoData,\n        ref DEVPROPKEY propertyKey,\n        out UInt64 propertyType, // or Uint32 ?\n        IntPtr propertyBuffer, // or byte[]\n        uint propertyBufferSize,\n        out uint requiredSize,\n        UInt32 flags);\n\n/// &lt;summary&gt;\n/// Gets a new key for the bus reported device description.\n/// &lt;/summary&gt;\ninternal static DEVPROPKEY DEVPKEY_Device_BusReportedDeviceDesc\n{\n    get\n    {\n        DEVPROPKEY key = new DEVPROPKEY();\n        key.pid = 4;\n        key.fmtid = new Guid((uint)0x540b947e, (ushort)0x8b40, (ushort)0x45bc, 0xa8, 0xa2, 0x6a, 0x0b, 0x89, 0x4c, 0xbd, 0xa2);\n        return key;\n    }\n}\n</code></pre>\n\n<p>I am calling with:</p>\n\n<pre><code>uint propertyRegDataType = 0;\nuint requiredSize = 0;\nIntPtr buffer = Marshal.AllocHGlobal(1024);\nif (UnsafeNativeMethods.SetupDiGetDevicePropertyW(infoSet, ref deviceInterfaceData, ref devicePropertyKey, out propertyType, buffer, 1024, out requiredSize, 0))\n{\n}\nelse\n{\n    int test = Marshal.GetLastWin32Error(); // returns 87 - invalid parameter\n}\n</code></pre>\n\n<p>infoSet has a value from:</p>\n\n<pre><code>IntPtr infoSet = UnsafeNativeMethods.SetupDiGetClassDevs(ref hidGuid, null, IntPtr.Zero, DIGCF_DEVICEINTERFACE | DIGCF_PRESENT);\n</code></pre>\n\n<p>deviceInterfaceData has values including a GUID for the interface and that comes from:</p>\n\n<pre><code>UnsafeNativeMethods.SetupDiEnumDeviceInterfaces(infoSet, 0, ref hidGuid, (uint)i, ref deviceInterfaceData);\n</code></pre>\n\n<p>hidGuid is from (where result is a Guid object:</p>\n\n<pre><code>UnsafeNativeMethods.HidD_GetHidGuid(out result);\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["c#","asp.net","gridview","scroll"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":789,"score":1,"question_id":7435691,"title":"How can I scroll to specific row in GridView?","body":"<p>I'm currently highlighting the matching row in the gridview, but to view it I have to scroll down. I would like to set the position of the scroll bar such that the matching record is always visible. </p>\n\n<pre><code>protected void MatchGrid_OnRowDataBound(Object sender, GridViewRowEventArgs e)\n{\n\n    if (e.Row.RowType  == DataControlRowType.DataRow)\n    {\n\n        //bool ismatch = (bool)DataBinder.Eval(e.Row.Cells, e.Row.Cells[2].Text =\"Main\");\n        //if (ismatch) e.Row.BackColor = Color.FromName(\"#FAF7DA\"); \n\n        // Highlights the selected row and makes the text bold\n        if (e.Row.Cells[2].Text.ToLower() == txtHouseNumber.Text.ToLower() &amp;&amp; e.Row.Cells[3].Text.ToLower() == txtStreetName.Text.ToLower())\n        {\n            e.Row.Cells[1].Text = \"&lt;b&gt;\" + e.Row.Cells[1].Text + \"&lt;/b&gt;\";\n            e.Row.Cells[2].Text = \"&lt;b&gt;\" + e.Row.Cells[2].Text + \"&lt;/b&gt;\";\n            e.Row.Cells[3].Text = \"&lt;b&gt;\" + e.Row.Cells[3].Text + \"&lt;/b&gt;\";\n            e.Row.BackColor = Color.FromName(\"#FAF7DA\");\n            //This is what I was trying to use \n            GV_NEMOAddresses.SelectedIndex = e.Row.RowIndex;\n        }\n    }\n\n}\n</code></pre>\n\n<p>I would prefer to do this without Javascript if possible.</p>\n"},{"tags":["c#","api"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13292426,"title":"Streamsend API with C#","body":"<p>I cannot seem to get this code to work with Streamsends API. I have been all over the internet and have found very little info pertaining to what I am trying to do. I am trying to upload a file to their server. Can anyone look at this and maybe help me out here? I keep getting a 500 error from Streamsends servers which they say is within the Streamsend application itself. Whats funny is if I take the line near the bottom that is commented out (//request.ContentType = \"multipart/form-data\";) and uncomment it I get a 422 error which is saying invalid data. It seems like there is something wrong with the boundary. I am fairly new to C# and this is the first time I have worked with Streamsends API so any help would be greatly appreciated. \nm_Method = \"POST\"\nm_Action = \"uploads\"</p>\n\n<pre><code>private string StreamSendResponse(string Path, string FileName)\n    {\n        string sReturn = String.Empty;\n        string sLocation = String.Empty;\n\n        string boundary = \"---------------------------\" + DateTime.Now.Ticks.ToString(\"x\");\n        byte[] boundarybytes = Encoding.ASCII.GetBytes(Environment.NewLine + \"--\" + boundary + Environment.NewLine);\n\n        Uri addy = new Uri(m_URI + m_Action);\n\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(addy);\n        request.ContentType = \"multipart/form-data; boundary=\" + boundary;           \n\n        request.Method = m_Method;\n\n        request.KeepAlive = true;\n        request.Headers.Add(\"Authorization\", \"Basic \" + Merv.base64Encode(m_ID + \":\" + m_Key));\n\n        Stream rs = request.GetRequestStream();\n\n        string formdataTemplate = \"Content-Disposition: form-data; name=\\\"{0}\\\"\\r\\n{1}\";\n        NameValueCollection nvc = new NameValueCollection();\n\n        foreach (string key in nvc.Keys)\n        {\n            rs.Write(boundarybytes, 0, boundarybytes.Length);\n            string formitem = string.Format(formdataTemplate, key, nvc[key]);\n            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);\n            rs.Write(formitembytes, 0, formitembytes.Length);\n        }\n\n        rs.Write(boundarybytes, 0, boundarybytes.Length);\n\n        string headerTemplate = \"Content-Disposition: form-data; name=\\\"{0}\\\"; filename=\\\"{1}\\\"\\r\\n Content-Type: application/octet-stream\\r\\n\";\n\n        string header = string.Format(headerTemplate, \"data\", FileName);\n\n        byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);\n        rs.Write(headerbytes, 0, headerbytes.Length);\n\n        FileStream fileStream = new FileStream(Path + FileName, FileMode.Open, FileAccess.Read);\n        byte[] buffer = new byte[4096];\n        int bytesRead = 0;\n        while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)\n        {\n            rs.Write(buffer, 0, bytesRead);\n        }\n        fileStream.Close();\n\n        byte[] trailer = System.Text.Encoding.ASCII.GetBytes(Environment.NewLine + \"--\" + boundary + \"--\" + Environment.NewLine);\n\n        rs.Write(trailer, 0, trailer.Length);\n        rs.Close();\n\n        request.Accept = \"application/xml\";\n        //request.ContentType = \"multipart/form-data\";\n\n        try\n        {\n            HttpWebResponse response = (HttpWebResponse)request.GetResponse();\n            StreamReader srResponse = new StreamReader(response.GetResponseStream());\n            sLocation = response.Headers[\"Location\"];\n            sReturn = srResponse.ReadToEnd().Trim();\n        }\n        catch (WebException exc)\n        {\n\n            StreamReader srResponse = new StreamReader(response.GetResponseStream());\n            sReturn = srResponse.ReadToEnd().Trim();\n            sLocation = exc.Message;\n        }\n        if (sReturn == String.Empty)\n        {\n            sReturn = sLocation;\n        }\n\n        return sReturn;\n    }\n</code></pre>\n"},{"tags":["c#","wpf","workflow-foundation-4","workflowservice"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13199533,"title":"Workflow Service custom tracking participant that talks to a client-side endpoint(s)?","body":"<p>I'm at the investigative stage for Workflow Service and WPF.</p>\n\n<p>Having State Machine WF Service hosted in IIS and one or more WPF clients talking to the WF Service sounds reasonable choice so far.</p>\n\n<p>However, although days of reading and research it isn't clear to me what would be the best strategy for tracking the transfer between states from WPF app.</p>\n\n<p>There're numerous samples of tracking participants but most of them are based on One process scenario. </p>\n\n<p>So I am thinking of a structure as below.</p>\n\n<ol>\n<li>A server-side WCF operation that any client calls to register its client-side endpoint</li>\n<li>A custom tracking participant that goes through all registered client-side endpoints and sends TrackingRecord at it's Track() method.</li>\n</ol>\n\n<p>Advantage of this approach is that it allows real time update of the states without extra layers like ETW. Another advantage is that it allows decoupling of the logic (or maybe model layer) from the presentation layer.</p>\n\n<p>Can anyone share the opinion over the above structure?\nI would also welcome any suggestions for achieving the goal.</p>\n\n<hr>\n\n<p>[EDIT]\nTo make my idea above more detailed and clear, below steps would be a typical usage.</p>\n\n<p>1) (WPF client) contains and opens a WCF endpoint for receiving TrackRecords.</p>\n\n<p>2) (WF Service) opens a WCF operation (or a simple WF instance with a Receive message) that registers client-side address to an internal store.</p>\n\n<p>3) (WF Service) a custom tracking participant is created and added that will send TrackingRecord to the registered clients' endpoints.</p>\n\n<p>4) (client) connects to the above service and hands out client-side endpoint mentioned at step 1 and consequently receives TrackingRecords.</p>\n\n<hr>\n\n<p>[ EDIT 2 ]</p>\n\n<p>To put my goal in simple terms, I'd like to know</p>\n\n<p>1) the most efficient way of tracking the StateMachine's state on a WF Service (IIS) + WPF or any types of client app through TrackingParticipant.</p>\n\n<p>2) if my suggestion can be improved</p>\n\n<p>Meanwhile, I have implemented this and works good so far. I also added MvvM Light framework's messaging feature at the client-side so that it propagate the received message to the models easily.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":13292078,"title":"Refer to a property name by variable","body":"<p>Is there a way to refer to a property name with a variable? </p>\n\n<p>Scenario: Object A have public integer property X an Z, so...</p>\n\n<pre><code>public void setProperty(int index, int value)\n{\n    string property = \"\";\n\n    if (index == 1)\n    {\n        // set the property X with 'value'\n        property = \"X\";\n    }\n    else \n    {\n        // set the property Z with 'value'\n        property = \"Z\";\n    }\n\n    A.{property} = value;\n}\n</code></pre>\n\n<p>This is a silly example so please believe, I have an use for this.</p>\n"},{"tags":["c#","delegates","lambda"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":13292337,"title":"How to Coalesce a Lambda Delegate","body":"<p>I want to do this:</p>\n\n<pre><code>class Foo {\n\n  static Func&lt;string&gt; sRunner;\n\n  Func&lt;string&gt; _runner;\n\n  public Foo(Func&lt;string&gt; runner){\n\n    _runner = runner ?? sRunner ?? () =&gt; \"Hey!\";\n\n  }\n}\n</code></pre>\n\n<p>I get an \"invalid expression\" term on the lambda.  Can that be fixed inline?</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13291866,"title":"how to find entered key code","body":"<p>how to find entered key code in c# .net page load.i want to check whether the entered key is 'ENTER' key or not.i tried something but not working</p>\n\n<pre><code>ConsoleKeyInfo info = Console.ReadKey();\nif (info.Key == ConsoleKey.Enter)\n{\n    Console.WriteLine(\"You pressed enter!\");\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":46,"score":1,"question_id":13292108,"title":"How to launch a JVM from C#","body":"<p>I would like to launch a java application from C# but am unsure of the proper way to do it. I can do it from a bat file:</p>\n\n<pre><code>java -cp \".;other_classes_location\" classname\n</code></pre>\n\n<p>How does this get turned into C#?</p>\n"},{"tags":["c#","sql","sql-server","smo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12704919,"title":"Create a copy of partitioned tables using SMO","body":"<p>I'm trying to use SMO to replicate a copy of a partitioned table:</p>\n\n<pre><code>using (var scope = new TransactionScope()) \n{ \n    var copiedtable = CreateTable(sourcetable);\n\n    createColumns(sourcetable, copiedtable);\n    CreateIndexes(sourcetable, copiedtable);\n    CreateForeignKeys(sourcetable, copiedtable);\n\n    sourcetable.PartitionScheme = sourcetable.PartitionScheme + \"1\";\n\n    scope.Complete();\n    return copiedtable; \n } \n</code></pre>\n\n<p>The copy is created but the partition scheme is ignored, is there a way to align to the partition scheme?  Am I going about things the wrong way?  I receive no error message or exception the code silently creates an unpartitioned copy of the partitioned table.</p>\n\n<p>I want to automate as I have several hundred tables where the partitions are aligned to the wrong schema.</p>\n"},{"tags":["c#","memory","interop"],"answer_count":8,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":864,"score":3,"question_id":3277711,"title":"Running executable from memory","body":"<p>I'm trying to run an executable directly from a byte[] representation of this executable as a resource in C#.</p>\n\n<p>So basically i want to run a byte[] of an PE directly without touching the harddisk.</p>\n\n<p>The code I'm using for this used to work but it doesn't anymore.</p>\n\n<p>The code creates a process with a frozen main thread, changes the whole process data and finally resumes it so it runs the byte[] of the PE. But it seems like the process dies if the thread is resumed, i don't really know whats wrong.</p>\n\n<p>So here is the code in a pastebin because its too long for here i guess...</p>\n\n<p><a href=\"http://pastebin.com/18hfFvHm\" rel=\"nofollow\">http://pastebin.com/18hfFvHm</a></p>\n\n<p>EDIT:</p>\n\n<p><strong>I want to run non-managed code !</strong>\nAny PE File ...</p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13292306,"title":"WPF Listview Item highlight","body":"<p>I have a listview and it binds the customer's informations into the listview. When I write \"Peter\" to the search textbox then it highlights it with red color. But, when I click on the the highlighted item then it gives me that error.</p>\n\n<p><strong>system.windows.documents.run' is not a visual or visual 3d</strong></p>\n\n<p>I can not overcome it..</p>\n\n<pre><code>private void HighlightText(Object itx)\n    {\n\n            if (itx != null)\n            {\n                if (itx is TextBlock)\n                {\n                    Regex regex = new Regex(\"(\" + textBox1.Text + \")\", RegexOptions.IgnoreCase);\n                    TextBlock tb = itx as TextBlock;\n                    if (textBox1.Text.Length == 0)\n                    {\n                        string str = tb.Text;\n                        tb.Inlines.Clear();\n                        tb.Inlines.Add(str);\n                        return;\n                    }\n                    string[] substrings = regex.Split(tb.Text);\n                    tb.Inlines.Clear();\n                    foreach (var item in substrings)\n                    {\n                        if (regex.Match(item).Success)\n                        {\n                            Run runx = new Run(item);\n                            runx.Background = Brushes.LightGray;\n                            tb.Inlines.Add(runx);\n                        }\n                        else\n                        {\n                            tb.Inlines.Add(item);\n                        }\n                    }\n                    return;\n                }\n                else\n                {\n                    for (int i = 0; i &lt; VisualTreeHelper.GetChildrenCount(itx as DependencyObject); i++)\n                    {\n                        HighlightText(VisualTreeHelper.GetChild(itx as DependencyObject, i));\n                    }\n                }\n            }\n\n    }\n</code></pre>\n"},{"tags":["c#",".net","floating-point"],"answer_count":1,"favorite_count":2,"up_vote_count":9,"down_vote_count":2,"view_count":82,"score":7,"question_id":13290758,"title":"Floating point inconsistency between expression and assigned object","body":"<p>This surprised me - the assigned object behaves differently to the expression! I expected both blocks below to give the same results</p>\n\n<pre><code>void Main()\n{\n    Console.WriteLine(0.1f+0.2f);\n    Console.WriteLine((0.1f+0.2f).GetType());\n    Console.WriteLine((0.1f+0.2f)==0.3f);\n\n    Console.WriteLine();\n\n    var x = 0.1f+0.2f;\n    Console.WriteLine(x);\n    Console.WriteLine(x.GetType());\n    Console.WriteLine(x==0.3f);\n}\n</code></pre>\n\n<p>Yet they print</p>\n\n<blockquote>\n  <p>0.3<br>\n   typeof (Single)<br>\n    False  </p>\n  \n  <p>0.3<br>\n   typeof (Single)<br>\n   <strong>True</strong>  </p>\n</blockquote>\n\n<p>(Tested in Linqpad)</p>\n\n<p>What's going on?</p>\n\n<hr>\n\n<p><strong>Edit</strong>: I ran the code in Visual Studio and saw the same results for all combinations of Debug/Release, x86/x64/AnyCPU, Start debugging/Start without debugging.</p>\n"},{"tags":["c#","asp.net","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3478,"score":0,"question_id":5626797,"title":"ASP.NET MVC 3 partial view not found","body":"<p>I have following problem. In my solution I have 2 controllers: Home and Account. Everything works so far. But when I add [Authorize] above HomeController eg</p>\n\n<pre><code>[Authorize]\npublic class HomeController : Controller\n{\n...\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>System.InvalidOperationException: The partial view 'Repository' was not found or no view engine supports the searched locations. The following locations were searched:\n~/Views/Account/Repository.aspx\n~/Views/Account/Repository.ascx\n~/Views/Shared/Repository.aspx\n~/Views/Shared/Repository.ascx\n~/Views/Account/Repository.cshtml\n~/Views/Account/Repository.vbhtml\n~/Views/Shared/Repository.cshtml\n~/Views/Shared/Repository.vbhtml\n</code></pre>\n\n<p>Partial view Repository is inside HomeController so therefore its View is in ~/Views/Home/Repository.cshtml, but it's seacrhed in Shared or Account folders. As I said, if there is no [Authorize] above HomeController class, everything works as expected.</p>\n\n<p>The code where error occurs is in _Layout.cshtml</p>\n\n<pre><code>@Html.Partial(\"Repository\")\n</code></pre>\n\n<p>Thanks for help.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13288153,"title":"Validate fields based on RadioButton (MVC)","body":"<p>I have got some <strong>sign up form</strong> that has 2 otpions</p>\n\n<blockquote>\n  <ol>\n  <li>Personal</li>\n  <li>Company</li>\n  </ol>\n</blockquote>\n\n<p>Some of the fields for them are the same like Password, Username, Email and other are different.</p>\n\n<p>My question is which strategy of the MODEL we should implement in that case?</p>\n\n<p>Have we i.e. use 2 \"TABs\" and 1 button \"SUBMIT\" but in that case we have duplicated UI fields... And I don't understand how  the class MODEL should be in that case and how we have to validate it...</p>\n\n<p>Or...</p>\n\n<p>We need to use 2 buttons \"SUBMIT\" and use somehow 2 MODELS ....</p>\n\n<p>I know we can use if (code is following) but which MODEL we have need for it?</p>\n\n<pre><code>&lt;html&gt;\n...\n  &lt;body&gt; \n    &lt;div&gt;\n\n      &lt;form action=\"/SignUp/Personal\" method=\"post\"&gt;\n        &lt;input type=\"text\" name=\"username\" value=\"\" /&gt;\n        &lt;input type=\"text\" name=\"passowrd\" value=\"\" /&gt;\n        &lt;input type=\"submit\" name=\"signup\" value=\"SUBMIT\" /&gt;\n      &lt;/form&gt;\n\n\n      &lt;form action=\"/SignUp/Company\" method=\"post\"&gt;\n        &lt;input type=\"text\" name=\"username\" value=\"\" /&gt;\n        &lt;input type=\"text\" name=\"passowrd\" value=\"\" /&gt;\n        &lt;input type=\"submit\" name=\"signup\" value=\"SUBMIT\" /&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Well I don't know which approach we can use...</p>\n\n<p>Any clue?</p>\n\n<p>Thank you!!!</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":13291788,"title":"LINQ to find array indexes of a value","body":"<p>Assuming I have the following string array:</p>\n\n<pre><code>string[] str = new string[] {\"max\", \"min\", \"avg\", \"max\", \"avg\", \"min\"}\n</code></pre>\n\n<p>Is it possbile to use LINQ to get a list of indexes that match one string?</p>\n\n<p>As an example, I would like to search for the string \"avg\" and get a list containing </p>\n\n<blockquote>\n  <p>2, 4</p>\n</blockquote>\n\n<p>meaning that \"avg\" can be found at str[2] and str[4].</p>\n"},{"tags":["c#","regex"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":11794144,"title":"Regular expression for valid filename","body":"<p>I already gone through some question in stackoverflow regarding this but nothing helped much in my case.</p>\n\n<p>I want to restrict the user to provide a filename that should contain only alphanumeric characters, -, _, . and space.</p>\n\n<p>I'm not good in regular expressions and so far I came up with this ^[a-zA-Z0-9.-_]$. Can somebody help me?</p>\n"},{"tags":["c#",".net","string","comparison"],"answer_count":1,"favorite_count":1,"up_vote_count":11,"down_vote_count":1,"view_count":165,"score":10,"question_id":13290374,"title":"string partial comparison","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1371813/why-does-string-compare-seem-to-handle-accented-characters-inconsistently\">Why does string.Compare seem to handle accented characters inconsistently?</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following code</p>\n\n<pre><code>var s1 = \"ABzzzzz2\";\nvar s2 = \"äbzzzzz1\";\n\nvar cmp = StringComparison.InvariantCultureIgnoreCase;\n\nConsole.WriteLine(string.Compare(s1, 0, s2, 0, 7, cmp)); //prints -1\nConsole.WriteLine(string.Compare(s1, 0, s2, 0, 8, cmp)); //prints 1\n</code></pre>\n\n<p>How could it be that part of the first string is less than part of the second, while the whole first string is greater than the whole second one?<br>\nI've tested it on x64, .net 2.0, 3.5, 4.0</p>\n"},{"tags":["c#","sockets","networking","asynchronous","stream"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13277617,"title":"Buffering stream of strings from socket","body":"<p>I am working on a C# app that passes around strings between networked instances.</p>\n\n<p>The code is currently using async sockets, and everything works great so far (localhost).</p>\n\n<p>However, I am expecting buffering problems when the packets will be split and merged when I'll be going through real interfaces.</p>\n\n<p>Client:</p>\n\n<pre><code>Socket sock;\n// Snip init and connect\n\nstring msg1 = \"Hello\\nWorld\";\nbyte[] data1 = System.Text.Encoding.UTF8.GetBytes(msg1);\nsock.Send(data1);\n\nstring msg2 = \"Foo\\nBar\\nBaz\";\nbyte[] data2 = System.Text.Encoding.UTF8.GetBytes(msg2);\nsock.Send(data2);\n</code></pre>\n\n<p>I'd go with something like this, but I can't figure out an elegant solution to the missing bit:</p>\n\n<p>Server:</p>\n\n<pre><code>Socket sock;\nMemoryStream ms = new MemoryStream();\nQueue&lt;string&gt; strings = new Queue&lt;string&gt;();\n// Snip init and receive connection\nsock.BeginReceive(buffer, 0, MaxSize, SocketFlags.None, new AsyncCallback(OnReceived), null);\n\nvoid OnReceived(IAsyncResult result) {\n  // Snip sanity stuff\n  int bytesReceived = sock.EndReceive(result);\n\n  // Here is where I'd need some help...\n  ms.Write(buffer, 0, bytesReceived);\n  ms.Flush();\n  for (;;) {\n    StreamReader sr = new StreamReader(ms);\n    if (sr.HasAStringTerminationCharacter) { // &lt;-- How?\n      string currentString = sr.ReadUntilTermination(); // &lt;-- How?\n      strings.Enqueue(currentString);\n    }\n    else\n      break;\n  }\n  sock.BeginReceive(buffer, 0, MaxSize, SocketFlags.None, new AsyncCallback(OnReceived), null);\n}\n</code></pre>\n"},{"tags":["c#","gui","optimization","unity3d"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":40,"score":-3,"question_id":13291815,"title":"How to optimize a code to function and call it through button C#","body":"<p>While doing combo box using buttons I just caught myself on idea, is it possible to make something like: \"wanna more? ok. press and get it :)\" for instance I have combo boxes with a fruits, vegetables, berries. So, I selected fruit, vegetable, berry and I want to repeat the same combo boxes with a list of fruits, vegetables, berries. Probably I may need something like \"Add new fruit, vegetable, berry\". So my question is: Is it possible to do \"Add new fruit, vegetable, berry\", if so please give some feedback :D Regards, Tim</p>\n\n<p>Here is a code an example code:</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\n\npublic class hibye: MonoBehaviour \n{\n\n    public string slectedItem = \"None\";\n    private bool editing = false;\n\n     public string slectedItem2 = \"None\";\n    private bool editing2 = false;\n\n    public string slectedItem3 = \"None\";\n    private bool editing3 = false;\n\n    private void OnGUI()\n    {   \n        if ( GUILayout.Button(slectedItem))\n        {\n            editing = true;\n        }\n\n        if (editing)\n        {\n         string[] sig = {\"Banana\",\"Apple\",\"Orange\"};\n\n            for (int x = 0; x &lt; sig.Length ; x++)\n            {\n                if (GUILayout.Button(sig[x]))\n                {\n                    slectedItem = sig[x];\n                    editing = false;\n\n                }\n            }\n        }\n          if ( GUILayout.Button(slectedItem2))\n        {\n            editing2 = true;\n        }\n\n        if (editing2)\n        {\n         string[] sig = {\"Cabbage\",\"Potato\",\"Paprika\"};\n\n            for (int x = 0; x &lt; sig.Length ; x++)\n            {\n                if (GUILayout.Button(sig[x]))\n                {\n                    slectedItem2 = sig[x];\n                    editing2 = false;\n\n                }\n            }\n        }\n          if ( GUILayout.Button(slectedItem3))\n        {\n            editing3 = true;\n        }\n\n        if (editing3)\n        {\n         string[] sig = {\"Baneberry\",\"Blackberry\",\"Grape\"};\n\n            for (int x = 0; x &lt; sig.Length ; x++)\n            {\n                if (GUILayout.Button(sig[x]))\n                {\n                    slectedItem3 = sig[x];\n                    editing3 = false;\n\n                }\n            }\n        }\n\n    }\n\n}\n</code></pre>\n\n<p>I want to make the code shortest and add another GUILayout.Button which allows me to make choice of existing items one more time without changing existing chosen items.</p>\n"},{"tags":["c#","asp.net","telerik"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13290781,"title":"casting LinkButton Telerik","body":"<p>I have a LinkButton inside of a telerik grid when it is clicked it updates the database. The trouble comes at the first line where I recieve an error that I am unable to cast the radgrid to linkButton. Can someone shed a little light. Here is the Error Msg.</p>\n\n<blockquote>\n  <p>Telerik.Web.UI.RadGrid' to type 'System.Web.UI.WebControls.LinkButton</p>\n</blockquote>\n\n<p>Here is my method:</p>\n\n<pre><code>protected void rad_grdCompleteRequest(object sender, EventArgs e)\n{\n    LinkButton btnCompleteRequest = (LinkButton)sender;\n    int requestID = Convert.ToInt32(btnCompleteRequest.Attributes[\"RequestID\"]);\n    SqlManager.UpdateRequest(requestID, 3);\n    Response.Redirect(Request.RawUrl);\n}\n</code></pre>\n"},{"tags":["c#",".net","wpf","task-parallel-library","task"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":66,"score":2,"question_id":13285652,"title":".Continue starts before task is completed","body":"<p>I have the following code in C#, VS2012, WPF 4.5.\nMy expectation would be that, <code>.ContinueWith</code> will be executed after the task has finished completely (that's a continuation's whole purpose, isn't it?). </p>\n\n<p>This should result in a value of 2 in <code>finalResult</code>.</p>\n\n<pre><code>        int myTestInt = 0;\n\n        Task task = Task.Factory.StartNew(async () =&gt;\n        {\n            myTestInt = 1;\n\n            await Task.Delay(TimeSpan.FromSeconds(6));\n\n            myTestInt = 2;\n\n        }).ContinueWith(_ =&gt;\n        {\n            int finalResult = myTestInt;\n        });\n</code></pre>\n\n<p>In fact, <code>finalResult</code> is assigned a value of 1 instead. So it seems like the continuation is started on the <code>await</code> statement already.</p>\n\n<p>Is this the intended behaviour? Am I missing something here? Can't I rely on <code>ContinueWith</code>to start after a task has completely finished?</p>\n\n<p>Update:</p>\n\n<p>Justin's answer just inspired me to check the following:</p>\n\n<pre><code>        int myTestInt = 0;\n        Task task=Task.Factory.StartNew(async () =&gt;\n        {\n            myTestInt = 1;\n            await Task.Delay(TimeSpan.FromSeconds(6));\n            myTestInt = 2;\n        });\n        task.Wait();\n        int result2 = myTestInt;\n</code></pre>\n\n<p>finalResult is still set to 1. Is there no way to reliably wait for a task that contains <code>await</code>s to complete?</p>\n"},{"tags":["c#","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":7,"view_count":30,"score":-6,"question_id":13292012,"title":"Windows form app - connect to database","body":"<p>Relatively new to Visual Studio. Trying to a create a simple stenography application using windows forms. When one creates a windows form application can it turned into a actual executable which i presume would on any machine with .net? I want to create a database to connect with this app. What databases could connect or be used integrated with a forms app? Sql server? </p>\n"},{"tags":["c#","internet-explorer-9","watin"],"answer_count":2,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":2372,"score":7,"question_id":7500339,"title":"How to test file download with Watin / IE9?","body":"<p>I'm trying to test file download with Watin 2.1.0 against IE9. I used the suggested code from the accepted answer to the question <a href=\"http://stackoverflow.com/questions/6125285/downloading-a-file-with-watin-in-ie9\">Downloading a file with Watin in IE9</a>, like this:</p>\n\n<pre><code>var downloadHandler = new FileDownloadHandler(fname);\nWebBrowser.Current.AddDialogHandler(downloadHandler);\nlink.ClickNoWait();\ndownloadHandler.WaitUntilFileDownloadDialogIsHandled(15);\ndownloadHandler.WaitUntilDownloadCompleted(200);\n</code></pre>\n\n<p>However, the <code>downloadHandler.WaitUntilFileDownloadDialogIsHandled(15)</code> call times out. What should I do?</p>\n"},{"tags":["c#","unicode-string"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13277958,"title":"Unicode string in C#","body":"<p>I remember using unicode string in C++ such as this: </p>\n\n<pre><code>std::wstring str = _T(\"a string here\");\n</code></pre>\n\n<p>I wonder what is the equivalent in C#?</p>\n\n<p>-- update --\nThank you guys!</p>\n"},{"tags":["c#","asp.net","mysql","sync","windowservice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13291654,"title":"Is this the only and good way to sync data between 2 databases programmatically","body":"<p>I have 2 same databases.One in production and another in local.I'm trying to write c# windows service to sync data from time to time from production to local database.\nHere is a code snippet from my data sync service</p>\n\n<pre><code> private static bool StartDataSync(string tableName, string connectionStringLive, string connectionStringLocal,string databaseName)\n    {\n        bool status = false;\n\n        DataSet dsResult = new DataSet();\n\n        Int64 maxId = 0;\n        MySqlConnection conLocal = new MySqlConnection(connectionStringLocal);\n        MySqlCommand cmdLocal = new MySqlCommand(\"pr_GetMaxIdFromTable\", conLocal);\n        cmdLocal.CommandType = CommandType.StoredProcedure;\n        MySqlParameter[] parameters = new MySqlParameter[4];\n        parameters[0] = new MySqlParameter(\"vTableName\", tableName);\n        parameters[0].Direction = ParameterDirection.Input;\n        parameters[1] = new MySqlParameter(\"vMaxId\", MySqlType.BigInt);\n        parameters[1].Direction = ParameterDirection.Output;\n        parameters[2] = new MySqlParameter(\"vExist\", \"0\");\n        parameters[2].Direction = ParameterDirection.InputOutput;\n        parameters[3] = new MySqlParameter(\"vDatabaseName\", databaseName);\n        parameters[3].Direction = ParameterDirection.Input;\n\n        foreach (MySqlParameter param in parameters)\n        {\n            cmdLocal.Parameters.Add(param);\n        }\n\n        conLocal.Open();\n        cmdLocal.ExecuteNonQuery();\n        int ifExist = 0;\n        ifExist = Convert.ToInt32(parameters[2].Value);\n        if (ifExist == 1)\n        {\n\n            maxId = Convert.ToInt64(parameters[1].Value);\n\n            MySqlConnection conLive = new MySqlConnection(connectionStringLive);\n            MySqlCommand cmdLive = new MySqlCommand(\"Select * from \" + tableName + \" where Id&gt;\" + maxId, conLive);\n\n            MySqlDataAdapter adp = new MySqlDataAdapter(cmdLive);\n            adp.Fill(dsResult);\n\n\n\n            MySqlCommand cmdLocalInsert = null;\n            string insertValues = string.Empty;\n            foreach (DataRow dr in dsResult.Tables[0].Rows)\n            {\n                insertValues = string.Empty;\n                foreach (DataColumn dc in dsResult.Tables[0].Columns)\n                {\n                    insertValues = insertValues + Convert.ToString(dr[dc]) + \",\";\n                }\n                insertValues = insertValues.Substring(0, insertValues.Length - 1);\n                cmdLocalInsert = new MySqlCommand(\"Insert into \" + tableName + \" Values(\" + insertValues + \")\", conLocal);\n                if (conLocal.State != ConnectionState.Open)\n                {\n                    conLocal.Open();\n                }\n                cmdLocalInsert.ExecuteNonQuery();\n            }\n        }\n\n        return status;\n    }\n</code></pre>\n\n<p>I dont know if this is the only way of doing this or if this may cause any other issues in future.If any one can suggest any other method of doing this, it will be most appreciated.</p>\n"},{"tags":["c#","reflection"],"answer_count":6,"favorite_count":15,"up_vote_count":60,"down_vote_count":0,"view_count":50153,"score":60,"question_id":1196991,"title":"Get property value from string using reflection in C#","body":"<p>I am trying implement the <a href=\"http://msmvps.com/blogs/shahed/archive/2008/07/24/c-reflection-tips-data-transformation-using-reflection.aspx\" rel=\"nofollow\">Data transformation using Reflection</a> example in my code.</p>\n\n<p>The <code>GetSourceValue</code> function has a switch comparing various types, but I want to remove these types and properties and have <code>GetSourceValue</code> get the value of the property using only a single string as the parameter. I want to pass a class and property in the string and resolve the value of the property.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":189,"score":1,"question_id":3115020,"title":"Events being sent to disabled control","body":"<p>I have a problem that I'd like some advice on. I have a button in my GUI that starts a complicated setup sequence (to connect to a analogue to digital converter and start logging data from an echo sounder). Once it is finished setting up, the button changes from START to STOP and has the expected behaviour. What I was experiencing is that during the long operation, if the user clicked on the button again (even though it was disabled) the event would still be sent to the button once it was reenabled. The only way I've found to make this work properly is to call Application.DoEvents() before enabling the button again. All I really want to do is swallow up the events destined for my button, so DoEvents() seems a bit heavy handed. Since people seem to be unanimously against calling DoEvents() I'm hoping that the bright minds here can help me come up with an alternative solution. Note I haven't tried my demo code but it follows my real code closely, excepting the really long methods.</p>\n\n<ol>\n<li>Is there an alternative way to accomplish this?</li>\n<li><p>Is it safe(ish) to call DoEvents() from the completion portion of the background worker?</p>\n\n<p>public class Form1 : Form\n{</p>\n\n<pre><code>BackgroundWorker worker;\nButton startButton;\nbool state;\n\n\npublic Form1() {\n    state = false;\n    BackgroundWorker worker = new BackgroundWorker();\n    worker.DoWork += new DoWorkEventHandler(StartSequence);\n    worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(ToggleButton);\n    startButton = new Button();\n    startButton.Text = \"START\";\n    startButton.Click += new System.EventHandler(StartClicked);\n    this.Controls.Add(startButton);\n}\n\n\nprivate void StartClicked( object sender, EventArgs e ) {\n    startButton.Enabled = false;\n    worker.RunWorkerAsync( !state );\n}\n\n\nprivate void StartSequence( object sender, DoWorkEventArgs e ) {\n    bool onState = (bool) e.Argument;\n    if ( onState ) {\n        RunReallyLongStartupSequence();\n    }\n    else {\n        RunReallyLongStopSequence();\n    }\n    state = onState;\n}\n\n\nprivate void ToggleButton( object sender, RunWorkerCompletedEventArgs e ) {\n    startButton.Text = state ? \"STOP\" : \"START\";\n\n\n<pre><code>// THIS IS WHAT I AM WORRIED ABOUT!\nApplication.DoEvents();\nstartButton.Enabled = true;\n</code></pre>\n\n}\n</code></pre>\n\n<p>}</p></li>\n</ol>\n"},{"tags":["c#","asp.net","redirect"],"answer_count":5,"favorite_count":4,"up_vote_count":18,"down_vote_count":0,"view_count":53359,"score":18,"question_id":1093081,"title":"aspx page to redirect to a new page","body":"<p>What is the code required to redirect the browser to a new page with an ASPX page?</p>\n\n<p>I have tried this on my page default.aspx :</p>\n\n<pre><code>&lt;% Response.Redirect(\"new.aspx\", true); %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%@ Response.Redirect(\"new.aspx\", true); %&gt;\n</code></pre>\n\n<p>And these resulted in a server error that is undetermined. I cannot see the error code; because the server is not in my control and the errors are not public.</p>\n\n<p>Please provide all necessary code from line 1 of the page to the end, and I would really appreciate it.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13291657,"title":"The type or namespace name 'Helper' does not exist in the namespace 'Google.Apis.Samples","body":"<p>I have added namespace <code>using Google.Apis.Samples.Helper;</code> but after running code I am getting below error which dll I have to add?</p>\n\n<blockquote>\n  <blockquote>\n    <p>The type or namespace name 'Helper' does not exist in the namespace 'Google.Apis.Samples</p>\n  </blockquote>\n</blockquote>\n"},{"tags":["c#","report-viewer2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":266,"score":0,"question_id":7474266,"title":"Flushing newest parameters from ReportViewer control to the ServerReport from code","body":"<p>After a user edits report parameters, at some point I try to access new parameters with </p>\n\n<pre><code>_reportViewer.ServerReport.GetParameters()\n</code></pre>\n\n<p>Since that gives only the parameters user has submitted to the server with  click on the View Report button, I'm looking to:</p>\n\n<p>a) Simulate click on a View Button from code or</p>\n\n<p>b) Get those parameters in some other way, preferably one that doesn't involve reflection.</p>\n\n<p>How could I \"flush\" the current parameters from the automatically generated report control from code?</p>\n"},{"tags":["c#","database","visual-studio-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13291904,"title":"Create a View in Visual Studio C#","body":"<p>I'm converting a program I prototyped in Visual Basic into C# in Visual Studio 2010, and I'm having trouble with the Database. Specifically, I can't create a View. There's no folder for Views in the Server Explorer, and I can't save a Query. Is there a way to save a View that I'm not seeing? Or is there a different thing to do the stuff a View does?</p>\n"},{"tags":["c#","ninject","moq","ninject-extensions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13286799,"title":"MoqMockingKernel: System.TypeLoadException: Inheritance security rules violated by type","body":"<p>I try to use the MoqMockingKernel class. (Ninject.MockingKernel.Moq) from the Ninject.MockingKernel Extension for a unit test.</p>\n\n<p>At initializing the MoqMockingKernel I'm getting the following error:</p>\n\n<blockquote>\n  <p>System.TypeLoadException: System.TypeLoadException: Inheritance\n  security rules violated by type:\n  'Ninject.MockingKernel.MockingKernel'. Derived types must either match\n  the security accessibility of the base type or be less accessible..</p>\n</blockquote>\n\n<p>My initializing code:</p>\n\n<pre><code>        private MoqMockingKernel mockingKernel;\n        private Mock&lt;IUnitOfWork&gt; unitOfWorkMock;\n        private IExternalServiceRepository externalServiceRepository;\n\n        [TestInitialize]\n        public void Initialize()\n        {\n            this.mockingKernel = new MoqMockingKernel();\n            this.mockingKernel.Bind&lt;IUnitOfWork&gt;().ToMock();\n\n            this.unitOfWorkMock = this.mockingKernel.GetMock&lt;IUnitOfWork&gt;();\n\n            externalServiceRepository = new ExternalServiceRepository { Kernel = this.mockingKernel };\n        }\n</code></pre>\n\n<p>How can I solve this <code>TypeLoadException</code>?</p>\n"},{"tags":["c#",".net","unit-conversion"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":1281,"score":0,"question_id":6027673,"title":".NET units class, inches to millimeters","body":"<p>Does .NET has Units conversion class? I need to convert inches to millimeters and vise versa. </p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13289829,"title":"Using Reflection to use a namespace on certain OSs","body":"<p>I'm creating a program that uses the CodeProject CoreAudioApi (pretty popular framework for manipulating audio), but the problem is the CoreAudioApi uses system calls that aren't available in any versions of Windows earlier than Vista.  If I run a program with CoreAudioApi compiled with it (using a <code>using</code> statement as normal), the program will crash on anything earlier than Vista.</p>\n\n<p>I've created this function to get the version number of the current environment:</p>\n\n<pre><code>win_version = Environment.OSVersion.Version.Major;\n</code></pre>\n\n<p>That returns the major version number I need.  '6' is Vista/7, anything else is not, which is all I need to determine.  Utilizing this, I need to determine whether or not to include the CoreAudioApi namespace if the OS is over or equal to '6'.  From research, <code>using</code>s need to be compiled with the program, but I've also read about something called Reflection - which might be what I need.</p>\n\n<p>Once I get the CoreAudioApi namespace <code>using</code>'d (sorry for the lack of terminology), the rest is easy.  How can I do this?</p>\n\n<p><strong>TL;DR</strong>\nI need some form of code that would effectively do this:</p>\n\n<pre><code>using System;\nusing System.Text;\n//etc\nif(currentWindowsVersion&gt;=6) using CoreAudioApi;\n</code></pre>\n\n<p>Except control structures won't work outside of a class, and all namespaces are compiled with the program, not controlled individually.</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> So far, I'm using this to load the CoreAudioApi namespace as a compiled assembly:</p>\n\n<pre><code>if(win_version&gt;=6){\n    CoreAudioApi = Assembly.LoadFrom(\"CoreAudio.dll\");\n    CoreAudioApi.GetLoadedModules();\n    CoreAudioApi.GetTypes();\n    MessageBox.Show(\"Loaded CoreAudioApi\");\n}\n</code></pre>\n\n<p>From here, what I need to do is actually use the types, and methods from the API.  My code that works on Windows Vista/7 is this:</p>\n\n<pre><code>public static MMDeviceEnumerator devEnum;\npublic static MMDevice defaultDevice;\n//later in a mute method:\ndefaultDevice.AudioEndpointVolume.Mute = true/false;\n</code></pre>\n\n<p>I don't even really need devEnum AFAIK, so really the only important lines are the last two (besides the comment).</p>\n"},{"tags":["c#",".net","validation","requiredfieldvalidator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13291363,"title":"How can I check which RequiredFieldValidator fail?","body":"<p>Code :</p>\n\n<pre><code>Page.Validate();\nif (!Page.IsValid)\n{\n    Page.RegisterStartupScript(\"ko\", \"&lt;script&gt;alert('Failed');&lt;/script&gt;\");\n    return;\n}\n</code></pre>\n\n<p>on this controls, some validator fails! How can I check which one? Thank you!</p>\n"},{"tags":["c#","algorithm","line","gradient","pixel"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":370,"score":4,"question_id":4381269,"title":"Line rasterisation: Cover all pixels, regardless of line gradient?","body":"<p>Basically, I want to use a line algo to determine which cells to check for collisions for my raycaster.</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm\" rel=\"nofollow\">Bresenham</a> isn't great for this as it uses a unified-thickness approach, meaning that it ignores cells that aren't at least half-covering the line. Not great at all, because it means that some segments of my line aren't being checked for intersections with the cells, leading to errors.</p>\n\n<p>I can't seem to find any thick-line algorithms, can anyone help me find one?</p>\n\n<p><img src=\"http://i.stack.imgur.com/VRM4v.png\" alt=\"Red: Bad. Green: Good!\">\n<br>\nGreen: What I would like.<br>\nRed: What I currently have and don't want.</p>\n"},{"tags":["c#",".net"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":695,"score":3,"question_id":2357795,"title":"Distance (feet, inches) class or struct","body":"<p>Does anyone know of any examples or code that shows a class or struct that can be used for distance like the DateTime struct? I need to be able to add, subtract, and display the data in feet and inches and using conversion methods just gets messy. A class or struct would be perfect, but I came across nothing in my searches.</p>\n"},{"tags":["c#","sorting","objectlistview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":9,"score":-1,"question_id":13291779,"title":"ObjectListView - Custom sorting on ModelObject level using an IComparer<>","body":"<p>I am a great fan of the open source ListView replacement <a href=\"http://objectlistview.sourceforge.net/cs/index.html\" rel=\"nofollow\" title=\"ObjectListView homepage\">ObjectListView</a> (OLV), but i always struggled around as soon as i needed to perform some advanced sorting.</p>\n\n<p>The problem is, that the OLV only allows to add a custom sorter based on the underlying ListViewItems instead performing comparisons on the actual ModelObjects of each row.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>MyOlv.CustomSorter = delegate(OLVColumn column, SortOrder order) {\n    if (column == BirthdayColumn) {\n        MyOlv.ListViewItemSorter = new SimpleComparer();\n    }\n};          \n\nclass SimpleComparer : IComparer {\n    public int Compare(object x, object y) {\n        // struggling around with ListViewItems and string conversions...\n    }\n}\n</code></pre>\n\n<p>I ended up writing a small helper class ObjectListViewModelComparer&lt;> that allows you to easily use a generic IComparer&lt;> to directly access and compare properties of your ModelObjects. See \"answer\" below.</p>\n"},{"tags":["c#","unit-testing","mocking","moq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13291760,"title":"moq: When using Setup(), how is equality of method parameters determined?","body":"<p>I'm using the <code>Setup()</code> method to set up the behaviour of a mocked instance of an interface.</p>\n\n<p>The method I'm setting up (let's call it <code>DoSomething()</code>) accepts an instance of a class (let's call the class <code>Foo</code>).</p>\n\n<pre><code>Foo foo = // Existing foo instance\nMock&lt;IMyInterface&gt; mock = new Mock&lt;IMyInterface&gt;();\nmock.Setup(x =&gt; x.DoSomething(foo)).Returns(1);\n</code></pre>\n\n<p>The problem I'm having is that when I use the mock, it never matches the setup, so never returns 1. I have overridden <code>Equals()</code> and <code>GetHashCode()</code> for <code>Foo</code>.</p>\n\n<p>Can anyone help? How does Moq determine whether the parameters provided to a set up method are equal or not?</p>\n"},{"tags":["c#","javascript","json"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2478,"score":4,"question_id":1291076,"title":"How do I convert a c# two-dimensional array to a JSON object?","body":"<p>If I have a two-dimensional array in C# - how can I convert it into a JSON string that contains a two dimensional array?</p>\n\n<p>eg.</p>\n\n<pre><code>int[,] numbers = new int[8,4];\nJavaScriptSerializer js = new JavaScriptSerializer();\nstring json = js.Serialize(numbers);\n</code></pre>\n\n<p>gives a flat one-dimensional array in a JSON object. The Microsoft documentation states:</p>\n\n<p><em>'A multidimensional array is serialized as a one-dimensional array, and you should use it as a flat array.'</em></p>\n"},{"tags":["c#","c#-4.0","ravendb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":7588349,"title":"Can I host RavenDB inside my self-contained process?","body":"<p>Is it possible to host RavenDB from within my own process? I do not want to use a separate IIS site or run a separate server .exe.</p>\n\n<p>Looking for something pseudo-code like <code>RavenDB.Server.Start(8080)</code> (8080 being the port).</p>\n"},{"tags":["c#","asp.net","module","dotnetnuke"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13288964,"title":"Get reference of all modules in a page from a module DNN","body":"<p>Is it possible to get the references of all the modules on the current page from a module?\nLike for example on a button click I could for example list all the Types of the DNN modules loaded on the page without hitting the database.</p>\n"},{"tags":["c#","asp.net-mvc-3","telerik-grid"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13291568,"title":"CheckBox in Telerik Grid","body":"<p><strong>The Objective:</strong></p>\n\n<p>Insert a CheckBox for each row of a Telerik Grid and when the user press submit recive all checkbox changes to the Controller.</p>\n\n<p>I'm using C# ASP.net MVC3</p>\n\n<p><strong>The Question:</strong> </p>\n\n<ul>\n<li>I was looking on-line tutorials and Telerik help but they allways use javascript to send the ID of the selected Items, I'm not sure if it's possible to bind directly to the model and save checkbox changes automathically to avoid javascript. </li>\n</ul>\n\n<p><strong>The code:</strong></p>\n\n<pre><code>@(Html.Telerik().Grid&lt;Article&gt;()\n.Name(\"ArticleGrid\")\n.DataKeys(keys =&gt;\n{\n    keys.Add(article =&gt; article.Code);\n})\n.Columns(columns =&gt;\n{\n    columns.Bound(c =&gt; c.Code);\n    columns.Bound(c =&gt; c.Description)\n    columns.Bound(article =&gt; article.Selected).Width(\"35px\")\n            .ClientTemplate(\"&lt;input type='checkbox' value='&lt;#= Code #&gt;' id='IsSelected&lt;#= Code #&gt;' /&gt;\")\n            .Title(\"\")\n            .HtmlAttributes(new { style = \"text-align:center\" });\n})\n.DataBinding(dataBinding =&gt; dataBinding.Ajax().Select( \"_SelectArticlesAjax\", Controllers.Valoration})\n)\n)\n</code></pre>\n"},{"tags":["c#","wcf","web-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13291564,"title":"WCF Service Authentication Issue","body":"<p>I have following architecture. I have secured service which can be access from specific Ip so on that server we created one more public service and when we try to call public service inside server it is accessible but it is not accessible from public application. It give authentication failed issue when calling from public application while both are same application.</p>\n\n<p>Any idea what possible authentication setting need to be change on public service?</p>\n\n<p>Note: Public service hosted on IIS connected as Administrator.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GkW6K.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","tree"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":44,"score":-1,"question_id":13291563,"title":"Creating Attack tree in C#","body":"<p>I am new at c# and attack trees creation.I am developing the tree structure.</p>\n\n<p>I want to know how to show evaluated result of a function in UI.\nHow to model fuctions in UI (class diagram)\nHow to put in database.</p>\n\n<p>any link will also be helpful.\nThanks</p>\n"},{"tags":["c#",".net","generic-constraints"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13286861,"title":"Where constraint for simple types and string","body":"<p>I have a generic method that I would like to put a constraint on.</p>\n\n<pre><code>public T MyMethod&lt;T&gt;(object obj) where T : ???\n</code></pre>\n\n<p>The constraint is all simple types int, bool etc but I also need to allow string. I there a way of constraining this group?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13291428,"title":"Initialized readonly field is null, why?","body":"<p>Can anyone please explain, why \"private readonly Int32[] _array = new[] {8, 7, 5};\" can be null?</p>\n\n<p>In this example, it works, and _array is always not null. But in my corporate code I have a simliar code and _array is always null. So I forced to declared it as static.</p>\n\n<p>The Class is a partial Proxy Class from my WCF Contract.</p>\n\n<pre><code>using System;\nusing System.ComponentModel;\n\nnamespace NullProblem\n{\n    internal class Program\n    {\n        private static void Main(string[] args)\n        {\n            var myClass = new MyClass();\n\n            // Null Exception in coperate code\n            int first = myClass.First;\n            // Works\n            int firstStatic = myClass.FirstStatic;\n        }\n    }\n\n    // My partial implemantation\n    public partial class MyClass\n    {\n        private readonly Int32[] _array = new[] {8, 7, 5};\n        private static readonly Int32[] _arrayStatic = new[] {8, 7, 5};\n\n        public int First\n        {\n            get { return _array[0]; }\n        }\n\n        public int FirstStatic\n        {\n            get { return _arrayStatic[0]; }\n        }\n    }\n\n    // from WebService Reference.cs\n    public partial class MyClass : INotifyPropertyChanged \n    {\n        // a lot of Stuff\n\n        #region Implementation of INotifyPropertyChanged\n\n        public event PropertyChangedEventHandler PropertyChanged;\n\n        #endregion\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","php","javascript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13288983,"title":"parseInt javascript funtion","body":"<p>I am having a javascript (.js) file which is used in a PHP project &amp; ASP.Net c# project. </p>\n\n<p>I have some statements in javascript like</p>\n\n<pre><code> var width = data[i].Width - data[i].X;\n</code></pre>\n\n<p>This line works as-it-is in my c# project. But in my PHP project, it has to be written as</p>\n\n<pre><code> var width = parseInt(data[i].Width) - parseInt(data[i].X];\n</code></pre>\n\n<p>Please note that data object is returned as JSON result in both projects. </p>\n\n<p>Does anyone know why?</p>\n"},{"tags":["c#","windows-phone-7","xaml","wpf-usercontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13276352,"title":"How do I set up a two-way binding to ancestor properties in a UserControl in Windows Phone 7?","body":"<p>Here is the XAML for my user control:</p>\n\n<pre><code>&lt;UserControl x:Name=\"titledTextBox\" x:Class=\"VitalStats.View.Controls.TitledTextBox\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    mc:Ignorable=\"d\"\n    FontFamily=\"{StaticResource PhoneFontFamilyNormal}\"\n    FontSize=\"{StaticResource PhoneFontSizeNormal}\"\n    Foreground=\"{StaticResource PhoneForegroundBrush}\"\n    d:DesignHeight=\"480\" d:DesignWidth=\"480\"\n    &gt;\n\n    &lt;Grid x:Name=\"LayoutRoot\"&gt;\n        &lt;StackPanel Orientation=\"Vertical\"&gt;\n            &lt;TextBlock x:Name=\"titleTextBlock\" \n                       TextWrapping=\"Wrap\" \n                       Margin=\"12,5,0,-5\" \n                       Text=\"{Binding Title, ElementName=titledTextBox, FallbackValue=Title Here}\" \n                       FontSize=\"20\" \n                       Foreground=\"{StaticResource PhoneSubtleBrush}\"/&gt;\n            &lt;TextBox x:Name=\"inputTextBox\" Text=\"{Binding Text, ElementName=titledTextBox, Mode=TwoWay}\"/&gt;   \n        &lt;/StackPanel&gt;\n    &lt;/Grid&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>and this is what my code-behind looks like,</p>\n\n<pre><code>// Usings here\n\nnamespace VitalStats.View.Controls\n{\n    public partial class TitledTextBox : UserControl\n    {\n\n        [Description(\"A TextBox with built in title\")]\n        public TitledTextBox()\n        {\n            InitializeComponent();\n\n            if (DesignerProperties.GetIsInDesignMode(this)  )\n            {\n                this.Title = \"Title Here\";  \n            }\n        }\n\n        public string Title\n        {\n            get { return this.GetValue(TitleProperty) as string; }\n            set { this.SetValue(TitleProperty, value); }\n        }\n        public static readonly DependencyProperty TitleProperty =\n            DependencyProperty.Register(\"Title\", typeof(string), typeof(TitledTextBox), null);\n\n        public string Text\n        {\n            get { return this.GetValue(TextProperty) as string; }\n            set { this.SetValue(TextProperty, value); }\n        }\n        public static readonly DependencyProperty TextProperty = \n            DependencyProperty.Register(\"Text\", typeof(string), typeof(TitledTextBox), null);\n\n    }\n}\n</code></pre>\n\n<p>The binding work when reading data into the UI (so the <code>Title</code> property works OK) however \nwhen reading from th UI (i.e. trying to access <code>Text</code> from the code) the property is always null implying that the binding is only one-way (despite the <code>Mode=TwoWay</code> property).</p>\n\n<p>I am aware (thanks to XamlZealot's answer) of the <code>FindAncestor</code> binding, however <code>AncestorType</code> does not exist in Windows Phone 7 (or Silverlight) XAML namespace.</p>\n\n<p>How then do I set up a two-way binding to a <code>UserControl</code> property from within the <code>UserControl</code>?</p>\n\n<p>This is on Windows Phone 7 (7.1 project).</p>\n"},{"tags":["c#","linq-to-entities"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":28,"score":3,"question_id":13291471,"title":"How to setup EF Trace on an Entities ObjectContext without passing in the connection name","body":"<p>I'm writing a reusable base repository class where the developer will pass in a generic representing the ObjectContext and the base repository will create an instance of it with Activator.CreateInstance. When debuging I want to make use of the nuget package CommunityEFProviderWrappers.EFTracingProvider. So my code to setup the object context looks like this:</p>\n\n<pre><code>    public void RenewDataContext()\n    {\n#if DEBUG\n        try\n        {\n            // get the default container name\n            if (string.IsNullOrEmpty(_defaultContainerName))\n            {\n                _defaultContainerName = Activator.CreateInstance&lt;T&gt;().DefaultContainerName;\n            }\n\n            // create an instance of the object context using EF Trace\n            Context = (T)Activator.CreateInstance(typeof(T), EFTracingProviderUtils.CreateTracedEntityConnection(_defaultContainerName));\n            Context.EnableTracing();\n        }\n        catch (Exception e)\n        {\n            var a = e.Message;\n        }\n#else\n        Context = Activator.CreateInstance&lt;T&gt;();\n#endif\n    }\n</code></pre>\n\n<p>The problem is that this always throws the following error when it tries to create an instance of the ObjectContext with the EFTracingProvider: <em>\"Schema specified is not valid. Errors: \\r\\n(0,0) : error 0175: The specified store provider cannot be found in the configuration, or is not valid.\"</em></p>\n\n<p>If I replace _defaultContainerName with the name of the connection string in the web config and don't do the first <em>Activator.CreateInstance()</em> then it works fine. So the issue has something to do with the fact that I create the first instance and then the second.</p>\n\n<p>Here is what I have tried:</p>\n\n<ol>\n<li>dispose and null out the first instance. </li>\n<li>close the connection on the first instance. </li>\n<li>put the first instance in a <em>using</em> statement.</li>\n<li>explicitly define the assembly containing the ObjectContext in the\nconnection string in the web.config in the startup project\n(http://stackoverflow.com/questions/1074337/metadataexception-when-using-entity-framework-entity-connection)</li>\n</ol>\n\n<p>I am trying to avoid having the developer pass in the generic type of the ObjectContext AND the name of the connection string. That seems kind of redundant.</p>\n\n<p>So my question is: <strong>How do I get the connection name from the generic representing the object context and still be able to use it to create an instance of the object context using the EntityConnection generated by EF Trace?</strong></p>\n"},{"tags":["c#","asp.net","iis"],"answer_count":7,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":11285,"score":8,"question_id":7355252,"title":"How to solve error message: \"Failed to map the path '/'.\"","body":"<p>I've searched and searched on Google, and I can't find anything that even seems applicable to my situation, let alone solves the problem.  It doesn't matter which address in my website I try to navigate to (even addresses that don't exist give this error instead of a 404), I get the exact same message (the path is always '/').  Any ideas?</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Server Error in '/' Application.\n\nFailed to map the path '/'.\n\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.InvalidOperationException: Failed to map the path '/'.\n\nSource Error: \n\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.\n\nStack Trace: \n\n\n[InvalidOperationException: Failed to map the path '/'.]\n   System.Web.HttpRuntime.HostingInit(HostingEnvironmentFlags hostingFlags, PolicyLevel policyLevel, Exception appDomainCreationException) +336\n\n[HttpException (0x80004005): Failed to map the path '/'.]\n   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11556592\n   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +141\n   System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +4813333\n\nVersion Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.225\n</code></pre>\n\n<p><strong>UPDATE:</strong> I went back to the site a few minutes after posting this--made no changes to code or configuration--and the error went away.  I'm really baffled, but it is no longer a problem.  Not sure what should be done with this question.</p>\n"},{"tags":["c#","jquery","asp.net-mvc","razor","jqgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13157408,"title":"jqgrid scroll is not working when grouping is enable","body":"<p>I am working in \"jquery.jqGrid-4.4.1\" version of jqgrid. I have huge data to show in grid that's why I need dynamic loading on scroll. I set scroll to 1 its working fine without grouping. Following is the example of using scroll but grouping is set to false.</p>\n\n<pre><code>{\n....\nrownum: 30,\nscroll: 1,\ngrouping: false, \ngroupingView : { \n    groupField : ['BillTitle'],\n    groupColumnShow : [true], \n    groupText : ['&lt;b&gt;{0}&lt;/b&gt;'], \n    groupCollapse : false, \n    groupOrder: ['asc'], \n    groupSummary : [true], \n    groupDataSorted : true    \n   }, \n}\n</code></pre>\n\n<p>On the other end I need to use grouping of jqgrid, when I set grouping to true dynamic loading of scroll not working. Following is not working but I need both functionality.</p>\n\n<pre><code>{\n....\nrownum: 30,\nscroll: 1,\ngrouping: true, \ngroupingView : { \n    groupField : ['BillTitle'],\n    groupColumnShow : [true], \n    groupText : ['&lt;b&gt;{0}&lt;/b&gt;'], \n    groupCollapse : false, \n    groupOrder: ['asc'], \n    groupSummary : [true], \n    groupDataSorted : true    \n   }, \n}\n</code></pre>\n\n<p>Please help me. Your help should be highly appreciated.</p>\n"},{"tags":["c#","asp.net","visual-studio","resharper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13285903,"title":"Which functions originally in Resharper are now included in Visual Studio (2012)?","body":"<p>I assume both Resharper and Visual Studio are continuously added functionality.\nThe fact that Resharper partly adds those functions that are most missing from Visual Studio, I guess as Visual Studio evolves, Visual Studio will add more and more of the functions that were originally in Resharper. Either the Visual Studio team figures it out what they would need in Visual Studio, or they look at what is available in the form of plug-ins such as Resharper. For example, VS 2012 seems to have added the hints of adding a 'using' statement when they are missing, although the VS function is not as nice as the Resharper one.</p>\n\n<p>Question:\nWhich functions originally in Resharper are now included in Visual Studio (2012)?</p>\n\n<p>I am asking from a C# and ASP.NET perspective.</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2085,"score":2,"question_id":5552670,"title":"The type or namespace name 'X' does not exist in the namespace 'Y' - in VS generated code","body":"<p>This is the weirdest error I have ever encountered.</p>\n\n<p>This MVC web project was working fine until today. It hasn't been worked on by anyone in a couple of weeks.</p>\n\n<p>Even though NOTHING has changed, simply running it now results in:</p>\n\n<pre><code>The type or namespace name 'ColourboxViewModel' does not exist in the namespace 'CMSModels.ViewModels'\n</code></pre>\n\n<p>(x5)</p>\n\n<pre><code>The type or namespace name 'Colourbox' does not exist in the namespace 'CMSModels' (are you missing an assembly reference?)\n</code></pre>\n\n<p>(x1)</p>\n\n<p>There is a reference to CMSModels in the project. Removing this reference gives me about 200 extra errors for each other class in the namespace, so I know it is working, but not for these two errors.</p>\n\n<p>This is the line of generated code which the error points to:</p>\n\n<pre><code>public class views_colorbox_index_aspx : System.Web.Mvc.ViewPage&lt;IEnumerable&lt;CMSModels.Colourbox&gt;&gt;, System.Web.SessionState.IRequiresSessionState, System.Web.IHttpHandler {\n...\npublic class views_colorbox_content_ascx : System.Web.Mvc.ViewUserControl&lt;CMSModels.ViewModels.ColourboxViewModel&gt; {\n</code></pre>\n\n<p>Intellisense is picking up the location of both CMSModels.ColourBox and CMSModels.ViewModels.ColourboxViewModel.</p>\n\n<p>I am completely stumped. Any help greatly appreciated as I am completely at a loss.</p>\n\n<hr>\n\n<p>OK I have found the issue - but not the solution. </p>\n\n<p>The class is defined as </p>\n\n<pre><code>public class ColourBoxViewModel\n</code></pre>\n\n<p>yet the generated code is looking for a class of 'ColourboxViewModel'. Note the lowercase B. Where does the auto-gen code get the names of classes from? Search in project reveals no mentions of it with a lowercase b. </p>\n\n<p>The issue is the same for the ColourBox class.</p>\n\n<hr>\n\n<p>Problem solved - and @František Žiačik you were correct. There was a folder which had been excluded from the project (which is why searching in entire project and within the views in visual studio found nothing) which contained the incorrectly typed inherit statement. The excluded folder was called ColorBox when originally created by outsourcers. This had been copied and renamed as ColourBox by another dev on the team who decided to, and I quote, 'spell everything correctly'. Said dev is now only allowed to code using a Speak n' Spell.</p>\n"},{"tags":["c#","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13291025,"title":"Multiple actions were found that match the request Web API?","body":"<p>I am using web API and i am new in this. I am stuck in a routing problem. I have a controller with following actions :</p>\n\n<pre><code>    // GET api/Ceremony\n    public IEnumerable&lt;Ceremony&gt; GetCeremonies()\n    {\n        return db.Ceremonies.AsEnumerable();\n    }\n\n    // GET api/Ceremony/5\n    public Ceremony GetCeremony(int id)\n    {\n        Ceremony ceremony = db.Ceremonies.Find(id);\n        return ceremony;\n    }\n\n    public IEnumerable&lt;Ceremony&gt; GetFilteredCeremonies(Search filter)\n    {\n        return filter.Ceremonies();\n    }\n</code></pre>\n\n<p>The problem occure when i added the action <code>GetFilteredCeremonies</code> to my controller. After adding this when i make an ajax call to <code>GetCeremonies</code> action then it return an Exception with following message :</p>\n\n<pre><code>\"Message\":\"An error has occurred.\",\"ExceptionMessage\":\"Multiple actions were \n found that match the request\n</code></pre>\n\n<p><em>FYI: The parameter <code>Search</code> is the Model class which contains properties and a function name Ceremonies.</em> </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Route:</p>\n\n<pre><code>config.Routes.MapHttpRoute(\n                name: \"DefaultApi\",\n                routeTemplate: \"api/{controller}/{id}\",\n                defaults: new { id = RouteParameter.Optional }\n            );\n</code></pre>\n"},{"tags":["c#",".net","string","truncate"],"answer_count":9,"favorite_count":1,"up_vote_count":34,"down_vote_count":0,"view_count":5841,"score":34,"question_id":2776673,"title":"How do I truncate a .NET string?","body":"<p>I apologize for such a question that likely has a trivial solution, but strangely, I could not find a concise API for this problem.</p>\n\n<p>Essentially, I would like to truncate a string such that its length is not longer than a given value.  I am writing to a database table and want to ensure that the values I write meet the constraint of the column's datatype.</p>\n\n<p>For instance, it would be nice if I could write the following:</p>\n\n<pre><code>string NormalizeLength(string value, int maxLength)\n{\n    return value.Substring(0, maxLength);\n}\n</code></pre>\n\n<p>Unfortunately, this raises an exception because <code>maxLength</code> generally exceeds the boundaries of the string <code>value</code>.  Of course, I could write a function like the following, but I was hoping that something like this already exists.</p>\n\n<pre><code>string NormalizeLength(string value, int maxLength)\n{\n    return value.Length &lt;= maxLength ? value : value.Substring(0, maxLength);\n} \n</code></pre>\n\n<p>Where is the elusive API that performs this task?  Is there one?</p>\n"},{"tags":["c#",".net","memory-management"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13291047,"title":"Why would this throw OutOfMemory?","body":"<p>I am experimenting with Marshal.AllocHGlobal and found puzzling that this code would not succeed, instead it throws an OutOfMemory exception:</p>\n\n<pre><code>namespace HAlloc\n{\n    using System;\n    using System.IO;\n    using System.Runtime.InteropServices;\n\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            // large file ~ 800MB\n            string fileName = @\"largefile.bin\";\n            FileInfo fileInfo = new FileInfo(fileName);\n\n            // allocation succeeds\n            IntPtr p = Marshal.AllocHGlobal((int)fileInfo.Length);\n\n            // OutOfMemory exception thrown here:\n            Marshal.Copy(File.ReadAllBytes(fileName), 0, p, (int)fileInfo.Length);\n            Marshal.FreeHGlobal(p);\n        }\n    }\n}\n</code></pre>\n\n<p>Why would it get an OutOfMemory when the AllocHGlobal call succeeded?</p>\n"},{"tags":["c#","rabbitmq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13291264,"title":"closing RabbitMQ connection","body":"<p>I use RabbitMQ.Client (runtime version v2.0.50727, version 2.8.1.0) with C# .NET application.</p>\n\n<p>I create connection like this:</p>\n\n<pre><code>using (IConnection connection = _factory.CreateConnection())\n{\n    using (IModel channel = connection.CreateModel())\n    {\n        // code...\n    }\n}\n</code></pre>\n\n<p>If I close the appliation properly, it simply closes the channel and connection. But if application is closed incorrectly (e.g. pressing restart button on PC), it is not. I would like to ensure that all unnecessary connections (from previous sessions or even other applications, if by mistake other instance of the application is running somewhere else) are closed before I start my application.</p>\n\n<p>I know I may use heart beats but it is possible that my application requires really much time to start doing anything (many hours of opened connection and not being used). So I think heartbeat is not the best thing.</p>\n\n<p>How can I close all opened connections for RMQ? (Or, even better, all opened connections, with the exception for one given IP)?</p>\n\n<p>Regards!</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13291081,"title":"GroupBox contain controls,how to get the names of those controls?","body":"<p>Im using GroupBox Control on my Form Page(WinForms).</p>\n\n<p>The GroupBox contain five controls(RadioButtons).</p>\n\n<p>Any idea how can I get the names and the states of controls \ninside GroupBox Control?  </p>\n"},{"tags":["c#","linq","lambda","predicatebuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13288647,"title":"Build query for IQueryable (EF4) from multiple parameters","body":"<p>I'm trying to build a single \"Or\" predicate from a list of predicates in the form <code>List&lt;Expression&lt;Func&lt;T, bool&gt;&gt;&gt;</code></p>\n\n<pre><code> public static IQueryable&lt;T&gt; Search&lt;T&gt;(this IQueryable&lt;T&gt; source, List&lt;Expression&lt;Func&lt;T, bool&gt;&gt;&gt; predicates = null)\n            where T : EntityObject\n        {\n            if (predicates == null || predicates.Count == 0)\n                return source;\n            else if (predicates.Count == 1)\n                return source.Where(predicates[0]);\n            else\n            {\n                var row = Expression.Parameter(typeof(T), \"row\");\n                var compoundExpression = predicates[0];\n\n                for (int i = 1; i &lt; predicates.Count; i++)\n                {\n                    compoundExpression = compoundExpression.Or(predicates[i]);\n                }\n                return source.Where(compoundExpression);\n            }\n        }\n\n        static Expression&lt;Func&lt;T, bool&gt;&gt; Or&lt;T&gt;(this Expression&lt;Func&lt;T, bool&gt;&gt; lhs, Expression&lt;Func&lt;T, bool&gt;&gt; rhs)\n        {\n            var row = Expression.Parameter(typeof(T), \"row\");\n            var body = Expression.Or(\n                Expression.Invoke(lhs, row),\n                Expression.Invoke(rhs, row));\n            return Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(body, row);\n        }\n</code></pre>\n\n<p>But this is returning every row in my source?</p>\n\n<p>For testing I am looking for <code>c=&gt;c.FullName.Contains(\"Smith\") or c=&gt;c.FullName.Contains(\"Jones\")</code></p>\n\n<p>I have tried amending to use <a href=\"http://www.albahari.com/nutshell/predicatebuilder.aspx\" rel=\"nofollow\">PredicateBuilder</a> but again it still returns every row in the source.</p>\n\n<pre><code>public static IQueryable&lt;T&gt; Search&lt;T&gt;(this IQueryable&lt;T&gt; source, List&lt;Expression&lt;Func&lt;T, bool&gt;&gt;&gt; predicates = null)\n            where T : EntityObject\n        {\n            if (predicates == null || predicates.Count == 0)\n                return source;\n            else if (predicates.Count == 1)\n                return source.Where(predicates[0]);\n            else\n            {\n                var pb = PredicateBuilder.False&lt;T&gt;();\n                for (int i = 0; i &lt; predicates.Count; i++)\n                {\n                    pb = pb.Or(predicates[i]);\n                }\n                return source.AsExpandable().Where(pb);\n            }\n        }\n</code></pre>\n\n<p>Any assistance very gratefully received!</p>\n\n<p>The end result would be to allow AND's as well as OR's <br/>\ne.g. c=>c.FullName.Contains(\"Dav\") AND c=>c.CustomerType == 'Staff'</p>\n"},{"tags":["c#",".net","winforms",".net-4.0",".exe"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":35,"score":1,"question_id":13288900,"title":"Find out the users accessing given exe file","body":"<p>Is there any way of find out the users who are currently running a given <code>.exe</code> file.</p>\n\n<p>For example we can find the current user of the application using <code>Environment.UserName</code>.</p>\n\n<p>Does it need any modification in program or anyway of achieving this?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Basically, I gave an exe file sitting on a network drive. I want to find out the users who are currently using the exe file.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13290603,"title":"how to convert int to uint","body":"<p>i have int variable with value <code>820924</code>\nwhen i'm trying to convert it like that: </p>\n\n<p><code>(uint)data[structure[\"MICROSECONDS\"].Index]</code></p>\n\n<p>it doesn't work</p>\n\n<p>this doesn't work as well</p>\n\n<p><code>unchecked((uint)data[structure[\"MICROSECONDS\"].Index])</code></p>\n\n<p>I receive \"Specified cast is not valid.\" exception.</p>\n\n<p>data stores <code>object</code> but at runtime I should trying to convert <code>int</code>. I'm almost sure. I've printed object value it was <code>820924</code>, however i don't know how to print object type, but it must be int.</p>\n\n<p>Code:</p>\n\n<pre><code>object value = data[structure[\"MICROSECONDS\"].Index];\nConsole.WriteLine(\"xx MICROSECONDS type \" + value.GetType());\nConsole.WriteLine(\"xx casting \" + value);\nConsole.WriteLine(\"xx cast ok\" + (uint)value);\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>xx MICROSECONDS type System.Int32\nxx casting 820924\n</code></pre>\n"},{"tags":["c#",".net","public","internal"],"answer_count":13,"favorite_count":4,"up_vote_count":18,"down_vote_count":0,"view_count":6115,"score":18,"question_id":106941,"title":"Should I use internal or public visibility by default?","body":"<p>I'm a pretty new C# and .Net developer. I recently created an MMC snapin using C# and was gratified by how easy it was to do, especially after hearing a lot of horror stories by some other developers in my organisation about how hard it is to do in C++.</p>\n\n<p>I pretty much went through the whole project at some point and made every instance of the \"public\" keyword to \"internal\", except as required by the runtime in order to run the snapin. What is your feeling on this, should you generally make classes and methods public or internal?</p>\n"}]}
{"total":375446,"page":5,"pagesize":100,"questions":[{"tags":["c#",".net","design","powershell","architecture"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13290553,"title":"What is the fastest way of comparing two huge CSV files for a change?","body":"<p>I think it is a architecture and/or design related question:</p>\n\n<p><strong>My scenerio is</strong> :</p>\n\n<p>\"</p>\n\n<ul>\n<li>I export a huge amount of data from Db to a CSV. </li>\n<li>I do it regularly. </li>\n<li>I want to check if the last exported CSV data is different than the\ncontent of the previous exported data\"</li>\n</ul>\n\n<p>How can I achieve this (without having a need to loop and compare line by line) ?</p>\n\n<p><strong>Notes</strong>:</p>\n\n<ul>\n<li><p>My exporter is a .Net console application.</p></li>\n<li><p>My Db is MS-SQL (if you need to know)</p></li>\n<li><p>My exporter is run regularly as a Scheduled TASK -within a PowerShell script</p></li>\n</ul>\n"},{"tags":["c#","c++","dll","com"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13290961,"title":"How to transmit c++ strucure from dll to c# program?","body":"<p>I have DLL, written in C++. There is structure in this DLL.</p>\n\n<pre><code>typedef struct TransmitData\n{\nwchar_t    szPath[MAX_PATH];\nDWORD      dwResult;\n} *lpTransmitData;\n</code></pre>\n\n<p>And I have one function to fill this struct</p>\n\n<pre><code>extert \"C\" __declspec(dllexport) int GetData(struct TransmitData &amp;data)\n{\n//I HAVE ONE THE SAME STRUCT IN THIS DLL\nmemcpy(&amp;data, &amp;transmitData, sizeof(struct TransmitData));\nreturn ret_value;\n}\n</code></pre>\n\n<p>In C# program I use functions with simple data types well, but for structure it doesn't work. There is code on C#:</p>\n\n<pre><code>public struct TransmitData\n{\n[MarshalAs(UnmanagedType.LPWStr, SizeConst = 260)] //260 = MAX_PATH\npublic string szPath;\npublic uint dwResult;\n}\n//...\n[DllImport(\"MyDLL\")]\npublic static extern int GetData(ref TransmitData data);\n</code></pre>\n\n<p>What am I doing wrong?\nThanks!</p>\n"},{"tags":["c#","asp.net","wcf","restful-authentication","basichttpbinding"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13266932,"title":"The HTTP request is unauthorized with client authentication scheme 'Anonymous'?","body":"<p>While trying to invoke a RESTful service(i have used UserNameAuthenticator from this sample for RESTful service <a href=\"http://stackoverflow.com/questions/4715752/adding-basic-http-auth-to-a-wcf-rest-service\">Adding basic HTTP auth to a WCF REST service</a>) from my web client application am getting an error like   </p>\n\n<pre><code>The HTTP request is unauthorized with client authentication scheme 'Anonymous'. The authentication header received from the server was 'Basic Realm'.\n</code></pre>\n\n<p>Client CS code</p>\n\n<pre><code>BasicHttpBinding binding = new BasicHttpBinding();\nbinding.SendTimeout = TimeSpan.FromSeconds(25);\nbinding.Security.Transport.ClientCredentialType =\nHttpClientCredentialType.Basic;\nEndpointAddress address = new  EndpointAddress(\"http://localhost:12229/RestServiceImpl.svc\");\nChannelFactory&lt;RestService.IRestServiceImpl&gt; factory =\nnew ChannelFactory&lt;RestService.IRestServiceImpl&gt;(binding, address);\nRestService.IRestServiceImpl channel = factory.CreateChannel();\nchannel.GetStudent();\n</code></pre>\n\n<p>Client Web.config</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"RestService.RestServiceImpl\"&gt;\n        &lt;endpoint address=\"http://localhost:12229/RestServiceImpl.svc\"\n          binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_ExternalSystemsService_v1Interface\"\n          contract=\"RestService.IRestServiceImpl\"\n          name=\"ExternalSystemsService_v1Port\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"BasicHttpBinding_ExternalSystemsService_v1Interface\"\n                         closeTimeout=\"00:01:00\" openTimeout=\"00:01:00\" receiveTimeout=\"00:10:00\"\n                         sendTimeout=\"00:01:00\" allowCookies=\"false\" bypassProxyOnLocal=\"false\"\n                         hostNameComparisonMode=\"StrongWildcard\" maxBufferSize=\"65536\"\n                         maxBufferPoolSize=\"524288\" maxReceivedMessageSize=\"65536\"\n                         messageEncoding=\"Text\" textEncoding=\"utf-8\" transferMode=\"Buffered\"\n                         useDefaultWebProxy=\"true\"&gt;\n          &lt;readerQuotas maxDepth=\"32\" maxStringContentLength=\"8192\" maxArrayLength=\"16384\"\n              maxBytesPerRead=\"4096\" maxNameTableCharCount=\"16384\" /&gt;\n          &lt;security mode=\"TransportCredentialOnly\"&gt;\n            &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\"\n                realm=\"\" /&gt;\n            &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>and RESTful service Web.config</p>\n\n<pre><code> &lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"webHttpTransportSecurity\"&gt;\n          &lt;security mode=\"TransportCredentialOnly\"&gt;\n            &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\" realm=\"\" /&gt;\n            &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n          &lt;/security&gt;\n          &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;services&gt;\n      &lt;service name=\"RestService.RestServiceImpl\"&gt;\n        &lt;endpoint name=\"ExternalSystemsService_v1Port\" address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_ExternalSystemsService_v1Interface\" contract=\"RestService.IRestServiceImpl\"&gt;&lt;/endpoint&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior&gt;\n          &lt;webHttp /&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"SecureRESTSvcTestBehavior\"&gt;\n&lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"false\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n          &lt;serviceCredentials&gt;\n            &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"RESTfulSecuritySH.CustomUserNameValidator, RESTfulSecuritySH\" /&gt;\n          &lt;/serviceCredentials&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Any suggestion?</p>\n"},{"tags":["c#",".net","asp.net","webforms","postback"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":617,"score":4,"question_id":7499870,"title":"ASP.NET button options.clientSubmit is set to false","body":"<p>I have a ASP.NET button which sometimes does not post back. I checked this in IE developer and found that when the button does not work <code>options.clientSubmit</code> is set to false in the function <code>WebForm_DoPostBackWithOptions()</code></p>\n\n<p>My button code</p>\n\n<pre><code>&lt;asp:Button \n           runat=\"server\" \n           ID=\"btnSubmit\" \n           CssClass=\"button\" \n           OnClick=\"btnSubmit_Click\"  \n           meta:resourcekey=\"btnSubmitResource1\" /&gt;\n</code></pre>\n\n<p>Inside <code>WebForm_DoPostBackWithOptions(options)</code></p>\n\n<pre><code>    if (options.clientSubmit) {\n    __doPostBack(options.eventTarget, options.eventArgument);\n    }\n</code></pre>\n\n<p>Can anyone tell me why the button sometimes works and sometimes does not? what should I do to make it work always?</p>\n"},{"tags":["c#","winrt"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":434,"score":3,"question_id":10326459,"title":"Is it possible to make a WinRT service","body":"<p>Since WinRT have unique capabilities, I wonder if it were to make a Windows Service that is targeted to WinRT? If it were not possible, is the workaround to make an invisible WinRT/Metro application possible?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["c#","mschart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13268682,"title":"MS Chart, add triangles to an existing chart at specific points","body":"<p>Im wondering if its possible to add colored triangles (pointing up or down) at specific points (x,y) on an existing chart, such that they will update their positions if the chart is scrolled/zoomed.</p>\n\n<p>Ive had a google around but havent stumbled across anything which seems to meet those requirements.</p>\n\n<p>Any pointers would be appreciated.</p>\n"},{"tags":["c#","powershell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13290296,"title":"CreateProcessAsUser - Error 5","body":"<p>I am trying to use CreateProcessAsUser method. But I am getting Error code - 5</p>\n\n<p>This is what I do .</p>\n\n<ol>\n<li>LoadUserProfile</li>\n<li>DuplicateToken</li>\n<li>ImpersonateUser</li>\n<li>CreateProcessAsUser - with duplicateToken</li>\n</ol>\n\n<p>Can someone help me out</p>\n\n<p>Regards</p>\n\n<p>Code</p>\n\n<pre><code># Start-of C# section\n$createPocess = @'\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Runtime.InteropServices;\nusing Microsoft.Win32;\nusing System.IO;\nusing System.Security.Principal;\n\nnamespace CreateProcessUtility\n{\n    class Win32\n    {\n    #region \"CONTS\"\n    const UInt32 INFINITE = 0xFFFFFFFF;\n    const UInt32 WAIT_FAILED = 0xFFFFFFFF;\n\n\n    #endregion\n\n    #region \"ENUMS\"\n\n    [Flags]\n    public enum LogonType\n    {\n        LOGON32_LOGON_INTERACTIVE = 2,\n        LOGON32_LOGON_NETWORK = 3,\n        LOGON32_LOGON_BATCH = 4,\n        LOGON32_LOGON_SERVICE = 5,\n        LOGON32_LOGON_UNLOCK = 7,\n        LOGON32_LOGON_NETWORK_CLEARTEXT = 8,\n        LOGON32_LOGON_NEW_CREDENTIALS = 9\n    }\n\n    [Flags]\n    public enum LogonProvider\n    {\n        LOGON32_PROVIDER_DEFAULT = 0,\n        LOGON32_PROVIDER_WINNT35,\n        LOGON32_PROVIDER_WINNT40,\n        LOGON32_PROVIDER_WINNT50\n    }\n\n    #endregion\n\n    #region \"STRUCTS\"\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct STARTUPINFO\n    {\n        public Int32 cb;\n        public String lpReserved;\n        public String lpDesktop;\n        public String lpTitle;\n        public Int32 dwX;\n        public Int32 dwY;\n        public Int32 dwXSize;\n        public Int32 dwYSize;\n        public Int32 dwXCountChars;\n        public Int32 dwYCountChars;\n        public Int32 dwFillAttribute;\n        public Int32 dwFlags;\n        public Int16 wShowWindow;\n        public Int16 cbReserved2;\n        public IntPtr lpReserved2;\n        public IntPtr hStdInput;\n        public IntPtr hStdOutput;\n        public IntPtr hStdError;\n    }\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct PROCESS_INFORMATION\n    {\n        public IntPtr hProcess;\n        public IntPtr hThread;\n        public Int32 dwProcessId;\n        public Int32 dwThreadId;\n    }\n\n    #endregion\n\n    #region \"FUNCTIONS (P/INVOKE)\"\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct ProfileInfo {\n        public int dwSize; \n        public int dwFlags;\n        public String lpUserName; \n        public String lpProfilePath; \n        public String lpDefaultPath; \n        public String lpServerName; \n        public String lpPolicyPath; \n        public IntPtr hProfile; \n    }\n\n\n\n    [DllImport(\"advapi32.dll\", CharSet = CharSet.Unicode, SetLastError = true)]\n    public static extern Boolean LogonUser \n    (\n        String lpszUserName,\n        String lpszDomain,\n        String lpszPassword,\n        LogonType dwLogonType,\n        LogonProvider dwLogonProvider,\n        out IntPtr phToken\n    );\n\n    [DllImport(\"advapi32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n    public static extern Boolean CreateProcessAsUser \n    (\n        IntPtr hToken,\n        String lpApplicationName,\n        String lpCommandLine,\n        IntPtr lpProcessAttributes,\n        IntPtr lpThreadAttributes,\n        Boolean bInheritHandles,\n        Int32 dwCreationFlags,\n        IntPtr lpEnvironment,\n        String lpCurrentDirectory,\n        ref STARTUPINFO lpStartupInfo,\n        out PROCESS_INFORMATION lpProcessInformation\n    );\n\n\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    public static extern UInt32 WaitForSingleObject \n    (\n        IntPtr hHandle,\n        UInt32 dwMilliseconds\n    );\n\n    [DllImport(\"kernel32\", SetLastError=true)]\n    public static extern Boolean CloseHandle (IntPtr handle);\n\n    [DllImport(\"userenv.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    public static extern bool LoadUserProfile(IntPtr hToken, ref ProfileInfo lpProfileInfo);\n\n    [DllImport(\"advapi32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\n    public static extern int DuplicateToken(IntPtr hToken, int impersonationLevel, ref IntPtr hNewToken);\n\n    #endregion\n\n    #region \"FUNCTIONS\"\n\n    public static void LaunchCommand2(string strCommand, string strDomain, string strName, string strPassword)\n    {\n        // Variables\n        WindowsIdentity m_ImpersonatedUser;\n        IntPtr tokenDuplicate = IntPtr.Zero;\n        PROCESS_INFORMATION processInfo = new PROCESS_INFORMATION();\n        STARTUPINFO startInfo = new STARTUPINFO();\n        Boolean bResult = false;\n        IntPtr hToken = IntPtr.Zero;\n        UInt32 uiResultWait = WAIT_FAILED;\n        string executableFile = \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\";\n        const int SecurityImpersonation = 2;\n\n\n        try \n        {\n            // Logon user\n            bResult = Win32.LogonUser(\n                strName,\n                strDomain,\n                strPassword,\n                Win32.LogonType.LOGON32_LOGON_INTERACTIVE,\n                Win32.LogonProvider.LOGON32_PROVIDER_DEFAULT,\n                out hToken\n            );\n            if (!bResult) { throw new Exception(\"Logon error #\" + Marshal.GetLastWin32Error()); }\n\n\n             #region LoadUserProfile\n                    ProfileInfo currentProfile = new ProfileInfo();\n                    currentProfile.dwSize = Marshal.SizeOf(currentProfile);\n                    currentProfile.lpUserName = strName;\n                    currentProfile.dwFlags = 1;                        \n                    Boolean bResult2 = LoadUserProfile(hToken, ref currentProfile);\n                    Console.WriteLine(bResult2);\n\n                    if (!bResult2) { throw new Exception(\"LoadUserProfile error #\" + Marshal.GetLastWin32Error()); }\n                   Console.WriteLine(currentProfile.hProfile + \"----\"+IntPtr.Zero);\n\n\n                   if (currentProfile.hProfile == IntPtr.Zero){\n                        Console.WriteLine(\"LoadUserProfile() failed - HKCU handle was not loaded. Error code: \" +\n                            Marshal.GetLastWin32Error());\n                        throw new Exception(\"LoadUserProfile error #\" + Marshal.GetLastWin32Error());\n                    }\n             #endregion\n\n\n            // Create process\n            startInfo.cb = Marshal.SizeOf(startInfo);\n            startInfo.lpDesktop = \"winsta0\\\\default\";\n\n            Console.WriteLine(\"Before impersonation: \" + WindowsIdentity.GetCurrent().Name);\n\n\n            if (DuplicateToken(hToken, SecurityImpersonation, ref tokenDuplicate) != 0){\n             m_ImpersonatedUser = new WindowsIdentity(tokenDuplicate);\n\n                if(m_ImpersonatedUser.Impersonate() != null){\n                    Console.WriteLine(\"After Impersonation succeeded: \" + Environment.NewLine +\n                                                  \"User Name: \" +\n                                                  WindowsIdentity.GetCurrent(TokenAccessLevels.MaximumAllowed).Name +\n                                                  Environment.NewLine +\n                                                  \"SID: \" +\n                                                  WindowsIdentity.GetCurrent(TokenAccessLevels.MaximumAllowed).User.\n                                                      Value);\n                    Console.WriteLine(m_ImpersonatedUser);\n                }\n\n\n                bResult = Win32.CreateProcessAsUser(\n                tokenDuplicate, \n                executableFile, \n                strCommand, \n                IntPtr.Zero,\n                IntPtr.Zero,\n                false,\n                0,\n                IntPtr.Zero,\n                null,\n                ref startInfo,\n                out processInfo\n            );\n            if (!bResult) { throw new Exception(\"CreateProcessAsUser error #\" + Marshal.GetLastWin32Error()); }\n\n        }\n\n            // Wait for process to end\n            uiResultWait = WaitForSingleObject(processInfo.hProcess, INFINITE);\n            if (uiResultWait == WAIT_FAILED) { throw new Exception(\"WaitForSingleObject error #\" + Marshal.GetLastWin32Error()); }\n        }\n        finally \n        {\n            // Close all handles\n            CloseHandle(hToken);\n            CloseHandle(processInfo.hProcess);\n            CloseHandle(processInfo.hThread);\n        }\n    }\n\n    #endregion\n}\n// Interface between powershell and C#    \npublic class CreateProcessCaller\n{\n    public static void modifyEnvParamWrapper2(string strCommand, string strDomain, string strName, string strPassword)\n    {\n        Win32.LaunchCommand2(strCommand, strDomain, strName, strPassword);\n    }\n}\n} \n\n'@\n# End-of C# section\n\n\nAdd-Type -TypeDefinition $createPocess -Language CSharp -IgnoreWarnings\n\n\nFunction modifyEnvParamWOWindow([String]$command, [String]$strDomain, [String]$strName, [String]$strPassword) {\n\ntry {\n    [CreateProcessUtility.CreateProcessCaller]::modifyEnvParamWrapper2($command, $strDomain, $strName, $strPassword)\n    return $True\n} catch {\n    write-host \"Unable to modify regestry entry: \" $_\n    return $False\n}\n}  \n</code></pre>\n"},{"tags":["c#",".net","control","locked"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":275,"score":4,"question_id":8392337,"title":"Control 'seems' to be locked","body":"<p>I'm trying to change properties to a control however it seems as if it's \"locked\" but in reality, it isn't because when I right-click on the control it shows the control as being unlocked.</p>\n\n<p>I'm using Visual Studio 2005, and I've never worked with a control that seems to be locked as such in the picture provided. </p>\n\n<p>I'd really appreciate a simple explanation and how to resolve this issue so that I can proceed with modifying it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/zFqr3.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","ssms","ssms-2012","ssms-addin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13291049,"title":"Create a ToolWindow requiring a Connection","body":"<p>I created an own SQL Management Studio 2012 Add-In using a WPF UI. In my UserControl being displayed I want to require an open SQL Server Connection just like it happens if you open an SQL File. </p>\n\n<p>An example: If you open an SQL file in SSMS it opens a dialog for connecting to a server. If you are already connected via the Object Explorer, this connection will be used. The status bar of the SQL document will show if you are connected or disconnected. </p>\n\n<p>In my Connect class I create new tool window using the CreateToolWindow2 method of the DTE2.Windows interface but this will only create a simple ToolWindow.</p>\n\n<pre><code>private DTE2 _applicationObject;\n...\nWindows2 windows = (Windows2)_applicationObject.Windows;\nWindow toolWindow = windows.CreateToolWindow2(...);\n</code></pre>\n\n<p>Can you give me an example or some resources how to require a connection within this ToolWindow instance and access it the connection within my UserControl instance created. </p>\n"},{"tags":["c#","android","html","html-parsing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13291042,"title":"Mono for Android Html Agility Pack","body":"<p>A user here, gave me a HtmlAgilityPack for Android. My question is how do I use it in MonoDevelop (Mono for Android - C#)?</p>\n"},{"tags":["c#","wpf","image","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13290748,"title":"Image not displayed pixel to pixel","body":"<p>I'm puzzled. </p>\n\n<p>I have created a PNG image that to be a divider in my application display and the image is 3 pixels high like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/NphPg.png\" alt=\"enter image description here\"></p>\n\n<p>However when I display it on my C# WPF window and run it, the divider is shown to be about 4 pixels instead, with the colours being off. </p>\n\n<h2>Code:</h2>\n\n<pre><code>&lt;StackPanel Height=\"3\"&gt;\n    &lt;StackPanel.Background&gt;\n        &lt;ImageBrush ImageSource=\"Assets/divider.png\" Stretch=\"None\"\n            AlignmentX=\"Left\" AlignmentY=\"Top\" Viewport=\"0,0,20,3\" \n            ViewportUnits=\"Absolute\" TileMode=\"FlipX\" /&gt;\n    &lt;/StackPanel.Background&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<h2>Output and Zoom:</h2>\n\n<p><img src=\"http://i.stack.imgur.com/Sfs5f.png\" alt=\"enter image description here\"></p>\n\n<p>What I've thought would be that the image is \"stretched\" (despite <code>Stretch=\"None\"</code>) or there is some mechanism to optimize the image, so I did away with the image and wrote it with 3 rectangles with the same color and 1 pixel height each like this:</p>\n\n<pre><code>&lt;StackPanel Height=\"3\" Orientation=\"Vertical\"&gt;\n    &lt;Rectangle Fill=\"#484848\" Height=\"1\" /&gt;\n    &lt;Rectangle Fill=\"#222\" Height=\"1\" /&gt;\n    &lt;Rectangle Fill=\"#484848\" Height=\"1\" /&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>However the results were similar: 4 pixels and colours run off (not exact colours as specified):</p>\n\n<p><img src=\"http://i.stack.imgur.com/A0zNX.png\" alt=\"enter image description here\"></p>\n\n<p>Other than pixels being off, the colours are off too. My colours are supposed to be <code>#484848</code>, <code>#222222</code>, <code>#484848</code>. When displayed on the WPF window, the shades goes off a little (too many shades of grey!)</p>\n\n<p>I need the separator to fill the window with too as the window gets resized. I'm a perfectionist and I want that 3 pixel height separator to be pixel perfect. Any solution to solve that problem?</p>\n"},{"tags":["c#",".net","google-api","google-analytics-api"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1333,"score":3,"question_id":9100770,"title":"Difference between Google API libraries: google-api-dotnet-client vs. google-gdata","body":"<p>What is the difference between the <a href=\"http://code.google.com/p/google-api-dotnet-client/\" rel=\"nofollow\">Google APIs Client Library for .NET</a> (google-api-dotnet-client) and <a href=\"http://code.google.com/p/google-gdata/\" rel=\"nofollow\">.NET library for the Google Data API </a> (google-gdata) as they pertain to the <a href=\"http://code.google.com/apis/analytics/\" rel=\"nofollow\">Google Analytics API</a>?</p>\n"},{"tags":["c#","asp.net","drop-down-menu"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1249,"score":0,"question_id":6202987,"title":"asp.net 4 dropdownlist findByText not working for dynamic list","body":"<p>I have a dropdownlist, whose datasource is from SQL server. </p>\n\n<pre><code>&lt;asp:DropDownList ID=\"State\" runat=\"server\" DataSourceID=\"SqlDataSource1\" DataTextField=\"STATE_NAME\" DataValueField=\"STATE_FIPS\"&gt;\n&lt;/asp:DropDownList&gt;\n                                   &lt;asp:SqlDataSource ID=\"SqlDataSource1\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:ConnectionString %&gt;\"\n                                       SelectCommand=\"SELECT DISTINCT [STATE_NAME], [STATE_FIPS] FROM [county] order by [STATE_NAME]\"&gt;\n                                   &lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>I want to prepopulate the value in the list. i use <code>DropDownList.SelectedIndex = DropDownList.Items.IndexOf(DropDownList.Items.FindByValue(YourValueHere))</code>. but it's not working. it gives me a null from <code>DropDownList.Items.FindByValue(YourValueHere)</code>.</p>\n\n<p>The same code works fine if i use static listitem, like:</p>\n\n<pre><code>&lt;asp:DropDownList ID=\"ddl\" runat=\"server\"&gt;\n                &lt;asp:ListItem&gt;item1&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem&gt;item2&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem&gt;item3&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem&gt;item4&lt;/asp:ListItem&gt;\n&lt;/asp:DropDownList&gt;\n</code></pre>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["c#","c++","c","com","serial-port"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13290587,"title":"Receiving data from RS232(com)","body":"<p>I want to write an app that receive data from RS232(sometimes using usb connector) port using C/C#.</p>\n\n<p>I have searched the web but found nothing. Do u have anything interesting? Articles, tutorials, tips, code snippets, everything is very much appreciated.</p>\n\n<p>I have got transmission protocol, but have no idea how to read data from rs232. \nCan I read/write data asynchronously? </p>\n"},{"tags":["c#",".net","facebook","facebook-c#-sdk"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":26,"score":-1,"question_id":13290983,"title":"How can I get like stats from facebook fanpage insights?","body":"<p>Have you got any manuals or turorials, how to create just simple (console) application, whitch consumes likes data from facebook insights?\nI'm insteresting in generating that codes too!\nNow I just have got fanpage, facebook account and Visual Studio :)\nWhat should I do?</p>\n"},{"tags":["c#","ivalueconverter"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13290531,"title":"is an object of value type also the nullable value type?","body":"<p>I saw some code like this</p>\n\n<pre><code>if(value == null || !(value is double || value is double?))\n{\n    return value;\n}\n</code></pre>\n\n<p>if value is double is true, value is double? should also be true, therefore can i change the code to</p>\n\n<pre><code>if(value == null || !(value is double?))\n{\n    return value;\n}\n</code></pre>\n"},{"tags":["c#","datagridview","commit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13290957,"title":"Force to commit and exit edit mode when DataGridView.IsCurrentCellDirty","body":"<p>I would like to force commit changes and exit edit mode for a cell in CurrentCellDirtyStateChanged event. In this event I do:</p>\n\n<pre><code>        if (this.gridView.IsCurrentCellDirty)\n        {\n            //this.gridView.CommitEdit(DataGridViewDataErrorContexts.Commit);\n            this.gridViewCursors.EndEdit(DataGridViewDataErrorContexts.Commit);\n        }\n</code></pre>\n\n<p>Also I have tried to do:</p>\n\n<pre><code>this.gridView.CommitEdit(DataGridViewDataErrorContexts.Commit);\n</code></pre>\n\n<p>But without success.</p>\n"},{"tags":["c#","wcf"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13290704,"title":"Consuming WCF service via service reference in .NET 4.0","body":"<p>I've been reading a little bit on WCF, and the general consensus on the web is that consuming a WCF service via Visual Studio's add service reference isn't the preferred/right way as it adds a lot of bloatware code.</p>\n\n<p>However, most of these posts are from 2009, with .NET 3.5.</p>\n\n<p>I'd like to know if this situation has improved with .NET 4.0, or .NET 4.5, and is it still recommended to consume a service manually over the VS way?</p>\n\n<p>Is the performance difference between the manual and service reference way very glaring?</p>\n"},{"tags":["c#","asp.net","twitter","twitterizer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13280110,"title":"how to get user timeline using twitterizer2","body":"<p>I am using twitterizer2 to try and get a users recent few tweets and then write them to a table using oAuth not the users screen name, but i am new to twitterizer so i don't know how to do this.</p>\n\n<p>how can i do this ?\nthanks</p>\n"},{"tags":["c#","asp.net","sql","reporting-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13290940,"title":"SQL Server 2008 R2 reporting services web service fails to load report","body":"<p>I am working on displaying a report hosted in SQL server 2008 R2 reporting services from an asp.net web application.</p>\n\n<p>The web application and the reporting server are on the same machine. The report is loaded in a report viewer control on an aspx page. The problem I am encountering is, whenever I load the page that displays the report, I get a prompt to enter a user name and password. When I enter a user name and password,  the page displays the report manager interface (shows report folders, data sources and reports on the server) instead of loading the actual report. This does not happen on the development machine (here the report displays without any prompts). Please help me troubleshoot this problem. Why I'm I being prompted for a username and password? Why is the page displaying the report server instead of the report?</p>\n\n<p>Here is the code I use to load the report.</p>\n\n<pre><code>reportViewer.ProcessingMode = Microsoft.Reporting.WebForms.ProcessingMode.Remote;\n//AppReportServerCredentials contains the user name and password of a user allowed to view reports on the server\nreportViewer.ServerReport.ReportServerCredentials = new AppReportServerCredentials();\nreportViewer.ServerReport.ReportServerUrl = new Uri(\"http://localhost/reportserver\");\nreportViewer.ServerReport.ReportPath = \"/reports_folder/report_name\";\nparam1 = new ReportParameter(\"param1\", 1234);\nparam2 = new ReportParameter(\"param2\", \"abcd\");\nreportViewer.ServerReport.SetParameters(new ReportParameter[] { param1, param2 });\n</code></pre>\n"},{"tags":["c#","continuous-integration","patch",".net-assembly","continuous-deployment"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13290716,"title":"Bringing C# application under assembly version and using it to create patches and manage them","body":"<p>We have a C# desktop application which we run for clients on various servers on a software as a service model. We are still on dot net framework 2.\nThe software has a architecture in which we have an independent application to catch external data thrown by some server. Then an application to make calculations based on it. Also one more application on which the client sees the output. The link between the 3 applications is another application which communicates with the DB. </p>\n\n<p>The 4 solutions are on a SVN for sourcecontrol. But the release management is still manual and the patches are made manually by checking the log and including the dlls, pdbs, xml. etc for the projects for which the code has changed. </p>\n\n<p>There is no assembly versioning implemented and the patch or release management is just done in the dark.</p>\n\n<p>I want to know what is the industry practice for generating automatic patches from the code. Also I want a patch for each revision in the SVN. Also is assembly versioning helpful in this?</p>\n\n<p>I have read much about continuous integration but it fails because we do not have unit tests and other fancy code to moniter the correctness of code. \nThe only thing at this time I would be interested is to implement a way to make patches which can be applied and removed easily. Also I want to know a way to determine the way we can monitor which release is at which level(or what patches have been applied) by some automated way rather than maintaining a log manually.</p>\n"},{"tags":["c#","html","smtp","sendmail"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13287801,"title":"SmtpClient sending raw Html","body":"<p>Could anyone tell me why the following code is sending out emails in raw Html? As in, the email looks like when you view a page source.</p>\n\n<p>I have cut down the code so as not to include attachments and from addresses.</p>\n\n<p>If I disable the line with the alternate view the email renders correctly but I also want to send out a plain text version.   </p>\n\n<pre><code>using (SmtpClient client = GetSmtpClient(settings)) {\n    using (MailMessage message = new MailMessage()) {\n        message.IsBodyHtml = true;\n        message.BodyEncoding = System.Text.Encoding.GetEncoding(\"iso-8859-1\");\n        message.To.Add(toList);\n        message.Subject = subject;\n        message.Body = htmlTemplate;\n        message.AlternateViews.Add(AlternateView.CreateAlternateViewFromString(textTemplate, new ContentType(\"text/plain\")));\n        client.Send(message);\n     }\n}\n</code></pre>\n\n<p><strong>Edit</strong>: The message was originally sending text as the main body and html as the alternative view but I have run into a problem with accented and foreign characters as described <a href=\"http://stackoverflow.com/questions/12374211/accented-characters-not-showing-up\">here</a> and wanted to set <code>IsBodyHtml</code> to true, which forces me to set html to the main view.</p>\n"},{"tags":["c#","windows","localization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13290828,"title":"Cannot print Turkish specific characters in C# console application","body":"<p>Following source code: </p>\n\n<pre><code>Console.WriteLine(\"01- ııı\");\nConsole.WriteLine(\"02- İİİ\");\nConsole.WriteLine(\"03- ööö\");\nConsole.WriteLine(\"04- ÖÖÖ\");\nConsole.WriteLine(\"05- üüü\");\nConsole.WriteLine(\"06- ÜÜÜ\");\nConsole.WriteLine(\"07- şşş\");\nConsole.WriteLine(\"08- ŞŞŞ\");\nConsole.WriteLine(\"09- ğğğ\");\nConsole.WriteLine(\"10- ĞĞĞ\");\n</code></pre>\n\n<p>gives me this output:</p>\n\n<pre><code>01- iii\n02- III\n03- ööö\n04- ÖÖÖ\n05- üüü\n06- ÜÜÜ\n07- sss\n08- SSS\n09- ggg\n10- GGG\n</code></pre>\n\n<p>Line 01,02,07,08,09,10 are wrong.</p>\n\n<p>I know all these letters are UNICODE letters. They should be displayed correctly.</p>\n\n<pre><code>OS: Windows 7 Enterprise 64-bit.\nCurrent System Locale: English (United States)\nCurrent Location: Turkey\nCuurent Language for non-unicode programs:English (United States)\n</code></pre>\n\n<p>Any solution or advice will be appreciated.</p>\n"},{"tags":["c#","extension-methods",".net-4.5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":13290757,"title":".NET 4.5 where is extension methods for static classes?","body":"<p>Many questions here asked about extension methods on static classes, and I feel its quiet justified to have them in .Net support. </p>\n\n<p>So I was quiet disappointed that 4.5 still doesn't have them (i'd gladly trade some other stuff it does have for this :) )</p>\n\n<p>From what I understand F# has them.</p>\n\n<p>A quick search on this site seems to indicate that it's a wanted support.</p>\n\n<p>So can anyone help me understand why Microsoft does not support extension methods on static classes? \nIs there something I'm missing, why is this so hard or where/what is the ambiguous cases that stop this from being implemented?</p>\n\n<p>I get that the signature would have to change (no longer pass in this Enum e) </p>\n\n<p>Code example:</p>\n\n<pre><code>internal class Program\n{\n    private static void Main(string[] args)\n    {\n        string animal = \"dog\";\n        Animal myAnimalII = Animal.Cat.EnumParse(animal, Animal.Mutant);\n        //Static class extension method wish\n        Animal myAnimalI = Animal.EnumParse(animal, Animal.Mutant);\n    }\n}\n\ninternal enum Animal\n{\n    Dog = 1,\n    Cat = 2,\n    Giraff = 3,\n    Mutant = 4\n}\n\npublic static class EnumExtensionMethods\n{\n    public static T EnumParse&lt;T&gt;(this Enum e, string value, T defaultValue)\n    {\n        if (string.IsNullOrEmpty(value))\n            return defaultValue;\n\n        if (Enum.IsDefined(typeof (T), value))\n            return (T) Enum.Parse(typeof (T), value);\n\n        int num;\n        if (int.TryParse(value, out num))\n        {\n            if (Enum.IsDefined(typeof (T), num))\n                return (T) Enum.ToObject(typeof (T), num);\n        }\n\n        return defaultValue;\n    }\n}\n</code></pre>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13286351,"title":"EF - Can not delete an object","body":"<p>Why does this code not work? It inserts an object but does not delete it </p>\n\n<pre><code>public int Toggle(RequestArchive RequestArchiveObj)\n{\n   var ra = DataContext.RequestArchives.Where(rec =&gt; rec.UserId == RequestArchiveObj.UserId &amp;&amp; rec.RequestId == RequestArchiveObj.RequestId);\n\n   if(ra.Count() &gt; 0)\n   {\n        foreach (var item in ra)\n        {                    \n            DataContext.DeleteObject(item);\n        }\n   }\n   else\n   {\n        DataContext.AddToRequestArchives(RequestArchiveObj);\n   }\n\n   DataContext.SaveChanges();\n   return RequestArchiveObj.Id;\n}\n</code></pre>\n"},{"tags":["c#","string","split"],"answer_count":3,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":1292,"score":9,"question_id":3880475,"title":"split string with more than one Char in C#","body":"<p>i want to split the String = \"Asaf_ER_Army\" by the \"ER\" seperator.\nthe Split function of String doesn't allow to split the string by more than one char.</p>\n\n<p>how can i split a string by a 'more than one char' seperator?</p>\n"},{"tags":["c#","registry"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":30,"score":4,"question_id":13290498,"title":"Different results from Registry.GetValue() and Registry.User.GetValue()","body":"<p>I'm getting different results in <code>output1</code> and <code>output2</code>. While the first one gives me the value I actually see in the registry, the latter only gives me the default value. What do I miss?</p>\n\n<pre><code>String output1 = Registry.GetValue(\n  @\"HKEY_USERS\\blobb\", \"beep\", \"nope!\") as String;\n\nString output2 = Registry.Users.GetValue(\n  @\"blobb\\beep\", \"nope!\") as String;\n</code></pre>\n\n<p>I've tried quite a few different variation of the input string but none gave me the corrrect value.</p>\n"},{"tags":["c#","algorithm","linq","list","arraylist"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":62,"score":1,"question_id":13289082,"title":"How to shift the data in a list","body":"<p>I have the following case and I want to get a general solution without heavy looping and slicing .</p>\n\n<p>Firstly : </p>\n\n<p>I initialize <code>N</code> which through it I calculate the list size (initial size) :</p>\n\n<p>Through this Equation <code>N(N-1)/2</code>..</p>\n\n<p>let's say I set <code>N = 5</code> so  the initial size will be <code>10</code> .</p>\n\n<p>After that I fill the list with one's and zeroes with some method .</p>\n\n<p>Like this :</p>\n\n<blockquote>\n  <p>0 1 0 1 1 1 0 1 0 1</p>\n</blockquote>\n\n<p>This list segmented according to N where the segments are (N-1).</p>\n\n<p>So </p>\n\n<ul>\n<li>The First Segment is : <code>0 1 0 1</code></li>\n<li>The Second Segment is : <code>1 1 0</code></li>\n<li>The Third Segment is : <code>1 0</code></li>\n<li>and The Forth Segment is : <code>1</code></li>\n</ul>\n\n<blockquote>\n  <p>[0 1 0 1] [1 1 0] [1 0] [1]</p>\n</blockquote>\n\n<p>What I wanna to do is if I enter any number as input N again:</p>\n\n<p>Maintain the previous data with the proper shifting</p>\n\n<p>According to the new size .for example if N=6 so  the size will be 15 </p>\n\n<p>So I will have 5 segments in stead of 4</p>\n\n<p>I want it like this :</p>\n\n<blockquote>\n  <p>[0 1 0 1 <strong>0</strong>] [1 1 0 <strong>0</strong>] [1 0 <strong>0</strong>] [1 <strong>0</strong>] [<strong>0</strong>]</p>\n</blockquote>\n\n<p>And vice verse If i enter N = 7 firstly and fill it .then i enter N = 4</p>\n\n<p>I wanna to make the proper shifting </p>\n"},{"tags":["c#","image","contrast"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4097,"score":3,"question_id":3115076,"title":"Adjust the contrast of an image in C# efficiently","body":"<p>Is there an efficient way of adjusting the contrast of an image in C#?</p>\n\n<p>I've seen <a href=\"http://www.gutgames.com/post/Adjusting-Contrast-of-an-Image-in-C.aspx\" rel=\"nofollow\">this article</a> which advocates doing a per-pixel operation. Not quick.</p>\n\n<p>I'm using colour matrices in places already and find them to be quick. Is there a way to adjust contrast using them? (Note: <a href=\"http://www.bobpowell.net/image_contrast.htm\" rel=\"nofollow\">This guy</a> gets it wrong.)</p>\n\n<p>I'm also using EmguCV. I notice that OpenCV (which Emgu wraps) <a href=\"http://ubaa.net/shared/processing/opencv/opencv_contrast.html\" rel=\"nofollow\">seems to have a contrast function</a> - is there any way of accessing this through Emgu? At the moment all I can do in Emgu is normalise the histogram, which does change the contrast, but not with any degree of control on my part.</p>\n\n<p>Anyone got any ideas?</p>\n"},{"tags":["c#","random"],"answer_count":6,"favorite_count":7,"up_vote_count":19,"down_vote_count":0,"view_count":13360,"score":19,"question_id":1064901,"title":"Random Number Between 2 Double Numbers","body":"<p>It is possible to generate a random number between 2 doubles?</p>\n\n<p>Example:</p>\n\n<pre><code>public double GetRandomeNumber(double minimum, double maximum)\n{\n    return Random.NextDouble(minimum, maximum) \n}\n</code></pre>\n\n<p>Then I call it with the following:</p>\n\n<pre><code>double result = GetRandomNumber(1.23, 5.34);\n</code></pre>\n\n<p>Any thoughts would be appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","html","encoding","character-encoding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":42,"score":-1,"question_id":13287762,"title":"Writing an html file anomaly","body":"<p>I am writing an html file and it's all good while debugging but the html file written is replacing certain characters(for instance some different transcript of single inverted comma that is not on keyboard) with their corresponding encoded version. Why is it so?</p>\n\n<p>Example: UN’s(this apostrophe is troubling)</p>\n\n<pre><code>try\n        {\n            if (!Directory.Exists(path))\n            {\n                Directory.CreateDirectory(Directory.GetParent(path).FullName);\n            }\n            using (StreamWriter file = new StreamWriter(path))\n            {\n                file.Write(text);\n            }\n            //File.WriteAllText(path, text);\n            lblStatus.Content = \"Rendering process finished.\";\n            rValue = true;\n        }\ncatch(Exception ex)\n{\n//logging the exception caught\n}\n</code></pre>\n"},{"tags":["c#",".net","shopify","hmac","sha256"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13254907,"title":"How can I create a matching HMAC value to verify a Shopify WebHook in .NET?","body":"<p>I have set up an endpoint to receive webhook requests from Shopify.</p>\n\n<p>The requests from Shopify include an HMAC header that is created from a shared secret key and the body of the request.</p>\n\n<p>I need to calculate the HMAC on my server and match it to the value in the request header to ensure that the request is authentic.</p>\n\n<p>I can't seem to create the appropriate mechanism in .NET to create a matching HMAC value.</p>\n\n<p>My algorithm at this point is as follows:</p>\n\n<pre><code>public static string CreateHash(string data)\n    {\n        string sharedSecretKey = \"MY_KEY\";\n\n        byte[] keyBytes = Encoding.UTF8.GetBytes(sharedSecretKey);\n        byte[] dataBytes = Encoding.UTF8.GetBytes(data);\n\n        //use the SHA256Managed Class to compute the hash\n        System.Security.Cryptography.HMACSHA256 hmac = new HMACSHA256(keyBytes);\n        byte[] hmacBytes = hmac.ComputeHash(dataBytes);\n\n        //retun as base64 string. Compared with the signature passed in the header of the post request from Shopify. If they match, the call is verified.\n        return System.Convert.ToBase64String(hmacBytes);\n    }\n</code></pre>\n\n<p>The Shopify docs for verifying their webhooks can be found <a href=\"http://wiki.shopify.com/Verifying_Webhooks\" rel=\"nofollow\">HERE</a> but only PHP and Ruby samples are included.</p>\n\n<p>Can anyone see what I might be doing wrong? Should I be just passing the entire JSON request body as a string into this method?</p>\n"},{"tags":["c#","asp.net-mvc","orchardcms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13289169,"title":"How to conditionaly prevent validation on ContentPart field in Orchard CMS?","body":"<p>In a <code>ContentPart</code> some of fields defined by <code>[Required]</code> attribute. but in some situations i don't want validate them.</p>\n\n<p>For example in the <code>ContentPart</code> i have a Boolean field which named <code>DoNotValidate</code>, and when its value assigned with <code>True</code> i want to prevent the requirement validation on fields and does not take any requirement error.</p>\n"},{"tags":["c#","wcf","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13289865,"title":"How can I remove LocalSqlServer connection string and add mine?","body":"<p>I have read many links on this but no luck found.</p>\n\n<p>WCF Service Application throws </p>\n\n<blockquote>\n  <p><em>Object reference not set to an instance an object</em></p>\n</blockquote>\n\n<p>when reading following line.</p>\n\n<pre><code>string connStr1 = \n            ConfigurationManager.ConnectionStrings[\"ConnStr1\"].ToString();\n</code></pre>\n\n<p>My configs are (in all three config files: <code>web.config, web.debug.config, web.release.config</code>)</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;connectionStrings&gt;\n    &lt;remove name=\"LocalSqlServer\"/&gt; &lt;!--Even &lt;clear /&gt; is not working--&gt;\n    &lt;add name=\"ConnStr1\" \n                connectionString=\"Say, xyz\" \n         providerName=\"System.Data.SqlClient\"  /&gt;\n  &lt;/connectionStrings&gt;\n  ...\n</code></pre>\n\n<p>Even if <code>LocalSqlServer</code> has been removed, following line still works</p>\n\n<pre><code>string test = ConfigurationManager.ConnectionStrings[\"LocalSqlServer\"].toString();\n</code></pre>\n\n<p>Any help would be appreciated. </p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":5820,"score":10,"question_id":3778165,"title":"Unescape JavaScript's escape() using C#","body":"<p>Are the any functions in C# that handle escape/unescape like JavaScript?</p>\n\n<p>I have a JSON string like this:</p>\n\n<p><code>{\"Feeds\":[{\"Url\":\"www.test.com\",\"FeedType\":\"Twitter\"},{\"Url\":\"www.test2.com\",\"FeedType\":\"Youtube\"}]}</code></p>\n\n<p>Which looks like this after <code>escape()</code></p>\n\n<p><code>%7B%22Feeds%22%3A%5B%7B%22Url%22%3A%22www.test.com%22%2C%22FeedType%22%3A%22Twitter%22%7D%2C%7B%22Url%22%3A%22www.test2.com%22%2C%22FeedType%22%3A%22Youtube%22%7D%5D%7D</code></p>\n\n<p>In my C# code I would like to unescape this string so that it looks exactly the same as it did before the <code>escape()</code></p>\n\n<p>Is this possible?</p>\n"},{"tags":["c#","javascript","asp.net-mvc","json","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13289531,"title":"JSON calling C# class method","body":"<p>Trying to call a C# class from JSON.</p>\n\n<p>The JSON code is in my master.cshtml file, and looks like this:</p>\n\n<pre><code>var tips = $(\".validateTips\");\n\nfunction updateTips(t) {\n   tips\n   .text(t)\n   setTimeout(function () {\n      tips.removeClass(\"ui-state-highlight\", 1500);\n   }, 500);\n}\n\n$.ajax({\n   type: \"POST\",\n   url: \"/App_Code/LoginClass.cs/test\",\n   data: {},\n   contentType: \"application/json; charset=utf-8\",\n   datatype: \"JSON\",\n   success: function (msg) {\n      updateTips(msg.d);\n   }\n});\n</code></pre>\n\n<p>the C# code is in the file LoginClass.cs and looks like this:</p>\n\n<pre><code>public class LoginClass\n{\n    public static string test()\n    {\n         return \"hello\";\n    }\n}\n\nmy solution folders looks like this:\n+----App_Code\n|    |\n|    +---LoginClass.cs\n|\n+----Views\n|    |\n|    +---Shared\n|        |\n|        +---Master.cshtml\n|\n+----default.cshtml (Where the master layout page is connected to)\n</code></pre>\n\n<p>The updateTips doesn't </p>\n"},{"tags":["c#","popup","umbraco"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13270497,"title":"Creating a custom pop up for Umbraco back office","body":"<blockquote>\n  <p>I think I have a solution. Umbraco uses asp.net files for their popups\n  which is something I haven't used yet but I think I can get the hang\n  of it. I don't know how to access the aspx from within my class,\n  should I make a code behind partial class?</p>\n  \n  <p>Thanks for any help.</p>\n</blockquote>\n\n<p>I am developing a multi-lingual site, using Umbraco, where content nodes are automatically copied to each language as they are created. Is there any way to implement a custom popup to confirm that it should be copied to all instead? </p>\n\n<p>This wouldn't actually be on the site, rather in the back office.</p>\n\n<p>Or is it possible to open a browser popup with c# as all I really need is a bool value from a message box?</p>\n\n<p>[EDIT: added possible solution]</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13290021,"title":"How to get Unique records via LINQ","body":"<pre><code>var EmpRecList = (from ur in db.Users\n  join ug in db.UserGroups on ur.UserGroupID equals ug.UserGroupID\n  select new\n  {\n      lastName = ur.LastName, \n      userID = ur.UserID,\n      firstName = ur.FirstName,\n      userGroupName = ug.UserGroupNameLang1\n  }).Where(oh =&gt; oh.userGroupName.StartsWith(userCur.UserGroupName))\n                                  .OrderBy(x =&gt; x.lastName);\n</code></pre>\n\n<p>I have this code snippet. The problem here is, im getting 2 records with the same user ID. I would like to have a distinct record based on the User ID. Thanks. Tried using distinct method but no success.</p>\n"},{"tags":["c#","asp.net","session","webforms","iterate"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13259394,"title":"Is it possible to iterate through all Sessions stored on Server in C#","body":"<p>I am using the ASP.NET framework( with C#) and I make Session variables for every user. Is it possible to iterate through all Sessions that have been intialized. In this iteration I would also like to change certain properties of some of the sessions.</p>\n\n<p>I am trying to change some data that is stored in session variables. I have session Ids of the particular users for whom I want to change their sessions, so I would also need to be able to compare the Ids.</p>\n"},{"tags":["c#","asp.net","sqldatareader","idatareader"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13279698,"title":"IDataReader not reading, no errors","body":"<p>I realize IDataReader is outdated and some view it as dirty code, but on the site I am working on this is what they use. I have an IDataReader statement to run a query to get a specific id from a table using multiple joins. Now this site has a DAL but it only supports the ability to select from one table at a time, so using select statements with joins do not work with it. This is why I am forced to use IDataReader with this.</p>\n\n<pre><code> if (Request.QueryString[\"CategoryId\"].ToString() == \"0\")\n                {\n                    using (IDataReader getCategoryID = DB.GetRS(\"SELECT ItemCatalogCategory.CategoryID FROM UserCustomerCatalog INNER JOIN ItemCatalogCategory ON UserCustomerCatalog.ItemProfileCatalogID = ItemCatalogCategory.ItemProfileCatalogID \" +\n                              \"INNER JOIN ItemCategory ON ItemCatalogCategory.CategoryID = ItemCategory.CategoryID INNER JOIN StoreCatalog ON UserCustomerCatalog.StoreCatalogID = StoreCatalog.StoreCatalogID \" +\n                              \"WHERE UserCustomerCatalog.ItemProfileCatalogID = '\" + Request.QueryString[\"CatalogID\"] + \"' AND UserCustomerCatalog.CustomerID =' \" + Session[\"Customer\"].ToString() + \"' AND ItemCategory.ProductID = '\" + productis + \"'\"))\n                    {\n\n                        if (getCategoryID.Read())\n                        {\n                            string categoryID = getCategoryID[\"ItemCatalogCategory.CategoryID\"].ToString();\n\n                            string lookmike = Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + categoryID;\n                            Response.Redirect(Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + categoryID);\n\n                        }\n                        else\n                        {\n                            Response.Redirect(Request.Url.AbsolutePath + \"?CatalogID=\" + catalogis + \"&amp;ProductID=\" + productis + \"&amp;CatalogIndex=\" + Request.QueryString[\"CatalogIndex\"] + \"&amp;CategoryID=\" + Request.QueryString[\"CategoryId\"]);\n                        }\n\n                    }//end using getCategoryID\n                }\n</code></pre>\n\n<p>this is what I have, but when it gets to:</p>\n\n<pre><code>if (getCategoryID.Read())\n</code></pre>\n\n<p>it renders as false, there are no exceptions thrown, and no errors or warnings. I have done this type of select in the past with no problems, but I cannot figure out why .Read() is returning false.</p>\n\n<p>Can anyone suggest possible reasons for it not reading? If more code is needed, I can provide as needed. Any help is appreciated, thank you in advance.</p>\n"},{"tags":["c#","asp.net","tinymce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13290063,"title":"Reading the TinyMCE editor content in ASP.NET","body":"<p>Not sure if I am missing something obvious here but how do you read the editor content after a postback? The only methods I can find is to read the value using javascript and then doing an AJAX callback, but I don't want to do that.</p>\n\n<p>Here is how I am rendering my TinyMCE:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src='path'&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n//My settings\n&lt;/script&gt;\n&lt;textarea id=\"txtTinyMce\" runat=\"server\"&gt;\n&lt;/textarea&gt;\n</code></pre>\n\n<p>Then if I attempt to read from <code>txtTinyMce</code> on postback it is empty.</p>\n\n<p>Any help is appretiated.</p>\n"},{"tags":["c#",".net","linq","linq-to-objects"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13289422,"title":"Return multiple rows from a select new using linq","body":"<p>We need to transpose data from the rows in a table to the output table such that that multiple rows are returned for every row in the input table. \nThe logic for extracting data in each row of the output depends if value is present in a given column in the input row.</p>\n\n<p>For e.g.</p>\n\n<p>Input table</p>\n\n<p>A, B, C, D, E, F</p>\n\n<p>Output table</p>\n\n<p>A, B, C, [if value present in D then some operation on value in D]</p>\n\n<p>A, B, C, [if value present in E then some operation on value in E]</p>\n\n<p>A, B, C, [if value present in F then some operation on value in F]</p>\n\n<p>For doing this I intend to something like this:</p>\n\n<pre><code>private IEnumerable&lt;OutputRow&gt; BuildOutputTable(DataTable inputTable)\n{\n    var outputRows = from inputRow in inputTable.AsEnumerable()\n                     select new outputRow(inputRow, *delegateToProcessor*);\n    return gbbOutputRows;\n}\n</code></pre>\n\n<p>But this will need me to iterate through for each of the additional value columns.\nCan I avoid that and just pass a single delegate so that the 'select new outputrow' returns me multiple rows?</p>\n"},{"tags":["c#","richtextbox","selection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":623,"score":0,"question_id":5882203,"title":"c# wpf richtextbox selection","body":"<p>I have a RichTextBox with for example this piece of text:</p>\n\n<p>Hi, my name is {name}!</p>\n\n<p>When I put my cursor between the brackets I want my richtextbox to select the entire word between brackets and also the brackets. </p>\n\n<p>so when I do this: ('|'is the cursor)</p>\n\n<p>Hi, my name is {n|ame}!</p>\n\n<p>I want to select '{name}'</p>\n\n<p>How can I do this? </p>\n"},{"tags":["c#","dll"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":814,"score":2,"question_id":9623694,"title":"TypeLoadException was unhandled in C#","body":"<p>I'm fairly new to C#, and am having a problem when loading a library into my program. Im trying to run <a href=\"http://www.matthewajohnson.org/software/svm.html\" rel=\"nofollow\">this</a> example in visual studio, but I am getting an error:</p>\n\n<pre><code>TypeLoadException was unhandled. Can't load type SVM.Problem from assembly SVM, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.\n</code></pre>\n\n<p>This is what my code looks like:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing SVM;\n\nnamespace SVM\n{\nclass Program\n{\n    static void Main(string[] args)\n    {\n        //First, read in the training data.\n        Problem train = Problem.Read(\"a1a.train\");\n        Problem test = Problem.Read(\"a1a.test\");\n\n        //For this example (and indeed, many scenarios), the default\n        //parameters will suffice.\n        Parameter parameters = new Parameter();\n        double C;\n        double Gamma;\n\n        //This will do a grid optimization to find the best parameters\n        //and store them in C and Gamma, outputting the entire\n        //search to params.txt.\n        ParameterSelection.Grid(train, parameters, \"params.txt\", out C, out Gamma);\n        parameters.C = C;\n        parameters.Gamma = Gamma;\n\n        //Train the model using the optimal parameters.\n        Model model = Training.Train(train, parameters);\n\n        //Perform classification on the test data, putting the\n        //results in results.txt.\n        Prediction.Predict(test, \"results.txt\", model, false);\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I have added the dll as a reference via the solution explorer. What could be going wrong?</p>\n\n<hr>\n\n<p>I have started a new project, added the dll as a reference, ran the project and now everything works. Very frustrating not to know what went wrong, but I suspect it had something to do with the project name and the dll name being the same. Thanks for helping!</p>\n"},{"tags":["c#","multithreading","gdi+","gameloop"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":13289899,"title":"A simple C# game loop using two threads, is this good?","body":"<p>I'm creating a simple game using GDI+ in C#.</p>\n\n<p>First of all I need a game loop, and a render loop. I've decided to break these in to two seperate threads. It seems to work, and runs extremely fast, but the reason I'm asking here is because I see people use timers for their game loops to make them run at a specific frame rate.</p>\n\n<p>This obviously has the advantage, that you can be sure of the speed in which actors move. But my game loops just runs as fast as possible, like the Update function in Unity3D. Now to make sure that actors always move at the same speed, all I have to do is to multiply the move speed by the frame delta time (the time between each frame).</p>\n\n<p>My render loop also runs as fast as possible. Is this a good game loop, why or why not?</p>\n\n<pre><code>// Constructor\npublic FormDisplay()\n{\n    // Create a thread object, passing in the GameLoop method\n    var gameThread = new Thread(this.GameLoop);\n\n    // Start the game thread\n    gameThread.Start();\n\n    // Create a thread object, passing in the GameLoop method\n    var renderThread = new Thread(this.RenderLoop);\n\n    // Start the render thread\n    renderThread.Start();\n}\n\nprivate void GameLoop()\n{\n    while (true)\n    {\n        // TODO: Insert Game Logic\n    }\n}\n\nprivate void RenderLoop()\n{\n    while (true)\n    {\n        // TODO: Insert Render Logic\n    }\n}\n</code></pre>\n"},{"tags":["c#","html","html-parsing","html-tag"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13248789,"title":"Detecting string containing only HTML and no text","body":"<p>Is it possible in C# to check whether a HTML string actually contains some text or is just made up of HTML tags and entities only?</p>\n\n<p>For example</p>\n\n<pre><code>string str = @\"&lt;p xmlns=\"\"http://www.w3.org/1999/xhtml\"\" /&gt;\"\n</code></pre>\n\n<p>This contains only HTML tag and no text.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13288783,"title":"Format of Tracing output in System.Diagnostics.TraceSource","body":"<p>taking the following code into consideration:</p>\n\n<pre><code>    static void Main(string[] args)\n    {\n        TraceSource ts = new TraceSource(\"MyApplication\");\n\n        ts.Switch = new SourceSwitch(\"MySwitch\");\n        ts.Switch.Level = SourceLevels.All;\n\n        ts.Listeners.Add(new TextWriterTraceListener(Console.Out));\n\n        ts.TraceInformation(\"Hello World\");\n        Console.ReadKey();\n    }\n</code></pre>\n\n<p>it generates the following output:</p>\n\n<blockquote>\n  <p>MyApplication Information: 0 : Hello World</p>\n</blockquote>\n\n<p>So, the part \"MyApplication Information: 0 :\" at the beginning of the trace output is coming from the TraceSource class itsself. </p>\n\n<p>However, I need to have a timestamp at the beginning of the line and I would like to change \"Information\" to \"Info\"! Is there any way to get more freedom in trace output such that I can configure it to be like:</p>\n\n<blockquote>\n  <p><strong>13:03:00</strong> - MyApplication <strong>Info</strong>: Hello World</p>\n</blockquote>\n\n<p>I tried for a couple of hours, but with no success. Whatever I do, at the beginning of the output line, there is always this constant predefined \"MyApplication Information: 0 : Hello World\" output.\nMSDN documentation did also not reveal any helpful information.</p>\n\n<p>Any clues???</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","regex","validation"],"answer_count":7,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":24244,"score":10,"question_id":5342375,"title":"c# regex email validation","body":"<p>I use this</p>\n\n<pre><code>@\"^([\\w\\.\\-]+)@([\\w\\-]+)((\\.(\\w){2,3})+)$\"\n</code></pre>\n\n<p>regexp to validate the email</p>\n\n<p><code>([\\w\\.\\-]+)</code> - this is for the first-level domain (many letters and numbers, also point and hyphen)<br><br>\n<code>([\\w\\-]+)</code> - this is for second-level domain<br><br>\n<code>((\\.(\\w){2,3})+)</code> - and this is for other level domains(from 3 to infinity) which includes a point and 2 or 3 literals<br></p>\n\n<p>what's wrong with this regex?</p>\n\n<p>EDIT:it doesn't match the \"something@someth.ing\" email</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":224,"score":0,"question_id":10364233,"title":"get thumbnail from rss feed linq, xml","body":"<p>How can i get the thumbanail</p>\n\n<p>if you view the source feed its here:</p>\n\n<p><a href=\"http://feeds.bbci.co.uk/news/world/middle_east/rss.xml\" rel=\"nofollow\">http://feeds.bbci.co.uk/news/world/middle_east/rss.xml</a></p>\n\n<p>I've tried the following but the last part wont work for media:thumbnail</p>\n\n<pre><code> XDocument feedXML = XDocument.Load(\"http://feeds.bbci.co.uk/news/world/middle_east/rss.xml\");\n            var feeds = from feed in feedXML.Descendants(\"item\")\n                        select new\n                        {\n                            Title = feed.Element(\"title\").Value,\n                            Link = feed.Element(\"link\").Value,\n                            Description = feed.Element(\"description\").Value,\n                            pubDate = feed.Element(\"pubDate\").Value,\n                            guid = feed.Element(\"guid\").Value,\n                            thumbnail = feed.Element(\"media:thumbnail\").Attribute(\"url\").Value\n                        };\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","architecture","n-tier"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13278329,"title":"Business Layer Facade vs Mingled Business Components","body":"<p>I'm currently designing the foundation for a large application.  We are going with the traditional 3 tier system using EF in the data layer, plain jane c# classes in the business layer and MVC / WCF for the ui layer.  We have prototyped enough of the application to realize that this will work for us, however due to the complexity of the business requirements <strong>it will be common for some of the business components interact with one another.</strong></p>\n\n<p>Consider the following two business components:</p>\n\n<ul>\n<li>RetailManager - Deal with everything related to retail in the system</li>\n<li>CartManager - Deals with everything related to the shopping cart experience</li>\n</ul>\n\n<p>The two interact, for instance, during the checkout process when an item is purchased.  The inventory for the purchased item needs to be reduced.</p>\n\n<p>Here is my thought process so far:</p>\n\n<ol>\n<li><p>Let business components reference each other and ensure cyclical references never happen (CartManager references RetailManager, but never the other way).  \"Checkout\" would be a method on the CartManager class, and it would call a method on the RetailManager to adjust inventory.  While this will work, I'm not sure how well it will scale, and what the maintenance cost will be over time.  It doesn't feel 100% \"right\" to me.</p></li>\n<li><p>Create a Facade between the business components and the UI tier.  In this example, the Facade would have the checkout method and a reference to both managers.  I like this approach more than the first, however I know that not all of my business objects will need a Facade, and I don't want to create a ton of Facade classes just to have empty pass through methods.</p></li>\n</ol>\n\n<p>I'm leaning towards 2, with the caveat that I will only create facade classes where needed.  The UI tier will have access to both the Facade and the business layer components and will have to know when to use which (the only part I don't like about this solution).</p>\n\n<p>I've done a lot of research but haven't been able to come to come up with a solution that feels completely right.</p>\n\n<p>Any thoughts on using the facade pattern in this way, or other ideas to solve the problem are welcome.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","c++","marshalling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13289171,"title":"MarshalAs(UnmanagedType.LPStr) - how does this convert utf-8 strings to char*","body":"<p>The question title is basically what I'd like to ask:</p>\n\n<p>[MarshalAs(UnmanagedType.LPStr)] - how does this convert utf-8 strings to char* ?</p>\n\n<p>I use the above line when I attempt to communicate between c# and c++ dlls;\nmore specifically, between:</p>\n\n<p>somefunction(char *string) [c++ dll]</p>\n\n<p>somefunction([MarshalAs(UnmanagedType.LPStr) string text) [c#]</p>\n\n<p>When I send my utf-8 text (scintilla.Text) through c# and into my c++ dll,\nI'm shown in my VS 10 debugger that:</p>\n\n<ol>\n<li><p>the c# string was successfully converted to char*</p></li>\n<li><p>the resulting char * properly reflects the corresponding utf-8 chars (including the bit in Korean) in the watch window.</p></li>\n</ol>\n\n<p>Here's a screenshot (with more details):</p>\n\n<p><img src=\"http://i1280.photobucket.com/albums/a500/daegon123/ss-1.png\" alt=\"ss\"></p>\n\n<p>As you can see, initialScriptText[0] returns the single byte(char): 'B' and the contents of  char * initialScriptText are displayed properly (including Korean) in the VS watch window.</p>\n\n<p>Going through the char pointer, it seems that English is saved as one byte per char, while Korean seems to be saved as two bytes per char. (the Korean word in the screenshot is 3 letters, hence saved in 6 bytes)</p>\n\n<p>This seems to show that each 'letter' isn't saved in equal size containers, but differs depending on language. (possible hint on type?)</p>\n\n<p>I'm trying to achieve the same result in pure c++: reading in utf-8 files and saving the result as char *. </p>\n\n<p>Here's an example of my attempt to read a utf-8 file and convert to char * in c++:</p>\n\n<p><img src=\"http://i1280.photobucket.com/albums/a500/daegon123/ss2.png\" alt=\"ss2\"></p>\n\n<p>observations:</p>\n\n<ol>\n<li>loss in visual when converting from wchar_t* to char*</li>\n<li>since result,s8 displays the string properly, I know I've converted the utf-8 file content in wchar_t* successfully to char *</li>\n<li>since 'result' retains the bytes I've taken directly from the file, but I'm getting a different result from what I had through c# (I've used the same file), I've concluded that the c# marshal has put the file contents through some other procedure to further mutate the text to char *. </li>\n</ol>\n\n<p>(the screenshot also shows my terrible failure in using wcstombs)</p>\n\n<p>note: I'm using the utf8 header from (http://utfcpp.sourceforge.net/)</p>\n\n<p>Please correct me on any mistakes in my code/observations.</p>\n\n<p>I'd like to be able to mimic the result I'm getting through the c# marshal and I've realised after going through all this that I'm completely stuck. Any ideas?</p>\n"},{"tags":["c#","file","text","compare"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13290059,"title":"c# Compare two text files and generate a new one with differences","body":"<p>I am looking for the best way to compare 2 text files (+-15000lines) quickly and get as output strings that are differents in the two files.\n1st one is an old inventory, new one is the current inventory and I would like to generate an third one containing strings that are different between file2 &amp; file1. (95% of the 2 files will be similar).</p>\n"},{"tags":["c#",".net","diagram","system.drawing"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1801,"score":3,"question_id":1993468,"title":"Creating Visio look-a-like diagrams programatically","body":"<p>I need to programatically create Visio look-a-like diagrams as a drawing. Mostly we are going to create network layout diagrams similar to this <a href=\"http://i.msdn.microsoft.com/Bb232815.a27c390d-e9d7-4b2d-97ef-ced4fa09856c%28ja-jp,office.12%29.gif\" rel=\"nofollow\">one</a>. </p>\n\n<p>Is there a component that could speed-up the development or some technique we could use? Generally we could do this on our own via System.Drawing, but this might get tricky for more complex network diagrams as we would have to ensure there are no visual overlappings. </p>\n\n<p><strong>UPDATE:</strong> No Visio available.\n<strong>UPDATE 2:</strong> I would love if these could be eye candy</p>\n"},{"tags":["c#","directx","direct3d","mesh","slimdx"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13290098,"title":"Meshes starting to jump on camera rotation/movement","body":"\n\n<p>Hey together,</p>\n\n<p>first time posting here, because I'm damn stuck...</p>\n\n<p>The further away a mesh is from the origin at (0, 0, 0), the more it \"jumps\"/\"flickers\" when rotating or moving the camera. It's somehow hard to describe this effect: it is like the mesh is jittering/shivering/trembling a little bit and this trembling gets bigger and bigger as you gain distance to the origin.<br>\nFor me, it begins to be observable at around 100000 units distance to the origin, so at (0, 0, 100000) for example. Neither the axis of the translation nor the type of the mesh (default mesh created from Mesh.Create... or with assimp.NET imported 3ds mesh) have influence on this effect. The value of the position of the mesh doesn't change when this effect occurs, checked this by logging the position.</p>\n\n<p>If I'm not missing something, this narrows it down to two possibilities:</p>\n\n<ol>\n<li>My camera code </li>\n<li>The DirectX-Device</li>\n</ol>\n\n<p>As for the DirectX-Device, this is my device initialization code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>    private void InitializeDevice()\n    {\n        //Initialize D3D\n        _d3dObj = new D3D9.Direct3D();\n\n        //Set presentation parameters\n        _presParams = new D3D9.PresentParameters();\n        _presParams.Windowed = true;\n        _presParams.SwapEffect = D3D9.SwapEffect.Discard;\n        _presParams.AutoDepthStencilFormat = D3D9.Format.D16;\n        _presParams.EnableAutoDepthStencil = true;\n        _presParams.PresentationInterval = D3D9.PresentInterval.One;\n        _presParams.BackBufferFormat = _d3dObj.Adapters.DefaultAdapter.CurrentDisplayMode.Format;\n        _presParams.BackBufferHeight = _d3dObj.Adapters.DefaultAdapter.CurrentDisplayMode.Height;\n        _presParams.BackBufferWidth = _d3dObj.Adapters.DefaultAdapter.CurrentDisplayMode.Width;\n\n        //Set form width and height to current backbuffer width und height\n        this.Width = _presParams.BackBufferWidth;\n        this.Height = _presParams.BackBufferHeight;\n\n        //Checking device capabilities\n        D3D9.Capabilities caps = _d3dObj.GetDeviceCaps(0, D3D9.DeviceType.Hardware);\n        D3D9.CreateFlags devFlags = D3D9.CreateFlags.SoftwareVertexProcessing;\n        D3D9.DeviceType devType = D3D9.DeviceType.Reference;\n\n        //setting device flags according to device capabilities\n        if ((caps.VertexShaderVersion &gt;= new Version(2, 0)) &amp;&amp; (caps.PixelShaderVersion &gt;= new Version(2, 0)))\n        {\n            //if device supports vertexshader and pixelshader &gt;= 2.0\n            //then use the hardware device\n            devType = D3D9.DeviceType.Hardware;\n\n            if (caps.DeviceCaps.HasFlag(D3D9.DeviceCaps.HWTransformAndLight))\n            {\n                devFlags = D3D9.CreateFlags.HardwareVertexProcessing;\n            }\n            if (caps.DeviceCaps.HasFlag(D3D9.DeviceCaps.PureDevice))\n            {\n                devFlags |= D3D9.CreateFlags.PureDevice;\n            }\n        }\n\n        //initialize the device\n        _device = new D3D9.Device(_d3dObj, 0, devType, this.Handle, devFlags, _presParams);\n        //set culling\n        _device.SetRenderState(D3D9.RenderState.CullMode, D3D9.Cull.Counterclockwise);\n        //set texturewrapping (needed for seamless spheremapping)\n        _device.SetRenderState(D3D9.RenderState.Wrap0, D3D9.TextureWrapping.All);\n        //set lighting\n        _device.SetRenderState(D3D9.RenderState.Lighting, false);\n        //enabling the z-buffer\n        _device.SetRenderState(D3D9.RenderState.ZEnable, D3D9.ZBufferType.UseZBuffer);\n        //and setting write-access exlicitly to true...\n        //i'm a little paranoid about this since i had to struggle for a few days with weirdly overlapping meshes\n        _device.SetRenderState(D3D9.RenderState.ZWriteEnable, true);\n    }\n</code></pre>\n\n<p>Am I missing a flag or renderstate? Is there something that could cause such a weird/distorted behaviour?</p>\n\n<p>My camera class is based on <a href=\"http://silverwaregames.com/Camera.cpp\" rel=\"nofollow\">Michael Silvermans C++ Quaternion Camera</a>:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>//every variable prefixed with an underscore is \n//a private static variable initialized beforehand\npublic static class Camera\n{\n    //gets called every frame\n    public static void Update()\n    {\n        if (_filter)\n        {\n            _filteredPos = Vector3.Lerp(_filteredPos, _pos, _filterAlpha);\n            _filteredRot = Quaternion.Slerp(_filteredRot, _rot, _filterAlpha);\n        }\n\n        _device.SetTransform(D3D9.TransformState.Projection, Matrix.PerspectiveFovLH(_fov, _screenAspect, _nearClippingPlane, _farClippingPlane));\n        _device.SetTransform(D3D9.TransformState.View, GetViewMatrix());\n    }\n\n    public static void Move(Vector3 delta)\n    {\n        _pos += delta;\n    }\n\n    public static void RotationYaw(float theta)\n    {\n        _rot = Quaternion.Multiply(Quaternion.RotationAxis(_up, -theta), _rot);\n    }\n\n    public static void RotationPitch(float theta)\n    {\n        _rot = Quaternion.Multiply(_rot, Quaternion.RotationAxis(_right, theta));\n    }\n\n    public static void SetTarget(Vector3 target, Vector3 up)\n    {\n        SetPositionAndTarget(_pos, target, up);\n    }\n\n    public static void SetPositionAndTarget(Vector3 position, Vector3 target, Vector3 upVec)\n    {\n        _pos = position;\n\n        Vector3 up, right, lookAt = target - _pos;\n\n        lookAt = Vector3.Normalize(lookAt);\n        right = Vector3.Cross(upVec, lookAt);\n        right = Vector3.Normalize(right);\n        up = Vector3.Cross(lookAt, right);\n        up = Vector3.Normalize(up);\n\n        SetAxis(lookAt, up, right);\n    }\n\n    public static void SetAxis(Vector3 lookAt, Vector3 up, Vector3 right)\n    {\n        Matrix rot = Matrix.Identity;\n\n        rot.M11 = right.X;\n        rot.M12 = up.X;\n        rot.M13 = lookAt.X;\n\n        rot.M21 = right.Y;\n        rot.M22 = up.Y;\n        rot.M23 = lookAt.Y;\n\n        rot.M31 = right.Z;\n        rot.M32 = up.Z;\n        rot.M33 = lookAt.Z;\n\n        _rot = Quaternion.RotationMatrix(rot);\n    }\n\n    public static void ViewScene(BoundingSphere sphere)\n    {\n        SetPositionAndTarget(sphere.Center - new Vector3((sphere.Radius + 150) / (float)Math.Sin(_fov / 2), 0, 0), sphere.Center, new Vector3(0, 1, 0));\n    }\n\n    public static Vector3 GetLookAt()\n    {\n        Matrix rot = Matrix.RotationQuaternion(_rot);\n        return new Vector3(rot.M13, rot.M23, rot.M33);\n    }\n\n    public static Vector3 GetRight()\n    {\n        Matrix rot = Matrix.RotationQuaternion(_rot);\n        return new Vector3(rot.M11, rot.M21, rot.M31);\n    }\n\n    public static Vector3 GetUp()\n    {\n        Matrix rot = Matrix.RotationQuaternion(_rot);\n        return new Vector3(rot.M12, rot.M22, rot.M32);\n    }\n\n    public static Matrix GetViewMatrix()\n    {\n        Matrix viewMatrix, translation = Matrix.Identity;\n        Vector3 position;\n        Quaternion rotation;\n\n        if (_filter)\n        {\n            position = _filteredPos;\n            rotation = _filteredRot;\n        }\n        else\n        {\n            position = _pos;\n            rotation = _rot;\n        }\n\n        translation = Matrix.Translation(-position.X, -position.Y, -position.Z);\n        viewMatrix = Matrix.Multiply(translation, Matrix.RotationQuaternion(rotation));\n\n        return viewMatrix;\n    }\n}\n</code></pre>\n\n<p>Do you spot anything in the camera code which could cause this behaviour?</p>\n\n<p>I just can't imagine that DirectX can't handle distances greater than 100k. I am supposed to render solar systems and I'm using 1 unit = 1km. So the earth would be rendered at its maximum distance to the sun at (0, 0,  152100000) (just as an example). This is becoming impossible if these \"jumps\" keep occuring.\nFinally i thought about scaling everything down, so that a system never goes beyond 100k/-100k distance from the origin, but I think this won't work because the \"jittering\" gets bigger as the distance from the origin gets bigger. Scaling everything down would - i think - scale down the jumping-behaviour, too.</p>\n"},{"tags":["c#","java",".net","mono","graph-databases"],"answer_count":13,"favorite_count":14,"up_vote_count":26,"down_vote_count":0,"view_count":8794,"score":26,"question_id":816055,"title":"Graph database for .NET","body":"<p>I've been designing an application, based on .NET/Mono framework, which should make an heavy use of the <em>shortest-path in a graph</em> theories and I would like to use a native solution to traverse the nodes of the graph, instead of implementing surrogate solutions which would be hardly maintainable and would massively affect performances.</p>\n\n<p>I've found an application which would be perfect for my scope: <strong>neo4j</strong>.</p>\n\n<p>Unfortunately, this application is purely written in Java code and it's not portable to .NET, because of the massive differences between the two architectures.</p>\n\n<p>Is anyone out there knows if is it there any port of neo4j or a similar solution for .NET?</p>\n"},{"tags":["c#",".net","algorithm","project-euler"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":56,"score":-3,"question_id":13282527,"title":"Is my program taking too much time to execute?","body":"<p>I wanted to solve a question from project euleur about finding the largest prime number of a big number. I run my code on a virtual machine on Visual studio 2012, and the code seems froze. When I step into the loop, the code works well, but when I execute it, the console is always there. It is as if the program is still running. Could it be that the program takes time to execute?</p>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>static void Main(string[] args)\n{\n    long number = 5;\n\n    for (long i = 1; i &lt; 600851475143; i++)\n    {\n        if (i % 2 != 0 &amp;&amp; i % 1 == 0 &amp;&amp; i % i == 0)\n            number = i;\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","visual-studio-2010","linq"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13289692,"title":"Remove an item from a linq collection","body":"<p>I think I am putting my question correctly :)</p>\n\n<p>I am querying the db using LINQ to retrieve some data. Please find the code below</p>\n\n<pre><code>  var leadtasktype = _context.LeadTypeTaskTypes.Where(l =&gt; l.LeadTypeId == item.Value);\n\n                foreach(LeadTypeTaskType l in leadtasktype){\n                    if (l.TaskTypeId == 21)\n                    {\n                        //I need to remove an item which has the tasktype id 21\n                    }\n                }\n</code></pre>\n\n<p>As I mentioned in the comments. I need to remove items from the leadtasktype based on my if condition. Any ideas on how to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13290080,"title":"How to ask runtime which .NET Framework was targeted by compile?","body":"<p>Is it discoverable, at runtime, which .NET Framework version was targeted by my own compile?\nThe environment in which I am writing allows me to write C# that is compiled on another machine, but I do not know which language version is available, other than it is 2.0 CLR.  I'd like to write a test that is output to the log file indicating the targeted framework.</p>\n\n<p>For this to work, I'd guess the compiled assembly would have to carry that information.</p>\n\n<p>This question is NOT how to list all frameworks on the runtime machine, as all versions to current are installed.  This is not a duplicate of that question.  This is also not a duplicate of how to determine the CLR with System.Environment.Version.  I'm also not trying to detect at compile time the target .NET runtime.  This needs to be a runtime detection so I can send it to the log.</p>\n"},{"tags":["c#","visio"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":12490916,"title":"auto arrange visio shapes through C#","body":"<p>I am using Microsoft Visio as a COM object in my C# application. I want to auto arrange shapes on a Visio page. What should I code for this task? The shapes are database entities. </p>\n\n<pre><code>userView.Shapes.SomeMethod();\n</code></pre>\n\n<p>userView is name of COM object but what should <code>SomeMethod</code> be?</p>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13289921,"title":"Table attribute displayed","body":"<p>I use Entity Framework in my project.</p>\n\n<pre><code>[Table(\"GetInfo\")]\npublic class InDetails : IEntityWithRelationships\n{\n    [Required]\n    [Key]\n    [Display(Name = \"Primary Key\", Description = \"Primary Key\")]\n    [Editable(false)]\n    [DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)]\n    public long Pkey { get; set; }\n\n    [Required]\n    [Display(Name = \"Facility ID\", Description = \"Facility ID is located at\")]\n    public int FacilityID { get; set; }\n\n    public String Photo { get; set; }\n</code></pre>\n\n<p>You see some have [Required]/[Displayed], but some not.\nWhat is the difference?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13247207,"title":"How to access selected item from dropdown in asp.net mvc3","body":"<p>i am using asp.net mvc3 and i populate a create view using following model </p>\n\n<p><strong>Model</strong> </p>\n\n<pre><code>public class CategoryModel\n{\n    public  int Id { get; set; }\n    public string Name { get; set; }\n    public  string URL { get; set; }\n    public  string Description { get; set; }\n    public  string Logo { get; set; }\n    public  bool IsActive { get; set; }\n    public  bool isPopular { get; set; }\n    public IList&lt;Category&gt; Parentcategories { get; set; }\n\n}\n</code></pre>\n\n<p>In my create View i populate like this </p>\n\n<p><strong>View</strong></p>\n\n<pre><code> &lt;div class=\"editor-field\"&gt;\n        @Html.DropDownList(\"parentcategories\", new SelectList(Model.Parentcategories.Select(c =&gt; c.Name), Model.Parentcategories.Select(c =&gt; c.Name)))\n        @Html.ValidationMessageFor(model =&gt; model.Parentcategories)\n    &lt;/div&gt;\n</code></pre>\n\n<p>now how can i access the selected item in my controller method </p>\n\n<p><strong>Method</strong></p>\n\n<pre><code> [HttpPost]\n    public ActionResult Create( CategoryModel model , HttpPostedFileBase file)\n    {\n     // \n    }\n</code></pre>\n\n<p>thanks,\nAhsan </p>\n"},{"tags":["c#","events","plugins","delegates","add-in"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2504,"score":1,"question_id":435138,"title":"c# - assigning methods to dynamically created controls","body":"<p>I'm designing an application that supports plugin development. Its more of a learning exercise.</p>\n\n<p>All of the assemblies (plugins) being loaded into my app contain a showPrefs() method. As I load each assembly, I want to assign a button to each one so that when I click on the button, it triggers the showPrefs() method of the assembly that the button is assigned to.</p>\n\n<p>How do I do this? A quick and dirty solution would be to change the showPrefs() method signature to be showPrefs(object sender, EventArgs e). This way I can assign it to the button but I think this is a cheap workaround around.</p>\n\n<p>Any ideas?</p>\n\n<hr>\n\n<p>The click event handler only accepts delegates that have the method signature of (object o, EventArgs e) so I don't know how I would assign the showPrefs() method to the click event.</p>\n\n<p>Thats the bit I'm having trouble with.</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":21,"score":-1,"question_id":13289511,"title":"How to load latest news from database and how to read and show them on the main screen by random","body":"<p>I'm trying to create web site which is shows newest news at the home page when it's opening in ASP.NET C#.\nBut i'm not good at html and css. \nCan anyone please help me to find the solution.</p>\n\n<p>thank you</p>\n"},{"tags":["c#","asp.net","iis","connection-pooling"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13287335,"title":"creating pools for iis","body":"<p>I'm new to the world of .net but been programming for ~15 years.\nToday, we have a system (ie inhouse developed) that is client/server based.\nA thin client connects via socket to a business logic process (BLP).</p>\n\n<p>The client sends xml messages to the BLP which replies via the same socket with xml</p>\n\n<p>So far so good. The BLP is written in either unmanaged c, or in Ada (we have two systems, same design)</p>\n\n<p>These BLPs is now to be published as a web service, (or at least some services they provide are)</p>\n\n<p>We've decided on .net/c#/IIS7 as the application server.</p>\n\n<p>The web service request comes in to the IIS, which passes it on to our c# code.\nNow, spawning these BLPs are quite heavy, so I wrote a pool for them, that\nspawns say 10 connections, and some functions that aps.net c# code can call to\nrequire a connection from the pool, and return a connection to the pool.\nThis is basically a connected socket.</p>\n\n<p>My question is then, how to make this pool static in IIS?\nI think it is kind of a 'database' pool, and optimally,\nI would have an entry in web.config that describes the connection pool.</p>\n\n<ul>\n<li>are there any interface I should implement?</li>\n<li>is there any sample code to look at?</li>\n<li>is it doable ?</li>\n</ul>\n\n<p>Most of my searches describe application pools, which I think is not what I want.</p>\n\n<p>Grateful for insightful comments</p>\n\n<p>edit:</p>\n\n<p>hmm, the poll is thread safe, so I tried with the first option first. there was a global.asax and a global.asax.cs alreay, so I put code like </p>\n\n<pre><code>public class WebApiApplication : System.Web.HttpApplication\n{\n    //bnl start\n    private  Pool myPool = null;\n    public Pool MyPool\n    {\n        get { return myPool; }\n    }\n    //bnl stop\n\n    protected void Application_Start()\n    {\n        AreaRegistration.RegisterAllAreas();\n\n        WebApiConfig.Register(GlobalConfiguration.Configuration);\n        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);\n        RouteConfig.RegisterRoutes(RouteTable.Routes);\n        BundleConfig.RegisterBundles(BundleTable.Bundles);\n\n        //bnl start\n        myPool = new Pool(3, 0, \"localhost\", 58031, \"user\", \"pwd\", \"proj\");\n        myPool.Initialize();\n        //bnl stop\n\n    }\n}\n</code></pre>\n\n<p>but then in the  controller, I cannot see the pool ..</p>\n\n<pre><code>    namespace Resttest.Controllers\n    {\n        public class ValuesController : ApiController\n        {\n          // GET api/values\n           public IEnumerable&lt;string&gt; Get()\n           {  \n              // the pool has method getPoolItem to return a free item/connection\n              PoolItem pi = Resttest.WebApiApplication.MyPool.getPoolItem();\n              return new string[] { \"value1\", \"value2\" };\n           }\n</code></pre>\n\n<p>However the Resttest.WebApiApplication.MyPool is not seen from the controller.\nBeing totally novice in this world, is there somthing obviously wrong?\n/Björn</p>\n"},{"tags":["c#","winforms","forms"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13287169,"title":"How to programitically move a control defined with the Windows Form Designer","body":"<p>I think this is an odd one. I have a screen (Windows Forms) created using the Forms Designer. I now want to programmatically change the width of one of the controls, ie at runtime, according to some or other criterion.</p>\n\n<p>My problem is that I can't seem to do this. My approach is to assign a new value to the Width property somewhere after the form class InitializeComponent() method has been executed (say at the end of the form constructor). A watch shows me the control property has been changed, but the subsequently displayed screen ignores the new value and uses the value assigned in InitializeComponent().</p>\n\n<p>Am I trying to do something impossible? Is there some voodoo in the background that blocks this for a control created by the Designer, or am I just going about it the wrong way?</p>\n"},{"tags":["c#","wpf","resources","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13288411,"title":"Prism embedded image","body":"<p>I have a <strong>module</strong> called <code>xModule</code>. I have an <strong>image</strong> inside it marked as <code>embedded resource</code>.</p>\n\n<p>Inside the initialization of the module I tried :</p>\n\n<pre><code>string stFileName = \"SmallIcon.png\";\nstring stAssembly = \"xModule\"; // That's the full name of the assembly\n//img.BeginInit();\n\nUri uri = new Uri(String.Format(@\"/{0};component/Images/{1}\", stAssembly , stFileName),\n                  UriKind.Relative);\nImageSource imgSource = new BitmapImage(uri);\n</code></pre>\n\n<p>During it's coming to the breakpoint on the <code>ImageSource imgSource =..</code> line, it seems the <code>ImageSource</code> can't find the image...</p>\n\n<p>Why? What's wrong with it?</p>\n\n<p>I get no errors, the assembly is referenced. I did something similar in the Xaml and it worked.\nAlso used : VS11, Unity</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13286882,"title":"Lists permutations (unknown number)","body":"<p>I have multiple Lists, could be 2 or 3 up to 10 lists, with multiple\nvalues in them. Now what I need to do is to get a combination of all\nof them.</p>\n\n<p>For example, if I have 3 lists with the following values:</p>\n\n<ul>\n<li>List 1: 3, 5, 7 </li>\n<li>List 2: 3, 5, 6</li>\n<li>List 3: 2, 9</li>\n</ul>\n\n<p>I would get these combinations</p>\n\n<ul>\n<li>3,3,2 </li>\n<li>3,3,9  </li>\n<li>3,5,2\nEtc..</li>\n</ul>\n\n<p>Now the problem is I cannot do this easily because I do not know how many lists I have, therefore determine how many loops I need.</p>\n"},{"tags":["c#",".net","visual-studio-2010","visual-studio","compact-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13289770,"title":"Convert projects from compact framework .NET to the full framework .Net","body":"<p>So I have a big c# solution containing 120 projects. The solution doesn’t contain a user interface and is compiled to support both compact framework and the full framework. The solution is in Visual Studio 2005 format.</p>\n\n<p>I would like to remove the support for Windows CE and convert it all to target the full framework and open it in Visual Studio 2010.</p>\n\n<p>What I want to do is remove the support for compact framework from the whole solution.</p>\n\n<p>How should I proceed? Is it possible to just convert the projects to the full framework?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13289575,"title":"How to access record from database usign linq-to-sql?","body":"<p>I am working on <code>Linq to sql</code>. I have created a function to search records in database. My functions is :</p>\n\n<pre><code>    public IEnumerable&lt;Record&gt; SearchRecord()\n    {\n      var records = db.Records.Where(r =&gt; r.Name == Name &amp;&amp; r.Date == Date \n                                                &amp;&amp; r.Country == Country);\n        return records;\n    }\n</code></pre>\n\n<p>I am trying to handle the case where if any one property out of <code>Name, Date and Country</code> is null. In that case i just want to remove that filter and fetch records only on the basis of non-null properties.I don`t want to add if - else conditions. How can i do this ?</p>\n"},{"tags":["c#",".net","roslyn-ctp","roslyn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13289701,"title":"Cannot download Roslyn","body":"<p>I am trying to get hold of Microsoft's Roslyn compiler service however the following (supposedly official) link is broken. <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=27746&amp;mnui=0\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=27746&amp;mnui=0</a></p>\n\n<p>Am I missing something or is there an alternative download location?</p>\n"},{"tags":["c#",".net","winforms","event-handling","datagridviewcombobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":183,"score":0,"question_id":7074149,"title":"Event of DataGridViewComboBoxCell","body":"<p>I am using the following code for binding a combo box column in a grid view in my winform    </p>\n\n<pre><code>DataGridViewComboBoxCell dgBatch = (DataGridViewComboBoxCell)grvProduct.Rows[pRowIndex].Cells[pComboColName];\n                DataTable dtBatch = new DataTable();\n                dtBatch = iExportSalesOrder.SelectProductDetails(pack_detl_ID);\n                dgBatch.DataSource = dtBatch;\n                dgBatch.ValueMember = \"qty\";\n                dgBatch.DisplayMember = \"sBatch_No\";\n</code></pre>\n\n<p>How can i get the <code>selectedindexchange</code> event of this combo box column?</p>\n"},{"tags":["c#","linq","logical-operators"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13289265,"title":"slightly complex matching condition","body":"<p>The code below represents what I am trying to write. The requirement is that the tax profile should match the correct currency. I have written the if conditions in my code below. However there are more than 100 tax profiles that are read via a database. <strong>Should I write if conditions for all 100 of them or is there a better way to code?</strong></p>\n\n<pre><code>using System;\n\nnamespace MatchCondition\n{\n    class MatchCondition\n    {\n        private const int TaxAmerica1 = 100;\n        private const int TaxAmerica2 = 200;\n        private const int TaxIndia1 = 300;\n        private const int TaxIndia2 = 400;\n\n        private const int Rupee =100;\n        private const int Dollar =200;\n\n        static void Main(string[] args)\n        {\n            try\n            {\n\n                int currencyId = int.Parse(args[0]);\n                int taxProfileId = int.Parse(args[1]);\n                if (currencyId == Rupee &amp;&amp; (taxProfileId == TaxIndia1 || taxProfileId == TaxIndia2))\n                {\n                    Console.WriteLine(\"All is well!\");\n                }\n                else if(currencyId == Dollar &amp;&amp; (taxProfileId == TaxAmerica1 || taxProfileId == TaxAmerica2))\n                {\n                    Console.WriteLine(\"All is well!\");\n                }\n                else if (taxProfileId == 0)\n                {\n                    Console.WriteLine(\"All is well!\");\n                }\n                else\n                {\n                    Console.WriteLine(\"Mismatch Detected!\");\n                }\n\n            }\n            catch (Exception exception)\n            {\n                Console.WriteLine(exception.Message);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","menu","multiple-columns","aspmenu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13288506,"title":"Is it in any way possible to get the asp:menu items sepparated in multiple-columns?","body":"<p>Is there any way to get the asp:menu items separated into multiple columns? I get the menu items from a System.Web.XmlSiteMapProvider and then \"forward\" them to a SiteMap to be used with the asp:menu.\nI need a menu structured like:</p>\n\n<pre><code>Item1 Item5 Item9  Item11\nItem2 Item6 Item10 Item12\nItem3 Item7 Item11 Item13\nItem4 Item8 Item12 Item14\n</code></pre>\n\n<p>And so on.. \nHow do i achive this based on a System.Web.XmlSiteMapProvider?</p>\n"},{"tags":["c#","multithreading","queue","synchronize"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13284730,"title":"Synchronize threads access to fixed size queue by threads order - C#","body":"<p>I was asked the following question in an interview:</p>\n\n<p>There is a <strong>fixed size</strong> queue of tasks. Threads want to enqueue task. If the queue is full they should wait. The threads order should remain: if thread1 came with task1 and after that thread2 came with task2, task1 should enter the queue before task2.</p>\n\n<p>Other threads want to dequeue tasks and execute it. If the queue is empty, they should wait, and also their order should remain: If t3 came before t4, t3 should enqueue task before t4.</p>\n\n<p>How to achieve this (in pseudo-code)?</p>\n"},{"tags":["c#","wpf","datagrid","refresh"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2527,"score":1,"question_id":6056098,"title":"How Can I refresh my Datagrid on WPF automatically for every 1 minute?","body":"<p>I want to be able do refresh my datagrid, because I am updating my table on my database datagrid and want to see the changes in grid , is there any way of automatically updating datagrid for every 1 minute?</p>\n\n<p>Help.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":126,"score":-3,"question_id":7431596,"title":"Blocking a sender in gmail","body":"<p>I am developing a application blocking a sender in gmail filter through c#.net.\nI am a using gmail api to block a sender using the following line,</p>\n\n<pre><code>GoogleMailSettingsService service = new GoogleMailSettingsService(\"yourdomain\", \"your-apps\");\n</code></pre>\n\n<p>what is \"yourdomain\" and \"your-apps\" fields.</p>\n\n<p>Or </p>\n\n<p>Kindly advice how to block a sender in gmail thorough a c#.net code.</p>\n"},{"tags":["c#","excel","gridview","export"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13289135,"title":"Exporting a gridview to excel in c#","body":"<p>I have to export an gridview to excel. I am using the following code in button click event funcion :</p>\n\n<pre><code>Response.Clear();\n\nResponse.Buffer = true;\n\nResponse.AddHeader(\"Content-Disposition\",\"attachment;filename=sample.xls\");\n\nResponse.Charset = \"\";\n\nResponse.ContentType = \"app`enter code here`lication/vnd.xls\";\n\nStringWriter stringWriter = new StringWriter();\n\nHtmlTextWriter htw = new HtmlTextWriter(stringWriter);\n\ngrdVw.RenderControl(htw);\n\nResponse.Write(stringWriter.ToString());\n\nResponse.End();\n</code></pre>\n\n<p>when I run this a dialog box is opening showing to download an empty XML file. When I tried to debug it, I found that grid has data but it stringWriter is not getting populated. I tried to change the content type to \"application/ms-excel\" etc. but no result. What is the error in the code and what might be the reason fot stringWriter not getting populated?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","vb.net","skype"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13287825,"title":"skype webcam not working","body":"<p>Can anyone give me example, how to send and receive webcam data. I mean, how to send local webcam to contact and contact's webcam in my application. I have tried a lot to find any working example but I cannot.</p>\n\n<pre><code>   public void SwitchPicModeToVideo()\n            {\n                if (pic.IsRunning) return;\n                if (pictureMode != PictureMode.Video) pictureMode = PictureMode.Video;\n                pic.VideoObject = video;\n                Console.WriteLine(P_VIDEO_STATUS);\n                if (P_IDENTITY == account.P_SKYPENAME)\n                {\n                    if (screenshare == true)\n                    {\n                        video.SelectVideoSource(SktVideo.MEDIATYPE.MEDIA_VIDEO, webcam.name, webcam.path);\n                    }             \n                }\n                else // getting video object for remote (incoming) video\n                {\n                    // only using the 1st (0th) element in the resulting video list,\n                    // as SkypeKit does not actually support multiple video streams\n                    SktVideo.List videos = this.GetLiveSessionVideos();\n                    if (videos.Count == 0) return;  // this is always 0\n                    this.video = (Video)videos[0];\n                    this.video.participant = this;\n                }\n\n\n                video.Start();\n                pic.Start();\n\n\n            }\n</code></pre>\n"},{"tags":["c#","jquery",".net","ajax","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13288342,"title":"Ajax jquery C# .net JSON passing params into [webmethod] from javascript - internal server error","body":"<p>the javascript to pass params:</p>\n\n<pre><code>&lt;script&gt;    \n    var str = \"pears\"\n    $.ajax({\n        url: 'WebService.asmx/HelloWorld', //'/WebService.asmx/HelloWorld',\n        data: \"{outputtype:'\" + str + \"'}\",\n        type: \"POST\",\n        cache: false,\n        dataType: 'json',\n        contentType: \"application/json; charset=utf-8\",\n        success: function (msg) {\n            var response = msg.d;\n            alert(response);\n        },\n        error: function (xhr, status, error) {\n            alert(error + \"\\n\" + xhr + \"\\n\" + status); //do something if there is an error\n        }\n    });\n</code></pre>\n\n<p>and the webmethod:</p>\n\n<pre><code>[WebMethod]\npublic string HelloWorld(String str)\n{\n    return str;\n}\n</code></pre>\n\n<p>I've spent an entire day on this and tried out countless variations of passing params into this method but none work. I've tried on different machines and I've tried making the webmethod static and I've tried various ways of passing in the values from the javascript.</p>\n\n<p>It will however work if I DON'T pass params.</p>\n"},{"tags":["c#","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13289558,"title":"Animation in windows store app using c#","body":"<p>I have an usercontrol in a grid that i want to reposition 400 pixels with an animation.\nI can use the following code to reposition it without animation.</p>\n\n<p><code>ucChat.Margin = new Thickness(0, -400, 0, 0);</code></p>\n\n<p>i try to use the following code to animate it but i get an exception</p>\n\n<pre><code>DoubleAnimation da = new DoubleAnimation();\nda.Duration = new Duration(TimeSpan.FromMilliseconds(1500));\nda.From = 0;\nda.To = -400;\n\nStoryboard st = new Storyboard();\nStoryboard.SetTarget(da, ucChat);\nStoryboard.SetTargetProperty(da, \"ucChat.Margin.Top\");\nst.Children.Add(da);\n\nst.Begin();\n</code></pre>\n\n<p>An exception of type 'System.Exception' occurred in Regenwormen.exe but was not handled in user code\nWinRT information: Cannot resolve TargetProperty ucChat.Margin.Top on specified object.</p>\n\n<p>Does anyone have an idea how i can solve this or what animation i need to use ? (thicknessanimation doesn't excists in windows store apps)</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13283357,"title":"C# ASP.net File search","body":"<p>I have website developed in C# and ASP.Net \nI am trying to enable the search functionality in it by using a text box for the user to enter the file name and search for it. i got the logic to get the file names that matches the string entered by the user. Now, i am stuck on how to display the files in the .aspx page. I have to display the file name with href link to download it. the files are generally pdf, ppt, chm etc..\nI have no clue on how to proceed further in this issue. Any help would be appreciated. </p>\n"},{"tags":["c#","named-pipes"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3696,"score":0,"question_id":1247237,"title":"NamedPipeServerStream/async reliable disconnect issues","body":"<p>We're using named pipes to communicate between a C# .Net service and a native C++ application. The service creates a message mode pipe, then kicks off a timer. </p>\n\n<pre><code>     m_pipeServer = new NamedPipeServerStream (\"Cyber_Srv_EventPipe\",\n                                             PipeDirection.InOut,\n                                             1,\n                                             PipeTransmissionMode.Message,\n                                             PipeOptions.Asynchronous,\n                                             4096,\n                                             4096,\n                                             pipeSa);\n     m_OutputQueue = new List&lt;My_Message&gt;();\n</code></pre>\n\n<p>In the timer tick routine is the main service loop, which looks like this:</p>\n\n<pre><code>     do\n     {\n        if (!m_bClientAttached)\n        {\n           try\n           {\n              m_pipeServer.WaitForConnection ();\n              m_bClientAttached = true;\n           }\n           catch (InvalidOperationException invope)\n           {\n              sDebug = string.Format (\"Pipe wait exception InvOpEx: {0}\",\n                                      invope.Message);\n              DebugMessage (sDebug);\n           }\n        }\n\n        // the message-pumping part of the loop. \n\n        if (m_bClientAttached)\n        {\n           try\n           {\n              if (!m_bReadInProgress)\n              {\n                 m_bReadInProgress = true;\n                 m_pipeServer.BeginRead (byNewRead, 0, byNewRead.GetLength (0),\n                                       new AsyncCallback (this.PipeReadComplete),\n                                       m_iReadCount);\n              }\n\n              if (m_OutputQueue.Count () &gt; 0)\n              {\n                 if (!m_bWriteInProgress)\n                 {\n                    m_bWriteInProgress = true;\n                    My_Message opmsg = m_OutputQueue.ElementAt (0);\n                    m_pipeServer.BeginWrite (opmsg.ToByteArray (), 0,\n                                             (int)(opmsg.MsgLength),\n                                             new AsyncCallback (this.PipeWriteComplete),\n                                             m_iWriteCount);\n                 }\n              }\n           }\n           catch (IOException ioe)\n           {\n              sDebug = string.Format (\"Main loop raised exception: {1}\",\n                                      ioe.Message);\n              DebugMessage (sDebug);\n              DetachClientPipe();\n           }\n           Thread.Sleep(1);\n        }\n\n     } while (m_bRunning);\n\n     m_pipeServer.Close ();\n  }\n</code></pre>\n\n<p>The read and write completion routines look like this:</p>\n\n<pre><code>  private void PipeReadComplete (IAsyncResult iAR)\n  {\n     string sDebug;\n     int iByteCount;\n     My_Message ipmsg = new My_Message();\n     try\n     {\n        iByteCount = m_pipeServer.EndRead (iAR);\n        if (iByteCount &gt; 0) \n        {\n           ipmsg.FromByteArray(byNewRead);\n           m_bReadInProgress = false;\n           ... process message ...\n        }\n        else\n        {\n           try\n           {\n              DebugMessage (\"PRC: Zero bytes read, disconnect pipe\");\n              DetachClientPipe();\n           }\n           catch (InvalidOperationException invope)\n           {\n              sDebug = string.Format (\"PRC - Pipe disconnect exception: {0}\",\n                                      invope.Message);\n              DebugMessage (sDebug);\n           }\n        }\n     }\n     catch (IOException e)\n     {\n        sDebug = string.Format (\"PRC: Read {0} raised exception: {1}\",\n                                (int)(iAR.AsyncState),\n                                e.Message);\n        DebugMessage (sDebug);\n        DetachClientPipe();\n     }\n  }\n\n  // ------------------------------------------------------------------\n\n  private void PipeWriteComplete (IAsyncResult iAR)\n  {\n     string sDebug;\n     try\n     {\n        m_pipeServer.EndWrite (iAR);\n        lock (m_OutputQueue)\n        {\n           m_OutputQueue.RemoveAt(0);\n        }\n        m_bWriteInProgress = false;\n     }\n     catch (IOException e)\n     {\n        sDebug = string.Format (\"Write {0} raised exception: {1}\",\n                                (int)(iAR.AsyncState),\n                                e.Message);\n        DebugMessage (sDebug);\n        DetachClientPipe();\n     }\n  }\n\n  // ------------------------------------------------------------------\n\n  private void DetachClientPipe()\n  {\n     if (m_pipeServer.IsConnected)\n     {\n        m_pipeServer.Disconnect();\n     }\n     m_bClientAttached = false;\n  }\n</code></pre>\n\n<p>The client side code is known good code, re-used. So here's the problem. The client can connect fine. We then shut down the client, everything is fine. We start it up and conect again. All fine, then we close it and start it again. Boom - error 231, pipe busy. the server will now generate pipe busy errors on any connection attempt until hell freezes over, or we restart the service. Then we're back to two connections again.</p>\n\n<p>I've been staring at this code for three straight days now, and I have no idea why it does this. I can't seem to see the wood for the trees, and I could use a fresh pair of eyes or three. Problem is no-one else in the team knows much of any C#.</p>\n\n<p><strong><em>Update</em></strong></p>\n\n<p>The reason this fails on the third connect attempt appears to be that on the first disconnect the PipeReadComplete returns and I get zero bytes read, so I detach the pipe and all is well. BUT... on the second disconnection, PipeReadComplete does NOT get called, so I don't force the disconnect. Weird.</p>\n"},{"tags":["c#","silverlight-4.0","listbox"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2797,"score":1,"question_id":6372904,"title":"How to change listbox item's color individually programmatically in silverlight?","body":"<p>I have an chat like tcp application.I want to differ the colors of sent and received messages. How can I do that programmatically?\nAny help is appreciated</p>\n\n<p><strong>Edit</strong>\nIt would be ok if I can change the row color instead.</p>\n"},{"tags":["c#","excel","datagridview","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13289251,"title":"Export from Excel to DataGridView, missing string","body":"<p>I have problem with export from Excel to dataTable. When I have too many text in a cell, it export to dataGridView but some text is missing. I think because my DataTable is limited to some characters. Can anyone help me with it?</p>\n\n<p>Example in Excel Cell I have :</p>\n\n<pre><code>15 ha\n14 ee\n13 oo\n...\n2  dd\n1  qq\n0  rr  \n</code></pre>\n\n<p>and when i export to dataGridView i just have</p>\n\n<pre><code>15 ha\n14 ee\n13 oo\n...\ntill 5 vv\nand the rest can not be seen\n</code></pre>\n\n<p>the code i use:</p>\n\n<pre><code>            System.Data.OleDb.OleDbConnection conn = new System.Data.OleDb.OleDbConnection(\"Provider=Microsoft.Jet.OleDb.4.0; Data Source = \" + userSelectedFilePath2 + \"; Extended Properties = \\\"Excel 8.0;HDR=Yes;IMEX=1\\\";\");\n\n            conn.Open();\n\n            string query = String.Format(\"select * from [{0}$]\", \"ABC\");\n            OleDbDataAdapter dataAdapter = new OleDbDataAdapter(query, conn);\n            DataSet dataSet = new DataSet();\n            dataAdapter.Fill(dataSet);\n            dataGridView1.DataSource = dataSet.Tables[0];\n</code></pre>\n"},{"tags":["c#","ip","packet"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13289459,"title":"send raw socket in C# , best Way","body":"<p>i want to make my own packet and create ttl, options , flags , source and destination port and ip and all of the packet fileds, how can i do ?\ni searched and founded sharppcap and packet.net and eExNetworkLibrary , but not good sample to use them !\nwhich one is better and how it is possible to make my own packet and send to destination ip ?</p>\n"},{"tags":["c#","multithreading","design-patterns","timer","singleton"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13288695,"title":"System.Timer as a Singleton","body":"<p>I have data which is constantly being read by many threads. This data needs to be updated daily.</p>\n\n<p>My approach has been to use a <code>ReaderWriterLockSlim</code> to manage access to the data. Every night the first thread to detect the day change applies a <code>WriteLock</code> to the data and updates it.</p>\n\n<p>In order to avoid the constant check for the day change event. I would ideally like to create a System.Timer object as a singleton and have it automatically start and then execute every 24hrs thereafter.</p>\n\n<p>This has been my approach:</p>\n\n<p>First I extended System.Timers to execute the callback on init.</p>\n\n<pre><code>using System.Timers;\n\nnamespace Utilities\n{\n    class AutoStartTimer : Timer\n    {\n        public AutoStartTimer(ElapsedEventHandler callback, int period):base(period)\n        {\n            callback(null, null);\n            AutoReset = true;\n            Elapsed += callback;\n            Enabled = true;\n        }\n    }\n}\n</code></pre>\n\n<p>Then I declared it at a singleton where I needed it.</p>\n\n<pre><code>private static AutoStartTimer _loadDataTimer = \n                                new AutoStartTimer(DataLoader, 86400000); // Daily\n</code></pre>\n\n<p>This approach is working for me so far. However I would like to know if there are any better ways to implement a Singleton Timer which executes once on initialisation and then for a set period afterwards or if anyone has managed to do this more efficiently without extending the Timer class. </p>\n\n<p>I need to use many of these in my current project so I want to make sure I am using a good approach.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","c++","visual-studio-2010","visual-studio","keyboard-shortcuts"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":144,"score":1,"question_id":11336233,"title":"How to disable Up/Down keys from scrolling through method overload in Visual Studio?","body":"<p>In Visual Studio 2010 C++/C# (And pretty much every version of VS), the Up/Down arrow keys will scroll through tooltip method overloads when the tooltip is active (Either by typing a method name or by pressing Ctrl+Shift+Space while inside a method).</p>\n\n<p>Is there any way to disable this feature? I constantly get hung up while trying to navigate a file with the keyboard when these tooltips appear. If there was a way to use Ctrl+Up/Down to scroll method overloads instead, that would be great, but disabling the feature entirely would be enough.</p>\n\n<p>I just want my text editor to let me navigate and edit text and stop hijacking my arrow keys. Any ideas?</p>\n"},{"tags":["c#","binding","devexpress","xtragrid"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2203,"score":0,"question_id":5055738,"title":"C# DevExpress XtraGrid, bind to property of nested class","body":"<p>It's easy to bind an XtraGrid control to a class by setting the FieldName for each column to the name of a property in the underlying class. We have now encountered a situation in which we would like to display data from a class nested in the underlying class.</p>\n\n<p>i.e. we have a \"User\" class which contains a property called \"Address\" which is another class called \"Address\". Within Address are properties like Street, City etc.</p>\n\n<p>We would like to display on the grid the UserName (from User class) and Street (from the Address class). Is this possible? </p>\n\n<p>Please note that Address is not a List, it is a class nested inside of the User class.</p>\n\n<p>We have tried setting the grid column FieldName to \"Address.Street\" however this doesn't work to pickup the data. I am hoping that this is possible, it seems an elementary feature to not support.</p>\n"},{"tags":["c#","hotkey","registerhotkey"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1550,"score":4,"question_id":4704134,"title":"Register more than one hotkey with RegisterHotKey","body":"<p>I found this little piece of code to register an hotkey:</p>\n\n<pre><code>    [DllImport(\"user32.dll\")]\n    public static extern bool RegisterHotKey(IntPtr hWnd, int id, int fsModifiers, int vlc);\n\n    protected override void WndProc(ref Message m)\n    {\n        if (m.Msg == 0x0312)\n            MessageBox.Show(\"Hotkey pressed\");\n        base.WndProc(ref m);\n    }\n\n    public FormMain()\n    {\n        InitializeComponent();\n        //Alt + A\n        RegisterHotKey(this.Handle, this.GetType().GetHashCode(), 1, (int)'A');\n    }\n</code></pre>\n\n<p>It works perfectly, but my problem is I want to use two different shortcuts. I know the second parameter is the id, so I figure I could make a different id and add a new if statement in the WndProc function but I'm not sure how I would go about that.</p>\n\n<p>In short, how would I go about creating a second shortcut?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13289121,"title":"asp.net - Specified cast not valid Linq","body":"<p>I got this error when I am trying the below code</p>\n\n<pre><code>IEnumerable&lt;DataRow&gt; projjType = from projT in dtProjList.AsEnumerable()\n                                 where projT.Field&lt;int?&gt;(\"ProjectId\") == projId &amp;&amp; \n                                 projT.Field&lt;int?&gt;(\"FilterId\") == 1 \n                                 select projT;\n</code></pre>\n\n<p>and the stack trace of error is   </p>\n\n<pre><code>at System.Data.DataRowExtensions.UnboxT`1.NullableField[TElem](Object value)\n   at System.Data.DataRowExtensions.Field[T](DataRow row, String columnName)\n   at Folder.Projects.&lt;&gt;c__DisplayClass28.&lt;repProjectList_ItemDataBound&gt;b__1e(DataRow projT) in D:\\Folder\\Project.aspx.cs:line 1061\n   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()\n   at System.Linq.SystemCore_EnumerableDebugView`1.get_Items()\n</code></pre>\n\n<p>where the dtProjList is DataTable,and Table Structure is as follows,</p>\n\n<pre><code>ProjectId (int)\nProjectName (string)\nProjectThumb (string)\nFilterTypeId (int)\nFilterId (int)\nFilterType (string)\n</code></pre>\n\n<p>all are not null values.Can anybody please help me out.</p>\n\n<p>thanks in advance.</p>\n\n<p><strong>Update</strong> :: This is onlyrecord in my table,is the error because of the single record ??</p>\n\n<pre><code>ProjectId   ProjectName ProjectThumb    FilterTypeId    FilterId    FilterType\n   1    Datamaster  small_14.jpg         1             1               Final\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13288456,"title":"How to execute different statements based on the file version of a referenced dll?","body":"<p>I have a C# dll that references a 3rd party dll. There are different versions of the 3rd party dll. </p>\n\n<p>As you might expect if the latest 3rd Party dll is present I want to use the new functionality if not I want to execute the old functionality.</p>\n\n<p>I wasn't sure how to achieve this but I thought the first thing to try would be a simple if statement that decides which function to call.</p>\n\n<p>So I find the assembly, get its location and hence its version info. (I need the file version as the product versions are the same). </p>\n\n<p>Then a simple </p>\n\n<pre><code>if (version &gt;= 3) do x() else do y()\n</code></pre>\n\n<p>When I execute the code on a machine with version 2 installed I get a <code>MissingMethodException</code> regarding <code>x()</code>. I thought I had made a stupid mistake but the logic was correct. The version is 2 so <code>x();</code> should not be executed. I decided to remove the offending method and replace it with a <code>throw new Exception()</code>. The exception is not thrown and the code completes successfully.</p>\n\n<p>Here is the danger - I am thinking that this is due to branch prediction. This is dangerous because it is not an area I have any knowledge of and therefore making assumptions is a dangerous thing.</p>\n\n<p>So my questions are:</p>\n\n<p>Am I tacking this problem the wrong way - is there a more obvious solution that I am missing?</p>\n\n<p>or</p>\n\n<p>Is there a way to disable branch prediction (if that is the cause) or to somehow enforce/flag the if condition as a point that must be executed before continuing.</p>\n\n<p>Here is the code being executed:</p>\n\n<ul>\n<li>On a machine with version 3 installed then it is fine.</li>\n<li>On a machine with version 2 installed I get a <code>MissingMethodException</code> regarding method <code>x()</code>.</li>\n<li>It I removed the call to <code>x();</code> and uncomment the throwing of the exception - no exception is thrown.</li>\n</ul>\n\n<p>Relevant code:</p>\n\n<pre><code>Assembly assembly = System.Reflection.Assembly.GetAssembly(typeof(3rdPartyClass));\nFileVersionInfo fileVersionInfo = FileVersionInfo.GetVersionInfo(assembly.Location);\n\nif (fileVersionInfo.FileMajorPart &gt;= 3)\n{\n    // throw new Exception(\"aagghh\");\n    x();\n}\nelse\n{\n    y();\n}\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":30,"score":-3,"question_id":13289080,"title":"How to disable/make invalid link after a time period","body":"<p>In my project I have the requirement as follows.\nSend an email to registered users with sign in link details.\nAfter a certain period of time elapses, the signin link should not work when user clicks on it.\nHow do you implement a timeout?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":48,"score":-3,"question_id":13287853,"title":"calculate IP range numbers from 2 given IP addresses","body":"<p>i am using pcapdotnet DLL's in my application and one of the option i have added is to change the packet ip address before sending the pcap file (send to my function 2 ip's: old ip address and the new ip address i want to change).</p>\n\n<p>now i want to add another option that can change range of ip address.</p>\n\n<p>for example:</p>\n\n<p>old ip addreee is 70.1.2.3 and the range is 10.0.0.1 until 212.0.0.0 </p>\n\n<p>so the ip address 70.1.2.3 will change to 10.0.0.1 and than 10.0.0.2 up to 70.1.2.3 and i am looking the best way to do it.</p>\n\n<p>so far i only see this post who did not help me: <a href=\"http://stackoverflow.com/questions/9032348/is-there-easy-way-of-calculating-number-of-ips-from-2-given-ip-addresses\">Is there easy way of calculating number of IPs from 2 given IP addresses?</a></p>\n"},{"tags":["c#","asp.net","visual-studio-2010","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13288673,"title":"Adding new item with EF with identity column","body":"<p>How can I add a new entity with EF where I have <code>Id</code> column which is defined as <code>identity</code> in the database ?</p>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Cannot insert explicit value for identity column in table 'AppsData'\n  when IDENTITY_INSERT is set to OFF.</p>\n</blockquote>\n\n<p>But I cannot set the <code>Id</code> to null, as it's an <code>int</code> in the database (not even nullable)</p>\n\n<p>My function is:</p>\n\n<pre><code>    public Conduit.Mam.MaMDBEntityFramework.AppsData Add(Conduit.Mam.MaMDBEntityFramework.AppsData item)\n    {   \n        maMdbEntities.AddToAppsDatas(item);\n\n        maMdbEntities.SaveChanges();\n\n        return item;\n    } \n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":672,"score":2,"question_id":3111831,"title":"Populating combobox according to selected index from another combobox","body":"<p>OMG I've been doing this for two days and still i cannot get the solution. This is my scenario:</p>\n\n<p>I have three comboboxes control and I need to load  with data from dataset dinamically.</p>\n\n<ul>\n<li>cbCode1 is populated with the load form.</li>\n<li>cbCode2 is populated when the selected index from cbCode1 changes</li>\n<li>cbCode3 is populates when the selected index from cbCode1 changes</li>\n</ul>\n\n<p>the data is coming from two fields in the datset \"description\" and \"id_code\". So I want to associate the value of the description with its id. Because I need to ask for this later..</p>\n\n<p>In the load form I have this:</p>\n\n<p>cbCode1.DataSource = D.Tables[0];\ncbCode1.DisplayMember = D.Tables[0].Columns[\"description\"].ColumnName;\ncbCode1.ValueMember = D.Tables[0].Columns[\"id_code\"].ColumnName;</p>\n\n<p>Now when the selected index from cbcode1 changes:</p>\n\n<pre><code>private void cbCode1_SelectedIndexChanged(object sender, EventArgs e)\n    {\n\n        // Get dataset from DB\n        DataSet D = new DataSet();\n        D = reason_get(1, 1, 1); // IdStation, Active, Level\n\n        // Ensure the cbcode2 is cleared\n        cbCode2.Items.Clear();\n        string SelectedValue = cbCode1.SelectedValue.ToString();\n\n        foreach (DataRow row in D.Tables[0].Rows)\n        {\n\n\n            if (row[\"id_parent_code\"].ToString () == SelectedValue ) \n            {\n\n                cbCode2.DataSource = D.Tables[0];\n                cbCode2.DisplayMember = D.Tables[0].Columns[\"description\"].ColumnName;\n                cbCode2.ValueMember = D.Tables[0].Columns[\"id_code\"].ColumnName;\n\n                cbCode2.SelectedIndex = 0;\n\n            }\n        }\n\n\n\n    }\n</code></pre>\n\n<p>This code doesn't work i don't know what I'm doing wrong. please help to solve this issue?</p>\n\n<p>Thanks in advance!</p>\n\n<p>A newbie programmer..</p>\n"},{"tags":["c#","mysql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13289176,"title":"Connect versions of .net mysql issues?","body":"<p>I installed mysql-connect 6.64 in my system and my sql version is 5.50  then we are accessing mysql successfully.but not able to connect mysql version 5.24 .why this is it version of mysql problem or ?</p>\n\n<p>please tell me why i am getting  while conencting mysql from .net </p>\n\n<pre><code>unable to connect any hosts\"Unable to connect to any of the specified MySQL hosts\n</code></pre>\n"},{"tags":["c#","jquery-ui","dotnetnuke"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":389,"score":0,"question_id":11079661,"title":"How to make jQuery UI to work in DotnetNuke 6+","body":"<p>EDIT:\nHere is the edited control file (control.ascx):</p>\n\n<pre><code>    &lt;%@ Control Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"Sale.ascx.cs\" Inherits=\"Enmasse.Modules.Demo_Enmasse.Sale\" %&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        $(document).ready(function () {\n            $(\"#&lt;%=txtuser.ClientID%&gt;\").autocomplete('&lt;%=ResolveUrl(\"Search_Username.ashx\")%&gt;');\n        function AnotherJSFunction{\n...\n}\n        });      \n    &lt;/script&gt;\n\n    &lt;asp:MultiView ID=\"MultiView1\" runat=\"server\" ActiveViewIndex=0&gt;\n    &lt;asp:View ID=\"main\" runat=\"server\"&gt;\n    &lt;div class=item&gt;\n    &lt;asp:TextBox ID=\"txtuser\" runat=\"server\" &gt;&lt;/asp:TextBox&gt;&lt;br /&gt;\n    ...\n</code></pre>\n\n<p>Here is the edited code behind file (control.ascx.cs):</p>\n\n<pre><code>protected void Page_Load(object sender, System.EventArgs e)\n       {\n            DotNetNuke.Framework.jQuery.RequestUIRegistration();\n       }\n</code></pre>\n\n<p>This is the web handler just in case (ashx):</p>\n\n<pre><code>&lt;%@ WebHandler Language=\"C#\" Class=\"Search_Username\" %&gt;\n\nusing System;\nusing System.Web;\nusing System.Data.SqlClient;\nusing System.Configuration;\nusing System.Text;\n\npublic class Search_Username : IHttpHandler {\n\n    public void ProcessRequest (HttpContext context) {\n        string prefixText = context.Request.QueryString[\"q\"];\n        using (SqlConnection conn = new SqlConnection())\n        {\n            conn.ConnectionString = ConfigurationManager.ConnectionStrings[\"SiteSqlServer\"].ConnectionString;\n            using (SqlCommand cmd = new SqlCommand())\n            {\n                cmd.CommandText = \"select Username from Users where Username like @SearchText + '%' and IsSuperUser &lt;&gt; 1\";\n                cmd.Parameters.AddWithValue(\"@SearchText\", prefixText);\n                cmd.Connection = conn;\n                StringBuilder sb = new StringBuilder();\n                conn.Open();\n                using (SqlDataReader sdr = cmd.ExecuteReader())\n                {\n                    while (sdr.Read())\n                    {\n                        sb.Append(sdr[\"Username\"]).Append(Environment.NewLine);\n                    }\n                }\n                conn.Close();\n                context.Response.Write(sb.ToString());\n            }\n        }\n    }\n    public bool IsReusable {\n        get {\n            return false;\n        }\n    }\n}\n</code></pre>\n\n<p>I have tested the web handler Search_Username.ashx and it works fine, but I'm not sure that the link to the file is correct. The jQuery autocomplete still doesn't work and there is no error either. I have no clue where to fix, although I have review some question on here. Can someone help me?</p>\n"},{"tags":["c#","active-directory","ldap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13284782,"title":"Find all users in Ldap using asp.net c#","body":"<p>Below is my code. I want to retrieve all the users whose first name or last name is same in a grid. But here am getting the name itself in the grid sorted.</p>\n\n<p>I'm giving user a choice to enter user name. Once he enter the name I should be able to search in Active Directory and return all user starting with that text entered by the user.</p>\n\n<p>I should be able to display all possibilities, for example if user enters <code>adam</code> I should give him choice to select whether he want to see <code>adam josef</code> or <code>adam john</code> e.t.c.</p>\n\n<p>Any suggestion will be helpful.</p>\n\n<p>Here is the code</p>\n\n<pre><code>       DirectoryEntry de = new DirectoryEntry(\"ADConnection\");\n\n        DirectorySearcher deSearch = new DirectorySearcher(de);\n\n        //set the search filter    \n        deSearch.SearchRoot = de;\n        String UserName = txt_To.Text;\n        deSearch.Filter = \"(&amp;(objectCategory=user)(GivenName=*\" + UserName + \"*))\";\n        string[] arrPropertiesToLoad = { \"sn\" };\n        deSearch.PropertiesToLoad.AddRange(arrPropertiesToLoad);\n\n      SearchResultCollection sResultColl = deSearch.FindAll();//Getting undefined error\n\n\n\n        Gridview1.DataSource = sResultColl ;\n        Gridview1.DataBind();\n</code></pre>\n\n<p>Here is the stack trace</p>\n\n<blockquote>\n  <p>[COMException (0x80004005): Unspecified error]<br>\n  System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) +439513<br>\n  System.DirectoryServices.DirectoryEntry.Bind() +36<br>\n  System.DirectoryServices.DirectoryEntry.get_AdsObject() +31<br>\n  System.DirectoryServices.DirectorySearcher.FindAll(Boolean findMoreThanOne) +78<br>\n  System.DirectoryServices.DirectorySearcher.FindAll() +9<br>\n  Certificate.WebForm4.btngo0_Click(Object sender, EventArgs e) in\n  C:\\Users\\273714\\documents\\visual studio\n  2010\\Projects\\Certificate\\Certificate\\WebForm4.aspx.cs:202<br>\n  System.Web.UI.WebControls.Button.OnClick(EventArgs e) +118<br>\n  System.Web.UI.WebControls.Button.RaisePostBackEvent(String\n  eventArgument) +112<br>\n  System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String\n  eventArgument) +10<br>\n  System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler\n  sourceControl, String eventArgument) +13<br>\n  System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)\n  +36    System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\n  +5563</p>\n</blockquote>\n"},{"tags":["c#",".net","typeof","gettype","generic-type-argument"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13286957,"title":"Check object is equal to generic type","body":"<p>I have a method that does some type conversion. I don't want to go through the whole process if the type is equal to the generic types passed. Here's a snippet.</p>\n\n<pre><code>    public static T ConvertTo&lt;T&gt;(this object @this)\n    {\n        if (typeof(T) == @this.GetType())\n            return (T)@this;\n    }\n</code></pre>\n\n<p>I'm checking is the object @this is already of type T which seems to work, but is this the best way of doing this?</p>\n"},{"tags":["c#","asp.net",".net-4.0","data-connections"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13287275,"title":"DataTable's Data","body":"<p>I have a readymade class given to me, which has important data, i m able to take that data into <code>Datatable</code> and successfully displaying it on a <code>GridView</code>. </p>\n\n<p>Now my further task is  the Data what it is displaying in <code>GridView</code> inturn has data in it. How to get that?</p>\n\n<p>This is my GridView Result</p>\n\n<pre><code>HeaderCol1        HeaderCol2       HeaderCol3      HeaderCol4 \nName1              Info1            ID1              Time1\nName2              Info2            ID2              Time2\n</code></pre>\n\n<p>Now what i want is every column here has further data in it,\nsuppose if i click on <code>Name1</code> it will have details about the person, his fullname, loc and so on.</p>\n\n<p>How can i achieve this? \nThanks in advance</p>\n"}]}
{"total":375443,"page":6,"pagesize":100,"questions":[{"tags":["c#","java","sql","database","mysqli"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13288737,"title":"Handle multi biilion row table","body":"<p>Think about facebook , they have billions of post , if they want to put all post in a table , they have to have about 1 billion insertion per day and really more than them of Read .</p>\n\n<p>my way is to break all post in separate table that has max 1 billion row and if they reached that max count , a new table will create and store until it reaches max row . (it is only suggestion )</p>\n\n<p><strong>what is your suggested way ?\nwhat is your suggestion DB for this ?</strong></p>\n"},{"tags":["c#","wpf","xaml",".net-3.5","textbox"],"answer_count":6,"favorite_count":6,"up_vote_count":29,"down_vote_count":0,"view_count":16521,"score":29,"question_id":563195,"title":"WPF TextBox DataBind on EnterKey press","body":"<p>The default DataBinding on TextBox is TwoWay and it commits the text to the Property only when TextBox lost its focus.\nIs there any easy XAML way exists to make the DataBinding Happens when I press Enter Key on the TextBox?. I know it is pretty easy to do in the code behind, but imagine if this textBox is inside some complex DataTemplate.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13289096,"title":"DatagridView cellcontent click Event?","body":"<p>I am using Datagrid-cellcontentclick event when I click on row sometime work sometime does not work. </p>\n\n<p>Does anyone has similar issue. I have function to get customer id when I click on row it show me id of row.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13286000,"title":"Disable last rows in a gridview","body":"<p>I have a gridview and i want to disable the last 5 rows of it how can i do it??below code is not working</p>\n\n<pre><code>  protected void gview_RowDataBound(object sender, GridViewRowEventArgs e)\n  {\n     if (e.Row.RowType == DataControlRowType.DataRow)\n    {\n          e.Row.Enabled = e.Row.RowIndex &lt;= 5; //for disabling last 4 rows \n    }\n  }\n</code></pre>\n"},{"tags":["c#","3d"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13286030,"title":"Apply Sobel Operator on Point having x,y,z coordinates for segmentaion","body":"<p>Using C# how to perform Edge detection using 3D sobel edge operator emphasizes edge details using three 3×3×3 masks, one detecting x-gradients, the second one detects the y gradients and the third one detects the z-gradients.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13288873,"title":"Calculating the percentage of uniqueness","body":"<p>I've figured out how to compare 2 text boxes and count how many words are the same in each one and how many are different but I was wondering instead of showing exactly how many are the same and how many are different could I calculate the percentage of difference between them?</p>\n\n<p>For those who I confused, if i wrote this entire message again under this post and changed a few words and maybe removed some I could get feedback from the program telling me the difference is 14% or so... </p>\n"},{"tags":["c#","linq","mongodb","query-optimization","mongodb-csharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13254784,"title":"Is there an \"Explain Query\" for MongoDB Linq?","body":"<p>Is there a way to run <code>.explain()</code> or equivalent on Linq queries? I would want to know </p>\n\n<ul>\n<li>The text of the actual JSON query</li>\n<li>The output of <code>.explain()</code> (indexes used, etc)</li>\n<li>It would also be nice to have the execution time of the query </li>\n</ul>\n"},{"tags":["c#","ajax","visual-studio-2010",".net-4.0","reportviewer"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":19147,"score":6,"question_id":2795592,"title":"Microsoft ReportViewer Web Control Requiring a ScriptManager","body":"<p>I'm trying to render the report viewer programmatically within a custom Page placed in an IHttpHandler context</p>\n\n<pre><code>ReportViewer rv = new ReportViewer();\nReportDataSource rds = new ReportDataSource();\nrds.Name = \"Report\";\nrv.LocalReport.ReportPath = \"Report.rdlc\";\n\nrds.Value = SomeReportObject;\n\nrv.LocalReport.DataSources.Add(rds);\nrv.LocalReport.Refresh();\n\nScriptManager scriptHandler = new ScriptManager();\nMyPage p = new MyPage();\np.Controls.Add(scriptHandler);\np.Controls.Add(rv);\n\nusing (TextWriter myTextWriter = new StringWriter())\n        {\n            using (HtmlTextWriter myWriter = new HtmlTextWriter(myTextWriter))\n            {\n               p.RenderControl(myWriter);\n            }\n        }\n</code></pre>\n\n<p>Although I have the ScriptManager added to the page but the runtime complains that the ReportViewer needs one, it throws the following exception at p.RenderControl(myWriter) line</p>\n\n<p><strong>The Report Viewer Web Control requires a System.Web.UI.ScriptManager on the web form.</strong></p>\n\n<p>And this is the MyPage Class</p>\n\n<pre><code>public class MyPage : Page\n{\n\n    public override void VerifyRenderingInServerForm(Control control)\n    {\n        //Empty Method\n    }\n\n    public override bool EnableEventValidation\n    {\n        get { return false; }\n        set { /* Do nothing */}\n    }\n}\n</code></pre>\n\n<p>Any help would be very appreciated. This is done on .NET 4 and I'm using ReportViewer 2010.</p>\n"},{"tags":["c#","asp.net-mvc-4","authorization"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":13227012,"title":"ASP.NET MVC 4 Custom Role based Authorization (without membership)","body":"<p>I'm pretty new to MVC and developing an application with ASP.NET MVC 4. For authentication I'm using Windows Authentication with Active Directory in a domain. Next step is to authorize users (without using membership). Went thru several articles and still to find a good approach. </p>\n\n<p>I have my own 3 database tables (<code>Users</code>, <code>Roles</code>, <code>UserRoles</code>) to maintain authorized users with several admin levels. It is many to many. For example, there may be an \"admin\" (full access to system with create rights), \"data operator\" (update rights only for a section) and \"support user\"(read only/ view only access). Since this is many to many - a user may be a \"support user\" as well as \"data entry operator\". </p>\n\n<p>For a particular section I need to control the access based on methods. For example, let say there is a controller called \"InvoiceController\". There may be methods as follows.</p>\n\n<pre><code>CreateNewInvoice() // Accessible only by admin\n\nUpdateInvoice(...) // Accessible for admin and data operator\n\nViewInvoice(...) // Accessible for admin, data operator and support user\n</code></pre>\n\n<p>(Only the users exist in roles table can access the system. Access denied for others.)</p>\n\n<p>Please let me know how can I use authentication at method level based on the roles stored in the database. </p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13288915,"title":"What is the most memory-effective way of storing binary matrix in c#?","body":"<p>How to store 2-dimensional arrayof logical values in c#, so that it takes least space?</p>\n"},{"tags":["c#","certificate","uac","custom-action","privatekey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13231858,"title":"Private key of certificate in certificate-store not readable","body":"<p>I think I've got the same issue <a href=\"http://stackoverflow.com/questions/1386303/installing-a-certificate-in-a-msi-custom-action-doesnt-work-properly\">like this guy</a>, but I wasn't as lucky as him/her since the solution provided doesn't work for me.</p>\n\n<p>The solution provided looks for files on the <code>C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys</code> (<strong>not</strong> in sub directories) and <code>C:\\Users\\[Username]\\AppData\\Roaming\\Microsoft\\Crypto\\RSA</code> (and subdirectories)\nHowever since I want the setup to install the application to all users, the custom action is running under the <code>SYSTEM</code>-User, which leads the files beeing actually created in <code>C:\\ProgramData\\Application Data\\Microsoft\\Crypto\\RSA\\S-1-5-18</code>.</p>\n\n<p>When running an \"normal\" application as Admin (right click -> Run as Admin) executing exactly the same code, a file is created at <code>C:\\Users\\[Username]\\AppData\\Roaming\\Microsoft\\Crypto\\RSA\\S-1-5-21-1154405193-2177794320-4133247715-1000</code>. </p>\n\n<p>The certificate generated using the WIX custom action seems to not have a private key (\"<em>The key set does not exists</em>\"), while the cert generated by the \"normal\" application does.</p>\n\n<p>When looking at the permissions of the files, they seem to be alright, even if they differ (the working one does include the <code>SYSTEM</code> user), even after adding the <code>SYSTEM</code> one to the (\"non-working\")file I am not able to read the private key, same error here.</p>\n\n<p>Then I used the <a href=\"http://msdn.microsoft.com/en-us/library/aa717039.aspx\" rel=\"nofollow\">FindPrivateKey</a> util the find the corresponding file but all I get is <code>\"Unable to obtain private key file name\"</code>.</p>\n\n<p>Ok whats going one here? Where does Windows store the private keys for certificates stored by the <code>SYSTEM</code> user? Maybe there isn't any private key file created? Why?</p>\n"},{"tags":["c#","vb.net","nullreferenceexception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13278127,"title":"Cant figure out this NullReferenceException","body":"<p>StackTrace:   at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32  errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)\nSource: mscorlib</p>\n\n<p>I see in the target source something about reflection. So i'll post the very small amount of code that uses reflection.</p>\n\n<p>I normally am able to find NullReferenceExceptions easily. This one though does not appear to be my code, and I can not figure it out to save my life. I have this code bot in VB.net, and C#.Net Both have the same problem. I think that my problem is in how my pointer works, but I could be wrong.</p>\n\n<p>The code is straight forward. I have a barcode scanner attached via usb that is in COM mode. I copied some of my code from another program that uses this same barcode that works perfectly. But to sum up what it does is that it opens, then, by use of reflection, gets the Pointer to the open com port, sets up a DataEventListener. When I scan something i wait 100ms, then spit out the data in string form. Simple as could be. The difference between my code and the other one that works flawlesly is that I have to get the pointer. To turn on my scanner i need a pointer to the comport using IntPtr. C# I use IntPtr, in VB i use SafeFileHandle. Both have the same error. The only time the error occurs is when a data event is fired. This is why I think it has to be with the handle. What is strange is that the Handle is needed to turn on and off the imager so I know i have a valid handle. (just don't know if it is held on to) So does anyone have any help or resources as to why I am having this error?</p>\n\n<p>First up.. VB.NET\nPublic Class ImagerOposDevice\n    Inherits AbstractOPOSDevice\n    Dim PortHandle As SafeFileHandle\n    Dim ImagerPort As SerialPort\n    Public exitCode = 1\n    Sub New(ByVal comName As String)\n        ImagerPort = New SerialPort(comName)\n    End Sub</p>\n\n<pre><code>Protected Overrides Function Open() As Boolean\n    ImagerPort.Open()\n    PortHandle = GetHandleFromSerialPort(ImagerPort)\n\n    If Not PortHandle.IsInvalid Then\n        AddHandler ImagerPort.DataReceived, AddressOf DataReceivedHandler\n    End If\n\n    Return (Not PortHandle.IsInvalid)\nEnd Function\nProtected Overrides Sub Close()\n    Try\n        ImagerPort.Close()\n        ImagerPort.Dispose()\n    Catch ex As Exception\n        Console.WriteLine(ex.Message)\n        Console.ReadLine()\n    End Try\n\nEnd Sub\n\nProtected Overrides Function RunCommand(ByVal X As Integer) As Boolean\n    If X = 0 Then\n        Return TurnImagerOn()\n    ElseIf X = 1 Then\n        Return TurnImagerOff()\n    Else\n        Return False\n    End If\nEnd Function\n\nPrivate Shared Function GetHandleFromSerialPort(ByVal sp As SerialPort) As SafeFileHandle\n    Dim BaseStream As Object = sp.BaseStream\n    Dim BaseStreamType As Type = BaseStream.GetType\n    Return BaseStreamType.GetField(\"_handle\", BindingFlags.NonPublic Or BindingFlags.Instance).GetValue(BaseStream)\nEnd Function\nPrivate Sub DataReceivedHandler(ByVal sender As Object, ByVal e As SerialDataReceivedEventArgs)\n    Try\n        'Dim sp As SerialPort = CType(sender, SerialPort)\n        System.Threading.Thread.Sleep(100)\n        Dim len = ImagerPort.BytesToRead\n        Dim buffer(len - 1) As Byte\n        ImagerPort.Read(buffer, 0, len)\n\n        Dim indata As String = System.Text.ASCIIEncoding.ASCII.GetString(buffer)\n        Console.WriteLine(\"Data Received:\")\n        Console.Write(indata)\n        TurnImagerOff()\n    Catch ex As Exception\n        Console.WriteLine(ex.Message)\n    End Try\n    exitCode = 0\nEnd Sub\n</code></pre>\n\n<p>in my main form it is straight forward</p>\n\n<pre><code>    imager = New ImagerOposDevice(\"COM7\")\n    imager.OpenDevice()\n    imager.SendCommand(0)\n    For index = 1 To 100 Step 1\n        System.Threading.Thread.Sleep(100)\n        If imager.exitCode = 0 Then\n            Exit For\n        End If\n    Next\n    Console.WriteLine(\"Press Enter to Close\")\n    Console.ReadLine()\n    CloseDevices()\n</code></pre>\n\n<p>Now for the C# code. It is a windows form, but the concept is almost identicle.</p>\n\n<pre><code>    private SerialPort devicePort;\n    private IntPtr deviceHandle;\n    public Imager(string Port) : base()\n    {\n        devicePort = new SerialPort(Port);\n    }\n    protected override bool Open()\n    {\n        try\n        {\n            devicePort.Open();\n            deviceHandle = GetHandleFromSerialPort(devicePort);\n            Console.WriteLine(\"Device Handle:{0}\", deviceHandle);\n            Console.WriteLine(\"Device Open:{0}\", devicePort.IsOpen);\n        }\n        catch(Exception ex)\n        {\n            Console.WriteLine(ex.Message);\n        }\n        return devicePort.IsOpen;\n    }\n    protected override bool Close()\n    {\n            devicePort.Close();\n            devicePort.Dispose();\n        return true;\n    }\n    protected override CommandReturnCodes RunCommand(int command)\n    {\n        switch (command)\n        {\n            case 0:\n                TurnImagerOn();\n                break;\n            case 1:\n                TurnImagerOff();\n                break;\n            case 2:\n                ReadLatch();\n                break;\n            case 3:\n                GetPartNumber();\n                break;\n            case 4:\n                GetSerialNumber();\n                break;\n            case 5:\n                GetProductString();\n                break;\n            default:\n                return CommandReturnCodes.FAIL;\n        }\n        return CommandReturnCodes.SUCCESS;\n    }\n    private static IntPtr GetHandleFromSerialPort(SerialPort sp)\n    {\n        Type t = typeof(SerialPort);\n        BindingFlags bf = BindingFlags.Instance | BindingFlags.NonPublic;\n        FieldInfo fi = t.GetField(\"internalSerialStream\", bf);\n        object ss = fi.GetValue(sp);\n        Type t2 = fi.FieldType;\n        FieldInfo fi2 = t2.GetField(\"_handle\", bf);\n        SafeFileHandle _handle = (SafeFileHandle)fi2.GetValue(ss);\n        Type t3 = typeof(SafeFileHandle);\n        FieldInfo fi3 = t3.GetField(\"handle\", bf);\n        IntPtr handle = (IntPtr)fi3.GetValue(_handle);\n        return handle;\n    }\n    public void TurnOnImagerEventListener()\n    {\n        devicePort.DataReceived += new SerialDataReceivedEventHandler(devicePort_DataReceived);\n    }\n\n    void devicePort_DataReceived(object sender, SerialDataReceivedEventArgs e)\n    {\n        System.Threading.Thread.Sleep(100);\n        SerialPort imager = sender as SerialPort;\n        byte[] buffer = new byte[imager.BytesToRead];\n        imager.Read(buffer, 0, imager.BytesToRead);\n        var scannedText = System.Text.Encoding.ASCII.GetString(buffer).Trim();\n        SendBarcodeEvent(scannedText);\n        TurnImagerOff();\n        Console.WriteLine(scannedText);\n    }\n</code></pre>\n\n<p>and to call it is same thing</p>\n\n<pre><code>        im = new Imager(comportBox.Text);\n        im.OpenDevice();\n        im.TurnOnImagerEventListener();\n        im.BarcodeScanned += new DataAvailableHandler(DeviceInformationReceived);\n</code></pre>\n"},{"tags":["c#","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13288795,"title":"How to use XmlTextWriter in windows8 Store app?","body":"<p>I'm Creating an windows store application in Visual studio 2012 in windows 8. I need to use the XmlTextWriter to write the output. I've Given the Namespace </p>\n\n<pre><code>    using System.Xml;\n</code></pre>\n\n<p>Please SOmebody tell me how to do the XmlTextWriter task in Windows8 Metro APP. . .</p>\n\n<p>Thanks in Advance!</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13289046,"title":"Trying to hook dialogs created by a child process from parent","body":"<p>I've written a small utility that uses MSRA.exe to create a remote help invitation file and immediately begin listening for assistance help requests for a help desk environment. The application works great and the thread MSRA.exe operates completely invisible to the user, but the one issue I have is that if the user terminates the connection improperly by killing the process or somthing then the next time my app is run and the MSRA.exe is called it sends a dialog that says the user didn't close the last connection properly and desktop settings were not restored, do they wish to restore desktop settings now? Well since I have MSRA hidden the dialog is hidden as well and halts the MSRA program while it waits for a response, is there any way to check for this dialog and force an answer?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Net;\nusing System.IO;\nusing System.Threading;\nusing System.Management;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\nnamespace WindowsFormsApplication2\n{\n\n    public partial class Form1 : Form\n    {\n        System.Diagnostics.Process p = new System.Diagnostics.Process();\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        public void EndSession()\n        {\n            if (button1.Text != \"Launch Connection\")\n            {\n                button1.Text = \"Closing Connection...\";\n                this.Refresh();\n                if (p.HasExited == false)\n                {\n                    KillProcessAndChildren(p.Id);\n                }\n                if (File.Exists(System.IO.Path.GetTempPath() + \"Invitation.msrcincident\") == true)\n                {\n                    File.Delete(System.IO.Path.GetTempPath() + \"Invitation.msrcincident\");\n                }\n            }\n            Application.Exit();\n        }\n\n        private void KillProcessAndChildren(int pid)\n        {\n            using (var searcher = new ManagementObjectSearcher(\"Select * From Win32_Process Where ParentProcessID=\" + pid))\n            using (ManagementObjectCollection moc = searcher.Get())\n            {\n                foreach (ManagementObject mo in moc)\n                {\n                    KillProcessAndChildren(Convert.ToInt32(mo[\"ProcessID\"]));\n                }\n                try\n                {\n                    Process proc = Process.GetProcessById(pid);\n                    proc.CloseMainWindow();\n                    if (!proc.WaitForExit((int)TimeSpan.FromSeconds(3).TotalMilliseconds))\n                    {\n                        proc.Kill();\n                    }\n                }\n                catch (ArgumentException)\n                { /* process already exited */ }\n            }\n        }\n\n        public void button1_Click(object sender, EventArgs e)\n        {\n            if (button1.Text == \"Launch Connection\")\n            {\n                button1.Text = \"Opening Connection...\";\n                this.Refresh();\n                if (File.Exists(System.IO.Path.GetTempPath() + \"Invitation.msrcincident\") == true)\n                {\n                    File.Delete(System.IO.Path.GetTempPath() + \"Invitation.msrcincident\");\n                }\n\n                string fileurl = System.IO.Path.GetTempPath() + \"Invitation.msrcincident\";\n                p.StartInfo.UseShellExecute = true;\n                p.StartInfo.RedirectStandardOutput = false;\n                p.StartInfo.CreateNoWindow = true;\n                p.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;\n                p.StartInfo.FileName = \"Msra.exe\";\n                p.StartInfo.Arguments = \"/saveasfile \" + fileurl + \" MyPass\";\n                Console.WriteLine(p.StartInfo.Arguments);\n                p.Start();\n\n                while (File.Exists(System.IO.Path.GetTempPath() + \"Invitation.msrcincident\") == false)\n                {\n                    Thread.Sleep(1000);\n                }\n                FtpWebRequest request = (FtpWebRequest)FtpWebRequest.Create(\"ftp://ftp.MyFTP.net/\" + System.Environment.UserName + \".\" + Dns.GetHostName() + \".msrcincident\");\n                request.Method = WebRequestMethods.Ftp.UploadFile;\n                request.Credentials = new NetworkCredential(\"MyUser\", \"MyPass\");\n                request.UsePassive = true;\n                request.UseBinary = true;\n                request.KeepAlive = false;\n                Stream ftpstream = request.GetRequestStream();\n\n\n                FileStream stream = File.OpenRead(fileurl);\n                int length = 1024;\n                byte[] buffer = new byte[length];\n                int bytesRead = 0;\n                do\n                {\n                    bytesRead = stream.Read(buffer, 0, length);\n                    ftpstream.Write(buffer, 0, bytesRead);\n                } while (bytesRead != 0);\n\n                stream.Close();\n                ftpstream.Close();\n                button1.Text = \"Connection Open\";\n            }\n            else\n            {\n                EndSession();\n            }\n        }\n\n        private void button2_Click(object sender, EventArgs e)\n        {\n            EndSession();\n\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            textBox1.Text = System.Environment.UserName;\n            textBox2.Text = Dns.GetHostName();\n\n            Process[] processes = Process.GetProcessesByName(\"msra\");\n\n            foreach (Process process in processes)\n            {\n                process.Kill();\n            }\n\n        }\n\n        private void Form1_FormClosing(object sender, FormClosingEventArgs e)\n        {\n            EndSession();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","windows-phone-7","push-notification"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13289029,"title":"Alternatives to Microsoft Push Notification Service","body":"<p><strong>What can be the alternative to MPNS for push notification in windows phone</strong>? I can think of something like <strong>MQTT</strong> or <strong>XMPP</strong>. Which is best for Push Notification Service among these and where can I get the clients for wp7? Please suggest any other alternative as well?</p>\n\n<p><strong>p.s.</strong>: Why I can't use Microsoft Push Notification service: I am trying to implement push notification service where I want to push a dummy text notifying the device that there is some new data available in the server. Then the device will poll the server and get the data. For achieving this, I used Google's cloud messaging service (Earlier c2dm) for Android, Apple push notification service for iPhone and MPNS for Windows phone. But now the client says our server cannot, rather shouldn't communicate with a 3rd party like Google/Apple/Microsoft servers for pushing the notification. I am forced to search for alternatives. I have implemented MQTT in Android and it is serving the purpose, also in Apple it will wokr without any issue. Now I am trying the same for wp7, but can't find any working MQTT client, does Microsoft restrict us to use 3rd party services to push? If not where can I get a working MQTT client for windows phone 7? Also if that is not possible, does Microsoft allow XMPP or not? If it allows can I use xmpp to achieve the same?</p>\n\n<p>Kindly provide any other alternatives as well. Thanks in advance...</p>\n"},{"tags":["c#","pcap.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13272565,"title":"Split packet into 2 packets with pcapdotnet","body":"<p>How can I split a packet into two packets using pcapdotnet? This is what I tried, but I don't know whether it's correct:</p>\n\n<pre><code>    public IEnumerable&lt;Packet&gt; splitPacket(Packet packet)\n    {\n        EthernetLayer ethernet = (EthernetLayer)packet.Ethernet.ExtractLayer();\n        IpV4Layer ipV4Layer = (IpV4Layer)packet.Ethernet.IpV4.ExtractLayer();\n        DateTime packetTimestamp = packet.Timestamp;\n        ILayer payload = packet.Ethernet.IpV4.Payload.ExtractLayer();\n        IpV4Fragmentation.Equals(packet, packet);\n\n        yield return PacketBuilder.Build(packetTimestamp, ethernet, ipV4Layer, payload);\n    }\n</code></pre>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":13190590,"title":"Add link labels to DataGridView","body":"<p>In my project, I'm filling the <code>dataGridView</code> from <code>dataSet</code> (binding the <code>DataGridView</code> to <code>DataSet</code>). The first column in <code>dataGridView</code> must be <code>LinkLabels</code> which I'm trying to get in the below code.</p>\n\n<pre><code>dgvMain.DataSorce = ds.Tables[0];\n</code></pre>\n\n<p>I tried: (<em>not working</em>)  </p>\n\n<pre><code>DataGridViewLinkCell lnkCell = new DataGridViewLinkCell();\nforeach (DataGridViewRow row in dgvMain.Rows)\n{\n    row.Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p><strong>also tried</strong></p>\n\n<pre><code>for (int intCount = 0; intCount &lt; dgvMain.Rows.Count; intCount++)\n{\n    dgvMain.Rows[intCount].Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p>The above attempts are adding <code>linkLabel</code> to the first cell only not all the cells in that column<br>When I debugged my code, I concluded that after adding the <code>linkLabel</code> to the first cell exception error is coming which I mentioned in the above code, which is making the code not to run properly.</p>\n\n<p>Please give me any suggestions, what should I do?</p>\n\n<p><strong>EDIT</strong>:  Though it is not the correct way but I gave the column cells a look like <code>Linklabel</code> by writing the below code:</p>\n\n<pre><code>            foreach (DataGridViewRow row in dgvMain.Rows)\n            {\n                row.Cells[1].Style.Font = new Font(\"Consolas\", 9F, FontStyle.Underline);\n                row.Cells[1].Style.ForeColor = Color.Blue;\n            }\n</code></pre>\n\n<hr>\n\n<p>Now the problem is that I cant add <code>Hand</code> like cursor to the only column cells(which is visible for LinkLabels). Is there anyway to achieve it? (I need answer for both questions, mainly the first one).</p>\n"},{"tags":["c#","asp.net","asp.net-mvc-3","sms","onlinebanking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13288897,"title":"SMS banking feature for asp.net mvc banking site","body":"<p>How do i implement the SMS banking feature for existing Asp.net mvc 3 banking application.</p>\n\n<p>Thanks,\nS.</p>\n"},{"tags":["c#","templates","microsoft-metro","control","destructor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13288834,"title":"Destroying a Template Control Metro","body":"<p>I have a Timer template control which displays a set time. The user however can change the page at anytime but the timer is still running in the background.</p>\n\n<p>The problem is that when the user changes page it destroys the template which is no problem but I need to save the current time the control was destroyed so that I can recover the correct state when the user goes back to the page.</p>\n\n<p>Is there any way of knowing when the template control is destroyed in the template itself similar to the onApplyTemplate function.</p>\n\n<p>I cant seem to find anything and when I created a destructor it was only called when the app closed.</p>\n"},{"tags":["c#",".net","visual-studio-2008",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13288792,"title":"Change already-written console application to project of \"Windows Service\" type?","body":"<p>I have a console application which I need to change to a windows service. How do I do this? In Properties it only has \"Windows Application\", \"Console Application\" and \"Class Library\" in the drop down.</p>\n"},{"tags":["c#","wpf","mvvm","caliburn.micro","stackpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":126,"score":2,"question_id":12387135,"title":"Stackpanel in a button","body":"<p>I'm supposed to make a user-control using WPF, and now i'm bumping into a weird problem.</p>\n\n<p>I came up with a kinda weird solution to get an image along with some text in a button, like this:</p>\n\n<pre><code>&lt;Button Height=\"24\" Width=\"100\" Name=\"btn_change\"&gt;\n     &lt;StackPanel Width=\"90\"&gt;\n           &lt;Image Source=\"Images\\11.png\" Width=\"24\" Height=\"18\" HorizontalAlignment=\"Left\" Panel.ZIndex=\"-1\" Stretch=\"Uniform\"&gt;&lt;/Image&gt;\n           &lt;Label Content=\"Change\" HorizontalAlignment=\"Right\" Margin=\"0,-18,0,0\" Height=\"20\" Padding=\"0,0,0,0\" /&gt;\n     &lt;/StackPanel&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>This worked perfectly, until i started using a MVVM Framework (Caliburn.Micro). From that point on the images no longer show up in the buttons, just the text. I can't figure out why it doesn't work.</p>\n\n<p>Maybe someone with knowledge of MVVM Frameworks can explain this or give me a solution :)</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Never mind! I looked it over thanks to H.B. and it seemed I moved the View to a subfolder. I changed the image source from <code>\"Images\\11.png\"</code> to <code>\"..\\Images\\11.png\"</code> and it worked!</p>\n"},{"tags":["c#","asp.net",".net","css","html-table"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13286814,"title":"Specified argument was out of the range of valid values. Parameter name: index","body":"<p><a href=\"http://jsbin.com/uzojax/10/edit\" rel=\"nofollow\">jsbin</a></p>\n\n<pre><code>&lt;table id=\"tableAppointment\" runat=\"server\" cellspacing=\"1\" width=\"100%\" bgcolor=\"#cccccc\"&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>C#</strong>   </p>\n\n<pre><code> protected void Page_Load(object sender, EventArgs e)\n            {\n            GenearateTable();\n            GiveRowspanToTable();\n        }\n\n        private void GenearateTable()\n        {\n            HtmlTableCell cell = null;\n            int k = 0;\n            for(int i = 0; i &lt; tableAppointment.Rows.Count; i++)\n            {\n                for(int j = 0; j &lt; 3; j++)\n                {\n                    k++;\n                    cell = new HtmlTableCell();\n                    tableAppointment.Rows[i].Cells.Add(cell);\n                    cell.Attributes.Remove(\"class\");\n                    cell.Attributes.Remove(\"rowspan\");\n                    cell.InnerHtml = k.ToString();\n                }\n\n            }\n\n        }\n\n        private void GiveRowspanToTable()\n        {\n            for(int i = 0; i &lt; tableAppointment.Rows.Count; i++)\n            {\n                for(int j = 0; j &lt; tableAppointment.Rows[i].Cells.Count; j++)\n                {\n                    if(tableAppointment.Rows[i].Cells[j].InnerText.Trim() == \"32\")\n                    {\n                        tableAppointment.Rows[i].Cells[j].RowSpan = 3;\n                        tableAppointment.Rows[i + 1].Cells.RemoveAt(j);\n                        tableAppointment.Rows[i + 2].Cells.RemoveAt(j);\n                    }\n\n                    if(tableAppointment.Rows[i].Cells[j].InnerText.Trim() == \"33\")\n                    {\n                        tableAppointment.Rows[i].Cells[j].RowSpan = 3;\n                        tableAppointment.Rows[i + 1].Cells.RemoveAt(j);\n                        tableAppointment.Rows[i + 2].Cells.RemoveAt(j);\n                    }\n\n                }\n            }\n        }\n</code></pre>\n\n<p>In page load i am generating table.\n                And checking cell value. If cell value is match giving rowspan to that cell\n                i m removing two cell from below row of matched cell\n                if rowsapn is 3 removing 2 cell\n                And same if rowspan is 2 removing one cell.I have show cell in block that should be happen with rowspan only\nWhen i removing gives an error \"Specified argument was out of the range of valid values.\nParameter name: index \"</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13288507,"title":"How to use Session List<T> in asp.net to store value","body":"<p>i made one property like this :</p>\n\n<pre><code>public static List&lt;Message&gt; _SessionStore;\n        public static List&lt;Message&gt; SessionStore\n        {\n            get\n            {\n                if(HttpContext.Current.Session[\"MyData\"]==null)\n                {\n                    _SessionStore = new List&lt;Message&gt;();\n                }\n                return _SessionStore;\n            }\n            set { HttpContext.Current.Session[\"MyData\"] = _SessionStore; }\n        }\n</code></pre>\n\n<p>I want to add value <code>SessionStore.Add() and get SessionStore.Where()</code>\nbut i got error while doing this Add And Get</p>\n\n<p>first i did <strong>SessionStore.Add(comment);</strong> somewhere then i got this error</p>\n\n<pre><code> List&lt;Message&gt; msglist = HttpContext.Current.Session[\"MyData\"] as List&lt;Message&gt;;\n    if(msglist.Count&gt;0)\n</code></pre>\n\n<p>i am not able access <code>msglist</code></p>\n\n<p>can anybody fix my property in way that i can use this List from anypage to add and get values</p>\n"},{"tags":["c#",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12525460,"title":"Task<WebResponse>.Wait lasts forever","body":"<p>C#, .Net 4.5. I have a queue that contains objects which are to be processed. Processing includes obtaining data with the URL which specified in one of the fields of the object. In the course of operation the new objects can be added to the queue. When I tried to do the work with the network asynchronous, I faced with a problem.</p>\n\n<p>Here is a minimum code.</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    private void button1_Click(object sender, EventArgs e)\n    {\n        string[] urls = { \"http://www.stackoverflow.com/\", \n                            \"http://www.google.com/\", \n                            \"http://www.microsoft.com/\" };\n        int i = 0;\n        Queue&lt;MyClass1&gt; queue = new Queue&lt;MyClass1&gt;();\n\n        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(urls[i]);\n        webRequest.Proxy.Credentials = CredentialCache.DefaultCredentials;\n        queue.Enqueue(new MyClass1(urls[i], webRequest.GetResponseAsync()));\n\n        while (queue.Count &gt; 0)\n        {\n            MyClass1 o = queue.Dequeue();\n            o.RespTask.Wait();\n            Debug.Print(\"Url: {0}, bytes: {1}\", o.Url, \n                o.RespTask.Result.ContentLength);\n\n            i++;\n            if (i &lt; urls.Length)\n            {\n                webRequest = (HttpWebRequest)WebRequest.Create(urls[i]);\n                webRequest.Proxy.Credentials = CredentialCache.DefaultCredentials;\n                queue.Enqueue(new MyClass1(urls[i], webRequest.GetResponseAsync()));\n            }\n        } \n    }\n}\n\npublic class MyClass1\n{\n    public MyClass1() { }\n    public MyClass1(string url, Task&lt;WebResponse&gt; respTask)\n    {\n        Url = url;\n        RespTask = respTask;\n    }\n\n    public string Url;\n    public Task&lt;WebResponse&gt; RespTask;\n}\n</code></pre>\n\n<p>That code hangs on o.RespTask.Wait(); on third iteration of cycle. Before this call o.RespTask.Status has value WaitingForActivation and waiting lasts forever. What am I doing wrong?</p>\n\n<p>UPDATE. I checked the code on 3 boxes. On two of them (Win7 32-bit and Win7 64-bit) the program hangs. On the third (Win7 64-bit) everything is working fine. It seems to me very strange.</p>\n"},{"tags":["c#","c++",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13288419,"title":"how to add bookmark using migradoc?","body":"<p>I want to add Bookmark in my PDF using <code>migradoc dll</code>.</p>\n\n<p>for example: two images on a single page.</p>\n\n<pre><code>           1. Images1\n           2. Images2**\n</code></pre>\n\n<p>and the same name bookmark will generate.</p>\n\n<p>if I click on <code>image1</code> bookmark that image will be shown to me. Remember both images are on single page.</p>\n"},{"tags":["c#","wpf","configuration","settings"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13286775,"title":"Custom app.config sections C#","body":"<p>I'm a bit lost on using app.config... I've been using .ini files all the time but now I want to change... This is how my .ini looks</p>\n\n<pre><code>[Clients]\n1 = Client1\n2 = Client 2\n[Client1]\nEmployees = 4\n1 = Employee1\n2 = Employee2\n3 = Employee3\n4 = Employee4\n[Client2]\nEmployees = 3\n1 = Employee1\n2 = Employee2\n3 = Employee3\n</code></pre>\n\n<p>Then I was using some for loops, first I search [Clients], inside that For client, I search how many employees does it have, and then, For each employee I do things...</p>\n\n<p>How can I convert this .ini into something like this</p>\n\n<pre><code>&lt;Clients&gt;\n &lt;name = \"client1\"&gt;\n  &lt;Employees&gt;\n    &lt;name = \"employee1\" /&gt;\n    &lt;name = \"employee2\" /&gt;\n    &lt;name = \"employee3\" /&gt;\n    &lt;name = \"employee4\" /&gt;\n  &lt;/Employees&gt;\n &lt;name = \"client2\"&gt;\n  &lt;Employees&gt;\n    &lt;name = \"employee1\" /&gt;\n    &lt;name = \"employee2\" /&gt;\n    &lt;name = \"employee3\" /&gt;\n  &lt;/Employees&gt;\n&lt;/Clients&gt;\n</code></pre>\n\n<p>And then do things with loops using that app.config</p>\n\n<p>Thanks in advice.</p>\n\n<p><strong>UPDATE</strong>\nI've tried this linq to xml code</p>\n\n<pre><code>XDocument doc = new XDocument(\n         new XDeclaration(\"1.0\", \"utf-8\", \"yes\"),\n         new XComment(\"Configuración Checkcenter\"),\n         new XElement(\"Entidad\",\n             new XAttribute(\"nombre\",cmbEntidad.Text),\n             new XElement(\"Servicios\",\n                 new XElement(\"nombre\", cmbServicio.Text))));\n\n    doc.Save(\"settings.xml\");\n</code></pre>\n\n<p>It works, returns me this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?&gt;\n&lt;!--My Settings--&gt;\n&lt;Client name=\"Client1\"&gt;\n  &lt;Employees&gt;\n    &lt;name&gt;Employee1&lt;/name&gt;\n  &lt;/Employees&gt;\n&lt;/Entidad&gt;\n</code></pre>\n\n<p>But it always replace my name in employees... How can I handle it to add new item if it doesn't exists? I mean, add new item to Employees for a client if it doesn't exist.</p>\n"},{"tags":["c#",".net","xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13288125,"title":"Construct Table From Multiple Related XML Files","body":"<p>I have two XML files that represents two relational tables that have relation in between.\nThe files are as below:\nExam.XML</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n &lt;Exam&gt;\n   &lt;Student id='1'&gt;\n     &lt;result&gt;100 &lt;/result&gt;\n  &lt;/Student &gt;\n  &lt;Student id='2'&gt;\n     &lt;result&gt;200 &lt;/result&gt;\n  &lt;/Student &gt;\n &lt;/Exam&gt; \n</code></pre>\n\n<p>Student.XML</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;Students&gt;\n  &lt;Student id='1'&gt;\n      &lt;name&gt;John&lt;/name&gt;\n  &lt;/Student &gt;\n  &lt;Student id='2'&gt;\n     &lt;name&gt;Mark &lt;/name&gt;\n  &lt;/Student &gt;\n</code></pre>\n\n<p> </p>\n\n<p>and the result should be</p>\n\n<p>StudentID StudentName Result</p>\n\n<p>1          John        100</p>\n\n<p>2         Mark        200</p>\n\n<p>How to implement this in c#?\nNote: my file are not that simple, so merging them will not be helpful</p>\n"},{"tags":["c#","math","types","double","decimal"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1765,"score":5,"question_id":4124189,"title":"Performing Math operations on decimal datatype in C#?","body":"<p>I was wondering if the above was at all possible.  For example:</p>\n\n<pre><code>Math.Sqrt(myVariableHere);\n</code></pre>\n\n<p>When looking at the overload, it requires a double parameter, so I'm not sure if there is another way to replicate this with decimal datatypes.</p>\n"},{"tags":["c#","configuration","app-config","configurationsection"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3164,"score":2,"question_id":4988375,"title":"Custom Configuration Collection - Unrecognized element 'addService'","body":"<p>Example from MSDN on making a custom config section that should work as follows,</p>\n\n<pre><code>class RemoteServiceSection : ConfigurationSection\n{\n    [ConfigurationProperty(\"remoteServices\", IsDefaultCollection=false)]\n    [ConfigurationCollection(typeof(RemoteServiceCollection), AddItemName=\"addService\", ClearItemsName=\"clearServices\",\n        RemoveItemName=\"removeService\")]\n    public RemoteServiceCollection Services\n    {\n        get\n        {\n            return this[\"remoteServices\"] as RemoteServiceCollection; \n        }\n    }\n}\n\nclass RemoteServiceCollection : ConfigurationElementCollection, IList&lt;RemoteServiceElement&gt;\n{\n    public RemoteServiceCollection()\n    {\n        RemoteServiceElement element = (RemoteServiceElement)CreateNewElement();\n        Add(element); \n    }\n\n    public override ConfigurationElementCollectionType CollectionType\n    {\n        get\n        {\n            return ConfigurationElementCollectionType.AddRemoveClearMap;\n        }\n    }\n\n    protected override ConfigurationElement CreateNewElement()\n    {\n        return new RemoteServiceElement();\n    }\n\n    protected override object GetElementKey(ConfigurationElement element)\n    {\n        return ((RemoteServiceElement)element).Hostname;\n    }\n\n    protected override string ElementName\n    {\n        get\n        {\n            return \"remoteService\";\n        }\n    }\n\n    public new IEnumerator&lt;RemoteServiceElement&gt; GetEnumerator()\n    {\n        foreach (RemoteServiceElement element in this)\n        {\n            yield return element; \n        }\n    }\n\n    public void Add(RemoteServiceElement element)\n    { \n        BaseAdd(element, true); \n    }\n\n    public void Clear()\n    {\n        BaseClear(); \n    }\n\n    public bool Contains(RemoteServiceElement element)\n    {\n        return !(BaseIndexOf(element) &lt; 0); \n    }\n\n    public void CopyTo(RemoteServiceElement[] array, int index)\n    {\n        base.CopyTo(array, index); \n    }\n\n    public bool Remove(RemoteServiceElement element)\n    {\n        BaseRemove(GetElementKey(element));\n        return true; \n    }\n\n    bool ICollection&lt;RemoteServiceElement&gt;.IsReadOnly\n    {\n        get { return IsReadOnly(); } \n    }\n\n    public int IndexOf(RemoteServiceElement element)\n    {\n        return BaseIndexOf(element); \n    }\n\n    public void Insert(int index, RemoteServiceElement element)\n    {\n        BaseAdd(index, element); \n    }\n\n    public void RemoveAt(int index)\n    {\n        BaseRemoveAt(index); \n    }\n\n    public RemoteServiceElement this[int index]\n    {\n        get\n        {\n            return (RemoteServiceElement)BaseGet(index); \n        }\n        set\n        {\n            if (BaseGet(index) != null)\n            {\n                BaseRemoveAt(index); \n            }\n            BaseAdd(index, value); \n        }\n    }\n}\n\nclass RemoteServiceElement : ConfigurationElement\n{\n    public RemoteServiceElement() { }\n\n    public RemoteServiceElement(string ip, string port)\n    {\n        this.IpAddress = ip;\n        this.Port = port; \n    }\n\n    [ConfigurationProperty(\"hostname\", IsKey = true, IsRequired = true)]\n    public string Hostname\n    {\n        get\n        {\n            return (string)this[\"hostname\"];\n        }\n        set\n        {\n            this[\"hostname\"] = value;\n        }\n    }\n    [ConfigurationProperty(\"ipAddress\", IsRequired = true)]\n    public string IpAddress\n    {\n        get\n        {\n            return (string)this[\"ipAddress\"];\n        }\n        set\n        {\n            this[\"ipAddress\"] = value;\n        }\n    }\n    [ConfigurationProperty(\"port\", IsRequired = true)]\n    public string Port\n    {\n        get\n        {\n            return (string)this[\"port\"];\n        }\n        set\n        {\n            this[\"port\"] = value;\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I am getting the error that says 'Unrecognized element 'addService'. I think I've followed the MSDN article exactly. It can be found here - <a href=\"http://msdn.microsoft.com/en-us/library/system.configuration.configurationcollectionattribute.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.configuration.configurationcollectionattribute.aspx</a></p>\n\n<p>Thanks in advance for your help. This is what I wrote in app.config (with brackets of course that dont show up here?):</p>\n\n<pre><code> remoteServices\n   addService hostname=\"xxxxxxx\" ipAddress=\"xxx.x.xxx.xx\" port=\"xxxx\" \n remoteServices\n</code></pre>\n\n<hr>\n\n<p>Here is app.config as requested, x'ing out the specific names just for privacy purposes, they are just strings:</p>\n\n<pre><code>&lt;configuration&gt;\n&lt;configSections&gt;\n  &lt;section name=\"remoteServices\" type=\"AqEntityTests.RemoteServiceSection, \n     AqEntityTests\" allowLocation=\"true\" allowDefinition=\"Everywhere\"/&gt;\n  &lt;/configSections&gt;\n  &lt;remoteServices&gt;\n   &lt;addService hostname=\"xxxxxx.xxxxxxx.com\" \n            ipAddress=\"xxx.x.xxx.xx\" \n            port=\"xx\" /&gt;\n  &lt;/remoteServices&gt;\n</code></pre>\n"},{"tags":["c#","msbuild","msbuild-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13288488,"title":"Change CSharp code at compile time based on Assembly being used","body":"<p>Test.csproj references <code>System.XML</code> and specifies TargetFrameworkVersion v4.0.\n<code>System.Xml.XmlReaderSettings</code> has gained a <code>DtdProcessing</code> Property, and deprecated <code>ProhibitDtd</code> in the meantime.\nThe requirement is to build from one project, supporting both assemblies.</p>\n\n<p>Building with MSBuild 3.5 (c:\\Windows\\Microsoft.NET\\Framework\\v3.5\\MSBuild) it ends up referencing C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\System.Xml.dll (Runtime Version v2.0.50727, Version 2.0.0.0)</p>\n\n<p>Building with MSBuild 4.0 (c:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild) it ends up referencing C:\\Program Files\\Reference Assemblies\\Microsoft\\Framework.NETFramework\\v4.0\\System.Xml.dll (Runtime Version v4.0.30319, Version 4.0.0.0).</p>\n\n<p>My attempted fix was to define a constant in the .csproj file based on the TargetFrameworkVersion.\nHowever, TargetFrameworkVersion is no indicator of which assembly will be linked.</p>\n\n<p>So, this doesn't work:</p>\n\n<pre><code>&lt;PropertyGroup Condition=\" '$(TargetFrameworkVersion)' != 'v2.0' And '$(TargetFrameworkVersion)' != 'v3.5' And '$(TargetFrameworkVersion)' != '' \"&gt;\n  &lt;DefineConstants Condition=\" '$(DefineConstants)' != '' \"&gt;$(DefineConstants);&lt;/DefineConstants&gt;\n  &lt;DefineConstants&gt;$(DefineConstants)XMLDTDPROCESSING&lt;/DefineConstants&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>\n\n<p>With this CSharp code:</p>\n\n<pre><code>namespace TestVSMSBuild\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            System.Xml.XmlReaderSettings readerSettings = new System.Xml.XmlReaderSettings();\n#if XMLDTDPROCESSING\n            readerSettings.DtdProcessing = System.Xml.DtdProcessing.Ignore;\n#else // !XMLDTDPROCESSING\n            readerSettings.ProhibitDtd = false;\n#endif // XMLDTDPROCESSING\n            System.Console.WriteLine(\"Reader: '{0}'\", readerSettings);\n        }\n    }\n</code></pre>\n\n<p>Reading <code>C:\\Windows\\Microsoft.NET\\Framework\\v3.5\\Microsoft.Common.targets</code> the comment for the <code>AssemblySearchPaths</code> property is:</p>\n\n<pre><code>&lt;!--\nThe SearchPaths property is set to find assemblies in the following order:\n\n    (1) Files from current project - indicated by {CandidateAssemblyFiles}\n    (2) $(ReferencePath) - the reference path property, which comes from the .USER file.\n    (3) The hintpath from the referenced item itself, indicated by {HintPathFromItem}.\n    (4) The directory of MSBuild's \"target\" runtime from GetFrameworkPath.\n        The \"target\" runtime folder is the folder of the runtime that MSBuild is a part of.\n    (5) Registered assembly folders, indicated by {Registry:*,*,*}\n    (6) Legacy registered assembly folders, indicated by {AssemblyFolders}\n    (7) Look in the application's output folder (like bin\\debug)\n    (8) Resolve to the GAC.\n    (9) Treat the reference's Include as if it were a real file name.\n--&gt;\n&lt;AssemblySearchPaths Condition=\" '$(AssemblySearchPaths)' == '' \"&gt;\n    {CandidateAssemblyFiles};\n    $(ReferencePath);\n    {HintPathFromItem};\n    {TargetFrameworkDirectory};\n    {Registry:$(FrameworkRegistryBase),$(TargetFrameworkVersion),$(AssemblyFoldersSuffix)$(AssemblyFoldersExConditions)};\n    {AssemblyFolders};\n    {GAC};\n    {RawFileName};\n    $(OutDir)\n&lt;/AssemblySearchPaths&gt;\n</code></pre>\n\n<p>My guess is this has something to do with <code>GetFrameworkPaths</code> which is defined as:</p>\n\n<pre><code>&lt;!--\n============================================================\n                                    GetFrameworkPaths\n\nGet the paths for the .NET Framework installation directory, and the .NET Framework\nSDK installation directory.\n\nThese paths are not used directly by this .targets file but are available for pre and\npost build steps.\n============================================================\n--&gt;\n&lt;PropertyGroup&gt;\n    &lt;Framework35Dir&gt;@(_TargetFramework35DirectoryItem)&lt;/Framework35Dir&gt;\n    &lt;Framework30Dir&gt;@(_TargetFramework30DirectoryItem)&lt;/Framework30Dir&gt;\n    &lt;Framework20Dir&gt;@(_TargetFramework20DirectoryItem)&lt;/Framework20Dir&gt;\n    &lt;FrameworkDir&gt;@(_TargetFramework20DirectoryItem)&lt;/FrameworkDir&gt;\n\n    &lt;FrameworkSDKDir&gt;@(_TargetFrameworkSDKDirectoryItem)&lt;/FrameworkSDKDir&gt;\n    &lt;GetFrameworkPathsDependsOn&gt;&lt;/GetFrameworkPathsDependsOn&gt;\n&lt;/PropertyGroup&gt;\n&lt;Target\n    Name=\"GetFrameworkPaths\"\n    DependsOnTargets=\"$(GetFrameworkPathsDependsOn)\"&gt;\n\n    &lt;!-- Get the paths to all of the target .NET framework directories. --&gt;\n    &lt;GetFrameworkPath&gt;\n        &lt;Output Condition=\" '$(TargetFrameworkVersion)' == 'v3.5' \"                                                                                  TaskParameter=\"FrameworkVersion35Path\"  ItemName=\"_CombinedTargetFrameworkDirectoriesItem\" /&gt;\n        &lt;Output Condition=\" '$(TargetFrameworkVersion)' == 'v3.0' or '$(TargetFrameworkVersion)' == 'v3.5' \"                                         TaskParameter=\"FrameworkVersion30Path\"  ItemName=\"_CombinedTargetFrameworkDirectoriesItem\" /&gt;\n        &lt;Output Condition=\" '$(TargetFrameworkVersion)' == 'v2.0' or '$(TargetFrameworkVersion)' == 'v3.0' or '$(TargetFrameworkVersion)' == 'v3.5'\" TaskParameter=\"FrameworkVersion20Path\"  ItemName=\"_CombinedTargetFrameworkDirectoriesItem\" /&gt;\n        &lt;Output TaskParameter=\"FrameworkVersion35Path\"  ItemName=\"_TargetFramework35DirectoryItem\" /&gt;\n        &lt;Output TaskParameter=\"FrameworkVersion30Path\"  ItemName=\"_TargetFramework30DirectoryItem\" /&gt;\n        &lt;Output TaskParameter=\"FrameworkVersion20Path\"  ItemName=\"_TargetFramework20DirectoryItem\" /&gt;\n    &lt;/GetFrameworkPath&gt;\n\n    &lt;PropertyGroup&gt;\n        &lt;TargetFrameworkDirectory&gt;@(_CombinedTargetFrameworkDirectoriesItem)&lt;/TargetFrameworkDirectory&gt;\n    &lt;/PropertyGroup&gt;\n\n    &lt;!-- Get the path to the target .NET framework SDK directory. --&gt;\n    &lt;GetFrameworkSdkPath&gt;\n        &lt;Output TaskParameter=\"FrameworkSdkVersion35Path\" PropertyName=\"TargetFrameworkSDKDirectory\"/&gt;\n        &lt;Output TaskParameter=\"FrameworkSdkVersion35Path\" ItemName=\"_TargetFrameworkSDKDirectoryItem\"/&gt;\n    &lt;/GetFrameworkSdkPath&gt;\n\n&lt;/Target&gt;\n</code></pre>\n\n<p>So, is there an easier way to alter the CSharp code based on the <code>System.XML</code> assembly being used ?\nIf this approach is correct, what condition <em>should</em> I use to define my <code>XMLDTDPROCESSING</code> constant ?</p>\n"},{"tags":["c#",".net","xbox360"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3769,"score":3,"question_id":2564692,"title":".NET XBox Live Account API","body":"<p>Is there a .NET API available to get data from your XBox Live account?\nAll I'm really interested in is who's online, but messages would be cool too.  And some sort of event driven notifications of user sign-on would be great, but I'll poll if need be.</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":74,"score":-1,"question_id":13288482,"title":"List<T>.Add doesn't work","body":"<p>I have a problem with List.Add(object). Item doesn't added to the list, but if I debug code item added! Who knows what the problem is?</p>\n\n<p>There is code.</p>\n\n<pre><code>private List&lt;ServiceInfo&gt; _startedServices = new List&lt;ServiceInfo&gt;();\n\npublic void StartService(ServiceInfo si, string instanceName)\n{\n    try\n    {\n        if (_internalInstance == null)\n        {\n            if(!FindInstance(instanceName))\n            throw new InvalidOperationException(\"Instance wasn't found in the supplied config file\");\n        }\n        ElTracer.WriteTraceLogInfo(\"Starting service \" + si.AssemblyContainingService);\n        if(ServiceFactory.CreateService(si, _internalInstance))\n        {\n            _startedServices.Add(si);\n            isServiceStarted = true;\n        }\n    }\n    catch (Exception e)\n    {\n        ElTracer.WriteTraceLogException(\"Failed to start instance:\" + si.AssemblyContainingService + \":\" + e);\n    }\n}\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","wcf","httpwebrequest","basichttpbinding"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13287283,"title":"Packet fragmentation in the WCF stack using BasicHttpBinding, http header and soap envelope always split by a packet boundary?","body":"<p>I have a problem whereby I have lots of very small web service calls to a Java endpoint (hosted on Oracle GlassFish 3.1.X).  I added this service as a Service Reference (using the remote wsdl file) and use a BasicHttpBinding to reach it.</p>\n\n<p>Since the service is located half the world away plus going across the internet, we frequently experience some packet loss when reaching the destination.  We are looking at any way possible to reduce the impact of these occurrences.  We have been using Wireshark to give us detailed knowledge of what is going across the wire to our destination, and back again.  I was curious to see that for every single request we generate, we are sending 2 packets.  The packet boundary is always between the HTTP header and the <code>&lt;s:Envelope&gt;</code> tag.  To me this is a big overhead, particularly in my environment where I want to minimise the amount of packets sent (to reduce overall packetloss).  </p>\n\n<p>In most cases (99% of our calls), the HTTP header packet is 210 bytes followed by a SOAP envelope packet of 291 bytes (excluding the 54 bytes of TCP/IP overhead for each packet).  Totalling these gives 501 bytes - just over a third of our Max Segment Size of 1460 bytes.  Why isn't WCF sending this HTTP POST request as a single packet of 501 bytes (555 bytes if you include the 54 bytes of TCP/IP overhead)?</p>\n\n<p><img src=\"http://i.stack.imgur.com/XhF2u.jpg\" alt=\"Wireshark reassembly screenshot\"></p>\n\n<p>Does anyone know why it does this?  It almost seems as if the HttpWebRequest object is calling .Flush() on the stream after writing it's headers but I'm not sure why it would do this?</p>\n\n<p>I've tried different combinations on these:</p>\n\n<pre><code>ServicePointManager.UseNagleAlgorithm = false;\nServicePointManager.Expect100Continue = false;\n</code></pre>\n\n<p>With no effect.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Wrong: <del>I've investigated a bit further and when a HttpWebRequest.GetRequestStream() is called, it does write the headers to the stream immediately.  At some stage before you write to the Stream that is given back to you, the network would Flush these (I guess? Unless a deliberate flush is happening somewhere).  When you finally start writing to the stream, it has already sent the header packet.  Not sure how to prevent this, it seems a very hard assertion inside the HttpWebRequest code that called GetRequestStream() will write the headers.  For my small requests, I want nothing to be written until I have closed the stream but that goes against the streaming nature of it.</del></p>\n"},{"tags":["c#","winforms","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13288181,"title":"DataContext from DLL has no Dispose() method","body":"<p>I have created a DLL which contains my LINQ DMBL files, which I have set as a reference in another project and is allowing me to interact with the database without problems. </p>\n\n<p>However, the DataContext is missing the Dispose() method, and when I try to wrap a using around it it tells me that it is not implicitly convertible to System.IDisposable. </p>\n\n<p>Is there something I'm missing here, as the Dispose() method is available in the DLL project. Is it somehow handled differently when the DataContext accessed via a DLL?</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","mysql","escaping"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13268907,"title":"Using literal underscore character in a MySQL query from c#","body":"<p>From my ASP.NET application I want to issue this query to MySQL</p>\n\n<pre><code>SELECT * FROM responses WHERE field_id LIKE '3\\_%'\n</code></pre>\n\n<p>In other words I am looking for records where the second character is the underscore literal character.</p>\n\n<p>The code generated by the model designer looks like this:</p>\n\n<pre><code>    public virtual RiskAnalysis.responsesDataTable GetResponseGroupForAnalysis(int raid, string fieldid) {\n    this.Adapter.SelectCommand = this.CommandCollection[2];\n    this.Adapter.SelectCommand.Parameters[0].Value = ((int)(raid));\n    if ((fieldid == null)) {\n        throw new global::System.ArgumentNullException(\"fieldid\");\n    }\n    else {\n        this.Adapter.SelectCommand.Parameters[1].Value = ((string)(fieldid));\n    }\n    RiskAnalysis.responsesDataTable dataTable = new RiskAnalysis.responsesDataTable();\n    this.Adapter.Fill(dataTable);\n    return dataTable;\n}\n</code></pre>\n\n<p>If I call this function like so:</p>\n\n<pre><code>string filter_string = @\"3\\_%\";    \nResponsesAdapter.GetResponseGroupForAnalysis(10, filter_string);\n</code></pre>\n\n<p>the MySQL log reports the query to look like this:</p>\n\n<pre><code>SELECT     *\nFROM         responses\nWHERE     (ra_id = 10) AND (field_id LIKE '3\\\\_%')\n</code></pre>\n\n<p>In other words the I know I'm missing something blindingly obvious here, but how do I place MySQL's escape backslash in the query without C# (un)helpfully escaping it?</p>\n"},{"tags":["c#","sql","wpf","listview","datatable"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13288467,"title":"Update listView bound to dataSet dataTable which looks up data from SQL c# wpf","body":"<p>I have a bit of an odd problem when trying to update a listView which is bouund to a dataSet.</p>\n\n<p>The dataSet gets its information from SQL and needs to auto update every 5 mins. At the moment I am using a backgroudWorker to get the new info and insert it into the dataSet.</p>\n\n<p>Then on the RunWorkerCompleted Event I do this</p>\n\n<pre><code>listView1.DataContex = dataSet.Tables[\"table\"].DefaultView\n</code></pre>\n\n<p>The DoWork Event contains something like this </p>\n\n<pre><code>dataSet.Clear();\n\nSqlDataAdapter adapter = new SqlDataAdapter(\n                \"SELECT [ContainerID] ,[UserID], [Spur], [Wave] ,[Date] FROM [ScannedItems] \" + \n                \"WHERE [Message] LIKE '%Success%'\" + \n                \"UNION ALL \" +\n                \"SELECT [ContainerID] ,[UserID], [Spur], [Wave] ,[Date] FROM [Workstation].[dbo].[AllSpurs] \" +\n                \"WHERE [Message] LIKE '%\" + \"Success\" + \"' ORDER BY [Date] DESC\", connection);\n\n\n            DataTableMapping mapping = adapter.TableMappings.Add(\"Table\", \"Packages Scanned\");\n            mapping.ColumnMappings.Add(\"ContainerID\", \"Cont\");\n            mapping.ColumnMappings.Add(\"UserID\", \"User\");\n            mapping.ColumnMappings.Add(\"Spur\", \"Spur\");\n            mapping.ColumnMappings.Add(\"Wave\", \"Wave\");\n            mapping.ColumnMappings.Add(\"Date\", \"Date\");\n\n            connection.Open();\n\n            adapter.FillSchema(dataSet, SchemaType.Mapped);\n            adapter.Fill(dataSet);\n\n            connection.Close();\n</code></pre>\n\n<p>This works when I call worker.RunWorkerAsync(); at startup.</p>\n\n<p>However when the timer calls it the tables go blank (all data removed). And if I try and scroll in the listVIew I get an error</p>\n\n<pre><code>Object reference not set to the instance of an object\n</code></pre>\n\n<p>However if I click the header of one of the columns the new data becomes visible and scrolling works.</p>\n\n<p>Could anyone let me know what I'm doing wrong.</p>\n\n<p>This is the XAML for the listView</p>\n\n<pre><code>&lt;ListView ItemContainerStyle=\"{StaticResource cnListView}\" ItemsSource=\"{Binding Path=Table}\" Margin=\"7,5,31,7\" Name=\"listView2\" SelectionMode=\"Multiple\" util:GridViewSort.AutoSort=\"True\" LostFocus=\"LostFocus\"&gt;\n                    &lt;ListView.View&gt;\n                        &lt;GridView x:Name=\"gridView1\" AllowsColumnReorder=\"False\" ColumnHeaderTemplate=\"{StaticResource cnDataViewHeader}\"&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Cont}\" util:GridViewSort.PropertyName=\"Cont\" Header=\"ContainerID\" Width=\"350\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=User}\" util:GridViewSort.PropertyName=\"User\" Header=\"User\" Width=\"200\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Spur}\" util:GridViewSort.PropertyName=\"Spur\" Header=\"Spur\" Width=\"120\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Wave, StringFormat='dd-MM-yyyy HH:mm:ss'}\" util:GridViewSort.PropertyName=\"Wave\" Header=\"Wave\" Width=\"250\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Date, StringFormat='dd-MM-yyyy HH:mm:ss'}\" util:GridViewSort.PropertyName=\"Date\" Header=\"Time Scanned\" Width=\"250\" /&gt;\n                        &lt;/GridView&gt;\n                    &lt;/ListView.View&gt;\n                &lt;/ListView&gt;\n</code></pre>\n\n<p>Thank You so much</p>\n"},{"tags":["c#","html","vb.net","regex"],"answer_count":9,"favorite_count":13,"up_vote_count":24,"down_vote_count":0,"view_count":8054,"score":24,"question_id":307013,"title":"How do I filter all HTML tags except a certain whitelist?","body":"<p>This is for .NET. IgnoreCase is set and MultiLine is NOT set.</p>\n\n<p>Usually I'm decent at regex, maybe I'm running low on caffeine...</p>\n\n<p>Users are allowed to enter HTML-encoded entities (&lt;lt;, &lt;amp;, etc.), and to use the following HTML tags:</p>\n\n<pre><code>u, i, b, h3, h4, br, a, img\n</code></pre>\n\n<p>Self-closing &lt;br/&gt; and &lt;img/&gt; are allowed, with or without the extra space, but are not required.</p>\n\n<p>I want to:</p>\n\n<ol>\n<li>Strip all starting and ending HTML tags other than those listed above. </li>\n<li>Remove attributes from the remaining tags, <em>except</em> anchors can have an href.</li>\n</ol>\n\n<p>My search pattern (replaced with an empty string) so far:</p>\n\n<pre><code>&lt;(?!i|b|h3|h4|a|img|/i|/b|/h3|/h4|/a|/img)[^&gt;]+&gt;\n</code></pre>\n\n<p>This <em>seems</em> to be stripping all but the start and end tags I want, but there are three problems:</p>\n\n<ol>\n<li>Having to include the end tag version of each allowed tag is ugly.</li>\n<li>The attributes survive. Can this happen in a single replacement?</li>\n<li>Tags <em>starting with</em> the allowed tag names slip through. E.g., \"&lt;abbrev&gt;\" and \"&lt;iframe&gt;\".</li>\n</ol>\n\n<p>The following suggested pattern does not strip out tags that have no attributes.</p>\n\n<pre><code>&lt;/?(?!i|b|h3|h4|a|img)\\b[^&gt;]*&gt;\n</code></pre>\n\n<p>As mentioned below, \"&gt;\" is legal in an attribute value, but it's safe to say I won't support that. Also, there will be no CDATA blocks, etc. to worry about. Just a little HTML.</p>\n\n<p>Loophole's answer is the best one so far, thanks! Here's his pattern (hoping the PRE works better for me):</p>\n\n<pre><code>static string SanitizeHtml(string html)\n{\n    string acceptable = \"script|link|title\";\n    string stringPattern = @\"&lt;/?(?(?=\" + acceptable + @\")notag|[a-zA-Z0-9]+)(?:\\s[a-zA-Z0-9\\-]+=?(?:([\"\"']?).*?\\1?)?)*\\s*/?&gt;\";\n    return Regex.Replace(html, stringPattern, \"sausage\");\n}\n</code></pre>\n\n<p>Some small tweaks I think could still be made to this answer:</p>\n\n<ol>\n<li><p>I think this could be modified to capture simple HTML comments (those that do not themselves contain tags) by adding \"!--\" to the \"acceptable\" variable and making a small change to the end of the expression to allow for an optional trailing \"\\s--\".</p></li>\n<li><p>I think this would break if there are multiple whitespace characters between attributes (example: heavily-formatted HTML with line breaks and tabs between attributes).</p></li>\n</ol>\n\n<p><strong>Edit 2009-07-23:</strong> Here's the final solution I went with (in VB.NET):</p>\n\n<pre><code> Dim AcceptableTags As String = \"i|b|u|sup|sub|ol|ul|li|br|h2|h3|h4|h5|span|div|p|a|img|blockquote\"\n Dim WhiteListPattern As String = \"&lt;/?(?(?=\" &amp; AcceptableTags &amp; _\n      \")notag|[a-zA-Z0-9]+)(?:\\s[a-zA-Z0-9\\-]+=?(?:([\"\"']?).*?\\1?)?)*\\s*/?&gt;\"\n html = Regex.Replace(html, WhiteListPattern, \"\", RegExOptions.Compiled)\n</code></pre>\n\n<p>The caveat is that the HREF attribute of A tags still gets scrubbed, which is not ideal.</p>\n"},{"tags":["c#",".net","windows-services","windows-process"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":3,"view_count":24,"score":-3,"question_id":13283608,"title":"Restrict users to open browsers(firefox, chrome, ie) in windows xp","body":"<p>I have two applications</p>\n\n<p>One is windows application and another one is windows service. </p>\n\n<p>When i run the windows application, check whether the browsers are opened or not, if  opened to kill the process and also i don't want allow to start the browsers also.</p>\n\n<p>I know how to kill the process.\nhow to restrict to start the browsers(How can i find the process initialization of browsers)</p>\n"},{"tags":["c#",".net","math","regression","linear-regression"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13231068,"title":"Applying mathematical expressions on time series data","body":"<p>I have parsed HL7 file and have generated some values. So that now, I have series of values over time for different identifiers of OBX segment of HL7 file.</p>\n\n<p>Now, as per requirement I want to apply following expressions over this timely generated data:</p>\n\n<p><code>Slope: dv/dt</code></p>\n\n<p><code>Acceleration: Change in slope over time</code></p>\n\n<p><code>Integration</code></p>\n\n<p><code>Bandpass: Filter function that will limit values in particular range</code></p>\n\n<p>For slope calculation I have referred <a href=\"http://dynamicnotions.blogspot.in/2009/05/linear-regression-in-c.html\" rel=\"nofollow\">http://dynamicnotions.blogspot.in/2009/05/linear-regression-in-c.html</a>. My small code will simply calculate slope of graph generated for values of one object identifier of HL7 file(like HR, PVC). I just want to know how can I apply all remaining expressions. Please tell me if there are any libraries I can refer for this. </p>\n"},{"tags":["c#","asp.net-mvc","html-helper","mvchtmlstring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12635590,"title":"TagBuilder.MergeAttributes does not work","body":"<p>I am trying to make a HtmlHelper and i need to allow user to add it's own custom attributes to the html tag.</p>\n\n<p>I tryied to do this using TagBuilder class, but it seems that instead of merging the attributes, it just replaces them.</p>\n\n<p>This is what i did in C#</p>\n\n<pre><code>public static MvcHtmlString List(this HtmlHelperhelper, object htmlAttributes)\n{\n    var attributes = HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);\n\n    var tag = new TagBuilder(\"div\");\n    tag.AddCssClass(\"myClass\");\n    tag.MergeAttributes(attributes, false);\n\n    // tag class property has value \"myClass\", not \"myClass testClass\"\n\n    return new MvcHtmlString(\"&lt;div&gt;\");\n}\n</code></pre>\n\n<p>This is my view:</p>\n\n<pre><code>@Html.List(new { @class = \"testClass\" })\n</code></pre>\n\n<p>What am i doing wrong?</p>\n"},{"tags":["c#","linq",".net-3.5"],"answer_count":4,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":12020,"score":9,"question_id":802256,"title":"How can I convert anonymous type to strong type in LINQ?","body":"<p>I have an array of ListViewItems ( <code>ListViewItem[]</code> ), where I store a <code>SalesOrderMaster</code> object in each ListViewItem.Tag for later reference.</p>\n\n<p>I have some code that right now, goes through each <code>ListViewItem</code> safely casts the .Tag property into a SalesOrderMaster object, then adds that object to a collection of SalesOrders, only after checking to make sure the order doesn't already exist in that collection.</p>\n\n<p>The process to <strong>compare</strong> sales orders is expensive, and I would like to convert this to a LINQ expression for clarity and performance. ( I also have the <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&amp;displaylang=en\">Parallel Extensions to .NET Framework 3.5</a> installed so I can use that to further improve LINQ performance)</p>\n\n<p>So without further ado: This is what I have, and then what I want. ( what I want won't compile, so I know I am doing something wrong, but I hope it illustrates the point )</p>\n\n<p>What I have: ( Slow )</p>\n\n<pre><code>foreach (ListViewItem item in e.Argument as ListViewItem[])\n            {\n                SalesOrderMaster order = item.Tag as SalesOrderMaster;\n                if ( order == null )\n                {\n                    return;\n                }\n                if (!All_SalesOrders.Contains(order))\n                {\n                    All_SalesOrders.Add(order);\n                }\n            }\n</code></pre>\n\n<p>What I want: ( Theory )</p>\n\n<pre><code>    List&lt;SalesOrderMaster&gt; orders = \n(from item in (e.Argument as ListViewItem[]).AsParallel() \nselect new { ((SalesOrderMaster)item.Tag) }).Distinct();\n</code></pre>\n\n<p>EDIT: I know the cast is cheap, I said the \"Compare\", which in this case translates to the .Contains(order) operation</p>\n\n<p>EDIT: Everyone's answer was awesome! I wish I could mark more than one answer, but in the end I have to pick one.</p>\n\n<p>EDIT : This is what I ended up with: </p>\n\n<pre><code>List&lt;SalesOrderMaster&gt; orders = \n(from item in (e.Argument as ListViewItem[]) select (SalesOrderMaster) item.Tag).GroupBy(item =&gt; item.Number).Select(x =&gt; x.First()).ToList();\n</code></pre>\n"},{"tags":["c#","linq","xml-parsing","linq-to-xml"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13283012,"title":"How can i remove the duplicate element from a xml document without scribbling the structure of xml using c#","body":"<p>Below is the sample xml .    </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Terms&gt;  \n   &lt;Term Id=\"D7923D9888BF100482C2CB8225D5863E\" Name=\"Television\" IsPlaceholder=\"false\" /&gt;  \n   &lt;Term Id=\"F25AF2D07E4E100484F5DF092526B43E\" Name=\"General news\" IsPlaceholder=\"false\"&gt;\n     &lt;ChildTerms&gt;\n       &lt;Term Id=\"04969DF089DA10048141D56C852D093E\" Name=\"Bombings\" IsPlaceholder=\"false\" /&gt;\n       &lt;Term Id=\"0E8CF338896510048024D56C852D093E\" Name=\"Protests and demonstrations\" IsPlaceholder=\"false\" /&gt;\n       &lt;Term Id=\"17956128897810048CE8D56C852D093E\" Name=\"Law and order\" IsPlaceholder=\"false\"&gt;\n     &lt;ChildTerms&gt;\n       &lt;Term Id=\"3EC37E763F534FDB8A10C63768DAD1B7\" Name=\"Executions\" IsPlaceholder=\"false\" /&gt;\n       &lt;Term Id=\"78C99FE8829F100481B5DF092526B43E\" Name=\"Trials\" IsPlaceholder=\"false\" /&gt;\n       &lt;Term Id=\"C72CC1E0883210048566AE2AC3A6923E\" Name=\"Prison breaks\" IsPlaceholder=\"false\" /&gt;\n       &lt;Term Id=\"CD42D51088321004856EAE2AC3A6923E\" Name=\"Prison riots\" IsPlaceholder=\"false\" /&gt;\n    &lt;/ChildTerms&gt;\n   &lt;/Term&gt;\n   &lt;Term Id=\"31711EC0894B10048983BA0A2B2CA13E\" Name=\"Accidents and disasters\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"2D777E23418C4A61AB869F88F0CC22B5\" Name=\"Industrial accidents\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"6EF1C84088321004850DAE2AC3A6923E\" Name=\"Mining accidents\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"77A15F9213344CF8AEFBD6560C618C9A\" Name=\"Oil spills\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"439E22A0894B100489C4BA0A2B2CA13E\" Name=\"Structural failures\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"513CDC30894B10048A8E87A309043C03\" Name=\"Bridge collapses\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"513D0340894B10048A8E87A309043C03\" Name=\"Building collapses\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"58AD538091C7100480A9A55C96277D3E\" Name=\"Evacuations\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"6B5B04B0882F100480E6AE2AC3A6923E\" Name=\"Fires\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"69D001C8896410048EBBD56C852D093E\" Name=\"Residential fires\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C61CA38882F10048FA88BB2970C7204\" Name=\"Wildfires\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"6C633968882F10048FA88BB2970C7204\" Name=\"Floods\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"7448DD4882A0100481DDDF092526B43E\" Name=\"Natural disasters\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"6C61CA38882F10048FA88BB2970C7204\" Name=\"Wildfires\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C615120882F10048FA68BB2970C7204\" Name=\"Earthquakes\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C618FA0882F10048FA78BB2970C7204\" Name=\"Tsunamis\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C6281D0882F10048FA88BB2970C7204\" Name=\"Droughts\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C62C050882F10048FA88BB2970C7204\" Name=\"Landslides and mudslides\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6C633968882F10048FA98BB2970C7204\" Name=\"Avalanches\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"A6F2C1C887E110048A6E8BEAE5FD5C07\" Name=\"Tornados\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"B4600998883010048C189528EB155503\" Name=\"Volcanic eruptions\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"DC90FFA0686948409257760CC35E98EB\" Name=\"Tropical cyclones\" IsPlaceholder=\"false\"&gt;\n            &lt;ChildTerms&gt;\n              **&lt;Term Id=\"6C6377E8882F10048FAB8BB2970C7204\" Name=\"Hurricanes\" IsPlaceholder=\"false\" /&gt;**\n              &lt;Term Id=\"A6F2C1C887E110048A6D8BEAE5FD5C07\" Name=\"Tropical storms\" IsPlaceholder=\"false\" /&gt;\n            &lt;/ChildTerms&gt;\n          &lt;/Term&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"B6503CF08830100482EFAE2AC3A6923E\" Name=\"Power outages\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"CCC363A0882F10048140AE2AC3A6923E\" Name=\"Explosions\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"E20E7174E0154782B8733D180A799D34\" Name=\"Transportation accidents\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"3C105048882F100489FD9528EB155503\" Name=\"Automotive accidents\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"3C107758882F100489FE9528EB155503\" Name=\"Maritime accidents\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"41687660882F10048A199528EB155503\" Name=\"Plane crashes\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6AA161B575F64C62993BC3E9CD82BB69\" Name=\"Rail accidents\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"48612B807C2B4B93BBBACBF54F547AD5\" Name=\"Crime\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"13C6A480899B10048B9DD56C852D093E\" Name=\"Violent crime\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"5018B8F4DED948128561C5AF2144CA66\" Name=\"Shootings\" IsPlaceholder=\"false\"&gt;\n            &lt;ChildTerms&gt;\n              &lt;Term Id=\"312A72707E8510048A118087FC32D30C\" Name=\"School shootings\" IsPlaceholder=\"false\" /&gt;\n            &lt;/ChildTerms&gt;\n          &lt;/Term&gt;\n          &lt;Term Id=\"92DD72A8899B10048F2CD56C852D093E\" Name=\"Assassinations\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"C5A59C298A2A4A36A618EFB20DF09A3C\" Name=\"Homicide\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"FCAF54924FA3415DA977901DDB1E2EA7\" Name=\"Gang-related crime\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"CA356A4172C64D3FA631803BA6CCC074\" Name=\"Arson\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"CD80007770234E6AA95991F7D3B0C737\" Name=\"Hate crimes\" IsPlaceholder=\"false\" /&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"5F7806EEC29A4884B038A26D799E9326\" Name=\"Strikes\" IsPlaceholder=\"false\" /&gt;\n  &lt;Term Id=\"5FC806A87DF7100483EBDF092526B43E\" Name=\"Weather\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"A6F2C1C887E110048A6E8BEAE5FD5C07\" Name=\"Tornados\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"88C2A7E08886100487FECB8225D5863E\" Name=\"Storms\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"DC90FFA0686948409257760CC35E98EB\" Name=\"Tropical cyclones\" IsPlaceholder=\"false\"&gt;\n            &lt;ChildTerms&gt;\n              **&lt;Term Id=\"6C6377E8882F10048FAB8BB2970C7204\" Name=\"Hurricanes\" IsPlaceholder=\"false\" /&gt;**\n              &lt;Term Id=\"A6F2C1C887E110048A6D8BEAE5FD5C07\" Name=\"Tropical storms\" IsPlaceholder=\"false\" /&gt;\n            &lt;/ChildTerms&gt;\n          &lt;/Term&gt;\n          &lt;Term Id=\"59143B3791444BF7BD11992B42B8EA2E\" Name=\"Wind storms\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"A6F248B087E110048A6B8BEAE5FD5C07\" Name=\"Blizzards\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"A6F2873087E110048A6C8BEAE5FD5C07\" Name=\"Thunderstorms\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"A6F3004887E110048A6F8BEAE5FD5C07\" Name=\"Ice storms\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"7CF243908830100481E9AE2AC3A6923E\" Name=\"War and unrest\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"3510D930896410048E5CD56C852D093E\" Name=\"Genocides\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"535DB1708832100484DBAE2AC3A6923E\" Name=\"Troop withdrawals\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"5FEF4190897910048240D56C852D093E\" Name=\"Massacres\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"6BCC38A43C5C4BC196FB108112EAA6C1\" Name=\"Civil wars\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"98C3B8C5D6AF41C296A3CA1E4C0977ED\" Name=\"Terrorism\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"D7F9E33889701004837FD56C852D093E\" Name=\"Terrorist attacks\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"9BEC03A0883310048673AE2AC3A6923E\" Name=\"Military occupations\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"B9779BC8896410048F4CD56C852D093E\" Name=\"Troop deployments\" IsPlaceholder=\"false\" /&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"877CB3C0899A10048ABBD56C852D093E\" Name=\"Transportation\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"E20E7174E0154782B8733D180A799D34\" Name=\"Transportation accidents\" IsPlaceholder=\"false\"&gt;\n        &lt;ChildTerms&gt;\n          &lt;Term Id=\"3C105048882F100489FD9528EB155503\" Name=\"Automotive accidents\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"3C107758882F100489FE9528EB155503\" Name=\"Maritime accidents\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"41687660882F10048A199528EB155503\" Name=\"Plane crashes\" IsPlaceholder=\"false\" /&gt;\n          &lt;Term Id=\"6AA161B575F64C62993BC3E9CD82BB69\" Name=\"Rail accidents\" IsPlaceholder=\"false\" /&gt;\n        &lt;/ChildTerms&gt;\n      &lt;/Term&gt;\n      &lt;Term Id=\"9031A908899A10048BAFCECE19677003\" Name=\"Traffic\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"90321E38899A10048BAFCECE19677003\" Name=\"Air travel disruptions\" IsPlaceholder=\"false\" /&gt;\n      &lt;Term Id=\"90321E38899A10048BB0CECE19677003\" Name=\"Rail travel disruptions\" IsPlaceholder=\"false\" /&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"9D48E670883110048405AE2AC3A6923E\" Name=\"International incidents\" IsPlaceholder=\"false\" /&gt;\n  &lt;Term Id=\"A0433408883010048BE79528EB155503\" Name=\"Riots\" IsPlaceholder=\"false\" /&gt;\n  &lt;Term Id=\"CAEFF3958DE64F4D989F5EF1209BD073\" Name=\"Humanitarian crises\" IsPlaceholder=\"false\"&gt;\n    &lt;ChildTerms&gt;\n      &lt;Term Id=\"463C2098896410048E93D56C852D093E\" Name=\"Famine\" IsPlaceholder=\"false\" /&gt;\n    &lt;/ChildTerms&gt;\n  &lt;/Term&gt;\n  &lt;Term Id=\"CE211E3891B0100483C1A55C96277D3E\" Name=\"Record setting events\" IsPlaceholder=\"false\" /&gt;\n  &lt;Term Id=\"DA6509F88971100486C5D56C852D093E\" Name=\"Search and rescue efforts\" IsPlaceholder=\"false\" /&gt;\n&lt;/ChildTerms&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>as you can see there are two entries for <strong>Hurricanes</strong>(Please find for ** mark before an elment) i just want to remove any one of them .I tried using Linq but it is scribbling the structure of the xml. Please help me out.</p>\n"},{"tags":["c#","web-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13288209,"title":"When host an oneway web service, i can't get the HttpContext.Current.ApplicationInstance","body":"<p>when i set the method attibute SoapDocumentMethod oneway=true i will can't get the HttpContext.Current.ApplicationInstance</p>\n\n<pre><code>[WebMethod]\n[SoapDocumentMethod(OneWay=true)]\npublic void Method1(INPUT oInput)\n{\n   var instance=HttpContext.Current.ApplicationInstance;\n}\n</code></pre>\n\n<p>how could i get the HttpContext.Current.ApplicationInstance while i use the oneway method.</p>\n\n<p>thanks.</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13288311,"title":"Click Event not working in windows mobile 6.0 application","body":"<p>I am currently doing a project on windows mobile application 6.0 all the application was working fill till i add a .dll file now it shows the error as shown below <img src=\"http://i.stack.imgur.com/izy4x.png\" alt=\"enter image description here\"></p>\n\n<p>The events are not working after adding that dll</p>\n"},{"tags":["c#","java","sql-server","jdbc","odbc"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13274852,"title":"What Java and/or C# frameworks are avaiable to implement SQL server accessible via ODBC/JDBC?","body":"<p>I need to figure out how to create server which behaves like SQL server in respect of accepting connections via ODBC, JDBC, etc, but implemented by me on C# (and/or Java) I.e. I don't want to create tables, call stored procs etc.\nFor the sake of example I just want to have query implemented:</p>\n\n<p>select * from HardcodedTableOfMyFavoriteColors</p>\n\n<p>Any other queries should just fail. The query should return just few colors (hardcoded in server code).</p>\n\n<p>If somebody interested why I need such thing the answer is below.</p>\n\n<p>My actual purpose is to be able to create C# (or Java) server accessible via JDBC/ODBC/etc way from legacy app with strictly defined set of queries. I hope framework will be able to parse query to XML to make my life a bit easier. However response data will be generated by my code and could be something depending on other systems, time etc. On client side response should look like usual SQL server response processed via the same JDBC/ODBC etc API calls.\nBy doing such substitution I hope to reimplement bloated stored procedure logic in C# (or Java) without need to change clients.</p>\n\n<p>Unfortunately I have to have implementation of such SQL-mimic server on both Linux and Windows because I forced to deal with home-grown Java library on Linux and C# on Windows to access custom COM objects.</p>\n\n<p>Anyone?</p>\n"},{"tags":["c#","asp.net","gridview","hyperlink"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13288215,"title":"Dynamically add HyperLink in GridView","body":"<p>I have two types of code:\n1st:</p>\n\n<pre><code>               &lt;Columns&gt;\n                &lt;asp:TemplateField&gt;\n                    &lt;ItemTemplate&gt;\n                        &lt;asp:HyperLink runat=\"server\" Text=\"Скачать объект\" NavigateUrl='&lt;%#\"objects/\" + Eval(\"Идентификатор\") %&gt;'&gt;&lt;/asp:HyperLink&gt;\n                    &lt;/ItemTemplate&gt;    \n                &lt;/asp:TemplateField&gt;\n               &lt;/Columns&gt;\n</code></pre>\n\n<p>works normal. But TemplateField showed everytime.</p>\n\n<p>2nd</p>\n\n<pre><code>            TemplateField templField = new TemplateField();\n            HyperLink hypLink = new HyperLink();\n            hypLink.NavigateUrl = \"&lt;%#\\\"objects/\\\" + Eval(\\\"Идентификатор\\\") %&gt;\";\n            hypLink.Text = \"Скачать объект\";\n            templField.InsertItemTemplate = (ITemplate)hypLink;\n            tableResults.Columns.Add(templField);\n</code></pre>\n\n<p>dosn't work with error: Unable to cast object of type 'System.Web.UI.WebControls.HyperLink' to type 'System.Web.UI.ITemplate'. Why in 1st time HyperLink added, in 2nd time didn't?</p>\n"},{"tags":["c#","visual-studio-2010","application","parameters","exe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":30,"score":-3,"question_id":13286278,"title":"c# access .exe and pass parameters to called application without displaying last","body":"<p>Have app1.exe with input parameters and buttons. How to create c# code to access app1.exe pass parameters for input and press button? thanks for any suggestion</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1923,"score":2,"question_id":5677117,"title":"Draw images and text in ComboBox","body":"<p>I have a ComboBox in WindowsForms and I draw items manually. Each item is composed from picture and text (Cell.Image and Cell.Title), so item is 34 px height.</p>\n\n<p>My problem is that when I drop down ComboBox, only 1 item is visible. MaxDropDownItems = 4 so ComboBox would draw 4 items. I know that I have set DropDownHeight = 34, but I want to display empty rectangle when there is no item in ComboBox like on the following picture.</p>\n\n<p>ComboBox with no item - OK:\n<img src=\"http://i.stack.imgur.com/L2ylw.png\" alt=\"ComboBox with no item - OK\"></p>\n\n<p>ComboBox with only 1 visible item - Bad:\n<img src=\"http://i.stack.imgur.com/YdND0.png\" alt=\"ComboBox with only 1 visible item - Bad\"></p>\n\n<p>My class derived from ComboBox:</p>\n\n<pre><code>public class ComboBoxCells : ComboBox\n{\n    private List&lt;Cell&gt; _cells;\n\n    public List&lt;Cell&gt; Cells\n    {\n        get { return this._cells; }\n        set\n        {\n            this._cells = value;\n            this.BeginUpdate();\n            this.Items.Clear();\n\n            if (value != null)\n                this.Items.AddRange(value.ToArray());\n\n            this.EndUpdate();\n        }\n    }\n\n    public ComboBoxCells()\n    {\n        this.DrawMode = DrawMode.OwnerDrawVariable;\n        this.DropDownHeight = 34;\n        this.DropDownWidth = 200;\n        this.DropDownStyle = ComboBoxStyle.DropDownList;\n        this.MaxDropDownItems = 4;\n\n        this.DrawItem += new DrawItemEventHandler(ComboBoxCells_DrawItem);\n        this.MeasureItem += new MeasureItemEventHandler(ComboBoxCells_MeasureItem);\n    }\n\n    private void ComboBoxCells_DrawItem(object sender, DrawItemEventArgs e)\n    {\n        e.DrawBackground();\n\n        // Draw item inside comboBox\n        if ((e.State &amp; DrawItemState.ComboBoxEdit) != DrawItemState.ComboBoxEdit &amp;&amp; e.Index &gt; -1)\n        {\n            Cell item = this.Items[e.Index] as Cell;\n\n            e.Graphics.FillRectangle(Brushes.Gray, new Rectangle(e.Bounds.Left + 6, e.Bounds.Top + 6, 22, 22));\n\n            e.Graphics.DrawImage(item.Image, new Rectangle(e.Bounds.Left + 7, e.Bounds.Top + 7, 20, 20));\n\n            e.Graphics.DrawString(item.Title, e.Font,\n                    new SolidBrush(e.ForeColor), e.Bounds.Left + 34, e.Bounds.Top + 10);\n        }\n        // Draw visible text\n        else if (e.Index &gt; -1)\n        {\n            Cell item = this.Items[e.Index] as Cell;\n\n            e.Graphics.DrawString(item.Title, e.Font,\n                    new SolidBrush(e.ForeColor), e.Bounds.Left, e.Bounds.Top);\n        }\n\n        e.DrawFocusRectangle();\n    }\n\n    private void ComboBoxCells_MeasureItem(object sender, MeasureItemEventArgs e)\n    {\n        e.ItemHeight = 34;\n    }\n}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13287557,"title":"Uploading Excel “External table is not in the expected format.”","body":"<pre><code> protected void imgButtonSearchProperty_Click(object sender, EventArgs e)\n {\n    try\n    {\n        if (FileUpload1.HasFile)\n        {\n            lblmsg.Visible = false;\n            GridView2.DataSource = null;\n            GridView2.DataBind();\n            GridView2.Visible = false;\n            string FileName = Path.GetFileName(FileUpload1.PostedFile.FileName);\n            AppLog.Log(\"The name of the file is \" + FileName);\n            string Extension = Path.GetExtension(FileUpload1.PostedFile.FileName);\n            AppLog.Log(\"The name of the extension is \" + Extension);\n            string FolderPath = ConfigurationManager.AppSettings[\"FolderPath\"];\n            AppLog.Log(\"The name of the FolderPath is \" + FolderPath);\n            string FilePath = Server.MapPath(FolderPath + \"\\\\\" + FileName);\n            AppLog.Log(\"The name of the FilePath is \" + FilePath);\n            FileUpload1.SaveAs(FilePath);\n            Import_To_Grid(FilePath, Extension);\n        }\n    }\n    catch (Exception ex)\n    {\n\n    }\n}\n private void Import_To_Grid(string FilePath, string Extension)\n{\n    try\n    {\n        string conStr = \"\";\n        switch (Extension)\n        {\n            case \".xls\": //Excel 97-03\n                conStr = ConfigurationManager.ConnectionStrings[\"Excel03ConString\"].ConnectionString;\n                break;\n            case \".xlsx\": //Excel 07\n                conStr = ConfigurationManager.ConnectionStrings[\"Excel07ConString\"].ConnectionString;\n                break;\n        }\n        conStr = String.Format(conStr, FilePath, 1);\n        OleDbConnection connExcel = new OleDbConnection(conStr);\n        OleDbCommand cmdExcel = new OleDbCommand();\n        OleDbDataAdapter oda = new OleDbDataAdapter();\n        cmdExcel.Connection = connExcel;\n        connExcel.Open();\n        DataTable dtExcelSchema;\n        dtExcelSchema = connExcel.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);\n        string SheetName = dtExcelSchema.Rows[0][\"TABLE_NAME\"].ToString();\n        //dSUploadInventory.Tables.Add(dtExcelSchema);\n        connExcel.Close();\n\n        //Read Data from First Sheet\n        connExcel.Open();\n        cmdExcel.CommandText = \"SELECT * From [\" + SheetName + \"]\";\n        oda.SelectCommand = cmdExcel;\n        oda.Fill(dt);\n        connExcel.Close();\n\n\n\n        ////To\n        string expression = string.Empty;\n        expression = \"ISNULL(PropertyId,0)=0\";\n        DataRow[] rows = dt.Select(expression);\n\n        if (rows.Length &gt; 0)\n        {\n            foreach (DataRow row in rows)\n            {\n                row.Delete();\n                row.AcceptChanges();\n            }\n        }\n        ////To Do\n        ViewState[\"ExcelData\"] = dt;\n\n\n\n        GridView1.DataSource = dt;\n        GridView1.DataBind();\n        if (dt.Rows.Count &gt; 0)\n        {\n            imgButtonSubmit.Visible = true;\n        }\n    }\n    catch (Exception ex)\n    {\n\n    }\n\n}\n</code></pre>\n\n<p>The connection string that I am using in web.config file is :\n</p>\n\n<pre><code>&lt;add name=\"Excel03ConString\" connectionString=\"Provider=Microsoft.Jet.OLEDB.4.0;Data      \nSource={0};Extended Properties='Excel 8.0;HDR={1}'\" /&gt; \n&lt;add name=\"Excel07ConString\" connectionString=\"Provider=Microsoft.ACE.OLEDB.12.0;Data \nSource={0};Extended Properties='Excel 12.0;HDR={1}'\" /&gt;\n</code></pre>\n\n<p>When I am trying to upload the excel using aforementioned code , I am getting the following error :</p>\n\n<pre><code>“External table is not in the expected format.”\n</code></pre>\n\n<p>I have added the connection string\nHelp would be appreciated.</p>\n"},{"tags":["c#","scanning","twain"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":167,"score":0,"question_id":11662418,"title":".NET Scanning API for 64bit machine","body":"<p>Is there a .Net scanning API available for 64bit machine to scan document or images from scanner? Can anyone give me sample code for this.</p>\n\n<p>Thanks \nAsif</p>\n"},{"tags":["c#","asp.net-mvc","razor","asp.net-mvc-4","ef-code-first"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13287539,"title":"ListBoxFor a many to many relationship","body":"<p>I Have to entities, and i'm using EF CodeFirst</p>\n\n<pre><code>public class DataContext : DbContext\n{\n    public DbSet&lt;Frame&gt; Frames { get; set; }\n    public DbSet&lt;GlassType&gt; GlassType { get; set; }\n}\n\npublic class Frame\n{\n    public int Id { get; set; }\n    public string size { get; set; }\n    public virtual ICollection&lt;Color&gt; Colors{ get; set; }\n}\n\npublic class Color\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n    public virtual ICollection&lt;Frame&gt; Frames { get; set; }\n}\n</code></pre>\n\n<p>And when i create or edit a frame, i want to select multiple colors with <code>@Html.ListBoxFor</code> or just ListBox. How do you guys do this?</p>\n\n<p><strong>Update: This is what i've tried allready</strong></p>\n\n<p>Controller:</p>\n\n<pre><code>public ActionResult Create()\n{\n    ViewBag.List = new SelectList(db.Colors,\"Id\",\"Name\");\n    return View();\n}\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>@Html.ListBox(\"Colors\",(SelectList)ViewBag.List);\n@Html.ValidationMessageFor(model =&gt; model.Colors)\n</code></pre>\n\n<p>But when i submit it loads, and then this ModelState error is added:</p>\n\n<blockquote>\n  <p>The value '3' is invalid.</p>\n</blockquote>\n"},{"tags":["c#","asp.net","gridview","url-rewriting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13283902,"title":"URL Rewriting from GridView in ASP.NET 4.0","body":"<p>I'm using Url Rewriting in my website.</p>\n\n<p>I'm able to rewrite the url using</p>\n\n<pre><code>Response.RedirectToRoute(\"bills-show\");\n</code></pre>\n\n<p>But from my GridView how can I redirect to another page ??\n Currently I'm using the following code in my <code>GridViewRowDataBound</code>.</p>\n\n<pre><code>e.Row.Attributes.Add(\"onclick\", \"location='CallCenter/BillDetails.aspx?billNo=\" + e.Row.Cells[0].Text + \"'\");\n</code></pre>\n\n<p>But what I need is using URL Rewriting.</p>\n\n<p>I tried using </p>\n\n<pre><code>e.Row.Attributes.Add(\"onclick\", \"WriteUrl(\" + e.Row.Cells[0].Text + \")\"); // in GridViewRowDataBound.\n</code></pre>\n\n<p>and</p>\n\n<pre><code>protected string WriteUrl(string billNo)\n{\n    return pg.GetRouteUrl(\"bill-details\", new { billno = billNo });\n}\n</code></pre>\n\n<p>but this is not working !!!</p>\n\n<p>Can you help me out ???</p>\n"},{"tags":["c#","generics","reflection","methodinfo","parameterinfo"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":285,"score":4,"question_id":4738826,"title":"How to determine if ParameterInfo is of generic type?","body":"<p>I have a <code>MethodInfo</code> of a GenericMethodDefinition.  Such as: <code>CallMethod&lt;T&gt;(T arg, string arg2)</code>.  The GetParameters() method will give me two ParameterInfo objects, the first of which is generic, the second of which is not.  How can I get ParameterInfo to tell me it is generic?  What about if it has constraints?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13287216,"title":"C#/aspx.net process Post Values form","body":"<p>I'm quite new on aspx development, and I'm struggling a lot with the connection of aspx code and aspx.cs, precisely I've following problem :</p>\n\n<p>DisplayChars.aspx :</p>\n\n<pre><code>&lt;form id=\"form1\" runat=\"server\"&gt;\n&lt;div&gt;   \n    &lt;div&gt;Champion name: &lt;/div&gt; &lt;div&gt;&lt;input id=\"Champ_name\" type=\"text\" /&gt;&lt;/div&gt;\n    &lt;div&gt;Champion Icon URL: &lt;/div&gt; &lt;div&gt;&lt;input id=\"Champ_icon\" type=\"text\" /&gt;&lt;/div&gt;\n    &lt;div&gt;Champion Subtext: &lt;/div&gt; &lt;div&gt;&lt;input id=\"Champ_subtext\" type=\"text\" /&gt;&lt;/div&gt;\n    &lt;div&gt; Free to play :&lt;/div&gt;&lt;div&gt;&lt;input id=\"Champ_freetoplay\" type=\"checkbox\" /&gt;\n&lt;/div&gt;\n&lt;div&gt;Positions:&lt;/div&gt;\n&lt;div&gt;\n        &lt;input id=\"Top\" type=\"checkbox\" /&gt; Top\n        &lt;input id=\"Mid\" type=\"checkbox\" /&gt; Mid\n        &lt;input id=\"Jungle\" type=\"checkbox\" /&gt; Jungle\n        &lt;input id=\"Carry\" type=\"checkbox\" /&gt; Carry\n        &lt;input id=\"Support\" type=\"checkbox\" /&gt; Support\n&lt;/div&gt;\n&lt;/div&gt;\n    &lt;input id=\"Champ_Submit\" type=\"submit\" value=\"submit\" /&gt;\n</code></pre>\n\n<p>DisplayChars.aspx.cs</p>\n\n<pre><code> if (IsPostBack)    \n        {\n            //NameValueCollection nvc = Request.Form.GetValues\n            //Champion t1 = new Champion(Request.Form.Get(\"Champ_Name\"), Int32.Parse(Request.Form.Get(\"Champ_freetoplay\")), Request.Form.Get(\"Champ_subtext\"), Request.Form.Get(\"Champ_description\"), \"10110\");\n            //t1.persistChampion();\n            string temp = Request[\"Champ_name\"];\n</code></pre>\n\n<p>So I'm struggling with getting the Form-values some how. \nI've tried <code>Request.Form.GetValues</code>,<code>Request.Form.Get</code> even <code>Request[\"Form_id_Name\"]</code>.</p>\n\n<p>The Question is, if this approach is even right, as I've experience in Object-oriented programming, but not in this combination of HTML aspx pseudo server code, and a cs-file behind it.</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":13139615,"title":"DataGrid column headers not aligned with data","body":"<p>I've got a DataGrid, which is quite simple as far as DataGrids go.  For some reason or other, the headers are not aligned with the rest of the data, as shown in the screenshot below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/0Neao.png\" alt=\"enter image description here\"></p>\n\n<p>I've searched the internet but cannot seem to find a solution for it.  Here is my DataGrid code:</p>\n\n<pre><code>Grid&gt;\n        &lt;DataGrid Name=\"dgAttributes\" \n                  ItemsSource=\"{Binding itemsSource}\" \n                  AutoGenerateColumns=\"False\" \n                  CanUserAddRows=\"False\" \n                  CanUserDeleteRows=\"False\" \n                  CanUserReorderColumns=\"False\" \n                  CanUserResizeColumns=\"False\" \n                  CanUserResizeRows=\"False\"\n                  CanUserSortColumns=\"False\"\n                  &gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"True\" Binding=\"{Binding Field}\" Header=\"Fields\"/&gt;\n                &lt;DataGridComboBoxColumn  Width=\"95\" IsReadOnly=\"False\" Header=\"Order\" ItemsSource=\"{Binding Source={StaticResource SortOrderProvider}}\" SelectedItemBinding=\"{Binding SortBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridCheckBoxColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding GroupBy}\" Header=\"Group By\"/&gt;\n                &lt;DataGridComboBoxColumn Width=\"85\" IsReadOnly=\"False\" Header=\"Aggregate\" ItemsSource=\"{Binding Source={StaticResource AggregateProvider}}\" SelectedItemBinding=\"{Binding AggregateBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding Having}\" Header=\"Having\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding DisplayOrder}\" Header=\"Display Order\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>It may also be worth mentioning that when I click on one of the Combobox cells, the headers align themselves properly.</p>\n"},{"tags":["c#","c++","camera","wia"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12542881,"title":"How to capture the capture event of camera and save a image?","body":"<p>I have a camera, which has a button. When I use Windows Image Acquisition (WIA) to connect to it, and press the button on the camera, it will capture an image in WIA. </p>\n\n<p>I want to implement it by myself without WIA; what event should I capture?</p>\n"},{"tags":["c#","asp.net","html","html5","flash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13287316,"title":"Using Dynamic flashVars with HTML5","body":"<p><strong>Hello all, i have a theoretical question.</strong></p>\n\n<p>With flash you can dynamically load flashvars to a video or audio flashobject.\nBut:  I would already have a flash video which loads the flashvars like that. But i want to create html5 code (either audio/video) around it. Can i use the flash vars outside of the element/flash object?</p>\n\n<p>Like loading the flash source (mp3) also to the HTML5 audio element, which surrounds the flash element?</p>\n\n<p><strong>To make it more visual:</strong></p>\n\n<ul>\n<li>HTML(5) Page.</li>\n</ul>\n\n<p>Contains a flash object, nested within a HTML5 audio/video element.</p>\n\n<ul>\n<li>C# page.</li>\n</ul>\n\n<p>Dynamically loads the flashvars &amp; params to the flash object. For example mp3source.</p>\n\n<p><strong>Problem:</strong>\nCan i also load the mp3source flashvar/param to the HTML5 video/audio in some way?</p>\n\n<p>To load the vars i would use htmlgenericcontrols. If someone has an idea about how/if i could create something like this... Please share it! :) </p>\n\n<p><strong>Thanks for the answers!</strong></p>\n\n<p><strong>PS: Some Code</strong> (!Not working, just to give you a clue!)</p>\n\n<p>C# Param</p>\n\n<pre><code>var mp3param = new HtmlGenericControl(\"param\");\nmp3param.Attributes.Add(\"name\", \"thevars\");\nvar thevars= \"mp3=\" + src;\n</code></pre>\n\n<p>HTML Output</p>\n\n<pre><code>&lt;audio id=\"htmlaudio\" controls=\"\"&gt;\n    &lt;source src=\"thisshouldbetheflashmp3source\" type=\"audio/mpeg\"&gt;\n    &lt;object type=\"application/x-shockwave-flash\" data=\"audioplayer.swf\" width=\"xx\" height=\"xx\" id=\"flashaudio\" style=\"visibility: visible;\"&gt;\n    &lt;param name=\"thevars\" value=\"mp3=Theflashmp3sourcethatdoesworkbutshouldalsobeusedinhtmlaudio\"&gt;\n&lt;/object&gt;\n&lt;/audio&gt;\n</code></pre>\n"},{"tags":["c#","winforms","events","mouseevent"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13287144,"title":"C# Click form & drag, class","body":"<p>I know you can use form click and drag with <a href=\"http://stackoverflow.com/questions/4767831/drag-borderless-windows-form-by-mouse\">this</a>\nBut say I wanted it not using that code and using my own, how would I do it?</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    MouseDragFormMove dragForm;\n\n    public Form1()\n    {\n        InitializeComponent();\n\n        dragForm = new MouseDragFormMove(this);\n        dragForm.AllowMouseDownDrag = true;\n    }\n}       \npublic class MouseDragFormMove\n{\n    private bool _status;\n    public bool AllowMouseDownDrag\n    {\n        get { return _status; }\n        set { _status = value; }\n    }\n\n    private Form parent;\n    public MouseDragFormMove(Form self)\n    {\n        _status = false;\n        parent = self;\n        parent.MouseDown +=new MouseEventHandler(parent_MouseDown);\n        parent.MouseUp += new MouseEventHandler(parent_MouseUp);\n        parent.MouseMove +=new MouseEventHandler(parent_MouseMove);            \n    }\n\n    public void showPos()\n    {\n        MessageBox.Show(parent.Location.X + \", \" + parent.Location.Y);\n    }\n\n    private Point CPoint;\n    private Point MPoint;\n    private bool isDragging;\n\n    private void parent_MouseDown(object sender, MouseEventArgs e)\n    {\n        CPoint = parent.Location;\n        MPoint = getMousePoint(e, CPoint);\n        isDragging = true;\n    }\n    private void parent_MouseUp(object sender, MouseEventArgs e)\n    {\n        isDragging = false;\n    }\n    private void parent_MouseMove(object sender, MouseEventArgs e)\n    {\n        CPoint = parent.Location;\n        MPoint = getMousePoint(e, CPoint);\n\n        if (isDragging &amp;&amp; _status)\n        {\n            parent.Location = MPoint;\n        }\n    }\n    private Point getMousePoint(MouseEventArgs e, Point FP)\n    {\n        int x = FP.X + (e.Location.X * 2);\n        int y = FP.Y + (e.Location.Y * 2);\n\n        return new Point(x, y);\n    }\n}\n</code></pre>\n\n<p>What am I doing wrong? I can't get it working. Also, it flickers aswell</p>\n"},{"tags":["c#","ldap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13287830,"title":"Get just the name from ldap in asp.net c#","body":"<p>I want to diaplay all the names that match with the user provided name from a directory server using LDAP and bind it to grid view. Am able to achieve this task bt instead of just a name am getting other properties like LDAP://CN=Neha Shetty,OU=Users,OU=MUM,OU=Mumbai,OU=India,OU=APAC,OU=bunt,DC=xxx,DC=com. But i just want Neha Shetty. Here is my code </p>\n\n<pre><code>DirectoryEntry de = new DirectoryEntry(\"ADConnection\");\n\nDirectorySearcher deSearch = new DirectorySearcher(de);\n\n//set the search filter    \ndeSearch.SearchRoot = de;\nString UserName = txt_To.Text;\n// deSearch.Filter = \"(&amp;(objectCategory=user)(GivenName=*\" + UserName + \"*))\";\ndeSearch = new DirectorySearcher(\"(&amp;(objectCategory=user)(Name=*\" + UserName + \"*))\");\n//deSearch.SearchScope = SearchScope.Subtree;\nstring[] arrPropertiesToLoad = { \"Surname\" };\ndeSearch.PropertiesToLoad.AddRange(arrPropertiesToLoad);\n\n//  SearchResultCollection sResultColl = deSearch.FindAll();\nSearchResultCollection sResultColl;\nsResultColl = deSearch.FindAll();\n\nGridview1.DataSource = sResultColl;\nGridview1.DataBind();\n</code></pre>\n"},{"tags":["c#","ruby","mono","port"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":13246099,"title":"Using C# to reference a port number to service name","body":"<p>On Linux using MONO.</p>\n\n<p>How do I use C# to pair a port number to a service ? </p>\n\n<p>example:</p>\n\n<pre><code>port 80 = http\nport 443 = https\n</code></pre>\n\n<p>and output it to the console, I need this for a simple port scanner I built.</p>\n\n<p>I know this function exists in ruby:</p>\n\n<pre><code>Socket.getservbyport(80, \"tcp\")\n</code></pre>\n"},{"tags":["c#","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":28,"score":1,"question_id":13286274,"title":"Windows 8 store app c# animating margin","body":"<p>i am creating a windows store app and it needs some animation</p>\n\n<p>does anyone have a working example of animating the margin of an usercontrol?</p>\n\n<p>do i need to use reposition? ( doubleanimation doesn't support ucChat.margin or ucChat.margin.top)</p>\n\n<pre><code>DoubleAnimation da = new DoubleAnimation();\n                da.Duration = new Duration(TimeSpan.FromMilliseconds(1500));\n                da.From = 0;\n                da.To = -400;\n\n                Storyboard st = new Storyboard();\n                Storyboard.SetTarget(da, ucChat);\n                Storyboard.SetTargetProperty(da, \"ucChat.Margin.Top\");\n                st.Children.Add(da);\n\n                st.Begin();\n</code></pre>\n\n<p>it seems that in wpf you could use ThicknessAnimation, is there an equivalent in windows store app?</p>\n"},{"tags":["c#","winforms","magento","oauth"],"answer_count":1,"favorite_count":2,"up_vote_count":8,"down_vote_count":2,"view_count":246,"score":6,"question_id":13106146,"title":"step by step oAuth rest C# winform examples","body":"<p>I have been trying for a while now and need to find a step by step from ground up on creating a consumer app for magento.</p>\n\n<p>I have looked at the following:</p>\n\n<ul>\n<li><p><a href=\"http://springframework.net/social-twitter/\" rel=\"nofollow\">Spring.NET Social extension for Twitter</a></p></li>\n<li><p><a href=\"http://code.google.com/p/devdefined-tools/wiki/OAuth\" rel=\"nofollow\">DevDefined OAuth</a></p></li>\n<li><p><a href=\"http://www.codeproject.com/Articles/247336/Twitter-OAuth-authentication-using-Net\" rel=\"nofollow\">Twitter OAuth authentication using .NET</a></p></li>\n</ul>\n\n<p>And many others, but it's not clear what to do really.  What i need to so is make a winform in C# that will need to use the rest api for magento with oAuth.  Really here I'm a little lost.  </p>\n\n<p>Really the info i get to have as a consumer is</p>\n\n<pre><code>String callbackUrl = \"liconnect://success\";\nString temporaryCredentialsRequestUrl = \"http://domain.xxx/oauth/initiate?oauth_callback=\" + HttpUtility.UrlEncode(callbackUrl);\nString adminAuthorizationUrl = \"http://domain.xxx/admin/oauth_authorize\";\nString accessTokenRequestUrl = \"http://domain.xxx/oauth/token\";\nString apiUrl = \"http://domain.xxx/api/rest\";\nString consumerKey = \"KKKKKKKKKKKKKKK\";\nString consumerSecret = \"SSSSSSSSSSSSSSSSSSS\";\n</code></pre>\n\n<p>The \"liconnect://success\"; is to get to some where pass but I haven't gotten that far either lol... </p>\n\n<p>The oauth_token and the oauth_token_secret need to be saved so I don't know if that can be stored from with in? but the deal is that you have to login too if you don't know the magento path .. I tried building a scraper with HtmlAgilityPack and got all the way to the login form but even thou i pass the form with everything that was on the page magento thinks there is an issue.  I would guess do to the headers.. so going that route has not worked.</p>\n\n<p>I also have tried to work to just do a post and use System.Security.Cryptography but that has not worked out as well.</p>\n\n<p>Any mad programmer that would have a line on a solid how to or want to take the challenge to put one here for people?  There are many out there asking the same question here.</p>\n"},{"tags":["c#","analysis"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":17,"score":0,"question_id":13287850,"title":"Ho to create a c# library which can run set of code analysis rules on a given package/DLL?","body":"<p>we are building a library for running some code analysis rules on a given package/dll.\nand planning to use this in our source control(svn) and checked in code is validated with these rules.</p>\n\n<p>so how to develop a c# library for this and plug it to svn...</p>\n\n<p>Thanks a lot</p>\n"},{"tags":["c#",".net","reflection","connection-string"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13286431,"title":"getting current value reflection c#","body":"<p>i have used the following code to change the current value for the current field value as</p>\n\n<pre><code>FieldInfo connectionStringField = GetType().BaseType.GetField(\"_sqlConnectionString\", BindingFlags.Instance | BindingFlags.NonPublic);  \n\nconnectionStringField.SetValue(this, connectionString);  \n</code></pre>\n\n<p>but my query is to get current value of connectionstringfied...</p>\n\n<p>i tried the below code as</p>\n\n<pre><code>getvalue(obj ss);\n</code></pre>\n\n<p>waiting for your valuable esponses</p>\n\n<p>it throws me null values</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13287434,"title":"Alignment of autogenerate mail using c#?","body":"<p>Is there any possible way to align the auto generate mail while upload a file to server. It sends the mail to admin what we upload in server like this</p>\n\n<blockquote>\n  <p>Hi All,<br>\n  We have uploaded the following files onto FTP site. Details\n  are as below:</p>\n  \n  <p>File name                          File size </p>\n  \n  <p>D:\\New folder\\diff2.zip               172</p>\n</blockquote>\n\n<p>I want to align this one in proper manner anyone help to resolve this..</p>\n"},{"tags":["c#","tiff","pcl"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1093,"score":1,"question_id":2337997,"title":"C# PCL rendering into TIFF (or other image format)","body":"<p>I'm looking for the best solution -- and perhaps the cheapest also -- to take PCL5e and PCL6 compliant code and render it into a TIFF image.  Reliably.</p>\n\n<p>Does anyone have any experience with the PCLTool SDK from PageTech (http://www.pagetech.com/pcl.php)?  This looks to be the best I can find, but I'm not sure how flexible it really is.</p>\n\n<p>The other options is trying to write my own interface, which would be a BEAST of a project and not one I really want to try to tackle.</p>\n\n<p>Any open-source solutions out there?  Anyone with a C#/.NET project having success with PCL rendering?  If so, how?</p>\n"},{"tags":["c#","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":52,"score":-6,"question_id":13287603,"title":"Index -1 does not have a value","body":"<p>I am using DataGridView and I don't want the user to be able to edit the DataGridView or click on it. I have explored ReadOnly and the Click events, to know avail.</p>\n\n<p>Still whenever the user clicks on the DataGridView, the program crashes displaying the error message \"Index -1 does not have a value.\" This is the code that is apparently the problem:</p>\n\n<pre><code>[STAThread]\nprivate static void Main()\n{\n  Application.EnableVisualStyles();\n  Application.SetCompatibleTextRenderingDefault(false);\n  Application.Run(new frmLogin());\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":13233022,"title":"asp.net error on remote server only","body":"<p>I get this error on my windows server 2003 server(64 bit).</p>\n\n<p>An unhandled exception occurred and the process was terminated. Event ID:1334</p>\n\n<p>While, application runs smoothly on my development machine(windows XP / Visual Studio 2008).</p>\n\n<p>Can anyone give me idea that can cause issue?</p>\n\n<p>Additional:\nI have used threads like below:</p>\n\n<pre><code> Dim thread1 As New Thread(New ThreadStart(AddressOf myProcess))\n                thread1.IsBackground = True\n                thread1.Start()\n</code></pre>\n\n<p>If I remove threads &amp; just execute </p>\n\n<pre><code>myProcess()\n</code></pre>\n\n<p>then it works fine.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","sql-server","sql-server-2008","ado.net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13287694,"title":"Getting row right after insert returns no result","body":"<p>I am running unit tests and when I try to insert data in the database and getting it right after, I don't get anything (I have tried with <code>DataAdapter</code> and <code>DataReader</code>).</p>\n\n<p>However when I put a 3 seconds sleep (even with 1 second it doesn't work...) between the insert and the select I get the result.</p>\n\n<p>In SQL Server Profiler I can see the execution, the insert is well done and is completed about 10 miliseconds before the select begins.</p>\n\n<p>I can't find out where this comes </p>\n\n<p>The code looks like this :\nInsert method</p>\n\n<pre><code>SqlCommand command = new SqlCommand(sqlTemplate);\ncommand.Parameters.Add(Sql4oConstants.Sql4oIdParameterName, SqlDbType.UniqueIdentifier).Value = id;\ncommand.Parameters.Add(Sql4oConstants.Sql4oTimestampParamterName, SqlDbType.DateTime).Value = DateTime.Now;\n\ncommand.CommandTimeout = dataSourceDescription.CommandTimeout;\nDatabaseManager.ExecuteNonQuery(dataSourceDescription.ConnectionString, command);\n</code></pre>\n\n<p>Get method</p>\n\n<pre><code>public static void Fill(string connectionString, DataTable table, SqlCommand command)\n    {\n        try\n        {\n            LogStorageWriter.WriteLogEntry(log, EStorageLevelLog.Debug, string.Format(\"Execute query: {0}\", command.CommandText));\n\n            using (SqlConnection conn = new SqlConnection(connectionString))\n            {\n                command.Connection = conn;\n                using (SqlDataAdapter adapter = new SqlDataAdapter(command))\n                {\n                    adapter.Fill(table);\n                }\n            }\n        }\n        catch (InvalidOperationException e)\n        {\n            LogStorageWriter.WriteLogEntry(log, EStorageLevelLog.Error, string.Format(\"Exception : {0}\", e.ToString()));\n        }\n    }\n</code></pre>\n"},{"tags":["c#","android","asp.net","vcard"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":258,"score":2,"question_id":11970746,"title":"Generate vCard that can be downloaded on Android using ASP.NET","body":"<p>I have been trying for quite some time now to generate a vCard using ASP.NET (C#) that can be downloaded onto an Android device.</p>\n\n<p>The process of generating the card is quite simple and so I'm not too worried about it.  It's the download itself that I can't get to work.</p>\n\n<p>My code for attaching the vCard to the page response looks like this:</p>\n\n<pre><code>public void downloadCard()\n{\n    //generate the vCard text\n    string vCard = generateCard();\n\n    //create the filename the user will download the file as\n    string filename = HttpUtility.UrlEncode(username + \".vcf\", System.Text.Encoding.UTF8);\n\n    //get a reference to the response\n    HttpResponse response = HttpContext.Current.Response;\n\n    //clear the response and write our own one.\n    response.Clear();\n    response.ContentType = \"text/x-vcard\";\n    response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + filename + \";\");\n    response.Write(vCard);\n    response.End();\n}\n</code></pre>\n\n<p>I won't bother showing the generation process as it's not really important though the only parameter the page takes is for a username which is received through a RESFUL URL thanks to some URL rewriting in the web.config file.  So the URL example.com/vcard/apbarratt produces the vCard for the user, apbarratt.</p>\n\n<p>The response that a GET request produces for this code looks like this:</p>\n\n<pre><code>200 OK\nDate: Wed, 15 Aug 2012 13:49:56 GMT\nX-AspNet-Version: 4.0.30319\nX-Powered-By: ASP.NET\nContent-Disposition: attachment; filename=apbarratt.vcf;\nContent-Length: 199\nServer: Microsoft-IIS/7.5\nContent-Type: text/x-vcard; charset=utf-8\nCache-Control: private\nBEGIN:VCARD\nVERSION:2.1\nN;LANGUAGE=en-us:Andy Barratt\nFN:Andy Barratt\nTEL;CELL;VOICE:07000000000\nURL;WORK:http://example.com\nEMAIL;INTERNET:apbarratt@example.com\nEND:VCARD\n</code></pre>\n\n<p>This works perfectly in every single browser that I have tested it in (not iOS, that's another issue that has been solved in another way), except for Android stock browsers.  In these browsers, the download fails, either with the filename \"unknown\" and the term \"failed\" or on other devices with the username \"apbarratt.vcf\" and the term \"In progress\" which doesn't ever seem to change.</p>\n\n<p>The issue is not a problem in other browsers such as opera mobile/mini.</p>\n\n<p>I've tried every possible thing I can think of, reading so many blogs on similar issues that I'm having dreams about the whole thing... they're really dull...</p>\n\n<p>Anyway, hopefully some fresh eyes will be able to help me.  Perhaps someone has done this before and could share some code, looking forward to some help.</p>\n\n<p>Andy</p>\n"},{"tags":["c#","visual-studio","remote-debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13287617,"title":"Remote debugging with informations?","body":"<p>I'm using the Visual Studio 2012 Remote debugguer and it works fine.\nBut I'm not getting a lot of informations.</p>\n\n<p>I agree with the fact that I can't have the source code when an unhandled exception is throw but I'm surprised that the remote debugguer don't send me the line or the function or simply the stacktrace.</p>\n\n<p>All I got is, for example :</p>\n\n<p>Unhandled ArgumentNullException in System.core.dll</p>\n\n<p>Is there a way to compile a program (with VS 2012) that can send more information in remote debugging?</p>\n"},{"tags":["c#","windows-phone-7.1","fft"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13242896,"title":"Can I use 3rd party libraries in Windows Phone 7.1?","body":"<p>I am going to do some sound frequency measurement. I have found the 3rd party library which enables performing Fast Fourier transform(FFT). <strong>Can I use them in Windows Phone 7.5(7.1SDK) application</strong> so it will not be rejected by Microsoft in the apphub?(the bold part of the question is more important)</p>\n\n<p>Found libraries:</p>\n\n<p><a href=\"http://code.google.com/p/aforge/\" rel=\"nofollow\">http://code.google.com/p/aforge/</a></p>\n\n<p><a href=\"http://www.exocortex.org/dsp/\" rel=\"nofollow\">http://www.exocortex.org/dsp/</a></p>\n\n<p><a href=\"http://www.mathdotnet.com/\" rel=\"nofollow\">http://www.mathdotnet.com/</a></p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13286643,"title":"Code of .Where() and .All()","body":"<p>I'm searching for the code of .Where(), .All or at least one of the other \"special\" methods in some object. I'd like to learn how to write such, because I find them useful.</p>\n\n<p>Also 1 question - Why some objects contain those methods and others do not, how do I inherit them in a class of mine for example?</p>\n"},{"tags":["c#","jquery","asp.net","jquery-mobile"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":2067,"score":8,"question_id":6864162,"title":"ASP.NET Response.Redirect with jQuery Mobile - Url hashing","body":"<p>I have a standard forms auth ASP.NET application.  My Registration and Login page are in the same .aspx file with 2 jQuery Mobile pages.  If I postback my ASP.NET page, such as the user fails to login correctly...etc  The Url hash starts appending to itself over and over.  </p>\n\n<p>Example Url:<br>\n<strong>http://localhost:56644/Register.aspx?ReturnUrl=%2fDefault.aspx%3fbla%3dtest&amp;bla=test#Register.aspx?ReturnUrl=%2fDefault.aspx%3fbla%3dtest&amp;bla=test</strong></p>\n\n<p>Once my user is authenticated I want to Redirect to the ReturnUrl without all the hash information or find a way for the url to remain during postbacks?</p>\n\n<p><strong>Markup:</strong></p>\n\n<pre><code>&lt;div data-role=\"page\" id=\"register\"&gt;\n    &lt;div data-role=\"content\" data-scroll=\"true\" data-theme=\"b\" class=\"Content\"&gt;\n        ......  \n        &lt;a href='#login'&gt;Login&lt;/a               \n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div data-role=\"page\" id=\"login\"&gt;\n    &lt;div data-role=\"content\" data-scroll=\"true\" data-theme=\"b\" class=\"Content\"&gt;\n        .....                             \n        &lt;a href='#register' &gt;Registered Yet?&lt;/a&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>Code-behind on Register.aspx:</strong></p>\n\n<pre><code>protected void btnLogin_Click(object sender, EventArgs e)\n{        \n    if (LoggedIn)\n    {\n        FormsAuthentication.SetAuthCookie(\"blabla\", true); \n        //Note: Request.QueryString[\"ReturnUrl\"] = \"/Default.aspx?bla=test\";\n        Response.Redirect(Request.QueryString[\"ReturnUrl\"]);\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13278201,"title":"Linq Query to group Parent and respective child rentities","body":"<p>Here are my classes:</p>\n\n<pre><code>class Country\n{\n    public Country()\n    {\n        States = new List&lt;State&gt;();\n    }\n\n    public int Id { get; set; }\n    public int Name { get; set; }\n\n    public virtual ICollection&lt;State&gt; States  { get; set; }\n}\n\nclass State\n{\n    public State()\n    {\n        Counties = new List&lt;County&gt;();\n    }\n\n    public int Id { get; set; }\n    public int Name { get; set; }\n    public int CountryID { get; set; }\n\n    [ForeignKey(\"CountryID\")]\n    public virtual Country Country { get; set; }\n\n    public virtual ICollection&lt;County&gt; Counties { get; set; }\n}\n\nclass County\n{\n    public County()\n    {\n        Cities = new List&lt;City&gt;();\n    }\n\n    public int Id { get; set; }\n    public int Name { get; set; }\n    public int StateID { get; set; }\n\n    [ForeignKey(\"StateID\")]\n    public virtual State State { get; set; }\n\n    public virtual ICollection&lt;City&gt; Cities { get; set; }\n}\n\nclass City\n{\n    public int Id { get; set; }\n    public int Name { get; set; }\n    public int CountyID { get; set; }\n\n    [ForeignKey(\"CountyID\")]\n    public virtual County County { get; set; }\n}\n</code></pre>\n\n<p>I am having difficulty in creating the query that will give me all the records for each entities above grouped by Country, then State, then County, then City</p>\n\n<p>I am ultimately trying to put this into a backbone.js treeview.</p>\n\n<p><strong>What would be the correct Linq query for collecting the records in their respective groups</strong></p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13285598,"title":"how can i make a string variable's font colour red in a messagebox from c# code?","body":"<p>i have this code</p>\n\n<pre><code>public static bool Delete(int ID, string ProductName)\n    {\n        if (MessageBox.Show(productName + \" will be deleted Permanently \", \"Confirm Delete Option\", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.No)\n            {\n                return false;\n            }\n        {\n            return true;\n        } \n    }\n</code></pre>\n\n<p>what i need to is make <strong>productName</strong> in messagebox below red in colour</p>\n\n<pre><code>if (MessageBox.Show(productName + \" will be deleted Permanently \"\n</code></pre>\n"},{"tags":["c#",".net","image","upload","type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13287508,"title":".NET MVC3 Image Upload related error: conversion from type 'System.Web.HttpPostedFileWrapper' to type 'Project.Domain.Entities.Image'","body":"<p>I will try to explain it simple:</p>\n\n<p>I have an entity - Image - wich looks like this:</p>\n\n<pre><code>public class Image : IEntity\n    {\n        public int ID\n        {\n            get;\n            set;\n        }\n        public string name\n        {\n            get;\n            set;\n        }\n        public virtual ICollection&lt;Restaurant&gt; Restaurant\n        {\n            get;\n            set;\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the relevant properties in the Restaurant entity class:</p>\n\n<pre><code>[HiddenInput(DisplayValue = false)]\npublic Guid ImageID { get; set; }\npublic string ImageName { get; set; }\npublic virtual Image Image\n        {\n            get;\n            set;\n        }\n\n        public byte[] ImageData \n        { \n            get; set; \n        }\n        [HiddenInput(DisplayValue = false)]\n        public string ImageMimeType \n        { \n            get; set; \n        }\n</code></pre>\n\n<p>And in my View, where the user takes an image and uploads it to save it for their user, I have a simple , with an enctype = \"multipart/form-data\". The user in this case is an entity - Restaurant.</p>\n\n<pre><code>@using (Html.BeginForm(\"Edit\", \"Admin\", FormMethod.Post, new { enctype = \"multipart/form-data\" }))\n\n[...]\n\n&lt;input type=\"file\" name=\"image\" /&gt;\n\n[...]\n</code></pre>\n\n<p>Here is the ActionResult in AdminController, wich should take care of the posted image (and other data from the html from). </p>\n\n<pre><code>[HttpPost]\n        public ActionResult Edit(Restaurant rest, Address address, HttpPostedFileWrapper image)\n        {\n            if (ModelState.IsValid)\n            {\n                if (image != null &amp;&amp; image.ContentLength &gt; 0)\n                {\n                    var filename = Path.GetFileName(image.FileName);\n                    Guid imageID = Guid.NewGuid();\n                    var relativePath = @\"~/Content/Images/Logotypes/\" + imageID.ToString();\n                    image.SaveAs(Server.MapPath(relativePath));\n\n                    rest.ImageMimeType = image.ContentType;\n                    rest.ImageName = filename;\n                    rest.ImageID = imageID;\n\n                    repo.Save(rest);\n                }\n                return View(rest);\n            }\n            else\n            {\n                var errors = ModelState\n                .Where(x =&gt; x.Value.Errors.Count &gt; 0)\n                .Select(x =&gt; new { x.Key, x.Value.Errors })\n                .ToArray();\n\n                return View(rest);\n            }\n        }\n</code></pre>\n\n<p>When it runs the code, ModelState.IsValid() returns false, and the ModelState-error is as follows:</p>\n\n<p>{System.InvalidOperationException: The parameter conversion from type 'System.Web.HttpPostedFileWrapper' to type 'Projct.Domain.Entities.Image' failed because no type converter can convert between these types.</p>\n\n<p>Any Ideas?</p>\n"},{"tags":["c#","text","fonts","gdi+"],"answer_count":3,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":4492,"score":11,"question_id":1003370,"title":"Measure a String without using a Graphics object?","body":"<p>I am using pixels as the unit for my font. In one place, I am performing a hit test to check if the user has clicked within the bounding rectangle of some text on screen. I need to use something like <code>MeasureString</code> for this. Unfortunately, the code doing the hit test is deep within a library which does not have access to a <code>Graphics</code> object or even a <code>Control</code>.</p>\n\n<p>How do I get the bounding box of a string given the font without using the <code>Graphics</code> class? Why do I even need a <code>Graphics</code> object when my font is in pixels?</p>\n"},{"tags":["c#",".net","visual-studio-2010","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13283589,"title":"Query is related to Windows Phone 7 coding","body":"<p>I have downloaded the GPS code from Codeproject.com.\nI want to track my current location.\nIn the codeproject code, it is able to find the location,but i have to enter the latitude and longitude in my code,which is hard coded.</p>\n\n<p>I want that to dynamically happen in code.</p>\n\n<p>For example:- if i enter in code latitude = 19.1767; longitude = 73.0222; then this will take me to Mumbai.\nBut to track his current location,user wont go in code and enter the latitude and longitude.\nHow can it happen dynamically??\nPlease help..</p>\n\n<p>Thanks &amp; Regards\nHasib Shaikh</p>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13286714,"title":"Check SQL reference constraint on INSERT but not on DELETE","body":"<p>I have a Logs table in my database where I'm storing records of user actions. There's a column for UserID, which is foreign-keyed to the Users table to check that the UserID exists when a log is added. However, attempting to delete a user causes a constraint failure because it leaves a UserID in the Logs table that no longer exists in the Users table. Deleting the offending rows from Logs isn't an option, because the whole point is to have persistent records (so that we can find out who broke what, basically) so deleting all actions by that user rather defeats the purpose.</p>\n\n<p>Is there a simple way to have it check the constraint when inserting new logs (to make sure the user exists at the time) but not when deleting a user? I'm accessing the DB via LINQ, so my queries are in C#, not SQL, so anything that requires that is out, but I have access to the database through MS SQL Server Management Studio, so I can do what I like with it.</p>\n\n<p>EDIT for slight clarification: the value of knowing who made an action is not just in accountability; it's useful in determining if an issue is user-specific, organisation-specific, or system-wide, which can greatly narrow down the list of possible causes. Once a user is deleted, it's still worth keeping their actions, and it's still useful to know which actions were by that user, for various reasons - for example, when tracking down an issue caused by one user doing a certain combination of things (eg. two actions that are fine separately but cause errors when one immediately follows another).</p>\n"},{"tags":["c#",".net","winforms","validation","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13262097,"title":"Validate cell's value on a custom datagridviewCell","body":"<p>I have a <code>DataGridView</code> with a custom <code>DataGridViewColumn</code>. The column is hosting a third-party component. I enter edit mode in the cell and modify its value and then I press enter key to validate the value. The problem is that I have to press enter key twice to validate the value. It seems like first enter key is to validate the value in the third-party's editor hosted in the cell, and second one to validate the <code>DataGridView</code>'s cell... So how to validate cell's value with only pressing enter key one time? </p>\n\n<p>Also I have seen strange behaviour, for example, the last <code>DataGridView</code>'s row does not behaves as the rest of the <code>DataGridView</code>'s cells. For last row, if I edit the value of a cell and then press enter key to validate, after validating value, it always remains in the same cell and in edit mode and cell's value gets selected so user can think that cell value is invalid when in fact it isn't. This does not happen with the rest of the rows. They need to press enter key twice to validate and cells do not remain in edit mode after validating.</p>\n\n<p><strong>EDIT</strong>:\nRegarding to the need to press enter key twice:\nIn the custom cell, when enter key is pressed for first time, it raises the event that says value for the cell has changed, it is in this case, OnSourceValueChanged (this is the event raised for the third-party when value has changed) so into it I do:</p>\n\n<pre><code>        this.valueChanged = true;\n        this.EditingControlDataGridView.NotifyCurrentCellDirty(true);\n        base.OnSourceValueChanged(e);\n</code></pre>\n\n<p>when executed NotifyCurrentCellDirty it raises CurrentCellDirtyStateChanged on datagridview which code is:</p>\n\n<pre><code>            if (this.gridView.IsCurrentCellDirty)\n        {\n            this.gridView.CurrentCell.DataGridView.EndEdit(DataGridViewDataErrorContexts.Commit);\n            this.gridView.EndEdit(DataGridViewDataErrorContexts.Commit);\n        }\n</code></pre>\n\n<p>After it, DataError event is raised for the datagridview but cell continues in edit mode so I would like to commit the value and exit edit mode. How to do this? Also I have tried:</p>\n\n<pre><code>this.dataGridView.CurrentCell.DataGridView.EndEdit(DataGridViewDataErrorContexts.Commit);\n</code></pre>\n\n<p>this.dataGridView.EndEdit(DataGridViewDataErrorContexts.Commit);</p>\n\n<p>in DataError handler but it does not work.</p>\n\n<p>Finally, cellvaluechanged is not raised maybe as it is a hosted control in the cell...I don't understand why I have to press enter key twice to commit and validate changes on the cell and exit edit mode for the cell. I want only to press enter key press once.</p>\n"},{"tags":["c#","regex","string","delete"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13287314,"title":"find String in Text, remove the first and last char","body":"<p>I search in a text for some strings and want to remove the first and last char in those strings.</p>\n\n<p>Example : </p>\n\n<pre><code>...\n...\nOK 125 ab_D9 \"can be \"this\" or; can not be \"this\" \";\n...\nOK 673 e_IO1_ \"hello; is strong\nor maybe not strong\";\n...\n</code></pre>\n\n<p>So i use the code to find all strings begin with OK and remove from the 4 groups \"...\":</p>\n\n<pre><code>tmp = fin.ReadToEnd();\nvar matches = Regex.Matches(tmp, \"(OK) ([0-9]+) ([A-Za-z_0-9]+) (\\\"(?:(?!\\\";).)*\\\");\", RegexOptions.Singleline);\nfor (int i = 0; i &lt; matches.Count; i++)\n    {\n         matches[i].Groups[4].Value.Remove(0);\n\n         matches[i].Groups[4].Value.Remove(matches[i].Groups[4].Value.ToString().Length - 1);\n         Console.WriteLine(matches[i].Groups[1].Value + \"\\r\\n\" + \"\\r\\n\" + \"\\r\\n\" + matches[i].Groups[2].Value + \"\\r\\n\" + \"\\r\\n\" + matches[i].Groups[3].Value + \"\\r\\n\" + \"\\r\\n\" + \"\\r\\n\" + matches[i].Groups[4].Value);\n         Console.WriteLine(\"           \");\n    }\n</code></pre>\n\n<p>But it doesn't remove first and last char from Group 4.what did i do wrong?  </p>\n\n<p>My Result should be:</p>\n\n<pre><code> OK\n\n 125\n\n ab_D9\n\n\n can be \"this\" or; can not be \"this\" \n\n\n OK\n\n 673\n\n e_IO1\n\n hello; is strong\n or maybe not strong\n</code></pre>\n"},{"tags":["c#","wpf","silverlight","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":411,"score":0,"question_id":10181245,"title":"How can I animate the Margin of a Stackpanel with a storyboard?","body":"<p>I would like to use it, but it doesnt't work, I wanna create a tile animation, in code behind, or if you know a project for this gol, pls write me    </p>\n\n<pre><code> Deployment.Current.Dispatcher.BeginInvoke(() =&gt;\n                    {\n                        while(true){\n                        Duration duration = new Duration(TimeSpan.FromSeconds(0.15));\n\n                        // Create two DoubleAnimations and set their properties.\n                        DoubleAnimation myDoubleAnimation1 = new DoubleAnimation();\n\n                        myDoubleAnimation1.Duration = duration;\n                        myDoubleAnimation1.From = -173\n                        myDoubleAnimation1.To = 173;\n                        Storyboard sb = new Storyboard();\n                        sb.Duration = duration;\n\n                        sb.Children.Add(myDoubleAnimation1);\n\n                        Storyboard.SetTarget(myDoubleAnimation1, image);\n\n                        // Set the attached properties of Canvas.Left and Canvas.Top\n                        // to be the target properties of the two respective DoubleAnimations.\n                        Storyboard.SetTargetProperty(myDoubleAnimation1, new PropertyPath(StackPanel.MarginProperty));\n\n                        // Begin the animation.\n                        sb.Begin();}\n                    });\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13286832,"title":"How to create chart for building Stacked plan in MVC3","body":"<p>I want to create chart for \"building stacked plan\" in mvc3\nfor example given image.\n <img src=\"http://i.stack.imgur.com/MZlyy.jpg\" alt=\"enter image description here\"></p>\n\n<p>if i want to create below type of chart by using \"Stackedbar\" chart of asp.net\nbut i am confused for how will be the series define in the chart \nbecause here in this scenario one row may have only single color or more than one color</p>\n\n<p>ie: if i have two rows in which first row have 5 column (colors) and second row have only 2 column (colors) </p>\n\n<p>Chart chart12 = new Chart(1000, 600, theme: ChartTheme.Vanilla3D).AddTitle(\"StackedBar\").AddLegend(\"Religious Population\");</p>\n\n<p>the below give code show wrong result as per requirement.</p>\n\n<pre><code> chart12.AddSeries(\"2002\", \"StackedBar\", xValue: new[] { \"Tentants3\", \"Tentants4\", \"Tentants5\" }, yValues: new[] { 20, 35, 45 });\n\nchart12.AddSeries(\"2001\", \"StackedBar\", xValue: new[] { \"Tentants1\", \"Tentants2\" }, yValues: new[] {70, 30 }); \n\n return File(chart12.GetBytes(\"png\"), \"image/bytes\");\n</code></pre>\n\n<p>Please suggest me...</p>\n\n<p><img src=\"http://i.stack.imgur.com/ODW5H.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","asp.net-mvc","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13281781,"title":"How to access a thread started initially when page is loaded, later in an ajax method call in c# mvc ?","body":"<p>I am using C# 5.0, VS 2012, MVC4. I have a scenario where I need to cache employees data and query the cache when performing a search on employees info.</p>\n\n<p>I am not displaying all employees initially but wanted to initiate a thread to cache all employees. So in index method when view is displayed, I am doing this</p>\n\n<pre><code>       //Starting a thread to load the cache if its null\n        if (HttpRuntime.Cache[\"AllEmployees\"] == null)\n        {\n            thCacheAllEmployees = new Thread(new ThreadStart(CacheAllEmployees));\n            thCacheAllEmployees.Name = \"CacheAllEmployees\";\n            thCacheAllEmployees.Start();\n        }\n</code></pre>\n\n<p>CacheAllEmployees is a separate method which will query LDAP and stores all employees in Cache. It will take about 15 secs for LDAP query. But within these first 15 secs after view is loaded and cache is not yet loaded, then when user starts typing in search box, I am making a ajax method call to GetFilteredEmployees action method. I want to access previously started thread, check if its alive, then to wait for that thread to complete so that I don't need to do a fresh LDAP query again.</p>\n\n<pre><code>      if (thCacheAllEmployees.IsAlive)\n        {\n            thCacheAllEmployees.Join();\n\n            if (HttpRuntime.Cache[\"AllEmployees\"] != null)\n                return (List&lt;CMSUser&gt;)HttpRuntime.Cache[\"AllEmployees\"];\n        }\n</code></pre>\n\n<p>But the problem is, when its ajax call seems like it will be a new Main Thread and doesn't know about thCacheAllEmployees. So thCacheAllEmployees will be null object. So I need to get the instance of this thread from currently all active threads in application.</p>\n\n<p>I can store thread id of thCacheAllEmployees when view is loaded first time in a session variable, but how can I access that thread from pool of threads when making ajax method call ?</p>\n\n<p>Is there any better way of doing this ? please give ur suggestions.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","razor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13284768,"title":"How I can use the Intranetwebapplication in mvc3","body":"<p>I want use asp.net mvc 3 and use intranet application but I don't have this option :( How I get the intranet application</p>\n\n<p><img src=\"http://i.stack.imgur.com/rMQBy.jpg\" alt=\"enter image description here\"></p>\n\n<p>and how I get mvc4 or it don't work on vs2010? </p>\n"},{"tags":["c#","solr","solrnet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13282102,"title":"Solr 4.0 and SolrNet to get groups ordered by document count","body":"<p>I’m using Solr 4.0, SolrNet and C#.</p>\n\n<p>I'm trying to get top 10 or 5 highest ranked ( i.e product groups ordered by number of products in a group) product groups as search result out of many products in solr. Fetching all product groups according to search criteria and applying LINQ on those groups to sort on basis of document counts and then getting top 10 groups as result would be an option but first it would fetch all groups matching the search criteria into application to apply LINQ makes the use of solr meaning less.</p>\n\n<p>Is it possible to get search result directly from Solr sorted by product groups having more number of products on top using SolrNet 4.0 ? </p>\n\n<p>Thanks</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4401,"score":2,"question_id":5590180,"title":"How to convert a Datetime string to a current culture datetime string","body":"<p>I have string say \"12/1/2011\" in English US culture my current machine culture is English Uk which is \"dd/mm/yyyy\" format. How to convert the 12/1/2011 to 1/12/2011. I have tried the below format.</p>\n\n<pre><code>System.DateTime.Parse(result,System.Threading.Thread.CurrentThread.CurrentCulture)\n              .ToString(System.Threading.Thread.CurrentThread.CurrentCulture.DateTimeFormat.ShortDatePattern)\n</code></pre>\n\n<p>but i could not able to see any output.</p>\n\n<p>-Lokesh.</p>\n"},{"tags":["c#","asp.net","visual-studio-2010","web-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13287133,"title":"Trying to invoke a webservice(wsdl) using c# in Visual Studio 2010","body":"<p>I am not a .Net Programmer and I am pretty new to it,I have created an Webservice using Java(Apache CXF Framework) and trying to invoke the same using a .Net client,for that I am using the below c# code,And I have added the webrefrence and trying to import the reference,I am getting an error like,</p>\n\n<blockquote>\n  <p>the type or namespace cannot be found are you missing a using\n  directive or an assembly reference</p>\n</blockquote>\n\n<p>I have seen in stack overflow that to change the build properties Target Framework to .Net Framework 4 from 4.5 client profile,and changed so,but still I am getting the same error.I am using HTTPS connection.I have given below the code,I am beginner in C#.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Net;\n\nnamespace CCSampleAccountClient\n{\n    class Program\n    {\n\n            static void Main(string[] args)\n        {\n            try\n            {\n\n                ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\n                WebServiceInfo service = new WebServiceInfo();\n                service.client = \"CC_XX\";\n                service.country = \"XX\";\n                service.language = \"XX\";\n                service.service = \"CCInvestmentAccountInquiry\";\n                service.version = \"1\";\n                service.sessionId = \"427a8bff9d084752bb49ad5bd5c65337\";\n                InvestmentAccount investment = new InvestmentAccount();\n                investment.webServiceInfo = service;\n                investment.depotNo = \"123456\";\n                investment.showProfitLoss = SHOW_PROFIT_LOSS.TRUE;\n\n                //CCInvestmentAccountInquiryPortTypeClient client = new CCInvestmentAccountInquiryPortTypeClient();\n                CCInvestmentAccountInquiryPortTypeClient client = new CCInvestmentAccountInquiryPortTypeClient(\"CCInvestmentAccountInquiryHttpPort\", \"**https**://xxx-xx-xx-obf.xxxx.XX/WebServicesxx/services/xxxxxx\");\n\n                SampleAccountInquiryPortType portType = (CCSampleAccountInquiryPortType)client.InnerChannel;\n                // client.ClientCredentials.ClientCertificate. \n                // SampleAccountDetail invesDetail = client.getInvestmentAccount(investment);\n                InvestmentAccountDetail invesDetail = portType.getInvestmentAccount(investment);\n                Console.WriteLine(\"\" + invesDetail.webServiceInfo.client);\n                Console.ReadLine();\n            }\n            catch (SystemException serviceFaultException)\n            {\n\n                Console.WriteLine(serviceFaultException.Message);\n                Console.ReadLine();\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>And my app/config file looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;sectionGroup name=\"applicationSettings\" type=\"System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"&gt;\n            &lt;section name=\"CCInvestementAccountClient.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\"/&gt;\n        &lt;/sectionGroup&gt;\n    &lt;/configSections&gt;\n    &lt;system.serviceModel&gt;\n        &lt;bindings/&gt;\n        &lt;client/&gt;\n    &lt;/system.serviceModel&gt;\n    &lt;applicationSettings&gt;\n        &lt;CCInvestementAccountClient.Properties.Settings&gt;\n            &lt;setting name=\"CCInvestementAccountClient_Ref_SampleInquiry\" serializeAs=\"String\"&gt;\n                &lt;value&gt;https://xxx-xx-xxx-xxx.xxx.xxx/xxx/services/SampleAccountInquiry&lt;/value&gt;\n            &lt;/setting&gt;\n        &lt;/SampleAccountClient.Properties.Settings&gt;\n    &lt;/applicationSettings&gt;\n&lt;startup&gt;&lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;&lt;/startup&gt;&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","hardware","udp","endianness"],"answer_count":5,"favorite_count":11,"up_vote_count":15,"down_vote_count":0,"view_count":28065,"score":15,"question_id":217980,"title":"C# little endian or big endian?","body":"<p>In the documentation of hardware that allows us to control it via UDP/IP,\nI found the following fragment:</p>\n\n<blockquote>\n  <p>In this communication protocol, DWORD is a 4 bytes data, WORD is a 2 bytes data,\n  BYTE is a single byte data. The storage format is little endian, namely 4 bytes (32bits) data is stored as: d7-d0, d15-d8, d23-d16, d31-d24; double bytes (16bits) data is stored as: d7-d0 , d15-d8.</p>\n</blockquote>\n\n<p>I am wondering how this translates to C#?\nDo I have to convert stuff before sending it over?\nFor example, if I want to send over a 32 bit integer, or a 4 character string?</p>\n"},{"tags":["c#","data","wsdl","hierarchical"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13285968,"title":"Data structure for hierarchical members in c#","body":"<p>I'm trying to read data from WSDL file and get stucked, because there could be a big hierarchical tree and i don't know what kind data structure use to get inputs and outputs, because they can have input as a object and object can point to couple simple inputs and second object... this could go on and on. So i don't know what to use. Maybe tree, maybe indexes. What is the best practise and can you give small example how data could be controlled?</p>\n\n<p>P.S. i'm developing automated tests generation tool, whose will use WSDL files for generation.</p>\n"},{"tags":["c#","override","hashcode"],"answer_count":8,"favorite_count":116,"up_vote_count":226,"down_vote_count":0,"view_count":50429,"score":226,"question_id":371328,"title":"Why is it important to override GetHashCode when Equals method is overridden?","body":"<p>Given the following class</p>\n\n<pre><code>public class Foo\n{\n    public int FooId { get; set; }\n    public string FooName { get; set; }\n\n    public override bool Equals(object obj)\n    {\n        Foo fooItem = obj as Foo;\n\n        return fooItem.FooId == this.FooId;\n    }\n\n    public override int GetHashCode()\n    {\n        // Which is preferred?\n\n        return base.GetHashCode();\n\n        //return this.FooId.GetHashCode();\n    }\n}\n</code></pre>\n\n<p>I have overridden the Equals method because Foo represent a row for the Foos table.  Which is the preferred method for overriding the GetHashCode?</p>\n\n<p>Why is it important to override GetHashCode?</p>\n"},{"tags":["c#","asp.net","caching","thread-safety","locking"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":13287053,"title":"C#: Are callback functions inside lock statement also locked?","body":"<p>I have a function which deserialize an Xml document and create objects from it.</p>\n\n<p>I want the objects to be stored into cache so i don't have to deserialize the xml every time i need to get data from it.</p>\n\n<pre><code>public class XMLDeserializer\n{\n    public event OnElementDeserialized OnElementDeserializedCallback;\n\n    public void DeserializeXml(string xmlPath)\n    {\n        // implementation\n    }\n}\n\npublic class XMLDeserializerFacade\n{\n    private static object _lockObject = new object();\n\n    private XMLDeserializer xmlDeserializer;\n    private ICacheProvider cacheProvider;\n    public XMLDeserializerFacade(XMLDeserializer xmlDeserializer, ICacheProvider cacheProvider)\n    {\n        this.xmlDeserializer = xmlDeserializer;\n        this.cacheProvider = cacheProvider;\n\n        xmlDeserializer.OnElementDeserializedCallback += delegate(object element)\n        {\n            cacheProvider.Add(\"uniqueKey\", element);\n            // is here in lock as well or i have to lock it again?\n        };\n    }\n\n    public void DeserializeXml(string xmlPath)\n    {\n        lock(_lockObject)\n        {\n            xmlDeserializer.DeserializeXml(xmlPath);\n\n            // From here it will go to\n            // cacheProvider.Add(\"uniqueKey\", element);  callback\n        }\n    }\n}\n</code></pre>\n\n<p>When i want to deserialize the xml, i call </p>\n\n<pre><code>XMLDeserializerFacade.DeserializeXml(\"file.xml\")\n</code></pre>\n\n<p>My question is that i should use <code>lock</code> also inside the <code>OnElementDeserializedCallback</code> callback as well?</p>\n\n<p>Thank you</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13286143,"title":"Generic order method by specific property","body":"<p>I am quite new in generic programming and have a question:</p>\n\n<p>I am trying to order a list by specific properties which should be defined as parameter.\nPlease look at the code for better understanding what I want:</p>\n\n<pre><code>public static IEnumerable&lt;T&gt; SortEmployeesFor&lt;T&gt;(\n    IEnumerable&lt;T&gt; list,\n    property1,\n    property2, \n    OrderOptions options)\n{\n    switch (options)\n    {\n        case OrderOptions.1:\n            return list.OrderBy(x =&gt; property1).ThenBy(x =&gt; property2);\n\n        case OrderOptions.2:\n            return list.OrderBy(x =&gt; property2).ThenBy(x =&gt; x.property1);\n\n        ...\n    }\n\n    return list;\n}\n</code></pre>\n\n<p>Is there any option to perform this?</p>\n\n<hr>\n\n<p>P.S. It's my first post, if I did something wrong, please understand and let me know.</p>\n"},{"tags":["c#","if-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":53,"score":-2,"question_id":13287263,"title":"Speed up if Statement c#","body":"<p>I have the following statement in C# is there any way i improve the performance of it </p>\n\n<pre><code>   string colTextValue = e.Row.Cells[i].Text.ToLower();\n\n   if (\n         colTextValue.Contains(\"id\") ||\n         colTextValue.Contains(\"unsubscribed\") ||\n         colTextValue.Contains(\"istelephoned\") ||\n         colTextValue.Contains(\"sentletter\") ||\n         colTextValue.Contains(\"ratingid\") ||\n         colTextValue.Contains(\"web\") ||\n         colTextValue.Contains(\"beds\") ||\n         colTextValue.Contains(\"date\") ||\n         colTextValue.Contains(\"perm\") ||\n         colTextValue.Contains(\"planning\") ||\n         colTextValue.Contains(\"emailed\") ||\n         colTextValue.Contains(\"arc\") ||\n         colTextValue.Contains(\"tel\") ||\n         colTextValue.Contains(\"fax\") ||\n         colTextValue.Contains(\"site\") ||\n         colTextValue.Contains(\"notes\") ||\n         colTextValue.Contains(\"cty\"))\n    {\n          //dostuff\n    }\n</code></pre>\n"},{"tags":["c#","rest","asp.net-mvc-4","asp.net-web-api"],"answer_count":2,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":246,"score":3,"question_id":12373738,"title":"How do I set a cookie on HttpClient's HttpRequestMessage","body":"<p>I am trying to use the web api's <code>HttpClient</code> to do a post to an endpoint that requires login in the form of an HTTP cookie that identifies an account (this is only something that is <code>#ifdef</code>'ed out of the release version). </p>\n\n<p>How do I add a cookie to the <code>HttpRequestMessage</code>?</p>\n"},{"tags":["c#","android","monodroid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13287222,"title":"Button click binds to multiple views in custom list view","body":"<p>I'm using a custom list adapter for a list view. I have defined a button in the list view and the click event works, but the problem is that once the list is scrolled, it binds multiple views with the same button. So on the click of the button, the event associated with each of the associated views is fired. </p>\n\n<p>How do I deal with this?</p>\n"},{"tags":["c#","asp.net","web-config","debug-mode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13287218,"title":"asp.net webconfig Debug=true and Solution Configuration as Debug","body":"<p>In an ASP.net web application, you have two 'debug' settings.  One is in the webconfig itself, and the other is when actually compiling the solution in Visual Studio.  First of all, are these related?</p>\n\n<p>An issue we have normally when compiling in Visual Studio as 'Release' is that when trying to diagnose an error via a stack trace / log files:</p>\n\n<ol>\n<li>Line numbers do not match</li>\n<li>Sometimes, line numbers are not even shown</li>\n</ol>\n\n<p>This is very problematic for troubleshooting applications on live environments, and is almost a deal-breaker for me.  </p>\n\n<p>What is the difference between setting debug=true in webconfig, and compiling in Debug mode, and can you set debug=false in web.config, while compiling in Debug mode?</p>\n"},{"tags":["c#",".net","regex","string"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13282833,"title":"Does regex + symbol apply to previous element only?","body":"<p>In order to match all strings beginning with <code>04</code> and only containing digits, will the following work?</p>\n\n<pre><code>Regex.IsMatch(str, \"^04[0-9]+$\")\n</code></pre>\n\n<p>Or is another set of brackets necessary?</p>\n\n<pre><code>Regex.IsMatch(str, \"^04([0-9])+$\")\n</code></pre>\n"},{"tags":["c#","wpf","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13286894,"title":"Create a dynamic grid depending on my data source with mvvm","body":"<p>Do you know if this is possible and if so how to do it?</p>\n\n<p>I have a set of data which will be created at runtime in my view model. Now I want to present these data to the user in a grid which automatically creates columns and rows depending on the number of data items in my data source.\nWhen the window is created it should not generate it all over again - just let it be static as I think that is easiest.</p>\n\n<p>my data source is a class containing a filepath, file name and an image.</p>\n\n<p>Is it possible?</p>\n"}]}
{"total":375441,"page":7,"pagesize":100,"questions":[{"tags":["c#","html-parsing"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13286354,"title":"is it possible to automate website input","body":"<p>I've got a question of one of my colleagues about writing a programm for downloading images of a webshop.</p>\n\n<p>I've got an excel list with article numbers. For finding the right product this number has to be inserted to the findbox of the webshop. How could it be possible to write a program that finds this product en returns the page source for parsing. </p>\n\n<p>Kind regards,\nLuuk Krijnen</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":129,"score":3,"question_id":12990028,"title":"Select only one Item from listBox","body":"<p>I am beginner in c#.  I need to show only one Item of the <code>ListView</code> (with its sub items), when user selects an item name which are populated also in <code>ComboBox</code>.</p>\n\n<p>I know the event to use i.e., <code>SelectedIndexChanged</code> event. But I dont know what to do in that.</p>\n\n<p>Currently I am using alternative big process which includes XML file and dataset which makes my project more complex.</p>\n\n<p>The <code>ListView</code> has many items in it. Same item names are also in <code>ComboBox</code>.</p>\n\n<p>If you have time please take a look at my very small project. <strong><a href=\"http://dl.dropbox.com/u/87374848/FlagsApp%201001.zip\" rel=\"nofollow\">download</a></strong></p>\n\n<p><strong>EDIT</strong>:     Here \"<em>Show only one item</em>\" means strictly show only one item, not select the particular item and show all the items.</p>\n"},{"tags":["c#","asp.net-mvc","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13286924,"title":"Can User.Identity.IsAuthenticated within the Login method return true?","body":"<p>I have the following login method in my MVC project</p>\n\n<pre><code>    public ActionResult Login(LoginModel model, string returnUrl)\n    {\n\n\n        if (ModelState.IsValid)\n        {\n\n\n            if (_authenticationRepository.Login(model.UserName, model.Password))\n            {                    \n                var authenticationTicket = new FormsAuthenticationTicket(1, model.UserName, DateTime.Now,\n                                                                         DateTime.Now.AddMinutes(20),\n                                                                         model.RememberMe, \"\", \"/\");\n\n                var cookie = new HttpCookie(FormsAuthentication.FormsCookieName,\n                                                FormsAuthentication.Encrypt(authenticationTicket));\n                Response.Cookies.Add(cookie);\n                UserContext.CreateUserContext();\n                return RedirectToLocal(returnUrl);\n            }\n        }\n</code></pre>\n\n<p>UserContext.cs\nThis stores the user/permissions into a session.</p>\n\n<pre><code>    public static void CreateUserContext()\n    {\n        BuildUserContext(HttpContext.Current.User);\n    }\n\n    private static void BuildUserContext(IPrincipal principalUser)\n    {\n        if (!principalUser.Identity.IsAuthenticated) return;\n\n        var user = _userAccountsRepository.GetUserByUserName(principalUser.Identity.Name);\n\n        if (user == null) return;\n\n        var userContext = new UserContext { IsAuthenticated = true };\n\n        var siteUser = Mapper.Map(user);\n\n        userContext.SiteUser = siteUser;\n\n        HttpContext.Current.Session[\"UserContext\"] = userContext;\n    }\n</code></pre>\n\n<p>I am aware that IsAuthenticated will only become true after a redirect. So within my login() method, is it possible to ensure that principalUser.Identity.IsAuthenticated will return true?</p>\n\n<p>Or where else will be a good place to create the user context if not it the login method?</p>\n\n<p>What I'm trying to achieve is:</p>\n\n<ol>\n<li>user logs in</li>\n<li>if login is successful, query db for his roles/permissions and save them into a session so that I don't have to requery every time I'm checking if the user has access to a certain action.</li>\n</ol>\n"},{"tags":["c#","database","dataset","database-connection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":794,"score":0,"question_id":3429303,"title":"Problem With Updating Database through DataAdapters/datasets in C#/Visual studio","body":"<p>I try updating my database after updating the dataset, but evenafter calling the data adapter's update function the underlying database doesn't change. I used SqlCommandBuilder and it still wouldn't update. Once I have the GUI open I can submit and search for values in my dataset but once I close it then re run it, all the changes are gone. Help?</p>\n\n<pre><code>    Code:\n\n        //in my form load event\n        con = new System.Data.SqlClient.SqlConnection();\n        ds1 = new DataSet();\n        ds2 = new DataSet();\n\n        con.ConnectionString = \"Data Source=.\\\\SQLEXPRESS;AttachDbFilename=|DataDirectory|\\\\Database1.mdf;Integrated Security=True;User Instance=True\";\n\n        con.Open();\n        MessageBox.Show(\"Database Open.\");\n\n        string sql = \"SELECT * From tblPurchases\";\n        da = new System.Data.SqlClient.SqlDataAdapter(sql, con);\n\n        string cust = \"SELECT * From tblCustomers\";\n        da2 = new System.Data.SqlClient.SqlDataAdapter(cust, con);\n\n        da.Fill(ds1, \"Purchases\");\n        numOfRecords = ds1.Tables[\"Purchases\"].Rows.Count;\n\n        da2.Fill(ds2, \"Customers\");\n        numOfCustomers = ds2.Tables[\"Customers\"].Rows.Count;\n\n        con.Close();\n        MessageBox.Show(\"Database Closed.\");\n\n    Code:\n            //in my submit button click event\n\n            System.Data.SqlClient.SqlCommandBuilder cb;\n            cb = new System.Data.SqlClient.SqlCommandBuilder(da);\n\n            System.Data.SqlClient.SqlCommandBuilder cb2;\n            cb2 = new System.Data.SqlClient.SqlCommandBuilder(da2);\n\n            DataRow dRow = ds1.Tables[\"Purchases\"].NewRow();\n            DataRow dRow2 = ds2.Tables[\"Customers\"].NewRow();\n\n            //dRow updating happens here\n\n            ds1.Tables[\"Purchases\"].Rows.Add(dRow);\n            ds2.Tables[\"Customers\"].Rows.Add(dRow2);\n\n            da.Update(ds1, \"Purchases\");\n            da2.Update(ds2, \"Customers\");\n</code></pre>\n\n<p>That's it. There are no error messages, it's just that even with that, the underlying database doesn't update and the updates only go as far as the dataset.</p>\n"},{"tags":["c#","regex","split"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2551,"score":4,"question_id":3720012,"title":"Regular expression to split string and number","body":"<p>I have a string of the form:</p>\n\n<pre><code>codename123\n</code></pre>\n\n<p>Is there a regular expression that can be used with <a href=\"http://msdn.microsoft.com/en-us/library/system.text.regularxpressions.regex.split.aspx\" rel=\"nofollow\"><code>Regex.Split()</code></a> to split the alphabetic part and the numeric part into a two-element string array?</p>\n"},{"tags":["c#","asp.net","web-services",".net-3.5","ninject"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13269324,"title":"Ninject .Net 3.5 SOAP Webservice issues","body":"<p>this is my first time posting up here and trust me I have searched high and low for an answer to my question but have had very little success.</p>\n\n<p>Background: I have currently started trying to re-factor our existing SOAP web service (.Net 3.5) in order to do some IOC and DI using Ninject.  I have a CacheManager which I am trying to initalize in the web method, however the injection does not seem to kick in.</p>\n\n<p>I have an console application that calls the webservice with the below:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        TestService service = new CachingService.TestService();\n\n        DataResult result = service.GetSomething(1);\n    }\n</code></pre>\n\n<p>The webservice is below: TestService.asmx.cs</p>\n\n<pre><code>[WebMethod(Description = \"Get something\")]\npublic DataResult GetSomething(int param)\n{\n    try\n    {\n        return this.CacheManager.Get();\n    }\n    catch (Exception ex)\n    {\n        throw;\n    }\n}\n</code></pre>\n\n<p>Base.cs (TestService.asmx.cs inherits Base to initialize CacheManager)</p>\n\n<pre><code>public class Base\n{\n    [Inject]\n    public ICacheManager CacheManager\n    {\n        get\n        {\n            if (cacheProxy == null)\n            {\n                cacheProxy = new CacheProxy();\n            }\n            return cacheProxy.CacheManager;\n        }\n    }  \n}\n</code></pre>\n\n<p>CacheProxy.cs</p>\n\n<pre><code>public class CacheProxy\n{\n    [Inject]\n    public ICacheManager CacheManager { get; set; }\n}\n</code></pre>\n\n<p>CacheManager.cs</p>\n\n<pre><code>public class CacheManager : ICacheManager\n{\n   //implements iCacheManager methods\n}\n</code></pre>\n\n<p>App_Start/NinjectWebCommon.cs</p>\n\n<pre><code>private static void RegisterServices(IKernel kernel)\n    {\nkernel.Bind&lt;ICacheManager&gt;()\n            .ToMethod(x =&gt; x.Kernel.Get&lt;ICacheManagerFactoryBuilder&gt;().GetCacheManagerFactory().CreateCacheManager())\n            .InRequestScope();\n}\n</code></pre>\n\n<p>CacheManagerFactoryBuilder.cs</p>\n\n<pre><code>public class CacheManagerFactoryBuilder : ICacheManagerFactoryBuilder\n{\n    private ICacheManagerFactory _Factory;\n\n    public CacheManagerFactoryBuilder(ICacheManagerFactory factory)\n    {\n        _Factory = factory;\n    }\n\n    public ICacheManagerFactory GetCacheManagerFactory()\n    {\n        return _Factory;\n    }\n}\n</code></pre>\n\n<p>CacheManagerFactory.cs</p>\n\n<pre><code>public class CacheManagerFactory : ICacheManagerFactory\n{\n    private readonly ICacheManager Manager;\n\n    public CacheManagerFactory(ICacheManager manager)\n    {\n        if (this.Manager == null)\n        {\n            this.Manager = manager;\n        }\n    }\n\n    public ICacheManager CreateCacheManager()\n    {\n        return this.Manager;\n    }\n\n}  \n</code></pre>\n\n<p>Everytime I run the console application and it hits <strong>GetSomething</strong>, <strong>CacheManager</strong> is null.  Why is it that the injection is not happening when I do a call to the web method?</p>\n"},{"tags":["c#","insert","sql-server-ce"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1312,"score":1,"question_id":6636513,"title":"INSERT statement affects 1 row, but the VS Server Explorer shows that it doesn't actually update the SQL CE database","body":"<p>I've checked other Stack Overflow questions to find answers, but I just can't find a solution to this. I am trying to insert string data into a SQL CE (local database).  </p>\n\n<p>I can read from the database, but I cannot insert data, regardless of whether I hard-code it or try to add it with parameters.  </p>\n\n<p>The table to be modified is called <code>users</code>. It has 3 columns: <code>ID</code>, <code>name</code>, <code>email</code>.</p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>string connection = Properties.Settings.Default.LocalDBConnectionString;\n\nusing (var con = new SqlCeConnection(connection))\n{\n    con.Open();\n\n    // (I also tried adding with parameters but couldn't get it working.)\n    using (var com = new SqlCeCommand(\"INSERT INTO users (name, email) \" +\n                                      \"VALUES (N'jimmy', N'email@jim.com')\", con))\n    {\n        int numRowsAffected = com.ExecuteNonQuery();\n\n        // This returns '1 row affected' but doesn't actually update the database\n        Console.WriteLine(numRowsAffected);\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>Although the Console outputs <code>1</code>, because 1 row is affected, when I go back into the database and check, it has not inserted the new data.  </p>\n\n<p>I was following <a href=\"http://www.dotnetperls.com/sqlce\" rel=\"nofollow\">this tutorial</a>, but only the Read works, the Insert or write doesn't work.</p>\n\n<p>I also found this similar <a href=\"http://stackoverflow.com/questions/3366123/sql-ce-3-5-writing-to-a-database\">Stack Overflow question</a>, but using parameters, still couldn't get it to work.</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>My connection string is: </p>\n\n<pre><code>Data Source=|DataDirectory|\\LocalDB.sdf\n</code></pre>\n\n<p>I don't know how to find the Build Settings, it is a Local Database I created within the console application solution, It is stored in the project directory.</p>\n\n<p>I am in \"Debug\" configuration if that helps?</p>\n\n<hr>\n\n<p>Here is another example I found <a href=\"http://www.mikeborozdin.com/post/Introducing-Microsoft-SQL-Server-Compact-Edition-%28Part-I%29.aspx\" rel=\"nofollow\">on the internet</a>:</p>\n\n<pre><code>SqlCeConnection con = new SqlCeConnection(Properties.Settings.Default.LocalDBConnectionString);\ncon.Open();\n\nSqlCeCommand comInsert = new SqlCeCommand (\"INSERT INTO users(name, email) VALUES('value 1', 'value 2')\", con);\ncomInsert.ExecuteNonQuery();\n\nSqlCeCommand comSelect = new SqlCeCommand(\"SELECT * FROM users\", con);\nSqlCeDataReader reader = comSelect.ExecuteReader();\n\nwhile (reader.Read())\n{\n    Console.WriteLine(\"{0} {1}\", reader[\"name\"], reader[\"email\"]);\n    Console.ReadKey();\n}\n\ncon.Close();\n</code></pre>\n\n<p>I just copied and pasted this in, and changed the main variables. This example temporarily inserts the data, but when I go to Visual Studio's Server Explorer and view the table, it hasn't updated.</p>\n"},{"tags":["c#","multithreading","image-processing","aforge"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13287092,"title":"Convert bitmap to byte array for multiple camera","body":"<p>i'm developing a multiple two frame detection project.im using ISPY. i tried the following method:</p>\n\n<pre><code>    private byte[] BitmapToRgbValues(Bitmap bmp)\n    {\n        // Lock the bitmap's bits.\n        Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);\n        System.Drawing.Imaging.BitmapData bmpData =\n         bmp.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadOnly,\n         bmp.PixelFormat);\n\n        // Get the address of the first line.\n        IntPtr ptr = bmpData.Scan0;\n\n        // Declare an array  to hold the bytes  of the bitmap.\n        int bytes = bmpData.Stride * bmp.Height;\n        byte[] rgbValues = new byte[bytes];\n\n        // Copy the RGB values into the array.\n        System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes); bmp.UnlockBits(bmpData);\n\n        return rgbValues;\n    }\n</code></pre>\n\n<p>Unfortunately this method freezes my application. it is not significant on 2 or 3 cameras. But with more than 10 cameras, it is a gone case.. I target 100 cameras or 512mb of frames. Ispy uses unmanaged image here to do the image processing. just wondering if there is a way for me to convert the multiple frame efficiently. Below is a sneak peak of how i convert the frame.</p>\n\n<pre><code>    private void VideoNewFrame(object sender, NewFrameEventArgs e)\n    {\n        Bitmap bmOrig = null;\n        if (e.Frame != null)\n        {\n            //more code..\n            bmOrig = e.Frame;\n        }\n        LastFrameUnmanaged = UnmanagedImage.FromManagedImage(bmOrig);\n        SecondFrameBuffer = BitmapToRgbValues(ResizeBitmap(bmOrig, 352, 288));\n        //more code..\n    }\n</code></pre>\n\n<p>SecondFrameBuffer is a byte[] array.</p>\n"},{"tags":["c#","winforms","devexpress"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13284732,"title":"How to edit DateEdit input format","body":"<p>How can i change the input format of the DateEdit? I want to type 2012 for example\nwithout day and month. </p>\n\n<p>With the display format i can change the it after enter a date. \nSo i thought the edit format is the solution. </p>\n\n<p>But if i type\n <code>editformat.formatstring = \"yyyy\"</code> \nand i try to type 2012 in the dateedit i just get 0001 as display text after enter it. </p>\n\n<p>Furthermore is it possible to type the month only? For example type 10 and he display October.</p>\n\n<p>regards</p>\n"},{"tags":["c#","dictionary","map","f#","idiomatic"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":13277773,"title":"Compose immutable F# map of list of strings","body":"<p>In C# I could build a <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code> pretty easy. If I was reading through a large database of items I could do the following:</p>\n\n<pre><code>var dict = new Dictionary&lt;string, List&lt;string&gt;&gt;();\nforeach(string[] row in data)\n   if (!dict.ContainsKey(row[0]))\n      dict.add(row[0], new List&lt;string&gt;() { row };\n   else\n      dict[row[0]].add(row);\n</code></pre>\n\n<p>Now the question is, how do I do this in f# with an immutable <code>Map&lt;string, string list&gt;</code>?</p>\n"},{"tags":["c#","asp.net-mvc","mocking","moq","httpcontext"],"answer_count":6,"favorite_count":7,"up_vote_count":33,"down_vote_count":0,"view_count":12586,"score":33,"question_id":1452418,"title":"How do I mock the HttpContext in ASP.NET MVC using Moq?","body":"<pre><code>[TestMethod]\npublic void Home_Message_Display_Unknown_User_when_coockie_does_not_exist()\n{\n    var context = new Mock&lt;HttpContextBase&gt;();\n    var request = new Mock&lt;HttpRequestBase&gt;();\n    context\n        .Setup(c =&gt; c.Request)\n        .Returns(request.Object);\n    HomeController controller = new HomeController();\n\n    controller.HttpContext = context; //Here I am getting an error (read only).\n    ...\n }\n</code></pre>\n\n<p>my base controller has an overrride of the Initialize that get's this requestContext.  I am trying to pass this along but I am not doing something right. </p>\n\n<pre><code>protected override void Initialize(System.Web.Routing.RequestContext requestContext)\n{\n    base.Initialize(requestContext);\n}\n</code></pre>\n\n<p>Where can I get more information on mocking my RequestContext and HttpContext using Moq?  I am trying to mock cookies and the general context.</p>\n"},{"tags":["c#","asp.net","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13285874,"title":"Asp.Net authentication(getting logout automatically)","body":"<p>In my application I have used Asp.Net Form Authentication, </p>\n\n<pre><code>FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(\n                    1,\n                    adminResult.UserName,\n                    DateTime.Now,\n                    DateTime.Now.AddDays(2),\n                    true,\n                    \"Administrator\",\n                    FormsAuthentication.FormsCookiePath\n                    );\n                string hash = FormsAuthentication.Encrypt(ticket);\n                HttpCookie coockie = new HttpCookie(FormsAuthentication.FormsCookieName, hash);\n                if (ticket.IsPersistent)\n                {\n                    coockie.Expires = ticket.Expiration;\n                }\n                Response.Cookies.Add(coockie);\n                if (Url.IsLocalUrl(returnUrl))\n                {\n                    return Redirect(returnUrl);\n                }\n                else\n                {\n                    return RedirectToAction(\"Dashboard\", \"Cockpit\");\n                }\n</code></pre>\n\n<p>But it's getting logout in 10 to 15 seconds automatically.</p>\n\n<p>What would be the solution ?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","linq","visual-studio","freeware"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13286942,"title":"Is there a Linqify tool like ReSharper","body":"<p>I was wondering if there is a freeware / Open Source tool that can Linqify / Linqification queries like ReSharper can?</p>\n\n<p><a href=\"http://www.jetbrains.com/resharper/webhelp/Code_Analysis__Examples_of_Quick-Fixes.html#loop_to_LINQ\" rel=\"nofollow\">http://www.jetbrains.com/resharper/webhelp/Code_Analysis__Examples_of_Quick-Fixes.html#loop_to_LINQ</a></p>\n"},{"tags":["c#","iphone","ios","monotouch","avaudiorecorder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":372,"score":1,"question_id":5878394,"title":"Using AVAudioRecorder.ToUrl() with MonoTouch 4.0.1 return null","body":"<p>For the last 2 years, I'm using the next code to init an audio recorder object, and everything has been fine. </p>\n\n<pre><code>ar = AVAudioRecorder.ToUrl(url, settings, out errorRecorder);\nar.MeteringEnabled = false;\n</code></pre>\n\n<p>However, this week I made an upgrade to: Mono 2.10.2, MonoTouch 4.0.1.10285, MonoDevelop 2.4.2. I'm still using Xcode 3.2.6 and iOS SDK 4.3. With this configuration, the method</p>\n\n<pre><code>AVAudioRecorder.ToUrl(url, settings, out errorRecorder)\n</code></pre>\n\n<p>always returned a null value to the ar object.</p>\n\n<p>Somebody has the same problem? This is the complete code:</p>\n\n<pre><code>NSError errorRecorder;\nNSUrl url;\nNSDictionary settings;\nAVAudioRecorder ar;\nstring path, audioFile;\n\nNSObject[] values = new NSObject[]\n{\n    NSNumber.FromInt32((int)AudioFileType.M4A), \n    NSNumber.FromFloat(11025.0f), \n    NSNumber.FromInt32(1),\n    NSNumber.FromInt32((int)AVAudioQuality.Min)\n};\n\nNSObject[] keys = new NSObject[]\n{\n    AVAudioSettings.AVFormatKey,\n    AVAudioSettings.AVSampleRateKey,\n    AVAudioSettings.AVNumberOfChannelsKey,\n    AVAudioSettings.AVEncoderAudioQualityKey\n};\n\nsettings = NSDictionary.FromObjectsAndKeys (values, keys);\n\npath = Environment.GetFolderPath(Environment.SpecialFolder.Personal);\npath = Path.Combine(path, audioDir);\nif (!Directory.Exists(path)){\n    Directory.CreateDirectory(path);\n}\n\naudioFile = newJobEntity.jobid + \"_\" + numFiles + \".caf\";\n\nif (!File.Exists(Path.Combine(path, audioFile)))\n    FileStream audioFileStream = File.Create(Path.Combine(path, audioFile));\n\nurl = NSUrl.FromFilename(Path.Combine(path, audioFile));\n\nar = AVAudioRecorder.ToUrl(url, settings, out errorRecorder);\nar.MeteringEnabled = false;\n</code></pre>\n\n<p>Thanks in advanced.</p>\n"},{"tags":["c#","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13286641,"title":"how to get html source in windows 8 app","body":"<p>In windows 8, I try to get html source from URL:</p>\n\n<pre><code>private void loadingDatafromWeb(string URL)\n{\n    HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(URL);\n    request.BeginGetResponse(new AsyncCallback(ReadCallbackLoadingData),request);\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>private void ReadCallbackLoadingData(IAsyncResult asynchronousResult)\n{\n    string myPageSource;\n    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n    HttpWebResponse response =   (HttpWebResponse)request.EndGetResponse(asynchronousResult);\n    using (StreamReader myWebSource = new StreamReader(response.GetResponseStream()))\n    {\n        myPageSource = myWebSource.ReadToEnd();\n    }\n</code></pre>\n\n<p>I want to get string myPageSource in function loadingDatafromWeb, but i can't do it. Please tell me how?</p>\n"},{"tags":["c#",".net","paradox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13286488,"title":"What is the .Net type equivalent to Time in Paradox Database","body":"<p>I'm accessing Paradox file by binary reading.</p>\n\n<p>But I have a question. I don't know what conversion should I to do from Time in Paradox Database:</p>\n\n<ul>\n<li>TimeSpan</li>\n<li>DateTime</li>\n<li>Or I should to convert to string</li>\n</ul>\n"},{"tags":["c#","api","google"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13286400,"title":"Is it possible to add attachment or document to an google event entry programmatically using c#? If possible, how?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://facebook.stackoverflow.com/questions/3094324/how-to-add-attachment-in-google-apps-calendar-using-google-api-version-2\">How to add “Attachment” in Google Apps Calendar using Google API version 2?</a>  </p>\n</blockquote>\n\n\n\n<p>I followed the following reference for Google event. </p>\n\n<p><a href=\"http://www.codeproject.com/Articles/64474/How-to-Read-the-Google-Calendar-in-C\" rel=\"nofollow\">http://www.codeproject.com/Articles/64474/How-to-Read-the-Google-Calendar-in-C</a></p>\n\n<p>Everything is working fine. But I want to add an extra option \"attachment\" to event entry when I sent it to participants. How can I do this. </p>\n\n<p>If there is any alternative API or solutions, please help me.</p>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13286577,"title":"Exception from HRESULT: 0x80240007","body":"<p>I am getting error \"Exception from HRESULT: 0x80240007\" when I am trying to fetch installed windows updates.My code worked well in windows 7 but its not working in windows xp.I am getting error in line \"var history = updateSearcher.QueryHistory(0, count);\" </p>\n\n<p>this is my code sniplet</p>\n\n<pre><code>        var updateSession = new UpdateSession();\n        var updateSearcher = updateSession.CreateUpdateSearcher();\n        var count = updateSearcher.GetTotalHistoryCount();\n        var history = updateSearcher.QueryHistory(0, count);\n</code></pre>\n\n<p>I am getting error in the last line. What Changes do i need to make in the code.please help me with this issues.</p>\n\n<p>swati</p>\n"},{"tags":["c#","asp.net","visual-studio","client"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":10368,"score":-1,"question_id":2009057,"title":"download file from server asp.net","body":"<p>I want to download a file from server to a local host.</p>\n\n<p>i have a code from the net which should work but is not working</p>\n\n<pre><code>     protected void Button4_Click(object sender, EventArgs e)\n    {\n     //To Get the physical Path of the file(test.txt)\n    string filepath = Server.MapPath(\"test.txt\");\n\n    // Create New instance of FileInfo class to get the properties of the file being downloaded\n   FileInfo myfile = new FileInfo(filepath);\n\n   // Checking if file exists\n   if (myfile.Exists)\n   {\n   // Clear the content of the response\n   Response.ClearContent();\n\n// Add the file name and attachment, which will force the open/cancel/save dialog box to show, to the header\nResponse.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + myfile.Name);\n\n// Add the file size into the response header\nResponse.AddHeader(\"Content-Length\", myfile.Length.ToString());\n\n// Set the ContentType\nResponse.ContentType = ReturnExtension(myfile.Extension.ToLower());\n\n// Write the file into the response (TransmitFile is for ASP.NET 2.0. In ASP.NET 1.1 you have to use WriteFile instead)\nResponse.TransmitFile(myfile.FullName);\n\n// End the response\nResponse.End();\n  }\n\n    }\n\n    private string ReturnExtension(string fileExtension)\n    {\n        switch (fileExtension)\n        {\n            case \".htm\":\n            case \".html\":\n            case \".log\":\n                return \"text/HTML\";\n            case \".txt\":\n                return \"text/plain\";\n            case \".doc\":\n                return \"application/ms-word\";\n            case \".tiff\":\n            case \".tif\":\n                return \"image/tiff\";\n            case \".asf\":\n                return \"video/x-ms-asf\";\n            case \".avi\":\n                return \"video/avi\";\n            case \".zip\":\n                return \"application/zip\";\n            case \".xls\":\n            case \".csv\":\n                return \"application/vnd.ms-excel\";\n            case \".gif\":\n                return \"image/gif\";\n            case \".jpg\":\n            case \"jpeg\":\n                return \"image/jpeg\";\n            case \".bmp\":\n                return \"image/bmp\";\n            case \".wav\":\n                return \"audio/wav\";\n            case \".mp3\":\n                return \"audio/mpeg3\";\n            case \".mpg\":\n            case \"mpeg\":\n                return \"video/mpeg\";\n            case \".rtf\":\n                return \"application/rtf\";\n            case \".asp\":\n                return \"text/asp\";\n            case \".pdf\":\n                return \"application/pdf\";\n            case \".fdf\":\n                return \"application/vnd.fdf\";\n            case \".ppt\":\n                return \"application/mspowerpoint\";\n            case \".dwg\":\n                return \"image/vnd.dwg\";\n            case \".msg\":\n                return \"application/msoutlook\";\n            case \".xml\":\n            case \".sdxl\":\n                return \"application/xml\";\n            case \".xdp\":\n                return \"application/vnd.adobe.xdp+xml\";\n            default:\n                return \"application/octet-stream\";\n        }\n    }\n</code></pre>\n\n<p>now when the button is clicked the file should be downloaded from the server to the local host computer... but nothing seems to be happening...</p>\n\n<p>i have the test.txt on the desktop of the serer... the save file option also does not come on the client side..</p>\n\n<p>I publish the files and put it in the inetpub folder of the server and run the GUI from the client side.. everything works except this...</p>\n\n<p>any suggestions...please help  </p>\n\n<p>this program downloads a file if it is present in the inetpub folder.. instead i want to download from any location within the server...</p>\n\n<p>??</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":183,"score":2,"question_id":13167800,"title":"Split over-tall WPF RichTextBox into multiple controls","body":"<p>I'm trying to get the content height of a RichTextBox and if it exceeds 500px, split it into multiple RichTextBoxes with the maximum height of 500px.</p>\n\n<p>Anyone know how to do this? Thanks.</p>\n\n<p>EDITED:</p>\n\n<p>by \"split\" I mean put the content that exceeds the height limit in another RichTextBox, the solution can't just change the appearence of the current RichTextBox due to project specificities.</p>\n"},{"tags":["c#",".net","wpf","silverlight","dependency-properties"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13285169,"title":"Why registering two identical attached properties works in Silverlight but fails in WPF?","body":"<p>Look at this code:</p>\n\n<pre><code>var property = DependencyProperty.RegisterAttached(\n                \"SomeAttachedProperty\",\n                typeof(object),\n                typeof(View),\n                new PropertyMetadata(default(object)));\n\nvar sameProperty = DependencyProperty.RegisterAttached(\n                \"SomeAttachedProperty\",\n                typeof(object),\n                typeof(View),\n                new PropertyMetadata(default(object)));\n</code></pre>\n\n<p>The second registration fails in WPF with <code>AgrumentException</code> that says \"property already registered\" (which is correct). </p>\n\n<p>In decompiled sources of WPF <code>DependencyProperty</code> I found:</p>\n\n<pre><code>FromNameKey key = new FromNameKey(name, ownerType);\nlock (Synchronized) \n{ \n     if (PropertyFromName.Contains(key))\n     { \n          throw new ArgumentException(SR.Get(SRID.PropertyAlreadyRegistered,\n                                      name, ownerType.Name));\n     }\n}\n</code></pre>\n\n<p>But in SL I haven't found any checks for existing properties with same name and type.</p>\n\n<p>So the question is why SL doesn't check it but WPF does? Are there some basic limitations or what?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","httpwebrequest","timeout","httpwebresponse","webexception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13285159,"title":"HttpWebRequest doesn't throw exception","body":"<p>I have a problem with httpwebrequest exception. I use the following code to make a request and catch the exception. </p>\n\n<pre><code>try\n{    \n    Uri url= new Uri(\"https://www.example.com\");\n    HttpWebRequest request2 =(HttpWebRequest)WebRequest.Create(url);\n\n    request2.Timeout = 10000;\n\n    HttpWebResponse response2 = (HttpWebResponse)request2.GetResponse();\n    response2.Close();\n}\ncatch (TimeoutException)\n{\n    listBox.Items.Insert(0, \"Timeout\");\n}\ncatch (WebException ex)\n{\n    using (WebResponse response = ex.Response)\n    {\n        HttpWebResponse httpResponse = (HttpWebResponse)response;\n        listBox.Items.Insert(0, \"Status code(Benchmark):\" + httpResponse.StatusCode);\n    }\n}\ncatch\n{\n    listBox.Items.Insert(0, \"Failure\");\n}\n</code></pre>\n\n<p>At company network when I enter a non-existing url such as www.oiuahsdupiasduiuhid.com; it throws webexception . I got status code: not found or service unavailable. However If I try it at home, it doesn't throw any exception. It waits around 1 second and then without any error stops working. I delete all exceptions to see what is happening but the problem is it doesn’t show any error.\nDo you have any idea about what is the problem? </p>\n\n<p>Or any recommendation, how can I handle this problem with a different way?</p>\n"},{"tags":["c#","winforms","math","matrix","gdi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13286485,"title":"How to draw 2d contour plot in c#?","body":"<p>Title says it all. I'm mainly interested in algorithm which would enable me to convert Point3D[] into drawable gdi lines?\n                                                                             Thanks in  advance.</p>\n"},{"tags":["c#",".net","windows","list"],"answer_count":2,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":3857,"score":5,"question_id":815340,"title":"How do I get a list of installed updates and hotfixes?","body":"<p>A list of every update and hotfix that has been installed on my computer, coming from either Microsoft Windows Update or from the knowledge base. I need the ID of each in the form of KBxxxxxx or some similar representation...</p>\n\n<p>Currently I have:</p>\n\n<pre><code>const string query = \"SELECT HotFixID FROM Win32_QuickFixEngineering\";\nvar search = new ManagementObjectSearcher(query);\nvar collection = search.Get();\n\nforeach (ManagementObject quickFix in collection)\n    Console.WriteLine(quickFix[\"HotFixID\"].ToString());\n</code></pre>\n\n<p>But this does not seem to list everything, it only lists QFE's.</p>\n\n<p>I need it to work on Windows XP, Vista and 7.</p>\n"},{"tags":["c#","oop","e-commerce","nopcommerce","nop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13286692,"title":"Sending mail to Nop Commerce Customers in a Console application Project","body":"<p>I am beginner in the Nop Commerce Project 2.30. I try to send mails to my Nop Commerce </p>\n\n<p>Clients ( in the database ) in a specific intervel ( every 12 Hours ). </p>\n\n<p>I create new method ( for create List of client list )  in the interface </p>\n\n<p><strong>Nop.Services.Customers.ICustomerService</strong> and implement this function, class is</p>\n\n<p><strong>Nop.Services.Customers.CustomerService</strong>. But a problem i can't create this method </p>\n\n<p>as <strong>static</strong> method. Please see image</p>\n\n<p><img src=\"http://i.stack.imgur.com/tnzMT.png\" alt=\"enter image description here\"></p>\n\n<p>Because <strong>CustomerService</strong> class is not contains the default </p>\n\n<p>constructor. This is the only one constructor in the CustomerService Class. </p>\n\n<p>Please see below.</p>\n\n<pre><code> public CustomerService(ICacheManager cacheManager,\n            IRepository&lt;Customer&gt; customerRepository,\n            IRepository&lt;CustomerRole&gt; customerRoleRepository,\n            IRepository&lt;CustomerAttribute&gt; customerAttributeRepository,\n            IEncryptionService encryptionService, \n            INewsLetterSubscriptionService newsLetterSubscriptionService,\n            RewardPointsSettings rewardPointsSettings, \n            CustomerSettings customerSettings,\n            IEventPublisher eventPublisher)\n        {\n            _cacheManager = cacheManager;\n            _customerRepository = customerRepository;\n            _customerRoleRepository = customerRoleRepository;\n            _customerAttributeRepository = customerAttributeRepository;\n            _encryptionService = encryptionService;\n            _newsLetterSubscriptionService = newsLetterSubscriptionService;\n            _rewardPointsSettings = rewardPointsSettings;\n            _customerSettings = customerSettings;\n            _eventPublisher = eventPublisher;\n        }\n</code></pre>\n\n<p>I am clueless how to call this parameterized constructor in a external program. So i try </p>\n\n<p>to make my function is static. Any Idea to create a static method in nop. Please help</p>\n"},{"tags":["c#","asp.net","epplus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13269591,"title":"setting cell width with epplus affects the whole column","body":"<p>I'm having a bit of trouble on solving this. Is there a way to set the width of a specific cell from a worksheet using epplus? Because when i use, for example:</p>\n\n<pre><code>ws.Column(1).Width = 40;\n</code></pre>\n\n<p>the whole column gets affected.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","xaml","mvvm","windows-8","winrt-xaml"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13282724,"title":"Binding a collection to a list control","body":"<p>Hi im learning about MVVM and Win8 app development, and Im having trouble with binding an ObservableCollection (located in NoteViewModel.cs) to my MainPage listbox (or listview) through XAML.</p>\n\n<pre><code>public ObservableCollection&lt;Note&gt; NotesList;\n</code></pre>\n\n<p>The Model is a simple Note.cs class, which holds NoteText, Priority and RemindDate.</p>\n\n<p>What Im doing right now is set the DataContext in the code-behind file of MainPage.xaml.cs\nto the ObservableCollection.</p>\n\n<pre><code>public MainPage()\n{\n    this.InitializeComponent();\n    NoteViewModel nvm = new NoteViewModel();\n    noteListView.DataContext = nvm.NotesList;\n}\n</code></pre>\n\n<p>And in the NoteViewModel Constructor I simply create 2 new Notes which I then add to the Collection.</p>\n\n<p>What I would like to do is set the DataContext in XAML to the NoteViewModel and the ItemsSource to the NotesList. I want to implement a DetailsView to a single note later.</p>\n\n<p>There are lots of tutorial with binding collections to listboxes, \nbut I havent found one which shows the MVVM-correct way to do so.</p>\n\n<p>Any help?</p>\n"},{"tags":["c#","javascript","asp.net","drop-down-menu"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13286050,"title":"Convert dropdownlist into text","body":"<p>I have designed a dropdownlist for the entry of date. Now I have to convert it into text format (like the way you enter into a text field - mm-dd-yyyy) so that I can display it in an xml file.</p>\n\n<p>Any suggestions on how to go about it?</p>\n\n<p>My frontend code looks like this. This is just one part of it. I have 3 more entities like this.:</p>\n\n<pre><code>  &lt;td&gt;\n      LICENSE FROM *\n  &lt;/td&gt;\n  &lt;td&gt;\n      &amp;nbsp;&lt;asp:DropDownList ID=\"drpmm0\" runat=\"server\" CssClass=\"drp1\"&gt;\n      &lt;/asp:DropDownList&gt;\n      &amp;nbsp;&lt;asp:DropDownList ID=\"drpdte0\" runat=\"server\" CssClass=\"drp1\"&gt;\n      &lt;/asp:DropDownList&gt;\n      &amp;nbsp;&lt;asp:DropDownList ID=\"drpyyyy0\" runat=\"server\" CssClass=\"drp1\"&gt;\n      &lt;/asp:DropDownList&gt;\n      &amp;nbsp;(mm-dd-yyyy)\n      &lt;asp:RequiredFieldValidator ID=\"reqmm0\" runat=\"server\" ControlToValidate=\"drpmm0\" Display=\"Dynamic\"ErrorMessage=\"Select Month\"&gt;&lt;/asp:RequiredFieldValidator&gt;\n      &lt;asp:RequiredFieldValidator ID=\"reqdte0\" runat=\"server\" ControlToValidate=\"drpdte0\" ErrorMessage=\"Select Date\"&gt;&lt;/asp:RequiredFieldValidator&gt;\n      &lt;asp:RequiredFieldValidator ID=\"reqyyyy0\" runat=\"server\" ControlToValidate=\"drpyyyy0\" ErrorMessage=\"Select Year\"&gt;&lt;/asp:RequiredFieldValidator&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>I just need a little guidance for backend.</p>\n"},{"tags":["c#","wpf","multithreading","graph","charts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13281914,"title":"How to update a single graph in chart from multiple async threads?","body":"<pre><code> Parallel.foreach(list&lt;&gt; , a=&gt;  \n    {  \n    // do some operation  \n         chart1.Series[0].Points.AddXY(x, y);  \n    });  \n</code></pre>\n\n<p>I want to draw different lines for each thread invoked in parallel. Is there anyway to do this?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13286411,"title":"C# Show relation with two dataGridView","body":"<p>I have 2 dataGridViews (WinForms):</p>\n\n<ul>\n<li>dataGridView1 presenting Categories</li>\n<li>dataGridView2 presenting Books</li>\n</ul>\n\n<p>Every Book has category_id field, which is foreign key to Category.id</p>\n\n<p>I've created relations, everything is working fine. The question is how to display in dataGridView2 only those Books, which belong to Category selected in dataGridView1?</p>\n\n<p>So far I have this:</p>\n\n<pre><code>int category_id = Convert.ToInt32(dataGridView1.SelectedRows[0].Cells[0].Value);\n\nvar booksInCategory = dbContext.Book.Where(b =&gt; b.Category.id == category_id).Select(b =&gt; b);\n\nthis.dataGridView2.DataSource = booksInCategory;\n</code></pre>\n\n<p>But it seems to return an empty Book, only Book.id is displayed, other fields are empty.</p>\n"},{"tags":["c#","gridview","grouping"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13286173,"title":"Grouping Items in GridView","body":"<p>I'm not really sure how I would go about coding this but here's what the GridView should look like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/oPydX.jpg\" alt=\"enter image description here\"></p>\n\n<p>Items will be grouped according to their respective \"products\"</p>\n\n<p>Any help regarding the structure of the GridView would be appreciated.</p>\n\n<p>Thank you :)</p>\n"},{"tags":["c#","pinvoke","structlayout"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13285459,"title":"Modify struct layout from p/invoke","body":"<p>I'm looking for guidance around changing the struct/class layout of objects returned/passed into a p/invoke function.  I've searched for an answer to this but maybe I'm just too tired and I'm not searching effectively.</p>\n\n<p>The simplest example I can come up with (the real one is a bit too complex for here) is with something like <a href=\"http://www.pinvoke.net/default.aspx/user32.getwindowrect\" rel=\"nofollow\">GetWindowRect</a>.</p>\n\n<p>If I wanted to add a few extra properties to the RECT struct, should I just add it to the definition for the struct itself or should I switch over to subclassing to add the extra properties?</p>\n\n<p>Which is better and why?</p>\n\n<pre><code>[DllImport(\"user32.dll\")]\n[return: MarshalAs(UnmanagedType.Bool)]\nstatic extern bool GetWindowRect(HandleRef hWnd, out RECT lpRect);\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct RECT\n{\n    public int Left;        // x position of upper-left corner\n    public int Top;         // y position of upper-left corner\n    public int Right;       // x position of lower-right corner\n    public int Bottom;      // y position of lower-right corner\n\n    public string Extra;    // ADDED\n}\n</code></pre>\n\n<p><strong>Versus</strong></p>\n\n<pre><code>[DllImport(\"user32.dll\")]\n[return: MarshalAs(UnmanagedType.Bool)]\nstatic extern bool GetWindowRect(HandleRef hWnd, out RECT lpRect);\n\n[StructLayout(LayoutKind.Sequential)]\npublic class RECT\n{\n    public int Left;        // x position of upper-left corner\n    public int Top;         // y position of upper-left corner\n    public int Right;       // x position of lower-right corner\n    public int Bottom;      // y position of lower-right corner\n}\n\npublic class RectEx : RECT\n{\n    public string Extra;    // Added\n\n    public RectEx(RECT r)\n    {\n        Left = r.Left;\n        Top = r.Top;\n        Right = r.Right;\n        Bottom = r.Bottom;\n        Extra = \"test\";\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","sql-server","visual-studio","datareader"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2424,"score":1,"question_id":6179139,"title":"Invalid attempt to call MetaData when reader is closed?","body":"<p>I'm running an if else statement off of a datareader to query table data and activate/de-activate some controls on a page. I implemented a using statement to automatically close the connection and the reader when I close the block, but I still get the reader is closed error on each of my if else statements. What's missing? Code below:</p>\n\n<pre><code>string comnt = \"SELECT StatusId FROM Submission WHERE SubmissionId =\" + x;\n\n\n    using (SqlConnection editConn = new SqlConnection(connectionString))\n    {\n        editConn.Open();\n\n        using (SqlCommand statCmd = new SqlCommand(comnt, editConn))\n        {\n            SqlDataReader dr = statCmd.ExecuteReader();\n            dr.Read();\n            if (dr.GetInt32(0) &gt; 0)\n            {\n                PanelComment.Visible = true;\n                PanelQuote.Visible = false;\n                LnbFid.Visible = false;\n                LnbCrim.Visible = false;\n                LnbEo.Visible = false;\n                LnbEpl.Visible = false;\n                LnbNot.Visible = false;\n                LnbPriv.Visible = false;\n                LnbPub.Visible = false;\n\n            }\n            else\n            {\n                PanelComment.Visible = false;\n            }\n\n        } \n</code></pre>\n"},{"tags":["c#","visual-studio","visual-studio-2012"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":404,"score":6,"question_id":12438557,"title":"Enhanced Scroll Bar for Visual Studio 2012?","body":"<p>If you have experienced working with Enhanced Scroll Bar of Productivity Tools of VS2010, you know it's nearly impossible to work without it anymore. Visual Studio 2012 doesn't support it. I've googled but found nothing interesting. Maybe you have heard of some alternatives that work with Visual Studio 2012?</p>\n"},{"tags":["c#","jquery",".net","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13284780,"title":"How to do multi-selection of jQuery Style in WPF?","body":"<p>Is it possible to select items of the same type like jQuery selector in WPF?</p>\n\n<pre><code>    &lt;div class=\"good\"&gt;123&lt;div&gt;\n    &lt;div class=\"good\"&gt;234&lt;div&gt;\n    &lt;div class=\"good\"&gt;345&lt;div&gt;\n    &lt;div&gt;aaa&lt;div&gt;\n</code></pre>\n\n<p>By jQuery, we can select all the div's of class \"good\" by $('.good').</p>\n\n<p><strong>For WPF, it is possible to do the selection like that by adding some sort of class to control?</strong></p>\n\n<p>ps: what i m doing is trying to change the style of a few controls from code behind. currently, i have made it by changing the style that has been applied to controls. at the moment, i think over it and have the question if WPF support this jQuery Style selection. Anyway, in WPF, it seems not a good idea to do in javascript way.</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13286356,"title":"Is there a type T in the standard library? IList<T> where T: class, new()","body":"<p>I'm testing a method which takes <code>IList&lt;T&gt; where T: class, new()</code>. For brevity, I'd like to test it with a type from the .NET standard library. However, I can't think of any which meet the conditions! Except for <code>List&lt;List&lt;T&gt;&gt;</code> - which I'd rather not use because manipulating collections of collections makes the test difficult to read.</p>\n\n<p>Can you think of a type that meets the conditions? I don't want to add any new references.</p>\n"},{"tags":["c#","code-contracts"],"answer_count":6,"favorite_count":8,"up_vote_count":28,"down_vote_count":0,"view_count":1187,"score":28,"question_id":3077933,"title":"Really trying to like CodeContracts in C#","body":"<p>I am finally playing catchup with everything new that has been added in to the .NET 3.5/4.0 Frameworks. The last few days I have been working with CodeContracts and I am really trying hard to like them. I am curious what other people think of the implementation of CodeContracts in C#? Specifically, how are people organizing things like Contract classes for interfaces, contract methods for Contract Invariants etc?</p>\n\n<p>I like the validation that contracts provide, at first glance they look great. With a few simple lines I can get some nice build checking before I even run my code. Unfortunately, I am having a hard time getting over the feeling that the way that code contracts are implement in C#, they are cluttering up my code more than they are documenting contracts. And to take full advantage of contracts, I am littering my code with assumptions and asserts etc (which I know some will say is a good thing); but as some of my examples below will show, it turns a single simple line in to 4 or 5 lines, and doesn't really add sufficient value in my opinion over alternative approaches (i.e., asserts, exceptions etc).</p>\n\n<p>Currently, my greatest frustrations are:</p>\n\n<p>Interface Contracts:</p>\n\n<pre><code>[ContractClass(typeof(IInterfaceContract))]\n  public interface IInterface\n  {\n    Object Method(Object arg);\n  }\n\n  [ContractClassFor(typeof(IInterface))]\n  internal abstract class IInterfaceContract\n  {\n    private IInterfaceContract() { }\n\n    Object IInterface.Method(Object arg)\n    {\n      Contract.Requires(arg != null);\n      Contract.Ensures(Contract.Result&lt;Object&gt;() != null);\n      return default(Object);\n    }\n  }\n</code></pre>\n\n<p>This feels like such a cludge to me, I wish there was a cleaner way to document requirements, either via attributes or some form of built in language support. The fact that I have to implement an abstract class that implements my interface, just so I can specify the contract seems tedious at best.</p>\n\n<p>Code Bloat:</p>\n\n<pre><code>typeof(Action&lt;&gt;).MakeGenericType(typeof(Object);\n</code></pre>\n\n<p>Requires several assumptions just to verify information that is readily available. I appreciate that all the analyzer knows is that it is operating on Type and thus must work on that limited knowledge, but it still frustrates me that a single line of code requires me to re-write as</p>\n\n<pre><code>var genericAction = typeof(Action&lt;&gt;);\n\nContract.Assume(genericAction.IsGenericType);\nContract.Assume(genericAction.GetGenericArguments().Length == 1);\n\ngenericAction.MakeGenericType(typeof(Object));\n</code></pre>\n\n<p>Just to keep things documented (yes I know I can use ContractVerificationAttribute to turn this off for a method/class etc, or SuppressMessageAttribbute to target specific messages, but that seems to defeat the purpose as your code would quickly become littered with suppressions etc. </p>\n\n<p>In addition, taking a case like</p>\n\n<pre><code>  public class MyClass\n    : IInterface\n  {\n    private readonly Object _obj;\n\n    public Object Property\n    {\n      get\n      {\n        Contract.Ensures(Contract.Result&lt;Object&gt;() != null);\n        return _obj;\n      }\n    }\n\n    public MyClass(Object obj)\n    {\n      Contract.Requires(obj != null);\n\n      _obj = obj;\n    }\n  }\n</code></pre>\n\n<p>obj is required to be not null, and is set to a readonly field that cannot be changed, yet I am still required to add a \"markup\" method to my class so that my property requirement to not return null can be proven:</p>\n\n<pre><code>[ContractInvariantMethod]\nprivate void ObjectInvariant()\n{\n  Contract.Invariant(_obj != null);\n}\n</code></pre>\n\n<p>There is more, but I figured I have probably ranted enough, and I would really appreciate the insight of people much smarter than me to help me \"like\" Code Contracts and make this feeling of code clutter go away. Any insight on how to better structure code, workaround wonkiness issues etc would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","resources"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13272109,"title":"Using application's *.resx from a generic DLL","body":"<p>I'm creating a generic DLL that creates documents from models and can be used either for winForms or for webForms. It's composed of a main class that I instantiate with certain parameters. \nI'd like my DLL to be able to lookup in the resource files without being tied down to 1 technology.</p>\n\n<p>So to say, I know how to access my resource files (<code>*.resx</code>) in a WebForm :</p>\n\n<pre><code>HttpContext.GetGlobalResourceObject(\"Global\", \"myLabel\")\n</code></pre>\n\n<p>I have a few restrictions :</p>\n\n<ol>\n<li>I don't want to transfer the HttpContext to the DLL as it will tie it to the application</li>\n<li>I don't want to rename the resource files from <code>*.resx</code> to <code>*.resource</code> because they are used in the application</li>\n<li>I don't want to pass all the labels over to the DLL because then my models won't be modifiable as I need</li>\n<li>I'd like to place a marker in my document models that is like this <code>&lt;%resource(Global,myLabel)%&gt;</code></li>\n</ol>\n\n<p>I've been looking at passing the class a resource object using <code>ResourceManager</code> but it never gets hold of my <code>*.resx</code> files.</p>\n\n<p>Does anyone know how to acheive the final goal? Either passing a resource object to the class either picking up the resource object from inside the class.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":36,"score":1,"question_id":13285923,"title":"how to reverse iterate over Queue?","body":"<p><code>foreach</code> loop iterates over <code>Queue</code> starting from the oldest item and ending with newest.\nWhat if I need to start with newest and end with oldest (probably interrupting at some point as in most cases I just need to iterate over several newest items)?</p>\n\n<p>i'm looking for straighforward and efficient solution. without recreating new objects.</p>\n"},{"tags":["c#","asp.net","cell"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13285785,"title":"How do i split an UltraWebGrid cell into two parts","body":"<p>I am getting the data in my ultra webgrid from the database.Now i need to do required formatting of the table.</p>\n\n<p>I get some 'n' numbers of rows in my ultra web grid.Now i need to split the 4th and 5th cell of every row into two parts other than the first row.</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13286344,"title":"Directory.GetFiles with multiple filters, collect one string array","body":"<p>I want to add new item to string array or I can keep in List. Can somebody show how to do this?</p>\n\n<pre><code> string sourceDir = \"C:\\\\Users\\\\ozkan\\\\Desktop\\\\foto\\\\\"\n string[] picList;        \n string pattern = \"*.jpg|*.png|*.gif\";\n string[] filters = pattern.Split('|');\n\n foreach (string filter in filters)\n { \n    // I want to collect all files url in picList\n    // Directory.GetFiles returns string array\n    picList = Directory.GetFiles(sourceDir, filter);           \n }\n</code></pre>\n"},{"tags":["c#","process","32bit-64bit"],"answer_count":5,"favorite_count":8,"up_vote_count":16,"down_vote_count":0,"view_count":10594,"score":16,"question_id":1953377,"title":"How to know a process is 32-bit or 64-bit programmatically","body":"<p>How do I check whether an application/process is running in 32-bit or 64-bit mode? for eg. i will start a process abc.exe. In c# how can we know whether a 32-bit abc.exe is running or a 64-bit one? please help..</p>\n\n<p>It is not the current process.. I am querying for some process 'abc.exe'</p>\n"},{"tags":["c#","nhibernate","database-replication"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":8,"score":2,"question_id":13286429,"title":"Use NHibernate generated sqls to sync with read-only database","body":"<p>I'm trying to leverage a sync mechanism inside my application, I need to provide read-only database throughout my application since my data is not frequently updated (for performance and scalability optimization reasons). I thought I could do this by executing sql inserts and updates generated by NH on the source publisher database to the read-only one (subscriber).</p>\n\n<p>My application is database agnostic, so I wouldn't focus on replication features of each RDBMS.</p>\n\n<p>The question is: Is this a reliable approach, and what's the best lock mechanisms to use in this situation?</p>\n"},{"tags":["c#","boolean","marshalling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13285942,"title":"Different bool size","body":"<p>As <a href=\"http://msdn.microsoft.com/en-us/library/eahchzkf.aspx\" rel=\"nofollow\">MSDN</a> states that <code>sizeof(bool)</code> is <strong>1</strong> byte. But when I put bool in struct , sizeof struct become <strong>4</strong> byte. Can someone explain this behavior?</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct Sample1\n{\n    public bool a1;\n}\n\nint size1 = Marshal.SizeOf(typeof (Sample1));  // 4\nint size2 = sizeof (bool);                     // 1\n</code></pre>\n"},{"tags":["c#",".net","windows","64bit","platform"],"answer_count":23,"favorite_count":35,"up_vote_count":89,"down_vote_count":0,"view_count":51215,"score":89,"question_id":336633,"title":"How to detect Windows 64 bit platform with .net?","body":"<p>In a .net 2.0 C# application I use the following code to detect the operating system platform:</p>\n\n<pre><code>string os_platform = System.Environment.OSVersion.Platform.ToString();\n</code></pre>\n\n<p>This returns \"Win32NT\". The problem is that it returns \"Win32NT\" even when running on Windows Vista 64bit.</p>\n\n<p>Is there any other method to know the correct platform (32 or 64bit)?</p>\n\n<p>Note that it should also detect 64bit when run as 32bit app on Windows 64bit.</p>\n"},{"tags":["c#",".net","asp.net","asp.net-3.5","32bit-64bit"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2078,"score":0,"question_id":5961523,"title":"How to check if client computer is running a 32-bit or 64-bit OS","body":"<p>How to check if client computer is running a 32-bit or 64-bit OS in ASP.NET 3.5?</p>\n"},{"tags":["c#","nhibernate","concurrency","optimistic-locking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13286382,"title":"NHibernate could not synchronize database state with session","body":"<p>I was checking log files of NHibernate, and found out random errors, as below:</p>\n\n<pre><code>NHibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [MaltaIndependent.Modules._AutoGen.MemberImpl#353796206]\n   at NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Persister\\Entity\\AbstractEntityPersister.cs:line 2821\n   at NHibernate.Persister.Entity.AbstractEntityPersister.UpdateOrInsert(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Persister\\Entity\\AbstractEntityPersister.cs:line 2702\n   at NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Int32[] dirtyFields, Boolean hasDirtyCollection, Object[] oldFields, Object oldVersion, Object obj, Object rowId, ISessionImplementor session) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Persister\\Entity\\AbstractEntityPersister.cs:line 3007\n   at NHibernate.Action.EntityUpdateAction.Execute() in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Action\\EntityUpdateAction.cs:line 79\n   at NHibernate.Engine.ActionQueue.Execute(IExecutable executable) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Engine\\ActionQueue.cs:line 136\n   at NHibernate.Engine.ActionQueue.ExecuteActions(IList list) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Engine\\ActionQueue.cs:line 125\n   at NHibernate.Engine.ActionQueue.ExecuteActions() in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Engine\\ActionQueue.cs:line 171\n   at NHibernate.Event.Default.AbstractFlushingEventListener.PerformExecutions(IEventSource session) in c:\\Repository\\Work\\CodeBase\\C#\\+OpenSource\\nHibernate\\nhibernate-core-master-v3.3.1\\src\\NHibernate\\Event\\Default\\AbstractFlushingEventListener.cs:line 241\n</code></pre>\n\n<p>Regarding this issue, I know this happens due to optimistic concurrency and is 'expected' to happen.  My main issue is the stack trace - Nowhere does it state 'where' it happened, and it starts the line <code>NHibernate.Event.Default.AbstractFlushingEventListener.PerformExecution</code>.  I tried downloading the NHibernate source code and taking a look, but couldn't make much sense as to why no complete stack trace is shown.  I have other stack traces for similar errors which take me down to the <code>Transaction.Commit()</code> line.  Any ideas how I can find which piece of code is actually throwing the error?</p>\n"},{"tags":["c#",".net","reflection"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1908,"score":3,"question_id":1784446,"title":"Set Nested Property Values using Reflections","body":"<p>I've searched throughout but can't find the exact answer to my question. Take for instance the following code:</p>\n\n<pre><code>public class Company\n{\n    private string m_strName;\n    private Customer m_objCustomer;\n\n    public Company()\n    {\n    \tm_strName = \"\";\n    \tm_objCustomer = new Customer();\n    }\n\n    public string Name\n    {\n    \tget { return m_strName; }\n    \tset { m_strName = value; }\n    }\n\n    public Customer CustomerInformaion\n    {\n    \tget { return m_objCustomer; }\n    \tset { m_objCustomer = value; }\n    }\n}\n\npublic class Customer\n{\n    private string m_strName;\n    private Details m_objDetails;\n\n\n    public Customer()\n    {\n    \tm_strName = \"\";\n    \tm_objDetails = new Details();\n    }\n\n    public string Name\n    {\n    \tget { return m_strName; }\n    \tset { m_strName = value; }\n    }\n\n    public Details CustomerDetails\n    {\n    \tget { return m_objDetails; }\n    \tset { m_objDetails = value; }\n    }\n}\n\npublic class Details\n{\n    private string m_strPhoneNumber;\n    private string m_strEmailAddress;\n\n    public Details()\n    {\n    \tm_strPhoneNumber = \"\";\n    \tm_strEmailAddress = \"\";\n    }\n\n    public string PhoneNumber\n    {\n    \tget { return m_strPhoneNumber; }\n    \tset { m_strPhoneNumber = value; }\n    }\n\n    public string EmailAddress\n    {\n    \tget { return m_strEmailAddress; }\n    \tset { m_strEmailAddress = value; }\n    }\n}\n</code></pre>\n\n<p>Now, I have setup a Form that has many text fields where a user can enter information about a customer at a company. One of those fields is the Email Address text field that has a Tag property set to EmailAddress. I want to be able to look at the Tag of the TextBox and iterate through the entire Company object to find a property with a matching Name and Set its value to the Text property of the TextBox. I can locate the property but setting its value has turned out to be quite difficult. Here's what I have thus far:</p>\n\n<pre><code>foreach (PropertyInfo info in m_objCompany.GetType().GetProperties())\n{\n    if (info.PropertyType != typeof(System.String))\n    {\n    \tforeach (PropertyInfo info2 in info.PropertyType.GetProperties())\n    \t{\n    \t\tif (objTextBox.Tag.Equals(info2.Name))\n    \t\t{\n    \t\t\tif (info2.CanWrite)\n    \t\t\t{\n    \t\t\t\tObject objValue = Convert.ChangeType(objTextBox.Text, info.PropertyType);\n    \t\t\t\tinfo2.SetValue(m_objCompany, objValue, null);\n    \t\t\t}\n    \t\t}\n\n    \t}\n    }\n}\n</code></pre>\n\n<p>My issue is that when I run the code I receive an error at ChangeType and/or SetValue. The issue is that the Reflection is stopping at info2 and attempting to set the value to the Type of Details - since it is the parent of the Property EmailAddress.</p>\n\n<p>Any help in determining how to point the SetValue to appropriate property would be helpful and appreciated. As I'm sure you well can guess my class is a GREAT deal larger than the example provided with near 100 properties. Most all are string values which will be entered in manually through TextBox objects. I'm attempting to create one routine that can then be called by all TextBox objects whereby the Tag property of the object could be used to indicate which Property of my class I'm trying to set. From there it is off to XML serialization land.</p>\n"},{"tags":["c#",".net","winforms","doevents"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1858,"score":5,"question_id":4977702,"title":"Is Application.DoEvents() just for WinForms?","body":"<p>Is <code>Application.DoEvents()</code> just for forms?</p>\n\n<p>I thought that this command was used to ensure that all of the commands before are processed but now after reading <a href=\"http://msdn.microsoft.com/en/library/system.windows.forms.application.doevents.aspx\">the documentation</a>, I'm not sure anymore.</p>\n"},{"tags":["c#",".net","vb.net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13286044,"title":"Weird Error: System.IO.FileNotFoundException: Could not load file or assembly","body":"<p>I have 2 projects, </p>\n\n<p>The first project C# project where I have a blank form(new project).\nI am compiling this form as a dll so I can reference the form.</p>\n\n<p>The VB project is an ExcelDNA project which consists of a custom task pane with a button to open the form,the task pane works fine.\nHowever, I get the following error when clicking the Button:</p>\n\n<pre><code>System.IO.FileNotFoundException: Could not load file or assembly \n</code></pre>\n\n<p>I can get this to work by creating a UserControl in the VB project, and then accessing it via the Button, however I have the form written in C# already and do not want to convert it to VB.</p>\n"},{"tags":["c#","list","collections","linked-list"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":236,"score":1,"question_id":9021082,"title":"Removing element from list with predicate","body":"<p>I have a list from the .NET collections library and I want to remove a single element. Sadly, I cannot find it by comparing directly with another object.</p>\n\n<p>I fear that using <code>FindIndex</code> and <code>RemoveAt</code> will cause multiple traversals of the list.</p>\n\n<p>I don't know how to use Enumerators to remove elements, otherwise that could have worked.</p>\n\n<p><code>RemoveAll</code> does what I need, but will not stop after one element is found.</p>\n\n<p>Ideas?</p>\n"},{"tags":["c#","performance",".net-3.5"],"answer_count":6,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":125,"score":6,"question_id":13283654,"title":"How to optimize large size for loop","body":"<p>I have a for loop with more than 20k iterations,for each iteration it is taking around two or three seconds and total around 20minutes.  how i can optimize this for loop. I am using .net3.5 so parallel foreach is not possible. so i splited the 200000 nos into small chunks and implemented some threading now i am able reduce the time by 50%. is there any other way to optimize these kind of for loops.</p>\n\n<p>My sample code is given below</p>\n\n<pre><code>    static double sum=0.0;\n    public double AsyncTest()\n    {\n            List&lt;Item&gt; ItemsList = GetItem();//around 20k items\n            int count = 0;\n            bool flag = true;\n            var newItemsList = ItemsList.Take(62).ToList();\n            while (flag)\n            {\n                int j=0;\n                WaitHandle[] waitHandles = new WaitHandle[62];\n                foreach (Item item in newItemsList)\n                {\n                    var delegateInstance = new MyDelegate(MyMethod);\n                    IAsyncResult asyncResult = delegateInstance.BeginInvoke(item.id, new AsyncCallback(MyAsyncResults), null);\n                    waitHandles[j] = asyncResult.AsyncWaitHandle;\n                    j++;\n                }\n                WaitHandle.WaitAll(waitHandles);\n                count = count + 62;\n                newItemsList = ItemsList.Skip(count).Take(62).ToList();  \n            }\n            return sum;\n    }\n\n    public double MyMethod(int id)\n    {\n        //Calculations\n        return sum;\n    }\n\n    static public void MyAsyncResults(IAsyncResult iResult)\n    {\n        AsyncResult asyncResult = (AsyncResult) iResult;\n        MyDelegate del = (MyDelegate) asyncResult.AsyncDelegate;\n        double mySum = del.EndInvoke(iResult);\n        sum = sum + mySum;\n    }\n</code></pre>\n"},{"tags":["c#","visual-studio-2008","installer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13173407,"title":"Build an installer with prerequisite option","body":"<p>I had made project in windows application, now I want to add custom launch condition for SQL Server Compact 3.5.</p>\n\n<p>Can it will done with registry search? can it will done with component id search?</p>\n\n<p>and if yes then how please let me know.</p>\n"},{"tags":["c#",".net","gps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13285964,"title":"Calculate Current Speed in .NET - With GPS","body":"<p>I would like to know what's the best way to calculate the current speed with GPS.\nI've an external GPS receiver which is connected via USB to my car-notebook. It gives me just the following information:\n- Longitude\n- Latitude\n- Altitude</p>\n\n<p>My try is to get two location-infos with timestamps.\nThen I am finding the difference in time (timestamp2 - timestamp1) and calculating the speed (distance/time).</p>\n\n<p>Are there any other possibilites oder maybe any libraries available?</p>\n"},{"tags":["c#",".net","data-binding","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":2793850,"title":"DataBinding to GridView","body":"<p>I Have a gridview object and i want to bind it to Object.. </p>\n\n<p>My Object is</p>\n\n<pre><code>namespace DataBinding\n{\n\npublic class BindingObject\n{\n   public ColorInfo Color { get; set; }\n    public string Name { get; set; }\n\n   public struct ColorInfo {\n        public string Red { get; set; }\n        public string Green { get; set; }\n        public string Blue { get; set; }\n    }\n}\n\n}\n</code></pre>\n\n<p>I want that in the gridview i will see only the Name Property And <strong>Red property</strong>..\nNow when i bound it my gridview see like this: Color column and Name Column and i want  Red column and Name Column..</p>\n\n<p>How i do this..</p>\n\n<p>Thanks..</p>\n\n<p><strong>Update</strong>: ok Thank but if i want to add a set propery.. when i do it: </p>\n\n<pre><code>public string Red { \n  get { return this.Color.Red; } \n  set { this.Color.Red = value; } \n} \n</code></pre>\n\n<p>there is error : </p>\n\n<pre>Error 1 Cannot modify the return value of 'DataBinding.BindingObject.Color' \nbecause it is not a variable</pre>\n\n<p>Thank you for the fast rply</p>\n"},{"tags":["c#","winforms","backgroundworker","thread-pool"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1129,"score":2,"question_id":2501522,"title":".NET Thread Pool - Unresponsive WinForms UI","body":"<h3>Scenario</h3>\n\n<p>I have a Windows Forms Application. Inside the main form there is a loop that iterates around 3000 times, Creating a new instance of a class on a new thread to perform some calculations. Bearing in mind that this setup uses a Thread Pool, the UI does stay responsive when there are only around 100 iterations of this loop (100 Assets to process). But as soon as this number begins to increase heavily, the UI locks up into eggtimer mode and the thus the log that is writing out to the listbox on the form becomes unreadable.</p>\n\n<h3>Question</h3>\n\n<p>Am I right in thinking that the best way around this is to use a Background Worker?\nAnd is the UI locking up because even though I'm using lots of different threads (for speed), the UI itself is not on its own separate thread?</p>\n\n<p>Suggested Implementations greatly appreciated.</p>\n\n<h3>EDIT!!</h3>\n\n<p>So lets say that instead of just firing off and queuing up 3000 assets to process, I decide to do them in batches of 100. How would I go about doing this efficiently? I made an attempt earlier at adding \"Thread.Sleep(5000);\" after every batch of 100 were fired off, but the whole thing seemed to crap out....</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13267721,"title":"LINQ Query - Only get Order and MAX Date from Child Collection","body":"<p>I'm trying to get a list that displays 2 values in a label from a parent and child (1-*) entity collection model.  </p>\n\n<p>I have 3 entities:</p>\n\n<ol>\n<li>[<strong>Customer</strong>]: CustomerId, Name, Address, ...  </li>\n<li>[<strong>Order</strong>]: OrderId, OrderDate, EmployeeId, Total, ... </li>\n<li>[<strong>OrderStatus</strong>]: OrderStatusId, StatusLevel, StatusDate, ...</li>\n</ol>\n\n<p>A <strong>Customer</strong> can have MANY <strong>Order</strong>, which in turn an Order can have MANY <strong>OrderStatus</strong>, i.e. \n[<strong>Customer</strong>] 1--* [<strong>Order</strong>] 1--* [<strong>OrderStatus</strong>]</p>\n\n<p>Given a CustomerId, I want to get all of the Orders (just OrderId) and the LATEST (MAX?) OrderStatus.StatusDate for that Order.</p>\n\n<p>I've tried a couple of attempts, but can seem to get the results I want.</p>\n\n<pre><code>private IQueryable&lt;Customer&gt; GetOrderData(string customerId)\n{\n     var ordersWithLatestStatusDate = Context.Customers\n\n     // Note: I am not sure if I should add the .Expand() extension methods here for the other two entity collections since I want these queries to be as performant as possible and since I am projecting below (only need to display 2 fields for each record in the IQueryable&lt;T&gt;, but thinking I should now after some contemplation.\n\n     .Where(x =&gt; x.CustomerId == SelectedCustomer.CustomerId)\n     .Select(x =&gt; new Custom \n     {\n         CustomerId = x.CustomerId,\n         ...\n         // I would like to project my Child and GrandChild Collections, i.e. Orders and OrderStatuses here but don't know how to do that. I learned that by projecting, one does not need to \"Include/Expand\" these extension methods.  \n     });\n     return ordersWithLatestStatusDate ;\n}\n</code></pre>\n\n<p>---- UPDATE 1 ----</p>\n\n<p>After the great solution from User: <a href=\"http://stackoverflow.com/users/470005/lazyberezovsky\">lazyberezovsky</a>, I tried the following:</p>\n\n<pre><code>var query = Context.Customers\n            .Where(c =&gt; c.CustomerId == SelectedCustomer.CustomerId)\n            .Select(o =&gt; new Customer \n            { \n                Name = c.Name, \n                LatestOrderDate = o.OrderStatus.Max(s =&gt; s.StatusDate) \n            });\n</code></pre>\n\n<p>In my hastiness from my initial posting, I didn't paste everything in correctly since it was mostly from memory and didn't have the exact code for reference at the time.  My method is a strongly-typed IQueryabled where I need it to return a collection of items of type T due to a constraint within a rigid API that I have to go through that has an IQueryable query as one of its parameters. I am aware I can add other entities/attributes by either using the extension methods .Expand() and/or .Select().  One will notice that my latest UPDATED query above has an added \"new Customer\" within the .Select() where it was once anonymous.  I'm positive that is why the query failed b/c it couldn't be turn into a valid Uri due to LatestOrderDate not being a property of Customer at the Server level.  FYI, upon seeing the first answer below, I had added that property to my client-side Customer class with simple { get; set; }.  So given this, can I somehow still have a Customer collection with the only bringing back those 2 fields from 2 different entities?  The solution below looked so promising and ingenious!</p>\n\n<p>---- END UPDATE 1 ----</p>\n\n<p>FYI, the technologies I'm using are OData (WCF), Silverlight, C#.</p>\n\n<p>Any tips/links will be appreciated.</p>\n"},{"tags":["c#","extension-methods"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13286144,"title":"Extension method must be defined in a non-generic static class while extending Task class","body":"<p>I'm trying to extend Task class, but I get two different errors depending how I extend it:\nfirst one:</p>\n\n<pre><code>public class ExtTask : Task\n{\n    public static void DoSomenthing(this Task task)\n    {\n        //some code\n    }\n}\n</code></pre>\n\n<p>Extension method must be defined in a non-generic static class</p>\n\n<p>so I add static:</p>\n\n<pre><code>public static class ExtTask : Task\n{\n    public static void DoSomenthing(this Task task)\n    {\n        //some code\n    }\n}\n</code></pre>\n\n<p>getting error: </p>\n\n<blockquote>\n  <p>Static class 'DownloadFile.ExtTask' cannot derive from type 'System.Threading.Tasks.Task'. Static classes must derive from object.</p>\n</blockquote>\n\n<p>how can I solve this problem?</p>\n"},{"tags":["c#","windows-8","winrt"],"answer_count":1,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":60,"score":7,"question_id":13284526,"title":"In WinRT, static field not initialized at all","body":"<p>I have the code like this</p>\n\n<pre><code>public class SomeClass\n{\n    private static int staticField = 10;\n}\n</code></pre>\n\n<p>The code never gets executed and staticField has default value 0. \nAlso the code causes MVVMlight's SimpleIoc to throw an exception with code like this:</p>\n\n<pre><code>SimpleIoc.Default.Register&lt;SomeClass&gt;();\n</code></pre>\n\n<p>Above code causes MVVMLight to throw an exception saying</p>\n\n<pre><code> Cannot build instance: Multiple constructors found but none marked with PreferredConstructor.\n</code></pre>\n\n<p>This very bizarre. \nI'm using Win8 RTM x64 + VS2012 Express for Windows 8.</p>\n"},{"tags":["c#","excel","charts"],"answer_count":0,"favorite_count":3,"up_vote_count":2,"down_vote_count":2,"view_count":24,"score":0,"question_id":13285997,"title":"replicate this excel chart from C# Excel COM API","body":"<p>I want to automate the process of creating a excel chart directly from my C# application. I want to replicate the following sheet in excel from C#. Currently I produce it manually and this would help save me a lot of time. There are a few features that I want to reproduce from C#:</p>\n\n<ul>\n<li>this data set is simplified as in reality, it is quite huge. So, I want to be able to control the intervals at which I show the x-axis/y-axis time ticks/labels.</li>\n<li>I want to show the labels for horizontal (Level 1/Level 2) lines as shown below but I want to get rid of the labels on the left of those lines. I did not find a way to do this in excel.</li>\n<li>I also want to replicate the coloring and width of lines and gridlines as shown.</li>\n</ul>\n\n<p>In my application, I've the values and times as arrays. This is first time I am looking at charting from C#. I am able to create some simple charts but I am unable to reproduce these features. Any help is much appreciated. cheers.</p>\n\n<p>I will post what I have so far in some time.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x6NjW.png\" alt=\"\"></p>\n"},{"tags":["c#","asp.net","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13273416,"title":"How to get windows username","body":"<p>I am trying to get the windows username on an aspx page.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>&lt;% System.Threading.Thread.CurrentPrincipal = new System.Security.Principal.WindowsPrincipal(System.Security.Principal.WindowsIdentity.GetCurrent()) %&gt;\n&lt;%= System.Threading.Thread.CurrentPrincipal.Identity.Name %&gt;\n</code></pre>\n\n<p>But all that does is give me <em>IIS APPPOOL/SBalance</em>  - which is not the windows username!</p>\n\n<p>However if I add the following server control:</p>\n\n<pre><code>&lt;asp:LoginName ID=\"LoginName1\" runat=\"server\" /&gt;\n</code></pre>\n\n<p>this does successfully pre-populate with my domain and username.</p>\n\n<p>So how can I get the domain/username as a string on the aspx page without using a login control?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","gdi"],"answer_count":4,"favorite_count":1,"up_vote_count":17,"down_vote_count":0,"view_count":591,"score":17,"question_id":4428335,"title":"How to get the exact text margins used by TextRenderer","body":"<p><code>System.Windows.Forms.TextRenderer.DrawText</code> method renders formatted text with or without left and right padding depending on the value of the <code>flags</code> parameter:</p>\n\n<ul>\n<li><code>TextFormatFlags.NoPadding</code> - fits the text tightly into the bounding box,</li>\n<li><code>TextFormatFlags.GlyphOverhangPadding</code> - adds some left and right margins,</li>\n<li><code>TextFormatFlags.LeftAndRightPadding</code> - adds even bigger margins.</li>\n</ul>\n\n<p>Now, my question is <strong>how can I get the exact amount of padding (left and right) added by <code>DrawText</code> to the text</strong> for a given device context, string, font etc?</p>\n\n<p>I've dug into .NET 4 with .NET Reflector and found that TextRenderer calculates \"overhang padding\" which is 1/6 of the font's height and then multiplies this value to calculate left and right margins using these coefficients:</p>\n\n<ul>\n<li>left 1.0, right 1.5 for <code>TextFormatFlags.GlyphOverhangPadding</code>,</li>\n<li>left 2.0, right 2.5 for <code>TextFormatFlags.LeftAndRightPadding</code>.</li>\n</ul>\n\n<p>The resulting values are rounded up and passed to the <code>DrawTextExA</code> or <code>DrawTextExW</code> native API functions. It's difficult to recreate this process because font's height is taken not from <code>System.Drawing.Font</code> but from <code>System.Windows.Forms.Internal.WindowsFont</code> and these classes return different values for the same font. And a lot of other internal BCL classes from the <code>System.Windows.Forms.Internal</code> namespace are involved. Decompiling all of them and reusing their code in my app is not an option, because that would be a serious .NET implementation dependency. That's why I need to know if there is some public API in WinForms or at least which Windows functions I can use to get the values of left and right margins.</p>\n\n<hr>\n\n<p><strong>Note:</strong> I've tried to <code>TextRenderer.MeasureText</code> with and without padding and compare the results but that gave me only the sum of left and right margins and I need them separately.</p>\n\n<hr>\n\n<p><strong>Note 2:</strong> In case you wonder why I need this: I want to draw one string with multiple fonts/colors. That involves calling <code>DrawText</code> once for every uniformly formatted substring with <code>NoPadding</code> option (so that the text doesn't spread) but I also want to add manually normal <code>GlyphOverhangPadding</code> at the very beginning and very end of the whole multi-format text.</p>\n"},{"tags":["c#","fft","wave","spectrum"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":234,"score":0,"question_id":11440371,"title":"Display a frequency spectrum of a FFT data in C#","body":"<p>I have already converted the wave file using FFT, and with the return double array I need to display a spectrum of the transformed data, which will look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/A6iWS.png\" alt=\"example of image spectrum\"></p>\n"},{"tags":["c#","winforms","richtextbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13285371,"title":"c# RichTextBox space between lines","body":"<p>I have a <code>richTextBox</code>-Control where I can insert words via shortcuts like <kbd>ctrl</kbd>+<kbd>1</kbd> = <code>Person</code>. If i type some lines and insert some words via shortcuts then the space between the lines in the <code>richtextbox</code> gets larger. Why is this happening and how can i change this?</p>\n\n<pre><code>private void rtbOnKeyDown(object sender, KeyEventArgs e)\n{\n    if (!e.Modifiers.Equals(Keys.Control)) return;\n    switch (e.KeyCode)\n    {\n        case Keys.D1:\n            rtb.Select(rtb.SelectionStart, 0);\n            rtb.SelectedText = \"Person\";\n            break;\n            //And so on with other key-codes\n    }\n}\n</code></pre>\n"},{"tags":["c#","xml","ms-word","office-interop","docx"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":723,"score":1,"question_id":8544174,"title":"How can we read .docx file using C#?","body":"<p>I want to read a docx File in c#.\nthe docx file when converted to .zip generate the xml of our file.\nI want to read that xml file .\nI need all the data from the doc with ther font name (bold italic setting), color from the file.\nHow can we do this?</p>\n"},{"tags":["c#","facebook","sdk","authorization","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":342,"score":0,"question_id":10431539,"title":"C# Facebook SDK - How to use web forms to server side authorize canvas application","body":"<p>There are lots of sample applications in MVC but the current project I'm working on requires that I use web forms.   </p>\n\n<p>I can authorize the application using the javascript method but I want to use server side.   Below is what I started with on the page.load</p>\n\n<pre><code>dynamic parameters = new ExpandoObject();\nparameters.client_id = AppId;\nparameters.client_secret = appSecret;\nparameters.response_type = \"code\";\n//parameters.state = state;\nparameters.redirect_uri = \"http://fb.local/page.aspx\";\n\n// The requested response: an access token (token), an authorization code (code), or both (code token).\nparameters.response_type = \"token\";\n\n// list of additional display modes can be found at http://developers.facebook.com/docs/reference/dialogs/#display\n//parameters.display = \"popup\";\n\n// add the 'scope' parameter only if we have extendedPermissions.\nif (!string.IsNullOrWhiteSpace(ExtendedPermissions))\nparameters.scope = ExtendedPermissions;\n\n// generate the login url\nvar fb = new FacebookClient();\nvar loginUrl = fb.GetLoginUrl(parameters);\n\nResponse.Redirect(loginUrl.AbsoluteUri, true);\n</code></pre>\n\n<p>I can authorize but I'm  not able to get the access token from the URL.</p>\n\n<p>On the next page I can view source and see the access token in the url bar but I'm not sure how to go about getting it into the code.  once I have the token, I'm all set.</p>\n\n<pre><code>page.aspx#access_token=AAACrxQhmdpY\n</code></pre>\n"},{"tags":["c#","youtube-api","authsub"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13286092,"title":"The application does not follows the link to the AuthSub Google login page","body":"<p>Am using AuthSub for youtube api authentication using .Net. I tried below code for authentication purpose as mentioned in the link <a href=\"https://developers.google.com/gdata/docs/auth/authsub#No-Library\" rel=\"nofollow\">https://developers.google.com/gdata/docs/auth/authsub#No-Library</a>. But my application does not follow the google login page to have the token. Please any one help me to follow google login page, next to my below code.   </p>\n\n<pre><code>String nextUrl = \"http://www.mysite.com/Youtube.aspx\";\nString scope = \"http://gdata.youtube.com/\";\nbool secure = false; // set secure=true to request secure AuthSub tokens\nbool session = true;\nString authSubUrl = AuthSubUtil.getRequestUrl(nextUrl, scope, secure, session);\n</code></pre>\n"},{"tags":["c#",".net","printing","wmi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13285491,"title":"C# Printer connection","body":"<p>I've been trying to find a way to figure out which installed printers are 'connected'. After some Googling I figured I had to dive into WMI.</p>\n\n<p>So I've built this test:</p>\n\n<pre><code>// Struct to store printer data in.\npublic struct MyPrinter \n{ \n    public string Availability; \n    public string ExtendedPrinterStatus; \n    public string Name; \n    public string PrinterStatus; \n    public string Status; \n    public string StatusInfo; \n\n    public MyPrinter(string a, string eps, string n, string ps, string s, string si) \n    { \n        Availability = a; \n        ExtendedPrinterStatus = eps; \n        Name = n; \n        PrinterStatus = ps; \n        Status = s; \n        StatusInfo = si; \n    } \n}\n\n\nvar installedPrinters = new string[numPrinters];\nPrinterSettings.InstalledPrinters.CopyTo(installedPrinters, 0);\n\nvar searcher = new ManagementObjectSearcher(\"SELECT * FROM Win32_Printer\"); \nvar data = new List&lt;MyPrinter&gt;(); \n\nforeach (var printer in searcher.Get()) \n{ \n    if (installedPrinters.Contains(printer[\"Name\"].ToString()))\n    {\n        var availability = (printer[\"Availability\"] ?? \"\").ToString(); \n        var extendedPrinterStatus = (printer[\"ExtendedPrinterStatus\"] ?? \"\").ToString(); \n        var name = (printer[\"Name\"] ?? \"\").ToString(); \n        var printerStatus = (printer[\"PrinterStatus\"] ?? \"\").ToString(); \n        var status = (printer[\"Status\"] ?? \"\").ToString(); \n        var statusInfo = (printer[\"StatusInfo\"] ?? \"\").ToString(); \n\n        data.Add(new MyPrinter(availability, extendedPrinterStatus, name, printerStatus, status, statusInfo)); \n    }\n}\n</code></pre>\n\n<p>I have 6 printers from which 2 are network printers. I've run this with all printers connected and all results looked like this:</p>\n\n<pre><code>Availability = \"\" // printer[\"Availability\"] = null\nExtendedPrinterStatus = \"2\" // 2 = Unknown\nName = \"{printer name here}\"\nPrinterStatus = \"3\" // 3 = Idle\nStatus = \"Unknown\"\nStatusInfo = \"\" // Null\n</code></pre>\n\n<p>So the only difference between the printers is the name.\nI ran the script again but this time I disconnected my laptop from the network. So 2 of the printers were not connected anymore in this case.</p>\n\n<p>The strange thing (for me) is, the results were exactly the same.</p>\n\n<p>The reason I ran this test is, to figure out which field I'd need to use for my case.</p>\n\n<p>So at the end, I have not been able to figure out how to figure out if a printer is connected or not.\nSo what I'd like, is a way to figure out the installed + connected printers in C#. If there is a way to do it without the use of WMI classes, that's also fine by me, as long as it works.</p>\n"},{"tags":["c#","generics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13285924,"title":"how to define the multiple where clauses in generics classes C#","body":"<p>I am wondering why I cant get such simple thing like this on google. This code is not compilable. How can I do this?</p>\n\n<pre><code>public class TestStep&lt;StartEvent, CompletedEvent&gt; \n    where StartEvent : MyBase1, MyInterface1, new() &amp;&amp;\n    where CompletedEvent : MyBase2, MyInterface2, new()\n{\n}\n</code></pre>\n\n<p>Please help.</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":350,"score":2,"question_id":8111217,"title":"2 digit number in c#","body":"<p>A need some help, I have a TextBlock that contains a string like this 00:00:00 And I want to create a timer that will count every second e.g.00:00:01 , 00:00:02 etc</p>\n\n<p>So the stupid thing that I do is to take the value of the text box</p>\n\n<pre><code>string[] times = myTextbox.Text.Split(':');\nint hours = Int32.Parse(times[0]);\nint minutes = Int32.Parse(times[1]);\nint seconds = Int32.Parse(times[2]);\n</code></pre>\n\n<p>Then I increase the right variable and finally I join them again and put them back in the textblock, BUT now my counter is like this: 0:0:1, 0:0:2, ...</p>\n\n<p>I know the problem, its very logical but my question is how can I solve it :)</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["c#","windows-8","google-analytics","winrt","gdata-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13285952,"title":"How to use Google Analytics API on WinRT with C#","body":"<p>I'm developing a C# Windows Store app that has to connect to Google Analytics.</p>\n\n<p>I found the <a href=\"http://code.google.com/p/google-api-dotnet-client/\" rel=\"nofollow\">Google API Client Library For .NET</a>, but it doesn't work under WinRT.</p>\n\n<p>It is possible to create my own wrappers around HttpClient, but I'd rather leave that as a worst-case scenario.</p>\n\n<p>Can you suggest any other solutions for connecting to the API?</p>\n"},{"tags":["c#","asp.net","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13285787,"title":"Error upon inserting data into Access database","body":"<p>I am busy on a school assignment and I have a basic access database that consists of three tables. Book, Reader and BookRated where as BookRated is the intersection table with Primary keys userName from Reader and ISBN from Book make up the composite primary key for BookRated(as foreign keys).</p>\n\n<p>I am trying to insert information into the BookRated table but get the following error</p>\n\n<blockquote>\n  <blockquote>\n    <p>System.Data.OleDb.OleDbException: You cannot add or change a record because a related record is required in table 'Book'.</p>\n  </blockquote>\n</blockquote>\n\n<pre><code>bool added;\n\n    int i;\n    conn = new OleDbConnection(@\"Provider=Microsoft.Jet.OleDb.4.0;\n                                Data Source =\" + Server.MapPath(\"App_Data\\\\BookRateInitial.mdb\"));\n    conn.Open();\n\n    OleDbCommand cmd2 = conn.CreateCommand();\n    cmd2.CommandText = @\"INSERT INTO bookRated([frnISBN], [title], [rating], [review], [frnUserName])\n                      VALUES(@ISBN, @title, @rating, @review, @userName)\";\n        //adding my parameters\n    cmd2.Parameters.AddRange(new OleDbParameter[]\n    {\n        new OleDbParameter(\"@title\", bookTitle),\n        new OleDbParameter(\"@rating\", rating),\n        new OleDbParameter(\"@review\", review), \n        new OleDbParameter(\"@ISBN\", isbn), \n        new OleDbParameter(\"@userName\", userName),\n    });\n    added = true;\n    i = cmd2.ExecuteNonQuery();\n    conn.Close();\n    return added;\n</code></pre>\n\n<p>for now all the values are string.</p>\n\n<p>Any advice perhaps as to where this error comes from?</p>\n"},{"tags":["c#",".net","winforms","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1719,"score":0,"question_id":4693996,"title":"Prevent a WinForms PictureBox animated GIF from pausing during processing?","body":"<p>I have a form with 2 controls on it. Control 1 has several search criteria and the user can click a button to start the search. Control 2 has a GridView that will display the search results and also has a PictureBox with an animated Gif in it.</p>\n\n<p>Control 1 has a method in it that has a nested foreach loop that takes upwards of 5 minutes to complete (depends upon the search criteria, sometimes it finishes almost instantly).</p>\n\n<p>What happens is that I call a method on Control 2 that makes the PictureBox visible and the animated Gif starts running. As soon as the foreach loop is hit that takes a while, the image completely stops. Whenever I show any MessageBoxes the image starts running again (I presume it is because the MessageBox is blocking). As soon as the MessageBox is closed, the image stops animating.</p>\n\n<p>I presume I will need to utilize something with threading, but everything I am trying (ImageAnimator, Thread calling a method that calls Invoke, etc.) all seem to not work. Any hints what events/libraries I need to work with in order to make this work? Any good examples to follow?</p>\n"},{"tags":["c#",".net","security","authentication",".net-4.0"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13285805,"title":"Authenticate google certificate by c# code?","body":"<p>When I browse <em>google.com</em> I can ensure that it is <em>google.com</em> by clicking in the address bar : </p>\n\n<p><img src=\"http://i.stack.imgur.com/1Vr2X.jpg\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/IMjYq.jpg\" alt=\"enter image description here\"></p>\n\n<p>But let's assume google is exposing  <code>Service1</code>, and I - using c# consume this service (wcf) - </p>\n\n<p>How can my service be assure that he is connecting to google.com ? </p>\n\n<p>I know there is a certificate involved here. </p>\n\n<p>I already  <em>know</em> how to read local certificates from my store. but this certificate is not in my store.</p>\n\n<p>Question : </p>\n\n<p>So <strong>How</strong> do ( and in what <strong>stage</strong>) can I read google's certificate data and to assure i'm connecting to them? </p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","internet-explorer","webbrowser-control","session-cookies","xbap"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13267989,"title":"WebBrowser Control inside XBAP application: allow cookies","body":"<p>I have a WebBrowser control (System.Windows.Forms.WebBrowser + WindowsFormsHost) inside XBAP application. The problem is that when I \"Navigate()\" to website that requires cookies and I put my credentials, WebBrowser does not set the \"session\" number parameter in the \"Cookie\" property of the GET (HTTP) method and the login fails. I suspect that the WebBrowser does not accept cookies (or session cookies?). I tried to use IInternetSecurityManager in this way:</p>\n\n<pre><code>    public static bool TryAllowCookies(Uri uri)\n    {\n        IInternetSecurityManager securityManager = (IInternetSecurityManager)new InternetSecurityManager();\n        int policy = 0;\n        Guid context = Guid.Empty;\n\n        int hr = securityManager.ProcessUrlAction(uri.ToString(),\n                                     URLACTION_COOKIES_SESSION | URLACTION_COOKIES_ENABLED | URLACTION_COOKIES |\n                     URLACTION_COOKIES_SESSION_THIRD_PARTY | URLACTION_COOKIES_THIRD_PARTY,\n                     ref policy,\n                     Marshal.SizeOf(policy),\n                     ref context,\n                     Marshal.SizeOf(context),\n                     PUAF_DEFAULT, 0);\n\n                     return (hr == 0) &amp;&amp; policy == URLPOLICY_ALLOW;\n    }\n</code></pre>\n\n<p>ProcessUrlAction returs always True, but does not work.</p>\n\n<p>I found no complete example of how to use IInternetSecurityManager with WebBrowser control. \nThe same control instead in a windows form application works perfectly.</p>\n\n<p>HTTP sniffing:</p>\n\n<p>WEBBROWSER FROM XBAP APPLICATION (NOT WORKS):</p>\n\n<pre><code>GET /cgi-bin/xxx.xxx HTTP/1.1\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-xpsdocument, application/x-ms-application, application/x-ms-xbap, application/xaml+xml, application/msword, application/vnd.ms-powerpoint, application/vnd.ms-excel, */*\nReferer: http://xxx.xxx.xxx.xxx/cgi-bin/yyy.yyy\nAccept-Language: it\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0E; .NET4.0C; InfoPath.2)\nHost: xxx.xxx.xxx.xxx\nConnection: Keep-Alive\nCookie: language=it; user=smith\n</code></pre>\n\n<p>WEBBROWSER FROM WINDOWS FORM APPLICATION (WORKS)</p>\n\n<pre><code>GET /cgi-bin/xxx.xxx HTTP/1.1\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-xpsdocument, application/x-ms-application, application/x-ms-xbap, application/xaml+xml, application/msword, application/vnd.ms-powerpoint, application/vnd.ms-excel, */*\nReferer: http://xxx.xxx.xxx.xxx/cgi-bin/yyy.yyy\nAccept-Language: it\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0E; .NET4.0C; InfoPath.2)\nHost: xxx.xxx.xxx.xxx\nConnection: Keep-Alive\nCookie: language=en; user=smith; session=2a9cffb0babea74e3432fc9805470faa; current_page=\n</code></pre>\n\n<p>thank you,\nRiccardo</p>\n"},{"tags":["c#","silverlight"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13285061,"title":"Sent a post request, but the response was sent that comes Get request","body":"<p>I have a string, the string I write to the stream and try to send to the server. In response comes everything is OK, but the type of request is \"Get\"(variable respons, method ReadCallbackSavePlayersfun1). Please tell me what's wrong</p>\n\n<pre><code>public void Fun1()\n\n{\n\nstring str = \"Hello Word!!!\";\n\nusing (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Create))\n\n{\n                StreamWriter w = new StreamWriter(file,Encoding.UTF8);\n                w.WriteLine(str);\n                 _cookies = DataHolder.Instance.Cookies;\n\n                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(String.Concat(\"http://Mysite.com/image.php\"));\n                string boundary = \"----------\" + DateTime.UtcNow.Ticks.ToString(\"x\", CultureInfo.InvariantCulture);\n                request.Method = \"POST\";\n                request.ContentType = \"multipart/form-data; boundary=\" + boundary;\n                request.CookieContainer = _cookies;\n\n\n                request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallbackPlayersfun1), request);\n                w.Close();\n\n             }\n\n}\n\n\n private void GetRequestStreamCallbackPlayersfun1(IAsyncResult asynchronousResult)\n\n {\n\n        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n        Stream postStream = request.EndGetRequestStream(asynchronousResult);\n string boundary = \"----------\" + DateTime.UtcNow.Ticks.ToString(\"x\", CultureInfo.InvariantCulture);\n        var sbHeader = new StringBuilder();\n        if (file != null)\n\n {\n            sbHeader.AppendFormat(\"--{0}\\r\\n\", boundary);\n            sbHeader.AppendFormat(\"Content-Disposition: form-data; name=\\\"{0}\\\"; filename=\\\"{1}\\\"\\r\\n\", \"picture\", file);\n            sbHeader.AppendFormat(\"Content-Type: {0}\\r\\n\\r\\n\", request.ContentType);\n\n}\n        using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Open))\n\n{\n            byte[] header = Encoding.UTF8.GetBytes(sbHeader.ToString());\n            byte[] footer = Encoding.UTF8.GetBytes(\"\\r\\n--\" + boundary + \"--\\r\\n\");\n            long contentLength = header.Length + (file != null ? file.Length : 0) + footer.Length;\n\n            postStream.Write(header, 0, header.Length);\n if (file != null)\n\n{\n\n\n                BinaryReader br = new BinaryReader(file, Encoding.UTF8);\n                byte[] buffer = br.ReadBytes(2048);\n                while (buffer.Length &gt; 0)\n\n{\n                    postStream.Write(buffer, 0, buffer.Length);\n                    buffer = br.ReadBytes(2048);\n\n }\n                br.Close();\n\n\n}\n\n            postStream.Write(footer, 0, footer.Length);\n            postStream.Flush();\n            postStream.Close();\n}\n\n request.BeginGetResponse(new AsyncCallback(ReadCallbackSavePlayersfun1), request);\n\n\n}\n\n  private void ReadCallbackSavePlayersfun1(IAsyncResult asynchronousResult)\n\n{\n            lock (__SYNC)\n\n{\n                HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n                HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);\n\n                try\n\n{\n                    String doc = \"\";\n                    using (Stream streamResponse = response.GetResponseStream())\n\n {\n                        Encoding encode = System.Text.Encoding.GetEncoding(\"utf-8\");\n                        StreamReader readStream = new StreamReader(streamResponse, encode);\n                        Char[] read = new Char[256];  \n                        int count = readStream.Read(read, 0, 256);\n                        while (count &gt; 0)\n\n{\n                            String str = new String(read, 0, count);\n                            doc += str;\n                            count = readStream.Read(read, 0, 256);\n\n}\n\n}\n\n\n}\n                catch \n{ }\n\n}\n\n}\n</code></pre>\n"},{"tags":["c#","logging","asmx"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":371,"score":2,"question_id":5099827,"title":"Logging for C# Webservices","body":"<p>We are consuming web services. We use wsdl.exe to generate the client proxy.</p>\n\n<p>How do we keep all the underlying XML files the proxy sends to and receives from the web services provider? </p>\n\n<p>The purpose is to protect ourselves by showing we did have send all the parameters in good format when system malfunctions and disputes arise.</p>\n"},{"tags":["c#","wcf","xsd","wsdl","svcutil.exe"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13285836,"title":"WCF and inheritance with the XSD extension element","body":"<p>I am trying to use the XSD <a href=\"http://www.w3schools.com/schema/el_extension.asp\" rel=\"nofollow\">extension</a> element to define a base-type for my WCF in the WSDL. The idea is to have a base type, which all other messages inherit from.</p>\n\n<p>My XSD definition for the base class:</p>\n\n<pre><code>&lt;complexType name=\"MyMessageBase\"&gt;\n  &lt;sequence&gt;\n    &lt;element name=\"TimeStamp\" type=\"dateTime\" /&gt;\n    &lt;element name=\"UserID\" type=\"int\" /&gt;\n  &lt;/sequence&gt;\n&lt;/complexType&gt;    \n</code></pre>\n\n<p>The request and response messages deriving from the base class:</p>\n\n<pre><code>&lt;element name=\"MyMessageRequest\"&gt;\n  &lt;complexType&gt;\n    &lt;complexContent&gt;\n      &lt;extension base=\"tns:MyMessageBase\"&gt;\n        &lt;sequence&gt;\n          &lt;element name=\"MyInput\" type=\"string\" /&gt;\n        &lt;/sequence&gt;\n      &lt;/extension&gt;\n    &lt;/complexContent&gt;\n  &lt;/complexType&gt;\n&lt;/element&gt;\n&lt;element name=\"MyMessageResponse\"&gt;\n  &lt;complexType&gt;\n    &lt;complexContent&gt;\n      &lt;extension base=\"tns:MyMessageBase\"&gt;\n        &lt;sequence&gt;\n          &lt;element name=\"MyOutput\" type=\"boolean\" /&gt;\n        &lt;/sequence&gt;\n      &lt;/extension&gt;\n    &lt;/complexContent&gt;\n  &lt;/complexType&gt;\n&lt;/element&gt; \n</code></pre>\n\n<p>I run SvcUtil on my WSDL and end up with the following:</p>\n\n<pre><code>[MessageContract(\n    WrapperName=\"MyMessageRequest\",\n    WrapperNamespace=\"http:/localhost/MyService/MyCall\", \n    IsWrapped=true)]\npublic partial class MyMessageRequest\n{  \n    public MyMessageRequest()\n    {\n    }\n}\n\n[MessageContract(\n    WrapperName=\"MyMessageResponse\",\n    WrapperNamespace=\"http://localhost/MyService/MyCall\", \n    IsWrapped=true)]\npublic partial class MyMessageResponse\n{\n    public MyMessageResponse()\n    {\n    }\n}\n</code></pre>\n\n<p>Is there any way to actually create base classes from a WSDL using SvcUtil?</p>\n"},{"tags":["c#","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":13266580,"title":"Complex Linq c# query","body":"<p>I tried this in LinqPad</p>\n\n<p>I have the following data and linq query which should return only 1 record and 2 images but returns 2 records and 4 images. </p>\n\n<p>I know i have something wrong but don't know what. I am looking for the users details + car details + images fro user: 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 </p>\n\n<p>It has something to do with the bids as when I delete one of he bids for user (0b3c2ba5-1538-4557-a6c0-7de701fd83e7 ) i then get 1 record and 2 images</p>\n\n<p><strong>TABLES<br>\n------</strong> </p>\n\n<h2>TABLE bids</h2>\n\n<pre><code>id      cardid  bidamount   dateplaced          usedid  \n\n43  83  625 2012-11-05 16:12:51.600 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n44  86  575 2012-11-05 16:15:02.257 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n45  83  650 2012-11-05 16:15:07.283 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n46  86  600 2012-11-05 17:45:04.140 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n47  86  625 2012-11-05 17:45:08.867 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n49  83  750 2012-11-07 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7  \n52  83  850 2012-11-08 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 \n</code></pre>\n\n<h2>TABLE userdetails</h2>\n\n<pre><code>userid                                  city    state  \n0b3c2ba5-1538-4557-a6c0-7de701fd83e7    Sydney  NSW  \n</code></pre>\n\n<h2>TABLE cars</h2>\n\n<pre><code>id  name     descr   listingOption priceStarting priceReserve  \n83  Valiant  Old Car     2              1000         1500  \n86  Volvo    Safe Car    3              3000         4500 \n</code></pre>\n\n<h2>TABLE auction_images</h2>\n\n<pre><code>id         image                                              belongs_to  \n71  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  83  \n72  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   83  \n75  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  86  \n76  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   86  \n</code></pre>\n\n<p><strong>QUERY\n-----</strong></p>\n\n<pre><code> var query = (from c in cars\n                         from ud in users_details\n                         from bd in bids\n                         orderby c.listingOption descending\n                         where a.userID == ud.userid\n                        &amp;&amp; c.id == bd.carID\n                        &amp;&amp; c.enabled == true\n                        &amp;&amp; bd.userID == new Guid(\"0b3c2ba5-1538-4557-a6c0-7de701fd83e7\")\n                         let images = from ai in auction_images\n                                      where ai.belongs_to == c.id\n                                      select ai\n\n                         let bid = (from b in bids\n                                    orderby b.id descending\n                                    where b.carID == c.id\n                                    select b.bidamount).FirstOrDefault()\n                         select\n                         new\n                         {\n                             images,\n                             bidamount = (bid != null ? bid : 0),\n                             ud.city,\n                             ud.state,\n                             c.name,\n                             c.descr,\n                             c.id,\n                             c.listingOption,\n                             c.priceStarting,\n                             c.priceReserve,\n                             bd.userID\n                         }\n                         );\n\nquery.Distinct().Dump();\n</code></pre>\n"},{"tags":["c#","wpf",".net-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13285299,"title":"ObservableCollection or IEnumerable?","body":"<p>Which is faster ObservableCollection or IEnumerable to load a listbox?</p>\n\n<p>I am currently using an IEnumerable as the ItemSource of the Listbox.</p>\n\n<p>Will it have any impact on the performance if I change this to ObservableCollection, if it is even possible?</p>\n"},{"tags":["c#","asp.net","web-services","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13285773,"title":"does vs2012 load test make a loop in a webtest parallel?","body":"<p>I have created a webtest that call a web-service with changing id in its query string.</p>\n\n<p>I don't manage to execute 1000 parallel calls using load test </p>\n\n<p>(in the summary it shows that only 100 calls were created)</p>\n\n<p>If I create a loop inside the webtest, </p>\n\n<p>will it be parallalized by the load 1000 virtual users?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc-3"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":44,"score":-1,"question_id":13285240,"title":"How to display number to 2 decimal places in mvc3,C#?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6951335/using-string-format-to-show-decimal-upto-2-places-or-simple-integer\">Using String Format to show decimal upto 2 places or simple integer</a><br>\n  <a href=\"http://stackoverflow.com/questions/13284682/how-to-set-decimal-point-in-2-decimal-places\">How to set decimal point in 2 decimal places?</a>  </p>\n</blockquote>\n\n\n\n<p>I have Price field in my view. it have the following values <code>2.5 and 44.</code>\nI want to display this value to <code>2.50 and 44.00</code> i use the following code</p>\n\n<pre><code>@{decimal prolistprice = decimal.Parse(item.OtherFields[\"Price\"].ToString());}\n  $@Math.Round(prolistprice, 2, MidpointRounding.AwayFromZero)\n</code></pre>\n\n<p>in which <code>item.OtherFields[\"price\"] is a object</code> i convert it to string and then decimal</p>\n\n<p>but Math.round is not working it shows 2.5 and 44 only..\nCan anyone help this</p>\n"},{"tags":["c#","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":564,"score":4,"question_id":2737091,"title":"Accept any certificate for SSL","body":"<p>I have small TcpClient app to connect to a server using SSL (SSlStream class)</p>\n\n<p>My question is, how to accept any ssl certification when connecting?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","web-services"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":5097,"score":1,"question_id":2622003,"title":"Call Webservice without adding a WebReference - with Complex Types","body":"<p>I'm using the code at <a href=\"http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=4750&amp;lngWId=10\" rel=\"nofollow\">This Site</a> to call a webservice dynamically.</p>\n\n<pre><code>[SecurityPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]\n    public static object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n    {\n        System.Net.WebClient client = new System.Net.WebClient();\n        //-Connect To the web service\n        using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n        {\n            //--Now read the WSDL file describing a service.\n            ServiceDescription description = ServiceDescription.Read(stream);\n            ///// LOAD THE DOM /////////\n            //--Initialize a service description importer.\n            ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n            importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n            importer.AddServiceDescription(description, null, null);\n            //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n            //--Generate properties to represent primitive values.\n            importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n            //--Initialize a Code-DOM tree into which we will import the service.\n            CodeNamespace nmspace = new CodeNamespace();\n            CodeCompileUnit unit1 = new CodeCompileUnit();\n            unit1.Namespaces.Add(nmspace);\n            //--Import the service into the Code-DOM tree. This creates proxy code\n            //--that uses the service.\n            ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n            if (warning == 0) //--If zero then we are good to go\n            {\n                //--Generate the proxy code \n                CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n                //--Compile the assembly proxy with the appropriate references\n                string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n                CompilerParameters parms = new CompilerParameters(assemblyReferences);\n                CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n                //-Check For Errors\n                if (results.Errors.Count &gt; 0)\n                {\n                    StringBuilder sb = new StringBuilder();\n                    foreach (CompilerError oops in results.Errors)\n                    {\n                        sb.AppendLine(\"========Compiler error============\");\n                        sb.AppendLine(oops.ErrorText);\n                    }\n                    throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n                }\n                //--Finally, Invoke the web service method \n                Type foundType = null;\n                Type[] types = results.CompiledAssembly.GetTypes();\n                foreach (Type type in types)\n                {\n                    if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                    {\n                        Console.WriteLine(type.ToString());\n                        foundType = type;\n                    }\n                }\n\n                object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n                MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n                return mi.Invoke(wsvcClass, args);\n            }\n            else\n            {\n                return null;\n            }\n        }\n    }\n</code></pre>\n\n<p>This works fine when I use built in types, but for my own classes, I get this:</p>\n\n<pre><code>Event Type: Error\nEvent Source:   TDX Queue Service\nEvent Category: None\nEvent ID:   0\nDate:       12/04/2010\nTime:       12:12:38\nUser:       N/A\nComputer:   TDXRMISDEV01\nDescription:\nSystem.ArgumentException: Object of type 'TDXDataTypes.AgencyOutput' cannot be converted to type 'AgencyOutput'.\n\nServer stack trace: \n   at System.RuntimeType.CheckValue(Object value, Binder binder, CultureInfo culture, BindingFlags invokeAttr)\n   at System.Reflection.MethodBase.CheckArguments(Object[] parameters, Binder binder, BindingFlags invokeAttr, CultureInfo culture, Signature sig)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)\n   at TDXQueueEngine.GenericWebserviceProxy.CallWebService(String webServiceAsmxUrl, String serviceName, String methodName, Object[] args) in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\GenericWebserviceProxy.cs:line 76\n   at TDXQueueEngine.TDXQueueWebserviceItem.Run() in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueWebserviceItem.cs:line 99\n   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.PrivateProcessMessage(RuntimeMethodHandle md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)\n   at System.Runtime.Remoting.Messaging.StackBuilderSink.AsyncProcessMessage(IMessage msg, IMessageSink replySink)\n\nException rethrown at [0]: \n   at System.Runtime.Remoting.Proxies.RealProxy.EndInvokeHelper(Message reqMsg, Boolean bProxyCase)\n   at System.Runtime.Remoting.Proxies.RemotingProxy.Invoke(Object NotUsed, MessageData&amp; msgData)\n   at TDXQueueEngine.TDXQueue.RunProcess.EndInvoke(IAsyncResult result)\n   at TDXQueueEngine.TDXQueue.processComplete(IAsyncResult ar) in C:\\CkAdmDev\\TDXQueueEngine\\TDXQueueEngine\\TDXQueueEngine\\TDXQueue.cs:line 130\n\nFor more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n</code></pre>\n\n<p>The classes reference the same assembly and the same version.  Do I need to include my assembly as a reference when building the temporary assembly?  If so, how?</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>It appears that the best solution will be to build a routine that can map from <code>AssemblyX.MyCustomType</code> to an equivalent <code>GeneratedAssembly.MyCustomType</code>.</p>\n\n<p>In my example, <code>MyCustomType</code> contains more types (which should all be part of the generated assembly) so it appears I need a method to do this \"deep copy\".  Also, some of the properties of the TDXDataTypes.AgencyOutput are arrays of other classes, just to make things more fun...</p>\n\n<p>I've created a <a href=\"http://stackoverflow.com/questions/2646578/using-automapper-to-dynamically-map-objects-including-arrays\">new question</a> for the mapping.</p>\n"},{"tags":["c#","exception","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13269215,"title":"Is there a way I can send a stack trace to the console in C# with VS2012","body":"<p>I have C# code that's giving an exception. I have the code within a try - catch and I can see the exception but I am having a problem viewing it in VS2012. Is there a way I can send a stack trace to the console so I can look without having to right click on properties of the exception? </p>\n\n<p>Even better does anyone have any code they use to log out more detailed information to the console?</p>\n"},{"tags":["c#","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13279439,"title":"String Manipulation Using RegEx","body":"<p>Given the following scenario, I am wondering if a better solution could be written with Regular Expressions for which I am not very familiar with yet.  I am seeing holes in my basic c# string manipulation even though it somewhat works.  Your thoughts and ideas are most appreciated.</p>\n\n<p>Thanks much,</p>\n\n<p>Craig</p>\n\n<p>Given the string \"story\" below, write a script to do the following:</p>\n\n<ol>\n<li>Variable text is enclosed by <code>{ }</code>.</li>\n<li>If the variable text is blank, remove any other text enclosed in <code>[ ]</code>.</li>\n<li>Text to be removed can be nested deep with <code>[ ]</code>.</li>\n</ol>\n\n<p>Format:</p>\n\n<pre><code>    XYZ Company [- Phone: [({404}) ]{321-4321} [Ext: {6789}]]\n</code></pre>\n\n<p>Examples:</p>\n\n<ol>\n<li><p>All variable text filled in.</p>\n\n<pre><code>XYZ Company - Phone: (404) 321-4321 Ext: 6789\n</code></pre></li>\n<li><p>No Extension entered, remove \"Ext:\".</p>\n\n<pre><code>XYZ Company - Phone: (404) 321-4321\n</code></pre></li>\n<li><p>No Extension and no area code entered, remove \"Ext:\" and \"( ) \".</p>\n\n<pre><code>XYZ Company - Phone: 321-4321\n</code></pre></li>\n<li><p>No extension, no phone number, and no area code, remove \"Ext:\" and \"( ) \" and \"- Phone: \".</p>\n\n<pre><code>XYZ Company\n</code></pre></li>\n</ol>\n\n<p>Here is my solution with plain string manipulation.</p>\n\n<pre><code>private string StoryManipulation(string theStory)\n    {\n        // Loop through story while there are still curly brackets\n        while (theStory.IndexOf(\"{\") &gt; 0)\n        {\n            // Extract the first curly text area\n            string lcCurlyText = StringUtils.ExtractString(theStory, \"{\", \"}\");                \n\n            // Look for surrounding brackets and blank all text between\n            if (String.IsNullOrWhiteSpace(lcCurlyText))\n            {\n                for (int lnCounter = theStory.IndexOf(\"{\"); lnCounter &gt;= 0; lnCounter--)\n                {\n                    if (theStory.Substring(lnCounter - 1, 1) == \"[\")\n                    {\n                        string lcSquareText = StringUtils.ExtractString(theStory.Substring(lnCounter - 1), \"[\", \"]\");\n                        theStory = StringUtils.ReplaceString(theStory, (\"[\" + lcSquareText + \"]\"), \"\", false);\n                        break;\n                    }\n                }\n            }\n            else\n            {\n                // Replace current curly brackets surrounding the text\n                theStory = StringUtils.ReplaceString(theStory, (\"{\" + lcCurlyText + \"}\"), lcCurlyText, false);\n            }\n        }\n        // Replace all brackets with blank (-1 all instances)\n        theStory = StringUtils.ReplaceStringInstance(theStory, \"[\", \"\", -1, false);\n        theStory = StringUtils.ReplaceStringInstance(theStory, \"]\", \"\", -1, false);\n        return theStory.Trim();\n    }\n</code></pre>\n"},{"tags":["c#","asp.net","web-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13285643,"title":"Auto click on button from different site","body":"<p>How to perform an auto click on specific button on web page? The page contains more than 1 buttons and i want to click only one button from that page. For example, Google page has many buttons/links(web, images, maps, shopping, etc). So, from this google example, let say i just want an auto click for images links only. How can i do this?<br>\nThere is a text for the button/links and searchable using find function(CTRL+F-windows). So, maybe i can do a search function and perfrom the click action. <br></p>\n\n<p>The button is handled by javascript as i can see from page source(javascript:set_action(4))</p>\n\n<p>Note: The auto click function and the button is not in the same website(im not the developer for the target page). So, the site where the auto click function reside should make a request to page where the button is.</p>\n"},{"tags":["c#","string","homework","char"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":445,"score":0,"question_id":8086883,"title":"How to find the number of occurrences of a letter in only the first sentence of a string?","body":"<p>I want to find number of letter \"a\" in only first sentence. The code below finds \"a\" in all sentences, but I want in only first sentence.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    string text;  int k = 0;\n    text = \"bla bla bla. something second. maybe last sentence.\";\n\n    foreach (char a in text)\n    {\n        char b = 'a';\n        if (b == a)\n        {\n            k += 1;\n        }\n    }\n\n    Console.WriteLine(\"number of a in first sentence is \" + k);\n    Console.ReadKey();\n}\n</code></pre>\n"},{"tags":["c#","windows-xp","event-log"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13282957,"title":"Read xml from event log in Windows Event Viewer on Windows XP with C#","body":"<p>How do I get the xml from a specific event log entry using C# on Windows XP? I already know the event log type (Security) and the event entry id.</p>\n\n<p>EventLogWatcher and other classes are Vista+ only...</p>\n"},{"tags":["c#",".net","api","windows-services","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13285403,"title":"Cancel HTTPWebRequest when server goes down","body":"<p>I have created a Windows Service that calls a API (that returns JSON) with HTTPWebRequest.</p>\n\n<p>The API doesn't return anything until it has something to \"deliver\". So I set the timeout quite high and lets the request wait until it receivs a response.</p>\n\n<p>The problem is that when I test to turn off or disconnect the server running the API. The HTTPWebRequest doesn't stop the request. So I can't know if the API server has gone down.</p>\n\n<p>The request code:</p>\n\n<pre><code>HttpWebRequest Request = (HttpWebRequest)HttpWebRequest.Create(Url);\nRequest.Method = \"POST\";\nRequest.ContentType = \"application/x-www-form-urlencoded\";\nRequest.ContentLength = PostData.Length;\nRequest.Timeout = Timeout;\nRequest.KeepAlive = true;\nusing (StreamWriter sw = new StreamWriter(Request.GetRequestStream()))\n{\n    sw.Write(PostData);\n}\nusing (HttpWebResponse Response = (HttpWebResponse)Request.GetResponse())\n{\n    using (StreamReader sr = new StreamReader(Response.GetResponseStream()))\n    {\n        ResponseText = sr.ReadToEnd();\n    }\n}\n</code></pre>\n\n<p>Is there anyway to \"break\" the request when the requested server goes down?\nI have tried using the webbrowser to call the API server and after a while disconnect it and that return an error to the webpage.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13285376,"title":"Convert 64base byte array to PDF and show in webBroswer compont","body":"<p>This is what i would like to do:</p>\n\n<p>Get a 64base byte array from database (which is actually in pdf format). This works.\nThen i would like to show the pdf in a webbrowser component. </p>\n\n<p>I first started with saving the pdf to a file.pdf and then open it:</p>\n\n<pre><code>        byte[] bitjes = isc.GetFileById(fileid); // Getting the bytes\n\n        FileStream stream = new FileStream(@\"C:\\NexusPDF\\\" + filename, FileMode.CreateNew);\n        BinaryWriter writer = new BinaryWriter(stream);\n        writer.Write(bitjes, 0, bitjes.Length);\n        writer.Close();\n\n        webBrowser.Navigate(@\"C:\\NexusPDF\\\" + filename);\n</code></pre>\n\n<p>But that gave me all sorts of problems involving read/write acces. So i figured i have to use the memorystream class to solve this problem.</p>\n\n<pre><code>        byte[] bitjes = isc.GetFileById(fileid);\n\n        MemoryStream memstream = new MemoryStream(bitjes);\n\n        BinaryWriter writer = new BinaryWriter(memstream);\n        writer.Write(bitjes, 0, bitjes.Length);\n        writer.Close();\n</code></pre>\n\n<p>But here's where i'm stuck! I can't just show this in a webBrowser component can i?\nDo i have to use the binaryreader before i can show the pdf?</p>\n\n<p>Am i approaching this problem the right way, or are there better alternatives?</p>\n\n<p>Main thing is that i don't want to save the file on disk.</p>\n\n<p>Any help will be appreciated.</p>\n"},{"tags":["c#","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":34,"score":4,"question_id":13285309,"title":"Serialize to XML non-nested repeating sequence","body":"<p>I need to serialize to an array which has multiple non-nested values i.e.</p>\n\n<pre><code> &lt;MyArray&gt;\n    &lt;Code&gt;code1&lt;/Code&gt;\n    &lt;Name&gt;name associated with code 1&lt;/Name&gt;\n    &lt;Code&gt;code2&lt;/Code&gt;\n    &lt;Name&gt;name associated with code 2&lt;/Name&gt;\n    &lt;Code&gt;code3&lt;/Code&gt;\n    &lt;Name&gt;name associated with code 3&lt;/Name&gt;\n    &lt;Code&gt;code4&lt;/Code&gt;\n    &lt;Name&gt;name associated with code 4&lt;/Name&gt;\n  &lt;/MyArray&gt;\n</code></pre>\n\n<p>I've tried various attributes on my array - e.g.</p>\n\n<pre><code>[XmlArray(ElementName=\"MyArray\")]        \n[XmlArrayItem(ElementName=\"\")]        \npublic List&lt;MyPair&gt; MyPairs { get; set; }\n</code></pre>\n\n<p>NB: the MyPair object contains 2 string properties (Code &amp; Name):</p>\n\n<p>but to no avail, I always get a containing element for each pair (which would normally be better but not what the schema demands - and over which I've no control). Any help greatly appreciated.</p>\n\n<p><strong>EDIT</strong> This is part of a huge xml document, is it possible to use manual serialization of XElement for 1 part of it and XMLSerialization for the rest?</p>\n"},{"tags":["c#",".net","unit-testing","sockets","tdd"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13283480,"title":"How to write unit test for asynchronous (socket) code that includes ManualResetEvent.WaitOne()?","body":"<p>I am playing around with a socket server and try to work according to the Test Driven Development pattern.</p>\n\n<p>There's a working test for the socket creation method, but my test hangs due to the fact that I have a ManualResetEvent.WaitOne() so that my socket waits for a connection before creating another one.</p>\n\n<p>Here's the code block to test:</p>\n\n<pre><code>ManualResetEvent allDone = new ManualResetEvent(false);\npublic void StartListening()\n{\n    allDone.Reset();\n\n    //Inform on the console that the socket is ready\n    Console.WriteLine(\"Waiting for a connection...\");\n\n    /* Waits for a connection and accepts it. AcceptCallback is called and the actual\n     * socket passed as AsyncResult\n     */\n    listener.BeginAcceptTcpClient(\n        new AsyncCallback(AcceptCallback),\n        listener);\n\n    allDone.WaitOne();\n}\n</code></pre>\n\n<p>And here's the test method which hangs at \"networkChannel.StartListening();</p>\n\n<pre><code>[TestMethod]\npublic void NetworkChannel_IsAcceptingConnectionsAsynchronously()\n{\n    ITcpClient client = MockRepository.GenerateMock&lt;ITcpClient&gt;();\n    ITcpListener listener = MockRepository.GenerateMock&lt;ITcpListener&gt;();\n    IAsyncResult asyncResult = MockRepository.GenerateMock&lt;IAsyncResult&gt;();\n\n    listener.Expect(x =&gt; x.BeginAcceptTcpClient(null, null)).IgnoreArguments().Return(asyncResult);\n    listener.Expect(x =&gt; x.EndAcceptTcpClient(asyncResult)).Return(client);\n\n    NetworkChannel networkChannel = new NetworkChannel(listener);\n\n    networkChannel.StartListening();\n    //Some more work... fake callback etc., verfify expectations,...\n}\n</code></pre>\n\n<p>If I comment all the manualresetevents, the test passes just fine but this cannot be the solution because the server tries to create duplicate sockets continuously ;-)</p>\n\n<p>Any hints for me? Would be very much appreciated!</p>\n\n<p>Regards,\nMartin</p>\n"},{"tags":["c#","progress-bar","invoke"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13285538,"title":"c# updating progressbar and label with invoke","body":"<p>I have this problem: in my form I have a progressbar and a label, my goal is to show the progress of a download and into the label the count of the bytes.\ndue to the fact that the values are from a backgroundworker I use this code:</p>\n\n<pre><code>void WebClient_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)\n{\n    string sFormatted = string.Format(\"{0} of {1}\", e.BytesReceived, e.TotalBytesToReceive);\n\n    Invoke(new MethodInvoker(delegate\n    {\n        myProgressBar.Value = e.ProgressPercentage;\n        myLabel.Text = sFormatted;\n    }));\n}\n</code></pre>\n\n<p>and this code work fine, but the progressbar is refreshed after a while, and the label is refreshed correctly:</p>\n\n<p>for example: I have 10000 bytes to download, I have downloaded 5000, the label shows correctly 5000 of 10000, but the bar is like 30% not 50...</p>\n\n<p>how can I solve this?</p>\n\n<p>thanks in advance</p>\n"},{"tags":["c#","linq",".net-4.0"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":69,"score":6,"question_id":13284933,"title":"Linq ( fluent !) Max with default value?","body":"<p>I have this code: </p>\n\n<pre><code>     List&lt;int&gt; l  = new List&lt;int&gt;();\n    //l.Add(1);\n\n     var m = l.Max();\n     console.write(m);\n</code></pre>\n\n<p>I want that if there is no elements - so use int's default (0).</p>\n\n<p>This raises an exception: <code>Sequence contains no elements</code></p>\n\n<p>Of course I can use <code>Any</code> or <code>query syntax</code> (as in <a href=\"http://stackoverflow.com/questions/8542325/linq-max-with-default-value\">here</a>). But I want to do it with <code>fluent</code> syntax.</p>\n\n<p>How can I fix it ?</p>\n"},{"tags":["c#","linq","syntax","forex"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":64,"score":1,"question_id":13250328,"title":"LINQ to object Open High Low Close (OHLC)","body":"<p>I would like to achieve same results from code sample below by using syntax LINQ query to object.\nPlease, help me guys.</p>\n\n<pre><code>public static List&lt;OHLC&gt; OHLC(List&lt;FileRaw&gt; fileRawsList, TimeSpan timeSpan, DateTime beginDate, DateTime endOfLoopDate)\n    {\n\n        List&lt;OHLC&gt; ohlcList = new List&lt;OHLC&gt;();\n\n        for (DateTime i = beginDate; i &lt; endOfLoopDate; )\n        {\n            DateTime iLow = i;\n            DateTime iMax = i.Add(timeSpan);\n            OHLC ohlcRaw = new OHLC()\n                {\n                    Open = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().First(),\n                    High = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Max(),\n                    Low = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Min(),\n                    Close = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Last(),\n                    Time = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Time).DefaultIfEmpty(iLow).First()\n                };\n\n            i = i.Add(timeSpan);\n            ohlcList.Add(ohlcRaw);\n        }\n        return ohlcList;\n    }\n</code></pre>\n\n<p>it produce</p>\n\n<pre><code>Open: 1.229570, High: 1.233580, Low: 1.221730, Close: 1.224630, Date: 01/08/2012 00:00:02\nOpen: 1.224620, High: 1.240460, Low: 1.213320, Close: 1.217490, Date: 02/08/2012 00:00:03\nOpen: 1.217530, High: 1.239160, Low: 1.217230, Close: 1.238650, Date: 03/08/2012 00:00:02\nOpen: 0,        High: 0,        Low: 0,        Close: 0,        Date: 04/08/2012 00:00:02\nOpen: 1.239720, High: 1.239830, Low: 1.239180, Close: 1.239460, Date: 05/08/2012 17:00:03\n</code></pre>\n"},{"tags":["c#","asp.net","asp.net-mvc-3","unit-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13285224,"title":"Cache memory does not update but my database updates","body":"<p>I have a problem in my test case for create, edit, delete. Specifically in my edit part. Here's the code.</p>\n\n<p>Test Case:</p>\n\n<pre><code>[TestClass]\npublic class UserCRUD\n{\n    [TestMethod]\n    public void TestMethod1()\n    {\n        taskModelContainer db = new taskModelContainer();\n        TaskMgr.Models.User UserEntity = new TaskMgr.Models.User();\n        UserController User = new UserController();\n        try\n        {\n            string Username = \"789zxc@t.cm\";\n            string Password = \"sdff34\";\n            string Role = \"User\";\n            string Name = \"lykers\";\n            int subsiteID = 1;\n\n            UserEntity.Username = Username;\n            UserEntity.Password = Password;\n            UserEntity.Role = Role;\n            UserEntity.Name = Name;\n            UserEntity.subsiteID = subsiteID;\n\n            ActionResult result = User.Create(UserEntity);\n\n            int id = Convert.ToInt32(User.ViewBag.id);\n            User Users = db.Users.Single(e =&gt; e.userID == id);\n\n            Assert.AreEqual(UserEntity.Username, Users.Username);\n            Assert.AreEqual(UserEntity.Password, Users.Password);\n            Assert.AreEqual(UserEntity.Role, Users.Role);\n            Assert.AreEqual(UserEntity.Name, Users.Name);\n            Assert.AreEqual(UserEntity.subsiteID, Users.subsiteID);\n\n            //Edit\n            //var qry = from e in db.Users orderby e.userID descending select e.userID;\n            //int eID = qry.First();\n\n\n            UserEntity.userID = id;\n            UserEntity.Username = \"dfsd56@y.c\";\n            UserEntity.Password = \"asc45k\";\n            UserEntity.Role = \"Administrator\";\n            UserEntity.Name = \"sfscf\";\n            UserEntity.subsiteID = 3;\n\n            ActionResult result2 = User.Edit(UserEntity);\n\n\n            //set viewbag to int\n            //int id1 = Convert.ToInt32(User.ViewBag.id);\n            //return data from database\n            User Users1 = db.Users.Single(e =&gt; e.userID == id);\n\n            //Users1.Username = UserEntity.Username;\n            //Users1.Password = UserEntity.Password;\n            //Users1.Role = UserEntity.Role;\n            //Users1.Name = UserEntity.Name;\n            //Users1.subsiteID = UserEntity.subsiteID;\n\n            Assert.AreEqual(UserEntity.userID, Users1.userID);\n            Assert.AreEqual(UserEntity.Username, Users1.Username);\n            Assert.AreEqual(UserEntity.Password, Users1.Password);\n            Assert.AreEqual(UserEntity.Role, Users1.Role);\n            Assert.AreEqual(UserEntity.Name, Users1.Name);\n            Assert.AreEqual(UserEntity.subsiteID, Users1.subsiteID);\n\n            //delete\n            //int userID = eID;\n        }\n        finally\n        {\n            ActionResult result3 = User.DeleteConfirmed(UserEntity.userID);\n\n            var del = from e in db.Users where e.userID == UserEntity.userID select e;\n            var delete = del.Count();\n\n            Assert.AreEqual(0, delete);\n        }\n    }\n}\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>[HttpPost]\npublic ActionResult Edit(User user)\n{\n    if (ModelState.IsValid)\n    {\n        db.Entry(user).State = EntityState.Modified;\n        db.SaveChanges();\n        //var qry = from e in db.Users orderby e.userID descending select e.userID;\n        //int eID = qry.First();\n        //ViewBag.id = user.userID;\n        return RedirectToAction(\"Index\");\n    }\n    ViewBag.subsiteID = new SelectList(db.Subsites, \"subsiteID\", \"subsite\", user.subsiteID);\n    return View(user);\n}\n</code></pre>\n\n<p>Whenever I go through <code>Assert.AreEqual(UserEntity.Username, Users1.Username);</code>, I'm receiving an error message that says <code>UserEntity.Username</code> does not match <code>Users1.Username</code>. Which is true whenever I hover those fields.</p>\n\n<p>Could someone/anyone help me figure out how to update the cache memory? What line of code/s should I use? In addition, I use DbContext. Not ObjectContext.</p>\n"},{"tags":["c#","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13285278,"title":"Dynamically create controls at runtime","body":"<p>I want to create controls at runtime in C#. I use the method shown below:</p>\n\n<p>Parse the XML file and get all the value from XML file, e.g.:</p>\n\n<pre><code>TextView.Name = DOC.SelectSingleNode(\"//TextViewObject/Name\").InnerText;\nTextView.Value = DOC.SelectSingleNode(\"//TextViewObject/Value\").InnerText;\nTextField.Name = DOC.SelectSingleNode(\"//TextFieldObject/Name\").InnerText;\n</code></pre>\n\n<p>What method should I use to create controls at runtime? How can I get values from these controls?</p>\n"},{"tags":["c#","file-io","permissions","uac"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":454,"score":5,"question_id":10743396,"title":"How to display UAC prompt for file save to restricted location using c#?","body":"<p>When a user saves a file from my application, they currently can't save to restricted locations (like C:).  I think this is a good restriction, but I would like to provide a UAC prompt to elevate privileges and allow a user to save in a restricted area.</p>\n\n<p>I've seen lots of answers around this topic that involve spawning a new process with elevated privileges using 'runas'.  Also, it seems like this can be done by impersonating another user.  From what I understand, both of those methods require a user to provide user credentials.</p>\n\n<p>What I'm wanting to do is basically what Windows itself does.  When you try to copy a file to C:\\ in Windows 7 (assuming you've got UAC set to its default level), you get the following prompt: </p>\n\n<p><img src=\"http://i.stack.imgur.com/hFLAX.png\" alt=\"UAC Prompt\"></p>\n\n<p>Once you click the Continue button with the UAC shield, the file is copied to C:\\ with no prompt for credentials (assuming you're logged on with admin privileges).  </p>\n\n<p>How can I replicate this behavior in my application for admin users?  They shouldn't have to impersonate any other user because they already have admin privileges.  Can anyone provide details on what Windows is doing during this process?  Are they spawning a new explorer.exe process with elevated privileges?</p>\n"},{"tags":["c#","xaml","windows-phone-8"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13276136,"title":"Where is ProgressRing Control?","body":"<p>I am trying to write a Windows Phone 8 SDK-based application.  I keep seeing mention of a ProgressRing control but I don't see it in the Toolbox or in the xaml designer.</p>\n\n<p>How do I use this?</p>\n"}]}
{"total":375441,"page":8,"pagesize":100,"questions":[{"tags":["c#","f#","microsoft-metro","windows-store"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13281340,"title":"Referencing F# libraries from a Windows Store/Metro C# app","body":"<p>I'm attempting to do some <a href=\"http://sharpdx.org/\" rel=\"nofollow\">SharpDX</a> in F#. SharpDX can't be imported into a Portable Library, only into a standard .NET library.</p>\n\n<p>Having worked around <a href=\"http://connect.microsoft.com/VisualStudio/feedback/details/761306/cannot-add-reference-to-portable-f-library-from-portable-c-library#tabs\" rel=\"nofollow\">a glaring bug</a> to reference the F# library from the C# app, I now run into another problem upon execution:</p>\n\n<p><code>Could not load file or assembly 'FSharp.Core, Version=4.3.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies. The system cannot find the file specified.</code></p>\n\n<p>This is a familiar exception, but I don't know what would be causing it in Visual Studio 2012.</p>\n"},{"tags":["c#",".net","excel-interop","numberformat"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13065087,"title":"Edit Range NumberFormat in existing document","body":"<p>I can't change column format in an existing Excel document (xlsx). Columns content are numbers actually but shown as text and therefore green triangle appear telling that cells shown as text.</p>\n\n<p>So I open this document in C# app and do the following thing:</p>\n\n<pre><code>sheet_.Range[sheet_.Cells[1, 2], sheet_.Cells[rowNum, 2]].EntireColumn.NumberFormat = \"0\";                \n</code></pre>\n\n<p>But it doesn't change column to appear content as numbers (they remain aligned by left side)</p>\n"},{"tags":["c#","asp.net","pdf","fonts","itextsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13284911,"title":"Changing PDF font size in iTextSharp","body":"<p>Following is the function I am writing to create PDF using iTextSharp.</p>\n\n<p>Let me explain the function ...</p>\n\n<p>I am here creating a PDF file from the another Template PDF file. The template PDF file is sent to this function in <code>bytes[]</code>, then I create <code>pdfReader</code> from this... </p>\n\n<p>From <code>pdfReader</code> I create <code>pdfStamper</code> (i.e. new PDF file) and write the response values to  its fields. It is working fine... only issue is <code>fint</code> size of values is much large...</p>\n\n<pre><code>public void GeneratePrintPDFTest(ResponseGroup actual, Pages page, byte[] filebyte, out string pdfname, string localstorage)\n{\n   string rootPath = @\"D:/FOP-PDF/\";\n   var pdfReader = new PdfReader(filebyte);\n   var pdfStamper = new PdfStamper(pdfReader,new FileStream(rootPath.ToString(CultureInfo.InvariantCulture) + page.PageId.ToString(CultureInfo.InvariantCulture)\n                    + \".pdf\",FileMode.Create));\n   pdfname = rootPath.ToString(CultureInfo.InvariantCulture) + page.PageId.ToString(CultureInfo.InvariantCulture) + \".pdf\";\n\n   AcroFields pdfFormFields = pdfStamper.AcroFields;\n\n   foreach (DictionaryEntry de in pdfReader.AcroFields.Fields)\n   {\n       var response = actual.Responses.Where(obj =&gt; obj.ITPPageFieldKeyId == Convert.ToInt32(de.Key.ToString())).Select(obj =&gt; obj).FirstOrDefault();\n\n       if (response != null)\n       {\n           if (response.ResponseValues != null &amp;&amp; !string.IsNullOrEmpty(response.ResponseValues.ToString())\n                        &amp;&amp; response.ResponseValues.ToString() != \"0\" &amp;&amp; !string.IsNullOrEmpty(response.DataItemID)\n                        &amp;&amp; response.DataItemID != \"0\")\n           {\n              if (response.PrintFormulaResult || response.PageFieldFormulaId == 0)\n              {\n                 pdfFormFields.SetField(de.Key.ToString(), response.ResponseValues.ToString());\n              }\n           }\n        }\n     }\n\n     pdfStamper.FormFlattening = false;\n     pdfStamper.Close();\n}\n</code></pre>\n\n<p>I tried following solutions but of no use....</p>\n\n<pre><code>float fSize = 10;\npdfFormFields.SetFieldProperty(de.Key.ToString(), de.Key.ToString(), fSize, null);\n</code></pre>\n\n<p>I also doubt it may be coming from the template PDF file, but if so how could I change it programatically. </p>\n\n<p>Please help me with this... Thanks in advance... </p>\n"},{"tags":["c#","while-loop"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13284569,"title":"A While Loop Thread","body":"<p>So I've been trying to create a bit of code that sends data on a while loop, specifically an alive packet to a server through a UdpClient.</p>\n\n<pre><code> static void doSend(string ip, int port)\n    {\n        while (isSending)\n        {\n            _sockMain = new UdpClient(ip, port);\n            // Code for datagram here, took it out\n            _sockMain.Send(arr_bData, arr_bData.Length);\n        }\n    }\n</code></pre>\n\n<p>But when I call the \"Stop\" method, it gets stuck in a constant loop and doesn't come out. How can I put the while loop into a Thread? So I can abort the thread on stop, cancelling the loop?</p>\n"},{"tags":["c#","com","cobol","microfocus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13254393,"title":"Accessing Visual Cobol from C#","body":"<p>We are using Micro Focus Visual Cobol 2.1 in Visual Studio 2010. (Note this is not Cobol.Net)</p>\n\n<p>We would like to access the functionality in Cobol from a C# program.</p>\n\n<p>We had hoped to be able to generate a COM wrapper and call the Cobol code through the COM wrapper, but cannot find the setting to create the COM wrapper.</p>\n\n<p>Anyone know how we can access the Cobol code from C#?</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":12757101,"title":"Determining how close an array is to the target array","body":"<p>I'm playing a little experiment to increase my knowledge and I have reached a part where I feel i could really optimize it, but am not quite sure how to do this.</p>\n\n<p>I have many arrays of numbers. (for simplicity, lets say each array has 4 numbers: 1, 2, 3, and 4)</p>\n\n<ul>\n<li><p>The target is to have all of the numbers in ascending order (ie,\n1-2-3-4), but the numbers are all scrambled in the different arrays.</p></li>\n<li><p>A higher weight is placed upon larger numbers.</p></li>\n<li><p>I need to sort all of these arrays in order of how close they are to\nthe target.</p></li>\n</ul>\n\n<p>Ie, 4-3-2-1 would be the worst possible case. </p>\n\n<p>Some example cases:</p>\n\n<pre><code>3-4-2-1 is better than 4-3-2-1\n2-3-4-1 is better than 1-4-3-2 (even though two numbers match (1 and 3). \n                                the biggest number is closer to its spot.)\n</code></pre>\n\n<p>So the big numbers always take precedence over the smaller numbers. Here is my attempt:</p>\n\n<pre><code>        var tmp = from m in moves\n                  let mx = m.Max()\n                  let ranking = m.IndexOf(s =&gt; s == mx)\n                  orderby ranking descending\n                  select m;\n\n        return tmp.ToArray();\n</code></pre>\n\n<p>P.S IndexOf in the above example, is an extension I wrote to take an array and expression, and return the index of the element that satisfies the expression. It is needed because the situation is really a little more complicated, i'm simplifying it with my example.</p>\n\n<p>The problem with my attempt here though, is that it would only sort by the biggest number, and forget all of the other numbers. it SHOULD rank by biggest number first, then by second largest, then by third. </p>\n\n<p>Also, since it will be doing this operation over and over again for several minutes, it should be as efficient as possible.</p>\n"},{"tags":["c#","dependency-injection","ndepend","static-code-analysis"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13197482,"title":"Finding code only used in special classes via NDepend","body":"<p>I am trying to get rid of dead code in our codebase using NDepend. Since we are using dependency injection I want to find interfaces (and the implementations) only used in classes that deriving from the registry base:</p>\n\n<pre><code>public class PresenterRegistry : Registry\n{\n    public PresenterRegistry()\n    {\n        For&lt;IExamplePresenter&gt;().Use&lt;ExamplePresenter&gt;();\n    }\n}\n</code></pre>\n\n<p>Is there any way to do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","asp.net","memory-management","excel-interop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13283188,"title":"Microsoft Office Interop Excel is not closing on windows 2008 64bt and office 2007 32bit","body":"<p>I created a excel helper class, to interact excel interop service.\nBut i noticed that the excel.exe is not getting closed on the server. \n(windows 2008 64bt Japanese OS and office 2007 32bit). \nWhen i checked with process explorer it shows tolltip like \"Path:[Error opening process]\"</p>\n\n<p>I did excel.Quit() and Marshal.FinalReleaseComObject(_xlApp) but nothing works as expected,\nThen i tried to kill the process by  processID,But still not killing the process.</p>\n\n<pre><code>uint processID = 0;\nGetWindowThreadProcessId((IntPtr)_hWnd, out processID);\n if (processID != 0)\n {\n  System.Diagnostics.Process.GetProcessById((int)processID).Kill();\n }\n</code></pre>\n\n<p>Then i tried below both method, but it close all manually opened excel documents.</p>\n\n<pre><code>System.Diagnostics.Process[] procs = System.Diagnostics.Process.GetProcessesByName(\"EXCEL\");\n        foreach (System.Diagnostics.Process p in procs)\n        {\n            int baseAdd = p.MainModule.BaseAddress.ToInt32();\n            if (baseAdd == _xlApp.Hinstance)\n            {\n                p.Kill();\n            }\n        }\n\nSystem.Diagnostics.Process[] procs = System.Diagnostics.Process.GetProcessesByName(\"EXCEL\");\n         foreach (System.Diagnostics.Process p in procs)\n         {\n             if (p.MainWindowTitle.Length == 0)\n             {\n                 p.Kill();\n             }\n         }\n</code></pre>\n\n<p>Any idea about how to close the excel.exe having error like below:\nPath:[Error opening process]</p>\n"},{"tags":["c#","asp-classic","routing","iis-7.5","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13274000,"title":"Is there a way to have IIS default document (default.asp) take precedence over .Net routing?","body":"<p>I am trying to migrate a site from classic ASP to .Net (using WebMatrix).  I am planning on mixing the new .cshmtl pages in with the legacy .asp files and slowly migrate the site over time.  To date, I have individual .asp pages for each piece of content (each url).  As I move to .Net, the content will be coming from a database, so there will not be specific pages for each url.  I love the power of routing that is available in .Net and it works well and plays nicely with the classic ASP with one exception so far.  </p>\n\n<p>My example is that I have an ASP page located at /crafts/default.asp and currently reference that everywhere as just /crafts/.  The IIS default document setting takes care of serving the default.asp page when i just reference /crafts/.  I want to start to post new items into this area of the site but run as .Net pages.  so I created a /crafts.cshtml page which is designed to handle different urls and go to the database and lookup the item and display the info.  So as an example I have legacy page at /crafts/fall-crafts.asp and this works fine - because there is an .asp page sitting there named that.  But when i reference /crafts/ .Net takes over and serves the /crafts.cshtml page instead of serving the /crafts/default.asp file.  Is there something I can do to keep the power of .Net routing in place, but still have IIS serve the default document in this case? </p>\n"},{"tags":["c#","tsql","ado.net","database-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13282826,"title":"Query runs faster in SQL Server than via ADO.NET command being sent","body":"<p>So I have the following in my CRUD method in my DL which brings back a photo blob:</p>\n\n<pre><code>    public static MemberPhoto RetrievePhoto(string customerID)\n    {\n        Database db = DatabaseFactory.CreateDatabase(Config.DbConnectionString);\n\n        using (DbCommand cmd = db.GetSqlStringCommand(string.Format(@\" SELECT  customerID,\n                                                                                p.Photo as PhotoBlob\n\n                                                                         FROM \n                                                                         SomeTable t\n\n                                                                         WHERE \n                                                                         t.PhotoID = (SELECT MAX(t.PhotoID) FROM SomeTable t\n                                                                                      WHERE t.customerID = @{0} \n                                                                                      GROUP BY t.CustomerID)\", \"customerID\")))\n        {\n            try\n            {\n                db.AddInParameter(cmd, \"@customerID\", DbType.String, customerID);\n\n                using (IDataReader reader = db.ExecuteReader(cmd))\n                {\n                    if (reader.Read())\n                    {\n                        Photo photo = new Photo();\n                        photo.LoadFromDataReader(reader);\n                        return photo;\n                    }\n                }\n            }\n</code></pre>\n\n<p>so that runs about 10 seconds slower than if I run this straight from management studio:</p>\n\n<pre><code>SELECT  customerID,\n    t.Photo as PhotoBlob\n\n    FROM \n    SomeTable t\n\n    WHERE \n    t.PhotoID = (SELECT MAX(t.PhotoID) FROM SomeTable t\n              WHERE t.customerID = '0000900595555' \n              GROUP BY t.CustomerID)\n</code></pre>\n\n<p>I don't know if it's because it takes a while for the reader to read the blob and bring that back or what?  If that's the problem how do you speed this up?  its instant at the DB, I run that query and it's a millisecond result timing.</p>\n\n<p>UPDATE:</p>\n\n<p>more info; the field type in the table is type Image in SQL Sever for that BLOB.</p>\n\n<p>I also ran my Unit Test, same amount of time, even after it hits my LoadFromReader:</p>\n\n<pre><code>[Test]\npublic void GetMemberPhoto_ByContractNumber_ReturnsAValidMemberPhoto()\n{\n    // Arrange\n    const string customerID = \"0044664176\";\n\n    // Act\n    DTO.MemberPhoto memberPhoto = MemberPhotoCRUD.RetrieveMemberPhotoFromBlob(customerID);\n\n    //Assert\n    Assert.IsNotNull(memberPhoto);\n    Assert.IsTrue(memberPhoto.CustomerID &gt; 0);\n    Assert.IsNotNull(memberPhoto.PhotoBinary.Length &gt; 0);\n}\n</code></pre>\n"},{"tags":["c#","android","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13284976,"title":"How to use 9-patch image in Wpf-app","body":"<p>I need to create and use 9-patch image (Like in android) in Wpf-app!<br>\nOnly one question - HOW?</p>\n"},{"tags":["c#","arrays","delegates"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3860,"score":3,"question_id":255098,"title":"Delegate Array","body":"<p>I am experimenting with calling delegate functions from a delegate array.  I've been able to create the array of delegates, but how do I call the delegate?</p>\n\n<pre><code>public delegate void pd();\n\npublic static class MyClass\n{\n\n    static void p1()\n    {\n        //...\n    }\n\n    static void p2 ()\n    {\n        //...\n    }\n\n    //...\n\n    static pd[] delegates = new pd[] {\n\n        new pd( MyClass.p1 ),\n        new pd( MyClass.p2)\n        /* ... */\n    };\n}\n\npublic class MainClass\n{\n    static void Main()\n    {\n        // Call pd[0]\n        // Call pd[1]\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong>  The reason for the array is that I need to call the delegate functions by an index as needed.  They are not run in response to an event.  I see a critical (stupid) error in my code as I had tried to execute the delegate function using the pd[] type rather than the name of the array (delegates).</p>\n"},{"tags":["c#","jquery","jqgrid","jqgrid-asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13284247,"title":"Set dropdown options from C# in jqgrid","body":"<p>I am generating column model at server end using C# and passing jSON to the grid. Now I want one column to give a dropdown functionality. But it is not working out, this is what I have so far:</p>\n\n<pre><code>StringBuilder deptDetails = new StringBuilder();\nforeach (Department dept in departmentList)\n{\n    deptDetails.Append(dept.DepartmentID);\n    deptDetails.Append(\":'\");\n    deptDetails.Append(\":'\" + dept.DepartmentName + \"',\");\n    deptDetails.Append(',');\n}\ndeptDetails.Length -= 1;\n\ncolModel[i] = new ColumnMod\n{\n    name = selectedItems[i].ToString(),\n    index = selectedItems[i].ToString(),\n    width = 100,\n    editable = true,\n    edittype = \"select\",\n    align = \"left\",\n    editoptions=\"{value:{\" + deptDetails + \"}}\"\n };\n</code></pre>\n\n<p>Here is my columnmodel class:</p>\n\n<pre><code>public class ColumnMod\n{\n    public string name { get; set; }\n    public string index { get; set; }\n    //public Boolean key { get; set; }\n    public Int32 width { get; set; }\n    public Boolean editable { get; set; }\n    public string edittype { get; set; }\n    //public Boolean sortable { get; set; }\n    public string align { get; set; }\n    //public Boolean hidden { get; set; }\n    public string editoptions { get; set; }\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Here is my JS code:</p>\n\n<pre><code>$grid.jqGrid({\n    colNames: selectedItems,\n    colModel: columnSelected,\n    sortname: selectedValues[0],\n    sortorder: \"asc\",\n    editurl: 'url',\n    cellsubmit: 'clientArray',\n    cellEdit: true,\n    rowNum: 5000,\n    rownumbers: true,\n    rownumWidth: 30,\n    autowidth: true,\n    shrinkToFit: true,\n    gridview: true,\n    pager: '#gridPager',\n    viewrecords: true,\n    recordtext: \"Total Rows: {2}\",\n    jsonReader: {\n        root: \"rows\",\n        page: \"page\",\n        total: \"totalpages\",\n        records: \"totalrecords\",\n        cell: \"cell\",\n        id: selectedValues[0], //index of the column with the PK in it \n        userdata: \"userdata\",\n        repeatitems: true\n    },\n    prmNames: {\n        rows: \"numRows\",\n        page: \"page\",\n        sort: \"sortField\",\n        order: \"sortOrder\"\n    },\n    datatype: function (postdata) {\n        if (lastSortField != postdata.sortField || lastSortOrder != postdata.sortOrder)\n         {   if (!$('#btnValidate').is(':disabled')) {\n                lastSortField = postdata.sortField;\n                lastSortOrder = postdata.sortOrder;\n            }\n        }\n    }\n</code></pre>\n\n<p>This is how I get value in columnModel:</p>\n\n<pre><code>function getSelectedColumnsJSON(selectedValues) {\ntry {\n    $.ajax({\n        type: \"POST\",\n        url: window.location.protocol + '//' + window.location.host + window.location.pathname + \"/getSelectedColumnsJSON\",\n        data: $.toJSON({\n            selectedItems: selectedValues\n        }),\n        contentType: \"application/json; charset=utf-8\",\n        dataType: \"json\",\n        async: false,\n        success: function (data, status) {\n            if (data.d)\n                columnSelected = data.d;\n        },\n        error: function (error) {\n            ShowMessage(error.responseText);\n        }\n    });\n}\ncatch (ex) {\n    ShowMessage(ex.message);\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I am getting the dropdown select in the column, but it is empty, I have tried to follow the format that is explained <strong><a href=\"http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acommon_rules\" rel=\"nofollow\">here</a></strong>..any help?</p>\n"},{"tags":["c#","unity"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13282572,"title":"Unity resolve parameter with named mapping","body":"<p>i'm using unity to resolve an object graph.</p>\n\n<pre><code>public interface ISessionManager\n{\n}\n\npublic class DefaultSessionManager : ISessionManager\n{\n}\n\npublic class OnCallSessionManager : ISessionManager\n{\n}\n</code></pre>\n\n<p>And i have service class that utilize ISessionManager on constructor</p>\n\n<pre><code>public class CustomerService\n{\n    public class CustomerService(ISessionManager sessionManager)\n    {\n    }\n}\n</code></pre>\n\n<p>On top of object graph. I have a viewmodel class and a data manager class.</p>\n\n<pre><code>public class ViewModel(CustomerService customerService)\n{\n}\n\npublic class DataManager(CustomerService customerService)\n{\n}\n</code></pre>\n\n<p>Now i want to resolve ViewModel and DataManager using different ISessionManager.\nFor <code>ViewModel</code> class i want <code>DefaultSessionManager</code> and <code>OnCallSessionManager</code> for <code>DataManager</code>. How can i do that ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","winapi","resize","winamp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13157381,"title":"c# resize Winamp main window","body":"<p>I have a problem:\nI found this:</p>\n\n<pre><code>[DllImport(\"user32.dll\")]\n    static extern bool MoveWindow(IntPtr hWnd, int X, int Y, int nWidth, int nHeight, bool bRepaint);\n    [DllImport(\"user32.dll\")]\n    static extern bool GetWindowRect(IntPtr hWnd, out RECT rect);\n\n    static void resize()\n    {\n        Process p = new Process();\n        p.StartInfo.FileName = \"winamp.exe\";\n        p.Start();\n        p.WaitForInputIdle();\n        Thread.Sleep(2000);\n        IntPtr hWnd = p.MainWindowHandle;\n        RECT rect;\n        GetWindowRect(hWnd, out rect);\n        int width = rect.right - rect.left;\n        int height = rect.bottom - rect.top;\n        MoveWindow(hWnd, 0, 0, width, height, true);\n    }\n</code></pre>\n\n<p>This code snippet works with all processes that I tested, except Winamp.\nAnyone an idea how to get it working with Winamp?</p>\n"},{"tags":["c#",".net","image","sendmail","outlook-2007"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":425,"score":0,"question_id":11735352,"title":"Send email with embedded image without using wordeditor","body":"<p>I am having troubles sending email with embedded image. I tried some solutions using word editor but they can't solve my circumstances. I can't use SmtpClient becuase a client does not want it. He has exchange and needs to have sent email in sent folder.</p>\n\n<p>I want send an email in html format with eg. image in header - logo and image in footer - sign.</p>\n\n<p>I have and HTML template stored in database as string to provide more looks and purposes of an email. Specific data I insert using variables which are replaced in moment of sending.</p>\n\n<p>Does anyone know how to add image stored in database to email into  without using mailitem.wordeditor and without need to display inspector? Let's assume the images are already on disc or can be a stream somehow used?</p>\n\n<p>My application needs send in background without notify the user by another windows. Adding images using wordeditor needs to have inspector displayed. And even when I immediately close it, it blinks.</p>\n\n<p>The second trouble is how to format HTMLBody property of mailitem, when it does not accept normal HTML but only their so-called html. Is it really needed to study their word html?</p>\n\n<p>Firstly I used MailMessage and this template worked even with images and alternativeviews. Maybe exist some posibility to use MailMessage to send it via outlook, but I dont know it.</p>\n\n<p>Does anoyne came accross with it?</p>\n\n<pre><code>    public void SendEmailViaOutlook()\n    {\n        //in template I mostly need to use table and css to divide email into blocks - header, content, footer\n\n        String htmlTemplate = \"&lt;html&gt;\\n\";\n        htmlTemplate += \"  &lt;head&gt;\\n\";\n        htmlTemplate += \"    &lt;style type=\\\"text//css\\\"&gt;\\n\";\n        htmlTemplate += \"       #Header  {border-width: 1; border: solid; text-align: center}\\n\";\n        htmlTemplate += \"       #Content {border-width: 1; border: solid; text-align: center}\\n\";\n        htmlTemplate += \"       #Footer   {border-width: 1; border: solid; text-align: center}\\n\";\n        htmlTemplate += \"    &lt;/style&gt;\\n\";\n        htmlTemplate += \"  &lt;/head&gt;\\n\";\n        htmlTemplate += \"  &lt;body&gt;\\n\";\n        htmlTemplate += \"    &lt;table&gt;\\n\";\n        htmlTemplate += \"      &lt;tr&gt;&lt;td&gt;&lt;img src=\\\"cid:companylogo\\\"/&gt;&lt;/td&gt;&lt;/tr&gt;\\n\";\n        htmlTemplate += \"      &lt;tr&gt;&lt;td&gt;&lt;div id=\\\"Header\\\"&gt;$HEADER$&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;\\n\";\n        htmlTemplate += \"      &lt;tr&gt;&lt;td&gt;&lt;div id=\\\"Contentr\\\"&gt;$CONTENT$&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;\\n\";\n        htmlTemplate += \"      &lt;tr&gt;&lt;td&gt;&lt;div id=\\\"Footer\\\"&gt;$FOOTER$&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;\\n\";\n        htmlTemplate += \"      &lt;tr&gt;&lt;td&gt;&lt;img src=\\\"cid:usersign\\\"/&gt;&lt;/td&gt;&lt;/tr&gt;\\n\";\n        htmlTemplate += \"    &lt;/table&gt;\\n\";\n        htmlTemplate += \"  &lt;/body&gt;n\";\n        htmlTemplate += \"&lt;/html&gt;\\n\";\n\n        //the code is simplified to demostrate problem\n        //$CONTENT etc. will be replaced by another html from custom html wysiwyg editor\n\n        try\n        {\n            Outlook.Application outlook = new Outlook.Application();\n            Outlook._MailItem outLookMailMessage = outlook.CreateItem(Outlook.OlItemType.olMailItem) as Outlook._MailItem;\n            outLookMailMessage.BodyFormat = Outlook.OlBodyFormat.olFormatHTML;\n\n            /*\n\n            here a I have problem to set the property - my template is not\n            set and a blank email is sent - almost none html it takes except the example from msdn http://support.microsoft.com/kb/310262, are there some rules how to write it?\n\n            */\n\n            outLookMailMessage.HTMLBody = htmlTemplate;\n            outLookMailMessage.Subject = this.Subject;\n\n            outLookMailMessage.Recipients.Add(\"somenone@somewhere.com\");\n\n            /*\n             here I woud need somehow link 2 images with cid companylogo and usersign\n             */\n\n            outLookMailMessage.Send();\n            outLookMailMessage = null;\n        }\n        catch (System.Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n    }\n</code></pre>\n\n<p>Any help would be much appreciated!</p>\n"},{"tags":["c#","wpf","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13247279,"title":"WPF(C#) how to use a post request to transfer file?","body":"<p>I have a picture that is presented in the form of a byte array. I need to save it to a file and send a post request. Tell me how to do it better</p>\n\n<p>Here is what I do</p>\n\n<pre><code>private Stream file;\n\n\n public void Fun1()\n\n  {\n\n   using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Create))\n\n      {\n\n       file.Write(bt, 0, bt.Length);\n       _cookies = DataHolder.Instance.Cookies;\n       HttpWebRequest request = (HttpWebRequest)WebRequest.Create(String.Concat(\"http://   Mysite.com/image.php?image=FILE\",file));\n            request.Method = \"POST\";\n            request.ContentType = \"multipart/form-data\";\n            request.CookieContainer = _cookies;     \n            request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallbackPlayersfun1), request);\n\n      }\n\n   }\n\n private void GetRequestStreamCallbackPlayersfun1(IAsyncResult asynchronousResult)\n\n{\n\n        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n        Stream postStream = request.EndGetRequestStream(asynchronousResult);\n using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Open))\n        {\n\n            BinaryReader br = new BinaryReader(file, Encoding.UTF8);\n            byte[] buffer = br.ReadBytes(2048);\n            while (buffer.Length &gt; 0)\n            {\n                postStream.Write(buffer, 0, buffer.Length);\n                buffer = br.ReadBytes(2048);\n            }\n        }\n        postStream.Close();\n\n        request.BeginGetResponse(new AsyncCallback(ReadCallbackSavePlayersfun1), request);\n\n}\n\n private void ReadCallbackSavePlayersfun1(IAsyncResult asynchronousResult)\n\n{\n\n  lock (__SYNC)\n\n{\n\n    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;\n                HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);\n\n            }\n        }\n</code></pre>\n\n<p>As a result, the server did not come, tell me what am I doing wrong</p>\n"},{"tags":["c#","facebook","security","facebook-c#-sdk","token"],"answer_count":3,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":2293,"score":12,"question_id":10388272,"title":"How to transparently renew  the Facebook access token while processing a service method which uses Facebook API calls?","body":"<p>I have a WCF service which runs in IIS 7.5 and VS 2010. This service has some methods which internally use the <a href=\"http://facebooksdk.codeplex.com/\">Facebook C# SDK</a> (version 4.1, not latest) in order to perform some GET and POST from/to Facebook. Since Facebook will soon <a href=\"http://developers.facebook.com/roadmap/offline-access-removal/\">remove</a> the <code>offline_access</code> I have to handle the situation where an access token is expired.</p>\n\n<p>I have understood the way the authentication is performed (in order to get the code and after having the code to get the access token) in order to use the Graph API for getting Facebook information (as presented <a href=\"http://developers.facebook.com/attachment/serversideflow.png\">here</a>).</p>\n\n<p>I have two questions:<br></p>\n\n<ul>\n<li>When my service method is called and I retrieve the token of the\nappropriate user from my DB, is there a way to know if the access token\nis expired or not? <br>I have <a href=\"http://developers.facebook.com/docs/authentication/access-token-expiration/\">read</a> that when a Facebook API call is performed and the access token is expired then the following exception is thrown: <code>OAuthException</code>. But is there any better way to detect the expiration? I don't want to <br>\n<ol>\n<li>Call the Facebook API</li>\n<li>Handle the exception</li>\n<li>Renew the access token and finally </li>\n<li>Repeat the initial call with the new access token.<br></li>\n</ol></li>\n<li>Is it possible to renew the access token of the user transparently (store it also in the DB) and <em>continue</em> to handle the service method?\nIn <a href=\"http://csharpsdk.org/docs/web/handling-expired-access-tokens\">this</a> resource, the important (\"Renewing an Access Token\") part is missing (declared as\n[todo])</li>\n</ul>\n\n<p>I would like to achieve the following scheme, in the implementation of the Service Method:<br></p>\n\n<pre><code>sc = SocialNetworkAccountDao.GetByUser(user)\n\nisExpired = call method to check if the sc.token is expired.\n\nif (isExpired)\n\n{\n\n  newToken = call method for getting new access token\n\n  sc.token = newToken;\n\n  SocialNetworkAccount.Update(sc);\n\n}\n\nFacebook = new Facebook (sc.token)\n\nFacebook.Post( ..... )\n\n--\n</code></pre>\n\n<p>The process to communicate with the <code>QAuth</code> dialog is asynchronous (a redirect is performed), and the communication with access token url to get the access token this is performed synchronously.<br><br>Final Question:<br></p>\n\n<ul>\n<li>Is there a way the service method to wait for the new access token we\nretrieve from the request / callback with Facebook in order to\ncontinue later with the new access token?</li>\n</ul>\n"},{"tags":["c#",".net","pdf","epub"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13279243,"title":"Validation for epub file and convert epub file to pdf","body":"<p>I have <strong>large</strong> volumes of epub files coming to my server. I have to validate epub file. I am not sure what should I do to validate for valid epub files. </p>\n\n<p>1.Anything specifically I should be validating for checking valid epub files.<br>\n2. What is the best way to convert epub to pdf files.</p>\n\n<p>I am using C# for coding. </p>\n"},{"tags":["c#","silverlight","debugging","xaml","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13100124,"title":"Can not add XAML breakpoint in Silverlight 5 project using Visual Studio 2012 RTM","body":"<p>So the problem is when i try to setup breakpoint on line with Binding markup extension I get error telling me that it's unable to set breakpoint in this location.</p>\n\n<p><strong>Visual Studio</strong></p>\n\n<pre><code>Microsoft Visual Studio Ultimate 2012\nVersion 11.0.50727.1 RTMREL\nMicrosoft .NET Framework\nVersion 4.5.50709\nInstalled Version: Ultimate\n</code></pre>\n\n<p><strong>Platform settings</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/ipQfd.png\" alt=\"B\"></p>\n\n<p>Platform targets are x86 for all except Silverlight ( selection box locked there)</p>\n\n<p>Debug info is set to full everywhere.</p>\n\n<p><strong>Debug settings</strong>\n<img src=\"http://i.stack.imgur.com/kJB00.png\" alt=\"enter image description here\"></p>\n\n<p>Cleaned up and rebuild solution with no errors.</p>\n\n<p>Go to line with Binding press F9 or Debug->Toggle breakpoint and see:</p>\n\n<p><img src=\"http://i.stack.imgur.com/F2H5Y.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":26,"score":-6,"question_id":13284257,"title":"how can an administrator access all the mails of a user in google api","body":"<p>As a google apps domain administrator,how can i get the access to all(read,unread,sent) emails of my domain user, ofcourse i can have their consent but without using their password.</p>\n"},{"tags":["c#","sql","entity-framework","sync"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13284661,"title":"EF synchronic savings of local and remote database","body":"<p>I have a local and remote database which are accessed with EF. The databases are in sync at initial state.</p>\n\n<p>Now I want to save the changes done locally, also save on the remote database. This should be possible without downloading the whole remote database?.</p>\n\n<p>Can I just change the connection string of the context and then call SaveChanges() on remote?.</p>\n"},{"tags":["c#","image","email"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":230,"score":0,"question_id":8480534,"title":"Embeding Images in an Email Using Outlook Interop","body":"<p>I have a simple little email app that allows a user to pick certain options that generate a string and sends out an email. I wanted to see if its possible to add images to the email i.e. a header logo or signature, etc. The research I've been looking at is very HTML heavy and I know very little HTML. Can anyone help? My code is as follows...</p>\n\n<pre><code>using System;\nusing Outlook = Microsoft.Office.Interop.Outlook;\nusing System.Configuration;\n\nnamespace My_EmailSender\n{\n  public class EmailSender:Notification\n{\n    string emailRecipient = ConfigurationManager.AppSettings[\"emailRecipient\"];\n\n    public void SendMail(string message)\n    {\n        try\n        {\n            var oApp = new Outlook.Application();\n            var oMsg = (Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailItem);\n            var oRecip = (Outlook.Recipient)oMsg.Recipients.Add(emailRecipient);\n            oRecip.Resolve();\n            oMsg.Subject = \"Email Notification\";\n            oMsg.Body = message;\n\n            // Display the message before sending could save() also but no need\n            oMsg.Send();\n            oMsg.Display(true);\n            oRecip = null;\n            oMsg = null;\n            oApp = null;\n        }\n\n        catch (Exception e)\n        {\n            Console.WriteLine(\"Problem with email execution. Exception caught: \", e);\n        }\n        return;\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["c#","expression-trees","prefix","irony"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13282917,"title":"Implementing a prefix notation expression parser using Irony","body":"<p>I'm trying to parse user-inputted prefix notation logical expressions using a context-free-grammar with the Irony library. This is for a class assignment so if anybody happens to be an expert on this, I would love to know more.</p>\n\n<p>I need to accept a user-inputted logical expression of the following format:</p>\n\n<pre><code>and P Q -- (meaning P ^ Q)\nor P Q -- (meaning P v Q)\nnot P  -- (meaning ~P)\nimp P Q -- (meaning P -&gt; Q)\n</code></pre>\n\n<p>I'm attempting to parse these into expression trees using a context free grammar I'm implementing in Irony. The context-free grammar I'm using is here, in BNF:</p>\n\n<pre><code>&lt;Expression&gt; ::= &lt;Not&gt; | &lt;And&gt; | &lt;Or&gt; | &lt;Implies&gt; | &lt;Identifier&gt;\n&lt;Not&gt;        ::= \"not\" &lt;Expression&gt;\n&lt;And&gt;        ::= \"and\" &lt;Expression&gt; &lt;Expression&gt;\n&lt;Or&gt;         ::= \"or\" &lt;Expression&gt; &lt;Expression&gt;\n&lt;Implies&gt;    ::= \"imp\" &lt;Expression&gt; &lt;Expression&gt;\n\n(&lt;Identifier&gt; is implemented as an IdentifierTerminal object).\n</code></pre>\n\n<p>I've used Irony to parse expressions before but for some reason, I cannot get it to work. When I type the expression <code>and P Q</code> it seems to be identifying \"and\" as an Identifier terminal, not part of the And nonterminal. I may be doing something obvious but I simply can't figure it out. Here is the language class I extended:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>class LogicPrefix : Grammar\n{\n    public LogicPrefix()\n        : base(false)\n    {\n        NonTerminal Expression = new NonTerminal(\"expression\");\n        NonTerminal Implies = new NonTerminal(\"implies\");\n        NonTerminal And = new NonTerminal(\"and\");\n        NonTerminal Or = new NonTerminal(\"or\");\n        NonTerminal Not = new NonTerminal(\"not\");\n        Terminal Identifier = new IdentifierTerminal(\"identifier\");\n        Root = Expression;\n\n        Expression.Rule = And | Or | Not | Identifier;\n\n        Not.Rule = \"not\" + Expression;\n        Implies.Rule = \"imp\" + Expression + Expression;\n        And.Rule = \"and\" + Expression + Expression;\n        Or.Rule = \"or\" + Expression + Expression;\n\n    }\n}\n</code></pre>\n\n<p>And here is my driver class:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>class Program\n{\n    static void Main(string[] args)\n    {\n        LogicPrefix grammar = new LogicPrefix();\n        Parser p = new Parser(grammar);\n        ParseTree pt = p.Parse(\"and P Q\");\n        //pt has thrown an error flag.\n    }\n}\n</code></pre>\n\n<p>Please let me know if I'm doing something wrong, I'd love some advice on this.</p>\n"},{"tags":["c#","windows-phone-7","windows-phone-7.1","windows-phone-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13284448,"title":"Disallowed key characters while uploading image in base64 format","body":"<p>I'm developing Windows phone(8.0)apps and I'm new to it,I'm using below code to post image to server in <code>Base64</code> format using post client</p>\n\n<pre><code>Uri uri = new Uri(UPLOAD_IMAGE_PATH);\nUploadImageData requestData = new UploadImageData();\nrequestData.image = base64String;\nstring jsonString = JsonConvert.SerializeObject(requestData);\nPostClient proxy = new PostClient(jsonString);\nproxy.DownloadStringCompleted += new PostClient.DownloadStringCompletedHandler(proxy_DownloadStringCompleted);\nproxy.DownloadStringAsync(uri);\n</code></pre>\n\n<p>where <code>base64String</code> is my image string encoded in Bae64 by using below code</p>\n\n<pre><code>internal static string ImageToBase64String(Stream choosenPhoto,Image image)\n{\n   WriteableBitmap bmp = new WriteableBitmap((BitmapSource)image.Source);\n   byte[] byteArray;\n   using (MemoryStream stream = new MemoryStream())\n   {\n     bmp.SaveJpeg(stream, bmp.PixelWidth, bmp.PixelHeight, 0, 100);\n     byteArray = stream.ToArray();\n     return Convert.ToBase64String(byteArray); \n   }           \n}\n</code></pre>\n\n<p>In below response it returns \"<code>disallowed key charaters</code>\" on <code>result</code>.</p>\n\n<pre><code>void proxy_DownloadStringCompleted(object sender, WindowsPhonePostClient.DownloadStringCompletedEventArgs e)\n{\n   string result = e.Result;\n}\n</code></pre>\n\n<p>But when i post same JSON string using <code>REST Client</code> from Mozilla, JSON response from server is successfull.\nI searched about this and i got some links <a href=\"http://stackoverflow.com/questions/8114512/disallowed-key-character-error-in-codeigniter\">link 1</a>, <a href=\"http://stackoverflow.com/questions/5423212/codeigniter-disallowed-key-characters\">link 2</a> that i need to allow characters on server side in <code>Input.php</code> file, So exactly what kind of character i need to allow. It works from <code>REST Client</code> did i miss something in my C# code, Please help me</p>\n"},{"tags":["c#","asp.net",".net","localization","resx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":174,"score":0,"question_id":9173779,"title":"Hooking into default IResourceProvider to handle named placeholders","body":"<p>I'm extending a large ASP .NET WebForms application that has a lot of localized strings in resx files, both global and local.\nIn a lot of these resource strings, the name 'CompanyX' appears. For example: \"Welcome to the CompanyX web portal\" or \"Contact CompanyX support for more info\".\nNow we want to deploy an instance of this application for Company Y instead. So we want a good way to dynamically replace the company name in all the resources. \nWe think that a workable way to achieve this, is to replace CompanyX with a named placeholder like $COMPANYNAME$ in all the resX files (simple find-replace). \nThen, at runtime, replace that placeholder with the actual company name, which is unique per physical deployment and defined in the settings.</p>\n\n<p>The place where we could do that dynamic replacement could be a custom implementation of IResourceProvider. After a string is looked up we could run our custom replacement logic on it.\nThe \"GetObject\" method seems wel suited for this task. Apart from this little hook, our custom implementation should look up local and global resources EXACTLY the same way as the default ResourceProvider, which suits our needs fine.\nHowever, I failed to find the source of the default ResourceProvider online. I only find examples of highly customized IResourceProvider implementations (e.g. that use the db). </p>\n\n<p>First question:\nIs this a decent approach to solving the main problem (replacing the company name in our resource strings? \nThe BIG advantage with this approach is that we wouldn't need to modify the aspx markup or code that uses the resources. We don't want to wrap every reference to a resource with a custom function call to do the placeholder formatting.\nAlso, just duplicating the resx files and doing find-replace is not option. We want to limit the number of files and strings to maintain!\nIf we can get the same advantages with another approach, let me know.</p>\n\n<p>Second question:\nCan someone show me how to implement this concept without disturbing the default handling of global and local resources? All I need is a way to hook in somewhere after the value is loaded, and execute the replacement logic.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13284492,"title":"Nullpointer error on event listeners when using StaticResource and MouseDown handler","body":"<p>I have a very odd error case that sprung up the moment I used a StaticResource converter on a Rectangle for coloring its background and at the same time using a MouseDown handler on another component next to it within a DataTemplate. If I narrow the code down a bit, this is what is required to reproduce the error :</p>\n\n<p>In the top I have these resources, one pointing to a converter that takes the boolean from the binding and converts it to a fill background color):</p>\n\n<pre><code>&lt;Window.Resources&gt;\n &lt;vm:DesktopViewModel x:Key=\"DesktopVM\" /&gt;\n &lt;vm:BooleanToColorConverter x:Key=\"converter\" /&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>And later in the same xaml file I iterate over a list of Alarm objects using this (I have replaced a Grid layout with a StackPanel and removed some other components for shorter code sample, this code snippet below still fails):</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding Alarms}\"&gt;\n &lt;ItemsControl.ItemTemplate&gt;\n   &lt;DataTemplate&gt;                                                        \n    &lt;StackPanel&gt;\n     &lt;Rectangle Height=\"20\" Stroke=\"Black\" Width=\"20\" RadiusX=\"4\" RadiusY=\"4\" Fill=\"{Binding Alarm, Converter={StaticResource converter}}\"/&gt;\n     &lt;Image Source=\"/MyNamespace;component/images/chart.png\" Stretch=\"None\" MouseDown=\"Image_MouseDown\" Cursor=\"Hand\"/&gt;\n    &lt;/StackPanel&gt;\n  &lt;/DataTemplate&gt;\n &lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>If I remove the MouseDown handler on the image it runs just fine without the nullpointer error in the start. If I remove the Fill tag in the Rectangle the code works just fine WITH the MouseDown handler!!! (and the handler works just fine too). It seems like the StaticResource reference in Fill is messing up something that makes locating the mouse handler function fail?!? </p>\n\n<p>Note that it fails when the window is created, not while running or clicking anything.</p>\n\n<p>Edit: I had the same nullpointer issue if I replaced the converter with a style using a StaticResource with triggers to do the same as the converter. Its pretty clear that the StaticResource reference in an attribute is the culprit but I have no idea why it should affect the event listener.</p>\n\n<p>Also the order of the compoents dont matter either. If I place the Image before the Rectangle the error is exactly the same.</p>\n"},{"tags":["c#","asp.net","vb.net","security","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":150,"score":3,"question_id":12546652,"title":"ASP.net Encrypt Files After Upload / Decrypt To User","body":"<p>I am doing some research and development into a possible project that my potential client is discussing with me.</p>\n\n<p>I am looking at creating an asp.net 4.5 web application that will be accessed over the web and hold some pretty sensitive information. The information is going to be uploaded via the webApp and the files stored on the server for viewing / retrieval later. I want to ensure the information is securely uploaded and stored. in order to do this I will propose a EV SSL certificate is used across the application at all times and some sort of encryption applied to the files (jpeg,pdf,txt) to ensure that if someone gained access to the application at server level the files are not directly viewable without the application too, this is where I am looking for suggestions or improvements.</p>\n\n<p>My research has guided me to AES encryption on the files, again is this going to be sufficient to protect the files ? Should encryption be applied at OS level (win2008) ? Should I store the files in the database ?</p>\n\n<p>The files must be readable back to the user on the webApp and viewable in the browser.</p>\n\n<p>Should any further information be needed, please ask!</p>\n"},{"tags":["c#","xna"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13232448,"title":"Sort a text file where each line is a name followed by a score","body":"<p>I'm going to make a scoreboard for an XNA game but I'm having some trouble figuring out how. The player, after finishing a level, will enter his name when prompted. His name and time will be recorder in a text file something like this:</p>\n\n<pre><code>sam 90\njames 64\nmatthew 100\n</code></pre>\n\n<p>I'm trying to figure out a way to sort this data by the time taken only and not taking into account the name. </p>\n\n<p>I haven't started coding this yet but if anybody can give me any ideas it would be greatly appreciated. </p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13283754,"title":"Hard coding month and year based on current month","body":"<p>I have a login page after login based on current month and year i have to show a label like if the month is october it should appear like July-Dec 2012 and if it is january it should appear like january-june 2013 how can i do it?</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13272894,"title":"Move multiple items in a list","body":"<p>I have a list class that implements <code>IEnumerable&lt;T&gt;</code>.<br>\nType T is a complex class with a string member as unique identifier. But it's enough to take just <em>int</em> as element type for explanations.</p>\n\n<p>I want to move multiple items one step to left.<br>\nExample:<br>\nOriginal list: <strong><em>0</strong>, 1, 2, <strong>3</strong>, <strong>4</strong>, 5</em><br>\nNow all bold items (0,3,4) should be moved to left (as far as possible).<br>\nResult list: <strong><em>0</strong>, 1, <strong>3</strong>, <strong>4</strong>, 2, 5</em>  </p>\n\n<p>Is there a good algorithm to do that? Maybe just with LINQ.</p>\n\n<p>Edit: Answers for a <code>List&lt;T&gt;</code> list are welcome. My class has similar methods. (Thanks for hint by TylerOhlsen.)<br>\nEdit2: One selected item should not pass another selected item.</p>\n"},{"tags":["c#",".net","aforge"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13284586,"title":"How to use window in FFT","body":"<p>I dont understand how to use the window in FFT. I use C# with Aforge.Math. I use this:</p>\n\n<pre><code>Array[i] = new Complex(buffer, 0);\nArray[i].Re *= 0.5 * (1 - Math.Cos((2 * Math.PI * i) / 4097));\n//Hanning window\n</code></pre>\n\n<p>After this: </p>\n\n<pre><code>FourierTransform.FFT(Array, FourierTransform.Direction.Forward);\n</code></pre>\n\n<p>And If I understood correctly, what is doing this window, that code gives me bad results. Please explain me, what i'm doing wrong.</p>\n"},{"tags":["c#","wpf","wcf","mvvm","user-roles"],"answer_count":4,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":113,"score":2,"question_id":13206409,"title":"Assigning Roles to Application Users","body":"<p>As in all the Line-Of-Business Applications, an application may have multiple <code>Users</code> with some <code>Roles</code> assigned to them. We have recently shifted to WPF MVVM Architecture and looking for best way to assign role to each logged in user. There are many terms floating over internet like Authentication, RoleManager, LoginService etc, but I am not sure which to work out with.</p>\n\n<p><strong>Here is what we have:</strong></p>\n\n<p>A small business application (With 20 Forms), developed within a single-project. We use <code>MVVM</code> architecture, <code>LINQ-to-SQL</code> as DataAccess and <code>Model</code>, with <code>Repository pattern</code> and <code>Unit Of Work</code>.</p>\n\n<p><strong>What we want:</strong></p>\n\n<p>There are different forms and each form has <em>insert</em>, <em>update</em>, <em>delete</em>, <em>print</em> etc operations. What we want is to restrict a logged in user according to his role - to the task he can perform. i.e for e.g. Admin is free to do \"<em>anything</em>\" with the application, while some other users may not be allowed to view some forms or carry out some operations (viz. update or delete).</p>\n\n<p>So how can we achieve this; what kind of service could be used for carrying out this complete mechanism using MVVM architecture within a Desktop LOB application. A technical term or tutorial link will be helpful.</p>\n\n<p>I hope I am clear and thank you very much in advance.</p>\n\n<p><strong>Edit:</strong>  I went through many forums and articles around, but all of them focuses on ASP.NET. Still cannot find a concrete implementation for assignment of roles within WPF. And the sources on ASP.NET doesn't comply well with WPF.  </p>\n"},{"tags":["c#","wcf","soap","soa"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13284521,"title":"C# -wcf Web service need to connect SOA web service with soap header passing username/password token. How to alter soap header?","body":"<p>I have a WCF web service. In that I need to utilize SOA web service. I have created Reference.cs with WSDL file. Everything seems to be fine but SOA service expect custom header with Token including username\\password. SOA team has given only username\\password to pass in header. Now how to alter the SOAP header to pass authentication token in c# wcf?</p>\n\n<p>Here is SOA expecting SOAP content </p>\n\n<pre><code>&lt;message&gt;\n&lt;properties&gt;\n&lt;property  name=\"tracking.compositeInstanceId\"  value=\"160008\"/&gt;\n&lt;property  name=\"tracking.ecid\"  value=\"ef41c1acc87d807b:47c8a7e5:13aba83ab3c:-8000-000000000006d79c\"/&gt;\n&lt;property  name=\"transport.http.remoteAddress\"  value=\"10.100.21.228\"/&gt;\n&lt;/properties&gt;\n&lt;headers&gt;\n&lt;header&gt;\n&lt;wsse:Security  soap:mustUnderstand=\"1\"&gt;\n&lt;wsse:UsernameToken  wsu:Id=\"UsernameToken-njZlxs5jA9tMZ9zdXhHIaw212\"&gt;\n&lt;wsse:Username&gt;meuser&lt;/wsse:Username&gt;\n&lt;wsse:Password  Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;welcome123&lt;/wsse:Password&gt;\n&lt;/wsse:UsernameToken&gt;\n&lt;/wsse:Security&gt;\n&lt;/header&gt;\n&lt;/headers&gt;\n&lt;parts&gt;\n&lt;part  name=\"request\"&gt;\n&lt;ns1:DoT_GIS_Inbound_Input&gt;\n&lt;ns1:InterfaceID&gt;DOT_CRM_GIS_SBL_003&lt;/ns1:InterfaceID&gt;\n&lt;ns1:ContactFirstName&gt;Fname&lt;/ns1:ContactFirstName&gt;\n&lt;ns1:ContactLastName&gt;LName&lt;/ns1:ContactLastName&gt;\n&lt;ns1:ComplaintType&gt;Parking&lt;/ns1:ComplaintType&gt;\n&lt;ns1:RequestType&gt;Complaint Request&lt;/ns1:RequestType&gt;\n&lt;ns1:Phone&gt;5555555&lt;/ns1:Phone&gt;\n&lt;ns1:ReportedDate&gt;12\\12\\2012&lt;/ns1:ReportedDate&gt;\n&lt;ns1:UniqueID&gt;ddffketto7878998&lt;/ns1:UniqueID&gt;\n&lt;ns1:Email&gt;anji@yahoo.com&lt;/ns1:Email&gt;\n&lt;ns1:Description&gt;description text&lt;/ns1:Description&gt;\n&lt;/ns1:DoT_GIS_Inbound_Input&gt;\n&lt;/part&gt;\n&lt;/parts&gt;\n&lt;/message&gt;\n</code></pre>\n\n<p>My WCF service's method  as below </p>\n\n<pre><code>public string CreateComplaintInCRM(string TYPE, string DESCRIPTION, string DATE_REPORTED, string EMAIL, string Phone, string Contact_Name, string UNIQUE_ID, string Contact_SName)\n     {\n\n                CRMCreateComplaint.DoT_GIS_Inbound_Input crmCreateObj = new CRMCreateComplaint.DoT_GIS_Inbound_Input();\n                CRMCreateComplaint.execute_pttClient exeRec = new CRMCreateComplaint.execute_pttClient();\n\n                crmCreateObj.InterfaceID = \"DOT_CRM_GIS_SBL_003\"; // CRM setting \n                crmCreateObj.RequestType = \"Complaint Request\"; //// CRM setting \n                crmCreateObj.ComplaintType = TYPE;//compalint type\n                crmCreateObj.ContactFirstName = Contact_Name;\n                crmCreateObj.ContactLastName = Contact_SName;\n                crmCreateObj.Description = DESCRIPTION;\n                crmCreateObj.Email = EMAIL;\n                crmCreateObj.UniqueID = UNIQUE_ID;\n                crmCreateObj.Phone = Phone;\n                crmCreateObj.ReportedDate = DATE_REPORTED;\n\n                //string COMPLAINTREFID = exe.execute(crmCreateObj);\n\n                exeRec.execute(crmCreateObj);\n                return \"Referece ID:\";\n            }\n</code></pre>\n\n<p>I get InvalidSecurity : error in processing the WS-Security security header. </p>\n\n<p>Any SOA developer in C# out there who has same kind of problem ? \nYour help and guide is highly appreciate. </p>\n\n<p>I have gone though lot of document and articles and none help properly </p>\n"},{"tags":["c#","asp.net","ajaxcontroltoolkit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2658,"score":1,"question_id":781459,"title":"How do I create a calendar in code-behind?","body":"<p>I want to create an asp.net ajax calendar like <a href=\"http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/Calendar/Calendar.aspx\" rel=\"nofollow\">this</a>, but entirely in code-behind. How do I do it?</p>\n\n<p><strong>Edit:</strong> I only want to add the js code to the page in code-behind (eg: not in the markup)</p>\n\n<p><strong>Edit_2:</strong> I need this because I create a textbox control in a template class and want to create the calendar there (for use with the textbox)</p>\n"},{"tags":["c#","mysql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13283987,"title":"how to connect mysql from c#?","body":"<p>I downloaded <code>mysql.dll</code>. When I add this to my solution, I get an error like</p>\n\n<blockquote>\n  <p>Please make sure that file is accesssble and that it is a valid assembly or com component...</p>\n</blockquote>\n\n<p>Please tell me how to connect to MySql from C# and any problems I may encounter while using MySql in C#. Will it run on every system?</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13262226,"title":"Mouse activity slowing down WPF graphics demo","body":"<p>Below is a small graphics demo in WPF. It looks something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Cq3h2.png\" alt=\"enter image description here\"></p>\n\n<p>When it's running, if I move the mouse around the main area of the window, the animation slows down (at least on my system). If I move the mouse pointer out of the window entirely, the animation come back up to speed.</p>\n\n<p>Any suggestions for how to prevent the mouse movement interfering with the animation speed?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Threading;\nusing System.Windows.Threading;\n\nnamespace WPF_Golden_Section\n{\n    class DrawingVisualElement : FrameworkElement\n    {\n        public DrawingVisual visual;\n\n        public DrawingVisualElement() { visual = new DrawingVisual(); }\n\n        protected override int VisualChildrenCount { get { return 1; } }\n\n        protected override Visual GetVisualChild(int index) { return visual; }\n    }\n\n    public static class CanvasUtils\n    {\n        public static Canvas SetCoordinateSystem(this Canvas canvas, Double xMin, Double xMax, Double yMin, Double yMax)\n        {\n            var width = xMax - xMin;\n            var height = yMax - yMin;\n\n            var translateX = -xMin;\n            var translateY = height + yMin;\n\n            var group = new TransformGroup();\n\n            group.Children.Add(new TranslateTransform(translateX, -translateY));\n            group.Children.Add(new ScaleTransform(canvas.ActualWidth / width, canvas.ActualHeight / -height));\n\n            canvas.RenderTransform = group;\n\n            return canvas;\n        }\n    }\n\n    public static class ColorUtils\n    {\n        public static Color Write(this Color color)\n        {\n            Console.Write(\"Color[{0} {1} {2} {3}]\", color.A, color.R, color.G, color.B);\n\n            return color;\n        }\n\n        static byte ColorComponentToByte(double n)\n        {\n            return \n                (byte)\n                    Math.Round(Math.Min(Math.Max(n, 0), 1) * 255);\n        }\n\n        public static Color Rgb(double r, double g, double b)\n        {\n            return\n                Color.FromRgb(\n                    ColorComponentToByte(r),\n                    ColorComponentToByte(g),\n                    ColorComponentToByte(b));\n        }\n\n        public static Color SetArgb(this Color color, double a, double r, double g, double b)\n        {\n            color.A = ColorComponentToByte(a);\n            color.R = ColorComponentToByte(r);\n            color.G = ColorComponentToByte(g);\n            color.B = ColorComponentToByte(b);\n\n            return color;\n        }\n    }\n\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            Width = 600;\n            Height = 600;\n\n            var dockPanel = new DockPanel();\n\n            Content = dockPanel;\n\n            var slider =\n                new Slider()\n                {\n                    Minimum = 0.1,\n                    Maximum = 10,\n                    LargeChange = 0.001,\n                    Value = 1\n                };\n\n            dockPanel.Children.Add(slider);\n\n            DockPanel.SetDock(slider, Dock.Top);\n\n            var incrementSlider =\n                new Slider()\n                {\n                    Maximum = 0.001,\n                    Minimum = 0.00001,\n                    Value = 0.0001\n                };\n\n            dockPanel.Children.Add(incrementSlider);\n\n\n            DockPanel.SetDock(incrementSlider, Dock.Top);\n\n            var pauseButton = new Button() { Content = \"Pause\" };\n\n            dockPanel.Children.Add(pauseButton);\n\n            DockPanel.SetDock(pauseButton, Dock.Top);\n\n            var canvas = new Canvas();\n\n            dockPanel.Children.Add(canvas);\n\n            DockPanel.SetDock(canvas, Dock.Top);\n\n            SizeChanged += (s, e) =&gt; canvas.SetCoordinateSystem(-400, 400, -400, 400);\n\n            var element = new DrawingVisualElement();\n\n            Action draw = () =&gt;\n                {\n                    canvas.Children.Clear();\n\n                    // var element = new DrawingVisualElement();\n\n                    using (var dc = element.visual.RenderOpen())\n                    {\n                        for (var i = 0.0; i &lt; 720.0; i += slider.Value)\n                        {\n                            var radius = Math.Sin(i / 720.0 * Math.PI) * 30;\n\n                            var phi = (1 + Math.Sqrt(5)) / 2;\n\n                            var omega = 2 * Math.PI * (phi - 1) * i;\n\n                            var x = Math.Cos(omega) * 0.5 * i;\n                            var y = Math.Sin(omega) * 0.5 * i;\n\n                            dc.DrawEllipse(\n                                new SolidColorBrush(ColorUtils.Rgb(i / 360.0, i / 360.0, 0.25)),\n                                new Pen(Brushes.Black, Math.Max(radius / 6, 1)),\n                                new Point(x, y),\n                                radius / 2,\n                                radius / 2);\n                        }\n                    }\n\n                    canvas.Children.Add(element);\n                };\n\n            slider.ValueChanged += (s, e) =&gt;\n            {\n                Title = slider.Value.ToString() + \"     \" + incrementSlider.Value;\n                draw();\n            };\n\n            var timer = new DispatcherTimer();\n\n            timer.Tick += (s, e) =&gt;\n                {\n                    if (slider.Value &lt; 10.0)\n                        slider.Value += incrementSlider.Value;\n                };\n\n            timer.Start();\n\n            pauseButton.Click += (s, e) =&gt;\n                {\n                    if (timer.IsEnabled)\n                        timer.Stop();\n                    else\n                        timer.Start();\n                };\n\n            slider.Value = 3.5;\n            incrementSlider.Value = 0.00001;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","string","if-statement","comparison"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":13284259,"title":"C# if string contains more than 1 value","body":"<p>Good Morning,</p>\n\n<p>In an <code>if</code> statement if we want to check if a string contains a value, we have :</p>\n\n<pre><code>if (string.Contains(\"Value1\"))    \n{    \n}    \n</code></pre>\n\n<p>How can we make the string compare with more values in an if statement without keep writing the whole statement? For example to avoid the below statement</p>\n\n<pre><code>if ((string.Contains(\"Value1\") &amp;&amp; (string.Contains(\"Value2\")) &amp;&amp; (string.Contains(\"Value3\")))    \n{    \n}\n</code></pre>\n\n<p>Thank you </p>\n"},{"tags":["c#","assemblies"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3018,"score":1,"question_id":5598983,"title":"Namespace 'Smo' not found, although the reference is added","body":"<p>I have added Microsoft.SqlServer.Management.Smo.dll reference to my project, but it still gives me the error below. The referenced dll is in C:\\Program Files\\Microsoft SQL Server\\100\\SDK\\Assemblies path.</p>\n\n<p>Error   25  The type or namespace name 'Smo' does not exist in the namespace 'Microsoft.SqlServer.Management' (are you missing an assembly reference?)  </p>\n\n<p>All the classes that I use such as Restore, Serer class under the Smo namesapce also throws the error.</p>\n\n<p>Please advise.</p>\n"},{"tags":["c#","image","png","spreadsheet","gif"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13275858,"title":"spreadsheet to image file","body":"<p>Conversion of an Excel spreadsheet to image. Programming problem in C#. Starting from an Excel spreadsheet and I need to generate a gif or png file displaying the content of the spreadsheet.</p>\n"},{"tags":["c#","autofac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13274547,"title":"passing optional parameter to autofac","body":"<p>I am trying to use Autofac and register the below class which receives one of the parameter as optional parameter (or rather null).\nMy classes are:</p>\n\n<pre><code>class BaseSpanRecord : ISpanRecord\n{\n    public BaseSpanRecord(RecordType recordType, List&lt;SpanRecordAttribute&gt; properties)\n    {\n        RecordType = recordType;\n        Properties = properties;\n    }\n}\n</code></pre>\n\n<p>Here <em>RecordType</em> is an enum and <em>SpanRecordAttribute</em> is a class with only properties for which i don't want to create any interface.</p>\n\n<p>In the constructor <em>RecordType</em> and <em>Properties</em> are the two public properties of the interface <em>ISpanRecord</em>\nThis class can be instantiated in the following ways in different places in the program:</p>\n\n<pre><code>ISpanRecord spanFileRecord = new BaseSpanRecord(recordType, null);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ISpanRecord spanFileRecord = new BaseSpanRecord(recordType, recordAttributeList);\n</code></pre>\n\n<p>How should i try to register this in the Autofac container so that it can handle the above two cases?\nOr should i change something in the way <em>BaseSpanRecord</em> class has been written to make its registration easier?</p>\n"},{"tags":["c#",".net","string"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":5051,"score":5,"question_id":4718965,"title":"C# string comparison ignoring spaces, carriage return or line breaks","body":"<p>How can I compare 2 strings in C# ignoring the case, spaces and any line-breaks. I also need to check if both strings are null then they are marked as same.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","wpf","colors","brush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1975,"score":1,"question_id":2772166,"title":"How to set Border.BorderBrush from string","body":"<p>Theres a problem. I can't set the BorderBrush using a string value per C#-Code (not in XAML): </p>\n\n<pre><code> ((Border)((Image)sender).Parent).BorderBrush = \"#FFBCC7D8\";\n</code></pre>\n\n<p>How to solve this problem?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":60,"score":-1,"question_id":13283313,"title":"How to convert binary to text in C#?","body":"<p>I have converted text <code>Hello</code> into binary <code>010000010100001001000011</code> in c#, now I want to covert it back into original text. I search it many times but could not get any successful answer.</p>\n"},{"tags":["c#","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":57,"score":-2,"question_id":13284024,"title":"Addition is not working in the following query","body":"<p>hi i used the following query as stored procedure, when i run this query in sql it returns the  correct result, but when i use the same query in c#, its not working. can u plz tell where i made the mistake</p>\n\n<pre><code>select a.Itemcode,a.Description,a.Category,a.Location,a.Quantity,b.count,    (isnull(a.Quantity,0)+isnull(c.count,0)-isnull(b.count,0)) as Stockin \nfrom (select Itemcode,Description,Category,Location,isnull(Quantity,0) as Quantity from   Totalitemsinstock)a \nleft join (select sum(ISNULL(StocktransferlocationDetails.count,0))as count,\nleft(StocktransferlocationDetails.Itemcode,10) as Itemcode from   StocktransferlocationDetails where Status='Open'\ngroup by left(StocktransferlocationDetails.Itemcode,10))b on a.Itemcode=b.Itemcode\nleft join(select sum(ISNULL(StocktransferlocationDetails.count,0))as count,\nleft(StocktransferlocationDetails.Itemcode,10) as Itemcode from   StocktransferlocationDetails where Status='Closed'\ngroup by left(StocktransferlocationDetails.Itemcode,10))c on a.Itemcode=c.Itemcode\n</code></pre>\n\n<p>i used this query as stored procedure</p>\n\n<pre><code>con.Open();\n                SqlCommand cm_stockin = new SqlCommand(\"StoredProcedure2\", con);\n                cm_stockin.CommandType = CommandType.StoredProcedure;\n                SqlDataAdapter da_stockin = new SqlDataAdapter(cm_stockin);\n\n                DataSet ds_stockin = new DataSet();\n                da_stockin.Fill(ds_stockin);\n                dataGridView_stockin.DataSource = ds_stockin.Tables[0];\n                con.Close();\n</code></pre>\n"},{"tags":["c#","asp.net",".net","entity-framework-4"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13240242,"title":"How to dispose object context in repository pattern","body":"<p>I implemented a repository pattern to my application dat .</p>\n\n<p>I have :</p>\n\n<pre><code>public class EFRepository&lt;T&gt;\n{\n    DbContext // My db context\n\n    public IQureable&lt;T&gt; GetQuery()\n    {\n        DataContext.CreateQuery(...);\n    }\n}\n</code></pre>\n\n<p>Now let say I have user repository :</p>\n\n<p>public class UserRepository : EFRepository\n{\n        public UserGetUserDetails(int userId)\n        {\n            GetQuery().Where(u=>u.Id = userId).First();\n        }\n}</p>\n\n<p>my problem is how to release the <code>DbContext</code> when I use the EF repository in derived repositories. \nLets say : <code>UserRepository: EFRepository</code> , and it uses the <code>GetQuery</code> then I have to dispose the context.</p>\n\n<p>Any good idea how to make this in generic repository?</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13284264,"title":"error getting correct value of process CPU usage in C# project","body":"<p>The code will get a process CPU usage (just set the PID of any process you want).\nMy problem is that after less then a minute I get an incorrect value like -2731, -5412, -3430 and then 0 for another minute. After that I get a value of 2325 and then it will work fine again. and it cycles. </p>\n\n<p>I'd appreciate your assistance. Thanks.</p>\n\n<p>win32.cs</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices.ComTypes;\n\nnamespace GetProcessCpuUsageTEST\n{\n    public struct ProcessTimes\n    {\n        public DateTime CreationTime, ExitTime, KernelTime, UserTime;\n        public FILETIME RawCreationTime, RawExitTime, RawKernelTime, RawUserTime;\n\n        public void ConvertTime()\n        {\n            CreationTime = Win32.FiletimeToDateTime(RawCreationTime);\n            ExitTime = Win32.FiletimeToDateTime(RawExitTime);\n            KernelTime = Win32.FiletimeToDateTime(RawKernelTime);\n            UserTime = Win32.FiletimeToDateTime(RawUserTime);\n        }\n    }\n\n    public class Win32\n    {\n        public const uint PROCESS_ALL_ACCESS = 0x1F0FFF;\n\n        public static DateTime FiletimeToDateTime(FILETIME FileTime)\n        {\n            try\n            {\n                if (FileTime.dwLowDateTime &lt; 0) FileTime.dwLowDateTime = 0;\n                if (FileTime.dwHighDateTime &lt; 0) FileTime.dwHighDateTime = 0;\n\n                long RawFileTime = (((long)FileTime.dwHighDateTime) &lt;&lt; 32) + FileTime.dwLowDateTime;\n                return DateTime.FromFileTimeUtc(RawFileTime);\n            }\n            catch\n            { return new DateTime(); }\n        }\n\n        public static ProcessTimes GetProcessTimes(int ProcessID)\n        {\n            IntPtr ProcessHandle = OpenProcess(PROCESS_ALL_ACCESS, false, (uint)ProcessID);\n\n            ProcessTimes ProcessTimes = new ProcessTimes();\n\n            GetProcessTimes(\n                ProcessHandle,\n                out ProcessTimes.RawCreationTime,\n                out ProcessTimes.RawExitTime,\n                out ProcessTimes.RawKernelTime,\n                out ProcessTimes.RawUserTime);\n\n            ProcessTimes.ConvertTime();\n\n            CloseHandle((uint)ProcessHandle);\n\n            return ProcessTimes;\n        }\n\n        [System.Runtime.InteropServices.DllImport(\"kernel32.dll\")]\n        [return: System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.Bool)]\n        private static extern bool GetProcessTimes(IntPtr hProcess, out FILETIME\n           lpCreationTime, out FILETIME lpExitTime, out FILETIME lpKernelTime,\n           out FILETIME lpUserTime);\n\n        // gets the process handle\n        [System.Runtime.InteropServices.DllImport(\"kernel32.dll\")]\n        private static extern IntPtr OpenProcess(\n            uint DesiredAccess,\n            bool InheritHandle,\n            uint ProcessId);\n\n        [System.Runtime.InteropServices.DllImport(\"kernel32.dll\")]\n        private static extern IntPtr CloseHandle(\n            uint ProcessId);\n    }\n}\n</code></pre>\n\n<p>Form1.cs</p>\n\n<pre><code>using System;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace GetProcessCpuUsageTEST\n{\n    public partial class Form1 : Form\n    {\n        private long OldUserTime;\n        private long OldKernelTime;\n        private DateTime OldUpdate;\n        public int CpuUsage { get; private set; }\n\n        readonly Timer timer = new Timer();\n        Process process;\n\n        StringBuilder sb;\n        StringWriter sw;\n\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            sb = new StringBuilder();\n            sw = new StringWriter(sb);\n\n            //Set the PID of any process you want to monitor\n            process = Process.GetProcessById(27720);\n\n            timer.Interval = 1000;\n            timer.Enabled = true;\n            timer.Start();\n            timer.Tick += timer_Tick;\n        }\n\n        private ProcessTimes processTimes;\n\n        void timer_Tick(object sender, EventArgs e)\n        {\n            processTimes = Win32.GetProcessTimes(process.Id);\n\n            sw.WriteLine(UpdateCpuUsage(processTimes.UserTime.Ticks, processTimes.KernelTime.Ticks).ToString(\"00\"));\n            rtBoxCpuUsage.Text = sw.ToString();\n            rtBoxCpuUsage.Focus();\n            rtBoxCpuUsage.SelectionStart = rtBoxCpuUsage.Text.Length;\n        }\n\n        public int UpdateCpuUsage(long NewUserTime, long NewKernelTime)\n        {\n            // updates the cpu usage (cpu usgae = UserTime + KernelTime)\n            long UserTime = NewUserTime - OldUserTime;\n            long KernelTime = NewKernelTime - OldKernelTime;\n\n            long updateDelay = 1 + (DateTime.Now.Ticks - OldUpdate.Ticks);\n            int rawUsage = (int)(((UserTime + KernelTime) * 100) / updateDelay);\n            CpuUsage = rawUsage / Environment.ProcessorCount;\n\n            if (CpuUsage &lt; 0 || CpuUsage &gt; 100)\n            {\n                bool err = true;\n            }\n\n            OldUserTime = NewUserTime;\n            OldKernelTime = NewKernelTime;\n            OldUpdate = DateTime.Now;\n\n            return CpuUsage;\n        }\n\n        private void BtnStart_Click(object sender, EventArgs e)\n        {\n            timer.Start();\n        }\n\n        private void BtnStop_Click(object sender, EventArgs e)\n        {\n            timer.Stop();\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","xml","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13283164,"title":"Regex to match XML elements in a text file","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\">RegEx match open tags except XHTML self-contained tags</a>  </p>\n</blockquote>\n\n\n\n<p>I have a text file consist of conversion instruction templates. \nI need to parse this text file, </p>\n\n<p>I need to match something like this:</p>\n\n<pre><code>(Source: &lt;element&gt;)\n</code></pre>\n\n<p>And get the \"element\".</p>\n\n<p>Or this pattern: </p>\n\n<pre><code>(Source: &lt;element attr=\"name\" value=\"\"/&gt;)\n</code></pre>\n\n<p>And get \"element attr=\"name\"\".</p>\n\n<p>I am currently using this regex: </p>\n\n<pre><code>\\(Source:\\ ?\\&lt;(.*?)\\&gt;\\)\n</code></pre>\n\n<p>Sorry for being a newbie. :)</p>\n\n<p>Thanks for all your help. </p>\n\n<pre><code>-JRC\n</code></pre>\n"},{"tags":["c#","asp.net","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":479,"score":5,"question_id":7125314,"title":"Slow instantiation of iTextSharp PdfReader with large fillable form","body":"<p>I have a large (6 pages, 222 fields) fillable PDF that I am using as a template with iTextSharp PdfReader.  When this object instantiates it takes 5 minutes or more.  I have tried:</p>\n\n<pre><code>string pdfPath = Path.Combine(context.Server.MapPath(\"~/apps/ssgenpdf/App_Data\"), \"07-2011 Worksheets.pdf\");\nreader = new PdfReader(pdfPath);\n</code></pre>\n\n<p>alternatively I have tried reading the file into a memory stream and passing the memory stream to the PdfReader constructor.  Additionally I have tried using:</p>\n\n<pre><code>reader = new PdfReader(new RandomAccessFileOrArray(pdfPath), null);\n</code></pre>\n\n<p>none of these alternatives show significant gains.</p>\n\n<p>This is an ASP.Net app, and so my interim solution is to do this creation on application start and caching the reader, then I check to see if I get a valid reader from the cache and instantiate a new reader from that reader.  Now I routinely see under 50 millisecond response from this approach.</p>\n\n<p>My concern is that this does not seem scalable if others in my group want to use this \"fillable PDF as template with iTextSharp\" strategy.  Does anyone have any suggestions for alternate strategies to balance performance with scalability?  </p>\n"},{"tags":["c#","regex","string"],"answer_count":11,"favorite_count":21,"up_vote_count":78,"down_vote_count":0,"view_count":49876,"score":78,"question_id":206717,"title":"How do I replace multiple spaces with a single space in C#?","body":"<p>How can I replace multiple spaces in a string with only one space in C#?</p>\n\n<p>Example:</p>\n\n<pre><code>1 2 3  4    5\n</code></pre>\n\n<p>would be:</p>\n\n<pre><code>1 2 3 4 5\n</code></pre>\n"},{"tags":["c#","sql","winforms","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13182654,"title":"From DataTable to DataGridView including image path","body":"<p>I am building a small application. This application stores customer information and customer pictures.\nHere I have a problem where I want to show data from datatable to datagridview with pictures. My application does not store the image in a database, but stored in a folder. </p>\n\n<p>So in my database just store image path. But not full path, only the name of the folder or file. I use combine path on each name. It is easier to manage folders if the root directory has been changed compared to if I keep the full path.</p>\n\n<p>For example, if I want to display the image in picture box, I'll do this.</p>\n\n<pre><code>//consider the record has been selected from table\n\nclassDirectory cd = new classDirectory();\n\n// it will check current directory combine application name folder and branch name folder.\n\nstring branchFolderPath = cd.getBranchFolderPath(branchName); \n\nstring branchPanelPath = cd.getPanelFolderPath(branchFolderPath,panelName);\n\nstring customerPath = cd.getCustomerFolderPath(branchPanelPath,customerID + \" - \" + customerName);\n\nstring customerImage = path.Combine(customerPath,customerPicPath);\n\npicCustomer.Image = new Bitmap(customerImage);\n</code></pre>\n\n<p>After combine, it will return string <strong>\"C:\\Users\\My Name\\Documents\\My Application Name\\Branch Name\\Panel Name\\1235 - HIDAYAH\\Pictures\\HIDAYAH - Picture.jpg\"</strong></p>\n\n<p>So I can see the pictures.</p>\n\n<p>But, I do not know how to display the data in grid view.</p>\n\n<p>So only so far I've just made.</p>\n\n<pre><code>Customer.classDataBinding cdb = new Customer.classDataBinding();\n\nDataTable dataCustomer = cdb._listOfCustomer();\n\ndgvCustomer.DataSource = dataCustomer;\n\nthis.dgvCustomer.Columns[\"Customer Image\"].Width = 120; //For a while, this code return the string only.\nthis.dgvCustomer.Columns[\"Customer ID\"].Width = 120;\nthis.dgvCustomer.Columns[\"Name\"].Width = 120;\nthis.dgvCustomer.Columns[\"Branch\"].Width = 120;\nthis.dgvCustomer.Columns[\"Panel\"].Width = 120;\n</code></pre>\n\n<p>Code in <strong>cdb._listOfCustomer()</strong></p>\n\n<pre><code>  public DataTable _listOfCustomer()\n    {\n        cs.testConnection();\n\n        DataTable dtCustomer = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(cs.connString))\n        {\n            string query = \"SELECT tbl_customer.customerPicPath as [Customer Image], tbl_customer.customerID as [Customer ID],tbl_customer.customerName as Name, tbl_branch.branchName as Branch, tbl_panel.panelName as Panel FROM (tbl_branch INNER JOIN tbl_panel ON tbl_branch.branchID = tbl_panel.branchID) INNER JOIN tbl_customer ON tbl_panel.panelID = tbl_customer.panelID;\";\n\n            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))\n            {\n                adap.Fill(dtCustomer);\n\n            }\n        }\n\n        return dtCustomer;\n</code></pre>\n\n<p>Any suggestion? Hope someone can help me to resolve this problem. Thanks a lot!</p>\n"},{"tags":["c#","asp.net","data-binding","telerik","radgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13272290,"title":"Telerik RadGrid using Multiple Columns","body":"<p>I am having a problem with the RadGrid using Multiple Columns when I Bind a DataSource to the RadGrid. Firstly let me show some screenshots of what I am trying to do.</p>\n\n<p>This is an example from Teleriks website under demos and the multiple columns (summary column) is what I am trying to achieve \n<img src=\"http://i.stack.imgur.com/77UPN.png\" alt=\"RadGrid Example from Telerik/demo\"></p>\n\n<p>This is the exception I am getting when I try and bind the control to a DataSource</p>\n\n<p><img src=\"http://i.stack.imgur.com/gv7BA.png\" alt=\"RagGridException\"></p>\n\n<p>This is the RadGrid I have set up in my ASP page.</p>\n\n<p><img src=\"http://i.stack.imgur.com/tKaSv.png\" alt=\"RaGrid Asp\"></p>\n\n<p>Firstly I don't want to bind the datasource in my asp page. Secondly I wanted the \"Product\" and \"Other\" ColumnGroups to be used only as a Summary column and not to be bound to a datasource since these ColumnGroups are only used as headers for the other Columns.</p>\n\n<p>Is there a workaround to not allow the ColumnGroups not to be bound to a DataSource while the normal columns are?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13282774,"title":"Convert Lambda Expression Group By to LINQ Version","body":"<p>please consider this code:</p>\n\n<pre><code>var result = data\n        .GroupBy(a =&gt; groupA.Contains(a.Group) ? \"A\" : \n                      groupB.Contains(a.Group) ? \"B\" : \n                      \"N/a\")\n        .Select(a =&gt; new\n        {\n            KEY = a.Key,\n            VALUE = a.Count()\n        });\n</code></pre>\n\n<p>can any one help how to convert <code>GroupBy</code> to <code>LINQ</code> version?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want this style:</p>\n\n<pre><code>from a in ....\ngroup a by ....\nselect ...\n</code></pre>\n"},{"tags":["c#","disruptor-pattern"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":789,"score":4,"question_id":8860684,"title":"Disruptor.net Example","body":"<p>I am trying to learn how to use the Disruptor.net messaging framework and I can't find any practical examples.  There are quite a few articles out there with pictures about how it works but I can't find anywhere that actually goes and shows you how to implement the methods - does anyone have any suggestions?</p>\n\n<p>Thanks in advance,\nWilliam</p>\n"},{"tags":["c#","ado.net"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13283908,"title":"datatable.merge don't add columns","body":"<pre><code>Untyped DataTable\n------------------\nColA ColB ColC\n\nTyped DataTable\nColA ColB\n\n\nTypedDataTable.Merge(UntypedDataTable)\n\nResults in:\n\nColA ColB ColC\n</code></pre>\n\n<p>Is there anyway to keep it from adding the extra columns from untyped table?\nIn other words, I only want to keep ColA and ColB.</p>\n"},{"tags":["c#","asp.net",".net","silverlight","inkscape"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13283959,"title":"How to Use InkSpace command line in ASP .Net ?","body":"<p>I want to use all command of InkSpace  software from my asp.net..\nLets Take Example :</p>\n\n<p>I want Path Geometry or SVG file of Letter \"A\", having fontType== \"Arial\" , size= 400, there is command in inkspace like SelectionInset</p>\n\n<p>List of command is here:<a href=\"http://how-to.wikia.com/wiki/How_to_use_Inkscape_in_commandline_mode/List_of_verbs\" rel=\"nofollow\">http://how-to.wikia.com/wiki/How_to_use_Inkscape_in_commandline_mode/List_of_verbs</a></p>\n\n<p>If we have any API to use this command-line \nPlease help me...............</p>\n"},{"tags":["c#","jquery","asp.net","ajax","webmethod"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13282187,"title":"Jquery Ajax and asp.net WebMethod","body":"<p>I'm trying to call a webmethod in an aspx page using jquery ajax. The ajax code is callind the page but I can't go into the method although the Page_Load is been accesed after the ajax Post request. I've tried in many ways but I can't.</p>\n\n<p>I hope you can help me, I'm going crazy.</p>\n\n<pre><code>    protected void Page_Load(object sender, EventArgs e)\n    {\n        string nombre = Request.QueryString[\"nombre\"];\n        if (!IsPostBack)\n        {\n            this.CargarDatosIniciales();                  \n        }\n    }\n\n    [WebMethod(enableSession:true)]\n    [ScriptMethod()]\n    public static void GuardarDatosFamilia(string nombre, string tipoDoc)\n    {\n        string nombrePersona = nombre;\n        string tipoDocumento = tipoDoc;\n    }\n\n\n    $.ajax({\n        type: \"POST\",\n        url: \"FRM_Caracterizacion.aspx/GuardarDatosFamilia\", //Direccion del servicio web segido de /Nombre del metodo a llamar\n        beforeSend: function () { alert('I am sending'); },\n        data: \"{'nombre':'\"+ nombre+\"','tipoDoc':'\"+ tipoDoc\"'}\",\n        contentType: \"application/json; charset=utf-8\",\n        dataType: \"json\" \n        });\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>This is what I get in Firebug:</p>\n\n<pre><code>     POST http://localhost:51620/FRM_Caracterizacion.aspx/GuardarDatosFamilia 200 OK    3.22s\n\n     Parámetros application/x-www-form-urlencoded\n     nombre Jhon Fredy\n     tipoDoc    1\n     Fuente\n     nombre=Jhon+Fredy&amp;tipoDoc=1\n</code></pre>\n\n<p>UPDATE 2:</p>\n\n<p>SOLUTION</p>\n\n<p>What I've done for my specific problem was:</p>\n\n<pre><code>     $.ajax({\n        type: \"POST\",\n        url: \"FRM_Caracterizacion.aspx\", //Direccion del servicio web segido de /Nombre del metodo a llamar\n        beforeSend: function () { alert('I am sending'); },\n        data: { metodo: 'AgregarDatosFamilia',\n        nombre:nombre,\n        tipoDoc:tipoDoc\n        },\n        dataType: \"json\" //Esto quiere decir que los datos nos llegaran como un objeto json\n    });\n\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n            if (Request.Form[\"metodo\"] == \"AgregarDatosFamilia\")\n            {\n                this.GuardarDatosFamilia();\n            }\n            this.CargarDatosIniciales();                  \n        }\n    }\n\n    public void GuardarDatosFamilia()\n    {\n        string nombre = Request.Form[\"nombre\"].ToString(),\n        string tipoDoc = Request.Form[\"tipoDoc\"].ToString()\n    }\n</code></pre>\n\n<p>Thanks everybody, I appreciate suggestions!</p>\n"},{"tags":["c#","windows"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13283213,"title":"assembly reference for BindingContext","body":"<p>what is assembly reference for BindingContext? i use this code in c# win app, but it gives me error</p>\n\n<pre><code> txt_barcode_num_pri.BindingContext .ToString  (TextBox).UpdateSource();\n\n                if (txt_barcode_num_pri.GetBindingExpression(c).HasError)\n</code></pre>\n"},{"tags":["c#","asp.net","database"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3267,"score":0,"question_id":5590516,"title":"error : Connection Property has not been initialized","body":"<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Data.OleDb;\n\n\nnamespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        System.Data.OleDb.OleDbConnection con;\n        DataSet ds1;\n        System.Data.OleDb.OleDbDataAdapter da;\n\n        int MaxRows = 0;\n        int inc = 0;\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            con = new System.Data.OleDb.OleDbConnection();\n            ds1 = new DataSet();\n\n            con.ConnectionString=\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:/MyWorkers1.mdb\";\n\n            string sql = \"SELECT * from tblWorkers\";\n            da = new System.Data.OleDb.OleDbDataAdapter(sql, con);\n\n            con.Open();\n            da.Fill(ds1, \"MyWorkers1\");\n            NavigateRecords();\n            MaxRows = ds1.Tables[\"MyWorkers1\"].Rows.Count;\n            //MaxRows = ds1.Tables[\"MyWorkers1\"].Rows[inc];\n            //MessageBox.Show(\"Database open\");\n\n            con.Close();\n            //MessageBox.Show(\"Database close\");\n\n            con.Dispose();\n        }\n\n        private void NavigateRecords()\n        {\n            DataRow drow = ds1.Tables[\"MyWorkers1\"].Rows[inc];\n            textBox1.Text = drow.ItemArray.GetValue(0).ToString();\n            textBox2.Text = drow.ItemArray.GetValue(1).ToString();\n            textBox3.Text = drow.ItemArray.GetValue(2).ToString();\n        }\n\n        private void btnNext_Click(object sender, EventArgs e)\n        {\n            if (inc != MaxRows - 1)\n            {\n                inc++;\n                NavigateRecords();\n            }\n            else\n            {\n                MessageBox.Show(\"No More Records\");\n            }\n        }\n\n        private void btnPrevious_Click(object sender, EventArgs e)\n        {\n            if (inc &gt; 0)\n            {\n                inc--;\n                NavigateRecords();\n            }\n            else\n            {\n                MessageBox.Show(\"First Record\");\n            }\n        }\n\n        private void btnFirst_Click(object sender, EventArgs e)\n        {\n\n            if (inc != 0)\n            {\n                inc = 0;\n                NavigateRecords();\n            }\n        }\n\n        private void btnLast_Click(object sender, EventArgs e)\n        {\n            if (inc != MaxRows - 1)\n            {\n                inc = MaxRows - 1;\n                NavigateRecords();\n            }\n        }\n\n        private void btnAddNew_Click(object sender, EventArgs e)\n        {\n            textBox1.Clear();\n            textBox2.Clear();\n            textBox3.Clear();\n        }\n\n        private void btnSave_Click(object sender, EventArgs e)\n        {\n            System.Data.OleDb.OleDbCommandBuilder cb;\n            cb = new System.Data.OleDb.OleDbCommandBuilder(da);\n\n            DataRow drow = ds1.Tables[\"MyWorkers1\"].NewRow();\n\n            drow[0] = textBox1.Text;\n            drow[1] = textBox2.Text;\n            drow[2] = textBox3.Text;\n\n            ds1.Tables[\"MyWorkers1\"].Rows.Add(drow);\n\n            MaxRows = MaxRows + 1;\n            inc = MaxRows - 1;\n\n            da.Update(ds1, \"MyWorkers1\");\n\n            MessageBox.Show(\"Record / Entry Added\");\n        }       \n\n    }\n}\n</code></pre>\n\n<p>When I run this it shows an error like  <code>\"Invalid Operation - Exception Unhandled connection property has not been initialized.\"</code></p>\n\n<p>What is wrong?</p>\n"},{"tags":["c#","printing","ihtmldocument2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13272704,"title":"IHTMLDocument2 Printing without Dialog Box","body":"<p>I've been working on a project that automatically prints HTML invoices. It's been particularly challenging as I've needed to keep the CSS formatting.</p>\n\n<p>Following advice, I've found myself using IHTMLDocument2 to carry out my printing. I'm supposed to be able to:</p>\n\n<pre><code>mshtml.IHTMLDocument2 doc = new mshtml.HTMLDocument() as mshtml.IHTMLDocument2;\ndoc.write(htmlContent); //htmlContent is a string of HTML\ndoc.execCommand(\"PRINT\", false, null);\n</code></pre>\n\n<p>The second argument specifies whether to produce the 'Printer Options' box, but it doesn't help. I've read that using \"PRINT\" will always result in a dialog box - however I haven't been able to find an alternative.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","push-notification","android-gcm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13268460,"title":"PushSharp:Android GCM Push Notification received without push message","body":"<p>I am using PushSharp library to send push notification from my application.</p>\n\n<pre><code>PushService push = new PushService();\nvar reg_id_d = \"APA91bETd-LsqnZjA-HKrnBOY3FbEhmWchpiwuhRkiv4gUdGDuvwDRB7YURICZ131XppDAUNUBLGe_vEPkQ-JR8UaVX7Y-NCkEfastCBLIYcUoFtt5cPafeKXHywi0WGDYW33ZQqr3oy\";\nvar project_id_d = \"482885626272\";\nvar api_key_d = \"AIzaSyAbh7R5KQR3KM7W_y-yS-Ao-JNiihNz7tE\"; // \"AIzaSyDcKfuW77GTwA46L6sqD41YhGf2j5S8o2w\";\nvar package_name_d = \"com.get.deviceid\";\n\npush.StartGoogleCloudMessagingPushService(new GcmPushChannelSettings(project_id_d, api_key_d, package_name_d));\npush.QueueNotification(NotificationFactory.AndroidGcm()\n                .ForDeviceRegistrationId(reg_id_d)\n                .WithCollapseKey(\"NONE\")\n                .WithJson(\"{\\\"alert\\\":\\\"Alert Text!\\\",\\\"badge\\\":\\\"1\\\"}\"));\n</code></pre>\n\n<p>I am getting notification on my device but with blank message..</p>\n\n<p>I have tried with sever code available in C# to send GCM push notification, but getting same problem of having blank message. </p>\n\n<p>I tried using PHP to send notification. and it is working as expected. so, I am not sure what is wrong in my above code. Can anyone please help me on this?</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-entities","group-by"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":13283365,"title":"Difference between \"select new\" and \"Select(a => new\"","body":"<p>please consider this 2 queries and their result:</p>\n\n<pre><code>var result = ent.tblCustomGroupBies\n            .GroupBy(a =&gt; groupA.Contains(a.Group.Value) ? \"A\" :\n                          groupB.Contains(a.Group.Value) ? \"B\" :\n                          \"N/a\")\n            .Select(a =&gt; new\n            {\n                KEY = a.Key,\n                VALUE = a.Count()\n            });\n</code></pre>\n\n<p>and it's result in <code>GridView</code>::</p>\n\n<p><img src=\"http://i.stack.imgur.com/WuWDB.png\" alt=\"enter image description here\"></p>\n\n<p>and the second query:</p>\n\n<pre><code> var result3 = from p in ent.tblCustomGroupBies\n               group p by new { Criterion = groupA.Contains(p.Group.Value) ? \"A\" : \n                                            groupB.Contains(p.Group.Value) ? \"B\" : \n                                            \"N/a\" }\n               into g\n               select new { KEY = g.Key, VALUE = g.Count() };\n</code></pre>\n\n<p>and it's result in <code>GridView</code>::</p>\n\n<p><img src=\"http://i.stack.imgur.com/AOtJi.png\" alt=\"enter image description here\"></p>\n\n<p>why <code>Select(a =&gt; new)</code> in first query show key column but <code>select new</code> does not show that?</p>\n"},{"tags":["c#","javascript","wpf","webbrowser-control","ihtmldocument2"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":32,"score":4,"question_id":13253647,"title":"Getting return value from Javascript in C# Webbrowser control WPF","body":"<p>I made JavaScript injection into WebBrowser control in C# <code>(System.Windows.Controls.WebBrowser)</code>\nsuch that, <code>&lt;C#&gt;</code></p>\n\n<pre><code>IHTMLDocument2 webdoc = (IHTMLDocument2)webBrowser1.Document;\nstring var = File.ReadAllText(\"C:/.../Resources/script.txt\");\nobject retVal = webdoc.parentWindow.execScript(var, \"Jscript\");\n</code></pre>\n\n<p>and the JavaScript file script.txt is,\n</p>\n\n<pre><code>var headID = document.getElementsByTagName('head')[0];\nvar newScript = document.createElement('script');\nnewScript.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'\nheadID.appendChild(newScript)\n\n$('body').bind('click',function(e){\n    var domsArray = [];\n    for (var i = 0; i &lt; 15; i++){\n        for (var j = 0; j &lt; 15; j++){\n            if (document.elementFromPoint(e.clientX+i, e.clientY+j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX+i, e.clientY+j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX+i, e.clientY+j));\n            }if (document.elementFromPoint(e.clientX-i, e.clientY+j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX-i, e.clientY+j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX-i, e.clientY+j));\n            }if (document.elementFromPoint(e.clientX+i, e.clientY-j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX+i, e.clientY-j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX+i, e.clientY-j));\n            }if (document.elementFromPoint(e.clientX-i, e.clientY-j) &amp;&amp; (jQuery.inArray(document.elementFromPoint(e.clientX-i, e.clientY-j), domsArray) &lt; 0)){\n            domsArray.push(document.elementFromPoint(e.clientX-i, e.clientY-j));\n        }}}\nfor (var p = 0; p &lt; domsArray.length; p++){\n    alert(domsArray[p].href);\n}});\n</code></pre>\n\n<p>What it does is, whenever a user clicks on any point in webbrowser page, it collects the href near around that point.</p>\n\n<p>I wanted to return the href array, to my C# so that I can create buttons with those links.</p>\n\n<p>However, when I tried,</p>\n\n<pre><code>Console.WriteLine(retVal);\n</code></pre>\n\n<p>It didn't print anything on console.\nEven after I cast them into things like string or int with other dummy return values, it didn't print anything.\nAm I getting correct return?\nIs there any way that I can test the output return from javascript?</p>\n"},{"tags":["c#",".net","vb.net","visual-studio"],"answer_count":8,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1066,"score":5,"question_id":4662784,"title":"Visual Studio: Is there a way to navigate to real implementation of method behind an interface?","body":"<p>In Visual Studio, when you right-click a method call, you go to the implementation of that method inside a class except if you access this method through an interface: in that case you go to the interface method not to the actual implementation.</p>\n\n<p>Is there a way / tips (key shortcut or anything) to access this actual implementation ? Otherwise you are stuck to add some comment just to remember where you did implement it that's really not productive and error prone !</p>\n\n<p>Update: interesting answers but I'm not really satisfied because all are cumbersome. I will give a precise example:</p>\n\n<pre><code>        IInterface iInterface = someObject;                        \n        iInterface.someMethod();\n</code></pre>\n\n<p>Actually if Visual Studio was just a little bit clever to look just one line above the method call it would see where's the real object is. And that would save me a lot of keystrokes and avoid to use \"find all references\" and then scan the lines with my tired eyes to see which line contain the right one :)</p>\n"},{"tags":["c#",".net","winforms","antivirus","sharpdevelop"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":442,"score":4,"question_id":7339265,"title":".Net WinForms : OpenFileDialog is blocked by Norton Antivirus if project was generated by SharpDevelop","body":"<p>If you create a new winform project with SharpDevelop 4, then drag an OpenFileDialog (or SaveFileDialog) to the form, then show the dialog (.ShowDialog), Norton internet security 2011 blocks the application and delete it (the binary). The sonar protection of norton reports a \"suspicious behaving\" of the application.\nThis does not happens with projects created by Visual Studio. I run Win 7.</p>\n\n<p>I thought maybe this have something to do with a lack of single-threaded apartment attribute. Does SharpDevelop use this attribute for winforms? Where it is located? And in general: What difference between SharpDevelop and Visual Studio's Auto-generated code may cause this?</p>\n\n<p>EDIT:</p>\n\n<ul>\n<li>The problem occurs both inside SharpDevelop debugging and outside with the binary.</li>\n<li>Setting .AutoUpgradeEnabled to False solved the problem. However, when code generated by Visual Studio,\nthe problem doesn't occur regardless of the value of .AutoUpgradeEnabled.</li>\n</ul>\n"},{"tags":["c#","entity-framework","parent-child"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13283595,"title":"multiple parent Entities with one child entity in EF code first","body":"<p>there are tow entities <code>Post</code> and <code>Photo</code> . both have a collection of <code>comment</code> entity .</p>\n\n<p>is there anyway to avoid the <code>mapping</code> written below (being have to define <strong>one</strong> property for <strong>each</strong> parent in <code>Comment</code> entity ) ?</p>\n\n<pre><code>public class Post\n{\n    public string Title {get; set;}\n    public ICollection&lt;Comment&gt; Comments{get; set; }\n}\n\npublic class Photo\n{\n    public string Path{get;set;}\n    public ICollection&lt;Comment&gt; Comments{get; set; }\n}\n\npublic class Comment\n{\n    public int? PostId{get;set;}\n    public Virtual Post Post{get;set;}\n\n    public int? PhotoId{get;set;}\n    public Virtual Photo Photo{get;set;}\n}\n</code></pre>\n"},{"tags":["c#","sql-server-2008","asp.net-mvc-2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13283661,"title":"Populating an empty list with values from a linq query in mvc2 ASP.NET","body":"<p>I have 3 tables. One named 'Participant' , the other named 'Employee' and the last one as 'Attendance Track'. I want to display participants who are not in the Attendance Track table during updation. The viewing needs to be done in a dropdownlist.</p>\n\n<p>Can anyone please tell me how can i do it? I am new to MVC.</p>\n"},{"tags":["c#","sql-server","microsoft","sync","microsoft-sync-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13265884,"title":"Microsoft Sync Framework for File (Client) and SQL Server Database (Server) synchronization","body":"<p>I'm trying to implement the syncing solution using Microsoft Sync Framework. The server will be SQL server database contains the documents in FileStream and client will be the File system (Windows OS). \nI have seen file synchronization provider with the Azure Blob Storage/Custom provider. But have not seen this. Do anybody have any idea on this.\nMy application scenario is :The database server contains the File/Documents in the form of byte array by the FileStream mechanism from SQL server.\nAnd the Sync activity will syncronize the documents from SQL server to any given file system.\nPlease help me out.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","cluster-analysis","levenshtein-distance","string-similarity"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":80,"score":2,"question_id":13275408,"title":"String similar to a set of strings","body":"<p>I need to compare a set of strings to another set of strings and find which strings are similar (fuzzy-string matching). \nFor example: </p>\n\n<pre><code>{ \"A.B. Mann Incorporated\", \"Mr. Enrique Bellini\", \"Park Management Systems\" } \nand\n{ \"Park\", \"AB Mann Inc.\", \"E. Bellini\" }\n</code></pre>\n\n<p>Assuming a zero-based index, the matches would be 0-1, 1-2, 2-0. Obviously, no algorithm can be perfect at this type of thing.</p>\n\n<p>I have a working implementation of the Levenshtein-distance algorithm, but using it to find similar strings from each set necessitates looping through both sets of strings to do the comparison, resulting in an O(n^2) algorithm. This runs unacceptably slow even with modestly sized sets.</p>\n\n<p>I've also tried a <a href=\"http://matpalm.com/resemblance/jaccard_coeff/\" rel=\"nofollow\">clustering algorithm</a> that uses shingling and the Jaccard coefficient. Unfortunately, this too runs in O(n^2), which ends up being too slow, even with bit-level optimizations. </p>\n\n<p>Does anyone know of a more efficient algorithm (faster than O(n^2)), or better yet, a library already written in C#, for accomplishing this? </p>\n"},{"tags":["c#","wpf","data-binding","usercontrols"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13281957,"title":"How to bind the text in a textbox of a usercontrol into a textblock?","body":"<p>I create a user Control textbox and i want to bind the textblock to what i type in the user control's textbox. I try some code, but it doesn't work. Anyone can teach me? Thanks</p>\n\n<p>My userControl TextBox:</p>\n\n<pre><code>&lt;Grid  Background=\"Silver\" Style=\"{StaticResource EntryFieldStyle}\"  Width=\"175\" Height=\"25\" Margin=\"0\" &gt;          \n    &lt;TextBox Name=\"watermarkTextBox\" Background=\"Green\"   /&gt;    \n&lt;/Grid&gt;\n</code></pre>\n\n<p>My xaml code:</p>\n\n<pre><code>&lt;StackPanel Orientation=\"Horizontal\"&gt;\n      &lt;UserControls:WatermarkTextBox x:Name=\"usernameArea\"/&gt;\n      &lt;TextBlock Text=\"{Binding ElementName=usernameArea Path=watermarkTextBox.Text}\"  FontSize=\"13\" Foreground=\"White\"/&gt; \n&lt;/StackPanel&gt;\n</code></pre>\n"},{"tags":["c#","asp.net","asp.net-mvc","wcf","http"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":13063983,"title":"Run asynchronous operation in one controller method and get that operation's result in another","body":"<p>I have a long running operation you might read in couple of my another questions (for your reference here is <a href=\"http://stackoverflow.com/questions/12836060/articles-on-how-to-organize-background-queue-operations\">first</a> and <a href=\"http://stackoverflow.com/questions/12900382/how-to-determine-progress-of-pending-operations-in-queue\">second</a>). </p>\n\n<p>In the beginning of whole deal, project expose a form in which user should specify all necessary information about XML file and upload XML file itself. In that method all user input data caught and went to an WCF service that handles such king of files. Controller got only task id of such processing. \nThen user got redirected to progress bar page and periodically retrieves status of task completeness, refreshes the progress bar.</p>\n\n<p>So here is my issue comes. When processing of XML file if over, how can I get results back and show them to user?</p>\n\n<p>I know that HTTP is stateless protocol but there is cookie mechanism that could help in this situation. Of course, I may just save processing results to some temporary place, like a static class in WCF server, but there is a high load on service, so it will eat all of supplied memory.</p>\n\n<p>In other words, I would like to pass task to WCF service (using netNamedPipeBinding) and receive results back as fast as it really possible. I want to escape temporary saving result to some buffer and wait until client will gather it back.</p>\n\n<hr>\n\n<p>As far as I go is using temporary buffer not on service side but at client's:</p>\n\n<pre><code>using (XmlProcessingServiceClient client = new XmlProcessingServiceClient())\n{\n    client.AnalyzeXmlAsync(new Task { fileName = filePath, id = tid });\n    client.AnalyzeXmlCompleted += (sender, e) =&gt;\n    {\n        System.Web.HttpContext.Current.Application.Lock();\n        // here is I just use single place for all clients. I know it is not right, it is just for illustrating purposes.\n        System.Web.HttpContext.Current.Application[\"Result\"] = e;\n        System.Web.HttpContext.Current.Application.UnLock();\n    };\n}\n</code></pre>\n"},{"tags":["c#","console"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13283184,"title":"C# Column formatting","body":"<p>I'm trying to format some output to the console but having some problems with a solution.\nI'm doing it in C# but everything time I call Console.Write it prints the the entire thing to the very end of the console then starts a new line. So what I want to do is adjust it to four columns and then start a newLine there. </p>\n\n<p>Here's the correct way the output should look like in the console:</p>\n\n<pre><code>Sam       John      Bob     Adam\n\nKelly     Nolan     Carl    Tim\n\nTom       David\n</code></pre>\n\n<p>Here's whats mine turns out to look like but its the wrong way:</p>\n\n<pre><code>Sam    John    Bob    Adam  Kelly  Nolan   Carl   Tim\n\nTom    David\n</code></pre>\n\n<p>If you have any ideas please provide them</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13282970,"title":"C# which is right or better expression?","body":"<pre><code>DateTime theMonth = DateTime.Now;\nfor(int i = 0; i&lt;8; i++){\n     string curMonth = theMonth.AddMonths(-i).ToString(\"MM/yyyy\");\n}\n</code></pre>\n\n<p>Or,</p>\n\n<pre><code>DateTime theMonth = DateTime.Now;\nstring curMonth;\nfor(int i = 0; i&lt;8; i++){\n     curMonth = theMonth.AddMonths(-i).ToString(\"MM/yyyy\");\n}\n</code></pre>\n\n<p>which is right or better expression? Or same?</p>\n"},{"tags":["c#","sharepoint","sharepoint2010","content-type","sharepoint-designer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13280088,"title":"How to change default Content type of Wiki Library items in Sharepoint 2010","body":"<p>I am working on a SharePoint 2010 Wiki Library. The items in the Wiki Library have a default content type 'Wiki Page'. </p>\n\n<p>I have created my custom content type with some additional fields. I would like to change the default content type and assign my custom content type to existing items in Wiki Library i.e. from 'Wiki Page' to 'My Custom Content Type'</p>\n\n<p>Please let me know how we can go about changing the content type in Wiki Library.</p>\n\n<p>Any comment/feedback is greaatly appreciated.</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","entity-framework","objectcontext"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13282083,"title":"ContextCreating method in EntityDataSource cannot convert Entities to ObjectContext","body":"<p>Using EntityFramework, I have created an EntityDataModel (.edmx file) in App_Code\\DAL. In the wizard, I named the entities 'DLGDBEntities'. I have a number of <code>EntityDataSource</code>s in the .aspx where I've set the <code>OnContextCreating</code> attribute to 'UseSurveyContext' which looks like this:</p>\n\n<pre><code>protected void UseSurveyContext(object sender, EntityDataSourceContextCreatingEventArgs e)\n{\n   e.Context = surveyContext;\n}\n</code></pre>\n\n<p>Setup code for the surveyContext is as follows:</p>\n\n<pre><code>DLGDBEntities surveyContext;\n</code></pre>\n\n<p>and in Page_Load:</p>\n\n<pre><code>surveyContext = new DLGDBEntities();\n</code></pre>\n\n<p>All of the above looks like the same code I've seen in every tutorial (eg: <a href=\"http://msdn.microsoft.com/en-us/library/cc668193.aspx#1\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/cc668193.aspx#1</a>), and I could swear I've had it working.</p>\n\n<p>Now however, I am getting the error: <code>Cannot implicitly convert type 'DAL.DLGDBEntities' to 'System.Data.Objects.ObjectContext'</code></p>\n\n<p>What have I done wrong, and why did it work before?</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13283439,"title":"Error:Retrieving the COM class factory for component with CLSID (how to write data in excel sheet)?","body":"<p>I am trying to write data into excel file and using </p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application oXL = new Microsoft.Office.Interop.Excel.Application();\nMicrosoft.Office.Interop.Excel.Workbook oWB;\nMicrosoft.Office.Interop.Excel.Worksheet oSheet;\nMicrosoft.Office.Interop.Excel.Range oRange;   \n</code></pre>\n\n<p>but I am getting an error</p>\n\n<p>Retrieving the COM class factory for component with CLSID {00024500-0000-0000-C000-000000000046} failed due to the following error: 80040154.</p>\n\n<p>I am using open office calc. it have the option to save file in .xls</p>\n\n<p>Can any one tell me how to write the data in excel if user is using or not not using MS office Excel.</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":32,"score":-5,"question_id":13283135,"title":"C# Counting word occurance in two textboxes","body":"<p>I'm trying to create a program that counts the number of times a word appears within a textbox.\nThere are two textboxes , one that lets the user input a word and the other one for text that the user also inputs. The program then counts how many times that word appears in the other textbox.</p>\n\n<p>I have to use this method</p>\n\n<pre><code>private int countword(string st1, string st2, bool bool1)\n</code></pre>\n\n<p>Maybe someone can point me in the right direction.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13266766,"title":"How can i skip extra rows in excel while importing it into database using SqlBulkCopy?","body":"<p>I am importing ExcelSheet into SQL server database, the problem I have is that the ExcelSheet has around 25 columns while the database table has 15 rows. I need to skip the extra unwanted rows in excel, e.g:</p>\n\n<pre><code>using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n{                  \n   bulkCopy.ColumnMappings.Add(\"PP NO\", \"passportnumber\");\n   bulkCopy.ColumnMappings.Add(\"COVER NO\", \"covernumber\");\n   bulkCopy.ColumnMappings.Add(\"NAME\", \"paxname\");\n   .....\n}\n</code></pre>\n\n<p>The error I am getting is \n<code>The given ColumnMapping does not match up with any column in the source or destination.</code></p>\n"},{"tags":["c#",".net-3.5","llblgenpro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276538,"title":"Llblgen update table?","body":"<p>Simply i wanna know </p>\n\n<p><strong>update table set (name,surname) values ('John','Locke') where Id=1</strong> \nsql statment equivalent in llblgen, i tried below code but it didn't work.</p>\n\n<pre><code>            Entity e = new Entity();\n            entity.Id = 1;\n            entity.name = \"John\";\n            entity.surname = \"Locke\";\n            entity.Save();\n</code></pre>\n\n<p>can anyone help?</p>\n"},{"tags":["c#",".net","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13277657,"title":"How do I download the contents of a HTTPS web page?","body":"<p>To get to the page, I need a password. I have the password and I can get to the page.</p>\n\n<p>The DownloadString(URL) function is downloading the contents of the LOG-IN page and not the actual page I want. Why?</p>\n\n<pre><code>using (var client = new WebClient())\n            {\n                var credentials = new NetworkCredential { UserName = \"username\", Password = \"password\" };\n                client.Credentials = credentials;\n\n                string pageContents = client.DownloadString(url);\n\n                if (pageContents.Contains(\"cheetah\"))\n                {\n                    MessageBox.Show(\"yes!\");\n                }\n                else\n                {\n                    MessageBox.Show(\"No\");\n                }\n            }\n</code></pre>\n\n<p>The above is getting the contents of the LOG-IN page as opposed to the page I really want. How do I get passed this?</p>\n"},{"tags":["c#","xml","loops","foreach","nodes"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11090,"score":1,"question_id":4650277,"title":"Xml node reading for each loop","body":"<p>I am trying to loop through an Xml file and display the value for account in a message.</p>\n\n<pre><code>XmlNodeList nodeList = testDoc.SelectNodes(\"/details/row/var\");\nforeach (XmlNode no in nodeList)\n{\n   XmlNode node = testDoc.SelectSingleNode(\"/details/row/var[@name='account']\");\n   test.actual = node.Attributes[\"value\"].Value;\n\n   MessageBox.Show(test.account);\n }\n</code></pre>\n\n<p>The message box is currently displaying the first record repeatidly, how can I get to the next record?</p>\n\n<p>Thanks for your input in advance.</p>\n"},{"tags":["c#","asp.net","json"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13271158,"title":"Way to Deserialize JSON from HttpWebResponse","body":"<p>I'm trying to figure out the best way to parse incoming JSON server-side in .NET 3.5.\nI am receiving \"title\" from HttpWebResponse in JSON Formate. so i have to retrieve each title and store in the database. so please provide the code for retrieving each title.  </p>\n\n<pre><code>public class MyObject\n{\n    public ArrayList list { get; set; }\n}\n\n    var request = WebRequest.Create(\"https://api.dailymotion.com/videos?fields=description,thumbnail_medium_url%2Ctitle&amp;search=Good+Morning\");\n    using (var twitpicResponse = (HttpWebResponse)request.GetResponse())\n    {\n        using (var reader = new StreamReader(twitpicResponse.GetResponseStream()))\n        {\n            JavaScriptSerializer js = new JavaScriptSerializer();\n            string objText = reader.ReadToEnd();\n            MyObject myojb = (MyObject)js.Deserialize(objText, typeof(MyObject));\n        }\n    }\n</code></pre>\n\n<p>I am receiving Title in the myojb but how to retrieve Each Title from myojb.</p>\n"},{"tags":["c#",".net","dictionary","multimap"],"answer_count":19,"favorite_count":13,"up_vote_count":67,"down_vote_count":0,"view_count":41369,"score":67,"question_id":146204,"title":"Duplicate keys in .NET dictionaries?","body":"<p>Are there any dictionary classes in the .NET base class library which allow duplicate keys to be used?  The only solution I've found is to create, for example, a class like:</p>\n\n<pre><code>Dictionary&lt;string, List&lt;object&gt;&gt;\n</code></pre>\n\n<p>But this is quite irritating to actually use.  In Java, I believe a MultiMap accomplishes this, but cannot find an analog in .NET.</p>\n"},{"tags":["c#","winforms",".net-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13283077,"title":"EventRegister missing in advapi32 w/Winforms .Net 4.0 app on some XP SP3 systems","body":"<p>I've got a small C# Winforms .net framework 4.0 (extended, not client profile) app that runs fine on Win7, runs intermittently on XP SP3 - depending on the machine or VM. </p>\n\n<p>When it fails, I get this:</p>\n\n<p>System.TypeInitializationException occurred\n  Message=The type initializer for 'System.Diagnostics.Eventing.FrameworkEventSource' threw an exception.\n  Source=mscorlib\n  TypeName=System.Diagnostics.Eventing.FrameworkEventSource\n  InnerException: System.EntryPointNotFoundException\n       Message=Unable to find an entry point named 'EventRegister' in DLL 'advapi32.dll'.\n       Source=mscorlib\n       TypeName=\"\"\n       InnerException: </p>\n\n<p>It happened on this line of code (generated in formname.designer.cs):\nthis.btnBuildPreso.BackgroundImage = global::SummitPPTManager.Properties.Resources.mortarboard;</p>\n\n<p>I created a XP Pro SP3 VM and reproduced the problem, but it was early in the initialization and so vague that it was of no use to me. Somehow, I managed to get it to go past that (not sure how). </p>\n\n<p>Based on <a href=\"http://stackoverflow.com/questions/4154079/net-winforms-app-dies-on-startup\">.NET Winforms app dies on startup</a>, I installed debugging tools but they told me nothing that meant anything to me. I tried to get remote debugging from the dev host Win7 Ult 64 to the \"remote\" (a VM running XP Pro SP3) but I couldnt ever get them to cooperate. </p>\n\n<p>Finally, I installed VS2010 on the failing XP VM, copied the source there and built the app there. It still fails and the debug info doesnt help much - at least it doesnt help me. </p>\n\n<p>I get \"The type initializer for 'System.Diagnostics.Eventing.FrameworkEventSource' threw an exception.\", which is a System.TypeInitializationException. It happens in various places, most recently on a XMLTextReader.MoveToContent() call. </p>\n\n<p>In each case of this exception, which has occurred in various places, the inner exception says \"Unable to find an entry point named 'EventRegister' in DLL 'advapi32.dll'.</p>\n\n<p>If I dig deeper into the exception on that XML method, I see 'culture.DisplayName' threw an exception of type 'System.TypeInitializationException'. </p>\n\n<p>The code where this occurs looks like this:</p>\n\n<pre><code>public static void GetSummitSettings()\n  {\n System.Globalization.CultureInfo culture = new System.Globalization.CultureInfo(\"en-US\", false);\n\n   try\n       {\n        XmlTextReader reader = new XmlTextReader(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + \"\\\\SummitPPTConfig.xml\");\n\n         try\n           {\n\n            try\n               {\n                  reader.MoveToContent();  // &lt;----- DIES HERE\n               }\n\n               catch (XmlException)\n               {\n                   _RegisteredEmailAddress = \"\";\n                   //System.Globalization.CultureInfo culture = new System.Globalization.CultureInfo(\"en-US\", false);\n                  _LastGoodConnect = DateTime.ParseExact(\"01/01/2012\", \"MM/dd/yyyy\", culture);\n                  reader.Close();\n                 return;\n                }\n\n    // yada...\n</code></pre>\n\n<p>I'm out of ideas and am all ears. While Ive been doing this a lot of years, C# and VS2010 are fairly new to me. Not supporting XP is unfortunately not an option for this app. </p>\n\n<p>EDIT: Naturally after documenting all of this, I randomly wondered if the XML file not existing would cause this, so I created one. The error went away. </p>\n\n<p>So now, I'm still curious why such an obtuse exception was thrown. The EventRegister inner exception sent me way off into the weeds for far too long.</p>\n\n<p>What <em>should</em> I have done when I saw that eventregister advapi32.dll inner exception?</p>\n"},{"tags":["c#","wpf","data-binding","datagridcomboboxcolumn"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13283215,"title":"Binding WPF DataGridComboBoxColumn with MVVM (WAF)","body":"<p>Help me to solve binding problem. The poject is in WPF + <a href=\"http://waf.codeplex.com\" rel=\"nofollow\">WAF</a> + ef code first. I want to bind DataGridComboBoxColumn value to models property, but something not working.\nModels:</p>\n\n<pre><code>public class DocumentMove\n    {\n        [Key]\n        public Guid DocumentMoveId { get; set; }\n        public Guid RawMaterialId { get; set; }\n        public RawMaterial RawMaterial { get; set; }\n        public decimal Amount { get; set; }\n        public decimal Price { get; set; }\n    }\n\npublic class RawMaterial\n    {\n        [Key]\n        public Guid RawMaterialId { get; set; }\n        public RawMaterialGroup Group { get; set; }\n        [MaxLength(20)]\n        public string Code { get; set; }\n        public Colour Colour { get; set; }        \n        [MaxLength(100)]\n        public string Name { get; set; }\n        public Measure Measure { get; set; }        \n        public List&lt;ArrLocation&gt; ArrLocations { get; set; }        \n        public List&lt;RawMove&gt; RawMoves { get; set; }\n        public Delivery Supplier { get; set; }\n        public RawMaterial()\n        {            \n        }\n}\n</code></pre>\n\n<p>The grid:</p>\n\n<pre><code>&lt;DataGrid x:Name=\"documentMoveTable\" AutoGenerateColumns=\"False\" ItemsSource=\"{Binding DocumentMoves}\" \n        SelectedItem=\"{Binding SelectedDocumentMove}\" CanUserDeleteRows=\"False\" IsReadOnly=\"False\" RowEditEnding=\"documentMoveTable_RowEditEnding\"&gt;\n        &lt;DataGrid.InputBindings&gt;\n            &lt;KeyBinding Command=\"{Binding RemoveCommand}\" Key=\"Del\"/&gt;\n        &lt;/DataGrid.InputBindings&gt;\n\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridComboBoxColumn Header=\"{x:Static p:Resources.RawMaterial}\"\n                SelectedValueBinding=\"{Binding RawMaterialId}\" \n                DisplayMemberPath=\"Name\" SelectedValuePath=\"RawMaterialId\"&gt;\n\n                &lt;DataGridComboBoxColumn.ElementStyle&gt;\n                        &lt;Style TargetType=\"{x:Type ComboBox}\"&gt;\n                            &lt;Setter Property=\"ItemsSource\" Value=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.RawMaterials}\" /&gt;\n                            &lt;Setter Property=\"IsReadOnly\" Value=\"True\"/&gt;\n                        &lt;/Style&gt;\n                &lt;/DataGridComboBoxColumn.ElementStyle&gt;\n                &lt;DataGridComboBoxColumn.EditingElementStyle&gt;\n                        &lt;Style TargetType=\"{x:Type ComboBox}\"&gt;\n                            &lt;Setter Property=\"ItemsSource\" Value=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.RawMaterials}\" /&gt;\n                        &lt;/Style&gt;\n                &lt;/DataGridComboBoxColumn.EditingElementStyle&gt;\n            &lt;/DataGridComboBoxColumn&gt;\n\n            &lt;DataGridTextColumn Binding=\"{Binding Amount, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, \n                                ValidatesOnExceptions=True, NotifyOnValidationError=True}\"\n                                Header=\"{x:Static p:Resources.Amount}\" Width=\"*\" ElementStyle=\"{StaticResource TextCellElementStyle}\"/&gt;\n\n            &lt;DataGridTextColumn Binding=\"{Binding Price, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, \n                                ValidatesOnExceptions=True, NotifyOnValidationError=True}\"\n                                Header=\"{x:Static p:Resources.Price}\" Width=\"*\" ElementStyle=\"{StaticResource TextCellElementStyle}\"/&gt;\n\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>And ViewModel:</p>\n\n<pre><code>[Export]\npublic class EditDocumentViewModel : ViewModel&lt;IEditDocumentView&gt;\n{\n    private IEnumerable&lt;DocumentMove&gt; _documentMoves;        \n    private ICommand _removeCommand;        \n    private ICommand _editListCommand;\n\n    public IEnumerable&lt;DocumentMove&gt; DocumentMoves\n    {\n        get { return _documentMoves; }\n        set\n        {\n            _documentMoves = value;\n            RaisePropertyChanged(\"DocumentMoves\");\n        }\n    }\n\n    public DocumentMove SelectedDocumentMove { get; set; }\n</code></pre>\n\n<p>...</p>\n\n<pre><code>}\n</code></pre>\n\n<p>While trying add a new row to grid, I can select a value from ComboBox and add values for \"Amount\" and \"Price\". On the Controller's side while handling the EditListCommand the values of <code>_editDocumentViewModel.SelectedDocumentMove.Amount</code> and <code>_editDocumentViewModel.SelectedDocumentMove.Price</code> are present but the value of <code>_editDocumentViewModel.SelectedDocumentMove.RawMaterialId</code> and <code>_editDocumentViewModel.SelectedDocumentMove.RawMaterial</code> are empty. I think something in my ComboBoxColumn binding is wrong, or may be something else?</p>\n\n<p>I have seen several similar question <a href=\"http://stackoverflow.com/questions/5517789/binding-a-wpf-datagridcomboboxcolumn-with-mvvm\">1</a> , <a href=\"http://stackoverflow.com/questions/5409259/binding-itemssource-of-a-comboboxcolumn-in-wpf-datagrid\">2</a>, but\n cant find how to fix it.</p>\n\n<p>Please help, and sorry for my english ) .</p>\n"},{"tags":["c#",".net","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13278793,"title":"Regex end-of-line anchor doesn't always work","body":"<p>I'm working on an ASP .NET (C#) project that makes use of regular expressions and I'm having trouble with the end-of-line anchors! I'm looking for some text and I want to make sure it only occurs at the end of a string.</p>\n\n<p>Here's some sample input that demonstrates my problem. For this case I'm trying to match the word \"text\" at the end.</p>\n\n<blockquote>\n  <p>This text is my sample text</p>\n</blockquote>\n\n<p>And here are the expressions I've tried (with the IgnoreCase option):</p>\n\n<pre><code>text\\z\ntext\\Z\ntext$\n</code></pre>\n\n<p>Now here's the crazy part. None of these regular expressions work on my system (Windows 8 Pro 64-bit, VS2010, .NET 4.0). I've debugged in my project and I've also tried the \"Regex Tester\" app from the Windows 8 store. It will not match!</p>\n\n<p>However, if I use an online regex tester, for example Derek Slager's at <a href=\"http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx\" rel=\"nofollow\">his blog post</a> which runs on .NET, or this Silverlight one at <a href=\"http://regexhero.net/tester/\" rel=\"nofollow\">http://regexhero.net/tester/</a>, using the exact same patterns and inputs, it matches the final instance of \"text\" with no problem.</p>\n\n<p>I'm confused. I really need reliable end-of-string matching and I don't know what I'm doing wrong.</p>\n\n<p>EDIT: Apparently I can't used compiled regex's. Here's an example using the data the project actually runs on:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        string url = \"http://192.168.0.113/MidlandGIS/rest/services/Osceola_Assessor_Data/MapServer/?f=pjson\";\n        string pattern = @\"mapserver/\\?f=(json|pjson)$\";\n\n        Regex myRegex = new Regex(pattern, RegexOptions.IgnoreCase &amp; RegexOptions.Compiled);\n        Console.Write(\"Trying compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        myRegex = new Regex(pattern, RegexOptions.IgnoreCase);\n        Console.Write(\"Trying non-compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        Console.Write(\"Trying inline regex: \");\n        if (Regex.IsMatch(url, pattern, RegexOptions.IgnoreCase))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match\");\n\n        Console.Write(\"Press any key to terminate.\");\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>outputs</p>\n\n<blockquote>\n  <p>Trying compiled regex: No match</p>\n  \n  <p>Trying non-compiled regex: Match</p>\n  \n  <p>Trying inline regex: Match</p>\n  \n  <p>Press any key to terminate.</p>\n</blockquote>\n\n<p>Edit again: OK I'm a complete idiot. I was using bitwise AND when I should be using bitwise OR to combine the regex options. Compiled regex's work just fine now.</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13282980,"title":"How to create a List of Func<T1, T2, out T3>","body":"<p>I suspect this is more simple than I think!</p>\n\n<p>I can create a list of Func and then add to it</p>\n\n<pre><code>var x = new List&lt;Func&lt;IBQCustomer, string&gt;&gt;();\nx.Add(c =&gt; c.FullName);\n</code></pre>\n\n<p>Bu how to I add an extra parameter into the Func? When I try I get an error</p>\n\n<pre><code>var y = new List&lt;Func&lt;IBQCustomer, OrderByDirection, string&gt;&gt;();\ny.Add(...);\n</code></pre>\n\n<p>Is this possible?</p>\n\n<p>I am aiming to build up a list of properties and what to do with them</p>\n\n<hr>\n\n<p>Error:</p>\n\n<pre><code>y.Add(c =&gt; c.FullName, OrderByDirection.Asc);\nNo overload for Add that takes 2 arguments\n</code></pre>\n"},{"tags":["c#","winforms","mschart"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":16,"score":3,"question_id":13283118,"title":"Interpolation implementation in MS Chart","body":"<p>I require to implement Interpolation and Extrapolation in Ms-Chart in Windows Application.</p>\n\n<p>For Interpolation I am using \"MathNet\" Library. but still I am unaware to implement this.</p>\n\n<p>I have try to implement the Interpolation as below.</p>\n\n<pre><code>using MathNet.Numerics.Interpolation.Algorithms;\n\nNevillePolynomialInterpolation objIterpolate = new NevillePolynomialInterpolation(Xpoints, Ypoints);\n\n    double NewYValue;\n    NewYValue = Math.Abs(objIterpolate.Interpolate(newValue); \n</code></pre>\n\n<p>I am passing in  XPoints in <code>NevillePolynomialInterpolation()</code> as a First Parameter which is XValues array of my chart.  and Ypoints as a YValues array of my chart.</p>\n\n<p>I am passing <code>newValue</code> as a XValue for getting interpolated value.</p>\n\n<p>Can anybody suggest, Is it right way or suggest the correct way to implement Interpolation.</p>\n"},{"tags":["c#","generics"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13282553,"title":"Can we write List as a type argument in Generics in C#?","body":"<p>For Example, function prototype is:</p>\n\n<pre><code> void set&lt;V&gt;(Type a, V b);\n</code></pre>\n\n<p>and we call it as:</p>\n\n<pre><code> int a;\n list&lt;int&gt; b;\n\nset&lt;List&lt;int&gt;&gt;(a,b); \n</code></pre>\n"},{"tags":["c#","winforms","mouse"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13282713,"title":"Changing Mouse Cursor to pencil in Drawing panel","body":"<p>In my Winform app, i have a Drawing panel. </p>\n\n<p>when i move my cursor within the drawing panel, cursor should be changed to <em>pencil</em>\nhow can i do this ?</p>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13283079,"title":"Use grid values from one page to another page function window application","body":"<p>  How i can use grid values from one page to another page function definition.  </p>\n"},{"tags":["c#","asp.net","telerik","rad-controls","radcombobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13264747,"title":"How to bind Radcombobox items client side with database values?","body":"<p>I am using oracle as my back end. how to bind radcombobox with database(oracle) table values form client side.\nas follows if i have emp table then columns are emp id and name so i has to bind emp id and name to rad combo box form client side.</p>\n"},{"tags":["c#","crystal-reports","visual-studio-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13171348,"title":"text rotation 180 degree in crystal report","body":"<p>How to rotate text 180 degree in crystal report?<br>\nI'm using visual studio 2005 with c#.<br>\nThere's text rotation angle property in crystal report but there's no 180 degree.<br>\nI don't want to use image.<br>\nI want to display some data are rotate 0 degree, some are 180 degree, some are 270 degree.<br>\nThanks in advance.</p>\n"},{"tags":["c#","wpf","image","xaml","image-processing"],"answer_count":5,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":2961,"score":10,"question_id":5645274,"title":"Image in WPF getting Blurry","body":"<p>I am developing an application in WPF using C#. I am putting Images in a WrapPanel and showing inside a Grid with one more Border and using images in Buttons also. Problem is my Image control loosing its quality. I am not able to post my image here so I am simply describing here.</p>\n\n<p>I used <code>SnapsToDevicePixels=\"True\"</code> for the images but still it looks blurry.</p>\n\n<p>Updated:</p>\n\n<p>Here I shared the Image below:\n<img src=\"http://i.stack.imgur.com/mC78t.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","winforms","visual-studio-2012"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13282144,"title":"c# replace timestamp value string of text in textfield","body":"<p>i currently have a textbox field, everytime a change is made, i add who it was updated by and what time</p>\n\n<p>right now it keep appending that text</p>\n\n<p>how can i find the line that says \"LastEdited: \", and only replace the time stamp value?</p>\n\n<p>this is what i do now\nmaybe someone can post me example of code how to grab the timestamp and replace it?</p>\n\n<pre><code>if (txtMemberNotesOriginally != txtMemberNotesChanged) {\n            txtMemberNotes.AppendText(\"LastEdited: \" + DateTime.Now.ToString() + \" By: \" + MyProgramName.Username + Environment.NewLine);\n</code></pre>\n\n<p>i am not an expert, so an example of code would bevery useful</p>\n\n<p>i  do use this textbox to save other notes as well (which i wouldn't wanna loose)</p>\n\n<p>can i do this</p>\n\n<pre><code>foreach (var line in txtMemberNotes.Lines) {\n                if (line.StartsWith(\"Last Edited: \"))\n                {\n                    txtMemberNotes.Text = txtMemberNotes.Text.Replace(line, \"Last Edited: \" + DateTime.Now.ToString() + \" By: \" + MyProgramName.Username + Environment.NewLine);\n                }\n                else \n                {\n                    txtMemberNotes.AppendText(\"Last Edited: \" + DateTime.Now.ToString() + \" By: \" + MyProgramName.Username + Environment.NewLine);\n                }\n            }\n</code></pre>\n"},{"tags":["c#","asp.net","usercontrols","datatable"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":12078,"score":5,"question_id":5892993,"title":"How to calculate the sum of the datatable column in asp.net?","body":"<p>I have a DataTable which has 5 columns:</p>\n\n<ul>\n<li>ID</li>\n<li>Name</li>\n<li>Account Number</li>\n<li>Branch </li>\n<li>Amount</li>\n</ul>\n\n<p>The DataTable contains 5 rows.</p>\n\n<p>I want to show the sum of the Amount Column in a Label Control as \"Total Amount\"</p>\n\n<p>What is the best way of doing this?</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","linq","entity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13276745,"title":"Creating Navigation Property without foreign key?","body":"<p>I am trying to create a navigation property for my data model using an existing database.  The data has a shared key (like a foreign key) however it is not specified that way in the database.  Here is what it looks like:</p>\n\n<pre><code> [Table(\"Alpha\")]\n    public class Alpha\n    {\n        public int AlphaID { get; set; }\n\n        public int AlphaGroupID { get; set; }\n\n        public int? ParentAlphaID { get; set; }\n\n        public int? CodeID { get; set; }\n\n        public int? BracketCodeID { get; set; }\n\n        public string Title { get; set; }\n    }\n\n\n\n\n\n[Table(\"AlphaGroup\")]\n    public class AlphaGroup\n    {\n        [Column(\"AlphaGroupID\")]\n        public int AlphaGroupID { get; set; }\n\n        public string Title { get; set; }\n\n        public string TitleAddon { get; set; }\n\n    }\n</code></pre>\n\n<p>AlphaGroupID needs to be a navigation property to AlphaGroupID but is not a foreign key.  Is there a way to accomplish this?</p>\n"},{"tags":["c#","wpf","windows","controlpanel","windows-search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13264646,"title":"Access windows control panel items (applets) via c# code","body":"<p>I am new to this and i have a small task. I want to access the <code>control panel items</code>, perform <code>search</code> and <code>display their name, description and task lists</code> etc what ever I can access in my window. Something similar to what windows explorer search does.</p>\n\n<p>This is what I have done till now. I followed the approach <a href=\"http://www.codeproject.com/Articles/6105/Enumerate-and-Host-Control-Panel-Applets-using-C\" rel=\"nofollow\">here</a> and I am able to access the cpl files in System folder. But they are not all the cpl files. And hence my result ends up being a subset of the desired result set.</p>\n\n<p>Also by accessing the <code>cpl</code> files I do not get the <code>task list</code> and other details which are valuable in my search operation. Please see image for the result i want<img src=\"http://i.stack.imgur.com/hVKFk.png\" alt=\"enter image description here\"> </p>\n\n<p>This result appears when i search for <code>display</code> inside the control panel explorer.</p>\n\n<p>What else should I try? Can someone guide me?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["c#","webbrowser","webbrowser-control"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13247351,"title":"Disabling Ctrl+P in webBrowser control","body":"<p>It seems like it's impossible to disable printing in a webBrowser control.</p>\n\n<p>Here's what I've tried:</p>\n\n<ul>\n<li><p>Setting WebBrowserShortcutsEnabled to FALSE</p>\n\n<ul>\n<li>This still shows a print dialog when pressing ctrl+p. The behavior seems strange, but from my testing, you can trigger the dialog while the webbrowser control still has focus. If you click on another control so the webbrowser loses focus, and click on the webbrowser again, you are unable to trigger the print dialog.</li>\n</ul></li>\n<li><p>Overriding Ctrl+P in the Form's KeyDown event</p>\n\n<ul>\n<li>This doesn't seem to do anything at all.</li>\n</ul></li>\n<li><p>Using Webbrowser's PreviewKeyDown</p>\n\n<ul>\n<li>This doesn't seem to be intended to intercept keys, merely preview them as you can't cancel out keypresses with it.</li>\n</ul></li>\n</ul>\n\n<p>It would be optimal if ALL keyboard shortcuts are disabled.</p>\n\n<p>There must be some way to achieve this? Thanks.</p>\n"},{"tags":["c#","asp.net","http","handler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13282727,"title":"Returning an array of images from a database using HTTP handler","body":"<p>I have written a handler that returns me one imaage from the database which display. Nw i want to an array of iamges which are related to a specific image. Like If image \" A is related to image \"B\",\"C\" and \"D\" , I want A,B,C, and D images to be returned by the http handler. So that i can show the images on the web page. How do I return an array of images or list of images?</p>\n\n<p>here is my handler code.</p>\n\n<pre><code>&lt;%@ WebHandler Language=\"C#\" Class=\"DisplayImg\" %&gt;\n\nusing System;\nusing System.Web;\nusing System.Configuration;\nusing System.IO;\nusing System.Data;\nusing System.Data.SqlClient;\n\npublic class DisplayImg : IHttpHandler\n{\n\n    public void ProcessRequest(HttpContext context)\n    {\n        string theID;\n        if (context.Request.QueryString[\"id\"] != null)\n            theID = context.Request.QueryString[\"id\"].ToString();\n        else\n            throw new ArgumentException(\"No parameter specified\");\n\n        context.Response.ContentType = \"image/jpeg\";\n        Stream strm = DisplayImage(theID);\n        byte[] buffer = new byte[2048];\n        int byteSeq = strm.Read(buffer, 0, 2048);\n\n        while (byteSeq &gt; 0)\n        {\n            context.Response.OutputStream.Write(buffer, 0, byteSeq);\n            byteSeq = strm.Read(buffer, 0, 2048);\n        }\n    }\n\n    public Stream DisplayImage(string theID)\n    {\n        SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings[\"SERVER\"].ConnectionString.ToString());\n        string sql = \"SELECT Server_image_icon FROM tbl_ServerMaster WHERE server_Code = @ID\";\n        SqlCommand cmd = new SqlCommand(sql, connection);\n        cmd.CommandType = CommandType.Text;\n        cmd.Parameters.AddWithValue(\"@ID\", theID);\n        connection.Open();\n        object theImg = cmd.ExecuteScalar();\n        try\n        {\n            return new MemoryStream((byte[])theImg);\n        }\n        catch\n        {\n            return null;\n        }\n        finally\n        {\n            connection.Close();\n        }\n    }\n\n    public bool IsReusable\n    {\n        get\n        {\n            return false;\n        }\n    }\n} \n</code></pre>\n"}]}
{"total":375441,"page":9,"pagesize":100,"questions":[{"tags":["c#","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":8588724,"title":"opening worddoc2007 inside webbrowser/c#.net","body":"<p>I need to open word document inside the webbrowser.</p>\n\n<p>It works when I open word2003, but not word2007. I got some links saying ActiveXwebbrowser will solve this problem. I tried that also but its opening as a new windows explorer not inside the ActiveXwebbrowser.</p>\n\n<p>I am working on a windows application using c#.net.</p>\n\n<pre><code>OpenFileDialog openFileDialog = new OpenFileDialog();\nopenFileDialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.Personal);\nopenFileDialog.Filter = \"Text Files (*.txt)|*.txt|All Files (*.*)|*.*\";\nif (openFileDialog.ShowDialog(this) == DialogResult.OK)\n{\n    object null_obj_str = \"\";\n    string FileName = openFileDialog.FileName;\n    object loc = FileName;\n    System.Object null_obj = 0;\n    axWebBrowser1.Navigate2(ref loc, ref null_obj, ref null_obj, ref null_obj_str, ref null_obj_str);\n    //axWebBrowser1.Navigate(new Uri(FileName));\n}\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","data","dataannotations"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":4029,"score":5,"question_id":3345348,"title":"How to specify a min but no max decimal using the range data annotation attribute?","body":"<p>I would like to specify that a decimal field for a price must be >= 0 but I don't really want to impose a max value.</p>\n\n<p>Here's what I have so far...I'm not sure what the correct way to do this is.</p>\n\n<pre><code>[Range(typeof(decimal), \"0\", \"??\"] public decimal Price { get; set; }\n</code></pre>\n"},{"tags":["c#","asp.net","html","css"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":17,"score":-1,"question_id":13272136,"title":"While giving rowspan and removing cell i m getting error \"Specified argument was out of the range of valid values\"","body":"<pre><code>ASPX page\n\n\n    &lt;table id=\"tableAppointment\" runat=\"server\" cellspacing=\"1\" width=\"100%\" bgcolor=\"#cccccc\"&gt;\n                                    &lt;tr class=\"csstextheader\"&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                        &lt;/td&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                            &lt;b&gt;Time Slot&amp;nbsp;&lt;/b&gt;\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td width=\"70px\"&gt;\n                                            08:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;08:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            09:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;09:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            10:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;10:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            11:00AM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;11:00AM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            12:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;12:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            01:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;01:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            02:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;02:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            03:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;03:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            04:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;04:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            05:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;05:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            06:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;06:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            07:00PM\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            00\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            15\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            30\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr class=\"csstablelisttd\"&gt;\n                                        &lt;td&gt;\n                                            &lt;span style=\"visibility: hidden;\"&gt;07:00PM&lt;/span&gt;\n                                        &lt;/td&gt;\n                                        &lt;td&gt;\n                                            45\n                                        &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                &lt;/table&gt;\n\nC#\n\nprotected void ReadFixedAppointments(string appId, string pID, string Acq_Modality_ID, string patientName, string dbHour, string dbMinute, int rowspan, string status)\n    {\n        string rowHourText = \"\";\n        string hour = \"\";\n        string rowMinuteText = \"\";\n        string matchedHour = \"\";\n        string cellAcqModalityID = \"\";\n        int row = -1;\n        int col = -1;\n\n        for(int i = 0; i &lt;= tableAppointment.Rows.Count - 1; i++)\n        {           \n            rowHourText = tableAppointment.Rows[i + 1].Cells[0].InnerText.Trim();\n\n            if(matchedHour == \"\" &amp;&amp; rowHourText != \"\")\n            {\n                if(rowHourText.Substring(5, 2) == \"PM\")\n                {\n                    hour = Convert.ToString(Convert.ToInt32(rowHourText.Substring(0, 2)) + 12);\n                    if(hour == \"24\")\n                        hour = \"12\";\n                }\n                else\n                {\n                    hour = rowHourText.Substring(0, 2);\n                }\n            }\n            if(hour == dbHour &amp;&amp; matchedHour == \"\")\n            {\n                matchedHour = hour;\n            }\n            rowMinuteText = tableAppointment.Rows[i + 1].Cells[1].InnerText.Trim();\n            if(Convert.ToInt32(rowMinuteText) == Convert.ToInt32(dbMinute) &amp;&amp; hour == dbHour)\n            {\n                row = i;\n                break;\n            }\n        }\n\n        for(int k = 0; k &lt; tableAppointment.Rows[0].Cells.Count; k++)\n        {\n            cellAcqModalityID = tableAppointment.Rows[0].Cells[k].Attributes[\"ID\"];\n            if(cellAcqModalityID != null &amp;&amp; cellAcqModalityID != \"\")\n            {\n                if(Acq_Modality_ID == cellAcqModalityID)\n                {\n                    col = k;\n                    break;\n                }\n            }\n        }\n\n        if(col != -1)\n        {\n            if(rowspan == 1 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n                tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"valign\", \"top\");\n            }\n            if(rowspan == 2 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n                if(tableAppointment.Rows[row + 2].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(tableAppointment.Rows[row + 2].Cells.Count - 1);\n                }\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n            }\n\n            if(rowspan == 3 &amp;&amp; tableAppointment.Rows[row + 1].Cells[col].Attributes[\"class\"] == null)\n            {\n\n                if(tableAppointment.Rows[row + 2].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 2].Cells.RemoveAt(tableAppointment.Rows[row + 2].Cells.Count - 1);\n                }\n                if(tableAppointment.Rows[row + 3].Cells.Count &gt;= col)\n                {\n                    tableAppointment.Rows[row + 3].Cells.RemoveAt(col);\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 3].Cells.RemoveAt(tableAppointment.Rows[row + 3].Cells.Count - 1);\n                }\n                tableAppointment.Rows[row + 1].Cells[col].RowSpan = rowspan;\n                tableAppointment.Rows[row + 1].Cells[col].InnerHtml = \"&lt;span id=\" + pID + \" name=\" + appId + \"&gt;\" + patientName + \"&lt;/span&gt;\";\n\n                if(status == \"CHECKED IN\")\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdgreen\");\n                }\n                else\n                {\n                    tableAppointment.Rows[row + 1].Cells[col].Attributes.Add(\"class\", \"csstdred\");\n                }\n            }\n        }\n    }\n\n    private int calculateRowspan(string startHour, string endHour, string startMinute, string endMinute)\n    {\n        int rowSpan = 0;\n        int hour = Convert.ToInt32(endHour) - Convert.ToInt32(startHour);\n        int minute = Convert.ToInt32(endMinute) - Convert.ToInt32(startMinute);\n        if(hour != 0)\n        {\n            hour = hour * 60;\n            hour = hour + minute;\n            rowSpan = hour / 15;\n        }\n        else\n        {\n            rowSpan = minute / 15;\n        }\n        return rowSpan;\n    }\n\n**I m fetching appId, pID, Acq_Modality_ID, patientName, dbHour, dbMinute, rowspan, status from database.\n\n    Now what i do matching  html cell with dbHour and dbMinute i have stored Acq_Modality_ID in first rows cells id atrribute like  CR(CR1) CR(CR2) CT(CT1) CT(CT2)\n\n    Calculating rowsapn using total time while each time slot is 15 minute\n\n    if user selects two cells then total time is 30 rowspan= 30/15=2.\n\n    In image i m selecting 3 slots so total time is 45 so calculate rowspan= 45/15=3 \n\n\n    While giving rowspan  and removing cell i m getting error \"Specified argument was out of the range of valid values\".\n\n\n    So how ca i tackle it. Confused since 4 days.**\n</code></pre>\n"},{"tags":["c#","windows-phone-7","rest","webclient"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13282748,"title":"WebClient on WP7 does not download the entire string, instead cuts it off arbitrarily","body":"<p>I am trying to download a long string of JSON from a public API on Windows Phone 7, but am finding that the whole JSON is not being downloaded, the string is cut off at different lengths depending on the file chosen. I've tried this using both <code>OpenReadAsync</code> and <code>DownloadStringAsync</code>.</p>\n\n<pre><code>WebClient wc = new WebClient();\nwc.DownloadStringComplteted += new DownloadStringCompletedEventHandler(DownloadStringCompleted);\nwc.DownloadStringAsync(new Uri(\"http://api.example.com\"));\n</code></pre>\n\n<p>By inserting a breakpoint just inside the event completed handler I can see that the <code>args.Result</code> property does not contain the full string of the API and is cut off at different intervals.</p>\n\n<p>This same procedure works elsewhere in the app, I've tested the API and ensured that <code>content-length</code> is correct and all that - I still cannot work out why the string is getting cut off by the WebClient.</p>\n"},{"tags":["c#","regex","string"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":13024233,"title":"Validate a string between another string?","body":"<p>I am developing an ASP.NET application in which I have to display description for text documents after performing SQL full text search query. I have to highlight the user input search string with in description of that document. Now problem is that:</p>\n\n<p>If the user enters <strong>rang</strong> as input search string then I have to check whether that string is part of another word or appears as an individual word. For example:</p>\n\n<p>1 - <strong>rang</strong> may appear by itself or it may be part of some word i.e. W*<em>rang</em>*ling.</p>\n\n<p>2 - <strong>weep</strong> may appear by itself or it may be part of *<em>weep</em>*ing.</p>\n\n<p>How can I validate such condition for strings? Is it possible through <code>Regex.Match()</code>?\nAny help will be much appreciated. </p>\n\n<p><strong>NOTE</strong>: A single word may appear multiple times in multiple ways within a paragraph.</p>\n"},{"tags":["c#","keypress","microphone","mute"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2831,"score":4,"question_id":2078970,"title":"How to mute the microphone c#","body":"<p>I wanted to know, what would the coding be if I wanted to toggle mute/unmute of my microphone. I am making a program that can run in the background and pickup a keypress event and toggle mute/unmute of the mic. Any help with any of that coding would be very helpful. I am pretty new to C#, and this is just a really simple program I wanted to make. That is all it does, is it will listen for keypress of the spacebar, even when the program is in the background, then when the spacebar is pressed it will mute/unmute the mic.</p>\n\n<p>Thank you for any and all help!</p>\n"},{"tags":["c#","asp.net","button","popup"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":302,"score":0,"question_id":12835938,"title":"popup window not opening on button click in asp.net","body":"<p>I have sample asp.net button for which i am writing click event and trying to open a new popupwindow , for some reason the popup window is not opening , please can i know whether the issue is related with browser or code </p>\n\n<p>Test.aspx</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n    &lt;script language=\"javascript\" type=\"text/javascript\"&gt;\n\n        function openNewWin(url) {\n\n            var x = window.open(url, 'mynewwin', 'width=600,height=600,toolbar=1');\n\n            x.focus();\n\n        }\n\n&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;div&gt;\n     &lt;asp:Button ID=\"btnOpenPop\" runat=\"server\" Text=\"Open Pop\"           \n\n        onclick=\"btnOpenPop_Click\" /&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Test.cs</p>\n\n<pre><code>public partial class Test : System.Web.UI.Page\n    {\n        protected void Page_Load(object sender, EventArgs e)\n        {\n\n\n        }\n\n        protected void btnOpenPop_Click(object sender, EventArgs e)\n        {\n            string url = \"http://www.dotnetcurry.com\";\n\n             ClientScript.RegisterStartupScript(this.GetType(), \"OpenWin\", \"&lt;script&gt;openNewWin('\" + url + \"')&lt;/script&gt;\");\n\n\n\n\n        }\n    }\n</code></pre>\n"},{"tags":["c#","vb.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13227251,"title":"How do i fix point in decimal value in C#","body":"<p>I have code in VB.net in below:</p>\n\n<pre><code>me.Index = Format(Convert.ToDouble(g.Trim()), \"##.##\")\n</code></pre>\n\n<p>result : 120.00</p>\n\n<p>how do i same thing in C#. I don't use format function in C#. I just want result will not place more then two value after point. i mean if i send value 120.120000 then result will be 12.12</p>\n"},{"tags":["c#","asp.net","pdf","itextsharp"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":153,"score":0,"question_id":12837660,"title":"How to convert .aspx page to pdf?","body":"<p>I need to create a pdf from .aspx page. In .aspx page user will enter so many values in textbox and gridview. It also has some tabs with different sections. I did used iTextSharp for creating simple pdf. But here i need to get the values from the page and need to read the tab controls. So is it posible to use iTextSharp or is there any opensource dll available for converting .aspx to pdf..</p>\n\n<p>Give me some idea?  </p>\n\n<p>Thanks..</p>\n"},{"tags":["c#","gsm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13246853,"title":"C# sms library long messages","body":"<p>I am using sms library is my project,</p>\n\n<pre><code>http://www.codeproject.com/Articles/20420/How-To-Send-and-Receive-SMS-using-GSM-Modem\n</code></pre>\n\n<p>Following is the link where from i am picking the references. I have a problem that if a message exceed from one message length then it give me error.</p>\n\n<p>My Question is : How can i send long message with this library.</p>\n\n<p>Following is my code </p>\n\n<pre><code>SmsSubmitPdu pdu = new SmsSubmitPdu(\"Long Message\",\"Number\", \"\");\n</code></pre>\n"},{"tags":["c#","asp.net","radiobuttonlist"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13264783,"title":"Repeater control radiobuttonlist always retun null value","body":"<p>I'm using the below code to read radio button list value. But it always returns null. Please help me to fix this issue.</p>\n\n<pre><code>foreach (RepeaterItem item in repeaterItems.Items)\n{\n    if (item.ItemType == ListItemType.Item || item.ItemType == ListItemType.AlternatingItem)\n    {\n        lbl_slno = (Label)item.FindControl(\"id\");\n        lbl_ques = (Label)item.FindControl(\"lblques\");\n        radiobtn = (RadioButtonList)item.FindControl(\"rdbtn\");\n        string radio_value = radiobtn.SelectedItem.Value;\n        //radio_value return \"Object reference not set to an instance of an object.\"\n    }\n}\n\n&lt;ItemTemplate&gt;\n    &lt;table cellspacing=\"0\" width=\"100%\" align=\"center\"&gt;\n        &lt;tr&gt;\n            &lt;td style=\"width: 42px;\" class=\"cu_style\" &gt;\n                &lt;asp:Label ID=\"id\" runat=\"server\" Text='&lt;%#Bind(\"fld_id\")%&gt;'&gt;&lt;/asp:Label&gt;\n            &lt;/td&gt;\n            &lt;td style=\"width: 503px;\" class=\"cu_style\"&gt;\n                &lt;asp:Label ID=\"lblques\" runat=\"server\" Text='&lt;%#Bind(\"fld_Question\")%&gt;'&gt;&lt;/asp:Label&gt;\n            &lt;/td&gt;\n            &lt;td style=\"width: 80px;\" class=\"cu_style\" colspan=\"3\"&gt;\n                &lt;asp:RadioButtonList ID=\"rdbtn\" Width=\"229px\" runat=\"server\" RepeatDirection=\"Horizontal\" &gt;\n                &lt;asp:ListItem Text=\"Agree\"&gt;Agree&amp;nbsp;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"Neutral\"&gt;Neutral&amp;nbsp;&amp;nbsp;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"Disagree\"&gt;Disagree&lt;/asp:ListItem&gt;\n                &lt;/asp:RadioButtonList&gt;\n            &lt;/td&gt;\n\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/ItemTemplate&gt;\n</code></pre>\n\n<p>My deign code is here,..</p>\n"},{"tags":["c#","winforms","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13151608,"title":"How to set font color for a particular column in list view?","body":"<p>How to set font color for a particular column in list view?\nI have two columns in listview, and I want to set the font in 2nd column to red color.</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":117,"score":0,"question_id":12891744,"title":"Convert multiple DataTables to columns in a single datagridview","body":"<p>I have three DataTables in C# called MIT, Oracle and Difference. Could you please let me know how to add these three tables to a gridview as seperate columns? I know how to bind a DataTable to a gridview as given below. But i need the same to be done for several DataTables.Please help</p>\n\n<pre><code>dataGridView1.DataSource = MIT;\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/VkxgP.png\" rel=\"nofollow\">Here</a>'s an image of the GridView.</p>\n"},{"tags":["c#","asp.net","usercontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":1,"question_id":13155771,"title":"How to call parent UserControl method from a child UserControl in asp.net?","body":"<p>I have to use the result of a parent usercontrol method in child usercontrol.How to find the method in child control?</p>\n"},{"tags":["c#","treeview"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":3110,"score":2,"question_id":5478984,"title":"TreeView with CheckBoxes in c#","body":"<p>I have a tree view with checkboxes in c#, I want that when the user checks one node all the nodes that there are on the levels below automatic checked also.\nDoes anyone know about way to do that without run with recorsive fnction on all the tree each time that the user checks some node?</p>\n\n<p>Thanks</p>\n\n<p>//this function returns the treeView.</p>\n\n<pre><code>   public TreeView GetTreeView()\n    {\n\n        getSubject();\n        // fill the treeview with all subjects.\n        foreach (Subject subject in subjects)\n        {\n            //for each root subject fill all the his children.\n            if (subject.subjestId == subject.parentSubject)\n            {\n                TreeNode node = new TreeNode(subject.subjectString, subject.subjestId, subject.subjestId);\n                addChild(node, subject.subjestId);\n                tv.Nodes.Add(node);\n            }\n        }\n        return tv;\n    }\n   // for each subject return sub subjects.\n   private void addChild(TreeNode node, int parentId)\n    {\n        foreach (Subject subject in subjects)\n        {\n            if (subject.parentSubject == parentId &amp;&amp; subject.parentSubject != subject.subjestId)\n            {\n                TreeNode childNode = new TreeNode(subject.subjectString, subject.subjestId, subject.subjestId);\n                addChild(childNode, subject.subjestId);\n                node.Nodes.Add(childNode);\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#","itextsharp","wkhtmltopdf"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13265592,"title":"Unable to print Check Boxes in pdf","body":"<p>We are using WkHtmlToPdf to convert from html to pdf. Now I have make all the form fields editable on request as well. Since there is a bug in WkHtmlToPdf while converting Html to Pdf it makes all the form field's property as Visible Not Printable. </p>\n\n<p>To get around this problem we are using ITextSharp to read existing pdf that has been generated by WkHtmlToPdf and setting that property as Visible for every form field.</p>\n\n<p>This is how I am doing that</p>\n\n<pre><code>        var pdfReader = new PdfReader(inputFilename);\n\n        using (var outputStream = new FileStream(outputFilename, FileMode.OpenOrCreate))\n        {\n            var stamper = new PdfStamper(pdfReader, outputStream);\n\n            // Regenarating all the fileds using itextSharp. \n            // Since wkHtmltoPdf has differnt default settings for pdf form fields (Visible and not Printable)\n            var formFields = stamper.AcroFields;\n            var filedNames = formFields.Fields.Keys;\n\n            foreach (var keyName in filedNames)\n            {\n                formFields.SetFieldProperty(keyName, \"setflags\", PdfAnnotation.FLAGS_PRINT, null);\n                formFields.SetFieldProperty(keyName, \"setflags\", PdfFormField.FF_EDIT, null);\n                formFields.SetFieldProperty(keyName, \"textsize\", 8.0f, null);\n                formFields.RegenerateField(keyName);\n              }\n          }\n</code></pre>\n\n<p>This solved my problem for all the fields but check Boxes. I have few check boxes in html which are converted to pdf using WkHtmlToPdf. I realized that when ever I try to RegenerateField() (Last line in foreach loop) check box is loosing all its properties (Whether I checked or unchecked) it is only showing empty check box, and its not editable.</p>\n\n<p>To solve this problem I came up with the following </p>\n\n<pre><code>if (formFields.GetFieldType(keyName).Equals(AcroFields.FIELD_TYPE_CHECKBOX))\n{\n                    // Regenerate checkbox formfield causing it to reset all its properties \n                    // including checkd/uncheked property     \n                    formFields.SetFieldProperty(keyName, \"setflags\", PdfAnnotation.FLAGS_PRINT, null);\n\n// Ignore the commented code as it is not working Not sure why??? and how\n\n                    //var item = formFields.GetFieldItem(keyName);\n                    //var appearance = item.GetValue(0).Get(PdfName.AS);\n\n                    //if (appearance != null)\n                    /{\n                    //    if (appearance.tostring().tolower().equals(\"/yes\"))\n                    //    {\n                    //        formfields.regeneratefield(keyname);\n\n                     // Not even one working when I try to set the check box status like below\n                    //        success  = formfields.setfield(keyname, \"yes\");\n                    //        success  = formfields.setfield(keyname, \"/yes\");\n                    //        success  = formfields.setfield(keyname, \"/yes\");\n                    //        success = formfields.setfield(keyname, \"on\");\n                    //        success =  formfields.setfield(keyname, \"1\");\n\n\n                    //    }\n                    }\n</code></pre>\n\n<p>With the code (excluding commented) code Check box successfully retaining its status and displaying in the generated Pdf. But it's not printing. I checked the properties of check box it's visible like any other fields in the pdf. Apart from check boxes all the fields(text boxes) are printing its values. </p>\n\n<p>I am checking properties through --> Open pdf document--> Forms--> Add/Edit Fields</p>\n\n<p>What am I doing wrong here? Instead of setting property on check box I tried to construct a brand new check box using Itextsharp but I couldn't using ItexSharp manual example. DO anyone did this stuff before? </p>\n\n<p>Even if I generate a new check box using ItextSharp, how can I replace exactly existing check box?    </p>\n\n<p>Thanks a lot for reading my story..</p>\n"},{"tags":["c#","pinvoke","msdn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13281729,"title":"How do I figure out what the values are for SECURITY_INFORMATION?","body":"<p>So I am trying to manipulate several pinvoke functions right now and I can't figure out where I find the values for each flag in SECURITY_INFORMATION at?</p>\n\n<p>Here is the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa379573%28v=vs.85%29.aspx\" rel=\"nofollow\">link</a></p>\n\n<p>I have already visited the PInvoke site and its definition of SECURITY_INFORMATION seems to be incorrect. <a href=\"http://www.pinvoke.net/default.aspx/Enums/SECURITY_INFORMATION.html#\" rel=\"nofollow\">Here</a> </p>\n\n<p>The reason I think it is incorrect is because I am throwing the following error when I try to call ConvertSecurityDescriptorToStringSecurityDescriptor method.</p>\n\n<pre><code>A call to PInvoke function 'ConvertSecurityDescriptorToStringSecurityDescriptor' \nhas unbalanced the stack. This is likely because the managed PInvoke signature \ndoes not match the unmanaged target signature. Check that the calling \nconvention and parameters of the PInvoke signature match the target \nunmanaged signature.\n</code></pre>\n\n<p>But again I am interested in figuring out how to find the Hexadecimal values of each flag listed in the MSDN article I supplied. Its as if people just magically generate the values and they are correct even though there is no sign of them anywhere documented in that article. </p>\n\n<p><strong>EDIT 1</strong></p>\n\n<pre><code>[DllImport(\"advapi32.dll\", SetLastError = true, CharSet = CharSet.Unicode)]\npublic static extern bool ConvertSecurityDescriptorToStringSecurityDescriptor(IntPtr SecurityDescriptor, \n    uint RequestedStringSDRevision, \n    SECURITY_INFORMATION SecurityInformation,\n    out IntPtr StringSecurityDescriptor, \n    out int StringSecurityDescriptorLen);\n\n[Flags]\npublic enum SECURITY_INFORMATION  {\n    OWNER_SECURITY_INFORMATION = 0x00000001,\n    GROUP_SECURITY_INFORMATION = 0x00000002,\n    DACL_SECURITY_INFORMATION = 0x00000004,\n    SACL_SECURITY_INFORMATION = 0x00000008,\n    UNPROTECTED_SACL_SECURITY_INFORMATION = 0x10000000,\n    UNPROTECTED_DACL_SECURITY_INFORMATION = 0x20000000,\n    PROTECTED_SACL_SECURITY_INFORMATION = 0x40000000\n}\n</code></pre>\n"},{"tags":["c#","excel","connection-string","oledb","datatables.net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13282410,"title":"C# extract formatted text from Excel through OLEDB","body":"<p>I am reading data from a large <code>excel</code> file which has got formatted texts. I extract the data to <code>DataTable</code> object through <code>oleDBConnection</code> &amp; <code>GetOleDbSchemaTable</code>. But the extracted data doesn't include any formatted information. </p>\n\n<p>My requirement is, I need to extract only non-Strikethrough texts.</p>\n\n<p>I don't have any issues while reading and everything is perfectly fine. But my extraction should be based on text format in <code>excel</code> which I am unable to find the solution.</p>\n\n<p>Anything to be added in the <code>connectionString</code> which is as follows:</p>\n\n<pre><code>connectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + fileName + \"; Extended Properties=\\\"Excel 12.0 Xml;HDR=YES;Mode=Read;ReadOnly=True;\\\"\";\n</code></pre>\n\n<p>Constraints:</p>\n\n<ol>\n<li><p>Using OleDBConnection - No Interop</p></li>\n<li><p>Reading to DataTable Object</p></li>\n</ol>\n"},{"tags":["c#","asp.net","asp.net-mvc-3","loops","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13282336,"title":"TextBoxFor model incrementing dynamically in a loop","body":"<p>I am building a web application for working out. When a work out day loads, it displays a FORM that has a series of text boxes for each exercise to record the amount of repetitions and the weight done for each set. Each exercise requires a different amount of sets.</p>\n\n<p>I created a class that holds two object types, a list of exercises from an ExerciseReference entity class/database table, and an entity class for recording the data that the user enters into the form and submits.</p>\n\n<p>My model looks like this:</p>\n\n<pre><code>public class ExerciseListModel\n{\n    public List&lt;ExerciseRef&gt; exercises { get; set; }\n    public ExerciseREC recordedExercises { get; set; }\n}\n</code></pre>\n\n<p>When building the Reps and Weights text boxes for each exercise, my Razor HTML looks similar to this:</p>\n\n<pre><code> @foreach(ExerciseRef item in Model.exercises)\n        {\n            &lt;div class=\"editor-label\"&gt;\n            &lt;h3&gt;@item.Name.ToString()&lt;/h3&gt;\n            &lt;/div&gt;\n            &lt;p&gt;@item.Description.ToString()&lt;/p&gt;\n\n                for (int i = 0; i &lt; item.NumberOfSets; i++)\n                {                        \n                   &lt;text&gt;Set #: &lt;/text&gt; @(i + 1)&lt;br /&gt;\n                   &lt;text&gt;REPS: &lt;/text&gt; @Html.TextBoxFor(m =&gt; m.recordedExercises.Set1Reps)&lt;br /&gt;\n                   &lt;text&gt;WEIGHT: &lt;/text&gt; @Html.TextBoxFor(m =&gt; m.recordedExercises.Set1Weight) &lt;br /&gt;&lt;br /&gt;\n\n                }\n\n        }\n</code></pre>\n\n<p>So essentially, this is a for loop within a foreach loop. The foreach loop builds the HTML list of all of the exercises, while the for loop builds the text boxes for reps and weights. </p>\n\n<p>I need the number in Set1Reps in the following line:</p>\n\n<pre><code> @Html.TextBoxFor(m =&gt; m.recordedExercises.Set1Reps)\n</code></pre>\n\n<p>To be dynamic and increment with the loop. I need it to have Set1Reps for Set 1, and change to Set2Reps for Set 2, and so on and so forth. </p>\n\n<p>Any idea how I could go about doing that?</p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263917,"title":"WPF Binding how to get object reference","body":"<p>I have a ListView showing a list of Accounts using MVVM &amp; a custom template and working fine\nNow on clicking the Acct Name, we need to execute a custom action which requires the current Acct object</p>\n\n<p>Is there a way to set the Label.Tag property to the Acct object ?</p>\n\n<p>the xaml def is below\nenv is vs2010 .net 4.0 c#</p>\n\n<pre><code>&lt;ListView Name=\"lv1\" Grid.Column=\"1\" Grid.Row=\"4\"\n    ItemsSource=\"{Binding AccountsList}\"\n    Background=\"Transparent\" BorderThickness=\"0\"&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Source=\"/asm1;component/Images/Icons/pdf1.png\" Width=\"12\" Height=\"12\" /&gt;\n                &lt;Label Content=\"{Binding Name}\" Margin=\"0,0,25,0\" \n                    ContextMenu=\"{x:Null}\" Name=\"lblacctItem\" \n                    MouseDoubleClick=\"lbl_MouseDoubleClick\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n    &lt;ListView.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;WrapPanel Background=\"Transparent\" \n                Width=\"{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource AncestorType=ScrollContentPresenter}}\" \n                ItemWidth=\"{Binding (ListView.View).ItemWidth, RelativeSource={RelativeSource AncestorType=ListView}}\" \n                MinWidth=\"{Binding ItemWidth, RelativeSource={RelativeSource Self}}\" \n                ItemHeight=\"{Binding (ListView.View).ItemHeight, RelativeSource={RelativeSource AncestorType=ListView}}\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListView.ItemsPanel&gt;\n&lt;/ListView&gt;\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","c#-4.0","linq-to-sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13269559,"title":"How to Custom Group By multiple records according some criteria","body":"<p>please consider this scenario:</p>\n\n<p>I have data like this :</p>\n\n<pre><code> Id          Group            Value\n -----------------------------------\n 1            1                100\n 2            1                120\n 3            1                100\n 4            2                90\n 5            2                105\n 6            3                300\n 7            4                123\n 8            4                110\n 9            5                100\n 10           5                110\n</code></pre>\n\n<p>I want to do <code>GroupBy</code> on this data as <code>1,2,3</code> place in one group and <code>4,5</code> place in another group. How I can do this with <code>LINQ</code>?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want to place <code>1,2,3</code> in one group and <code>4,5</code> in another group and perform <code>Count</code> aggregation on them and I get <strong>6</strong> for first group and <strong>4</strong> for secnd group</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13282365,"title":"windows forms datagridview sorting and paging","body":"<p>I have a Windows Form DataGridView loading only the page size from the database. If I click a column header it will only sort the displayed records.</p>\n\n<p>How do I sort the column relative to all records in the result set (displayed and not displayed)?</p>\n\n<p>My SQL handles sorting, I just need to override the DataGridView's sorting, call my SQL with a sort column and display the records?</p>\n"},{"tags":["c#","event-handling","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13282273,"title":"How to get index of sender item from \"multiplexed\" event handler?","body":"<p>I've got a single <code>OnDownloadProgress</code> event handler for an ordered list of <code>BitmapImage</code> items that I'm putting into a <code>FlipView</code>, and I'm wondering the best way to get the index of the sending BitmapImage in the event handler.</p>\n\n<p>It's easy to do this kind of thing with objects derived from <code>FrameworkElement</code>, because they have a <code>Tag</code> property that you can set to the index (or whatever you want). But the OnDownloadProgress event is sent not by the <code>Image</code>, but by the BitmapImage, and that doesn't have a <code>Tag</code>.</p>\n\n<p>I can think of a couple of ways to achieve this, but they seem hackish or heavy.</p>\n\n<p>One way is by setting the Image's <code>Tag</code> to the BitmapImage instance, and then searching for that instance in the handler until you've found the sender:</p>\n\n<pre><code>private FlipView PhotosView;\n\nprivate void AddImages(List&lt;string&gt; photoUrls)\n{\n    PhotosView.Items.Clear();\n    foreach (var url in photoUrls)\n    {\n        var image = new Image();\n        var source = new BitmapImage(new Uri(url));\n        source.DownloadProgress += OnDownloadProgress;\n        image.Source = source;\n        image.Tag = source;\n        PhotosView.Items.Add(image);\n    }\n}\n\nprivate void OnDownloadProgress(object sender, DownloadProgressEventArgs args)\n{\n    int n = 0;\n    foreach (var item in PhotosView.Items)\n    {\n        var image = (Image)item;\n        if (image.Tag == sender)\n        {\n            Debug.WriteLine(\"image {0} progress={1}%\", n, args.Progress);\n            break;\n        }\n        n++;\n    }\n}\n</code></pre>\n\n<p>But that seems kinda wrong. A better way would be to maintain a mapping of BitmapImage instances to the index (<code>Dictionary&lt;BitmapImage, int&gt;</code>), and while more speed-efficient, that seems kinda heavy too.</p>\n\n<p>Or, finally, I could subclass <code>BitmapImage</code> and add a <code>Tag</code> or <code>Index</code> member. Oh wait ... it's a <code>sealed</code> class. Scratch that one.</p>\n\n<p>Is there a simpler or more standardized way to do this kind of thing?</p>\n"},{"tags":["c#","excel","openxml","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12981632,"title":"Programmatically set a sheet's format to text before reading the cell contents","body":"<p>I have a requirement to read the contents of an excel sheet,write to it and allow for editing and re-importing. The problem I am having is that when user enters a number into the cells in the sheet, the numbers are, on the back, considered indexes on the SharedString table, an effect I do not need. What I would like to do is force the cells in the worksheet to be formatted as text before going ahead to read it. I believe that way, I am sure that my numbers will be treated as Strings. How do I accomplish this please? </p>\n\n<p>I would appreciate examples using the OPENXML library to solve this problem please. </p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13282313,"title":"Send data to customuser control","body":"<p>My main form has a datagrid. When user selects a row i need to show custom control. </p>\n\n<p>setting source and template:\n    var staff = new List();\n    grdCustomers.ItemsSource = staff;\n    grd.RowDetailsTemplate = CreateStaffDatatemplate();</p>\n\n<pre><code>    private DataTemplate CreateStaffDatatemplate()\n    {\n        FrameworkElementFactory fef = new FrameworkElementFactory(typeof(CustomControl)); \n        var dataTemplate = new DataTemplate();\n        dataTemplate.VisualTree = fef;            \n        return dataTemplate; \n    } \n</code></pre>\n\n<p>I need the pass the selected staff object to the custom control. How can i do that?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":182,"score":0,"question_id":4086161,"title":"Removing object from IEnumerable","body":"<p>I am returning a list of IEnumerable from one method. How do i remove an element from it?</p>\n\n<p>i want to do something like :-</p>\n\n<p>objIEnumerable.remove(objCustomer)</p>\n\n<p>Thanks in advance :)</p>\n"},{"tags":["c#","java","android"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13112796,"title":"Translating C# code with delegate to Java, to use with Android","body":"<p>I'm in the process of diving into Android development. Most of the projects I was involved with, were in C#. Delegates were elements of C# I did use very often, I've used also stuff like passing data using class that extends EventArgs or properties with set and get. With my programming knowledge I think I will be able to get started with Android development pretty smoothly. The thing is I have completly no idea how to approach an implementing mechanism similar to C# delagte in Java. </p>\n\n<p>Below I present some exemplary class that works in C# just fine and contains some elements of C# language that I would like to use in my future Android projects. Can someone provide me with a translation of this code? I would prefer that 'cos working with my own example and its conversion would allow me to catch it all faster. Also, any valuable resources on the topic (not only delegates but genereal topic of converting C# into Java) would be apreciated.</p>\n\n<p><strong>CountdownTimer.cs</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace SampleDelegateApp\n{\n    public class CountdownTimer\n    {\n        Timer tmrTicks = new Timer();\n        int secondsLeft = 0;\n        int numberOfSecondsToCountdown = 0;\n\n        public bool IsWorking\n        {\n            get { return tmrTicks.Enabled; }\n        }\n\n        public CountdownTimer(int seconds)\n        {\n            if (secondsLeft &lt; 0) secondsLeft = 0; \n            numberOfSecondsToCountdown = seconds;\n            secondsLeft = seconds;\n\n            tmrTicks.Interval = 1000;\n            tmrTicks.Tick += new EventHandler(tmrTicks_Tick);\n            tmrTicks.Enabled = false;\n        }\n\n        void tmrTicks_Tick(object sender, EventArgs e)\n        {\n            secondsLeft--;\n            if (secondsLeft &gt;= 1) \n                WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, false));\n            else\n            {\n                Stop();\n                WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, true));\n            }\n        }\n\n        public void Reset()\n        {\n            Stop();\n            secondsLeft = numberOfSecondsToCountdown;\n            if (secondsLeft &lt; 0) secondsLeft = 0;\n            WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, false));\n        }\n\n        public void Stop()\n        {\n            tmrTicks.Enabled = false;\n        }\n\n        public void Start()\n        {\n            if (secondsLeft &lt;= 0)\n            {\n                secondsLeft = 0;\n                WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, true));\n            }\n            else\n            {\n                tmrTicks.Enabled = true;\n            }\n        }\n\n        public delegate void CountdownTimerTickEventHandler(object sender, CountdownTimerEventArgs ea);\n\n        public event CountdownTimerTickEventHandler CountdownTimerTick;\n\n        protected virtual void WhenCountdownTimerTick(CountdownTimerEventArgs ea)\n        {\n            if (CountdownTimerTick != null)\n            {\n                CountdownTimerTick(this, ea);\n            }\n        }\n    }\n\n    public class CountdownTimerEventArgs : EventArgs\n    {\n\n        public string timeString = \"\";\n        public float procentOfTimeLeft = 0.0f;\n        public bool countdownFinished = false;\n\n        public CountdownTimerEventArgs(int secondsLeft, int SecondsToCountdown, bool isfinished)\n        {\n            countdownFinished = isfinished;\n            timeString = string.Format(\"{0:00}:{1:00}\", secondsLeft / 60, secondsLeft % 60);\n        }\n    }\n}\n</code></pre>\n\n<p><strong>frmTest.cs</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace SampleDelegateApp\n{\n    public partial class frmTest : Form\n    {\n        CountdownTimer ctmrTest;\n\n        public frmTest()\n        {\n            InitializeComponent();\n            ctmrTest = new CountdownTimer(-44);\n            ctmrTest.CountdownTimerTick += new CountdownTimer.CountdownTimerTickEventHandler(ctmrTest_CountdownTimerTick); \n        }\n\n        void ctmrTest_CountdownTimerTick(object sender, CountdownTimerEventArgs ea)\n        {\n            lblTimer.Text = ea.timeString;\n            if (ea.countdownFinished) countdownEnd();\n        }\n\n        private void btnStart_Click(object sender, EventArgs e)\n        {\n            ctmrTest.Reset();\n            ctmrTest.Start();\n        }\n\n        void countdownEnd()\n        {\n            MessageBox.Show(\"Finish\");\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13281125,"title":"What is the best way to expose a List<T> as readonly?","body":"<p>I've been around this design problem many times, and never found a killer solution.</p>\n\n<p>I want to expose a collection that is editable in the owner <code>class</code> scope, but only readable for other public scopes.</p>\n\n<p><strong>Trial 1:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n\n    public IEnumerable&lt;object&gt; MyList { get { return _myList; } }\n}\n</code></pre>\n\n<p>The problem with this is a external code can just cast it back to <code>List</code> and edit, like this:</p>\n\n<pre><code>var x = ((List&lt;object&gt;)MyList);\n</code></pre>\n\n<p><strong>Trial 2:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n\n    public IEnumerable&lt;object&gt; MyList { get { return _myList.ToList(); } }\n}\n</code></pre>\n\n<p>This way we prevent external modification, but create a unnecessary overhead of copying the <code>List</code> many times.</p>\n\n<p><strong>Trial 3:</strong></p>\n\n<pre><code>public class MyClass\n{\n    private List&lt;object&gt; _myList = new List&lt;object&gt;();\n    private ReadOnlyCollection&lt;object&gt; _roList = \n        new ReadOnlyCollection&lt;object&gt;(_myList)\n\n    public IEnumerable&lt;object&gt; MyList { get { return _roList; } }\n}\n</code></pre>\n\n<p>This is the standard solution, wich I use currently, but <code>ReadOnlyCollection</code> is about 30% slower:</p>\n\n<pre><code>Debug Trace:\nUse normal foreach on the ReadOnlyCollection\nSpeed(ms): 2520,3203125\nResult: 4999999950000000\n\nuse&lt;list&gt;.ForEach\nSpeed(ms): 1446,1796875\nResult: 4999999950000000\n\nUse normal foreach on the List\nSpeed(ms): 1891,2421875\nResult: 4999999950000000\n</code></pre>\n\n<p>Is there a 'perfect' way of doing this? Thanks.</p>\n"},{"tags":["c#","serial-port"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13260710,"title":"Byte array not being initialized to correct size?","body":"<p>I am writing an application that receives some input from a long range radio via a serial connection. I am currently using the SerialPort C# class to receive and send data, but I am having a few issues. I've noticed that the function I have for receiving data is not correctly setting the buffer byte array size. All data is being sent in bytecode (Hex). </p>\n\n<p>Say the other node sends 103 bytes of data. Stepping through my code and setting a breakpoint at the \"Read()\" line, I see that \"serialPort1.BytesToRead-1\" evaluates to 103, BUT the byte[] array is only initialized to 17. I have no explanation for this behavior. As a result, only the first 17 bytes are put into the array. Continuing through the step through, this same event is triggered, this time with \"serialPort1.BytesToRead-1\" evaluating to 85 (presumably since only the first 17 of the 103 bytes were read.</p>\n\n<p>If I hardcore the data array size at 103, it works flawlessly in one pass. However, at the moment I am unable to store all the data in my byte array in one pass, which is causing a lot of problems. Anyone know why my byte array is being initialized to such an arbitrary size???</p>\n\n<pre><code>private void serialPort1_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n        byte[] data = new byte[serialPort1.BytesToRead - 1];\n        serialPort1.Read(data, 0, data.Length);\n        DisplayData(ByteToHex(data) /*+ \"\\n\"*/);\n}\n</code></pre>\n\n<hr>\n\n<p>Updated: Here's the new method I am attempting. isHeader is a boolean value initially set to true (as the first two bytes being received from the packet are in fact the length of the packet).</p>\n\n<pre><code>    const int NUM_HEADER_BYTES = 2;\n\n    private void serialPort1_DataReceived(object sender,                     System.IO.Ports.SerialDataReceivedEventArgs e)\n    {\n        byte[] headerdata = new byte[2];\n        if (isHeader)\n        {\n            serialPort1.Read(headerdata, 0, NUM_HEADER_BYTES);\n            int totalSize = (headerdata[0] &lt;&lt; 8 | headerdata[1]) &gt;&gt; 6;\n            serialPort1.ReceivedBytesThreshold = totalSize - NUM_HEADER_BYTES;\n            data = new byte[totalSize - NUM_HEADER_BYTES];\n            isHeader = false;\n        }\n        else\n        {\n            serialPort1.Read(data, 0, data.Length);\n            double[][] results = ParseData(data, data.Length);\n            serialPort1.ReceivedBytesThreshold = NUM_HEADER_BYTES;\n            isHeader = true;\n            DisplayData(ByteToHex(data) /*+ \"\\n\"*/);\n        }\n    }\n</code></pre>\n"},{"tags":["c#","java","generics","type-erasure","ikvm"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":722,"score":4,"question_id":1477038,"title":"Doesn't IKVM.net support generics (type parameters)?","body":"<p>I statically recompiled a Java lib which used generics a lot, like <code>Collection&lt;?&gt;</code>, but the emitted .NET dll only uses <code>Collection</code>, not with type parameters. How come? </p>\n"},{"tags":["c#",".net","asp-classic"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":112,"score":2,"question_id":13013649,"title":"Parse HTML into web service from Classic ASP","body":"<p>I am trying to build a webservice where a user enters HTML and then via a web service verifies if it is valid HTML.</p>\n\n<p>My example (basic only) is:</p>\n\n<pre><code>Set objXML = CreateObject(\"Msxml2.ServerXMLHTTP.6.0\")         \nDim strEnvelope \nstrEnvelope = \"input=\" &amp; Server.HTMLEncode(\"&lt;b&gt;\") \nCall objXML.Open(\"POST\", \"http://[DOMAIN]/WebServices/HTMLWebService.asmx/ValidateHTML\", false) \nCall objXML.SetRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\") \nCall objXML.Send(strEnvelope) \n\nResponse.Write(strEnvelope &amp; \"##\" &amp; objXML.responseText &amp; \"##\")\n</code></pre>\n\n<p>My ASPX page validates the input and then returns if it's true of false (in a string array XML). At the moment it's always returning false.\nAfter some investigation it seems that for some reason the input received by the ASMX is empty and it's to do with the HTML tagging - either it's not being HTML encoded or not accepted by the asmx script.  It's returning the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;ArrayOfString xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://tempuri.org/\"&gt;\n&lt;string /&gt;\n&lt;string&gt;false&lt;/string&gt;\n&lt;/ArrayOfString&gt;\n</code></pre>\n\n<p>&lt;string /&gt; is where I am putting the input directly back into the returned xml string array. If I hard code \"&lt;b&gt;\" into this value, the xml returns this as \"&lt;b&gt;\" which is what I'd expect. </p>\n\n<p>If I just put an input of \"b\" then it returns false but does give me a value of \"b\" in the first item of the string array - so it's definitely picking up that value.</p>\n\n<p>Has anyone ever parsed html into an ASP.NET (c#) web service before or have any suggestions?</p>\n"},{"tags":["c#","asp.net",".net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13263751,"title":"Сhanging read-only field value with method","body":"<p>I have a working GridView in an ASP.Net webapp which tracks DNS records I have requested. It's defined as follows:</p>\n\n<pre><code>&lt;asp:GridView ID=\"gvExistingEntries\" runat=\"server\" AutoGenerateColumns=\"False\" \n    DataKeyNames=\"DNSId\" DataSourceID=\"dsDNS\" Width=\"100%\" \n    BackColor=\"White\" BorderColor=\"#DEDFDE\" BorderStyle=\"None\" BorderWidth=\"1px\" \n    CellPadding=\"4\" ForeColor=\"Black\" GridLines=\"Vertical\" AllowSorting=\"True\" ShowFooter=\"true\"&gt;\n    &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n    &lt;Columns&gt;\n        &lt;asp:BoundField DataField=\"DNSId\" Visible=\"false\" ReadOnly=\"true\" /&gt;\n        &lt;asp:BoundField DataField=\"DNSName\" HeaderText=\"DNS Name\" SortExpression=\"DNSName\" /&gt;\n        &lt;asp:BoundField DataField=\"IPAddress\" HeaderText=\"IP Address\" ReadOnly=\"True\" SortExpression=\"IPAddress\" /&gt;\n        &lt;asp:BoundField DataField=\"RecordType\" HeaderText=\"Record Type\" SortExpression=\"RecordType\" /&gt;\n        &lt;asp:BoundField DataField=\"RequestTicket\" HeaderText=\"Request Ticket\" SortExpression=\"RequestTicket\" /&gt;\n        &lt;asp:BoundField DataField=\"LastUpdateBy\" HeaderText=\"Updated By\" ReadOnly=\"True\" SortExpression=\"LastUpdateBy\" /&gt;\n\n        &lt;asp:TemplateField ShowHeader=\"false\" ItemStyle-HorizontalAlign=\"Center\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"updateButton\" runat=\"server\" CommandName=\"Edit\" Text=\"Update\" /&gt;\n                &lt;asp:LinkButton ID=\"deleteButton\" runat=\"server\" CommandName=\"Delete\" Text=\"Delete\" onClientClick=\"return confirm('Are you sure you want to delete this entry?');\" /&gt;\n            &lt;/ItemTemplate&gt;\n\n            &lt;EditItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"saveUpdate\" runat=\"server\" CommandName=\"Update\" Text=\"Save\" onClientClick=\"return confirm('Are you sure you want to save these changes?');\" /&gt;\n                &lt;asp:LinkButton ID=\"cancelUpdate\" runat=\"server\" CommandName=\"Cancel\" Text=\"Cancel\" /&gt;\n            &lt;/EditItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n    &lt;FooterStyle BackColor=\"#CCCC99\" /&gt;\n    &lt;HeaderStyle BackColor=\"#6B696B\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;PagerStyle BackColor=\"#F7F7DE\" ForeColor=\"Black\" HorizontalAlign=\"Right\" /&gt;\n    &lt;RowStyle BackColor=\"#F7F7DE\" /&gt;\n    &lt;SelectedRowStyle BackColor=\"#CE5D5A\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;SortedAscendingCellStyle BackColor=\"#FBFBF2\" /&gt;\n    &lt;SortedAscendingHeaderStyle BackColor=\"#848384\" /&gt;\n    &lt;SortedDescendingCellStyle BackColor=\"#EAEAD3\" /&gt;\n    &lt;SortedDescendingHeaderStyle BackColor=\"#575357\" /&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>The datasource is defined as follows:</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"dsDNS\" runat=\"server\" \n    ConnectionString=\"&lt;%$ ConnectionStrings:DNSMonConnectionString %&gt;\" \n    SelectCommand=\"SELECT [DNSId], [DNSName], [RecordType], [StartValidityDate], [EndValidityDate], [IPAddress], [LastUpdate], [RequestTicket], (select [FirstName] + ' ' + [LastName] + ' (' + [Login] + ')' FROM [User] where [User].[UserID] = [DomainName].[LastUpdateBy]) AS [LastUpdateBy] FROM [DomainName] ORDER BY [DNSName]\"\n\n    UpdateCommandType=\"StoredProcedure\"\n    UpdateCommand=\"sp_update_DNSEntry\" OnUpdating\n    DeleteCommandType=\"StoredProcedure\"\n    DeleteCommand=\"sp_drop_DNSEntry\"&gt;\n    &lt;DeleteParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" Type=\"Int32\" /&gt;\n    &lt;/DeleteParameters&gt;\n    &lt;UpdateParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" /&gt;\n        &lt;asp:Parameter Name=\"DNSName\" /&gt;\n        &lt;asp:Parameter Name=\"RecordType\" /&gt;\n        &lt;asp:Parameter Name=\"IPAddress\" /&gt;\n        &lt;asp:Parameter Name=\"RequestTicket\" /&gt;\n    &lt;/UpdateParameters&gt;\n&lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>Whenever the user uses the update feature this works and saves it to the database, but I want the code to resolve the IP address before it saves it. I have the method ready to go for this, but I do not know how to incorporate that into the code.</p>\n\n<p>Any ideas? I'd rather avoid having the code on the database if possible.</p>\n"},{"tags":["c#",".net","wcf","wsdl","wcf-extensions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13281803,"title":"wcfextras still generates many files instead of single WSDL file","body":"<p>Here is the <code>app.config</code> I got:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;system.serviceModel&gt;\n    &lt;extensions&gt;\n      &lt;behaviorExtensions&gt;\n        &lt;add name=\"wsdlExtensions\" type=\"WCFExtras.Wsdl.WsdlExtensionsConfig, WCFExtras, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" /&gt;\n      &lt;/behaviorExtensions&gt;\n    &lt;/extensions&gt;\n\n    &lt;behaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior name=\"WsdlSampleEndpointBehavior\"&gt;\n          &lt;wsdlExtensions singleFile=\"true\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n\n      &lt;serviceBehaviors&gt;\n        &lt;behavior&gt;\n          &lt;serviceMetadata httpGetEnabled=\"True\"/&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"True\"/&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n\n    &lt;diagnostics&gt;\n      &lt;messageLogging\n           logEntireMessage=\"true\"\n           logMalformedMessages=\"true\"\n           logMessagesAtServiceLevel=\"true\"\n           logMessagesAtTransportLevel=\"true\"\n           maxMessagesToLog=\"3000\"\n           maxSizeOfMessageToLog=\"20000\"/&gt;\n    &lt;/diagnostics&gt;\n&lt;services&gt;\n  &lt;service name=\"VogService\"&gt;\n    &lt;host&gt;\n      &lt;baseAddresses&gt;\n        &lt;add baseAddress=\"http://localhost:8733/\"/&gt;\n      &lt;/baseAddresses&gt;\n    &lt;/host&gt;\n    &lt;endpoint address=\"GoToTheMarketService\"\n    binding=\"basicHttpBinding\" bindingConfiguration=\"GoToTheMarketService\"\n    contract=\"GoToTheMarketService\" name=\"GoToTheMarketService\" behaviorConfiguration=\"WsdlSampleEndpointBehavior\"&gt;\n      &lt;identity&gt;\n        &lt;dns value=\"localhost\"/&gt;\n      &lt;/identity&gt;\n    &lt;/endpoint&gt;\n    &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\"/&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n\n&lt;bindings&gt;\n  &lt;basicHttpBinding&gt;\n    &lt;binding name=\"GoToTheMarketService\" closeTimeout=\"00:01:00\"\n      openTimeout=\"00:01:00\" receiveTimeout=\"00:10:00\" sendTimeout=\"00:01:00\"\n      allowCookies=\"false\" bypassProxyOnLocal=\"false\" hostNameComparisonMode=\"StrongWildcard\"\n      maxBufferSize=\"65536\" maxBufferPoolSize=\"524288\" maxReceivedMessageSize=\"65536\"\n      messageEncoding=\"Text\" textEncoding=\"utf-8\" transferMode=\"Buffered\"\n      useDefaultWebProxy=\"true\"&gt;\n      &lt;readerQuotas maxDepth=\"32\" maxStringContentLength=\"8192\" maxArrayLength=\"16384\"\n        maxBytesPerRead=\"4096\" maxNameTableCharCount=\"16384\" /&gt;\n      &lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\"\n          realm=\"\" /&gt;\n        &lt;message clientCredentialType=\"UserName\" algorithmSuite=\"Default\" /&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/system.serviceModel&gt;\n\n  &lt;system.diagnostics&gt;\n    &lt;sources&gt;\n      &lt;source name=\"System.ServiceModel.MessageLogging\"&gt;\n        &lt;listeners&gt;\n          &lt;add name=\"messages\"\n          type=\"System.Diagnostics.XmlWriterTraceListener\"\n          initializeData=\"C:\\messages.svclog\" /&gt;\n        &lt;/listeners&gt;\n      &lt;/source&gt;\n    &lt;/sources&gt;\n  &lt;/system.diagnostics&gt;\n\n  &lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>I added <code>wcfextras</code> to project references and even set it to copy local.</p>\n\n<p>In the result it just generates same WSDL file with imports of XSD and so on:</p>\n\n<pre><code>...\n&lt;wsdl:import namespace=\"aaa\" location=\"http://localhost:8733/?wsdl=wsdl0\"/&gt;\n...\n&lt;xsd:schema targetNamespace=\"aaa/Imports\"&gt;\n&lt;xsd:import schemaLocation=\"http://localhost:8733/?xsd=xsd0\" namespace=\"aaa\"/&gt;\n&lt;xsd:import schemaLocation=\"http://localhost:8733/?xsd=xsd1\" namespace=\"http://lalala.com/asdas12\"/&gt;\n&lt;/xsd:schema&gt;\n...\n</code></pre>\n\n<p>How can I make it to generate just one, single WSDL file?</p>\n"},{"tags":["c#","configuration","windows-services","setting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13282174,"title":"Windows Service doesn't read settings.setting?","body":"<p>I have a Setting.setting have a setting option : isSent - type int - value : 0</p>\n\n<p>And my code :</p>\n\n<pre><code> if (Settings.Default.isSent =! 0)\n                {\n                    var info = _text.ReadFile(Settings.Default.FilePath);\n                //Do something\n                } else\n                {\n                //Do something\n                }\n</code></pre>\n\n<p>I install my Windows Service, start and attach it to Visual to debug, and it always run to </p>\n\n<pre><code>var info = _text.ReadFile(Settings.Default.FilePath);\n</code></pre>\n\n<p>But not run to </p>\n\n<pre><code>} else\n{\n//Do something\n}\n</code></pre>\n\n<p>like I expect :( </p>\n\n<p>Anyone can explain it and know how to solve this for me ? Appreciate any answer :)</p>\n"},{"tags":["c#",".net","entity-framework","oop","generics"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13279018,"title":"How to avoid the need to reference Entity Framework on my service layer?","body":"<p>While trying to create a data access layer for a new project, I ran into what I can only imagine as an OOP/Design/Generics problem (using EF 4.3 to access the database).</p>\n\n<p>Mainly I wanted to achieve two things with this data layer:</p>\n\n<ul>\n<li>Different Context objects I have on my project should share the same connection string.</li>\n<li>Abstract repository class with common implementation.</li>\n</ul>\n\n<p>For some reason, I cannot compile my solution without referencing EntityFramework on the service layer. What I'm looking for is a way to fix this. Here's what I have:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.DomainClasses\n//POCO classes mapped on Entity Framework.\n\n//Project/Namespace DataAccessLayer.Base\n//Base classes and interfaces for all data access layer, such as:\n\npublic abstract class BaseContext&lt;TContext&gt; : DbContext where TContext : DbContext\n{\n  //To allow multiple contexts sharing the same connection string\n  protected BaseContext(): base(\"name=MyConnectionString\") {}\n}\n\n//Generic interface for a read-only repository\npublic interface IReadOnlyRepository&lt;T&gt; : IDisposable where T : class\n\n//Generic interface for a read/write repository\npublic interface IRepository&lt;T&gt; : IReadOnlyRepository&lt;T&gt; where T : class\n\n//Basic implementation for a read-only repository\npublic abstract class BaseReadOnlyRepository&lt;C, T&gt; : IReadOnlyRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Basic implementation for a read/write repository\npublic abstract class BaseRepository&lt;C, T&gt; : IRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Project DataAccessLayer.AccountContext/ Namespace DataAccessLayer\n//Context class:\n\npublic class AccountContext : BaseContext&lt;AccountContext&gt; {}\n\n//With this, I can have simple repositories:\n\npublic class UserRepository : BaseRepository&lt;AccountContext, User&gt;\n{ //All implementation comes from the base abstract class, unless I need to change it (override methods)\n}\n</code></pre>\n\n<p>I have a service layer between data access and the application (Windows Forms). Because I have a generic repository, it seemed a good and logic idea to have generic services. In the end, very similar to the repository structure:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.Services\n//Service layer supposed to reference only the repository project and not Entity Framework.\n\n//Generic interface for a read-only service working with a read-only repository\npublic interface IReadOnlyService&lt;T&gt; where T : class {}\n\n//Generic interface for a read/write service working with a read/write repository\npublic interface IService&lt;T&gt; : IReadOnlyService&lt;T&gt; where T : class\n\n//Base implementation for a read-only service\npublic abstract class BaseReadOnlyService&lt;T, R&gt; : IReadOnlyService&lt;T&gt;\n    where T : class\n    where R : IReadOnlyRepository&lt;T&gt;, new()\n{\n}\n\n//Base implementation for a read/write service\npublic abstract class BaseService&lt;T, R&gt; : IService&lt;T&gt;\n    where T : class\n    where R : IRepository&lt;T&gt;, new()\n{\n}\n\n//Concrete sample service\npublic class UserService : BaseService&lt;User, UserRepository&gt;\n{ //As with the repository I can change the default behavior of implementation overriding methods\n}\n</code></pre>\n\n<p>With this setup, the only way to compile is to reference Entity Framework on the service layer project.\nHow can I avoid the need to reference Entity Framework there?</p>\n\n<p>At this point, I'm willing to even throw it all out and rebuild everything but this is the only way I found to make it work given my needs (DbContext sharing connection strings, generic repository to avoid replication of code).</p>\n\n<p>Appreciate any help. Thanks.</p>\n\n<p><em>--Edit--Including here some extra steps I did 3 hours after I posted the question--</em></p>\n\n<p>In order to figure this out, I started to create a sample project with the same code above plus some implementation to mimic the results on the original project as much as possible.</p>\n\n<p>I created the domain classes project, the whole base data layer project and then the context project. I noticed I need to reference Entity Framework on the context project even though the context class does not derive directly from DbContext. Instead, it derives from an abstract class that derives from DbContext. This is ok though since my context will have DbSets and any other implementation related to DbContext.</p>\n\n<p>Next is the repository project. Needs to reference all other three (domain, base data layer and context). My repository has no code. All funcionality lies on the ancestor. I try to compile the repository project and VS requires me to referente Entity Framework. I wonder if it's really just a matter of embedding libraries. If this is confirmed, it's going to be a surprise. Entity Framework library is present on the output of the other projects. Why would I need to reference it here too? What's making VS require this?</p>\n\n<p>Anyway, for testing purposes, I added the reference. After all, I'm inside the data layer. I can live with that. Moving on to the service layer. For the sake of simplicity, I put all of the service classes into the same project.</p>\n\n<p>One possible flaw is that one of the constraints for the service abstract classes is the repository interface. That requires me to add a reference to the base data layer on my service layer. Perhaps already here there is something I can do that allows me to use only the repository reference. I have no option but to reference base data layer.</p>\n\n<p>Lastly, my concrete service is created and VS gives me the following error message: The type 'System.Data.Entity.DbContext' is defined in an assembly that is not referenced. You must add a reference to assembly 'EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</p>\n\n<p>So, in the end, the only way to keep going is to reference Entity Framework on the service layer. And at some point, when building the Windows Forms App, I will also have to reference Entity Framework.</p>\n\n<p>What should I do to avoid having these references? What improvements can I have on this structure?</p>\n\n<p>What I know is that my app certainly doesn't have to know that Entity Framework is involved anywhere on the other layers. Neither does the service layer. Services will only consume repositories. Repositories can even be providing fake data for tests.</p>\n\n<p>In case anyone is interested, I uploaded the project I created while writing this. It's a 1,17Mb zip file with no binaries whatsoever (except the Entity Framework 4.3.1 dll that I got through Nuget). Link: <a href=\"http://www.mediafire.com/?b45zkedy2j7eocc\" rel=\"nofollow\">http://www.mediafire.com/?b45zkedy2j7eocc</a>.</p>\n\n<p>Again, thanks for helping.</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":615,"score":2,"question_id":6611957,"title":"DefaultIfEmpty in LINQ-to-SQL join causing duplicates","body":"<p>Here is an extract of my query:</p>\n\n<pre><code>...\njoin p in dc.PODs on c.ID equals p.Consignment into pg\nfrom pgg in pg.DefaultIfEmpty()\n...\n</code></pre>\n\n<p>What the query should do is get all the 'PODs' associated with a consignment, store it as an IEnumerable object (which seems to work) so I can run through it when querying the main IEnumerable generated from the query. </p>\n\n<p>The problem is, I am getting duplicate main rows with the DefaultIfEmpty line, which only happens when a row has multiple PODs - so it's returning a row for each POD, which is incorrect. If I take out the pg.DefaultIfEmpty() line, it <em>seems</em> to work a bit better, but I still want to get the rows without PODs.</p>\n\n<p>Any ideas guys?</p>\n"},{"tags":["c#","console-application"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13281978,"title":"Multiple ConsoleKey variables","body":"<pre><code>  using System;\n  using System.Collections.Generic;\n  using System.Linq;\n  using System.Text;\n\nnamespace LearningKeys\n {\nclass Program\n{\n    static void Main(string[] args)\n    {       \n\n       while (true)\n            {     \n\n            ConsoleKeyInfo Menu;\n            Menu = Console.ReadKey(true);\n\n\n\n            Console.WriteLine(\"1. Pick Item\");\n            Console.WriteLine(\"2. Display all Items\");\n            Console.WriteLine(\"3. Pick Special Item\");\n            Console.WriteLine(\"4. Quit\");\n\n\n\n\n            if (Menu.Key == ConsoleKey.Backspace)\n            {\n                Console.WriteLine(\"1. Pick Item\");\n                Console.WriteLine(\"2. Display all Items\");\n                Console.WriteLine(\"3. Pick Special Item\");\n                Console.WriteLine(\"4. Quit\");\n\n\n            }\n\n            ConsoleKeyInfo DisplayAllItems;\n            DisplayAllItems = Console.ReadKey(true);\n\n           if (DisplayAllItems.Key == ConsoleKey.D1)\n            {\n                Console.WriteLine(\"1. Mushrooms \\n2. Sword \\n3.Boots\"); \n\n\n\n            }\n\n\n            Console.Read();\n\n            break;\n\n            }\n     }\n   }\n}\n</code></pre>\n\n<p>Hello there, I was wondering why my top 4 Console.WriteLine's disappear when I put the ConsoleKeyInfo variable on top of it. Or why the program does not work when I have more than one Consolekey assigned? I'm sure it is because of the Console.ReadKey(); but I'm not sure of what else to use. I'm just learning ConsoleKeys.</p>\n"},{"tags":["c#",".net","msdeploy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13281587,"title":"WebDeploy API for .NET","body":"<p>I've installed MSDeploy on my machine.  I am using Visual Studio 2010 and C#.  Trying to load 'Microsoft.Web.*' to code some sexy msdeploy functionality.  Perhaps I'm a level 3 tard (highly probable) but the documentation for getting this absolutely blow as@.</p>\n\n<p>The error I get is:\n\"The type or namespace name 'Web' does not exist in the namespace 'Microsoft' (are you missing an assembly reference?)\"</p>\n\n<p>So -- of course I try to load it via References, but it aint there.  I then Google like a mf for \"webdeploy api C#\" and the such and cannot for the love of the giant spaghetti monster find anything on how to install / download the msdeploy (\"microsoft.web.*) .dlls, apis.</p>\n\n<p>Anyone can point a brother to a link?  </p>\n\n<p>I did download and install \"WebDeploymentSetup.msi\", but nope.  I did install \"webdeploy_en.msi\" but nope.  Then I found this craaaazy thing called \"AzurePack.exe\" -- didn't even try to install that.  But, will if someone says that's it.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","oauth-2.0","dotnetopenauth","vkontakte"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13268201,"title":"Starting with DotNetOpenAuth","body":"<p>I'm working <strong>application for mobile devices</strong> with autorization in social network, that uses <strong>OAuth 2.0</strong> protocol (vk.com). Looks like DotNetOpenAuth is good tool for this task, but I'm a little confused where to start. Is there any tutorial about how to set up DotNetOpenAuth? I need only autorize and do few simple requests like: getting photo, name, etc. Or, may be there is another tool I can use?</p>\n"},{"tags":["c#","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278669,"title":"Creating Images from SQL Server BLOBs is painfully slow","body":"<p>Has anyone had any issues when converting a BLOB (jpg) from SQL Server 2008 to a file on your file system?  It's taking upward of 5-8 seconds for the blob to be retrieved then file created</p>\n\n<p>ultimately I'm gonna store the filepaths and do quick lookups like that but for the initial hit per jpeg, it takes a long time to create the file and I have to assume there's a way to make it faster or I'm just doing it wrong or in an inefficient way in C#.  </p>\n\n<p>Here's how I'm getting it from the DB:</p>\n\n<pre><code>memberPhoto.PhotoBinary = (byte[])reader.GetValue(ordinals[(int)Enums.MemberPhotoColumn.PhotoBinary])\n</code></pre>\n\n<p>Here's how I'm creating the file off that:</p>\n\n<pre><code>        using (FileStream file = File.Create(photoPhysicalFilepath))\n        {\n            BinaryWriter writer = new BinaryWriter(file);\n            writer.Write(photoBinary);\n            writer.Flush();\n        }\n\n        return relativePhotoFilePath;\n</code></pre>\n\n<p>photoBinary is the byte[] value I got from the datareader.</p>\n\n<p>Not sure if this is efficient.  I've seen people go this route but don't understand if this is an old way to do it and I've found a more syntactically elegant way of doing it or if my way is just a more elegant way I've found:</p>\n\n<pre><code>                 fs = new FileStream(FilePath, FileMode.Create);\n\n                    fs.Write(imageData, 0, imageData.Length);\n                    fs.Close();\n\n                    MimeType = image.MIMEType;\n\nwhere imageData is again a byte[]\n</code></pre>\n\n<p>So I'm wondering if anyone has done it my way or do you typically go with the second syntax...has there been any performance gains from the second vs. first on a large scaled website that anyone has encountered?</p>\n\n<p>ultimately just trying to figure out why it's taking so long for the blob to file creation.</p>\n"},{"tags":["c#","wpf","multithreading","error-handling","facebook-c#-sdk"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13281922,"title":"Catching exception caused by network error during Facebook photo upload","body":"<p>I have done photo uploading to Facebook event page, mostly by following this <a href=\"http://blog.prabir.me/post/Facebook-CSharp-SDK-Upload-Progress.aspx\" rel=\"nofollow\">tutorial</a>. The result is satisfactory so far, with photos being uploaded to the event page most of the time. However, sometimes when the program is uploading the photo, and the network connection is laggy or severed, the program would crash and throw the <code>System.AggregateException</code>, with message:</p>\n\n<p><code>A Task's exception(s) were not observed either by Waiting on the Task or accessing its Exception property. As a result, the unobserved exception was rethrown by the finalizer thread.</code></p>\n\n<p>Through initial inspection, the InnerException of this is:</p>\n\n<p><code>[Facebook.WebExceptionWrapper]: {\"The underlying connection was closed: An unexpected error occurred on a receive.\"}</code></p>\n\n<p>,and the InnerException of the above exception is <code>System.IO.IOException</code>, and another <code>System.Net.Socket.SocketException</code> inside the IOException, in which, both error messages describe something like <code>{\"An established connection was aborted by the software in your host machine\"}</code>.</p>\n\n<p>The StackTrace of the exceptions gives me only:</p>\n\n<pre><code>at System.Threading.Tasks.TaskExceptionHolder.Finalize()\n</code></pre>\n\n<p>Now obviously, the problem is caused by crappy network connection the system may encounter sometimes. So, how or where do I handle this exception based on the code referenced from this <a href=\"http://blog.prabir.me/post/Facebook-CSharp-SDK-Upload-Progress.aspx\" rel=\"nofollow\">tutorial</a>? I have no idea where I should put the try-catch block at when this happened in another thread, or so it seems like to me.</p>\n\n<p>Thanks in advanced!</p>\n\n<p>Referenced code from the <a href=\"http://blog.prabir.me/post/Facebook-CSharp-SDK-Upload-Progress.aspx\" rel=\"nofollow\">tutorial</a>:</p>\n\n<pre><code>var mediaObject = new FacebookMediaObject\n                              {\n                                  ContentType = \"image/jpeg\",\n                                  FileName = Path.GetFileName(_filename)\n                              }\n                              .SetValue(File.ReadAllBytes(_filename));\n\nvar fb = new FacebookClient(_accessToken);\nfb.PostCompleted += fb_PostCompleted;\nfb.PostAsync(\"/me/photos\", new Dictionary&lt;string, object&gt; { { \"source\", mediaObject } });\n\npublic void fb_PostCompleted(object sender, FacebookApiEventArgs e)\n{\n  if (e.Cancelled)\n  {\n    var cancellationError = e.Error;\n    MessageBox.Show(\"Upload cancelled\");\n  }\n  else if (e.Error == null)\n  {\n    // upload successful.\n    MessageBox.Show(e.GetResultData().ToString());\n  }\n  else\n  {\n    // upload failed\n    MessageBox.Show(e.Error.Message);\n  }\n}\n</code></pre>\n"},{"tags":["c#","visual-studio-2008","tfs","tfs2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13275776,"title":"directory not empty message after get latest","body":"<p>Environment: Visual Studio 2008 and Team Foundation Server 2008</p>\n\n<p>I am getting a \"Cannot delete because directory not empty\" message after doing a Get Latest. Any ideas why?</p>\n"},{"tags":["c#","pdf"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1899,"score":2,"question_id":3574505,"title":"split PDF into multiple files in C#","body":"<p>We have a C# Windows service that currently processes all the PDFs by reading the 2D barcode on the PDF using a 3rd party component and then updates the database and stores the document in the Document repository.</p>\n\n<p>Is there a way I can cut the files after reading the barcode and store it as another document?</p>\n\n<p>For example if there is a 10 page document, it should split into 10 different files.</p>\n\n<p>Thanks. </p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13281048,"title":"C# Updating form (richTextBox and toolStripStatusLabel) from Program thread","body":"<p>I'm trying to take a console application and build a gui for it. I've got the main functions of my GUI working and added the console application files to my new project. I changed the namespace of the files to match that of the winform application and moved the main function of the console application into the Program class defining it as a function taking a CSV path argument which it gets from the form.</p>\n\n<p>So it appears that program it functioning but Im having trouble getting the form to update. There are some Console.WriteLine() functions that I want to write to the toolStripStatusLabel and others to the richTextBox.</p>\n\n<p>I'm new to C# and the main program wasnt written by me but Im trying to build on it.</p>\n\n<p>Program.cs</p>\n\n<pre><code>Form1 Frm1 = new Form1();\nFrm1.UpdateStatusBar(\"Sorted jobs by EDD....\");\nFrm1.Refresh();\n</code></pre>\n\n<p>Form1.cs</p>\n\n<pre><code>public void UpdateStatusBar(string status)\n{\n    Form1 Frm1 = new Form1();\n    Frm1.toolStripStatusLabel1.Text = status;  \n}\n</code></pre>\n\n<p><a href=\"http://pastebin.com/HjnJ1YcF\" rel=\"nofollow\">Pastebin Program.cs</a>\nSee line 92.</p>\n\n<p><a href=\"http://pastebin.com/PyPEsmRD\" rel=\"nofollow\">Pastebin Form1.cs</a>\nSee line 88.</p>\n"},{"tags":["c#","inversion-of-control"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13280942,"title":"Operation is not valid due to the current state of the object","body":"<p>I am a student and my job was to build my own IoC container. I've read some tutorials/code samples and finally created it but when I try to create instance of it, I get exception like in the topic. Here is my IoC code and test code, I've been trying to figure out what's wrong but just can't find it.</p>\n\n<p>IoC</p>\n\n<pre><code>public class Mkontener: UnresolvedDependenciesException, IContainer\n{\n    private readonly Dictionary&lt;Type, object&gt; container = new Dictionary&lt;Type, object&gt; { };\n\n    public void Register(System.Reflection.Assembly assembly)\n    {\n\n        Type[] mytypes = assembly.GetTypes();\n\n\n        foreach (Type t in mytypes)\n        {\n            if (!container.ContainsKey(t))\n            {\n                container.Add(t, Activator.CreateInstance(t));\n            }\n        }\n        //throw new NotImplementedException();\n    }\n\n    public void Register(Type type)\n    {\n        if (!container.ContainsKey(type))\n        {\n            container.Add(type, Activator.CreateInstance(type));\n        }\n        //throw new NotImplementedException();\n    }\n\n    public void Register(object impl)\n    {\n        Type t = impl.GetType();\n        if (!container.ContainsKey(t))\n        {\n            container.Add(t, impl);\n        }\n\n        // throw new NotImplementedException();\n    }\n\n    public void Register&lt;T&gt;(Func&lt;T&gt; provider) where T : class\n    {\n\n        container.Add(provider.GetType(), provider);\n        //throw new NotImplementedException();\n    }\n\n    public T Resolve&lt;T&gt;() where T : class\n    {\n\n        return (T)Resolve(typeof(T));\n    }\n\n    public object Resolve(Type type)\n    {\n        List&lt;ConstructorInfo&gt; konstruktor = new List&lt;ConstructorInfo&gt; { };\n        foreach (ConstructorInfo cons in type.GetConstructors())\n        {\n            konstruktor.Add(cons);\n        }\n        if (konstruktor.Count == 0)\n        {\n            return Activator.CreateInstance(type);\n        }\n        else\n        {\n            ConstructorInfo active = null;\n            int lparams = 0;\n            foreach (ConstructorInfo cnst in konstruktor)\n            {\n                int inner=0;\n                foreach (ParameterInfo a in cnst.GetParameters())\n                {\n                    inner++;\n                }\n                if (inner &gt; lparams)\n                {\n                    active = cnst;\n                }\n\n            }\n            List&lt;object&gt; lista = new List&lt;object&gt; { };\n            foreach(ParameterInfo param in active.GetParameters())\n            {\n                if (container.ContainsKey(param.GetType()))\n                {\n                    lista.Add(container[param.GetType()]);\n                }\n                else\n                {\n                    //throw new UnresolvedDependenciesException();\n                }\n            }\n\n            object[] obiekty= lista.ToArray();\n            return  Activator.CreateInstance(type, obiekty);\n        }\n        if (container.ContainsKey(type))\n        {\n            return container[type];\n        }\n        else\n        {\n            //throw new UnresolvedDependenciesException();\n        }\n\n    }\n\n\n    public void Register&lt;T&gt;(T impl) where T : class\n    {\n        container.Add(impl.GetType(), impl);\n    }\n}\n</code></pre>\n\n<p>Part of test unit</p>\n\n<pre><code>public void P1__Container_Should_Register_Singleton_As_Object()\n{\n    // Arrange\n    var container = (IContainer)Activator.CreateInstance(LabDescriptor.Container);\n    var singleton = new FakeImpl();\n\n    // Act\n    container.Register(singleton);\n    var result = container.Resolve&lt;IFake&gt;();\n\n    // Assert\n    Assert.That(result, Is.Not.Null);\n    Assert.That(result, Is.SameAs(singleton));\n}\n</code></pre>\n\n<p>Sorry for clumsy code etc. Just starting here.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13272019,"title":"Single click on button not working but double click does the work","body":"<p>Here is my html code</p>\n\n<pre><code>&lt;form runat=\"server\"&gt;\n    Hello, i'm login page\n    Enter Name   &lt;asp:TextBox ID=\"txtName\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n    &lt;input type=\"submit\" value=\"PressMe\" onclick=\"location.href='&lt;%: Url.Action(\"EnterLogin\", \"LoginForm\") %&gt;'\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my controller code</p>\n\n<pre><code>public class LoginFormController : Controller\n{\n    public ActionResult ShowLogin()\n    {\n        return View();\n    }\n\n    public ActionResult EnterLogin()\n    {\n        ViewData[\"Name\"] = Convert.ToString(Request.Form[\"txtName\"]);\n        return View(\"EnterLogin\");\n    }\n}\n</code></pre>\n\n<p>On clicking <strong>PressMe</strong> button the expected output is to display Enter Login View but it doesn't.If i double click on the button then it works fine.\nAny reason for single click not to work??</p>\n"},{"tags":["c#","linq-to-xml"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2205,"score":3,"question_id":1545204,"title":"how to get root node attribute value using linq","body":"<p>I have the following XML. How to read the root node attribite value and it's decendents using LINQ? I am trying to read \"dId\" and \"dTime\" from root node, \"id\" from Customer element and Order number.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n &lt;Customers dId=\"wqwx\" dTime=\"10-9-09 11:23\"&gt;\n   &lt;Customer id=\"1\"&gt;\n      &lt;Orders&gt;\n        &lt;Order number=\"22\" status=\"ok\"&gt;\n      &lt;/Orders&gt;\n   &lt;/Customer&gt;\n &lt;/Customers&gt;\n</code></pre>\n\n<p>I tried the following code but it doesn't work.</p>\n\n<pre><code>XDocument doc= XDocument.Load(@\"C:\\Customers.xml\");\nvar q = from c in doc.Descendants(\"Customers\")\n        select new        \n          {   \n           dID = c.Attribute(\"dId\"),\n           dTime = c.Attribute(\"dTime\");\n          }\n</code></pre>\n"},{"tags":["c#","winforms","caching","singleton"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13280912,"title":"Designing a caching schema for Winforms","body":"<p>I have a Winform application that I am trying to implement caching in order to speed up the process of reading data everytime one of my class methods get called. I am thinking of using a Singleton-like approach. I am thinking of something like this:</p>\n\n<pre><code>public class MyCache {\n    private MyDataClass _cacheData;\n    private static MyCache _cache;\n\n    public static MyCache CreateCache()\n    {\n        return _cache ?? new MyCache();\n    }\n\n    public void CacheData(MyDataClass data)\n    {\n        _cache = data;\n    }\n\n    public MyDataClass GetCache()\n    {\n        return _cache;\n    } \n}\n</code></pre>\n\n<p>Can someone tell me if this approach is good or if there is a better approach I should use?</p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":39,"score":-1,"question_id":13281248,"title":"Reload a .js file on selectedindex change event of dropdown in asp.net","body":"<p>I have a dropdown inside update panel. On the selected index change event, i need to execute a .js file using c# or javascript\nHow can i do this ?</p>\n\n\n\n<pre><code>&lt;asp:UpdatePanel ID=\"UP_Social_Ddl\" runat=\"server\"&gt;\n  &lt;ContentTemplate&gt;\n     &lt;div class=\"styled-select\"&gt;\n      &lt;asp:Label runat=\"server\" \n         ID=\"Label2\" \n         Font-Size=\"Small\" \n         ToolTip=\"Social : 'ON' will post your activity on this page to your FaceBook Wall.\"   Text=\"Social :\" \n         Style=\"vertical-align: bottom;\" /&gt;\n          &lt;asp:DropDownList \n             ID=\"ddlSocialSwitch\" \n             runat=\"server\" \n             AutoPostBack=\"true\" \n             Style=\"vertical-align: middle;\" \n              ToolTip=\"Social : ON will post your activity on this page to your FaceBook Wall.\"   \n              OnSelectedIndexChanged=\"ddlSocialSwitch_SelectedIndexChanged\"&gt;\n          &lt;/asp:DropDownList&gt;\n       &amp;nbsp;&lt;a valign=\"bottom\" onclick=\"logout_fb\" href=\"#\" id=\"auth-logoutlink\"&gt;&lt;img valign=\"bottom\" src=\"facebookLogOutButton.png\"/&gt;&lt;/a&gt;\n       &lt;asp:Label ID=\"lbl\" Visible=\"false\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n      &lt;/div&gt;\n  &lt;/ContentTemplate&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13280919,"title":"Assign variable values inside method","body":"<p>I'm trying to get make method in which I can assign values to multiple variables. I don't know how many variables I will have, but I know their type. The variables can all be of different types though.</p>\n\n<p>I have googled quite a bit about this, and am fairly sure that this can't be done with managed code. (Correct me if I'm wrong though)</p>\n\n<p>I don't know much (read: anything) about unsafe code. Can it be done that way? Maybe pass in an array of pointers to the variables I want to initialise and do it that way?</p>\n\n<p>I am basically looking for a way to pass an arbitrary number of mixed type variables to a method and assign their values inside the method... Is it pie in the sky?</p>\n\n<p>EDIT 1:</p>\n\n<p>Here is some code which I hope illustrates what I would like to achieve:</p>\n\n<pre><code>private void SomeMethod()\n{\n    string a = string.empty;\n    int b = 0;\n    double c = 0;\n\n    object[] testObject = new object[] { b, c };\n\n    SetVariables(ref testObject);\n}\n\npublic static void SetVariables(ref object[] Variables)\n{\n    for (int i = 0; i &lt; Variables.Length; i++)\n        Variables[i] = // The value the variable needs to have\n}\n</code></pre>\n\n<p>After <code>SetVariables</code> has executed, a, b and c would be say:</p>\n\n<pre><code>a = \"Some text\"\nb = 123\nc = 1564.653\n</code></pre>\n\n<p>I am looking for a way to access the variables passed in as the parameter to SetVariables and modify their value. I guess that would mean accessing their storage location in memory, hence my thinking that I might need pointers?</p>\n\n<p>EDIT 2:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/13266305/casting-data-to-type-of-variables-stored-in-object\">My question here</a> should give a better indication of the context in which I am trying to do this.</p>\n\n<p>I will only be dealing with basic types: string, int, double and bool for the variables I want to assign to.</p>\n\n<p>The data I am assigning from is in text format and has a variable number of fields. Each field should map to one of the input variable in the order in which the variables are passed in. If the order does not match there will be a misasignment at best or a type error at worst, but it is up to the user to make sure that the variables match the data.</p>\n"},{"tags":["c#","data-structures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13281379,"title":"Designing a self-rotating generic list","body":"<p>I am looking for a data structure similar to a <code>List&lt;T&gt;</code>. </p>\n\n<p>What I want to be able to do is specify the maximum number of items this structure can hold, for example, 10 items. When an 11th item is added, what I want it to do is remove the first item added, move the rest of the items up in the list and add the 11th item to the bottom of the list. </p>\n\n<p>When another item is added, again, the top item is removed and everything moves up again, etc etc.</p>\n\n<p>Is there a data structure like this already that exists in .NET? Or do I need to build my own?</p>\n"},{"tags":["c#","reference","keyword","out","ref"],"answer_count":11,"favorite_count":36,"up_vote_count":94,"down_vote_count":0,"view_count":40560,"score":94,"question_id":388464,"title":"What's the difference between the 'ref' and 'out' keywords?","body":"<p>I'm creating a function where I need to pass an object so that it can be modified by the function. What is the difference between:</p>\n\n<pre><code>public void myFunction(ref MyClass someClass)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>public void myFunction(out MyClass someClass)\n</code></pre>\n\n<p>Which should I use and why?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","partial-views"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13255107,"title":"Can I modify MVC viewmodel before passing it into a Partial","body":"<p>If I have a model passed onto Index.cshtml </p>\n\n<p>Can I modify a property on the model inside of a code block in Index.cshtml and then pass modified model into Html.Partial(\"_MyView\", Model)</p>\n\n<pre><code>@model.Name = \"Joe\"\n\n@Html.Partial(\"_MyView\", Model)\n\n@model.Name = \"Ann\"\n\n@Html.Partial(\"_MyView\", Model)\n</code></pre>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":13271067,"title":"Difference between Display(Name) and DisplayName","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5243665/displayname-attribute-vs-display-attribute\">displayname attribute vs display attribute</a>  </p>\n</blockquote>\n\n\n\n<p>Is there any difference between <code>Display(Name=\"MyName\")</code> and  <code>DisplayName(\"MyName\")</code> or is it only a feature of ASP.NET MVC ? \nI'm talking about the namespace <b>System.ComponentModel.DataAnnotations</b>.</p>\n"},{"tags":["c#","visual-studio-2010","registry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3303,"score":0,"question_id":4950974,"title":"read registry key #1","body":"<p>I wrote a firefox extension and I want to check that it is loaded from a service developed in visual studio 2010 c#.  I have researched and tried numerous different methods to read a key and all I get is:  \"Registry read failed: System.NullReferenceException: Object reference not set to an instance of an object.\"  Here is one method I used:</p>\n\n<pre><code>RegistryKey rKey1 = Registry.CurrentUser;\nRegistryKey rKey2 = rKey1.OpenSubKey(\"Software\\\\Mozilla\\\\Firefox\\\\Extensions\");\nstring strKeyValue = rKey2.GetValue(\"thing@place.com\").ToString();\n</code></pre>\n"},{"tags":["c#","email"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13281341,"title":"How to convert strings from \"GBK\" to \"UTF-8\" in C#?","body":"<p>I come up against problem when I develop my email client.I find the name of the email attachment in Chinese is messy code when I send an email with attachment which name include Chinese from my app to the email server and get if back from the server.But it is right at the email server.In addition,when I send an email with attachment which name include Chinese from the other client,it's all Ok. Thank you for all!</p>\n"},{"tags":["c#","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13281267,"title":"Windows8 Listbox Align Text Center","body":"<p>How do you center align the items of a Listbox using C# in Windows 8?   </p>\n\n<p>Here is my xaml:</p>\n\n<pre><code>        &lt;ListBox x:Name=\"listBox1\" HorizontalAlignment=\"Left\" Height=\"365\" Margin=\"242,275,-1,0\" VerticalAlignment=\"Top\" Width=\"190\" SelectionChanged=\"listBox1_SelectionChanged\" FontSize=\"20\" FontWeight=\"Bold\"/&gt;\n</code></pre>\n\n<p>And in the code behind, I populate the listbox with the following code: </p>\n\n<pre><code>  listBox1.Items.Add(new ListBoxItem() { Content = Global.availableDecks[0].ToString(), IsEnabled = true });\n  listBox1.Items.Add(new ListBoxItem() { Content = Global.availableDecks[1].ToString(), IsEnabled = true });\n</code></pre>\n"},{"tags":["c#","windows-services","multithreading","backgroundworker"],"answer_count":12,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":7964,"score":9,"question_id":1498498,"title":"Windows Service that runs Periodically","body":"<p>I'm writing a windows service that once started will run every X hours.  The process it completes is fairly intensive, so I want to use a background worker.  I'm using a Settings file to store both the hours between runs and the last time the service ran.</p>\n\n<p>I'm not exactly sure the best way to do this - that is, I want the service to idle using as few resources as possible, and when it runs, it needs to run in the background worker, report what it did, and then go back into idle mode.</p>\n\n<p>I've thought about using 2 background workers.  The first worker would be a private local variable for the service that runs something like this:</p>\n\n<pre><code>while (true)\n{\n      //create new background worker and run\n\n      Thread.Sleep(Settings.Default.SleepTimeHours * 3600000);\n}\n</code></pre>\n\n<p>with a sub worker that is created each iteration of the loop, and destroyed when completed.  To support cancellation, I think I would have to have a local instance of the second worker available in the service, but it will be null if the process currently is not running.  When the secondary worker completes, it would send out my reporting, set the last run time in the settings file, and then dispose of the worker and set the reference to null.</p>\n\n<p>I'm wondering if there is a better way to do this or a best practice.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","netsuite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12959181,"title":"Trying to download file from FileCabinet in NetSuite using C# program","body":"<p>I need to download JPG file from <code>FileCabinet</code> in <code>NetSuite</code>. For that I know the file name, so I searched file and assigned to <code>FileObject</code>. I got the object right, but got <code>NULL</code> content. I am providing here some code. Can anybody point out the error or any missing step here? Thank you.</p>\n\n<pre><code>var result = _service.search(flSearch);\nif (result.totalRecords &gt; 0)\n{\n    recordList = result.recordList;\n    Record[] records = new Record[recordList.Length];\n    for (int j = 0; j &lt; recordList.Length; j++)\n    {\n        if (recordList[j] is File)\n        {\n            File itemImage = (File)(recordList[j]);            \n            byte[] data;\n            data = new Byte[(int)itemImage.fileSize];\n            data = itemImage.content;  //Here getting NULL value\n            FileStream inFile;\n            using (inFile = new FileStream(\"newImage.jpg\", FileMode.Create, FileAccess.Write))\n            {\n                inFile.Write(data, 0, data.Length);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13281143,"title":"How can I change the Icon of WPF application","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1881580/wpf-icon-for-all-app-windows\">WPF Icon for all app windows</a>  </p>\n</blockquote>\n\n\n\n<p>I have a <code>wpf</code> application, I want to set the icon for all the windows.</p>\n\n<p>I have and <code>ico</code> file in my project folder /img/app.ico, but it is <code>build action = Resource</code>.</p>\n\n<p>I change the application <code>Icon and manifest</code> to <code>/img/app.ico</code>, but it won't work. </p>\n\n<p>An error is prompt when compiling:</p>\n\n<pre><code>The img/app.ico is not found.\n</code></pre>\n"},{"tags":["c#","security","arguments","command-line-arguments","truecrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13279436,"title":"See command line arguments being passed to a program","body":"<p>You may skip this part</p>\n\n<blockquote>\n  <p>I am using a batch file that I have in my thumb drive in order to\n  mount a true crypt volume. I created that batch file with the help of\n  <a href=\"http://www.truecrypt.org/docs/?s=command-line-usage\" rel=\"nofollow\">this link</a>. on that batch file I have the username and password\n  that I pass as arguments to trueCrypt.exe in order for it to be\n  mounted.</p>\n</blockquote>\n\n<hr>\n\n<p>Anyways so my question is: will it be possible to see the arguments being passed to a program from a third party process? In other words, will it be possible to see the arguments being passed to this program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.Diagnostics;\n\nclass Program\n{\n    static string password = \"\";\n\n    static void Main(string[] args)\n    {\n        if (args.Length &gt; 0)\n            password = args[0];\n\n        // get location where this program resides \n        var locationOfThisExe = Assembly.GetExecutingAssembly().Location;\n\n\n        Console.Write(\"Press enter to start a new instance of this program.\");\n        Console.Read();\n\n        var randomArgument = new Random().NextDouble().ToString();\n        Process.Start(locationOfThisExe, randomArgument); \n        // I am passing a random argument to a new process!\n        // is it possible to see these arguments from another process?\n    }\n}\n</code></pre>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p><strong>I am creating an edit cause I think I explained my self incorrectly but this edit should be a solution instead of a question</strong></p>\n\n<p>I think this question has not received enough attention. Executing the command showed by <a href=\"http://stackoverflow.com/users/235660/alois-kraus\">http://stackoverflow.com/users/235660/alois-kraus</a>  shows:</p>\n\n<p>(I pasted the output on notepad++)</p>\n\n<p><img src=\"http://i.stack.imgur.com/TAdH2.png\" alt=\"enter image description here\"></p>\n\n<p>on the image it does not show very clearly but I was able to see the argument being pass to that process. <strong>That matters a lot to me because I mount my true crypt volumes with the command:</strong></p>\n\n<p>\"C:\\Program Files\\TrueCrypt\\TrueCrypt.exe\" /v \"a:\\volume.tc\" /lz /a /p a</p>\n\n<p>that tells to truecrypt that I want to mount the volume located at <code>a:\\volume.tc</code> on drive letter z  and the password is <code>a</code></p>\n\n<p>If I execute that command true crypt will mount that volume on drive z:</p>\n\n<p><img src=\"http://i.stack.imgur.com/pDY9h.png\" alt=\"enter image description here\"></p>\n\n<p>the problem is that If I then execute the command <code>wmic process</code> note what shoes up:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vkGM1.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Note the password is in there!</strong></p>\n\n<p>So in summary it is not safe to pass secure information as an argument. It may be secure if you close the process that received the arguments but I think it is important to be aware of this...</p>\n"},{"tags":["c#","entity-framework","grid","devexpress","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13281199,"title":"Create master/detail grids using XtraGrid Entity framework","body":"<p>I'm a beginner regarding C#, Entity and working with grids, so although I assume what I'm asking is somewhat general, I am a little lost.\nI have two tables in my SQL database: <code>PeriodicReports</code> and <code>PeriodicReportGroups</code>. Each reports group can have 1 or more periodic reports, so what I envisioned was a grid with rows that would have a + sign at the left and could be expanded, showing the related periodic reports for each group. I know this can be done because I've seen very similar examples in DevExpress support site, but although I've put time trying to understand them and apply them to my case, I still haven't figured how to do it. \nThis is what my code looks like. After using the Entity Framework with my tables, this class got created automatically:</p>\n\n<pre><code>public partial class ReportEntities : DbContext\n{\n    public ReportEntities()\n        : base(\"name=ReportEntities\")\n    {\n    }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        throw new UnintentionalCodeFirstException();\n    }\n\n    public DbSet&lt;PeriodicReportGroup&gt; PeriodicReportGroups { get; set; }\n    public DbSet&lt;PeriodicReport&gt; PeriodicReports { get; set; }\n}\n</code></pre>\n\n<p>I created this interface and class myself in order to only show certain columns in my grid:</p>\n\n<pre><code>    public interface IPeriodicReportGroup\n{\n    string Name { get; }\n    string Description { get; }\n    bool Active { get; set; }\n}\n\npublic partial class PeriodicReportGroup : IPeriodicReportGroup\n{\n}\n</code></pre>\n\n<p>And in the other hand, I have my XtraForm with an XtraGrid:</p>\n\n<pre><code>public partial class Form1 : XtraForm\n{\n    public Form1()\n    {\n        InitializeComponent();\n        InitSkinGallery();\n        InitGrid();\n    }\n\n    BindingList&lt;IPeriodicReportGroup&gt; gridDataList = new BindingList&lt;IPeriodicReportGroup&gt;();\n\n    void InitGrid()\n    {\n        var database = new ReportEntities();\n\n        var reportGroups = database.PeriodicReportGroups.ToList( );\n\n        foreach (var group in reportGroups )\n            gridDataList.Add( group );\n\n        gridControl.DataSource = gridDataList;\n    }\n...\n</code></pre>\n\n<p>So far, I'm successfully putting the periodic report groups that I have in my DB in the grid, which is good. But I still have no clue on how exactly set up the details grid that will expand for each group, although I feel it should be something pretty standard. Can anybody offer some guidance? I'm not asking for somebody else to do my work, just something that can point me out in the right direction, because right now I'm pretty lost. \nI'd also love to be able to add new groups and new details on the run by inputting data into an empty row, is this possible? </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","facebook","facebook-graph-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13281032,"title":"Retrieving more post from public fb page using FB graph api","body":"<p>As i have tried getting the post from a public facebook page, by passing access token, however i can only retrieve the latest 25 post. Can i increase number number of post returned? or can i retrieve post based on dates i want. If possible, can someone guide me how to do so?</p>\n\n<p>what i have now:</p>\n\n<pre><code>  static JsonObject GetPost(string accessToken)\n    {\n        FacebookClient facebookClient = new FacebookClient(accessToken);\n\n        JsonObject pagePost = facebookClient.Get(\"/pageName/posts\") as JsonObject;\n\n        return pagePost;\n\n    }\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":1565,"score":0,"question_id":3733429,"title":"how to show password in asterik format when we generate random password","body":"<p>i am generate random password and show it in a textbox.\nwhen i am set textbox property textmode to password then it doesn't show in textbox but when i set it singleline then password shows in textbox.\nI am using following code -- </p>\n\n<pre><code>textbox1.attributes.add(\"value\",passwordvalue);\n</code></pre>\n\n<p>for show i am using --</p>\n\n<pre><code>textbox1.text = textbox1.attributes[\"value\"].tostring();\n</code></pre>\n\n<p>Same happing with when i edit record. password doesn't show in textbox. </p>\n"},{"tags":["c#","eclipse"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13281077,"title":"Cannot install emonic c# plugin to Eclipse 3.7.2","body":"<p>I wanted to use the c# inside the Eclipse, but I get that error while trying to install. How to solve that problem.</p>\n\n<p>Below: version of my Eclipse, source(put in the plugin manager) information after calculating dependencies.</p>\n\n<pre><code>Version: 3.7.2\nBuild id: M20120208-0800\n</code></pre>\n\n<hr>\n\n<pre><code> http://emonic.sourceforge.net/updatesite/internap/site.xml\n</code></pre>\n\n<hr>\n\n<pre><code>Cannot complete the install because some dependencies are not satisfiable\norg.emonic.debugger_feature.feature.group [0.0.2] cannot be installed in this environment because its filter is not applicable.\n</code></pre>\n"},{"tags":["c#","fizzbuzz"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13280940,"title":"Feedback on Fizz Buzz programming test","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11764539/writing-fizzbuzz\">Writing FizzBuzz</a>  </p>\n</blockquote>\n\n\n\n<p>I've just been at a job interview where I was posed the task of coding a solution to the FizzBuzz test in C# at the interview and by hand and I'd like some constructive feedback on my solution, i.e. the quality and/or readability of the code.</p>\n\n<p>The FizzBuzz test is to write a program that goes through the numbers 1 to 100. For every multiple of 3, the program should output \"Fizz\" and for every multiple of 5 it should output \"Buzz\".\nIf both above conditions are met it should output \"FizzBuzz\". If none of the above conditions are met, it should just output the number.</p>\n\n<p>Here is my solution in C#:</p>\n\n<pre><code>        for (int i = 1; i &lt; 101; i++)\n        {\n            string Output = \"\";\n\n            if (i%3 == 0)\n                Output = \"Fizz\";\n            if (i%5 == 0)\n                Output += \"Buzz\";\n            if (Output != \"\")\n                Console.WriteLine(Output);\n            else\n                Console.WriteLine(i.ToString()); \n         }\n</code></pre>\n\n<p>I've specifically not included comments in the code. Constructive feedback is appreciated, especially when it comes to readability.</p>\n"},{"tags":["c#","jquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":230,"score":1,"question_id":3819299,"title":"Jquery timepickr C#","body":"<p>I try to use timepickr plugin, from <a href=\"http://haineault.com/media/jquery/ui-timepickr/page/\" rel=\"nofollow\">http://haineault.com/media/jquery/ui-timepickr/page/</a></p>\n\n<p>my headers:</p>\n\n<pre><code>&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery-1.4.2.min.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;   \n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery-ui-1.8.2.custom.min.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery.utils.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/jquery.strings.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"&lt;%=ResolveUrl(\"~/Scripts/ui.timepickr.js\")%&gt;\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>my view:</p>\n\n<pre><code>&lt;input type=\"text\" id=\"hourstime\" style=\" font-family:Arial;width: 47px; vertical-align:inherit;margin:1;\"/&gt;\n</code></pre>\n\n<p>and jquery:</p>\n\n<pre><code>$(document).ready(function () {\n    $('#hourstime').timepickr();\n});\n</code></pre>\n\n<p>So, it fails with error:</p>\n\n<pre><code>Uncaught TypeError: Cannot call method 'call' of undefined\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","linq","collections","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13275694,"title":"How to build this LINQ expression?","body":"<p>I have a class that looks like this: </p>\n\n<pre><code>class UserProfile { public int Id; public int? ParentId; public string Name; public string Role; }\n</code></pre>\n\n<p>Each UserProfile is a user or an admin. Each user may be a child of a single admin, whose Id is stored in the user's ParentId. Below is an example:</p>\n\n<pre><code>IEnumerable&lt;UserProfile&gt; users = new List&lt;UserProfile&gt;{\n        new UserProfile(){Id = 1, ParentId = null,  Name = \"Admin1\", Role = \"Admin\" },\n        new UserProfile(){Id = 2, ParentId = 1,  Name = \"User2\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = 1,  Name = \"User3\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = null,  Name = \"Admin2\", Role = \"Admin\" },\n        new UserProfile(){Id = 4, ParentId = 3,  Name = \"User4\", Role = \"Admin\" },\n        new UserProfile(){Id = 5, ParentId = null,  Name = \"User5\", Role = \"Admin\" },\n        new UserProfile(){Id = 6, ParentId = 3,  Name = \"User6\", Role = \"Admin\" },\n    };  \n</code></pre>\n\n<p>I need to rearrange this list or create another list, so that it will be in specific order:\nAll admins and their users:</p>\n\n<ul>\n<li><strong>Admin1</strong> (full details)   </li>\n<li>User2 (full details)</li>\n<li>User3 (full details)  </li>\n<li>User5 (full details) </li>\n<li><strong>Admin2</strong> (full details)   </li>\n<li>User4 (full details)</li>\n<li>User6 (full details)</li>\n</ul>\n\n<p>I tried to separate them first, but I don't know how to merge them in the desired order.</p>\n\n<pre><code>var adminsOnly = users.Where(p =&gt; p.Role.Equals(\"Admin\")).OrderBy(p =&gt; p.Id);\nvar usersOnly = users.Where(p =&gt; p.Role.Equals(\"User\")).OrderBy(p =&gt; p.Id);\n</code></pre>\n\n<p>Thanks a lot.</p>\n\n<p><strong>Note: There can be Users without Admins, and Admins without Users.</strong></p>\n"},{"tags":["c#","wpf","listbox","scrollbar"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13280837,"title":"WPF – Wrong scrolling in a reverse ordered (bottom to top) ListBox","body":"<p>I have the following code to reverse a <code>ListBox</code> (items are placed form bottom to top):</p>\n\n<pre><code>&lt;ListBox HorizontalContentAlignment=\"Stretch\"&gt;          \n    &lt;ListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel VerticalAlignment=\"Bottom\"  Orientation=\"Vertical\"&gt;\n                &lt;VirtualizingStackPanel.LayoutTransform&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/VirtualizingStackPanel.LayoutTransform&gt;\n            &lt;/VirtualizingStackPanel&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListBox.ItemsPanel&gt;\n    &lt;ListBox.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"ListBoxItem\"&gt;\n            &lt;Setter Property=\"LayoutTransform\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ScaleTransform ScaleX=\"1\" ScaleY=\"-1\" /&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListBox.ItemContainerStyle&gt;\n&lt;/ListBox&gt;\n</code></pre>\n\n<p>If you add some items, you will see that the scrollbar is wrong (original instead inverse). What can I do to transform the scrollbar like done with the content? BTW, If you set  <code>ScrollViewer.CanContentScroll=\"False\"</code> in the ListBox the scrolling is fine. But then Virtualization is lost.</p>\n"},{"tags":["c#","winapi","time","clickonce","administrator"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3307,"score":2,"question_id":5713825,"title":"Run as administrator: requireAdministrator & ClickOnce + emulating system time","body":"<p>My app uses ClickOnce  tehcnology. Today I needed to run it as administrator. I modified the manifest file from</p>\n\n<pre><code>&lt;requestedExecutionLevel  level=\"asInvoker\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>However VS cannot compile the project:</p>\n\n<blockquote>\n  <p>Error 35  ClickOnce does not support the request execution level 'requireAdministrator'.  </p>\n</blockquote>\n\n<p>I think it's impossible to use them at once. Isn't it? I need to change the system time, can I do that in application level? Can I emulate it, so app. can do what I want. I change time +2 hours then put back for a second. I got a few dlls and they ask for time.</p>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":11572981,"title":"How to XML serialize polymorphic array without wrapping element","body":"<p>Want to serialise my data into this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n   &lt;ExecuteCommand Command=\"...\" /&gt;\n   &lt;WaitCommand Seconds=\"5\" /&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>But instead I'm getting this (note the wrapping Commands element)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n  &lt;Commands&gt;&lt;!-- I want to get rid of thiw wrapper Commands element and just  --&gt;\n    &lt;ExecuteCommand Command=\"...\" /&gt;\n    &lt;WaitCommand Seconds=\"5\" /&gt;\n  &lt;/Commands&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>Here's the sample code used to produce this:</p>\n\n<pre><code>public class BaseCommand //base class\n{\n    [XmlAttribute]\n    public string Result { get; set; }\n}\n\npublic class ExecuteCommand : BaseCommand\n{\n    [XmlAttribute]\n    public string Command { get; set; }\n}\n\npublic class WaitCommand : BaseCommand\n{\n    [XmlAttribute]\n    public int Seconds { get; set; }\n}\n\npublic class Batch\n{\n    [XmlAttribute]\n    public string Name { get; set; }\n\n    private List&lt;BaseCommand&gt; _commands = new List&lt;BaseCommand&gt;();\n    [XmlArrayItem(typeof(ExecuteCommand))]\n    [XmlArrayItem(typeof(WaitCommand))]\n    public List&lt;BaseCommand&gt; Commands\n    {\n        get\n        {\n            return _commands;\n        }\n        set\n        {\n            _commands = value;\n        }\n    }\n\n    public static void Main()\n    {\n        XmlSerializer serializer = new XmlSerializer(typeof(Batch));\n\n        Batch b = new Batch();\n        b.Name = \"Test batch\";\n        b.Commands.Add(new ExecuteCommand() { Command = \"...\" });\n        b.Commands.Add(new WaitCommand() { Seconds = 5 });\n\n        serializer.Serialize(Console.Out, b);\n        Console.Read();\n    }\n}\n</code></pre>\n\n<p>I searched and read heaps of articles on this topic. They all seem to provide solution for serializing collections with a single class type (no inheritance used). I use inheritance and nothing seems to work. Unfortunately I have to output precise XML document due to legacy support</p>\n"},{"tags":["c#","unit-testing","asp.net-mvc-3","session"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":586,"score":2,"question_id":6990019,"title":"How can I properly Mock the KeysCollection in HttpSessionStateBase?","body":"<p>I setup this mock session object from the example here: <a href=\"http://stackoverflow.com/questions/340827/how-to-moq-an-indexed-property\">How to MOQ an Indexed property</a></p>\n\n<pre><code>/// &lt;summary&gt;\n/// HTTP session mockup.\n/// &lt;/summary&gt;\ninternal sealed class HttpSessionMock : HttpSessionStateBase\n{\n    private readonly Dictionary&lt;string, object&gt; objects = new Dictionary&lt;string, object&gt;();\n\n    public override object this[string name]\n    {\n        get { return (objects.ContainsKey(name)) ? objects[name] : null; }\n        set { objects[name] = value; }\n    }\n}\n</code></pre>\n\n<p>some sample code to produce an error...</p>\n\n<pre><code>var mockSession = new HttpSessionMock();\nvar keys = mockSession.Keys;\n</code></pre>\n\n<p>Error: <strong>The method or operation is not implemented.</strong></p>\n\n<p>I need to implement the Keys property, but can't create a KeysCollection object.</p>\n\n<p>What is the best way to do this?</p>\n\n<p>EDIT: [SOLUTION]</p>\n\n<p>I ended up changing the HttpSessionMock based on the answer given.  This is what I ended up with.  (I also added a reference to System.Linq).</p>\n\n<pre><code>internal sealed class HttpSessionMock : HttpSessionStateBase\n{\n    private readonly NameValueCollection objects = new NameValueCollection();\n\n    public override object this[string name]\n    {\n        get { return (objects.AllKeys.Contains(name)) ? objects[name] : null; }\n        set { objects[name] = (string)value; }\n    }\n\n    public override NameObjectCollectionBase.KeysCollection Keys\n    {\n        get { return objects.Keys; }\n    }\n}\n</code></pre>\n\n<p>note: this mock session will only store strings, not objects.</p>\n"},{"tags":["c#","janus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":9323231,"title":"How to switch from 4.0.25 to 4.0.18 in Janus Components","body":"<p>I want to change my <strong>Janus Components</strong> from 4.0.25 version to 4.0.18 version without replacing each component one by one.</p>\n\n<p>Anyone know how I can do this? </p>\n"},{"tags":["c#","nhibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13222894,"title":"Very slow update with nHibernate","body":"<p>I'm using nHibernate with one session per method. I'm using Castle Dynamic Proxy to open a session and a transaction before executing the method and I commit the transaction and close the session right after the execution of this method.</p>\n\n<p>I'm using a SQLite database and if set cascade to SaveUpdate or None doesn't change anything. nHIbernate is configured with Fluent nHibernate with the default configuration. </p>\n\n<p>When I flush the session, it takes more than 2 seconds.</p>\n\n<pre><code>public void AddNewChild(LightPatientDto patient, LightPatientDto child)\n{\n    var ePatient = this.Session.Load&lt;Patient&gt;(patient.Id);\n    var eChild = this.Session.Load&lt;Patient&gt;(child.Id);\n\n    switch (ePatient.Gender)\n    {\n        case Gender.Male:\n            eChild.Father = ePatient;\n            break;\n        case Gender.Female:\n            eChild.Mother = ePatient;\n            break;\n        default:\n            Assert.FailOnEnumeration(eChild.Gender);\n            break;\n    }\n\n    this.Session.Update(eChild);\n    this.Session.Flush(); // &lt;== takes more than 2 seconds\n}\n</code></pre>\n\n<p>NHibernate profiler gives me this SQL is executed in 2008 ms. When I copy paste this SQL using a SQLite administration tool, it's executed in 90 ms.</p>\n\n<pre><code>UPDATE Patient\nSET    BirthDate = '1964-05-06T00:00:00.00' /* @p0 */,\n       Fee = 0 /* @p1 */,\n       Height = 0 /* @p2 */,\n       InscriptionDate = '2007-05-21T00:00:00.00' /* @p3 */,\n       PlaceOfBirth = 'xxxxxx' /* @p4 */,\n       PrivateMail = '' /* @p5 */,\n       PrivateMobile = NULL /* @p6 */,\n       PrivatePhone = '0496/xx.xx.xx' /* @p7 */,\n       Reason = 'diabète' /* @p8 */,\n       Father_id = 2 /* @p9 */,\n       Insurance_id = 1 /* @p10 */,\n       Mother_id = NULL /* @p11 */,\n       Practice_id = 1 /* @p12 */,\n       Profession_id = NULL /* @p13 */,\n       Reputation_id = 1 /* @p14 */\nWHERE  Person_id = 3 /* @p15 */\n</code></pre>\n\n<p>How can I optimise the execution time?</p>\n"},{"tags":["c#",".net","xml","linq","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13280719,"title":"How do I read all XML nodes of a specific name and put them into an array (or list)?","body":"<p>I have an XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ticket&gt;\n    &lt;comments type=\"array\"&gt;\n         &lt;comment&gt; \n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;/comment&gt;\n         &lt;comment&gt;\n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;comment&gt;\n     &lt;/comments&gt;\n&lt;/ticket&gt;\n</code></pre>\n\n<p>How would I go about getting whatever is inside the URL tag and add it to a <code>&lt;List&gt;</code>? I'm using C#.</p>\n"},{"tags":["c#","textbox","windows-8","microsoft-metro","dynamically-generated"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13280902,"title":"Save/Restore(Get/Set) absolute position of UI control (textbox) dynamically with C# code in Win8 Metro Store app","body":"<p>as said in title, it's about Windows 8 Metro style store app.</p>\n\n<p>-Textbox is dynamically generated by Code\n - Textbox can be dragged by user to anywhere to the screen\n - user can save the location of textbox anytime\n - user can restore the location of its previously saved location on screen.\n - List item</p>\n\n<p>eg.</p>\n\n<pre><code>TextBox t = new TextBox();\nt.Name = \"TextBoxControl\";\n// add event for dragging\nt.ManipulationDelta += t_ManipulationDelta;\nt.RenderTransform = dragTranslation;\n// Add textbox to screen\nBasic_Root.Children.Add(t)\n</code></pre>\n\n<p>User can drag and textbox anywhere in the screen, but i need to save the position of this dragged textbox's new location. And there is a button, once clicked, will restore the textbox to its previously saved location, may I know how this can be done?</p>\n\n<p>I thought of saving the Margin value of textbox, and set it later for restoring its position, but it didn't work.</p>\n\n<p>I found something about....</p>\n\n<pre><code>var ttv = MainTextBlock.TransformToVisual(Window.Current.Content);\nPoint screenCoords = ttv.TransformPoint(new Point(0, 0)\n</code></pre>\n\n<p>This allow me to see the x,y location of the dragged textbox, so I save the Point, but how can I restore textbox's location with this saved Point?</p>\n\n<p>Many Thanks!</p>\n"},{"tags":["c#","file","parsing","ssis-data-transformations"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13280011,"title":"C# Best way to parse flat file with dynamic number of fields per row","body":"<p>I have a flat file that is pipe delimited and looks something like this as example</p>\n\n<p>ColA|ColB|3*|Note1|Note2|Note3|2**|A1|A2|A3|B1|B2|B3</p>\n\n<p>The first two columns are set and will always be there.</p>\n\n<p>* denotes a count for how many repeating fields there will be following that count so Notes 1 2 3 </p>\n\n<p>** denotes a count for how many times a block of fields are repeated and there are always 3 fields in a block. </p>\n\n<p>This is per row, so each row may have a different number of fields. </p>\n\n<p>Hope that makes sense so far.</p>\n\n<p>I'm trying to find the best way to parse this file, any suggestions would be great.</p>\n\n<p>The goal at the end is to map all these fields into a few different files - data transformation. I'm actually doing all this within SSIS but figured the default components won't be good enough so need to write own code.</p>\n\n<p>UPDATE I'm essentially trying to read this like a source file and do some lookups and string manipulation to some of the fields in between and spit out several different files like in any normal file to file transformation SSIS package.</p>\n\n<p>Using the above example, I may want to create a new file that ends up looking like this</p>\n\n<p>\"ColA\",\"HardcodedString\",\"Note1CRLFNote2CRLF\",\"ColB\"</p>\n\n<p>And then another file</p>\n\n<p>Row1: \"ColA\",\"A1\",\"A2\",\"A3\"</p>\n\n<p>Row2: \"ColA\",\"B1\",\"B2\",\"B3\"</p>\n\n<p>So I guess I'm after some ideas on how to parse this as well as storing the data in either Stacks or Lists or?? to play with and spit out later.</p>\n"},{"tags":["c#",".net","proxy","fiddler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12772332,"title":"C# FiddlerCore API to capture data","body":"<p>I am successfully using the FiddlerCore API in C# to intercept web responses from a particular web host and capture JSON data.</p>\n\n<p>The FiddlerCore API seems to block any other web browsing in Chrome, IE, etc whilst my application is running and capturing data.  I understand that FiddlerCore creates a proxy to catch the traffic but wondered if it was possible to stop FiddlerCore from changing the LAN settings in my browser to direct traffic through a proxy?</p>\n\n<p>I am currently Starting my Fiddler instance using the code below:</p>\n\n<pre><code>         Fiddler.FiddlerApplication.Startup(8877, true, true);\n</code></pre>\n\n<p>And I intercept the data packets in my winforms app in the following event</p>\n\n<pre><code>         FiddlerApplication.AfterSessionComplete\n</code></pre>\n"},{"tags":["c#",".net","multithreading","parallel-processing"],"answer_count":5,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":6330,"score":11,"question_id":3780870,"title":"Using AsParallel()/Parellel.ForEach() guidelines?","body":"<p>Looking for a little advice on leveraging <code>AsParallel()</code> or <code>Parallel.ForEach()</code> to speed this up.</p>\n\n<p>See the method I've got (simplified/bastardized for this example) below.</p>\n\n<p>It takes a list like \"US, FR, APAC\", where \"APAC\" is an alias for maybe 50 other \"US, FR, JP, IT, GB\" etc. countires. The method should take \"US, FR, APAC\", and convert it to a list of \"US\", \"FR\", plus all the countries that are in \"APAC\".</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases)\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias]) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n\n<p>Is making this parallelized as simple as changing it to what's below? Is there more nuance to using <code>AsParallel()</code> than this? Should I be using <code>Parallel.ForEach()</code> instead of <code>foreach</code>? What rules of thumb should I use when parallelizing <code>foreach</code> loops?</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases.AsParallel())\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias].AsParallel()) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n"},{"tags":["c#","windows-8","windows-store-apps","windows-live","windows-store"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13280783,"title":"Is it possible to communicate two WindowsStore apps through Windows Live SDK?","body":"<p>I plan to create a small application where the user can insert the email which is logged in in Windows 8 of the another computer.</p>\n\n<p>I want to create a communication through Sockets. Until I've investigated WINDOWS LIVE SDK will help me but I'm not really informated about that SDK. Is this correct?</p>\n"},{"tags":["c#","visual-studio-2010","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13279769,"title":"Call Method on application launching in Windows Phone SDK 7.1","body":"<p>I need to call a method normally fired by a button of the mainpage.xaml, when the application start.\nDo I need to use the Application_Launching method of the app.xaml? If yes, how?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","windows","button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13273214,"title":"Programmatically Add \"Start Button\" To Windows 8","body":"<p>There have been others that have asked this question but the common registry setting that was suggested doesn't work any longer.  What I would like to do is something similar to StartIsBack that \"reinvokes\" the code to bring the Start Button/Menu back to Windows 8, or I could replicate the work done similar to the other Windows 8 start button alternatives.</p>\n\n<p>Does anyone know how to programmatically (C++ or C#) reinvoke the start button?</p>\n"},{"tags":["c#","wpf","filenotfoundexception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":291,"score":0,"question_id":7413907,"title":"BitmapImage filenotfound exception (PresentationCore.resources) on construction","body":"<p>I have a problem with a BitmapImage in wpf. When i create it it gives a filenotfound exception, which says it's missing the PresentationCore.resources assembly. But i've added it to my references list and it still throws the same exception</p>\n\n<pre><code>Uri filename = new Uri(@\"D:\\barcode_zwart_wit.jpg\", UriKind.Absolute);\nBitmapImage image = new BitmapImage(filename); //&lt;-- FileNotFound Exception\n</code></pre>\n\n<ul>\n<li>The image uri is correct.<br/></li>\n<li>The image isn't opened somewhere else</li>\n<li>I've checked the version of the PresentationCore.resources, no problem there.<br/></li>\n<li>The lines are in the setter of a property, which is first launched in the constructor of a usercontrol.<br/></li>\n<li>Visual Studio 2010, .net v4</li>\n</ul>\n\n<p>Does anyone have any idea what's the problem? Does PresentationCore.resources have any dependencies i don't know about?</p>\n"},{"tags":["c#","javascript","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13280504,"title":"set focus on the first textbox on the page with ajax editor in .net","body":"<p>I a have a web form with few textboxes,dropdowns and finally towards the end of the page is 4 custom ajax editors. So on page load the focus is always inside the last editor and no way it comes to the first text box or top of page.On each page load the cursor goes inside the last editor control.How to bring the focus inside the first text box?\nBelow are the few methods i tried </p>\n\n<p><code>1.&lt;body onload=\"document.body.scrollTop = 0;\"&gt;</code></p>\n\n<pre><code>2.    void Page_Init(object sender, EventArgs e)\n{\n\n    SetFocus(txtReqtitle);\n\n\n}\n</code></pre>\n\n<p>for the above while loading the page i could see the focus goes to the desired text box and then it comes to the last custom control.</p>\n\n<pre><code>3.    if(!Page.ClientScript.IsStartupScriptRegistered(\"scrFocus\"))\n           {\n              string strScript=\"var txtBox=document.getElementById('\" + txtReqtitle.ClientID.ToString() +\"');txtBox.focus();\";\n               ClientScript.RegisterStartupScript(this.GetType(),\"scrFocus\", strScript,true);\n\n\n            }\n</code></pre>\n\n<p>4.</p>\n\n<pre><code>function setFocus() {\ndocument.getElementById(\"txtReqtitle\").focus();\n</code></pre>\n\n<p>}</p>\n\n<pre><code>5. ScriptManager.GetCurrent(this.Page).SetFocus(txtReqtitle);\n</code></pre>\n\n<p>Any ideas? Thanks..</p>\n"},{"tags":["c#","wpf",".net-assembly","serializable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":13263043,"title":"c# Serializable Class - WPF MainWindow Exception Occurs","body":"<p>I have a WPF application which is hooking into a DLL that I am also writing. The DLL scans a data folder of a 3rd Party application and handles all the interpretation of data within. The WPF is to provide a nice GUI on top of that; I separated them because it may be necessary in the future to write a command line interface for it too.</p>\n\n<p>The scanning of the data folder takes some time so I wanted to save the state of the object (a Repository) and open that instead if the data folder has been scanned and retains the same 'Last Modified' state. I have marked the Repository object as [Serializable] however when I attempt to save the state (from either the WPF or the DLL) I get an exception that the WPF MainWindow is not [Serializable].</p>\n\n<p>If I read the created .dat file it does have some (not sure if all) information from that class.</p>\n\n<p>I don't understand why it would be trying to save any information about the WPF windows. I have tried to mark the window as [Serializable] just to try however that class does not allow it. Searching around the web had me looking into AppDomains since I'm loading a DLL along with the application but that is a little over my head. Below is how I am currently trying to implement it. Edit: The call to serialize is at the bottom of the WPF code. </p>\n\n<p>I should mention that I created an inline class within the WPF namespace and was able to successfully serialize that to a file.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>This is the DLL:</p>\n\n<pre><code>namespace HPOO_XML_Parser\n{\n[Serializable]\npublic class HPOORepository\n{\n\n    string _version;\n    string _path;\n    string _library;\n    string _uuid;\n\n\n    [NonSerialized]\n    BackgroundWorker bWorker = new BackgroundWorker();\n    [NonSerialized]\n    XElement _xmlRepo;      \n\n\n    int _nodeCount;\n    List&lt;Node&gt; nodes;\n    ...\n    Rest of properties and methods\n}\n</code></pre>\n\n<p>And the WPF which calls it</p>\n\n<pre><code>namespace HPOO_Repository_Scanner\n{\n/// &lt;summary&gt;\n/// Interaction logic for MainWindow.xaml\n/// &lt;/summary&gt;\npublic partial class MainWindow : Window\n{\n    HPOORepository repo;\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        StatusVisibility(); // Simply hides progress bar/cancel button\n    }\n\n    private void OpenRepository(object sender, RoutedEventArgs e)\n    {\n\n        string ooHome;\n        using (FolderBrowserDialog browser = new FolderBrowserDialog())\n        {\n            ooHome = Environment.GetEnvironmentVariable(\"ICONCLUDE_HOME\");\n            if (ooHome != null)\n            {\n                browser.SelectedPath = ooHome;\n            }\n            browser.ShowNewFolderButton = false;\n            browser.Description = \"Select a repository to open...\";\n\n            if (browser.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                try\n                {\n                    repo = new HPOORepository(browser.SelectedPath);\n                }\n                catch (Exception ex)\n                {\n                    System.Windows.MessageBox.Show(ex.Message, \"Invalid Repository Selected\", MessageBoxButton.OK, MessageBoxImage.Error);\n\n                }\n            }\n            repo.ProgressChanged += new ProgressChangedEventHandler(repo_ProgressChanged);\n\n            prgStatus.Maximum = 100;\n\n            repo.ReadRepository();\n\n        }\n\n    }\nprivate void mnuSave_Click(object sender, RoutedEventArgs e)\n    {\n        SaveRepo(repo);\n    }\n\n    public void SaveRepo(object repository)\n    {\n        BinaryFormatter binFormat = new BinaryFormatter();\n\n        using (Stream fStream = new FileStream(\"test\" + \".dat\",\n            FileMode.Create, FileAccess.Write, FileShare.None))\n        {\n            binFormat.Serialize(fStream, repository);\n        }\n    }\n</code></pre>\n\n<p>Edit: And finally the exception:</p>\n\n<pre><code>System.Runtime.Serialization.SerializationException was unhandled\nMessage=Type 'HPOO_Repository_Scanner.MainWindow' in Assembly 'HPOO Repository Scanner, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.\nSource=mscorlib\nStackTrace:\n\n\n    at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)\n       at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo)\n       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)\n       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph)\n       at HPOO_Repository_Scanner.MainWindow.SaveRepo(Object repository) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 179\n       at HPOO_Repository_Scanner.MainWindow.mnuSave_Click(Object sender, RoutedEventArgs e) in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\MainWindow.xaml.cs:line 168\n       at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)\n       at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\n       at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\n       at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e)\n       at System.Windows.Controls.MenuItem.InvokeClickAfterRender(Object arg)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.DispatcherOperation.InvokeImpl()\n       at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)\n       at System.Threading.ExecutionContext.runTryCode(Object userData)\n       at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Windows.Threading.DispatcherOperation.Invoke()\n       at System.Windows.Threading.Dispatcher.ProcessQueue()\n       at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)\n       at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\n       at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n       at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)\n       at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)\n       at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n       at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)\n       at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\n       at System.Windows.Threading.Dispatcher.Run()\n       at System.Windows.Application.RunDispatcher(Object ignore)\n       at System.Windows.Application.RunInternal(Window window)\n       at System.Windows.Application.Run(Window window)\n       at System.Windows.Application.Run()\n       at HPOO_Repository_Scanner.App.Main() in \\\\tsclient\\D\\Dropbox\\_Work\\Visual Studio Projects\\HPOO Repository Scanner\\HPOO Repository Scanner\\HPOO Repository Scanner\\obj\\x86\\Debug\\App.g.cs:line 0\n       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ThreadHelper.ThreadStart()\n  InnerException: \n</code></pre>\n"},{"tags":["c#","sockets","https","dns","tunnel"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13279475,"title":"Tunnel HTTP, HTTPS and DNS in C#","body":"<p>I want all web traffic (HTTP, HTTPS and DNS - Are there any others?) goes through a local application and goes to a server application and from there goes to internet. How can I do this?</p>\n\n<p>I have wrote an Async TCP server and I know socket Async programming in C# using SocketAsyncEventArgs (I am not a master with just one project but I think I can understand some basics).</p>\n"},{"tags":["c#","jquery","asp.net",".net","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":10489740,"title":"Good way to determine if someone left a webpage","body":"<p>I am trying to code an app for work where our clients can edit certain fields. When they click edit, the code will lock the data to be editted. And when they click save the data will unlock. But I am having trouble deciding if I can unlock the data when they click elsewhere, go to another page or site, or even close the browser.</p>\n\n<p>What's a good way to decide if the user has left the edit page?</p>\n\n<p>(We are using C# .NET 3.5 and JQuery and a SQL Server 2005 DB).</p>\n"},{"tags":["c#","xaml","windows-8"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":3,"view_count":60,"score":0,"question_id":13280050,"title":"How do you develop Windows 8 lock screen app?","body":"<p>I want to put some info on my lock screen in Windows 8. can I do my app for that? can it be done in C# / XAML?</p>\n"},{"tags":["c#","c++","dll","function-pointers"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13280323,"title":"Calling a DLL function that contains a function pointer from C#","body":"<p>I have a DLL that is written in C++ that includes exported function that has a function pointers to be used as callback function. </p>\n\n<pre><code>// C++ \nDllExport unsigned int DllFunctionPointer( unsigned int i, unsigned int (*TimesThree)( unsigned int number ) ) {\n    return TimesThree( i )  ; \n}\n</code></pre>\n\n<p>I have a CSharp application that I would like to use to invoke the DLL functions. </p>\n\n<pre><code>// C#\npublic unsafe delegate System.UInt32 CallBack( System.UInt32 number ); \nclass Program\n{\n    [DllImport(\"SimpleDLL.dll\")]\n    public static extern System.UInt32 DllFunctionPointer( System.UInt32 i, CallBack cb) ;\n\n    static unsafe void Main(string[] args)\n    {\n        System.UInt32 j = 3;\n        System.UInt32 jRet = DllFunctionPointer(j, CallBack );\n        System.Console.WriteLine(\"j={0}, jRet={1}\", j, jRet); \n    }\n\n    static System.UInt32 CallBack( System.UInt32 number ) {\n        return number * 3 ; \n    }\n}\n</code></pre>\n\n<p>The problem with the above code is that the application crashes with the following error message. </p>\n\n<pre><code>'CallingACallbackFromADLL.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\\XXXX\\CallingACallbackFromADLL.exe', Symbols loaded.\nManaged Debugging Assistant 'PInvokeStackImbalance' has detected a problem in 'C:\\XXXX\\CallingACallbackFromADLL.vshost.exe'.\nAdditional Information: A call to PInvoke function 'CallingACallbackFromADLL!CallingACallbackFromADLL.Program::DllFunction' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.\n\nThe program '[9136] CallingACallbackFromADLL.vshost.exe: Managed (v4.0.30319)' has exited with code 1073741855 (0x4000001f).\n</code></pre>\n\n<p>I am not sure what to do next. </p>\n\n<p>My question is: </p>\n\n<ul>\n<li>What is the correct way to call a C++ DLL function that contains a Callback pointer from a C# application. </li>\n</ul>\n"},{"tags":["c#",".net","wmi","sysadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":185,"score":0,"question_id":11508844,"title":"Mount Network Drive with WMI","body":"<p>Trying to write a WMI class function to mount a network drive on any computer (remote or local) using the credentials of the logged in computer. </p>\n\n<p>This is a class for a larger project that I wrote for help desk staff to do first line fixes on remote PC's. The tech types in the the machine name or ip address and the app connects to it and allows to tech to click a couple of buttons and fix some basic items without having to remote(VNC) into the PC. </p>\n\n<p>I've read all over the internet that it is much easier ways than WMI, but due to the remote nature of the app I would rather not use local API calls, nor do I want to worry about uploading script and executing it though a process start. Also other functions are already in WMI so I'd like to keep the code base the same. </p>\n\n<p>The basic idea is to mount <code>H:</code> to <code>//fileserver.example.com/$username</code></p>\n\n<p>NetFixer is already in production use so I'm trying to keep my code nice and neat </p>\n\n<p><img src=\"http://i.stack.imgur.com/2yDn5.png\" alt=\"enter image description here\"></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Management;\n\nnamespace WMIcontrols\n{\n  public class Remote\n  {\n\n   public string target;\n\n   //Some code skipped here for simplicity sake... \n\n   public bool MountNetDrive(string DriveLetter, string MountLocation)\n    {\n      try\n      {\n          //Mount the network drive\n          return true;\n      }\n      catch\n      {\n          //Mount Failed\n          return false;\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":["c#","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13280358,"title":"cast byte array to object array","body":"<p>Why is </p>\n\n<pre><code>object h = new byte();\n</code></pre>\n\n<p>possible and </p>\n\n<pre><code>object[] h = new byte[5];\n</code></pre>\n\n<p>is not?</p>\n\n<p>How to cast a byte Array to an object Array?</p>\n\n<p>Thank You!</p>\n"},{"tags":["c#","asp.net","ms-word"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13276821,"title":"How to insert Page break when creating MS Word document","body":"<p>I trying to create a Word document via C#. I want to be able to insert a page break at a certain point in my code, however I am not sure on how to do this. I am mostly using StringBuilder to create the html.\nThis is being done in Visual studios 2008 with c#. I've looked at some guides but most of them use code like \"Word variable\". So I'm not sure if \"Word\" comes from an extra downloaded library or what not.</p>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro","c#-4.5"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13280292,"title":"Where in Windows 8 app should you code 'privacy policy'?","body":"<p>my app failed certification with reason : <em>\"4.1.1 Your app must have a privacy statement if it is network-capable\n. . .\nYou must provide access to your privacy policy in the Description page of your app, as well as in the app’s settings as displayed in the Windows Settings charm.\"</em></p>\n\n<p>What are they talking about? what description? how do I set info displayed in windows settings?</p>\n\n<p>the app is C#</p>\n"},{"tags":["c#","xna","sprites"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13279452,"title":"I can't make my sprite move","body":"<p>I'm a complete newbie at XNA and I am currently learning from this tutorial: </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/bb203893.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/bb203893.aspx</a></p>\n\n<p>The problem occurs when running the program after completion of step five. I don't think it's a typo as others have pointed out the same problem in the comments.</p>\n\n<p>My sprite is meant to bounce around the screen automatically when my program is run, however is does not move even a pixel from 0,0. </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing Microsoft.Xna.Framework;\nusing Microsoft.Xna.Framework.Audio;\nusing Microsoft.Xna.Framework.Content;\nusing Microsoft.Xna.Framework.GamerServices;\nusing Microsoft.Xna.Framework.Graphics;\nusing Microsoft.Xna.Framework.Input;\nusing Microsoft.Xna.Framework.Media;\n\nnamespace WindowsGame1\n{\n\npublic class Game1 : Microsoft.Xna.Framework.Game\n{\n    GraphicsDeviceManager graphics;\n    SpriteBatch spriteBatch;\n\n    public Game1()\n    {\n        graphics = new GraphicsDeviceManager(this);\n        Content.RootDirectory = \"Content\";\n    }\n\n\n    protected override void Initialize()\n    {\n\n\n        base.Initialize();\n    }\n\n    Texture2D myTexture;\n\n    Vector2 spritePosition = Vector2.Zero;\n\n    Vector2 spriteSpeed = new Vector2(50.0f, 50.0f);\n\n    protected override void LoadContent()\n    {\n\n        spriteBatch = new SpriteBatch(GraphicsDevice);\n        myTexture = Content.Load&lt;Texture2D&gt;(\"Main\");\n\n    }\n\n\n    protected override void UnloadContent()\n    {\n\n    }\n\n\n     void UpdateSprite(GameTime gameTime)\n    {\n        //Move the sprite by speed, scaled by elapsed time\n\n         spritePosition +=\n            spriteSpeed * (float)gameTime.ElapsedGameTime.TotalSeconds;\n\n        int MaxX =\n            graphics.GraphicsDevice.Viewport.Width - myTexture.Width;\n         int MinX = 0;\n\n         int MaxY =\n             graphics.GraphicsDevice.Viewport.Height - myTexture.Height;\n         int MinY = 0;\n\n         //Check for bounce.\n         if (spritePosition.X &gt; MaxX)\n         {\n             spriteSpeed.X *= -1;\n             spritePosition.X = MaxX;\n\n         }\n\n         else if (spritePosition.X &lt; MinX)\n         {\n             spriteSpeed.X *= -1;\n             spritePosition.X = MinX;\n\n         }\n\n         if (spritePosition.Y &gt; MaxY)\n         {\n             spriteSpeed.Y *= -1;\n             spritePosition.Y = MaxY;\n         }\n\n         else if (spritePosition.Y &lt; MinY)\n         {\n             spriteSpeed.Y *= -1;\n             spritePosition.Y = MinY;\n         }\n\n\n    }\n\n\n    protected override void Draw(GameTime gameTime)\n    {\n        GraphicsDevice.Clear(Color.CornflowerBlue);\n\n\n\n        spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend);\n        spriteBatch.Draw(myTexture, spritePosition, Color.White);\n        spriteBatch.End();\n\n        base.Draw(gameTime);\n    }\n  }\n}\n</code></pre>\n"},{"tags":["c#","image","ocr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2688,"score":0,"question_id":5632522,"title":"c# Bitmap.Save A generic error occurred in GDI+ windows application","body":"<p>I am doing OCR application. I have this error when I run the system which the system will save the picturebox3.image into a folder.</p>\n\n<pre><code>//When user is selecting, RegionSelect = true\n    private bool RegionSelect = false;\n    private int x0, x1, y0, y1;\n    private Bitmap bmpImage;\n\nprivate void loadImageBT_Click(object sender, EventArgs e)\n{\n    try\n    {\n        OpenFileDialog open = new OpenFileDialog();\n        open.InitialDirectory = @\"C:\\Users\\Shen\\Desktop\";\n\n        open.Filter = \"Image Files(*.jpg; *.jpeg)|*.jpg; *.jpeg\";\n\n        if (open.ShowDialog() == DialogResult.OK)\n        {\n            singleFileInfo = new FileInfo(open.FileName);\n            string dirName = System.IO.Path.GetDirectoryName(open.FileName);\n            loadTB.Text = open.FileName;\n            pictureBox1.Image = new Bitmap(open.FileName);\n            bmpImage = new Bitmap(pictureBox1.Image);\n        }\n\n    }\n    catch (Exception)\n    {\n        throw new ApplicationException(\"Failed loading image\");\n    }\n}\n\n//User image selection Start Point\nprivate void pictureBox1_MouseDown(object sender, MouseEventArgs e)\n{\n    RegionSelect = true;\n\n    //Save the start point.\n    x0 = e.X;\n    y0 = e.Y;\n}\n\n//User select image progress\nprivate void pictureBox1_MouseMove(object sender, MouseEventArgs e)\n{\n    //Do nothing it we're not selecting an area.\n    if (!RegionSelect) return;\n\n    //Save the new point.\n    x1 = e.X;\n    y1 = e.Y;\n\n    //Make a Bitmap to display the selection rectangle.\n    Bitmap bm = new Bitmap(bmpImage);\n\n\n    //Draw the rectangle in the image.\n    using (Graphics g = Graphics.FromImage(bm))\n    {\n        g.DrawRectangle(Pens.Red, Math.Min(x0, x1), Math.Min(y0, y1), Math.Abs(x1 - x0), Math.Abs(y1 - y0));\n    }\n\n    //Temporary display the image.\n    pictureBox1.Image = bm;\n}\n\n//Image Selection End Point\nprivate void pictureBox1_MouseUp(object sender, MouseEventArgs e)\n{\n    // Do nothing it we're not selecting an area.\n    if (!RegionSelect) return;\n    RegionSelect = false;\n\n    //Display the original image.\n    pictureBox1.Image = bmpImage;\n\n    // Copy the selected part of the image.\n    int wid = Math.Abs(x0 - x1);\n    int hgt = Math.Abs(y0 - y1);\n    if ((wid &lt; 1) || (hgt &lt; 1)) return;\n\n    Bitmap area = new Bitmap(wid, hgt);\n    using (Graphics g = Graphics.FromImage(area))\n    {\n        Rectangle source_rectangle = new Rectangle(Math.Min(x0, x1), Math.Min(y0, y1), wid, hgt);\n        Rectangle dest_rectangle = new Rectangle(0, 0, wid, hgt);\n        g.DrawImage(bmpImage, dest_rectangle, source_rectangle, GraphicsUnit.Pixel);\n    }\n\n    // Display the result.\n    pictureBox3.Image = area;\n\n\n    ** ERROR occuer here!!!!!**\n    area.Save(@\"C:\\Users\\Shen\\Desktop\\LenzOCR\\TempFolder\\tempPic.jpg\"); // error line occcur\n\n    singleFileInfo = new FileInfo(\"C:\\\\Users\\\\Shen\\\\Desktop\\\\LenzOCR\\\\TempFolder\\\\tempPic.jpg\");\n}\n\n\n       private void ScanBT_Click(object sender, EventArgs e)\n{\n    var folder = @\"C:\\Users\\Shen\\Desktop\\LenzOCR\\LenzOCR\\WindowsFormsApplication1\\ImageFile\";\n\n    DirectoryInfo directoryInfo;\n    FileInfo[] files;\n    directoryInfo = new DirectoryInfo(folder);\n    files = directoryInfo.GetFiles(\"*.jpg\", SearchOption.AllDirectories);\n\n    var processImagesDelegate = new ProcessImagesDelegate(ProcessImages2);\n    processImagesDelegate.BeginInvoke(files, null, null);     \n\n    //BackgroundWorker bw = new BackgroundWorker();\n    //bw.DoWork += new DoWorkEventHandler(backgroundWorker1_DoWork);\n    //bw.RunWorkerAsync(bw);\n    //bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorker1_RunWorkerCompleted);\n}\n\nprivate void ProcessImages2(FileInfo[] files)\n{\n    var comparableImages = new List&lt;ComparableImage&gt;();\n\n    var index = 0x0;\n\n    foreach (var file in files)\n    {\n        if (exit)\n        {\n            return;\n        }\n\n        var comparableImage = new ComparableImage(file);\n        comparableImages.Add(comparableImage);\n        index++;\n    }\n\n    index = 0;\n\n    similarityImagesSorted = new List&lt;SimilarityImages&gt;();\n    var fileImage = new ComparableImage(singleFileInfo);\n\n    for (var i = 0; i &lt; comparableImages.Count; i++)\n    {\n        if (exit)\n            return;\n\n        var destination = comparableImages[i];\n        var similarity = fileImage.CalculateSimilarity(destination);\n        var sim = new SimilarityImages(fileImage, destination, similarity);\n        similarityImagesSorted.Add(sim);\n        index++;\n    }\n\n    similarityImagesSorted.Sort();\n    similarityImagesSorted.Reverse();\n    similarityImages = new BindingList&lt;SimilarityImages&gt;(similarityImagesSorted);\n\n    var buttons =\n        new List&lt;Button&gt;\n            {\n                ScanBT\n            };\n\n    if (similarityImages[0].Similarity &gt; 70)\n    {\n        con = new System.Data.SqlClient.SqlConnection();\n        con.ConnectionString = \"Data Source=SHEN-PC\\\\SQLEXPRESS;Initial Catalog=CharacterImage;Integrated Security=True\";\n        con.Open();\n\n        String getFile = \"SELECT ImageName, Character FROM CharacterImage WHERE ImageName='\" + similarityImages[0].Destination.ToString() + \"'\";\n        SqlCommand cmd2 = new SqlCommand(getFile, con);\n        SqlDataReader rd2 = cmd2.ExecuteReader();\n\n        while (rd2.Read())\n        {\n            for (int i = 0; i &lt; 1; i++)\n            {\n                string getText = rd2[\"Character\"].ToString();\n                Action showText = () =&gt; ocrTB.AppendText(getText);\n                ocrTB.Invoke(showText);\n            }\n        }\n        con.Close();\n    }\n    else\n    {\n        MessageBox.Show(\"No character found!\", \"Error!\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n    }\n\n}\n#endregion\n</code></pre>\n"},{"tags":["c#",".net","windows","windows-8","winrt"],"answer_count":5,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":2477,"score":12,"question_id":7426492,"title":"Can old native applications run on Windows8 tablet version?","body":"<p><img src=\"http://i.stack.imgur.com/5TCIt.png\" alt=\"enter image description here\"></p>\n\n<p>I don't understand this picture well.\nIn the Metro style Apps, what does C/C++ mean? Native C/C++? or is it managed C++? They(Metro style apps) don't even have Win32 layer!</p>\n\n<p>To make an application which compatible with both Metro style and Desktop, should we only use .NET code? The old native applications can run on Windows8 Tablet?</p>\n"},{"tags":["c#","asp.net-mvc-3","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13280273,"title":"Forms authentication in asp.net mvc 3 - ActionResult Register method - how to?","body":"<p>can you please help me. I have written logon and logout methods correctly using forms authentication in asp.net mvc 3.</p>\n\n<pre><code>[HttpPost]\n        public ActionResult LogOn(Guest guest, String returnURL, bool RememberMe = false)\n        {\n            var isValidURL = bl.IsValidReturnUrl(returnURL);\n\n            if (!ModelState.IsValid)\n            {\n                ModelState.AddModelError(\"\", \"The username or password provider is incorrect\");\n                return View(guest);\n            }\n\n            if (bl.IsUserValidated(guest.Username, guest.Password))\n            {\n                FormsAuthentication.SetAuthCookie(guest.Username, RememberMe);\n                if (isValidURL)\n                    return Redirect(returnURL);\n                else\n                    return RedirectToAction(\"Home\", \"Index\");\n            }\n            return View(guest);\n        }\n</code></pre>\n\n<p>How to write a <strong>Register</strong> controller method, I don't know where to start, I have my own database in which I should insert new registered users with their username, password and email. Thanks</p>\n"},{"tags":["c#","asp.net",".net","c#-4.0","iis-7.5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13280347,"title":"FormsAuthentication.RedirectToLoginPage Not Working When Application at Root of Site","body":"<p>The application (ASP.Net 4 / C#) I've been developing uses FormsAuthentication.RedirectToLoginPage() to send the user back to the login page after he/she has clicked on a Logout button. </p>\n\n<p>I'm finding that when the application is deployed at the root of a IIS Site, the redirect does not work. Clicking on the logout button simply reloads the page.</p>\n\n<p>When the application is deployed to an Application virtual folder within the site, the redirect works property.</p>\n\n<p>I've also tried using Respond.Redirect(), which also does not work. I've tried recreating the site from scratch (no luck). </p>\n\n<p>The code for the logout button:</p>\n\n<pre><code>    protected void lbLogout_Click(object sender, EventArgs e)\n    {\n        FormsAuthentication.SignOut();\n        Session.Abandon();\n\n        // clear authentication cookie\n        HttpCookie cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, \"\");\n        cookie1.Expires = DateTime.Now.AddYears(-1);\n        cookie1.Path = FormsAuthentication.FormsCookiePath;\n        cookie1.HttpOnly = true;\n        Response.Cookies.Add(cookie1);\n\n        // clear session cookie \n        HttpCookie cookie2 = new HttpCookie(\"ASP.NET_SessionId\", \"\");\n        cookie2.Expires = DateTime.Now.AddYears(-1);\n        Response.Cookies.Add(cookie2);\n\n        FormsAuthentication.RedirectToLoginPage();\n        //Response.Redirect(\"~/login.aspx\");\n        Response.End();\n    }\n</code></pre>\n\n<p>Thanks for the help!</p>\n"},{"tags":["c#","forms","datagridview","resize"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":10588,"score":4,"question_id":1607790,"title":"C# Auto Resize Form to DataGridView's size","body":"<p>I have a Form and a DataGridView. I populate the DataGridView at runtime, so I want to know how do I resize the Form dynamically according to the size of the DataGridView? Is there any sort of property or method? Or do I have to determine the size myself and update accordingly?</p>\n"},{"tags":["c#","generics","generic-programming"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":40,"score":6,"question_id":13280294,"title":"Retrieving the unclosed type of a generic type closing a generic type","body":"<p>I’m having an issue (probably due to my lack of familiarity of C# generics) in getting the unclosed type of a generic. I have several methods that look rather similar to the following except for the explicit validator interface in use. </p>\n\n<pre><code>public IEnumerable&lt;IDeleteValidator&lt;T&gt;&gt; GetDeleteValidators&lt;T&gt;()\n{\n    var validatorList = new List&lt;IDeleteValidator&lt;T&gt;&gt;();\n    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))\n    {\n        var validatorType = typeof(IDeleteValidator&lt;&gt;).MakeGenericType(type);\n        var validators = ObjectFactory\n            .GetAllInstances(validatorType).Cast&lt;IDeleteValidator&lt;T&gt;&gt;();\n        validatorList.AddRange(validators);\n    }\n    return validatorList;\n}\n</code></pre>\n\n<p>The method GetRecursiveBaseTypesAndInterfaces does as it says and gathers all base types and interfaces of a given type. So what I'm eventually doing is getting the unclosed type of the explicit validator interface and getting it's type as closed on each of the original type T's base classes and interfaces. This works great, however I'd like to clean up my code and accomplish this in a more generic form than above</p>\n\n<p>knowing that any validator of T will extend IValidator (as bellow)</p>\n\n<pre><code>public interface IDeleteValidator&lt;in T&gt; : IValidator&lt;T&gt; {}\n</code></pre>\n\n<p>My <strong>uncompleted</strong> attempt at a generic version of the above method looks like:</p>\n\n<pre><code>public IEnumerable&lt;TValidator&gt; GetValidators&lt;T, TValidator&gt;() \n    where TValidator : IValidator&lt;T&gt;\n{\n    var validatorList = new List&lt;TValidator&gt;();\n    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))\n    {\n        var unclosedType = ???\n        var validatorType = typeof(unclosedType).MakeGenericType(type);\n        var validators = ObjectFactory\n            .GetAllInstances(validatorType).Cast&lt;TValidator&gt;();\n        validatorList.AddRange(validators);\n    }\n    return validatorList;\n}\n</code></pre>\n\n<p>How do I define <em>unclosedType</em> (or restructure the method) to do the same work as the original method with a call to</p>\n\n<pre><code>GetValidators&lt;Whatever, IDeleteValidator&lt;Whatever&gt;&gt;();\n</code></pre>\n\n<p>Or would it be possible to refine my method more so as a call like the following would be sufficient?</p>\n\n<pre><code>GetValidators&lt;IDeleteValidator&lt;Whatever&gt;&gt;();\n</code></pre>\n"}]}
{"total":375441,"page":10,"pagesize":100,"questions":[{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13279944,"title":"multiply value in 2 dropdownlists","body":"<p>I have the best part of 2 days trying to figure out how to \"times 2 dropdownlists\" with each other and show it in a label...</p>\n\n<p>like in math when u mutiple 2 numbers..</p>\n\n<p>plzz help me...</p>\n\n<p>all suggestions are welcome</p>\n\n<pre><code>Protected void Button1_Click(object sender, EventArgs e)\n{\n     int amount1 = int.parse(DropDownList1.selectedValue.ToString());\n     int amount2 = int.parse(DropDownList1.selectedValue.ToString());\n\n     Label.Text = amount1 * amount2;\n}\n</code></pre>\n\n<p>i get an error:</p>\n\n<p>Cannot implicitly convert type 'Int' to 'string</p>\n"},{"tags":["c#","selenium","ipv6"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":150,"score":5,"question_id":10735404,"title":"Selenium has an IPv6 issue when using firefoxdriver","body":"<p>I am trying to use Selenium to drive some web tests in Firefox, however when I do this</p>\n\n<pre><code>FirefoxDriver _driver = new FirefoxDriver();\n</code></pre>\n\n<p>I get this  exception</p>\n\n<blockquote>\n  <p>An address incompatible with the requested protocol was used\n  [::1]:7055</p>\n</blockquote>\n\n<p>This appears to be some sort of IPv6 vs IPv4 issue that selenium is not going to fix. however I need to work around it. Disabling IPv6 on my Ethernet makes no difference. what else can I try?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","javascript","video","overlay"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13280277,"title":"Show video overlay from clicking linkButton","body":"<p>I have a page with a gridview.\nOn of the columns is showing an play icon depending on whether there is an video-url in the database. This part is :</p>\n\n<pre><code>&lt;asp:TemplateField HeaderText=\"\" ItemStyle-CssClass=\"video\" &gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:LinkButton ID=\"lbtVideoUrl\" runat=\"server\" OnClientClick=\"javascript:clicker('http://www.youtube.com/watch?v=qySK7GWFEAg')\" &gt;&lt;img class='&lt;%# Eval(\"Class\", \"{0}\")  %&gt;' src='&lt;%# Eval(\"VideoImage\", \"{0}\")  %&gt;' alt=\"Video\" title='&lt;%# Eval(\"ToolTip\", \"{0}\")  %&gt;' /&gt;&lt;/asp:LinkButton&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n</code></pre>\n\n<p>The javascript that should handle this is : </p>\n\n<pre><code>function clicker(theUrl) {\n    var thediv = document.getElementById('displaybox');\n    if (thediv.style.display == \"none\") {\n            thediv.style.display = \"\";\n            thediv.innerHTML = \"&lt;table width='100%' height='100%'&gt;&lt;tr&gt;&lt;td align='center' valign='middle' width='100%' height='100%'&gt;&lt;object width='640' height='360'&gt;&lt;param name='movie' value='\" + theUrl + \"'&gt;&lt;/param&gt;&lt;param name='allowFullScreen' value='true'&gt;&lt;/param&gt;&lt;param name='allowscriptaccess' value='always'&gt;&lt;/param&gt;&lt;embed src='\" + theUrl + \"' type='application/x-shockwave-flash' width='640' height='360' allowscriptaccess='always' allowfullscreen='true'&gt;&lt;/embed&gt;&lt;/object&gt;&lt;br&gt;&lt;br&gt;&lt;a href='#' onclick='return clicker();'&gt;CLOSE WINDOW&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\";\n    } else {\n        thediv.style.display = \"none\";\n        thediv.innerHTML = '';\n    }\n    return false;\n}\n</code></pre>\n\n<p>However, when i click the button i see the gray overlay and the video field, but before anything is shown the overlay is closed again. I must be missing something, but have no clue what....</p>\n\n<p>One more piece of info (don't know if it is relevant) : i had to add the following to the code behind to get it 'working' so far :</p>\n\n<pre><code>protected void gv_SelectedIndexChanged(object sender, EventArgs e)\n{\n}\n</code></pre>\n\n<p>PS next step is getting the url from the database, so i can add different links to different icons.</p>\n"},{"tags":["c#","hash",".net-3.5","md5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13280271,"title":"Chose checksum algorithm for comparing files","body":"<p>I have to sync up few thousands of files on a regular basis while checking for duplicates. Currently I check the file lengths followed by last byte for each file. If there are clashes, I calculate MD5 hash for the next round of comparison. However, hashing is currently becoming a bottleneck on large files. File sizes are diverse and range between 100kb and 4gb. Can I use some other algorithm other than MD5. I just need a reliable and fast algorithm to calculate the checksum and do not even need to use any cryptographic classes.</p>\n"},{"tags":["c#","arrays","sum","average"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13279532,"title":"Finding average of the numbers user's type into an array","body":"<p>Could someone please explain to me why my average keeps coming as 0 when I run my program? I have listed the entire code of my project on here and have literally never used arrays before.  Also, is the name of this array mData? I tried reading in my book to determine what to look for in these items and have come up with nothing.</p>\n\n<pre><code>public partial class frmMain : Form\n{\n\n    private const int mSize = 20;\n    private int[] mData = new int[mSize];\n    private int mIndex = 0;\n\n\n    private static void Main()\n    {\n        frmMain main = new frmMain();\n        Application.Run(main);\n    }\n    private frmMain()\n    {\n        InitializeComponent();\n    }\n\n    private void btnEnter_Click(object sender, EventArgs e)\n    {\n        int num;\n        num = int.Parse(txtInput.Text);\n\n        //store num in the array\n        mData[mIndex] = num;\n        mIndex = mIndex + 1;\n\n        //check for full array\n        if (mIndex == mSize)\n        {\n            //inform user that array is full\n            MessageBox.Show(\"The array is full.\");\n            btnEnter.Enabled = false;\n        }\n    }\n\n    private void btnExit_Click(object sender, EventArgs e)\n    {\n        Close();\n    }\n\n    private void btnDisplay_Click(object sender, EventArgs e)\n    {\n        int n;\n\n        for (n = 0; n &lt; mIndex; n++)\n            listBoxOutput.Items.Add(mData[n]);\n    }\n\n    private void btnAverage_Click(object sender, EventArgs e)\n    {\n\n        int sum = 0;\n        int average = 0;\n\n        if (mIndex == 0)\n        {\n            //inform user that array is empty\n            MessageBox.Show(\"The array is empty.\");\n        }\n\n        //add up the values\n        for (int i = 0; i &lt; mData.Length; i++)\n        {\n            sum += mData[i];\n        }\n\n        //divide by the number of values\n        average = sum / mSize;\n\n        listBoxOutput.Items.Add(\"The average of the array is: \" + average);\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","sharepoint"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13269431,"title":"Is there a way to detect the page layout in an ItemAdded event?","body":"<p>In our SharePoint project, we have a page layout in which the user can set a custom checkbox (\"Show as news\") in edit mode. Now our customer asked if we can have this checkbox set to checked per default.</p>\n\n<p>The checkbox is realised as a <code>&lt;SharePointWebControls:BooleanField&gt;</code> in the layout page, with a corresponding <code>&lt;Field Type=\"Boolean\"&gt;</code> in the sitecolumns definition.</p>\n\n<p>I tried adding a <code>&lt;Default&gt;1&lt;/Default&gt;</code> to the sitecolumn definition, and together with changing the default value for the site column through SiteSettings, this worked and the checkbox appeared as checked by default for new pages. However, we have other layouts which also use that field (same content type) and for which we don't want to have the value checked per default.</p>\n\n<p>So, my idea was to set the field value in an event receiver if a page is created. The receiver is called correctly and the item is available, however I can't seem to find a way to determine the page layout from the item I get through the event properties. I tried accessing the layout directly through the field <code>item[\"PublishingPageLayout\"]</code> and also by getting the page as PublishingPage, then calling <code>publishingPage.Layout.Name</code> but in both cases there is no value available (null) for the layout.</p>\n\n<p>I'd be glad if anyone could suggest an alternative way to find out the layout. Or maybe completely other way to achieve what I want.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13279812,"title":"Sorting a List of Custom Objects","body":"<p>I have a class called Person which contains a property LastName, which reflects a string cooresponding to the Person's last name.</p>\n\n<p>I created a List as follows:</p>\n\n<pre><code>var People = List&lt;Person&gt;\n</code></pre>\n\n<p>What I would like to do is sort the people by their LastName property in alphabetical order.</p>\n\n<p>After looking at some examples, I've tried</p>\n\n<pre><code>People = People.OrderBy(p =&gt; p.LastName);\n</code></pre>\n\n<p>But it does not work.</p>\n"},{"tags":["c#","database","winforms","data-binding"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":849,"score":6,"question_id":5209661,"title":"C# - Should i use databinding?","body":"<p>Im developing applications in C# winforms, and have gone down the path of databinding my grids using a bindingsource. My question is:</p>\n\n<p>Is this the best approach to take? Should i manually populate the cells instead of letting the binding source do it for me? Could it lead to problems further down the track?</p>\n\n<p>If there any any situations where databinding would create issues that would be useful.</p>\n\n<p>One of my colleagues swears black and blue to NOT use databinding. I dont really trust what he says, so any pros/cons would be valuable.</p>\n\n<p>EDIT: In the situation of a multi-user applications connecting to a single database and editable datagrids, how would you solve concurrency issues for updating of data?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","process","shellexecute"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":31,"score":-2,"question_id":13279403,"title":"Launch Shell but not in focus?","body":"<p>I have a simple app that repeatably uses <code>Process.Start</code> to launch one of my console applications. Unfortunately everytime it does this my window loses focus. Since it does this over 100 and takes about an hour to run through my window loses focus more then once per minute.</p>\n\n<p>Is there a way I can launch the process it w/o having the window hidden? but not setting focus to it? Although the app is more like something i would want running in the background i do need to see the console output which is why i require it not to be hidden</p>\n"},{"tags":["c#","do-while"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13279943,"title":"change asp:FileUpload to Visible=\"true\" using a do while statement","body":"<p>I am trying to create a page that has a variable number of FileUpload fields, depending on the number selected from a drop down list by the user.</p>\n\n<p>my .apsx code is as follows;</p>\n\n<pre><code>            &lt;tr&gt;\n\n            &lt;td&gt;Number of photo's to upload&lt;/td&gt;\n            &lt;td&gt;&lt;asp:DropDownList ID=\"DLPhotoCount\" runat=\"server\" OnSelectedIndexChanged=\"OnSelectedIndexChanged_PhotoCount\" AutoPostBack=\"true\"&gt;\n\n                &lt;asp:ListItem Text=\"...\"&gt;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"1\"&gt;&lt;/asp:ListItem&gt;\n                &lt;asp:ListItem Text=\"2\"&gt;&lt;/asp:ListItem&gt;\n\n            &lt;/asp:DropDownList&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n\n            &lt;td&gt;Picture 1:&lt;/td&gt;\n            &lt;td&gt;&lt;asp:FileUpload runat=\"server\" ID=\"Pic1\" Visible=\"false\"/&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n\n       &lt;tr&gt;\n\n            &lt;td&gt;Picture 2:&lt;/td&gt;\n            &lt;td&gt;&lt;asp:FileUpload runat=\"server\" ID=\"Pic2\" Visible=\"false\"/&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n\n            &lt;td&gt;&lt;asp:Button runat=\"server\" ID=\"BtnUploadFiles\" text=\"Upload Files\" OnClick=\"OnClick_BtnUploadFiles\" Visible=\"false\"/&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n</code></pre>\n\n<p>and my C# is;</p>\n\n<pre><code>    protected void OnSelectedIndexChanged_PhotoCount(object sender, EventArgs e)\n{\n    string Pic = \"Pic\";\n    int PicNo = Convert.ToInt32(DLPhotoCount.SelectedItem.Text);\n\n    if (DLPhotoCount.SelectedItem.Text != \"...\")\n    {\n        string StPicNo = Pic + PicNo;\n\n        do\n        {                \n            FileUpload StPicNo.Visible = true;\n            PicNo = PicNo + 1;\n\n        }\n        while (PicNo &lt; Convert.ToInt32(DLPhotoCount.SelectedItem.Text + 1));\n\n        BtnUploadFiles.Visible = true;\n\n    }\n    else\n    {\n        Pic1.Visible = false;\n        Pic2.Visible = false;\n        BtnUploadFiles.Visible = false;\n    }\n}\n</code></pre>\n\n<p>Open to suggestions on any alternatives if this isn't the best way to achieve the required functionality</p>\n"},{"tags":["c#","windows-services"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13279276,"title":"C# Service Intergration","body":"<p>Need to build a service that displays a message and locks the computer out (Just by using a Windows Form) when the Network Cable is unplugged (So they cannot proceed without Network - Its for a school where the students keep unplugging the cables to bypass certain blocks)</p>\n\n<p>Ive seen that you can interactive with the desktop with a service if you allow it to, im just wondering will Windows Forms display even if there is no user logged in?</p>\n\n<p>As this program needs to catch them out when there authenticating in, then unplugging it.</p>\n\n<p>Cheers\nRichard</p>\n"},{"tags":["c#","arrays","addressbook"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13279982,"title":"C# Console Application phonebook arrays","body":"<p>I am told to design a phonebook which will use 2D array to store Name and Phone numbers in type : string .\nIt should have the functions like add, remove, print methods.</p>\n\n<p>I am yet struggling in this array. I do not know how to fill the whole of array members with \"none\" whenever a record for name is not present and \"000\" for its number. </p>\n\n<p>by default, i need it to have this printed:\n(20 records of none 000)\nnone 000\nnone 000\nnone 000\n...\nnone 000\nnone 000\nnone 000</p>\n\n<p>I came up with:</p>\n\n<pre><code>string[,] db = new db[20,2];\n</code></pre>\n\n<p>I am not sure though if its the right, but I just want a 2D array which has 20 rows and 2 columns.</p>\n\n<p>Then I wanna use for or foreach loop to fill the elements by none and 000:</p>\n\n<pre><code>for (int i=0; i&lt;db.Length/2; i++)\n     for (int j=0; j&lt;db.Length/20; j++)\n</code></pre>\n\n<p>Could you help me with filling that?\nThanks</p>\n"},{"tags":["c#",".net","c#-4.0","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13279613,"title":"I couldnt use the library that I have already imported as references in my project","body":"<p>I am writing a program for computer vision in c# that part of project SIFT is needed; I downloaded the MEMO library for SIFT :  </p>\n\n<p><a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/</a></p>\n\n<p>In my project I added the two libraries <strong>*<em>libsift.dll &amp; ICSharpCode.SharpZipLib.dll</strong> *</em> as references in to my projects.</p>\n\n<p><img src=\"http://i.stack.imgur.com/86hzx.png\" alt=\"enter image description here\"></p>\n\n<p>Now that I want to mention libsift on top of the code \" USING libsift\" it doesnt recognize it;   </p>\n\n<p><img src=\"http://i.stack.imgur.com/2A24Y.png\" alt=\"enter image description here\"></p>\n\n<p>even more if I wanna make a instance of such class atuo detect doesn't recognize it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Spmts.png\" alt=\"enter image description here\"></p>\n\n<p>It is weird because I could see the functions of this library in object browser.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/kfmuX.png\" alt=\"enter image description here\">  </p>\n\n<p>I couldnt use the library that I have already imported as references in my project although I could see the functions in object browser? What could be the problem? </p>\n\n<p>(I have c# .Net VS2010 in windows.)</p>\n"},{"tags":["c#","roslyn"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13280008,"title":"How do I compile a C# solution with Roslyn?","body":"<p>I have a piece of software that generates code for a C# project based on user actions.  I would like to create a GUI to automatically compile the solution so I don't have to load up Visual Studio just to trigger a recompile.</p>\n\n<p>I've been looking for a chance to play with Roslyn a bit and decided to try and use Roslyn instead of msbuild to do this.  Unfortunately, I can't seem to find any good resources on using Roslyn in this fashion.</p>\n\n<p>Can anyone point me in the right direction?</p>\n"},{"tags":["c#","wcf","rest","iis7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13174246,"title":"how to restrict access to WCF restful function to specific IP range?","body":"<p>I've built a Restful WCF service with few simple functions. a new requirememt has been raised. </p>\n\n<p>one of the functions should be accessible only to a specific ip range.</p>\n\n<p>what is the best way to implement this? I thought that an easy way is to simply configure the IIS with a rule that will block ip range according the request pattern - cant find such option.. </p>\n\n<p>Thanks!\nofer</p>\n"},{"tags":["c#","naudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13279984,"title":"Intercepting Skype, replacing voice with line-in and currently played audio file","body":"<p>How do you change <a href=\"http://channel9.msdn.com/coding4fun/articles/Skype-Voice-Changer\" rel=\"nofollow\">http://channel9.msdn.com/coding4fun/articles/Skype-Voice-Changer</a> to instead of it using EffectsChannel as the input channel use line-in mixed with the currently played audio file using the WaveOut() device?</p>\n\n<p>So I am playing an audio file with </p>\n\n<pre><code>WaveOut Klangwiedergabegerät = new WaveOut();\n\n//....\n\nvoid abspielen(string Dateiname, float ZielAmplitude)\n{\n    Klangwiedergabegerät.DeviceNumber = cbAusgabegeräte.SelectedIndex;\n    ISampleProvider StückchenHalter = CreateInputStreamS(Dateiname,ZielAmplitude);\n    Klangwiedergabegerät.Init(new SampleToWaveProvider(StückchenHalter));\n    Klangwiedergabegerät.Play();\n}\n\nprivate ISampleProvider CreateInputStreamS(string Dateiname, float Lautstärke)\n{\n    if (Dateiname.EndsWith(\".mp3\"))\n    {\n        mp3Reader = new Mp3FileReader(Dateiname);\n        pcmStream = WaveFormatConversionStream.CreatePcmStream(mp3Reader);\n        waveChannel = new SampleChannel(pcmStream, true);\n    }\n    else if (Dateiname.EndsWith(\".wav\"))\n    {\n        pcmStream = new WaveFileReader(Dateiname);\n        waveChannel = new SampleChannel(pcmStream, true);\n    }\n    else\n    {\n        throw new InvalidOperationException(\"Unsupported extension\");\n    }\n    waveChannel.Volume = Lautstärke;\n    postVolumeMeter = new MeteringSampleProvider(waveChannel);\n    postVolumeMeter.StreamVolume += OnPostVolumeMeter;\n    return postVolumeMeter;\n}\n</code></pre>\n"},{"tags":["c#",".net","infragistics","tablelayout","noise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13279895,"title":"Noise box, when a table layout is scrolling, without 'AutoScroll' property enabled","body":"<p>I have a big problem, when I doing a scrolling without 'Autoscrool' property enabled on a table layout, I get a noise box, seems that the layout continue scrolling (see attached image). I have tried update/refresh/invalidate... its container layouts, but I could not get success for my problem.</p>\n\n<p>Other weird behavior that I have is, once have the noise box on the screen, and launched any dialog, the full layout is fixed.</p>\n\n<p>Has anyone had a similar problem before?</p>\n\n<p>see below the code that I'm using to scrool the table layout:</p>\n\n<pre><code>    private void panelSelectorTrackBar_ValueChanged(object sender, EventArgs e)\n    {\n        galleryTableLayoutPanel.Top = panelSelectorTrackBar.Value;\n        dashboardPanelDetails.Hide();\n    }\n</code></pre>\n\n<p>On where <strong>galleryTableLayoutPanel</strong> is a <em>TableLayout</em> instance, <em>panelSelectorTrackBar</em> is an <em>UltraTrackBar</em> instance.</p>\n\n<p><img src=\"http://i.stack.imgur.com/831Yb.png\" alt=\"Noise Box\"></p>\n"},{"tags":["c#","wpf","pixelsense"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13279322,"title":"Finding a dynamically added ScatterViewItem","body":"<p>I have the following: </p>\n\n<pre><code>Window window = Application.Current.Windows.Cast&lt;Window&gt;().SingleOrDefault(x =&gt; x.IsActive);\nScatterView main = UIHelper.FindChild&lt;ScatterView&gt;(window, \"MainScatterView\");\n        main.Items.Add(type);\n\n//Neither of these work\nScatterViewItem parent = (ScatterViewItem)main.ContainerFromElement(type);\n\nScatterViewItem parent = UIHelper.FindVisualParent&lt;ScatterViewItem&gt;(type);\n</code></pre>\n\n<p>The documentation says: <em>When you add an object that is not of type ScatterViewItem, the ScatterView control first wraps the object in a ScatterViewItem control before adding it to the collection</em> <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/microsoft.surface.presentation.controls.scatterviewitem.aspx</a></p>\n\n<p>How does one get the scatterviewitem that it has been wrapped in?</p>\n"},{"tags":["c#","performance","asp.net-4.0","code-readability","boolean-operations"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13279096,"title":"how to decide on a bool operators usage, performance issues vs readability","body":"<p>Having even more than two options to choose from, leads me to question, which one to choose, if  the result / outcome is same.</p>\n\n<p>in <code>.NET</code> <code>C#</code>  the following conditions are asking same question using different operators, so the question is , what experienced developers use, i tend to assume that ready made operators like <code>Equals</code> would go through more processing actions.</p>\n\n<p>When and why would you choose <code>!</code> over <code>Equals</code>, and both over 'traditional'  <code>==</code> ?</p>\n\n<pre><code>//bool\nif (!Page.IsPostBack) \n{\n    //bool\n    if (NotAuthorized().Equals(false)) \n    {            \n        AppsCtrls.DDLs_Init();\n\n        //bool\n        if (CurrSeSn.Raised(Flag.MainDataSet_IsPopulated) == false)\n        {\n            initALLDataSet(AllDataStColsSelectionMod.doneViaSP);\n        }\n\n        custid = RConv.Str2int(Request.QueryString[\"custid\"]);\n        username = GetTableData.AsString(\"name\", \"tblCustomers\", \"custid\", custid);\n    }\n}\n</code></pre>\n"},{"tags":["c#","locale","gettext"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":9527480,"title":"gettext(i18n) in process running as root/system process","body":"<p>It's not possible to setlocale of a process running as root, how can I use gettext to obtain localized strings (the locale is not auto detected, nor can I force it to a particular value using setlocale) in such a process. Is there any workaround?</p>\n\n<p>Edit -> Adding the code, I used for testing the issue. I force changed the environment variables - LC_ALL, LANGUAGE, LANG to fr_FR.UTF8. I set the locale to fr_FR.UTF8 explicitly too. All the putenv calls returned 0 and the setlocale call returned \"C\".</p>\n\n<pre><code> int err = putenv(\"LC_ALL=fr_FR.UTF8\");\n err = putenv(\"LANG=fr_FR.UTF8\");\n err = putenv(\"LANGUAGE=fr_FR.UTF8\");\n char *loc = setlocale(LC_ALL, \"fr_FR.UTF8\");\n bindtextdomain(\"default\", \"locale\");\n textdomain(\"default\");\n char *text = gettext(\"hello\");\n</code></pre>\n\n<p>The same code snippet works if I try it in a user process. The exe of both the processes are in same directory, which contains directory locale\\fr\\LC_MESSAGES\\default.mo</p>\n\n<p>Can we change the locale of a process which is running as system process and not user?</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":28,"score":-6,"question_id":13279844,"title":"How to do group by and join table in linq?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13279499/how-to-join-and-group-by-with-linq\">How to join and group by with linq?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to join table and  and group by in linq.\nSo I write </p>\n\n<pre><code>   var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                          group opv by opv.OrderId into g\n                          select new\n                          {\n                              TotalAmount = g.Sum(x =&gt; x.PriceExclTax),\n                               table2Val = gr\n\n                          };   \n\n\n            var result = query1.ToList().Select(x =&gt;\n            {\n                return new HireItemReportLine()\n                {\n                    Fname = x.table2Val.first_name,\n                  MName = x.table2Val.middle_name,\n                  LName = x.table2Val.last_name,\n                };\n            }).ToList();\n</code></pre>\n\n<p>I want to select the <code>gr</code> table data, <code>opv</code> table data and <code>o</code> table data.</p>\n\n<p>But there is error and it says</p>\n\n<pre><code>The name 'gr' does not exist in the current context\n</code></pre>\n\n<p>How to solve it??</p>\n"},{"tags":["c#",".net","asp.net-mvc","dependency-injection","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12320846,"title":"Some questions about webapi ActionFilterAttribtes, FilterProvider, and Dependency Injection","body":"<p>I see that by default, an MVC4 WebApi project has 2 <code>IFilterProviders</code>: The <code>ConfigurationFilterProvider</code>, and the <code>ActionDescriptorFilterProvider</code>. When setting up a custom <code>IFilterProvider</code> to do property depenency injection, is it appropriate to remove both of these from the Filters collection first? Or is it more appropriate to just remove the <code>ActionDescriptorFilterProvider</code>, and leave the <code>ConfigurationFilterProvider</code> in the collection?</p>\n\n<p>Secondly, I see that after a WebApi Http <code>ActionFilterAttribute</code> is constructed for a particular action, it seems to stay around. For example when I put a custom action filter on an ApiController Get method, it is only constructed the first time that method is called. Subsequent calls to the api method seem to reuse the same filter (constructor breakpoints are only hit during the first invocation). Is this right? Why is it different than an MVC actionfilter, where a new instance is created for each method invocation?</p>\n"},{"tags":["c#",".net","winforms","krypton-toolkit"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1117,"score":3,"question_id":7916607,"title":"How to deselect the text of a combobox","body":"<p>I have a krypton combo box which I data bind with a list of key-value pairs. What's happening is that when i set the selected item in code, it is highlighting the text. How can i prevent this or deselect the text?</p>\n\n<p>I've tried </p>\n\n<pre><code>// 1\ncombo.Select(0,0);\n// 2\ncombo.Focus();\nanotherControl.Focus();\n// 3\ncombo.SelectionStart = 0;\ncombo.SelectionLength = combo.Text.Length;\n// 4 \ncombo.SelectionStart = combo.Text.Length;\ncombo.SelectionLength = 0;\n</code></pre>\n\n<p>Nothing wants to work.\nAny help appreciated.</p>\n"},{"tags":["c#","asp.net-mvc","dependency-injection","ioc-container","asp.net-web-api"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":868,"score":1,"question_id":10930402,"title":"How to do dependency injection to Action Filter on ASP.NET Web API","body":"<p>I really get stuck on the approach to do dependency injection into action filter of web api. I  have an action filter like this:</p>\n\n<pre><code>public class AuthorizationAttribute : ActionFilterAttribute\n{\n    public IApiKeyRepository Repository { get; set; }\n\n    private Guid GetApiKey(string customerKey)\n    {\n        return Repository.GetApiKey(customerKey);\n    }\n\n    public override void OnActionExecuting(HttpActionContext actionContext)\n    {        \n    }\n}\n</code></pre>\n\n<p>I would like to do property injection on the property Repository by using Windsor (but it does not matter which IoC container is used)</p>\n\n<p>I did come up to customize FilterProvider but it did not work out for me, does anyone have solution or running code on this? it will be much appreciated</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13279489,"title":"Copy/Clone Stream in a loop...","body":"<p>I am fundamentally doing something wrong here within this loop. The first time through the loop, the Stream works fine, but subsequent times through the loop fail with the Stream being corrupted. I know am probably doing something silly. I tried to set the updateTemplate to 0 each time but the InputStream doesn't support the seek. I am basically appending multiple forms that are filled in onto a List here. Any suggestions would be appreciated, especially ones that would result in better performance.</p>\n\n<pre><code>...\nfiles.Add(PDFhelper.fillTemplate(template, mappings));\n\nforeach (Update u in myObject.Updates)\n{\n    mappings = this.GenerateFieldMappings(u);\n    Stream output = new MemoryStream();\n    template.CopyTo(output);\n    files.Add(PDFhelper.fillTemplate(output, mappings)); //First time stream is good  \n\n}\n\nreturn PDFhelper.MergeFiles(files);\n\n...\n</code></pre>\n"},{"tags":["c#","wpf","performance","master-detail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":13279655,"title":"How to make my WPF application as FAST as Outlook","body":"<p>The commons WPF applications take some time for loading medium complex views, once the view is loaded it works fine. For example in a Master - Detail view, if the Detail view is very complex and use different DataTemplates take some seconds (2-3 seconds) for load the view.</p>\n\n<p>When i open the Outlook application, for instance, it renders complex views and it is relative much more fast.</p>\n\n<p>Is there a way for increase the performance of my WPF application? Maybe a way for not loading the template's data every time that change the \"master\" item, and load it only one time in the app time live?</p>\n\n<p>i will appreciate any suggestion. </p>\n"},{"tags":["c#","wpf","usercontrols"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13161987,"title":"Why is the Dependency Property not returning its value?","body":"<p>I have a MyUserControl with the following Xaml:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding InputValueProperty}\" /&gt;\n</code></pre>\n\n<p>In the MyUserControl.xaml.cs I have:</p>\n\n<pre><code>public string InputValue\n{\n    get { return (string)GetValue(InputValueProperty); }\n    set { SetValue(InputValueProperty, value); }\n}\npublic static readonly DependencyProperty InputValueProperty = \n    DependencyProperty.Register(\"InputValueProperty\", typeof(string), \n    typeof(MyUserControl));\n</code></pre>\n\n<p>In my MainWindow.xaml I create a user control:</p>\n\n<pre><code>&lt;local:MyUserControl InputValue=\"My Input\" /&gt;\n</code></pre>\n\n<p>Later on in my MainWindow.xaml.cs I am trying to access this string.  All instances of MyUserControl are contained in a List and I access them with a foreach.</p>\n\n<pre><code>string temp = userControl.InputValue;\n</code></pre>\n\n<p>This is always null.  In my MainWindow.xaml I can see the \"My Input\" in the text box of the user control but I can't ever seem to get it out of there. </p>\n"},{"tags":["c#","linq","entity-framework-4","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13274597,"title":"Entity Framework 5 upgrade from 4","body":"<p>I'm having an issue with the Where clause in a search, in my original version EF4 I could add a Where clause with  2 parameters, the where clause (string predicate) and a ObjectParameter list such as</p>\n\n<pre><code>var query = context.entities.Where(WhereClause.ToString(), Params.ToArray());\n</code></pre>\n\n<p>since my upgrade to EF5 I don't seem to have that option am I missing something?</p>\n\n<p>This was originally used to build dynamic where clause such as \"it.entity_id = @entity_id\" then holding the variable value in the ObjectParameter.</p>\n\n<p>I'm hoping I don't have to rewrite all the searches that have been built out this way, so any assistance would be greatly appreciated.</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","winforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13279380,"title":"Prevent form loading until user input","body":"<p>So, management has decided to implement an idea to allow the user to choose the language for the program.  And the way they want it is, in my opinion, silly.  But, I can't change their mind.  Here's how it works.  The main form(<code>frmMain</code>) will start to load.  Before the <code>InitializeComponent()</code>, they want another form(<code>frmLanguage</code>) to load asking the user to select a language.  Now, I can get frmLanguage to pop up at the proper time.  My problem is, how do I prevent or pause frmMain from continuing to load once I've got frmLanguage displayed?</p>\n\n<pre><code>public FrmMain()\n{\n    var language = new FrmLanguage();\n    language.Show();\n\n    // I need to pause the FrmMain right here\n\n    InitializeComponent();\n}\n</code></pre>\n\n<p>I was thinking that threading might be the way to do this, but I've got zero experience with it, so I'm unsure that's even a correct line of thinking.  I don't want to do a <code>Sleep()</code> or similar, cause who knows how long the user will take to enter their choice.  Also, this will be a one-off popup.  I'll be changing a line in a pre-existing INI file so that this won't pop up if they've already selected a language.  Thanks for any and all help.</p>\n"},{"tags":["c#","winforms","chartfx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13035381,"title":"How to put ellipsis at the axis of chartfx graph?","body":"<p>I'm working on ChartFX for windows forms, have a problem. My application must works on screens that have an small size (i.e. 1440x900), I need to display several charts on the same screen (I cannot change it). So, when it happens the axis labels of my charts (charts of the ChartFX) looks cutted.</p>\n\n<p>Somebody does know how a can add ellipsis instead cut labels for the axis labels using chartFX ?</p>\n"},{"tags":["c#",".net","arrays"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":122,"score":8,"question_id":10465099,"title":"Create an array populated with a range of values x through y","body":"<p>Let's say I have integer variables x and y, and I want an array populated with values x through y.  Is there a nice way to do this inline, using C#?</p>\n\n<p>I know I can achieve this using an extension method:</p>\n\n<pre><code>public static int[] ExpandToArray(this int x, int y)\n{\n    var arr = int[y - x + 1];\n    for (int i = x; i &lt;= y; i++) \n    {\n        arr[i-x] = i;\n    }\n    return arr;\n}\n</code></pre>\n\n<p>And then use it to write:</p>\n\n<pre><code>x.ExpandToArray(y);\n</code></pre>\n\n<p>Is there a built-in way (without creating an extension method) in .NET to write something like <code>x.ExpandToArray(y)</code>?</p>\n"},{"tags":["c#","wpf","richtextbox"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":84,"score":4,"question_id":13116278,"title":"How can I type half-space in RichTextBox?","body":"<p>When I press \"Shift + Space\" to type half-space (when I 'm writing in Persian) in a RichTextBox, it just inserts space. It types all other Persian characters correctly, but when it comes to \"Shift+Space\", it types just space.</p>\n\n<p>The name of this character is \"ZERO WIDTH NON-JOINER\" and the information is given in this link: <a href=\"http://www.fileformat.info/info/unicode/char/200c/index.htm\" rel=\"nofollow\">http://www.fileformat.info/info/unicode/char/200c/index.htm</a>.</p>\n\n<p>I should mention that I fixed the problem by handling previewKewDown event; but I like to know what is the problem with this key combination in a RichTextBox.</p>\n\n<p>thanks.</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13279499,"title":"How to join and group by with linq?","body":"<p>I want to join tables and want to group by <code>orderID</code> select two tabel data.</p>\n\n<p>So I wrote this query.  </p>\n\n<pre><code> var query1 = from opv in _opvRepository.Table\n                     join o in _orderRepository.Table on opv.OrderId equals o.Id\n                     join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                     join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                     join p in _productRepository.Table on pv.ProductId equals p.Id\n                     where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                     (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                     (!p.Deleted) &amp;&amp;\n                     (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)      \n                     group opv by opv.OrderId into g\n                     select new\n                     {\n                         table1Val = opv,\n                         table2Val = gr,\n                         table3Val = 0\n                     };\n\n\n\n        var result = query1.ToList().Select(x =&gt;\n        {\n            return new HireItemReportLine()\n            {\n                OrderId = x.table1Val.OrderId,                   \n\n              Fname=x.table2Val.first_name,\n\n            };\n        }).ToList();\n</code></pre>\n\n<p>But there is error and it says</p>\n\n<pre><code>The name 'opv' does not exist in the current context\nThe name 'gr' does not exist in the current context\n</code></pre>\n\n<p>How can I do it?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13279297,"title":"Alternatives to DisplayName DataAnnotation when displaying run-time data in MVC3 model","body":"<p>I have a requirement to display a label whose text is determined at run-time.</p>\n\n<p>Previously, when the text was known at compile-time, I was able to use the DisplayName DataAnnotation to craft how my model represented its data.</p>\n\n<p>As an example, I used to have this:</p>\n\n<pre><code>[DisplayName(\"Task Template\")]\npublic List&lt;KeyValuePair&lt;int, string&gt;&gt; TaskTemplate { get; set; }\n\n&lt;%= Html.LabelFor(model =&gt; model.TaskTemplate) %&gt;\n&lt;%= Html.DropDownListFor(model =&gt; model.TaskTemplateFlag, new SelectList(Model.TaskTemplate, \"Key\", \"Value\"))%&gt;\n</code></pre>\n\n<p>but now the DisplayName needs to be determined at run-time.</p>\n\n<p>According to <a href=\"http://stackoverflow.com/questions/9434918/displayattribute-name-with-a-variable-dynamic-displayname\">this StackOverflow answer</a> there is no way to do this using a DataAnnotation.</p>\n\n<p>I'm left wondering what best practice is? Do I stop using LabelFor altogether? Should I just store a bunch of string properties in my model, load my values into the properties, and render using DisplayFor?</p>\n\n<p><strong>Update:</strong> I think that this is probably a good enough solution:</p>\n\n<pre><code>public string TaskTemplateLabel { get; set; }\npublic List&lt;KeyValuePair&lt;int, string&gt;&gt; TaskTemplate { get; set; }\n\n//Constructor: TaskTemplateLabel = GetLabelFromDataSource();\n\n&lt;%= Html.LabelFor(model =&gt; model.CurrentDeviceName, Model.TaskTemplateLabel)%&gt;\n</code></pre>\n"},{"tags":["c#","com","memory-leaks"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13279539,"title":"C# interface to COM leaks memory... strangely","body":"<p>I have a C# program that accesses a COM Interface to a piece of simulation software called Aspen Plus.  I have a very strange memory leak.</p>\n\n<p>When I need to get the result values out of the simulation, I run a series of calls like this, in some cases the variable returned might be null, so I insert a check for that.  Then I use FinalReleaseComObject to clean up the COM references.</p>\n\n<pre><code>   public override ValueType recvValueFromSim&lt;ValueType&gt;(string path) {\n       Happ.IHNode tree = this.Aspen.Tree;\n       dynamic node = tree.FindNode(path);\n       ValueType retVal = default(ValueType);\n       if (node != null &amp;&amp; node.Value != null) {\n           retVal = node.Value;\n       }\n       Marshal.FinalReleaseComObject(node);\n       Marshal.FinalReleaseComObject(tree);\n       node = null;\n       return retVal;\n   }\n</code></pre>\n\n<p>Unfortunately, the above code leaks a lot.  It leaks 2MB per simulation.  At first I thought the Garbage Collector would eventually run and clean it up, but no dice.  After running a couple of hundred simulations, I ran out of memory.</p>\n\n<p>The bizarre thing is, the below code works fine and doesn't leak. I didn't like it, because using catch to check for null references seems like bad form, but this doesn't leak.</p>\n\n<pre><code>   public override ValueType recvValueFromSim&lt;ValueType&gt;(string path) {\n      ValueType node;\n      try {\n         node = this.Aspen.Tree.FindNode(path).Value;\n         return node;\n      } catch {\n         return default(ValueType);\n      }\n   }\n</code></pre>\n\n<p>Why doesn't it leak?  Does anybody know?  The belies why I thought I knew about temporary references and releasing COM objects.</p>\n"},{"tags":["c#",".net","impersonation","dcom"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13278831,"title":"How to impersonate another user for a DCOM connection in C#?","body":"<p>I am trying to connect to a DCOM object on a remote machine which is logged in as a different user from a C# application. I have gotten my code working to connect to the same DCOM object while it is running on the same computer, like so:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\");\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>MyDCOMType is a type implemented in the DCOM application (a VB6 app) that I added as a reference in my project. I have been able to create an instance of it in the C# code and call all of the methods with the expected results. Now I am trying to get it to connect to the same object on the remote machine. I am attempting to impersonate the user on the remote system like so (variable definitions and error handling omitted):</p>\n\n<pre><code>if (LogonUser(\n       userName,\n       domain,\n       password,\n       LOGON32_LOGON_NEW_CREDENTIALS,\n       LOGON32_PROVIDER_WINNT50,\n       out token) != false)\n{\n      if (DuplicateToken(token, (int)_SECURITY_IMPERSONATION_LEVEL.SecurityDelegation, out tokenDuplicate) != false)\n      {\n            impersonationContext = WindowsIdentity.Impersonate(tokenDuplicate.DangerousGetHandle());\n      }\n }\n</code></pre>\n\n<p>Which is then followed by similar code to create the object:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\", ipAddress);\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>Except that the CreateInstance call throws an UnauthorizedAccessException error with error code 80070005 for unauthorized access.</p>\n\n<p>The other thing is that I have C++ code that does the same thing that works perfectly. That code goes like so:</p>\n\n<pre><code>COAUTHINFO      AuthInfo;\nCOAUTHIDENTITY  AuthIdentity;\nCOSERVERINFO    ServerInfo;\nMULTI_QI        Results;\nHRESULT     hr;\nBSTR        version;\n_MyDCOMType     *pSession = NULL;\n\nAuthIdentity.Domain             = (unsigned short *) w_domain;\nAuthIdentity.DomainLength       = wcslen( w_domain);\nAuthIdentity.Flags              = SEC_WINNT_AUTH_IDENTITY_UNICODE;\nAuthIdentity.Password           = (unsigned short *) w_password;\nAuthIdentity.PasswordLength     = wcslen(w_password);\nAuthIdentity.User               = (unsigned short *) w_username;\nAuthIdentity.UserLength         = wcslen(w_username);\n\nAuthInfo.dwAuthnLevel           = RPC_C_AUTHN_LEVEL_CALL;\nAuthInfo.dwAuthnSvc             = RPC_C_AUTHN_WINNT;\nAuthInfo.dwAuthzSvc             = RPC_C_AUTHZ_NONE;\nAuthInfo.dwCapabilities         = EOAC_NONE;\nAuthInfo.dwImpersonationLevel   = RPC_C_IMP_LEVEL_IMPERSONATE;\nAuthInfo.pAuthIdentityData      = &amp;AuthIdentity;\nAuthInfo.pwszServerPrincName    = NULL;\n\nServerInfo.dwReserved1  = 0;\nServerInfo.dwReserved2  = 0;\nServerInfo.pAuthInfo    = &amp;AuthInfo;\nServerInfo.pwszName     = w_nodename;\n\nhr = CoCreateInstanceEx(clsid, NULL, CLSCTX_ALL, &amp;ServerInfo, (ULONG) 1, &amp;Results);\nhr = CoSetProxyBlanket(Results.pItf, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL,\n    RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE, &amp;AuthIdentity, EOAC_NONE);\npSession = (_MyDCOMType *)Results.pItf;\n\nhr = pSession-&gt;raw_GetVersion(&amp;version);\n</code></pre>\n\n<p>It connects to the remote server, creates the DCOM object, and gets data from it just fine. I'd like to figure out how to get my C# code to do the same. Any ideas? Did I mess up one of the enums going to the functions? Am I missing some critical call or doing something all wrong? As background, my computer and the computer I am trying to connect to are both logged in under domain accounts, but neither has permissions on the other. The C++ code impersonates the remote user for the purpose of the DCOM connection. I am trying to do a .NET impersonation in such a way that it will be valid for the network connection given a manually entered username and password.</p>\n\n<p>Alternatively, if it just isn't possible, I suppose I could write a small C++/CLR DLL with the same C++ code to handle the DCOM connection part and reference it from the C# code, but I'm hoping to avoid the extra complexity.</p>\n"},{"tags":["c#",".net","mef"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13078821,"title":"MEF Composition ImportMany yield two versions of same class","body":"<p>I haven't been able to find an answer for my problem. I'm using MEF to find and create my classes that implement IPlugIn, but I end up with two versions of each PlugIn class. I have determined that the AggregateCatalog only contains one Assembly that contains only 1 type of each class as a Part, but I am still getting two instances of each as the end result. I'm probably just doing something stupid, but I haven't found it yet. I'd appreciate any help...</p>\n\n<pre>\n\n...\n\n    [ImportMany(typeof(IPlugIn))]\n     public System.Lazy>[] Plugins { get; set; }\n\n...\n    //aggregatecatalog only contains one dll containing plugin classes, 4 of them\n    container = new CompositionContainer(aggregateCatalog,\n                                         CompositionOptions.DisableSilentRejection \n                                         | CompositionOptions.IsThreadSafe);\\\n\n    container.SatisfyImportsOnce(this);\n\n    ...\n    public void StartAll()\n    {\n    //We have 8 PlugIns here?? How? \n    if (Plugins == null || Plugins.Count() == 0)\n    {\n\n       log.Warn(\"No PlugIns Available to Start!\");\n       return;\n    }\n\n        foreach (var plug in Plugins)\n        {\n            log.Info(\"Starting PlugIn: \" + plug.Value.GetName());\n            plug.Value.Start();\n        }\n    }\n\n   ...\n\n    [Export(typeof(IPlugIn))]\n    public class MyPlugIn : BasePlugIn, IPlugIn\n\n    ...\n\n</pre>\n\n<p>I'm debugging in Visual Studio. I clearly see only one Assembly loading. The CompositionContainer has only 1 of each. After SatisfyImportOnce in StartAll(), I have two instances of each IPlugIn classes. Is this something with the way I am using ImportMany? I am open to any ideas. </p>\n"},{"tags":["c#",".net","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":8444503,"title":"Scale-invariant feature transform C#","body":"<p>Do you know if there is any implementation of Scale-invariant feature transform available in C# .NET? </p>\n\n<p>There is one available in <a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">MONO</a>, but Im having many problems trying to run it.</p>\n"},{"tags":["c#","wpf","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13275949,"title":"update dataGrid back to ef from anonymous type","body":"<p>The following code shows into dataGrid result from two tables</p>\n\n<p>But I understand that I can not update the data back into the DB (since it shows anonymous type)</p>\n\n<pre><code>public class NameAndDone\n{\n    public string document_Name { get; set; }\n    public bool ? document_Done { get; set; }\n}\n\n\n       vagEntities projectE = new vagEntities();\n       var doc = from c in projectE.Person_Documents\n                  join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n                  where c.Person_Id == selc   \n                  select new NameAndDone { document_Name = cw.Document_Name,document_Done = c.Document_done};\n\n       carsGrid.ItemsSource = doc;\n</code></pre>\n\n<p>and in the xaml </p>\n\n<pre><code>        &lt;DataGrid Grid.Row=\"1\" RowHeight=\"30\" AutoGenerateColumns=\"False\" Margin=\"15,15,15,96\" x:Name=\"carsGrid\" &gt;\n    &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn  Binding=\"{Binding Path=document_Name}\" MinWidth=\"100\" Header=\"Documents\"  /&gt;\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=document_Done}\" Header=\"Done\" /&gt;\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>My question is: Is it possible to update with the saveChanges () function?\nOr I need to change all the code (hope not)</p>\n\n<p>Thanks in advance to anyone who helps (even if I can not understand)</p>\n\n<p>Please, does anyone have an idea?</p>\n"},{"tags":["c#","asp.net","content-management-system","sitecore","sitecore6"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13279060,"title":"Sitecore item:created vs item:added","body":"<p>What is the difference between the events <code>item:created</code> vs <code>item:added</code>? When does each event get hit?</p>\n"},{"tags":["c#","casting","boxing"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13278911,"title":"Is it possible to box an integer to a custom type object?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5062213/c-sharp-implicit-explicit-type-conversion\">C# Implicit/Explicit Type Conversion</a>  </p>\n</blockquote>\n\n\n\n<p>I have an int that I am attempting to box, so as to use it in a constructor which takes as a parameter object of <code>CustomType</code>.</p>\n\n<p>An example of what I mean.</p>\n\n<pre><code> int x = 5;\n object a = x;\n\n CustomType test = new CustomType(a)\n\n //constructor in question\n public CustomType(CustomType a)\n {\n   //set some variables etc\n }\n</code></pre>\n\n<p>Howver I get the following error</p>\n\n<pre><code> The best overloaded method match for X has some invalid arguments.\n</code></pre>\n\n<p>So obviously I'm way off the mark.  Where am I going wrong? Is boxing the right solution or should i be looking at type casting?</p>\n"},{"tags":["c#",".net","windows","environment-variables","class-library"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13275338,"title":"How to resolve environment variables programatically in C# without using Environment Enum?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4726818/expand-environment-variable-for-my-documents\">Expand environment variable for My Documents</a>  </p>\n</blockquote>\n\n\n\n<p>We often use %% delimited environment variables in Command prompt in Windows Xp, 7, Vista, Server 2003-2008R2 and possibly in future windows versions. Examples are:</p>\n\n<pre><code>%windir%\n%systemroot%\n%temp%\n</code></pre>\n\n<p>I need to be able to programatically resolve these environment variables using C#.</p>\n\n<p>Please do not suggest <code>Environmen.SpecialFolder</code> , because i am getting values from a webservice in the above formats and i need to able to programmatically resolve them and determine physical location of these paths on server. My scenario is a class libarary project and i may <strong>NOT</strong> require/be able to use <code>Server.MapPath</code></p>\n\n<p>I am looking for a generic method builtin or custom that can help me resolve all environment variables pro grammatically and calculate local physical paths from these variables just Command Prompt or Windows Explorer or Run Command does !</p>\n\n<p>I have seen questions similar to these on StackOverFlow but couldn't find any marked answers. Please note that <code>Environment.Xxxxx Enum</code> doesnt cater for the scenario i am working through.</p>\n\n<p>Any help is appreciated. I am using .NET 4.0 Complete Framework Profile with C#.</p>\n"},{"tags":["c#","mvvm","windows-8","winrt","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13279397,"title":"How can I create a bindable command proxy","body":"<p>I am currently developing a Windows store app using the MVVM pattern. The ViewModel implements a couple of commands that are used by the view. In some cases I want the view to trigger more than just one command. Therefore I created a CommandGroup class that is derived from ICommand and holds an observable collection of commands. In order to be able to populate this collection using XAML I created another class called CommandProxy that is derived from DependencObject and also implements ICommand.</p>\n\n<p>The idea is to support something like this within the view:</p>\n\n<pre><code>&lt;Button Content=\"Test\"&gt;\n   &lt;Button.Command&gt;\n      &lt;vm:CommandGroup&gt;\n         &lt;vm:CommandGroup.Commands&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command1}\" CommandParameter=\"{Binding ElementName=Object1}\"/&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command2}\" CommandParameter=\"{Binding ElementName=Object2}\"/&gt;\n            &lt;vm:CommandProxy Command=\"{Binding Command3}\" CommandParameter=\"{Binding ElementName=Object3}\"/&gt;\n         &lt;/vm:CommandGroup.Commands&gt;\n      &lt;/vm:CommandGroup&gt;\n   &lt;/Button.Command&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>Everything looks fine when doing a syntax check, but the bindings are not resolved at runtime. This can be reproduced using the following example assuming the ViewModel implements the command MyCommand and the view contains an element called MyElement:</p>\n\n<pre><code>&lt;Button Content=\"Test\"&gt;\n   &lt;Button.Command&gt;\n      &lt;vm:CommandProxy Command=\"{Binding MyCommand}\" CommandParameter=\"{Binding ElementName=MyElement}\"/&gt;\n   &lt;/Button.Command&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>This is a simplyfied version of the CommandProxy class that can be used to reproduce the issue:</p>\n\n<pre><code>public class CommandProxy : DependencyObject, ICommand\n{\n    public static readonly DependencyProperty CommandProperty =\n        DependencyProperty.Register(\"Command\", typeof(object), typeof(CommandProxy), new PropertyMetadata(null));\n\n    public static readonly DependencyProperty CommandParameterProperty =\n        DependencyProperty.Register(\"CommandParameter\", typeof(object), typeof(CommandProxy), new PropertyMetadata(null));\n\n    /// &lt;summary&gt;\n    /// Command\n    /// &lt;/summary&gt;\n    public ICommand Command\n    {\n        get\n        {\n            return (ICommand)GetValue(CommandProperty);\n        }\n\n        set\n        {\n            SetValue(CommandProperty, value);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Command Parameter\n    /// &lt;/summary&gt;\n    public object CommandParameter\n    {\n        get\n        {\n            return GetValue(CommandParameterProperty);\n        }\n\n        set\n        {\n            SetValue(CommandParameterProperty, value);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Event used to singnal that CanExecute has changed\n    /// &lt;/summary&gt;\n    public event EventHandler CanExecuteChanged;\n\n    /// &lt;summary&gt;\n    /// Create new CommandGroupElement\n    /// &lt;/summary&gt;\n    public CommandProxy()\n    {\n    }\n\n    /// &lt;summary&gt;\n    /// Determine whether command can be executed\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"parameter\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public bool CanExecute(object parameter)\n    {\n        if (Command != null)\n            return Command.CanExecute(CommandParameter);\n         return false;\n    }\n\n    /// &lt;summary&gt;\n    /// Execute Command\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"parameter\"&gt;Parameter&lt;/param&gt;\n    public void Execute(object parameter)\n    {\n        if (Command != null)\n            Command.Execute(CommandParameter);\n    }\n\n    /// &lt;summary&gt;\n    /// Raise CanExecuteChanged event\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    protected void raiseCanExecuteChanged()\n    {\n        raiseCanExecuteChanged(this, EventArgs.Empty);\n    }\n\n    /// &lt;summary&gt;\n    /// Raise CanExecuteChanged event\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;Parameter&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    protected void raiseCanExecuteChanged(object sender, EventArgs e)\n    {\n       if (CanExecuteChanged != null)\n           CanExecuteChanged(this, EventArgs.Empty);\n    }\n}\n</code></pre>\n\n<p>Is there anybody who can tell me what I'm doing wrong or explain me why this does not work?</p>\n\n<p>Kind regards</p>\n\n<p>Thomas</p>\n"},{"tags":["c#","tcp","listener","ports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13279333,"title":"Listening to multiple ports with TcpListener","body":"<p>I need to listen to about 100 different ports via TCP. Looking at the TcpListener class in C#, it obviously listens on just one port. Does it make sense to create 100 different TcpListener instances each with their own port. </p>\n\n<p>I am not seeing it as a clean solution but it seems like the only option.</p>\n\n<p>Thanks for any opinions in advance</p>\n"},{"tags":["c#","java","launching-application"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":98,"score":4,"question_id":11248691,"title":"Error when launching java program from C#","body":"<p>I trying to launch java program with this code:</p>\n\n<pre><code>ProcessStartInfo info = new ProcessStartInfo();\n        info.WorkingDirectory = @\"D:\\2\\server\";\n        info.FileName = \"java\";\n        info.Arguments = \"-Xms512m -Xmx1536m -Xbootclasspath/p:./libs/jsr166.jar -cp ./libs/*;server.jar server.Server\";\n        ServerProcess = new Process();\n        ServerProcess.StartInfo = info;\n        ServerProcess.Start();\n</code></pre>\n\n<p>But always getting error:</p>\n\n<blockquote>\n  <p>Error occurred during initialization of VM Could not reserve enough\n  space for object heap Could not create the Java virtual machine.</p>\n</blockquote>\n\n<p>But if i create a .bat file with code:</p>\n\n<pre><code>java -Xms512m -Xmx1536m -Xbootclasspath/p:./libs/jsr166.jar -cp ./libs/*;server.jar server.Server\n</code></pre>\n\n<ul>\n<li>all ok!</li>\n</ul>\n\n<p>So i guess something wrong with my C# code?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","linq","extension-methods"],"answer_count":1,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":51,"score":5,"question_id":13279215,"title":"Wrap a Linq query in a try/catch block using a method declaration","body":"<p>So here is what I would like to be able to do.</p>\n\n<pre><code>var a = Item.CatchLog().Where(x=&gt;x.Property==\"value\").Take(10);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().FirstOrDefault(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().Any(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>Essentially, I would like is for <code>CatchLog()</code> to basically wrap the execution of the query in a try catch, and <code>Debug.WriteLine()</code> the <code>Exception</code> and then <code>throw</code> it. </p>\n\n<p>Any ideas on how I could implement something like this?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13279000,"title":"Convert lambda expression to linq query","body":"<p>Is there any way to convert this lambda expression in linq query?</p>\n\n<pre><code>function List&lt;ViewModel&gt; CreateViewModels(List&lt;Model&gt; models)\n{\n   return models.Select(x =&gt;\n   {\n      var viewModel = new ViewModel();\n\n      this.UpdateViewModel(x, viewModel);\n\n      return viewModel;\n   }).ToList();\n}\n</code></pre>\n\n<p>Where 'UpdateViewModel' is a function that transfer the values from the Model object to the ViewModel object.</p>\n\n<p>Ok, this code is clean but I'm wondering to know if there is the equivalent with a linq query.</p>\n"},{"tags":["c#","windows-8","visual-studio-2012","bing-maps","bing-maps-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13239597,"title":"Why can I not reference Bing Maps in my app?","body":"<p>I tried to add a Reference to Bing Maps in my app by right-clicking on <em>References | Add References | Windows | Extensions | Bing Maps for C#...</em>, but selecting \"OK\" does nothing - the Reference is not added.</p>\n\n<p>I then tried adding it via <em>Tools | Extensions and Updates</em>, but when I installed the latest version (with today's date - 11/5/2012), I then got:</p>\n\n<pre><code>Successfully installed 'BingMapAppSDK 1.0.1011.1716'.\nSuccessfully uninstalled 'BingMapAppSDK 1.0.1011.1716'.\nInstall failed. Rolling back...\nCould not install package 'BingMapAppSDK 1.0.1011.1716'. You are trying to install this package into a project that targets '.NETCore,Version=v4.5', but the package does not contain any assembly references that are compatible with that framework. For more information, contact the package author.\n</code></pre>\n\n<p>Now the button there (at <em>Tools | Extensions and Updates | Bing Maps SDK for C#...</em> says \"Uninstall\" so it is apparently installed, but why can I not add the Reference to my project?</p>\n\n<h2>UPDATE</h2>\n\n<p>It's not just Bing Maps that won't let itself be added to my project's References; when I try to add \"Microsoft Visual C++ Runtime Package,\" it also will not be added; there's no err msg when I select it, it simply doesn't get added...</p>\n\n<p>I have another project which has \"Bing Maps for C#...\" installed as a Reference. Why that one would work and the other one not is both a conundrum and an irritation.</p>\n\n<p>The bizarre thing is that, according to <em>Extensions and Updates  Installed | SDKs</em>, in the working project the only Bing Maps SDK installed is the one for JavaScript... and yet my project does have a Reference to \"Bing Maps for CE, C++, or VB\"...???</p>\n\n<p>Yet if I go to <em>Extensions and Updates | Online | Visual Studio Gallery</em> and search for \"bing maps\" the search results contains \"Bing Maps SDK for Windows Store apps\" with a green check, indicating it is installed.</p>\n\n<p>Could it be my project's configuration? The project that works is set for Debug, x86. The one that doesn't work is set to Debug, Any CPU...???</p>\n\n<p>And if I'm doing something wrong, why is the \"Filtered to: SDKs applicable to  displaying (among other things) \"Bing Maps for C#, C++, or VB\"? </p>\n\n<p>IOW, it's teasing me that it's available, but won't allow it to be added...argghhhh!!!</p>\n\n<h2>UPDATE 2</h2>\n\n<p>Maybe this could be a clue to my problem: In <em>Tools | Extensions and Updates</em>, Bing Maps SDK for Windows Store apps appears in the \"Tools\" category as opposed to the SKDKs category (although Bing Maps SDK for JavaScript) is in the SDKs category...</p>\n\n<h2>UPDATE 3</h2>\n\n<p>Based on Mayank's suggestion, I tried to browse to and add the .dll</p>\n\n<p>That not only didn't work, but also gave me an err msg:</p>\n\n<p><em>\"A reference to C:\\Users\\Clay\\AppData\\Local\\Microsoft SDKs\\Windows\\v8.0\\ExtensionSDKs\\Bing.Maps.Xaml\\1.0\\DesignTime\\CommonConfiguration\\x86\\Bing.Maps.Design.dll' could not be added. The project targets '.NETCore' while the file reference targets .NETFramework'. This is not a supported scenario.</em></p>\n\n<p>If this is truly the problem, how do I switch from .NETCore to .NETFramework? I'm certain I did not explicitly choose .NETCore at any time for this project...</p>\n\n<h2>UPDATE 4</h2>\n\n<p>Elsewhere somebody suggested I compare the .csproj files of an app that does work with the Bing Maps and the one that doesn't. Here's is what I have come up with:</p>\n\n<p>I noticed that the app that IS working with Bing Maps has this in the .csproj file, whereas the other one doesn't:</p>\n\n<pre><code>&lt;Compile Include=\"DataModel\\SampleDataSource.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BindableBase.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BooleanToVisibilityConverter.cs\" /&gt;\n    &lt;Compile Include=\"Common\\BooleanNegationConverter.cs\" /&gt;\n    &lt;Compile Include=\"Common\\LayoutAwarePage.cs\" /&gt;\n    &lt;Compile Include=\"Common\\RichTextColumns.cs\" /&gt;\n    &lt;Compile Include=\"Common\\SuspensionManager.cs\" /&gt;\n    &lt;Compile Include=\"SQLite.cs\" /&gt;\n    &lt;Compile Include=\"SQLiteAsync.cs\" /&gt;\n    &lt;Compile Include=\"ViewModel\\StorageUtils.cs\" /&gt;\n    &lt;Compile Include=\"View\\SectionN.xaml.cs\"&gt;\n      &lt;DependentUpon&gt;SectionN.xaml&lt;/DependentUpon&gt;\n    &lt;/Compile&gt;\n</code></pre>\n\n<p>...although curious (why does one include all of those files, and the other doesn't?), I don't see why this would be a problem.</p>\n\n<p>Also, the working app contains this:</p>\n\n<pre><code>&lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)' == 'TSLsARM|\nAnyCPU'\"&gt;\n    &lt;DebugSymbols&gt;true&lt;/DebugSymbols&gt;\n    &lt;OutputPath&gt;bin\\TSLsARM\\&lt;/OutputPath&gt;\n    &lt;DefineConstants&gt;DEBUG;TRACE;NETFX_CORE&lt;/DefineConstants&gt;\n. . .\n</code></pre>\n"},{"tags":["c#","inotifypropertychanged","bindinglist"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13279186,"title":"INotifyPropertyChanged and the BindingList ListChanged event","body":"<p>If I have a class like the one below:</p>\n\n<pre><code>public class MyClass : INotifyPropertyChanged\n{\n    private BindingList&lt;String&gt; myList;\n\n    public BindingList&lt;String&gt; MyList\n    {\n        get { return myList; }\n        set\n        {\n            if (myList == value) return;\n            myList = value;\n            OnPropertyChanged(\"MyList\");\n        }\n    }\n}\n</code></pre>\n\n<p>Do I need to setup the following event handler:</p>\n\n<pre><code>myList.ListChanged += (object sender, ListChangedEventArgs e) =&gt; OnPropertyChanged(\"MyList\");\n</code></pre>\n\n<p>Or is it detected?  I know that the BindingList class will look for the INotifyPropertyChanged interface on the templated type it is of so it can determine whether it should raise the ListChanged event, but I am uncertain if it works the other way.</p>\n"},{"tags":["c#","windows-8","winrt-xaml"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":2409,"score":3,"question_id":10362566,"title":"How to programmatically respond to Snap in Windows 8 Metro","body":"<p>Is there a way to respond to Snap in C# in a Metro app? When one of the pages is snapped I need to show another one. My idea is to respond to snap by naviating to another page.</p>\n\n<p>I found</p>\n\n<pre><code>var currentView = ApplicationLayout.GetForCurrentView();\ncurrentView.LayoutChanged += new TypedEventHandler&lt;ApplicationLayout, ApplicationLayoutChangedEventArgs&gt;(currentView_LayoutChanged);\n</code></pre>\n\n<p>but it looks like it no longer works in Consumer Preview. Is there another way?</p>\n"},{"tags":["c#","asp.net","appfabric","windows-server","appfabric-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13279038,"title":"AppFabric 1.0 error Server collection cannot be empty","body":"<p>I am getting the following error when I run the simple <strong>Windows Server App Fabric 1.0</strong> demo console application: </p>\n\n<pre><code>ErrorCode&lt;ERRCA0021&gt;:SubStatus&lt;ES0001&gt;:Server collection cannot be empty.\n</code></pre>\n\n<p>Please help me.. What am I missing..?? I have looked every where on the internet and nothing seems to be fixing this issue. thanks..</p>\n\n<p>My application is as follows: </p>\n\n<pre><code>static void Main(string[] args)\n{\n    var factory = new Microsoft.ApplicationServer.Caching.DataCacheFactory(); &lt;--- *** Error here\n\n    var cache = factory.GetDefaultCache();\n    var key = \"mykey\";\n    var obj = cache[key];\n    if (obj == null)\n    {\n        cache[key] = \"I am data for caching\";\n    }\n    obj = cache[key];\n    Console.WriteLine(obj);\n    Console.Read();\n}\n</code></pre>\n\n<p>My app.config is as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n&lt;configSections&gt;\n    &lt;section name=\"dataCacheClients\"\n                type=\"Microsoft.ApplicationServer.Caching.DataCacheClientsSection, Microsoft.ApplicationServer.Caching.Core\" /&gt; \n&lt;/configSections&gt;\n&lt;dataCacheClients&gt;\n&lt;dataCacheClient&gt;\n    &lt;hosts&gt;\n        &lt;host name=\"MyMachineNameHere\" cachePort=\"22233\" /&gt;\n    &lt;/hosts&gt;\n&lt;/dataCacheClient&gt;\n&lt;/dataCacheClients&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","linq","visual-studio-lightswitch"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13017288,"title":"Lightswitch, adding filter to query that relies on unsaved changes","body":"<p>I'm using Lightswitch and I'm trying to populate a dropdown list by filtering the query to the a list of items that have not been selected already.</p>\n\n<p>The code I wrote works, but it is only using the data that has been \"saved\".  I'd like to filter out things that have been added, but not necessarily saved.</p>\n\n<pre><code>partial void NotAssignedToEventEmployee_PreprocessQuery(int? SelectedEventId, ref IQueryable&lt;EmployeeItem&gt; query)\n{\n    query = from a in query\n            where a.AssignmentsAsEmployeeCollection.All(y =&gt; y.EventSetItem.Id != (int)SelectedEventId)\n            select a;\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13253444,"title":"Programmatically calling PreviewTextInput not invoking TextChanged event","body":"<p>I have a <code>TextBox</code> that only allows certain characters to be typed into it; I'm handling this logic in the <code>PreviewTextInput</code> event.  If it's a character that's allowed, then the <code>TextChanged</code> event is fired, otherwise it cancels the <code>TextChanged</code> event.</p>\n\n<p>I have another application that is opened on a second screen while this is running, however even if there is keyboard input while the other application is active, it should still update the currently focused <code>TextBox</code> on the main application.  To do this, I added a listener to the <code>OnKeyPress()</code> event on the second application, which calls the <code>PreviewTextInput</code> event on the focused <code>TextBox</code> in the main application.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>private void ImageEventController_OnKeyPress(char c)\n        {\n            object focusedElement = this.CurrentKeyboardFocus;\n            if (focusedElement != null)\n            {\n                if (focusedElement is TextBox)\n                {\n                    TextBox target = (TextBox)focusedElement;\n                    if (target.IsEnabled)\n                    {\n                        string text = c.ToString();\n                        var routedEvent = TextCompositionManager.PreviewTextInputEvent;\n\n\n         target.RaiseEvent(new TextCompositionEventArgs(\n                    InputManager.Current.PrimaryKeyboardDevice,\n                    new TextComposition(InputManager.Current, target, text)) { RoutedEvent = routedEvent });\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>When this is called, it goes through the <code>PreviewTextInput</code> event, however the <code>TextChanged</code> event never gets fired even if it's a valid character.  Is there any reason why <code>TextChanged</code> is not getting fired when <code>PreviewTextInput</code> is invoked programmatically?</p>\n\n<p>UPDATE:</p>\n\n<p>I added in this code to the bottom of my <code>PreviewTextInput</code> event listener:</p>\n\n<pre><code>if (!e.Handled)\n{\n     textbox.Text = e.Text;\n}\n</code></pre>\n\n<p>This forces the <code>TextChanged</code> event to fire and fixes the functionality when the second application has focus, however if the main application has focus it causes two TextBoxes to get updated when only pressing one button.</p>\n"},{"tags":["c#","oop","class-structure"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":184,"score":1,"question_id":9592030,"title":"C# Array Properties and Class Structure","body":"<p>The current structure of my classes goes a little bit like this:\nPC.Processor.Architecture[0] = The Architecture of the first processor (assuming a multi-processor system).</p>\n\n<p>How I ideally want it is more like this:\nPC.Processor[0].Architecture, because it's a bit more self explanatory this way.</p>\n\n<p>Is there a fairly efficient way of doing this with what I have? Bear in mind there are like, over 9000 properties in each of the classes Processor, Motherboard, Memory etc and WMI calls are not CPU-cheap to run.</p>\n\n<p>Here are the important snippets for my classes</p>\n\n<pre><code>class PC\n{\n    public Processor Processor;\n    public Motherboard Motherboard;\n\n    // Constructor\n    public PC()\n    {\n        Processor = new Processor();\n        Motherboard = new Motherboard();\n    }\n\n    // Method to get all info sequentially\n    public void GetAllInfo()\n    {\n        Processor.GetInfo();\n        Motherboard.GetInfo();\n    }\n}\n\nclass Processor\n{\n    public string[] Architecture;\n    public string[] Availability;\n    public UInt16[] Cores;\n\n    public void GetInfo()\n    {\n        // Get WMI Information from custom process\n        // Returns as an array of ManagementObjects for each matched device (which is a bit like an array of dictionaries)\n        ManagementObject[] WMIData = DataRetriever.GetWMIData(\"Win32_Processor\");\n        try\n        {\n            for (int i = 1; i &lt; WMIData.Length; i++)\n            {\n                this.Architecture[i] = (string)WMIData[i][\"Architecture\"];\n                this.Availability[i] = (string)WMIData[i][\"Availability\"];\n                this.Cores[i] = (UInt16)WMIData[i][\"NumberOfCores\"];\n            }\n        }\n        catch (NullReferenceException e)\n        {\n            // To be implemented\n        }\n    }\n}\n</code></pre>\n\n<p><strong>FURTHERMORE</strong><br>\nThere may be more than one WMI search query per class. For example, HardDrive needs to make use of both Win32_PhysicalMedia and ATAPI_SmartData (or whatever the class actually is.)</p>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13278778,"title":"How to use XElement.Parse and then find the value of a specific element?","body":"<p>I've got some XML that is returned from a REST call that looks like this:</p>\n\n<pre><code>&lt;ArrayOfProperty xmlns=\\\"http://schemas.microsoft.com/HPCS2008R2/common\\\" xmlns:i=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;Id&lt;/Name&gt;\n    &lt;Value&gt;17&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;StartTime&lt;/Name&gt;\n    &lt;Value&gt;11/7/2012 9:13:50 PM&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;State&lt;/Name&gt;\n    &lt;Value&gt;Failed&lt;/Value&gt;\n  &lt;/Property&gt;\n</code></pre>\n\n<p>I'm using the RestSharp API to assist in executing the API calls and trying to use the linq-to-xml XElement.Parse to parse the results.  I'm not sure how to get the value of the state such that from within this document I want to do something like :</p>\n\n<p><code>XElement.Parse(XMLstring).Elements???</code> to get the text \"Failed\" from the set of elements that contains the element State but I want the text \"Failed\" from the <code>&lt;Value&gt;Failed&lt;/Value&gt;</code> element.  That value element can have multiple values but I always want the value that is associated with the state.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","path","system.diagnostics","process.start"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1722,"score":3,"question_id":8003272,"title":"Can Process.Start() take the system PATH into account?","body":"<p>I've been searching and experimenting for a while with this but have had no luck.</p>\n\n<p>I am trying to make a console program to automate some tasks that I couldn't quite do with a BAT file.  I want to call \"signcode.exe\" from the Windows SDK, the bin folder with all the tools in in my system PATH and I can call \"signcode\" from anywhere but Process.Start is ignoring path.</p>\n\n<p>Current code:</p>\n\n<pre><code>System.Diagnostics.Process sign = new System.Diagnostics.Process();\nsign.StartInfo.FileName         = signCommand.Substring(0, signCommand.IndexOf(' '));  // signtool.exe\nsign.StartInfo.Arguments        = signCommand.Substring(signCommand.IndexOf(' ') + 1); // /sign /a file1 file2\n\n// sign.StartInfo.EnvironmentVariables[\"Path\"] = Environment.GetEnvironmentVariable(\"PATH\");  // this doesn't work either\nsign.StartInfo.UseShellExecute              = false;\nsign.StartInfo.RedirectStandardOutput       = true;\nsign.StartInfo.RedirectStandardError        = true;\n\nsign.Start();  // Throws Win32Exception - The system cannot find the file specified\n</code></pre>\n\n<p>I've confirmed that StartInfo.EnvironmentVariables[\"Path\"] matches my system path, and contains the Windows SDK folder.  Setting it manually doesn't work either.</p>\n\n<p>I've even tried setting TempPath as shown on the MSDN page for <a href=\"http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.environmentvariables.aspx\" rel=\"nofollow\">EnvironmentVariables Property</a> but that didn't work either.  I wonder why you would be able to set this if it has no effect.</p>\n\n<p>If System.Diagnostics.Process cannot use the path, are there any other functions I could use?  I'd like to see the output of the command in my console application as well.</p>\n\n<p>Thanks.</p>\n\n<p>EDIT:  Here is some additional debug values:</p>\n\n<pre><code>Console.WriteLine(\"Sign Filename = '{0}'\", sign.StartInfo.FileName);\nSign Filename = 'signtool.exe'\n\nConsole.WriteLine(\"Sign Arguments = '{0}'\", sign.StartInfo.Arguments);\nSign Arguments = '/sign /f C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\APPARENTINC.pfx /t http://timestamp.comodoca.com/authenticode \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\MGInsight.exe\" \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\XPXScanner.dll\" \"C:\\Visual Studio\\Projects\\MGInsight\\MGInsight\\Publish\\Application Files\\\\MGInsight_0_9_1_85\\NetworkCalculations.dll\"'\n\nConsole.WriteLine(\"Sign Path = '{0}'\", sign.StartInfo.EnvironmentVariables[\"Path\"]);\nSign Path = 'C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;\"C:\\Program Files\\Intel\\WiFi\\bin\\\";\"C:\\Program Files\\Common Files\\Intel\\WirelessCommon\\\";\"C:\\Program Files (x86)\\cwRsync\\bin\";\"C:\\Program Files (x86)\\Git\\cmd\";\"C:\\Program Files (x86)\\Git\\bin\";\"C:\\Program Files (x86)\\Zend\\ZendServer\\bin\";\"C:\\Program Files (x86)\\Zend\\ZendServer\\share\\ZendFramework\\bin\";\"C:\\Program Files\\Java\\jre6\\bin\";\"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\\";\"C:\\Program Files\\Microsoft Windows Performance Toolkit\\\";C:\\MinGW\\bin;\"C:\\Program Files (x86)\\Microsoft\\ILMerge\";\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\";C:\\Program Files (x86)\\Nmap'\n</code></pre>\n\n<p>The path <code>\"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\"</code> is where signtool.exe is and I can run it from command prompt by simply typing <code>signtool</code>, but if I run this application from the same prompt, it doesn't register that path.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":192,"score":-2,"question_id":9592243,"title":"Why does this C# code fail?","body":"<p>This is matrix product which saves the answer in <code>C</code>, such that <code>C=A*B</code>. So why won't the <code>C</code> values change?</p>\n\n<p>It uses special way that it calculates each column, because we want to use this method in Parallel programming such that each column evaluated in a single thread. I have tested something like this in pascal before, but in C# every thing is wrong.</p>\n\n<p>Note: This is for homework and there is no parallel in this code yet.</p>\n\n<pre><code>class Program\n{\n    private static int n = 2;\n    static int[,] A = new int[n, n];\n    static int[,] B = new int[n, n];\n    static int[,] C = new int[n, n];\n    private static void Main(string[] args)\n    {\n        A[0, 0] = 2; A[0, 1] = 3;\n        A[1, 0] = 5; A[1, 1] = 1;\n\n        B[0, 0] = 3; B[0, 1] = 0;\n        B[1, 0] = 1; B[1, 1] = 0;\n\n        C[0, 0] = 0; C[0, 1] = 0;\n        C[1, 0] = 0; C[1, 1] = 0;\n\n        //Calculation \n        for (int z = 0; z &lt; n; z++)\n        {\n            ComputeColumn(z);\n        }\n        PrintAnswer(C);\n        Console.ReadKey();\n    }\n    private static void ComputeColumn(int n)\n    {\n        for (int i = 0; i &lt; n; i++)\n        {\n            for (int k = 0; k &lt; n; k++)\n            {\n                C[i, n] += (A[i, k] * B[k, n]);\n            }\n        }\n    }\n    private static void PrintAnswer(int[,] what)\n    {\n        for (int i = 0; i &lt; n; i++)\n        {\n            for (int j = 0; j &lt; n; j++)\n            {\n                Console.Write(what[i, j] + \" \");\n            }\n            Console.WriteLine();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","signalr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13279041,"title":"How do i update SignalR in my project on visual studio?","body":"<p>I know this may sound like a newb quesiton, but how can i go about updating my signalR in visual studio.  I know there are some dependencies that must be updated as well so I wanted to know step by step how to upgrade my SignalR.  I am using nuget for my packages.  I am also using SignalR.Ninject, so just wanted to make sure this would be up to date as well.</p>\n\n<p>When I go to my references folder and click on the SignalR dependencies it is version 0.5.1.10625 with nothing to update on the nuget \"updates\" tab</p>\n"},{"tags":["c#","json","serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13278459,"title":"Json Serialization in C#","body":"<p>I'm trying to serialize a local object to json but msdn documentation always seems to confuse me. I believe I am suppose to use the DataContractJsonSerializer but not completely sure, as I have seen mixed responses. I've also had someone recommend Newtonsoft.</p>\n\n<p>Does anyone have any experience with this that can point me in the right direction?</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278522,"title":"How to add a context menu for only one level in a TreeView","body":"<p>I've got a TreeView, containing a number of levels of <code>TreeViewItems</code>.</p>\n\n<p>I would like to add a context menu to only one level of items in the TreeView. However, my code produces a result whereby every single item in the TreeView has a context menu.</p>\n\n<p>This is my code:    </p>\n\n<pre><code>//.... foreach item in this level.... \n\n{\nContextMenu cmDatabase = new ContextMenu();\nMenuItem menuItem = new MenuItem();\nmenuItem.Header = \"Close Connection\";\nImage imgMenuIcon = new Image();\nimgMenuIcon.Source = new BitmapImage(new Uri(\"icon.png\"));\nmenuItem.Icon = imgMenuIcon;\ncmDatabase.Items.Add(menuItem);\ntreeViewItem.ContextMenu = cmDatabase;\n}\n</code></pre>\n\n<p>I've also tried manually setting all the other TreeViewItems' contextMenu property to null.  No luck though.  Any ideas?</p>\n"},{"tags":["c#","wpf","multithreading","user-interface","wpf-controls"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":59,"score":4,"question_id":13273289,"title":"WPF Control On Separate UI Thread?","body":"<p>I am making a media player, now.. I have added a realtime search function to search for songs etc. (Some thing like WMP realtime search) i.e while you enter the keywords the searching happens.</p>\n\n<p>During the searching process, accessing the database and loading an IEnumerable is done on another thread via a BackGroundProcess. The UI is updated by invoking a dispatcher of a UIElement.</p>\n\n<p>This process is rather fast, but however while you enter the search keywords in the textbox, there seems to be a small lag, this is beacause the Listbox.ItemSource updating takes some time. \ni.e say you want to search for \"Adele\", when you type in \"a\", the search function loads the results for \"A\", but as we are typing the whole word \"Adele\" , it some time to display the \"d\" \"e\" \"l\" \"e\" and there is a slight lag in between these letters.</p>\n\n<p>During this search process, when I stop updating the UI the search process seems very smooth, this only means to me that the Listbox is locking up the thread, so the rest of the player's UI is stuck there while the Listbox is done with its processing.</p>\n\n<p>So I believe if I can put the Listbox Control to another UI thread, I can maintain the smooth flow of the player irrespective of the time taken to load the Listbox.\nFYI: Data Virutualization is there &amp; ListBox has UI Virtualization is working</p>\n\n<p>How can i put the ListBox control onto another UI Thread?\nWPF, C#</p>\n\n<p>Thanks in advance  :)</p>\n"},{"tags":["c#","asp.net-mvc","upload","google-drive-sdk","google-drive"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13276819,"title":"ResumableUpload with google drive api v2 .net","body":"<p>I'm trying to upload a file to google drive and monitor the upload progress. I'm using .net with api v2.</p>\n\n<p>I was using the DriveService.Files.Insert method that gives me a FilesResource.InsertMediaUpload, and then I'm using the ProgressChanged event to list to the progress. The problem is that this event is called only 3 times: with \"starting\", \"uploading\", \"completed\" states. I would like to have many call in the \"uploading\" state.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    private UploadToGoogle(...)\n    {\n        //Consider I have an populated File and MemoryStream:\n        MemoryStream contentStream = /*Populated memoryStream*/;\n        File body = /*Populated file*/;\n\n        FilesResource.InsertMediaUpload uploadRequest = null;\n\n        try\n        {\n            contentStream.Position = 0;\n\n            uploadRequest = driveService.Files.Insert(body, contentStream, body.MimeType);\n\n            uploadRequest.ProgressChanged += new Action&lt;Google.Apis.Upload.IUploadProgress&gt;(UploadProgessEvent);\n\n            Action asyncAction = () =&gt;\n            {\n                uploadRequest.Upload();\n                Console.WriteLine(\"Completed!\");\n            };\n\n            var thread = new System.Threading.Thread(new System.Threading.ThreadStart(asyncAction));\n            thread.Start();\n\n        }catch(Exception) {}\n    }\n</code></pre>\n\n<p>There's some content on internet about the ResumableUpload class in older apis, but don't know how to use that in v2. I've found the ResumableUpload class in Google.Apis.Upload namespace, but it's abstract and I have no idea how to use that.</p>\n\n<p>I didn't find anything usefull about progress monitoring in documentation: <a href=\"https://developers.google.com/drive/manage-uploads\" rel=\"nofollow\">https://developers.google.com/drive/manage-uploads</a></p>\n\n<p>And I really don't want to use resumable upload through WebRequest, is there a way to implement that in .net sdk...</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13278962,"title":"Drawing lines with an arrow in the middle","body":"<p>First of all sorry for my English...\nI would like to draw lines with arrows in the middle in c#. How can i do it?</p>\n\n<p>I have done this:</p>\n\n<pre><code>Graphics g = e.Graphics;\ng.SmoothingMode = SmoothingMode.AntiAlias;\n\nPen p = new Pen(Color.Black, 2);\np.StartCap = LineCap.Round;\np.EndCap = LineCap.ArrowAnchor;\ng.DrawLine(p, StartX, StartY, EndX, EndY);\np.Dispose();\n</code></pre>\n\n<p>But it's not enough... I would like to draw the arrow to the line's middle...</p>\n"},{"tags":["c#","multithreading","locking"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13273277,"title":"Prevent Reading and Writing to a File at the Same Time","body":"<p>I have a process that needs to read and write to a file. The application has a specific order to its reads and writes and I want to preserve this order. What I would like to do is implement something that lets the first operation start and makes the second operation wait until the first is done with a first come first served like of queue to access the file. From what I have read file locking seems like it might be what I am looking for but I have not been able to find a very good example. Can anyone provide one?</p>\n\n<p>Currently I am using a TextReader/Writer with .Synchronized but this is not doing what I hoped it would.</p>\n\n<p>Sorry if this is a very basic question, threading gives me a headache :S</p>\n"},{"tags":["c#",".net","itextsharp","pdfsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2468,"score":0,"question_id":6363135,"title":"adding new pages to existing pdf using iTextSharp","body":"<p>I have a pdf file with 1 page.Now I want to add two more pages to it with some data or image.\nI tried this but it doesnot adding new pages :</p>\n\n<pre><code>private void addPage()\n   {\n     Document document = new Document();\n     writer = PdfWriter\n        .GetInstance(document, new FileStream(outputFileName, FileMode.Create));\n\n        document.Open();\n\n        PdfContentByte cb = writer.DirectContent;\n\n\n     for (int pageNumber = 1;pageNumber &lt; reader.NumberOfPages + 2;pageNumber++)\n        {\n            document.SetPageSize(reader.GetPageSizeWithRotation(1));\n            document.NewPage();\n\n            if (pageNumber == 1)\n            {\n                Chunk fileRef = new Chunk(\" \");\n                fileRef.SetLocalDestination(newPdf);\n                document.Add(fileRef);\n            }\n\n            PdfImportedPage page = writer.GetImportedPage(reader, pageNumber);\n            int rotation = reader.GetPageRotation(pageNumber);\n            if (rotation == 90 || rotation == 270)\n            {\n                cb.AddTemplate(\n                    page, 0, -1f, 1f, 0, 0,\n                    reader.GetPageSizeWithRotation(pageNumber).Height\n                );\n            }\n            else\n            {\n                cb.AddTemplate(page, 1f, 0, 0, 1f, 0, 0);\n            }\n        }\n        document.NewPage();\n\n        Paragraph paragraph = new Paragraph();\n        iTextSharp.text.Font titleFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 15\n                , iTextSharp.text.Font.BOLD\n                , BaseColor.BLACK\n            );\n        Chunk titleChunk = new Chunk(\"Comments\", titleFont);\n        paragraph.Add(titleChunk);\n        document.Add(paragraph);\n\n        paragraph = new Paragraph();\n        iTextSharp.text.Font textFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 12\n                , iTextSharp.text.Font.NORMAL\n                , BaseColor.BLACK\n            );\n        Chunk textChunk = new Chunk(\"\", textFont);\n        paragraph.Add(textChunk);\n\n        document.Add(paragraph);\n        }\n\n        document.Close();\n\n  }\n</code></pre>\n"},{"tags":["c#","forms","class","containers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13278969,"title":"Windows / Web Form to other classes, forms, and etc","body":"<p>So this particular topic has been beaten to death; but apparently my iteration is either not the method of choice or isn't practical for implementation.</p>\n\n<p>The goal is to create a Windows Form and a Web Form.  Those two forms; set a property in a separate class.  Then other classes reference the container; that way as the interface is changed the functionality will change without a lot of recoding.</p>\n\n<p>Windows Form ---> Container &lt;--- Web Form\n                  Container --> Referenced by these: Class 1, Class 2, Class 3</p>\n\n<p>I approached it like this:\nForm:</p>\n\n<pre><code>private Some.Reference.ToClass.Container _container;\npublic void Method(Some.Reference.ToClass.Container Container)\n{\n          _container = Container;\n}\n\nprivate void button_click(object sender, EventArgs e)\n{\n          _container.Name = textbox.Text (or some other component)\n}\n</code></pre>\n\n<p>Class: \"Container\"</p>\n\n<pre><code>public Name { get; set; }\n</code></pre>\n\n<p>Class or Form to Reference:</p>\n\n<pre><code>Class WhateverName\n{\n       private string REFERENCE;\n\n       private Some.Reference.ToClass.Container _container;\n       public void Method(Some.Reference.ToClass.Container Container)\n       {\n                _container = Container;\n       }\n\n       public void NewMethod()\n       {\n              REFERENCE = _container.Name;\n       }\n}\n</code></pre>\n\n<p>It continually doesn't set; it states it's a null object.  What am I missing?  Any help would be appreciated. Or even a nice tutorial for me to compare to learn; or find why it doesn't work would be fine as well.</p>\n"},{"tags":["c#","asp.net","signalr"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13242565,"title":"Disconnect not firing sometimes in signalR","body":"<p>I currently keep my users in a table called OnlineUsers.  When a person connects or disconnects it adds the userid and his connectionid to the table, but for some reason (i believe when multiple browser windows are open) the Disconnect function does not fire sometimes, leaving users in the table and making them appear \"online\" when they really aren't.  Has anyone ran into this problem before and what would be a good way to fix this issue?</p>\n\n<p>UPDATE** (sorry about not putting code, I should have done it in the first place)</p>\n\n<p>Here are my db functions to add and remove from the table:</p>\n\n<pre><code>    public bool ConnectUser(Guid UserId, String ConnectionId)\n            {\n                if (!Ent.OnlineUsers.Any(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId))\n                {\n                    Ent.OnlineUsers.AddObject(new OnlineUser { UserId = UserId, ConnectionId = ConnectionId });\n                    Ent.SaveChanges();\n                    return true;\n                }\n                else\n                    return false;\n            }\n            public void DisconnectUser(Guid UserId, String ConnectionId)\n            {\n                if (Ent.OnlineUsers.Any(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId))\n                {\n                    Ent.OnlineUsers.DeleteObject(ucEnt.OnlineUsers.First(x =&gt; x.UserId == UserId &amp;&amp; x.ConnectionId == ConnectionId));\n                    Ent.SaveChanges();\n                }\n            }\n</code></pre>\n\n<p>Here is my hub class connect and disconnect task:</p>\n\n<pre><code> public Task Disconnect()\n        {\n\n            disconnectUser();                \n            return null;\n        }\n        public Task Reconnect(IEnumerable&lt;string&gt; connections)\n        {\n            connectUser();                \n            return null;\n        }\n        public Task Connect()\n        {\n            connectUser();               \n            return null;\n        }\nprivate void connectUser()\n        {\n            if (onlineUserRepository.ConnectUser(MainProfile.UserId, Context.ConnectionId))\n            {\n                Groups.Add(Context.ConnectionId, Convert.ToString(MainProfile.ChatId));\n            }\n        }\n        private void disconnectUser()\n        {\n            onlineUserRepository.DisconnectUser(MainProfile.UserId, Context.ConnectionId);\n            Groups.Remove(Context.ConnectionId, Convert.ToString(MainProfile.ChatId));\n        }\n</code></pre>\n"},{"tags":["c#","winforms",".net-4.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13278888,"title":"c# winforms - is InitializeComponent() function calling while refresh?","body":"<p>I want to ask about function <code>InitializeComponent()</code>. Is called after <code>Invalidate()</code> - invalidating component?</p>\n\n<p>Version: .net 4.5, VS 2012</p>\n"},{"tags":["c#","async-await"],"answer_count":5,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1668,"score":9,"question_id":8145479,"title":"Can constructors be async","body":"<p>I have a silverlight project where I'm trying to populate some data in a constructor</p>\n\n<pre><code>public class ViewModel\n{\n    public ObservableCollection&lt;TData&gt; Data { get; set; }\n    async public ViewModel()\n    {\n        Data = await GetDataTask();\n    }\n\n    public Task&lt;ObservableCollection&lt;TData&gt;&gt; GetDataTask()\n    {\n        Task&lt;ObservableCollection&lt;TData&gt;&gt; task;\n        //Create a task which represents getting the data\n        return task;\n    }\n}\n</code></pre>\n\n<p>Unfortunately, I'm getting an error: \"The modifier 'async' is not valid for this item\"\nOf course, if I wrap in a standard method and call that from the constructor:</p>\n\n<pre><code>public async void Foo()\n{\n    Data = await GetDataTask();\n}\n</code></pre>\n\n<p>it works fine.  Likewise, if I use the old inside-out way</p>\n\n<pre><code>GetData().ContinueWith(t =&gt; Data = t.Result);\n</code></pre>\n\n<p>That works too.  I was just wondering why we can't call await from within a constructor directly.  There are probably lots of (even obvious) edge cases and reasons against it, I just can't think of any.  I've also search around for an explanation, but can't seem to find any.</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13277719,"title":"How to terminate a console mode app from a BackGroundWorker","body":"<p>I am creating one BackgroundWorker and inside its DoWork function I have the following code:  </p>\n\n<pre><code>        foreach (string newFilepath in newFilesPath)\n        {\n                        if (!File.Exists(encryptedFilePath))\n                        {\n                            encryptedFiles.Add(encryptedFilePath);\n                            Helper.SendErrorMail(null, \"Could not find encrypted file.\", encryptedFilePath);\n                            Application.Exit();\n                        }\n                        else\n                        {\n                            Helper.Count_DataFeeds++;\n                            File.Delete(newFilepath);\n                        }\n        }\n</code></pre>\n\n<p>As per this code I should see only one mail because the Application exists, however I am seeing 8 mails(for each file it is iterating).  Why application is not quitting ? I want to kill the application at once.</p>\n\n<p>It is a console application.</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":11983111,"title":"Detect when new display is connected","body":"<p>I'm writing an application that requires two displays: one for the control panel, the other for the output. What I have is this: if there's only one display, the application shows both forms on it but if there are two, the output form goes to the other.\nThe problem is that this only happens when the application is started. In other words, if the application is already running before the second display is connected, nothing happens unless the user sends the output to the new display manually (assuming they know how to do it).\nWhat I want is that when a new display is connected, the output form is automatically sent to it even while the application is running. I think it has to do with polling a port in a thread but I don't know how to do it. Can anyone help with how to do it? If there is a better solution, I'll gladly welcome it.</p>\n\n<p>(I would have provided some part of the code but I'm typing this from a phone)</p>\n"},{"tags":["c#",".net","multithreading","system.reactive"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13270559,"title":"ReplaySubject.First() blocks unexpectedly","body":"<p>I am encountering an absolutely bizarre behaviour in a Silverlight application on which I am working. Please see the following code:</p>\n\n<pre><code>var replaySubject = new ReplaySubject&lt;string&gt;(1);\n    replaySubject.OnNext(\"This can never block... surely?\");\n\nvar s = replaySubject.First();\nDebug.WriteLine(s);\n</code></pre>\n\n<p>Basically, my app comes through this piece of code repeated and it always prints out the message... except for in one particular scenario in which the thread blocks on the <code>First()</code> line.</p>\n\n<p>It's always on the UI thread. If I set a break point on the line with <code>First()</code>, and drill into the <code>replaySubject</code> with the debugger, I can see the string in its queue.</p>\n\n<p>Can anyone think of any scenario that would cause the <code>First()</code> call to block here?</p>\n\n<p>BTW: It's RX version 1.1.11111</p>\n"},{"tags":["c#","asp.net-mvc-3","c#-4.0","castle-windsor"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13153370,"title":"Does ASP.NET MVC 3 cache Filters?","body":"<p>I have an UnitOfWork attribute, something like this:</p>\n\n<pre><code>public class UnitOfWorkAttribute : ActionFilterAttribute\n{\n    public IDataContext DataContext { get; set; }\n\n    public override void OnActionExecuted(ActionExecutedContext filterContext)\n    {            \n        if (filterContext.Controller.ViewData.ModelState.IsValid)\n        {\n            DataContext.SubmitChanges();\n        }\n\n        base.OnActionExecuted(filterContext);\n    }\n}\n</code></pre>\n\n<p>As you can see, it has <code>DataContext</code> property, which is injected by Castle.Windsor. <code>DataContext</code> has lifestyle of PerWebRequest - meaning single instance reused for each request.</p>\n\n<p>Thing is, that from time to time I get <code>DataContext is Disposed</code> exception in this attribute and I remember that ASP.NET MVC 3 tries to cache action filters somehow, so may that causes the problem?  </p>\n\n<p>If it is so, how to solve the issue - by not using any properties and trying to use ServiceLocator inside method? </p>\n\n<p>Is it possible to tell ASP.NET MVC to not cache filter if it does cache it?</p>\n"},{"tags":["c#","entity-framework","nhibernate","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13277324,"title":"NHibernate, join between tables and return a specific type","body":"<p>I have 2 tables, I'd like place some fields in a result class, but I'm stuck. The code I want look like this with Entity Framework :</p>\n\n<pre><code>var res =   \n(from p in context.EstimationItem\n    join q in ...\n    select new EstimationWithDetail\n    {\n        Estimation = q.Estimation,\n        Id = q.Id,\n        FullName = q.Customer.FirstName + q.Customer.LastName\n\n    }).ToList();\n</code></pre>\n\n<p>In Nibernate, at this time, I have this, but I'm stuck ...</p>\n\n<pre><code>var res =\n    Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinQueryOver(x =&gt; x.Estimation)\n    .Select(\n        x =&gt; x.Estimation.Reference,\n        x =&gt; x.Estimation.CreationDate,\n        x =&gt; x.Price,\n        x =&gt; x.Estimation.Customer.FirstName,\n        x =&gt; x.Estimation.Customer.LastName\n        )\n    .List();\n\npublic class Estimation\n{\n    public virtual string Reference { get; set; }\n    public virtual Customer Customer { get; set; }\n    public virtual DateTime CreationDate { get; set; }\n    public virtual decimal Total { get; set; }\n    public virtual IList&lt;EstimationItem&gt; EstimationItems { get; set; }\n}\n\npublic class EstimationItem\n{\n    public virtual decimal Price { get; set; }\n    public virtual int Quantity { get; set; }\n    public virtual Estimation Estimation { get; set; }\n    public virtual Product Product { get; set; }\n}\n\npublic class EstimationWithDetail\n{\n    public string Reference { get; set; }       //Estimation.Reference\n    public string FullName { get; set; }        //concat FirstName and LastName from Customer\n    public decimal Price { get; set; }          //Estimation.Total\n    public int Id { get; set; }                 //Estimation.Id\n    public DateTime CreationDate { get; set; }  //Estimation.CreationDate\n}\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>I tried the code but I get this error : \n<em>InvalidOperarionException, variable 'x' of type 'EstimationItem' referenced from scope '', but it is not defined</em></p>\n\n<pre><code>var res =\n    Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinQueryOver(x =&gt; x.Estimation)\n    .Select(x =&gt; new EstimationWithDetail\n    {\n        Code = x.Estimation.Reference,\n        CreationDate = x.Estimation.CreationDate,\n        Price = x.Estimation.Total,\n        FullName = x.Estimation.Customer.FirstName + x.Estimation.Customer.LastName\n    })\n    .List&lt;EstimationWithDetail&gt;();\n</code></pre>\n\n<p><strong>Update 2 :</strong>\nI tried this too</p>\n\n<pre><code>Estimation a = null;\nCustomer b = null;\nvar res = Session.QueryOver&lt;EstimationItem&gt;()\n    .JoinAlias(c =&gt; c.Estimation, () =&gt; a)\n    .JoinAlias(c =&gt; c.Estimation.Customer, () =&gt; b)\n    .Select(x =&gt; new EstimationWithDetail\n    {\n        Code = a.Reference,\n        Id = a.Id,\n        FullName = b.LastName\n    })\n    .List&lt;EstimationWithDetail&gt;();\n</code></pre>\n"},{"tags":["c#","asp.net","regex"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2108,"score":0,"question_id":5254197,"title":"format ssn using regex","body":"<p>Hi I need regex in c sharp to display SSN in the format of xxx-xx-6789. i.e 123456789 should be displayed as xxx-xx-6789 in a textfield. The code I am using write now is </p>\n\n<pre><code>string SSN = \"123456789\";\nRegex ssnRegex = new Regex(\"(?:[0-9]{3})(?:[0-9]{2})(?:[0-9]{4})\");\nstring formattedSSN = ssnRegex.Replace(SSN, \"XXX-XX-${last}\");\n</code></pre>\n\n<p>What is correct Reg Expression to mask ssn xxx-xx-6789 ?</p>\n"},{"tags":["c#","outlook","add-in","compose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13276546,"title":"outlook vsto perform custom send message","body":"<p>I have an Outlook add-in that adds a custom Send button to the NewMailMessage tab in the Compose inspector window. When clicking on this custom button I want to perform some modifications to the email being sent before actually sending it out. How do I get a hold of the email from the button click event? In older versions than Outlook 2010, I know you can programmatically get the \"Send\" <code>CommandBar</code> button and call <code>Execute</code> on it to mimic sending the message. However in 2010 and later versions this method has been deprecated. MSDN suggests to implement the IRibbonExtensibility for Ribbon customizations but do I need to do that for my purpose?</p>\n"},{"tags":["c#","types","language-features","c#-5.0","non-nullable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":53,"score":-3,"question_id":13277733,"title":"what are the fundamental problems with having non-nullable reference types in C#?","body":"<p>At this moment there is no such thing as non-nullable types in C#. It is quite obvious that as any other feature it takes time and money to get it developed. No questions here. However I can see a lot of benefits in having it. One of the most obvious one is eliminating the need for null checks and leaving little-to-no chance for null reference exceptions. So assuming I am right, is there a fundamental problem that makes this feature too expensive to add to C#? If so, what is it?</p>\n"},{"tags":["c#",".net","visual-studio-2010","properties","designer"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1798,"score":3,"question_id":7437004,"title":"How to make a User control property of type Collection<MyClass> editable in Form Designer?","body":"<p>Today at work, I stumbled upon a problem that was driving me nuts.</p>\n\n<p>Basically my goal is this:</p>\n\n<p>I have a <code>UserControl1</code>, with a field of the type <code>Collection&lt;Class1&gt;</code> and a corresponding property <code>Collection&lt;Class1&gt; Prop</code>. Like this:</p>\n\n<pre><code>public class UserControl1 : UserControl\n{\n    private Collection&lt;Class1> field = null;\n    // later changed to:\n    //private Collection&lt;Class1> field = new Collection&lt;Class1>();\n    [Category(\"Data\")]\n    [DefaultValue(null)]\n    [Description(\"asdf\")]\n    public Collection&lt;Class1> prop\n    {\n        get { return field; }\n        set { field = value; }\n    }\n}</code></pre>\n\n<pre><code>// later added:\n//[Serializable]\npublic class Class1\n{\n    private bool booltest; public bool Booltest { get...set...}\n    private int inttest; public int Inttest { get...set...}\n}</code></pre>\n\n<p><b>If you already know what I screwed up: no need to read the rest.</b> I am going to describe what exactly I did.</p>\n\n<p>Now I put the <code>UserControl</code> onto a random Form and change the <code>Prop</code> property. A generic \"Collection Editor\" appears, like the one used for the columns and groups in a listview control. I can enter data as expected. However, when I click OK, the data is gone.</p>\n\n<p>It took me over hour to figure out that I actually have to instantiate my field: <code>private Collection&lt;MyClass&gt; field = new Collection&lt;MyClass&gt;();</code>. Very good, only that the designer entered superspazzing mode. Cascading nightmare error message that can be reduced to: \"You must put <code>[Serializable]</code> before your <code>Class1</code>.\" After doing that I could actually put my <code>UserControl1</code> on the Form again.</p>\n\n<p>But that only works once. When opening the designer of the Form where I use the <code>UserControl1</code> after editing something, it gives me an error:</p>\n\n<p><code>Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'.</code></p>\n\n<p>Well. The Error List says:</p>\n\n<p><code>Warning: ResX file Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'. Line 134, position 5. cannot be parsed.</code></p>\n\n<p>The designer tries to fetch the Property's data from the resx file. Removing the resx file \"solves\" that exactly once.</p>\n\n<p>The Form can now be displayed again, with my <code>UserControl1</code>. The Collection property <em>is</em> editable, and it is being saved. It actually works. Once. Whenever I change something and then try to open the Form's designer again, the above error occurs again. I can delete the resx file, but that will of course also delete my data.</p>\n\n<p>Relevant resources that helped me so far (among a ton of not so helpful search results):</p>\n\n<p><a href=\"http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1\" rel=\"nofollow\">http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1</a><br>\n<a href=\"http://www.codeproject.com/KB/cs/propertyeditor.aspx\" rel=\"nofollow\">http://www.codeproject.com/KB/cs/propertyeditor.aspx</a><br>\n<a href=\"http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94\" rel=\"nofollow\">http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94</a><br>\n<a href=\"http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx</a><br></p>\n\n<p>(I also tried implementing ISerializable and overriding GetObjectData with</p>\n\n<p><code>{ info.AddValue(\"testbool\", testbool); info.AddValue(\"testint\", testint); }</code></p>\n\n<p>didn't help either (I also tried the property names instead of the field names))</p>\n\n<p>Sorry for writing this like a bad horror novel btw.</p>\n"},{"tags":["c#","wpf","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13278426,"title":"WPF -- property is null when next page is shown","body":"<p>I'm having an issue where on my listview, when I select an item, the row highlight and the value for the property does get set. But when I click on the button to show the second page, the listview isnt highlighted/selected from the previous. The property is null. The two listview on each page reference the same properties for itemsource and selecteditem. Can anyone help me on why second page doesnt trigger property?</p>\n\n<p>MainWindow.xaml</p>\n\n<pre><code>    &lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"5\"&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition Width=\"auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Button Name=\"btnPrevious\" Content=\"&amp;lt;\" Grid.Column=\"0\" Height=\"300\" Click=\"btnPrevious_Click\"&gt;&lt;/Button&gt;\n        &lt;Grid Width=\"310\" Height=\"300\" Grid.Column=\"2\"&gt;\n            &lt;Frame x:Name=\"UserControlContainer\" NavigationUIVisibility=\"Hidden\" Width=\"310\" /&gt;\n        &lt;/Grid&gt;\n        &lt;Button Name=\"btnNext\" Content=\"&amp;gt;\" Grid.Column=\"4\" Height=\"300\" Click=\"btnNext_Click\"&gt;&lt;/Button&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>MainWindow.xaml.cs</p>\n\n<pre><code>public partial class MainWindow : UserControl\n    {\n        private FirstPage fPage;\n        private SecondPage sPage;\n\n        private static int oldIndex = 1;\n\n        public FirstPage FPage\n        {\n            get\n            {\n                if (fPage == null)\n                    fPage = new FirstPage();\n\n                return fPage;\n            }\n            set\n            {\n                fPage = value;\n            }\n        }\n\n        public SecondPage SPage\n        {\n            get\n            {\n                if (sPage == null)\n                    sPage = new SecondPage();\n\n                return sPage;\n            }\n            set\n            {\n                sPage = value;\n            }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            UserControlContainer.Source = new Uri(\"Views\\\\FirstPage.xaml\", UriKind.Relative);\n        }\n\n        private void btnPrevious_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.FPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 2);\n\n            oldIndex = 2;\n        }\n\n        private void btnNext_Click(object sender, RoutedEventArgs e)\n        {\n            var content = UserControlContainer.Content as UserControl;\n\n            var targetUserControl = this.SPage as UserControl;\n            targetUserControl.DataContext = this.DataContext;\n\n            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 1);\n\n            oldIndex = 1;\n        }\n    }\n</code></pre>\n\n<p>MainViewModel.cs</p>\n\n<pre><code>public class MainViewModel : INotifyPropertyChanged\n{\n    Dictionary&lt;int, string&gt; itemList;\n    KeyValuePair&lt;int, string&gt;? selectedItemList = null;\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    private void NotifyPropertyChanged(String PropertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));\n        }\n    }\n\n    public Dictionary&lt;int, string&gt; ItemList\n    {\n        get\n        {\n            itemList = GetItemsList();\n            return itemList;\n        }\n    }\n\n    private Dictionary&lt;int, string&gt; GetItemsList()\n    {\n        var resultList = new Dictionary&lt;int, string&gt;();\n\n        resultList.Add(1, \"Item I\");\n        resultList.Add(2, \"Item II\");\n        resultList.Add(3, \"Item III\");\n\n        return resultList;\n    }\n\n    public KeyValuePair&lt;int, string&gt;? SelectedItemList\n    {\n        get \n        { \n            return selectedItemList; \n        }\n        set\n        {\n            selectedItemList = value;\n            NotifyPropertyChanged(\"SelectedNewPtLevel\");\n        }\n    }\n}\n</code></pre>\n\n<p>FirstPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstFirst\" HorizontalAlignment=\"Left\"  \n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Yellow\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>SecondPage.xaml</p>\n\n<pre><code>&lt;UserControl.DataContext&gt;\n        &lt;vm:MainViewModel /&gt;\n    &lt;/UserControl.DataContext&gt;\n\n    &lt;Grid&gt;\n        &lt;ListView Name=\"lstSecond\" HorizontalAlignment=\"Left\"\n                    Height=\"auto\" ItemsSource=\"{Binding Path=ItemList}\" SelectedItem=\"{Binding Path=SelectedItemList}\" \n                    FontSize=\"11\" SelectionMode=\"Single\" Width=\"310\"&gt;\n            &lt;ListView.ItemContainerStyle&gt;\n                &lt;Style TargetType=\"ListViewItem\"&gt;\n                    &lt;Style.Triggers&gt;\n                        &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                            &lt;Setter Property=\"Background\" Value=\"Pink\"&gt;&lt;/Setter&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                &lt;/Style&gt;\n            &lt;/ListView.ItemContainerStyle&gt;\n            &lt;ListView.View&gt;\n                &lt;GridView&gt;\n                    &lt;GridView.ColumnHeaderContainerStyle&gt;\n                        &lt;Style&gt;\n                            &lt;Setter Property=\"FrameworkElement.Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;/Style&gt;\n                    &lt;/GridView.ColumnHeaderContainerStyle&gt;\n                    &lt;GridViewColumn Width=\"69\" DisplayMemberBinding=\"{Binding Key}\"&gt;&lt;/GridViewColumn&gt;\n                    &lt;GridViewColumn Width=\"109\" DisplayMemberBinding=\"{Binding Value}\"&gt;&lt;/GridViewColumn&gt;\n                &lt;/GridView&gt;\n            &lt;/ListView.View&gt;\n        &lt;/ListView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n"},{"tags":["c#","concurrency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13277908,"title":"Does using ConcurrentDictionary TryGetValue within an if statement make the if contents thread-safe?","body":"<p>If I have a ConcurrentDictionary and use the TryGetValue within an if statement, does this make the if statement's contents thread safe? Or must you lock still within the if statement?</p>\n\n<p>Example:</p>\n\n<pre><code>        ConcurrentDictionary&lt;Guid, Client&gt; m_Clients;\n\n        Client client;\n        //Does this if make the contents within it thread-safe? \n        if (m_Clients.TryGetValue(clientGUID, out client))\n        {\n            //Users is a list.\n            client.Users.Add(item);\n        }\n</code></pre>\n\n<p>or do I have to do:</p>\n\n<pre><code>        ConcurrentDictionary&lt;Guid, Client&gt; m_Clients;\n\n        Client client;\n        //Does this if make the contents within it thread-safe? \n        if (m_Clients.TryGetValue(clientGUID, out client))\n        {\n            lock (client)\n            {\n                //Users is a list.\n                client.Users.Add(item);\n            }\n        }\n</code></pre>\n"},{"tags":["c#","java","uml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13277867,"title":"Showing a recursive method with UML","body":"<p>Is there a way to show a recursive method with UML class diagram modelling?</p>\n\n<p><img src=\"http://i.stack.imgur.com/BztHs.jpg\" alt=\"class diagram\">\n<br/><br/>\nIn the above class I have a static method Calculate and I want to show that this method alone calls itself recursively and not any other methods or the class. How do I show this in UML?</p>\n"},{"tags":["c#","servicestack","ormlite-servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12548228,"title":"Is using GetLastInsertId safe for Web Application?","body":"<p>Is this code safe in web application!</p>\n\n<pre><code>public Insert(Student s)\n{\n    con.Save&lt;Student&gt;(s);\n    s.Id=con.GetLastInsertId();\n}\n</code></pre>\n\n<p>I've investigated code of servicestack ormlite </p>\n\n<pre><code>public override long GetLastInsertId(IDbCommand dbCmd)\n{\n    dbCmd.CommandText = \"SELECT SCOPE_IDENTITY()\";\n    return dbCmd.GetLongScalar();\n}\n</code></pre>\n\n<p>So is it big trap for beginners? </p>\n\n<p>And how can we get filled Student instance like EF does? (Only Id must be filled)</p>\n"},{"tags":["c#","objective-c","ios","multidimensional-array"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":51,"score":-3,"question_id":13278272,"title":"iOs's C# Array.GetLength(int dimension) equivalent?","body":"<p>I believe the title says it all.</p>\n\n<p>How to get multidimensional array, dimension one, length (in objective c)?</p>\n\n<p>In C# it's:</p>\n\n<pre><code>Array.GetLength(int dimension)\n</code></pre>\n\n<p>I am looking for the exact equivalent of something like this:</p>\n\n<pre><code>int[10,4] mda = new int[10,4];\nint A = mda.GetLength(1);\n//A=4\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I know that there are ways to get this without using built in functions..</p>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["c#","visual-studio-2012","visual-studio-debugging"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12934271,"title":"Visual Studio 2012 random debugger startup failure: Unable to start program","body":"<p>I have a managed startup project and quite often when I press F5 the Visual Studio complains with dialog \"Unable to start program '...\\test.exe'\" (no additional information). The process test.exe is actually started in the background but when I try to attach the debugger to it, VS complains that debugger is already attached. To be able to debug again I have to manually kill the test.exe process and restart the VS. I run VS as Administrator. Thanks!</p>\n\n<p>Important information:</p>\n\n<ol>\n<li>Running on Windows Server 2008 x64.</li>\n<li>Application is x64.</li>\n<li>Running VS as Administrator.</li>\n</ol>\n"},{"tags":["c#",".net","wpf","mvvm","avalonedit"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":292,"score":2,"question_id":12344367,"title":"Making AvalonEdit MVVM compatible","body":"<p>I'm trying to make Avalon MVVM compatible in my WPF application. From googling, I found out that <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">AvalonEdit is not MVVM friendly</a> and I need to export the state of AvalonEdit by making a class derived from TextEditor then adding the necessary dependency properties. I'm afraid that I'm quite lost in Herr Grunwald's answer <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>If you really need to export the state of the editor using MVVM, then I suggest you create a class deriving from TextEditor which adds the necessary dependency properties and synchronizes them with the actual properties in AvalonEdit.</p>\n</blockquote>\n\n<p>Does anyone have an example or have good suggestions on how to achieve this?</p>\n"},{"tags":["c#","xaml","crash","windows-8"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":111,"score":2,"question_id":13215425,"title":"How to handle a Windows 8 XAML/C# app crash","body":"<p>I've got a Windows 8 app in the store right now and it's been certified for Windows 8 and Windows RT devices. Also, in my Windows Store dashboard, no crashes are shown. For some reason, though, a commenter who reviewed my app says that it crashes on launch in Windows RT, and I have no way to test that (I don't have a Windows RT device).</p>\n\n<p>To help diagnose the problem, I've decided to create a crash page which would launch if the app crashed the last time it opened. Is there a way to set some variables right before an app crashes? That way I could, say, create a variable \"recoverymode\" that would launch a page asking for more information the next time the app is launched. Or is there some way to do this for Windows 8 apps that I'm not aware of that will automatically send me crash data?</p>\n"},{"tags":["c#","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278558,"title":"How to send parameters to scoreboard","body":"<p>On the application I'm building for a cyclist race, where as cyclists go over the finish line, I have to enter the time (hours, mins, secs) and click the finish button. Once I click the finish button, I want this information to be displayed in lblScoreboard as:</p>\n\n<p>Competitive cyclist No. 1 has completed in 1:23:49</p>\n\n<p>Then as another cyclists time has been entered, the lblScoreboard should look like:</p>\n\n<p>Competitive cyclist No. 1 has completed in 1:23:49<br>Competitive cyclist No. 9 has completed in 1:20:30</p>\n\n<p>The code I've used in my 'Finished' button is:</p>\n\n<pre><code>lblCyclistsFinished.Text = finishLine.Scoreboard(currentCyc);\n</code></pre>\n\n<p>and the code behind the FinishLine class is:</p>\n\n<pre><code>class FinishLine\n{\n    public string Scoreboard(Cyclists cyc)\n    {\n        String msg;\n\n        msg = cyc.ToString();\n\n        return msg;\n    }\n}\n</code></pre>\n\n<p>However, with the code in FinishLine, it will display one result, but as soon as I enter a new result; it replaces the first one so there's only ever 1 result displayed.</p>\n\n<p>The information I want passed is: Type + \"No. \" + Number + \" has completed in \" + Hours + \":\" + Mins + \":\" + Secs;</p>\n"},{"tags":["c#","asp.net","validation","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13278303,"title":"Styling multiple validation controls","body":"<p>I'm using the validation controls (namely <code>RequiredFieldValidator</code> and <code>RegularExpressionValidator</code>) and am having a bit of trouble getting them to style correctly.</p>\n\n<p>The problem is that because I have markup like this:</p>\n\n<pre><code>&lt;asp:RequiredFieldValidator ID=\"EmailRequiredValidator\" ControlToValidate=\"Email\" ErrorMessage=\"Email field is required\" runat=\"server\"&gt;&lt;/asp:RequiredFieldValidator&gt;\n&lt;asp:RegularExpressionValidator ID=\"EmailFormatValidator\" ControlToValidate=\"Email\" ValidationExpression=\"^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,4})$\" runat=\"server\" ErrorMessage=\"Invalid email address\"&gt;&lt;/asp:RegularExpressionValidator&gt;\n</code></pre>\n\n<p>the <code>RegularExpressionValidator</code> gets pushed over to the side because the <code>RegularExpressionValidator</code> is in the way. Perhaps a graphical representation will help:</p>\n\n<p><img src=\"http://i.stack.imgur.com/yavUp.png\" alt=\"The problem\"></p>\n\n<p>The \"Invalid email address\" error label is meant to be right next to the input box, but the other validator pushes it to the side.</p>\n\n<p>How can I make the validators invisible until they fire an error message or make them float on top of one another?</p>\n"},{"tags":["c#","powershell"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":657,"score":0,"question_id":7917873,"title":"Calling Powershell from C# and handling exception","body":"<p>I am calling Powershell scripts from C# using Process.Start(). How do I capture exceptions that are raised by the Powershell script in the C# code?</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13278170,"title":"Parse datetime string in the format \"Nov. 7, 2012, 9:02 p.m.\"","body":"<p>How can I parse a date string in the format \"Nov. 7, 2012, 9:02 p.m.\"</p>\n\n<p>I think I'm close. Have tried:</p>\n\n<pre><code>        string line = \"Nov. 7, 2012, 9:02 p.m.\";\n        string format = \"MMM. dd, yyyy, hh:mm p.m.\"; ;\n        DateTime result = DateTime.ParseExact(line, format, null);\n</code></pre>\n"},{"tags":["c#","visual-studio-2008","syntax-error","underline"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":10915455,"title":"Visual Studio 2008 underlining non-error code in red","body":"<p>I have a large C# project in Visual Studio 2008, and nearly half my project is underlined in red errors, most of them are \"Undeclared element\"; the project compiles, builds, debugs, and runs fine, no errors.</p>\n\n<p>I can also type a legitimate error, and it doesn't underline the error, for instance if I write strong.Format() instead of string.Format, it doesn't underline strong????, but it will underline the Format, in string.Format and tell me undeclared element, it makes no sense.</p>\n\n<p>Similar to question:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/9729621/visual-studio-2010-improperly-underlining-code-comments-with-red-error-line-when\">Visual Studio 2010 Improperly underlining code/comments with red error line when there is no error</a></li>\n</ul>\n\n<p>But he never got an answer, and this is VS 2008 and C# instead of VS 2010 and C++</p>\n"},{"tags":["c#","wpf","xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":54,"score":-6,"question_id":13277692,"title":"Is a Database or XML file better for storing information?","body":"<p>I have some information that needs be stored.  These are \"default values\" for certain inputs that are contained in the program.</p>\n\n<p>Would it be better to store this information in a Database or an XML file?  Which is faster?</p>\n\n<p>Currently there are 2 versions of the program that I am re-writing.  1 version uses an XML file and the other uses an Access database.</p>\n\n<p>What do you think is the best one?</p>\n"},{"tags":["c#","windows-7","taskbar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13275763,"title":"How to change the name of your program in C# when clicking and dragging up from the taskbar?","body":"<p>Ok. So in windows 7 you know how you have the icons of open programs. Well when i click and drag up on my C# Windows Form application it says \"WindowsFormApplication3\" When in every possible file in Visual Studio i changed it to the name of my program. And even in task manager it shows my name of the program. How can i change this name that shows when clicking and dragging up from my programs icon in the taskbar?</p>\n"},{"tags":["c#","wcf","rest","stream","basichttpbinding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13278487,"title":"WCF MemoryStream data corruption issue","body":"<p>I have created a simple REST based WCF service which runs on BasicHttpBinding. In one of my webmethod, I am  returning a Stream which points to a JSON response. </p>\n\n<p>The Method looks like : </p>\n\n<pre><code>[OperationContract]\n        [FaultContract(typeof(ApplicationFault))]\n        [WebInvoke(Method = \"POST\", UriTemplate = \"GetActiveCalls/{nurseid}\")]\n        Stream GetActiveCalls(string nurseid);\n</code></pre>\n\n<p>From the body of the GetActiveCalls, I am creating an object of MemoryStream and returning the same as response. The code looks like  </p>\n\n<pre><code>// Serialize the results as JSON\n                string jsonResult = new JavaScriptSerializer().Serialize(baseResponses);\n\n// ContentType json\nWebOperationContext.Current.OutgoingResponse.ContentType = \"application/json\";\n                WebOperationContext.Current.OutgoingResponse.Headers.Add(\"Cache-Control\", \"no-cache\");\n                var bytes = Encoding.UTF8.GetBytes(jsonResult);\n                //Parse to memorystream\n                var ms = new MemoryStream(bytes);\n                ms.Seek(0, SeekOrigin.Begin);\n                ms.SetLength(bytes.LongLength);\n                return ms;\n</code></pre>\n\n<p>When trying this from client, I get result like</p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Status\":true}</p>\n\n<p>But sometimes after invoking the same method for multiple times, I start getting the response as : </p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Statu{\"LastEv</p>\n\n<p>You can see after \"Statu on the JSON response, the stream gets reset and starts getting data from the beginning. </p>\n\n<p>It looks strange to me. Can someone point to if I am missing something. </p>\n\n<p>*From server side, when I put breakpoint, it seems the MemoryStream has correct response.</p>\n"},{"tags":["c#","wpf","splash-screen","timespan","eventlistener"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":137,"score":8,"question_id":13213625,"title":"SplashScreen.Close(Timespan.FromMilliseconds(int)) : Is there an Event dispatched at Timespan Complete?","body":"<p>C# WPF Application</p>\n\n<p>I have a <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.aspx\" rel=\"nofollow\">SplashScreen</a> being displayed at startup for a minimum amount of time by using</p>\n\n<pre><code>Thread.Sleep(int); //int = milliseconds to display splash screen\n</code></pre>\n\n<p>When that sleep time is reached, the code resumes and the SplashScreen fades out to close by using</p>\n\n<pre><code>SplashScreen.Close(Timespan.FromMilliseconds(int)); //int = milliseconds fade-out\n</code></pre>\n\n<p>I would like to pause at this point to wait until the SplashScreen has become 100% transparent and is fully closed, then continue with other tasks, I.E. Writiting to the Console or displaying a MainWindow. </p>\n\n<p>Is there an event fired when the (TimeSpan.FromMilliseconds(int)) is complete?\nAny other suggestions?</p>\n\n<pre><code>namespace StartupSplash\n{\n    public class SplashScreenStartup\n    {\n        //IMPORTANT:set image property to Resource and NOT Splash Screen\n        private SplashScreen Splash = new SplashScreen(\"Resources/SplashScreen.png\");\n\n        public void SplashScreenStartUp()\n        {\n            Splash.Show(false, true);\n            Thread.Sleep(3000); // Pause code, display splash screen 3 seconds\n            Splash.Close(TimeSpan.FromMilliseconds(3000)); // 3 second splash fade-out\n            // I want to wait until splash screen fadeOut has completed before\n            // this next console output is performed.\n            Console.WriteLine(\"Executes before Splash fadeOut completes.\");\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","facebook","facebook-c#-sdk"],"answer_count":3,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":9242,"score":12,"question_id":5171309,"title":"Facebook C# SDK and Access Token","body":"<p>I'd like to be able to authenticate myself <strong>(my profile, not just my app)</strong> on my own web application using the Facebook C# SDK. Using the Graph API, I can get an access token, but that token does not seem to work properly with the Facebook C# as it seems to be stateless.</p>\n\n<p>The error that is thrown is:</p>\n\n<pre><code>(OAuthException) An active access token must be used to query information about the current user.\n</code></pre>\n\n<p>I've poked around the Facebook C# SDK and documentation and most of the info I'm seeing is to redirect users to a login page which is not what I'm looking for.</p>\n\n<p>Does anyone have a good sample of auto-logging in myself so I can pull up my own information?</p>\n\n<p>TIA</p>\n"},{"tags":["c#","asp.net","validation","dynamic-data"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13278422,"title":"Dynamic Data on Entity Framework custom validation using partial methods","body":"<p>I'm using <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">Dynamic Data</a> and am trying to write custom validation using partial-class method. I've created an ASP.NET Dynamic Data Enties Web Application and added an ADO.NET Entity Data Model to it. I'm using the Customers table from the Northwind database.</p>\n\n<p>I'm simply using an example almost the same as what's supplied on the <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN page</a>.</p>\n\n<pre><code>public partial class Customer\n{\n    partial void OnContactTitleChanging(string value)\n    {\n        if (value != null &amp;&amp; value.Length &gt; 1 &amp;&amp; !Char.IsUpper(value[0]))\n            throw new ValidationException(\n            \"Title must start with uppercase letter\");\n    }\n}\n</code></pre>\n\n<p>This seems to work fine, as I can't change a ContactTitle to a value starting with a lowercase letter. </p>\n\n<p>But...</p>\n\n<p>In my database, a record already exists that doesn't start with an uppercase letter. When just listing the current records, the method is already being executed, resulting in the Exception being thrown. <em>(and because I wasn't actually editing anything, there is no DynamicValidator control on the page, and the exception isn't caught)</em></p>\n\n<p>If I use SQL to LINQ Classes in stead of Entity Framework, listing invalid records is no problem. But when I try to edit the incorrect ContactTitle and click Update, the <code>OnContactTitleChanging</code> method is being executed twice. Once with the new <code>value</code>, which is ok, but then once again with the original value, which results in the exception being thrown after all.</p>\n\n<p>Am I missing something here? Is the example on <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN</a> too simple?</p>\n"},{"tags":["c#","reflection","collections"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13277981,"title":"Create a list of types in C#","body":"<p>I'd like to create a list of types, each of which must implement a particular interface.  Like:</p>\n\n<pre><code>interface IBase { }\ninterface IDerived1 : IBase { }\ninterface IDerived2 : IBase { }\n\nclass HasATypeList\n{\n    List&lt;typeof(IBase)&gt; items;\n    HasATypeList()\n    {\n        items.Add(typeof(IDerived1));\n    }\n\n}\n</code></pre>\n\n<p>So I know I can do</p>\n\n<pre><code>List&lt;Type&gt; items;\n</code></pre>\n\n<p>But that won't limit the allowable types in the list to ones that implement IBase.  Do I have to write my own list class?  Not that it's a big deal, but if I don't have to...</p>\n"},{"tags":["c#","wpf","xaml","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278040,"title":"Datagrid RowDetails not being updated","body":"<p>I'm having a problem getting the <code>RowDetailsTemplate</code> to update when modifying the collection (\"Items\") that a <code>DataGrid</code> is bound to.  The collection is being modified from within a view model.  When I modify the <i>contents</i> of one of the bound items, the change is updated in both the DataGridRow and RowDetailsTemplate.  E.g.</p>\n\n<pre><code>Items[i].Name = \"new name\";  // RowDetailsTemplate gets updated\n</code></pre>\n\n<p><b>But</b> if I assign one of the items to a totally new object the DataGridRow updated, but the RowDetailsTemplate doesn't get updated. E.g.</p>\n\n<pre><code>Items[i] = new Model {Name = \"new name\"};  // RowDetailsTemplate NOT updated\n</code></pre>\n\n<p>The only thing I thought at first was that I needed to add a listener to the CollectionChanged event of the bound Items and explicitly raise a property change notification. E.g</p>\n\n<pre><code>Items = new ObeservableCollection&lt;Model&gt;();\nItems.CollectionChanged += (o,e) =&gt; OnNotifyPropertyChanged(\"Items\");\n</code></pre>\n\n<p>but that didn't work.</p>\n\n<p>My XAML bindings look like this:</p>\n\n<pre><code>&lt;DataGrid DataContext=\"{StaticResource viewmodel}\" \n          ItemsSource=\"{Binding Items, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"&gt;\n  &lt;DataGrid.RowDetailsTemplate&gt;\n    &lt;DataTemplate&gt;\n      &lt;TextBlock Text=\"{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"/&gt;\n    &lt;/DataTemplate&gt;\n  &lt;/DataGrid.RowDetailsTemplate&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Why is the <code>DataGridRow</code> notified of the changed Item but not the <code>RowDetailsTemplate</code>?!</p>\n\n<p><b>Update</b>\nDoing a delete/add instead of modifying the collection works.  E.g.</p>\n\n<pre><code>Items.Remove(Items[i]);\nItems.Add (new Model {Name = \"new name\"});  // RowDetailsTemplate updated OK\n</code></pre>\n\n<p>(Oh and the Model class of course implements <code>INotifyPropertyChanged</code>.)</p>\n\n<p>Seems like this might be an issue where I need to refresh the DataContext of the details view?  </p>\n"}]}
{"total":375450,"page":11,"pagesize":100,"questions":[{"tags":["c#","visual-studio-2008","syntax-error","underline"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":10915455,"title":"Visual Studio 2008 underlining non-error code in red","body":"<p>I have a large C# project in Visual Studio 2008, and nearly half my project is underlined in red errors, most of them are \"Undeclared element\"; the project compiles, builds, debugs, and runs fine, no errors.</p>\n\n<p>I can also type a legitimate error, and it doesn't underline the error, for instance if I write strong.Format() instead of string.Format, it doesn't underline strong????, but it will underline the Format, in string.Format and tell me undeclared element, it makes no sense.</p>\n\n<p>Similar to question:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/9729621/visual-studio-2010-improperly-underlining-code-comments-with-red-error-line-when\">Visual Studio 2010 Improperly underlining code/comments with red error line when there is no error</a></li>\n</ul>\n\n<p>But he never got an answer, and this is VS 2008 and C# instead of VS 2010 and C++</p>\n"},{"tags":["c#","wpf","xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":54,"score":-6,"question_id":13277692,"title":"Is a Database or XML file better for storing information?","body":"<p>I have some information that needs be stored.  These are \"default values\" for certain inputs that are contained in the program.</p>\n\n<p>Would it be better to store this information in a Database or an XML file?  Which is faster?</p>\n\n<p>Currently there are 2 versions of the program that I am re-writing.  1 version uses an XML file and the other uses an Access database.</p>\n\n<p>What do you think is the best one?</p>\n"},{"tags":["c#","windows-7","taskbar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13275763,"title":"How to change the name of your program in C# when clicking and dragging up from the taskbar?","body":"<p>Ok. So in windows 7 you know how you have the icons of open programs. Well when i click and drag up on my C# Windows Form application it says \"WindowsFormApplication3\" When in every possible file in Visual Studio i changed it to the name of my program. And even in task manager it shows my name of the program. How can i change this name that shows when clicking and dragging up from my programs icon in the taskbar?</p>\n"},{"tags":["c#","wcf","rest","stream","basichttpbinding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13278487,"title":"WCF MemoryStream data corruption issue","body":"<p>I have created a simple REST based WCF service which runs on BasicHttpBinding. In one of my webmethod, I am  returning a Stream which points to a JSON response. </p>\n\n<p>The Method looks like : </p>\n\n<pre><code>[OperationContract]\n        [FaultContract(typeof(ApplicationFault))]\n        [WebInvoke(Method = \"POST\", UriTemplate = \"GetActiveCalls/{nurseid}\")]\n        Stream GetActiveCalls(string nurseid);\n</code></pre>\n\n<p>From the body of the GetActiveCalls, I am creating an object of MemoryStream and returning the same as response. The code looks like  </p>\n\n<pre><code>// Serialize the results as JSON\n                string jsonResult = new JavaScriptSerializer().Serialize(baseResponses);\n\n// ContentType json\nWebOperationContext.Current.OutgoingResponse.ContentType = \"application/json\";\n                WebOperationContext.Current.OutgoingResponse.Headers.Add(\"Cache-Control\", \"no-cache\");\n                var bytes = Encoding.UTF8.GetBytes(jsonResult);\n                //Parse to memorystream\n                var ms = new MemoryStream(bytes);\n                ms.Seek(0, SeekOrigin.Begin);\n                ms.SetLength(bytes.LongLength);\n                return ms;\n</code></pre>\n\n<p>When trying this from client, I get result like</p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Status\":true}</p>\n\n<p>But sometimes after invoking the same method for multiple times, I start getting the response as : </p>\n\n<p>{\"LastEvents\":[{\"FormatValues\":\"Klic 2 3 4\",\"Icon\":null,\"Color\":\"Red\",\"Acknowledged\":false,\"EventID\":28566}],\"Message\":\"\",\"Statu{\"LastEv</p>\n\n<p>You can see after \"Statu on the JSON response, the stream gets reset and starts getting data from the beginning. </p>\n\n<p>It looks strange to me. Can someone point to if I am missing something. </p>\n\n<p>*From server side, when I put breakpoint, it seems the MemoryStream has correct response.</p>\n"},{"tags":["c#","wpf","splash-screen","timespan","eventlistener"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":137,"score":8,"question_id":13213625,"title":"SplashScreen.Close(Timespan.FromMilliseconds(int)) : Is there an Event dispatched at Timespan Complete?","body":"<p>C# WPF Application</p>\n\n<p>I have a <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.aspx\" rel=\"nofollow\">SplashScreen</a> being displayed at startup for a minimum amount of time by using</p>\n\n<pre><code>Thread.Sleep(int); //int = milliseconds to display splash screen\n</code></pre>\n\n<p>When that sleep time is reached, the code resumes and the SplashScreen fades out to close by using</p>\n\n<pre><code>SplashScreen.Close(Timespan.FromMilliseconds(int)); //int = milliseconds fade-out\n</code></pre>\n\n<p>I would like to pause at this point to wait until the SplashScreen has become 100% transparent and is fully closed, then continue with other tasks, I.E. Writiting to the Console or displaying a MainWindow. </p>\n\n<p>Is there an event fired when the (TimeSpan.FromMilliseconds(int)) is complete?\nAny other suggestions?</p>\n\n<pre><code>namespace StartupSplash\n{\n    public class SplashScreenStartup\n    {\n        //IMPORTANT:set image property to Resource and NOT Splash Screen\n        private SplashScreen Splash = new SplashScreen(\"Resources/SplashScreen.png\");\n\n        public void SplashScreenStartUp()\n        {\n            Splash.Show(false, true);\n            Thread.Sleep(3000); // Pause code, display splash screen 3 seconds\n            Splash.Close(TimeSpan.FromMilliseconds(3000)); // 3 second splash fade-out\n            // I want to wait until splash screen fadeOut has completed before\n            // this next console output is performed.\n            Console.WriteLine(\"Executes before Splash fadeOut completes.\");\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","facebook","facebook-c#-sdk"],"answer_count":3,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":9242,"score":12,"question_id":5171309,"title":"Facebook C# SDK and Access Token","body":"<p>I'd like to be able to authenticate myself <strong>(my profile, not just my app)</strong> on my own web application using the Facebook C# SDK. Using the Graph API, I can get an access token, but that token does not seem to work properly with the Facebook C# as it seems to be stateless.</p>\n\n<p>The error that is thrown is:</p>\n\n<pre><code>(OAuthException) An active access token must be used to query information about the current user.\n</code></pre>\n\n<p>I've poked around the Facebook C# SDK and documentation and most of the info I'm seeing is to redirect users to a login page which is not what I'm looking for.</p>\n\n<p>Does anyone have a good sample of auto-logging in myself so I can pull up my own information?</p>\n\n<p>TIA</p>\n"},{"tags":["c#","asp.net","validation","dynamic-data"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13278422,"title":"Dynamic Data on Entity Framework custom validation using partial methods","body":"<p>I'm using <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">Dynamic Data</a> and am trying to write custom validation using partial-class method. I've created an ASP.NET Dynamic Data Enties Web Application and added an ADO.NET Entity Data Model to it. I'm using the Customers table from the Northwind database.</p>\n\n<p>I'm simply using an example almost the same as what's supplied on the <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN page</a>.</p>\n\n<pre><code>public partial class Customer\n{\n    partial void OnContactTitleChanging(string value)\n    {\n        if (value != null &amp;&amp; value.Length &gt; 1 &amp;&amp; !Char.IsUpper(value[0]))\n            throw new ValidationException(\n            \"Title must start with uppercase letter\");\n    }\n}\n</code></pre>\n\n<p>This seems to work fine, as I can't change a ContactTitle to a value starting with a lowercase letter. </p>\n\n<p>But...</p>\n\n<p>In my database, a record already exists that doesn't start with an uppercase letter. When just listing the current records, the method is already being executed, resulting in the Exception being thrown. <em>(and because I wasn't actually editing anything, there is no DynamicValidator control on the page, and the exception isn't caught)</em></p>\n\n<p>If I use SQL to LINQ Classes in stead of Entity Framework, listing invalid records is no problem. But when I try to edit the incorrect ContactTitle and click Update, the <code>OnContactTitleChanging</code> method is being executed twice. Once with the new <code>value</code>, which is ok, but then once again with the original value, which results in the exception being thrown after all.</p>\n\n<p>Am I missing something here? Is the example on <a href=\"http://msdn.microsoft.com/en-us/library/cc488527.aspx\" rel=\"nofollow\">MSDN</a> too simple?</p>\n"},{"tags":["c#","reflection","collections"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13277981,"title":"Create a list of types in C#","body":"<p>I'd like to create a list of types, each of which must implement a particular interface.  Like:</p>\n\n<pre><code>interface IBase { }\ninterface IDerived1 : IBase { }\ninterface IDerived2 : IBase { }\n\nclass HasATypeList\n{\n    List&lt;typeof(IBase)&gt; items;\n    HasATypeList()\n    {\n        items.Add(typeof(IDerived1));\n    }\n\n}\n</code></pre>\n\n<p>So I know I can do</p>\n\n<pre><code>List&lt;Type&gt; items;\n</code></pre>\n\n<p>But that won't limit the allowable types in the list to ones that implement IBase.  Do I have to write my own list class?  Not that it's a big deal, but if I don't have to...</p>\n"},{"tags":["c#","wpf","xaml","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278040,"title":"Datagrid RowDetails not being updated","body":"<p>I'm having a problem getting the <code>RowDetailsTemplate</code> to update when modifying the collection (\"Items\") that a <code>DataGrid</code> is bound to.  The collection is being modified from within a view model.  When I modify the <i>contents</i> of one of the bound items, the change is updated in both the DataGridRow and RowDetailsTemplate.  E.g.</p>\n\n<pre><code>Items[i].Name = \"new name\";  // RowDetailsTemplate gets updated\n</code></pre>\n\n<p><b>But</b> if I assign one of the items to a totally new object the DataGridRow updated, but the RowDetailsTemplate doesn't get updated. E.g.</p>\n\n<pre><code>Items[i] = new Model {Name = \"new name\"};  // RowDetailsTemplate NOT updated\n</code></pre>\n\n<p>The only thing I thought at first was that I needed to add a listener to the CollectionChanged event of the bound Items and explicitly raise a property change notification. E.g</p>\n\n<pre><code>Items = new ObeservableCollection&lt;Model&gt;();\nItems.CollectionChanged += (o,e) =&gt; OnNotifyPropertyChanged(\"Items\");\n</code></pre>\n\n<p>but that didn't work.</p>\n\n<p>My XAML bindings look like this:</p>\n\n<pre><code>&lt;DataGrid DataContext=\"{StaticResource viewmodel}\" \n          ItemsSource=\"{Binding Items, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"&gt;\n  &lt;DataGrid.RowDetailsTemplate&gt;\n    &lt;DataTemplate&gt;\n      &lt;TextBlock Text=\"{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}\"/&gt;\n    &lt;/DataTemplate&gt;\n  &lt;/DataGrid.RowDetailsTemplate&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>Why is the <code>DataGridRow</code> notified of the changed Item but not the <code>RowDetailsTemplate</code>?!</p>\n\n<p><b>Update</b>\nDoing a delete/add instead of modifying the collection works.  E.g.</p>\n\n<pre><code>Items.Remove(Items[i]);\nItems.Add (new Model {Name = \"new name\"});  // RowDetailsTemplate updated OK\n</code></pre>\n\n<p>(Oh and the Model class of course implements <code>INotifyPropertyChanged</code>.)</p>\n\n<p>Seems like this might be an issue where I need to refresh the DataContext of the details view?  </p>\n"},{"tags":["c#","wpf","wpfdatagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":318,"score":0,"question_id":10257724,"title":"WPF DataGrid - how to set the column headers to have vertical text?","body":"<p>Well, actually rotated -90 degrees from horizontal is what I mean. I need to do this because the text for the header is quite long but the cell value is short, and I want to fit a lot of columns on the screen. Is it possible to do this easily or do I need to learn about resources and templates first? I don't mind a \"hack\" solution!</p>\n"},{"tags":["c#","wpf","datetime","dynamic-data-display"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12937164,"title":"Dynamic Data Display Scattered DateTime Axis","body":"<p>I am trying to chart candlestick markers for a chart of stock prices. I have a marker for every minute of a trading day - 9:30 AM to 4:00 PM. I don't want to display empty space for 4:01 PM to 9:29 AM for each trading day. Is there a way I can remove that time span from my X axis on my graph? I want all the data to look continuous without break in flow. I am using a NumericAxis for my X axis with a TickToDateTimeLabelProvider that I created. Is there a way to change the LabelProvider to fit my needs? Or does it stretch deeper than that? </p>\n\n<p>Here is my code for the LabelProvider:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace Microsoft.Research.DynamicDataDisplay.Charts {\npublic class TickToDateTimeLabelProvider : NumericLabelProviderBase {\n    public override UIElement[] CreateLabels(ITicksInfo&lt;double&gt; ticksInfo) {\n        var res = new TextBlock[ticksInfo.Ticks.Length];\n        for (int i = 0; i &lt; ticksInfo.Ticks.Length; ++i) {\n            long l = (long)ticksInfo.Ticks[i];\n            if (l &lt; 0)\n                l = 0;\n            DateTime dt = new DateTime(l);\n            res[i] = new TextBlock();\n            res[i].Text = dt.ToString();\n        }\n        return res;\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","wpf","mvvm","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13278159,"title":"What is more efficient, a datatable or a custom object?","body":"<p>Normally, when working with data from a database with a forms application, I keep it in a dataset or datatable and pull data out as needed. Now, I am working with WPF and trying to conform more to the MVVM pattern. Converting these datatables to objects make it a little easier to use with MVVM.</p>\n\n<p>For example, if I had a table filled by a query like so -\n<strong>Select p.first_name, p.last_name, p.phone,p.email from person as p where p.first_name = 'Bob'</strong>\nInstead of keeping the datatable, I would just now convert that into a person object.</p>\n\n<p>From a performance standpoint, is there and downfall to making objects or should I stick with datasets and datatables?</p>\n"},{"tags":["c#",".net","office-automation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13172108,"title":"Loading an excel application with a file opened inside a windows .NET client app","body":"<p>How to load an Excel application inside an .NET Windows client application?</p>\n\n<p>The excel application should be hosted in windows form just a like any windows user control.</p>\n\n<p>The loaded excel application will open a excel file created already.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","winforms","messagebox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13277952,"title":"Message Boxes Modal","body":"<p>I've been working at this on and off for a while but essentially I have a class that I call to display message boxes. </p>\n\n<p>I'm trying to get my message boxes to be modal, which is easily done if you specify the form to be modal to. </p>\n\n<p>So my form is declared like this</p>\n\n<pre><code>public partial class MainForm : Form\n</code></pre>\n\n<p>and it is instantiated like this</p>\n\n<pre><code>var mainForm = new MainForm();\n</code></pre>\n\n<p>So I have a class that contains methods which open message boxes like this</p>\n\n<pre><code>MainForm.ActiveForm.Invoke(new MethodInvoker(delegate\n{\n    MessageBox.Show(MainForm.ActiveForm, message, title, buttons, icon);\n}));\n</code></pre>\n\n<p>This works fine, but active form only works when the form is active.....</p>\n\n<p>Anyways is there an easy way around this?</p>\n"},{"tags":["c#","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13276781,"title":"Error attempting to use \"extern alias\" to reference two different DLLs with the same namespace (Visual Studio 2010)","body":"<p>I've read a couple of articles which lead me to believe that it's possible to reference two DLLs with the same namespace in the same project - see <a href=\"http://blogs.msdn.com/b/ansonh/archive/2006/09/27/774692.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/ansonh/archive/2006/09/27/774692.aspx</a>.</p>\n\n<p>However, when I attempt to do this, I run into a couple of issues that I have been unable to resolve.</p>\n\n<p>Here's what I have done:</p>\n\n<ol>\n<li>Create a project for a class library, called V1.Model which has class Model.MyClass.  Sign this assembly.</li>\n<li>Create another project for a class library, called Model, which also has class Model.MyClass.  Sign the assemply.</li>\n<li>Copy the DLLs created from the above two projects into a folder, say Versions, and rename them (V1.Model -> V1.Model.dll, Model -> V2.Model.dll).</li>\n<li>Create a console application project, called Test, which references V1.Model.dll and V2.Model.dll.</li>\n<li>Change the \"Aliases\" property of the reference to V1.Model to \"V1\".</li>\n<li>Change the \"Aliases\" property of the reference to V2.Model to \"V2\".</li>\n<li><p>Create the following code which references both assemplies:</p>\n\n<p>extern alias V1;<br>\nextern alias V2;  </p>\n\n<p>static void Main(string[] args)<br>\n{<br>\n    var v1 = new V1::Model.MyClass();<br>\n    var v2 = new V2::Model.MyClass();<br>\n}  </p></li>\n<li><p>Build and run Test</p></li>\n</ol>\n\n<p>When I do this, there are a couple of issues.  </p>\n\n<p>One, the V1.Model.dll is not copied to the bin directory.  (In fact, if I include many versions of the same namespace, it appears that only the DLL with the most recent version is copied).  Of course, I can workaround this issue by manually copying the dll to the bin directory, but I am curious why this is necessary.  Also, note that I have changed the \"Copy Local\" property to true for both references.</p>\n\n<p>Two, when I run the application, I get the following error: </p>\n\n<blockquote>\n  <p>Could not load file or assembly 'Model, Version=1.0.0.0,\n  Culture=neutral, PublicKeyToken=d89c4561a79dd027' or one of its\n  dependencies. The system cannot find the file specified.</p>\n</blockquote>\n\n<p>Any ideas what I am doing wrong?</p>\n\n<p>Thanks,\nEric</p>\n"},{"tags":["c#","regex"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13278011,"title":"Regular Expression start-end position","body":"<p>I need to make a validation in a string with positional information using regex.</p>\n\n<p>Example:</p>\n\n<pre><code>020005254877841100557810AAAAAA841158891BBBB\n</code></pre>\n\n<p>I need to get match position 5 until 10 and has to be only numbers.</p>\n\n<p>How can I do this using RegEx?</p>\n"},{"tags":["c#","string","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":64,"score":0,"question_id":13277667,"title":"C# string replace does not work","body":"<p>I am trying to replace a part of string with another another string. To be more precise\nI have  <code>C:\\Users\\Desktop\\Project\\bin\\Debug</code></p>\n\n<p>and I am trying to replace <code>\\bin\\Debug</code>  with <code>\\Resources\\People</code></p>\n\n<p>I have tried the following:</p>\n\n<p>a) <code>path.Replace(@\"\\bin\\Debug\", @\"\\Resource\\People\\VisitingFaculty.txt\");</code></p>\n\n<p>b) <code>path.Replace(\"\\\\bin\\\\Debug\", \"\\\\Resource\\\\People\\\\VisitingFaculty.txt\");</code></p>\n\n<p>None of the above three seems to work, as the string remains the same and nothing is replaced. Am I doing something wrong? </p>\n"},{"tags":["c#","asp.net","asp.net-mvc","razor","html.dropdownlistfor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13268589,"title":".Net MVC 4 Dropdownlistfor SelectedItem (Not just selected value, but the selected text)","body":"<p>I have a for loop to generate IEnumerable list:</p>\n\n<pre><code>public static IEnumerable&lt;SelectListItem&gt; loadData()\n{\n    DataTable dt = load_from_database;\n    List&lt;SelectListItem&gt; list = new List&lt;SelectListItem&gt;();\n    foreach (DataRow dr in dt.Rows)\n    {\n        SelectListItem listItem = new SelectListItem();\n        listItem.Text = dr[\"name\"].ToString();\n        listItem.Value = dr[\"id\"].ToString();\n        list.Add(listItem);\n    }\n    return list;\n}\n</code></pre>\n\n<p>And I have the following model:</p>\n\n<pre><code>public class Models\n{\n    public string selectedUserApp { get; set; }\n    public IEnumerable&lt;SelectListItem&gt; userApps  { get; set;  }\n}\n</code></pre>\n\n<p>And the controller:</p>\n\n<pre><code>public ActionResult Index()\n{\n    var model = new UserApplicationModels();\n    userAppsList = loadData();\n    model.userApps = userAppsList;\n    model.selectedUserApp = model.userApps.First().Value;\n\n    return View(model);\n}\n</code></pre>\n\n<p>Then the view:</p>\n\n<pre><code>@model Models\n\n@Html.DropDownListFor(x=&gt;x.selectedUserApp , Model.userApps)\n</code></pre>\n\n<p>What I got is the value of the selected item, but I need to get the text of selected item. </p>\n\n<p>What can I do?</p>\n"},{"tags":["c#",".net","iis","application","application-pool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13278110,"title":"Log Every File Access Attempt on a System and Sort it by User/System Account","body":"<p>I have a strange issue where I need to see why my application pool is crashing due to a permissions issue and no logs are helpful. Is there any way to log every file access attempt on a system and sort it by the user/system account that tried to access it, especially if it fails in accessing the desired file? Even if there are third party applications for this, it would be very helpful.</p>\n"},{"tags":["c#",".net","compiler","clr"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":440,"score":1,"question_id":554405,"title":"Stipulating that a property is required in a class - compile time","body":"<p>Is there a way to stipulate  that the clients of a class should specify a value for a set of properties in a class.  For example (see below code), Can i stipulate that \"EmploymentType\" property in Employment class should be specified at compile time?  I know i can use parametrized constructor and such.  I am specifically looking for outputting  a custom warning or error during compile time.   Is that possible?</p>\n\n<pre><code>public class Employment\n{\n   public EmploymentType EmploymentType {get; set;}\n}\n\npublic enum EmploymentType\n{\n    FullTime = 1,\n    PartTime= 2\n}\n\npublic class Client\n{\n    Employment e = new Employment();\n// if i build the above code, i should get a error or warning saying you should specify value for EmploymentType\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-4","rendering","html-helper","partialview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13274860,"title":"What is the alternative in MVC 4 to ViewData.Model.ExecuteResult(ViewContext)?","body":"<p>Anyone know an option to render one or plus partial views pass by controller?</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13277636,"title":"Coding in vb2012, error in FileStream","body":"<p>i am building an application in C# in vb2012. i opened a new project and started editing the <code>MainPage.xaml.cs</code> file to write a main method and then a file read...</p>\n\n<pre><code>FileStream s = new FileStream(\"abc.txt\", File.Read);\n</code></pre>\n\n<p>but it's showing error in <code>FileStream</code> and saying </p>\n\n<blockquote>\n  <p>the type or namespace could not be found</p>\n</blockquote>\n"},{"tags":["c#","serialization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13277122,"title":"Serializing lists/dictionaries","body":"<p>I have a application that needs to serialize a custom object and send it to a windows service, the custom object contains 2 lists of custom objects and a dictionary of int, string. When i try to serialize the object I am getting the error message:</p>\n\n<p><code>There was an error generating the XML document.</code></p>\n\n<p>I've googled around and found that this is generally due to one of the datatypes not being setup for serialization correctly. So I've gone through and verified the serialization on all the custom classes and as far as I can tell it is setup correctly.</p>\n\n<p>My question now is, are lists and dictionaries serializable by default or does something need to be done in order to serialize them? Or, is there a better way to serialize collections of custom objects to be passed between executables?</p>\n\n<p><strong>Edits:</strong></p>\n\n<p>Main Custom Class:</p>\n\n<pre><code>[Serializable]\nclass MoveInInfoRequest : ServerRequestData\n{ }\n[Serializable]\n[XmlInclude(typeof(GetUnitTypesResponseData)), XmlInclude(typeof(VendorObj.RequiredFields)),\n     XmlInclude(typeof(VendorObj.InsuranceChoice)), XmlInclude(typeof(VendorObj.ProrateSettings))]\npublic class MoveInInfoResponse : ServerResponseData\n{\n    public GetUnitTypesResponseData UnitTypesInfo\n    { get; set; }\n    public List&lt;VendorObj.RequiredFields&gt; RequiredFields \n    { get; set; }\n    public Dictionary&lt;int, String&gt; RentalPeriods\n    { get; set; }\n    public List&lt;VendorObj.InsuranceChoice&gt; InsCoverageAmounts\n    { get; set; }\n    public VendorObj.ProrateSettings ProrateOptions\n    { get; set; }\n}\n</code></pre>\n\n<p>Sampple Sub class: the other two classes are set up similar to this just much longer but they only use default datatypes. </p>\n\n<pre><code>&lt;Serializable(), DataContract([Namespace]:=\"*companyNamespace*\")&gt; _\nPublic Class InsuranceChoice\n    Public Sub New()\n    End Sub\n    &lt;DataMember()&gt; _\n    Public InsuranceChoiceID As Integer\n    &lt;DataMember()&gt; _\n    Public CoverageDescription As String\n    &lt;DataMember()&gt; _\n    Public Premium As Decimal\n    &lt;DataMember()&gt; _\n    Public ActualCoverageAmount As Decimal\n\nEnd Class\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","asp.net-web-api","serializable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13263988,"title":"ASP.NET Web API and [Serializable] class","body":"<p>I have a class that is marked with [Serializable]. When i return it from the Web API the field names are all funky.</p>\n\n<p>Normally the JSON returned is</p>\n\n<pre><code>[{\"OrderId\":797 ...\n</code></pre>\n\n<p>JSON returned when using [Serializable]</p>\n\n<pre><code>[{\"&lt;OrderId&gt;k__BackingField\":797 ...\n</code></pre>\n\n<p>I wan't to mark it serializable to use a BinaryFormatter for caching. Is there any other way than to write a custom serializer or to make a twin class that is not serializable and write monkey code to \"cast\" between the two?</p>\n"},{"tags":["c#","facebook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13278023,"title":"Facebook C# event api + wrong privacy and unable to upload image","body":"<p>I successfully created an event on facebook using the event api but somehow the event privacy remains as 'OPEN' even though I specified as 'SECRET' and if I were to include a logo image it returns this error:</p>\n\n<pre><code>(OAuthException - #324) (#324) Missing or invalid image file\n</code></pre>\n\n<p>I have ensured that the photo exist as well as tried replacing the content type as <strong>\"image/png\"</strong> but still no help.</p>\n\n<p>Please kindly advice what am I doing wrong. Thanks.</p>\n\n<pre><code>public string CreateEvent()\n    {\n            var accessToken = accessTok;\n            FacebookClient facebookClient = new FacebookClient(accessToken);\n            Dictionary&lt;string, object&gt; createEventParameters = new Dictionary&lt;string, object&gt;();\n            createEventParameters.Add(\"owner\", \"IronMan\");\n            createEventParameters.Add(\"name\", \"Test Event\");\n            createEventParameters.Add(\"description\", \"This is a super hero event.\");\n            createEventParameters.Add(\"start_time\", \"2012-11-11T19:00:00-0700\" );\n            createEventParameters.Add(\"location\", \"A Street\");\n\n            //Add the \"venue\" details\n            JsonObject venueParameters = new JsonObject();\n            venueParameters.Add(\"street\", \"19 Phipps St\");\n            venueParameters.Add(\"city\", \"Toronto\");\n            venueParameters.Add(\"state\", \"ON\");\n            venueParameters.Add(\"zip\", \"L2A 2V2\");\n            venueParameters.Add(\"country\", \"Canada\");\n            venueParameters.Add(\"latitude\", \"43.6654507\");\n            venueParameters.Add(\"longitude\", \"-79.38569580000001\");\n            createEventParameters.Add(\"venue\", venueParameters);\n\n            createEventParameters.Add(\"privacy\", \"SECRET\");\n            createEventParameters.Add(\"updated_time\", DateTime.Now.ToString(CultureInfo.InvariantCulture));\n\n            // Add the event logo image\n            string uploadPath = Server.MapPath(\"~/Images\");\n            string fullPath = uploadPath + \"\\\\bb.png\";\n            FacebookMediaObject logo = new FacebookMediaObject()\n                                           {\n                                               ContentType = \"image/jpeg\",\n                                               FileName = fullPath\n                                           };\n            logo.SetValue(File.ReadAllBytes(logo.FileName));\n            createEventParameters[\"@file.jpg\"] = logo;\n\n          JsonObject result = facebookClient.Post(\"/me/events\", createEventParameters) as JsonObject;\n\n            // TODO: Use the info above and create event natively so that it will appear on my map.\n\n        return result[\"id\"].ToString();\n    }\n</code></pre>\n"},{"tags":["c#",".net","asynchronous","windows-services","parallels"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13277742,"title":"C# Console Application using Parallels or Async","body":"<p>There is a lot of examples and talk out there about parallels, concurrency and now asynchronous calls with .NET 4.5. We are looking for the best solution for our application as a lot of this talk is confusing to us. </p>\n\n<p>We have a console application which needs to run every minute, it currently checks for XML files in a directory and then if any exist, it loops through each one synchronously, loading each as an XMLDocument, parsing it using LINQ and List objects and then saving it to the database. The XML files are relatively small, the biggest ones are maybe 400kb with most in that 20-85kb range.  </p>\n\n<p>We are trying to determine the best route performance wise as there are sometimes 30-50 files and it takes more than a minute to run, pushing it into the time where it needs to run again. With the files currently being processed synchronously, there seems to be an opportunity to process them more quickly since each one is independent of the others, but aren't sure the best approach here in regards to thread safety and performance.</p>\n\n<p>Here is our code, I took a bunch of stuff out to keep just the main components to keep it simple. The Engine.ProcessXML is the call to another method which determines the type of document, then calls the appropriate LINQ parsing method and database layer method for saving.</p>\n\n<pre><code>string feedsDir = ConfigHelper.FeedsDirectory;\n\nif (Directory.Exists(feedsDir))\n{\n    //get full xml file paths\n    string[] filePaths = Directory.GetFiles(feedsDir, \"*.xml\");\n\n    //get total number of files to be processed\n    int fileCount = filePaths.Length;\n\n    if (fileCount &gt; 0)\n    {\n        //loop through each file to process\n        foreach (string file in filePaths)\n        {\n            if (File.Exists(file))\n            {\n                //load the file into xml document object\n                XDocument xmlDoc = XDocument.Load(file);\n\n                //if xml document not empty, process\n                if (xmlDoc != null)\n                {\n                    //parse and save document data\n                    Engine.ProcessXML(xmlDoc);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Side Note:  We have looked into creating a windows service and some FileSystemWatcher class, but we are currently wanting to keep the complexity down. The console app is easier to debug right now and want to address this first performance issue. We can always go back and wrap our console application in a service once it is performing at maximum speed, per-say. And getting this app on parallels or some type of multi-threading, if possible, would make a service easier to convert to since that would probable be needed. </p>\n"},{"tags":["c#","java","oracle","comments","code-comments"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13277865,"title":"What is the best approach for inline code comments?","body":"<p>We are doing some refactor to a 20 years old legacy code, and I'm having a discussion with my colleague about the comments format in the code (plsql,java).</p>\n\n<p>There is no a default format for comments, but in most cases people do something like this in the comment:</p>\n\n<pre><code>// date (year, year-month, yyyy-mm-dd, dd/mm/yyyy), (author id, author name, author nickname) and comment\n</code></pre>\n\n<p>the proposed format for future and past comments that I want is:</p>\n\n<pre><code>// {yyyy-mm-dd}, unique_author_company_id, comment\n</code></pre>\n\n<p>My colleague says that we only need the comment, and must reformat all past and future comments to this format:</p>\n\n<pre><code>// comment\n</code></pre>\n\n<p>My arguments:</p>\n\n<ul>\n<li>I say for maintenance reasons, it´s important to know when and who\ndid a change (even this information is in the SCM).</li>\n<li>The code has life and hence has history.</li>\n<li>Because without the change date it is impossible to know when a change was introduced without opening the SCM tool and searching in the long object history.</li>\n<li>because the author is very important, a change by author X is more credible than a change of author Y</li>\n<li>Agility reasons, no need to open and navigate the SCM tool</li>\n<li>people would be more afraid of changing something that someone did 15 years ago, than something that was recently done...</li>\n</ul>\n\n<p>My colleague's arguments:</p>\n\n<ul>\n<li>The history is in the SCM</li>\n<li>Developers must not be aware of history of the code directly in the code</li>\n<li>Package gets 15k lines long and unstructured comments make this packages harder to understand</li>\n</ul>\n\n<p>What do you think is the best approach? or do you have a better approach to solve this problem?</p>\n"},{"tags":["c#",".net","embedded","netduino"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":36,"score":-4,"question_id":13277992,"title":"C# WPF to Embedded programming transition","body":"<p>I've been learning C# .NET Framework for around 4-6 months (still starting) using some books, and have currently made my way up to Collections and Generics. I'll probably spend the next two months covering the rest up to LINQ and/or Garbage Collections.</p>\n\n<p>The thing is, I started to become interested in embedded systems and found out that you can use C# to code it through .NET MF, which mean I wouldn't have to learn C or C++.\nSo, I would like to know if the knowledge I'll have by that time (2 months) will be enough to start working on Embedded (using C# .NET Micro Framework and Netduino) or I should probably see more about plain C# like Multithreading, async and other advanced features ?</p>\n\n<p>I want use embedded just as a hobby, at least by now, as I'll still have a long way through university. Although, I'll probably pick it as a career then.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","amazon-web-services","amazon-cloudsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12051613,"title":"Are there libraries to search Amazon CloudSearch from .NET?","body":"<p>What libraries are out there to perform searches in AWS' CloudSearch domains? The AWS SDK is virtually devoid of search capabilities.</p>\n\n<hr>\n\n<p>I would like to use Amazon CloudSearch for a project to search in pre-existing databases for certain customer-related data for billing purposes.</p>\n\n<p>We already have extensive experience with Solr-based search services, but in this particular instance we do not want to host the search service in-house and already have experience with AWS.</p>\n\n<p>The Amazon SDK provides a decent .NET-based approach to administer search domains. But: Apparrently it lacks any capability whatsoever to actually <strong>search</strong> for things.</p>\n\n<p>I have found <a href=\"https://github.com/Bigjono/AWS-CloudSearch\" rel=\"nofollow\">a few</a> <a href=\"https://github.com/breaker05/Amazon-CloudSearch\" rel=\"nofollow\">attempts</a> to provide a search API, but nothing that works OOTB. Any suggestions or experience with CloudSearch from within .NET?</p>\n\n<p>(Yes, I know it is easy to just chug parameters in a web service call and deal with the JSON reply; a wrapper / library just would deal better with the messy details of parsing etc.)</p>\n"},{"tags":["c#","windows-phone-7","qr-code","contact","vcard"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13277956,"title":"Scan QR code (vcard) and save the contact on windows phone 7","body":"<p>Hi guys I'm developing an app, but I have a problem with saving vcard as contact functionality, here is how it works step by step:</p>\n\n<ol>\n<li><p>Scan the QR Code (a vCard Data v2.1 <a href=\"http://www.printbusinesscards.com/marketing/qrcode/QR-Code-Quality-Standards-Test.php\" rel=\"nofollow\">http://www.printbusinesscards.com/marketing/qrcode/QR-Code-Quality-Standards-Test.php</a> Test Case 12.02)</p></li>\n<li><p>Now i store the dats in a string and i pass it to a new page (BEGIN:VCARD\nVERSION:2.1\nN:Standard;Joe;;;\nFN:Joe Standard12.02\nTEL:999-999-0001\nTEL;WORK:999-999-0002\nTEL;HOME:999-999-0003\nTEL;CELL:999-999-0004\nTEL;CELL;WORK:999-999-0005\nTEL;CELL,WORK:999-999-0006\nTEL;CELL;WORK;VOICE;MSG:999-999-0007\nTEL;CELL;WORK;VOICE;type=MSG:999-999-0008\nTEL;CELL;WORK;type=VOICE;type=MSG:999-999-0009\nEND:VCARD)</p></li>\n<li><p>Now I have the problem, I want to save the string (vcard) as contact, is there a fast way, or i need to parse all the string?</p></li>\n</ol>\n\n<p>(actually should work as builtin windows phone bing qr readear)</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","parameters","switch-statement","class-library","using-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13266258,"title":"C# switch library using with program paremeters","body":"<p>I have a project with two class libraries.\nI need to switch between them programatically, with application parameters, something like</p>\n\n<pre><code>if(arg == \"a\")\n    using LibraryA;\nif(arg == \"b\")\n    using LibraryB;\n\nnamespace Project\n{\n    public class MyClass\n    {\n    // my code here\n    }\n}\n</code></pre>\n"},{"tags":["c#","android","mono","monodroid","xamarin"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":57,"score":6,"question_id":13277146,"title":"Mono for Android - Supported Architecture - Drop x86?","body":"<p>We have a near complete application, and are trying to squeeze under the 50MB download limit for Google Play.</p>\n\n<p>When inspecting our APK to try to find ways to drop our file size, I noticed the <code>lib\\x86</code>, <code>lib\\armeabi</code>, and <code>lib\\armeabi-v7a</code> directories that are described <a href=\"http://docs.xamarin.com/Android/Guides/Advanced_Topics/CPU_Architecture\">here</a>.  They correspond to the 'Supported architecture' option in project options of a Mono for Android project.</p>\n\n<p>If I remove x86, I save around 1.1 MB on our APK size.  (This is almost enough to get us under 50MB)</p>\n\n<ul>\n<li>What are the drawbacks for removing x86?  </li>\n<li>Will my APK still run on x86 devices?</li>\n<li>Is there any substantial market share on Google Play for x86 devices?</li>\n<li>If it will not work on x86, will Google Play prevent my APK from being installed on x86 devices?</li>\n</ul>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":367,"score":1,"question_id":5522900,"title":"asp.net form control ID is null on enumeration","body":"<p>I have a simple ASP.Net page, and I am enumerating through the controls doing things to the controls via reflection (localising the page - but that is whole other can of managerial dictat type worms). So...I have a test page thus:</p>\n\n<pre><code>&lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/Master Pages/Root.master\" AutoEventWireup=\"true\" CodeFile=\"refelectiontest.aspx.cs\" Inherits=\"refelectiontest\" %&gt;\n\n&lt;asp:Content ID=\"Content1\" ContentPlaceHolderID=\"ContentPlaceHolder1\" Runat=\"Server\"&gt;\n\n    &lt;asp:Button ID=\"Button1\" runat=\"server\" Text=\"Button\" /&gt;\n\n    &lt;asp:Label ID=\"Label1\" runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;&lt;asp:Label ID=\"Label2\"\n        runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;\n\n    &lt;asp:Label ID=\"Label3\" runat=\"server\" Text=\"Label\"&gt;&lt;/asp:Label&gt;\n\n&lt;/asp:Content&gt;\n</code></pre>\n\n<p>And then in the code behind, I want to iterate through the controls...</p>\n\n<p>So I have this (the master page can deal with itself)</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n\n            try\n            {\n\n                foreach (Control ctrl in Form.Controls)\n                {\n                    if (ctrl is ContentPlaceHolder)\n                    {\n                        ContentPlaceHolder chp = ctrl as ContentPlaceHolder;\n                        foreach (Control control in chp.Controls)\n                        {\n                string strID = control.ID;\n                //do stuff based on the the ID\n                        }\n                    }\n\n\n                }\n\n            }\n            catch (Exception ex)\n            {\n                Response.Write(ex.ToString());\n            }\n        }\n\n    }\n</code></pre>\n\n<p>Now, if I just run this, it barfs with an object null exception. And if I step through the code, putting a breakpoint on the control.ID line, then indeed the ID is null. However, if I then expand the control object, the ID fills itself out and all is well.</p>\n\n<p>It looks like the ID is only getting completed at the last moment - how can I ensure that I can get the ID without getting null?\nThe same thing happens if I don't use the master page.\nThanks.</p>\n"},{"tags":["c#",".net","permissions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3463,"score":2,"question_id":1475964,"title":"writing files to Common Application Data folder denied","body":"<p>i have used the follwing function to write data to user application folder</p>\n\n<pre><code>private void WriteToLog(string source, string method, string msg)\n{\n\n string LogFile =Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + \"\\\\test\";            \n LogFile = LogFile + \"\\\\Log.txt\";\n StreamWriter sw = new StreamWriter(LogFile, true );\n string str = DateTime.Now.ToString() + \"source=\" + source + \"\\t Method=\" + method + \"\\t\" + msg;\nsw.WriteLine(str);\nsw.Flush();\nsw.Close();\n}\n</code></pre>\n\n<p>the above code working perfectly in administrator accounts, but failed in limited user accounts</p>\n"},{"tags":["c#","asp.net","reportviewer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13169719,"title":"set textbox value in Reportviewer using asp.net c#","body":"<p>i have a reportviewer containing a a textbox and tablix.\nThe tablix is populated using a datasource(which gets data using  a stored proc with 2 parameters from a query string).\nHow do i specify the value of the query strings as the value of my reportviewer textbox.\nsomething like:\nThis ReportfFrom query String val1 to query String val 2.</p>\n\n<p>markup:</p>\n\n<pre><code>&lt;rsweb:ReportViewer ID=\"ReportViewer1\" runat=\"server\" \n    CssClass=\"ReportAlignment\" Font-Names=\"Verdana\" Font-Size=\"8pt\" \n    InteractiveDeviceInfos=\"(Collection)\" WaitMessageFont-Names=\"Verdana\" \n    WaitMessageFont-Size=\"14pt\" Width=\"550px\"&gt;\n    &lt;LocalReport ReportPath=\"TempEmpWageSummaryReport.rdlc\"&gt;\n        &lt;DataSources&gt;\n            &lt;rsweb:ReportDataSource DataSourceId=\"LoadWageSummary\" Name=\"DataSet1\" /&gt;\n        &lt;/DataSources&gt;\n    &lt;/LocalReport&gt;\n&lt;/rsweb:ReportViewer&gt;\n&lt;asp:SqlDataSource ID=\"LoadWageSummary\" runat=\"server\" \n    ConnectionString=\"&lt;%$ ConnectionStrings:stockerConnectionString %&gt;\" \n    SelectCommand=\"procTempEmployeeWageSummaryReport\" \n    SelectCommandType=\"StoredProcedure\"&gt;\n    &lt;SelectParameters&gt;\n        &lt;asp:QueryStringParameter Name=\"startDate\" QueryStringField=\"start\" \n            Type=\"String\" /&gt;\n        &lt;asp:QueryStringParameter Name=\"endDate\" QueryStringField=\"end\" Type=\"String\" /&gt;\n    &lt;/SelectParameters&gt;\n&lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>The code behind</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        string start = Server.UrlDecode(Request.QueryString[\"start\"]);\n        string end = Server.UrlDecode(Request.QueryString[\"end\"]);\n        //this.ReportViewer1.LocalReport.ReportEmbeddedResource = \"TempEmpWageSummaryReport.rdlc\";\n        string param0 = \"GROUPED TEMPORARY EMPLOYEE WAGE SUMMARY REPORT FROM \" + start + \"to \" + end;\n        ReportParameter rp = new ReportParameter(\"ReportParameter1\", param0);\n        this.ReportViewer1.LocalReport.SetParameters(new ReportParameter[] { rp });\n\n        this.ReportViewer1.LocalReport.Refresh();\n\n        //BindReport();\n    }\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","windows-vista"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5108,"score":4,"question_id":1572442,"title":"Saving a file to Application Data in c#","body":"<p>I used the following method to save a file to the folder  Application Data in c#</p>\n\n<pre><code>string path = \n    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);\n</code></pre>\n\n<p>Its working fine in windows XP, but i cannt find such a folder path i Windows vista.\nWhere is this folder located in Vista and how can i save the file to this folder</p>\n"},{"tags":["c#","arrays"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13277737,"title":"Why does the array have more elements than I've defined?","body":"<p>So, I've got this function which reads from an INI file:</p>\n\n<pre><code>private void GetRigInfo()\n{\n    RigInfo = new string[9];\n    var fileLocation = new string[2];\n\n    // The problem is that there's no telling where the hddrigsite.ini will be \n    stored.  So, we have to find out where it is from the hddconfig.ini.\n    Log(\"Locating rig info\");\n\n    // There's no telling if this will be on a 32 or 64 bit OS.  Check for both\n    var rigInfoLocation = File.ReadAllLines(Environment.Is64BitOperatingSystem ?\n                          @\"C:\\Program Files (x86)\\HDD DrillView\\hddconfig.ini\" : \n                          @\"C:\\Program Files\\HDD DrillView\\hddconfig.ini\");\n\n    // This should get us the location of the rigsite info we need.\n    foreach (var s in rigInfoLocation.Where(s =&gt; s.Contains(\"data_dir\")))\n    {\n        fileLocation = s.Split('=');\n    }\n\n    RigInfo = File.ReadAllLines(fileLocation[1] + \"\\\\hddrigsite.ini\");\n\n    Log(\"Rig info found\");\n}\n</code></pre>\n\n<p>Now, when I step through, and get to the last <code>Log()</code> in the function, and I hover over <code>RigInfo</code>, Visual Studio intellisense shows me <code>RigInfo{string[30]}</code>.  Now, I've always understood that <code>= new string[9]</code> would create a 9 element array.  So why is it allowed to have 30 elements?  When I run the program, I get no errors or anything when it comes to this array.  Matter of fact, it works just the way that I need it to in the overall scheme of things.  Thanks for any and all help in understanding how and why this is the way it is.  Also attached screenshot for better visual aid.</p>\n\n<p><img src=\"http://i.stack.imgur.com/hsFyy.png\" alt=\"Confusing intellisense\"></p>\n"},{"tags":["c#","asp.net","asprepeater"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13277526,"title":"asp:repeater show count of items in each category","body":"<p>I have a simple repeater that gets the 'groups' of 'widgets' The home page lists all of the groups:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ItemTemplate&gt;\n    &lt;tr&gt;\n        &lt;td width=\"60\" class=\"center\"&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Number\") %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"Stories.aspx?ProjectID=&lt;%# DataBinder.Eval(Container.DataItem, \"ProjectId\") %&gt;\"&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Name\") %&gt;&lt;/a&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"Description\") %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/ItemTemplate&gt;\n</code></pre>\n\n<p><strong>Code Behind</strong></p>\n\n<pre><code>private void LoadForm()\n{\n    using (MarketingWebContentEntities context = new MarketingWebContentEntities())\n    {\n        rptGroup.DataSource = (from groups in context.URLGroup\n                               select groups).ToList();\n        rptGroup.DataBind();\n    }\n}\n</code></pre>\n\n<p>I would like within the repeater to show number of 'widgets' within each 'group'.  I know I'd need to run a query on the 'widgets' table to see how many items are in that list.  I'm just unsure how to add that within the repeater mark-up.</p>\n"},{"tags":["c#","fxcop"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13277238,"title":"Why does FxCop insist on IDisposable for a struct","body":"<p>I have the code similar to the following in one of my projects:</p>\n\n<pre><code>internal enum ArtworkType\n{\n    Undefined = 0,\n    Bmp = 1,\n    Gif = 2,\n    Jpeg = 3,\n    Png = 4\n}\n\n[StructLayout(LayoutKind.Sequential)]\ninternal struct TagArtwork\n{\n    internal IntPtr data;\n    internal int size;\n    internal ArtworkType type;\n}\n</code></pre>\n\n<p>When I run FxCop on this code, I get run into warning <a href=\"http://msdn.microsoft.com/en-us/library/ms182173.aspx\" rel=\"nofollow\">CA1049</a>. This struct is used for interoperability with a native code library, so it pretty much <strong>has</strong> to have this layout. Why does FxCop give me grief about this struct? I have other structs in the same source file, which also have <code>IntPtr</code> members, but FxCop does not complain about those.</p>\n\n<p>For example, the following code does <strong>not</strong> trigger the same warning:</p>\n\n<pre><code>internal enum ItemType\n{\n    Implicit = 0,\n    Utf8 = 1,\n    Utf16 = 2,\n    Sjis = 3,\n    Html = 6,\n    Xml = 7,\n    Uuid = 8,\n    Isrc = 9,\n    Mi3p = 10,\n    Gif = 12,\n    Jpeg = 13,\n    Png = 14,\n    Url = 15,\n    Duration = 16,\n    DateTime = 17,\n    Genres = 18,\n    Integer = 21,\n    Riaa_pa = 24,\n    Upc = 25,\n    Bmp = 27,\n    Undefined = 255\n}\n\n[StructLayout(LayoutKind.Sequential)]\ninternal struct MP4ItmfData\n{\n    internal byte typeSetIdentifier;\n    internal ItemType typeCode;\n    internal int locale;\n    internal IntPtr value;\n    internal int valueSize;\n}\n</code></pre>\n\n<p>I suppose I could implement <code>IDisposable</code> on the struct, but that just seems wrong. Likewise, I could simply suppress the warning, but at the moment, I want to understand what it is about this particular struct that is triggering the warning, when it's not that much different than the other seven structs I have in the same source file. Alternatively, I'd happily accept an explanation of why the other structs <strong>don't</strong> trigger this warning.</p>\n"},{"tags":["c#","debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13275024,"title":"Debugging an issue with COM object and RCW","body":"<p>In my C# WinForms app I have a child app that is using a old VB 6.0 or maybe VC 6.0 ActiveX control as a text editor ( old ActiveX version of TXTextControl if you have used it).\nIn VS IDE when I close this child app that has this activeX control and then I close the main app and I get this error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vZaF7.png\" alt=\"enter image description here\"></p>\n\n<p>What are some techniques and ideas that you suggest for digigng into this and finding whats going on?  This does not happen if I run my app out side of VS IDE. </p>\n"},{"tags":["c#",".net","iis","crystal-reports","application-pool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13277769,"title":"Application Pool Crashes when Web Site is Not Running as Network Service","body":"<p>I have a site running Crystal Reports Viewer in IIS 7 but for security reasons we want it to run the application pool under the ApplicationPoolIdentity. We noticed the application pool keeps crashing when we switched it from Network Service to ApplicationPoolIdentity and we want to give extra permissions to the ApplicationPoolIdentity on certain folders on the drive in order to remedy this situation. The problem is, we gave a ton of permissions to different folders, but as far as we can tell we cannot pinpoint why the application pool keeps crashing and what file it cannot access. We checked a lot of different log files, but maybe we skipped over some that could be of more importance. Is there anything out there to show us where the problem is, whether it be a certain log I haven't come across or some sort of tracing I can use to get to the files that I need to give this identity permissions? The pool crashes when trying to load Crystal Reports Viewer and gives no errors, just says it is unreachable.</p>\n"},{"tags":["c#","popup","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13269557,"title":"DoNotPromptForConvert Fails to Suppress popup in Excel 2010","body":"<p>I'm have a .Net project that is automating the transfer of information between Excel workbooks.  The code opens up an Excel 2010 application, opens up a Workbook that is in xlExcel8 format, creates a blank workbook in xlExcel8 format and transfers a page from the first workbook to the blank workbook. I have not been able to suppress the pop-up message when I save the blank workbook even though I've used the DoNotPromptForConvert command. The Code I've been using is:</p>\n\n<pre><code>        private static void QuickTest()\n    {\n        Object M = Type.Missing;\n\n        string FullFileName2 = \"C:\\\\Users\\\\Bill Corry\\\\Venrock\\\\SusansProject\\\\Test.xls\";                //blank WkbkName\n        string FullFileName = \"C:\\\\Users\\\\Bill Corry\\\\Venrock\\\\SusansProject\\\\VRQtrCompInfoReqv8.xls\";   //Template\n        XLHlpr XLH = new XLHlpr();      // start a helper class \n\n        XL.Workbook srcWkBk = XLH.OpenExistingWorkbook(FullFileName, false);    //open WkBk with Format xlExcel8\n        srcWkBk.DoNotPromptForConvert = true;                                   //try to suppress pop-up message\n\n        XL.Workbook WkBk = XLH.GetNewWorkbook();                                //open blank workbook \n        WkBk.DoNotPromptForConvert = true;\n        WkBk.SaveAs(FullFileName2, XL.XlFileFormat.xlExcel8, M, M, M, M, XL.XlSaveAsAccessMode.xlNoChange, M, M, M, M, M);  //no popup here\n            //Copy Worksheet from first file to blank workbook\n        XL.Worksheet WkSht = (XL.Worksheet)srcWkBk.Worksheets[1];           \n        WkSht.Copy(WkBk.Worksheets[1], M);\n        WkBk.DoNotPromptForConvert = true;\n        WkBk.Save();                                  //Popup occurrs on this step\n        WkBk.Close(false, M, M);\n        srcWkBk.Close(M, M, M);                     \n    }\n</code></pre>\n"},{"tags":["c#","ado.net","tableadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13260129,"title":"SUM child column of tableadapter","body":"<p>I have a tableadapter (<code>SettlementCurrentTableAdapter</code>) with a relation. parent table is (<code>SettlementCurrent</code>) child table is (<code>Trips</code>). </p>\n\n<p>I need to SUM each row (<code>tripLoadedMiles</code>) in (<code>Trips</code>) and display the total in a label (<code>labelWelcomeSetTotalMiles</code>).</p>\n\n<p>I would like to do this in code and not sql as i use this tableadapter to display other labels.</p>\n\n<p>Can someone help me figure this out. i am new to C# and i use Visual C#.</p>\n\n<pre><code>        this.settlementCurrentTableAdapter.Fill(this.myLeaseDataSet.SettlementCurrent);\n        MyLeaseDataSet.SettlementCurrentRow settlementCurrent;\n        settlementCurrent = myLeaseDataSet.SettlementCurrent.Last();\n\n        var settlementCurrentID = settlementCurrent.setID;\n\n        this.tripsTableAdapter.FillByTripSetID(this.myLeaseDataSet.Trips, settlementCurrentID);\n        MyLeaseDataSet.TripsCurrentDataTable settlementTrips;\n        settlementTrips = myLeaseDataSet.Trips.SOMETHING();\n\n        var totalMiles = settlementTrips.tripLoadedMiles.Sum();\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":28,"score":5,"question_id":13178656,"title":"AppBarButtonStyle: Changing Content from code","body":"<p>How to change Content of Button which style is AppBarButtonStyle from code-behind? I would like to change an icon and I do it like that:</p>\n\n<pre><code>private void ChangemyButtonIcon()\n{\n   myButton.SetValue(AutomationProperties.NameProperty, \"new text\");\n   myButton.Content = \"&amp;#xE15D;\"; // &lt;--- works wrong\n}\n</code></pre>\n\n<p>but then instead of standard icon inside button text displays.</p>\n\n<p>Do you know how to do it in right way?\nThank you in advance for help\nMaciek</p>\n"},{"tags":["c#","dependency-injection","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13275826,"title":"Unity named mapping issue","body":"<p>I have two implementations of <code>IEmailService</code>, one for testing and one for live (is-A). And I have a <code>BusinessService</code> that has-A <code>IEmailService</code> reference. </p>\n\n<pre><code>BusinessService\n    IEmailService (has-A)\n\nIEmailService\n    TestEmailService (is-A)\n    LiveEmailService (is-A)\n</code></pre>\n\n<p>In unity config, I register the two <code>IEmailService</code> implementations as follows. </p>\n\n<pre><code>&lt;unity xmlns=\"http://schemas.microsoft.com/practices/2010/unity\"&gt;\n&lt;container&gt;\n  &lt;register type=\"DataAccess.IEmailService, DataAccess\"\n            mapTo=\"DataAccess.LiveEmailService, DataAccess\"\n            name=\"Live\"&gt;\n    &lt;lifetime type=\"singleton\" /&gt;\n  &lt;/register&gt;\n  &lt;register type=\"DataAccess.IEmailService, DataAccess\"\n            mapTo=\"DataAccess.TestEmailService, DataAccess\"\n            name=\"Test\"&gt;\n    &lt;lifetime type=\"singleton\" /&gt;\n  &lt;/register&gt;\n&lt;container&gt;\n&lt;/unity&gt;\n</code></pre>\n\n<p>Based on the <code>appSetting</code> for <code>IEmailService</code> I want Unity to pick the correct implementation. This will help while testing. </p>\n\n<pre><code>&lt;appSettings&gt;\n    &lt;add key=\"IEmailService\" value=\"Test\"/&gt;\n&lt;/appSettings&gt;\n</code></pre>\n\n<p>The issue is when unity resolves <code>BusinessService</code>, it tries to resolve <code>(none)</code> named mapping of <code>IEmailService</code> instead of <code>Live</code> or <code>Test</code> and throws an <code>ResolutionFailedException</code>.</p>\n\n<p><code>container.Resolve&lt;BusinessService&gt;();</code> throws below exception:</p>\n\n<pre><code>BusinessServices.Test.BusinessServiceTest_Integration.Test103:\n\nMicrosoft.Practices.Unity.ResolutionFailedException : Resolution of the dependency failed, type = \"BusinessServices.BusinessService\", name = \"(none)\".\nException occurred while: while resolving.\nException is: InvalidOperationException - The current type, DataAccess.IEmailService, is an interface and cannot be constructed. Are you missing a type mapping?\n-----------------------------------------------\nAt the time of the exception, the container was:\n\n  Resolving BusinessServices.BusinessService,(none)\n  Resolving parameter \"emailService\" of constructor BusinessServices.BusinessService(DataAccess.IEmailService emailService)\n    Resolving DataAccess.IEmailService,(none)\n\n  ----&gt; System.InvalidOperationException : The current type, DataAccess.IEmailService, is an interface and cannot be constructed. Are you missing a type mapping?\n</code></pre>\n\n<p>The workaround I came up with is to specify the registrations in code as well and have a wrapper method around <code>container.RegisterType</code> to register <code>IEmailService</code> with <code>(none)</code> named mapping as well based on the <code>appSetting</code> value. </p>\n\n<pre><code>IUnityContainer container;\n\n// registering unity\nstatic void Load()\n{\n    container = new UnityContainer().LoadConfiguration();\n\n    RegisterType&lt;IEmailService, TestEmailService&gt;(\"Test\");\n    RegisterType&lt;IEmailService, LiveEmailService&gt;(\"Live\");\n}\n\n// register the `Test` or `Live` implementation with `(none)` named mapping as per appSetting\nstatic void RegisterType&lt;TFrom, TTo&gt;(string name) \n    where TTo : TFrom\n{\n    var tFromAppSetting= ConfigurationManager.AppSettings[typeof(TFrom).Name];\n    if (!string.IsNullOrEmpty(tFromAppSetting) &amp;&amp; tFromAppSetting == name)\n        container.RegisterType&lt;TFrom, TTo&gt;();\n}\n</code></pre>\n\n<p>This works, but I end up specifying the registrations in two places - config as well as code. Is there a better way for doing this?</p>\n"},{"tags":["c#","domain-driven-design"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13277306,"title":"DDD: Object Id must be 0 before inserting in database","body":"<p>I am trying to learn DDD, and i am making a simple demo project.</p>\n\n<p>Right now, i have a generic repository</p>\n\n<pre><code>public class Repository&lt;T&gt; where T : class, IAggregateRoot\n{\n    public void Add(T entity)\n    {\n        ObjectSet.AddObject(entity);\n    }\n}\n</code></pre>\n\n<p>and a <code>Product</code> class</p>\n\n<pre><code>public class Product : IAggregateRoot\n{\n    private Guid _id = Guid.Empty;\n    public Guid Id\n    {\n        get { return _id; }\n        private set { _id = value; }\n    }\n    public string Name { get; private set; }\n\n    protected Product() { }\n    public Product(string name)\n    {\n        Name = name;\n    }\n}\n</code></pre>\n\n<p>The idea is that i want that a Product which has been created to have an empty Guid. It should get a new Guid only when is inserted into databse.</p>\n\n<pre><code>Product product = new Product(\"Hello World\");\nproduct.Id == Guid.Empty; // True\n</code></pre>\n\n<p>How is right now, when i call the repository to insert a product, it inserts it in database with an empty Guid.</p>\n\n<pre><code>var repository = new Repository&lt;Product&gt;();\nrepository.Add(product);\n</code></pre>\n\n<p>Where should i put the Guid generation of the Product? In the repository? If yes, how should i do it, because i have a generic repository.</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","string"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":58,"score":0,"question_id":13277517,"title":"Replace all single quotes with two single quotes in a string","body":"<p>I am trying to read value from DB using c#.\nThe query string contains multiple single quotes - such as: Esca'pes' (the query strings are being read from a text file)</p>\n\n<p>So, I wanted to replace all the single quotes with two single quotes before forming the SQL query. My code is as below:</p>\n\n<pre><code>if (name.Contains('\\''))\n{\n    name = name.Replace('\\'','\\''');  \n}\n</code></pre>\n\n<p>How to fix this?</p>\n"},{"tags":["c#","database","idisposable"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13049784,"title":"Whats the correct way to dispose table adapters and data sets?","body":"<p>I've been working on a project that uses table adapters and datasets to access an access database. I'm near completion and ran code analysis from visual studio and it came up with some errors about needing to implement IDisposable on specific classes that I use these methods. While I've looked at a few different things on this about having a dispose method or using a using block, I'm not really sure how to make this work. The dataset and table adapters are created as global variables to be used by the whole class, many classes will call on other classes which will also use different table adapters and datasets. I've tried creating a Dispose method, but I don't know when to call it and I am wondering if it is called at the wrong time will it crash my program. Here is a sample of one of the classes that I need to implement Idisposable :</p>\n\n<pre><code>   using System;\n   using System.Collections.Generic;\n   using System.Linq;\n    using System.Text;\n\n namespace recipeDataBase \n {\n     class NewRecipe : IDisposable\n     {\n         recipiesNewDataSet recipeDataSet = new recipiesNewDataSet();\n         recipiesNewDataSetTableAdapters.RecipeTableAdapter recipeTableAdapter = new      recipiesNewDataSetTableAdapters.RecipeTableAdapter();\n    recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter recipeIngredientTableAdapter = new recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter();\n    recipiesNewDataSetTableAdapters.RatingTableAdapter ratingTableAdapter = new recipiesNewDataSetTableAdapters.RatingTableAdapter();\n    recipeDataBase.recipiesNewDataSetTableAdapters.IngredientTableAdapter ingredientTableAdapter = new recipiesNewDataSetTableAdapters.IngredientTableAdapter();\n    private RecipeInfo newRecipe;\n    private RatingNum originalRatingNum;\n    private RatingNum newRating;\n    private RecipeInfo originalRecipe;\n    private string[] ingredients;\n\n    public NewRecipe(RecipeInfo incommingNewRecipe, RatingNum IncommingNewRating, string[] incommingIngredients)\n    {\n        newRecipe = incommingNewRecipe;\n        newRating = IncommingNewRating;\n        ingredients = incommingIngredients;\n        CreateNewRecipe();\n        UpdateNewRecipe();\n    }\n    public void CreateNewRecipe()\n    {\n        originalRatingNum = new RatingNum();\n        originalRecipe = new RecipeInfo();\n        originalRatingNum.cookingTime = 0;\n        originalRatingNum.easeOfCooking = 0;\n        originalRatingNum.familyRating = 0;\n        originalRatingNum.healthRating = 0;\n        originalRatingNum.userRating = 0;\n\n        ratingTableAdapter.Fill(recipeDataSet.Rating);\n        ratingTableAdapter.Insert(originalRatingNum.userRating, originalRatingNum.familyRating, originalRatingNum.healthRating, originalRatingNum.easeOfCooking, originalRatingNum.cookingTime);\n        Query getNewRecipeNumbers = new Query();\n        int newRatingNumber = getNewRecipeNumbers.newRatingNum();\n\n\n\n        originalRatingNum.ratingNum = newRatingNumber;\n        newRating.ratingNum = newRatingNumber;\n        newRecipe.ratingNum = newRatingNumber;\n        originalRecipe.recipeName = \"newRecipe\";\n        originalRecipe.nationality = \"newRecipe\";\n        originalRecipe.recipeEvent = \"newRecipe\";\n        originalRecipe.source = \"newRecipe\";\n        originalRecipe.type = \"newRecipe\";\n        originalRecipe.servings = \"0\";\n        originalRecipe.ratingNum = newRatingNumber;\n\n\n        recipeTableAdapter.Fill(recipeDataSet.Recipe);\n        recipeTableAdapter.Insert(originalRecipe.recipeName, originalRecipe.nationality, originalRecipe.recipeEvent, originalRecipe.source, originalRecipe.type, originalRecipe.servings, originalRecipe.ratingNum); \n        int newRecipeNum = getNewRecipeNumbers.newRecipeNum();\n        newRecipe.recipeNum = newRecipeNum;\n        originalRecipe.recipeNum = newRecipeNum;\n        recipeDataSet.AcceptChanges();\n    }\n\n    public void UpdateNewRecipe()\n    {\n        UpdateRatingNum updateRatingNum = new UpdateRatingNum(originalRatingNum, newRating);\n        UpdateRecipe updateRecipe = new UpdateRecipe(newRecipe, originalRecipe);\n\n        UpdateIngredients updateIngredients = new UpdateIngredients(ingredients);\n        UpdateRecipeIngredient updateRecpeIngredients = new UpdateRecipeIngredient(ingredients, newRecipe.recipeNum);\n        recipeDataSet.AcceptChanges();\n\n    }\n\n\n    public void Dispose()\n    {\n        ratingTableAdapter.Dispose();\n        recipeTableAdapter.Dispose();\n        recipeTableAdapter.Dispose();\n        ingredientTableAdapter.Dispose();\n        recipeDataSet.Dispose();\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>As you can see I did implement Idisposable and used the automatically created method to put all of the table adapters and dataset in there to be disposed, but how do I use it and where?</p>\n\n<p>Thanks for the help</p>\n\n<p>Craig</p>\n"},{"tags":["c#","wcf","logging"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":4946,"score":4,"question_id":1927975,"title":"Best way to log errors in WCF","body":"<p>What's the best way to catch and log errors when developing a WCF service layer, and why?</p>\n\n<p>I can think of three ways,</p>\n\n<p>1) Manual try/catches around each method.</p>\n\n<p>2) Leave the responsibility to the WCF engine.</p>\n\n<p>3) Use a third party library such as Enterprise Library Policy Injection/Logging.</p>\n"},{"tags":["c#","wcf","web-services","logging"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":593,"score":3,"question_id":7328743,"title":"log soap request and response from Wcf web service to a text file using log4net","body":"<p>Is there there any simple way of getting a WCF Service to log SOAP requests and responses to a text file.</p>\n\n<p>I want to log the messages on server, just to clarify.</p>\n"},{"tags":["c#","asp.net","css"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13275487,"title":"Making a div format properly next to a img in asp.net","body":"<p>Hi i made a user control that is a image and a div. When i hover over the image the div appears. I am having problems getting the div to be next to the image in the right place. I want to be able to have the div position itself dynamically so if the image is placed on the left or right it will be on the side that is of screen. </p>\n\n<p>Here is the code </p>\n\n<pre><code>    &lt;a id=\"&lt;%=this.ClientID%&gt;_helpButton\" href=\"#\" onclick=\"popUp('FeedBack.aspx?helpID=', 'feedback')\"\nonmouseover=\"unhidden('&lt;%=this.ClientID%&gt;_div1', '&lt;%=this.ClientID%&gt;_ShowMore', '&lt;%=this.ClientID%&gt;_helpButton')\"\nonmouseout=\"unhidden('&lt;%=this.ClientID%&gt;_div1', '&lt;%=this.ClientID%&gt;_ShowMore', '&lt;%=this.ClientID%&gt;_helpButton')\"\nstyle=\"top: 50%; left: 50%;\"&gt;\n&lt;img src=\"help.gif\" alt=\"Help Button\" style=\"border: 0\" /&gt;&lt;/a&gt;\n\n    &lt;div id=\"&lt;%=this.ClientID%&gt;_div1\" class=\"helper\" style=\"visibility: hidden; border: 3px solid black;\nbackground-color: Gray; width: 40%; height: auto; word-wrap: break-word; position: absolute;\"&gt;\n&lt;asp:Literal ID=\"Literal1\" runat=\"server\" Text=\"\" /&gt;\n&lt;br /&gt;\n&lt;a id=\"link1\" onclick=\"displayMore('&lt;%=this.ClientID%&gt;_ShowMore')\" href=\"#\"&gt;more\n&lt;/a&gt;\n&lt;div id=\"&lt;%=this.ClientID%&gt;_ShowMore\" style=\"visibility: hidden;\" class=\"helper2\"&gt;\n    &lt;asp:Literal ID=\"helpText1\" runat=\"server\" Text=\"\" /&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#",".net","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13260131,"title":"How to parse XML header and nested sections using LINQ","body":"<pre><code>XElement documentRoot = XElement.Parse(@\"&lt;OrdersReport Date='2012-08-01'&gt;\n                &lt;SettingHeader&gt;\n                  &lt;SettingId&gt;1&lt;/SettingId&gt;\n                &lt;/SettingHeader&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;1&lt;/ClientId&gt;\n                    &lt;Orders&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;1&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;123 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;MyCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AZ&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;2&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;OrderCancelled&gt;\n                        &lt;OrderNumber&gt;3&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;222 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;CancelledCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/OrderCancelled&gt;\n                    &lt;/Orders&gt;\n                    &lt;Returns&gt;\n                      &lt;Amount&gt;\n                        &lt;OrderId&gt;2&lt;/OrderId&gt;\n                        &lt;OrderId&gt;3&lt;/OrderId&gt;\n                        &lt;OrderId&gt;21&lt;/OrderId&gt;       \n                      &lt;/Amount&gt;\n                    &lt;/Returns&gt;\n                  &lt;/Client&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;2&lt;/ClientId&gt;    \n                  &lt;/Client&gt;\n                &lt;/OrdersReport&gt;\");\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>        var orders = documentRoot.Descendants(\"Order\")\n                       .Concat(documentRoot.Descendants(\"OrderCancelled\"))\n                       .Select(x =&gt; new\n                       {\n                           OrderNumber = (int)x.Element(\"OrderNumber\"),\n                           ShipAddress = (string)x.Element(\"ShipAddress\"),\n                           ShipCity = (string)x.Element(\"ShipCity\"),\n                           ShipState = (string)x.Element(\"ShipState\")\n                       });\n\n        foreach (var o in orders)\n        {\n            Console.WriteLine(o.OrderNumber + \" \" + o.ShipAddress + \" \" \n                + o.ShipCity);\n        }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 123 Main St. MyCity\n2 111 Main St. OtherCity\n3 222 Main St. CancelledCity\n3 222 Main St. CancelledCity\n</code></pre>\n\n<p>How do I append <em>ClientId</em> and <em>SettingId</em> like the below output?</p>\n\n<p>Target output:</p>\n\n<pre><code>1 123 Main St. MyCity ClientId 1 SettingId 1\n2 111 Main St. OtherCity ClientId 1 SettingId 1\n...\n</code></pre>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13262551,"title":"Generic type serialization with two similarly named generic arguments","body":"<p>I would like to be able to serialize a generic type against several different entities using the C# XmlSerializer. For example i want to serialize:</p>\n\n<pre><code>GenericThing&lt;MyApp.A&gt; and GenericThing&lt;MyApp.B&gt;\n</code></pre>\n\n<p>This all works well until i have something like the following:</p>\n\n<pre><code>GenericThing&lt;MyApp.A.Entity&gt; and GenericThing&lt;MyApp.B.Entity&gt;\n</code></pre>\n\n<p>Because these two classes have the same name the serializer cant differentiate between the two entities and attempts to serialize both to <code>GenericThingOfEnitity</code>.</p>\n\n<p>Is there a way of decorating <code>GenericThing</code> so that it is more specific about its generic argument during serialization (ie serializes to <code>GenericThingOfMyApp.B.Enitity</code> or similar)? I unfortunately don't have control over either <code>MyApp.A</code> or <code>MyApp.B</code></p>\n"},{"tags":["c#","crash","windows-8","crash-reports","windows-store-apps"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13224661,"title":"Windows Store app crashes, quality reports, and CEIP","body":"<p>Microsoft's Antoine Leblond <a href=\"http://blogs.msdn.com/b/windowsstore/archive/2012/06/27/improving-apps-with-quality-reports.aspx\" rel=\"nofollow\">discusses here</a> how the Windows Store dashboard shows app crashes, which is nice.</p>\n\n<p>Separately, Microsoft has <a href=\"http://technet.microsoft.com/en-us/library/jj618322.aspx\" rel=\"nofollow\">an article</a> that talks about their Windows Customer Experience Improvement (CEIP) system, noting that CEIP is turned off by default in Windows 8. However, the article also says this:</p>\n\n<blockquote>\n  <p>When Windows 8 is installed and the computer is started for the first\n  time, the Initial Configuration Tasks dialog box appears. Accepting\n  the default recommendations for Initial Configuration Tasks turns on\n  the Customer Experience Improvement Program</p>\n</blockquote>\n\n<p>That to me indicates that most users will probably accept the default and CEIP will be turned on in most people's installs.</p>\n\n<p>So my main question is: <strong>Are the quality reports in the Windows Store dashboard done through CEIP, or is CEIP bypassed and the reports are always sent for Windows Store apps?</strong></p>\n\n<p>Kind of related, do these quality reports work and send stack traces for C# apps as well as C++ apps?</p>\n"},{"tags":["c#",".net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13266324,"title":"accessing database","body":"<p>Here is my problem; I have a hosted and published database on godaddy servers. I have also published my website. However, when I tried to use one of visual studio's tools such as chart, or data view or any tool that wants me to specify a data source, I get the </p>\n\n<pre><code>\"error 40: could not open a connection to sql server\".\n</code></pre>\n\n<p>In most cases, I have worked around this issue by writing the code instead of using these tools on the \".cs\" sections, but now I need to update my database model and I really would prefer not to write that amount of code. The connection string I choose works perfectly, it can update and gather values from database on the published website. But when I Right click on the models section and select \"update model from database\" the update wizard cannot access the database with the very same connection string. Like I said, this problem occurs on every tool that wants me to select a data source.</p>\n\n<p>Is this a permission issue regarding visual studio or something else? \nThanks in advance.</p>\n"},{"tags":["c#",".net","string","script#"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13260153,"title":"Using Script# code with string operations in standart C# .NET project","body":"<p>I added reference of Script# to my standart console application. After that I was trying to invoke some method from there but was getting the following error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/uSDdc.png\" alt=\"MissingMethodException\"></p>\n\n<p>I suppose it happened on the following line:</p>\n\n<pre><code>string[] lines = s.Split(';');\n</code></pre>\n\n<p>My assumption is that usual <strong>mscorlib</strong> library has not method <code>public string[] Split(char separator)</code>, but has <code>public string[] Split(params char[] separator)</code></p>\n\n<p>Is it possible to write valid code with such string operations both for a Script# project and for a standart C# .NET project? Due to this problem I have to write duplicate code for both projects with minimal difference.</p>\n\n<p><strong>P.S.</strong> I tried to use assemblty binding redirects, as discussed in <a href=\"http://stackoverflow.com/q/8104853/1046374\">this SO</a> question, but it didn't help me.</p>\n"},{"tags":["c#","listbox","margin"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13277097,"title":"How can I programmatically change a listbox margin?","body":"<p>I am trying to change the margin around a set of programmatically generated listboxes using the following code:</p>\n\n<pre><code>newListBox.Margin = new Thickness(0, 0, 0, 0);\n</code></pre>\n\n<p>However this gives me the error:</p>\n\n<pre><code>the type or namespace Thickness could not be found\n</code></pre>\n\n<p>I tried adding <code>using System.Windows</code> namespace but I still get the same error. Can anyone help please?</p>\n"},{"tags":["c#","button","numericupdown"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13276444,"title":"How do I disable a button when the value in the NumericUpDown control is greater than a certain number?","body":"<p>The button only disables after I click on it. I want it to disable without any interaction as soon as the value in the NumericUpDown control is incremented above a specific point. I have goggled but found no answers, here is my code:             </p>\n\n<pre><code>    private void mybtn_Click(object sender, EventArgs e)\n    {            \n        if (numericud.Value &gt; myArray[r, c] || myArray[r, c] == 0)\n            DisableButton(mybtn);            \n        myArray[r, c] = CalcNewMax(myArray[r, c]);\n        OpenNewForm();\n    }\n\n    private void DisableButton(Button selectedbtn)\n    {\n        selectedbtn.Enabled = false;\n    }\n</code></pre>\n\n<p>Any help is much appreciated, thanks!</p>\n"},{"tags":["c#","asp.net","webcontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13277012,"title":"Casting string to Web Control and targeting variable in container","body":"<p>Using VWD 2010 C#. Default.aspx(.cs).<br>\nWhats to happen: A button changes the color of a label with <code>ID = \"Day31\"</code>.\nGiven that it is the 31st day of the month for this example.\nThe button and label are positioned inside a table inside \"MainContent\".</p>\n\n<pre><code>protected void Red_Click(object sender, EventArgs e)\n{\n    ContentPlaceHolder MainContent = Page.Master.FindControl(\"MainContent\") as   ContentPlaceHolder;\n    int theday;\n    theday = System.DateTime.Now.Day; // example the day is 31st\n    string str=\"Day\"+theday;\n    ClientScript.RegisterStartupScript(this.GetType(), \"myalert\", \"alert('\" + str+ \"');\", true);\n    Label dayLabel = FindControl(str) as Label;\n\n    dayLabel.BackColor = System.Drawing.Color.Red; // this line error, \"Null\"\n}\n</code></pre>\n\n<p>Question: Why is there a <code>Null</code> error message at this line of code?</p>\n"},{"tags":["c#","wpf","progress-bar"],"answer_count":3,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":9990,"score":9,"question_id":1194620,"title":"How do I display progress during a busy loop?","body":"<p>I'm working in C# and WPF, very new to both. </p>\n\n<p>I have a loop that reads plenty of data from an external source. The process takes about 20 seconds, and I want to show the progress to the user. I don't need any fancy progress bars, so I chose to plot my progress in a label that will say \"Step 1/1000\", then change to \"Step 2/1000\" etc.</p>\n\n<p>My code looks something like this:</p>\n\n<pre><code>// \"count\" is the number of steps in the loop, \n// I receive it in previous code\n\nString countLabel = \"/\"+count.ToString();\n\nfor (i = 0; i &lt; count; i++)\n{\n    ... do analysis ...\n    labelProgress.Content = \"Step \"+i.ToString()+countLabel\n}\n</code></pre>\n\n<p>However, during that analysis the screen is \"stuck\" and the progress does not show as advancing. I understand this behavior from my past in C++, where I would probably have a separate thread showing a progress bar receiving notifications from the loop, or some form of repaint/refresh, or forcing the window/app to process its message queue.</p>\n\n<p>What's the right way to do it in C#? I'm not tied to the label, so if there's a simple progress-bar popup screen I could use instead of this label it would also be great...</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","gui","user-interface","windows-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277319,"title":"Disabling windows 7 interface shadows","body":"<p>Is there any method to disable the shadow under a window in my application via C#? I searched on Internet but nothing helps me...</p>\n"},{"tags":["c#","constructor","arguments"],"answer_count":10,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":121,"score":6,"question_id":13260021,"title":"Why am I getting a \"does not contain a constructor that takes 0 arguments\" error? C#","body":"<p>On my form load, I have this code:</p>\n\n<pre><code>    private void Form1_Load(object sender, EventArgs e)\n    {\n        CharityCyclists cyclist1 = new CharityCyclists();\n        CharityCyclists cyclist2 = new CharityCyclists(\"a\", 1, \"Finished\", 0, 0, 0, \"One Wheel\", 1, 500);\n\n        cyclist1.Type = \"Novelty Charity Cyclist\";\n        cyclist1.Number = 1;\n        cyclist1.Finished = \"Not Finished\";\n        cyclist1.Hours = 0;\n        cyclist1.Mins = 0;\n        cyclist1.Secs = 0;\n        cyclist1.Bicycle = \"Tricycle\";\n        cyclist1.Wheels = 3;\n        cyclist1.FundsRaised = 300;\n    }\n</code></pre>\n\n<p>However, I'm getting a error saying \"'CycleEvent.CharityCyclists' does not contain a constructor that takes 0 arguments\", it says the error is to do with this part of the code:</p>\n\n<pre><code>CharityCyclists cyclist1 = new CharityCyclists();\n</code></pre>\n\n<p>Here is my CharityCyclists class:</p>\n\n<pre><code>class CharityCyclists : Cyclists\n{\n    private string bicycle;\n    private int wheels;\n    private double fundsRaised;\n\n    public string Bicycle\n    {\n        get { return bicycle; }\n        set { bicycle = value; }\n    }\n\n    public int Wheels\n    {\n        get { return wheels; }\n        set { wheels = value; }\n    }\n\n    public double FundsRaised\n    {\n        get { return fundsRaised; }\n        set { fundsRaised = value; }\n    }\n\n    public CharityCyclists(String type, int number, String finished, int hours, int mins, int secs, string bicycle, int wheels, double fundsRaised) : base(type, number, finished, hours, mins, secs, fundsRaised)\n    {\n        this.bicycle = bicycle;\n        this.wheels = wheels;\n        this.FundsRaised = fundsRaised;\n    }\n\n    public override string ToString()\n    {\n        return base.ToString() + \" riding a \" + bicycle + \" with \" + wheels + \" wheels\" ;\n    }\n}\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["c#","algorithm","image","hardware","autofocus"],"answer_count":4,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":2084,"score":10,"question_id":4224817,"title":"Autofocus algorithm for USB microscope","body":"<p>I'm trying to design an auto-focus system for a low cost USB microscope. I have been developing the hardware side with a precision PAP motor that is able to adjust the focus knob in the <a href=\"http://www.dealextreme.com/details.dx/sku.29661\" rel=\"nofollow\">microscope</a>, and now I'm in the hard part.</p>\n\n<p>I have been thinking about how to implement the software. The hardware have two USB ports, one for the microscope camera and another for the motor. My initial idea is to write an application in C# that is able to get the image from the microscope and to move the motor forth and backwards, so far so good :)</p>\n\n<p>Now I need a bit of help with the auto-focus, how to implement it? There is any good algorithm for this? Or maybe an image processing library that will help my in my task?</p>\n\n<p>I have been googleling but with no success... I'll appreciate any help/idea/recommendation!</p>\n\n<p>Many thanks :) </p>\n\n<p><strong>EDIT:</strong> Thanks guys for your answers, i'll try all the options and get back here with the results (or maybe more questions).</p>\n"},{"tags":["c#","php","asp.net-mvc","drupal","authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13277128,"title":"Single authentication with Drupal and ASP.NET","body":"<p>I'm an experienced C# developer with a small amount of PHP experience.  I am looking at getting a Drupal instance up and running, but, I will need an ASP.NET instance running along with it since there is going to be custom development work that needs to be done.</p>\n\n<p>I was wondering if anyone had ideas for how to combine authentication for Drupal and ASP.NET so that I don't need to make users authenticate more than once while using the two sites together.</p>\n"},{"tags":["c#","xaml","controls","microsoft-metro"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13276715,"title":"update control on another page windows 8 metro app c#","body":"<p>This is a basic process that I cannot find any info on in Google or reference books on my Kindle account.</p>\n\n<p>In regular forms applications pre-Windows 8, if you are on form 2 and you want to update something on form 1, you just type:</p>\n\n<pre><code>form1.Default.controlOnForm1.text = \"updated text\";\n</code></pre>\n\n<p>This does not work in Windows 8.  </p>\n\n<p>I feel silly asking this, but I have lots of info I need to send across my app.</p>\n\n<p>Thank you.  </p>\n"},{"tags":["c#","nhibernate","object","reference-type"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":82,"score":0,"question_id":13274508,"title":"Calling ToString() on a Reference Type","body":"<p>Given two object arrays I need to compare the differences between the two (when converted to a string). I've reduced the code to the following and the problem still exists:</p>\n\n<pre><code>public void Compare(object[] array1, object[] array2) {\n    for (var i = 0; i &lt; array1.Length; i++) {\n        var value1 = GetStringValue(array1[i]);\n        var value2 = GetStringValue(array2[i]);\n    }\n}\n\npublic string GetStringValue(object value) {\n    return value != null &amp;&amp; value.ToString() != string.Empty ?\n        value.ToString() : \"No Value\";\n}\n</code></pre>\n\n<p>The code executes fine no matter what object arrays I throw at it. However if one of the items in the array is a reference type then somehow the reference is updated. This causes issues later.</p>\n\n<p>It appears that this happens when calling ToString() against the object reference. I have updated the GetStringValue method to the following (which makes sure the object is either a value type or string) and the problem goes away.</p>\n\n<pre><code>public string GetStringValue(object value) {\n    return value != null &amp;&amp; (value.GetType().IsValueType || value is string)\n        &amp;&amp; value.ToString() != string.Empty ? value.ToString() : \"No Value\";\n}\n</code></pre>\n\n<p>However this is just a temporary hack as I'd like to be able to override the ToString() method on my reference types and compare them as well.</p>\n\n<p>I'd appreciate it if someone could explain why this is happening and offer a potential solution. Thanks</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>To help further explain my application. This piece of code is taken from an NHibernate event listener. I think the problem lies from NHibernate adding it's own wrapper around a class to deal with lazy loading. Here's the error it throws:</p>\n\n<blockquote>\n  <p>collection [<em>*</em>] was not processed by flush()</p>\n</blockquote>\n"},{"tags":["c#","asp.net","vb.net","html-agility-pack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13275576,"title":"How can I use HTMLAgilityPack to download a CSV file?","body":"<p>I have the code to go to a website, login with the hidden fields and cookies and include a browser header so that I appear as a normal user.</p>\n\n<p>Now that I am in the protected content I need to download a csv file that I have found within the document using HTMLAgilityPack.</p>\n\n<p>I would like to grab the csv with HTMLAgilityPack so that I can continue to use the cookies and browser user-agent string already setup.</p>\n\n<p>From what I have read HTMLAgilityPack parses the dom. I would expect a csv file to cause an error and return null. But I have seen vague references of being able to grab the raw data of the page/file requested before it is parsed. If so, that would be the solution but I cannot find how to do that.</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13276944,"title":"System.Web.Helpers can't be loaded on one server, works everywhere else, what could be wrong?","body":"<h2>Exception</h2>\n\n<pre><code>Exception: Could not load file or assembly 'System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) \n</code></pre>\n\n<h2>Stack Trace</h2>\n\n<pre><code>at MyWebApp.Logic.Managers.ImagesManager.SaveImage(Stream imageFileStream, Site site)\nat MyWebApp.WebSite.Controllers.ImageController.AddGalleryImage(String qqfile, HttpPostedFileBase uploadFile) in \nC:\\Users\\jhr\\Documents\\subversion\\MyProject\\trunk\\MyWebApp.WebSite\\Controllers\\ImageController.cs:line 67\n</code></pre>\n\n<p>Line #67 of <code>ImageController.cs</code></p>\n\n<pre><code>Image image = _imagesManager.SaveImage(fileStream, site);\n</code></pre>\n\n<p><code>ImagesManager</code> is using the class <code>WebImage</code> out of <code>System.Web.Helpers</code>. This works on multiple laptops and a development server, but I can't get it to work on our QA server.</p>\n\n<p><code>System.Web.Helpers.dll</code> with the correct version is the <code>bin</code> directory of my application <strong>just like on the machines where it works</strong>. I am using the same <code>web.config</code> on all the machines as well. </p>\n\n<p>I am copying a working application from one machine to the other, which is supposed to be configured exactly the same, but I get this exception only on one machine.</p>\n\n<h3>What am I missing?</h3>\n"},{"tags":["c#","windows-mobile","windows-mobile-6"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13251177,"title":"How can I know if this method is supported in Windows Mobile?","body":"<p>There are some classes (of the .NET framework 3.5) that contain some methods that are supported in .NET Compact Framework, and some methods that are not supported. There are also some classes that does not exists for the .NET Compact Framework.</p>\n\n<p>For example for the <a href=\"http://msdn.microsoft.com/en-us/library/system.io.file_members%28v=vs.90%29.aspx\" rel=\"nofollow\"><code>System.IO.File</code></a> class, the <code>File.Create</code> function is supported by .NET Compact Framework, but the <code>File.Encrypt</code> function is not.</p>\n\n<p>Another example: the <code>System.IO.File</code> class is supported by .NET Compact Framework, but the <code>System.Diagnostic.StackTrace</code> is not.</p>\n\n<p>I need to tell to the compiler something like this:</p>\n\n<pre><code>#ifdef COMPACT_FRAMEWORK   // I'm compiling this from a smart device project\n\nMyEncryptMethod(\"filename\");\n\n#else // I'm compiling this from a desktop project\n\nFile.Encrypt(\"filename\");\n\n#endif\n</code></pre>\n\n<p>How can I do?<br>\n(The specific version is Windows Mobile 6.1 Professional).</p>\n"},{"tags":["c#","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13276958,"title":"Why whould I want to disable .NET Code Contracts","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3111332/net-4-0-code-contracts-when-to-use-when-are-they-a-waste-of-time\">.net 4.0 Code Contracts. When to use? When are they a waste of time?</a>  </p>\n</blockquote>\n\n\n\n<p>I started to read the full documentation of the .NET Code Contracts and I noticed that you can specify the compiler not to emit the code corresponding to your contracts. But I was wondering WHY someone would want to do that?! I mean, from the documentation, code contracts are about specifying pre / post / invariants about your code.</p>\n\n<p>Looking at another question <a href=\"http://stackoverflow.com/questions/3111332/net-4-0-code-contracts-when-to-use-when-are-they-a-waste-of-time\">.net 4.0 Code Contracts. When to use? When are they a waste of time?</a>, it seems that contracts should guard against invalid state of an object, but then again, why would I want to disable them! In doing so, wouldn't I open the door for a mountain of problems?</p>\n\n<p>Should they be used as business validation, like making sure that a <code>startDate &lt;= endDate</code> or should I use the good old if-then-throw for business? If I disable the code contracts my class could now be in an invalid state.</p>\n\n<p>So my question remains, why would I want to disable code contracts?</p>\n"},{"tags":["c#",".net","expression-blend","blend","expression-blend-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13277135,"title":"Sort Properties of my Control in Expression Blend designer","body":"<p>I created my new Category \"MyCategory\" to store all my Properties of my Control, in design mode (Expression Blend 4), like theses categories:</p>\n\n<p><img src=\"http://i.stack.imgur.com/J4Jsd.png\" alt=\"enter image description here\"></p>\n\n<p>By default, all my properties under my Category are sorted alphabetically. </p>\n\n<p>Is it possible to choose the order ?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","xaml","video","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13277133,"title":"Play a video on the default media player from a Windows Store App?","body":"<p>I want to implement a function that plays a video in the default media player from a windows store apps that uses Xaml and C#.</p>\n\n<p>I don't want to embed the player I want to open a new window with the default player and tell it to play the selected file.</p>\n\n<p>All the samples that I've found are to create an embedded player or send to a device.</p>\n\n<p>Can anybody help me?\nThanks...</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13276973,"title":"Fisrt line of private void listBox1_SelectedIndexChanged(object sender, EventArgs e) always gets an error","body":"<p>im trying delete an item on a listbox but when I press the button to delete it the first line of the code in the private void listBox1_SelectedIndexChanged(object sender, EventArgs e) gets an error.</p>\n\n<pre><code>private void listBox1_SelectedIndexChanged(object sender, EventArgs e)\n  {\n      textBox1.Text = listBox1.SelectedItem.ToString();   \n  }\n</code></pre>\n\n<p>here is the error\nObject reference not set to an instance of an object.</p>\n"},{"tags":["c#","table","field","resultset"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":13276832,"title":"How do I check if a ResultTable has a field or not?","body":"<p>So for example:</p>\n\n<pre><code>while(reader.Read())\n{\n   var test = reader[\"NonExistentField\"];\n}\n</code></pre>\n\n<p>That will give me an error. Testing for null (<code>reader[\"NonExistentField\"] == null ?</code>) does the same.</p>\n"},{"tags":["c#","javascript","encryption","rc4-cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13075326,"title":"RC4 Algorithm: Unable to Encrypt / Decrypt data where client uses Javascript and Server c#","body":"<p>I need to pass encrypted (and base64 encoded) string data between a .NET 4.0 WCF application hosted in IIS (basicHttpBinding) and an internal client application system that uses a JavaScript RC4 algorithm implementation to encrypt / decrypt data. </p>\n\n<p>So far I have not succeeded in sending data encrypted by the client to the server and then decrypting it on the server (or the reverse - where the client decrypts data received from a server response). We have tried a few variations of RC4 algorithms found in JavaScript files on the internet (and also AES).</p>\n\n<p>I have converted the version of the RC4 algorithm the client is using to C# (JavaScript file located at: <a href=\"https://gist.github.com/2185197\" rel=\"nofollow\">https://gist.github.com/2185197</a>). I created an html page to test the JavaScript encrypt / decrypt functionality in a purely client-side manner. This works. Similarly, through unit testing, I have established that the c# Encrypt / Decrypt also works within the .NET WCF service. With these tests, there was no base64 Encoding / Decoding.</p>\n\n<p>Using the c# RC4 algorithm, I can successful handle encryption / decryption of data sent over the wire where the encrypted data is base64 encoded AND where the client is a .NET application (using same C# algorithm implementation class as the server) </p>\n\n<p>I have stepped through the client-side JavaScript (Firebug) and C# (Visual Studio) algorithm line by line, verifying if variable values match. Everything matches except for where code converts an integer value to String (via Char). The result here is inconsistent. Below is the problem line.</p>\n\n<p>Below is the line of code for each implementation.</p>\n\n<p>C#: \nvar charX = Convert.ToChar(26).ToString();</p>\n\n<p>JavaScript:</p>\n\n<p>Var charX = String.fromCharCode(26);</p>\n\n<p>Some visual differences might simply be due to the rendering abilities of Firebug and Visual Studio. [My understanding is that they both should be rendering UTF8 Encoded strings]. I have read that the JavaScript Engine and JavaScript Language differ in their encoding. As such Microsoft has implemented a fix [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode] that I tried to implement without success. There might be some encoding that I need to implement in the C# code; but as yet have not yet identified </p>\n\n<p>As per the above example for integer value 26, C# code shows a left arrow when the variable value is inspected. The JavaScript shows a white space. For the JavaScript, this is consistent with the tests done via the W3Shools (http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_fromcharcode)</p>\n\n<p>Do I need to perform some sort of Encoding in the .NET application to ensure that the character handling is consistent in JavaScript v C#?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Below is the JavaScript code:</p>\n\n<pre><code> function rc4(key, str) {\n        var s = [], j = 0, x, res = '';\n        for (var i = 0; i &lt; 256; i++) {\n            s[i] = i;\n        }\n        for (i = 0; i &lt; 256; i++) {\n            j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;                \n        }\n        i = 0;\n        j = 0;\n        for (var y = 0; y &lt; str.length; y++) {\n            i = (i + 1) % 256;\n            j = (j + s[i]) % 256;\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;\n\n            //res += String.fromCharCode(str.charCodeAt(y) ^ s[(s[i] + s[j]) % 256]);\n\n            var sx = s[i] + s[j];\n            var ssx =  s[sx % 256];\n            var fromChar1 =str.charCodeAt(y);\n            var fromChar2 = (fromChar1 ^ ssx);\n            var fromChar3 = String.fromCharCode(fromChar2);  //******  PROBLEM LINE *******\n            //var fromChar3 = fixedFromCharCode(fromChar2);                \n            res += fromChar3;\n        }\n        return res;\n    }\n\n    //Fix as per Microsoft\n    //https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode\n     function fixedFromCharCode(codePt) {\n        if (codePt &gt; 0xFFFF) {\n            codePt -= 0x10000;\n            return String.fromCharCode(0xD800 + (codePt &gt;&gt; 10), 0xDC00 + (codePt &amp; 0x3FF));\n        }\n        else {\n            return String.fromCharCode(codePt);\n        }\n    }\n</code></pre>\n\n<p>Below is the c# code:</p>\n\n<pre><code>public class RC4\n{\n    public static string Encrypt(string key, string data)\n    {\n        var s = new List&lt;int&gt;();\n        var j = 0;\n\n        var x = 0;\n        var res = string.Empty;\n\n        for (var i = 0; i &lt; 256; i++)\n        {\n            s.Add(i);\n        }\n\n        for (var i = 0; i &lt; 256; i++)\n        {\n            var unicodeInt01 = ConvertedCharacterToItsUnicodeNumberic(key, i);\n\n            j = (j + s[i] + unicodeInt01) % 256;\n\n            x = s[i];\n            s[i] = s[j];\n            s[j] = x;\n        }\n\n        var f = 0;\n        j = 0;\n        for (var y = 0; y &lt; data.Length; y++)\n        {\n            f = (f + 1) % 256;\n            j = (j + s[f]) % 256;\n            x = s[f];\n            s[f] = s[j];\n            s[j] = x;\n\n            var unicodInt02 = ConvertedCharacterToItsUnicodeNumberic(data, y);\n            var convStringOperationApplied = unicodInt02 ^ s[(s[f] + s[j]) % 256];\n\n            var charX = Convert.ToChar(convStringOperationApplied);   //******  PROBLEM LINE *******\n            var val = new string(charX, 1);\n            res += val;\n\n        }\n\n        return res;\n    }\n\n    private static int ConvertedCharacterToItsUnicodeNumberic(string key, int i)\n    {\n        return key.ElementAt(i % key.Length);\n    }\n\n    public static string Decrypt(string key, string data)\n    {\n        return Encrypt(key, data);\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","linq","linq-to-entities"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":669,"score":4,"question_id":1689199,"title":"C# - code against a property using the property name as a string","body":"<p>What's the simplest way to code against a property in C# when I have the property name as a string?  For example, I want to allow the user to order some search results by a property of their choice (using LINQ).  They will choose the \"order by\" property in the UI - as a string value of course.  Is there a way to use that string directly as a property of the linq query, without having to use conditional logic (if/else, switch) to map the strings to properties.  Reflection?</p>\n\n<p>Logically, this is what I'd like to do:</p>\n\n<pre><code>query = query.OrderBy(x =&gt; x.\"ProductId\");\n</code></pre>\n\n<p>Update:\nI did not originally specify that I'm using Linq to Entities - it appears that reflection (at least the GetProperty, GetValue approach) does not translate to L2E.</p>\n"},{"tags":["c#","winforms","treeview"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":763,"score":3,"question_id":10362988,"title":"Treeview flickering?","body":"<p>I came to know that by adding TreeView.BeginUpdate will prevent flickering of treeview, but when i added it in to my project all nodes of my treeview disappears, Can any body tell me why it happens, here is the code snippet where i used TreeView.BeginUpdate and TreeView.EndUpdate</p>\n\n<pre><code>  TreeNode treeNode = new TreeNode(\"Windows\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Another node following the first node.\n        //\n        treeNode = new TreeNode(\"Linux\");\n        treeView1.Nodes.Add(treeNode);\n        //\n        // Create two child nodes and put them in an array.\n        // ... Add the third node, and specify these as its children.\n        //\n        TreeNode node2 = new TreeNode(\"C#\");\n        TreeNode node3 = new TreeNode(\"VB.NET\");\n        TreeNode[] array = new TreeNode[] { node2, node3 };\n        //\n        // Final node.\n        //\n        treeNode = new TreeNode(\"Dot Net Perls\", array);\n        treeView1.Nodes.Add(treeNode);\n</code></pre>\n"},{"tags":["c#","winforms","visual-studio-2010",".net-4.0","listbox"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":5834,"score":1,"question_id":6504336,"title":"Get the value for a listbox item by index","body":"<p>This must be very easy but I am stuck.\nI have a listbox with X Items. Each Item has a text description (Whhich appears in the listbox) and its value(numerical). \nI want to be able to get the value property for an item, using the index number of the item.</p>\n"},{"tags":["c#","jquery","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13276570,"title":"ReferenceError: Model not defined in view","body":"<p>I get the following error, \"ReferenceError: Cat is not defined\", when trying to pass a model to view and print out it's text value with JavaScript. Why is there a reference error and how to fix it?</p>\n\n<p>Model:</p>\n\n<pre><code>public class Animal\n{\n    public List&lt;SelectListItem&gt; AnimalList { get; set; }\n\n    public Animal()\n    {\n        SelectListItem animalItem = new SelectListItem();\n        animalItem.Text = \"Cat\";\n        animalItem.Value = \"1\";\n\n        AnimalList = new List&lt;SelectListItem&gt;();\n        AnimalList.Add(animalItem);\n    }\n}\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>    public ActionResult Index()\n    {\n        var model = new Animal();\n\n        return View(model);\n    }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function () {\n    @foreach (var item in Model.AnimalList)\n    {\n        &lt;text&gt;\n            console.log(@item.Text);\n        &lt;/text&gt;\n    }\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>By the way. It works fine if I set the text to a number, for example 0.</p>\n"},{"tags":["c#","vsto","outlook-addin","outlook-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13261075,"title":"C# Outlook 2010 Addin - AppointmentItem.ItemProperties.Add Exception","body":"<p>I am working on an Outlook add-in that adds a Form Region to IPM.Appointment message classes. When this region is showed, it will first add a few properties to the AppointmentItem.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Outlook.AppointmentItem appItem;\n\nprivate void FormRegion_FormRegionShowing(object sender, System.EventArgs e)\n{\n    try\n    {\n        appItem = (Outlook.AppointmentItem)this.OutlookItem;\n\n        appItem.ItemProperties.Add(\"CustomProperty\", Outlook.OlUserPropertyType.olText);\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.ToString());\n    }\n}\n</code></pre>\n\n<p>This works fine on my calendar, but if I try to use the addin with a delegate calendar that I have either Editor or Owner access to, it throws the following exception:</p>\n\n<pre><code>System.UnauthorizedAccessException: You don't have appropriate permission to perform this operation.\n  at Microsoft.Office.Interop.Outlook.Itemproperties.Add(String Name, OlUserPropertType Type, ObjectAddToFolderFields, Object DisplayFormat)\n  at ThisAddin.FormRegion.FormRegion_FormRegionShowing(Ovject sender,EventArgs e)\n</code></pre>\n\n<p>Any and all help is appreciated!</p>\n"},{"tags":["c#","xml-documentation"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13267304,"title":"C#: How to display generic parameter arguments in xml documentation","body":"<p>I can reference a generic type/method definition like this:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Takes a &lt;see cref=\"Func{T}\"/&gt;.\n/// &lt;/summary&gt;\npublic void Method&lt;T&gt;(Func&lt;T&gt; func) { }\n</code></pre>\n\n<p>However this does not work:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Takes a &lt;see cref=\"Func{Int32}\"/&gt;.\n/// &lt;/summary&gt;\npublic void Method(Func&lt;int&gt; func) { }\n</code></pre>\n\n<p>ReSharper / the generated help file says <code>Func&lt;TResult&gt;</code>.</p>\n"},{"tags":["c#","ilmerge"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13276481,"title":"Embedding\\Merging .NET v1 Assemblies on .NET v4+ Assembly","body":"<p>I have a C# library with some assemblies developed by us and some third-party o I need put everything in a single assembly file.</p>\n\n<p>When I try to <strong>merge</strong> everything using ILMerge I got the following error:</p>\n\n<blockquote>\n  <p>An exception occurred during merging: </p>\n  \n  <p>ILMerge.Merge: The assembly 'TestLibrary' is not marked as\n  containing only managed code.   (Consider using the /zeroPeKind option\n  -- but read the documentation first!)\n       em ILMerging.ILMerge.Merge()\n       em ILMerging.ILMerge.Main(String[] args)</p>\n</blockquote>\n\n<p>When I remove TestLibrary from the Merge, it works fine. But to get my project working I have reference the TestLibrary separately and enable useLegacyV2RuntimeActivationPolicy=\"true\".</p>\n\n<p>So, after a little more research I decided to try using Embedded Resources using <a href=\"http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx\" rel=\"nofollow\" title=\"Jeffrey Richter\">Jeffrey Richter</a>:</p>\n\n<pre><code>AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =&gt; {\n   String resourceName = \"AssemblyLoadingAndReflection.\" +\n      new AssemblyName(args.Name).Name + \".dll\";\n   using (var stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName)) {\n      Byte[] assemblyData = new Byte[stream.Length];\n      stream.Read(assemblyData, 0, assemblyData.Length);\n      return Assembly.Load(assemblyData);\n   }\n};\n</code></pre>\n\n<p>It loads the resource bytes but fails on Assembly.Load saying that the program have a incorrect format.</p>\n\n<p>The TestLibrary is a C++ .Net v1.0 Library.</p>\n"},{"tags":["c#","class","partial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13276804,"title":"partial class does not contain definition","body":"<p>I got a weird problem and finally fixed it. Just like to share this expeirence so other people will search this topic and get the answer.\nI defined 2 partial classes, and compiled with the error of \"does not contain a definition for ...\". It was weird because it worked when the 2 classes were individual classes.</p>\n\n<p>Here is the code:</p>\n\n<p>Before:\nFoo1.cs</p>\n\n<pre><code>public class foo1{public void xyz(){}}\n</code></pre>\n\n<p>Foo2.cs</p>\n\n<pre><code>public class foo2{}\n</code></pre>\n\n<p>After:\nFoo1.cs</p>\n\n<pre><code>public partial class foo1{  public void xyz(){}}\n</code></pre>\n\n<p>Foo2.cs</p>\n\n<pre><code>public partial class foo1{}\n</code></pre>\n\n<p>Compilation said \"MyNamespace.foo1 does not contain a definition for xyz\". But xyz was good when the class was not partial! This could be caused by different namespaces. But I doubted that. Because if namespaces were different, it would not compile.</p>\n\n<p>I figured out at last. The problem was in Foo1.cs, the namespace was not defined but it was defined in Foo2.cs. Before I defined the partial class, the compiler provided a default namespace to Foo1.cs, that was the same as the one defined explicitly in Foo2.cs. But with the partial class, the compiler would not provide a default namespace to the partial class. This is why the compiler complained when a third party called foo1.xyz().</p>\n\n<p>I learned a lesson that always define the namespace explicitly for each single cs file, except that you do not define the namespace.</p>\n"},{"tags":["c#",".net","winapi","cracking","detours"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13276741,"title":"Prevent detouring functions. Avoid cracking","body":"<p>There is an application that checks for activation using DLL <code>Check</code> function. <code>Check</code> returns 1 if application is activated and 0 otherwise. I create simple application and DLL containing function <code>MyCheck</code> (which always returns 1) with the same signature and detoured <code>Check</code> function with my version using MS detours lib for function hooking. Obviously it works and the application is successfully cracked, so I need to avoid it.</p>\n\n<ol>\n<li><p>I tried to call <code>Check</code> function directly (by specifying exact address), without even using <code>GetProcAddress</code>, but looks like detours lib is modifying the function body itself, not export table.</p>\n\n<pre><code>[UnmanagedFunctionPointer(CallingConvention.StdCall)]\nprivate delegate bool CheckFunctionDelegate();\n\nstatic void Main(string[] args)\n{\n    ProcessModule module = Process.GetCurrentProcess().Modules\n        .Cast&lt;ProcessModule&gt;()\n        .First(m =&gt; m.ModuleName == \"licensing_check.dll\");\n\n\n    IntPtr procedurePtr = IntPtr.Add(module.BaseAddress, 0x00003FF0);\n\n    // Calling validation function by pointer\n    CheckFunctionDelegate checkFunction = (CheckFunctionDelegate)\n        Marshal.GetDelegateForFunctionPointer(procedurePtr, typeof(CheckFunctionDelegate));\n\n    if (checkFunction())\n    {\n        // do some stuff\n    }\n}\n</code></pre>\n\n<p>}</p></li>\n<li><p>Then I tried to read function body and I see that after detour MD5 checksum differs from the original one. So I'm trying to read entire contents of DLL in memory and check it to confirm that DLL contents are not changed, but it doesn't work either. It throws <code>AccessViolationException</code>.</p>\n\n<p>Process.EnterDebugMode();</p>\n\n<p>ProcessModule module = Process.GetCurrentProcess().MainModule;\nbyte[] data = new byte[module.ModuleMemorySize];\nMarshal.Copy(module.BaseAddress, data, 0, module.ModuleMemorySize);</p></li>\n</ol>\n\n<p>I used MainModule here, but it gives the same error for each module in <code>Process.GetCurrentProcess().Modules</code> collection.</p>\n\n<p>I would appreciate any help on this, I'm not necessarily expecting to solve it in one of the ways I describe, any good solution is acceptable.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","string"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":34,"score":-3,"question_id":13276210,"title":"A method to execute cmd prompt command going wrong","body":"<p>I have this method </p>\n\n<pre><code>private void _executeCommand(string commandStr, int timeout)\n         {\n\n            try\n            {\n               System.Diagnostics.ProcessStartInfo procStartInfo =\n                   new System.Diagnostics.ProcessStartInfo(\"cmd\", \"/c \" + commandStr);\n               procStartInfo.RedirectStandardOutput = true;\n               procStartInfo.UseShellExecute = false;\n               // Do not create the black window.\n               procStartInfo.CreateNoWindow = true;\n               // Now we create a process, assign its ProcessStartInfo and start it\n               System.Diagnostics.Process proc = new System.Diagnostics.Process();\n               proc.StartInfo = procStartInfo;\n               proc.Start();\n               Thread.Sleep(timeout);\n\n            }\n            catch (ExecutionEngineException e)\n            {\n\n               throw e;\n\n            }}\n</code></pre>\n\n<p>somehow, if I pass a string called <code>myCmd</code>, <code>_executeCommand(myCmd, timeout)</code>, it does nothing. But if I pass the exact string value of <code>myCmd</code>, <code>_executeCommand(\"copy //data//file \\\"C://Program Files/myApp\\\"\", timeout)</code>, it was able to execute. Could anyone see what the problem is? </p>\n"},{"tags":["c#","vb.net","mixed","mixed-language"],"answer_count":3,"favorite_count":8,"up_vote_count":8,"down_vote_count":0,"view_count":5476,"score":8,"question_id":2339776,"title":"Mixing VB.Net and C# Code in an ASP.Net Web Site project?","body":"<p>The question quite an older and often asked around, i have similar questions here but my question is a bit more specific.</p>\n\n<p>Q1. Is it legal to mix C# and VB.Net code in ASP.Net Web site? Will it work or not? If it works how it may be done? Any sample will be good.</p>\n\n<p>Q2. If there are any repercussions of mixing C# and VB.Net code then please do share those as well.</p>\n\n<p>I have a web project that is coded in VB.Net. I am working on one module of the project. and i want to code in C#. I cant convert the whole project to C# because i am not the only one working on the project. However, the module i intend to build , i want to have that built in C#. </p>\n\n<p>I have heard that in case of web projects, if we code part in C# and part in VB.net then there are problems compiling the project to a dll. Is that true? if yes then what is the solution. </p>\n\n<p>Also, if i am building a dynamic link library in .Net then can i mix C# and Vb.Net code?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13276236,"title":"C# Custom paste like feature","body":"<p>I am trying to create a way or inserting text anywhere on the system in Windows, much like the clipboard works. For example, pressing ctrl+shift+1 would 'paste' text set in my application into where the user is currently pointing the cursor. </p>\n\n<p>For example, if my application sets it to be 'local.network' and the user presses ctrl+shift+1 in their browser address bar, it would paste in 'local.network'. I then want to have different values set, depending on what number the user presses. Is this possible or can I not create a system wide function like this?</p>\n"},{"tags":["c#",".net","vb.net","winforms","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13276201,"title":"PDB file and error handling?","body":"<p>We have a windows form application running across different customers, when they get errors we log into a database &amp; using that stack information that is logged, we correct the issue.</p>\n\n<p>However there are issues that occur only in production, the stack shows for example</p>\n\n<blockquote>\n  <p>CalculateTotals(method name) :NullReferenceException: Object reference not set to instance of an object.</p>\n</blockquote>\n\n<p>The CalculateTotals is a method name, that has lots of sub-method calls &amp; more lines, i am not able to get the exact line # of the code where it fails.</p>\n\n<p>My application's PDB file is not sent to customers (when they do installation),</p>\n\n<p>how do i keep a copy of that .PDB file (may be in a remote location and \nnot make it part of installation) and use that to \ndebug the errors &amp; get the exact line?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13276587,"title":"DialogResult.Ok like Custom Class","body":"<p>I am trying to develop a custom input dialog box. In its constructor I want to take a parameter as follows-</p>\n\n<pre><code>PromptType.Question\nPromptType.Information\nPromptType.Feedback\n//etc....\n\nprivate void buttonTest_Click(object sender, System.EventArgs e) \n{\n   InputBoxResult result = InputBox.Show(\"Some title\",PromptType.Question);\n}\n</code></pre>\n\n<p>How can i do it?? </p>\n"},{"tags":["c#","file-io","filestream"],"answer_count":2,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":57,"score":9,"question_id":13276506,"title":"Is it safe to keep C# Filestream open for long periods of time?","body":"<p>Inside my web service, I open a filestream to a file on local disk. I keep this around for the lifetime of the service. For every query that comes in, I use the filestream to read the disk.\nI do this to avoid having to reopen the filestream on every query. Latency of this path is critical (should less than few ms). I use SSD to keep disk IO time to 0.1ms or less.</p>\n\n<p>Can the filestream 'go bad' (become invalid) over long periods of time (days). Is it safer to just reopen the filestream on every query? If I have to reopen, what's the overhead of constantly reopening a filestream several times a second?</p>\n"},{"tags":["c#","debugging","process.start"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13276634,"title":"Visual Studio - Keeping command window open","body":"<p>So I'm debugging a C# program in Visual Studio, and it launches a command window for <code>Process.Start</code>.</p>\n\n<p>I want to keep this window open - however the method I tried - doing a <code>Console.Readline();</code> didn't work.</p>\n\n<p>Is there a standard way to keep a console window open so that I can see what happens when the program executes? It would be very helpful for debugging</p>\n"},{"tags":["c#",".net","datetime","timespan"],"answer_count":15,"favorite_count":6,"up_vote_count":25,"down_vote_count":0,"view_count":10051,"score":25,"question_id":1525990,"title":"Difference in months","body":"<p>In C#/.NET <code>TimeSpan</code> has <code>TotalDays</code>, <code>TotalMinutes</code>, etc. but I can't figure out a formula for total months difference. Variable days per month and leap years keep throwing me off. How can I get <strong>TotalMonths</strong>?</p>\n\n<p><strong>Edit</strong> Sorry for not being more clear: I know I can't actually get this from <code>TimeSpan</code> but I thought using <code>TotalDays</code> and <code>TotalMinutes</code> would be a good example to express what I was looking for ... except I'm trying to get Total Months.</p>\n\n<p>Example: Dec 25, 2009 - Oct 6, 2009 = 2 TotalMonths. Oct 6th to Nov 5th equals 0 months. On Nov 6th, 1 month. On Dec 6th, 2 months</p>\n"},{"tags":["c#","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13276576,"title":"How do I get the contents of a web page that is behind a log-in page?","body":"<p>This works, expect, I'm downloading the string of the log-in page and not the actual page (url variable).</p>\n\n<p>How do I get the contents of a page that is behind a log-in?</p>\n\n<pre><code>var credentials = new NetworkCredential { UserName = \"xxxxxx\", Password = \"yyyyyy\" };\nusing (var client = new WebClient())\n{\n    client.Credentials = credentials;\n\n    string page = client.DownloadString(url);\n\n    if (page.Contains(\"cheetah\"))\n    {\n         MessageBox.Show(\"cheetah exists\");\n    }\n    else\n    {\n         MessageBox.Show(\"NOPE\");\n    }\n }\n</code></pre>\n"},{"tags":["c#","visual-studio-2005","file-association","process.start"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":752,"score":3,"question_id":884012,"title":"How to bring up the \"Windows cannot open this file\" dialog?","body":"<p>My users can attach documents to various entities in the application.  Of course, if user A attaches a .TIFF file, user B may not have a viewer for that type of file.  </p>\n\n<p>So I'd like to be able to bring up this dialog:</p>\n\n<p><img src=\"http://www.angryhacker.com/toys/cannotopen.png\" alt=\"alt text\" /></p>\n\n<p>My application is C# with VS2005.<br />\nCurrently I do Process.Start and pass in the file name.  If no association is found, it throws an exception.</p>\n"},{"tags":["c#","parameters","ado.net","sqldataadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13276602,"title":"c# Using Parameters.AddWithValue in SqlDataAdapter","body":"<p>How can i use Parameters.Add.WithValue in SqlDataAdapter. Below searching codes.</p>\n\n<pre><code>var da = new SqlDataAdapter(\"SELECT * FROM annotations WHERE annotation LIKE '%\"+txtSearch.Text+\"%'\", _mssqlCon.connection);\nvar dt = new DataTable();\nda.Fill(dt);\n</code></pre>\n\n<p>I rewrote the code like this:</p>\n\n<pre><code>SqlDataAdapter da;\nda = new SqlDataAdapter(\"SELECT * FROM annotations WHERE annotation LIKE '%@search%'\", _mssqlCon.connection);\nda.SelectCommand.Parameters.AddWithValue(\"@search\",txtSearch.Text);\nvar dt = new DataTable();\nda.Fill(dt);\n</code></pre>\n\n<p>But failed. Could you help me where is my fault?<br /> Yours sincerely.</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13274792,"title":"Filter DataGridView","body":"<p>ive searched the internet for a solution for my problem, me and my studygrp is making a datagridview that takes information from a classLibrary. all that works but now we got to filter it but all i can find is by bindingsource but thats not what i was thinking. i just want a simple filter so that u can enter something in a textbox and it shows it on the datagridview if it contains that information. ive tryed </p>\n\n<pre><code>try\n   {\n      ((DataTable)dataGridView1.DataSource).DefaultView.RowFilter = \"FromColumn like '%\" + textBox1.Text + \"%'\";\n   }\ncatch (Exception) { }\n</code></pre>\n\n<p>but it doesnt work like i want it to hmmn... anyone that can help?</p>\n"},{"tags":["c#","inheritance","oop","compiler-errors"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":616,"score":1,"question_id":3558177,"title":"How to prevent hide or override on a public property","body":"<p>I have an abstract base class that has a Property on it that I would like to prevent both hiding, aka new, and override on.</p>\n\n<pre><code>public abstract class DomainObject\n{\n    public bool IsDeleted { get; set; }\n}\n\npublic class BankAccount : DomainObject\n{\n    public bool IsDeleted { get; set; }\n}\n</code></pre>\n\n<p>The issue is: I need BankAccount to inherit from the base DomainObject class, so I can't mark it as sealed, but I want to prevent the situation, an override or new, of IsDeleted at compile time.</p>\n"},{"tags":["c#","visual-studio-2010","oracle","cultureinfo"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13275628,"title":"ToDecimal Regional / Culture problems","body":"<p>I'm receiving from the Oracle database the following value (as varchar): <code>7876,72</code>\nIn Visual Studio it's read as a <code>String</code></p>\n\n<p><strong>CASE 1 (expected case):</strong></p>\n\n<p>When I'm debuggin I see: <code>7876.72</code> and when I try to <code>Convert.ToDecimal(\"7876.72\")</code> I'm getting <code>7876.72D</code></p>\n\n<p><strong>CASE 2 (wrong case):</strong></p>\n\n<p>When I'm debuggin I see: <code>7876,72</code> and when I try to <code>Convert.ToDecimal(\"7876,72\")</code> I'm getting <code>787672D</code></p>\n\n<p>I'm checking the <code>CultureInfo.CurrentCulture</code> and <code>RegionInfo.CurrentRegion</code> and it's the same on both machines...</p>\n\n<p>The main reason of this is because:</p>\n\n<p><code>Convert.ToDecimal(\"7876,72\").ToString(\"0,0.00\", CultureInfo.InvariantCulture)</code> gives me: <code>787,672.00</code> and it should be <code>7,876.72</code>.</p>\n\n<p><strong>Global.asax - Application_Start</strong></p>\n\n<pre><code>Dim newCulture As CultureInfo = DirectCast(System.Threading.Thread.CurrentThread.CurrentCulture.Clone(), CultureInfo)\nnewCulture.DateTimeFormat.ShortDatePattern = \"yyyy/MM/dd\"\nnewCulture.DateTimeFormat.DateSeparator = \"/\"\nnewCulture.NumberFormat.CurrencyDecimalSeparator = \".\"\nnewCulture.NumberFormat.NumberDecimalSeparator = \".\"\nThread.CurrentThread.CurrentCulture = newCulture\n</code></pre>\n\n<p>Any ideas on how to keep the same value on both machines?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","vb.net","reboot"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":85,"score":5,"question_id":13276147,"title":"programmatically reboot in safe mode then execute program","body":"<p>I have a program and once the is button clicked I want a message to appear that will tell user that the computer is rebooting (with ok/cancel option), then the computer will reboot. Yet the kicker is, I want it to reboot into safe mode. Then when the user is logged into safe mode, it will automatically start a program on startup.</p>\n\n<p>Now I realize that this is possible by programmatically editing boot.ini with /safemode, task to start program once computer logs in,then telling the computer to reboot.However, the end user is assumed to have not enough knowledge of Windows to reverse these settings manually.</p>\n\n<p>What I want is, after the end user is done with the program in Windows Safe Mode, they can simply reboot the computer and resume using Windows with out manually changing any settings to the way they were before booting into safe mode. </p>\n\n<p>NOTE* the program that will run in safe mode, has been tested to work in safe mode. I just need to know how to get the end user to safe mode and run the program automatically with out the end user having any knowledge of how to reverse these settings.</p>\n\n<p>Could anyone suggest a method to execute all this madness?  An example in C# or vb.net would be great!</p>\n\n<p>Thank you in advance!</p>\n\n<p>Ben</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":37,"score":-1,"question_id":13275975,"title":"CircularBuffer highly efficient implementation (both thread-safe and not thread-safe)","body":"<p>Could someone suggest good CircularBuffer implementation? I need both \"not thread-safe\" and \"thread-safe\" versions. I expect following operations:</p>\n\n<ul>\n<li>ability to provide size of the buffer when creating</li>\n<li>adding elements</li>\n<li>iterating elements</li>\n<li>removing elements while iterating</li>\n<li>probably removing elements</li>\n</ul>\n\n<p>I expect implementation to be highly optimized in terms of speed and used memory, average and worst times etc.</p>\n\n<p>I expect \"not thread-safe\" implementation to be extremely fast. I expect \"thread-safe\" implementation to be fast, probably using \"lock-free code\" for synchronization and it's ok to have some restrictions if this is required for speed.</p>\n\n<p>If buffer is too small to store new (added) element it's ok to silenty override existent element or raise exception.</p>\n\n<p>Should I use disruptor.net?</p>\n\n<p>Adding link to a good example <a href=\"http://stackoverflow.com/questions/8860684/disruptor-net-example\">Disruptor.net Example</a></p>\n"}]}
{"total":375450,"page":12,"pagesize":100,"questions":[{"tags":["c#","xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":372,"score":1,"question_id":1928005,"title":"C# Display in XML Format","body":"<p>I am expecting an xml as output when execute the following</p>\n\n<pre><code>XElement Root = XElement.Load(@\"d:\\xmlfiles\\Customers.xml\");\nXElement BringContact = Root.Element(\"Contact\");\nResponse.Write(BringContact);\n</code></pre>\n\n<p>as</p>\n\n<pre><code>&lt;Contact&gt;\n  &lt;Company&gt;Alfreds Futterkiste&lt;/Company&gt;\n  &lt;City&gt;Berlin&lt;/City&gt;\n&lt;/Contact&gt;\n</code></pre>\n\n<p>But the Response.Write() displays  values only\nas</p>\n\n<pre><code>Alfreds Futterkiste Berlin\n</code></pre>\n\n<p>What is the code change do i need?</p>\n"},{"tags":["c#","linq","collections"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":218,"score":1,"question_id":6228129,"title":"Linq Get Collection of collocated equal objects","body":"<p>The following code shows what I want to do:</p>\n\n<pre><code>public static IEnumerable&lt;IEnumerable&lt;T&gt;&gt; DoIt&lt;T&gt;(this IEnumerable&lt;T&gt; that)\n{\n    if (that == null)\n        throw new ArgumentNullException();\n\n    if (that.Count() &gt; 1)\n    {\n        var result = new Collection&lt;IEnumerable&lt;T&gt;&gt;();\n        var collection = new Collection&lt;T&gt;();\n\n        collection.Add(that.ElementAt(0));\n        for (int i = 1; i &lt; that.Count(); ++i)\n        {\n            if (!that.ElementAt(i).Equals(that.ElementAt(i - 1)))\n            {\n                result.Add(collection);\n                collection = new Collection&lt;T&gt;();\n            }\n\n            collection.Add(that.ElementAt(i));\n        }\n\n        result.Add(collection);\n        return result;\n    }\n\n    return new Collection&lt;IEnumerable&lt;T&gt;&gt;() { that };\n}\n</code></pre>\n\n<p>I'm only using custom implementations like that one, if there is no appropriate implementation already existing. Is there any way to do the same with the standard framework?</p>\n"},{"tags":["c#","sql-server","sqlcommand"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13276173,"title":"SQL command returns invalid object name database.table","body":"<p>I run this code:</p>\n\n<pre><code>                    SqlConnection polaczenie;\n                    polaczenie = new SqlConnection(dane_polaczenia);\n                    SqlCommand cmd = new SqlCommand();\n                    cmd.Connection = polaczenie;\n                    polaczenie.Open();\n                    cmd.CommandText = @\"SELECT * FROM test.test\";\n                    cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>After executing I got exception <code>Invalid object name 'test.test'.</code> </p>\n\n<p>Database and table values are correct.</p>\n\n<p>How to specify <code>database.table</code> in <code>CommandText</code> correctly?</p>\n"},{"tags":["c#","visual-studio-2010","performance-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13276513,"title":"Best way to load test without webtest in Visual Studio","body":"<p>I've been running load tests to test the overall performance of the system we're building, but I've run in to an issue and I'm not sure of the best way to solve it. What I want to do is have some other commands that get run that are not a web request, but I would like to still use all the loadtest functionality (counter monitoring, concurrent users, etc....). I haven't found a way to do this without having to make an actual webtest. I can obviously cheat the webtest and have it return a dummy web request. But I was curious if there was a better way of doing this. It seems like something that would be at least somewhat common but I was unable to find any information.</p>\n"},{"tags":["c#","winforms","cmd","cmd.exe"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":397,"score":4,"question_id":11767654,"title":"Sending commands to cmd prompt in C#","body":"<p>For one of my implementations I am working on a tool that is supposed to send/retrieve commands/results to/from the cmd window. Everything works fine but the Use case below fails to do anything. It seems as if my application is waiting for something (instead of displaying the result) </p>\n\n<p>From my tool I navigate to the python folder . From the python folder I try to launch  python.exe but at this point, my editor does not do anything. it simply keeps on waiting. </p>\n\n<p>For your kind consideration I am also linking the video here. It would be easier for you guys to understand what I am trying to say. </p>\n\n<p><a href=\"http://www.youtube.com/watch?v=MkGZOQSMXuM\" rel=\"nofollow\">View the Video here (on youtube)</a></p>\n\n<p>I am also attaching the code that I currently have. </p>\n\n<pre><code>            ProcessStartInfo info = new ProcessStartInfo(\"cmd.exe\");\n\n            string argument = null;\n            if (!string.IsNullOrEmpty(startingDirectory) &amp;&amp; System.IO.Directory.Exists(startingDirectory))\n            {\n               argument += @\"cd\\\";\n            }\n            else\n            {\n                argument += \"\\\"\";\n            }\n            info.Arguments = argument;\n            info.CreateNoWindow = true;\n            info.RedirectStandardError = true;\n            info.RedirectStandardInput = true;\n            info.RedirectStandardOutput = true;\n            info.UseShellExecute = false;\n             this.shellProcess = System.Diagnostics.Process.Start(info);\n            this.shellProcess.EnableRaisingEvents = true;\n            //this.InputStream.AutoFlush = true;\n            this.shellProcess.Exited += new EventHandler(ProcessExited);\n            this.ErrorBeginRead();\n            this.OutputBeginRead();\n\n private void OutputBeginRead()\n    {\n        this.shellProcess.StandardOutput.BaseStream.BeginRead(outputBuffer, 0, outputBuffer.Length, new AsyncCallback(this.OnOutputInput), this.shellProcess);\n    }\n\n        private void ErrorBeginRead()\n    {\n        this.shellProcess.StandardError.BaseStream.BeginRead(errorBuffer, 0, errorBuffer.Length, new AsyncCallback(this.OnErrorInput), this.shellProcess);\n    }\n</code></pre>\n\n<p>Thank you !</p>\n\n<p>EDIT:\nLaunching python is just an example. I need to use the same method for other normal cmd line commands as well.It would be nice, if somebody can point what i am doing wrong with the code that I have  or what I must do , in order to achieve the intended functionality. </p>\n\n<p>EDIT 2 : The normal cmd commands are working perfectly. The command line tools like python,perl are not working .</p>\n\n<p>Edit 3 : So I managed to do move a wee bit forward following Jamie's suggestions. The ui is not \"hanging\" anymore. but when i access the python interpreter , the interpreter's output is still not visible in my tool. Any suggestions why that might be happening ? </p>\n"},{"tags":["c#",".net","generics"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13257835,"title":"How can I run Generic Find method from a List on the Visual Studio Immediate Window?","body":"<p>I just want to debug calling Find from Immediate Window, is it possible?</p>\n\n<pre><code>            Customer found = listOfCustomers.Find(\n                delegate(Customer cu)\n                {\n                    return cu.Name.ToLower().Contains(\"adam\");\n                }\n            );\n</code></pre>\n"},{"tags":["c#","xmpp","winrt","ejabberd","agsxmpp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":12559363,"title":"XMPP Libraries for Metro Apps in WinRT","body":"<p>Could you please list down some XMPP Libraries which supports for Metro Apps in WinRT? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","asp.net-mvc-3","model-binding","mvc-editor-templates"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13275702,"title":"Custom binding for DateTime not working when EditorTemplate is in place","body":"<p>As the default editors that MVC3 provides for DateTime are not HTML5 friendly, I have coded the following custom Editor Template:</p>\n\n<p>(DateTime.cshtml)</p>\n\n<pre><code>@model DateTime?\n\n&lt;input type=\"date\" value=\"@{ \n    if (Model.HasValue) {\n        @Model.Value.ToISOFormat() // my own extension method that will output a string in YYYY-MM-dd format\n    }\n}\" /&gt;\n</code></pre>\n\n<p>Now, this works fine, but then I had the problem of the dates not being correctly parsed, being that the ISO dates are not not parsed with the default DateTime binding. So, I implemented my own binder:</p>\n\n<pre><code>public class IsoDateModelBinder: DefaultModelBinder\n{\n    const string ISO_DATE_FORMAT = \"YYYY-MM-dd\";\n\n    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)\n    {\n        var value = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);\n\n        if (string.IsNullOrEmpty(value.AttemptedValue))\n            return null;\n\n        DateTime date;\n        if (DateTime.TryParseExact(value.AttemptedValue, ISO_DATE_FORMAT, CultureInfo.InvariantCulture, DateTimeStyles.None, out date));\n            return date;\n\n        return base.BindModel(controllerContext, bindingContext);\n    }\n}\n</code></pre>\n\n<p>And I have registered it (Global.asax.cs):</p>\n\n<pre><code>System.Web.Mvc.ModelBinders.Binders.Add(typeof(DateTime), new IsoDateModelBinder());\nSystem.Web.Mvc.ModelBinders.Binders.Add(typeof(DateTime?), new IsoDateModelBinder());\n</code></pre>\n\n<p>However, when the custom edit template is in place, the custom binder won't get called at all. I had removed it from the solution and the custom binder is correctly called -- although at that point the format is wrong because the custom editor hadn't provide the correct controls.</p>\n\n<p>So, what am I missing?</p>\n"},{"tags":["c#","silverlight","datagrid","icomparer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13276175,"title":"How to specify an IComparer for a particular property on a model that can be used for Silverlight DataGrid column sorting","body":"<p>I have a Silverlight datagrid with a column who's binding is set to a string property on the model. These strings are alphanumeric, so I have created a custom IComparer to sort them appropriately. My question is how can I force the grid to use this custom comparer when sorting by this column?</p>\n\n<p>One of my ideas was perhaps there is some attribute that can be applied on the model's string property that I am binding to, that would explicitly specify the comparer to use when comparing this value with another string?</p>\n"},{"tags":["c#","sql-server-ce"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":33,"score":4,"question_id":13273466,"title":"Set Identity In sqlce table to auto increment?","body":"<p>I am a begginer programmer (High-School student) and my teacher has given me a task to make a primary key inside a <code>sqlce</code> table automatically increment every time I insert a new row into my database ( I dont think he knows how to do it either :)</p>\n\n<p>Here is my Current Code:</p>\n\n<pre><code>using (SqlCeConnection con = new SqlCeConnection(conString))\n{\n\n    con.Open();\n\n\n    using (SqlCeCommand com = new SqlCeCommand(\"INSERT INTO Occupational VALUES(@employedBeforeBool, @nameofEmployer, @Addressemployed,@specificsAtEmployer,@employmentOnDischarge, @yearsExperienceWithEmployer, @desireToReturnToEmployer, @farmingExperienceBool, @tradesorapprentiship, @whattradesorapprentiship, @SoldierID, @Occupational_ID)\", con))\n    {\n        com.CommandText = \"SET IDENTITY_INSERT Occupational ON\";\n        com.Parameters.AddWithValue(\"@employedBeforeBool\", Soldier1.employedBeforeBool);\n        com.Parameters.AddWithValue(\"@nameofEmployer\", Soldier1.nameOfEmployer);\n        com.Parameters.AddWithValue(\"@Addressemployed\", Soldier1.addressOfEmployer);\n        com.Parameters.AddWithValue(\"@specificsAtEmployer\", Soldier1.specificsAtEmployer);\n        com.Parameters.AddWithValue(\"@employmentOnDischarge\", Soldier1.employmentOnDischarge);\n        com.Parameters.AddWithValue(\"@yearsExperienceWithEmployer\", Soldier1.yearsExperienceWithEmployer);\n        com.Parameters.AddWithValue(\"@desireToReturnToEmployer\", Soldier1.desireToReturnToEmployer);\n        com.Parameters.AddWithValue(\"@farmingExperienceBool\", Soldier1.farmingExperienceBool);\n        com.Parameters.AddWithValue(\"@tradesorapprentiship\", Soldier1.tradeOrApprenticeship);\n        com.Parameters.AddWithValue(\"@whattradesorapprentiship\", Soldier1.whattradesorapprentiship);\n        com.Parameters.AddWithValue(\"@SoldierID\", SoldierID);\n        //com.Parameters.AddWithValue(\"@Occupational_ID\", counter);\n\n        com.ExecuteNonQuery();\n    }\n</code></pre>\n\n<p>My program doesnt crash when I run it and it looks like it is inserting but nothing is showing up inside the table.</p>\n\n<p>Thanks for any help that I get</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13276130,"title":"Populate ComboBox and Textfields from Excel","body":"<p>I have an excel spreadsheet, that contains client information. I would like to populate a combo box (comboBox1) with unique values from Column A. I would then like a second combo box (comboBox2) to list the values from Column B that exist where comboBox1=Column A. Finally, I would like to populate text fields with column's C, D, E and so on....</p>\n\n<p>I have mocked up a quick screen of my desired result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xxvEg.png\" alt=\"enter image description here\"></p>\n\n<p>This would be derived from the following spreadsheet:</p>\n\n<p><img src=\"http://i.stack.imgur.com/INR2w.png\" alt=\"enter image description here\"></p>\n\n<p>The data in the spreadsheet changes from time to time, which is why I can not hard code the information.</p>\n\n<p>I am not sure where to even start with this. Do I load the data into 2D arrays or is there a better way of doing it?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13276077,"title":"Replacing newline in multiline textbox with <br/>","body":"<p>I am trying to use a multiline textbox to insert text into a table which is displayed as html.  I want to with javascript take the text inside of the textbox and find where the user pressed enter and place \"<code>&lt;br/&gt;</code>\" in that position so when the text is displayed it will show line break.  Any ideas on how I could do this?</p>\n\n<p>I tried something like this but it did not work.</p>\n\n<pre><code>var text = document.getElementById(\"announcementid\").value;\n\n\n            var newtext = text.replace(\"\\n\", \"&lt;br/&gt;\");\n\n            text = newtext;\n</code></pre>\n"},{"tags":["c#","asp.net","session-variables"],"answer_count":5,"favorite_count":31,"up_vote_count":39,"down_vote_count":0,"view_count":64221,"score":39,"question_id":621549,"title":"How to access session variables from any class in ASP.NET?","body":"<p>I have created a class file in the App_Code folder in my application. I have a session variable </p>\n\n<pre><code>Session[\"loginId\"]\n</code></pre>\n\n<p>I want to access this session variables in my class, but when I am writing the following line then it gives error</p>\n\n<pre><code>Session[\"loginId\"]\n</code></pre>\n\n<p>Can anyone tell me how to access session variables within a class which is created in app_code folder in ASP.NET 2.0 (C#)</p>\n"},{"tags":["c#","sockets","windows-8","windows-store-apps","windows-store"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":9,"score":-1,"question_id":13276228,"title":"How to establish a communication to another computer using Microsoft Account?","body":"<p>I was seeing an app which connects to another computer using Microsoft Account (through email): Mine Sweeper.</p>\n\n<p>I'm interested to create an app where I introduced its Microsoft Account and establish a communication between themselves (like a chat) using Sockets. Any idea about how to resolve the account?</p>\n"},{"tags":["c#","asp.net","label","messagebox"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":318,"score":-1,"question_id":7929097,"title":"What is the best way to display error/warning messages on website app?","body":"<p>I'm creating a website app(ASP.NET, C#) and I just want to know the best way to display error/warning messages. Is it better to do it by MessageBox or thru a Label? Just need some suggestions.</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-blobs"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13270873,"title":"loading lots of Azure blob data in a WPF app","body":"<p>I've been given a task to build a prototype for an app. I don't have any code yet, as the solution concepts that I've come up with seem stinky at best... </p>\n\n<p><strong>The problem:</strong></p>\n\n<p>the solution consist of various Azure projects which do stuff to lots of data stored in Azure SQL db-s. Almost every action that happens creates a gzipped log file in blob storage. So that's one .gz file per log entry.</p>\n\n<p>We should also have a small desktop (WPF) app that should be able to read, filter and sort these log files.</p>\n\n<p>I have absolutely 0 influence on how the logging is done, so this is something that can not be changed to solve this problem.</p>\n\n<p><strong>Possible solutions that I've come up with (conceptually):</strong></p>\n\n<p><strong>1:</strong></p>\n\n<ul>\n<li>connect to the blob storage</li>\n<li>open the container</li>\n<li>read/download blobs (with applied filter)</li>\n<li>decompress the .gz files</li>\n<li>read and display</li>\n</ul>\n\n<p>The problem with this is that, depending on the filter, this could mean a whole lot of data to download (which is slow), and process (which will also not be very snappy). I really can't see this as a usable application.</p>\n\n<p><strong>2:</strong></p>\n\n<ul>\n<li>create a web role which will run a WCF or REST service</li>\n<li>the service will take the filter params and other stuff and return a single xml/json file with the data, the processing will be done on the cloud</li>\n</ul>\n\n<p>With this approach, will I run into problems with decompressing these files if there's a lot of them (will it take up extra space on the storage/compute instance where the service is running).</p>\n\n<p><strong>EDIT:</strong> what I mean by filter is limit the results by date and severity (info, warning, error). The .gz files are saved in a structure that makes this quite easy, and I will not be filtering by looking into the files themselves.</p>\n\n<p><strong>3:</strong></p>\n\n<ul>\n<li>some other elegant and simple solution that I don't know of</li>\n</ul>\n\n<p>I'd also need some way of making the app update the displayed logs in real time, which i suppose would need to be done with repeated requests to the blob storage/service.</p>\n\n<hr>\n\n<p>This is not one of those \"give me code\" questions. I am looking for advice on best practices, or similar solutions that worked for similar problems. I also know this could be one of those \"no one right answer\" questions, as people have different approaches to problems, but I have some time to build a prototype, so I will be trying out different things, and I will select the right answer, which will be the one that showed a solution that worked, or the one that steered me in the right direction, even if it does take some time before I actually build something and test it out.</p>\n"},{"tags":["c#","enums","iterate","function-parameter"],"answer_count":7,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":11870,"score":6,"question_id":492115,"title":"C# enums as function parameters?","body":"<p>Can you pass a standard c# enum as a parameter? </p>\n\n<p>For example:</p>\n\n<pre><code>enum e1\n{\n    //...\n}\n\nenum e2\n{\n    //...\n}\n\npublic void test()\n{\n    myFunc( e1 );\n    myFunc( e2 );\n}\n\npublic void myFunc( Enum e )\n{\n    // Iterate through all the values in e\n}\n</code></pre>\n\n<p>By doing this I hope to retrieve all the names within any given enum. What would the Iteration code look like?</p>\n"},{"tags":["c#","async-await","c#-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":13260167,"title":"Wrong C# compiler error message on async lambda type inference","body":"<p>I bumped into this C# compiler error and while I'm ok with the compiler not being able to infer the type of the lambda the error message seems wrong. Here's the relevant piece of code:</p>\n\n<pre><code>Func&lt;object&gt; lambda = async () =&gt; { return await Task.FromResult(1); };\n</code></pre>\n\n<p>and here's the compiler error:</p>\n\n<blockquote>\n  <p>error CS4010: Cannot convert async lambda expression to delegate type '<code>System.Func&lt;object&gt;</code>'. An async lambda expression may return <code>void</code>, <code>Task</code> or <code>Task&lt;T&gt;</code>, none of which are convertible to '<code>System.Func&lt;object&gt;</code>'.</p>\n</blockquote>\n\n<p>The part I don't quite understand is the last sentence. The lambda is indeed returning <code>Task&lt;int&gt;</code>, but why does the compiler think that it should try to convert it to <code>System.Func&lt;object&gt;</code>?</p>\n\n<p>On the other hand, if what the error message is trying to convey is that <code>System.Func&lt;Task&lt;int&gt;&gt;</code> cannot be assigned to <code>System.Func&lt;object&gt;</code>, that doesn't seem to be the case thanks to generic delegate covariance which means that this works just fine instead:</p>\n\n<pre><code>Func&lt;object&gt; lambda = new Func&lt;Task&lt;int&gt;&gt;(async () =&gt; { return await Task.FromResult(1); });\n</code></pre>\n"},{"tags":["c#","windows-phone-7","xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13276070,"title":"WP7 Dialer number displaying number","body":"<p>In Wp7 phone when user open the keypad and press various digits those number are displayed at top of screen and once you enter digits which are more than which can be displayed. Those numbers are automatically displayed on right side. Can anyone tell how to implement feature like that?</p>\n"},{"tags":["c#","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":48,"score":-6,"question_id":13275958,"title":"C# and Microsoft Access Database","body":"<p>I'm using V. C#. I use a database which my tables are in that. When I running my project one of my tables is deleting automticly. What can I do. Please help.\nhere is my sorce code :</p>\n\n<pre><code>private void button2_Click(object sender, EventArgs e)\n{\n    OleDbConnection baglanti2 = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=taban.accdb\");\n    baglanti2.Open();\n    komut = new OleDbCommand(\"SELECT tc,ad FROM gecmis WHERE tc='\" + textBox1.Text + \"'\", baglanti2);\n    oku = komut.ExecuteReader();\n    if (oku.Read())\n    {//eger aranan veri databasede varsa\n        MessageBox.Show(\" Hosgeldin \" + oku[\"ad\"]);\n    }\n    oku.Close();\n    baglanti2.Close();\n}\n</code></pre>\n"},{"tags":["c#","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13275960,"title":"upgrading: how to remove a project reference","body":"<p>I am uninstalling part of an application that involves a reference no longer used. How do I remove that project from the references folder programmatically?</p>\n\n<p>In other words, I can manually click to expand the References node and delete the reference there. However, how would I do that as part of an uninstaller program?</p>\n"},{"tags":["c#","asp.net-mvc-3","linq","entity-framework","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13273012,"title":"How to combine two model list to one model","body":"<p>Please see code below :</p>\n\n<pre><code>public class NewsFilterModel\n{\n    public CtArticleDetail ArticleDetail { get; set; }\n\n    public PcPage Page { get; set; }\n}\n\npublic IEnumerable&lt;NewsFilterModel&gt; GetNewsFilterModelByTagNames(string tagNames, int status)\n{\n     var resultArticle = db.CtArticleDetail.Where(m =&gt; m.tagNames == tagNames);\n     var resultPage  = db.PcPage.Where(m =&gt; m.tagNames == tagNames);\n}\n</code></pre>\n\n<p>Can anyone please advice what the best way to combine two model to one model which is NewsFilterModel ?</p>\n\n<p>What I am trying to achieve is:</p>\n\n<p>NewsFilterModelList</p>\n\n<pre><code>1.Article1\n2.Page1\n3.Article2\n4.Page2\n5.Article3\n6.Page3\n</code></pre>\n\n<p>I've ended this like below: </p>\n\n<pre><code>foreach (var item in pageResult)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = null, Page = item, Date = item.UpdatedOn.ToDateTime() });\n            }\n\n            foreach (var item in tempArticleList)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = item, Page = null, Date = item.LiveDate.ToDateTime() });\n            }\n\n            return resultList.AsEnumerable();\n</code></pre>\n\n<p>Anyone has better idea, please advice.</p>\n"},{"tags":["c#","entity-framework","asp.net-web-api",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":138,"score":3,"question_id":13077328,"title":"Serialization Issues with Web API and Entity Framework Contract First Many to Many Relationship","body":"<p>I am attempting to use EF with Code First and the Web API.  I don't have any problems until I get into serializing Many-to-Many relationships.  When I attempt to execute the following web api method below I get the following error message:</p>\n\n<pre><code>public class TagsController : ApiController\n{\n\n        private BlogDataContext db = new BlogDataContext();\n\n        // GET api/Tags\n        public IEnumerable&lt;Tag&gt; GetTags()\n        {\n            return db.Tags.AsEnumerable();\n        }\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>'System.Data.Entity.DynamicProxies.Tag_FF17EDDE6893000F7672649A39962DB0CA591C699DDB73E8C2A56203ED7C7B6D'\n  with data contract name\n  'Tag_FF17EDDE6893000F7672649A39962DB0CA591C699DDB73E8C2A56203ED7C7B6D:http://schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies'\n  is not expected. Consider using a DataContractResolver or add any\n  types not known statically to the list of known types - for example,\n  by using the KnownTypeAttribute attribute or by adding them to the\n  list of known types passed to DataContractSerializer.</p>\n</blockquote>\n\n<p>I have read some SO articles (<a href=\"http://stackoverflow.com/questions/11315311/using-navigation-properties-in-entity-framework-code-first\">article 1</a>, <a href=\"http://stackoverflow.com/questions/9071118/efcf-many-to-many-in-a-detached-context\">article 2</a>) that the fix is to add the following attribute:</p>\n\n<blockquote>\n  <p>[DataContract (IsReference=true)]</p>\n</blockquote>\n\n<p>but this has had no effect.  Also using [IgnoreDataMember] does not have an effect.  The only option that does seem to work is to set Configuration.ProxyCreationEnabled to false.  Is this my only option?  Am I missing something?</p>\n\n<p><em><strong>Sample POCO objects:</em></strong></p>\n\n<p><strong>Tag</strong></p>\n\n<pre><code>[DataContract(IsReference = true)]\npublic class Tag\n{\n        public Tag()\n        {\n            this.Blogs = new HashSet&lt;Blog&gt;();\n        }\n\n        [Key]\n        [DataMember]\n        public int Id { get; set; }\n\n        [DataMember]\n        public string Name { get; set; }\n\n        [IgnoreDataMember]\n        public virtual ICollection&lt;Blog&gt; Blogs { get; set; }\n}\n</code></pre>\n\n<p><strong>Blog</strong></p>\n\n<pre><code>[DataContract(IsReference = true)]\npublic class Blog\n{\n    public Blog()\n    {\n        this.Tags = new HashSet&lt;Tag&gt;();\n    }\n\n    [Key]\n    [DataMember]\n    public int Id { get; set; }\n\n    [DataMember]\n    public string Name { get; set; }\n\n    [IgnoreDataMember]\n    public virtual ICollection&lt;Tag&gt; Tags { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13275907,"title":"MapPath vs VirtualPathUtility.ToAbsolute","body":"<p>I am using c#, asp.net and working on a web application.  </p>\n\n<p>I initially had a relative path as such which I needed to be an absolute path.\nThe below works but need to get the absolute path:</p>\n\n<pre><code>    return Chart.RenderChartHTML(\"../../Charts/MSLine.swf\");\n</code></pre>\n\n<p>I tried the following which didn't work (note that it gives me the complete path on my hard drive to .swf):</p>\n\n<pre><code>    string mslinepath = HttpContext.Current.Server.MapPath(\"Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n\n<p>I then tried the following which works:</p>\n\n<pre><code>    string mslinepath = VirtualPathUtility.ToAbsolute(\"~/Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n\n<p>Wondering why VirtualPathUtility.ToAbsolute works while the other one doesn't.  </p>\n"},{"tags":["c#","primes"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":13275080,"title":"Input an Integer and get its prime factors and duplicates","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5872962/prime-factors-in-c-sharp\">Prime Factors In C#</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to get this coding to give me all the prime factors of the integer that is inputted, including its duplicates. I have this current code and it seems to be working sort of but it isn't showing all of it's prime factors and duplicates. Any help would be appreciated.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace _1_Numeric_Problem\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string myInput;\n            int myInt;\n            int p;\n\n            Console.WriteLine((\"Please input an integer\"));\n\n            myInput = Console.ReadLine();\n            myInt = Int32.Parse(myInput);\n\n            {\n                for (int i = 2; i &gt; 1; i++)\n                {\n                    if (i == 100000)\n\n                        break;\n\n                    if (myInt % i == 0)\n                    {\n\n                        if (i &lt;= 3)\n                        {\n\n                            Console.Write(\"{0} \", i);\n                            Console.ReadLine();\n                            continue;\n                        }\n\n                        else\n                        {\n                            for (p = 2; p &lt; i; p++)\n                                if (i % p != 0)\n                                {\n                                    Console.Write(\"{0} \", i);\n                                    Console.ReadLine();\n                                    return;\n                                    Console.ReadLine();\n                                }\n                                else\n                                {\n                                    p++;\n                                    continue;\n                                }\n\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","sharepoint"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":745,"score":1,"question_id":6140787,"title":"How to get the Last Added Document ID in SharePoint using List.asmx","body":"<p>Actually I want to add the title and other fields value, but I don't have the Item Id? I am adding Document content using WebRequest. it added successfully, to add other information title etc I am using Batch Element but it not do any change and If I pass ID manually, it set the values as expected.</p>\n"},{"tags":["c#","asp.net","session-variables"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2194,"score":2,"question_id":9623150,"title":"Asp.net session variable","body":"<p>I have a asp.net project with c# code behind. I have a static class called GlobalVariable where I store some information, like the currently selected product for example.</p>\n\n<p>However, I saw that when there are two users using the website, if one changes the selected product, if changes it for everybody. The static variables seem to be commun to everybody.</p>\n\n<p>I would want to create (from the c# code) some kind of session variable used only from the c# code, but not only from the page, but from any class.</p>\n"},{"tags":["c#","asp.net","entity-framework","asp.net-webforms"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13173530,"title":"How to retrieve data from my Entitiy Model in code-behind","body":"<p>I created my tables, then my <code>Entity Model</code> (<code>Model1.edmx</code>).\n<br>I can drag &amp; drop a <code>GridView</code> and <code>EntityDataSource</code> control, they work fine.</p>\n\n<p>but I need to use my data model in code-behind. \n<br>I should be able to query a single record.\n<br>For example, in <code>Page_Load</code> event I want to fill the textboxes with specific record.</p>\n\n<p>I don't know where to begin with, the namespaces, instantiating the object etc. Any help is appreciated.</p>\n\n<p>I'm using <code>WebForms</code>(c#) with <code>EntityFramework</code></p>\n"},{"tags":["c#","vb.net","vb.net-to-c#"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13275895,"title":"C# equivalent to \"Not MyEnum.SomeValue\"","body":"<p>I'm trying to convert some VB.net code to C#.  I used SharpDevelop to do the heavy lifting; but the code it generated is breaking on some of the enum manipulation and I'm not sure how to fix it manually.</p>\n\n<p>Original VB.net code:</p>\n\n<pre><code>Enum ePlacement\n    Left = 1\n    Right = 2\n    Top = 4\n    Bottom = 8\n    TopLeft = Top Or Left\n    TopRight = Top Or Right\n    BottomLeft = Bottom Or Left\n    BottomRight = Bottom Or Right\nEnd Enum\n\nPrivate mPlacement As ePlacement\n\n''...\n\nmPlacement = (mPlacement And Not ePlacement.Left) Or ePlacement.Right\n</code></pre>\n\n<p>generated C# code:</p>\n\n<pre><code>public enum ePlacement\n{\n    Left = 1,\n    Right = 2,\n    Top = 4,\n    Bottom = 8,\n    TopLeft = Top | Left,\n    TopRight = Top | Right,\n    BottomLeft = Bottom | Left,\n    BottomRight = Bottom | Right\n}\n\nprivate ePlacement mPlacement;\n\n//...\n\n//Generates CS0023:   Operator '!' cannot be applied to operand of type 'Popup.Popup.ePlacement'\nmPlacement = (mPlacement &amp; !ePlacement.Left) | ePlacement.Right;\n</code></pre>\n\n<p>Resharper suggests adding the <code>[Flags]</code> attribute to the enum; but doing so doesn't affect the error.</p>\n"},{"tags":["c#",".net","winrt","microsoft-metro"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1026,"score":0,"question_id":8300197,"title":"How to download a webpage in MetroStyle app (WinRT) and C#","body":"<p>I'm creating a MetroStyle app and I want to use a website API that is based on the HTTP Get methods. For instance to login I should download the XML returned by this URL:</p>\n\n<p><code>websitehost.com/api/login.php?u=username&amp;p=password</code></p>\n\n<p>The problem is that the new MetroStyle apps won't let me to use many of the methods I've been using for years in .Net so how can I download the returned XML document and parse it?</p>\n"},{"tags":["c#","list"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13275768,"title":"list.add seems to be adding a reference to the original object?","body":"<p>I have created a couple custom classes (<code>NTDropDown</code> and <code>NTBaseFreight</code>) which I use to store data that I retrieve from a DB. I initialize a List of <code>NTBaseFreight</code> and 2 lists for <code>NTDropDown</code>. </p>\n\n<p>I can successfully use <code>List.Add</code> to add freights to the freights list, but as I debug the code, my 2 dropdown lists contain only 1 <code>NTDropDown</code>, which always has the same values as <code>NTDropDown</code> (I'm assuming this is a referencing problem, but what am I doing wrong)?</p>\n\n<p>To give an example, on the second row, if the carrier and <code>carrier_label</code> were <code>\"001\", \"MyTruckingCompany\"</code> and I put a break on the if statement for <code>frt_carriers</code>, both frt_carriers and frt_modes would contain only 1 item in their list, with the values <code>\"001\", \"MyTruckingCompany\"</code>...the same values in <code>NTDropDown</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>List&lt;NTDropDown&gt; frt_carriers = new List&lt;NTDropDown&gt;();\nList&lt;NTDropDown&gt; frt_modes = new List&lt;NTDropDown&gt;();\nList&lt;NTBaseFreight&gt; freights = new List&lt;NTBaseFreight&gt;();\nNTDropDown tempDropDown = new NTDropDown();\nNTBaseFreight tempFreight = new NTBaseFreight();\n\n//....Code to grab data from the DB...removed\n\nwhile (myReader.Read())\n{\n    tempFreight = readBaseFreight((IDataRecord)myReader);\n\n    //check if the carrier and mode are in the dropdown list (add them if not)\n    tempDropDown.value = tempFreight.carrier;\n    tempDropDown.label = tempFreight.carrier_label;\n    if (!frt_carriers.Contains(tempDropDown)) frt_carriers.Add(tempDropDown);\n\n    tempDropDown.value = tempFreight.mode;\n    tempDropDown.label = tempFreight.mode_label;\n    if (!frt_modes.Contains(tempDropDown)) frt_modes.Add(tempDropDown);\n\n    //Add the freight to the list\n    freights.Add(tempFreight);\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13265259,"title":"How to use C# to confirm a computer has the harddisk raid or not?","body":"<p>Can I use C# to confirm a computer has harddisk raid or not? WMI only can know how many harddisk on the computer. There are no keywords can know the computer has the raid or not.</p>\n"},{"tags":["c#","wpf","styles"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13275765,"title":"WPF TextBlock Style Underline on Mouse Hover","body":"<p>Simple question. Can the following WPF C# code cut down some weight? I mean, WTF, uh... I mean WPF, come one. Have you every seen CSS? I only want to underline the Text when I hover with the mouse just like a link. Do I really have to add 9 lines for that?</p>\n\n<pre><code>&lt;TextBlock x:Name=\"Cassette_tblPrintLabel\" Text=\"Print Label\" Canvas.Left=\"154\" Canvas.Top=\"215\" Foreground=\"#FF3355FF\" Cursor=\"Hand\" MouseDown=\"Cassette_lblPrintLabel_MouseDown\"&gt;\n    &lt;TextBlock.Style&gt;\n        &lt;Style TargetType=\"TextBlock\"&gt;\n            &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"IsMouseOver\" Value=\"True\"&gt;\n                &lt;Setter Property=\"TextBlock.TextDecoration\" Value=\"Underline\" /&gt;\n            &lt;/Trigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/TextBlock.Style&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","bitmap","texture2d","sharpdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13038312,"title":"SharpDX Texture2D to Bitmap","body":"<p>I have a problem with using SharpDX. I convert a Bitmap, lock the bits with the lockBits method and then create a DataStream and build a Texture2D from it. This seems to work quite well, no error occurs.\nNow I have the following problem. I want to convert the Texture2D back to a Bitmap. There is a method called Texture2D.ToStream(size, texture2D, stream) but when I try this only an error occurs.\nCan anyone help me with this issue? A conversion to an Image or WriteableBitmap would be also okay.</p>\n"},{"tags":["c#","arrays","generics","multidimensional-array"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13275780,"title":"Method to check if a point is in array's bounds","body":"<p>I'd like to make a method that will accept any two-dimensional array and a point and check if the point's coordinates are within the array's dimensions.</p>\n\n<p>I don't understand how to pass any kind of 2d array into this method.</p>\n\n<pre><code>Check(&lt;T&gt;[,] arr, Point p)\nCheck(Array[,] arr, Point p)\n</code></pre>\n\n<p>Both give me different kinds of errors.</p>\n"},{"tags":["c#","api","url","google"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13275735,"title":"Accessing Google address API getting unauthorized response","body":"<p>I am at a loss as to how not to get the following error after calling the Google API to standardize an address using C# .NET 2008:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>System.Net.WebException: The remote server returned an error: (401) Unauthorized.\n</code></pre>\n\n<p>My main code is as such:</p>\n\n<pre><code>string clientId = \"hiddenclientID\";\nstring signature = \"hiddenKey\";\n\nstring url = \"http://maps.googleapis.com/maps/api/geocode/xml?address=\"+address.Replace(' ', '+')+\"&amp;client=\"+clientId+\"&amp;sensor=false\";\n\nstring signedUrl = Sign(url, signature);\n\nHttpWebResponse response = (HttpWebResponse)WebRequest.Create(signedUrl).GetResponse();\n\nMessageBox.Show(response.ToString());\n</code></pre>\n\n<p>My Sign() function is as such:</p>\n\n<pre><code>public static string Sign(string url, string keyString) {       \nASCIIEncoding encoding = new ASCIIEncoding();        \n\nstring usablePrivateKey = keyString.Replace(\"-\", \"+\").Replace(\"_\", \"/\");       \nbyte[] privateKeyBytes = Convert.FromBase64String(usablePrivateKey);        \nUri uri = new Uri(url);       \nbyte[] encodedPathAndQueryBytes = encoding.GetBytes(uri.LocalPath + uri.Query);        \n\nHMACSHA1 algorithm = new HMACSHA1(privateKeyBytes);       \nbyte[] hash = algorithm.ComputeHash(encodedPathAndQueryBytes);        \nstring signature = Convert.ToBase64String(hash).Replace(\"+\", \"-\").Replace(\"/\", \"_\");        \n\nreturn uri.Scheme+\"://\"+uri.Host+uri.LocalPath + uri.Query +\"&amp;signature=\" + signature;     \n            }\n</code></pre>\n\n<p>I am only trying to get the XML response from my request at this point.</p>\n\n<p>Any help would be great.</p>\n"},{"tags":["c#","asp.net-mvc","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13275664,"title":"Passing parameters to a partial view using Html.Action","body":"<p>I am developing an MVC application (razor syntax), and I am having issues passing parameters into my <code>Html.Action</code> call. Below is a search page I am implementing. Note, the model contains distinct values to be used in the dropdowns.</p>\n\n<p>Call From View:</p>\n\n<pre><code>@using(Html.BeginForm(\"Search\", \"Home\", FormMethod.Get, null)){\n\n@Html.LabelFor(model =&gt; model.siteCode)\n@Html.DropDownListFor(model =&gt; model.siteCode, new SelectList(Model.siteCode), \"All\")\n\n@Html.LabelFor(model =&gt; model.group)\n@Html.DropDownListFor(model =&gt; model.group, new SelectList(Model.group), \"All\")\n}\n\n@Html.Action(\"ShowOrderData\", \"Home\", new {siteCode = Model.siteCode, group = Model.group}\n</code></pre>\n\n<p>Action in Controller:</p>\n\n<pre><code>public ActionResult ShowOrderData(string siteCode = \"\",\n                                        string group = \"\",)\n{\n        var model = _db.ToolOrders\n            .Where(r =&gt; r.SiteCD_LOC.Contains(siteCode))\n            .Where(r =&gt; r.GroupCode.Contains(group))\n\nreturn PartialView(\"_OrderData\", model);\n}\n</code></pre>\n\n<p>Note: There may be some syntactical errors. There are about 10 more parameters being passed and I didn't want to clog up the code blocks.</p>\n\n<p>So when debugging with this code, empty strings are sent to my <em>ShowOrderData</em> controller. I attempted to add .ToString in the Html.Action call ( <code>Model.siteCode.ToString()</code> ), and a LINQ statement will show up instead. I am guessing this method is wrong because the model does not contain any information from the previous request.</p>\n\n<p>How do I properly send data from the QueryString to a partial view? I've seen methods that access the queryString directly via request.querystring, but I've also heard that it is bad practice to use that in a view.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","service","access-denied","windows-xp-sp3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":841,"score":1,"question_id":2286801,"title":"Can't access web service when connected to the network :: HTTP 407","body":"<p>I have a console application that communicates with a web service. Both of them are on the same machine.</p>\n\n<p>When I am accessing the web service with the LAN disabled, it connects without a problem. But if the LAN is enabled and connected to our office network, I receive this error:</p>\n\n<p>\"HTTP 407 Proxy Authentication required - The ISA Server requires authorization to fulfill the request. Access to the Web Proxy service is denied.\"</p>\n\n<p>We've been hunting the source of the problem for three days now. We have tried everything that we can think of. Any ideas what's causing the problem?</p>\n\n<p>Additional notes:\n- The machine is in a Workgroup setup but with DNS suffix (computer.local). When accessing the web service, we type the address as \"http://machine.computer.local/service.asmx\"</p>\n\n<ul>\n<li><p>I talked to the IT guys and they said that we don't have an ISA server installed</p></li>\n<li><p>There is no \"proxy\" set in IE.</p></li>\n<li><p>The machine is in mint condition.</p></li>\n</ul>\n"},{"tags":["c#","visual-studio-2010","loops","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13275622,"title":"Create a Set of String with Column Header as string title and string value as row 0 value","body":"<p>I have column 1 column 2 and column 3. At row 0 for each of these i have Values 1,2,3 respectively. </p>\n\n<p>How can I build a loop that will set </p>\n\n<pre><code>string column 1 = 1\nstring column 2 = 2\nstring column 3 = 3 \n</code></pre>\n\n<p>so that the strings name is the column headers and the value of the string is the value in row 0 of that column.</p>\n\n<p>This needs to be done for about 150+ columns and I am looking to avoid individually typing out. </p>\n\n<p>Columns are in a table called \"ShipmentInfo\"</p>\n"},{"tags":["c#","reflection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13270183,"title":"Type conversion issue when setting property through reflection","body":"<p>We have a property of type <code>long?</code> that gets filled with an <code>int</code>.</p>\n\n<p>This works fine when i just set the property directly <code>obj.Value = v;</code> but when i try and set the property through reflection <code>info.SetValue(obj, v, null);</code> it gives me a the following exception:</p>\n\n<blockquote>\n  <p>Object of type 'System.Int32' cannot be converted to type 'System.Nullable`1[System.Int64]'.</p>\n</blockquote>\n\n<p>This is a simplified scenario:</p>\n\n<pre><code>    class TestClass\n    {\n        public long? Value { get; set; }\n    }\n\n    [TestMethod]\n    public void TestMethod2()\n    {\n        TestClass obj = new TestClass();\n        Type t = obj.GetType();\n\n        PropertyInfo info = t.GetProperty(\"Value\");\n        int v = 1;\n\n        // This works\n        obj.Value = v;\n\n        // This does not work\n        info.SetValue(obj, v, null);\n    }\n</code></pre>\n\n<p>Why does it not work when setting the property through <code>reflection</code> while it works when setting the property directly?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13270775,"title":"Why Not looking for the View in the correct location","body":"<p>I'm an MVC newbie so this might sound trivial.I have my 2 Views(EnterLogin.aspx,ShowLogin.aspx) in a folder called <code>LoginForm</code> in Views.\nHere is my Global.asax.cs below</p>\n\n<pre><code>public class MvcApplication : System.Web.HttpApplication\n{\n    public static void RegisterRoutes(RouteCollection routes)\n    {\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            \"Default\", // Route name\n            \"{controller}/{action}/{id}\", // URL with parameters\n            new { controller = \"LoginForm\", action = \"ShowLogin\", id = UrlParameter.Optional } // Parameter defaults\n        );\n    }\n\n    protected void Application_Start()\n    {\n        AreaRegistration.RegisterAllAreas();\n\n        RegisterRoutes(RouteTable.Routes);\n    }\n}\n</code></pre>\n\n<p>Here is my ShowLogin.aspx design code</p>\n\n<pre><code>&lt;form method=\"post\" action=\"EnterLogin\" runat=\"server\"&gt;\n    Hello, i'm login page\n    Enter Name   &lt;asp:TextBox ID=\"txtName\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n    &lt;input type=\"submit\" value=\"PressMe\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here are my controllers</p>\n\n<pre><code>public class LoginFormController : Controller\n{\n    public ActionResult ShowLogin()\n    {\n        return View();\n    }\n\n    public ActionResult EnterLogin()\n    {\n        return View(\"EnterLogin\");\n    }\n}\n</code></pre>\n\n<p>On running the application it first loads with url </p>\n\n<pre><code>http://localhost:50224/\n</code></pre>\n\n<p>and shows the ShowLogin.aspx View</p>\n\n<p>On clicking the button I'm calling <code>EnterLogin</code> controller to show <code>EnterLogin</code> View but it looks in URL</p>\n\n<pre><code>http://localhost:50224/EnterLogin\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>http://localhost:50224/LoginForm/EnterLogin\n</code></pre>\n\n<p>What could be causing this?</p>\n"},{"tags":["c#",".net","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12964757,"title":"Pass sysname in datatable TVP","body":"<p>I have a stored procedure using the type below as a param</p>\n\n<pre><code>    CREATE TYPE [dbo].[columnOrderTableType] AS TABLE\n     ([id]                     [int]        IDENTITY(1,1) NOT NULL\n     ,[columnName]             [sysname]                  NOT NULL\n</code></pre>\n\n<p>I need to pass a datatable from my api as TVP to this sproc</p>\n\n<p>When I use string as value for the columnName I get an error saying that type doesnt match the types reqd for columnOrderTableType</p>\n\n<p>How do I pass a sysname in datatable?</p>\n"},{"tags":["c#","xsd.exe"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13275685,"title":"Generate class from XSD with short class names","body":"<p>Is there a tool that will generate deeply-nested classes with short class names, e.g. just the element name?</p>\n\n<p>The data could be thought of like this XML:</p>\n\n<pre><code>&lt;Family&gt;\n  &lt;GreatGrandParent&gt;\n    &lt;GrandParent&gt;\n      &lt;Parent/&gt;\n      &lt;Parent&gt;\n        &lt;Child /&gt;\n        &lt;Child /&gt;\n      &lt;/Parent&gt;\n      &lt;Parent/&gt;\n    &lt;/GrandParent&gt;\n    &lt;GrandParent/&gt;\n  &lt;/GreatGrandParent&gt;\n&lt;/Family&gt;\n</code></pre>\n\n<p>but when I generate the class using XSD.exe, I get unwieldy class names representing the entire tree like \"FamilyGreatGrandParentGrandParentParentChild\" rather than \"Child\" at the leaf level.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13275532,"title":"Including 3rd party code as source vs dll","body":"<p>There is a Github project for a C# library that I'd like to use. Is it more conventional to include the source as a separate project in my Visual Studio solution and build the dll as part of the regular compilation process, or to build a dll separately and include just that in my project reference?</p>\n"},{"tags":["c#","html-agility-pack","keynotfoundexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13275620,"title":"KeyNotFoundException with using HtmlEntity.DeEntitize() method","body":"<p>I am currently working on a scraper written in C# 4.0. I use variety of tools, including the built-in WebClient and RegEx features of .NET. For a part of my scraper I am parsing a HTML document using HtmlAgilityPack. I got everything to work as I desired and went through some cleanup of the code.</p>\n\n<p>I am using the <code>HtmlEntity.DeEntitize()</code> method to clean up the HTML. I made a few tests and the method seemed to work great. But when I implemented the method in my code I kept getting <code>KeyNotFoundException</code>. There are no further details so I'm pretty lost. My code looks like this:</p>\n\n<pre><code>WebClient client = new WebClient();\nstring html = HtmlEntity.DeEntitize(client.DownloadString(path));\nHtmlDocument doc = new HtmlDocument();\ndoc.LoadHtml(html);\n</code></pre>\n\n<p>The HTML downloaded is UTF-8 encoded. How can I get around the <code>KeyNotFound</code> exception?</p>\n"},{"tags":["c#","wpf","c#-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13275235,"title":"What is the difference between Activator.CreateInstance and a standard constructor?","body":"<p>What is the diffrenece between the two examples below? What is the purpose of <code>Activator</code>, why would I use it?</p>\n\n<p>1.</p>\n\n<pre><code>string objTypeName = \"Foo\";\nFoo foo = (Foo)Activator.CreateInstance(Type.GetType(objTypeName));\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Foo foo = new Foo()\n</code></pre>\n\n<p>I went through below the pages linked below, but didn't get a clear picture.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.activator_methods.aspx\" rel=\"nofollow\">Here</a> , <a href=\"http://stackoverflow.com/questions/7598088/purpose-of-activator-createinstance-with-example\">here</a> and <a href=\"http://msdn.microsoft.com/en-us/library/wccyzw83.aspx\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13273887,"title":"LINQ query to group records by month within a period","body":"<p>I am looking for some help on adapting the following LINQ query to return all dates within the next 6 months, even those where no records fall within the given month.</p>\n\n<pre><code>var maxDate = DateTime.Now.AddMonths(6);\n\nvar orders = (from ord in db.Items\n\nwhere (ord.Expiry &gt;= DateTime.Now &amp;&amp; ord.Expiry &lt;= maxDate)\n\ngroup ord by new\n    {\n        ord.Expiry.Value.Year,\n        ord.Expiry.Value.Month\n    }\ninto g\nselect new ExpiriesOwnedModel\n    {\n        Month = g.Select(n =&gt; n.Expiry.Value.Month).First(),\n        Quantity = g.Count()\n    }).ToList();\n</code></pre>\n\n<p>I'd really appreciate any assistance or pointers on how best to implement this.</p>\n"},{"tags":["c#","string","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13275069,"title":"'u0022' to introduce quotation marks to string C#","body":"<p>I have a string property that returns a directory, it has \"program file//\" in it, so to use it in a command prompt, I have to use quotation mark around the string. But if I do the following</p>\n\n<pre><code>string myDic = someDic;\n\nstring myCmdPrptDic = '\\u0022' + someDic + \"\\u0022'\n</code></pre>\n\n<p>myCmdPrptDic ends up like \\\"C://Program Files//myApp\\\" and will not work under cmd prompt. Is there a way to just create \"C://Program Files//myApp\" only? Or maybe I should just use a stringBuilder....</p>\n\n<p>I just need to generate a string like:</p>\n\n<pre><code>copy //data/file// \"C://program files//myapp\"\n</code></pre>\n\n<p>but I could not do it as </p>\n\n<pre><code>string = \"copy //data//file\" +\" \"+ '\\u0022' + someDic + \"\\u0022';\n</code></pre>\n"},{"tags":["c#","visual-studio","port","p2p","firewall"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":26,"score":1,"question_id":13275547,"title":"Open ports for p2p chat","body":"<p>I want to write a p2p chat program using server in c#.\nBasically, when client A would want to send a message to client B,\nthe server will notify client B for the request, and open\nport and create socket. The messages will transfer directly from\none clint to the other.</p>\n\n<p>The Question:\nHow can i open port on the firewall and save it in the NAT?\nIs there any c# code for that (open source)?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13274444,"title":"Get mouse coords relative to other window","body":"<p>I would like to get the mouse coords relative to another window (window client area), the window is not part of my application. </p>\n\n<p>I would prefer to do this without delving into the Win32 API and dll imports, but I'm not sure if it's possible.</p>\n\n<p>The basic idea is: My C# WPF app will have the users focus, when the user presses a hot key(CTRL + C) the app will get the coords relative to the client area of an earlier specified window. It's just a quick app I need to make for in-house development assistance.</p>\n"},{"tags":["c#","report-viewer2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13275514,"title":"Reportviewer: Subscript in a label","body":"<p>I am using MS reportviewer, C# (VS 2010)</p>\n\n<p>In a tablix column header, is it possible to display a letter as subscript in a label?</p>\n"},{"tags":["c#","coded-ui-tests"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":12989046,"title":"Obtain List of Test Cases for a Coded UI Project Programatically","body":"<p>I have a coded ui project, in which i have a set of test cases recorded (methods)\nIs there a way to obtain the list of test cases programmatically(C#) and also get the description i have given during the Record phase</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":585,"score":1,"question_id":6915638,"title":"Reading csv file into a DataTable using C#?","body":"<p>I have a number of Python scripts I wrote a while back, to do some data munging.\nI need to 'port' some of those scripts to C#.</p>\n\n<p>Python provides a CSV module which facilitates importing CSV data from file into a dictionary. I want to have the same functionality in my library, but since I am new to C#, decided to come in here to ask for the best practices way to import CSV data into a DataTable.</p>\n\n<p>Do I roll my own, or is there a 'CSV module' ala Python?</p>\n"},{"tags":["c#","ef-migrations","entity-framework-5","code-first-migrations"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":626,"score":0,"question_id":11974439,"title":"Changing column default values in EF5 Code First","body":"<p>I'm trying to use CF to build a model for an existing database.  I have a column in which I forgot to set a sane default value.  And rather than compromise the purity of the initial migration by changing it, I just figured I'd create another migration (that's what migrations are for, right?  :) </p>\n\n<pre><code>public override void Up()\n{\n    AlterColumn(\"Config\", \"DefaultTaxPerDollar\", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.087m));\n}\n\npublic override void Down()\n{\n    AlterColumn(\"Config\", \"DefaultTaxPerDollar\", c => c.Decimal(nullable: false, precision: 19, scale: 5, defaultValue: 0.0m));\n\n}\n\n</code></pre>\n\n<p>But this produces <code>Column already has a DEFAULT bound to it.</code> error from the SQL Server.  </p>\n\n<p>How does one change a default value using CF migrations?  Or, how does one simply remove a default value (and subsequently re-create it with a different value)?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here is the SQL generated:</p>\n\n<pre><code>ALTER TABLE [Config] ADD CONSTRAINT DF_DefaultTaxPerDollar DEFAULT 0.087 FOR [DefaultTaxPerDollar]\nALTER TABLE [Config] ALTER COLUMN [DefaultTaxPerDollar] [decimal](19, 5) NOT NULL\n</code></pre>\n\n<p>I think I may have found a solution, to use the <code>Sql()</code> method with some complex SQL inspired by <a href=\"http://thisisnotcnn.blogspot.com/2011/03/get-default-constraint-name-for.html\" rel=\"nofollow\">this</a> post.  The problem stems from the fact that SQL Server uses constraints to implement defaults (OH! how I miss MySQL!) with a generated name for the constraint.  So the Code First team could not simply change or remove/re-create the default value easily.</p>\n"},{"tags":["c#",".net","windows","semaphore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":19,"score":-2,"question_id":13275439,"title":"What is the maximum length of a named Semaphore's name?","body":"<p>What is the maximum length of a <a href=\"http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx\" rel=\"nofollow\">Semaphore</a>'s name?  It makes sense that there would be one, as it maps to an underlying kernel semaphore, but the documentation does not seem to specify it precisely.</p>\n"},{"tags":["c#","treeview"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5964,"score":2,"question_id":1327079,"title":"How can move up and move down selected item programmatically in treeview in c#?","body":"<p>i have one treeview and 2 button\ni want when click on UP_button, above Node selected if i am click on DOWN_button then selection should be go down</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13275207,"title":"c# get absolute path of relative path","body":"<p>I  am calling a method in c# as follows:</p>\n\n<pre><code>    return Chart.RenderChartHTML(\"../../Charts/MSLine.swf\");\n</code></pre>\n\n<p>The thing is that the path can be different depending on what \nfolder I am calling RenderChartHTML from.</p>\n\n<p>I tried the following so that it finds the absolute path but not working: </p>\n\n<pre><code>    string mslinepath = HttpContext.Current.Server.MapPath(\"~/Charts/MSLine.swf\");\n\n    return Chart.RenderChartHTML(mslinepath);\n</code></pre>\n"},{"tags":["c#",".net","winforms","keyevent"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13274936,"title":"A Form's key events go missing","body":"<p>I have a bug in my application that I don't know how to how to attack. Basically, key events \"go missing\" after some time. I have added event handlers to KeyDown, KeyPressed and KeyUp that write to the console (both for the Form and one of its TextBoxes). Here's the correct order of things:</p>\n\n<pre><code>control_PreviewKeyDown\nShellForm_KeyDown\ncontrol_KeyDown\nShellForm_KeyPress\ncontrol_KeyPress\nShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>In the failed state (which I can't reproduce consistently), I get these events when pressing a key (TextBox has focus):</p>\n\n<pre><code>ShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>Form.KeyPreview is true.</p>\n\n<p>It's the same for all TextBoxes in the Form; they are not disabled and not set to readonly, but it's no longer possible to write text.</p>\n\n<p>Problem is, I don't really know where to begin.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13267941,"title":"WebRequest Does Not Contain A Definition For Create","body":"<p>I ran a console application yesterday to send and receive web request and web response and it works fine. Today I'm testing the same method on my form application and I get the error WebRequest Does Not Contain A Definition For Create. All my imports are the same. It's a bit strange and I don't know what I'm doing wrong. This is the code to my console application:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing HtmlAgilityPack;\nusing System.Net;\nusing System.IO;\n\nnamespace WebrequestCsharp\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            StreamWriter sw;\n            sw = File.AppendText(\"c:\\\\Temp\\\\webresponse.txt\");\n            //Create a Web-Request to an URL\n            HttpWebRequest HWR_Request = (HttpWebRequest)WebRequest.Create(\"http://www.hitta.se/ericsson/företag_och_personer\");\n\n            //Send Web-Request and receive a Web-Response\n            HttpWebResponse HWR_Response = (HttpWebResponse)HWR_Request.GetResponse();\n\n            //Translate data from the Web-Response to a string\n            Stream S_DataStream = HWR_Response.GetResponseStream();\n            StreamReader SR_DataStream = new StreamReader(S_DataStream, Encoding.UTF8);\n            string s_ResponseString = SR_DataStream.ReadToEnd();\n            S_DataStream.Close();\n            sw.WriteLine(s_ResponseString);\n            sw.Flush();\n            sw.Close();\n\n            HtmlDocument doc = new HtmlDocument();\n            doc.Load(\"c:\\\\Temp\\\\webresponse.txt\");\n            Console.ReadKey();\n        }\n\n\n    }\n}\n</code></pre>\n\n<p>And this is my form application that cannot accept my Create:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing HtmlAgilityPack;\nusing System.Net;\nusing System.IO;\n\nnamespace PhoneFind\n{\n    class WebRequest\n    {\n        private String url { get; set; }\n        private String searchEngine { get; set; }\n        HttpWebRequest HWR_Request = (HttpWebRequest)WebRequest.Create(\"http://www.hitta.se/ericsson/företag_och_personer\");\n        public WebRequest(String url, String searchEngine)\n        {\n            this.url = url;\n            this.searchEngine = searchEngine;\n        }\n\n        // sends a request to the search engine \n        public String sendRequest(String url, String searchEngine)\n        {\n            switch (searchEngine){\n                case \"hitta\":\n                    //Create a Web-Request to a URL\n\n                    //Send Web-Request and receive a Web-Response\n                    HttpWebResponse HWR_Response = (HttpWebResponse)HWR_Request.GetResponse();\n\n                    //Translate data from the Web-Response to a string\n                    Stream S_DataStream = HWR_Response.GetResponseStream();\n                    StreamReader SR_DataStream = new StreamReader(S_DataStream, Encoding.UTF8);\n                    string s_ResponseString = SR_DataStream.ReadToEnd();\n                    S_DataStream.Close();\n                    break;\n            }\n            return \"\";\n\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","network-share"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":507,"score":0,"question_id":10684879,"title":"Reading File From Network Location","body":"<p>I am having Bunch of Files in A folder which is shared on Network Drive . I am trying to Access those Files into my Code . But It is giving an error:</p>\n\n<blockquote>\n  <p>System.IO.DirectoryNotFoundException was unhandled by user code</p>\n</blockquote>\n\n<pre><code>Fname = txtwbs.Text;\nDirectoryInfo objDir = new DirectoryInfo(\"Y:\\\\\");\n_xmlpath = objDir + \"\\\\\" + Fname + \"\\\\\" + Fname + \".xml\";\nif (File.Exists(_xmlpath ))\n{\n    reader(_xmlpath);\n}\n</code></pre>\n\n<p>I have Also used:</p>\n\n<pre><code>file = fopen(\"\\\\\\\\10.0.2.20\\\\smartjobs\\\\Eto\\\\\"+Fname);   \n</code></pre>\n\n<p>I am Able to Read File from My Local PC But it is giving Exception Only for Network Location .Please let me know how can I read File From Network Shared Location .</p>\n\n<p>And Also How Can I Make A tree view of Folders into Asp.net Web Application . </p>\n\n<p>Directory Structure is Like that </p>\n\n<pre><code>\\\\10.0.2.20\\Smartjobs\\Eto\\\n</code></pre>\n\n<p>this is Parent Directory It is congaing Nos of Folder having XML Documents.</p>\n"},{"tags":["c#","asp.net","servicestack"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13275268,"title":"Multiple Assemblies for Multiple Services","body":"<p>I'm not sure how to organize my project. I have a solution with multiple services. eg. ShoppingCart, UrlShortener. The AppHostBase can only take one assembly however. I'm also interested in separation of concerns and in future use cases if separating Interface assemblies from ServiceModel assemblies. Should my domain model need to know about the interface (perhaps client requirements?) then at least the namespace won't get flooded with unnecessary DTO's etc.</p>\n\n<p>So right now I see it as such, each being separate assemblies/projects:</p>\n\n<pre><code>MyApp.RestServices.ShoppingCartService.Interface\nMyApp.RestServices.ShoppingCartService.ServiceModel\nMyApp.RestServices.UrlShorteningService.Interface\nMyApp.RestServices.UrlShorteningService.ServiceModel\n</code></pre>\n\n<p>I'm confused in the fact that when registering the AppHost you can only configure one Assembly. </p>\n\n<pre><code>public AppHost() : base(\"MyApp's REST services\", \n    typeof(MyApp.RestServices.ShoppingCartService.Interface).Assembly) {}\n</code></pre>\n\n<p>In my case I want separate assemblies for different services, eg. Short Url Service, Shopping Cart Service.  I don't want to have to put them all in one project.</p>\n\n<pre><code>public AppHost() : base(\"MyApp's REST services\", \n    new[]{\n          typeof(MyApp.RestServices.ShoppingCartService.Interface).Assembly,\n          typeof(MyApp.RestServices.Interface.ShoppingCartService).Assembly}\n) {}\n</code></pre>\n\n<p>I'm really quite new so there is a lot I can be missing but I do wish to get it right for the long term as I continue to learn.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13274934,"title":"Binding dropdownlist when adding a new row in gridview","body":"<p>I have a drop down and some textboxes in a gridview and im binding the DDL from DB values and i have to add a new row with same DDL and textboxes but how can i bind the DDL when a new row is created??</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":5403,"score":8,"question_id":3837755,"title":"Binding to Self/'this' in XAML","body":"<p>Simple WPF/XAML question. In XAML, how do I reference the Self/this object in a given context? In a very basic app with a main window, one control, and a coded C# property of the window, I want to bind a property of the control to the hand coded property of the window. </p>\n\n<p>In code, this is very easy - in the Window's constructor, I added this:</p>\n\n<pre><code>Binding bind = new Binding();\nbind.Source = this;\nbind.Path = new PropertyPath(\"ButtonWidth\");\nbutton1.SetBinding(WidthProperty, bind);\n</code></pre>\n\n<p>Obviously, I have a property called ButtonWidth, and a control called button1. I can't figure out how to do this in XAML. Various attempts like the following example have not worked:</p>\n\n<pre><code>&lt;Button x:Name=\"button1\" Width=\"{Binding Source=Self Path=ButtonWidth}\"/&gt;\n\n&lt;Button x:Name=\"button1\" Width=\"{Binding RelativeSource={RelativeSource Self} Path=ButtonWidth}\"/&gt; \n</code></pre>\n\n<p>etc</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","image","processing","mask","digital"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13275122,"title":"Applying Masks in Digital Image Processing","body":"<p>Im currently adding different features to a very simple digital image processing program. It is coded using the unsafe methods.\nThis program only works with greyscale images. </p>\n\n<p>My question is how do i apply masks to pixels?</p>\n\n<p>For example a Sobel Mask for horizontal lines only:</p>\n\n<blockquote>\n  <p>Gx = -1, -2, -1, 0, 0, 0, 1, 2, 1</p>\n</blockquote>\n\n<p>The expected outcome for this would be:</p>\n\n<p><img src=\"http://i.stack.imgur.com/M7FP4.jpg\" alt=\"enter image description here\"></p>\n\n<p>My code to obtain pixels:</p>\n\n<pre><code>private void obtainPixelsToolStripMenuItem_Click(object sender, System.EventArgs e)\n    {\n\n        Graphics g = this.CreateGraphics();\n\n        int width = original_image.Width - 2;\n        int height = original_image.Height - 2;\n\n        int total_val = 0;\n        int avg = 0;\n\n\n        Rectangle r = new Rectangle(535, 50, original_image.Width, original_image.Height);\n        Rectangle r2 = new Rectangle(0, 0, original_image.Width, original_image.Height);\n\n        proc_image = original_image.Clone(r2, PixelFormat.Format8bppIndexed);\n\n\n        BitmapData bmDataOR = original_image.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format8bppIndexed);\n        BitmapData bmDataPR = proc_image.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format8bppIndexed);\n\n        int stride = bmDataOR.Stride;\n\n\n\n        unsafe\n        {\n            byte* o = (byte*)(void*)bmDataOR.Scan0;\n            byte* p = (byte*)(void*)bmDataPR.Scan0;\n\n            byte[] pix_val = new byte[9];\n\n\n            for (int y = 0; y &lt; height; ++y)\n            {\n                for (int x = 0; x &lt; width; ++x)\n                {\n                    pix_val[0] = o[y * stride + x];\n                    pix_val[1] = o[y * stride + x + 1];\n                    pix_val[2] = o[y * stride + x + 2];\n                    pix_val[3] = o[(y + 1) * stride + x];\n                    pix_val[4] = o[(y + 1) * stride + x + 1];\n                    pix_val[5] = o[(y + 1) * stride + x + 2];\n                    pix_val[6] = o[(y + 2) * stride + x];\n                    pix_val[7] = o[(y + 2) * stride + x + 1];\n                    pix_val[8] = o[(y + 2) * stride + x + 2];\n\n            //Do something with pixel values\n\n                }\n            }\n\n            proc_image.UnlockBits(bmDataPR);\n            original_image.UnlockBits(bmDataOR);\n\n            g.DrawImage(proc_image, r);\n\n        }\n\n    }\n</code></pre>\n\n<p>Am i right in thinking the mask should be a float array?\nand then how do i apply the mask to the pixel values?</p>\n"},{"tags":["c#","sockets","priority"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13274641,"title":"Priority in socket communication","body":"<p>I have a client-server communication between a mobile and a PC(server). \nIn the communication I have four sockets: two of these are to send and receive data, and the other two are for some kind of keep alive since I need to detect as fast as I can the disconnection.</p>\n\n<p>As long as the connection is OK the data will travel without any problem. But I want to establish some priority in order to be sure that the keep alive (remember: two sockets) channel is always sending data, unless the connection between server-client is dead.</p>\n\n<p>Is there any way to achieve this? I hope to be clear.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["c#","asp.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13275249,"title":"pass array from one method to another","body":"<p>i have program one array of array in C# and asp.net\none method inside a button read a file and the next one is goin to send the array of array to a web services, in order to read the file i used a fileupload, in the first method the file is read correctly and the array is full and that is all the button is goin to do the second method in the second button is goin to send this array to web service, however i try to used a global variable for this but it returns an error saying that the array is empty, so waht i do is insted of an array i saved in a list the lis is save as a Session this way i recover the list in the second method and star to read again, this procese taker much memory space, is it posible to send the array of array to the second button whit out losig the data?</p>\n\n<p>here is part of mi code first button: for an exemple let say that obj=10 and carac=2 so my array will 10 by 2</p>\n\n<pre><code>dat= FileUpload1.PostedFile.InputStream;\n        string line;\n        string [] splitt;\n                int n=0;\n           string [] datos =new string[carac];\ndouble [][] dimencion= new double [obj][] ;\n        System.IO.StreamReader sr = new System.IO.StreamReader(dat);\n        line = sr.ReadLine();\n        while (line != null)\n                {\n                dimencion[n] = new double[carac];\n                for (int m2 = 0; m2 &lt; carac; m2++)\n                    {\n                     datos = line.Split(new Char[] {' ',',','\\t'});\n                     dimencion[n][m2] = Convert.ToDouble(datos[m2]);\n                     }\n                 n = n + 1;\n                line = sr.ReadLine();\n                 }\n</code></pre>\n\n<p>so i try to send de varable dimencion to the second button but nothing having dimencion as a global varible</p>\n\n<pre><code>{\nFirstService mySvc = new FirstService();\nmySvc.Parametros(dimencion);\n}\n</code></pre>\n"},{"tags":["c#","printing","raw-data"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13274965,"title":"Inserting physical carriage returns in string to be sent to printer","body":"<p>I am need to insert physical carriage returns into text to be sent to a printer. So far I have been unsuccessful finding any documentation on how to do this. I am sure it is out there but not sure of the correct terms to define this process.</p>\n\n<p>This is an example that I got from a program printing to the same printer. Where line 1, 2, 3, 4 are there are carriage returns in the text. Below is basically what I need the data to look like that is being sent to the printer. </p>\n\n<p><img src=\"http://i.stack.imgur.com/WZQbv.jpg\" alt=\"Basically what I need the code to look like\"></p>\n\n<p>Thanks in advance for any help!</p>\n\n<h3>NOTE:</h3>\n\n<p>This is what is being sent to the printer</p>\n\n<pre><code>strStrm += \"1W1D44000010002025,LA \" + comboBox1.SelectedItem.ToString() + ((char)13) + ((char)10);\nstrStrm += textBox2.Text + ((char)13) + ((char)10);\nstrStrm += txtYear.Text + ((char)13) + ((char)10);\nstrStrm += strID_Ord + ((char)13) + ((char)10);\nstrStrm += strID_Item + ((char)13) + ((char)10);\nstrStrm += strItemPar + ((char)13) + ((char)10);\n</code></pre>\n\n<p>And this is what the printer is receiving</p>\n\n<pre><code>1W1D44000010002025,LA,Line 1 \nLine 2\nLine 3\nLine 4\n</code></pre>\n\n<p>But I need it to look like the image above where the Carriage Returns are sent to the printer and not formatted into the string.</p>\n"},{"tags":["c#","winforms","multithreading","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13274990,"title":"C# Thread ListView","body":"<p>I'm a fairly new to .net and I'm still struggling to understand a lot things, and right now I'm trying to accomplish something relatively simple but I've failed every single time, I would like to add a Thread to my program, this Thread would be responsible to perform the Upload operations to a web server and keep my program responsive providing the feedback of the operations to my users by updating a ListView, where the users would see all the status of the file uploads.</p>\n\n<p>I don't know how to put this Thread inside the program to make it responsive, I couldn't find any examples so far and I'm trying to find a little sample to show me the use of Thread and WinForms in action.</p>\n"},{"tags":["c#","amazon-ec2","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13271793,"title":"Any way to view and EC2 instance AlarmStatus value using AmazonEC2 API?","body":"<p>I was wondering if there was a way to view an ec2 instance's alarm status through the AmazonEC2 API?</p>\n\n<p><img src=\"http://i.stack.imgur.com/zB0vE.png\" alt=\"AlarmStatus\"></p>\n\n<p>We've implemented a working solution to get specific metric values using the AmazonCloudWatch.GetMetricStatistics method:</p>\n\n<pre><code>var reg = new GetMetricStatisticsRequest()\n            {\n                MetricName = metric,\n                Period = 60 * 30,\n                Statistics = new List&lt;string&gt; { AVERAGE },\n                Dimensions = dimensions,\n                Namespace = \"AWS/EC2\",\n                EndTime = DateTime.Now.ToUniversalTime(),\n                StartTime = DateTime.Parse(startTime)\n            };\n\ndata.Columns.Add(AVERAGE);\ndata.Columns.Add(TIMESTAMP);\n\nvar points = Service.GetMetricStatistics(reg).GetMetricStatisticsResult.Datapoints.OrderBy(p =&gt; p.Timestamp);\n</code></pre>\n\n<p>But it would be more useful to check the Alarm status directly.</p>\n\n<p>We've iterated over the AmazonEC2.DescribeInstancesResponse result but no joy so far. Has anyone achieved this yet?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":83,"score":7,"question_id":13271880,"title":"Partial ungrouping list of duplicate values","body":"<p>I know how to group data using LINQ, and I know how to split it into separate items, but I have no idea how to only partially ungroup it.  </p>\n\n<p>I have a set of data which looks something like this: </p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } }\n};\n</code></pre>\n\n<p>In order to process this correctly, I need every instance of a duplicate part to be a separate entry in the dictionary (although it doesn't matter if it remains a dictionary - <code>IEnumerable&lt;KeyValuePair&lt;Header, Detail&gt;&gt;</code> is perfectly acceptable).  However, I don't want to split up the <code>Parts</code> list entirely - having different parts in the list is fine.</p>\n\n<p>Specifically, I want the end data to look like this:</p>\n\n<pre><code>{\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n}\n</code></pre>\n\n<p>For a more complex example:</p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part2\", \"Part2\", \"Part3\", \"Part3\"} } }\n};\n\nvar desiredOutput = new List&lt;KeyValuePair&lt;Header, Detail&gt;&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part 3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\", \"Part3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\" } } }\n};\n</code></pre>\n\n<p>Any advice? </p>\n"},{"tags":["c#","coded-ui-tests","page-refresh"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13256868,"title":"Assert on Page Refresh Coded UI","body":"<p>I have a test that needs to verify that an autorefresh property has been set.  My first thought would be to <code>.WaitForControlExist()</code> on a loading page that happens when the page refreshes but Coded UI is too slow to capture that control as it disappears after a half second or so.</p>\n\n<p>My question is whether or not there is a method that will wait for the page to be refreshed that has some sort of timeout similar to WaitForControlExist() </p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13275042,"title":"add cookie to WebClient","body":"<p>I want download pdf with WebClient but i need send cookie with request</p>\n\n<p>how can add cookie to WebClient then download pdf\n<code>\n WebClient webClient = new WebClient();</p>\n\n<p>webClient.DownloadFile(\"http://........\", \"C://2.pdf\");</p>\n\n<p></code></p>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13232660,"title":"Concurrency issues with EF5 / Base Repository","body":"<p>I've finished writing a new application which has now been deployed into the live environment however my global error handler is picking up these exceptions several times throughout the day. These errors come in batches and are one of the four in bold. </p>\n\n<p>MVC 4, IIS 6, Windows Server 2003, .Net .4.0, EF 5 (latest from NuGet)</p>\n\n<p><strong>The type 'ARandomModelInMyContext’ has been mapped more than once.</strong></p>\n\n<p><strong>Index was out of range. Must be non-negative and less than the size of the collection.</strong> </p>\n\n<pre><code>Parameter name: index\nSystem.ThrowHelper.ThrowArgumentOutOfRangeException() at System.Data.Metadata.Edm.MetadataCollection`1.get_Item(Int32 index) at System.Data.Mapping.DefaultObjectMappingItemCollection.ContainsMap(GlobalItem cspaceItem, ObjectTypeMapping&amp; map) at\n</code></pre>\n\n<p><strong>The context cannot be used while the model is being created.</strong></p>\n\n<pre><code>System.Data.Entity.Internal.LazyInternalContext.InitializeContext() at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()\n</code></pre>\n\n<p><strong>The underlying provider failed on Open. The connection was not closed. The connection's current state is connecting.</strong></p>\n\n<p>The structure of the application is a pretty standard MVC4 application with a Service Layer and a repository layer.</p>\n\n<ul>\n<li>A service creates a repo in the constructor </li>\n<li>Repository creates a new Context in the repository constructor like so:</li>\n</ul>\n\n<p><code>public class MyRepository : BaseRepository&lt;MyModel&gt;, IMyRepository</code></p>\n\n<p>With the constructor:</p>\n\n<pre><code>public MyRepository() : base(new MyEntities())\n{\n}\n</code></pre>\n\n<p>Base Repository looks like this:</p>\n\n<pre><code>public class BaseRepository&lt;TEntity&gt; where TEntity : class\n{\n    internal CRMEntities Context;\n    internal DbSet&lt;TEntity&gt; dbSet;\n    public BaseRepository(MyEntities context)\n    {\n        this.Context = context;\n        dbSet = context.Set&lt;TEntity&gt;();\n    }\n}\n</code></pre>\n\n<p>There shouldn't be any concurrency issues as I'm not making directly using any threading or async.</p>\n\n<p>Any ideas? Can my repository structure be improved? I've made all the constructors DI-able however I'm not using an IoC container yet.</p>\n\n<p>Would wrapping the construction of the Context in the repository in lock be worth while? For example:  </p>\n\n<pre><code>public class BaseRepository&lt;TEntity&gt; where TEntity : class\n{\n    internal MyEntities Context;\n    internal DbSet&lt;TEntity&gt; dbSet;\n    private static object _lock = new object();\n\n    public BaseRepository(MyEntities context)\n    {\n        lock (_lock)\n        {\n            this.Context = context;\n            dbSet = context.Set&lt;TEntity&gt;();\n        }\n    }\n }\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12403775,"title":"C# get original resource text for control","body":"<p>If I change the text of a button (say, \"Next\" to \"Finish\"), is there a way of finding the original text so I can put it back, by referring to the resources (i.e. retrieve the word \"Next\" from the resources)?</p>\n\n<p>Obviously I could store the original before changing it, but I am curious as to whether there is a more elegant way of referring to it (e.g. in the same way you refer to a resourced string: <code>global::MyProject.Properties.Resources.LeString</code>).</p>\n"},{"tags":["c#","goto"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":2,"view_count":147,"score":4,"question_id":13274661,"title":"Should I use goto statement?","body":"<p>I have a piece of code like the following:</p>\n\n<pre><code>try\n{\nWork:\n\n   while(true)\n   {\n      // Do some work repeatedly...\n   }\n}\ncatch(Exception)\n{\n   // Exception caught and now I can not continue \n   // to do my work properly\n\n   // I have to reset the status before to continue to do my work\n   ResetStatus();\n\n   // Now I can return to do my work\n   goto Work; \n}\n</code></pre>\n\n<p>Are there better alternatives compared to using <code>goto</code>? Or is this a good solution?</p>\n"},{"tags":["c#",".net","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":74,"score":-2,"question_id":13274651,"title":"C# .net 4 dependency","body":"<p>I have a standalone tool developed in C# Visual Studio Express 2010.\nMy problem is that this tool will fail to start on machines having no .NET installed, and asking for .NET 4 on machines has .NET under 3.5 or lower. \nWhat I basically want to do is to install .NET 4 from my application before the main script runs. I can write a program to download it from an official webpage, also to run the installer etc. But the main problem still exists, the app won't even reach the download part as it won't run on machines...\nI've googled around and found that you can include dll-s etc., but I still doubt I can proceed without a proper .NET installation. So how can run dotnetfx.exe with my .NET dependent application?\nYour attention and ideas are much appreciated.\nCs.</p>\n"},{"tags":["c#","function","plot","console-application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":48,"score":-3,"question_id":13274418,"title":"C#: How to plot a function using console","body":"<p>I want to plot any polynomial function in C# using the console application, without using any windows or forms, I searched a lot but all I found was in window application or involving MATLAB and what I want is something just in the console.</p>\n\n<p>I want it to plot any polynomial function given, for example; the coefficients are stored in an array, and i want to plot the function related to it, for example:</p>\n\n<p>The array is:</p>\n\n<p><code>double[] array = new double[4] { 2 , 0 , -4 , 3 };</code></p>\n\n<p>Then the function is: 3X^3 - 4X^2 + 2</p>\n\n<p>And it will be plotted on the XY-Plane like this:</p>\n\n<p>For Example: X + 1</p>\n\n<p><a href=\"http://i.stack.imgur.com/SD3tb.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/SD3tb.jpg</a></p>\n\n<p>Any help is appreciated.</p>\n\n<p>Update:</p>\n\n<p>Using the method you provided, I tried this code:</p>\n\n<pre><code>        WriteAt(\"|\", 40, 0);\n        WriteAt(\"|\", 40, 1);\n        WriteAt(\"|\", 40, 2);\n        WriteAt(\"|\", 40, 3);\n        WriteAt(\"|\", 40, 4);\n        WriteAt(\"|\", 40, 5);\n        WriteAt(\"|\", 40, 6);\n        WriteAt(\"|\", 40, 7);\n        WriteAt(\"|\", 40, 8);\n        WriteAt(\"|\", 40, 9);\n\n        WriteAt(\"-----------------------------------------\", 20, 10);\n\n        WriteAt(\"|\", 40, 11);\n        WriteAt(\"|\", 40, 12);\n        WriteAt(\"|\", 40, 13);\n        WriteAt(\"|\", 40, 14);\n        WriteAt(\"|\", 40, 15);\n        WriteAt(\"|\", 40, 16);\n        WriteAt(\"|\", 40, 17);\n        WriteAt(\"|\", 40, 18);\n        WriteAt(\"|\", 40, 19);\n        WriteAt(\"|\", 40, 20);\n\n        WriteAt(\"*\", 32, 12);\n        WriteAt(\"*\", 34, 11);\n        WriteAt(\"*\", 36, 10);\n        WriteAt(\"*\", 38, 9);\n        WriteAt(\"*\", 40, 8);\n        WriteAt(\"*\", 42, 7);\n        WriteAt(\"*\", 44, 6);\n        WriteAt(\"*\", 46, 5);\n        WriteAt(\"*\", 48, 4);\n</code></pre>\n\n<p>And I got this:</p>\n\n<p><a href=\"http://i.stack.imgur.com/cqLz2.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/cqLz2.jpg</a></p>\n\n<p>So, now I have to give the WriteAt function the points that must be drawn but putting in mind that the origin is (40,10) in my plotting ??</p>\n\n<p>I subtract 2 from the x-axis because the \"-\" is half the size of the \"|\" so the plot will be kinda scaled.</p>\n"},{"tags":["c#","image-processing","try-catch","unsafe"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":62,"score":2,"question_id":13261875,"title":"try catch exceptions in unsafe code","body":"<p>I am writing some image processing code and use C# to do low level pixel manipulation. Every once in a while, an accessViolationException happens.</p>\n\n<p>There are several approaches to this typical problem, some think code should be written robustly so to not have access violation exceptions, and as far as I try, the application is going fine however I would like to add a try catch so that iff something were to happen, the application would not fail in too ugly of a way.</p>\n\n<p>So far, I have put in some example code to test it out</p>\n\n<pre><code>unsafe\n{\n    byte* imageIn = (byte*)img.ImageData.ToPointer();\n    int inWidthStep = img.WidthStep;\n    int height = img.Height;\n    int width = img.Width;\n    imageIn[height * inWidthStep + width * 1000] = 100; // make it go wrong\n}\n</code></pre>\n\n<p>When I put a try catch around this statement, I still get an exception. Is there a way to catch exceptions generated in an unsafe block?</p>\n\n<p>Edit: as stated down below, this type of exception is no longer handled unless the checking of them is explicitly enabled by adding this attribute to the function and adding the \"using System.Runtime.ExceptionServices\".</p>\n\n<pre><code>[HandleProcessCorruptedStateExceptions]\n    public void makeItCrash(IplImage img)\n    {\n        try\n        {\n            unsafe\n            {\n                byte* imageIn = (byte*)img.ImageData.ToPointer();\n                int inWidthStep = img.WidthStep;\n                int height = img.Height;\n                int width = img.Width;\n                imageIn[height * inWidthStep + width * 1000] = 100; // to make it crash\n            }\n        }\n        catch(Exception e)\n        {\n            // log the problem and get out\n        }\n    }\n</code></pre>\n"},{"tags":["c#","token","lex","lexical-analysis"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13274890,"title":"how to identify digits and expressions","body":"<p>i have been working on a simple lexical analyzer which generates lexemes and tokens\nmy program opens a .cpp file and from then it displays libraries,operators,variables,reserved words and data types,i have 2 problems </p>\n\n<ol>\n<li>i want to change the program so that it opens .cpp and .txt files and generate tokens and lexemes i.e(displays libraries,operators,variables,reserved words and data types) </li>\n</ol>\n\n<p>2.its not displaying digits and expressions</p>\n\n<p>how can i go about solving problems 1 and 2</p>\n\n<p>code for opening a .cpp file//this code only opens .cpp files but i want to modify it so that it opens .txt files too</p>\n\n<pre><code>private void btnOpen_Click(object sender, EventArgs e)\n        {\n            if (openFileDialog1.ShowDialog() == DialogResult.OK)\n            {\n                if (openFileDialog1.FileName.EndsWith(\".cpp\".ToUpper()))\n                {\n                    txtPath.Text = openFileDialog1.FileName;\n                    rTextSource.Text = AnalyzerBackWork.readFullFile(txtPath.Text);                    \n                }\n                else\n                {\n                    MessageBox.Show(\"Must Open a .cpp file\");\n                }\n            }\n            else\n            {\n                return;\n            }\n        } \n</code></pre>\n\n<p>code for searching operators , i want to make a code that will search for digits and expressions</p>\n\n<pre><code>public static void myMain()\n        {            \n            char[] word = new Char[500];\n            int counter = 0;\n            char[] lib = new Char[500];\n            int libCounter = 0;\n\n            ReadFile();\n\n            for (cnt = 0; cnt &lt; index; cnt++)\n            {\n                // FOR CHECKING OPERATORS\n\n                if (Token[cnt] == '+' || Token[cnt] == '-' || Token[cnt] == '*' || Token[cnt] == '/' || Token[cnt] == '%' || Token[cnt] == '&amp;' || Token[cnt] == '^'\n                    || Token[cnt] == '&lt;' || Token[cnt] == '&gt;' || Token[cnt] == '!' || Token[cnt] == '=')\n                {\n                    if (Token[cnt] == '+')\n                    {\n                        if (Token[cnt + 1] == '+')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '-')\n                    {\n                        if (Token[cnt + 1] == '-')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '&lt;')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '&gt;')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '!')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else if (Token[cnt] == '=')\n                    {\n                        if (Token[cnt + 1] == '=')\n                            operators[operatorCount++] = Token[cnt] + \"\" + Token[cnt + 1];\n                        else\n                            operators[operatorCount++] = Token[cnt].ToString();\n                    }\n                    else\n                        operators[operatorCount++] = Token[cnt].ToString();\n                }\n</code></pre>\n"},{"tags":["c#","asp.net","visual-studio-2008","entity-framework"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":10601,"score":2,"question_id":1562807,"title":"Entity framework with \"Group By\" and/or \"Order by\"","body":"<p>Say we've got a project that allows user to download things. On the main page, I want to show the Most downloaded files ordered by the number of download! All that using EF.</p>\n\n<p>How can i do this !! I've tried many things with Group By (Its a nightmare when you've got a lot of informations in an object). And i still dunno how to do this...</p>\n\n<pre><code>var query = from details in m_context.TransactionDetails\n                        where details.Chanson != null\n                        group details by details.Items into AnItem\n                        orderby AnItem.Count()\n                        select new Item() {\n                            IdItem = Chansons.Key.IdItem,\n                            ItemState= Chansons.Key.ItemState,\n                            [...This object got something like 20 including links to other objects ... ]\n                        };\n</code></pre>\n\n<p>Anyone have an idea?</p>\n\n<p>Thanks :o)</p>\n\n<p>Oh and sorry for my english, I'm giving my best but im from Quebec (Usualy talk french).</p>\n"},{"tags":["c#",".net","serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13274421,"title":"Change object at runtime to serializable .NET","body":"<p>I would like change object to ISerializable at runtime. Something like</p>\n\n<pre><code>&lt;!-- language: c# --&gt;\nvar nonSerializeObject = new NonSerialize();\nISerializable mySerializeObject = \n      somethingforserializable.serialize(nonSerializeObject,TypeOfObject);\n</code></pre>\n"},{"tags":["c#","inversion-of-control","prism","unity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13274701,"title":"Should I put all the constructor parameters in the interface to be resolved for the Unity?","body":"<p>I am using Prism with Unity to do the IoC. I have some classes that have some value type parameters (e.g., string path, int number) in their constructors. </p>\n\n<p>How should I deal with these parameters if I want to resolve these classes? </p>\n\n<p>Should I put these parameter into interface or should I put them into a function and call it after the class is resolved?</p>\n\n<p>Thanks,</p>\n\n<p>Wei</p>\n"},{"tags":["c#","selenium","for-loop","webdriver","window-handles"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":483,"score":1,"question_id":11237357,"title":"selenium webdriver window handles c# switchTo failed","body":"<p>Here comes 2 windows pop out during the testing.</p>\n\n<p>my code:</p>\n\n<pre><code>string BaseWindow = driver.CurrentWindowHandle;                 \nReadOnlyCollection&lt;string&gt; handles = driver.WindowHandles;\n\nforeach(string handle in handles)                    \n{                         \nBoolean a=driver.SwitchTo().Window(handle).Url.Contains(\"Main\");\nif (a == true)  \n{       \nInitialSetting.driver.SwitchTo().Window(handle);      \nbreak;\n}  \n}                \n</code></pre>\n\n<p>I want to switch to the window which url contains \"Main\". But when the test is running, it switches between two windows continuously and it doesn't stop.</p>\n\n<p>I debug and found the <code>foreach</code> didn't break even when the <code>boolean a</code> is true.</p>\n\n<p>How can I resolve this? </p>\n"},{"tags":["c#","wpf","collectionviewsource"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13274763,"title":"Correct Way to bind ComboBox to CollectionViewSource","body":"<p>Hey i have a CollectionViewSource Property on my ViewModel.</p>\n\n<p>This ViewModel is bound to a ComboBox this way:</p>\n\n<pre><code>&lt;ComboBox   ItemsSource=\"{Binding Products.View}\" \nSelectedItem=\"{Binding SelectedEntity.Product}\"  \nIsSynchronizedWithCurrentItem=\"True\"/&gt;\n</code></pre>\n\n<p>When binding to an existing SelectedEntity it works fine.</p>\n\n<p>When i try to bind to an <code>SelectedEntity</code>, that dosn't posses a Product i want to display the first Item from the List. Therefore i tried to use <code>Products.View.MoveCurrentToFirst()</code>, but still the first item isn't displayed.</p>\n\n<p>It of course works when i set <code>SelectedEntity.Product = Products.View.CurrentItem.</code></p>\n\n<p>What can i do, to improve my code? This looks somewhat wrong to me...</p>\n"},{"tags":["c#","visual-studio-2010","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13272194,"title":"Context message for UPDATE is not working","body":"<p>I am working on a CRM Dynamics Plugin. There is a field on custom entity named \"email\". I want to make sure that for two entity records email addresses should be unique. For that purpose I have written following code:</p>\n\n<pre><code>public class Class1 : IPlugin\n{\n    public void Execute(IServiceProvider serviceProvider)\n    {\n        // Obtain the execution context from the service provider.\n        Microsoft.Xrm.Sdk.IPluginExecutionContext context = (Microsoft.Xrm.Sdk.IPluginExecutionContext)\n            serviceProvider.GetService(typeof(Microsoft.Xrm.Sdk.IPluginExecutionContext));\n\n        // Get a reference to the organization service.\n        IOrganizationServiceFactory factory =\n        (IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));\n        IOrganizationService service = factory.CreateOrganizationService(context.UserId);\n\n\n        // The InputParameters collection contains all the data passed in the message request.\n        if (context.InputParameters.Contains(\"Target\") &amp;&amp;\n            context.InputParameters[\"Target\"] is Entity)\n        {\n            Entity entity = (Entity)context.InputParameters[\"Target\"];\n\n            //&lt;/snippetAccountNumberPlugin2&gt;\n\n            // Verify that the target entity represents an account.\n            // If not, this plug-in was not registered correctly.\n            if (context.MessageName.ToUpper() == \"CREATE\")\n            {\n                if (entity.LogicalName == \"new_assignment1entity\")\n                {\n                    try\n                    {\n                        QueryExpression query = new QueryExpression(\"new_assignment1entity\");\n                        query.ColumnSet.AddColumns(\"new_email\");\n                        EntityCollection result1 = service.RetrieveMultiple(query);\n                        foreach (var a in result1.Entities)\n                        {\n                            int size = result1.Entities.Count;\n                            if (a.Attributes[\"new_email\"].ToString().Equals(entity[\"new_email\"]))\n                                throw new InvalidPluginExecutionException(\"Duplicate Email found!\");\n                        }\n                    }\n                    catch (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;)\n                    {\n                        //You can handle an exception here or pass it back to the calling method.\n                        throw new InvalidPluginExecutionException(\"Some problem occurred while Querying Records!\");\n                    }\n                }\n            }\n            else if (context.MessageName.ToUpper() == \"UPDATE\")\n            {\n                if (entity.LogicalName == \"new_assignment1entity\")\n                {\n                    try\n                    {\n                        QueryExpression query = new QueryExpression(\"new_assignment1entity\");\n                        query.ColumnSet.AddColumns(\"new_email\");\n                        EntityCollection result1 = service.RetrieveMultiple(query);\n                        foreach (var a in result1.Entities)\n                        {\n                            int size = result1.Entities.Count;\n                            if (a.Attributes[\"new_email\"].ToString().Equals(entity[\"new_email\"]))\n                                throw new InvalidPluginExecutionException(\"Duplicate Email found!\");\n                        }\n                    }\n                    catch (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;)\n                    {\n                        //You can handle an exception here or pass it back to the calling method.\n                        throw new InvalidPluginExecutionException(\"Some problem occurred while Querying Records!\");\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>When User creates a new entity record with duplicate email address this code works and shows a dialog box printing error message. But when User edit an existing record (update and existing record) and makes the email address duplicate then this code does not work and updated record with duplicated email address saved.<br/>\nI am guessing that Context message with UPDATE else part is not working.<br/>\nPlease help me out.</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13273855,"title":"Converting string to ToolStripMenuItem","body":"<p>I have a menu structure already set up on a form and I want to programatically enable or disable certain menu items using a database.</p>\n\n<p>I have got to the last stage where I have a class of <code>AllowedMenu</code> and <code>CodeNames</code> (which match the toolstripmenuitems exactly), and all I want to do it convert the <code>CodeName</code> into a <code>ToolStripMenuItem</code> from a String.</p>\n\n<p>How could I do this?</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13274336,"title":"validation expression for datetime like month/date/year","body":"<p>I need a validation expression for datetime like month/date/year.I tried many expressions.But all contains validation for time also...So please help me...</p>\n"},{"tags":["c#","garbage-collection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13274234,"title":"Library code calling GC.Collect() unnecessarily","body":"<p>A call to a 3rd-party provided compiled .NET DLL is calling GC.Collect() on every call to Submit(). Here's a sample of the disassembled code:</p>\n\n<pre><code>public bool Submit(string destPath, ...)\n{\n    bool result;\n    try\n    {\n        GC.Collect();\n        result = this.Submit_private(destPath, ...);\n</code></pre>\n\n<p>Other than disassembling and re-compiling the code, is there a recommended way to remove this unnecessary call?</p>\n\n<p>Additional info:</p>\n\n<ul>\n<li>The vendor says the code was written by a \"contractor\". I'm assuming it was put there to slow down the calls to Submit() in dev/test - it was written for .NET 1.1 and they don't have a newer version. It's a class library, intended to be re-used - why would you ever put a GC.Collect() on a method you expect callers to call continuously?</li>\n<li>The Submit_private() method validates, constructs, sends an HTTP request. It also processes the response message.</li>\n</ul>\n"},{"tags":["c#","asp.net","asp.net-mvc","login","forms-authentication"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13273375,"title":"Why does my login page keep reloading, without trying to authenticate?","body":"<p>In Controllers/AccountController.cs:</p>\n\n<pre><code>public class AccountController : Controller\n{\n    //\n    // GET: /Account/Login\n    public ActionResult Login()\n    {\n        return View();\n    }\n    ...\n}\n</code></pre>\n\n<p>In web.config:</p>\n\n<pre><code>&lt;authentication mode=\"Forms\"&gt;\n  &lt;forms loginUrl=\"~/Account/Login\" defaultUrl=\"~/Home/Index\" name=\".ASPXFORMSAUTH\"/&gt;\n&lt;/authentication&gt;\n&lt;authorization&gt;\n  &lt;deny users=\"?\"/&gt;\n&lt;/authorization&gt;\n</code></pre>\n\n<p>In Views/Account/Login.aspx:</p>\n\n<pre><code>&lt;script runat=\"server\" type=\"text/C#\"&gt;\n    protected void Page_Load(object sender, EventArgs e) {...}\n    protected void OnAuthenticate(object sender, AuthenticateEventArgs e) {...}\n    protected void OnLoggedIn(object sender, EventArgs e){...}\n    protected void OnLoginError(object sender, EventArgs e){...}\n&lt;/script&gt;\n\n...\n\n&lt;asp:Login ID=\"login1\" runat=\"server\" \n           DestinationPageUrl=\"~/Views/Home/Index.aspx\"\n           OnAuthenticate=\"OnAuthenticate\" \n           OnLoggedIn=\"OnLoggedIn\" \n           OnLoginError=\"OnLoginError\"&gt;\n    ...\n    &lt;asp:Button ID=\"loginButton\" runat=\"server\" CommandName=\"Login1\" Text=\"Login\" ValidationGroup=\"login1\" TabIndex=\"4\" /&gt;\n    ...\n&lt;/asp:Login&gt;\n</code></pre>\n\n<p><code>Page_Load</code> is called, but then <code>OnAuthenticate</code>, <code>OnLoggedIn</code>, and <code>OnLoginError</code> are never called. Why is that?</p>\n\n<p>I am using MVC, and what happens after clicking the \"Login\" button is I am taken back to the AccountController. This returns the Login.aspx View, so the login page just gets reloaded.</p>\n"},{"tags":["c#","windows","events"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13257499,"title":"How to create CRITICAL events for Windows Event Viewer?","body":"<p>I searched on stackoverflow for previously asked questions and did not find much that helped.</p>\n\n<p>I'm trying to create a c# app that can create windows events (locally and remotely).  I would like to be able to create Critical event-levels (maybe verbose too?).</p>\n\n<p>Anyways, I've been digging around for a couple days now and can't find an answer.  Help would be much appreciated.</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13272641,"title":"How to Assign a data column value to specific word uisng C#","body":"<p>I have a field in my table in which I would like to set a string  like “COMPLETE”.   Initially the field is empty  and I want to set it some kind of text like “COMPLETE”  Here is what I have so far…</p>\n\n<pre><code>   string ID = GV_Action.Rows[0].Cells[1].Text;\n\n    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString);\n\n    SqlCommand cmd = new SqlCommand(\"sp_Update\", con);\n    cmd.CommandType = CommandType.StoredProcedure;\n\n    cmd.Parameters.Add(\"@ID\", SqlDbType.VarChar).Value = ID;\n\n    cmd.Connection = con;\n    con.Open();\n    cmd.ExecuteNonQuery();\n    con.Close();\n</code></pre>\n\n<p>in my Strored procedure below i am using a default ID but would like to pass the paramter ID  and not use the fixed value how can i do that?\nhere is how i created the proc\nCREATE PROC sp_Update</p>\n\n<p>AS</p>\n\n<p>EXEC msdb.dbo.sp_start_job N'UpdateField';</p>\n\n<p>GO</p>\n\n<p>EXEC sp_Update</p>\n\n<p>and here is job that i am calling when the procedure kicks off\nupdate MyTable</p>\n\n<p>set Status = 'Complete'\n  where Post_ID = 303</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":22,"down_vote_count":1,"view_count":4668,"score":21,"question_id":6089403,"title":"Delete all entities in Entity Framework","body":"<p>I want to delete content of all tables (all entities using Entity Framework 4+).\nHow can this be done?</p>\n\n<p>Thanks, James</p>\n"},{"tags":["c#","asp.net","html","asp.net-mvc","webclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13273688,"title":"Right Accept Type?","body":"<p>In my ASP.NET MVC app, I am providing a link to a .csv file:</p>\n\n<pre><code>WebClient wc = new WebClient();\n                    wc.Headers.Add(\"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\");\n                    wc.Headers.Add(\"Accept\", \"text/plain,text/html,application/xml;q=0.9,*/*;q=0.8\");                   \n                    wc.Headers.Add(\"Accept-Charset\", \"ISO-8859-1,utf-8;q=0.7,*;q=0.3\");\n                    byte[] csvBytes = wc.DownloadData(url);\n                    return File(csvBytes, \"application/octet-stream\", \"Target.csv\"); \n</code></pre>\n\n<p>The url returns the following data:</p>\n\n<pre><code>&lt;string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/\"&gt;\n\"PAUL\",\"SMITH\",\"A &amp; P CONSTRUCTION\",\"211 N JACKSON ST\",\"PAPILLION\",\"NE\",\"68046\" \"JEROME\",\"HALSEY\",\"A A A LOCATING INC\",\"1906 SOUTHVIEW DR\",\"NEW YORK\",\"NY\",\"68046\" \"MIKE\",\"GIBILISCO\",\"ABSOLUTE SECURITY INC\",\"944 S JEFFERSON ST\",\"OMAHA\",\"NE\",\"68102\"\n&lt;/string&gt;\n</code></pre>\n\n<p>When I open the .csv, I get the right data except for first row/first column:</p>\n\n<pre><code>&lt;string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/\"&gt;\"PAUL\"  SMITH   A &amp;amp; P CONSTRUCTION  211 N JACKSON ST    PAPILLION   NE  68046\n</code></pre>\n\n<p>What Accept type should I use to get rid of the string tag.</p>\n"},{"tags":["c#","winforms","visual-studio-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13230311,"title":"Why does MS Chart only display x-axis labels for some data points?","body":"<p>When I bind the data to the barchart. I am not able to see the labels in the X-axis for some bars. E.g: i bind four data to the chart. The chart is displaying only 2nd and 4th data label.</p>\n"},{"tags":["c#","c#-4.0","xna","xna-4.0","spritefont"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":4,"view_count":86,"score":1,"question_id":13243130,"title":"How to draw special characters in XNA?","body":"<p>I want to draw special characters like: \"π,Ω,θ,ξ\" in XNA by using method \n<code>SpriteBatch.DrawString()</code>, but I get an exception saying those <strong>characters aren't available</strong> in the SpriteFont file. Is there any solution for this?</p>\n"},{"tags":["c#","visual-studio","installer","suite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13274602,"title":"Creating a Windows Installer Using Visual Studio for a Suite","body":"<p>I have several C# programs that I would like to create an installer for as a suite. I'm wanting to create this in Visual Studio if possible using the Setup Project. This is my first time creating an installer for a suite, so I am unfamiliar with what most people use and how to do it. I'm also open to what other tools that I could use that might be able to get the job done better/easier. Here is what I'm wanting to be able to do:</p>\n\n<ul>\n<li><p>Licensing agreement that has the standard agree checkbox/radio button</p></li>\n<li><p>Type in a CD Key and the installer will automatically know what programs to install based on how the CD key is configured.</p></li>\n</ul>\n\n<p>OR</p>\n\n<ul>\n<li><p>Have a list of checkboxes displaying each program (similar to office) and the user can check which ones they would like to install. And maybe after selecting, have an option to type in the CD key to verify they have rights to use those programs. I'm not sure if this could be done during the installation process or if it would be best to do it when the program loads.</p></li>\n<li><p>Creates an uninstaller</p></li>\n<li><p>Other normal steps in an installation (Readme, Program location, etc.)</p></li>\n</ul>\n\n<p><strong>The main component I'm wanting out of this is to install programs that I select.</strong></p>\n"},{"tags":["c#","il2js"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13273574,"title":"How do I invoke IL2JS correctly?","body":"<p>So I saw Microsoft open-sourced <a href=\"https://github.com/Reactive-Extensions/IL2JS\" rel=\"nofollow\">IL2S</a>, which seems to be a tool to compile a silverlight applications to pure javascript via compiling the IL.</p>\n\n<p>However, I can't seem to get it to work.  When I run: </p>\n\n<blockquote>\n  <p>PS C:\\source\\IL2JS-master\\bin> ./il2jsr -rewrite C:\\FlatRedBallProjects\\Test1\\Te\n  st1\\Test1\\Bin\\Debug\\Test1.dll  -out test.js -reference .\\IL2JS_mscorlib.dll</p>\n</blockquote>\n\n<p>When I run this I get</p>\n\n<blockquote>\n  <p>error 3003: No assembly name resembled the special 'JSTypes' assembly\n  1 errors, 0 warnings</p>\n</blockquote>\n\n<p>So I tried to add another -reference option for jstypes and got the following output:</p>\n\n<blockquote>\n  <p>PS C:\\source\\IL2JS-master\\bin> ./il2jsr -rewrite C:\\FlatRedBallProjects\\Test1\\Test1\\Test1\\Bin\\Debug\\Test1.dll  -out test.js -reference .\\IL2JS_mscorlib.dll -reference  .\\IL2JS_JSTypes_silverlight.dll</p>\n  \n  <p>error 3005: Unable to load assembly from file 'C:\\source\\IL2JS-master\\bin': cannot load mscorlib\n  1 errors, 0 warnings</p>\n</blockquote>\n\n<p>So it seems like you can only have one -reference option, but you need to somehow reference both jstypes and mscorlib assemblies.</p>\n\n<p>What am I doing wrong?</p>\n\n<p><hr>\n<b>Edit</b>: \nSo after some more debugging it seems like the correct way to do this is to use 2 -reference arguments.  The reason why the latter doesn't work is because of </p>\n\n<pre><code>        CCI.SystemTypes.Initialize(false, true, ResolveReference);\n\n        // ----------------------------------------\n        // Account for mscorlib being loaded\n        // ----------------------------------------\n        mscorlib = CCI.SystemTypes.SystemAssembly;\n        if (mscorlib == null || mscorlib.Directory == null)\n</code></pre>\n\n<p>In <code>AssemblyLoader.cs</code>.  That last if statement fails (<code>mscorlib.Directory</code> is null).  Now the question is why...</p>\n"},{"tags":["c#",".net","dynamic","assemblies","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13272877,"title":"CSharpCodeProvider and resolution of dynamic assemblies","body":"<p>I have an application where I'm using CSharpCodeProvider to allow for integrated scripting via C# code.  The scripts can refer to dynamically emitted assemblies (these are created via IL Emit); to allow this reference, I save the dynamically generated assembly to a file on disk, then add this location to the CompilerParameters.ReferencedAssemblies collection.</p>\n\n<p>This works fine for the first compilation and execution of the script.  I have code that instantiates a class generated from the script, which has a constructor taking parameters, of which some are types from the dynamically emitted assembly.  It looks like this:</p>\n\n<pre><code>        var hostType = _compilerResults.CompiledAssembly.GetType(\"ExMod.Engine.ScriptHost\");\n\n        var parameters = new List&lt;object&gt;();\n        parameters.Add(simulation);\n\n        var extraParameters =\n            simulation.Environment.Controllers.\n            Select(c =&gt; c.GetPrecompiledContext()).\n            Where(c =&gt; c != null);\n        parameters.AddRange(extraParameters);\n\n        _scriptHost = (ScriptHostBase)Activator.CreateInstance(hostType, parameters.ToArray());\n</code></pre>\n\n<p>The extraParameters expression is where the references to the external dynamically generated types get added.</p>\n\n<p>The problem occurs when I attempt to compile and run the script a second time.  It only occurs if I've also re-emitted a new version of my IL Emit assembly.  The Exception occurs on the Activator.CreateInstance call and is:</p>\n\n<p><code>MissingMethodException: Constructor on type 'ExMod.Engine.ScriptHost' not found.</code></p>\n\n<p>Observations:</p>\n\n<ol>\n<li>I've confirmed via the Debugger that a constructor does exist with the correct parameters.</li>\n<li>I've also confirmed (using the Make Object ID in the Debugger) that the issue is caused because the 'Controller' parameter in the constructor (referenced type from the dynamically emitted assembly) is referring to the original dynamic assembly, rather than the most recently emitted dynamic assembly, which is why the types don't match and the constructor does not resolve.</li>\n<li>When I run the CSharpCodeProvider compiler and then try to run the script, it never calls my AppDomain AssemblyResolve event, which is where I have special logic to always resolve to the 'most recent' dynamic assembly.</li>\n</ol>\n\n<p>My theory is that somehow the CSharpCodeProvider is resolving the 'earliest' dynamic assembly rather than the 'latest'. This occurs because they both have the same name and location.  The question: how do I get the CSharpCodeProvider to resolve to the latest version of the dynamic assembly?</p>\n\n<p>I've considered changing the location for each dynamically emitted assembly, but I'd prefer not to create a bunch of copies on disk for each script iteration.</p>\n"},{"tags":["c#","visual-studio-2008"],"answer_count":10,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":3931,"score":7,"question_id":1477582,"title":"Error Creating Debug Information - Code Won't Compile","body":"<p>I'm using VS 2008. When ever I make a change in my code and try to compile I get the following error:</p>\n\n<blockquote>\n  <p>Error 7\tUnexpected error creating\n  debug information file 'C:\\Documents\n  and Settings\\jbezanson\\My\n  Documents\\MyProjects\\DispatchBoard\\DispatchBoard\\obj\\Debug\\DispatchBoard.PDB'\n  -- 'C:\\Documents and Settings\\jbezanson\\My\n  Documents\\MyProjects\\DispatchBoard\\DispatchBoard\\obj\\Debug\\DispatchBoard.pdb:\n  The process cannot access the file\n  because it is being used by another\n  process. '    DispatchBoard</p>\n</blockquote>\n\n<p>Using Process Explorer, it is always <code>devenv.exe</code> that is locking the file. If I run in Release mode this does not happen. It started 2 days ago when I started a WPF application, and since then it happens with every application I work on.</p>\n\n<p>The only info I could find from Google was referring to a bug in VS 2003. </p>\n\n<p>Anyone else have this problem? How do I fix it? It is getting very annoying having to kill the file handle every time I want to compile.</p>\n"},{"tags":["c#","asp.net","generic-handler","sagepay"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13274232,"title":"ASP.NET handle a POST from Sage Pay","body":"<p>I am writing an asp.net web application to talk to sage pay and make payments via their server to server method. At present my site collects user details and then sends a transaction registration HttpRequest to their server. Their server then responds to my request with some details and a redirect link. I check out the reponse object and then redirect to their payment page where the users payment details (card number etc) can be entered. Once the user has clicked confirm then sage will send a POST to a url of my choosing which I can then process and tell them whether to continue with the transaction or not.</p>\n\n<p>What I am aiming to do is receive the POST from them, check the content and respond accordingly. I must then give them as part of my  success or failure url which their site will send the user too on completion of the transaction. If I were sending a request first it would be easy but I am not. They just need an address to send the response to and then I must process it.</p>\n\n<p>My question is this. How can I handle an HttpRequest (I assume this is what it will be?) in my web application? </p>\n\n<p>Can I do this by telling them to respond to a generic handler? If I were to give them the url of my generic handler could I process the POST in there and then respond to them?</p>\n"}]}
{"total":375450,"page":13,"pagesize":100,"questions":[{"tags":["c#","windows","winrt-xaml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13274495,"title":"WinRT XAML TextBlock - Hyperlink Feature","body":"<p>I have a textblock as given below. I would like to make just one word clickable. Kind of like a hyperlink to another page.</p>\n\n<pre><code>&lt;TextBlock&gt;\n    &lt;Run Text=\"I can haz \" /&gt;\n    &lt;Run Text=\"Cheezburger\" Click=\"Cheezburger_Click\" /&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>Is such functionality possible?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13260191,"title":"Winforms controls and \"generic\" events handlers. How can I do this?","body":"<p>In the demo of the ObjectListView control there is this code (in the \"Complex Example\" tab page) to allow for a custom editor (a ComboBox) (Adapted to my case and edited for clarity):</p>\n\n<pre><code>EventHandler CurrentEH;\nprivate void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        ISomeInterface M = (e.RowObject as ObjectListView1Row).SomeObject; //(1)\n        ComboBox cb = new ComboBox();\n        cb.Bounds = e.CellBounds;\n        cb.DropDownStyle = ComboBoxStyle.DropDownList;\n        cb.DataSource = ISomeOtherObjectCollection;\n        cb.DisplayMember = \"propertyName\";\n        cb.DataBindings.Add(\"SelectedItem\", \n                            M, \"ISomeOtherObject\", false,\n                            DataSourceUpdateMode.Never);\n        e.Control = cb;\n        cb.SelectedIndexChanged += \n            CurrentEH = (object sender2, EventArgs e2) =&gt;\n                M.ISomeOtherObject = \n                    (ISomeOtherObject)((ComboBox)sender2).SelectedValue;   //(2)\n    }\n}\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n    {\n        // Stop listening for change events\n        ((ComboBox)e.Control).SelectedIndexChanged -= CurrentEH;\n        // Any updating will have been down in the SelectedIndexChanged\n        // event handler.\n        // Here we simply make the list redraw the involved ListViewItem\n        ((ObjectListView)sender).RefreshItem(e.ListViewItem);\n        // We have updated the model object, so we cancel the auto update\n        e.Cancel = true;\n    }\n}\n</code></pre>\n\n<p>I have too many other columns with combo editors inside objectlistviews to use a copy&amp; paste strategy (besides, copy&amp;paste is a serious source of bugs), so I tried to parameterize the code to keep the code duplication to a minimum. ObjectListView_CellEditFinishing is a piece of cake:</p>\n\n<pre><code>HashSet&lt;OLVColumn&gt; cbColumns = new HashSet&lt;OLVColumn&gt; (new OLVColumn[] { SomeCol, SomeCol2, ...};\n\nprivate void ObjectListView_CellEditFinishing(object sender,\n                                               CellEditEventArgs e)\n{\n    if (cbColumns.Contains(e.Column)) ...\n</code></pre>\n\n<p>but ObjectListView_CellEditStarting is the problematic.</p>\n\n<p>I guess in CellEditStarting I will have to discriminate each case separately:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        // code to create the combo, put the correct list as the datasource, etc.\n    else if (e.Column == SomeOtherCol)  \n        // code to create the combo, put the correct list as the datasource, etc.\n</code></pre>\n\n<p>And so on.</p>\n\n<p>But how can I parameterize the \"code to create the combo, put the correct list as the datasource, etc.\"? Problem lines are </p>\n\n<p>(1) Get SomeObject. the property NAME varies.</p>\n\n<p>(2) Set ISomeOtherObject, the property name varies too.</p>\n\n<p>The types vary too, but I can cover those cases with a generic method combined with a not so \"typesafe\" API (for instance, the cb.DataBindings.Add and cb.DataSource both use an <code>object</code>)</p>\n\n<p>Reflection? more lambdas? Any ideas? Any other way to do the same?</p>\n\n<p>PS: I want to be able to do something like this:</p>\n\n<pre><code>private void ObjectListView_CellEditStarting(object sender,\n                                             CellEditEventArgs e)\n{\n    if (e.Column == SomeCol)\n        SetUpCombo&lt;ISomeInterface&gt;(ISomeOtherObjectCollection,\n                                   \"propertyName\",\n                                   SomeObject,\n                                   ISomeOtherObject);\n\n    else if (e.Column == SomeOtherCol)  \n        SetUpCombo&lt;ISomeInterface2&gt;(ISomeOtherObject2Collection,\n                                   \"propertyName2\",\n                                   SomeObject2\n                                   ISomeOtherObject2);\n</code></pre>\n\n<p>and so on. Or something like that.</p>\n\n<p>I know, parameters SomeObject and ISomeOtherObject are not real parameters per see, but you get the idea of what I want. I want not to repeat the same code skeleton again and again and again.</p>\n\n<p>One solution would be \"preprocessor generics\" like C's DEFINE, but I don't thing c# has something like that.</p>\n\n<p>So, does anyone have some alternate ideas to solve this?</p>\n"},{"tags":["c#","gridview","windows-mobile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13247404,"title":"Get Value of a colum from GridView Windows Mobile 6.0","body":"<p>Somebody please tell me how to get the value of the first column of the selected row of gridview in windows mobile application 6.0 (Emulator is standard). I used to get this value from the windows application by using the code shown below but this is not working in windows mobile 6.0 standard verstion</p>\n\n<pre><code>dgridShipmentItemTypes.Rows[nIndex].Cells[\"dgridShmtItmTypeName\"].Value.ToString();\n</code></pre>\n"},{"tags":["c#","asp.net","itextsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4974,"score":0,"question_id":8414637,"title":"iTextSharp HTMLWorker ParseHTML Tablestyle and PDFStamper","body":"<p>Hi I have succesfully used a HTMLWorker to convert a gridview using asp.NET / C#.</p>\n\n<p>(1) I have applied some limited style to the resulting table but cannot see how to apply tablestyle for instance grid lines or apply other formatting style such as a large column width for example for a particular column. \n(2) I would actually like to put this text onto a pre-existing template which contains a logo etc. I've used PDF Stamper before for this but cannot see how I can use both PDFStamper and HTMLWorker at once. HTMLWorker needs a Document which implements iDocListener ... but that doesnt seem compatible with usign a PDFStamper. I guess what I am looking for is a way to create a PDFStamper, write title etc, then add the parsed HTML from the grid. The other problem is that the parsed content doesnt interact with the other stuff on the page. For instance below I add a title chunk to the page. Rather than starting below it, the parsed HTML writes over the top. How do I place / interact the parsed HTML content with the rest of what is on the PDF document ? </p>\n\n<p>Thanks in advance\nRob</p>\n\n<p>Here';s the code I have already </p>\n\n<pre><code>            Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 30f, 0f);\n\n            HTMLWorker htmlWorker = new HTMLWorker(pdfDoc);\n\n            StyleSheet styles = new StyleSheet();\n            styles.LoadTagStyle(\"th\", \"size\", \"12px\");\n            styles.LoadTagStyle(\"th\", \"face\", \"helvetica\");\n            styles.LoadTagStyle(\"span\", \"size\", \"10px\");\n            styles.LoadTagStyle(\"span\", \"face\", \"helvetica\");                \n            styles.LoadTagStyle(\"td\", \"size\", \"10px\");\n            styles.LoadTagStyle(\"td\", \"face\", \"helvetica\");     \n\n            htmlWorker.SetStyleSheet(styles);\n\n            PdfWriter.GetInstance(pdfDoc, HttpContext.Current.Response.OutputStream);\n\n            pdfDoc.Open();\n\n            //Title - but this gets obsured by data, doesnt move it down\n            Font font = new Font(Font.FontFamily.HELVETICA, 14, Font.BOLD);\n            Chunk chunk = new Chunk(title, font);                \n            pdfDoc.Add(chunk);\n\n\n            //Body\n            htmlWorker.Parse(sr);\n</code></pre>\n"},{"tags":["c#","asp.net","pdf","itextsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13270321,"title":"How to place the text in desired position of a new page in pdf?","body":"<p>I am using CSharp and iTextSharp for creating pdf.</p>\n\n<p>This is my code to place the text:</p>\n\n<pre><code>        PdfContentByte cb = writer.DirectContent;\n        cb.BeginText();\n        cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, text, width, height, 0);\n        cb.EndText();\n</code></pre>\n\n<p>After I create new page using.</p>\n\n<pre><code>        doc.NewPage();\n</code></pre>\n\n<p>and try to place the text in new page like this is not working:</p>\n\n<pre><code>        cb.BeginText();\n        cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, text, width, height, 0);\n        cb.EndText();\n</code></pre>\n\n<p>But This is working:</p>\n\n<pre><code>        ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT,\n        new Phrase(Petrol[i], font), 451 + i * x, 684, 0)\n</code></pre>\n\n<p>Can someone explain why cb.ShowTextAligned() is not worked.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","amazon-ec2","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":21,"score":3,"question_id":13274353,"title":"Easiest way to get EC2 instance attributes within the instance itself","body":"<p>Can you guys show me how to retrieve instanceId, dns public name and type of current EC2 instance from where I'm running the code... </p>\n\n<p>I'm playing with <code>DescribeInstanceAttribute()</code>, but it needs to supply the instanceId to the request, and I can't find how to get the id of currently running instance.</p>\n"},{"tags":["c#","wpf","xaml","datagrid","string-formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13272144,"title":"How can i format a string as currency in a data bound DataGrid in WPF C#?","body":"<p>I have some data being shown in a DataGrid.  The data comes from SQL, where a \"money\" type can be null.  When i display this data, all is OK when i format the data in a double column format as currency.  ie:</p>\n\n<p>internal void FillGrid()\n        {</p>\n\n<pre><code>        bD = new DataTable();\n        DataTable dt = EmployerQuery();  //queries the SQL DB\n\n\n        bD.Columns.Add(new DataColumn(\"ID\", typeof(int)));\n        bD.Columns.Add(new DataColumn(\"EmployerName\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"FlatMinAmount\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"DistrictRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"VendorRate\", typeof(double)));\n        bD.Columns.Add(new DataColumn(\"Description\", typeof(string)));\n        bD.Columns.Add(new DataColumn(\"EmployeeCount\", typeof(int)));\n\n        foreach (DataRow sqlRow in dt.Rows)\n        {\n            var row = bD.NewRow();\n            row[\"ID\"] = sqlRow[\"ClientID\"];\n            row[\"EmployerName\"] = sqlRow[\"OfficialName\"];\n            row[\"FlatMinAmount\"] = sqlRow[\"FlatMinAmount\"];\n            row[\"DistrictRate\"] = sqlRow[\"DistrictRate\"];\n            row[\"VendorRate\"] = sqlRow[\"VendorRate\"];\n            row[\"Description\"] = sqlRow[\"Description\"];\n            row[\"EmployeeCount\"] = sqlRow[\"EmployeeCount\"];\n\n            bD.Rows.Add(row);\n\n        }    \n</code></pre>\n\n<p></p>\n\n<p>However, I then save the data as a .csv file.  When i read that file back, the values for \"FlatMinAmount\" that were null are not allowed to be inserted into a column type double, so I cannot format the data columns as type double, since many are null.  </p>\n\n<pre><code>&lt;dg:DataGrid Name=\"newGrid\" ItemsSource=\"{Binding ElementName=readGrid, Path=readGrid}\" AutoGenerateColumns=\"False\"\n                 Margin=\"5\" Height=\"175\" Width=\"Auto\" ColumnWidth=\"Auto\"&gt;\n        &lt;dg:DataGrid.Columns&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding ID}\" Header=\"Employer ID\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployerName}\" Header=\"Employer Name\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding FlatMinAmount, StringFormat=C}\" Header=\"FlatMinAmount\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding DistrictRate, StringFormat=C}\" Header=\"District Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding VendorRate, StringFormat=C}\" Header=\"Vendor Rate\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding Description}\" Header=\"Description\" Width=\"Auto\" IsReadOnly=\"True\"/&gt;\n            &lt;dg:DataGridTextColumn Binding=\"{Binding EmployeeCount}\" Header=\"EmployeeCount\" Width=\"*\" IsReadOnly=\"True\"/&gt;\n        &lt;/dg:DataGrid.Columns&gt;\n    &lt;/dg:DataGrid&gt;\n\n\nDataTable r = new DataTable();\n\n        try\n        {\n            //string csv = string.Empty;\n\n            //r.Columns.Add(\"ID\", typeof(int));\n            //r.Columns.Add(\"EmployerName\", typeof(string));\n            //r.Columns.Add(\"FlatMinAmount\",typeof(double));\n            //r.Columns.Add(\"DistrictRate\", typeof(double));\n            //r.Columns.Add(\"VendorRate\", typeof(double));\n            //r.Columns.Add(\"Description\", typeof(string));\n            //r.Columns.Add(\"EmployeeCount\", typeof(int));\n\n            r.Columns.Add(\"ID\");\n            r.Columns.Add(\"EmployerName\");\n            r.Columns.Add(\"FlatMinAmount\");\n            r.Columns.Add(\"DistrictRate\");\n            r.Columns.Add(\"VendorRate\");\n            r.Columns.Add(\"Description\");\n            r.Columns.Add(\"EmployeeCount\");\n\n            // Read sample data from CSV file\n            using (CsvFileReader reader = new CsvFileReader(filename))\n            {\n                CsvRow row = new CsvRow();\n                while (reader.ReadRow(row))\n                {\n                    //foreach (string s in row)\n                    {\n                        r.Rows.Add(row[0], row[1], row[2], row[3], row[4], row[5], row[6]);\n\n\n                    }\n\n                }\n            }\n</code></pre>\n\n<p>(readGrid is then set to r in code-behind) </p>\n\n<p>If they are string, then i cannot use the StringFormat=C in the binding to show $ etc.  Also, it seems I cannot style a DataGridTextColumn.  So, how can i display the values I read in from .csv as $xx.xx?</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":71,"score":0,"question_id":13273508,"title":"Extension method must be defined in a non-generic static class","body":"<p>I'm getting the above error. I saw other similar posts on this error but I don't seem to find where the problem is. I changed my class type to static and the error resists. This is the entire code to my main form class:</p>\n\n<p>I Edited my class. This is how it looks like now and the error has changed to:Missing partial modifier on declaration of type 'PhoneFind.frmMain'; another partial declaration of this type exists.</p>\n\n<pre><code>namespace PhoneFind\n{\n    public partial class frmMain : Form\n    {\n        // the path to the temporary file to store the webresponse\n        String path = \"c:\\\\Temp\\\\webresponse.txt\";\n        public frmMain()\n        {\n            InitializeComponent();\n            comboSelectSearchEngine.SelectedIndex = 0;\n            ofdPhones.Filter = \"txt files (*.txt)|*.txt\";\n            listbxMessages.Items.Clear();\n            addItemToListBox(listbxMessages, \"Welcome to ActionBase Phone Find!\");\n            addItemToListBox(listbxMessages, \"Select the file containing the numbers.\");\n            radioNumbers.Checked = true;\n        }\n\n        private void frmMain_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        private void btnLoadFile_Click(object sender, EventArgs e)\n        {\n            if (ofdPhones.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                txtFile.Text = ofdPhones.FileName;\n\n                // Read the file line by line and add the numbers to the numbers listbox.\n                listbxNumbers.Items.Clear();\n                String line;\n                int numbersCounter = 0;\n                System.IO.StreamReader file = new System.IO.StreamReader(ofdPhones.FileName);\n                while ((line = file.ReadLine()) != null)\n                {\n                    listbxNumbers.Items.Add(line.Trim());\n                    numbersCounter++;\n                }\n                addItemToListBox(listbxMessages, ofdPhones.FileName + \" loaded.\");\n                addItemToListBox(listbxMessages, numbersCounter + \" records found in the file.\");\n\n            }\n        }\n\n        // add item to the listbox and move scroll to the end of the listbox for the latest messages to be visibile to the viewer\n        private void addItemToListBox(ListBox listbox, String item)\n        {\n            listbox.Items.Add(item);\n            listbox.SelectedIndex = (listbox.Items.Count - 1);\n        }\n\n        private void radioNumbers_CheckedChanged(object sender, EventArgs e)\n        {\n            if (!radioNumbers.Checked)\n            {\n                grpbxNumbers.Text = \"Names and Addresses\";\n            }\n            else\n            {\n                grpbxNumbers.Text = \"Numbers\";\n            }\n        }\n\n        private void btnRun_Click(object sender, EventArgs e)\n        {\n            if (listbxNumbers.Items.Count == 0)\n            {\n                MessageBox.Show(\"No records have been loaded.\" + \"\\n\" + \"Use the browse button to load records.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            }\n            else if (!CheckForInternetConnection())\n            {\n                MessageBox.Show(\"No internet connection.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            }\n            else\n            {\n                String response;\n                switch (comboSelectSearchEngine.SelectedIndex)\n                {\n                    case 0: // Hitta.se\n                        foreach (String item in listbxNumbers.Items)\n                        {\n                            WebRequestObj request = new WebRequestObj(item, \"hitta\");\n                            response = request.sendRequest();\n                            if (response.Equals(\"Error\"))\n                            {\n                                addItemToListBox(listbxMessages, \"Error sending '\" + item + \"' to the server.\");\n                            }\n                            else\n                            {\n                                //create a temporary file to work on the response\n                                StreamWriter sw;\n                                if (!File.Exists(path)) {\n                                    sw = File.CreateText(path);\n                                }\n                                try\n                                {\n                                    File.WriteAllText(path, String.Empty); // clear the content of the file\n                                    sw = File.AppendText(path);\n                                    sw.WriteLine(response);\n                                    sw.Flush();\n                                    sw.Close();\n                                    String s = findResultType(path);\n                                    MessageBox.Show(s);\n                                }\n                                catch (IOException ioe)\n                                {\n                                    MessageBox.Show(ioe.Message,\"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n                                }\n\n\n                            }\n                        }\n                        break;\n                }\n            }\n        }\n\n        public bool CheckForInternetConnection()\n        {\n            try\n            {\n                using (var client = new System.Net.WebClient())\n                using (var stream = client.OpenRead(\"http://www.google.com\"))\n                {\n                    return true;\n                }\n            }\n            catch\n            {\n                return false;\n            }\n        }\n\n        /*\n         * findResultType\n         * gets the web response and finds out if the matching result of the search termis one of the following:\n         * 1. one person (oneperson)\n         * 2. one company (onecompany)\n         * 3. more than one person, no company (manypersonnocompany)\n         * 4. no person, more than one company (nopersonmanycompany)\n         * 5. more than one person, more than one company (manypersonmanycompany)\n         * 6. no person, no company (nopersonnocompany)\n         */\n        public String findResultType(String reponsepath)\n        {                   \n            HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();\n            doc.Load(reponsepath);\n            List&lt;String&gt; itemList = new List&lt;String&gt;();\n            IEnumerable&lt;String&gt; v = null;\n            var item = doc.DocumentNode.SelectNodes(\"//body[@id='person']\");\n\n            if (item != null)\n            {\n                v = item.Select(p =&gt; p.InnerText);\n                itemList = v.ToList();\n                if (itemList.Count == 1)\n                    return \"oneperson\";\n            }\n            else\n            {\n                item = doc.DocumentNode.SelectNodes(\"//body[@id='company']\");\n                if (item != null)\n                {\n                    v = item.Select(p =&gt; p.InnerText);\n                    itemList = v.ToList();\n                    if (itemList.Count == 1)\n                        return \"onecompany\";\n                }\n            }\n\n            //for (int i = 0; i &lt; itemList.Count; i++)\n            //{\n            //    MessageBox.Show(itemList[i]);\n            //    //console.writeline(itemlist[i]);\n            //}\n            //console.writeline(itemlist.count + \" results found.\");\n            return \"\";\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13274113,"title":"Variables that accept values with pipe | as separator","body":"<p>I have six variables of type <code>String</code>, they contain 0/1 value retrieved from a DB field bit.</p>\n\n<p>So,these variables are value of radio boxes, that have Y=1 | N=0. </p>\n\n<p>Now,  I have a Varilable,  that accept one or more enumerator values, they are separated by pipe \"|\".</p>\n\n<pre><code>if (bool.Parse(mht_ReadAccess) &amp;&amp; bool.Parse(mht_WriteAccess))\n{\n  var grantAccessRequest = new GrantAccessRequest\n  {\n    PrincipalAccess = new PrincipalAccess\n    {\n      AccessMask = AccessRights.WriteAccess | AccessRights.ReadAccess,\n      Principal = userreference\n    },\n    Target = recordentityreference\n  };\n}\n</code></pre>\n\n<p>Now, this is a static way to solve this problem.  If I have 6 variables like \"mht_WriteAccess\" , how can I check how many of them are set on  true, and automatically change the situation for the \"AccessMask\" variable, and so pass all the right enum values with pipe.</p>\n\n<p>I want to know if there's a way to do this automatically, maybe with any cycle?</p>\n"},{"tags":["c#","sql-server","crystal-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13274399,"title":"CrystalDecisions.CrystalReports.Engine.ReportDocument' threw an exception","body":"<p>Once my crystal report sap 2010 was corrupted and re installed my crystal report software but nothing changed after that i followed the instruction on this link </p>\n\n<pre><code>http://social.msdn.microsoft.com/Forums/en-US/vscrystalreports/thread     /c0a40e76-7bd9-4113-85a7-190873318c07/\n</code></pre>\n\n<p>and after installing crystal report software i re installed my software and the things start working again. Now i am facing same error again </p>\n\n<pre><code>CrystalDecisions.CrystalReports.Engine.ReportDocument' threw an exception\n</code></pre>\n\n<p>But the above is not a permenant solution, Please Help.</p>\n"},{"tags":["c#","oracle","plsql","odp.net"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12416315,"title":"Using C# and ODP.NET and Oracle, how do you get an associative array (pl/sql table) from a stored procedure","body":"<p>Using C# 4.0 and ODP.NET.  We have a stored procedure that is part of a package that takes two in parameters and returns a pl/sql table.</p>\n\n<p>I have googled for hours and have found many examples of code here and elsewhere where you pass an array to a stored procedure, but have not found a single example where you get a pl/sql table back.</p>\n\n<p>Is this possible?  I believe it has to be but not sure anymore.</p>\n\n<p>Note: I am NOT getting back a ref cursor, it is a pl/sql table (associate array)</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":13273333,"title":"Compare two Tables SQLSE","body":"<p>I want to know if that possible to compare two columns in two different tables in one database using C# with SQLSE.  if the two table has the same data in order, i can say the two tables are match; otherwise, there is no match.</p>\n\n<p>// More info </p>\n\n<p>I want to compare two column has repeated value the two column vlaues come from actual combination of visits for two patients and i want to check do they visit the hospital on the same date and rational insted to go for every 5 combination and compare the match i want to compare the whole table</p>\n"},{"tags":["c#",".net","linq","extension-methods","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":71,"score":0,"question_id":13270063,"title":"Is there any built-in .NET Framework alternative for my extension method?","body":"<p>I got this nice method which I use in many cases.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    using (IEnumerator&lt;TSource&gt; enumer = e.GetEnumerator())\n    {\n        if (!enumer.MoveNext())\n            yield break;\n\n        bool flag = true;\n        TSource first = enumer.Current;\n\n        do\n        {\n            TSource current = enumer.Current;\n            TSource next = (flag = enumer.MoveNext()) ? enumer.Current : first;\n            yield return currentNextAction(current, next);\n        } while (flag);\n    }\n}\n</code></pre>\n\n<p>I have looked <a href=\"http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx\" rel=\"nofollow\">MSDN</a> for some built-in alternatives, but could not find them. Is there any?</p>\n\n<p>And, is there anything I could improve in this code?</p>\n\n<p><strong>EDIT</strong>: New code for non-enumeratorable method.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    bool flag = false;\n    TSource first = default(TSource);\n    TSource previous = default(TSource);\n\n    foreach (TSource item in e)\n    {\n        if (!flag)\n        {\n            flag = true;\n            first = previous = item;\n            continue;\n        }\n\n        yield return currentNextAction(item, previous);\n        previous = item;\n    }\n\n    if (flag)\n        yield return currentNextAction(previous, first);\n    else\n        yield break;\n}\n</code></pre>\n\n<p>(I like the first one by the way)</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":40,"score":-4,"question_id":13273796,"title":"Working Lyrics Service?","body":"<p>I need a Lyrics provider for my media player.\nSearched the web and found alot of samples. None of them work now, either the service is down or service has changed the API :S</p>\n\n<p>Can someone direct me to a working API Service for a lyrics providing app??</p>\n\n<p>According to my knowledge these sites don't supply their services for developers anymore\nLyricsPlugin : Not Working\nLyricWiki : Not Working\nLeosLyrics\nLyrDB(worked sometime back though)</p>\n\n<p>.Net 4, C#, WPF</p>\n\n<p>Thanks in advance.\nHave a nice day! :)</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13273144,"title":"What approach should be used for model binding to an exisiting session object?","body":"<p>Here's my problem:</p>\n\n<p>We have an intranet asp.net mvc 3 application with a controlled set of users. We have a Person class, that contains a large amount of information, that is initially loaded and stored in the session. The data/editing for this object spans across many screens. Basically, each screen is a subset of the Person's data.  </p>\n\n<p>I'm trying to take advantage of the built in model binding in asp.net mvc. Should I create a data class that binds the form data from each screen and then updates my session object using a service object?  </p>\n\n<p>Example below: DxFormData contains a subset of the person data and will only be used as a parameter on this method. </p>\n\n<pre><code> public ActionResult Dx(DxFormData data)\n {\n    // Update current session Person object with data passed in if modelstate is valid\n    var viewModel = this.GetDxViewModel();        \n    return View(viewModel);\n }\n\npublic class DxForm Data\n{\n    public string AdmitDx { get; set; }\n    public string PrinDx { get; set; }\n}\n</code></pre>\n\n<p>I'm looking for thoughts on this approach and if there's a better solution available to me. The problem that I see, is that the person class contains all the data and I'm creating another class with a subset of that data. Obviously, duplicating the properties.</p>\n\n<p>Side note: I did write a custom model binder that returned the session person for binding. However, I am continually getting errors when it attempts to bind. </p>\n"},{"tags":["c#",".net","windows-8"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13274145,"title":"using .net 4 projects with 4.5 target?","body":"<p>I am new to .NET and c#.</p>\n\n<p>There are so many good examples out there made for .NET 4.0, but when I do NUGET it complains that the target .net version mismatches.</p>\n\n<p>I am developing for Windows 8 and Windows Phone 8, so they use .NET 4.5.</p>\n\n<p>Is there any way to just convert the old projects and force them to use .NET 4.5? \nOr do I need to wait for the author to update his project?</p>\n"},{"tags":["c#","email"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13273914,"title":"net.mail and web.mail vs gmail","body":"<p>I am wondering, if I can use <code>System.Net.Mail</code> with 465 port and <code>System.Web.Mail</code> with 587 port. For example for gmail, I cannot switch ports in this example as it will throw transport protocol exception...</p>\n\n<pre><code>using web = System.Web.Mail;\nusing net = System.Net.Mail;\n\nprivate void SendMail()\n{\n    web.MailMessage webMail = new web.MailMessage();\n    webMail.To = \"MAILTO@gmail.com\";\n    webMail.From = \"MAILFROM@gmail.com\";\n\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendusing\", \"2\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\", \"true\");            \n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\", \"1\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendusername\", \"LOGIN\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\", \"PASSWORD\");\n    webMail.Fields.Add(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\", 465);\n    web.SmtpMail.SmtpServer = \"smtp.gmail.com\";\n    web.SmtpMail.Send(webMail);\n\n    net.SmtpClient smtp = new net.SmtpClient();\n    smtp.UseDefaultCredentials = false;\n    smtp.Credentials = new System.Net.NetworkCredential(\"LOGIN\", \"PASSWORD\");\n    smtp.Port = 587;\n    smtp.Host = \"smtp.gmail.com\";\n    smtp.EnableSsl = true;\n\n    var netMail = new net.MailMessage(new net.MailAddress(\"MAILFROM@gmail.com\", \"\", System.Text.Encoding.UTF8),\n                                      new net.MailAddress(\"MAILTO@gmail.com\", \"\", System.Text.Encoding.UTF8));\n\n    smtp.Send(netMail); \n}\n</code></pre>\n\n<p>I am asking because even the simplest second <code>Net.Mail</code> cannot be sent under Russian Win 7 64x in .Net 2.0 build - it throws exception about invalid character in the header... And We.Mail works as expected. But I dont want to use it...</p>\n"},{"tags":["c#",".net","isolatedstorage"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":7105,"score":6,"question_id":1112681,"title":"Can I get a path for a IsolatedStorage file and read it from external applications?","body":"<p>I want to write a file where an external application can read it, but I want also some of the IsolatedStorage advantages, basically insurance against unexpected exceptions. Can I have it?</p>\n"},{"tags":["c#",".net","sqlite3","compact-framework","system.data.sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13249669,"title":"Updating Multiple Tables using single connection object in System.Data.SQLite","body":"<p>I am using Compact Framework <code>SQLite ADO adapter(System.Data.SQLite)</code> to update the database on my device. I am storing my <code>DB</code> in file. The DB contains 3-4 table which may get access concurrently. My query is, can I execute insert, update, read on these tables using single <code>SQLiteConnection</code> object?  </p>\n\n<p>Thanks,\nOmky</p>\n"},{"tags":["c#","multithreading","task"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13273929,"title":"c# Task do not work without sleep between them","body":"<p>I'm using Task in c# to send file via FTP in multithread.</p>\n\n<p>here is my function (file is a list of strings)</p>\n\n<pre><code> Task&lt;bool&gt;[] result = new Task&lt;bool&gt;[file.Count];\n        int j = 0;\n        foreach (string f in file)\n        {  \n            result[j] = new Task&lt;bool&gt;(() =&gt; ftp.UploadFtp(f, \"C:\\\\Prova\\\\\" + f + \".txt\", j));\n            result[j].Start();\n            j++;\n\n            //System.Threading.Thread.Sleep(50);\n\n        }\n        Task.WaitAll(result, 10000);\n</code></pre>\n\n<p>and the function to upload files</p>\n\n<pre><code>public static bool UploadFtp(string uploadFileName, string localFileName, int i)\n    {\n        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://127.0.0.1/\" + uploadFileName + \".txt\");\n        //settare il percorso per il file da uplodare\n        //FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://desk.txt.it/\");\n        request.Method = WebRequestMethods.Ftp.UploadFile;\n\n        request.Credentials = new NetworkCredential(\"ftp_admin\", \"\");\n        //request.Credentials = new NetworkCredential(\"avio\", \"avio_txt\");\n        try\n        {\n            Console.WriteLine(uploadFileName);\n            Console.WriteLine(i);\n            StreamReader sourceStream = new StreamReader(localFileName);\n            byte[] fileContents = File.ReadAllBytes(localFileName);\n\n            sourceStream.Close();\n            request.ContentLength = fileContents.Length;\n\n            Stream requestStream = request.GetRequestStream();\n            requestStream.Write(fileContents, 0, fileContents.Length);\n            requestStream.Close();\n\n            FtpWebResponse response = (FtpWebResponse)request.GetResponse();\n\n            //MessageBox.Show(\"Upload File Complete, status {0}\", response.StatusDescription);\n\n            response.Close();\n            return true;\n        }\n        catch (Exception e)\n        {\n            return false;\n        }\n\n    }\n</code></pre>\n\n<p>in this way the program try always to save the last file of the list, but if I add a Sleep(50) it uploads the files correctly.\nit seems that the program starts 4 task doing the same job (saving the last file) only if I do not use sleep, but I do not understand why and I don't know how to solve the problem.</p>\n\n<p>Can someone help me? thank you</p>\n"},{"tags":["c#","casting","type-conversion","unboxing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13269809,"title":"Automatic unboxing","body":"<p>I have an array of objects (<code>object[]</code>). All the items in this array have the same type (unknown at compile time). I need to convert this array in a typed array, that is, if the items are integers, I want to get an <code>int[]</code>.</p>\n\n<p>I've looked into the <code>Array.ConvertAll</code> method, but I need to specify a specific type in the template, meaning that I have to get the element type then call <code>ConvertAll</code> for each case possible.</p>\n\n<p>I've also looked into the keyword <code>dynamic</code> with no more luck (looks like <code>dynamic[]</code> is the same as <code>object[]</code>).</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#","encryption","rsa","public-key-encryption"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13272063,"title":"How / Should I Encrypt Variable Size Data with RSA (RSACryptoServiceProvider)","body":"<p>In my research I have found mixed messages on this subject so I'm looking for expertise to explain the best approach to encrypting variable amounts of data.</p>\n\n<p><strong>Requirements:</strong></p>\n\n<p>[Edit: Adding additional requirement #3 in response to comment]</p>\n\n<ol>\n<li><p>I would like to use RSA for the public/private key encryption scheme\nso I can distribute the public key to an application that should\nencrypt data but should not know how to decrypt it</p></li>\n<li><p>I need to support data lengths from 16 characters (credit card\nnumber) to kilobytes (serialized objects) and beyond.  Most of the\n    data I encrypt will be small (credit cards, addresses, etc).</p></li>\n<li><p>This is for encrypting data at rest.</p></li>\n</ol>\n\n<p><strong>Options I'm Aware Of:</strong></p>\n\n<ol>\n<li><p><strong>RSA-ONLY:</strong> Use <code>RSACryptoServiceProvider</code> to encrypt all data using public key. \nIterate through the data in blocks that are less than the key size\nminus padding.</p></li>\n<li><p><strong>HYBRID:</strong> Use <code>AesCryptoServiceProvider</code> to encrypt the data, calling\n<code>.GenerateKey()</code> and <code>.GenerateIV()</code> to generate a random key and IV.\nThen use RSACryptoServiceProvider to encrypt the above key and IV\nand prepend or append that to the data.</p></li>\n</ol>\n\n<p>It seems to my the Hybrid approach gives me the best of both worlds.  Strong block cipher (AES) and distributed public key (RSA).</p>\n\n<p>What are the pros and cons of these approaches?  What is the standard?  Surprisingly I have not found much opinion or information on the subject and would appreciate any references you might have.</p>\n\n<p><strong>Bonus:</strong>\nI am rolling my own for various reasons including corporate licensing restrictions but I'm curious if there is a good standard opensource approach for C#.</p>\n"},{"tags":["c#","sql","xml","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13273860,"title":"Backslashes in XML returned from stored procedure","body":"<p>I have written a stored procedure that returns my rows as XML with the following syntax:</p>\n\n<pre><code>FOR XML PATH ('customer'), ROOT ('customers'), TYPE\n</code></pre>\n\n<p>Running the query from the stored procedure in SSMS produces output that when clicked, looks just fine.  </p>\n\n<p>However, calling that stored procedure from C# gives me XML that I assume has double quotes that are escaped, thus:</p>\n\n<pre><code>&lt;customers&gt;&lt;customer id=\\\"123456\\\" firstName=\\\"ABE\\\" lastName=\\\"LINCOLN\\\" dob=\\\"02/12/1809\\\"&gt;\n</code></pre>\n\n<p>My C# code looks like this:</p>\n\n<pre><code>public string GetCustomerXML()\n{\n     string xml = string.Empty;\n     XmlDocument xmlDoc = new XmlDocument();\n\n     using (SqlConnection myConnection = new SqlConnection(connectionString))\n     {\n          myConnection.Open();\n\n          using (SqlCommand cmd = new SqlCommand(\"GetData_CreateXML\", myConnection))\n          {\n               cmd.CommandType = CommandType.StoredProcedure;\n\n               using (XmlReader reader = cmd.ExecuteXmlReader())\n               {\n                   while (reader.Read())\n                   {\n                       xmlDoc.Load(reader);\n                       xml = xmlDoc.OuterXml.ToString();\n                   }\n               }\n           }\n     }\n\n     return xml;\n}\n</code></pre>\n\n<p>What am I getting wrong here? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","txtextcontrol"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":9,"view_count":59,"score":-6,"question_id":13273278,"title":"compile and execute lines of code from txt in C#","body":"<p>I have on text s this lines:</p>\n\n<pre><code>myData = myData.Replace(\".jpg\", \"&gt;JPG&lt;\");\nmyData = myData.Replace(\".gif\", \"&gt;GIF&lt;\");\nmyData = myData.Replace(\".png\", \"&gt;PNG&lt;\");\nmyData = myData.Replace(\".tif\", \"&gt;TIF&lt;\");\n</code></pre>\n\n<p>and on my C# program i wont  one by one, on a cicle for:</p>\n\n<pre><code>for (int l=0; w&lt;listWithLines.Count;l++)\n{\n// MY LINE\n// listWithLines[l]\n}\n</code></pre>\n"},{"tags":["c#","web-services","excel","file","upload"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13273693,"title":"Uploading and saving an Excel file C# webservice using javascript","body":"<p>I have a javascript code that uploads a file to the server using XMLHttpRequest object. I am accepting the file as a Stream in the web service that is written using C#:</p>\n\n<pre><code>int uploadFile(Stream file)\n{\n    using (FileStream fileStream = File.Create(System.AppDomain.CurrentDomain.BaseDirectory + \"file.csv\"))\n            {\n                byte[] buffer = new byte[8 * 1024];\n                int len;\n                while ((len = file.Read(buffer, 0, buffer.Length)) &gt; 0)\n                {\n                    fileStream.Write(buffer, 0, len);\n                }    \n            }\n    //process file\n    return 0;\n}\n</code></pre>\n\n<p>In javascript the file is sent as a form data object:</p>\n\n<pre><code>var fd = new FormData(document.forms.namedItem(\"file\"));\nvar req = new XMLHttpRequest();\nreq.open(\"POST\", url, true);\nreq.send(fd);\n</code></pre>\n\n<p>Now, I am trying to save the Excel file on the server. I am reading the stream into a byte array and writing it to a csv file. But the error I am facing is corrupted data in the csv file.</p>\n\n<p>Where am I going wrong or is there any other way to upload and save file through web service?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","ienumerable","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13242706,"title":"How do I set a variable based on specific element from database call?","body":"<p>Ok, I'll preface this with the fact that I am new to c# and using WebMatrix.  I'm trying to do a database call as part of page and get information specific to \"Category\" and then use that data from the database to put information on the page - including for example, setting the page title to be the CategoryTitle from the database.  Below is my sample code and I know I am just not understanding something, but basically I get the data from the database (which includes a bunch of stuff about the category like; id, title, description, etc) into an IEnumerable (which i don't fully understand what that is) and then I just want to reference the CategoryTitle (which is the name of the field in the database and result set.  When I use the code below, I get the following error \"Compiler Error Message: CS1061: 'System.Collections.Generic.IEnumerable' does not contain a definition for 'CategoryTitle' and no extension method 'CategoryTitle' accepting a first argument of type 'System.Collections.Generic.IEnumerable' could be found (are you missing a using directive or an assembly reference?)\"</p>\n\n<p>I know the \"categoryData.CategoryTitle;\" part is wrong, but how do I do what I am trying to?  I can get it to work using a foreach loop and doing \"foreach(var row in categoryData)\" and then saying \"row.CategoryData\", but i feel like i shouldn't have to do that since its only one record in the result set.</p>\n\n<pre><code>@{\n\n    Layout = \"~/layouts/_layout.cshtml\";\n\n    var categoryID = 1;\n    IEnumerable&lt;dynamic&gt; categoryData = null;\n\n    var db = Database.Open(\"Connection\"); \n    categoryData = db.Query(\"exec sp_get_Category @CategoryID=\" + categoryID);\n\n    Page.Title = categoryData.CategoryTitle;\n\n}\n</code></pre>\n"},{"tags":["c#","encoding","ascii","smartcard","vfp"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":330,"score":1,"question_id":9309094,"title":"Visual FoxPro (VFP) CTOBIN and BINTOC Functions - Equivalent In .Net","body":"<p>We are rewriting some applications previously developed in Visual FoxPro and redeveloping them using .Net ( using C# ) </p>\n\n<p>Here is our scenario:\nOur application uses smartcards. We read in data from a smartcard which has a name and number. The name comes back ok in readable text but the number, in this case '900' comes back as a 2 byte character representation (131 &amp; 132) and look like this - ƒ„</p>\n\n<p>Those 2 special characters can be seen in the extended Ascii table.. now as you can see the 2 bytes are 131 and 132 and can vary as there is no single standard extended ascii table ( as far as I can tell reading some of the posts on here )</p>\n\n<p>So... the smart card was previously written to using the BINTOC function in VFP and therefore the 900 was written to the card as ƒ„. And within foxpro those 2 special characters can be converted back into integer format using CTOBIN function.. another built in function in FoxPro..</p>\n\n<p>So ( finally getting to the point ) - So far we have been unable to convert those 2 special characters back to an int ( 900 ) and we are wondering if this is possible in .NET to read the character representation of an integer back to an actual integer.</p>\n\n<p>Or is there a way to rewrite the logic of those 2 VFP functions in C#?</p>\n\n<p><strong>UPDATE</strong>:\nAfter some fiddling we realise that to get 900 into 2bytes we need to convert 900 into a 16bit Binary Value, then we need to convert that 16 bit binary value into a decimal value.</p>\n\n<p>So as above we are receiving back 131 and 132 and their corresponding binary values as being 10000011 ( decimal value 131 ) and 10000100 ( decimal value 132 ).\nWhen we concatenate these 2 values to '1000001110000100' it gives the decimal value 33668 however if we removed the leading 1 and transform '000001110000100' to decimal it gives the correct value of 900... </p>\n\n<p>Not too sure why this is though... </p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["c#","sqlite","orm","ormlite-servicestack"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13262935,"title":"Keeping classes and table schemas in sync when using an ORM","body":"<p>I haven't had a lot of experience with ORMs. I'm trying to figure out the best way to handle the adding/removing of properties from a mapped class, ideally in an automatic and generic way.</p>\n\n<p>I'm using ServiceStack.OrmLite and SQLite.</p>\n\n<p>The purpose of the database is a document store. There are no foreign keys/referential integrity concerns.</p>\n\n<p>E.G.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Baz {get; set;}\n}\n</code></pre>\n\n<p>Creates the table Foo with the columns Bar, Baz. </p>\n\n<p>In an ideal world the Foo class would never changed so I wouldn't have to worry about this, but in reality it could.</p>\n\n<p>Lets say Foo also needs a Quz property.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Baz {get; set;}\n   public Quz {get; set;}\n}\n</code></pre>\n\n<p>Reading is fine, Quz just comes back as null, but inserting fails because there is no Quz column. This makes sense.</p>\n\n<p>Lets say that Baz is no longer required.</p>\n\n<pre><code>public class Foo\n{\n   public Bar {get; set;}\n   public Quz {get; set;}\n}\n</code></pre>\n\n<p>Reading/inserting works fine, however the underlying table would still have the Baz column which is a bit messy.</p>\n\n<p>Given that it is a server app, and won't be restarted often, a couple of things I've considered and dismissed:</p>\n\n<ul>\n<li><p>On start, If the Foo table exists, read it in to a temporary store, drop and recreate Foo (meaning that the table would be created with the correct schema) and then reinsert the data. This appears to work fine and does the job of keeping the schema in sync with the class, however it is too slow.</p></li>\n<li><p>On start, query the underlying table to gets its column definitions and use reflection to work out what the columns for the Foo class should actually be. Add/Drop columns as necessary. I'm pretty sure I could get this approach to work, but it's more complicated than ideal, and I'm not convinced it is a good idea.</p></li>\n</ul>\n"},{"tags":["c#","bitmap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13273678,"title":"Store the databits of a bitmap into a int array","body":"<p>In Java i would do something like this</p>\n\n<pre><code>int[] pixels = ((DataBufferInt) image.getRaster().getDataBuffer()).getData();\n</code></pre>\n\n<p>where image is a BufferedImage and then alter the pixels in there and make my own blitting methods but how am i supposed to do something like this in C#? I know i can use a Bitmap to replace BufferedImage in C# but i'm not sure about making a reference to the data like shown above.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1630,"score":6,"question_id":4809520,"title":"How to allow copying message on MessageBox","body":"<p>How can I allow selecting and copying of text from MessageBox in WPF?</p>\n"},{"tags":["c#","url","slash"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13273476,"title":"Get anything after first slash in URL","body":"<p>I can get my browser url using : <code>string url = HttpContext.Current.Request.Url.AbsoluteUri;</code>\nBut say if I have a url as below :</p>\n\n<pre><code>http://www.test.com/MyDirectory/AnotherDir/testpage.aspx\n</code></pre>\n\n<p>How would I get the \"MyDirectory\" part of it, is there a utility in .NET to get this or do I need string manipulation ?</p>\n\n<p>If I do string manipulation and say anything after first instance of \"/\" then wouldnt it return the slash after http:? It would work if my url was <code>www.test.com/MyDirectory/AnotherDir/testpage.aspx</code></p>\n\n<p>Can someone please help</p>\n"},{"tags":["c#",".net","ado.net","edmx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13273720,"title":"Edmx Entity model inheritance","body":"<p>I want to create a generic Entity Model, with some classes and logics above, to put into a DLL and reuse that in various projects. I keep in mind the possibility to extend the generic ModelContainer in another in every project and use the extended ModelContainer to access database. I ask you if it is possible to do so in a \"clean way\" or I need some work around or \"bad stuff\".\nThank you all.</p>\n"},{"tags":["c#",".net","asp.net","web-config","settings"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1691,"score":3,"question_id":6289388,"title":"Custom type application settings in ASP.NET","body":"<p>Just now I came across ApplicationSettings in .NET WinForms that could handle complex types.<br>\nCurrently I am using AppSettings in my ASP.NET WebForms which can handle only string.<br>\nCan I use ApplicationSettings in Webforms? If so how?</p>\n"},{"tags":["c#","ado.net"],"answer_count":7,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":47370,"score":4,"question_id":1042618,"title":"How to create a DataTable in c# and how to add rows?","body":"<p>Can any body please help me creating DataTable in c#. I did like this</p>\n\n<pre><code> DataTable dt = new DataTable();\n dt.clear();\n dt.Columns.Add(\"Name\");\n dt.Columns.Add(\"Marks\");\n</code></pre>\n\n<p>and how to see the structure of DataTable.</p>\n\n<p>Now i want to add for name : ravi and Marks : 500 how to do this one </p>\n\n<p>Any Help will be greatly appreciated!</p>\n"},{"tags":["c#","wpf","datacontext","dataitems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2229,"score":1,"question_id":2859978,"title":"Populate datagrid using Datacontext in C# WPF","body":"<p>I'm trying to get data from file. The file first has three lines of text that describes the file, then there is a header for the data below. I've managed to extract that. What I'm having problems is getting the data below the header line. The data below the header line can look like \"1   2   3  4  5   6     7   8   9   abc\". </p>\n\n<pre><code>DataGrid dataGrid1 = new DataGrid();\nmasterGrid.Children.Add(dataGrid1);\n\nusing (TextReader tr = new StreamReader(@filename))\n{\n    int lineCount = 1;\n    while (tr.Peek() &gt;= 0)\n    {\n        string line = tr.ReadLine();\n        {\n            string[] data = line.Trim().Split(' ');\n\n            Dictionary&lt;string, object&gt; sensorData = new Dictionary&lt;string, object&gt;();\n\n            for (int i = 0, j = 0; i &lt; data.Length; i++)\n            {\n                //I know that I'm delimiting the data by a space before.\n                //but the data from the text file doesn't necessarily have\n                //just one space between each piece of data\n                //so if I don't do this, spaces will become part of the data.\n                if (String.Compare(data[i],\" \") &gt; 0)\n                {\n                    sensorData[head[j]] = data[i];\n                    j++;\n                }\n            }\n\n            sensorDatas.Add(sensorData);\n\n            sensorData = null;\n\n        }\n        lineCount++;\n    }\n}\n\ndataGrid1.DataContext = sensorDatas;\n</code></pre>\n\n<p>I can't figure out why this doens't work. If I change \"dataGrid1.DataContext = sensorDatas;\" to \"dataGrid1.ItemsSource = sensorDatas;\" then I get the data in the proper columns, but I also get some Raw View data such as: Comparer, Count, Keys, Values as columns, which I don't want.</p>\n\n<p>Any insight?</p>\n"},{"tags":["c#",".net","image","web","download"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13273697,"title":"How do I download pictures from a webpage based on their LINKS on this page?","body":"<p>This is what I have so far but I'm running into an issue.</p>\n\n<p>The page <a href=\"https://xxxxxxxx.zendesk.com/tickets/33126\" rel=\"nofollow\">https://xxxxxxxx.zendesk.com/tickets/33126</a> contains a link to a .jpg image. I want to download this image. The page could have several images so I need to scan the page to find all the .jpg, .gif, etc.</p>\n\n<pre><code>I'm having an issue with my code at the end. I'll explain there.\n\n    public static void GetTicketAttachments(string url)\n    {   \n        GetImages(\"https://xxxxxxxx.zendesk.com/tickets/33126\");   \n    }\n\nstatic void GetImages(string url)\n    {\n        string responseString;\n        HttpWebRequest initialRequest = (HttpWebRequest)WebRequest.Create(url);\n        using (HttpWebResponse initialResponse = (HttpWebResponse)initialRequest.GetResponse())\n        {\n            using (StreamReader reader = new StreamReader(initialResponse.GetResponseStream()))\n            {\n                responseString = reader.ReadToEnd();\n            }\n\n            List&lt;string&gt; imageset = new List&lt;string&gt;();\n            Regex regex = new Regex(@\"f=\"\"[^\"\"]*jpg|bmp|tif|gif|png\", RegexOptions.IgnoreCase);\n            foreach (Match m in regex.Matches(responseString))\n            {\n                if (!imageset.Contains(m.Value))\n                    imageset.Add(m.Value);\n            }\n            for (int i = 0; i &lt; imageset.Count; i++)\n                imageset[i] = imageset[i].Remove(0, 3);\n            totalFiles = imageset.Count;\n            currentFiles = totalFiles;\n\n            foreach (string f in imageset)\n            {\n                ThreadPool.QueueUserWorkItem(new WaitCallback(DownloadImage), f);\n            }\n        }\n    }\n</code></pre>\n\n<p>The issue happens here. The object \"path\" is always null for some reason. Therefore I cannot download the picture.</p>\n\n<pre><code>static void DownloadImage(object path)\n    {\n        currentFiles--;\n        path = Path.GetFileName(path.ToString());\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(path.ToString());\n        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())\n        {\n            Image image = Image.FromStream(response.GetResponseStream());\n            image.Save(@\"C:\\\" + Path.GetFileName(path.ToString()));\n        }\n    }\n</code></pre>\n\n<p>Anyone know what could be the issue? The \"picture count\" is indeed counting 1 (one link TO a picture on the page). </p>\n"},{"tags":["c#","winapi","modal","outlook-2007","inspector"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":754,"score":3,"question_id":5784237,"title":"How to : Given HWND, discover if window is Modal or not","body":"<p>For any given window I handle, I need a way to find out whether or not the given window is Modal.</p>\n\n<p>Far as I can tell, there are no methods that do exactly that, which is why I need some clever workaround to work this out!</p>\n\n<p>Help is appreciated!</p>\n\n<p>EDIT : Why is my GetWindow(,GW_OWNER) failing? :(</p>\n\n<pre><code>    [DllImport(\"user32.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    internal static extern IntPtr FindWindow(string lpClassName, string lpWindowName);\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern IntPtr GetWindow(IntPtr hWnd, GetWindow_Cmd uCmd);\n    [DllImport(\"user32.dll\", ExactSpelling = true)]\n    internal static extern IntPtr GetAncestor(IntPtr hwnd, GetAncestor_Flags gaFlags);\n    [DllImport(\"user32.dll\", SetLastError = false)]\n    internal static extern IntPtr GetDesktopWindow();\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern int GetWindowLong(IntPtr hWnd, int nIndex);\n\n    const UInt32 WS_DISABLED = 0x8000000;\n\n\n    internal enum GetAncestor_Flags\n    {\n        GetParent = 1,\n        GetRoot = 2,\n        GetRootOwner = 3\n    }\n\n    internal enum GetWindow_Cmd : uint\n    {\n        GW_HWNDFIRST = 0,\n        GW_HWNDLAST = 1,\n        GW_HWNDNEXT = 2,\n        GW_HWNDPREV = 3,\n        GW_OWNER = 4,\n        GW_CHILD = 5,\n        GW_ENABLEDPOPUP = 6\n    }\n\n\n\nIntPtr _inspHwnd = FindWindow(\"rctrl_renwnd32\", inspector.Caption); // searching for a window with this name\n        if (_inspHwnd.ToInt32() != 0) // found window with this name\n        {\n            IntPtr _ownerHwnd = GetWindow(_inspHwnd, GetWindow_Cmd.GW_OWNER);\n            if (_ownerHwnd.ToInt32() != 0)\n            {\n                IntPtr _ancestorHwnd = GetAncestor(_ownerHwnd, GetAncestor_Flags.GetParent);\n                if (_ancestorHwnd == GetDesktopWindow())\n                {\n                    if (GetWindowLong(_ancestorHwnd, -16) == WS_DISABLED) \n                    { \n                        // inspector is probably modal if you got all the way here\n                        MessageBox.Show(\"modal flag tripped\");\n                    }\n                }\n            }\n        }\n</code></pre>\n"},{"tags":["c#","asp.net",".net","vb.net","usercontrols"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13249082,"title":"When does usercontrol visible property affect its children?","body":"<p>I have a <strong>ASP.NET userControl</strong> that contains other controls. \nSometimes, when changing the visible property of the usercontrol, it does change the visible value of its children, but sometimes it doesn't. </p>\n\n<p>I thought it depended on the moment the property was changed during the page life cycle, cause it seemed to work well when changed in the <code>Page_PreRender</code> event, but I got a case when it didn't work.</p>\n\n<p>Any idea, on how I could affect the visibility of all the controls of the user control just through the visible property of this one? I don't want to make a loop through all the children to set their visbile property.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","webbrowser","ftpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13270303,"title":"C# webbrowser not showing updated result","body":"<p>Hey guys i am having trouble with webbrowser or may be ftp .. i am uploading a picture and when i navigate the webbrowser it shows me the old photo, yet the picture im uploading gets to the ftp and gets overwrite .. heres the code</p>\n\n<pre><code> webBrowser1.Refresh(WebBrowserRefreshOption.Completely);\n        webBrowser1.Navigate(\"www.google.com\");\n        openFileDialog1.ShowDialog();\n        string filename = Path.GetFullPath(openFileDialog1.FileName);\n\n        FileInfo toUpload = new FileInfo(@\"upload.jpg\");\n        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://fingercube.co.cc/public_html/objimg/\" + toUpload.Name);\n        request.Method = WebRequestMethods.Ftp.UploadFile;\n        request.Credentials = new NetworkCredential(\"username\", \"pass\");\n        Stream ftpStream = request.GetRequestStream();\n        FileStream file = File.OpenRead(filename);\n        int lenght = 2;\n        byte[] buffer = new byte[lenght];\n        int bytesRead = 0;\n        do\n        {\n            bytesRead = file.Read(buffer, 0, lenght);\n            ftpStream.Write(buffer, 0, bytesRead);\n        }\n\n        while (bytesRead != 0);\n        file.Close();\n        ftpStream.Close();\n\n\n       webBrowser1.Navigate(\"http://fingercube.co.cc/objimg/\"+toUpload.Name);\n</code></pre>\n\n<p>it shows me the old photo everytime .. but the photo is uploaded every time ! :(</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273601,"title":"Right Data Structure for Cascading Controls","body":"<p>Suppose I had a series of tables in a database with (for example purposes) information about the menu items in a series of restaurants. \nSo, for example, we have, say 10 tables:</p>\n\n<pre><code>Rest_1, Rest_2, Rest_3, .... Rest_10 \n(Names being more complex, though, in the real situation)\n</code></pre>\n\n<p>And every table has the EXACT SAME column structure, say (Just making this up for illustration purposes, so forgive the weakness of the example):</p>\n\n<pre><code>Col1 (Primary Key) = Menu_Item\nCol2               = Menu_Category  (Desert, Appetizer, ...)\nCol3               = Item_Cost\nCol4               = Item_SalePrice\nCol5               = Item_Popularity\nCol6               = Seasonal_Item  (Boolean - Is it seasonal)\nCol7               = Min_Order      (Boolean - Is there a minimum order from the vendor)  \nCol8               = In_Stock       (Boolean - Is it in stock now)  \n....\n</code></pre>\n\n<p>Now, I have a Windows Form with, say, 3 comboBoxes and a checkbox:</p>\n\n<pre><code>cboRestaurant\ncboMenuCategory\ncboPopularity\nckInStock\n</code></pre>\n\n<p>And a DataView which, based upon what the user chooses above, shows the correct (filtered) information which can then be used for processing something.</p>\n\n<p>So, my situation is that we would:</p>\n\n<ol>\n<li>Populate the Restaurant combobox</li>\n<li>Based upon the user's selection of cboRestaurant &amp; the ckInStock.checked status, populate the cboMenuCategory combobox</li>\n<li>Based upon 1 &amp; 2, populate the cboPopularity combobox</li>\n<li>Based upon what user chose for all the comboboxes / checkbox, populate the dataview.</li>\n</ol>\n\n<p>... Again, I know this is a weak example, but I'm trying to convey the concept.</p>\n\n<hr>\n\n<p>So... Based upon what I've picked up online, what I'm seeing as being the best case to accomplish this would be to:</p>\n\n<ol>\n<li>Query each Table and store the results in a DataTable  (This I can do)</li>\n<li>Store those datatables in a Dataset                    (This I can do)</li>\n</ol>\n\n<p>What I don't know how to do is to let the dataset know how all the datatables are related (All have the same column names) <strong>AND</strong> bind the comboboxes to the dataset such as to filter the information based upon what was selected in the previous combobox.</p>\n\n<h2>OR</h2>\n\n<p>Create a list(of custom object) that will hold all these variables from all the tables and then Linq-Query that list based upon the <code>combobox.SelectedIndexChanged</code> \\ <code>ckInStock.CheckedChanged</code> events - this seems much worse since we're constantly querying and re-querying.</p>\n\n<hr>\n\n<h2>So, my first question is:</h2>\n\n<p>If solution #1 is right, how do I create the conglomerated dataset and have the comboboxes have the correct filtered data based upon the preceding comboboxes and checkbox value?</p>\n\n<h2>My Second question is:</h2>\n\n<p>Is there just a better way to accomplish this IN TOTAL that I just don't know about - A built in better object that does the cascading filtering for you, or how best to accomlish this otherwise?</p>\n"},{"tags":["c#",".net","encoding","character-encoding","special-characters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13272149,"title":"Encoding special characters into Byte array","body":"<p>Few days ago I've asked a question about german special characters.\nI can encode and decode characters like ö, ä or ü now. But.. some characters left and I need to encode/decode them too. </p>\n\n<p>For example, characters that fails: ² ³ € µ Ü Ö Ä ~ ´ §</p>\n\n<p>Here is code: </p>\n\n<pre><code>    private static byte[] MyGetBytesArray(string data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetBytes(data);\n    }\n\n    private static string MyGetString(byte[] data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetString(data);\n    }\n</code></pre>\n\n<p>I'm looking for a solution to encode/decode all characters. I'm writing an encrypt/decrypt algorythm, and I don't know what user will paste into program. I need to give back exactly the same. </p>\n\n<p>Thanks for help, again.. </p>\n\n<p>EDIT:\nOk, UnicodeEncoding works (I think). It is my encrypt/decrypt algoryth now:/ I'm still not sure what is going on (I thnik it is sth with zeros. During encoding by Unicode zero is after every character), but encoding special characters wokrs. At least that test was successfull: </p>\n\n<pre><code>string text = File.ReadAllText(opd.FileName, Encoding.Default);\nbyte[] byt = getBytesArray(text);\nstring text2 = getString(byt);\n\nif (text2 == text)\n{\n    MessageBox.Show(\"OK\");\n}\nelse\n{\n    MessageBox.Show(\"FAIL\");\n}\n</code></pre>\n\n<p>BTW. Encoding.Default is correct right ? </p>\n"},{"tags":["c#","sql","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13095357,"title":"VS 2010 SQL Update for SQL Statement","body":"<p>Please bear with me as I'm just beginning to learn this stuff. </p>\n\n<p>I have a VS 2010 Web project up and I'm trying to understand how I can make a custom <code>UpdateCommand</code> (Because I chose to write my own SQL statement, I do not have the option for VS 2010 to auto generate an update command for me.) Problem is: I don't know what the <code>UpdateCommand</code> should look like. Here is my Select:</p>\n\n<pre><code>SELECT * FROM Dbo.MainAsset, dbo.Model, dbo.Hardware WHERE MainAsset.device = Hardware.DeviceID AND MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>Which, VS 2010 turns into:</p>\n\n<pre><code>SELECT MainAsset.pk, MainAsset.img, MainAsset.device, MainAsset.model, MainAsset.os, MainAsset.asset, MainAsset.serial, MainAsset.inyear, MainAsset.expyear, MainAsset.site, MainAsset.room, MainAsset.teacher, MainAsset.FirstName, MainAsset.LastName, MainAsset.Notes, MainAsset.Dept, MainAsset.AccountingCode, Model.Model AS Hardware, Model.pk AS Model, Model.DeviceID, Hardware.Computer, Hardware.pk AS Expr3, Hardware.DeviceID AS Expr4 FROM MainAsset INNER JOIN Hardware ON MainAsset.device = Hardware.DeviceID INNER JOIN Model ON MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>How would I approach updating one column, say \"MainAsset.site\" if that's changed in the Gridview DDL? Any help constructive help would be appreciated. Thank you.</p>\n"},{"tags":["c#",".net","sql-server","stream"],"answer_count":4,"favorite_count":38,"up_vote_count":123,"down_vote_count":0,"view_count":106943,"score":123,"question_id":411592,"title":"How do I save a stream to a file?","body":"<p>I have a <code>StreamReader</code> object that I initialized with a stream, now I want to save this stream to disk (the stream may be a <code>.gif</code> or <code>.jpg</code> or <code>.pdf</code>).</p>\n\n<p>Existing Code:</p>\n\n<pre><code>StreamReader sr = new StreamReader(myOtherObject.InputStream);\n</code></pre>\n\n<ol>\n<li>I need to save this to disk (I have the filename).</li>\n<li>In the future I may want to store this to SQL Server.</li>\n</ol>\n\n<p>I have the encoding type also, which I will need if I store it to SQL Server, correct?</p>\n"},{"tags":["c#","wpf","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13268597,"title":"Ispost back like functionality in WPF pages","body":"<p>I am building a WPF application which contains a large number of pages. I want to know whether there is any function which is similar to IsPostBack in Asp.Net. I just wanted to know is this the first time the specific page is loading. Thanks in advance.</p>\n"},{"tags":["c#","asp.net-mvc-3","dynamic","razor","viewmodel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13272873,"title":"How to create dynamic DropDownList with several complex types? ASP.NET MVC 3","body":"<p>guys. I have these ViewModels:</p>\n\n<pre><code>public class CandidateViewModel\n{\n    public string Name { get; set; }\n    public IList&lt;CourseViewModel&gt; Courses { get; set; }\n    //...\n}\n\npublic class OptionViewModel\n{\n    public int Number { get; set; }\n    public string Description { get; set; }\n    //...\n}\n\npublic class CourseViewModel\n{\n    public string Name { get; set; }\n    public string SelectedCourse { get; set; }\n    public IList&lt;OptionViewModel&gt; Options { get; set; }\n\n    public CourseViewModel(int options)\n    {\n        Options.Add(new OptionViewModel(-1, string.Empty));\n        for (int count = 1; count &lt;= options; ++count)\n            Options.Add(new OptionViewModel(\n                count, string.Format(\"Option {0}\", count)));\n\n        Options.Add(new OptionViewModel(0, \"Don't want it\"));\n    }\n}\n</code></pre>\n\n<p>Well, I want to create a number of DropDownLists equals the number of Courses into CandidateViewModel. Each dropdown should be as options the OptionViewModel list of CourseViewModel instance. I need my final result like this:</p>\n\n<pre><code>&lt;select name=\"Course1\"&gt;\n    &lt;option value=\"-1\"&gt;&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Option 3&lt;/option&gt;\n    &lt;option value=\"0\"&gt;Don't want it&lt;/option&gt;\n&lt;/select&gt;\n\n&lt;select name=\"Course2\"&gt;\n    &lt;option value=\"-1\"&gt;&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Option 3&lt;/option&gt;\n    &lt;option value=\"0\"&gt;Don't want it&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>However, my .cshtml page has CandidateViewModel as Model, and I can't create by \"Html.DropDownListFor\" trhu Razor. Can you help me, please?</p>\n\n<p>Thank you so much, guys!</p>\n"},{"tags":["c#","app-config","configurationelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13272418,"title":"overriding/replacing ConfigurationElements in app.config in runtime","body":"<p>I have two ConfigurationElement objects (one of which is in the running application's app.config) and I need to replace that one with the other. I also have the ConfigurationElementCollection that the first element belongs to. It looks like the Add and Remove methods are protected internal. Is it not intended for me to be able to update the ConfigurationElementCollection object in runtime? If so, what are the alternatives?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","build","const","pre-buildevent"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13273617,"title":"Computed const value constantly one build behind","body":"<p>While updating our build incrementer program that runs during the <strong>pre-build</strong> event, I noticed a potential problem that can cause quite a bit of issues. Building the application the first time successfully updates <code>BuildInfo.cs</code> and calculates all of the const values. Each subsequent build and successful execution of the pre-build event updates the proper file (as provided below) but each computed const value is out of date from the last build.</p>\n\n<pre><code>// In externally modified file BuildInfo.cs which is updated by our pre-build\n// tool to update the version information and produce new consts.\nnamespace ConstProblem.Properties {\n  static class BuildInfo {\n    internal const string AssemblyVersionString = \"1.1.0.0\";\n    internal const string BuildDate = \"2012-11-07T08:52:32.5480259-07:00\";\n    internal const string FileVersionString = \"1.1.12312.852\";\n    internal const string Full = \"v1.1 (Build: 2012-11-07 08:52)\";\n    internal const string Short = \"1.1\";\n  }\n}\n\n// Program.cs. Reproduces the problem for this question.\nnamespace ConstProblem {\n  class Program {\n    const string UserAgent = \"ConstProblem/\" + Properties.BuildInfo.Short;\n\n    static void Main() {\n      System.Console.WriteLine(UserAgent);\n    }\n  }\n}\n</code></pre>\n\n<p>As an example, the application was originally built with the <code>AssemblyVersionString</code> at <code>1.0.0.0</code>. The above program ran and compiled as expected. Increasing this to 1.1 and building/running the application a second time produced <code>ConstProblem/1.0</code> as it's output and has this as it's values</p>\n\n<pre><code>// From the Immediate Window\nProperties.BuildInfo\nConstProblem.Properties.BuildInfo\n    base {object}: object\n    AssemblyVersionString: \"1.1.0.0\"\n    BuildDate: \"2012-11-07T08:51:46.8404556-07:00\"\n    FileVersionString: \"1.0.12312.851\"\n    Full: \"v1.0 (Build: 2012-11-07 08:51)\"\n    Short: \"1.0\"\n</code></pre>\n\n<p>As you can see, the <code>AssemblyVersionString</code> was updated <code>1.1.0.0</code> properly but the rest of the computed values did not. If I were to build and execute a third time (and increase to 1.2) they would update to the information provided above.</p>\n\n<p>I have confirmed that the output file by the pre-build event outputs all of the information correctly and exits with a status of 0 to allow the build to continue. I am at a loss as to why the const's are constantly one build behind. The build utility is also something I wrote and it just uses a template and replaces the contents of the BuildInfo.cs if the file is checked-out.</p>\n\n<p>My environment is running Visual Studio 2010 Ultimate and compiling in .Net 4. I've reproduced this in both Console and Web applications. I got the idea for using const values from the comments in <a href=\"http://blogs.msdn.com/b/junfeng/archive/2004/02/28/81407.aspx\" rel=\"nofollow\" title=\"How to get the assembly version and file version of your own assembly? -Junfeng Zhang\">How to get the assembly version and file version of your own assembly?</a></p>\n"},{"tags":["c#","hierarchy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13271634,"title":"Hierarchy from Flat Data w/ out parentID childID","body":"<pre><code>| Level1      | Level2               | Level3       | Level4|\n\n| ELECTRONICS | TELEVISIONS          | NULL         | NULL  |\n\n| ELECTRONICS | TELEVISIONS          | LCD          | NULL  |\n\n| ELECTRONICS | PC                   | NULL         | NULL  |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | MP3 PLAYERS  | FLASH |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | CD PLAYERS   | NULL  |\n\n| ELECTRONICS | PORTABLE ELECTRONICS | 2 WAY RADIOS | NULL  |\n</code></pre>\n\n<p>In a legacy database I have this table, I am trying to print it out in a nice hierarchy html ul li list. I have been trying different answers here on stackoverflow to build the objects in C# but they all have parentID and childID and that dosent work for me in this case.</p>\n\n<p>I am trying this code, but I do understand that it is really bad,</p>\n\n<pre><code>    List&lt;Node&gt; FlatToHierarchy(IList&lt;SearchWord&gt; list)\n    {\n        List&lt;Node&gt; nodes = new List&lt;Node&gt;();\n\n        foreach (SearchWord x in list)\n        {\n            if (x.Level2 != \" \" &amp;&amp; x.Level3 == \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level1;\n                node.Child = x.Level2;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n\n            if (x.Level3 != \" \" &amp;&amp; x.Level4 == \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level2;\n                node.Child = x.Level3;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n\n            if (x.Level4 != \" \")\n            {\n                Node node = new Node();\n                node.Parent = x.Level3;\n                node.Child = x.Level4;\n                node.Keyword = x.Keyword;\n                nodes.Add(node);\n                //dict.Add(node.Parent, node);\n            }\n        }\n\n        return nodes;\n    }\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13057682,"title":"Custom validation class - How to make universal","body":"<p>I am attempting to create a custom validation attribute for my MVC application.  My code as written, works great for the properties specified in the code.  I now want to expand it, so it  is more general, because I have 5 other properties I would like to use this same attribute on.<br>\nThe general idea is if the specified other property is true, then the property attached to the attribute must be > 0.</p>\n\n<p>I assume the way to do this is to create a constructor that accepts the value of the property and the value of the other property, but I can't seem to get it going.  The specific problem I having is I can't find the correct way to pull in the needed values.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>public class MustBeGreaterIfTrueAttribute : ValidationAttribute\n{\n    protected override ValidationResult IsValid(object value, ValidationContext context)\n    {\n        var model = context.ObjectInstance as HistoryViewModel;\n        //ValidationResult result = null;\n\n        // Validate to ensure the model is the correct one\n        if (context.ObjectInstance.GetType().Name == null)\n        {\n            throw new InvalidOperationException(string.Format(\n                    CultureInfo.InvariantCulture, \"Context of type {0} is not supported. \"\n                                                  + \"Expected type HistoryViewModel\",\n                                                   context.ObjectInstance.GetType().Name));\n        }\n\n        // Here is the actual custom rule\n        if (model.HistoryModel.IsRetired == true)\n        {\n            if (model.CounterA == 0)\n            {\n                return new ValidationResult(\"Please enter more information regarding your History\");\n            }\n        }\n        else if ( model.HistoryModel.IsRetired == true )\n        {\n            if ( model.ROCounter &gt; 0 )\n\n            return ValidationResult.Success;\n        }\n\n        // If all is ok, return successful.\n        return ValidationResult.Success;\n\n    }\n\n    //  Add the client side unobtrusive 'data-val' attributes\n    //public IEnumerable&lt;ModelClientValidationRule&gt; GetClientValidationRules(ModelMetadata metadata, ControllerContext context)\n    //{\n\n    //}\n\n}\n</code></pre>\n\n<p>Thank you for you time.</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13273475,"title":"Is there automatic formatting for an asp:literal control?","body":"<p>Is there a way to automatically format a <code>string</code> for literal insertion into JavaScript code?</p>\n\n<p>Say you have this in your page:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script type=\"text/javascript\"&gt;\n    var strvar = &lt;asp:Literal runat=\"server\" id=\"ltrStrvar\"&gt;&lt;/asp:Literal&gt;;\n&lt;/script&gt;\n</code></pre>\n\n<p>And in your server-side code:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>protected void Page_Load(object sender, EventArgs e) {\n    ltrStrvar.Text = \"hello \\\"world\\\"\";\n}\n</code></pre>\n\n<p>Is there a way to <em>automatically</em> have it escape the string and surround it with quotes for error-free insertion into JavaScript, so all I have to do is set the <code>Text</code> property with an arbitrary string? I know how to do it <em>manually</em> but was looking for a more elegant solution.</p>\n"},{"tags":["c#","windows","service","installer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13273565,"title":"ServiceAccount.User multiple windows services installer","body":"<p>I have a basic windows installer for multiple services (C#). I am using user authentication. \nThe username/password is prompted for each service that is being installed. I need to limit this to one prompt?</p>\n\n<p>In one of my services I am doing the following:</p>\n\n<pre><code>private void serviceProcessInstaller1_BeforeInstall(object sender, InstallEventArgs e)\n{\n    this.serviceProcessInstaller1.Account = ServiceAccount.User;\n    GetServiceAccount(ref serviceProcessInstaller1);\n}\n\npublic static void GetServiceAccount(ref ServiceProcessInstaller installer)\n{\n    ServiceInstallerDialog myInstaller = new ServiceInstallerDialog();\n\n    myInstaller.ShowDialog();\n\n\n    if (myInstaller.Result == ServiceInstallerDialogResult.OK)\n    {\n        installer.Account = ServiceAccount.User;\n        installer.Username = myInstaller.Username;\n        installer.Password = myInstaller.Password;\n    }\n}\n</code></pre>\n\n<p>This takes care of one service how can I pass these parameters to the\nother services in my installer?</p>\n"},{"tags":["c#","c#-4.0","quartz.net","quartz.net-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13264115,"title":"How ignore Misfires in Quartz.Net?","body":"<p>This is my Quartz configuration:</p>\n\n<pre><code>  &lt;quartz&gt;\n    &lt;add key=\"quartz.scheduler.instanceName\" value=\"EmailScheduler\" /&gt;\n    &lt;!-- Configure Thread Pool --&gt;\n    &lt;add key=\"quartz.threadPool.type\" value=\"Quartz.Simpl.SimpleThreadPool, Quartz\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadCount\" value=\"10\" /&gt;\n    &lt;add key=\"quartz.threadPool.threadPriority\" value=\"Normal\" /&gt;\n    &lt;!-- Configure Job Store --&gt;\n    &lt;add key=\"quartz.jobStore.misfireThreshold\" value=\"60000\" /&gt;\n    &lt;add key=\"quartz.jobStore.type\" value=\"Quartz.Impl.AdoJobStore.JobStoreTX, Quartz\" /&gt;\n    &lt;add key=\"quartz.jobStore.driverDelegateType\" value=\"Quartz.Impl.AdoJobStore.StdAdoDelegate, Quartz\" /&gt;\n    &lt;add key=\"quartz.jobStore.dataSource\" value=\"default\" /&gt;\n    &lt;add key=\"quartz.jobStore.lockHandler.type\" value=\"Quartz.Impl.AdoJobStore.UpdateLockRowSemaphore, Quartz\" /&gt;\n    &lt;add key=\"quartz.dataSource.default.provider\" value=\"SqlServer-20\" /&gt;\n    &lt;add key=\"quartz.dataSource.default.connectionString\" value=\"data source= ......\" /&gt;\n    &lt;add key=\"quartz.jobStore.tablePrefix\" value=\"QRTZ_\" /&gt;\n  &lt;/quartz&gt;\n</code></pre>\n\n<p>here is my <code>IInterruptableJob</code>:</p>\n\n<pre><code>public class JobC : Quartz.IInterruptableJob\n{\n    public void Interrupt()\n    {\n        Console.WriteLine(\"Job Interrupt() called at \" + DateTime.Now);\n    }\n\n    public void Execute(IJobExecutionContext context)\n    {\n        // what code i should write here to detect misfires???\n        Console.WriteLine(\"FireTime at \" + context.FireTimeUtc.Value + \" PreviousFireTime at:\" + (context.PreviousFireTimeUtc.HasValue ? context.PreviousFireTimeUtc.Value.ToString() : \"NULL\"));\n    }\n}\n</code></pre>\n\n<p>Here is my job and trigger:</p>\n\n<pre><code>var job = JobBuilder.Create&lt;JobC&gt;().WithIdentity(new JobKey(\"JobC\")).RequestRecovery(true).Build();\nvar trigger = TriggerBuilder.Create()\n    .WithSimpleSchedule(x =&gt; x\n        .RepeatForever()\n        .WithIntervalInSeconds(2)\n            // I'm ignoring misfires here, but seems it not works!\n        .WithMisfireHandlingInstructionIgnoreMisfires())\n    .StartNow()\n    .Build();\n\nvar scheduler = new Quartz.Impl.StdSchedulerFactory().GetScheduler();\nscheduler.Start();\nscheduler.ScheduleJob(job, trigger);\n</code></pre>\n\n<p>After i call <code>scheduler.PauseAll()</code> all jobs pause and after calling <code>scheduler.ResumeAll()</code> all missed fires, gets fires! but i want to ignore them and just continue by now.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","camera"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":30,"score":-2,"question_id":13239061,"title":"Camera Snapshot in net framework 2.0","body":"<p>Hi how can i snapshot an image from my web camera am using net2.0 c#\nwithout showing the dialog of selecting a camera.\nso basic ->\nHow can i select the default camera then get an snapshot image\ni have tried wia but i can not make it select the default camera and\ntake the snapshot.</p>\n\n<p>I wish my application to work from xp to windows 8</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13272091,"title":"Transfer Cookie from WebBrowser to Webrequest","body":"<p>I get the cookies from InternetGetCookieEx and then pass it to WebRequest however this won't work for Hotmail. The result is </p>\n\n<blockquote>\n  <p><strong>Cookies must be allowed</strong>  Your browser is currently set to block cookies. Your browser must allow cookies before you can use Windows\n  Live ID.</p>\n</blockquote>\n\n<pre><code>[DllImport(\"wininet.dll\", CharSet = CharSet.Auto, SetLastError = true)]\nstatic extern bool InternetGetCookieEx(string pchURL, string pchCookieName, StringBuilder pchCookieData, ref uint pcchCookieData, int dwFlags, IntPtr lpReserved);\nconst int INTERNET_COOKIE_HTTPONLY = 0x00002000;\n\npublic static string GetGlobalCookies(string uri)\n{\n    uint datasize = 1024;\n    StringBuilder cookieData = new StringBuilder((int)datasize);\n    if (InternetGetCookieEx(uri, null, cookieData, ref datasize, INTERNET_COOKIE_HTTPONLY, IntPtr.Zero)\n        &amp;&amp; cookieData.Length &gt; 0)\n    {\n        return cookieData.ToString().Replace(';', ',');\n    }\n    else\n    {\n        return null;\n    }\n}\n\nhttpWebRequest.CookieContainer.SetCookies(\n    webBrowser.Document.Url, \n    GetGlobalCookies(webBrowser.Document.Url.AbsoluteUri)\n    );\n</code></pre>\n"},{"tags":["c#","java","android"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":13262539,"title":"How to achieve following c# behaviour in java (Android)","body":"<p>when i was programming in c# i was making very often use of events. Now I would like to achieve something similar in Java. I know both languages are diffrent and there are some diffrences in implementing such mechanism. Well to give better picture maybe i will describe a little what i want to get, because i might confuse some of terminology:</p>\n\n<p><strong>MyClass</strong> contains code that handles launching <strong>MyEvent</strong> and some code that in certain situations launches that event. </p>\n\n<p><strong>MyEventArgs</strong> is class that transports data from <strong>MyClass</strong> and is sent along with event launch, so function that handles <strong>MyEvent</strong> has some additional information about state of <strong>MyClass</strong> instance.</p>\n\n<p>And there is <strong>MyApp</strong> class that in main method contains instance of <strong>MyClass</strong> and code handling <strong>MyEvent</strong> and when event is raised inside <strong>MyClass</strong> certain actions are performed in code that listens to <strong>MyEvent</strong>.</p>\n\n<p>If it's still unclear, what i mean to achieve is exactly like c# mechanism that is behind button click, just instead of button there is my class, there are my event arguments instead of mouse event args and there is behaviour designed by me instead of click.</p>\n\n<p>I've tried to google some answers to my problem and for example i found sites like:</p>\n\n<p><a href=\"http://javarevisited.blogspot.com/2011/12/observer-design-pattern-java-example.html\" rel=\"nofollow\">http://javarevisited.blogspot.com/2011/12/observer-design-pattern-java-example.html</a> <a href=\"http://www.javaworld.com/javaworld/javaqa/2002-03/01-qa-0315-happyevent.html\" rel=\"nofollow\">http://www.javaworld.com/javaworld/javaqa/2002-03/01-qa-0315-happyevent.html</a>   </p>\n\n<p>And either im just lost and I'm looking in bad places/using bad keywords, or what more possible i can't understand anything out of these examples/i can't transform them to work in way I need.</p>\n\n<p>What im asking for, is some example, or atleast some draft of code handling such mechanism with use of <strong>MyClass,</strong>  <strong>MyEvent,</strong>  <strong>MyEventArgs,</strong> names, pointing code i should use in my class to raise event and some sample use of class and handling of event in Main method, so it would help me wrap my mind around this problem.</p>\n\n<p><strong>==========Edit========</strong></p>\n\n<p>Maybe there are some things like that avaliable for android developers? As my goal is to get to get into mobile apps development after i dust off java.</p>\n\n<p><strong>==========Edit========</strong></p>\n\n<p>If anyone still interested, here is some sample code, it doesn't use names i metioned, just shows in general what im looking for:</p>\n\n<p>And is there no exact solution, maybe somone would suggest something similar to thing im looking for?</p>\n\n<p><strong>frmTest.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public partial class frmTest : Form\n    {\n        CountdownTimer ctmrTest;\n\n        public frmTest()\n        {\n            InitializeComponent();\n            ctmrTest = new CountdownTimer(100);\n            ctmrTest.CountdownTimerTick += new CountdownTimer.CountdownTimerTickEventHandler(ctmrTest_CountdownTimerTick); \n        }\n\n        void ctmrTest_CountdownTimerTick(object sender, CountdownTimerEventArgs ea)\n        {\n            lblTimer.Text = ea.timeString;\n            if (ea.countdownFinished) countdownEnd();\n        }\n\n        private void btnStart_Click(object sender, EventArgs e)\n        {\n            ctmrTest.Reset();\n            ctmrTest.Start();\n        }\n\n        void countdownEnd()\n        {\n            MessageBox.Show(\"Finish\");\n        }\n    }\n}\n</code></pre>\n\n<p><strong>CountdownTimer.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public class CountdownTimer\n    {\n        Timer tmrTicks = new Timer();\n        int secondsLeft = 0;\n        int numberOfSecondsToCountdown = 0;\n\n        public bool IsWorking\n        {\n            get { return tmrTicks.Enabled; }\n        }\n\n        public CountdownTimer(int seconds)\n        {\n            ...\n        }\n\n        void tmrTicks_Tick(object sender, EventArgs e)\n        {\n            ...\n            WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, true));\n        }\n\n        public void Reset()\n        {\n            ...\n            WhenCountdownTimerTick(new CountdownTimerEventArgs(secondsLeft, numberOfSecondsToCountdown, false));\n        }\n\n        public void Stop()\n        {\n            tmrTicks.Enabled = false;\n        }\n\n        public void Start()\n        {\n            ,,,\n        }\n\n        public delegate void CountdownTimerTickEventHandler(object sender, CountdownTimerEventArgs ea);\n\n        public event CountdownTimerTickEventHandler CountdownTimerTick;\n\n        protected virtual void WhenCountdownTimerTick(CountdownTimerEventArgs ea)\n        {\n            if (CountdownTimerTick != null)\n            {\n                CountdownTimerTick(this, ea);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><strong>CountdownTimerEventArgs.cs</strong></p>\n\n<pre><code>namespace SampleApp\n{\n    public class CountdownTimerEventArgs : EventArgs\n    {\n        public string timeString = \"\";\n        public bool countdownFinished = false;\n\n        public CountdownTimerEventArgs(int secondsLeft, int SecondsToCountdown, bool isfinished)\n        {\n            countdownFinished = isfinished;\n            timeString = string.Format(\"{0:00}:{1:00}\", secondsLeft / 60, secondsLeft % 60);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","http","httpcontext"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13273312,"title":"HttpContext.Current.Request.Url.Host what it returns?","body":"<p>I'm having a local application which has a path:</p>\n\n<pre><code>http://localhost:950/m/pages/Searchresults.aspx?search=knife&amp;filter=kitchen\n</code></pre>\n\n<p>but when this goes to integration environment or perhaps the production, it will be something like</p>\n\n<pre><code>http://www.someshopping.com/m/pages/SearchResults.aspx?search=knife&amp;filter=kitchen\n</code></pre>\n\n<p>For some case I need to pass just:</p>\n\n<pre><code>www.someshopping.com\n</code></pre>\n\n<p>to my XSLT file and in one of the function I'm using this:</p>\n\n<pre><code>string currentURL = HttpContext.Current.Request.Url.Host;\n</code></pre>\n\n<p>this returns me \"<strong>localhost</strong>\" in local environment. Will the same code return me:</p>\n\n<p><strong>www.someshopping.com</strong> in production  (I DO NOT need <strong>http://</strong>)</p>\n\n<p>just don't want to take any chance. So asked this silly question.</p>\n"},{"tags":["c#","list","exception","outofmemoryexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":51,"score":-2,"question_id":13273139,"title":"OutOfMemoryException in List C#","body":"<p>I'm working on some tool and I'm getting strange OutOfMemoryException even if I have 2Gb memory free(tool consumes 200Mb).\nHere is stack trace:</p>\n\n<pre><code>    System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.\n      at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n      at System.Collections.Generic.List`1.EnsureCapacity(Int32 min)\n      at MySolution.MyClass.BeginSomethingAsync(Object state)\n      at System.Threading._ThreadPoolWaitCallback.WaitCallback_Context(Object state)\n      at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n      at System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal(_ThreadPoolWaitCallback tpWaitCallBack)\n  at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(Object state)\n</code></pre>\n\n<p>I'm sure that List has only 10,000 items.\nI have found some information (http://bytes.com/topic/net/answers/721871-why-outofmemoryexception-thrown) but this didnt help me. </p>\n"},{"tags":["c#",".net","obfuscation"],"answer_count":6,"favorite_count":7,"up_vote_count":6,"down_vote_count":3,"view_count":3225,"score":3,"question_id":1857685,"title":"How to create own dotnet obfuscator","body":"<p>I know that dot net dlls and exe contain their assemblies with them so every body can extract code from it. So please tell me how can i create my own .net obfuscator and if there exist any other way to protect my application to deassemble. and plez dont give me link of any paid obfuscator. i would prefer code sample in c# or vb.net</p>\n"},{"tags":["c#","database","listbox"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3150,"score":0,"question_id":2438796,"title":"Transferring data from one list box to another c#","body":"<p>Ok so I have 2 list boxes one is connected to a database the other isnt.</p>\n\n<p>I want to be able to send the selected item from the listbox connected to the database to the one that isnt.</p>\n\n<p>Ive written this code</p>\n\n<pre><code>listBox2.Items.Add(listBox1.SelectedItem);\n</code></pre>\n\n<p>But instead of copyin the item i get \"</p>\n\n<pre><code>System.Data.DataRowView\n</code></pre>\n\n<p>Anyone havin any advice?</p>\n"},{"tags":["c#","delete","directory","folder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13265743,"title":"The technique which deletes an execution file itself and a folder includes it","body":"<p>I am developing the program which deletes the execution file itself for a uninstaller. Because it was the theme frequently taken up also at this site, I found the way easily.</p>\n\n<p>One of answer is-><a href=\"http://www.codeproject.com/Articles/31454/How-To-Make-Your-Application-Delete-Itself-Immedia\" rel=\"nofollow\">http://www.codeproject.com/Articles/31454/How-To-Make-Your-Application-Delete-Itself-Immedia</a>. I referred to this and wrote it.</p>\n\n<pre><code>string dir = Path.GetDirectoryName(Application.ExecutablePath);\nProcessStartInfo psi = new ProcessStartInfo();\npsi.WindowStyle = ProcessWindowStyle.Hidden;\npsi.FileName = \"cmd\";\npsi.Arguments = \"/C rmdir /s /q \\\"\" + dir + \"\\\"\";\nProcess p = Process.Start(psi);\nApplication.Exit();\n</code></pre>\n\n<p>Deleting its file was succeeded, on the other hand, the folder was not deleted. Although I would like to also delete a folder including it, are there any good ways? </p>\n"},{"tags":["c#","service","window","execution"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13273199,"title":"How is code executed in a window service?","body":"<p>I was asked to develop a C# windows service. However I am used to create GUI with User Input.</p>\n\n<p>Since windows services are automated, I would like to know how is the code executed.</p>\n\n<p>I mean how can I control the flow?</p>\n\n<p>Could someone clarify? I don't find a lot of information about window services... </p>\n"},{"tags":["c#","casting","boolean","equality","value-type"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":68,"score":2,"question_id":13272552,"title":"Comparing value types cast to object","body":"<p>I have a method which returns an object, which could be one of a number of different data types, including strings, numbers and bools; and at some point I need to compare the equality of two values returned from this method. I'm using <code>==</code> instead of <code>Equals()</code> because I need different number types to compare - ie. <code>3 == 3.0</code> - which is working fine for strings and numbers, but for some reason it falls down when I'm comparing boolean values.</p>\n\n<p>What would be the best way to solve this problem? I'd prefer not to have to detect the type and cast if bool, but I will do if there is no other solution</p>\n\n<p>My code looks something like:</p>\n\n<pre><code>private object GetValue() {\n    // does some stuff, returns either a boolean, string or number value\n}\n\nvar value1 = GetValue();\nvar value2 = GetValue();\nif (value1 == value2) {\n    // do something\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":5,"view_count":56,"score":-4,"question_id":13273205,"title":"Need advice on program logic","body":"<p>The program comes to the page and makes pressing buttons</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\n\nnamespace Bot\n{\n    public partial class FormWindow : Form\n    {\n        Random rnd;\n        Settings settingsForm;\n        Timer tm;\n        CallTimers callTimers;\n\n        public FormWindow()\n        {\n            rnd = new Random();\n            settingsForm = new Settings();\n            tm = new Timer();\n            tm.Tick += new EventHandler(tm_Tick);\n            wb = new WebBrowser();\n            InitializeComponent();\n        }\n\n        private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n        }\n\n        //go to page \n        public void GoPage(string string_9, string string_10)\n        {\n            this.wb.Stop();\n            string additionalHeaders = \"Content-Type: application/x-www-form-urlencoded\" + Environment.NewLine;\n            this.wb.Navigate(string_9, \"\", Encoding.UTF8.GetBytes(string_10), additionalHeaders);\n        }\n\n\n        public List&lt;HtmlElement&gt; Method_1(params string[] ClassNames)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in wb.Document.All)\n            {\n                for (int i = 0; i &lt; ClassNames.Length; i++)\n                {\n                    string b = ClassNames[i];\n                    if (htmlElement.GetAttribute(\"className\") == b)\n                    {\n                        list.Add(htmlElement);\n                        break;\n                    }\n                }\n            }\n            return list;\n        }\n\n\n        private void ButtonStart_Click(object sender, EventArgs e)\n        {\n            if (this.settingsForm.tEmail.Text == \"\" || this.settingsForm.tPassword.Text == \"\")\n            {\n                MessageBox.Show(\"Отсутствует логин и\\\\или пароль для входа на сервер МосВара.\\nВвести их можно, нажав на кнопку \\\"Настройки\\\".\", \"Ошибка\", MessageBoxButtons.OK, MessageBoxIcon.Hand);\n                return;\n            }\n            wb.Navigate(\"http://www.moswar.ru\");\n        }\n\n        private void tm_Tick(object sender, EventArgs e)\n        {\n            ((MethodInvoker)tm.Tag).Invoke();\n            tm.Stop();\n        }\n\n        //go to page through time \n         public void CallMethodAfterDelay(MethodInvoker MethodToCall, int Delay,Timer tm)\n       {\n           tm.Interval = Delay;\n           tm.Tag = MethodToCall;\n           tm.Start();\n       }\n        public void KrysomahHunting()\n        {\n            GoPage(\"http://www.moswar.ru/metro/\", \"\");\n        }\n\n        private List&lt;HtmlElement&gt; method_2(string string_9, string string_10)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in this.wb.Document.All)\n            {\n                if (htmlElement.GetAttribute(\"className\") == string_9 &amp;&amp; htmlElement.InnerText != null &amp;&amp; htmlElement.InnerText.IndexOf(string_10) != -1)\n                {\n                    list.Add(htmlElement);\n                }\n            }\n            return list;\n        }\n\n    }\n}\n</code></pre>\n\n<p>Help how to articulate the logic</p>\n\n<p>In this piece of code</p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n\n        }\n</code></pre>\n\n<p>When the program comes to the method </p>\n\n<pre><code>method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n</code></pre>\n\n<p>throws Exception ArgumentOutRangeException</p>\n\n<p>I supposethat this couldbe caused by </p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n</code></pre>\n\n<p>Heconstantly checks.Ifapagethatexecute methods .And because the method once already done its job, there is no longer the values</p>\n\n<p>And so we get an exception ArgumentOutRangeException. Help how to make the logic for this case!</p>\n"},{"tags":["c#",".net","c#-4.0","sso","saml-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13273256,"title":"Error while deserializing SAML2 response to Saml2SecurityToken","body":"<p>I have a SAML Reponse which I want to convert to a Saml2SecurityToken.\nThis is what I do:</p>\n\n<pre><code>// SAMLResponseString is a base64 encode SAML2 XML string\nstring SAMLResponse = SamlHelper.DecodeFrom64(SAMLResponseString);\nXmlReader reader = new XmlTextReader(new StringReader(SAMLResponse));\n\nvar certificate = new X509Certificate2(\"[path]\", \"[password]\");\nList&lt;SecurityToken&gt; tokens = new List&lt;SecurityToken&gt;();\ntokens.Add(new X509SecurityToken(certificate));\n\nSecurityTokenResolver outOfBandTokenResolver =\n  SecurityTokenResolver.CreateDefaultSecurityTokenResolver(new \n  ReadOnlyCollection&lt;SecurityToken&gt;(tokens), true);\nvar securityToken = (Saml2SecurityToken) WSSecurityTokenSerializer.DefaultInstance.ReadToken(reader, null);\n</code></pre>\n\n<p>On the last line (of the WSSecurityTokenSerializer), I get the following error:</p>\n\n<pre><code>Cannot read the token from the 'Response' element with the 'urn:oasis:names:tc:SAML:2.0:protocol' namespace for BinarySecretSecurityToken, with a '' ValueType. If this element is expected to be valid, ensure that security is configured to consume tokens with the name, namespace and value type specified.\n</code></pre>\n\n<p>My Response is starting with: (without the space between &lt; and samlp:Response):</p>\n\n<pre><code>&lt; samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" Version=\"2.0\"&gt;\n</code></pre>\n\n<p>Does anyone know what is going wrong here?</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13273097,"title":"using selected text in asp.net textbox","body":"<p>I have a textbox that has regular text in it.  I want a user to be able to select a word and create a hyperlink from that word.  I will be doing this by basically using that word and replacing it with an a tag and adding url info.  My question is how can I get the users selected text from c# code behind.  I saw something about selectedtext but that only works for windows forms textbox.  Any ideas?</p>\n\n<p>thanks,</p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13273180,"title":"c# Reflection of a nested struct property","body":"<p>I'm trying to do some dynamic text to object parsing, however, I have run into a snag when creating and setting nested property values for structs.</p>\n\n<p>If I have a property in an object that is a struct, whenever I use reflection to obtain the struct object and set any of it's properties/fields, the value on the object is not changed.  Take the object graph below.</p>\n\n<pre><code>public struct MyStruct\n{\n    public int MyIntProp {get;set;}\n}\n\npublic class MyObj\n{\n    public MyStruct NestedStruct {get;set;}\n}\n\nPropertyInfo pInfo = (myObj.GetType()).GetProperty(\"NestedStruct\");\nobject nestedStruct = pInfo.GetValue(myObj); // This is the nested struct however it is only a copy not the actual object\nPropertyInfo intInfo = (pInfo.PropertyType).GetProperty(\"MyIntProp\");\nintInfo.SetValue(nestedStruct, 23); // this sets the MyIntProp on the nestedStruct, but it is not set on the myObj.NestedStruct.  My goal is to set object on that NestedStruct via reflection.\n</code></pre>\n\n<p>When I use reflection to obtain the NestedStruct property and then set the MyIntProp on that struct, the original MyObj.NestedStruct.MyIntProp doesn't change.  Naturally I attribute this to the fact that the struct is a value type and not a reference type.  </p>\n\n<p>So the real question is how I can use reflection to obtain the reference to a value type.</p>\n"},{"tags":["c#","github","open-source","nuget"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":28,"score":3,"question_id":13272672,"title":"Directory structure for a NuGet published github hosted project","body":"<p>For a github hosted open sourced C# project which is also available via NuGet, how should one organize the source? Specifically:</p>\n\n<ul>\n<li>should the .nuspec file be in the github repository?</li>\n<li>should the .nuspec file be in the same folder as the .csproj file?</li>\n<li>how about the NuGet package tree (the /lib, /content stuff), since is generated, should it be in git?</li>\n</ul>\n\n<p>My thinking is that the NuGet part is separate from the github hosting, as in the project source are available but the .nuspec is not, since the publishing in NuGet is not an open source operation per-se. None wants that every fork to build and publish a <em>new</em> NuGet package, so that the open source Foo package ends up in the gallery as 'Rick's Foo' vs. 'John's Foo' vs. 'Alice's Foo' etc. </p>\n\n<p>But on the other hand I do want the github source depot to act as a one-stop repository for the project, if I open my other laptop and enlist from there, I should be able to build/package/push w/o recreating the whole NuGet infrastructure from scratch (ie. only enter my API key, nothing more).</p>\n\n<p>These two requirements are contradicting each other, Did I miss something obvious?</p>\n"},{"tags":["c#","trace","nlog","system.diagnostics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13260672,"title":"Automatically log System.diagnostics.trace messages to an Nlog target","body":"<p>Say you have C# trace messages all over an application. Something like:       </p>\n\n<pre><code>Trace.TraceInformation(\"Service Started\"); \n</code></pre>\n\n<p>How do you automatically log this to an nLog target without having to add code like the following to all the classes that have trace messages? </p>\n\n<pre><code>using NLog;\nprivate static Logger logger = LogManager.GetCurrentClassLogger();\n</code></pre>\n\n<p>Is there a way to do this without including traces produced by the .NET Framework itself, which <a href=\"http://nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through-nlog.html\" rel=\"nofollow\">this article</a> demonstrates how to do? </p>\n"},{"tags":["c#","process","kill"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13273163,"title":"Restart a process","body":"<p>I want to restart a program.<br />\nI've found the process and have called Kill method, then i've runned it again:<br />\nprocess.Kill();<br />\nprocess.Start();<br /></p>\n\n<p>It stops but doesn't start.<br />\nAlso if I put Exited event it never fires.<br />\nWhat's the problem?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13272886,"title":"Hybrid asp.net 4 and MVC application","body":"<p>I am in the process of migrating a asp.net 4 project to MVC 3 - with plans to migrate to MVC4 once everything had been migrated.  I followed this post:</p>\n\n<p><a href=\"http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx\" rel=\"nofollow\">http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx</a></p>\n\n<p>Created an Area, added the Controllers and Views folders, created a controller</p>\n\n<pre><code>public class HomeController : Controller\n{\n  public ActionResult Index()\n  {\n    return View();\n  }\n}\n</code></pre>\n\n<p>Ran the application and checked the standard Aspx pages and then worked fine and then went to the path of the Controller and get the \"Error: Value can not be null. Parameter name: incomingMarkupParser\" error.  So, I then removed the return View(); and replaced it with return Content(\"Hello world\"); and this worked with no problems at all.</p>\n\n<p>So I thought to myself, is there a problem with the area... Created a Controllers and Views folder and tried again - same problem.</p>\n\n<p>System.Web.Razor is version 2.0.0.0\nSystem.Web.WebPages is version 1.0.0.0 (also tried version 2)</p>\n\n<p>Web.Config</p>\n\n<pre><code>  &lt;assemblies&gt;\n    &lt;add assembly=\"System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" /&gt;\n    &lt;add assembly=\"System.Web.Extensions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;add assembly=\"System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n    &lt;add assembly=\"System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /&gt;\n    &lt;add assembly=\"System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;add assembly=\"System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n    &lt;add assembly=\"System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n    &lt;add assembly=\"System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n  &lt;/assemblies&gt;\n\n  &lt;namespaces&gt;\n    &lt;add namespace=\"System.Web.Helpers\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n    &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n    &lt;add namespace=\"System.Web.Routing\" /&gt;\n    &lt;add namespace=\"System.Web.WebPages\"/&gt;\n  &lt;/namespaces&gt;\n</code></pre>\n\n<p>I know the problem is to do with Razor but I cannot find what.  Has anyone else experienced this, and if so how did they overcome it?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net","gridview","textbox","validator"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13180696,"title":"How to globalize RegularExpressionValidator Error Message?","body":"<p>Is there any way where we can globalize RegularExpressionValidator errorMessage? and instead of calling the error message from  we can call it off a resource file ?\nHere is what I have:</p>\n\n<pre><code>&lt;FooterTemplate&gt;\n                                    &lt;asp:TextBox ID=\"addCREDIT_TYPE\" style=\"WIDTH: 55px\" Runat=\"Server\" MaxLength=\"1\"&gt;&lt;/asp:TextBox&gt;\n                                    &lt;asp:RegularExpressionValidator ID=\"valCreditType\" ControlToValidate=\"addCREDIT_TYPE\" ValidationExpression=\"B|P|C|b|p|c\"\n                                    ErrorMessage=\"Invalid Type. Enter B or C or P\" Runat=\"server\" Display=\"Dynamic\"&gt;&lt;/asp:RegularExpressionValidator&gt;\n                                    &lt;/FooterTemplate&gt;\n</code></pre>\n"},{"tags":["c#","wpf","xaml","visual-studio-2012","kinect"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13256124,"title":"KinectColorViewer and SDK 1.6","body":"<p>I'm new to Kinect and VS Development, and I was using the <a href=\"http://channel9.msdn.com/Series/KinectQuickstart\" rel=\"nofollow\">Windows Kinect Quickstart Series</a>, but unfortunately, it was meant for Kinect SDK v1.00.</p>\n\n<p>I got stuck on KinectColorView usage, and I'cant proceed (I have been Googlin' for 2 days now). I also found this very similar question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> here on StackOverflow but couldn't solve my problem. I know that I'm close, but i need help.</p>\n\n<p><strong>The problem is: that I can't get my KinectColorViewer to work.</strong></p>\n\n<p>I added it to the XAML designer, but it seems I can't bind it to the SensorManager. \nHere is my XAML code:</p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:WpfViewers=\"clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers\" xmlns:Toolkit=\"clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit\" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\" x:Class=\"KinectSetupDev.MainWindow\"\n    Title=\"MainWindow\" Height=\"768\" Width=\"1024\" Loaded=\"Window_Loaded_1\" Closed=\"Window_Closed_1\"&gt;\n\n    &lt;Grid HorizontalAlignment=\"Left\" Height=\"736\" VerticalAlignment=\"Top\" Width=\"1012\" Margin=\"2,2,0,0\"&gt;\n         &lt;TextBlock x:Name=\"tbMessages\" HorizontalAlignment=\"Left\" Height=\"60\" Margin=\"10,662,0,0\" TextWrapping=\"Wrap\" VerticalAlignment=\"Top\" Width=\"992\"/&gt;\n         &lt;WpfViewers:KinectColorViewer x:Name=\"KinectColorViewer\" KinectSensorManager=\"{Binding KinectSensorManager}\" HorizontalAlignment=\"Left\" Height=\"240\" Margin=\"608,27,0,0\" VerticalAlignment=\"Top\" Width=\"320\" BorderThickness=\"1\" BorderBrush=\"Black\"/&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>Nothing to report about the XAML code, except that i had to add the chunk</p>\n\n<pre><code>\"KinectSensorManager=\"{Binding KinectSensorManager}\"\n</code></pre>\n\n<p>in the KinectColorViewer item by writing it, because I couldn't find the way to this by the XAML designer's GUI (so I have some doubts about its viability).</p>\n\n<p>Here is my code-behind (<em>I almost totally copied it by the question: <a href=\"http://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5\">Using KinectColorViewer in SDK1.5</a> so I can't understand why it's not working!!</em>)</p>\n\n<pre><code>namespace KinectSetupDev\n{\n  public partial class MainWindow : Window\n  {\n    // Automatically finds a Kinect for you.\n    private readonly KinectSensorChooser sensorChooser = new KinectSensorChooser();\n\n    public KinectSensorManager KinectSensorManager01 { get; private set; }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n\n    }\n\n    private void Window_Loaded_1(object sender, RoutedEventArgs e)\n    {\n        // Initialize the Kinect sensor manager.\n        KinectSensorManager01 = new KinectSensorManager();\n        KinectSensorManager01.KinectSensorChanged += this.KinectSensorChanged;\n\n        // Locate an available sensor.\n        sensorChooser.Start();\n\n        // Bind chooser's sensor value to the local sensor manager.\n        var kinectSensorBinding = new Binding(\"Kinect\") { Source = this.sensorChooser };\n        BindingOperations.SetBinding(this.KinectSensorManager01, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);\n    }\n\n    private void Window_Closed_1(object sender, EventArgs e)\n    {\n        UninitializeKinectServices(KinectSensorManager01.KinectSensor);\n    }\n\n    #region Kinect Discovery &amp; Setup\n\n    private void KinectSensorChanged(object sender, KinectSensorManagerEventArgs&lt;KinectSensor&gt; args)\n    {\n        if (null != args.OldValue)  \n            UninitializeKinectServices(args.OldValue);\n\n        if (null != args.NewValue)\n            InitializeKinectServices(KinectSensorManager01, args.NewValue);\n    }\n\n    // Kinect enabled apps should customize which Kinect services it initializes here.\n    private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)\n    {\n        // Application should enable all streams first.\n        kinectSensorManager.ColorStreamEnabled = true;\n        kinectSensorManager.DepthStreamEnabled = true;\n        kinectSensorManager.SkeletonStreamEnabled = true;\n\n        // Start the sensor!\n        try\n        {\n            sensor.Start();\n            sensorChooser.Kinect.ElevationAngle = 10;\n            tbMessages.Text = \"Kinect Started\";\n        }\n        catch (System.IO.IOException)\n        {\n            sensor = null;\n            tbMessages.Text = \"Kinect Not Started\" + \"\\r\";\n        }\n    }\n\n    // Kinect enabled apps should uninitialize all Kinect services that were initialized in InitializeKinectServices() here.\n    private void UninitializeKinectServices(KinectSensor sensor)\n    {\n        if (sensor != null)\n        {\n\n            if (sensor.IsRunning)\n            {\n                sensorChooser.Kinect.ElevationAngle = 0;\n                sensor.Stop();\n                sensor.AudioSource.Stop();\n\n            }\n        }\n    }\n\n    #endregion Kinect Discovery &amp; Setup\n\n  }\n}\n</code></pre>\n\n<p>I tried to add the line  <code>DataContext = this;</code>  in the contructor, but it does not work.</p>\n\n<p><strong>The application runs, my Kinect starts but the KinectColorViewer does not show anything.</strong></p>\n\n<p><em>Moreover, can anyone tell the difference between</em>  <code>sensor.SkeletonStream.Enable();</code> \n<em>and</em>  <code>kinectSensorManager.SkeletonStreamEnabled = true;</code>  <em>??</em></p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13272865,"title":"how to manipulate the URL path in c# asp.net?","body":"<p>I have the following path:</p>\n\n<blockquote>\n  <p>-http://localhost/portal/reportview.aspx</p>\n</blockquote>\n\n<p>but I need to retrieve the first 3 parts:</p>\n\n<blockquote>\n  <p>-http://localhost/portal/</p>\n</blockquote>\n\n<p>Ive tried <code>HttpContext.Current.Request.Url.GetLeftPart();</code> with no luck.</p>\n"},{"tags":["c#","database","path","privileges","appdata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13272429,"title":"Crash for the deletion of a database in AppData: Access denied","body":"<p>I have this code for creating a path for a database:</p>\n\n<pre><code>static string folder = Application.UserAppDataPath; \nstatic string fisier = \"prog.db\"; \nstring file = folder + \"\\\\\" + fisier;\n</code></pre>\n\n<p>And this code for delete the database:</p>\n\n<pre><code>if (System.IO.File.Exists(file))\n   System.IO.File.Delete(file);\n</code></pre>\n\n<p>And this code for wirting the database:</p>\n\n<pre><code>if (!System.IO.File.Exists(file)) \n            {\n                System.IO.File.WriteAllText(file, \"\");\n            }\n</code></pre>\n\n<p>The codes work perfectly, but the problem is with the privileges. To some people, is a problem with the deleting of database, the application will crash becouse will can not delete the database. Not works only for some people, in my case, work perfectly, but I want to resolve the problem to not crash if you don't have the privileges.</p>\n"},{"tags":["c#","itextsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13258280,"title":"How do I 'Save As' an existing pdf in ItextSharp?","body":"<p>What I want to do is write variables to an existing PDF template and allow the user to save as after clicking get results? is this possible?</p>\n"},{"tags":["c#","vb.net","compiler","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13260695,"title":"What other neat tricks does the SpecialNameAttribute allow?","body":"<p>In researching <a href=\"http://stackoverflow.com/questions/13259162/vb-net-power-operator-overloading-from-c-sharp\">a question</a> on implementing the Visual Basic Power (<code>^</code>) operator, I learned that the <a href=\"http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx\" rel=\"nofollow\"><code>System.Runtime.CompilerServices.SpecialNameAttribute</code></a> class allows one to implement this operator in C# for use in VB.</p>\n\n<p>Interestingly, the <a href=\"http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx\" rel=\"nofollow\">documentation</a> states:</p>\n\n<blockquote>\n  <p>The <strong>SpecialNameAttribute</strong> class is not currently used in the .NET Framework, but is reserved for future use.</p>\n</blockquote>\n\n<p>My question is:  What other neat tricks are available when using this attribute? </p>\n\n<p>(side question - is the documentation inaccurate or is this a semantic issue since the attribute is apparently used by the <em>compiler</em> but not the <em>framework</em>?)</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":117,"score":3,"question_id":13270662,"title":"How to make AND operator in C# linq?","body":"<pre><code>IEnumerable&lt;WireUsrTgInfo&gt; lstWireData = \n    (from var in lstWireUsrTgInfo\n     where var.bWireData == true &amp;&amp; var.bWireData == false --&gt; This is not working\n     select var).AsEnumerable&lt;WireUsrTgInfo&gt;();\n</code></pre>\n\n<p>How to do this ... </p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12679114,"title":"Send custom object through webservices Error","body":"<pre><code>   [WebService(Namespace = \"http://tempuri.org/\")]\n[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n[System.ComponentModel.ToolboxItem(false)]\n// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. \n// [System.Web.Script.Services.ScriptService]\npublic class Service1 : System.Web.Services.WebService\n{\n\n    [WebMethod]\n    public LoginResponse SignUp(string email, string password)\n    {\n        LoginResponse s = new LoginResponse();\n        //s.Code = \"123434\";\n        //s.Message = \"Signup succeed\";\n        //s.UserId = \"\";\n        return s;\n    }\n\n    [WebMethod]\n    public SendCodeResponse SendCode(string userId, string barCode)\n    {\n        SendCodeResponse scr = new SendCodeResponse();\n        scr.code = \"\";\n        return scr;\n    }\n\n\n\n[Serializable]\n    public class LoginResponse\n    {\n        string code;\n        string message;\n        string userId;\n\n        [XmlElement(Type = typeof(string), ElementName = \"Code\")]\n        public string Code\n        {\n            get { return code; }\n            set { code = value; }\n        }\n\n        [XmlElement(Type = typeof(string), ElementName = \"Message\")]\n        public string Message\n        {\n            get { return message; }\n            set { message = value; }\n        }\n\n        [XmlElement(Type = typeof(string), ElementName = \"UserId\")]\n        public string UserId\n        {\n            get { return userId; }\n            set { userId = value; }\n        }\n    }\n\n\n    [Serializable]\n    public class SendCodeResponse\n    {\n        string code;\n        [XmlElement(Type = typeof(string), ElementName = \"Code\")]\n        public string Code\n        {\n            get { return code; }\n            set { code = value; }\n        }\n    }\n</code></pre>\n\n<p>When I run this webservice it gives me\n\nServer Error in '/' Application.</p>\n\n<p>The XML element 'SendCodeResponse' from namespace 'http://tempuri.org/' references a method and a type. Change the method's message name using WebMethodAttribute or change the type's root element using the XmlRootAttribute.</p>\n\n<p>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </p>\n\n<p>Exception Details: System.InvalidOperationException: The XML element 'SendCodeResponse' from namespace 'http://tempuri.org/' references a method and a type. Change the method's message name using WebMethodAttribute or change the type's root element using the XmlRootAttribute.</p>\n\n<p>\nPlease help me.</p>\n"},{"tags":["c#","asp.net","repeater"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13272805,"title":"How to pass in the entire object into a function in a repeater?","body":"<p>In my codebehind I have:</p>\n\n<pre><code>List&lt;Products&gt; products = \nrptr.Datasource = products;\n\n\nprotected string GetVariants(Product product)\n{\n  //\n}\n</code></pre>\n\n<p>In my repeater I have:</p>\n\n<pre><code>&lt;itemTemplate&gt;\n\n&lt;li&gt;  &lt;%# Eval(\"Name\") %&gt;\n&lt;li&gt;  &lt;%# GetVariants(?????????????) %&gt;\n\n&lt;/itemTemplate&gt;\n</code></pre>\n\n<p>How do I pass the product object to the GetVariants method?</p>\n"},{"tags":["c#","xaml","stackpanel","windows-store-apps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13241742,"title":"Add Expansion Button to Stackpanel","body":"<p>I'd like to add Elements to a StackPanel (or Listbox / Listview if it would make that easier) and automatically add a Button (like \"...\") to indicate that there are more children than there is space for.\nConsider a calendar that has appointment items in each day. If there are more appointments than as much as can be displayed a button is displayed to go to a detailed view for that day.</p>\n\n<p>Can this be done automatically, or how do I calculate the positions of the stackpanel and its items.</p>\n\n<p>It's for windows store development in c#.</p>\n"},{"tags":["c#","sockets","client","endpoint","reconnect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13271817,"title":"Connect to the same End Point using Socket","body":"<p>I'm using the <a href=\"http://msdn.microsoft.com/en-us/library/system.net.sockets.socket%28v=vs.90%29.aspx\" rel=\"nofollow\">Socket</a> class in a client TCP/IP application to connect my client to a server.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>var endPoint = new IPEndPoint(IPAddress.Parse(IP), port);\nvar client = new Socket(AddressFamily.InterNetwork, SocketType.Stream,\n                        ProtocolType.Tcp);\n\nclient.Connect(endPoint);\n\ntry\n{\n    while (true)\n    {\n        // Do work...\n        // Receive/Send data from/to server\n    }\n}\ncatch (SocketException)\n{\n    /* At some point the server disconnects...\n    Exception catched because the server close the connection\n    Socket error 10054 - WSAECONNRESET */\n\n    // So I try to reconnect\n    if(client.Connected == false)\n    {\n        /* The following line throws a InvalidOperationException.\n        Message: After disconnecting the socket, you can reconnect only \n        asynchronously from a different EndPoint. BeginConnect must be \n        called on a thread that will not close until the operation completes.*/\n        client.Connect(endPoint);   \n\n        /* So I try instead Socket.BeginConnect, but the following line\n        throws a SocketException 10061 - WSAECONNREFUSED */\n        client.BeginConnect(endPoint, ConnectCallback, client);\n\n        /* And also the following code throws a \n            SocketException 10061 - WSAECONNREFUSED */\n        client = new Socket(AddressFamily.InterNetwork, SocketType.Stream,\n                                ProtocolType.Tcp);\n        client.Connect(endPoint);\n    }\n} \n</code></pre>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms740668%28v=vs.85%29.aspx\" rel=\"nofollow\">Here</a> a list of socket error.<br><br></p>\n\n<p>So, at some point the server close the connection, I need to know what is the best method to know when the server is ready for accept another connection and how to connect again to the same End Point.</p>\n"},{"tags":["c#","vsto","excel-interop"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":4896,"score":1,"question_id":7099770,"title":"HRESULT: 0x800A03EC on Worksheet.range","body":"<p>I am getting HRESULT: 0x800A03EC on Worksheet.range method. Number of rows are more than 70K. Office 2007.</p>\n\n<p>Code:</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Range neededRange\n    = currentWS.Range[cell.Cells[1, 1], cell.Cells[nRowCount, nColumnCount]];\n</code></pre>\n\n<p>Here my rowcount is more than 65530 . Breaks on this function. I have observed that it breaks only when row count goes more than 65530.</p>\n"},{"tags":["c#","web-applications","bitmap","webbrowser","xelement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":30,"score":-4,"question_id":13272162,"title":"web browser in C# without using my own web browser class","body":"<p>i have no idea about what im doing the problem is that i got the assignment without any further explanation all what i have to do is make a program with main form that will load an html file into it but without using web browser class and the Html will contain a text and images and the only hint i got is i'll be using \"Xelement to read the file from a Dom tree and render it into a bitmap file that will be displayed into the form\" </p>\n"},{"tags":["c#","sql-server","sql-server-2005","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2113,"score":1,"question_id":6824188,"title":"SqlDataSourceEnumerator.Instance.GetDataSources() does not locate local SQL server 2008 instance","body":"<p>I use the following code to list all the remote and local SQL Server instances:</p>\n\n<pre><code>public static void LocateSqlInstances()\n  {\n     using( DataTable sqlSources = SqlDataSourceEnumerator.Instance.GetDataSources())\n     {\n        foreach(DataRow source in sqlSources.Rows )\n        {\n           string instanceName = source[\"InstanceName\"].ToString();\n\n           if (!string.IsNullOrEmpty(instanceName))\n           {\n              Console.WriteLine(\" Server Name:{0}\", source[\"ServerName\"]);\n              Console.WriteLine(\"   Instance Name:{0}\", source[\"InstanceName\"]);\n              Console.WriteLine(\"   Version:{0}\", source[\"Version\"]);\n              Console.WriteLine();\n           }\n        }\n        Console.ReadKey();\n     }\n  }\n</code></pre>\n\n<p>running the code on my local machine. The code can find and list a SQL server express instance (version 9.0.5000) installed but failed to list the other SQL server instance (version 10.0.1600).</p>\n\n<p>I've done a lot of research on the Internet and made sure that 1-the Sql Broswer is runing and 2 - the UDP port 1434 is open.</p>\n\n<p>Anybody knows why? Thanks.</p>\n"},{"tags":["c#","xml","attributes","unity3d"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13272359,"title":"how to read and print specific attributes from xml c #","body":"<p>Lets say I have xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Test Description=\"Test XML\" VersionFormat=\"123\" ProtectedContentText=\"(Test test)\"&gt;\n    &lt;Testapp&gt;\n        &lt;TestappA&gt;\n            &lt;A Id=\"0\" Caption=\"Test 0\" /&gt;\n            &lt;A Id=\"1\" Caption=\"Test 1\" /&gt;\n            &lt;A Id=\"2\" Caption=\"Test 2\" /&gt;\n            &lt;A Id=\"3\" Caption=\"Test 3\"&gt;\n                &lt;AA&gt;\n                    &lt;B Id=\"4\" Caption=\"Test 4\" /&gt;\n                &lt;/AA&gt;\n            &lt;/A&gt;\n        &lt;/TestappA&gt;\n        &lt;AA&gt;\n            &lt;Reason Id=\"5\" Caption=\"Test 5\" /&gt;\n            &lt;Reason Id=\"6\" Caption=\"Test 6\" /&gt;\n            &lt;Reason Id=\"7\" Caption=\"Test 7\" /&gt;\n        &lt;/AA&gt;\n    &lt;/Testapp&gt;\n&lt;/Test&gt;\n</code></pre>\n\n<p>I need to read the values of attributes Caption from this xml without using LINQ as the purpose of this code is perform this in Unity3D, after spending all night to make this real I wrote a code which doesn't work. Please help! </p>\n\n<p>code snipped: </p>\n\n<pre><code>// XML settings\nXmlReaderSettings settings = new XmlReaderSettings();\nsettings.IgnoreWhitespace = true;\nsettings.IgnoreComments = true;                        \n\n// Loop through the XML to get all text from the right attributes\nusing (XmlReader reader = XmlReader.Create(sourceFilepathTb.Text, settings))\n{\n    while (reader.Read())\n    {\n        if (reader.NodeType == XmlNodeType.Element)\n        {\n            if (reader.HasAttributes)\n            {\n                if (reader.GetAttribute(\"Caption\") != null)\n                {                                \n                    MessageBox.Show(reader.GetAttribute(\"Caption\"));\n                }                            \n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","entity-framework",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13271262,"title":"Entity Framework meta data","body":"<p>I have a piece of code</p>\n\n<pre><code> using (InContext inContext = new InContext())\n</code></pre>\n\n<p>When I right click the definition, it points to <code>C:\\Users\\me\\AppData\\Local\\Temp\\....</code></p>\n\n<p>What is that? A defined dll?</p>\n\n<pre><code>    #region Assembly SharedObjects.dll, v4.0.30319\n   // C:\\source\\blah\\blah\\packages\\SharedObjects.1.0.4659.22817\\lib\\net40\\SharedObjects.dll\n    #endregion\n\n   using blahSharedObjects;\n   using System;\n   using System.Data.Entity;\n\n   namespace something\n   {\n       public class InContext : DbContext\n   {\n       public InContext();\n       public InContext(string connectionString);\n\n\n        public DbSet&lt;InDetails&gt; InDetailRecords { get; set; }\n        public string IPAddress { get; set; }\n\n        public string UserName { get; set; }\n\n   }\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#","html-agility-pack"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":46,"score":-2,"question_id":13272217,"title":"ArgumentNullException unhandled","body":"<p>I'm new to C#. I have an implicit typed variable defined like this:</p>\n\n<pre><code> var item = doc.DocumentNode.SelectNodes(\"//body[@id='person']\")\n                                  .Select(p =&gt; p.InnerText);\n</code></pre>\n\n<p>This var sometimes returns <code>null</code>. And that's where visual studio asks me to handle the <code>ArgumentNullException</code>. But if I do that my <code>var</code> remains unknown to the rest of my <code>try</code>-<code>catch</code> and I can no longer use it.</p>\n\n<p>Someone advised me to use the null object design pattern but I don't how am I supposed to implement it for a <code>var</code>. Does anyone know how I should handle such situations because I'm tired of handling the null case each and every time.</p>\n"},{"tags":["c#","multithreading","compression"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1368,"score":2,"question_id":1211225,"title":"Multithreaded compression in C#","body":"<p>Is there a library in .net that does multithreaded compression of a stream? I'm thinking of something like the built in <code>System.IO.GZipStream</code>, but using multiple threads to perform the work (and thereby utilizing all the cpu cores).</p>\n\n<p>I know that, for example 7-zip compresses using multiple threads, but the C# SDK that they've released doesn't seem to do that.</p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13259236,"title":"Web Service background process without human interaction","body":"<p>I would like my web service to call a clean up routine every X hours, with no input from any user, or any call to \"Start Clean up Services\".  I understand I can call a method to start this service, but I want no user interaction at all.  I want to publish this service, and it automatically starts, and runs my clean up process every X hours.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","process.start"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13272693,"title":"Launching a file using Process.Start works, but adding conditions does not","body":"<p>So I am trying to launch a printer script using cscript from C#, and cscript launches a visual basic file. So sort of a daisy chain (and I want to keep this daisy chain intact for certain reasons).</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Process.Start(\"c:/windows/system32/cscript.exe c:/windows/System32/Printing_Admin_Scripts/en-US/prnport.vbs\");\n</code></pre>\n\n<p>Now, when I launch ONLY cscript, no problems.</p>\n\n<p>However when I add the condition of prnport.vbs to the cscript launch, I get this error in Visual Studio:</p>\n\n<pre><code>\"The system cannot find the file specified\"\n</code></pre>\n\n<p>But I can confirm the file path is correct - <code>prnport.vbs</code> DOES exist in <code>/en-US</code>.</p>\n\n<p>So what am I doing wrong here? Can you not pass arguments (and in this case, the file path is being passed as an argument to cscript.exe) when using Process.Start?</p>\n\n<p>New to C# and confused about the proper way to do this.</p>\n"},{"tags":["c#","process","parallel-processing","threadpool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13270508,"title":"Parallel processing of large number of processes","body":"<p>I use a <code>ThreadPool</code> to execute several processes in parallel, like shown <a href=\"http://www.mindstick.com/Articles/8a6ce546-6516-46c7-9398-edc0d28a38f1/\" rel=\"nofollow\">here</a>\nwith a difference that I start my own process/program with some parameters. In few words, this program calculates some values and write them into a text file, which I compare afterwards.</p>\n\n<pre><code>public void StartProcess()\n{\n    string par = @\"-p \"\"foo\"\" -c 17\";\n    Process p = Process.Start(@\"C:\\MyProgramm.exe\", par); \n    p.EnableRaisingEvents = true;\n    p.Exited += new EventHandler(p_Exited);\n}\n\nvoid p_Exited(object sender, EventArgs e)\n{            \n    // Indicates that the process has been completed\n    this.doneEvent.Set();\n    Console.WriteLine(\"thread {0} end...\", ThreadIndex);\n}\n</code></pre>\n\n<p>For a small number of threads it works fine. In my case I must start about 200 threads, but in <code>WaitHandle.WaitAll</code> method I get a <code>NotSuppotedException</code> </p>\n\n<blockquote>\n  <p>The number of objects in waitHandles is greater than the system\n  permits.</p>\n</blockquote>\n\n<p>My question now is: Is there a possibility of <code>ThreadPool</code> class to manage a large number of threads? Something like a queue, starting new processes when other has been completed.\nTo be simple, in my case a process = thread.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":606,"score":1,"question_id":7534335,"title":"Accessing GridView Cells Value","body":"<p>Hi I am trying to access the integer value of the first cell but i am getting this error</p>\n\n<pre><code>Unable to cast object of type 'System.Web.UI.WebControls.DataControlFieldCell' to type 'System.IConvertible'.\n</code></pre>\n\n<p>And the value i have stored in that cell is an ID like 810 </p>\n\n<p>My Code</p>\n\n<pre><code>int myID = Convert.ToInt32(GridView1.Rows[rowIndex].Cells[0]);\n</code></pre>\n"},{"tags":["c#","winforms","listview","listviewitem"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":342,"score":2,"question_id":3356224,"title":"C#: Prevent ListViewItem Image to be rendered selected","body":"<p>I was wondering whether it would be possible to have a ListView, in which items can be selected as usual with one difference. When a ListViewItem is selected, I would like to see the selection in the text label, however I would prefer the image to remain the same. The reason for this is, that currently the blue selection drawn ontop of the image looks horrible (the effect is even worse on transparent images!). </p>\n\n<p>I was hoping of not having to use the DrawItem handler, but I guess the hopes are slim. </p>\n\n<p>thanks a lot, </p>\n\n<p>best</p>\n\n<p>Frank</p>\n\n<p>EDIT: I thought I better add a screenshot showing the issue. I'm using the ListView in LargeIcon mode. </p>\n\n<p>** oups I'm not allowed to add pictures yet * so here the link to it. sorry for the inconvenience. <em>*</em> </p>\n\n<p><a href=\"http://cl.ly/adb9c6d29ffc0e2e1b5e\" rel=\"nofollow\">http://cl.ly/adb9c6d29ffc0e2e1b5e</a></p>\n\n<p>As you can see the selected element is 'Rate vs. Species'. However, I would love for the blue tint on the icon to disappear. </p>\n\n<p>Thanks again. </p>\n"},{"tags":["c#","javascript","asp.net-mvc","signalr"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":5003,"score":1,"question_id":7594978,"title":"Using SignalR with ASP.NET MVC3","body":"<p>I'm attempting to use SignalR hubs in an application, but am having no luck currently. I've read through <a href=\"http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx\" rel=\"nofollow\">Scott Hanselman's article</a>, and also looked at <a href=\"http://beyondrelational.com/modules/24/syndicated/370/Posts/9623/signalr-with-mvc3-chat-app-build-asynchronous-real-time-persistant-connection-websites.aspx\" rel=\"nofollow\">this</a> blog post which shows how to implement it in MVC, basically doing the same thing. Unfortunately, I'm having no luck. On the client side, the javascript seems to work fine [apart from nothing happening] but when I place breakpoints in the code it shows that the controller is being called, not the hub code. The code I'm using is this:</p>\n\n<pre><code>// Client side javascript:\nvar hooking;\n$(function() {\n    // Setup SignalR\n    hooking = $.connection.hooking;\n    hooking.removeLead = function(ref) {\n        $(\"lead\" + ref).remove();\n    };\n    $.connection.hub.start();\n    }\n});\n\n// Hooking.cs (placed in application root)\npublic class Hooking : Hub\n{\n    public void Submit(string jsonString)\n    {\n        var serializer = new JavaScriptSerializer();\n        var json = serializer.Deserialize&lt;HookingLeadResult&gt;(jsonString);\n        Clients.removeLead(json.Ref); // Remove lead from client hooking windows\n        // update lead gen\n    }\n}\n</code></pre>\n\n<p>When I call <code>hooking.submit(resultJson);</code> later in my code for some reason it calls the Index action of my HookingController (which is the current page). Anyone know how to correctly call the Submit function from Hooking.cs?</p>\n"},{"tags":["c#",".net","membership-provider","sqlmembershipprovider"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13271544,"title":"writing custom membership provider","body":"<p>i am writing the custom membership provider class by implementing System.Web.Security.membershipprovider.</p>\n\n<p>now my problem is while accessing the class i am getting error as</p>\n\n<p>error code :</p>\n\n<pre><code>String reference not set to an instance of a String.\nParameter name: s\n</code></pre>\n\n<p>Stack trace:</p>\n\n<pre><code>   at System.Text.Encoding.GetBytes(String s)\n   at ss.Provider.EncodePassword(String password) \n   at ss.Provider.CreateUser(String username, String password, String email, String passwordQuestion, String passwordAnswer, Boolean isApproved, Object providerUserKey, MembershipCreateStatus&amp; status) \n   at System.Web.UI.WebControls.CreateUserWizard.AttemptCreateUser()\n   at System.Web.UI.WebControls.CreateUserWizard.OnNextButtonClick(WizardNavigationEventArgs e)\n   at System.Web.UI.WebControls.Wizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.CreateUserWizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.Wizard.WizardChildTable.OnBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e)\n   at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\n</code></pre>\n\n<p>and my class as</p>\n\n<p>create user:</p>\n\n<pre><code> public override MembershipUser GetUser(object userID,bool userIsOnline)\n        {\n            SqlConnection sqlConnection = new SqlConnection(connectionString);\n            SqlCommand sqlCommand = new SqlCommand(\"User_SelByUserID\", sqlConnection);\n\n            sqlCommand.CommandType = CommandType.StoredProcedure;\n            sqlCommand.Parameters.Add(\"@userID\", SqlDbType.UniqueIdentifier).Value = userID;\n\n            MembershipUser membershipUser = null;\n            SqlDataReader sqlDataReader = null;\n\n            try\n            {\n                sqlConnection.Open();\n\n                sqlDataReader = sqlCommand.ExecuteReader(CommandBehavior.CloseConnection);\n\n                if (sqlDataReader.HasRows)\n                {\n                    sqlDataReader.Read();\n                    membershipUser = GetUserFromReader(sqlDataReader);\n\n                    if (userIsOnline)\n                    {\n                        SqlCommand sqlUpdateCommand = new SqlCommand(\"User_UpdateActivityDate_ByUserID\", sqlConnection);\n\n                        sqlUpdateCommand.CommandType = CommandType.StoredProcedure;\n                        sqlUpdateCommand.Parameters.Add(\"@userID\", SqlDbType.NVarChar, 255).Value = userID;\n                        sqlUpdateCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                        sqlUpdateCommand.ExecuteNonQuery();\n                    }\n                }\n            }\n            catch (SqlException e)\n            {\n                //Add exception handling here.\n            }\n            finally\n            {\n                if (sqlDataReader != null) { sqlDataReader.Close(); }\n            }\n\n            return membershipUser;\n\n        }\n</code></pre>\n\n<p>Encode password:</p>\n\n<pre><code>private string EncodePassword(string password)\n        {\n            string encodedPassword = password;\n\n            switch (PasswordFormat)\n            {\n                case MembershipPasswordFormat.Clear:\n                    break;\n                case MembershipPasswordFormat.Encrypted:\n                    encodedPassword = Convert.ToBase64String(EncryptPassword(Encoding.Unicode.GetBytes(password)));\n                    break;\n                case MembershipPasswordFormat.Hashed:\n                    HMACSHA1 hash = new HMACSHA1();\n                    hash.Key = HexToByte(machineKey.ValidationKey);\n                    encodedPassword = Convert.ToBase64String(hash.ComputeHash(Encoding.Unicode.GetBytes(password)));\n                    break;\n                default:\n                    throw new ProviderException(\"Unsupported password format.\");\n            }\n\n            return encodedPassword;\n        }\n</code></pre>\n\n<p>the password given string is Gowtham!1</p>\n\n<p>Updated:</p>\n\n<pre><code>  public override MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out MembershipCreateStatus status)\n        {\n\n            ValidatePasswordEventArgs args = new ValidatePasswordEventArgs(username, password, true);\n\n            OnValidatingPassword(args);\n\n            if (args.Cancel)\n            {\n                status = MembershipCreateStatus.InvalidPassword;\n                return null;\n            }\n\n            if ((RequiresUniqueEmail &amp;&amp; (GetUserNameByEmail(email) != String.Empty)))\n            {\n                status = MembershipCreateStatus.DuplicateEmail;\n                return null;\n            }\n\n            MembershipUser membershipUser = GetUser(username, false);\n\n            if (membershipUser == null)\n            {\n                System.DateTime createDate = DateTime.Now;\n\n                SqlConnection sqlConnection = new SqlConnection(connectionString);\n                SqlCommand sqlCommand = new SqlCommand(\"User_Ins\", sqlConnection);\n\n                sqlCommand.CommandType = CommandType.StoredProcedure;\n                sqlCommand.Parameters.Add(\"@returnValue\", SqlDbType.Int, 0).Direction = ParameterDirection.ReturnValue;\n                sqlCommand.Parameters.Add(\"@username\", SqlDbType.NVarChar, 255).Value = username; ;\n                sqlCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                sqlCommand.Parameters.Add(\"@password\", SqlDbType.NVarChar, 255).Value = EncodePassword(password);\n                sqlCommand.Parameters.Add(\"@email\", SqlDbType.NVarChar, 128).Value = email;\n                sqlCommand.Parameters.Add(\"@passwordQuestion\", SqlDbType.NVarChar, 255).Value = passwordQuestion;\n                sqlCommand.Parameters.Add(\"@passwordAnswer\", SqlDbType.NVarChar, 255).Value = EncodePassword(passwordAnswer);\n                sqlCommand.Parameters.Add(\"@isApproved\", SqlDbType.Bit).Value = isApproved;\n                sqlCommand.Parameters.Add(\"@comment\", SqlDbType.NVarChar, 255).Value = String.Empty;\n\n                try\n                {\n                    sqlConnection.Open();\n\n                    sqlCommand.ExecuteNonQuery();\n                    if ((int)sqlCommand.Parameters[\"@returnValue\"].Value == 0)\n                    {\n\n                        status = MembershipCreateStatus.Success;\n                    }\n                    else\n                    {\n                        status = MembershipCreateStatus.UserRejected;\n                    }\n                }\n                catch (SqlException e)\n                {\n                    //Add exception handling here.\n\n                    status = MembershipCreateStatus.ProviderError;\n                }\n                finally\n                {\n                    sqlConnection.Close();\n                }\n\n                return GetUser(username, false);\n            }\n            else\n            {\n                status = MembershipCreateStatus.DuplicateUserName;\n            }\n\n            return null;\n        }\n</code></pre>\n"},{"tags":["c#","asp.net","gridview","csv"],"answer_count":1,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":6416,"score":1,"question_id":6674555,"title":"Export gridview data into CSV file","body":"<p>I have a gridview control in ASP.Net 2.0 and i need to export this gridview data into CSV file.</p>\n\n<p>I have bind this gridview with the dataset.After binding the dataset to the gridview i have done some changes in the gridview data like if I got 0 in dataset then i show 0 as \"Started\" in the gridview and if i got 1 in the dataset then I show 1 as \"Not Started\" in the gridview. </p>\n\n<p>So, i can't use dataset directly for exporting. What i need is..<strong>i want the code (in c#) that export my gridview data(not dataset's data) into CSV file.</strong></p>\n"},{"tags":["c#",".net","excel","usercontrols","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":201,"score":3,"question_id":12270735,"title":"Getting a handle to a NamedRange control in C#","body":"<p>I'm developing an application-level AddIn for Excel 2007 using C# (.NET 4.0). Questions similar to this one have been previously asked >></p>\n\n<p><a href=\"http://stackoverflow.com/questions/11374023/resizing-namedrange-throws-a-controlnotfoundexception\">Resizing NamedRange throws a ControlNotFoundException</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/7152020/c-sharp-excel-addin-accessing-controls\">C# excel addin - Accessing Controls</a></p>\n\n<p>but the responses to them (where there were any) did not work for me. So I would like to give a detailed description of what I'm trying to do, and what happens when I try to do it.</p>\n\n<p>Very briefly, my problem is that I'm not able to get hold of NamedRange control objects for modifying them, after they have been instantiated and initialized elsewhere in the code.</p>\n\n<p>Please read on for a more complete description.</p>\n\n<p>When the AddIn starts, it creates a NamedRange control and attaches it to some cells on a particular worksheet >></p>\n\n<pre><code>Worksheet worksheet = Globals.Factory.GetVstoObject(\n                Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nExcel.Range cell = worksheet.Range[\"A1\"];\n_configParams.HeaderNamedRange = worksheet.Controls.AddNamedRange(cell, \"HeaderCells\");\n_configParams.HeaderNamedRange.RefersTo = \"=\" + worksheet.Name + \"!$A$1:$A$5\";\n</code></pre>\n\n<p>After the AddIn has started, I want to allow the User to re-specify the cells to which this NamedRange control can point. In order to do so, I'm getting the User to select a range of cells and then get hold of the selected cells' location (as a String) in a suitable event-handler method.</p>\n\n<p>I then intend to programmatically re-specify the cells that the above NamedRange control points to. I have tried the following approaches, but neither of them work.</p>\n\n<p>[Approach 1]</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\n((NamedRange)(controlWorksheet.Controls[\"HeaderCells\"])).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, it throws a ControlNotFoundException, and I get the following message:</p>\n\n<pre><code>Microsoft.VisualStudio.Tools.Applications.Runtime.ControlNotFoundException was unhandled by user code\n  Message=This document might not function as expected because the following control is missing: PortfolioHeaderCells. Data that relies on this control will not be automatically displayed or updated, and other custom functionality will not be available. Contact your administrator or the author of this document for further assistance.\n  Source=Microsoft.Office.Tools.Excel.Implementation\n  StackTrace:\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.EnsureProxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.get_Proxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.AttachSupport()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.ResetControl()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.set_RefersTo(String value)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException: System.Runtime.InteropServices.COMException\n       Message=Exception from HRESULT: 0x800A03EC\n       Source=Microsoft.VisualStudio.Tools.Office.Runtime\n       ErrorCode=-2146827284\n       StackTrace:\n            at Microsoft.VisualStudio.Tools.Office.Runtime.Interop.IHostItemProvider.GetHostObject(String primaryType, String primaryCookie, IntPtr&amp; hostObject)\n            at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.Microsoft.Office.Tools.IHostItemProvider.GetHostObject(Type primaryType, String primaryCookie)\n            at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       InnerException:\n</code></pre>\n\n<p>[Approach 2]</p>\n\n<p>I then saw <a href=\"http://stackoverflow.com/questions/2416727/set-excel-named-ranges-via-c\">Set Excel Named Ranges via C#?</a> and so tried to use the approach described in the answer there:</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\ncontrolWorksheet.Names.Item(\"HeaderCells\", Type.Missing, Type.Missing).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, I get the following exception and message:</p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  Message=Exception from HRESULT: 0x800A03EC\n  Source=\"\"\n  ErrorCode=-2146827284\n  StackTrace:\n       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       at Microsoft.Office.Interop.Excel.Names.Item(Object Index, Object IndexLocal, Object RefersTo)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException:\n</code></pre>\n\n<p>So, in both approaches, the exception from HRESULT is the same: 0x800A03EC. Also, the exception is being thrown in the line where I try to get hold of the NamedRange control and re-specify the cells it points to.</p>\n\n<p>I have stepped through my code, and a NamedRange control does indeed exist where/when I try to modify the NamedRange object.</p>\n\n<p>I then checked the type of the <code>controlWorksheet.Controls[\"HeaderCells\"]</code> object using the following code >></p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nSystem.Windows.Forms.MessageBox.Show((controlWorksheet.Controls[\"HeaderCells\"]).ToString());\n</code></pre>\n\n<p>This results in a MessageBox containing \"Microsoft.Office.Tools.Excel.NamedRangeImpl\". If I'm not mistaken, this Type is not exposed by the Excel Object Model, and so I wonder if the problem is being caused by my casting a NamedRangeImpl object to a NamedRange control object.</p>\n\n<p>Your help is much appreciated. If there is any further information that I can provide, please let me know. Thanks in advance!</p>\n"},{"tags":["c#",".net","winrt",".net-4.5"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1897,"score":7,"question_id":7596919,"title":"WinRT - TCP clients?","body":"<p>I am building an IRC client in the new WinRT <code>(.NET 4.5</code>) framework for Windows 8 Metro applications.</p>\n\n<p>However, I have some issues. I've already figured out that I need to use a <code>StreamSocket</code> to read TCP data, but I may be doing something wrong.</p>\n\n<p>The reason I believe this is because I am not receiving any data.</p>\n\n<p>Below you see my code. I haven't been able to find any code samples on the web regarding this.</p>\n\n<pre><code>class IRCClient\n{\n    private StreamSocket tcpClient;\n    public string Server = \"holmes.freenode.net\";\n    public int Port = 6665;\n\n    public IRCClient()\n    {\n        tcpClient = new StreamSocket();\n    }\n\n    public async void Connect()\n    {\n        await tcpClient.ConnectAsync(\n                         new Windows.Networking.HostName(Server), \n                         Port.ToString(), \n                         SocketProtectionLevel.PlainSocket);\n\n        DataReader reader = new DataReader(tcpClient.InputStream);\n        string data = reader.ReadString(reader.UnconsumedBufferLength);\n\n        MessageDialog dialog = new MessageDialog(data);            \n    }\n}\n</code></pre>\n\n<p>Data is always an empty string following that code. Furthermore, UnconsumedBufferLength always returns 0.</p>\n\n<p>How come?</p>\n"},{"tags":["c#","vb.net","printing","serial-port","thermal-printer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":11978254,"title":"Capture Thermal Printer Data from www.dpd.co.uk to PDF","body":"<p>I am trying to achieve the following:</p>\n\n<ul>\n<li>Put a shipment into www.dpd.co.uk</li>\n<li>When the shipping label is about to be printed, capture the data that is going to be sent to the Citizen thermal printer</li>\n<li>Turn this data into a PDF file</li>\n<li>Save this PDF into a PNG file for use later (Already have code for this).</li>\n</ul>\n\n<p>So, I need help with <b>capturing data</b> that would usually be sent via COM Port to the Thermal Printer and put what would come out on the label into a PDF.</p>\n\n<p>I am open to try ANY coding engines (VB.net, C#, etc)</p>\n"},{"tags":["c#","asp.net","drop-down-menu","selectedvalue","databound"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1679,"score":2,"question_id":6746745,"title":"Setting SelectedValue of a data bound DropDownList","body":"<p>I have an asp.net dropDownList which is automatically bound to a sqlDataSource to values of client type on page load. On page load I am also creating a Client object, one of it's properties is ClientType. I am trying to set the SelectedValue of the ddl according to the value of the ClientType property of the Client object unsuccessfully. I recieve the following error message  \"System.ArgumentOutOfRangeException: 'ddlClientType' has a SelectedValue which is invalid because it does not exist in the list of items\". I understand that this is because the list has not yet been populated when I'm trying to set the selected value. Is there a way of overcoming this problem? Thank you! </p>\n"}]}
{"total":375450,"page":14,"pagesize":100,"questions":[{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13272322,"title":"System.InvalidOperationException: Category does not exist","body":"<pre><code>var performanceCounterCategory = new PerformanceCounterCategory(\"Network Interface\")\n{\n   MachineName = target.FullyQualifiedDomainName\n};\nWindowsUserImpersonator impersonator = null;\ntry\n{\n    // impersonate user if required\n    impersonator = GetImpersonator();\n    performanceCounterCategory.ReadCategory();// exeption\n    var interfaces = performanceCounterCategory.GetInstanceNames();\n    var length = interfaces.Length;\n    netBytesTotalPerSecCountersField = new List&lt;PerformanceCounter&gt;();\n    for (var i = 0; i &lt; length; i++)\n    {\n        if (interfaces[i].Contains(\"Loopback\"))\n        {\n            continue;\n        }\n        var counter = new PerformanceCounter\n        {\n            MachineName = target.FullyQualifiedDomainName,\n            CategoryName = \"Network Interface\",\n            CounterName = \"Bytes Total/sec\",\n            InstanceName = interfaces[i]\n        };\n</code></pre>\n\n<p>It works fine with some windows machines, but does not work with others. For example, it works fine with win 7 ultimate but throws an exeption for win 7 enterprise. What's wrong? Why would it work with some and not work with others?</p>\n"},{"tags":["c#","wpf","mvvm","outlook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13251705,"title":"Failing to create an email with outlook interop when outlook has already been opened","body":"<p>How do you open an outlook window? I tried the code below but this doesn't work when an instance of outlook is already running - </p>\n\n<pre><code>System.Diagnostics.Process[] processes = System.Diagnostics.Process.GetProcessesByName(\"OUTLOOK\");\n\nint processCount = processes.Length;\nif (processCount != 0)\n{\n    **outlookApp = Marshal.GetActiveObject(\"Outlook.Application\") as Microsoft.Office.Interop.Outlook.Application;** this is throwing the below error **\n}\nelse\n{\n    outlookApp = new Microsoft.Office.Interop.Outlook.Application();\n}\n</code></pre>\n\n<p>And I got:</p>\n\n<pre><code>Error:\nOperation unavailable (Exception from HRESULT: 0x800401E3 (MK_E_UNAVAILABLE))\n</code></pre>\n\n<p>Can someone please give an alternate approach or changes to the above code?</p>\n"},{"tags":["c#","asp.net",".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13271611,"title":"What are the things that i have to Do and Don't when an application to be Globalized and Localized?","body":"<p><strong>What are the areas we needed to change in the code when an application to be Globalized and Localized?</strong></p>\n\n<p>For example</p>\n\n<p><strong>Do</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\", CultureInfo.InvariantCulture)\n                        .ToString();\n</code></pre>\n\n<p><strong>Don't</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\").ToString();\n</code></pre>\n"},{"tags":["c#","serial-port","clear"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13268001,"title":"C# serial port clear","body":"<p>I need to achieve this statement on serial port communication:</p>\n\n<blockquote>\n<pre><code>SUCCESS   Purge: TXCLEAR RXCLEAR  \n</code></pre>\n</blockquote>\n\n<p>But when I call <code>mySerialPort.discartInBuffer();</code> or  <code>mySerialPort.discartOutBuffer();</code>, all I got is this:</p>\n\n<blockquote>\n<pre><code>SUCCESS   Purge: RXABORT RXCLEAR  \nSUCCESS   Purge: TXABORT TXCLEAR\n</code></pre>\n</blockquote>\n\n<p>Is there any way to call both clear commands as it is in first example?\n(Communication was sniffed via PortMon)</p>\n\n<p>Appreciate you help, thanks. </p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13272267,"title":"Programatically execute Ctrl-H","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7307868/c-sharp-simulate-key-press\">C# Simulate Key Press</a>  </p>\n</blockquote>\n\n\n\n<p>I need a way in C# to \"type\" <kbd>Ctrl</kbd>+<kbd>H</kbd> in code when a user clicks a button.  I am working on a Word addin that customizes the ribbon.  When a user clicks my \"Replace\" button, I want the Replace dialog to show.  I can't figure out how to get to that dialog box, but <kbd>Ctrl</kbd>+<kbd>H</kbd> brings it up.  Is there a way to do that?</p>\n"},{"tags":["c#","winforms","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13272174,"title":"ClickOnce deployed application has blinking cursor but no focus","body":"<p>We have an application deployed via ClickOnce which has a weird problem.  When you start the application and we show our login dialog the User name field will have a blinking cursor as if the control has focus but as soon as you start typing nothing happens.  You have to actually click the dialog window to give it focus.  </p>\n\n<p>If you click away again though the User name field won't have a blinking cursor anymore so it's almost like the control has focus but not really?</p>\n\n<p>Has anyone ran into this problem?  We need our app to have focus when it starts...</p>\n\n<p>One thing to mention is we're actually using a UI framework (XF.UI.Smart) which has a ShellPresenter/ShellView idea.  The shell is being hidden while the login dialog shows.  Could this hiding of the main window be the problem?</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13272056,"title":"FormatNumber for c#","body":"<p>Im struggling to get the right syntax to use in c# for the vb function FormatNumber...i will say that 'iPremium' is an object as it returns data from a tableadapter.</p>\n\n<p>the value that 'ipremium' holds is 943.4000 and the idea is to only have two decimal places after the '.', i would hope this is acheivable using the right syntax but unfortunately not being a c# expert, it could take a while to figure this out.</p>\n\n<p>here's the vb code:</p>\n\n<pre><code>  iPremium = FormatNumber(iPremium, 2, TriState.True)\n</code></pre>\n\n<p>any idea's on how this is acheivable? </p>\n\n<p>thanks for any idea's and suggestions and excuse the ignorance if this is not worded correctly</p>\n"},{"tags":["c#",".net","excel","sharepoint","pia"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1858,"score":4,"question_id":6960693,"title":"Excel process doesn't get closed","body":"<p>I know similar questions have been asked before but I still need to ask this question as I am not able to get my EXCEL (32) process closed once I am done using it.</p>\n\n<p>As you can see in the code below, once <code>ProcessRFAFData</code> function finishes its execution, the EXCEL process doesn't get closed (I can still see <code>EXCEL.EXE*32</code> in the task manager).</p>\n\n<p>For this reason, when <code>SaveErrors</code> starts its execution, I get the following exception:</p>\n\n<p><code>System.Runtime.InteropServices.COMException (0x800A03EC):<br>\nMicrosoft Office Excel cannot open or save any more documents because there is not enough available memory or disk space.<br>\n• To make more memory available, close workbooks or programs you no longer need.<br>\n• To free disk space, delete files you no longer need from the disk you are saving to.<br>\nat Microsoft.Office.Interop.Excel.Workbooks.Add(Object Template)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.&lt;&gt;c__DisplayClass9.b__6()<br>\nat Microsoft.SharePoint.SPSecurity.&lt;&gt;c__DisplayClass4.b__2()<br>\nat Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.SaveErrors()</code></p>\n\n<p>Here is the code that executes the Excel processes:</p>\n\n<pre><code>try {\n    ProcessRFAFData(FileName);\n} catch (Exception ex) {\n    Status = \"ERROR: \" + ex.ToString();\n}\n\nif (Errors.Count() &gt; 0) {\n    SaveErrors();\n}\n</code></pre>\n\n<p>Here are all the functions interacting with Excel:</p>\n\n<pre><code>private void ReleaseObject(object obj) {\n    try {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n        obj = null;\n    } catch (Exception) { } finally {\n        GC.Collect();\n    }\n}\n\nprivate void ProcessRFAFData(string FileName) {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    bool error = false;\n\n    try {\n        SPSecurity.RunWithElevatedPrivileges(delegate() {\n            XLA = new Microsoft.Office.Interop.Excel.Application();\n            XLW = XLA.Workbooks.Open(FileName, 0, true,\n                Type.Missing, null, null, true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows,\n                Type.Missing, false, false, Type.Missing, false, Type.Missing, Type.Missing);\n\n            int index = RFAFTabExists(ref XLW);\n            if (index == 0) return;\n\n            XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(index);\n\n            if (!ValidProjectID(ref XLS)) return;\n\n            ParseData(ref XLS);\n\n            XLW.Close(true, Type.Missing, Type.Missing);\n            XLA.Quit();\n\n            ReleaseObject(XLS);\n            ReleaseObject(XLW);\n            ReleaseObject(XLA);\n        });\n    } catch (SP.ServerException ex) {\n        // output error\n    } catch (Exception ex) {\n        // output error\n    }\n}\n\nprivate int RFAFTabExists(ref Microsoft.Office.Interop.Excel.Workbook XLW) {\n    int index = 0;\n    foreach (Microsoft.Office.Interop.Excel.Worksheet w in XLW.Worksheets) {\n        if (w.Name.Equals(settings.Collection[\"RFAFTabName\"])) index++;\n    }\n\n    return index;\n}\n\nprivate bool ValidProjectID(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    using (SP.ClientContext CTX = new SP.ClientContext(SiteURL)) {\n        var projectId = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n\n        var project = // getting list of projects from SharePoint\n\n        if (project.Count() &gt; 0) {\n            ProjectID = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n            return true;\n        }\n    }\n\n    return false;\n}\n\nprivate void ParseData(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    ListData.Add(\"HID\", GetHID(XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString()));\n\n    if (ListData[\"HID\"].Equals(\"0\")) Errors.Add(new ImportError {\n        Reason = \"Hub ID does not exist in this project workspace.\",\n        Reference = string.Format(\"Hub ID: {0}\", XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString())\n    });\n\n    int row = Int32.Parse(settings.Collection[\"StartRow\"]);\n    while (!NoMoreData(ref XLS, row)) {\n        string PRSIN = XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"PRSIN\"], row), Type.Missing).Text.ToString();\n\n        string NOC = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"NOC\"], row), Type.Missing).Text.ToString());\n\n        string UEIRP = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"UEIRP\"], row), Type.Missing).Text.ToString());\n\n        string LAT = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LAT\"], row), Type.Missing).Text.ToString());\n\n        string LON = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LON\"], row), Type.Missing).Text.ToString());\n\n        string PJ = GetPJ(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        string ST = GetState(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        ListItemData.Add(new ListItem {\n            ProposedRemoteSiteItemNumber = PRSIN,\n            NumberOfCarriers = NOC,\n            UsableEIRP = UEIRP,\n            Latitude = LAT,\n            Longitude = LON,\n            PrimaryJurisdiction = PJ,\n            State = ST\n        });\n\n        row++;\n    }\n}\n\nprivate bool NoMoreData(ref Microsoft.Office.Interop.Excel.Worksheet XLS, int row) {\n    return string.IsNullOrEmpty(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n        settings.Collection[\"ProposedRemoteSiteItemNumberCol\"], row), Type.Missing).Text.ToString());\n}\n\nprivate void SaveErrors() {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    object MissingValue = System.Reflection.Missing.Value;\n\n    try {\n        try {\n            SPSecurity.RunWithElevatedPrivileges(delegate() {\n                XLA = new Microsoft.Office.Interop.Excel.Application();\n                XLW = XLA.Workbooks.Add(MissingValue);\n                XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(1);\n\n                XLS.Cells[1, 1] = \"Reason for error\";\n                XLS.Cells[1, 2] = \"Reference\";\n\n                XLS.get_Range(\"A1\").Font.Bold = true;\n                XLS.get_Range(\"B1\").Font.Bold = true;\n\n                int row = 2;\n                foreach (ImportError e in Errors) {\n                    XLS.Cells[row, 1] = e.Reason;\n                    XLS.Cells[row, 2] = e.Reference;\n\n                    row++;\n                }\n\n                XLW.SaveAs(ErrorLogFileName, Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal,\n                    MissingValue, MissingValue, MissingValue, MissingValue,\n                    Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, MissingValue,\n                    MissingValue, MissingValue, MissingValue, MissingValue);\n\n                XLW.Close(true, MissingValue, MissingValue);\n                XLA.Quit();\n\n                ReleaseObject(XLS);\n                ReleaseObject(XLW);\n                ReleaseObject(XLA);\n            });\n        } catch (Exception ex) {\n            Status = \"ERROR: \" + ex.ToString();\n        }\n\n        // Uploading excel file to SharePoint document library\n\n    } catch (Exception) { }\n}\n</code></pre>\n\n<p>I would really appreciate any help you can provide me in this.</p>\n"},{"tags":["c#","windows","file-locking"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":637,"score":1,"question_id":7007671,"title":"File.Open for read access denied on executing file in Windows","body":"<p>I have a problem with file permissions on executing files in Windows that seems to be solved after following a forum tip[1], but I cannot understand why. Maybe you guys can help.</p>\n\n<p>I'm checking the banner of a file by executing it (reading the console output) and then opening the same file for reading afterwards using FileStream:</p>\n\n<pre><code>public void fileMD5(string filename) {\n  if (!File.Exists(filename)) return NT.Fail(\"File does not exist: \" + filename);\n\n  BinaryReader stream = new BinaryReader(File.Open(filename,\n      FileMode.Open, FileAccess.Read, FileShare.ReadWrite));\n  int bufferSize = 4096;\n  byte[] buffer = new byte[bufferSize];\n  int readBytes;\n  while ((readBytes = stream.Read(buffer, 0, bufferSize)) &gt; 0) {\n    md5Hasher.TransformBlock(buffer, 0, readBytes, buffer, 0);\n  }\n  stream.Close();\n}\n\nfileMD5('sample.exe');\n</code></pre>\n\n<p>and every once in a while I would get \"file is being used by another process\". From Wikipedia I know that Windows will set a lock on executing files denying write access[2], but I'm only reading. Also the process should have stopped already when I try to open it.</p>\n\n<p>From the forum post it would seem that adding a FileShare.ReadWrite would help and it seems that It does:</p>\n\n<pre><code>FileStream stream = File.Open('sample.exe', \n    FileMode.Open, FileAccess.Read, FileShare.ReadWrite);\n</code></pre>\n\n<p>But I don't understand why. Is there a race condition here that I don't see?</p>\n\n<p>Also the File.Open call seems to be much quicker with FileShare.ReadWrite instead of the default (which I guess is FileShare.Read).</p>\n\n<p>[1] <a href=\"http://www.xtremevbtalk.com/archive/index.php/t-192118.html\" rel=\"nofollow\">http://www.xtremevbtalk.com/archive/index.php/t-192118.html</a></p>\n\n<p>[2] <a href=\"http://en.wikipedia.org/wiki/File_locking#In_Microsoft_Windows\" rel=\"nofollow\">http://en.wikipedia.org/wiki/File_locking#In_Microsoft_Windows</a></p>\n"},{"tags":["c#","unity3d","gree"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":59,"score":6,"question_id":13269246,"title":"Is there something like python decorators for c#?","body":"<p>I am wrapping calls to an API and most of my methods have in their first lines:</p>\n\n<pre><code>if ( !Gree.Authorizer.IsAuthorized() )\n{\n    return;\n}\n</code></pre>\n\n<p>In python I would decorate those methods with something like <code>@login_required</code>.</p>\n\n<p>What would you use to refactor that type of logic in <code>c#</code>?</p>\n"},{"tags":["c#","wpf","storyboard","itemscontrol"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13259366,"title":"Animate height change when the DataContext of an ItemsControl changes in WPF","body":"<p>I have an <code>ItemsControl</code> that binds to its <code>DataContext</code>. When the <code>DataContext</code> changes, I want the height change of <code>ItemsControl</code> animated. I tried to specify a <code>DataContextChanged</code> event for the <code>ItemsControl</code>: </p>\n\n<pre><code>&lt;ItemsControl x:Name=\"items\" ItemsSource=\"{Binding}\" ItemTemplate=\"{StaticResource LocationTemplate}\" DataContextChanged=\"Items_DataContextChanged\"&gt;\n</code></pre>\n\n<p>And in the handler, I tried to create a <code>DoubleAnimation</code> for height. However, I don't know how to specify <code>From</code> and <code>To</code> properties. Anyone can help? Thanks!</p>\n"},{"tags":["c#","algorithm","google-maps","google","google-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13249778,"title":"Google algorithm for text on broken lines","body":"<p>I wonder what kind of algorithm <code>Google</code> uses to show up text (like streets/rivers names etc.) on the map? Especially I want to know how they render the strings that they are folded (e.g. <code>N Cahuenga Blvd</code>).</p>\n\n<p>I tried to have a look at <code>Google API</code>, but I couldn't find anything useful... :(</p>\n\n<p><img src=\"http://i.stack.imgur.com/n1BLT.png\" alt=\"Example\"></p>\n"},{"tags":["c#","asp.net","cookies","webforms","asp.net-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13058574,"title":"Check if Cookie Exists","body":"<p>From a quick search on <em>Stack Overflow</em> I saw people suggesting the following way of checking if a cookie exists:</p>\n\n<pre><code>HttpContext.Current.Response.Cookies[\"cookie_name\"] != null\n</code></pre>\n\n<p>or (inside a <code>Page</code> class):</p>\n\n<pre><code>this.Response.Cookies[\"cookie_name\"] != null\n</code></pre>\n\n<p>However, when I try to use the indexer (or the Cookies.Get method) to retrieve a cookie that does not exist it seems to actually <strong>create</strong> a 'default' cookie with that name and return that, thus no matter what cookie name I use it never returns null. (and even worse - creates an unwanted cookie)</p>\n\n<p>Am I doing something wrong here, or is there a different way of simply checking for the existance of a specific cookie by name?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":9,"view_count":48,"score":-8,"question_id":13272205,"title":"using GUI based c#","body":"<p>using a form1 in GUI based c# how can i create two circle and fill color in them such that if i take the mouse cursor on form1 client area and click on them then the color of the circle  will change simultaneously.</p>\n"},{"tags":["c#","reflection","copy"],"answer_count":5,"favorite_count":8,"up_vote_count":15,"down_vote_count":0,"view_count":15627,"score":15,"question_id":1198886,"title":"C# Using Reflection to copy base class properties","body":"<p>I would like to update all properties from MyObject to another using Reflection. The problem I am coming into is that the particular object is inherited from a base class and those base class property values are not updated.</p>\n\n<p>The below code copies over top level property values.</p>\n\n<pre><code>public void Update(MyObject o)\n{\n    MyObject copyObject = ...\n\n    FieldInfo[] myObjectFields = o.GetType().GetFields(\n    BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance);\n\n    foreach (FieldInfo fi in myObjectFields)\n    {\n        fi.SetValue(copyObject, fi.GetValue(o));\n    }\n}\n</code></pre>\n\n<p>I was looking to see if there were any more BindingFlags attributes I could use to help but to no avail.</p>\n"},{"tags":["c#","algorithm"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":138,"score":3,"question_id":13270865,"title":"convert string \"172406\" to integers 17, 24, 06 fast","body":"<p>I need to convert fast the string in format \"HHmmss\" to DateTime or integers. I've tested such code:</p>\n\n<pre><code>Console.WriteLine(\"decoding \" + text);\nlong microseconds = sw.ElapsedTicks / (Stopwatch.Frequency / (1000L * 1000L));\nConsole.WriteLine(\"start time \" + microseconds);\nfield = DateTime.ParseExact(text, \"HHmmss\", null);\nmicroseconds = sw.ElapsedTicks / (Stopwatch.Frequency / (1000L * 1000L));\nConsole.WriteLine(\"finish time \" + microseconds);\n</code></pre>\n\n<p>and the output is</p>\n\n<pre>\ndecoding 172400\nstart time 121\nfinish time 244\n\ndecoding 172400\nstart time 236\nfinish time 383\n\ndecoding 172400\nstart time 116\nfinish time 416\n\ndecoding 172400\nstart time 235\nfinish time 421\n\ndecoding 172359\nstart time 149\nfinish time 323\n</pre>\n\n<p>so in average about 150 microseconds. What's a lot of time, i'm writing HFT software and the best HFT has in average 10 microseconds \"tick-to-trade\" time (this includes everything!). I understand that using c# this is imposible however i still think that 150 microseconds is too much even using c#.</p>\n\n<p>Now I want to use another algorithm, however I don't know how to \"extract\" integers from the text:</p>\n\n<pre><code>field = new DateTime(DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day, /*extract hour, min, sec from text*/)\n</code></pre>\n\n<p>What can you suggest and what would be the fastest way?\nPlease do not ask why I'm care about perfomance instead just suggest how to do that faster.</p>\n\n<p><strong>Results:</strong></p>\n\n<p>Using <code>DateTime.ParseExact(text, \"HHmmss\", null)</code> about 6-8 ticks</p>\n\n<p>Using <code>TimeSpan ts = TimeSpan.ParseExact(text, \"hhmmss\", null);</code> about 3-4 ticks</p>\n\n<p>Using <code>int hour = 10 * text[0] + text[1] - 11 * '0';</code>... about 0 ticks</p>\n\n<p>Acutally much less than 0 ticks if using loop for measurements. Actually it was found that last version is 100 times faster than other.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>    long startMicroseconds = sw.ElapsedTicks /*/ (Stopwatch.Frequency / (1000L * 1000L))*/;\n\n    //TimeSpan ts = TimeSpan.ParseExact(text, \"hhmmss\", null);\n\n    //int hour = 10 * text[0] + text[1] - 11 * '0';\n    //int minute = 10 * text[2] + text[3] - 11 * '0';\n    //int second = 10 * text[4] + text[5] - 11 * '0';\n\n    field = DateTime.ParseExact(text, \"HHmmss\", null);\n\n    long finishMicroseconds = sw.ElapsedTicks /*/ (Stopwatch.Frequency / (1000L * 1000L))*/;\n    Console.WriteLine(\"elappsed \" + (finishMicroseconds - startMicroseconds));\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":159,"score":0,"question_id":12039379,"title":"“does not contain a definition for ...and no extension method ...accepting a first argument for type error","body":"<p>I've got the following error:</p>\n\n<pre><code>'DirectActivity' does not contain a definition for 'ddl_jobcode_Id2' and no extension method 'ddl_jobcode_Id2' accepting a first argument of type 'DirectActivity' could be found (are you missing a using directive or an assembly reference?)\n</code></pre>\n\n<p>In my aspx, I created a DropDownList like this:</p>\n\n<pre><code>&lt;asp:DropDownList ID=\"ddl_jobcode_Id2\" runat=\"server\" DataSourceID=\"ddl_ActivityType2\"\n                            DataTextField=\"jobCode\" DataValueField=\"ID\" SelectedValue='&lt;%# Bind(\"jobCode_ID2\", \"{0}\") %&gt;'\n                            OnDataBound=\"ddl_jobcode_Id2_DataBound\" \n                            onselectedindexchanged=\"ddl_jobcode_Id2_SelectedIndexChanged1\" \n                            AutoPostBack=\"True\"&gt;\n                        &lt;/asp:DropDownList&gt;\n</code></pre>\n\n<p>I need to add a control so that in the .cs file I worte </p>\n\n<pre><code>protected void ddl_jobcode_Id2_SelectedIndexChanged1(object sender, EventArgs e)\n{\n    if(this.ddl_jobcode_Id2.SelectedValue == \"19\" )\n     {  ...}}\n</code></pre>\n\n<p>and it just shows this error on <code>ddl_jobcode_Id2</code></p>\n\n<p>could anyone help me please? many thanks!!!</p>\n"},{"tags":["c#","asp.net","facebook-connect"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2986,"score":0,"question_id":2094946,"title":"Example of ASP.NET/C# using Facebook Connect Toolkit 3.0","body":"<p>Are there any examples of fully functioning code with C# and Facebook Connect with version 3.0 of the toolkit?</p>\n\n<p><strong>NOTE:</strong> I am specifically interested in version 3.0 of the toolkit. There are plenty of 2.0 examples out there but the 3.0 toolkit deprecates many of the 2.0 objects which makes these examples useless. I am <strong>ONLY</strong> interested in examples with 3.0</p>\n"},{"tags":["c#","asp.net","datagrid","grid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13269839,"title":"retrieve data by clicking on a gridview cell in asp.net using c#","body":"<p>I have a gridview </p>\n\n<pre><code>&lt;asp:GridView ID=\"wbsdataGV1\" runat=\"server\" Width=\"790px\" AutoGenerateColumns=\"False\"\n                                    OnSelectedIndexChanged=\"wbsdataGV1_SelectionChanged\" DataKeyNames=\"WBSCode\"&gt;\n                                    &lt;Columns&gt;\n\n                                        &lt;asp:TemplateField HeaderText=\"WBS Code\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" Text='&lt;%# Eval(\"WBSCode\") %&gt;'&gt;&lt;/asp:LinkButton&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Description\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:TextBox ID=\"TextBox40\" runat=\"server\" Text='&lt;%# Eval(\"Description\") %&gt;' ReadOnly=\"true\"\n                                                    Width=\"300px\"&gt;&lt;/asp:TextBox&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"300px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Territory Code\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:Label ID=\"Label45\" runat=\"server\" Text='&lt;%# Eval(\"TerritoryCode\") %&gt;'&gt;&lt;/asp:Label&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                        &lt;asp:TemplateField HeaderText=\"Amount\"&gt;\n                                            &lt;ItemTemplate&gt;\n                                                &lt;asp:Label ID=\"Label46\" runat=\"server\" Text='&lt;%# Eval(\"AmountReleased\") %&gt;'&gt;&lt;/asp:Label&gt;\n                                            &lt;/ItemTemplate&gt;\n                                            &lt;ControlStyle Width=\"100px\" /&gt;\n                                            &lt;ItemStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                        &lt;/asp:TemplateField&gt;\n                                    &lt;/Columns&gt;\n                                    &lt;HeaderStyle BackColor=\"Wheat\" BorderStyle=\"Solid\" BorderWidth=\"1px\" /&gt;\n                                    &lt;RowStyle BorderStyle=\"Solid\" BorderWidth=\"1px\" HorizontalAlign=\"Center\" /&gt;\n                                &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>now in the link button i want to click it and retrieve that row's data in the same page and show it...</p>\n\n<p>i am using </p>\n\n<pre><code>protected void wbsdataGV1_SelectionChanged(object sender, EventArgs e)\n{\n    string rowID = (string)this.wbsdataGV1.SelectedDataKey.Value;\n    con.Open();\n    SqlCommand cmd = new SqlCommand(\" select WBSCode,Description,TerritoryCode,AmountReleased from WBS where WBSCode='\"+rowID+\"'\");\n    cmd.Connection = con;\n    SqlDataAdapter da = new SqlDataAdapter(cmd);\n    DataTable dt = new DataTable();\n    da.Fill(dt);\n    if (dt.Rows.Count &gt; 0)\n    {\n        wbssearchdata1.DataSource = dt;\n        wbssearchdata1.DataBind();\n    }\n\n    con.Close();\n}\n</code></pre>\n\n<p>this code but its not firing on the click .. so how can i solve this.. any help? </p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":13270938,"title":"how to write this LINQ query of 3 tables?","body":"<ul>\n<li><p>Table1 CAR (CARID, CarModelID ,CARuniqueinfo1, CARUniqueinfo2): contians all cars have been entered to the warehouse.</p></li>\n<li><p>Table2 CarModel (CarModelID ,Modelinfo1 ,Modelinfo2 ) </p></li>\n<li><p>Table3 Sale (SaleID, CarID, clientID, EmpID) </p></li>\n</ul>\n\n<p>What is the Linq Query that returns :</p>\n\n<p>number of sold cars only for ModelID=101</p>\n\n<pre><code>DataClassesDataContext db = new DataClassesDataContext(); \n</code></pre>\n"},{"tags":["c#","asp.net","listview","viewstate","objectdatasource"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13269937,"title":"Sorting a ListView using an ObjectDataSource with a LinkButton and ViewState","body":"<p>I am using a ListView to display paginated data:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;asp:ListView ID=\"listOfItems\" runat=\"server\" DataSourceID=\"ItemsDataSource\" EnableModelValidation=\"True\" InsertItemPosition=\"FirstItem\" ItemPlaceholderID=\"ItemRowContainer\"&gt;\n    &lt;LayoutTemplate&gt;\n        &lt;div class=\"tablecontainer\"&gt;\n            &lt;div class=\"pagination-top\"&gt;\n                &lt;custom:TablePaginationControl ID=\"TablePaginationControl1\" runat=\"server\" ControlID=\"listOfItems\" ShowPageSizeList=\"true\" /&gt;\n            &lt;/div&gt;\n            &lt;table class=\"list-view\"&gt;\n                &lt;tr&gt;\n                    &lt;th class=\"first-column\" width=\"350px\"&gt;\n                        &lt;asp:LinkButton ID=\"SortByName\" runat=\"server\" CommandArgument=\"Name\" CommandName=\"SortMainList\" OnCommand=\"SortItems\" Text=\"&lt;%$ Resources:Name %&gt;\"&gt;&lt;/asp:LinkButton&gt;\n                    &lt;/th&gt;\n                    ...\n                &lt;/tr&gt;\n                &lt;tbody&gt;\n                    &lt;tr runat=\"server\" id=\"ItemRowContainer\" /&gt;\n                &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n    &lt;/LayoutTemplate&gt;\n    ...\n&lt;/asp:ListView&gt;\n</code></pre>\n\n<p>The datasource definition:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;asp:ObjectDataSource ID=\"ItemsDataSource\" runat=\"server\" EnablePaging=\"True\" InsertMethod=\"AddItems\" SelectCountMethod=\"SelectItemsCount\" SelectMethod=\"SelectItems\" TypeName=\"SHLCentral.TheLibrary.Web.View.DocumentManagementControl, ClientPortal.Web, Version=1.0.0.0, Culture=neutral, PublicKeyToken=cd2852a10d692fb9\" UpdateMethod=\"UpdateItems\"&gt;\n    ...\n&lt;/asp:ObjectDataSource&gt;\n</code></pre>\n\n<p>The revelant code behind is made of these two methods:</p>\n\n<pre><code>public IEnumerable&lt;ListDocumentsResult&gt; SelectItems(\n    int maximumRows,\n    int startRowIndex)\n{\n    var results = Controller.ListDocuments(new ListDocumentsRequest());\n\n    PropertyInfo sortProperty;\n    try\n    {\n        sortProperty = typeof (ListDocumentsResult).GetProperty((string) ViewState[\"mainListSortColumn\"]);\n    }\n    catch\n    {\n        sortProperty = null;\n    }\n    Func&lt;ListDocumentsResult, object&gt; sortFunction = sortProperty == null\n                            ? (Func&lt;ListDocumentsResult, object&gt;) (ldr =&gt; ldr.LastUpdatedDate)\n                            : (ldr =&gt; sortProperty.GetValue(ldr, new object[0]));\n\n    return\n        (sortProperty == null || !((bool) ViewState[\"mainListSortAsc\"])\n             ? results.OrderByDescending(sortFunction)\n             : results.OrderBy(sortFunction))\n            .Skip(startRowIndex)\n            .Take(maximumRows);\n}\n\nprotected void SortItems(object sender, CommandEventArgs e)\n{\n    if (e.CommandName == \"SortMainList\")\n    {\n        var sortColumn = (string) e.CommandArgument;\n        if ((string)ViewState[\"mainListSortColumn\"] == sortColumn)\n        {\n            ViewState[\"mainListSortAsc\"] = !(bool)ViewState[\"mainListSortAsc\"];\n        }\n        else\n        {\n            ViewState[\"mainListSortAsc\"] = true;\n            ViewState[\"mainListSortColumn\"] = sortColumn;\n        }\n        DataBind();\n    }\n}\n</code></pre>\n\n<p>So my intention this: when the users clicks on the <code>LinkButton</code> contained in the \"Name\" column header (I left out all but one column for clarity), the <code>SortItems</code> method is called: it sets the sorted column name and sort order into the <code>ViewState</code>, then reloads the <code>ListView</code> using the <code>DataBind</code> method. In the Select method of the <code>ObjectDataSource</code>, we read this <code>ViewState</code> values and use them to order the data.</p>\n\n<p>Putting breakpoints on all these methods, I can see there is this sequence of calls when I click the <code>LinkButton</code>:</p>\n\n<ul>\n<li><code>OnLoad</code></li>\n<li><code>SortItems</code></li>\n<li><code>SelectItems</code></li>\n</ul>\n\n<p>The problem I have is that when I get to the <code>SelectItems</code> method, the <code>ViewState</code> is totally empty (it has 0 keys): if I set a breakpoint on the Load method of the page, I see the control containing all this is only loaded once. The <code>DataBind</code> method does not seem to trigger any loading of the control, it seems to be just triggering the <code>SelectItems</code> method of a new instance of the control (meaning that if, instead of using <code>ViewState</code>, I set an instance field in the <code>SortItems</code> method, the field is null when getting in the <code>SelectItems</code> method).</p>\n\n<p>I am sure that the <code>ViewState</code> is active on the page (I can find the <code>ViewState</code> keys on the browser side using a Firefox extension for instance).</p>\n\n<p>There is something not quite clear to me about the life cycle of the page/control. Could someone explain what it is to me?</p>\n"},{"tags":["c#","reflection","intellisense"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":395,"score":4,"question_id":9086136,"title":"How to hide public methods from intellisense","body":"<p>I want to hide public methods from the intellisense member list.  I have created an attribute that when applied to a method will cause the method to be called when its object is constructed.  I've done this to better support partial classes.  The problem is that in some environments (such as Silverlight), reflection cannot access private members even those of child classes.  This is a problem since all of the work is done in a base class. I have to make these methods public, but I want them to be hidden from intellisense, similar to how the <code>Obsolete</code> attribute works.  Frankly, because I am anal about object encapsulation. I've tried different things, but nothing has actually worked.  The method still show up in the member drop-down.</p>\n\n<p><strong>How do I keep public methods from showing up in intellisense when I don't want them to be called by clients?</strong> How's that for a <em>real</em> question, Philistines! This can also apply to MEF properties that have to be public though sometimes you want to hide them from clients.</p>\n"},{"tags":["c#","java","php","website","interop"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":78,"score":4,"question_id":13271772,"title":"How does PHP website communicate with Java and C# programs efficiently","body":"<p>I have a website written in PHP, the website accepts code snippets written in different programming languages (Java and C#) and perform some static analysis and returns the results to the user. I already wrote different analyzers for Java and C# respectively. The Java analyzer is written in Java; the C# analyzer is written in C#. </p>\n\n<p>My problem is how the PHP website can communicate with those analyzers written in different languages in an efficient way. That is: when the PHP website receives some Java code, it can invokes the Java analyzer, etc. I can of course use PHP’s exec to launch the analyzer process, but that is too slow.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13268634,"title":"Web data scrapper without httpwebrequest in .net","body":"<p>In .net there are some .net classes which uses IE component.By them we can read htmldom and do login and data scrapping.\nKindly can any body give me the name of those classes /assemblies where it is present.I myself used it to login and data scrapping quite a way back</p>\n"},{"tags":["c#","wpf","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1922,"score":2,"question_id":4348408,"title":"how to close window form which is hosting WPF user control from within a WPF user control","body":"<p>I want to close a window form that is hosting a WPF user control. Something like this as used while closing a current form in window application. But for WPF application I am not able to get reference to user controls parent</p>\n\n<p>How to get Form which is hosting this control so that I can close my form</p>\n\n<p>this.Close()</p>\n"},{"tags":["c#","jquery","asp.net","dialog","popup"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13270236,"title":"Show a confirmation/dialogbox in asp.net(c#)","body":"<p>Functionality I need to achieve is: \nConfirmbutton_Click</p>\n\n<p>Show a popup/dialogbox:</p>\n\n<p>On click of Yes, I need to validate Email-Id and other personal details submitted.\n    If validation fails, show error messages and return false.\n    If email-id and other details are correct, then hide/show few Divs.</p>\n\n<p>I had achieved this functionality in jQuery but now I am supposed to do it in server side. Firstly because the Divs were not showing up each time correctly and secondly due to security concern.  </p>\n\n<p>The suggestions I got on googling ask to write complete code (in script tag) at server side. That would be too much as I need to validate many fields.<br>\nAlso, is there a way I can just do the validations at client side and come back to server side and show my Divs depending upon the validation result ? The client script will be executed before server side, so it is achievable.</p>\n\n<p>I don't want to create a new popup page for this.</p>\n\n<p>If anyone could help me with correct code or pointers to one, how to validate and show divs(showing div to be done from server side).</p>\n\n<h2>UPDATED:</h2>\n\n<p>I am midway, if anyone could help me any:</p>\n\n<p>In page load(not post back) I hv added:</p>\n\n<pre><code>btnConfirm.Attributes.Add(\"onclick\", \"if(confirm('Confirm - Are you sure you want to go ahead.')) onConfirm(); else return false;\");\n</code></pre>\n\n<p>In jQuery code i have added validations as:</p>\n\n<pre><code>function onConfirm() {    \n    //Check if email-id is not blank, else show message and return to the page\n    if (isBlank($('#emailAddress').val()) == false) {\n        $('#errorBlankEmail').show();\n        return false;\n    }\n}\n    //Text validation functions\n    function isBlank(valueSent) {\n        if ($.trim(valueSent) == \"\")\n            return false;\n        else\n            return true;\n}\n</code></pre>\n\n<p>and the button code as: </p>\n\n<pre><code>&lt;asp:Button ID=\"btnConfirm\" runat=\"server\"   Text=\"Confirm\"  onclick=\"Confirm_Click\" /&gt;\n</code></pre>\n\n<p>And the server side code for this:</p>\n\n<pre><code>protected void Confirm_Click(object sender, EventArgs e)\n    {\n        divConfirm.Visible = true;\n    }\n</code></pre>\n\n<p>Now when I click on button, it works until I validate and validation fails, it executes the server side code. Is there a way where I can avoid the server-side code if result is false in client click code ?</p>\n"},{"tags":["c#","xsd","jaxb","xml-schema"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13246810,"title":"Does the Xml Schema spec define the serialization of optional attributes with a default?","body":"<p>Firstly, the Xml Schema spec <em>does</em> specify the <strong>parsing</strong> of an <code>optional attribute with a default value</code>: if such an attribute is absent in an xml document, then when parsed with the XSD, they appear to be present, and having that default value.</p>\n\n<p>Secondly, some tools apply this idea to <strong>serialization</strong>, so that attributes with default values are omitted (in other words: given <code>an optional attribute with a default value</code>, when an attribute has that value, it is omitted).</p>\n\n<p>However, as far as I can tell, this serialization behaviour is <strong>not specified</strong> in the Xml Schema. But it's a complex spec, and maybe I missed it - does the spec define serialization of <code>optional attribute with a default value</code>?</p>\n\n<hr>\n\n<p>If not, maybe it has become a <em>de facto</em> standard - do many tools implement this behaviour?  I've seen that Microsoft and MarkLogic do it:</p>\n\n<ul>\n<li>C# <a href=\"http://stackoverflow.com/questions/3411542/xml-serialization-of-the-default-values-of-optional-attributes\">XML Serialization of the default values of optional attributes</a></li>\n<li>\".net\" (in general?) <a href=\"http://stackoverflow.com/questions/11857274/including-xml-attribute-when-the-value-is-the-same-as-the-default\">Including xml attribute when the value is the same as the default</a></li>\n<li>marklogic <a href=\"http://stackoverflow.com/questions/13143530/default-schema-values-in-marklogic\">Default Schema Values in MarkLogic</a></li>\n</ul>\n\n<p>But not JAXB:</p>\n\n<ul>\n<li><strong>not</strong> JAXB <a href=\"http://stackoverflow.com/questions/8885011/jaxb-avoid-saving-default-values\">JAXB Avoid saving default values</a></li>\n</ul>\n\n<hr>\n\n<p>Finally, - and perhaps here I teeter on the precipice of subjectivity - what <strong>should</strong> be the behaviour?</p>\n\n<p>Omitting attributes with default values reduces clutter, especially if the default value is expected and common. e.g. <code>minOccurs</code> and <code>maxOccurs</code> default to <code>1</code> in an XSD itself - if you've been processing an XSD, and then serialize the result, having them suddenly appear on every <code>&lt;element&gt;</code>, <code>&lt;sequence&gt;</code>, <code>&lt;choice&gt;</code> etc makes it less readable.</p>\n\n<p>OTOH, in objects and data structures, if there is a default value, we expect it to be there if we look at it.  Therefore, it can be surprising when an attribute that has a default value is omitted - as the above SO questions show.</p>\n\n<p>I think it might depend on whether you consider the result to be data, or a representation of data.  With a representation, it can be very convenient to modify it to make it more readable.  But with data, you expect it to exactly <em>be</em> the data. Thoughts?</p>\n"},{"tags":["c#","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13271981,"title":"How do i capture incomming and out going xml when call web service","body":"<p>i am calling a third part web service from window application. i just tried to capture xml response &amp; request generated by that web service when we call but fail. search google and found lots of article and follow their instruction and code nothing works.</p>\n\n<p>as a sample i follow this instruction from this url \n<a href=\"http://knowledgecenter.zuora.com/kb/How_do_I_capture_the_SOAP_API_Request_and_Response%3F\" rel=\"nofollow\">http://knowledgecenter.zuora.com/kb/How_do_I_capture_the_SOAP_API_Request_and_Response%3F</a>\nhttp://msdn.microsoft.com/en-us/library/ms179346.aspx</p>\n\n<p>can anyone tell me any easy way out to capture incomming and out going xml when call &amp; work with web service. looking for help.</p>\n"},{"tags":["c#","winforms","datagridview","telerik"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":13259013,"title":"Compare 2 different columns in the datagridview","body":"<p>In my datagridview, Four columns <code>1&amp;2</code> are read only col <code>3</code> &amp; <code>4</code> got number values. I want to compare that <code>4th</code> col must be greater that <code>3rd</code> column. \nFor example: \n<img src=\"http://i.stack.imgur.com/7fpSh.jpg\" alt=\"enter image description here\"></p>\n\n<p>If the <code>4</code> col value is less than the 3rd column then I want to propose message doesn't navigate to another control. </p>\n\n<p>My simple approach seems not working. How can i compare 2 specific columns for this kind of condition??</p>\n\n<pre><code>    private void datagridview_CellValidating(object sender, CellValidatingEventArgs e)\n    {\n        try\n        {\n\n            int bbor = datagridview.CurrentCell.ColumnIndex;\n            int ebor = datagridview.CurrentCell.RowIndex;\n            if (ebor &lt;= bbor)\n            {\n                MessageBox.Show(\"Please verify the value\");\n                e.Cancel = true;\n            }\n        }\n        catch (Exception exception)\n        {\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","web-services","ews","exchange-server","exchangewebservices"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13270962,"title":"Simulate ExchangeServer web service","body":"<p>As you already know, Win7 Outlook can connect to ExchangeServer. \n<a href=\"http://www.washington.edu/itconnect/wares/uwexchange/outlook2010.html\" rel=\"nofollow\">http://www.washington.edu/itconnect/wares/uwexchange/outlook2010.html</a></p>\n\n<p>I want to develop server app in C#, to which Outlook will be able to connect too.\nAll in order to sync my server data (contacts, calendar, tasks, etc.) with Outlook.</p>\n\n<p>What I know is that ExchangeServer use EWS for client communication.\nCan I develop web service based on EWS Managed API to communicate/sync with Outlook ?</p>\n\n<p>If cannot, what are the other options(managed or unmanaged code) ?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13270700,"title":"how to move auto generated columns to left side?","body":"<p>i  have gridview and i am adding rows at runtime using datatable as datasource.but i want to add delete command field to grid view.I add it and run it.But i got delete button at left position.I want to change that delete button to last of gridview.Means after autogenerated columns.Please help me.Thanks in advance</p>\n"},{"tags":["c#","ajax","asp.net-mvc","asp.net-web-api"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13271804,"title":"ASP.net WebAPI return a file through ajax call","body":"<p>I am currently looking for a way to force a download of a file which is returned through a WebAPI controller.</p>\n\n<p>I was using <a href=\"http://www.shawnmclean.com/blog/2012/04/force-download-of-file-from-asp-net-webapi/\" rel=\"nofollow\">http://www.shawnmclean.com/blog/2012/04/force-download-of-file-from-asp-net-webapi/</a> as a reference.</p>\n\n<p>On my client I am using an ajax GET call to send up an ID of an object and try to download the file</p>\n\n<pre><code>    exportList: (foo, callback) =&gt;\n        path = '/api/export/id'\n        path = path.replace(\"id\", foo.id)\n        $.ajax(\n            url: path,\n            dataType: 'text',\n            success: (data) =&gt;\n                callback(data)\n            error: (data) =&gt;\n                callback(false)\n        )\n</code></pre>\n\n<p>On the server-side, I have the above URI routed to the method below</p>\n\n<pre><code>    [AcceptVerbs(\"GET\")]\n    public HttpResponseMessage ExportList(int id)\n    {\n        string file = fooService.ExportList(id);\n\n        if (file == null)\n        {\n            return Request.CreateResponse(HttpStatusCode.NoContent);\n        }\n        HttpResponseMessage result = new HttpResponseMessage(HttpStatusCode.OK);\n        result.Content = new StringContent(file);\n        result.Content.Headers.ContentType = new MediaTypeHeaderValue(\"application/octet-stream\");\n        result.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue(\"attachment\");\n        result.Content.Headers.ContentDisposition.FileName = \"List.csv\";\n\n        return result;\n    }\n</code></pre>\n\n<p>The fooService.ExportList method simply creates a csv string. </p>\n\n<p>When watching the request come back to the client, the response does have the csv string in it, but the client is not prompted or forced to download it.  </p>\n\n<p>Is this the correct way to go about this?</p>\n"},{"tags":["c#","visual-studio","oracle11g","odp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13270315,"title":"Accessing oracle database from c# with odb.net","body":"<p>I'm trying to access Oracle 11g DB.\nAccording to connectionstring.com , the connstring should be :</p>\n\n<pre><code>Driver={Oracle in OraClient11g_home1};Dbq=myTNSServiceName;Uid=user;Pwd=passwd;\n</code></pre>\n\n<p>Anyhow I'm getting an ArgumentException:  'Driver' is not a valid word.</p>\n\n<p>Thank you.</p>\n\n<p>Greetings</p>\n\n<p>R. Bada</p>\n"},{"tags":["c#","dll","access-specifier"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13270414,"title":"Inconsistent accessibility: base class is less accessible than class","body":"<p>So I have an abstract base class in a DLL and child classes of that class. I want the childs to be public, but the base to be private so that it cannot be accessed outside of the dll.</p>\n\n<p>How do I do that?</p>\n"},{"tags":["c#","pixelsense"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13271913,"title":"SurfaceInkCanvas scales strokes when painting out of bounds","body":"<p>I have a <code>ScatterView</code> that contains an image over which I should be able to draw.</p>\n\n<pre><code>&lt;s:ScatterView HorizontalAlignment=\"Center\" Margin=\"0,0,0,0\" Name=\"desk\" VerticalAlignment=\"Center\"&gt;\n    &lt;s:ScatterViewItem Width=\"200\" Height=\"200\"&gt;\n        &lt;Grid&gt;\n            &lt;Image Name=\"img1\" Source=\"/Resources/Desert.jpg\"/&gt;\n            &lt;Viewbox&gt;\n                &lt;s:SurfaceInkCanvas Name=\"cvs1\"/&gt;\n            &lt;/Viewbox&gt;\n        &lt;/Grid&gt;\n    &lt;/s:ScatterViewItem&gt;\n&lt;/s:ScatterView&gt;\n</code></pre>\n\n<p>I noticed that whenever I draw an ink trail towards the border of the image, the previous strokes scale down. I do not want this to happen. How can I change this behavior?</p>\n"},{"tags":["c#","javascript","asp.net","json","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13271369,"title":"Convert JSON to XML","body":"<p>I know this has been asked many many times.</p>\n\n<p>But honestly with so many tries, the solutions are not working for me.</p>\n\n<p>As I am working in <strong>ASP.Net 1.1</strong>, so can not handle this .net level.</p>\n\n<p>So I went ahead a tried many solution i.e <strong>using javascript library, jquery library</strong> to do this.</p>\n\n<p>Some tool are converting, but appending <strong>&lt;0>, &lt;1> &lt;2></strong> and so on..Which while doing LoadXml is throwing format error.</p>\n\n<p>I need a simple function or a good library which can convert a JSON object to XML.</p>\n\n<p>Please suggest if there are any.</p>\n\n<p>I have tried these to name a few :</p>\n\n<p><a href=\"http://code.google.com/p/x2js/\" rel=\"nofollow\">This gave me the xml having &lt;0>, &lt;1> ,&lt;2> sort of tags.</a></p>\n\n<p><a href=\"http://ruchirawageesha.blogspot.in/2011/06/xml-to-json-and-json-to-xml-conversion.html\" rel=\"nofollow\">This Did not work at all.</a> </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have deleted the middle JSON and XML data as it was huge :</p>\n\n<p>JSON</p>\n\n<pre><code>\"{\\\"CrashTestResult\\\":[[\\\"Crash Test Note\\\",\\\"Results based on a 35 MPH frontal crash and 38.5 MPH side crash.  Results are reported in a range of one to five stars, with five stars indicating the best crash protection for vehicles within \\\\\"TIRES, P265/70R17 ALL-SEASON, BLACKWALL\\\",\\\"$0.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ON-/OFF-ROAD, WHITE OUTLINED-LETTER\\\",\\\"$125.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ON-/OFF-ROAD, BLACKWALL\\\",\\\"$150.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P265/70R17 ALL-SEASON, WHITE OUTLINED-LETTER\\\",\\\"$125.00\\\"],[\\\"TIRES\\\",\\\"TIRES, P275/55R20 ALL-SEASON, BLACKWALL\\\",\\\"$0.00\\\"],[\\\"Drivetrain Years\\\",\\\"5\\\"],[\\\"Roadside Assistance Miles/km\\\",\\\"100,000\\\"],[\\\"Roadside Assistance Years\\\",\\\"5\\\"]],\\\"Wheel\\\":[\\\"WHEELS, 4 - 17\\\\\\\" X 7.5\\\\\\\" (43.2 CM X 19.1 CM) ALUMINUM, 5-SPOKE\\\",\\\"WHEELS, 4 - 17\\\\\\\" X 7.5\\\\\\\" (43.2 CM X 19.1 CM) ALUMINUM, 5-SPOKE\\\",\\\"WHEELS, 4 - 20\\\\\\\" X 8.5\\\\\\\" (50.8 CM X 21.6 CM) PAINTED ALUMINUM\\\"]}\"\n</code></pre>\n\n<p>Want XML like </p>\n\n<pre><code>\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?&gt;\\r\\n&lt;VINDescription xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\\r\\n  &lt;CrashTestResult xmlns=\\\"http://autoexact.com/VINDecoder/\\\"&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Crash Test Note&lt;/string&gt;\\r\\n      &lt;string&gt;Results based on a 35 MPH frontal crash and 38.5 MPH side crash.  Results are reported in a range of one to five stars, with five stars indicating the best crash protection for vehicles within the same weight class.  This test used driver and passenger belts and airbags.&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Frontal Driver&lt;/string&gt;\\r\\n      &lt;string&gt;* * * *&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Frontal Passenger&lt;/string&gt;\\r\\n      &lt;string&gt;* * * *&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n&lt;string&gt;$2,755.00&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;CPOS PKG&lt;/string&gt;\\r\\n      &lt;string&gt;28F CUSTOMER PREmas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Basic Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;36,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Basic Years&lt;/string&gt;\\r\\n      &lt;string&gt;3&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Corrosion Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;100,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Corrosion Years&lt;/string&gt;\\r\\n      &lt;string&gt;5&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Miles/km&lt;/string&gt;\\r\\n      &lt;string&gt;36,000&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Note&lt;/string&gt;\\r\\n      &lt;string&gt;Unlimited Years/Unlimited Miles for vehicles sold after 07/26/2007&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n    &lt;ArrayOfstring xmlns=\\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\\"&gt;\\r\\n      &lt;string&gt;Drivetrain Years&lt;/string&gt;\\r\\n      &lt;string&gt;3&lt;/string&gt;\\r\\n    &lt;/ArrayOfstring&gt;\\r\\n  &lt;/Warranty&gt;\\r\\n  &lt;Wheel xmlns=\\\"http://autoexact.com/VINDecoder/\\\" /&gt;\\r\\n&lt;/VINDescription&gt;\"\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13271858,"title":"Can't see class within DLL","body":"<p>I have created a DLL to house a class that I want to use across multiple applications, as well the DBML created by LINQ.</p>\n\n<p>The problem I am having is that the class is not visible/usable from external applications when the compiled DLL is set as a reference, although all the LINQ objects are. Also, when I manually import the .cs file then I can use the class as expected.</p>\n\n<p>I have built the class as static, and the code is as follows:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nusing System.ComponentModel;\nusing System.Data;\n\nnamespace OsgShared\n{\n    static class GlobalClass\n    {\n        public static USER CurrentUser { get; set; }\n\n        private static Dictionary&lt;string,int&gt; _SysDetIDs;\n        public static Dictionary&lt;string,int&gt; SysDetIDs { get { return _SysDetIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccInfoTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccInfoTypeIDs { get { return _AccInfoTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _AccGroupTypeIDs;\n        public static Dictionary&lt;string, int&gt; AccGroupTypeIDs { get { return _AccGroupTypeIDs; } }\n\n        private static Dictionary&lt;string, int&gt; _EntTypeIDs;\n        public static Dictionary&lt;string, int&gt; EntTypeIDs { get { return _EntTypeIDs; } }\n\n        /// &lt;summary&gt;\n        /// Populates Dictionary objects containing database reference data\n        /// &lt;/summary&gt;\n        public static void PopulateDictionaries()\n        {\n            _SysDetIDs = new Dictionary&lt;string,int&gt;();\n            _AccInfoTypeIDs = new Dictionary&lt;string,int&gt;();\n            _AccGroupTypeIDs = new Dictionary&lt;string,int&gt;();\n            _EntTypeIDs = new Dictionary&lt;string, int&gt;();\n\n            OsgDBDataContext db = new OsgDBDataContext();\n\n            // Populates Dictionaries here\n\n            db.Dispose();\n        }\n    }\n}\n</code></pre>\n\n<p>Is there anything obviously wrong with how I've set this class up that's preventing it from appearing when used via a DLL?</p>\n\n<p>Many thanks</p>\n"},{"tags":["c#","tridion"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":59,"score":2,"question_id":13267701,"title":"SDL Tridion C# code fragment can't find engine, package or log fields in context","body":"<p>I'm quite new to Tridion development and I'm having my first \"basic\" issue.\nI've written a simple C# code fragment in a TBB (using content manager text editor) and I've tried to use engine, package and log fields (as I know they are made available by Tridion) but  I receive an error saying \"the name does not exist in context\".\nHere is the code:</p>\n\n<pre><code>&lt;%@ Page Language=\"C#\" ContentType=\"text/html\" ResponseEncoding=\"utf-8\" %&gt;\n&lt;div&gt;\n        &lt;!-- TemplateBeginRepeat name=\"Component.Fields.crociera\" --&gt;\n              &lt;!-- TemplateBeginIf cond=\"prezzo&lt;250\" --&gt;\n                     Go to @@location@@&lt;br/&gt;\n              &lt;!-- TemplateEndIf --&gt;\n        &lt;!-- TemplateEndRepeat --&gt;\n&lt;/div&gt;\n&lt;%\nString ts = DateTime.Now.ToString(\"d MMM yyyy\");\nResponse.Write(\"&lt;br/&gt;\"+ts);\nengine.getSession();\n%&gt;\n</code></pre>\n\n<p>When I save the TBB and publish the page I receive this error:</p>\n\n<pre><code>Compilation Error\n\nDescription: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. \n\nCompiler Error Message: CS0103: The name 'engine' does not exist in the current context\n\nSource Error:\n\n\nLine 31: Response.Write(\"&lt;br/&gt;\"+ts);\nLine 32: engine.getSession();\nLine 33: %&gt;                         \nLine 34:                  &lt;/div&gt;\n\nSource File: c:\\inetpub\\wwwroot\\stage\\pj\\ricerca\\ricerca.aspx    Line: 32 \n</code></pre>\n\n<p>Probably I miss something or do something wrong, does anyone recognize the problem?</p>\n"},{"tags":["c#","asp.net-mvc-3","razor"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":313,"score":2,"question_id":8040482,"title":"Why does Razor not like this?","body":"<p>Ive got a mega annoying problem I have a view with:</p>\n\n<pre><code>@{\n\n        if(ViewBag.Section == \"Home\")\n        {\n           &lt;div id=\"headerfrontPage\"&gt;   \n        }\n        else\n        {\n            &lt;div id=\"header\"&gt;   \n        }\n\n\n     }\n</code></pre>\n\n<p>And I get a compilation error:</p>\n\n<blockquote>\n  <p>The code block is missing a closing \"}\" character.  Make sure you have\n  a matching \"}\" character for all the \"{\" characters within this block,\n  and that none of the \"}\" characters are being interpreted as markup.</p>\n</blockquote>\n\n<p>How do I conditionally write a div? Its for a hack bascially...</p>\n"},{"tags":["c#","wpf","radio-button"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13170299,"title":"WPF Radiobutton TwoWay Binding causes always two Property calls. How to distinguish?","body":"<p>I have several RadioButtons combined in one Group so that only one can be checked. The RadioButtons are bound to boolean Properties.</p>\n\n<p>This works very well and my program reacts on the changes of these Properties.</p>\n\n<p>Suppose <code>optA</code> is selected. Next I select <code>optB</code>, the value of <code>PropertyB</code> is set to true and my program reacts accordingly. However, at this time both <code>optA</code> and <code>optB</code> are true until the Group of Radio buttons updates <code>optA</code> to false  which again triggers my \"IsSelected\" event.</p>\n\n<p>I think this is totally correct behavior...\nBut how can I distinguish between a change from the user and the automated change from the group?</p>\n\n<p>Edit: Code</p>\n\n<pre><code>&lt;RadioButton Name=\"featureCheckBox\" GroupName=\"featureRadioButtonGroup\" IsChecked=\"{Binding Path=IsSelected, Mode=TwoWay}\" /&gt;\n\n public bool IsSelected { \n\n        get{ return _isSelected; }\n        set { PropertyChanged.ChangeAndNotify(ref _isSelected, value, () =&gt; IsSelected); }\n    }\n</code></pre>\n"},{"tags":["c#","com","outlook","outlook-2010","comexception"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13271829,"title":"Outlook COMException","body":"<p>System.Runtime.InteropServices.COMException  ..Your server administrator has limited the number of items you can open simultaneously...</p>\n\n<p>at Microsoft.Office.Interop.Outlook._AppointmentItem.get_UserProperties()</p>\n\n<pre><code>        var calendar = outlookApplication.GetNamespace(\"MAPI\").GetDefaultFolder(OlDefaultFolders.olFolderCalendar);\n\n        if (calendar == null || calendar.Items == null)\n        {\n            return null;\n        }\n\n        var calendarItems = calendar.Items;\n\n        if (calendarItems != null &amp;&amp; calendarItems.Count &gt; 0)\n        {\n            // Dont convert to LINQ or foreach please -&gt; may cause Outlook memory leaks. \n            for (int counter = 1; counter &lt;= calendarItems.Count; counter++)\n            {\n                var appointment = calendarItems[counter] as AppointmentItem;\n\n                if (appointment != null)\n                {\n                    var userProperty = appointment.UserProperties.Find(\"myInformation\");\n\n                    if (userProperty != null &amp;&amp; userProperty.Value == myValue)\n                    {\n                        return appointment ;\n                    }\n                }\n            }\n        }\n</code></pre>\n\n<p>Maybe its appointment.UserProperties.Find(\"myInformation\") cause COMException?</p>\n"},{"tags":["c#","ios","monotouch","monotouch.dialog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13267573,"title":"Updating Monotouch.Dialog RootElement","body":"<p>I have been following the code from the monotouch.dialog task sample app (http://docs.xamarin.com/ios/Guides/User_Interface/MonoTouch.Dialog/Elements_API_Walkthrough).</p>\n\n<p>Something I dont seem able to work out, is when the user clicks the + button a new row to the table is added. The user touches this and navigates to another screen where they can enter information. Now, when they navigate back to the root view, I want the list of rootElements to be updated so the entered name is used instead of the default name 'connection'</p>\n\n<p>How would I go about updating the text for each of the RootElements based upon what has been entered?</p>\n\n<p>I hope that all makes sense!</p>\n\n<p>-- code below.</p>\n\n<pre><code>public override bool FinishedLaunching (UIApplication app, NSDictionary options)\n{\n    window = new UIWindow (UIScreen.MainScreen.Bounds);\n\n    RootElement _rootElement = new RootElement (\"To Do List\"){ new Section()};\n\n    DialogViewController _rootVC = new DialogViewController (_rootElement);\n\n    // This adds an 'add' button to the root view controller, and handles by delegate,the push to a screen where you can add a new vCenter connection profile.\n    UIBarButtonItem _addButton = new UIBarButtonItem (UIBarButtonSystemItem.Add);\n    _rootVC.NavigationItem.RightBarButtonItem = _addButton;\n\n    _addButton.Clicked += (sender, e) =&gt;  {\n        var connectionProfile = new connectionProfile{};\n        // See, on the line below, I add a default RootElement with the text New Connection.\n\n        var connectionProfileElements = new RootElement (\"New Connection\") {\n            new Section () {\n                // When they enter the name on the next line of code, I want to use this to update the New Connection text on the root screen.\n                new EntryElement (\"Name\", \"Enter Connection Name\", connectionProfile._connectionName),\n                new EntryElement (\"VC Address\", \"Enter VC Address\", connectionProfile._address),\n                new EntryElement (\"VC Port\", \"Enter VC Port\", connectionProfile._port),\n                new EntryElement (\"Username\", \"Enter Username\", connectionProfile._userID),\n                new EntryElement (\"Password\", \"Enter Password\", connectionProfile._password,true)}      \n            };\n            _rootElement [0].Add (connectionProfileElements);\n        };\n\n        UINavigationController _nav = new UINavigationController (_rootVC);\n        window.RootViewController = _nav;\n        window.MakeKeyAndVisible ();\n\n        return true;\n    }\n}\n</code></pre>\n\n<p>And :</p>\n\n<pre><code>public class connectionProfile\n{\npublic connectionProfile ()\n    {\n    }\n\n    public string _connectionName { get; set; }\n    public string _address { get; set; }\n    public string _port { get; set; }\n    public string _userID {get; set; }\n    public string _password { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","post","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13271705,"title":"Displaying information to the user after page processing","body":"<p>I'm (very) new to ASP.NET and am building a registration form. I built an empty web site, added <code>Register.aspx</code> and populated it with all the form elements that're usually presented on a registration page. I also made the form submit to the Register.aspx page.</p>\n\n<p>Now, I want to catch the POST data after it's submitted. I saw there was a <code>Page_Load</code> method in Register.aspx.cs, and within that I've done:</p>\n\n<pre><code>if (Request.HttpMethod == \"POST\")\n{\n    // Validate inputs and show information to the user\n}\n</code></pre>\n\n<p>But now I have no idea how I can print things to the page. After some digging I tried to use a Label control, so I put this on my Register.aspx page:</p>\n\n<pre><code>&lt;asp:Label ID=\"StatusLabel\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n</code></pre>\n\n<p>but when I try to access it using <code>StatusLabel.Text</code> from within Register.aspx.cs I get an error saying it doesn't exist in the current context.</p>\n\n<p>I'm thoroughly confused, how can I achieve what I want to do?</p>\n\n<p>Cheers!</p>\n"},{"tags":["c#",".net-4.0","lua","luainterface"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":952,"score":2,"question_id":5902285,"title":"LuaInterface - Compiling under .Net 3.5 / .Net 4.0 FileLoadException","body":"<p>A project of mine utilizes LuaInterface. I've begun migrating it from XNA to OpenTX, as well as rewriting it under .Net 4.0.</p>\n\n<p>I started moving my Lua class over, to find that i get an exception when debugging (FileLoadException)</p>\n\n<pre><code>Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.\n</code></pre>\n\n<p>When i rebuilt LuaInterface, i changed the .Net Framework in its properties from .Net 2.0 to .Net 4.0 (as well as its client mode) and .Net 3.5.</p>\n\n<p>Both of these settings give me the error stating its still built using 2.0.</p>\n\n<p>I've attempted many solutions here at StackOverflow as well as MSDN, stating to setup an app.config and even change Application Pools for some ungodly reason...</p>\n\n<p>Anyway, every solution i've attempted failed, stating that its STILL using 2.0.</p>\n\n<p>I've used 'IL DASM' and it states its built using 3.5/4.0.</p>\n\n<p>Any ideas as to whats going on? Been messing with this all day. Am I simply being naive to think that changing a single setting could fix my problems?</p>\n\n<p>Any help would be GREATLY appreciated.</p>\n"},{"tags":["c#","windows-phone-7.1"],"answer_count":3,"favorite_count":0,"up_vote_count":13,"down_vote_count":0,"view_count":3232,"score":13,"question_id":7313291,"title":"Windows phone 7.1 ListPicker, easy way to go full mode?","body":"<p>I'm trying to use the <code>ListPicker</code> controller with <code>ListPickerMode=\"Full\"</code>, to get the fullscreen pick window. However it just generate an error when i try</p>\n\n<p>\"A first chance exception of type 'System.Windows.Markup.XamlParseException' occurred in System.Windows.dll</p>\n\n<p>Additional information: Set property <code>Microsoft.Phone.Controls.ListPicker.ListPickerMode</code> threw an exception. [Line: 49 Position: 57]\"</p>\n\n<p>Here's my code:</p>\n\n<pre><code>&lt;toolkit:ListPicker x:Name=\"OutputSelector\" ListPickerMode=\"Full\"   \nMargin=\"0,542,6,0\" Header=\"Output Type\" Width=\"450\" VerticalAlignment=\"Top\" /&gt;\n</code></pre>\n\n<p>I populate my ListPicker in C# using a list to set as ItemSource if that is any help.\nAnother thing is that when i try to write \"ListPickerMode\" in xml it doest give it as an option, but when i have written the whole thing it suggest \"Full\" \"expanded\" and \"Normal\".</p>\n\n<p>If i add 5 items to the ListPicker it automatically uses FullMode, and i have tried changing ItemCountThreshold=\"0\" but that just generate more errors.</p>\n\n<p>I'm using Windowns Phone 7.1 OS 2011 aug release.</p>\n\n<p>It's probably just me that is stupid, first day with Windows Phone programing :)</p>\n\n<p>UPDATE!</p>\n\n<p>Well it looks like ItemCountThreshold &amp; ListPickerMode was remove for 7.1 or something, atleast in XAML part, not the C# part, where they are read only.</p>\n\n<p>Solution for my problem!</p>\n\n<pre><code>&lt;toolkit:ListPicker x:Name=\"OutputSelector\" ExpansionMode=\"FullScreenOnly\"   \nMargin=\"0,542,6,0\" Header=\"Output Type\" Width=\"450\" VerticalAlignment=\"Top\" /&gt;\n</code></pre>\n\n<p>The ExpansionMode will make the Listpicker appear in fullscreen or expanded.</p>\n"},{"tags":["c#","crystal-reports","dataset","subreport"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13271748,"title":"Using Subreport in main crystal report","body":"<p>I need to create a crystal report using 2 Datatable\nName of Dataset is Dataset1\nand two datatables are :\n1.Booking_details\n2.av_details</p>\n\n<p>Using these two Datasets I need to create 1 crystal report.</p>\n\n<p>What i did was used subreport,\nmain report will contain Booking_details, and \nsubreport will contain av_details.</p>\n\n<p>However, I am able to get details on main report, but subreport just shows heading rest is blank.</p>\n\n<p>Here are my codes :</p>\n\n<pre><code>    private void crystalReportViewer1_Load(object sender, EventArgs e)\n    {\n        DataSet1 ds = new DataSet1();\n        Printfpreport printfp = new Printfpreport();\n        Printfpsubreport printfpsub = new Printfpsubreport();\n       // printbillbooking printfp = new printbillbooking();\n        printfp.SetDataSource(dt);\n        printfpsub.SetDataSource(dt_av);\n\n        crystalReportViewer1.ReportSource = printfp;\n\n        //crystalReportViewer1.ReportSource = printfpsub;\n        crystalReportViewer1.Refresh();\n\n\n    }\n</code></pre>\n\n<p>If you need any more info do let me know wil post it .</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","naudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266904,"title":"NAudio WaveOut Device ID","body":"<p>I need select waveout device, to play sound. But I cant do that. </p>\n\n<pre><code>void Initialize()\n{\n_WaveOut = new WaveOut();\nvar reader = new WaveFileReader(FileName);\n_WaveOut.Init(new WaveChannel32(reader));\n}\n</code></pre>\n\n<p>This function starts, then the form start. After this on my form, I select waveout device with combobox. Combobox is filles with this code:</p>\n\n<pre><code>for (int i = 0; i &lt; WaveOut.DeviceCount; i++)\n{\n     WaveOutCapabilities WOC = WaveOut.GetCapabilities(i);\n     comboBox2.Items.Add(WOC.ProductName);\n\n}\n</code></pre>\n\n<p>After this, I select my device.</p>\n\n<pre><code>int WaveOutDeviceId = comboBox2.SelectedIndex;\n</code></pre>\n\n<p>And start Play function:</p>\n\n<pre><code>void Play()\n{\n_WaveOut.DeviceNumber = WaveOutDeviceId;\n_WaveOut.Play();\n}\n</code></pre>\n\n<p>But my sound always play on default device (With number = 0). If I do this for microphone, this code works correctly.</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13271385,"title":"Stop the response from writing a file when there is an access denied error","body":"<p>I have the following code</p>\n\n<pre><code>try\n{        \n    GetFileAndDisplay() // Gets the file from the server and writes the file in a Response stream\n}\ncatch (UnauthorizedAccessException ex)\n{\n    Page.ClientScript.RegisterStartupScript(this.GetType(), \"Msg\", \"&lt;script type='text/javascript'&gt;alert('Error')&lt;/script&gt;\");\n    Response.Clear();                \n    Response.ContentType = \"\";               \n    Response.End();                \n}\n</code></pre>\n\n<p>The file still gets downloaded for the client, albeit a corrupted file but is there a way to stop the file from downloading.</p>\n"},{"tags":["c#","encoding","converter","windows-media-encoder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13254151,"title":"C# WMEncoder Error C00D002E","body":"<p>I wrote a Windows Service Code to convert AVI to WMV file.\nI'm using XviD, and Windows Media 9, in a Windows Vista.\nThe service starts converting, and stops before completing the job, with a WMENC_ENCODER_STOPPED status, but the file was not fully converted. And the resulting file stays locked to this application forever, until I stop the service. And when I do so, that resulting file is automatically deleted.\nCan anyone, please, help? It is important !!</p>\n\n<p>EDIT: This program works constantly, executing conversion tasks. If a file fails to convert as described above, and I use the function GC.WaitForPendingFinalizers(), I still have the locking problem. But the service goes on, and pick another task. Succeeding or failing this new task, when I use GC.WaitForPendingFinalizers(), the first one is unlocked, and automatically deleted.</p>\n\n<pre><code>            public WMENC_ENCODER_STATE EncoderStatus\n    {\n        get { return _encoderStatus; }\n        set { _encoderStatus = value; }\n    }\n\n    IWMEncFile2 File;\n    IWMEncAudioSource[] SrcAud;\n    IWMEncVideoSource2[] SrcVid;\n    IWMEncSourceGroup2[] SrcGrp;\n    WMEncoder glbEncoder = new WMEncoder();\n    WMEncProfile2[] Pro = null;\n    IWMEncSourceGroupCollection SrcGrpColl = null;\n\n    public WMVEnconder(ConvertGroup[] sourceGroup, string targetFile, string profilefile)\n    {\n        glbEncoder.OnStateChange += new _IWMEncoderEvents_OnStateChangeEventHandler(Encoder_OnStateChange);\n        glbEncoder.OnError +=new _IWMEncoderEvents_OnErrorEventHandler(Encoder_OnError);\n\n        // Creates source group.\n        SrcGrpColl = glbEncoder.SourceGroupCollection;\n\n        int[] intProVBRModeAudio = new int[sourceGroup.Length];\n        int[] intProVBRModeVideo = new int[sourceGroup.Length];\n        Int32[] intProContentType = new int[sourceGroup.Length];\n        Pro = new WMEncProfile2[sourceGroup.Length];\n        for (int i = 0; i &lt; Pro.Length; i++)\n        {\n            Pro[i] = new WMEncProfile2();\n            Pro[i].LoadFromMemory(profilefile);\n            intProContentType[i] = Pro[i].ContentType;\n            intProVBRModeAudio[i] = (int)Pro[i].get_VBRMode(WMENC_SOURCE_TYPE.WMENC_AUDIO, 0);\n            intProVBRModeVideo[i] = (int)Pro[i].get_VBRMode(WMENC_SOURCE_TYPE.WMENC_VIDEO, 0);\n        }\n\n        SrcGrp = new IWMEncSourceGroup2[sourceGroup.Length];\n        for (int i = 0; i &lt; SrcGrp.Length; i++)\n            SrcGrp[i] = (IWMEncSourceGroup2)SrcGrpColl.Add(i.ToString());\n\n        SrcAud = new IWMEncAudioSource[sourceGroup.Length];\n        SrcVid = new IWMEncVideoSource2[sourceGroup.Length];\n\n        for (int i = 0; i &lt; sourceGroup.Length; i++)\n        {\n            if (intProContentType[i] == 1)\n            {\n                SrcAud[i] = (WMEncoderLib.IWMEncAudioSource)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO);\n                SrcAud[i].SetInput(sourceGroup[i].AudioFile, \"\", \"\");\n\n                SrcAud[i].MarkIn = sourceGroup[i].AudioMarkin;\n                SrcAud[i].MarkOut = sourceGroup[i].AudioMarkout;\n            }\n            else if (intProContentType[i] == 16)\n            {\n                SrcVid[i] = (WMEncoderLib.IWMEncVideoSource2)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);\n                SrcVid[i].SetInput(sourceGroup[i].VideoFile, \"\", \"\");\n\n                SrcVid[i].MarkIn = sourceGroup[i].VideoMarkin;\n                SrcVid[i].MarkOut = sourceGroup[i].VideoMarkout;\n            }\n            else if (intProContentType[i] == 17)\n            {\n                SrcAud[i] = (WMEncoderLib.IWMEncAudioSource)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO);\n                SrcAud[i].SetInput(sourceGroup[i].AudioFile, \"\", \"\");\n\n                SrcVid[i] = (WMEncoderLib.IWMEncVideoSource2)SrcGrp[i].AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);\n                SrcVid[i].SetInput(sourceGroup[i].VideoFile, \"\", \"\");\n\n                SrcAud[i].MarkIn = sourceGroup[i].AudioMarkin;\n                SrcAud[i].MarkOut = sourceGroup[i].AudioMarkout;\n                SrcVid[i].MarkIn = sourceGroup[i].VideoMarkin;\n                SrcVid[i].MarkOut = sourceGroup[i].VideoMarkout;\n            }\n            else\n                throw new Exception(\"erro - não suporta este tipo de profile\");\n\n            SrcGrp[i].set_Profile(Pro[i]);\n\n            if (i + 1 &lt; sourceGroup.Length)\n                SrcGrp[i].SetAutoRollover(-1, (i + 1).ToString());\n        }\n\n        File = (IWMEncFile2)glbEncoder.File;\n        File.LocalFileName = targetFile;\n\n        glbEncoder.PrepareToEncode(true);\n    }\n    /// &lt;summary&gt;\n    /// Inicia os processos do codificador.\n    /// &lt;/summary&gt;\n    public void Start()\n    {\n        glbEncoder.Start();\n    }\n    /// &lt;summary&gt;\n    /// Pára os processos do codificador.\n    /// &lt;/summary&gt;\n    public void Stop()\n    {\n        glbEncoder.Stop();\n    }\n    /// &lt;summary&gt;\n    /// Elimina as configurações atuais.\n    /// &lt;/summary&gt;\n    public void Reset()\n    {\n        glbEncoder.Reset();\n    }\n    /// &lt;summary&gt;\n    /// Evento deflagrado pela mudança no estado do codificador.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"enumState\"&gt;Enumerador indicador do estado do codificador.&lt;/param&gt;\n    private void Encoder_OnStateChange(WMEncoderLib.WMENC_ENCODER_STATE enumState)\n    {\n        _encoderStatus = enumState;\n        string strRunState = \"\";\n        switch (enumState)\n        {\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STARTING :\n                strRunState = \"Encoder Starting\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_RUNNING:\n                strRunState = \"Encoder Running\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_END_PREPROCESS:\n                strRunState = \"Encoder End Preprocess\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_PAUSING:\n                strRunState = \"Encoder Pausing\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_PAUSED:\n                strRunState = \"Encoder Paused\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STOPPING:\n                strRunState = \"Encoder Stopping\";\n                break;\n            case WMENC_ENCODER_STATE.WMENC_ENCODER_STOPPED:\n                strRunState = \"Encoder Stopped\";\n                break;\n        }\n        _strEncoderStatus = strRunState;\n    }\n    /// &lt;summary&gt;\n    /// Evento deflagrado pela ocorrência de um erro durante o processo de codificação.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"hr\"&gt;Valor numérico do erro que ocorreu.&lt;/param&gt;\n    private void Encoder_OnError(int hr)\n    {\n        string errorReceived = \"\";\n\n        switch (hr)\n        {\n            case -1074600792:\n                errorReceived = \"The starting time must be greater than zero and less than the ending time.\";\n                break;\n            case -1074600793:\n                errorReceived = \"The ending time must be greater than the starting time and less than the file duration.\";\n                break;\n            case -1074600804:\n                errorReceived = \"The video capture device is in use and cannot be opened.\";\n                break;\n            case -1074600808:\n                errorReceived = \"The video capture driver returned an unrecoverable error.\";\n                break;\n            case -1074600809:\n                errorReceived = \"The video capture device did not start.\";\n                break;\n            case -1074600813:\n                errorReceived = \"The video capture window was not created.\";\n                break;\n            case -1074600820:\n                errorReceived = \"The specified operation is not allowed when the file is being archived.\";\n                break;\n            case -1074600825:\n                errorReceived = \"The archive file name is not properly specified.\";\n                break;\n            case -1074600831:\n                errorReceived = \"The specified operation is not allowed when the encoder engine is not running.\";\n                break;\n            case -1074600833:\n                errorReceived = \"Inverse telecine cannot be specified when the frame rate does not equal 30 frames per second.\";\n                break;\n            case -1074600834:\n                errorReceived = \"Internal problems are preventing the preview or postview.\";\n                break;\n            case -1074600835:\n                errorReceived = \"One or more required codecs cannot be found.\";\n                break;\n            case -1074600840:\n                errorReceived = \"The display size or color setting has changed since the encoding session was defined.\";\n                break;\n        }\n\n        try\n        {\n            if (Directory.Exists(@\"C:\\MediaDNA_V2\\Data\\Conversion\\Exception\"))\n            {\n                MediaDNAException mdnaException = new MediaDNAException(Modulo.CONVERSION, 0, \"C_110018\", TipoErro.INFORMACAO, new Exception(errorReceived),\n                    ErrorMessageConstants.C_110018, new object[] { hr.ToString(\"X\") });\n                ExceptionManager.RegisterException(mdnaException, @\"C:\\MediaDNA_V2\\Data\\Conversion\\Exception\");\n            }\n        }\n        catch { }\n    }\n\n    #region IDisposable Members\n    /// &lt;summary&gt; Release everything. &lt;/summary&gt;\n    public void Dispose()\n    {\n        glbEncoder.Stop();\n        glbEncoder.Reset();\n        GC.SuppressFinalize(this);\n        CloseInterfaces();\n    }\n    #endregion\n\n    /// &lt;summary&gt;\n    /// Fecha as interfaces utilizadas pelo codificador.\n    /// Obs: O processador precisa estar \"STOPPED\" para executar este processo.\n    /// &lt;/summary&gt;\n    private void CloseInterfaces()\n    {\n        if (glbEncoder != null)\n        {\n            if (File != null)\n                Marshal.FinalReleaseComObject(File);\n            if (Pro != null)\n            {\n                for (int i = 0; i &lt; Pro.Length; i++)\n                    Marshal.FinalReleaseComObject(Pro[i]);\n\n                Pro = null;\n            }\n            if (SrcVid != null)\n            {\n                for (int i = 0; i &lt; SrcVid.Length; i++)\n                    Marshal.FinalReleaseComObject(SrcVid[i]);\n\n                SrcVid = null;\n            }\n            if (SrcAud != null)\n            {\n                for (int i = 0; i &lt; SrcAud.Length; i++)\n                    Marshal.FinalReleaseComObject(SrcAud[i]);\n\n                SrcAud = null;\n            }\n            if (SrcGrpColl != null)\n                Marshal.FinalReleaseComObject(SrcGrpColl);\n            if (SrcGrpColl != null)\n                Marshal.FinalReleaseComObject(SrcGrpColl);\n            if (glbEncoder != null)\n                Marshal.FinalReleaseComObject(glbEncoder);\n            GC.Collect();\n            GC.WaitForPendingFinalizers();\n            GC.Collect();\n        }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","xaml","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13271689,"title":"WPF combobox ItemTemplate does not apply","body":"<p>I have a combobox, which is bound to a dictionary of </p>\n\n<pre><code>&lt;int, MyObject&gt;\n</code></pre>\n\n<p>by the following code:</p>\n\n<pre><code>this.comboBox.ItemsSource= dictionary;\n</code></pre>\n\n<p>MyObject has some public properties, such as Name (string) and Selected (boolean). </p>\n\n<p>In my Xaml I have an ItemTemplate on comboBox:</p>\n\n<pre><code>&lt;ComboBox.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;TextBlock Text=\"{Binding Path=Key, Mode=OneWay}\"/&gt;\n    &lt;/DataTemplate&gt;\n&lt;/ComboBox.ItemTemplate&gt;\n</code></pre>\n\n<p>When I run the app, I get the combobox filled with [1, MyObject] values. </p>\n\n<p>What I eventually want to do is have a checkbox and a textblock in the ItemTemplate, which will be bound to MyObject.Selected and MyObject.Name. At the moment, I can't even get the datatemplate to display the dictionaty Key value.</p>\n\n<p>Any ideas why the itemtemplate is being ignored? I've tried the full temeplate (stack planel containing a combobox and textblock), that showed the same values at runtime.</p>\n\n<p>cheers.</p>\n"},{"tags":["c#","windows","visual-studio-2010","visual-studio","internet-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13271684,"title":"Create a custom security manager (IInternetSecurityManager)","body":"<p>I need to create a custom security manager (c#) with IInternetSecurityManager to enable all the security options (especially i need to enable cookies) in the WebBrowser Control.\nI need some sample code. </p>\n\n<p>thanks to all,\nRiccardo.</p>\n"},{"tags":["c#","epub","watermark"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13271615,"title":"How do I watermark an existing .epub file?","body":"<p>May I know which strategy I've to follow in order to watermark an existing epub file? Any suggestion for existing code or libraries?</p>\n\n<p>In particular i'd like to insert the watermark in ONE page of the document.</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":25,"score":1,"question_id":13271673,"title":"install voice for C# SpeechSynthesizer class","body":"<p>How can I add voice for <code>SpeechSynthesizer</code> to use for \"text to speech\" in C#</p>\n"},{"tags":["c#","unity",".net-assembly","utf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13254864,"title":"Spanish Characters in C#","body":"<p>I am currently working on a Spanish translation program that uses HtmlDocument to access the Google translate website. I am programming in Assembly C# in Unity. Shown below is my current code for accessing Google:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing UnityEngine;\nusing System.Collections;\nusing System.Net;\nusing HtmlAgilityPack;\n\n\npublic class Dictionary{\n    string[] formatParams;\n    HtmlDocument doc;\n    string returnString;\n    char[] letters;\n    public Dictionary(){\n        formatParams = new string[2];\n        doc = new HtmlDocument();\n        returnString = \"\";\n    }\n    public string Translate(String input, String languagePair, Encoding encoding)\n    {\n        formatParams[0]= input;\n        formatParams[1]= languagePair;\n        string url = String.Format(\"http://www.google.com/translate_t?hl=en&amp;ie=UTF8&amp;text={0}&amp;langpair={1}\", formatParams);\n\n        string result = String.Empty;\n\n        using (WebClient webClient = new WebClient())\n        {\n            webClient.Encoding = encoding;\n            result = webClient.DownloadString(url);\n        }       \n        doc.LoadHtml(result);\n        input = alter (input);\n        return doc.DocumentNode.SelectSingleNode(\"//span[@title='\"+input+\"']\").InnerText;\n    }\n    // Use this for initialization\n    void Start () {\n\n    }\n    string alter(string inputString){\n        returnString = \"\";\n        letters = inputString.ToCharArray();\n        for(int i=0; i&lt;inputString.Length;i++){\n            if(letters[i]=='\\''){\n                returnString = returnString + \"&amp;#39;\";  \n            }else{\n                returnString = returnString + letters[i];   \n            }\n        }\n        return returnString;\n    }\n}\n</code></pre>\n\n<p>The code is accessed by:</p>\n\n<pre><code>    search = new Dictionary();\n    input = \" \";\n    temp = \" \";\n    returnString = \"\";\n    code = Encoding.UTF8;\n\n    search.Translate(input,\"en|es\",code);\n</code></pre>\n\n<p>This code does work successfully, if you put \"Hello\" as input, it will return \"Hola\". However, if you set input as \"How are you?\" it will return \"Cmo ests\". I have done research and have discovered that using UTF8 will not display special characters, which I need for Spanish(and other languages). I have read that using UTF16 will fix this error, however, when I write:</p>\n\n<pre><code>code = Encoding.UTF16;\n</code></pre>\n\n<p>Another error pops up saying :</p>\n\n<pre><code>Assets/GUIScript.cs(26,33): error CS0117: `System.Text.Encoding' does not contain a definition for `UTF16'\n</code></pre>\n\n<p>If anyone knows the code to properly implement UTF16 or to fix my issue with special character, any help would be greatly appreciated.</p>\n"},{"tags":["c#","jquery","validation",".net-3.5","asp.net-webforms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13248154,"title":"jQuery Validation with ASP.NET C# Web Forms","body":"<p>I'm having a bit of an awkward problem with jquery validation (which is brilliant) and asp.net web forms. I presume its an issue with how the forms are used in this framework but anyway here's the issue.</p>\n\n<ol>\n<li>I have a page which has a number of fields for an employee to fill out, when he/she submits/saves the record (asp.net button control) the validation rules trigger and display relative errors if present (seems to work, rules need work but that irrelevant for the minute).</li>\n<li>The validations trigger correctly and list at the bottom of the screen, however if i click anywhere on the screen the jQuery seems to fire again and displays only the first error (same with any sort of key press/minimization of the screen). When that error is corrected the next in the list appears and so on...</li>\n</ol>\n\n<p><strong>Note:</strong></p>\n\n<p>My form is in the master page which has a content placeholder within it and the .net version is 3.5 (unfortunately limited by the servers I'm working on).</p>\n\n<p>If anybody could help, that would be great :D.</p>\n\n<pre><code>    $(document).ready(function () {\n        $('.txt')\n        .focus(function () { \n            $('.txt').removeClass('focused');\n            $(this).addClass('focused'); \n        })\n        .blur(function () { \n            $(this).removeClass('focused'); \n        });\n\n\n        //Fire validation events\n        $(\"#aspnetForm\").validate({\n            //Setting validations rules like, Required, Minimum or Maximum Length, Data Type etc.\n            rules:\n            {\n                //Set name of tag to validate: Name = UniqueID\n                &lt;%= txtPointCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPointName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPointLocalName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtPortCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtCountryCode.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtCountryName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtAreaName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtRegionName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 },\n                &lt;%= txtContinentName.UniqueID %&gt; : { required: true, minlength: 5, maxlength: 10 }\n            },\n            //Contextual error messages for each selected field\n            messages:\n            {\n                &lt;%= txtPointCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPointName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPointLocalName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtPortCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtCountryCode.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtCountryName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtAreaName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtRegionName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\",\n                &lt;%= txtContinentName.UniqueID %&gt; : \"This field cannot be empty, please enter between 5 - 10 characters.\"\n            },\n\n            //A custom message display handler. Gets the map of errors as the first argument and and array of errors as the second, \n            //called in the context of the validator object.\n            showErrors: function (errorMap, errorList)\n            {\n                var messages = \"\";\n                var errorCount = 0;\n\n                //Error builder\n                $.each(errorList, function (index, value) {\n                    var id = $(value.element).attr('id');\n                    var elementName = $(value.element).attr('name').split('txt'); //Strip out UniqueID obfuscation\n\n                    messages += \"&lt;span&gt;\" + (index + 1) + \". | &lt;a noref title=\\\"Click to view field\\\" onClick=\\\"setFocus('\" + id + \"');\\\"&gt;[\" + elementName[1] + \"]&lt;/a&gt; | \" + value.message + \"&lt;/span&gt;&lt;br/&gt;\";\n                    errorCount++;\n                });\n\n                messages = \"&lt;div class='errorWrapper'&gt;&lt;hr&gt;&lt;h1&gt;Please correct the following \" + errorCount + \" errors:&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;\" + messages + \"&lt;/div&gt;\";\n\n                //Display error summary with slide animation\n                $('#summary-validation').html(messages);\n                $('#summary-validation').show(\"fast\");\n            },\n\n            //If all validations are successfully validate then execute submitHandler function\n            submitHandler: function ()\n            {\n                $('#summary-validation').empty();\n                //alert(\"All fields are valid!\");\n                $(\"#aspnetForm\").submit();\n            },\n            onkeyup: false, //Stops validation refresh on occurances of certain key presses\n            onfocusout: false //Stops validation refresh when element loses focus\n        });\n        //-------------------------------------------------------------------------------\n    });\n    //If validation errors are occured in any field, it will display field name with link, clicking on link it will set focus of perticular field.            \n    function setFocus(ele)\n    {\n        document.getElementById(ele).focus();\n        //$(ele).focus();\n    }\n</code></pre>\n"},{"tags":["c#","documentation","xsd","annotations","element"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13271347,"title":"Xsd documentation value","body":"<p>how can I create xsd documentation programatically?\nExample:</p>\n\n<pre><code>&lt;xs:annotation&gt;\n&lt;xs:documentation&gt;Documentation&lt;/xs:documentation&gt;\n&lt;/xs:annotation&gt;\n</code></pre>\n\n<p>I used:</p>\n\n<pre><code> XmlSchemaElement element = new XmlSchemaElement();\n    XmlSchemaAnnotation annotation = new XmlSchemaAnnotation();\n    XmlSchemaDocumentation doc = new XmlSchemaDocumentation();\n\n    //doc.Value = \"Documentation\"; ??\n    annotation.Items.Add(doc);\n    element.Annotation = annotation;\n</code></pre>\n\n<p>but how do I set documentation value? There is no such property in XmlSchemaDocumentation type. Thanks!</p>\n"},{"tags":["c#",".net","visual-studio-2010","unit-testing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":538,"score":1,"question_id":8921064,"title":"Unit test project not building from build server","body":"<p>My VS2010 solution has a test project in it.  The unit tests themselves reference the following namespace:</p>\n\n<pre><code>using Microsoft.VisualStudio.TestTools.UnitTesting;\n</code></pre>\n\n<p>which is accessed via the following assembly on my PC:</p>\n\n<pre><code>Assembly Microsoft.VisualStudio.QualityTools.UnitTestFramework\n    C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\\n    PublicAssemblies\\Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll\n</code></pre>\n\n<p>When I build the solution on my PC I have no issues; the tests will build and run okay.</p>\n\n<p>We have an intranet page which we can use to kick off builds on a build server.  When I build via this page, the build fails with the following errors:</p>\n\n<pre><code>Generator.cs(3,17): error CS0234: The type or namespace name 'VisualStudio' \ndoes not exist in the namespace 'Microsoft' (are you missing an assembly\nreference?)\n</code></pre>\n\n<p>The obvious problem would be that the <code>Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll</code> mentioned above is not present on the build server.  I thought this was would be installed with VS2010, and since the projects in my solution build .NET 4.0 targets, I would expect this to be installed on the build server.</p>\n\n<p>What is the easiest way to resolve this?  The build server is out of my jurisdiction and I don't particular want to log a job to get new libraries installed on to it.</p>\n"},{"tags":["c#","tabcontrol"],"answer_count":13,"favorite_count":1,"up_vote_count":14,"down_vote_count":1,"view_count":25735,"score":13,"question_id":418006,"title":"How can I disable a tab inside a TabControl?","body":"<p>Is there any way to disable a tab in a tabcontrol?</p>\n\n<p>I am using C#.</p>\n"},{"tags":["c#"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":65,"score":-1,"question_id":13271191,"title":"How to create game highscores with names?","body":"<p>I have a simple game and I want to save highscores with names, then on another form show it, but in descending order of points.\nI want to do it with txt file, and saving is ok, I just save like: Adam,200,John,100 etc. Showing them is also not problem but how to sort them? So how can I connect the scores with the names?</p>\n"},{"tags":["c#","database","razor","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":10286353,"title":"Need Help to solve and understand this error: Exception Details: System.InvalidOperationException: 2","body":"<p>I got this error:</p>\n\n<pre><code>Exception Details: System.InvalidOperationException: 2 : String truncation: max=0, len=1, value='3'.\n</code></pre>\n\n<p>From this set of code:</p>\n\n<pre><code>var reqcategory=Request[\"category\"];\n        foreach (var cat in reqcategory)\n        {\n        var sql5 = \"SELECT Type.PreReq1, Type.PreReq2, (CASE WHEN (Type.PreReq1 IS NOT   NULL) AND (PermitApp1.RPClass IS NULL) AND (PermitApp1.RPCategory IS NULL) THEN 1 ELSE 0 END) AS missing1, (CASE WHEN (Type.PreReq2 IS NOT NULL) AND (PermitApp2.RPClass IS NULL)AND (PermitApp2.RPCategory IS NULL) THEN 1 ELSE 0 END) AS missing2 FROM Type LEFT JOIN PermitApp AS PermitApp1 ON (Type.PreReq1=PermitApp1.RPClass) OR (Type.PreReq1=PermitApp1.RPCategory) AND ( PermitApp1.CDSID = @0 ) AND (PermitApp1.MDecision='1') LEFT JOIN PermitApp AS PermitApp2 ON (Type.PreReq2=PermitApp2.RPClass) OR (Type.PreReq2=PermitApp2.RPCategory) AND ( PermitApp2.CDSID = @1 ) AND (PermitApp2.MDecision='1') WHERE Type.PType = @2\";\n        var result = db.QuerySingle(sql5, myCDSID, username, cat);\n        var miss1 = result.missing1;\n        var miss2 = result.missing2;\n\n\n        if(miss1 == '1' || miss2 == '1'){\n            ModelState.AddError(\"missing\", \"You have not met the Pre-Requisites for \"+ cat +\" yet.\");\n            } else if (miss1 == '0' &amp;&amp; miss2 == '0'){\n\n        Session[\"license\"] = Request[\"licence\"];\n        Session[\"from\"] = Request[\"from\"];\n        Session[\"to\"] = Request[\"to\"];\n        Session[\"group\"] = Request[\"group\"];\n        Session[\"class1\"] = Request[\"class1\"];\n        Session[\"category1\"] = Request[\"category1\"];\n        Session[\"class\"] = Request[\"class\"];\n        Session[\"category\"] = Request[\"category\"];\n        Response.Redirect(\"~/Questionnaire\");\n        }\n        }\n</code></pre>\n\n<p>the highlighted line was :</p>\n\n<pre><code>var result = db.QuerySingle(sql5, myCDSID, username, cat);\n</code></pre>\n\n<p>I don't understand what was mentioned on the error page and i could not find someone in the same case as my. Thanks</p>\n"},{"tags":["c#","com","vfp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12904209,"title":"COM Integration","body":"<p>I have a COM object developed in C# which will be consumed in VFP. The object can be loaded by the vfp project on the dev system, by copying the c# dll into the vfp project's main directory, and registering it. I am running the vfp project installed rather than in the vfp environment. In other words, vfp is not open on my dev system, but vs2010 is.. However, the dll project obviously is not being run.</p>\n\n<p>When I move to the test machine, which has neither vfp nor vs, drop in the dll, register it, and try running, nothing happens. Unfortunately, no errors are generated in vfp, and I cannot make changes to the vfp code.</p>\n\n<p>Is there some trick that I need to do before a COM object will run on a system, or some type of registration that VS may have done with the dll on the dev system? </p>\n\n<p>Thank you for any assistance. It is greatly appreciated.</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1216,"score":6,"question_id":7809745,"title":"Linq code to select one item","body":"<p>I find myself writing a lot of code like this to select one item that matches </p>\n\n<pre><code>var item = (from x in Items where x.Id == 123 select x).First();\n</code></pre>\n\n<p>Is there a cleaner way of doing it or is this as concise as I'm going to get?</p>\n\n<p>EDIT: Should have said \"Cleaner way using linq syntax\". I was already aware of the lambda syntax and it's starting to look like this is actually the only way. I did get some useful info though, so thanks to everyone who replied.</p>\n"},{"tags":["c#","asp.net-mvc-3","projects-and-solutions"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":44,"score":-1,"question_id":13271403,"title":"How to access other projects in one solution","body":"<p>I have one empty solution Store with 3 projects Store.Domain, Store.UnitTests, Store.WebUI</p>\n\n<p>In domain I have my Data Model and I like to access through Store.WebUI. I try using Store.Domain however I got an error type or namespace could not be found are you missing using directive or an assembly reference?</p>\n"},{"tags":["c#","jquery","asp.net","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":197,"score":0,"question_id":9426534,"title":"Inserting and selecting data using Jquery","body":"<p>I am working with visual studio 2010,4.0 frame work\nmy pages are like the following</p>\n\n<p>default.aspx contain a \ntextbox\nbutton</p>\n\n<p>on the click of button the data should insert into the sql database without the page being posted i.e. using jquery.</p>\n\n<p>How can it be done?</p>\n"},{"tags":["c#","character-encoding","vfp","dbase"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13026489,"title":"How do i read a dbase file and apply different decoding?","body":"<p>I have a dbf file endcoded as 866 codepage (DOS)</p>\n\n<p>Using the code below, I'm trying to read it.\nProblem is that strings I get are formed as if the file was in code page 1252.\nI've checked other questions on SO and other forums with no luck so far.\nLooking for ideas on hot to read it propperly.</p>\n\n<pre><code>var ConnectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\PathtoFile\\;Extended Properties=\"\"dBase 5.0\"\"\";\nvar  dBaseConnection = new System.Data.OleDb.OleDbConnection(ConnectionString );\n\ndBaseConnection.Open();\n\nvar dBaseCommand = new System.Data.OleDb.OleDbCommand(\"SELECT * FROM FileName\",dBaseConnection);\nvar dBaseDataReader =  dBaseCommand.ExecuteReader(CommandBehavior.SequentialAccess);\n\n\nwhile( dBaseDataReader.Read()){\n\nEncoding.GetEncoding(866).GetString(Encoding.GetEncoding(1252).GetBytes(dBaseDataReader.GetString(2)).Dump();  // Does not help \n}\n</code></pre>\n"},{"tags":["c#",".net","sorting","string-comparison","bug"],"answer_count":1,"favorite_count":8,"up_vote_count":21,"down_vote_count":0,"view_count":272,"score":21,"question_id":13254153,"title":"Bug in the string comparing of the .NET Framework","body":"<p>It's a requirement for any <a href=\"http://en.wikipedia.org/wiki/Comparison_sort\" rel=\"nofollow\">comparison sort</a> to work that the underlying order operator is <a href=\"http://en.wikipedia.org/wiki/Partially_ordered_set\" rel=\"nofollow\"><em>transitive</em> and <em>antisymmetric</em></a>.</p>\n\n<p>In .NET, that's not true for some strings:</p>\n\n<pre><code>static void CompareBug()\n{\n  string x = \"\\u002D\\u30A2\";  // or just \"-ア\" if charset allows\n  string y = \"\\u3042\";        // or just \"あ\" if charset allows\n\n  Console.WriteLine(x.CompareTo(y));  // positive one\n  Console.WriteLine(y.CompareTo(x));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(x, y));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(y, x));  // positive one\n\n  var ja = StringComparer.Create(new CultureInfo(\"ja-JP\", false), false);\n  Console.WriteLine(ja.Compare(x, y));  // positive one\n  Console.WriteLine(ja.Compare(y, x));  // positive one\n}\n</code></pre>\n\n<p>You see that <code>x</code> is strictly greater than <code>y</code>, and <code>y</code> is strictly greater than <code>x</code>.</p>\n\n<p>Because <code>x.CompareTo(x)</code> and so on all give zero (<code>0</code>), it is clear that this is not an order. Not surprisingly, I get unpredictable results when I <code>Sort</code> arrays or lists containing strings like <code>x</code> and <code>y</code>. Though I haven't tested this, I'm sure <code>SortedDictionary&lt;string, WhatEver&gt;</code> will have problems keeping itself in sorted order and/or locating items if strings like <code>x</code> and <code>y</code> are used for keys.</p>\n\n<p><strong>Is this bug well-known?</strong> What versions of the framework are affected (I'm trying this with .NET 4.0)?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here's an example where the sign is negative either way:</p>\n\n<pre><code>x = \"\\u4E00\\u30A0\";         // equiv: \"一゠\"\ny = \"\\u4E00\\u002D\\u0041\";   // equiv: \"一-A\"\n</code></pre>\n"},{"tags":["c#","wpf","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":9092494,"title":"When I draw a button, it snaps back to the middle of the screen?","body":"<p>I'm very new to WPF. I was trying to add a button to a tab item (of a tab control I had already dragged in) in Visual C# 2010 Express. Upon doing this, the button repeatedly snapped to the center of the screen when I tried to drag-and-drop reposition it. Why is this happening, and how can I move the button? I haven't written any code, and the only properties of the button that I've changed are the size, content, and name.</p>\n"},{"tags":["c#",".net","matlab","process","filesystemwatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":846,"score":1,"question_id":1115028,"title":"How to use command line Matlab from .NET without linking?","body":"<p>I finally discovered a way to use command line Matlab from .NET without linking:</p>\n\n<ol>\n<li><p>Write variables from .NET to a MAT file using David A. Zier's \"csmatio\" dll.</p></li>\n<li><p>Read the file from Matlab, process it and save the results to a MAT file:</p>\n\n<pre><code>var process = new Process()\n{\n    StartInfo = new ProcessStartInfo()\n    {\n        FileName = MatlabExecutableFileName,\n        Arguments = \"-nodisplay \" + \n           \"-nojvm \" +\n           \" -r \\\"somecommands; \" + \n           \"save FILENAME OUTPUTVARIABLES; \" +\n           \"exit;\\\"\"\n    }\n};\nprocess.Start();\n</code></pre></li>\n<li><p><strong>The worst part:</strong> Wait until the process finishes. </p>\n\n<p>The naive approach:</p>\n\n<pre><code>process.WaitForExit();\n</code></pre>\n\n<p>Doesn't work because matlab spawns the main application in a new thread</p>\n\n<p>Watching for the output file for changes is tricky:</p>\n\n<pre><code>new FileSystemWatcher(MatlabPath, fileName)\n    .WaitForChanged(WatcherChangeTypes.All)\n</code></pre>\n\n<p>Was not working because of a bug on this class.</p>\n\n<p>The currently working code is longer:</p>\n\n<pre><code>using (var watcher = new FileSystemWatcher(MatlabPath, fileName))\n{\n    var wait = new EventWaitHandle(false, EventResetMode.AutoReset);\n    watcher.EnableRaisingEvents = true;\n    watcher.Changed += delegate(object sender, FileSystemEventArgs e)\n    {\n       wait.Set();\n    };\n    foreach(var i in Enumerable.Range(0, 2))\n    {\n        if (!wait.WaitOne(MillissecondsTimeout))\n        {\n            throw new TimeoutException();\n        }\n    }\n    Thread.Sleep(1000);\n}\n</code></pre>\n\n<p>But I am concerned about the last line of code. The code block above was written with the intent of avoiding it, but I don't know what else to do. This amount of time will be too much on some computers and too little on others.</p></li>\n</ol>\n\n<p><strong>SOLUTION</strong></p>\n\n<pre><code>var previousProcesses = Process\n    .GetProcessesByName(\"Matlab\")\n    .Select(a =&gt; a.Id)\n    .ToArray();\nprocess.Start();\nprocess.WaitForExit();\nvar currentProcess = Process\n    .GetProcessesByName(\"Matlab\")\n    .Where(a =&gt; !previousProcesses.Contains(a.Id))\n    .First();\ncurrentProcess.WaitForExit();\n</code></pre>\n"},{"tags":["c#","path"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":51,"score":6,"question_id":13266756,"title":"Absolute to Relative path","body":"<p>I'm getting a file from an OpenFileDialog which returns a string with the absolute path to the selected file. Now I want that path as a relative path to a given path (in this case the path to my application).</p>\n\n<p>So let's say I get a path to the file:\n<code>c:\\myDock\\programming\\myProject\\Properties\\AssemblyInfo.cs</code></p>\n\n<p>and my application is located in</p>\n\n<p><code>c:\\myDock\\programming\\otherProject\\bin\\Debug\\program.exe</code></p>\n\n<p>then I want the result: </p>\n\n<p><code>..\\..\\..\\myProject\\Properties\\AssemblyInfo.cs</code></p>\n"},{"tags":["c#","visual-studio-2010","dll","release-management"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2336,"score":8,"question_id":5491253,"title":"Visual Studio 2010 Compiling with the Debug or Release version of third party library depending on if my project is being compiled Build or Release?","body":"<p>I've downloaded a number of 3rd party libraries (dlls) now for Visual Studio 2010/C# and I've noticed that in their distributions \\bin directory they usually have two versions Debug and Release.</p>\n\n<p>Is there a way to add these libraries as references to the project, but use the Release build (when I'm building a release), and use the Debug build (when I'm debugging)?</p>\n"},{"tags":["c#",".net","compact-framework","windows-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":527,"score":1,"question_id":7252606,"title":"Changing TimeZone does not reflect change in Time in .NET Compact Framework","body":"<p>I am working on .Net Compact Frmework(CF) application. I this application the requirement is that I should be able to change the TimeZone. However, when I changed the TimeZone the current time does not changed to that particular TimeZone. From, web I came to know that DateTime.Now can not work in this case.</p>\n\n<p>I am using following Win API:</p>\n\n<ol>\n<li><code>SetTimeZoneInformation(...)</code> - To set the time zone at Runtime.</li>\n<li><code>GetLocalTime(...)</code> - To get the Local time w.r.t current time\nzone.</li>\n</ol>\n\n<p>Can anybody tell me what might be wrong?</p>\n"},{"tags":["c#","xaml","webbrowser-control","windows-phone-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13271246,"title":"Windows Phone WebBrowser Control can't display page","body":"<p>I have a Windows Phone 8, C#/XAML project, running on emulator. My XAML file has a phone:WebBrowser control. I've been trying to displaying a website like www.google.com, but I always get:</p>\n\n<p>\"We're having trouble display this page\"\n We're having trouble with the page you're trying to reach and can't open it right now.</p>\n\n<p>My XAML code:</p>\n\n<pre><code>&lt;Grid x:Name=\"ContentPanel\" Grid.Row=\"1\" Margin=\"12,0,12,0\"&gt;\n        &lt;phone:WebBrowser x:Name=\"webBrowser\" Height=\"319\" Width=\"684\" HorizontalAlignment=\"Left\" Margin=\"10,-10,0,0\" VerticalAlignment=\"Top\" Source=\"https://www.google.com\" /&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>I tried the link on Chrome or IE, and loads fine. \nDo you know what's wrong? \nThanks.</p>\n"},{"tags":["c#","configuration","visual-studio-2012","projects","solution"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13270926,"title":"Visual Studio Solution: Get projects related to a build configuration","body":"<p>For a post-build step on our build server I want to get all projects inside a C# Visual Studio 2012 solution related to a specific configuration.<br>\nHere is a sample sln file: <a href=\"http://pastebin.com/Hya1s9E7\" rel=\"nofollow\">pastebin</a><br>\nThis file has two projects: TestApplication1 and TestApplication2 with two configurations: App1 and App2. App1 will only build TestApplication1 and App2 only TestApplication2.<br>\nNow when I say \"display all projects for configuration App1 I\", want to get TestApplication1 back.<br> The problem is that I cant see any entry that specify which project should be build under which configuration. The sln file looks like that every project is related to every configuration.<br>\nHow can I solve this?</p>\n"},{"tags":["c#",".net","expression"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13270230,"title":"How to convert a string into a BinaryExpression object?","body":"<p>Say we have strings like:</p>\n\n<pre><code>string s1 = \"a &lt; 5\";\nstring s2 = \"b &gt;= 7\";\nstring s3 = \"c &lt;= 8\";\n...\n</code></pre>\n\n<p>I want to convert such strings into BinaryExpression objects similar to what we get by using:</p>\n\n<pre><code>  BinaryExpression b1 = Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof( int ), \"a\" ), Expression.Constant( 5, typeof( int ) ) );\n  BinaryExpression b2 = Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof( int ), \"b\" ), Expression.Constant( 7, typeof( int ) ) );\n  BinaryExpression b3 = Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof( int ), \"c\" ), Expression.Constant( 8, typeof( int ) ) );\n</code></pre>\n\n<p>I have created the method below:</p>\n\n<pre><code>BinaryExpression ConvertStringToBinaryExpression( string exp )\n{\n  string[] s = exp.Split( ' ' );\n  string param = s[ 0 ];\n  string comparison = s[ 1 ];\n  int constant = int.Parse( s[ 2 ] );\n  if ( comparison == \"&lt;\" )\n    return Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&lt;=\" )\n    return Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;=\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else\n    throw new ArgumentException( \"Invalid expression.\", \"exp\" );\n}\n</code></pre>\n\n<p>However, the above method does not work properly if, for example, we have strings like:</p>\n\n<pre><code>string s4 = \"a&lt; 5\"  // no space between 'a' and '&lt;'\nstring s5 = \"b&gt;=9\"  // no space at all\nstring s6 = \"c &lt;=7\"  // no space betwen '&lt;=' and '7'\n</code></pre>\n\n<p>What is the easiest way to make it more robust and reliable?</p>\n"},{"tags":["c#","monotouch","one-to-many","relationships","coolstorage"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13270964,"title":"Mapping issue using CoolStorage in Monotouch","body":"<p>I'm trying out Vici CoolStorage with Monotouch and seem to be having an issue with relationships. Using the following I am trying to populate a database with a single Survey and then generate a list of 5 questions using a for loop.</p>\n\n<p>When I run it there seems to be an issue mapping the Questions to the Survey in the database so if anyone could give me an idea of what I've missed it would be much appreciated! The error given is \"Vici.CoolStorage.CSException: Relation Survey could not be read\".</p>\n\n<h2>Classes</h2>\n\n<pre><code>[MapTo(\"Survey\")]\npublic class Survey : CSObject&lt;Survey, int&gt;\n{\n    public int SurveyId { get { return (int)GetField (\"SurveyId\"); } }\n    public string Title { get { return (string)GetField (\"Title\"); } set { SetField (\"Title\", value); } }\n    public DateTime DateCreated { get { return (DateTime)GetField (\"DateCreated\"); } set { SetField (\"DateCreated\", value); } }\n    public bool IsCurrent { get { return (bool)GetField (\"IsCurrent\"); } set { SetField (\"IsCurrent\", value); } }\n\n    [OneToMany(LocalKey=\"SurveyId\", ForeignKey=\"QuestionId\")]\n    public CSList&lt;Question&gt; Questions { get { return (CSList&lt;Question&gt;)GetField(\"Questions\"); } }\n\n}\n\n[MapTo(\"Question\")]\npublic class Question : CSObject&lt;Question, int&gt;\n{\n    public int QuestionId { get { return (int)GetField (\"QuestionId\"); } }\n    public string Text { get { return (string)GetField (\"Text\"); } set { SetField (\"Text\", value); } }\n    public int SurveyId { get { return (int)GetField (\"SurveyId\"); } }\n\n    [ManyToOne(LocalKey=\"QuestionId\", ForeignKey=\"SurveyId\")]\n    public Survey Survey { get { return (Survey)GetField (\"Survey\"); } set { SetField (\"Survey\", value); } }\n}\n</code></pre>\n\n<h2>Database Tables</h2>\n\n<pre><code>CSDatabase.ExecuteNonQuery (@\"CREATE TABLE Survey (SurveyId INTEGER PRIMARY KEY AUTOINCREMENT, Title TEXT(100) NOT NULL, DateCreated TEXT(50) NOT NULL, IsCurrent INTEGER)\");\nCSDatabase.ExecuteNonQuery (@\"CREATE TABLE Question (QuestionId INTEGER PRIMARY KEY AUTOINCREMENT, Text TEXT(100) NOT NULL, SurveyId INTEGER REFERENCES Survey(SurveyId))\");\n</code></pre>\n\n<h2>Loop</h2>\n\n<pre><code>for (int i = 1; i &lt;= 10; i++) \n{\n            Question q = Question.New ();\n            q.Text = String.Format (\"Question {0}\", i);\n            survey.Questions.Add (q);\n}\nsurvey.Save();\n</code></pre>\n"},{"tags":["c#","datagrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":463,"score":0,"question_id":2728330,"title":"How to adjust row height in datagrid at runtime in C# .net?","body":"<p>How to adjust row height in datagrid at runtime in C# .net?</p>\n"},{"tags":["c#","wpf","com","port"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13270754,"title":"Error while receiving data from serial port","body":"<p>I have application with several windows (actually its two almost same windows with some functions). One of that function is reading data from COM port (read weight from weighting machine). Problem is that, it works perfect on first window, but when im closing it and opening another window, then clicking same function (lets call it calculate weight), im getting this error message:\nAccess to the port 'COM1' is denied.</p>\n\n<p>Code:</p>\n\n<pre><code>   private void calculateWeight_Click(object sender, RoutedEventArgs e)\n{\n    sp = new SerialPort(\"COM1\", 9600, Parity.None, 8, StopBits.One);\n    tekst = string.Empty;\n    sp.Open();\n    sp.WriteLine(((char)5).ToString());\n    sp.WriteLine(((char)17).ToString());\n    sp.DataReceived += new SerialDataReceivedEventHandler(sp_DataReceived);\n}\nprivate delegate void UpdateUi(string s);\nvoid sp_DataReceived(object sender, SerialDataReceivedEventArgs e)\n{\n    tekst += sp.ReadExisting();\n    if (tekst.Contains('S') &amp;&amp; tekst.Length &gt; 14)\n        Dispatcher.Invoke(DispatcherPriority.Send, new UpdateUi(czytajWage), tekst);\n}\nstring tekst = string.Empty;\n\nvoid czytajWage(string s)\n{\n    string w = \"\";\n    for (int i = 5; i &lt; 14; i++)\n    {\n        w += s[i];\n    }\n    MessageBox.Show(w);\n    w = \"\";\n    tekst = \"\";\n\n    sp.DataReceived -= sp_DataReceived;\n}\n</code></pre>\n\n<p>Anyone can help? ;)</p>\n"},{"tags":["c#","visual-studio-2010","unit-testing"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13270860,"title":"visual studio 2010 c# unit tests","body":"<p>Trying to create unit tests for my methods and can't seem to get the configuration right.\nI go New Test -> Unit Test Wizard -> Pick my method -> fill in test method values but I always get Assert.Inconclusive failed. Verify the correctness of this test method.</p>\n\n<p>Here is a sample method:</p>\n\n<pre><code>namespace ConsoleApplication\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n        }\n\n        public int Mult(int a, int b)\n        {\n            return a * b;\n        }\n    }\n}\n</code></pre>\n\n<p>and the test method:</p>\n\n<pre><code>[TestMethod()]\n        public void MultTest()\n        {\n            Program target = new Program(); // TODO: Initialize to an appropriate value\n            int a = 4; // TODO: Initialize to an appropriate value\n            int b = 5; // TODO: Initialize to an appropriate value\n            int expected = 20; // TODO: Initialize to an appropriate value\n            int actual;\n            actual = target.Mult(a, b);\n            Assert.AreEqual(expected, actual);\n            Assert.Inconclusive(\"Verify the correctness of this test method.\");\n        }\n</code></pre>\n\n<p>Seems straight forward enough, but am I missing something trivial?</p>\n"},{"tags":["c#","enums","contains"],"answer_count":9,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":274,"score":14,"question_id":13248869,"title":"C# enum contains value","body":"<p>I have an enum</p>\n\n<pre><code>enum myEnum2 { ab, st, top, under, below}\n</code></pre>\n\n<p>I would like to write a function to test if a given value is included in myEnum</p>\n\n<p>something like that:</p>\n\n<pre><code>private bool EnumContainValue(Enum myEnum, string myValue)\n{\n     return Enum.GetValues(typeof(myEnum))\n                .ToString().ToUpper().Contains(myValue.ToUpper()); \n}\n</code></pre>\n\n<p>But it doesn't work because myEnum parameter is not recognized.</p>\n"},{"tags":["c#","performance"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1395,"score":4,"question_id":2443164,"title":"Does variable name length matter for performance C#?","body":"<p>I've been wondering if using long descriptive variable names in WinForms C# matters for performance? I'm asking this question since in AutoIt v3 (interpreted language) it was brought up that having variables with short names like <code>aa</code> instead of <code>veryLongVariableName</code> is much much faster (when program is bigger then 5 liner). I'm wondering if it's the same in C#?</p>\n"},{"tags":["c#","windows-phone-7","dll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13270025,"title":"Could not add reference to dll file","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12520212/exception-from-hresult-0x80131047\">Exception from HRESULT: 0x80131047</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to add reference .dll file to my WP7 application. Getting an error</p>\n\n<blockquote>\n  <p>The given assembly name or codebase was invalid. Exception from\n  HRESULT:0x80131047</p>\n</blockquote>\n"},{"tags":["c#","javascript",".net","asp.net","json"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":1495,"score":0,"question_id":7559676,"title":"How to correctly deserialize a JSON string into the class that contains a nested List of another class","body":"<p>I have the following object graph and I'm using Jquery's $.Ajax() to send this identical \"View\" object in JSON (stringified) from the browser to a Page Method on ASP.Net. The JAvascript deserialization works for all of the strings and int's in the View class but My <code>List&lt;DataItem&gt;</code> is empty. </p>\n\n<p>What I tried: Using chrome dev tools, I took the stringified JSON, created a unit test and used both the <code>DataContractJsonSerializer</code> and the <code>JavaScriptSerializer</code>. The <code>DataContractJsonSerializer</code> object deserialized my object graph correctly but the <code>JavaScriptSerializer</code> dumped my List. How can I get the correct deserialization on my page method ?</p>\n\n<pre><code>public class View\n{\n    public string Text { get; set; }\n    public string AnotherText { get; set; }\n    public Int SomeInt { get; set; }\n    public List&lt;DataItem&gt; { get; set; }\n}\n\npublic class DataItem\n{\n    public Person person {get;set}\n}\n\npublic class Person\n{\n    public int Age {get;set}\n}\n\n   var dataa = {mqvm: mqvmJSON };\n    $.ajax({\n        type: \"POST\",\n        dataType: \"json\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify( dataa ),\n        url: \"GoHere.aspx/WebMethodName\",\n        success: function(data) {\n            alert(data.d);\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            alert(jqXHR.responseText + ' ' + errorThrown);\n        }\n    });\n</code></pre>\n\n<p>Instead of this (the view obj as a param).</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(View mqvm)\n    { \n        return \"Success\";\n    }\n</code></pre>\n\n<p>how can I get this? (the string param)</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(string mqvm)\n    { \n        //do manual JSON deserialization here.\n\n        return \"Success\";\n    }\n</code></pre>\n\n<p>My JSON looks like this.</p>\n\n<pre><code>    {\n    \"Text\": \"6\",\n    \"AnotherText\":\"wow\"\n    \"SomeInt\": 5,\n    \"DataItem\":[\n        {\n            \"person\":{\n                \"Age\":23\n            }\n        },\n        {\n            \"person\":{\n                \"Age\":42\n            }\n        }\n    ]\n}\n</code></pre>\n"},{"tags":["c#","asp.net","twitter","twitter-api","asp.net-webforms"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13269985,"title":"Twitter API get user feed","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3800850/how-to-read-twitter-feeds\">How to read Twitter feeds</a>  </p>\n</blockquote>\n\n\n\n<p>I am looking for some samples to get the twitter feed (public feed) for an user in C#, ASP.NET. Whatever samples I found are using OAuth etc, but I am not able to find any sample which provides just feed without any authentication. </p>\n\n<p>Any sample is highly appricated. </p>\n\n<p>PS: I don't want to use the twitter widgets</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13270060,"title":"Is there a way I can find out if a string in C# does not contain the numbers & characters 0-9 and A-Z?","body":"<p>I have seen some kind of regular expression tests but how can I check if a string does not contain any of the 0-9 numbers or A-Z characters?</p>\n"},{"tags":["c#",".net","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13253315,"title":"Entity Framework does not generate association property","body":"<p>So.</p>\n\n<p>I'm having trouble fixing this little problem.</p>\n\n<p>I have several classes, and it's all nice and good. Right up until now. I have now added another class (MatchResult), and it works. \n<img src=\"http://i.stack.imgur.com/QYrFi.png\" alt=\"Before\"></p>\n\n<p>But when I try to make the correct association: </p>\n\n<p><img src=\"http://i.stack.imgur.com/ojGaq.png\" alt=\"enter image description here\"></p>\n\n<p>It fails with a runtime exception.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Schema specified is not valid. Errors: </p>\n  \n  <p>The relationship 'DbModel.FK_ProductPrice' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n  \n  <p>The relationship 'DbModel.FK_WebshopProduct' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n</blockquote>\n\n<p>It seems - for some reason - that EF does not create the MatchResults property on the Product class.</p>\n\n<p>This approach has worked on every single class I've ever made using EF. Up until now.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":7,"view_count":69,"score":-4,"question_id":13270739,"title":"How can you set a default checkbox value C#?","body":"<p>How can you set a default checkbox value? Yes i'm new at all this. But I'm learning well. </p>\n"},{"tags":["c#","php","md5sum"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13200767,"title":"c# hash and php MD5 file/folder hash not the same","body":"<p>I have to MD5 hash files/folders on both a client(C#) and a server(PHP) file structure. (Server land is PHP and client land is c#.) The problem is while they work they do not match. Any ideas would be greatly appreciated</p>\n\n<p>Here are my two algorithms</p>\n\n<p>C#</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Security.Cryptography;\nusing System.Text;\n\nnamespace nofolder\n{\n    public class classHasher\n    {\n        /**********\n         *  recursive folder MD5 hash of a dir\n         */\n        MD5 hashAlgo = null;\n        StringBuilder sb;\n        public classHasher()\n        {\n            hashAlgo = new MD5CryptoServiceProvider();\n        }\n        public string getHash(String path)\n        {\n            // get the file attributes for file or directory\n            if (File.Exists(path)) return getHashOverFile(path);\n            if (Directory.Exists(path)) return getHashOverFolder(path);\n            return \"\";\n        }\n        public string getHashOverFolder(String path)\n        {\n            sb = new StringBuilder();\n            getFolderContents(path);\n            return sb.ToString().GetHashCode().ToString();\n        }\n        public string getHashOverFile(String filename)\n        {\n            sb = new StringBuilder();\n            getFileHash(filename);\n            return sb.ToString().GetHashCode().ToString();\n        }\n        private void getFolderContents(string fold)\n        {\n            foreach (var d in Directory.GetDirectories(fold))\n            {\n                getFolderContents(d);\n            }\n            foreach (var f in Directory.GetFiles(fold))\n            {\n                getFileHash(f);\n            }\n        }\n        private void getFileHash(String f)\n        {\n            using (FileStream file = new FileStream(f, FileMode.Open, FileAccess.Read))\n            {\n                byte[] retVal = hashAlgo.ComputeHash(file);\n                file.Close();\n                foreach (var y in retVal)\n                {\n                    sb.Append(y.ToString());\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>PHP</p>\n\n<pre><code>function include__md5_dir($dir){\n    /**********\n    *   recursive folder MD5 hash of a dir\n    */\n    if (!is_dir($dir)){\n        return  md5_file($dir);\n    }\n\n    $filemd5s = array();\n    $d = dir($dir);\n\n    while (false !== ($entry = $d-&gt;read())){\n        if ($entry != '.' &amp;&amp; $entry != '..'){\n             if (is_dir($dir.'/'.$entry)){\n                 $filemd5s[] = include__md5_dir($dir.'/'.$entry);\n             }\n             else{\n                 $filemd5s[] = md5_file($dir.'/'.$entry);\n             }\n         }\n    }\n    $d-&gt;close();\n    return md5(implode('', $filemd5s));\n}\n</code></pre>\n\n<p><strong>EDIT.</strong></p>\n\n<p>I have decided <em>the c# must change</em>. <strong>the PHP is fine as it is</strong>. The first code that works 100% gets the bounty</p>\n"},{"tags":["c#","asp.net","aspect-ratio"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":540,"score":3,"question_id":10070296,"title":"C# : How to calculate aspect ratio","body":"<p>I am relatively new to programming. I need to calculate the aspect ratio(16:9 or 4:3) from a given dimension say axb. How can I achieve this using C#. Any help would be deeply appreciated.</p>\n\n<pre><code>public string AspectRatio(int x, int y)\n{\n //code am looking for\n return ratio\n}\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","windows","vb.net","networking"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":8589,"score":2,"question_id":5570004,"title":"How to change LAN Settings (proxy configuration) programmatically","body":"<p>I am writing a program to automatically switch my proxy address based on the network I am connected to.</p>\n\n<p>I have so far got everything to work except the part that I have highlighted below.  </p>\n\n<p><img src=\"http://imgur.com/FZFS8.png\" alt=\"LAN Settings Dialog\"></p>\n\n<p>Is there any way to change the automatic configuration script and the automatically detect settings in code?</p>\n\n<p>The solution can be either P/Invoke registry editing. I just need something that works.</p>\n"},{"tags":["c#","java","dll","jni"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":605,"score":3,"question_id":10977200,"title":"Calling C# dll from Java","body":"<p>I am a Java developer. But, for some reason I have to take the help of C# to accomplish my task. I have below mentioned C# code which is used to create a DLL. That DLL has to be used in my Java program to do the needful.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing Microsoft.Office.Interop.Word;\n\nnamespace Yrl.Tracingtool\n{\npublic class DocxUtil\n{\n    public Application Jump(string fileName)\n    {\n\n        object fileNameAsObject = (object)fileName;\n        Application wordApplication;\n        try\n        {\n            wordApplication = new Application();\n            object readnly = false;\n            object missing = System.Reflection.Missing.Value;\n            wordApplication.Documents.Open(ref fileNameAsObject, ref missing, ref readnly, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing,\n                                            ref missing, ref missing, ref missing, ref missing);\n            object what = Microsoft.Office.Interop.Word.WdGoToItem.wdGoToPage;\n            object which = Microsoft.Office.Interop.Word.WdGoToDirection.wdGoToFirst;\n            object count = 3;\n\n            wordApplication.Selection.GoTo(ref what, ref which, ref count, ref missing);\n\n            return wordApplication;\n        }\n        catch (Exception ex)\n        {\n            //LogEntry log = new LogEntry();\n            //log.Categories.Add(\"Trace\");\n            //log.Message = ex.ToString();\n            //Logger.Write(log, \"Trace\");\n            throw new System.IO.FileLoadException(\"File cannot be opened\");\n        }\n        finally\n        {\n            wordApplication = null;\n        }\n    }\n}\n}\n</code></pre>\n\n<p>I have checked this forum and other forums too, but most of them talk about using a C++ or C DLL file in a JNI call. If anyone is having knowledge of calling C# DLL from Java please let me know.</p>\n"},{"tags":["c#","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":54,"score":0,"question_id":13269993,"title":"Regular expression to validate numbers separated by commas or dashes","body":"<p>It should validate something like this</p>\n\n<pre><code>12,14,15,18-20,23,50-130\n</code></pre>\n\n<p>I think of this:</p>\n\n<pre><code>^(?:\\\\d[,] | \\\\d[-])$ // or ^(?:\\\\d[,] | \\\\d[-] *)$ ??\n</code></pre>\n\n<p><strong>EDIT</strong>\nIt should work for</p>\n\n<pre><code>12,  15\n11,13, 14,18, 51-52\n</code></pre>\n\n<p>It should't work for</p>\n\n<pre><code>w,12\n12,15d\n14,,18\n14--20\n12,12-\n-12,13\n,12\n12,\n13-,\n-,13\n</code></pre>\n"},{"tags":["c#","asp.net","linq","orm","informix"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":359,"score":2,"question_id":9043819,"title":"Confusion about selecting the suitable ORM?","body":"<p>I use <code>asp.net with informix</code> database.</p>\n\n<p>I use a set of written classes to handle the connections, the CRUD operations, transactions, etc....</p>\n\n<p>Now, I feel these classes are not the best choice, less performance,take a lot of time and have many drawbacks.</p>\n\n<hr>\n\n<p>I want to use an <code>ORM</code>, but I don't know how to choose the one which suits my web applications<code>(asp.net,Informix)</code>.</p>\n\n<p>Please help to select the convenient <code>ORM</code>.</p>\n\n<p>I'm confused among nhibernate , Entity framework , LinQ To SQl , and the open Access (Telerik Component)</p>\n\n<p>Note : i will use Visual studio 2012 so i want the recent comparison. </p>\n"},{"tags":["c#",".net","drivers","umdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":11924740,"title":"UMDF Development in .NET","body":"<p>Does anyone know if the current state of Microsoft's UMDF allows for driver development in .NET?</p>\n"},{"tags":["c#","c++","windows","64bit","umdf"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":352,"score":1,"question_id":5265773,"title":"UMDF driver for loopback joystick device","body":"<p>I'm trying to write a UMDF device driver for a loopback (virtual) joystick device in Windows, similar to the <code>uinput</code> device in Linux.</p>\n\n<p>I'm familiar with C++, C (on Linux) and C#, and the application I'm writing this for, <a href=\"http://digitalsquid.co.uk/droidpad/\" rel=\"nofollow\" title=\"DroidPad\">DroidPad</a>, is written in C#. I've already downloaded the WDK and looked at several examples.</p>\n\n<p>I decided to try the UMDF framework as I believe that user-mode drivers don't need to be signed in 64-bit windows 7; this is the problem with the joystick driver currently used by DroidPad, <a href=\"http://ppjoy.blogspot.com/\" rel=\"nofollow\" title=\"PPJoy\">PPJoy</a>.</p>\n\n<p>Any help would be greatly appreciated as to developing a UMDF driver for a virtual input device, as well as sending data to the driver from a C# application. Does anyone know of any similar UMDF driver (something similar to <code>uinput</code>)? I also read somewhere that the UMDF framework can be used from C#, how manageable would this be?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270546,"title":"How to query a XML with namespaces in the name?","body":"<p>I'm working with a XML like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ListOfLore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;                \n        &lt;q1:LoreNumber&gt;15642&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;\n        &lt;q1:LoreNumber&gt;15644&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n&lt;/ListOfLore&gt;\n</code></pre>\n\n<p>I'm doing this and I'm getting nothing</p>\n\n<pre><code>var lores = (from ListOfLore in pjs.Descendants(\"ListOfLore\")\n                              from Lore in ListOfLore.Descendants()\n                              where Lore.Name.LocalName == (\"Lore\") \n                              select Lore);\n</code></pre>\n\n<p>I want to get all of <code>Lore</code> items from the <code>ListOfLore</code></p>\n"},{"tags":["c#","listbox","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13252351,"title":"ListBox populated with DataSet doesn't update","body":"<p>Second Version</p>\n\n<p>I'm populating a <code>ListBox</code> using the following code </p>\n\n<pre><code>private BindingSource sri = new BindingSource();\n\npublic void sola()\n{\n    sri.DataSource = llenar.Tables[\"tipoender\"];\n    listBox1.DataSource = sri;\n    listBox1.ValueMember = \"end_tipoendereco\";\n    listBox1.DisplayMember = \"tpl_descricao\";\n}\n</code></pre>\n\n<p>I use this to DELETE (updating with the value 2 a determined column), when the column ID_tipoauditoria value =2 the record is not loaded . This code is working </p>\n\n<pre><code>DataSet grava = new DataSet();\nSqlDataAdapter da4 = new SqlDataAdapter();\nSqlCommandBuilder constru8 = new SqlCommandBuilder(da4);\nSqlParameter codi = new SqlParameter(\"@emp\", SqlDbType.Int);\ncodi.Value = codem;\nSqlCommand llena10 = new SqlCommand(\"dmlpjende\", conec1);\nllena10.Parameters.Add(codi);\nllena10.CommandType = CommandType.StoredProcedure;\nda4.SelectCommand = llena10;\nda4.Fill(grava, \"endere\");\nDataRow dr2 = grava.Tables[\"endere\"].Rows[ni];\n// listBox1.BackColor = Color.Red;\ndr2.BeginEdit();\ndr2[\"id_tipoauditoria\"] = 2;\ndr2.EndEdit();\nda4.Update(grava.Tables[\"endere\"]);\n</code></pre>\n\n<p>What is the best method to refresh the <code>ListBox</code>? I have tried resetting the binding with no-success. I only need to refresh the dataset or the listbox.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13270181,"title":"How end edit of a cell, changing its content when it's clicked?","body":"<p>I have changed a <code>DataGridViewCheckBoxCell</code> to contain a string at the right of the CheckBox that reflects the CheckBox value. When it's <code>true</code>, the string is \"Value1\"; when it's <code>false</code> the string should change to \"Value2\".</p>\n\n<p>The string value is changing only after the <code>DataGridViewCheckBoxCell</code> loses focus. I want the string value to change right after the CheckBox value changes. How can I do that?</p>\n\n<p>For reference, this is my personalized <code>DataGridViewCheckBoxCell</code> class:</p>\n\n<pre><code>public class MyDGVCheckBoxCell : DataGridViewCheckBoxCell\n{\n    public static string TRUE_VALUE = \"Excitada\";\n    public static string FALSE_VALUE = \"Monitorada\";\n\n    public MyDGVCheckBoxCell(bool isExcitada)\n    {\n        FalseValue = FALSE_VALUE;\n        TrueValue = TRUE_VALUE;\n        Value = isExcitada ? TRUE_VALUE : FALSE_VALUE;\n    }\n\n    protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates elementState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)\n    {\n        base.Paint(graphics, clipBounds, cellBounds, rowIndex, elementState, value, formattedValue, errorText, cellStyle, advancedBorderStyle, paintParts);\n\n        Rectangle contentBounds = this.GetContentBounds(rowIndex);\n\n        Point stringLocation = new Point();\n\n        stringLocation.Y = cellBounds.Y + 4;\n        stringLocation.X = cellBounds.X + contentBounds.Right + 1;\n\n        graphics.DrawString(this.Value.ToString(), Control.DefaultFont, System.Drawing.Brushes.Black, stringLocation);\n    }\n}\n</code></pre>\n"},{"tags":["c#","datetime"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13270429,"title":"Converting string to DateTime with offset","body":"<p>This is the string: <code>2007-08-31T06:59:40+02:00</code>\n<br>How do I convert it to <code>DateTime</code>?</p>\n"},{"tags":["c#","audio"],"answer_count":5,"favorite_count":17,"up_vote_count":23,"down_vote_count":0,"view_count":9165,"score":23,"question_id":1215326,"title":"Open source C# code to present wave form?","body":"<p>I just wanted to make a quick check,does any of you know of an open source c# code to present wave form (graphically) from a byte array? </p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","rest","asp.net-web-api","good-design"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":88,"score":6,"question_id":13256258,"title":"REST Standards - Should output models always match input models?","body":"<p>So I have the requirement that part of the output models must include UI important information. This information is essentially text translations and suggested formats for dates, prices, lengths.</p>\n\n<p>So an example of an output model could be:</p>\n\n<pre><code>{\n  statuses : {\n    enumValue1 : \"Display This Text\",\n    enumValue2 : \"Display This Text2\",\n  },\n  thePrice : {\n    value : 3.50,\n    formattedValue : \"$3.50\"\n  },\n  length : {\n    meters 3,\n    formattedValue : \"3 ft.\"\n  },\n  iAmAPropertyOnlyInGet : 42\n}\n</code></pre>\n\n<p>Now if I have this as my output model, is it \"ok\" to have a completely different input model?</p>\n\n<pre><code>{\n  status : {\n    enumValue1,\n    enumValue2,\n  },\n  thePrice : 3.50,\n  lengthInMeters : 3  \n}\n</code></pre>\n"}]}
{"total":375450,"page":15,"pagesize":100,"questions":[{"tags":["c#","wpf","mvvm","mvvm-light"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13213221,"title":"How a ViewModel communicates with its own View","body":"<p>I am developing a WPF MVVM Light application, I want to display some message boxes/dialog boxes or there are some other scenarios where I want my View model to communicate with its view or raise some event on its respective view.</p>\n\n<p>How could I achieve that?</p>\n"},{"tags":["c#","wkhtmltopdf"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12525322,"title":"How to use wkHtmltoPdf to generate PDf files from statcic html files in C#","body":"<p>Can Any 1 suggest me how to use wkhtmltopdf in C# Console application to generate PDF files from static html files ??</p>\n\n<p>wkhtmltopdf  -  <a href=\"http://code.google.com/p/wkhtmltopdf/\" rel=\"nofollow\">http://code.google.com/p/wkhtmltopdf/</a></p>\n\n<p>I have tried downloading the ibwkhtmltox-0.11.0_rc1 Windows Static Library (i368) \nbut cant include its dll into my c# console app.</p>\n\n<p>Any code samples will be help full</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","java","asp.net","java-ee","soa"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":964,"score":2,"question_id":3879140,"title":"Channels for Java, J2EE, C#, asp.net and SOA","body":"<p>What are the Freenode irc channels for Java, J2EE, C#, asp.net and SOA?\nThanks in advance..:)</p>\n"},{"tags":["c#","sharepoint","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13232543,"title":"check if folder exists c# webrequest","body":"<p>I'm using this to create a folder in an existing sharepoint location. Is there a way to check if a folder exists before creation instead of using try/catch to figure out of this method fails and then assume the folder exists?\nI've checked the webrequest methods, but there is no such this as a check.</p>\n\n<pre><code>try\n{\n    HttpWebRequest request = (System.Net.HttpWebRequest)HttpWebRequest.Create(\"https://site.sharepoint.com/files/\"+foldername);\n    request.Credentials = CredentialCache.DefaultCredentials;\n    request.UserAgent = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\";\n    request.Method = \"MKCOL\";\n    HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();\n    response.Close();\n}\ncatch (Exception ex) \n{ \n    //if this piece fails the folder exists already \n} \n</code></pre>\n"},{"tags":["c#","xml","garbage-collection","codesynthesis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13270244,"title":"Can garbage collection after writing XML files larger than 100MB cause an application to freeze?","body":"<p>So, I wrote a WPF application that takes in all sorts of data from a database, then using Code Synethesis it writes XML files based off of the data. The problem is, sometimes after it finishes writing, the application just seems to hang there, with the Windows Cursors.Wait icon and if I click in the application it freezes up completely and I have to Close Process on the application from Task Manager.</p>\n\n<p>Looking at a completed XML document (*.xml), its about 100MB to 200MB (including tags and everything), depending on the type of data. Is it possible that the garbage collection is the reason why the application seems to be busy for so long? Sometimes it sits for +30mins and it'll eventually resolve, but no idea why.</p>\n"},{"tags":["c#",".net","drawing","system.drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13269145,"title":"Get System.Drawing.Font width?","body":"<p>I'm using .Net tools to do some 2D drawing. <code>System.Drawing.Font</code> uses a <code>GetHeight()</code> that returns the height in pixels. I'm missing a <code>GetWidth()</code> to retrieve the width! What should I use?</p>\n"},{"tags":["c#","asp.net","visual-studio","gridview"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1358,"score":1,"question_id":8264670,"title":"ASP.NET Configure update button in GridView","body":"<p>I am using C# ASP.NET on VS2005. </p>\n\n<p>I have a gridview table but it does not have a selection for <em>Enable Editing</em> when I right click on the <em>Smart Tab</em>. </p>\n\n<p>Thus I manually added the edit button with the following code:</p>\n\n<p><code>AutoGenerateEditButton=\"True\"</code></p>\n\n<p>The edit button has successfully appeared on my gridview like this:\n<img src=\"http://i.stack.imgur.com/0ADAI.png\" alt=\"enter image description here\"></p>\n\n<p>When I click on the <em>Edit</em> button, the page is refreshed and the row is now editable:\n<img src=\"http://i.stack.imgur.com/ATTG9.png\" alt=\"enter image description here\"></p>\n\n<p>However, when I pressed on the update button, I was brought to the error:</p>\n\n<p><code>Updating is not supported by data source 'SqlDataSource1' unless UpdateCommand is specified.</code></p>\n\n<p><img src=\"http://i.stack.imgur.com/W97K0.png\" alt=\"enter image description here\">\n<a href=\"http://i.stack.imgur.com/W97K0.png\" rel=\"nofollow\">http://i.stack.imgur.com/W97K0.png</a></p>\n\n<p>I have no clue on how I can input or configure the <code>UpdateCommand</code> because I don't see any background code for the <code>Update</code> button.</p>\n\n<p>Need help from experienced. Thank you in advance.</p>\n\n<hr>\n\n<p>Edited: Added INSERT query in <code>SqlDataSource1</code>, however I still met the same error when I press the <code>Update</code> button.</p>\n"},{"tags":["c#","asp.net","nfc","mifare"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":8,"view_count":46,"score":-7,"question_id":13270298,"title":"Nfc mifare 1k card operation c#","body":"<p>i want a complete help for Nfc mifare 1k card operation.\ni want to read/write program (c#).</p>\n\n<p>Am using a mifare 1k card and NFC card reader.</p>\n\n<p>i want c# code for reading data and want to write data. as am a .net devplper, it is not easy to understand the hexa demical data and itz internal commands</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13270152,"title":"Pagination for Grid View","body":"<p>I am using a Grid View of asp.net 4.0. I want to use pagination.\nI am Handling Pagination with  SQL query. I am getting only the number of records, i want to show in my grid. I want to set the total number of records to my grid, so that my grid displays page numbers (eg. 1 2 3 ....8) according to my total number of records. My grid should tell me what is the current page number which is been viewed.\nI am unable to set Page numbers according to my total record count.\nPlease Help me on this.\nThanks in Advance.</p>\n"},{"tags":["c#",".net","wpf","serialization","application-settings"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":492,"score":2,"question_id":6309026,"title":"ApplicationSettingsBase writes empty tag for custom collection","body":"<p>I have been fighting with this off and on for several days now.  I need to store a collection of custom objects as part of the user's settings.  Based on lots of google work it seems that building a preferences class off of <code>ApplicationSettingsBase</code> is an appropriate way to do so.  The problem I run into is as soon as I try to store a collection of a custom type no data gets saved for that property.  If I keep to collections of base types, such as string, things work.  I have a separate proof of concept project I have been working with for the past day to isolate down to just this issue.</p>\n\n<p>This project consists of a WPF window with a listbox and two buttons, “+” and “-“.  I have a Prefs class with three properties defining different types of collections.  In my window code I bind the listbox to one of these lists and the buttons either add or remove an item to/from the list.  Closing the window should save the contents of the list to the users.config file for the current user.  Reopening it should display the saved contents of the list.</p>\n\n<p>If I use List1 (<code>ObservableCollection&lt;string&gt;</code>) and click the + button a few times then close the window the data is correctly saved to user.config.  However if I change and use List2(<code>ObservableCollection&lt;Foo&gt;</code>) or List3(<code>FooCollection</code>) I just end up with an empty value tag.  I have tried to implement <code>ISerializable</code> and <code>IXmlSerializable</code> in attempts to get this working with no change in behavior.  In fact running in debug mode with break points shows that the collection contains data when the save method is called but the serialization interface methods are never being called.</p>\n\n<p>What am I missing?  </p>\n\n<p>UPDATE: I have changed my approach and written the data off to another file alongside of user.config for the time being so that I can make some progress on other portions of the app.  But I would still like to know why application settings base was failing to record my collection data.</p>\n\n<p>Here is all of the relevent code, if someone thinks an ommitted section is important I will add it back into the post.</p>\n\n<p>user.config after adding a couple of elements to each list property</p>\n\n<pre><code>&lt;setting name=\"List1\" serializeAs=\"Xml\"&gt;\n    &lt;value&gt;\n        &lt;ArrayOfString xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n            xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;string&gt;0&lt;/string&gt;\n            &lt;string&gt;1&lt;/string&gt;\n            &lt;string&gt;2&lt;/string&gt;\n        &lt;/ArrayOfString&gt;\n    &lt;/value&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List2\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List3\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n</code></pre>\n\n<p>Window XAML</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;ListBox Name=\"l1\" Grid.Column=\"0\" Grid.Row=\"0\" ItemsSource=\"{Binding}\"&gt;&lt;/ListBox&gt;\n    &lt;StackPanel Grid.Column=\"1\" Grid.Row=\"0\"&gt;\n        &lt;Button Name=\"bP\" Margin=\"5\" Padding=\"5\" Click=\"bP_Click\"&gt;+&lt;/Button&gt;\n        &lt;Button Name=\"bM\" Margin=\"5\" Padding=\"5\" Click=\"bM_Click\"&gt;-&lt;/Button&gt;\n    &lt;/StackPanel&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Code Behind for Window</p>\n\n<pre><code>public partial class Window1 : Window\n{\n    Prefs Prefs = new Prefs();\n\n    public Window1()\n    {\n        InitializeComponent();\n\n        //l1.DataContext = Prefs.List1;\n        //l1.DataContext = Prefs.List2;\n        l1.DataContext = Prefs.List3;\n    }\n\n    private void Window_Closed(object sender, EventArgs e)\n    {\n        Prefs.Save();\n    }\n\n    private void bP_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.Add(Prefs.List1.Count.ToString());\n        //Prefs.List2.Add(new Foo(Prefs.List2.Count.ToString()));\n        Prefs.List3.Add(new Foo(Prefs.List3.Count.ToString()));\n    }\n\n    private void bM_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.RemoveAt(Prefs.List1.Count - 1);\n        //Prefs.List2.RemoveAt(Prefs.List2.Count - 1);\n        Prefs.List3.RemoveAt(Prefs.List3.Count - 1);\n    }\n}\n</code></pre>\n\n<p>Prefs class</p>\n\n<pre><code>class Prefs : ApplicationSettingsBase\n{\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;string&gt; List1\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;string&gt; Value = this[\"List1\"] as System.Collections.ObjectModel.ObservableCollection&lt;string&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;string&gt;();\n                this[\"List1\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; List2\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; Value = this[\"List2\"] as System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;();\n                this[\"List2\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public FooCollection List3\n    {\n        get\n        {\n            FooCollection Value = this[\"List3\"] as FooCollection;\n            if (Value == null)\n            {\n                Value = new FooCollection();\n                this[\"List3\"] = Value;\n            }\n            return Value;\n        }\n    }\n}\n</code></pre>\n\n<p>Foo Class</p>\n\n<pre><code>[Serializable()]\nclass Foo : System.ComponentModel.INotifyPropertyChanged, ISerializable, IXmlSerializable\n{\n    private string _Name;\n    private const string PropName_Name = \"Name\";\n    public string Name\n    {\n        get { return this._Name; }\n        set\n        {\n            if (value != this._Name)\n            {\n                this._Name = value;\n                RaisePropertyChanged(Foo.PropName_Name);\n            }\n        }\n    }\n    public override string ToString()\n    {\n        return Name;\n    }\n\n    public Foo() { }\n    public Foo(string name)\n    {\n        this._Name = name;\n    }\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public Foo(SerializationInfo info, StreamingContext context)\n    {\n        this._Name = (string)info.GetValue(Foo.PropName_Name, typeof(string));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(Foo.PropName_Name, this._Name);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        reader.MoveToContent();\n        _Name = reader.GetAttribute(Foo.PropName_Name);\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        writer.WriteAttributeString(Foo.PropName_Name, _Name);\n    }\n    #endregion\n}\n</code></pre>\n\n<p>and FooCollection class</p>\n\n<pre><code>[Serializable()]\nclass FooCollection : ICollection&lt;Foo&gt;, System.ComponentModel.INotifyPropertyChanged, INotifyCollectionChanged, ISerializable, IXmlSerializable\n{\n    List&lt;Foo&gt; Items;\n    private const string PropName_Items = \"Items\";\n\n    public FooCollection()\n    {\n        Items = new List&lt;Foo&gt;();\n    }\n\n    public Foo this[int index]\n    {\n/***Omitted for space***/\n    }\n\n    #region ICollection&lt;Foo&gt; Members\n/***Omitted for space***/\n    #endregion\n\n    public void RemoveAt(int index)\n    {\n/***Omitted for space***/\n    }\n\n    #region IEnumerable Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyCollectionChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public FooCollection(SerializationInfo info, StreamingContext context)\n    {\n        this.Items = (List&lt;Foo&gt;)info.GetValue(FooCollection.PropName_Items, typeof(List&lt;Foo&gt;));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(FooCollection.PropName_Items, this.Items);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        reader.MoveToContent();\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            if (reader.IsStartElement(FooCollection.PropName_Items))\n            {\n                reader.ReadStartElement();\n\n                while (reader.IsStartElement(\"Foo\"))\n                {\n                    this.Items.Add((Foo)FooSerializer.Deserialize(reader));\n                }\n\n                reader.ReadEndElement();\n            }\n\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        writer.WriteStartElement(FooCollection.PropName_Items);\n\n        foreach (Foo Item in Items)\n        {\n            writer.WriteStartElement(\"Foo\");\n            FooSerializer.Serialize(writer, Item);\n            writer.WriteEndElement();//\"Foo\"\n        }\n\n        writer.WriteEndElement(); //FooCollection.PropName_Items\n    }\n    #endregion\n}\n</code></pre>\n"},{"tags":["c#","facebook","windows-phone-7","share"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":377,"score":2,"question_id":8374585,"title":"WP 7.5 ShareLinkTask doesn't add miniature in facebook","body":"<p>My users are complaining that when they share a link to an image (directly) on facebook they don't get miniature next to it... is there something I'm doing wrong (I'm using WP 7.5 ShareLinkTask class, code below)? Or is the only way to re-implement or use other FB library?</p>\n\n<pre><code>        ShareLinkTask t = new ShareLinkTask();\n        t.LinkUri = new Uri(model.ImageUrl);\n        t.Title = model.Name;\n        t.Show();\n</code></pre>\n\n<h2>-------------------------------------</h2>\n\n<p><strong>This is what I mean:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/X50lP.png\" alt=\"This is what I mean\"></p>\n"},{"tags":["c#","java","asp.net","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13268218,"title":"Replace existing existing pdf form field with new form field at the same palce","body":"<p>I need to replace a check box in existing pdf with new check box using ItextSharp.</p>\n\n<p>While reading the Pdf how do I know the location of form field which I am reading.</p>\n\n<p>rectangle measures and page information (If the form field I am reading now is in page number 6). </p>\n\n<p>Precisely what I want to know is how to know existing form field location while reading?\nCan anyone provide some sample code on finding location and page.</p>\n\n<p>Why am I trying to replace existing pdf? you can find the reason here.. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/13265592/unable-to-print-check-boxes-in-pdf\">Unable to print Check Boxes in pdf</a></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net","web-services","bytearray","jsonarray"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13268249,"title":"How to convert this json array into list","body":"<p>My json Array:</p>\n\n<pre><code> {\"lstResult\":[{\"food_photo\":[255,216,255,224,0,16,74,70,73,70,0,1........3,5],\"food\":\"12\",\"qty_uom\":\"Pcs\",\"unit\":null}]}\n</code></pre>\n\n<p>my C# class:</p>\n\n<pre><code> public class lstresult\n    {\n    public photo[] lstResult{get;set;}\n    }\n\npublic class photo\n{\npublic byte[] food_photo{get;set;}\n}\npublic class Food\n{\n    public photo[] food_photo { get; set; }\n    public int food_qty { get; set; }\n    public string qty_uom { get; set; }\n    public string unitcost { get; set; }\n}\n</code></pre>\n\n<p>My question: </p>\n\n<blockquote>\n  <p>my json string contain a \"food_photo\" key how to convert this byte array into\n  image? or convert into list in asp.net\n  Thanks in advance</p>\n</blockquote>\n"},{"tags":["c#","gps","coordinates","latitude-longitude"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13269558,"title":"Find closest city to given location","body":"<p>I am trying to find the closest city to given location. I have stored location of some cities that I want to work with. And I have my location, but I dont know how to find the closest city to my location ?</p>\n\n<pre><code>Cities\nNew York - Lat 40.714353; Long -74.005973\nWashington - Lat 38.895112; Long -77.036366\n....more cities\n\nMy location\nPhiladephia - Lat 39.952335; Long -75.163789\n</code></pre>\n\n<p>So how should I compare the coords to find the closest city ? I am doing program in C# but just knowing the solution of algorythm is enaught for me :)\nThanks for any help</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-membership","viewdata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13269786,"title":"Storing Additional Information About a Logged In ASP.NET MVC User","body":"<p>I need to store an ID against a user that will be used in EVERY action that is carried out on my web application. I had hoped to use a customized authorization <code>ActionFilterAttribute</code> (on an entire controller) to populate the <code>ViewData</code> with this additional info, but it turns out that a whole STACK of stuff runs before these <code>ActionFilterAttributes</code> do e.g. ModelBinding, Controller construction</p>\n\n<p>I thought perhaps there may be a way to extend the <code>HttpContext.User.Identity</code> to store additional data but have no idea even where to start.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","winforms","image-processing"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":28,"score":2,"question_id":13270031,"title":"Looking for high-level Instagram/Microsoft Word like image processing library","body":"<p>Currently, I am looking for a (commercial or free) .NET/C# image processing library for a WinForms project to apply customizable effects like Instagram or Microsoft Office Word does, e.g.:</p>\n\n<p><img src=\"http://i.stack.imgur.com/tg7VY.png\" alt=\"enter image description here\"></p>\n\n<p>I found plenty of image libraries like:</p>\n\n<ul>\n<li><a href=\"http://www.imagemagick.org/script/index.php\" rel=\"nofollow\">ImageMagick</a></li>\n<li><a href=\"http://www.leadtools.com/\" rel=\"nofollow\">Lead Tools</a></li>\n<li><a href=\"http://freeimage.sourceforge.net/\" rel=\"nofollow\">Free Image</a></li>\n<li><a href=\"https://www.atalasoft.com/products/dotimage-sdk-1\" rel=\"nofollow\">DotImage</a></li>\n<li>...</li>\n</ul>\n\n<p>Unfortunately, all these libraries seem to provide a rather low-level way of manipulating images. When it comes to high-level effects like borders, rotation, vintage filters like Instagram, etc., I found zero libraries.</p>\n\n<p>(Ironically, for JavaScript, <a href=\"http://stackoverflow.com/questions/8192317/create-instagram-esque-filters-with-javascript\">there are quite a few libraries out there</a>)</p>\n\n<p>Maybe there is no market for such a library, still I would love to have this function in my application without doing everything on my own.</p>\n\n<p><strong>Therefore my question is:</strong></p>\n\n<p>Is there a .NET library available to have a customizable and extendable way of applying various high-level filters to images?</p>\n"},{"tags":["c#",".net","visual-studio-2010","silverlight",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13229923,"title":"NullReferenceException on Fresh Silverlight Project - Designer","body":"<p>I just created a new Silverlight project along side an existing web project. (Visual Studio 2010)</p>\n\n<p>The designer window is now showing \"An unhandled exception has occured\". </p>\n\n<p><strong>Note: The project has no additional code added, it has only the default code.</strong></p>\n\n<p><em>Part of the stacktrace is below.</em></p>\n\n<p>System.NullReferenceException</p>\n\n<p>Object reference not set to an instance of an object.\n     at   </p>\n\n<p>Microsoft.Windows.Design.Platform.SilverlightMetadataContext.SilverlightXamlExtensionImplementations.d__8.MoveNext()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.BuildSubsumption()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.SubsumingNamespace(Identifier identifier)</p>\n"},{"tags":["c#","xml-parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":222,"score":0,"question_id":11241977,"title":"XML Clean up (remove invalid characters from attribute value)","body":"<p>How can i remove none valid chars from xml but keep standard\nfor example i want remove all &lt; and \" from attribute value inner strings</p>\n\n<pre><code>&lt;log&gt;\n  &lt;data id=\"1\" name=\"No Error\"  value=\"0\" /&gt;\n  &lt;data id=\"2\" name=\"Error \"1\" between text\" value=\"0\" /&gt;\n  &lt;data id=\"3\" name=\"Error &lt;2&gt; between text\"  value=\"0\"  /&gt;\n&lt;/log&gt;\n</code></pre>\n\n<p>How can i daynamicly remove quotes surrounds \"1\"\nand &lt;> surrounds 2</p>\n\n<p>that final out put shuld be</p>\n\n<pre><code>&lt;log&gt;\n  &lt;data id=\"1\" name=\"No Error\"  value=\"0\"  /&gt;\n  &lt;data id=\"2\" name=\"Error 1 between text\" value=\"0\" /&gt;\n  &lt;data id=\"3\" name=\"Error 2 between text\"  value=\"0\"  /&gt;\n&lt;/log&gt;\n</code></pre>\n\n<p>Thanks for the suppot</p>\n\n<p>I was thinking of the following solution:</p>\n\n<ol>\n<li>Read the file as text</li>\n<li>Modify any string that starts with <code>&lt;Name=&gt;</code> and ends with\n<code>&lt;value=&gt;</code></li>\n<li>remove all <code>\",&lt;,&gt;</code> </li>\n<li>add <code>\"</code> after <code>&lt;name=&gt;</code> and add <code>\"</code> before <code>&lt;value=&gt;</code></li>\n</ol>\n\n<p>if this is correct, how can i do this with C#, the replace method will not work.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","xna"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":46,"score":1,"question_id":13259841,"title":"Button press calls method multiple times","body":"<p>i'm working on a XNA game and i've encountered a problem. Whenever i press a key in the game, the method that is triggered by the key press is called multiple times. For example, when the user presses the attack button (space) the character attacks like 10 times within one  key press. I want the key press to trigger the method just one time. Even if the user holds down a key i want some methods to be called only once. For now i've solved it by writing a thread.sleep after each button press, but that seems VERY unefficient. I hope my problem i understandable. Thanks in advance!</p>\n"},{"tags":["c#","xml","excel","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13269987,"title":"I need to flatten this XML data, so i can import it to Excel","body":"<p>I've been trying for days to get this data into Excel or Access, but i have little experience with XML / XSD. I dont know what is the best approach when it comes to importing data into Excel/Access. Excel doesn't support nested elements afaik. Access dont seem to bother with the linking of nested data. Sooo i might end up flattening the structure my self for Excel, which in either case would be the program i need for final analysis.</p>\n\n<p>I would like it flat or even csv format, but my concern is the size of the file. I have a subset of the data now an this xml file is already 11Meg and its a few precent of the total data.</p>\n\n<p>This is my XML file, a subset.</p>\n\n<pre><code>    &lt;Root&gt;\n    &lt;Delivery&gt;\n    &lt;Database&gt;xxxxxxx&lt;/Database&gt;\n    &lt;Path&gt;SomeUNCPath&lt;/Path&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n</code></pre>\n"},{"tags":["c#","text-to-speech","speech-synthesis"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":449,"score":2,"question_id":10304913,"title":"Speech Synthesizer \"Input string was not in a correct format\"","body":"<p>Here is my code:</p>\n\n<pre><code>string _message = \"Hello world.\";\nSpeechSynthesizer _synth = new SpeechSynthesizer();\nPrompt _prompt = new Prompt(_message);\n_synth.Speak(_prompt);\n</code></pre>\n\n<p>I can not for the life of me figure out what exactly is causing this error:</p>\n\n<p>\"Input string was not in a correct format.\"</p>\n\n<p>The line that causes this error is when I call <code>_synth.Speak(_prompt);</code>\n<br/>\nEDIT: I have tried this code on my desktop computer and it works fine so something is wrong with my install on my laptop. Still I'm not too sure how to fix this...<br/></p>\n\n<p>EDIT:</p>\n\n<p>The stacktrace:</p>\n\n<pre><code>System.FormatException: Input string was not in a correct format.\n   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffe\nr&amp; number, NumberFormatInfo info, Boolean parseDecimal)\n   at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo in\nfo)\n   at System.Speech.Internal.SapiAttributeParser.GetCultureInfoFromLanguageStrin\ng(String valueString)\n   at System.Speech.Synthesis.VoiceInfo..ctor(VoiceObjectToken token)\n   at System.Speech.Internal.Synthesis.VoiceSynthesis.BuildInstalledVoices(Voice\nSynthesis voiceSynthesizer)\n   at System.Speech.Internal.Synthesis.VoiceSynthesis..ctor(WeakReference speech\nSynthesizer)\n   at System.Speech.Synthesis.SpeechSynthesizer.get_VoiceSynthesizer()\n   at System.Speech.Synthesis.SpeechSynthesizer.Speak(Prompt prompt)\n   at TTSTesting.Program.Speak(String _message) in C:\\Users\\ctanaka\\Desktop\\TTST\nesting\\TTSTesting\\Program.cs:line 22\n</code></pre>\n"},{"tags":["c#","multithreading","waithandle"],"answer_count":4,"favorite_count":8,"up_vote_count":15,"down_vote_count":0,"view_count":5605,"score":15,"question_id":2702545,"title":"Workaround for the WaitHandle.WaitAll 64 handle limit?","body":"<p>My application spawns loads of different small worker threads via <code>ThreadPool.QueueUserWorkItem</code> which I keep track of via multiple <code>ManualResetEvent</code> instances. I use the <code>WaitHandle.WaitAll</code> method to block my application from closing until these threads have completed.</p>\n\n<p>I have never had any issues before, however, as my application is coming under more load i.e. more threads being created, I am now beginning to get this exception:</p>\n\n<p><code>WaitHandles must be less than or equal to 64 - missing documentation</code></p>\n\n<p>What is the best alternative solution to this?</p>\n\n<p><b> Code Snippet </b></p>\n\n<pre><code>List&lt;AutoResetEvent&gt; events = new List&lt;AutoResetEvent&gt;();\n\n// multiple instances of...\nvar evt = new AutoResetEvent(false);\nevents.Add(evt);\nThreadPool.QueueUserWorkItem(delegate\n{\n    // do work\n    evt.Set();\n});\n\n...\nWaitHandle.WaitAll(events.ToArray());\n</code></pre>\n\n<p><b> Workaround </b></p>\n\n<pre><code>int threadCount = 0;\nManualResetEvent finished = new ManualResetEvent(false);\n\n...\nInterlocked.Increment(ref threadCount);\nThreadPool.QueueUserWorkItem(delegate\n{\n    try\n    {\n         // do work\n    }\n    finally\n    {\n        if (Interlocked.Decrement(ref threadCount) == 0)\n        {\n             finished.Set();\n        }\n    }\n});\n\n...\nfinished.WaitOne();\n</code></pre>\n"},{"tags":["c#","dynamic-html"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13230044,"title":"dynamically change the html table tag width which is in string","body":"<p>I am doing a CLR procedure of sending mail, I have composed the html into my string , After binding some dynamic values I have been able to send mail.</p>\n\n<p>But Now the issue is , I am getting a string which containing the HTML, So I want to find the first <code>&lt;table&gt;</code> and then change its width. it.[Due to large width the template is disturbing]. This  is the body of the email.</p>\n\n<pre><code> string StrHtml =\" &lt;table cellspacing='1' cellpadding='10' border='0'\nstyle='width:880px'&gt;&lt;/table&gt;\"\n</code></pre>\n\n<p>I want to change the <code>style='width:880px' to style='width:550px'</code></p>\n\n<p>I am doing this code only in class library. what is the best way to do this?</p>\n\n<p>My Code is :</p>\n\n<pre><code>string ImgPath = string.Empty;\nImgPath = Convert.ToString(ds.Tables[0].Rows[i][\"GroupMessage\"]);\nstring pattern = string.Empty;\npattern = System.Text.RegularExpressions.Regex.(ImgPath, \"(&lt;table.*?&gt;.*&lt;/table&gt;\", System.Text.RegularExpressions.RegexOptions.IgnoreCase).Groups[1].Value;  \n\nMailMessage message = new MailMessage();\nmessage.AlternateViews.Add(htmlMail);\nmessage.Body = ImgPath ; //\nmessage.IsBodyHtml = true;\n//Other mail sending code here.....\n</code></pre>\n"},{"tags":["c#","winforms","random","numbers"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13269757,"title":"Generating a number with 7 digits with the ability to have zeros at the front","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4325267/c-sharp-convert-int-to-string-with-padding-zeros\">C# convert int to string with padding zeros?</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to generate a random number however in the ranges I have included \"0000000, 9999999\" I want it to show these zeros when a number is generated for example the following outputs would be:</p>\n\n<p>\"00037544\"\n\"01659369\" \n\"75484957\"\n\"00000001\"</p>\n\n<p>I am using the:</p>\n\n<pre><code>    int num = rnd.Next(0000000, 9999999);\n</code></pre>\n\n<p>The problem with that is sometimes it will generate:</p>\n\n<p>\"1648\"\n\"947596\"\n\"18500\" etc</p>\n\n<p>Is there something that im missing? </p>\n\n<p>Thanks for looking</p>\n"},{"tags":["c#",".net","mp3"],"answer_count":6,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":5466,"score":7,"question_id":1214040,"title":"How to get the length of a MP3 in C#","body":"<p>Yes this is an exact duplicate of <a href=\"http://stackoverflow.com/questions/1007547/finding-mp3-length-in-c\">this question</a>, but the link given and accepted as answer is not working for me. It is returning incorrect values (a 2 minutes mp3 will be listed as 1'30, 3 minutes as 2'20) with no obvious pattern.</p>\n\n<p>So here it is again: how can I get the length of a MP3 using C# ? </p>\n\n<p><em>or</em></p>\n\n<p>What am I doing wrong with the <a href=\"http://www.devhood.com/tutorials/tutorial%5Fdetails.aspx?tutorial%5Fid=79\">MP3Header class</a>:</p>\n\n<pre><code>MP3Header mp3hdr = new MP3Header();\nbool boolIsMP3 = mp3hdr.ReadMP3Information(\"1.mp3\");\nif(boolIsMP3)\n  Response.Write(mp3hdr.intLength);\n</code></pre>\n"},{"tags":["c#",".net","mp3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":606,"score":3,"question_id":4499470,"title":"Is there a C# library that allows you to query mp3 duration and bitrate","body":"<p>I'm looking for an open source library (BSD/MIT style license) that allows me to extract the bitrate and duration of a MP3 audio file in dot net. </p>\n\n<p>Any takers?</p>\n"},{"tags":["c#",".net","directx","mp3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":268,"score":2,"question_id":11127092,"title":"How to retrieve the correct Duration of an mp3 audio file in C#/.NET/DirectX?","body":"<p>I am writing a media presentation program, and I am nearly complete, but for some reason I am getting incorrect durations of mp3 files. I use the Microsoft.DirectX.AudioVideoPlayback.Audio class to play audio files, and it works well for wav files. From google search, I can tell that it seems to be a problem when the mp3s are encoded using a variable bit rate, however I need my program to report accurately regardless of the bit rate settings of the media. Here is the code:</p>\n\n<pre><code>Media_Audio aud = (Media_Audio)item.MediaFile;\nTimeSpan total = aud.EndTime - aud.StartTime;\nif (aud.EndTime.TotalSeconds == 0)\n{\n    total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n}\nTimeSpan now = TimeSpan.FromSeconds(aud.Player.CurrentPosition) - aud.StartTime;\nstring nows = now.Hours.ToString() + \":\" + now.Minutes.ToString() + \":\" + now.Seconds.ToString();\nstring tots = total.Hours.ToString() + \":\" + total.Minutes.ToString() + \":\" + total.Seconds.ToString();\nitem.currentPosition.Text = nows + \"/\" + tots;\n</code></pre>\n\n<p>The key line being:</p>\n\n<pre><code>total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n</code></pre>\n\n<p>aud.Player is an instance of Microsoft.DirectX.AudioVideoPlayback.Audio.</p>\n\n<p>For a song that is, in fact, 5:49 seconds long, it reports 39:13 as the duration. The same length as Windows Explorer and VLC Player. Also, have the K-Lite Mega Codec pack installed. so it could be interfering. I am aware of this question: <a href=\"http://stackoverflow.com/questions/383164/how-to-retrieve-duration-of-mp3-in-net\">How to retrieve duration of MP3 in .NET?</a>\nHowever, at this stage in my program I do not have the time to switch from my current method of playing audio files to a new one, so do I have any other options to determine the duration using DirectX only? Or Will I have to resort to BASS.NET or TagLib Sharp? (And does meta-data even contain accurate information for VBR-encoded mp3s?)</p>\n"},{"tags":["c#","wpf","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":269,"score":1,"question_id":11363203,"title":"How to get a dynamic ListBox ItemTemplate to stretch horizontally the full width of the ListBox?","body":"<p>I have a normal listbox with a custom template to show the items. What I cannot manage is to stretch the template horizontally over the full widtg of the list box.</p>\n\n<p>My problem is, that all of the elements in the main window are put dynamically, and they resize along with the window size changed method. I've searched through the net and the idea was to put HorizontalAligment=\"Stretch\". This I tried, everywhere possible, with no significant success.</p>\n\n<p>my xaml code goes like this:</p>\n\n<pre><code>&lt;UserControl x:Class=\"LiveGames.Dealer.UsersList\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         mc:Ignorable=\"d\" \n         Background=\"Transparent\"&gt;\n&lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n     &lt;Grid&gt;\n        &lt;Grid.Resources&gt;\n            &lt;DataTemplate x:Key=\"PlayerTemplate\"&gt;\n                &lt;WrapPanel&gt;\n                    &lt;Border CornerRadius=\"10\" BorderBrush=\"White\" BorderThickness=\"2\" &gt;\n                        &lt;Border.Background&gt;\n                            &lt;LinearGradientBrush StartPoint=\"0.5,0\" EndPoint=\"0.5,1\"&gt;\n                                &lt;GradientStop Offset=\"0.0\" x:Name=\"gradientOne_Name\" Color=\"Red\" /&gt;\n                                &lt;GradientStop Offset=\"1.0\" x:Name=\"gradientTwo_Name\" Color=\"DarkRed\" /&gt;\n                            &lt;/LinearGradientBrush&gt;\n                        &lt;/Border.Background&gt;\n                        &lt;Grid &gt;\n                            &lt;Grid.ColumnDefinitions x:Uid=\"5\"&gt;\n                                &lt;ColumnDefinition  Width=\"*\"/&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;Grid.RowDefinitions&gt;\n                                &lt;RowDefinition Name=\"RowH\" Height=\"50\"/&gt;\n                            &lt;/Grid.RowDefinitions&gt;\n\n                            &lt;!--  &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Grid.Row=\"1\" Text=\"Player: \" FontSize=\"18\" /&gt;--&gt;\n                            &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"5\" Grid.Column=\"0\" Text=\"{Binding Path=ID}\" FontSize=\"22\" FontWeight=\"Bold\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/Border&gt;\n                &lt;/WrapPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/Grid.Resources&gt;\n        &lt;Canvas&gt;\n            &lt;ListBox Name=\"userList\" Background=\"Transparent\" BorderBrush=\"Transparent\" BorderThickness=\"0\" ItemsSource=\"{Binding}\"  ItemTemplate=\"{StaticResource PlayerTemplate}\" HorizontalContentAlignment=\"Stretch\"&gt;\n                &lt;ListBox.ItemContainerStyle&gt;\n                    &lt;Style TargetType=\"ListBoxItem\" &gt;\n                        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Stretch\"/&gt;\n                    &lt;/Style&gt;\n                &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;/ListBox&gt;\n        &lt;/Canvas&gt;\n    &lt;/Grid&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p></p>\n\n<p>Does anybody have any idea how to do this, maybe even in the code behind?</p>\n\n<p>M</p>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13265442,"title":"WPF Listview item highlight by their first character","body":"<p>I have a listview and it binds customer datas from database. I want to be focused by their first character. For example, when I click on to \"B\" from keyboard then, highlight focus must go to customers whose names' first character is \"B\". Do you have any idea? My listview's XAML is below.</p>\n\n<pre><code>&lt;ListView x:Name=\"datalist\" ButtonBase.Click=\"datalist_Click\" ContextMenuOpening=\"datalist_ContextMenuOpening\" MouseDoubleClick=\"datalist_MouseDoubleClick\" SelectionChanged=\"datalist_SelectionChanged\"\nMouseUp=\"datalist_MouseUp\" PreviewMouseUp=\"datalist_PreviewMouseUp\" &gt; \n</code></pre>\n"},{"tags":["c#","asp.net","sql","database","polling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13269609,"title":"Datatable: Does it retrieve all data at once or when it is needed","body":"<p>We have a performance problem in production, we are trying to solve. During our attempt to solve it, we have our eyes on the datatable. </p>\n\n<p><strong>Our flow</strong>:</p>\n\n<ol>\n<li>We run a select query on the database</li>\n<li>Put the data into a <code>DataTable</code></li>\n<li>We write out all the data into a <code>StringBuilder</code> with a separator</li>\n<li>The <code>StringBuilder</code> writes all text into the <code>Response.Write</code>, which builds a CSV file</li>\n</ol>\n\n<p>The problem is in production, our client says the operation times out. We can't reproduce the timeout in development, which might be because of the amounts of data in production.</p>\n\n<p><strong>Step 1</strong>:</p>\n\n<p>We've run a profiler on the select query, and that runs really fast.</p>\n\n<p><strong>Step 2</strong>:</p>\n\n<p>We have the following code:</p>\n\n<pre><code>SqlDataReader reader = searchQuery.ExecuteReader();\nreturnTable.Load(reader);\n</code></pre>\n\n<p><strong>Step 3</strong>:</p>\n\n<p>We iterate the <code>returnTable</code> like this:</p>\n\n<pre><code>foreach (DataRow order in orders.Rows)\n{\n      trackingNumber = order[\"TrackingNumber\"] != null ? order[\"TrackingNumber\"].ToString() : errString;\n      created = order[\"Created\"] != null ? ((DateTime)order[\"Created\"]).ToString() : errString;\n      // rest of the fields\n}\n</code></pre>\n\n<p><strong>Step 4:</strong></p>\n\n<pre><code>HttpContext.Current.Response.Write(bld.ToString());\n</code></pre>\n\n<p>Now, when we have run step 2, what happens? Is the <code>DataTable</code> fully loaded? </p>\n\n<p>I could see a problem if we poll the database in each and every row in step 3, as that could slow our process. But if it loads it all at once, I can't see how this could be a problem.</p>\n\n<p>So basically: does the <code>DataTable</code> load everything at once, or does it use lazy loading?</p>\n"},{"tags":["c#","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13269532,"title":"How to find RTF table cell color from the color table","body":"<p>I want read table contents from a RTF file along with table cell color information. In my RTF file, the color table defined as ,</p>\n\n<pre><code>{\\colortbl;\n\\red0\\green0\\blue0;\n\\red0\\green0\\blue255;\n\\red0\\green255\\blue255;\n\\red0\\green255\\blue0;\n\\red255\\green0\\blue255;\n\\red255\\green0\\blue0;\n\\red255\\green255\\blue0;\n\\red255\\green255\\blue255;\n\\red0\\green0\\blue128;\n\\red0\\green128\\blue0;\n\\red128\\green0\\blue128;\n\\red128\\green0\\blue0;\n\\red128\\green128\\blue0;\n\\red128\\green128\\blue128;\n\\red192\\green192\\blue192;\n}\n</code></pre>\n\n<p>and I have the RTF for table header row as ,</p>\n\n<pre><code>\\trowd \\trql\\trgaph90\\trleft-90\\trautofit1\n\\clvertalt\n\\clbrdrl\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrt\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrr\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrb\\brdrs\\brdrw15\\brdrcf1\n\\clcfpat7\\clcbpat8\\clshdng2000\n\\cellx1440\n\\clvertalt\n\\clbrdrl\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrt\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrr\\brdrs\\brdrw15\\brdrcf1\n\\clbrdrb\\brdrs\\brdrw15\\brdrcf1\n\\clcfpat7\\clcbpat8\\clshdng2000\n\\cellx2970\n\\pard\n\\intbl \\widctlpar\\keep\\hyphpar0\n\\li0\\ri0\\fi0\n\\ql{Product Name\\cell\n}{Price\\cell}\\row\n</code></pre>\n\n<p>Table cell background information are given as \"\\clcfpat7\\clcbpat8\\clshdng2000\".</p>\n\n<p>Please help me to find the correct color of the table cell from the color information.</p>\n"},{"tags":["c#","unit-testing","nunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13267723,"title":"NUnit - common assertions after each test","body":"<p>I'm writing service tests with database(without mocks).</p>\n\n<p>I have a new requirement to perform common database \"health\" checks* after each test in our test suits.</p>\n\n<p>The question is: where can I put this kind of tests/checks?</p>\n\n<p>At first I thought about TearDown, but AFAIK it was supposed(designed) to perform cleanup not assertions.\nWould it be ok to put it there? </p>\n\n<p>I'm not doing anything on teardown right now (and that is probably not going to change) - the database is cleaned on SetUp and each and every test is responsible for preparing the environment for itself.</p>\n\n<p>*- the database design is inherited from another company and unfortunately its very poor - we've discovered inconsistencies in data and that's why we need to perform 'health checks' to identify places where they occur</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":89,"score":0,"question_id":12941028,"title":"Group by multiple values and break down to weekly periods","body":"<p>I'm still learning LINQ and have a task where I need to group Booking objects by four properties and then by weekly intervals depending on the input timerange. </p>\n\n<pre><code>public class Booking\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public decimal Price { get; set; }\n    public bool Notification { get; set; }\n    public DateTime Date { get; set; }\n}\n</code></pre>\n\n<p>Let's say we have the following Bookings:</p>\n\n<pre><code>        IList&lt;Booking&gt; Bookings = new List&lt;Booking&gt;\n        {\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 150, Date = new DateTime(2012,06,01)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 100, Date = new DateTime(2012,06,02)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 200, Date = new DateTime(2012,06,03)},\n\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 80, Date = new DateTime(2012,06,10)},\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 110, Date = new DateTime(2012,06,12)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Accepted, Price = 225, Date = new DateTime(2012,06,20)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 300, Date = new DateTime(2012,06,21)},\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 140, Date = new DateTime(2012,06,22)},\n        };\n</code></pre>\n\n<p>That would result in the following lines on the final printout:</p>\n\n<pre><code>                                        Week 22     Week 23     Week 24     Week 25     Week 26\n                                        May28-Jun3  Jun4-10     Jun11-17    Jun18-24    Jun25-Jul1\n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price\n            ----------------------------------------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       0   0       0   0\n            Group2  Phone   Accepted    0   0       1   80      1   110     0   0       0   0\n            Group3  Store   Accepted    0   0       0   0       0   0       1   225     0   0       \n            Group3  Store   Invoiced    0   0       0   0       0   0       2   440     0   0           \n</code></pre>\n\n<p>I have created 2 additional classes to represent a line with the possibility to include any number of weeks:</p>\n\n<pre><code> public class GroupedLine\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public List&lt;WeeklyStat&gt; WeeklyStats { get; set; } \n}\n\npublic class WeeklyStat\n{\n    public DateTime WeekStart { get; set; }\n    public decimal Sum { get; set; }\n    public int Count { get; set; }\n}\n</code></pre>\n\n<p>If I have the following time period:</p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n</code></pre>\n\n<p>Firstly, I need to identify what weeks are necessary in the statistics: in this case week 22-26. </p>\n\n<p>For that I have the following code: </p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n\n        var firstWeek = GetFirstDateOfWeek(DateFrom, DayOfWeek.Monday);\n        IList&lt;DateTime&gt; weeks = new List&lt;DateTime&gt; { firstWeek };\n\n        while(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7) &lt;= DateTo)\n        {\n            weeks.Add(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7));\n        }\n</code></pre>\n\n<p>And now, I'd need some LINQ magic to do the grouping both by the 4 properties and the aggregation (count of bookings and sum of prices) for the weeks.</p>\n\n<p>I can attach code sample of the LINQ I got so far tomorrow, as I don't have access to it now.\nSorry for the long post, hope it's clear what I mean.</p>\n\n<p>Edit: 2012-11-07\nI have to modify the question a bit, so that the grouped weeks only include those weeks, that actually have data. \nUpdated example output:</p>\n\n<pre><code>                                        May28-Jun3  Jun4-10     Jun18-24    \n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  \n            ---------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       \n            Group2  Phone   Accepted    0   0       1   80      0   0       \n            Group3  Store   Accepted    0   0       0   0       1   225             \n            Group3  Store   Invoiced    0   0       0   0       2   440         \n</code></pre>\n\n<p>In this case there were no Bookings in period Jun 11-17 and Jun25-Jul1 so they are omitted from the results.</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13265833,"title":"How to move from directory to directory?","body":"<p>I am using <code>Directory.GetCurrentDirectory()</code> function. After I get current directory path I need to move two directories up and to get the path of this derictory to the path variable.</p>\n\n<p>Any idea how I can do that?</p>\n"},{"tags":["c#","wpf","growl"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1270,"score":3,"question_id":4643272,"title":"What \"growl\" type notification windows are available for WPF (windows that appear and fade after X seconds)?","body":"<p>I wanted to know if there are any good \"growl\" type notification windows available as open source or guided tutorials for WPF applications.  I'm looking for a window that can appear when users save for example, notifying them that the save was successful and then disappears after X seconds (with a fade out) without the user needing to take the explicit action to close the notification window.  This way for messages/notifications that require no confirmation, like the example, the user would not have to click \"OK\" to make the messagebox or dialog close.</p>\n"},{"tags":["c#","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13268673,"title":"C# threading, thread not persistant","body":"<p>Morning all,</p>\n\n<p>Using C# .NET 4.0 and Visual Studio 2012 Express.</p>\n\n<p>I have a program that runs some SQL stored procedures, then opens and Access database and auto generates the reports then emails them.</p>\n\n<p>I have it set on a date so it runs as soon as midnight comes.</p>\n\n<p>The following is a code sample.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Thread myUltiThread = new Thread(GetCurrentDate);\n    myUltiThread.Start();\n}\n\nprivate void GetCurrentDate()\n{\n    string myDate = \"\";\n    myDate = DateTime.Today.Day.ToString();\n\n    if(myDate == \"7\" &amp;&amp; myDateToggle == false)\n    {\n        Task t = new Task(() =&gt; RunMonthBackUp());\n        t.Start();\n    }\n\n    if (myDate == \"8\" &amp;&amp; myDateToggle == true)\n    {\n        myDateToggle = false;\n    }\n}\n</code></pre>\n\n<p>So as you can see once the button is pressed my program then starts the thread, which uses the getdate method, this method checks if the date is correct.</p>\n\n<p>if it is then it starts a task that runs the whole process.</p>\n\n<p>My problem is that this is not happening, I believe its because the method is only running once. I have a feeling this is due to my lack of understanding working with threads (only ever deal with tasks usually).</p>\n\n<p>Could someone point out to me where I am going wrong and how to get this set up properly?</p>\n\n<p>Many thanks guys</p>\n"},{"tags":["c#","thread-safety","volatile"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13269563,"title":"How to make Utility Methods for Thread","body":"<p>I want to make a re-usable piece of code that Threads can call to sleep until a certain time has been reached or they are told to cancel. The Cancel variable would be a volatile Boolean on the object that has the Thread.</p>\n\n<p>My approach was this:</p>\n\n<pre><code>public class ThreadUtil\n{\n    public static void SleepTillOrDone(DateTime till, ref bool done)\n    {\n        while ((!done) &amp;&amp; (DateTime.Now &lt; till))\n        {\n            var diff = till - DateTime.Now;\n            Thread.Sleep(diff.TotalMilliseconds &gt;= 100 ? 100 : 10);\n        }\n    }\n}\n</code></pre>\n\n<p>However, this gives a warning of \"a reference to a volatile field will not be treated as volatile\". After reading around a bit I understand what the warning means, but how would one write such a method that would be safe to use without the volatile keyword? Or is there a different &amp; completely better approach?</p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":164,"score":4,"question_id":9316847,"title":"Using Code Contracts to specify a return value may be null","body":"<p>Is there a way of explicitly specifying that a return value <em>can</em> be null using Code Contracts?</p>\n\n<p>My worry is that methods without a <code>Contract.Ensures(Contract.Result&lt;object&gt;() != null)</code> may be incorrectly 'fixed' in the future to include the post-condition, even though the original intention may have been to allow null results.</p>\n"},{"tags":["c#","sql","xml","nodelist","xmlnodelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13269221,"title":"Reading XML file via XML nodes","body":"<p>I have this XML document I am trying to read in and insert into a data base. There will only ever be one GamePlay node however GamePlayStep may repeat so I have created a node list for this. For some reason GamePlayStep isn't receiving data. Here is the XML file: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;GameData&gt;\n  &lt;GamePlay&gt;\n    &lt;type&gt;add&lt;/type&gt;\n    &lt;GamePlayID&gt;1&lt;/GamePlayID&gt;\n    &lt;ParticipantID&gt;1&lt;/ParticipantID&gt;\n    &lt;GameID&gt;1&lt;/GameID&gt;\n    &lt;GameDifficultyID&gt;1&lt;/GameDifficultyID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;Success&gt;False&lt;/Success&gt;\n  &lt;/GamePlay&gt;\n  &lt;GamePlayStep&gt;\n    &lt;GamePlayStepID&gt;1&lt;/GamePlayStepID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;SortOrder&gt;1&lt;/SortOrder&gt;\n    &lt;Score&gt;1&lt;/Score&gt;\n    &lt;hintUsed&gt;True&lt;/hintUsed&gt;\n    &lt;GamePause&gt;\n      &lt;GamePauseID&gt;1&lt;/GamePauseID&gt;\n      &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n      &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n      &lt;Order&gt;1&lt;/Order&gt;\n      &lt;Duration&gt;05:01&lt;/Duration&gt;\n    &lt;/GamePause&gt;\n  &lt;/GamePlayStep&gt;\n&lt;/GameData&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>public static void start()\n        {\n            string[] filePaths = Directory.GetFiles(System.Configuration.ConfigurationManager.ConnectionStrings[\"filePath\"].ConnectionString);\n            List&lt;GamePlay&gt; gameObj = new List&lt;GamePlay&gt;();\n            List&lt;GamePlayStep&gt; gameStepObj = new List&lt;GamePlayStep&gt;();\n            foreach (string value in filePaths)\n            {\n                XmlDocument xd = new XmlDocument();\n                XmlNodeList GameSteps;\n                xd.Load(value);\n                XmlNode documentNode = xd.SelectSingleNode(\"/GameData/GamePlay\");\n                GameSteps = xd.SelectNodes(\"/GameData/GamePlay/GamePlayStep\");\n\n                GamePlay newGamePlay = new GamePlay();\n                newGamePlay.setType(Convert.ToString(documentNode.SelectSingleNode(\"type\").InnerText));\n                newGamePlay.setGamePlayID(Convert.ToInt32(documentNode.SelectSingleNode(\"GamePlayID\").InnerText));\n                newGamePlay.setParticipantID(Convert.ToInt32(documentNode.SelectSingleNode(\"ParticipantID\").InnerText));\n                newGamePlay.setGameDifficultyID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameDifficultyID\").InnerText));\n                newGamePlay.setGameID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameID\").InnerText));\n                newGamePlay.setStartDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"Start\").InnerText));\n                newGamePlay.setEndDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"End\").InnerText));\n                newGamePlay.setSuccess(Convert.ToBoolean(documentNode.SelectSingleNode(\"Success\").InnerText));\n                newGamePlay.setFile(value);\n                newGamePlay.addNewGamePlay();\n\n                foreach (XmlNode documentNode2 in GameSteps)\n                {\n\n                    GamePlayStep newGamePlayStep = new GamePlayStep();\n                    newGamePlayStep.setGamePlayStepID(Convert.ToInt32(documentNode2.SelectSingleNode(\"GamePlayStepID\").InnerText));\n                    newGamePlayStep.setGamePlayID(newGamePlay.getGamePlayID());\n                    newGamePlayStep.setStartDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"Start\").InnerText));\n                    newGamePlayStep.setEndDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"End\").InnerText));\n                    newGamePlayStep.setOrderPlayed(Convert.ToInt32(documentNode2.SelectSingleNode(\"SortOrder\").InnerText));\n                    newGamePlayStep.setScore(Convert.ToInt32(documentNode2.SelectSingleNode(\"Score\").InnerText));\n                    newGamePlayStep.setHintUsed(Convert.ToBoolean(documentNode2.SelectSingleNode(\"hintUsed\").InnerText));\n                    newGamePlayStep.addNewGamePlayStep();\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The GamePlay is filling the variables properly and inserting into the database however the GamePlaySteps in the NodeList are not. Does anyone see the problem or how I can improve this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","entity-framework","generics","types"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":54,"score":5,"question_id":13269002,"title":"Getting List of Objects by a type given by a string","body":"<p>I get objects by</p>\n\n<pre><code>IEnumerable&lt;ObjectStateEntry&gt; om = context.ObjectStateManager.GetObjectStateEntries(System.Data.EntityState.Modified);        \n</code></pre>\n\n<p>How can I get a <code>List</code> of the objects with a type given by a string?</p>\n\n<pre><code>Type typ = Type.GetType(\"mytype\");\nvar om2 = om.Select(s =&gt; s.Entity).OfType&lt;typ&gt;(); // does not work\n</code></pre>\n"},{"tags":["c#","unit-testing","mocking","moq","stub"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13267799,"title":"What to use mock parameter or instance parameter in test method?","body":"<p>What is the best practice to pass object parameter in the test method?\nWhat to use in this case?(Mocks, Stubs or create instance of object and fill it)</p>\n\n<p>For example:</p>\n\n<pre><code>[Test]\npublic void LoadContentsFor_ValidUser_ReturnsEmptyList()\n{\n    var user = new User {Id = 1, FirstName = \"Test\"};\n    var contents = this.contentPresentationService.LoadContentsFor(user);\n    Assert.IsTrue(contents.Count == 0);\n}\n</code></pre>\n\n<p>Or using mocks:</p>\n\n<pre><code>[Test]\npublic void LoadContentsFor_ValidUser_ReturnsEmptyList()\n{\n    var user = new Mock&lt;User&gt;();\n    user.Setup(x =&gt; x.Id).Returns(1);\n    user.Setup(x =&gt; x.FirstName).Returns(\"Test\");\n    var contents = this.contentPresentationService.LoadContentsFor(user.Object);\n    Assert.IsTrue(contents.Count == 0);\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","viewmodel","asp.net-mvc-viewmodel"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13252720,"title":"MVC 3 viewmodel properties","body":"<p>I have a question regarding organization of properties in viewModel. As far as I understand the viewmodel should be as simple as possible, and the main thing that it should do is bind data to view.</p>\n\n<p>The question is how to distinguish properties in viewmodel from BL model.\nI mean for example I have a BL model like : </p>\n\n<pre><code>   public class UserDetailsModel\n    { \n        public string UserName {get;set;}\n        public string SomeInfo{get;set;}\n        public string AnotherInfo{get;set;}\n        public string Anything{get;set;}\n        public string Something {get;set;}\n        ...\n\n     }\n</code></pre>\n\n<p>then I have another BL model say:</p>\n\n<pre><code> public class UserInfoModel\n        { \n            public string Info1{get;set;}\n            public string Info2{get;set;}\n            public string Info3{get;set;}\n            public string Info4{get;set;}\n            public string Info5 {get;set;}\n            ...\n\n         }\n</code></pre>\n\n<p>Now the question is what is the best practices to Create ViewModel that should have data of both BL models. </p>\n\n<p>1) Duplicate the properties from 2 models , and use Default Model binding to transfer data from view to controller , then create BL models from ViewModels and via repository update data ? In this case we have code duplication ... </p>\n\n<p>2) ViewModel should look something like: </p>\n\n<pre><code> public class UsersIdentificationViewModel \n        {\n            public UsersIdentificationViewModel()\n            {\n                UserInfoModel = new UserInfoModel();\n            }\n\n            public UserInfoModel UsersInfo { get; set; }\n\n            public UserDetailsModel UserDetails { get; set; }   \n\n        }\n</code></pre>\n\n<p>The default binding will not work in this case (Correct me if I am mistaking) and I should write custom Model binder or something like this... What approach is better for unit testing , or maybe there is another approach ?</p>\n"},{"tags":["c#","xml","for-loop","attributes","switch-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":85,"score":-3,"question_id":13269637,"title":"how to use for loop instead of switch?","body":"<p>here is a code of xml attributes reader, I need to read the attributes through for loop or through something if there is anything convenient for representing the loop value of attributes to another script. Now it uses switch and i cant use it as public variable to pass the value for another script. Is there a way to do it properly? Please help me in this matter, any help would be appreciated. </p>\n\n<pre><code>using UnityEngine;\nusing System.IO;\nusing System.Xml;\nusing System.Text; \n\npublic class XMLStringReader : MonoBehaviour\n{\n public string attrVal;\n    XmlDocument root;\n\n    void Start ()\n    {\n\n XmlReader reader = new XmlTextReader(\"D://Dram/verer.xml\");\n\n         reader.MoveToContent();\n        if (reader.Name != null) \n        {\n            while (reader.Read()) \n            {\n                if(reader.NodeType == XmlNodeType.Element) \n                { \n                    // check if the element has any attributes\n                    if (reader.HasAttributes)\n                    {\n                        // move to the first attribute\n                        reader.MoveToFirstAttribute();\n\n                        for(int i = 0; i &lt; reader.AttributeCount; i++) \n                        { \n                            // read the current attribute\n                          reader.MoveToAttribute(i);\n\n\n\n                            switch (reader.Name) \n                            {                                \n                                case \"UIName\":\n                                print(\"UIName : \" + reader.Value);\n\n\n                                    break;\n                                default: // ignore\n                                    break;\n                            }\n\n                        } \n                        // move back to the element node that contains\n                        // the attributes we just traversed\n                        reader.MoveToElement();\n                    }\n                }\n            }\n        }\n\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","ado.net"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13268287,"title":"Transactions in .net using c#","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/224689/transactions-in-net\">Transactions in .net</a>  </p>\n</blockquote>\n\n\n\n<p>I just wanted to know about Transaction in .net using c# language. I have gone through different articles on the net. However, I came to know about transaction theoretically but I wanted to know the exact use of it in real time. For example when exactly should I use transactions in real time. Let's suppose, I am writing code where I am doing some action on the click event of a link. Lets say, I am hitting the SQL connection to get some values. Should I use transaction there? If I am writing simple code, where I fetch values without using sql connection, should I use transactions there? What are the pros and cons of using Transactions. Getting theoritical knowledge is different, but I want to know the exact use of it. When to use when not to use. Can transactions be used in simple code? Any responses or links for even basic stuff about transactions are welcome.</p>\n"},{"tags":["c#",".net","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1287,"score":1,"question_id":4756046,"title":"How secure is ProtectedData.Protect (DPAPI)?","body":"<p>Suppose someone gets access all of my hard disk, I guess the weak spot would be my windows password. Without knowing/being able to retrieve that, the data should be pretty much safe, shouldn't it?</p>\n\n<p>I'm asking specifically because of the <a href=\"http://en.wikipedia.org/wiki/Encrypting_File_System#Decrypting_files_using_the_local_Administrator_account\" rel=\"nofollow\">EFS entry</a> in wikipedia which states that</p>\n\n<blockquote>\n  <p>In Windows 2000, the local administrator is the default Data Recovery Agent, capable of decrypting all files encrypted with EFS by any local user.</p>\n</blockquote>\n\n<p>and EFS happens to use DPAPI. So does the same apply to my own data protected using this:</p>\n\n<pre><code>ProtectedData.Protect(plain, null, DataProtectionScope.CurrentUser);\n</code></pre>\n\n<p>And if that is indeed the case, how could I prevent it?</p>\n\n<p><strong>[Edit]</strong> N.B. I'm trying to store credentials for a winforms app so that the user does not have to enter their password every time they login. In other words, if someone is able to login as that user (i.e. know the user password), then they might as well be able read the encrypted data.</p>\n\n<p>Which - not coming from a windows background - now makes me wonder - can't the local admin login as any local user anyway? In that case I shouldn't be concerned about the admin being able to retrieve passwords anyway...</p>\n\n<p><strong>[Edit2]</strong> As google reveals, it looks like an Administrator <strong>cannot</strong> just login as any user without resetting/changing their password first. So my question still seems relevant...</p>\n"},{"tags":["c#",".net","static","webclient","void"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13268529,"title":"C# How to transfer reference void within main void","body":"<p>This is likely to be a(nother) noob question, but I'm not sure how to do this.</p>\n\n<p>I have piece of code within a private method which refers to a static method.</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    wc.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wc_DownloadStringCompleted);\n    wc.DownloadStringAsync(new Uri(requestUri));\n}\n</code></pre>\n\n<p>The static method it refers to:</p>\n\n<pre><code>static void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)\n{\n\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }          \n}\n</code></pre>\n\n<p>Now I need the content of the static method to replace the content of the WebClient. \nLike:</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }\n}\n</code></pre>\n\n<p>Since I'm not sure where \"e\" originates from, I do not know how to get it working.</p>\n"},{"tags":["c#","oracle","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":39,"score":4,"question_id":13269126,"title":"C# & NHibernate \"Could not compile the mapping document\" on windows service","body":"<p>this is my first question on this page, so first of all sorry for any newbie mistakes and my bad english.</p>\n\n<p>I wouldn't be asking on a page like this if I didn't ran out of ideas on how to solve my problem, so I hope I get it to work with your help since it's my last chance.</p>\n\n<p>I created a program in C# using NHibernate to connect it to my Oracle database (wich is working perfectly), and now I've been told to create a similar program, but now in a Windows Service instead of a .exe.</p>\n\n<p>The problem is that I have all the settings done to make NHibernate work like in the .exe program, and if i debug the program it all works fine, but as soon as I install the service and run it, stops working.</p>\n\n<p>I'm not doing anyhing in the program, just testing the NHibernate connection.</p>\n\n<p>The exception:</p>\n\n<pre><code>Could not compile the mapping document: Mapping\\CSB_Mensaje.hbm.xml\nSystem.IO.DirectoryNotFoundException: No se puede encontrar una parte de la ruta de acceso 'C:\\Windows\\system32\\Mapping\\CSB_Mensaje.hbm.xml'.\n   en System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)\n   en System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)\n   en System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize)\n   en System.Xml.XmlDownloadManager.GetStream(Uri uri, ICredentials credentials, IWebProxy proxy, RequestCachePolicy cachePolicy)\n   en System.Xml.XmlUrlResolver.GetEntity(Uri absoluteUri, String role, Type ofObjectToReturn)\n   en System.Xml.XmlTextReaderImpl.OpenUrlDelegate(Object xmlResolver)\n   en System.Threading.CompressedStack.runTryCode(Object userData)\n   en System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n   en System.Threading.CompressedStack.Run(CompressedStack compressedStack, ContextCallback callback, Object state)\n   en System.Xml.XmlTextReaderImpl.OpenUrl()\n   en System.Xml.XmlTextReaderImpl.Read()\n   en System.Xml.XmlTextReader.Read()\n   en System.Xml.XmlCharCheckingReader.Read()\n   en System.Xml.XsdValidatingReader.Read()\n   en System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)\n   en System.Xml.XmlDocument.Load(XmlReader reader)\n   en NHibernate.Cfg.Configuration.LoadMappingDocument(XmlReader hbmReader, String name)\n</code></pre>\n\n<p>The part of the exception on spanish, says it can't find a part of the access path.</p>\n\n<p>This exception is thrown while trying to execute this code:</p>\n\n<pre><code>private static void Init(String BBDD)\n    {\n        Configuration config = new Configuration();\n        config.Configure().SessionFactoryName(BBDD);\n        config.AddFile(\"Mapping\\\\CSB_Mensaje.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Periodicidad.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Plantilla.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Subscripciones.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Usuario.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Login.hbm.xml\");\n        config.AddFile(\"Mapping\\\\CSB_Configuration.hbm.xml\");\n        _SessionFactory = config.BuildSessionFactory();\n    }\n</code></pre>\n\n<p>And this is my hibernate.cfg.xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;hibernate-configuration xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n  &lt;session-factory name=\"Oracle\"&gt;\n    &lt;property name=\"connection.provider\"&gt;\n      NHibernate.Connection.DriverConnectionProvider\n    &lt;/property&gt;\n    &lt;property name=\"dialect\"&gt;\n      NHibernate.Dialect.Oracle10gDialect\n    &lt;/property&gt;\n    &lt;property name=\"connection.driver_class\"&gt;\n      NHibernate.Driver.OracleClientDriver\n    &lt;/property&gt;\n    &lt;property name=\"connection.connection_string\"&gt;\n      User Id=CSB;\n      Password=Hound2012;\n      Data Source=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.1.30)(PORT = 1521)))(CONNECT_DATA = (SID = HL)));\n    &lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;\n      true\n    &lt;/property&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Again, this is my first time asking something here, so I'm sorry for any mistake made. Any help would be greatly apreciated.</p>\n\n<p>Regards,\nKhor</p>\n"},{"tags":["c#","c++","security","windows-services","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13269574,"title":"Error : \"Impossible to find object or property\", when loading a private certificate in a Windows service running as LocalSystem","body":"<p>I am developing a Windows service middleware that uses security certificates to perform authentication when it wants to initialize a secure communication channel with remote applications.</p>\n\n<p>The Windows service is a .Net 3.5  application that uses (via a C++/CLI layer) the C++ WinCrypt library in order to load certificates. In particular I am calling the CertFindCertificateInStore method when i accessing the store to load the certificate. The CertFindCertificateInStore uses the “My” system store as store by default.</p>\n\n<p>I have registered my private certificate in the “My” system store either for the current user (the user logged onto the machine) either for the local machine, via the MMC console. Be sure that the certificate is good and it includes my private key.</p>\n\n<p>When i run the Windows service as current user (again the user logged onto the machine)  the certificate is correctly loaded,  instead the certificate is not loaded when i run the service as “LocalSystem”. The error  \"Impossible to find object or property\", is then raised when I call the CertFindCertificateInStore. I point up that the “My” store instead continues to be accessible.</p>\n\n<p>(NB: When I open a new session using a different user and I run the same Windows service as user for whom I registered the certificates, the certificate is again correctly loaded)</p>\n\n<p>Then I used either the MMC console either the winhttpcertcfg.exe system tool in order to verify that the “LocalSystem” user has the rights to access my certificate. Afterwards either the MMC console and the winhttpcertcfg.exe tool confirm that THEORETICALLY the user “LocalSystem” has the rights to access the certificate.</p>\n\n<p>Do you have any suggestion to help me to solve this problem?</p>\n\n<p>Thank you in advance for your help,</p>\n\n<p>PS: a similar question has been posted here <a href=\"http://stackoverflow.com/questions/3936065/certificates-cannot-find-the-certificate-and-private-key-for-decryption-error-w\">Certificates: Cannot find the certificate and private key for decryption Error when sign</a></p>\n"},{"tags":["c#",".net","winforms","usercontrols","flowlayoutpanel"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":28,"score":5,"question_id":13265635,"title":"insert Usercontrol in FlowLayoutPanel","body":"<p>I have a <code>FlowLayoutPanel</code> and several <code>UserControl</code>s. Now I want one controll to be always at the bottom of my <code>FlowLayoutPanel</code>. So I want to add my UserControl just above the lowest controll. Is there an easy way to insert user controls in a <code>FlowLayoutPanel</code>?</p>\n\n<p>I'm currently thinking about removing the control at the bottom, and adding the control I want to add and  add the bottom control again. But this I do not think this is really the best way. Is there anyone here who could help me with some information on how to do this ?</p>\n"},{"tags":["c#",".net","asp.net-mvc","razor"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":39,"score":2,"question_id":13268203,"title":"Can we do the DBContext in MVC3 with Razor?","body":"<p>Can I connect to the DB using <code>DBContext</code> in MVC3 by defining the <code>ConnectionString</code> in Web.config?</p>\n\n<p>If possible can anyone provide me some links too?</p>\n"},{"tags":["c#","linq","ienumerable"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13269183,"title":"Search between Two IEnumerable - LINQ","body":"<p>Hi can you guys help me with this, I have try several things.\nI need to search between two IEnumerables, here is the code.</p>\n\n<pre><code>IEnumerable&lt;Project&gt; Projects = new[] { new Project {id = \"1\", lan = \"test1\"},  new Project {id = \"2\", lan = \"test1\"}}\n\nIEnumerable&lt;string&gt; lan = new [] { \"test1\", \"test2\"};\nIEnumerable&lt;string&gt; indexFiltered = ?;\n</code></pre>\n\n<p>I need to do a linq query that return the Project.id thats have any Project.lan in lan.</p>\n\n<p>Any idea?</p>\n"},{"tags":["c#","string"],"answer_count":11,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":85,"score":-1,"question_id":13263452,"title":"How to remove characters in a string?","body":"<p>How to remove the some characters in a string ..</p>\n\n<pre><code>string s=\"testpage\\information.xml\"\n</code></pre>\n\n<p>I need only information.xml how to do that?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13268564,"title":"Winform datagridview not refreshing","body":"<p>I've created a datagridview from the tools and chosed the datasource from db. By using dataset of a table I am displaying data in the datagridview. But When I add new data to the database my gridview still looks the same its not refreshing with the new data :( kindly assist. Thanks in advance</p>\n"},{"tags":["c#","xaml","windows-8","winrt","winrt-xaml"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":2568,"score":1,"question_id":10359197,"title":"Windows 8 GridView - disabling item tap visualization","body":"<p>Is it possible to remove the tap effect on an item inside a gridview?</p>\n"},{"tags":["c#","xml","xslt","xhtml","doctype"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13268073,"title":"How to add DOCTYPE to HTML using XSLT and C#","body":"<p>I am using XSLT in conjunction with C# to transform my xml document into HTML. I need the DOCTYPE to be in the HTML document. But somehow I can't seem to get it to appear. Please help...</p>\n\n<p>My xsl includes the following.</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n    &lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n    &lt;xsl:output method=\"xml\" encoding=\"utf-8\" doctype-public=\"-//W3C//DTD XHTML 1.0 Strict//EN\" doctype-system=\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\" indent=\"yes\"/&gt;\n</code></pre>\n\n<p>My C# code looks like this :</p>\n\n<pre><code>            try\n            {\n                XPathDocument myXPathDoc = new XPathDocument(myPath);\n\n                XslTransform myXslTrans = new XslTransform();\n\n                myXslTrans.Load(ConfigurationManager.AppSettings[\"XsltFilePath\"] == null ? \"MyTransform.xsl\" : ConfigurationManager.AppSettings[\"XsltFilePath\"]);\n\n                String htmlFile = Path.Combine(myFolder, myName, \"index.html\");\n\n                XmlTextWriter myWriter = new XmlTextWriter(htmlFile, null);\n\n                myXslTrans.Transform(myXPathDoc, null, myWriter);\n\n                myWriter.Close();\n            }\n            catch (Exception e)\n            {\n                System.Console.WriteLine(e.Message + \"\\n\" + e.StackTrace);\n            }\n</code></pre>\n\n<p>Any ideas what I am doing wrong? I am using .NET 4.0. Thanks in advance.</p>\n"},{"tags":["c#","vb.net","string"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13262629,"title":"remove spaces and empty line in the end of a string vb.net","body":"<p>in vb.net i have a string that looks like this</p>\n\n<pre><code>\"text text text                           \n                             \"\n</code></pre>\n\n<p>so in the end of it there are spaces and a new empty line</p>\n\n<p>How can make this look like </p>\n\n<pre><code>\"text text text\"\n</code></pre>\n"},{"tags":["c#",".net","delegates","event-handling","event-bubbling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13268251,"title":"How to bubble an event up multiple levels?","body":"<p>I'm struggling to bubble an event correctly.</p>\n\n<p>I have a master page with a user control, and a page that is a child of the master page.</p>\n\n<p>The user control and the page share common data, so when the user control updates, it updates the apage and vice versa.</p>\n\n<p>The user control exposed an event to the master page. This is the format I use.</p>\n\n<p>outside of class:</p>\n\n<pre><code>public delegate void OfferBookmarkRemoved(int OfferID);\n</code></pre>\n\n<p>inside class:</p>\n\n<pre><code>public event OfferBookmarkRemoved OfferBookmarkRemoved;\n\nprotected void LV_Bookmarks_ItemCommand(object source, ListViewCommandEventArgs e)\n{\n    if (e.CommandName == \"RemoveOffer\")\n    {\n        var offerId = (int)e.CommandArgument;\n\n        OnOfferBookmarkRemoved(offerId);\n    }\n\n}\n\nvoid OnOfferBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    if (OfferBookmarkRemoved != null)\n    {\n        OfferBookmarkRemoved(offerId);\n    }\n}\n</code></pre>\n\n<p>Now this can be used in the master page ok. I don't do anything in the master page and want to expose the event so that the aspx page can use it, like this:</p>\n\n<pre><code>Master.OfferBookmarkRemoved += OnBookmarkRemoved;\n\nvoid OnBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    OfferList1.UpdateBookmark(offerId);\n}\n</code></pre>\n\n<p>So the missing bit is to listen for the event in the master and make it available to the page.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["c#",".net","xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13268851,"title":"Merge missing XML records based on Empty XML example","body":"<p>I have an XML template file and a previously saved XML database record:</p>\n\n<ul>\n<li>XML file - contains all the current fields I want for an object - This may change over time with items added</li>\n<li>XML database record - this is the saved XML.  It may be different from the XML in point one because the \"template\" xml may have been updated to contain more fields, etc.</li>\n</ul>\n\n<p>An example will clear this up..</p>\n\n<p>I have a \"template\" xml that looks like this:</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>This tells the UI to collect a Title and Description when creating a new record.  This works perfectly.</p>\n\n<p>So when I create a new DVD record it will display these 2 fields to the user and collect the \"Title\" and \"Description\" values and save the value into an XML field in a SQL Server table.</p>\n\n<p>But what I want to do now is add a new \"field\" definition to the template xml.  I've done this.. for the purposes of this example, lets have a \"PurchasedDate\" field definition added to the template XML.</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n\n</pre>\n\n<p>If I'm creating a new DVD record, I get prompted for the 3 values; Title, Description, Purchased Date, because that's whats in the template XML..  But if I'm recalling a previously saved DVD record, it doesn't have the new \"Purchased Date\" field in the XML..</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>So what I want to do is take the XML saved in the database (shown above), compare or merge any missing \"field\" definitions from the template XML file.. and end up with this below:</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>I'm using Linq to get the value from the existing record from the database if one exists.\nand I'm currently doing a XmlDocument.LoadXml(xmlstring) or XmlDocument.Load(filename) depending on whether its new or existing record.</p>\n\n<p>I'd then like to take the XmlDocument and merge the template into this to produce the above XML output for displaying on screen.</p>\n\n<p>If there is a better way than using XmlDocuments, can you please let me know..  I'll happily go and research it and then use it..</p>\n\n<p>I'm using C#...</p>\n\n<p>Many thanks..</p>\n"},{"tags":["c#","entity-framework","entity-framework-4","ef-code-first"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13268665,"title":"Modify Many-to-Many table Created By EF5 Code First","body":"<p>I have 2 classes and the one is a collection property of the other like below.</p>\n\n<pre><code>public class NotificationMessage\n{\n    public int ID { get; set; }\n    public string Message { get; set; }\n    public virtual ICollection&lt;Device&gt; Devices { get; set; }\n}\n\npublic class Device\n{\n    public int ID  { get; set; }\n    public string Token  { get; set; }\n    public virtual ICollection&lt;NotificationMessage&gt; NotificationMessages { get; set; }\n}\n\npublic class NotificationMessageDevice\n{\n    [Column(Order = 0), Key, ForeignKey(\"NotificationMessage\")]\n    public int NotificationMessageID { get; set; }\n\n    [Column(Order = 1), Key, ForeignKey(\"Device\")]\n    public int DeviceID { get; set; }\n\n\n    public virtual Device Device { get; set; }\n    public virtual NotificationMessage NotificationMessage { get; set; }\n}\n</code></pre>\n\n<p>When you create a relationship like above, the entity flamework is enough clever to create many to many relationship on Database by creating NotificationMessageDevices.</p>\n\n<p>The problem rises in here. Now I want to add CreateDate to the table 'NotificationMessageDevices' . What I have done is that I have created a new class called 'NotificationMessageDevice' in the way entity framework would create the table \"NotificationMessageDevices\" in existing database. I added new properties and called Update-Verbose. The very first exception was about missing ID property it wanted me to add public int ID {get;set;} however when I add this up it realizes the ID property is index property so that I need to remove all the data in that table. </p>\n\n<p>What is the workaround of this case on Entity Framework without data loss :) </p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13257709,"title":"Comparing collections and counting duplicates using LINQ and C#","body":"<p>I have two similar objects in my system.</p>\n\n<ul>\n<li>LeadImportViewModel</li>\n<li>LeadGridViewModel</li>\n</ul>\n\n<p>I need to populate the <code>QtyDuplicates</code> field in my <code>LeadImportViewModel</code> collection, which should show the quantity of corresponding records in the LeadGridViewModel collection where the  <code>CompanyNameStripped</code> value is identical.</p>\n\n<pre><code>public class LeadImportViewModel\n{\n    public int Id { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n    public int QtyDuplicates{ get; set; }\n}\n\npublic class LeadGridViewModel\n{\n    public int LeadId { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n}\n</code></pre>\n\n<p>The collection is created as follows:</p>\n\n<pre><code>var coll = (from t1 in db.Leads_Staging\n                    select new LeadImportViewModel\n                        {\n                            Id = t1.Id,\n                            CompanyName = t1.CompanyName,\n                            CompanyNameStripped = t1.CompanyNameStripped,\n\n                        });\n</code></pre>\n\n<p>What would be the most efficient way to do this using LINQ/C#?</p>\n"},{"tags":["c#","c#-4.0"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13256892,"title":"Return an object","body":"<p>I'm suddenly stuck. I defined an object:</p>\n\n<pre><code>public class AddResult\n{\n   public AddResult(string id, bool success)\n   {\n      this.ID = id;\n      this.Success = success;\n   }\n\n   public string ID { get; set; } \n   public bool Success { get; set; } \n   public string ErrorMessage { get; set; } \n}\n</code></pre>\n\n<p>I want to return this object in another method.</p>\n\n<pre><code>public AddResult Load(string userName, string password)\n{\n    // validate\n    if(userName = \"\")\n      {\n           AddResult.ErrorMessage = \"wrong\";\n           AddResult.ID = \"\";\n      }\n    // want to return object AddResult\n }\n</code></pre>\n\n<p>The intellisense is not working for AddResult.ID etc, I know something is wrong but need your advice.</p>\n"},{"tags":["c#","design","interface","patterns","oo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13269222,"title":"C# Interface too rigid","body":"<p>I'm working with some legacy code and have this existing interface:</p>\n\n<pre><code>public interface IProcess\n{\n    IDTO Process(IDTO request);\n}\n</code></pre>\n\n<p>There is then a factory with a huge switch statement returning objects (17 of them) that implement the interface.  The created objects then call process like:</p>\n\n<pre><code>return xProcess.Process(requestDTO);\n</code></pre>\n\n<p>My problem is that I now need to change a few of these to pass in a second parameter like:</p>\n\n<pre><code>xProcess.Process(requestDTO, Id);\n</code></pre>\n\n<p>I'm looking for an elegant way to achieve this.</p>\n\n<p>I have tried making the interface an abstract class like:</p>\n\n<pre><code>public abstract class IProcess\n{\n\n    public virtual IDTO Process(IDTO request)\n    {\n       return null;\n    }\n\n    public virtual IDTO Process(IDTO request, int Id)\n    {\n        return null;\n    }\n}\n</code></pre>\n\n<p>This allows me to override the Process method in the created classes but I have a problem that IProcess is inherited by another interface, which is now obviously broken.</p>\n\n<p>The legacy platform is huge and the test coverage is not great so I'm looking for a nice elegant solution with the minimum impact to the rest of the code base.  Perhaps, there is a pattern I'm overlooking?</p>\n\n<p>Can anyone help please?  (examples would be great)</p>\n\n<p>Thanks</p>\n\n<p>David</p>\n"},{"tags":["c#","asp.net","table","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3049,"score":0,"question_id":4689611,"title":"Populating dynamic table in asp.net?","body":"<p>I would really appriciate your help on this. This is my problem:</p>\n\n<p>I have a ArrayList of product objects. Each product has a id, name and a supplier.\nWhen i iterate the arraylist and creates a table to put  this valus into cells i come to the problem that a product can have more than one supplier. If this is the case the id and name are the same but with a different supplier in the arraylist.\nMy code so far takes care of this by creating emtyp cells for id and name and put the other supplier in a new cell. </p>\n\n<p>But, i doesn't look good to create new rows for every supplier. What i want is that if a product has more than one supplier i want all the suppliers in the same cell on the row for the product id.</p>\n\n<pre><code>string id = string.Empty;\nint count = 0;\npublic void CreateResultTable(ArrayList result)\n{\n    TableRow row;\n    TableCell cell;\n\n    if (result != null &amp;&amp; result.Count &gt; 0)\n    {\n        foreach (Item item in result)\n        {\n\n            if (count == 0)\n            {\n                row = new TableRow();\n                id = item.id;\n\n                cell = new TableCell();\n                cell.Text = item.id;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = item.product;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n                    row.Cells.Add(cell);\n\n                }\n                else\n                    cell.Text = string.Empty;\n                    row.Cells.Add(cell);\n\n                count++;\n            }\n            else if (id != item.id)\n            {\n\n                row = new TableRow();\n                id = item.id;\n\n                cell = new TableCell();\n                cell.Text = item.id;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = item.product;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n\n                }\n                else\n                    cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n\n            }\n            else\n            {\n                row = new TableRow();\n                cell = new TableCell();\n                cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                cell.Text = string.Empty;\n                row.Cells.Add(cell);\n\n                cell = new TableCell();\n                ArrayList levList = item.suppliers;\n                if (levList != null)\n                {\n                    string lev = string.Empty;\n                    for (int i = 0; i &lt; levList.Count; i++)\n                    {\n                        lev += levList[i];\n                    }\n                    cell.Text = lev;\n                    row.Cells.Add(cell);\n                }\n                else\n                    cell.Text = string.Empty;\n                row.Cells.Add(cell);\n            }\n\n            SearchResultLev.Rows.Add(row);\n\n\n\n        }\n\n\n        SearchResultLev.Visible = true;\n        SearchResult.Visible = false;\n        NoSearchResult.Visible = false;\n    }\n\n    else\n    {\n        SearchResultLev.Visible = false;\n        SearchResult.Visible = false;\n        NoSearchResult.Visible = true;\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","image"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1375,"score":6,"question_id":3643750,"title":".NET Image Libraries","body":"<p>What are some good image libraries for C#? Mainly for things such as painting in layers. Or maybe a resource that can describe similar tasks?</p>\n"},{"tags":["c#","xaml","animation","storyboard"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13252023,"title":"BeginTime not working correctly when set programmatically in WinRT / c#","body":"<p>I'm animating something in my Windows 8 app from code behind. I have a collection of animation objects, each containing a <code>DoubleAnimation</code>. I call a method which iterates over this collection, creates new <code>Storyboard</code> objects for each one and begins them. Regardless of whether I set <code>BeginTime</code> on the storyboard,  <code>DoubleAnimation</code> or both, they all start and run at the same time. </p>\n\n<p>How do I delay an animation by a set number of milliseconds? </p>\n\n<pre><code>  foreach (AnimationObject a in queue)\n  {\n      Storyboard sb = new Storyboard();\n      sb.Duration = a.DoubleAnimation.Duration;\n      sb.BeginTime = a.DoubleAnimation.BeginTime;\n      sb.Children.Add(a.DoubleAnimation);\n      Storyboard.SetTarget(a.DoubleAnimation, a.Target);\n      Storyboard.SetTargetProperty(a.animation, a.TargetProperty);\n      sb.Begin();\n  }\n</code></pre>\n\n<p>I wrote a queue instead which uses <code>await Task.Delay(a.BeginTime)</code> and this works, so I know I'm setting BeginTime correctly. However the Task Delay approach doesn't seem very efficient</p>\n"},{"tags":["c#","asp.net-mvc-3","entity-framework","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":161,"score":4,"question_id":12707682,"title":"How to map a stored procedure using DBContext in ASP.NET MVC 3 Entity Framework","body":"<p>I do mapping here for tables.. How to map stored procedures here?</p>\n\n<pre><code>public class AppDBContext : DbContext\n{\n    public DbSet&lt;UserAccount&gt; UserAccount { get; set; }\n    public DbSet&lt;GetUserAccounts&gt; GetGetUserAccounts { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;UserAccount&gt;().ToTable(\"UserAccount\");\n        modelBuilder.Entity&lt;Customer&gt;().ToTable(\"Customer\");\n\n        base.OnModelCreating(modelBuilder);\n    }\n}\n</code></pre>\n"},{"tags":["c#","httpwebresponse"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13267979,"title":"HTTPWebResponse using application/x-www-form-urlencoded","body":"<p>So I sent an HTTPWebRequest using application/x-www-form-urlencoded as my content type. I assume that this means the reponse will be returned in a similar type? (EDIT: Have now been told this isn't the case)</p>\n\n<p>My question is this. How do I access the different key/value pairs returned in the response. My code so far looks like this. I can of course read the string but surely there is a better way to access the data other than ripping the string apart. </p>\n\n<pre><code>    HttpWebResponse response = SendPOSTRequest(\"https://site/page?Service=foo\", content.ToString(), \"\", \"\", true);\n\n    string responseCode = response.StatusCode.ToString();\n    string responseStatusDescription = response.StatusDescription;\n\n    StreamReader sr = new StreamReader(response.GetResponseStream());\n\n    string result = sr.ReadToEnd();\n</code></pre>\n\n<p>I tried using XML/linq to read the elements into an XDocument but of course it is not being returned in XML form.</p>\n\n<p>Assume I have 3 or 4 different pieces of information in there how could I read them out? </p>\n\n<p>EDIT: I have just checked and the data is being returned as text/plain. How can this be processed easily?</p>\n\n<p>EDIT: The response string once retrieved via a streamreader is:</p>\n\n<pre><code>VPSProtocol=2.23\nStatus=OK\nStatusDetail=Server transaction registered successfully.\nVPSTxId={FDC93F3D-FC64-400D-875F-0B7E855AD81F}\nSecurityKey=*****\nNextURL=https://foo.com/PaymentPage.asp?TransactionID={875F-0B7E855AD81F}\n</code></pre>\n\n<p>EDIT: It seems this piece of code gets me part way there. I am able to break the response up into a List and address it line by line. It still isnt a perfect solution though. </p>\n\n<pre><code>            StreamReader sr = new StreamReader(response.GetResponseStream());\n\n            List&lt;string&gt; str = new List&lt;string&gt;;\n\n            while (sr.Peek() &gt;= 0)\n            {\n                str.Add(sr.ReadLine().ToString());\n            }\n</code></pre>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":733,"score":2,"question_id":7093861,"title":"Filter items of a ListBox based on the text of a TextBox using only XAML in WPF","body":"<p>I currently have a ListBox binded to a collection of items. As the collection is big we want to filter the items being shown based on the text entered on a TextBox. </p>\n\n<p>What I'm asking is if this is possible to implement using only XAML, I don't want to modify the collection of items, I would like to modify the Visibility of each of the items based on the filter.</p>\n\n<p>Hope its clear,</p>\n\n<p>thanks!</p>\n"},{"tags":["c#","winforms","listbox","calling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13268664,"title":"Sending information to listbox from a class to a Form","body":"<p>I am trying to send information to a listbox to a Form from a class. Sounds simple enough. However it just won't show anything after the method has run.</p>\n\n<p>This is my Class and Method 'Testclass' that is being called from form one</p>\n\n<pre><code>    public void testclass()\n    {\n        Form1 m = new Form1();\n        int tostng = \"36183464\";\n        m.listBox1.Items.Add(tostng).ToString();\n    }\n</code></pre>\n\n<p>in Form1 I have a listbox which has had it's modifiers set to \"Public\" so not errors pop up. It will run but nothing will be entered into the listbox. This code works when everything is all in Form1. </p>\n\n<p>Thank you for looking.</p>\n"},{"tags":["c#",".net","svn","version-control","project-management"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":13268532,"title":"Share a file for C# project at home and at office","body":"<p>I have formed a number of source code files as my library. For example, I wrote <em>LinqExtension.cs</em> providing <em>Median()</em> function.</p>\n\n<p>Now I'm working on a project which needs LinqExtension.cs. As usually, I link the file to the project. As introduced <a href=\"http://greenicicleblog.com/2010/12/01/link-whole-directories-into-visual-studio-projects/\" rel=\"nofollow\">here</a>. The reason that I link files rather than copying them is to keep the files at a single location. If I modify a file, all dependent projects get affected. </p>\n\n<p>I also add the project to Subversion and upload to and download from Google Code. The linked file is not under version control.</p>\n\n<p>I work on the project at home as well as at office. I hate copying the linked file to my office, which makes the file not single. </p>\n\n<p>I figure out a solution that add <code>&lt;Compile Include=\"http://www.example.com/LinqExtension.cs\"/&gt;</code> to csproj file so that the file only exists on the Internet. Once I upload a new verison of the file, all dependent projects get affected.  Unfortunately the solution doesn't work.</p>\n\n<p>Any other suggesions or better practice?</p>\n"},{"tags":["c#","xaml","windows-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13158310,"title":"Rotating an analog dial toward the mouse/pointer in Windows 8 / XAML","body":"<p>I've implemented an Analog dial in Windows 8 XAML, and it almost works </p>\n\n<p>However, when turning the dial it shakes like crazy. it seems to rotate almost 90 degrees clockwise and anticlockwise while being moved. I've implemented it using <code>PointerPressed</code>, <code>PointerReleased</code> and <code>PointerMoved</code></p>\n\n<p>My Code</p>\n\n<pre><code>private void dial_PointerPressed(object sender, PointerRoutedEventArgs e)\n{\n    dialPressed = true;    \n}\n\nprivate void dial_PointerReleased(object sender, PointerRoutedEventArgs e)\n{\n    dialPressed = false;\n}\n\nprivate void dial_PointerMoved(object sender, PointerRoutedEventArgs e)\n{\n    if(dialPressed)\n    {\n        Windows.UI.Input.PointerPoint currentLocation = \n              e.GetCurrentPoint(dial); \n\n        Point dialCenter = \n              new Point(dial.ActualHeight / 2, dial.ActualWidth / 2);\n\n        double radians = Math.Atan(\n              (currentLocation.Position.Y - dialCenter.Y) / \n              (currentLocation.Position.X - dialCenter.X));\n\n        RotateTransform r = new RotateTransform();\n        r.Angle = radians * 180 / Math.PI;\n\n        if (currentLocation.Position.X - dialCenter.X &lt; 0)\n        {\n            r.Angle += 180;\n        }\n\n        TransformGroup t = new TransformGroup();\n        t.Children.Add(r);\n        dial.RenderTransform = t;\n\n    }\n}\n</code></pre>\n\n<p>Should I be binding against different events? What's making my dial shaky? </p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":156,"score":2,"question_id":12649247,"title":"HttpClient.GetAsync fails in background task with lock screen access and both TimeTrigger or MaintenanceTrigger","body":"<p>Client.GetAsync appears to fail for me when running in a background task in my Windows 8 Metro app. </p>\n\n<p>I tried using both a TimeTrigger and a MaintenanceTrigger. It appears that there is no exception. When debugging it, it just exits at that line (if I keep pressing step over), even though there is way more to execute as well as a try-catch around it.</p>\n\n<p>This leads me to believe that Windows is cancelling my task. So I listened to the cancelled event with no luck.</p>\n\n<p>I have declared Internet access as a capability, and the task has been properly registered. Furthermore, my app has full lock screen access.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Here's the code I use to register the background task currently.</p>\n\n<pre><code>if (await ObtainLockScreenAccess())\n{\n    const string name = \"Task\";\n\n    var updaterTasks = BackgroundTaskRegistration.AllTasks.Where(t =&gt; t.Value.Name == name);\n    if (!updaterTasks.Any())\n    {\n\n        var builder = new BackgroundTaskBuilder();\n        builder.Name = name;\n        builder.TaskEntryPoint = \"Stackstabilizer.BackgroundTasks.UpdateBackgroundTask\";\n\n        var trigger = new MaintenanceTrigger(15, false);\n        var condition = new SystemCondition(SystemConditionType.InternetAvailable);\n\n        builder.AddCondition(condition);\n        builder.SetTrigger(trigger);\n\n        var task = builder.Register();\n\n        Debug.WriteLine(\"Task has been registered\");\n\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong> Here's the background task signature:</p>\n\n<pre><code>namespace Stackstabilizer.BackgroundTasks\n{\n    // You must use a sealed class, and make sure the output is a WINMD. \n    public sealed class UpdateBackgroundTask : IBackgroundTask\n    {\n        public async void Run(IBackgroundTaskInstance taskInstance)\n        {\n\n            var deferral = taskInstance.GetDeferral();\n\n            try { ... } finally { deferral.Complete(); }\n\n        }\n     }\n\n}\n</code></pre>\n\n<p>And here's some details on my declarations.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x6u6E.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","process"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":584,"score":2,"question_id":6857019,"title":"How to start Process hidden?","body":"<p>I start a Console Application via ProcessStartInfo and process.Start(). I want to hide the black window.  Here's my code:</p>\n\n<pre><code>string output = \"\";\n            //Setup the Process with the ProcessStartInfo class\n            ProcessStartInfo startInfo = new ProcessStartInfo();\n            startInfo.FileName = \"C:\\\\WINNT\\\\system32\\\\cmd.exe\";\n            startInfo.UseShellExecute = false;\n\n            startInfo.RedirectStandardOutput = true;\n\n            //Start the process\n           Process proc = Process.Start(startInfo);\n</code></pre>\n"},{"tags":["c#",".net","asynchronous","exception-handling","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13267029,"title":"How do I catch in C# an exception from an asynchronous method that is awaited?","body":"<p>I'm basically wondering how I should, in C#, catch exceptions from asynchronous methods that are waited on through the <code>await</code> keyword. Consider for example the following small console program, which most importantly contains a method called <code>AwaitSync</code>. <code>AwaitSync</code> calls <code>TestAsync</code>, which returns a Task that when executed throws an exception. I try to catch the exception in <code>AwaitAsync</code>, <em>but it goes unhandled</em>.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        AwaitAsync();\n        Console.ReadKey();\n    }\n\n    static async Task AwaitAsync()\n    {\n        try\n        {\n            await TestAsync();\n        }\n        catch (Exception)\n        {\n            Console.WriteLine(\"Exception caught\");\n        }\n    }\n\n    static Task TestAsync()\n    {\n        return Task.Factory.StartNew(() =&gt; { throw new Exception(\"Test\"); });\n    }\n}\n</code></pre>\n\n<p>How am I supposed to go about catching the exception from the Task returned by <code>TestAsync</code>? While this example is a console program, my real life problem is within the context of of ASP.NET MVC / Web API.</p>\n\n<p><strong>EDIT:</strong>\nTurns out the exception is getting caught, for technical reasons I just didn't notice the 'Exception caught' message before the terminal closed. In any case, Jon Skeet's answer was very valuable to my understanding of <code>await</code> and exception handling.</p>\n"},{"tags":["c#","search","google","results"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1615,"score":1,"question_id":6538847,"title":"google search result html code c#","body":"<p>I have to create an app which will -- for a given term -- download links of first 10 results from the google search page, however there is a problem,</p>\n\n<p>If I download the source code with the webClient, instead of html-- I get JS code. </p>\n\n<p>I get same result if I take a look at source code in Google chrome (ctrl+u) BUT if I try to inspect that element with built in developer tools I can see real html code</p>\n\n<p>Anyone know how can I download real html code so I can extract links?</p>\n"},{"tags":["c#","asp.net-mvc","unit-testing","nunit","moq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":207,"score":0,"question_id":10401409,"title":"using moq to populate httpcontext.request","body":"<p>I am using the <a href=\"http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx\" rel=\"nofollow\">hanselman tutorial</a> to use Moq to create unit tests for methods that take httpcontext as input parameter. </p>\n\n<pre><code>public static class MvcMockHelpers\n{\n\n    public static HttpContextBase FakeHttpContext()\n    {\n        var context = new Mock&lt;HttpContextBase&gt;();\n        var request = new Mock&lt;HttpRequestBase&gt;();\n        var response = new Mock&lt;HttpResponseBase&gt;();\n        var session = new Mock&lt;HttpSessionStateBase&gt;();\n        var server = new Mock&lt;HttpServerUtilityBase&gt;();\n\n        context.Setup(ctx =&gt; ctx.Request).Returns(request.Object);\n        context.Setup(ctx =&gt; ctx.Response).Returns(response.Object);\n        context.Setup(ctx =&gt; ctx.Session).Returns(session.Object);\n        context.Setup(ctx =&gt; ctx.Server).Returns(server.Object);\n\n        return context.Object;\n    }\n\n    public static HttpContextBase FakeHttpContext(string url)\n    {\n        var context = FakeHttpContext();\n        context.Request.SetupRequestUrl(url);  &lt;---- error here\n        return context;\n    } \n\n\n\n}\n</code></pre>\n\n<p>I am getting the following error on <strong>context.Request.SetupRequestUrl(url);</strong></p>\n\n<p><em>Error  1   'System.Web.HttpRequestBase' does not contain a definition for 'SetupRequestUrl' and no extension method 'SetupRequestUrl' accepting a first argument of type 'System.Web.HttpRequestBase' could be found (are you missing a using directive or an assembly reference?)</em></p>\n\n<p>Please help. </p>\n\n<p>I am trying to find a very simple easy to follow tutorial on setting up httpcontext request object and pass into method with context input parameter and be able to create unit test but all the examples in google either do not work or are complicated. please help.</p>\n"},{"tags":["c#","list","ellipse"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13260056,"title":"How to ensure you clicked on an ellipse object from a list?","body":"<p>I have a list with ellipse objects with the parameters (Point Begin, Point End, Color c). Now I want to ensure when I click somewhere if I did hit an ellipse. </p>\n\n<p>I also do this with rectangles which already works and looks something like this:</p>\n\n<pre><code> case 3: // Rectanglefill\n        return p.X &gt;= Begin.X &amp;&amp; p.X &lt;= End.X &amp;&amp; p.Y &gt;= Begin.Y &amp;&amp; p.Y &lt;= End.Y;\n</code></pre>\n\n<p>In this method I only want to return the bool True if I have a hit and False if the mouse click didn't hit something. </p>\n\n<p>Now for the ellipse I already have this:</p>\n\n<pre><code>case 4: // Ellipsfill\n/*  int radiusx = Math.Abs(End.X - Begin.X) / 2;\n    int radiusy = Math.Abs(End.Y - Begin.Y) / 2;\n    int midpointx = (Begin.X + End.X) / 2;\n    int midpointy = (Begin.Y + End.Y) / 2;\n\nreturn ((Math.Pow((p.X -midpointx) / radiusx, 2) + Math.Pow((p.Y - midpointy) / radiusy, 2)) &gt; 1);\n</code></pre>\n\n<p>But this doesn't work.</p>\n"},{"tags":["c#",".net","hl7","object-model"],"answer_count":5,"favorite_count":10,"up_vote_count":12,"down_vote_count":0,"view_count":6200,"score":12,"question_id":777933,"title":"HL7 object model for .NET","body":"<p>Searching for a library or framework that would provide an object model, parsing, validating, etc</p>\n\n<p>The idea would be to be able to spin up a new object of type hl7 v2 or v3. Then perhaps call it message type ORU_R01 or ADT, or ORM.</p>\n\n<p>Wouldn't life be great if we were able to do something like this:</p>\n\n<pre><code>HL7V2 myMessage = new HL7V2();\nmyMessage.Type = V2MsgTypes.ORU_R01;\nmyMessage.TryParse(someHL7_string);\n\nif (myMessage.IsValid)\n{\n  //do some work\n  //maybe access the PID segment\n  if (myMessage.Patient.Names.FamilyName ==\"Johnson\")\n  {\n    //do more work\n  }\n}\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2159,"score":5,"question_id":4794355,"title":"WPF 4: Grow/Shrink TextBlock (Font Size) based on available space","body":"<p>I've seen this question asked a lot, however, to the opposite of what I'm looking for.  While other people want a control to size itself based on the size of text, I'm trying to figure out is if there is a way to grow the size of text to the amount of space available.</p>\n\n<p>Take the idea of a digital clock window and you want the numbers stating the time to grow (or shrink) based on the size of the window the clock is in.  If there isn't a way to automatically do this any pointers to a programmatic way I can get this accomplished?</p>\n\n<p>Thanks in advanced.</p>\n"},{"tags":["c#","android","mono"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13267476,"title":"Cannot show waiting message while long operation is running in Mono for Android","body":"<p>I'm trying to show a waiting message via a Toast while a long operation is running. I'm using a BackgroundWorker.\nThis code is inside a ListView_ItemClick event handler:</p>\n\n<pre><code>var bgWait = new BackgroundWorker();\nbgWait.DoWork += bgWait_DoWork;\nbgWait.RunWorkerAsync();\nbgWait.RunWorkerCompleted += bgWait_Completed;\n</code></pre>\n\n<p>The code in bgWait_DoWork event handler is the following:</p>\n\n<pre><code>private void bgWait_DoWork(object sender, DoWorkEventArgs e)\n{\nvar toastWait = Toast.MakeText(this, \"Please wait\", ToastLength.Long);\ntoastWait.SetGravity(GravityFlags.Top &amp; GravityFlags.Center, 0, 0);\ntoastWait.Show();\nTimeConsumingOperation();\ntoastWait.Cancel();\n}\n</code></pre>\n\n<p>When I run in debug mode, it seems that only the first line from bgWait_DoWork is reached - \"var toastWait = Toast.MakeText(this, \"Please wait\", ToastLength.Long);\" - and then it jumps to bgWait_Completed event handler.</p>\n\n<p>Any idea why this is happening?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","parsing","flags"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13268604,"title":"C# Flags parsing","body":"<p>I have wrote enum:</p>\n\n<pre><code>[Flags]\npublic enum BundleOS {\n    Win32 = 0,\n    Win64 = 1,\n    Mac = 2\n}\n</code></pre>\n\n<p>I need parse it from string, and write to string. Sample of string: <code>\"Win32|Win64\"</code>. \nNext code returns invalid result:</p>\n\n<pre><code>BundleOS os;\nBoolean result = TryParse&lt;BundleOS&gt;(\"Win32|Win64\", out os);\n</code></pre>\n\n<p>In <code>result</code> variable I got the <code>false</code> value. But I need <code>true</code>, and <code>os</code> value must to have the <code>BundleOS.Win32|BundleOS.Win64</code> value.</p>\n\n<hr>\n\n<p>If I do such operation:</p>\n\n<pre><code>String x = (BundleOS.Win32|BundleOS.Win64).ToString();\n</code></pre>\n\n<p>I need get such value: <code>\"Win32|Win64\"</code>, but I get <code>\"Win64\"</code>.</p>\n\n<p>Is exists a simple solution of these problems?</p>\n"},{"tags":["c#","asp.net","events"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13268068,"title":"How to fire an event when dropdown inside Repeater changes","body":"<p>I want to do some actions in my database when user change dropdown's selectedIndex.Now I have the following.</p>\n\n<pre><code>&lt;td class=\"shop-item-qty\"&gt;\n&lt;asp:DropDownList ID=\"qtyDropDownList\" OnSelectedIndexChanged=\"changeCount\" AutoPostBack=\"true\"  runat=\"server\"/&gt;\n&lt;asp:HiddenField ID=\"ItemId\" runat=\"server\" Value='&lt;%#Eval(\"GiftVoucher.ID\") %&gt;'/&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>All I want is to get my hidden fields value in <code>changeCount</code> method. The problem is that I can't directly get hidden fields value, because this code is in <code>Repeater</code> element. How can I achieve that functionality?</p>\n"},{"tags":["c#","asp.net","checkbox","repeater"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13262955,"title":"Repeater control checkbox event not fired","body":"<p>Am having three check box in repeater control. I need the concept like radio button list.When i click the first row first checkbox, other two are checked property is set to false. suppose i check the second one means first and third are unchecked. </p>\n\n<p><strong>My Design code is here :</strong></p>\n\n<pre><code>      &lt;asp:Repeater ID=\"repeaterItems\" runat=\"server\" \n                                                                    onitemdatabound=\"repeaterItems_ItemDataBound\" &gt;\n    &lt;ItemTemplate&gt;\n       &lt;table id=\"mytable\" cellspacing=\"0\" width=\"100%\" align=\"center\"&gt;\n          &lt;tr&gt;\n               &lt;td style=\"width: 18px;\"&gt;\n               &lt;asp:Label ID=\"id\" runat=\"server\" Text='&lt;%#Bind(\"fld_id\")%&gt;'&gt;&lt;/asp:Label&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 301px;\"&gt;\n              &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%#Bind(\"fld_Question\")%&gt;'&gt;&lt;/asp:Label&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 10px;\"&gt;   \n                    &lt;asp:CheckBox ID=\"CheckBox1\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox1_CheckedChanged\" /&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 30px;\"&gt;\n                     &lt;asp:CheckBox ID=\"CheckBox2\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox2_CheckedChanged\"/&gt;\n               &lt;/td&gt;\n               &lt;td style=\"width: 33px;\"&gt;\n                     &lt;asp:CheckBox ID=\"CheckBox3\" runat=\"server\" AutoPostBack=\"true\" OnCheckedChanged=\"CheckBox3_CheckedChanged\"/&gt;\n               &lt;/td&gt;\n             &lt;/tr&gt;\n           &lt;/table&gt;\n        &lt;/ItemTemplate&gt;\n     &lt;/asp:Repeater&gt;\n</code></pre>\n\n<p><strong>code is :</strong> </p>\n\n<pre><code>protected void CheckBox1_CheckedChanged(object sender, EventArgs e)\n    {\n        CheckBox chk1 = sender as CheckBox;\n        RepeaterItem item = chk1.Parent as RepeaterItem;\n        CheckBox chk2 = item.FindControl(\"CheckBox2\") as CheckBox;\n        chk2.Checked = false;\n    }\n\n    protected void CheckBox2_CheckedChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void CheckBox3_CheckedChanged(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void repeaterItems_ItemCreated1(object sender, RepeaterItemEventArgs e)\n    {\n        RepeaterItem ri = (RepeaterItem)e.Item;\n\n        if (ri.ItemType == ListItemType.Item || ri.ItemType == ListItemType.AlternatingItem)\n        {\n            CheckBox chk = (CheckBox)e.Item.FindControl(\"CheckBox1\");\n            chk.CheckedChanged += new EventHandler(CheckBox1_CheckedChanged);\n        }\n    }\n</code></pre>\n\n<p>CheckBox1_CheckedChanged event not fire. Please help me to fix this error.\nI spent more time to solve this issue but i can't.. </p>\n"},{"tags":["c#",".net","oop","hl7"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3366,"score":5,"question_id":1999159,"title":"dotnet HL7 integration library","body":"<p>I have a medical health database that a 3rd party needs to connect to.</p>\n\n<p>We need to look at using the HL7 standards.</p>\n\n<p>I am looking for a good library to make using HL7 easier in a dotnet enviroment.</p>\n\n<p>I will need a comprehensive 2.x and 3.x lib that can do most of the heavy lifting.</p>\n\n<p>I want to try and avoid using message parsing and would rather use an object model as much as possible.</p>\n\n<p>I have seen <a href=\"http://nhapi.sourceforge.net/\">http://nhapi.sourceforge.net/</a> but this only seems to go to v2.x and not 3.x.</p>\n\n<p>Has any one used this library adn what was your feelings about this? was it useful adn productive?</p>\n\n<p>Any suggestions are welcome.</p>\n\n<p>Opensource or comercial are both good.</p>\n\n<p>thanks</p>\n"},{"tags":["c#","asp.net-mvc-3","razor"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13267914,"title":"mvc3 Razor foreach loop issues","body":"<p>Hi I have the following code but the if statement within the loop causes the statement to fail, any ideas please?</p>\n\n<pre><code>@{ var count = 1; }\n@foreach (var siteIcon in Model.SiteIconsList)\n{\n    &lt;div class=\"span2\"&gt;\n        &lt;a onclick=\"updateIcon(@siteIcon.ImageId)\" href='#'&gt;\n            &lt;img class=\"iconImage\" src=\"data:Image;base64,@(Html.Raw(Convert.ToBase64String(siteIcon.ImageData)))\" alt=\"\" /&gt;\n        &lt;/a&gt;\n    &lt;/div&gt;\n    if(count==5){\n        &lt;/div&gt;\n         &lt;div class=\"row-fluid\"&gt;\n         count=1;\n    }\n}\n</code></pre>\n"},{"tags":["c#","settings","project"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13266953,"title":"Define my own environment variables in C# project settings","body":"<p>I want to define my own environment variables which are used in the project settings, like $(TARGETPATH) and some predefined variables do.</p>\n\n<p>How can I do this in C#?</p>\n"},{"tags":["c#","pdu","string-decoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13268026,"title":"Decoding into USSD 7 bit","body":"<p>can anyone decode this into 7 bit USSD code..and tell me exactly how you did it ??</p>\n\n<p>AA986c3602</p>\n\n<p>For eg encoding *600*1# becomes 2A1B0CA68A8D1A</p>\n\n<p>Thanks in advance </p>\n"},{"tags":["c#",".net","visual-studio","ms-word","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13266926,"title":"Print an RTF containing headers and footers on a server","body":"<p>I have been looking for a way of printing an RTF file containing headers and footers to a named printer from a server, and would appreciate any pointers in where I should look next.</p>\n\n<p>I have looked at a couple of ways of handling this:</p>\n\n<p>First I looked into using a ShellExecute \"PrintTo\" call, which works exactly how I want it as long as either Word or OpenOffice is installed to correctly 'render' the RTF. However, the limitation of needing to install either of these applications is undesirable.</p>\n\n<p>The other option I have looked into is using a RichEditBox to load the RTF into and print from there, but header and footer information is then ignored.</p>\n\n<p>Is it possible to open an RTF file on the server, in the same format as it would be opened in Word, using just .net?</p>\n"},{"tags":["c#","arrays","params"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13268151,"title":"C#: Convert array to use in params with additional parameters","body":"<p>I have a method that takes params. Inside the method another variable shall be added to the output:</p>\n\n<pre><code>private void ParamsTest(params object[] objs)\n{\n  var foo = \"hello\";\n  // Invalid: Interpretes objs as single array parameter:\n  Console.WriteLine(\"{0}, {1}, {2}\", foo, objs);\n}\n</code></pre>\n\n<p>When I call</p>\n\n<pre><code>ParamsTest(\"Hi\", \"Ho\");\n</code></pre>\n\n<p>I would like to see the output.</p>\n\n<pre><code>hello Hi Ho\n</code></pre>\n\n<p>What do I need to do? </p>\n\n<p>I can copy <code>foo</code> and <code>objs</code> into a new array and pass that array to <code>WriteLine</code> but is there a more elegant way to force <code>objs</code> to behave as params again? Kind of <code>objs.ToParams()</code>?</p>\n"},{"tags":["c#","sql-server","entity-framework","extended-properties"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13268446,"title":"Get Extended Property in edmx modeling Db","body":"<p>I have a database modelling by Entity Framework. I need to read the extended properties of each table through the object context associated to my Db. How can i do?</p>\n\n<p>Thank's in advance</p>\n"},{"tags":["c#","html","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13267937,"title":"Regex c# html spider","body":"<p>I'm trying to have my console application return me all of these values in a html webpage:\n<code>&lt;img border=\"0\" alt=\"img.jpg\" title=\"img.jpg\" src=\"/_layouts/images/icjpg.gif\" /&gt;</code></p>\n\n<p>However I'm only interested in the <code>title=\"img.jpg\"</code>.\nI've seen that Regular expressions can be used to filter these, however I don't see how I filter the rest away and only keep <code>title=\"img.jpg\"</code> or the value in the <code>title=\"THIS\"</code></p>\n\n<p>Any help would be appreciated. </p>\n\n<p>I've seen this <a href=\"http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet\" rel=\"nofollow\">cheatlist for regex</a></p>\n"},{"tags":["c#","matrix"],"answer_count":4,"favorite_count":7,"up_vote_count":19,"down_vote_count":0,"view_count":11337,"score":19,"question_id":2336701,"title":"Recommendation for C# Matrix Library","body":"<p>I need a C# library to deal with matrices. It should implement singular value decomposition, matrix inversion, etc</p>\n\n<p>I've used <a href=\"http://www.codeproject.com/Articles/19032/C-Matrix-Library\" rel=\"nofollow\">CSML</a> before, but this does not implement some of the features i need. </p>\n\n<p>Some of the features are:<br>\nSingular value decomposition<br>\nMatrix inversion<br>\nTrace<br>\nDeterminants  </p>\n\n<p><strong>Suggested Libraries (from answers)</strong></p>\n\n<p>(most of them implement the features stated above)</p>\n\n<ul>\n<li><a href=\"http://numerics.mathdotnet.com/\" rel=\"nofollow\">Math .NET Numerics for .NET, Silverlight and Mono</a> (opensource)</li>\n<li><a href=\"http://www.extremeoptimization.com/\" rel=\"nofollow\">Extreme Optimization Numerical Libraries</a> (commercial, very\ncomplete)</li>\n<li><a href=\"http://ilnumerics.net/%24Home.html\" rel=\"nofollow\">IL Numerics</a> (commercial)</li>\n<li><a href=\"https://rtmath.net/products/finmath/\" rel=\"nofollow\">Deltix's FinMath numerical library</a> (commercial,  uses the Intel®\nMath Kernel Library (MKL) and Intel® Integrated Performance\nPrimitives (IPP))</li>\n<li><a href=\"http://blog.ivank.net/lightweight-matrix-class-in-c-strassen-algorithm-lu-decomposition.html\" rel=\"nofollow\">Lightweight fast matrix class in C#</a> (Strassen algorithm, LU\ndecomposition)</li>\n</ul>\n"},{"tags":["c#",".net","winforms","buttonclick","axwindowsmediaplayer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13268219,"title":"Accessing windows media player component on a form from another form","body":"<p>I'm making a C# application in which I have 2 forms: Form1 &amp; Form2. Form1 contains a windows media player COM component(axwindowsmediaplayer1), which I'm using to play songs on button click. \nNow, I want to invoke axwindowsmediaplayer1  from button click on Form2. I tried to make a static function(so that I can use it as Form1.function_name), but it gives error since axwindowsmediaplayer1 isn't static. </p>\n\n<p>How I can do this ? Please help. </p>\n"},{"tags":["c#","windows-phone-7","windows-phone-7.1","isolatedstorage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13268246,"title":"Value does not fall within the expected range, IsolatedStorage","body":"<p>I have a class that I wrote that saves and retrieves any objects to a windows phone isolated storage system. Have a look...</p>\n\n<pre><code>public class DataCache\n{\n    // Method to store an object to phone ************************************\n    public void StoreToPhone(string key, Object objectToStore)\n    {\n        var settings = IsolatedStorageSettings.ApplicationSettings;\n\n        try\n        {\n            if (existsInStorage(key))\n            {\n                settings.Remove(key);\n                settings.Add(key, objectToStore);\n            }\n            else\n            {\n                settings.Add(key, objectToStore);\n            }\n        }\n        catch (Exception e)\n        {\n            MessageBox.Show(\"An error occured while trying to cache data: \" + e.Message);\n        }\n    }\n\n    // Method to retrieve an object ******************************************\n    public Object retrieveFromPhone(string key)\n    {            \n        var settings = IsolatedStorageSettings.ApplicationSettings;            \n        Object retrievedObject = null;\n\n        try\n        {\n            if (existsInStorage(key))\n            {\n                settings.TryGetValue&lt;Object&gt;(key, out retrievedObject);\n            }\n            else\n            {\n                MessageBox.Show(string.Format(\"Cannot find key {0} in isolated storage\", key));\n            }\n        }\n        catch(Exception e)\n        {\n            MessageBox.Show(\"An error occured while trying to retrieve cache object: \"+e.Message);\n        }\n        return retrievedObject;\n    }\n\n    // Helper method to check if there is space on the phone to cache the data\n    private bool IsSpaceAvailable(long spaceReq)\n    {\n        using (IsolatedStorageFile store = IsolatedStorageFile.GetUserStoreForApplication())\n        {\n            long spaceAvail = store.AvailableFreeSpace;\n            if (spaceReq &gt; spaceAvail)\n            {\n                return false;\n            }\n            return true;\n        }\n    }\n\n    // Method to check if key exists in isolated storage *********************\n    public bool existsInStorage(string key)\n    {\n        var settings = IsolatedStorageSettings.ApplicationSettings;\n        bool objectExistsInStorage = settings.Contains(key);\n        return objectExistsInStorage;\n    }\n}\n</code></pre>\n\n<p>When I run my app and try and store some data using my StoreToPhone() method I get the following error:</p>\n\n<blockquote>\n  <p>An error occurred while trying to cache data: Value does not fall within the expected range</p>\n</blockquote>\n\n<p>I don't exactly know what this means.. Is it not expecting this type of object? I'm not sure... I'm passing it a custom class I wrote fyi.</p>\n"},{"tags":["c#","asp.net","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13268386,"title":"Access denied error when publishing web site to server","body":"<p>I've built a website using ASP.NET MVC2 and it runs perfectly run on localhost. However, when I go to <code>Build -&gt; Publish</code> and publish the website to the server, I get a 403 Forbidden error. The files are there, as I can see <code>Site.css</code> if I navigate to it.</p>\n\n<p>I'm not sure if it matters, but here's my entire Web.config file:</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"FostConnection\" connectionString=\"server=myserver;database=mydatabase;uid=myuser;password=mypassword;\" providerName=\"System.Data.SqlClient\" /&gt;\n  &lt;/connectionStrings&gt;\n\n  &lt;system.web&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n        &lt;add assembly=\"System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n        &lt;add assembly=\"System.Web.Mvc, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n\n    &lt;pages&gt;\n      &lt;namespaces&gt;\n        &lt;add namespace=\"System.Web.Mvc\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n        &lt;add namespace=\"System.Web.Routing\" /&gt;\n      &lt;/namespaces&gt;\n    &lt;/pages&gt;\n  &lt;/system.web&gt;\n\n  &lt;system.webServer&gt;\n    &lt;validation validateIntegratedModeConfiguration=\"false\"/&gt;\n    &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n  &lt;/system.webServer&gt;\n\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"System.Web.Mvc\" publicKeyToken=\"31bf3856ad364e35\" /&gt;\n        &lt;bindingRedirect oldVersion=\"1.0.0.0\" newVersion=\"2.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>What would be some common causes for this that I can iron out?</p>\n"},{"tags":["c#",".net","encryption","yahoo-messenger"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":3,"view_count":307,"score":0,"question_id":5565150,"title":"What encryption generates this type of text?","body":"<p>I'm trying to decode a DAT file produced by Yahoo Messenger, which looks similar to the text below which I generated by opening an exe in Notepad:</p>\n\n<pre><code>‹\n‹N€9 tè…ÀtäÿFöt‹FŠ ‹V‹NˆÿFÿNëÿFH‰F3À9Ft9Ft  ö…³   ;Øtsj÷ël;Øt%‹F‹N¶Dÿj Pÿ5@aÐMè5  …À„þÿÿ…Ûuƒ} tÇEø   jEPÿvÿvÿuøÿ5DaÐMÿÐM…Àu,ÿÐM=Y  tjðë…ÛtjöXë&lt;3Àf‹F,ÇF.   ‰Eë‹E‹N…Étÿv2PÿÑëƒ~$ t\n‹N(f‰ƒF(ÿF 3À‰F_[ÉÂ ÌÌÌÌÌƒù\nu&lt;r&lt;Ÿ\n</code></pre>\n\n<p>I have tried few online tools that has various encryption algorithm like Blow-fish, DES, MD5 1-Way and other normal encryption like leet speak, rot-13 etc, but i found the generated text is normal readable but not the original one. I think its AES or RSA or Triple DES. Actually i am working on a utility that will read the Yahoo Messengers archive of the local. But when i open the local , I found a DAT file, with encrypted text as above. </p>\n\n<p><strong>(UPDATE)</strong> </p>\n\n<p>As per venkyduded article \"yahoo uses a simple XOR algorithm to encode the messages (so much for security !!) \". Any good link on XOR rversing.</p>\n\n<p>Any help would be highly appreciated.</p>\n"},{"tags":["c#","debugging","sockets","background","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":11792361,"title":"Debugging of WinRT's background networking","body":"<p>I've made a project than uses tcp sockets connectivity (own closed protocol), added background connectivity with Network Trigger API, as described <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=28999\" rel=\"nofollow\">here</a> (starting from page 17) - StreamSocket control channel registration block, and IBackgroundTask class, that should be fired each time socket receives something.</p>\n\n<p>Have tried everything to debug the code in background task, with no use:</p>\n\n<ul>\n<li>closing the visible app with a gesture</li>\n<li>lock the screen</li>\n<li>tried to load some other heavy application, to make windows suspend my app </li>\n</ul>\n\n<p>All these have not helped me to make background task run (and debug) during socket message. What am I doing wrong? Should I have to get the separate suspendable device, like a WinRT tablet, to get this working?</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13256059,"title":"Azure october 2012 sdk - how to delete a table entity without retrieving it first?","body":"<p>In the previous version we could do this to delete an entity without knowing whether it exists.</p>\n\n<pre><code>svc = new TestContext();\nitem = new TestEntity(\"item2pk\", \"item2rk\");\nsvc.AttachTo(\"TestTable\", item, \"*\");\nsvc.DeleteObject(item);\nsvc.SaveChanges();\n</code></pre>\n\n<p><a href=\"http://blog.smarx.com/posts/deleting-entities-from-windows-azure-without-querying-first\" rel=\"nofollow\">(source)</a></p>\n\n<p>The new TableOperations doesn't have this syntax. Do I have to use this old method or is there a way? I'd like to be consistent because now all my code use the new classes for version 2.</p>\n\n<p>edit: the title was misleading</p>\n"},{"tags":["c#","assemblies","globalization"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13201717,"title":"Finding Globalized Resource files when remotely loading an assembly","body":"<p>Our code uses a \"Plugin\" model, that remotely loads dll's conforming to a predefined structure <code>IPluginModel</code> that is defined in the main program.  The main program itself has several localized forms where the text and placement of the labels in the UI are all changed based on the different localization <code>Thread.CurrentThread.CurrentUICulture</code>.</p>\n\n<p>One thing that we noticed is that any forms or reports from the remotely loaded dll's will never be properly localized.  It does not seem to matter where the localization dll's containing the different resources for the plugin are located, either next to the main form, next to the plugin dll, or anywhere else.  How would one cause the Assembly to correctly locate its localized resources when the assembly itself is loaded during RunTime of the main program?</p>\n\n<p>I do have code that rather resembles the method used <a href=\"http://stackoverflow.com/questions/3125153/dynamically-loading-a-resource-and-reading-the-correct-value-for-the-currentuicu\">Here</a>, but dont want to have to manually implement the resx against the form itself if at all possible.  The code I have is located directly inside the plugin itself and is called whenever the CurrentUICulture is NOT \"en-US\".</p>\n\n<p>Ideally speaking, what Im looking for is a way to load the <code>pluginName.resources.dll</code> which is directly associated with the plugin I just loaded.  I do see the different folders in my main projects bin folder, the es folder contains a <code>main.resources.dll</code>, but simply placing the plugin dll's in that folder did not seem to work last time I tried it, although in theory that could have changed...or I may have done it wrong at the time...</p>\n\n<p><strong>Loading the assembly [code snippet]</strong></p>\n\n<pre><code>    private void LoadPlugin(string filePath)\n    {\n        bool isValidPlugin = false;\n        Assembly asm = null;\n        try\n        {\n            asm = Assembly.LoadFrom(Path.Combine(Environment.CurrentDirectory, filePath));\n                //Do some type checking to make certain this is in fact one of OUR plugins\n            var p = (IFTLPlugin)Activator.CreateInstance(types[x]);\n                _plugins.Add(p.Prefix, p);\n            }\n        }\n</code></pre>\n"},{"tags":["c#","asp.net","c#-4.0","asynchronous"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13266277,"title":"How do I call async methods in asp.net C# 4.0?","body":"<p>I'm aware that with .net 4.5 there is the await, async keywords that allows for easy calling of async methods. I 'm currently studying how to make async calls in C# 4.0. An example I want to is to make an async call where the datagrid is being databind. </p>\n\n<p>If you could provide me some links I would really appreciate it.</p>\n"}]}
{"total":375450,"page":16,"pagesize":100,"questions":[{"tags":["c#","backgroundworker","oledbconnection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13247816,"title":"Cannot open OleDbConnection in BackgroundWorker","body":"<p>When trying to read data from mdb using backgroundworker I get an error </p>\n\n<blockquote>\n  <p>The program '[3768] BackgroundWorkerExample.vshost.exe: Managed' has exited with code 0 (0x0).</p>\n</blockquote>\n\n<p>without any other information or exception and I'm not able to catch it. Here is my code, without BGW it works fine. Do I miss something?</p>\n\n<pre><code>namespace BackgroundWorkerExample\n{\npublic class TestClass\n{\n    BackgroundWorker _Worker;\n\n    public TestClass()\n    {\n        InitializeWorker();\n    }\n\n    public void InitializeWorker()\n    {\n        _Worker = new BackgroundWorker();\n\n        _Worker.DoWork += new DoWorkEventHandler(WorkerDoWork);\n        _Worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(WorkerRunWorkerCompleted);\n    }\n\n    private void WorkerRunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        Console.WriteLine(\"Work completed!\");\n    }\n\n    private void WorkerDoWork(object sender, DoWorkEventArgs e)\n    {\n        DataTable data = GetDataTable();\n        PrintResults(data);\n    }\n\n    public void Run()\n    {\n        _Worker.RunWorkerAsync();\n    }\n\n    public DataTable GetDataTable()\n    {\n        string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\students.mdb;\";\n\n        try\n        {\n            using (OleDbConnection con = new OleDbConnection(connectionString))\n            {\n                try\n                {\n                    con.Open(); // crashes here!\n\n                    DataTable res = new DataTable();\n\n                    string query = \"SELECT * FROM students\";\n\n                    OleDbDataAdapter adapter = new OleDbDataAdapter(query, con);\n                    adapter.Fill(res);\n\n                    return res;\n                }\n                catch (Exception ex)\n                {\n                    Console.WriteLine(ex.Message);\n                    return null;\n                }\n            }\n        }\n        catch (Exception e)\n        {\n            // never reaches this part\n            return null;\n        }\n    }\n\n    public void PrintResults(DataTable data)\n    {\n        foreach (DataRow row in data.Rows)\n        {\n            for (int i = 0; i &lt; 5; i++)\n            {\n                Console.Write(row[i] + \"   \");\n            }\n            Console.WriteLine();\n        }\n    }\n}\n}\n</code></pre>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13265015,"title":"Stretch WrapGrid item width","body":"<p>I am using a <code>WrapGrid</code> as <code>itemscontrol</code> in a <code>ListView</code> to present items horizontally with following XAML code (WinRT)</p>\n\n<pre><code>&lt;ItemsPanelTemplate &gt;\n    &lt;WrapGrid x:Name=\"ContentGrid\" MinWidth=\"200\" MinHeight=\"0\" VerticalAlignment=\"Top\"   HorizontalAlignment=\"Center\"   Orientation=\"Horizontal\" Margin=\"0,0,0,5\" &gt;                                     \n    &lt;/WrapGrid&gt;\n&lt;/ItemsPanelTemplate&gt;\n</code></pre>\n\n<p>Now how can i <strong>stretch items horizontally</strong> when the width is more than <code>MinWidth</code> and No More items can be added Horizontally. (All the items are aligned to center and there are lots of space in both sides horizontally)</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"CustomChildItemTemplete\"&gt;\n   &lt;Grid Background=\"Red\"&gt;\n   &lt;/Grid&gt;\n&lt;/DataTemplate &gt;\n</code></pre>\n\n<p><strong>More Details:</strong>  When the <code>listview</code> width is Around 800 (approx) it is showing 4 items horizontal (as minimum item width is 200) but if the width is 900 (4 items visible) and blank space (50 px) is in Right and Left of the <code>itemscontrol</code>, how can i remove this blank space by increasing the item width (simply item width must be 225 when <code>listview</code> width is 900)</p>\n"},{"tags":["c#",".net","xmltextwriter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13264853,"title":"xmlTextWriter does not save the XML file to bin folder","body":"<p>I am trying to create an XML file for storing some info from  a class. I gave the path as a const set to <code>Info.xml</code>. but the <code>XMLTextWriter</code> is not saving the XML file to bin(debug/release) folder, rather it is saving it to MyDocuments folder. When i tried to check if the file exists with <code>File.Exists(path)</code>, its returning false. Could somebody please guide me here.</p>\n\n<p>My code looks as below...</p>\n\n<pre><code>string BookName = \"Book1\" \nstring AuthorName= \"Author1\" \nXmlTextWriter writer = new XmlTextWriter(\"Info.xml\", Encoding.UTF8);    writer.WriteStartDocument(); \nwriter.WriteStartElement(\"Title\"); \nwriter.WriteString(BookName); \nwriter.WriteStartElement(\"Author\"); \nwriter.WriteString(AuthorName); \nwriter.WriteEndElement(); \nwriter.WriteEndElement(); \nwriter.WriteEndDocument(); \nwriter.Close();\n</code></pre>\n"},{"tags":["c#","xml-serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13251548,"title":"XML deserializing null properties to zero and false","body":"<p>I am passing an xml doc with some attributes missing to a deserilaliser. I need the missing values to be null in the resulting object but currently ints deserialise to zero and bools to false.</p>\n\n<p>The example below shows a doc with vals deserialising correctly but the doc without vals returning the zeros and nulls. </p>\n\n<p>How do force the deserialiser not to treat missing attributes like this.</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Xml;\nusing System.Xml.Serialization;\n\nnamespace SOQuestion\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            var resultWithVals = getObject(docWithVals());\n            var resultWithoutVals = getObject(docWithoutVals());\n\n            Console.WriteLine(\"WITH VALS\");\n            Console.WriteLine(resultWithVals.someBool);\n            Console.WriteLine(resultWithVals.someFloat);\n            Console.WriteLine(resultWithVals.someInt);\n            Console.WriteLine(resultWithVals.someString);\n\n\n            Console.WriteLine(\"WITHOUT VALS\"); // nulls are returned here as zero and false\n            Console.WriteLine(resultWithoutVals.someBool);\n            Console.WriteLine(resultWithoutVals.someFloat);\n            Console.WriteLine(resultWithoutVals.someInt);\n            Console.WriteLine(resultWithoutVals.someString);\n\n            Console.ReadLine();\n\n\n        }\n\n        public static XmlDocument docWithVals()\n        {\n            var doc = new XmlDocument();\n            var el = (XmlElement)doc.AppendChild(doc.CreateElement(\"Result\"));\n            el.SetAttribute(\"someString\", \"Hello World\");\n            el.SetAttribute(\"someBool\", \"true\");\n            el.SetAttribute(\"someInt\", \"1\");\n            el.SetAttribute(\"someFloat\", \"1.1\");\n            return doc;\n\n        }\n\n        public static XmlDocument docWithoutVals()\n        {\n            var doc = new XmlDocument();\n            var el = (XmlElement)doc.AppendChild(doc.CreateElement(\"Result\"));\n            el.SetAttribute(\"someString\", \"Hello World\");\n            return doc;\n\n        }\n\n\n        public static Result getObject(XmlDocument doc)\n        {\n\n                var mySerializer = new XmlSerializer(new Result().GetType());\n                var myStream = new MemoryStream();\n                doc.Save(myStream);\n                myStream.Position = 0;\n                var r = mySerializer.Deserialize(myStream);\n                return (Result)r;\n         }\n\n    }\n\n    [Serializable]\n    public class Result\n    {\n        [XmlAttribute]\n        public string someString { get; set; }\n        [XmlAttribute]\n        public bool someBool { get; set; }\n        [XmlAttribute]\n        public int someInt { get; set; }\n        [XmlAttribute]\n        public float someFloat { get; set; }\n\n    }\n\n}\n</code></pre>\n"},{"tags":["c#","templates","listbox","windows-8","listboxitem"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13268103,"title":"Windows store apps - how to use a custom template to a ListBoxItem in C#?","body":"<p>here's an example of my ListBoxItem in a ListBox with a custom template:</p>\n\n<pre><code>&lt;ListBox Margin=\"0,140,0,0\" x:Name=\"ListBox_Main\" VerticalAlignment=\"Top\" Foreground=\"Black\" SelectionChanged=\"ListBox_Main_SelectionChanged\" FontFamily=\"Segoe UI\" Grid.RowSpan=\"2\" FontSize=\"26.667\"&gt;\n            &lt;ListBox.Resources&gt;\n                &lt;Style x:Key=\"CustomStyle_ListBox\" TargetType=\"ListBox\"&gt;\n                    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource ListBoxForegroundThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"Background\" Value=\"{StaticResource ListBoxBackgroundThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"BorderBrush\" Value=\"{StaticResource ListBoxBorderThemeBrush}\"/&gt;\n                    &lt;Setter Property=\"BorderThickness\" Value=\"{StaticResource ListBoxBorderThemeThickness}\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.HorizontalScrollBarVisibility\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.VerticalScrollBarVisibility\" Value=\"Auto\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.HorizontalScrollMode\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsHorizontalRailEnabled\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.VerticalScrollMode\" Value=\"Enabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsVerticalRailEnabled\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.ZoomMode\" Value=\"Disabled\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.IsDeferredScrollingEnabled\" Value=\"False\"/&gt;\n                    &lt;Setter Property=\"ScrollViewer.BringIntoViewOnFocusChange\" Value=\"True\"/&gt;\n                    &lt;Setter Property=\"IsTabStop\" Value=\"False\"/&gt;\n                    &lt;Setter Property=\"TabNavigation\" Value=\"Once\"/&gt;\n                    &lt;Setter Property=\"FontFamily\" Value=\"{StaticResource ContentControlThemeFontFamily}\"/&gt;\n                    &lt;Setter Property=\"FontSize\" Value=\"{StaticResource ControlContentThemeFontSize}\"/&gt;\n                    &lt;Setter Property=\"ItemsPanel\"&gt;\n                        &lt;Setter.Value&gt;\n                            &lt;ItemsPanelTemplate&gt;\n                                &lt;VirtualizingStackPanel/&gt;\n                            &lt;/ItemsPanelTemplate&gt;\n                        &lt;/Setter.Value&gt;\n                    &lt;/Setter&gt;\n                    &lt;Setter Property=\"Template\"&gt;\n                        &lt;Setter.Value&gt;\n                            &lt;ControlTemplate TargetType=\"ListBox\"&gt;\n                                &lt;Border x:Name=\"LayoutRoot\" BorderBrush=\"{TemplateBinding BorderBrush}\" BorderThickness=\"{TemplateBinding BorderThickness}\" Background=\"{TemplateBinding Background}\"&gt;\n                                    &lt;VisualStateManager.VisualStateGroups&gt;\n                                        &lt;VisualStateGroup x:Name=\"CommonStates\"&gt;\n                                            &lt;VisualState x:Name=\"Normal\"/&gt;\n                                            &lt;VisualState x:Name=\"Disabled\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"Transparent\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"BorderBrush\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource ListBoxDisabledForegroundThemeBrush}\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                        &lt;/VisualStateGroup&gt;\n                                        &lt;VisualStateGroup x:Name=\"FocusStates\"&gt;\n                                            &lt;VisualState x:Name=\"Focused\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{StaticResource ListBoxFocusBackgroundThemeBrush}\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                            &lt;VisualState x:Name=\"Unfocused\"&gt;\n                                                &lt;Storyboard&gt;\n                                                    &lt;ObjectAnimationUsingKeyFrames Storyboard.TargetProperty=\"Background\" Storyboard.TargetName=\"LayoutRoot\"&gt;\n                                                        &lt;DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"#FFFFFFFF\"/&gt;\n                                                    &lt;/ObjectAnimationUsingKeyFrames&gt;\n                                                &lt;/Storyboard&gt;\n                                            &lt;/VisualState&gt;\n                                        &lt;/VisualStateGroup&gt;\n                                    &lt;/VisualStateManager.VisualStateGroups&gt;\n                                    &lt;ScrollViewer x:Name=\"ScrollViewer\" BringIntoViewOnFocusChange=\"{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}\" HorizontalScrollMode=\"{TemplateBinding ScrollViewer.HorizontalScrollMode}\" HorizontalScrollBarVisibility=\"{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}\" IsHorizontalRailEnabled=\"{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}\" IsVerticalRailEnabled=\"{TemplateBinding ScrollViewer.IsVerticalRailEnabled}\" IsDeferredScrollingEnabled=\"{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}\" Padding=\"{TemplateBinding Padding}\" TabNavigation=\"{TemplateBinding TabNavigation}\" VerticalScrollBarVisibility=\"{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}\" VerticalScrollMode=\"{TemplateBinding ScrollViewer.VerticalScrollMode}\" ZoomMode=\"{TemplateBinding ScrollViewer.ZoomMode}\"&gt;\n                                        &lt;ItemsPresenter/&gt;\n                                    &lt;/ScrollViewer&gt;\n                                &lt;/Border&gt;\n                            &lt;/ControlTemplate&gt;\n                        &lt;/Setter.Value&gt;\n                    &lt;/Setter&gt;\n                &lt;/Style&gt;\n            &lt;/ListBox.Resources&gt;\n            &lt;ListBox.Style&gt;\n                &lt;StaticResource ResourceKey=\"CustomStyle_ListBox\"/&gt;\n            &lt;/ListBox.Style&gt;\n                &lt;ListBox.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;StackPanel Orientation=\"Vertical\" /&gt;                                     \n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ListBox.ItemsPanel&gt;\n        &lt;ListBox.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"ListBoxItem\"&gt;\n                &lt;Setter Property=\"Padding\" Value=\"120 10 120 10 \" /&gt;\n            &lt;/Style&gt;\n        &lt;/ListBox.ItemContainerStyle&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 1\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 2\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 3\"/&gt;\n            &lt;ListBoxItem Background=\"#19000000\" Template=\"{StaticResource CustomStyle_ListBoxItem}\" Content=\"Item 4\"/&gt;\n        &lt;/ListBox&gt;\n</code></pre>\n\n<p>and now I wanna add another ListBoxItem in C#:</p>\n\n<pre><code>ListBoxItem item = new ListBoxItem();\nitem.Content = \"item 5\";\nListBox_Main.add(item); //credit goes to Danilo Vulović\n</code></pre>\n\n<p>now I want to use the {StaticResource CustomStyle_ListBoxItem} which is a template used by my ListBoxItems in XAML, how can I do this in C#?</p>\n"},{"tags":["c#","dynamics-crm-2011"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13235030,"title":"How to get result of rollup query for a custom entity","body":"<p>When trying to get the records I get this error</p>\n\n<pre><code>The 'Rollup' method does not support entities of type 'new_X'.\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>RollupRequest req = new RollupRequest();\nQueryExpression qe = new QueryExpression();\nqe.EntityName = \"new_x\";\nqe.ColumnSet = new ColumnSet(true);\nreq.Query = qe;\nreq.Target = new EntityReference(\"new_newpost\", new Guid(\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"));\nreq.RollupType = RollupType.Related;\nRollupResponse resp = (RollupResponse)xrm.Execute(req);\n</code></pre>\n\n<p>How can I get the results of rollup query</p>\n\n<p>Thanks in advance</p>\n\n<hr>\n\n<p>For custom entities you can do the fallowing</p>\n\n<pre><code>var rollupQuery = xrm.GoalRollupQuerySet.Where(c =&gt; c.Id == x.new_RecordstoRun.Id).First();\nvar result = xrm.RetrieveMultiple(new FetchExpression(rollupQuery.FetchXml));\n</code></pre>\n\n<p>But - How can I add a 'Skip' or 'Take' Linq to this?</p>\n"},{"tags":["c#","clickonce"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13267784,"title":"Local installed location of the clickonce application","body":"<p>I need to know where the clickonce application got installed. Is there a way to find this through C#?</p>\n"},{"tags":["c#","asp.net-mvc-3","unit-testing","moq","mspec"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":791,"score":3,"question_id":7596426,"title":"How to test HTTP status code set by an ASP.NET MVC action with MSpec","body":"<p>I have the following controller:</p>\n\n<pre><code>public sealed class SomeController : Controller\n{\n    public ActionResult PageNotFound()\n    {\n        Response.StatusCode = 404;\n\n        return View(\"404\");\n    }\n}\n</code></pre>\n\n<p>I have created an MSpec specification:</p>\n\n<pre><code>[Subject(typeof (SomeController))]\npublic class when_invalid_page_is_requested : SomeControllerSpec\n{\n    Because of = () =&gt; result = Controller.PageNotFound();\n\n    It should_set_status_code_to_404 = \n        () =&gt; Controller.Response.StatusCode.ShouldEqual(404);\n}\n\npublic abstract class SomeControllerSpec\n{\n    protected static HomeController Controller;\n\n    Establish context = () =&gt; { Controller = new SomeController(); };\n}\n</code></pre>\n\n<p>But because of how I instantiate the controller, HttpContext is null.\nWhat would be the best way to test status code set by the <code>PageNotFound</code> action?</p>\n\n<p><strong>EDIT: Posted an answer below</strong></p>\n"},{"tags":["c#","wpf","string","listbox","listboxitem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13267657,"title":"adding a ListBoxItem in a ListBox in C#?","body":"<p>I know that:</p>\n\n<pre><code>String test = \"test\";\nListBox.Items.Add(test);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>String test = \"test\";\nint index = 1;\nListBox.Items.Insert(index, String);\n</code></pre>\n\n<p>adds the String in a ListBox, but I want to insert ListBoxItem, how to?\npreviously I learn that</p>\n\n<pre><code>var contentToString = (String)ListBoxItem.Content;\n</code></pre>\n\n<p>simply converts ListBoxItem to String, but I couldn't do the opposite to convert String to ListBoxItem</p>\n"},{"tags":["c#","linq-to-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13268016,"title":"Linq to sql: Multiple counts","body":"<p>How can I get multiple counts using linq to sql from multiple tables? For example, I have following tables:</p>\n\n<h3>Customer</h3>\n\n<pre><code>ID, Name \n1, AAA \n2, BBB \n3, CCC \n4, DDD \n</code></pre>\n\n<h3>Department</h3>\n\n<pre><code>ID,CustomerID, Name \n1,   1,        XXX \n2,   1,        YYY \n3,   1,        ZZ1 \n4,   2,        ZZ2 \n5,   2,        ZZ3 \n6,   3,        UUU \n</code></pre>\n\n<h3>Office</h3>\n\n<pre><code>ID,DeptartmentID, Name \n1,  1,           Office1 \n2,  2,           Office2 \n3,  2,           Office3 \n4,  2,           Office4 \n5,  3,           Office5 \n6,  6,           Office6 \n\n\n\npublic class RecordCounts\n{\n   public int DepartmentCounts {get; set;}\n   public int OfficeCounts {get; set;}\n}\n</code></pre>\n\n<p>Can someone help me how to get counts for departments and levels where Customer.ID=something?</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":11795,"score":17,"question_id":388937,"title":"Determine Label Size based upon amount of text and font size in Winforms/C#","body":"<p>I'd like to know if there's a better approach to this problem. I want to resize a label (vertically) to accomodate certain amount of text. My label has a fixed width (about 60 chars wide before it must wrap), about 495 pixels. The font is also a fixed size (12points afaik), but the text is not. </p>\n\n<p>What I want to do is increase the Label Height when there's a \"NewLine\" or the text must wrap; the idea is that the text is fully visible in the label. The AutoSize doesn't work because it will grow in width, not in height. </p>\n\n<p>Of course I could count the number of NewLines and add:  Newlines * LineHeight, and then -given that I manage to put 60 chars per line, just divide the number of chars and add as many LineHeight pixels as needed.</p>\n\n<p>I was wondering if there was a more professional way to do it. Is my approach too \"lame\" ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","datagridview","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13267890,"title":"Update SQL Server CE table from SqlCeDataAdapter","body":"<p>I select data from SQL Server CE table and I want to store changed data (new rows, editings and deleting) back to SDF file:</p>\n\n<pre><code>public partial class MainForm : Form\n    {\n        private string connStr = \"DataSource = Database.sdf\";\n        private SqlCeConnection conn;\n        private SqlCeDataAdapter adapter;\n        private DataSet dataSet;\n\n        public MainForm()\n        {\n            InitializeComponent();\n            conn = new SqlCeConnection(connStr);\n            conn.Open();\n            if (conn.State == ConnectionState.Open)\n                DBStatusText.Text = \"Соединено с \" + conn.Database +\" (SQL Server CE \" + conn.ServerVersion + \")\";\n            SqlCeCommand comm = conn.CreateCommand();\n            comm.CommandText = \"SELECT TeamNum, TeamName FROM [Teams]\";\n            adapter = new SqlCeDataAdapter();\n            dataSet = new DataSet();\n            adapter.SelectCommand = comm;\n            adapter.Fill(dataSet);\n            dataGridView1.DataSource = dataSet.Tables[0];\n        }\n\n        ~MainForm()\n        {\n            adapter.Update(dataSet);\n            conn.Close();\n            conn.Dispose();\n            conn = null;\n        }\n    }\n</code></pre>\n\n<p>But I'm failed with this. Path to SDF file is correct. What I do wrong? Thanks.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":11580128,"title":"How to convert SID to String in .net","body":"<p>I would like to convert the SID's System.Byte[] type to a String.</p>\n\n<p>My code:</p>\n\n<pre><code>string path = \"LDAP://DC=abc,DC=contoso,DC=com\";\nDirectoryEntry entry = new DirectoryEntry(path);\nDirectorySearcher mySearcher = new DirectorySearcher(entry);\n\nmySearcher.Filter = \"(&amp;(objectClass=user)(samaccountname=user1))\";\nresults = mySearcher.FindAll();\nforeach (SearchResult searchResult in results)\n{\n    Console.WriteLine(searchResult.Properties[\"ObjectSID\"][0].ToString());\n}\n</code></pre>\n\n<p>I tried with this but it gets the values from the domain I'm currently logged in, and i need from a given domain.</p>\n\n<pre><code>System.Security.Principal.NTAccount(user1)\n    .Translate([System.Security.Principal.SecurityIdentifier]).value\n</code></pre>\n"},{"tags":["c#","asp.net","application","webforms","application-state"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13261114,"title":"The application variable in ASP.net(c#).","body":"<p>I have a problem with the application state in Asp.net. I need a list of Strings that i would use in different forms in the same application. Here I add the list:    </p>\n\n<pre><code>Application.Add(\"users\", new List&lt;String&gt;());\n</code></pre>\n\n<p>In a new form I try to add a string to the list, but I get NullReferenceException in the second line of the code below.</p>\n\n<pre><code> List&lt;String&gt; ls=(List&lt;String&gt;) Application.Get(\"users\");\n            ls.Add(TextBox4.Text);\n</code></pre>\n"},{"tags":["c#","java","web-applications","project"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":53,"score":-2,"question_id":13267853,"title":"Need Final Year project idea?","body":"<p>I'm searching project idea for my final year project does any one have good idea??</p>\n\n<p>I have idea to build IDE(like eclipse) for mobile is it good for my project. i have no idea about how to do it or how to implement. can anybody help me.. \n  I'm good with java ,C# and web developing.</p>\n\n<p>Thanks in advanced. :)</p>\n"},{"tags":["c#","asp.net","wkhtmltopdf","html-to-pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13267838,"title":"Pechkin HTML to PDF that includes a link to a PNG from an SSL URL","body":"<p>I'm trying to convert an HTML string to PDF using Pechkin Synchronised (WkHtmlToPDF). Everything works perfectly apart from one (deal breaking) part. </p>\n\n<p>As part of the HTML string I have an Image tag that references a dynamically generated PNG file over SSL (See below for code). It simply appears as a blank box in the output pdf. </p>\n\n<p>I've checked the docs and turned on every option I can think of and have seen references to WkHtmlToPDF being able to support PNG format and pull data from SSL'd sources. </p>\n\n<pre><code>byte[] pdf = new Pechkin.Synchronized.SynchronizedPechkin(\nnew Pechkin.GlobalConfig()).Convert(\n    new Pechkin.ObjectConfig()\n   .SetLoadImages(true)\n   .SetPrintBackground(true)\n   .SetScreenMediaType(true)\n   .SetCreateExternalLinks(true), html);\n\nusing (FileStream file = System.IO.File.Create(@\"C:\\TEMP\\Output.pdf\"))\n{\n    file.Write(pdf, 0, pdf.Length);\n}\n</code></pre>\n\n<p>Relevant HTML that references the \"missing\" image</p>\n\n<pre><code>&lt;img width=\"385\" src=\"https://www.somehost.com/path/endpoint?type=somedata&amp;amp;height=140&amp;amp;width=2&amp;amp;data=000000000000000000\"&gt;\n</code></pre>\n\n<p>Also tried converting the &amp;'s to just &amp;'s to see if that helps like so but sadly it didnt:</p>\n\n<pre><code>&lt;img width=\"385\" src=\"https://www.somehost.com/path/endpoint?type=somedata&amp;height=140&amp;width=2&amp;data=000000000000000000\"&gt;\n</code></pre>\n\n<p>When I hit the link directly through the browser and inspect fiddler reports Content Length 1136, Content Type as image/png and the headers also mention WebSphere and Servlets</p>\n"},{"tags":["c#","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13267747,"title":"HTML.TextBoxFor disabled not passing value","body":"<p>I have the following bit in my view :</p>\n\n<pre><code>@Html.TextBoxFor(model =&gt; model.PersonnelId, new { disabled = \"disabled\" })\n</code></pre>\n\n<p>In my controller I have this :</p>\n\n<pre><code>if (ModelState.IsValid)\n{\n    PersonnelFacade.SavePerson(person);\n    return RedirectToAction(\"Index\");\n}\n</code></pre>\n\n<p>Now when I check the person.PersonnelId it is empty.\nWhen I remove the {disabled = \"disabled\" } it works fine but then I can change the PersonnelId which is not what I want to do.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["c#","list","generics"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13266579,"title":"How to remove items from a generic list after N minutes?","body":"<p>I have a list as below:</p>\n\n<pre><code>private List&lt;DateTime&gt; _result = new List&lt;DateTime();\n</code></pre>\n\n<p>and I add values to it like</p>\n\n<pre><code>_result.Add(DateTime.Now);\n</code></pre>\n\n<p>The requirement is that each item which is added should be removed from the list within 5 minutes deadline.</p>\n\n<p>I was thinking I could create a Timer which checks my list every e.g. 1 minute and find old items and remove them but I hoped there could be an easier way?</p>\n\n<p>How to implement it?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","int","string.format"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13267055,"title":"How can I convert formatted string to int (if I know format) in C#?","body":"<p>I have formatted string, for example <code>123 456 000$</code> and I know format of this string <code>{0:### ### ##0}$</code>. I'd like to get <code>int value = 123456000;</code> from this string in C# with using known format.</p>\n\n<p>How I can do that? </p>\n"},{"tags":["c#","itextsharp"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":9896,"score":9,"question_id":2370427,"title":"itextsharp set a document horizontal page a4","body":"<p>how can i set a document in a4 horizontal format in itextsharp?</p>\n\n<p>thanks</p>\n"},{"tags":["c#","pdf","axacropdf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13267708,"title":"The highlight controls of axAcroPDF are disabled","body":"<p>I am try to use axAcroPDF COM to display PDF file on my form , select text and highlight them.\nThe PDF page can be rendered correctly. And I have noticed there are some buttons stay at right of the form , but they are all gray ,so I can not click these buttons to make the selected content highlight.</p>\n\n<p>I have tested , to load the same PDF file with Adobe Reader, I can use all the function normally.\nI also tryed to use setCurrentHighLight() but is not work.</p>\n\n<p>Please help me to solve this problem , Thanks a lot.</p>\n"},{"tags":["c#","winforms","listbox"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":531,"score":1,"question_id":7672776,"title":"C#, winform - List box selection using up and down arrow key?","body":"<p>I have list box, I am able to select the entries (Single select mode - one at a time) using keyboard and mouse, but when i use up and down arrow keys, its not selecting the list. But able to scroll the list with an underline below each entity the arrow key is related. Thanks </p>\n"},{"tags":["c#","syntax","extension-methods"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":102,"score":4,"question_id":13267572,"title":"Is there a reason why extension methods can't be invoked directly on \"this\"?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3906170/why-can-you-not-invoke-extension-methods-directly\">Why can you not invoke extension methods directly?</a>  </p>\n</blockquote>\n\n\n\n<p>Lets assume the following code:</p>\n\n<pre><code> public static class MyExtensions\n{\n    public static void SayHello(this Foo self)\n    {}\n}\n\npublic class Foo\n{\n    this.SayHello(); //this works\n    SayHello(); //this does not compile\n}\n</code></pre>\n\n<p>I'm just interested in the reasoning behind this, why can't extension methods be invoked on an implicit <code>this</code> ?</p>\n\n<p><code>this.SayHello()</code> and <code>SayHello</code> means the same thing when applied to instance methods.\nSo why use different behavior when calling extension methods?</p>\n"},{"tags":["c#",".net","multithreading","timer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":64,"score":-2,"question_id":13153245,"title":"How to excecute method after a delay in threading .timer?","body":"<p>I have a class that created a <strong>threading .timer</strong>.</p>\n\n<pre><code>  System.Threading.Timer timer;\n  TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n    timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n}\n\nprivate void ProcessTimerEvent(object obj)\n{\n    if (Tick != null)\n        Tick(this, EventArgs.Empty);\n}\n</code></pre>\n\n<p>I want dispose Timer inside of this and then timer work.</p>\n\n<p>in my TickEvent i excecute a method but don't complate this.</p>\n\n<pre><code> void MyTimer_Tick(object sender, EventArgs e)\n{\n if(value)\n   MyFunction();\n}\n</code></pre>\n\n<p>Timer must be taken to stop until MyFunction complete.</p>\n"},{"tags":["c#",".net","date","strtotime"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":43,"score":-1,"question_id":13267618,"title":"strtotime for C# (.NET)","body":"<p>Do you know of a strtotime equivalent in C#(.NET) even for other languages than English (i.e. Slovak version of 25th January is 25 Január).</p>\n"},{"tags":["c#","asp.net","mobile","sms"],"answer_count":17,"favorite_count":10,"up_vote_count":19,"down_vote_count":1,"view_count":4404,"score":18,"question_id":548911,"title":"Sending SMS","body":"<p>I want to send SMS from my Web application in C#. </p>\n\n<p>Can anyone guide me as to how this can be done ?</p>\n"},{"tags":["c#","asp.net","error-handling","unhandled-exception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13229914,"title":"Exception without YSOD","body":"<p>So I set up my Global.asax file to email me when an unhanded exception occurred. I get an email with exceptions that don't appear to the user, and the code appears to be working just fine at the client end and the page loads and does what is expected.</p>\n\n<p>I have this code in the aspx file, which shows a checkbox based on a role or a customer number started with specific characters...</p>\n\n<pre><code>&lt;%  if (Roles.IsUserInRole(\"Admin\") ||\n                   txtAccountNo.Text.Substring(0, 2) == \"UK\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"FR\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"IT\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"DK\" ||\n                   txtAccountNo.Text.Substring(0, 2) == \"SE\")\n               { %&gt;\n            &lt;label for=\"chkExpressDelivery\"&gt;&lt;asp:Literal ID=\"Literal14\" runat=\"server\" Text=\"&lt;%$ Resources:LocalizedText, fieldLabel_ExpressDelivery %&gt;\"&gt;&lt;/asp:Literal&gt;&lt;span class=\"small\"&gt;&lt;/span&gt;&lt;/label&gt;\n            &lt;asp:CheckBox ID=\"chkExpressDelivery\" runat=\"server\" Width=\"50px\" CssClass=\"_checkbox _normalcheckbox\" Text=\"&amp;nbsp;\" /&gt;\n            &lt;%} %&gt;\n</code></pre>\n\n<p>now txtAccountNo is populated from a user profile property in the Page_Load event in the aspx.cs file.</p>\n\n<p>the error message i receive in the email (which the client never sees) is </p>\n\n<blockquote>\n  <p>Index and length must refer to a location within the string. Parameter name: length</p>\n</blockquote>\n\n<p>I understand the error message - that it's saying the txtAccountNo.Text is basically empty when that code runs, but what i dont understand is, the client never sees this error and the page behaves as i want it to.</p>\n\n<p>BUT, if i turn on custom error messages in the web.config file, the client is directed to the custom error page, but without it, no error as far as the client is concerned. </p>\n\n<p>So how can i correct this error so i can turn on my custom error pages?</p>\n\n<p>I hope this makes sense! Let me know if you need any more info.</p>\n\n<p>Thanks</p>\n\n<p>Stuart</p>\n\n<p>this code now works...</p>\n\n<pre><code>&lt;%  if (txtAccountNo.Text.Length &gt; 0 &amp;&amp; (Roles.IsUserInRole(\"Admin\") ||\n               txtAccountNo.Text.Substring(0, 2) == \"UK\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"FR\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"IT\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"DK\" ||\n               txtAccountNo.Text.Substring(0, 2) == \"SE\"))\n           { %&gt;\n        &lt;label for=\"chkExpressDelivery\"&gt;&lt;asp:Literal ID=\"Literal14\" runat=\"server\" Text=\"&lt;%$ Resources:LocalizedText, fieldLabel_ExpressDelivery %&gt;\"&gt;&lt;/asp:Literal&gt;&lt;span class=\"small\"&gt;&lt;/span&gt;&lt;/label&gt;\n        &lt;asp:CheckBox ID=\"chkExpressDelivery\" runat=\"server\" Width=\"50px\" CssClass=\"_checkbox _normalcheckbox\" Text=\"&amp;nbsp;\" /&gt;\n        &lt;%} %&gt;\n</code></pre>\n"},{"tags":["c#","asp.net","sms"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":7544,"score":2,"question_id":793323,"title":"Looking for a free SMS gateway that works with C#","body":"<p>I have developed a Website in ASP.NET 2.0 I want to send an SMS to every person who  registers to my site. I want to do it in C# code, is there any service[webservice] which I can use and send free SMS to any mobile.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13266681,"title":"Is it possible to return IQueryable<SomeClass> to a IQueryable<T> method?","body":"<p>In QueryableEntities method below,\n<code>IEnumerable&lt;Competition&gt;.AsQueryable()</code> will return <code>IQueryable&lt;Competition&gt;</code> which am not able to return because it is expecting <code>IQueryable&lt;T&gt;</code></p>\n\n<p>I can write only one method to return <code>IQueryable&lt;Competition&gt;</code> and <code>IQueryable&lt;Submission&gt;</code> </p>\n\n<p>If anyone knows how to do it please let me know, thanks</p>\n\n<pre><code>public partial class WinBoutsDataContext&lt;T&gt; : System.Data.Linq.DataContext where T : class\n{\n    public IQueryable&lt;T&gt; QueryableEntities\n    {\n        get\n        {\n            if (typeof(T).Equals(typeof(Model.Competition)))\n            {\n                return this.ConvertToCompetitionList(\n                      this.GetTable&lt;Storage.Competition&gt;()).AsQueryable();\n            }\n             else if(typeof(T).Equals(typeof(Model.Submission)))\n            {\n                return this.ConvertToSubmissionList(\n                       this.GetTable&lt;Storage.CompetitionEntry&gt;()).AsQueryable();\n            }\n        }\n    }\n\n    public DataAccess.Model.Competition ConvertToCompetition(DataAccess.Storage.Competition comp)\n    {\n\n        DataAccess.Model.Competition modelComp = new DataAccess.Model.Competition \n        { \n            CompetitionID = comp.CompetitionID, \n            Active = comp.Active, \n            CompetitionStatusID = \n            comp.CompetitionStatusID, \n            Duration = comp.Duration, \n            EndDate = comp.EndDate, \n            Entrants = comp.Entrants, \n            Featured = comp.Featured, \n            Image = comp.Image, \n            IsOvertime = comp.IsOvertime, \n            MaxEntrants = comp.MaxEntrants, \n            Notes = comp.Notes, \n            OvertimeDuration = comp.OvertimeDuration, \n            OvertimeEnd = comp.OvertimeEnd, \n            OvertimeStart = comp.OvertimeStart, \n            ParentCompetitionID = comp.ParentCompetitionID, \n            Prize = comp.Prize, StartDate = comp.StartDate, \n            SuggestedBy = comp.SuggestedBy, \n            Summary = comp.Summary, \n            Title = comp.Title \n        };\n\n        return modelComp;\n    }\n\n    public IEnumerable&lt;DataAccess.Model.Competition&gt; ConvertToCompetitionList(IEnumerable&lt;DataAccess.Storage.Competition&gt; compList)\n    {\n        List&lt;DataAccess.Model.Competition&gt; compModelList = new List&lt;DataAccess.Model.Competition&gt;();\n\n        foreach (DataAccess.Storage.Competition comp in compList)\n        {\n            compModelList.Add(ConvertToCompetition(comp));\n        }\n\n        return compModelList;\n    }\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":212,"score":0,"question_id":3980341,"title":"Validate and sort a variety of serial numbers with different formats?","body":"<p>I am faced with the following issue.  I need to capture a range of serial numbers in c# to be stored in a database.  If these serial numbers are just numbers, it is fine, but I have ran into serial numbers which are alpha-numeric such as:</p>\n\n<p>56AAA71064D6 and 56AAA7105A25</p>\n\n<p>How can I accommodate the different possibilities that serial number ranges may be in?</p>\n\n<p>Assuming that all serial numbers have some order, how can I parse the sequential part of it?</p>\n\n<p>The database takes the serial numbers as strings already.</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13266624,"title":"How to retrieve a control's container when clicked","body":"<p>I've got a <code>TreeView</code> which contains a number of <code>TreeViewItems</code>.  Each <code>TreeViewItem</code> contains a horizontally-oriented <code>StackPanel</code> which in turn contains an image and a label.</p>\n\n<p>When the user clicks on the TreeViewItem, I would like to get a reference for that <code>TreeViewItem</code>.  Instead, the source is returning as either label or image, depending on which part of the <code>TreeViewItem</code> the user clicks on.</p>\n\n<p>I cannot use the selectedItemChanged event, as this is strictly an operation which must occur every time a TreeViewItem is clicked.</p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;TreeView DockPanel.Dock=\"Left\" \n          Name=\"tvSchema\" \n          AllowDrop=\"True\"\n          TreeViewItem.PreviewMouseLeftButtonDown=\"tvSchema_PreviewMouseLeftButtonDown\"&gt;\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>And here is the code which attempts to retrieve the selected TreeViewItem when the user clicks on one:</p>\n\n<pre><code>private void tvSchema_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n{\n     object x = e.OriginalSource; //Returns TextBlock\n     object y = e.Source; //Returns Label\n     object z = sender; //Returns TreeView\n}\n</code></pre>\n\n<p>What can be done to get the actual TreeViewItem?</p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":1464,"score":1,"question_id":7855948,"title":"How to call a class in the App_Code folder from code behind?","body":"<p>I created a class in ASP.NET C# which is located in the App_Code folder. Now I want to call this class from my code behind from one of my .aspx pages. How can I do this?</p>\n\n<p>Any help will be appreciate it.</p>\n"},{"tags":["c#","windows-8","xmpp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13267456,"title":"Is there any free XMPP library which Supports WinRT?","body":"<p>Could anyone say me the XMPP library that supports WinRT, I've tried Jabber-Net, agsXMPP, those are not working. . .</p>\n"},{"tags":["c#","jquery","asp.net-mvc","form-validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13267455,"title":"Retaining form state for elements introduced by jQuery","body":"<p>I have a view which has a table with one editable row. A new editable row can be added using jQuery by clicking an image.</p>\n\n<pre><code>&lt;table width=\"100%\" class=\"rateTable\" id=\"rateTbl\"&gt;\n    &lt;tr&gt;\n        &lt;th&gt;\n            Low Range\n        &lt;/th&gt;\n        &lt;th&gt;\n            High Range\n        &lt;/th&gt;\n        &lt;th&gt;\n            Rate\n        &lt;/th&gt;            \n        &lt;th&gt;\n        &lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"LowRange0\")\n        &lt;/td&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"HighRange0\")\n        &lt;/td&gt;\n        &lt;td&gt;\n            @Html.TextBox(\"Rate0\")\n        &lt;/td&gt;\n        &lt;td&gt;                \n            &lt;input type=\"image\" alt=\"new band\" src=@Url.Content(\"~/Content/images/add.gif\") id=\"addBand\" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Following is the jQuery script which adds a new row.</p>\n\n<pre><code>$(\"#addBand\").click(function () {        \n    AddRow(highRange);        \n});\n\nvar AddRow = function (highRange) {\n    var tr = $(\"#rateTbl tr:last\").clone(true, true);\n\n    $(tr).find(\"input, select\")\n    .attr(\"name\", function () {\n        var parts = this.id.match(/(\\D+)(\\d+)$/);\n        if (parts != null) {\n            return parts[1] + ++parts[2];\n        }\n    })\n    .attr(\"id\", function () {\n        var parts = this.id.match(/(\\D+)(\\d+)$/);\n        if (parts != null) {\n            return parts[1] + ++parts[2];\n        }\n    });\n\n    $(\"#rateTbl tr:last\").after(tr);\n}\n</code></pre>\n\n<p>The trouble is upon form submit and subsequent validation failure, the form state does not retain the newly added row thereby losing the input values. I need to make sure that the new row added using jQuery be retained in case of validation failure.</p>\n"},{"tags":["c#","active-directory","sid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13267425,"title":"How do i get the SID-History value using c# from active directory","body":"<p>I have a problem i've been struggling with.\nI am trying to get the sidhistory property from an AD searchresult.\nIs there anyone that can shed some light, or point me in the right direction on how to get the sidhistory property value?</p>\n\n<p>This is an example of what i do ....i iterate through the properties, but there is not sidhistory property when i debug the code.</p>\n\n<pre><code>using (DirectoryEntry directoryEntryUser = new DirectoryEntry(searchResult.Path))\n{\n    foreach (string propertyName in directoryEntryUser.Properties.PropertyNames)\n    {\n            PropertyValueCollection propertyValues = \n            directoryEntryUser.Properties[propertyName];\n            // And the rest of the code goes here\n            // to get the values.\n            // Sid-History or any variation never displays here \n            // as a property name\n            // however objectsid does display\n    }\n}\n</code></pre>\n"},{"tags":["c#","regex"],"answer_count":7,"favorite_count":21,"up_vote_count":41,"down_vote_count":0,"view_count":89681,"score":41,"question_id":273141,"title":"Regex for numbers only","body":"<p>I haven't used regular expressions at all, so I'm having difficulty troubleshooting. I want the regex to match only when the contained string is all numbers; but with the two examples below it is matching a string that contains all numbers plus an equals sign like \"1234=4321\". I'm sure there's a way to change this behavior, but as I said, I've never really done much with regular expressions.</p>\n\n<pre><code>        string compare = \"1234=4321\";\n        Regex regex = new Regex(@\"[\\d]\");\n\n        if (regex.IsMatch(compare))\n        { \n            //true\n        }\n\n        regex = new Regex(\"[0-9]\");\n\n        if (regex.IsMatch(compare))\n        { \n            //true\n        }\n</code></pre>\n\n<p>In case it matters, I'm using C# and .NET2.0.</p>\n"},{"tags":["c#","asp.net","events","gridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13267301,"title":"allow only one checkbox to be checked - asp.net c#","body":"<p>I have a gridview where i have added checkboxes programmatically.\ni do as following when creating checkboxes inside a foreach loop, so that they trigger an event when checked,</p>\n\n<pre><code>            cbGV = new CheckBox();\n            cbGV.ID = \"cbGV\";\n            cbGV.AutoPostBack = true;\n            cbGV.CheckedChanged += new EventHandler(this.cbGV_CheckedChanged);\n</code></pre>\n\n<p>So basically when i want the event to be triggered, i have the following below,</p>\n\n<pre><code>    protected void cbGV_CheckedChanged(object sender, EventArgs e)\n    {\n        //gets the current checked checkbox.\n        CheckBox activeCheckBox = sender as CheckBox;\n\n        foreach (GridViewRow gvr in GridView1.Rows)\n        {\n            //this code is for finding the checkboxes in the gridview.\n\n            CheckBox checkBox = ((CheckBox)gvr.FindControl(\"cbGV\"));\n\n            //so basically, right here i'm confused on how i should compare the if/else logic, how i should compare and disable every other checkbox if the current checkbox is checked. Any ideas gues?\n\n        }\n</code></pre>\n\n<p>thanks for your answer in advance.</p>\n"},{"tags":["c#","asp.net","itextsharp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13245208,"title":"How to create pdfformfields using iTextSharp?","body":"<p>I am using iTextSharp and CSharp for creating the pdf.I need to add formfields like checkbox,radiobutton and dropdown which canot be edited.</p>\n\n<p>I used this..</p>\n\n<pre><code>            FileStream pdffile = new FileStream(path + \"/Pdf/tes.pdf\",FileMode.Create);\n            PdfWriter writer = PdfWriter.GetInstance(doc, pdffile);\n            doc.Open(); \n            Rectangle rect = new Rectangle(100, 100, 100, 100);\n            RadioCheckField checkbox = new RadioCheckField(writer, rect, \"bhjabsdf\", \"on\");\n            checkbox.CheckType = RadioCheckField.TYPE_CHECK;\n            PdfFormField field = checkbox.CheckField;\n            writer.AddAnnotation(field);\n            doc.Close();\n</code></pre>\n\n<p>But it's not working.I also read about PdfStamper.But i am creating a new pdf,not changing the exsisting one.So i don't know whether i can use pdfstamper?</p>\n\n<p>Thanks..</p>\n\n<p>Edit:</p>\n\n<pre><code>private void CreateRadioButton(PdfWriter writer, PdfContentByte cb,Font font)\n    {\n        Rectangle rect;\n        PdfFormField field;\n        PdfFormField radiogroup = PdfFormField.CreateRadioButton(writer, true);\n        radiogroup.FieldName = \"language\";\n        RadioCheckField radio;\n        int x = 20;\n        for (int i = 0; i &lt; Petrol.Length; i++)\n        {\n            rect = new Rectangle(440 + i * x, 692, 450 + i * x, 682);\n            radio = new RadioCheckField(writer, rect, null, LANGUAGES[i]);\n            radio.BorderColor = GrayColor.GRAYBLACK;\n            radio.BackgroundColor = BaseColor.WHITE;\n            radio.CheckType = RadioCheckField.TYPE_CIRCLE; \n\n            if (Petrol[i] == \"F\")\n                radio.Checked = true;\n            field = radio.RadioField;\n</code></pre>\n\n<p>//Here i am setting readonly..</p>\n\n<pre><code>            field.SetFieldFlags(PdfFormField.FF_READ_ONLY);\n            radiogroup.AddKid(field);                \n            ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT,\n              new Phrase(Petrol[i], font), 451 + i * x, 684, 0);\n            if (i &gt;= 1) x = 25;\n        }\n        writer.AddAnnotation(radiogroup);\n    }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13267087,"title":"How to join and select table data in mvc C#?","body":"<p>In my project I have services.\nSo in side the service I want to join tables and want to select more than one table data.</p>\n\n<p>So I write this cording.</p>\n\n<pre><code>var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join g in _graduandRepository.Table on opv.graduand_id equals g.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                         select opv,g;\n</code></pre>\n\n<p>But there is error and I can't select <code>opv and g.</code> if I write   <code>select opv;</code>it is ok. but i want to select both table.\nHow can i do it??</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":978,"score":-2,"question_id":2606206,"title":"Sending SMS using free gateway","body":"<p>I just wanted to develop one web application which allows users to send an SMS to any mobile free of charge . I searched on the net and found many codes and articles and through those articles i came to know that for that kind of application, i required either of the\nfollowing things:</p>\n\n<ol>\n<li>Web service (Third party web services that are free but not working or not delivering the sms)</li>\n<li>GSM Modem ( I don't have any idea about this)</li>\n<li>SMS Gateway ( I don't have any idea about plz suggest me a idea</li>\n</ol>\n"},{"tags":["c#","asp.net-mvc","appfabric"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13260517,"title":"Caching MVC views in AppFabric manually","body":"<p>I am trying to recreate most of the functionality of the OutputCache action filter in MVC 4 by caching view result objects myself. The reason I don't want to use the OutputCache action filter is because I can't use it with AppFabric and partial views; partial views are always stored in MemoryCache and I want the cached objects to be used across a server farm.</p>\n\n<p>The first problem I have is </p>\n\n<pre><code>{\"Type 'System.Web.Mvc.TempDataDictionary' cannot be serialized. \nConsider marking it with the DataContractAttribute attribute, and marking all of \nits members you want serialized with the DataMemberAttribute attribute.  \nIf the type is a collection, consider marking it with the \nCollectionDataContractAttribute.  See the Microsoft .NET Framework documentation for  \nother supported types.\"}\n</code></pre>\n\n<p>This makes me wonder if I should cache something else to return what is essentially the view at the end. Does anyone have an idea of what I should cache instead to recreate the view or a different approach for caching partial views over a server farm? I do not want to use third party plugins for this.</p>\n\n<p>Thanks</p>\n\n<p>Update: I started caching the string representation of the partial view like so:</p>\n\n<pre><code>using (StringWriter sw = new StringWriter())\n        {\n            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(ControllerContext, \"ViewName\");\n            ViewContext viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);\n            viewResult.View.Render(viewContext, sw);\n            view = sw.GetStringBuilder().ToString();\n        }\n</code></pre>\n\n<p>This has made it easy to just retrieve the string in cache and return it as content in the action. I'm still looking for other suggestions or a better way to do this.</p>\n"},{"tags":["c#","asp.net-mvc","entity-framework","automapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13266570,"title":"Automapper - Returning right value but not mapping","body":"<p>In my MVC webapplication I got the following automapper code:</p>\n\n<p><strong>The configure:</strong></p>\n\n<pre><code> public static void Configure()\n        {\n            Mapper.CreateMap&lt;string, List&lt;Ruimte&gt;&gt;().ConvertUsing&lt;StringCombinatieRuimtesConverter&gt;();\n        }\n</code></pre>\n\n<p><strong>The custom converter:</strong></p>\n\n<pre><code>public class StringCombinatieRuimtesConverter : ITypeConverter&lt;string, List&lt;Ruimte&gt;&gt;\n    {\n        #region Implementation of ITypeConverter&lt;in string,out List&lt;Ruimte&gt;&gt;\n\n        public List&lt;Ruimte&gt; Convert(ResolutionContext context)\n        {\n            if (context.SourceValue == null)\n            {\n                return new List&lt;Ruimte&gt;();\n            }\n\n            return context.SourceValue.ToString().Split(',').Select(r =&gt; new Ruimte { Id = int.Parse(r) }).ToList();\n        }\n\n        #endregion\n    }\n</code></pre>\n\n<p><strong>And I call it with the following code:</strong></p>\n\n<pre><code>            var ruimteList = new List&lt;Ruimte&gt;();\n\n            // Update the CombinatieVan\n            Mapper.Map(command.CombinatieRuimteVan, ruimteList);\n</code></pre>\n\n<p>If I debug the command.CombinatieRuimteVan is: 2,3,4,6. This is fine.\nNow if I debug the converter it does return 4 objects of the class \"Ruimte\" with as Id the numbers stated before. But after the Mapper.Map method is done the \"ruimteList\" is still an empty list.</p>\n\n<p>Does anyone know what is going wrong here? The automapper works fine on another spot in my application where I automap a whole entity containing the \"CombinatieRuimteVan\" set. But when I sololy convert the string to the list it doesn't seem to work.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13266916,"title":"How to pause a Threading.timer to complete a function","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/684200/synchronizing-a-timer-to-prevent-overlap\">Synchronizing a timer to prevent overlap</a>  </p>\n</blockquote>\n\n\n\n<p>I have a <code>Threading.Timer</code> in my class.</p>\n\n<pre><code> System.Threading.Timer timer;\n TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n</code></pre>\n\n<p>and defined a callback for it.</p>\n\n<pre><code>private void ProcessTimerEvent(object obj)\n{\n  if(value)\n    MyFunction();\n}\n</code></pre>\n\n<p>When run it, re-running callback before <code>myfunction</code> to complete.</p>\n\n<p>How to pause <code>Threading.Timer</code> to complete <code>myfunction</code>?</p>\n"},{"tags":["c#","asp.net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2173,"score":3,"question_id":2465681,"title":"How to encode a DateTime in a QueryString and read it in the asp:QueryStringParameter","body":"<p>How to encode a <code>DateTime</code> in a <code>QueryString</code> and read it in the <code>asp:QueryStringParameter</code>?</p>\n\n<p>out: \n(it's a <code>asp:HyperLink NavigateUrl</code>)</p>\n\n<pre><code>String.Format(\"~/Reports/Logs/Option_History.aspx?OptionID={0}&amp;time={1}\", _\n              id, _\n              time)\n</code></pre>\n\n<p>in:</p>\n\n<pre><code>&lt;asp:QueryStringParameter Name=\"time\" \n                          QueryStringField=\"Time\" \n                          Type=\"DateTime\" \n                          ConvertEmptyStringToNull=\"true\" /&gt;\n</code></pre>\n"},{"tags":["c#","windows-8","winrt-xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13266995,"title":"Random Color Generation in particular range","body":"<p>I need to generate a random color for each item in my <code>gridview</code>. My requirement is that I must generate these colors between, for example, one shade of blue and another shade of blue. i.e. all colors must be within that range. I have a start color and an end color and I have a random object to generate bytes. How do I ensure that the colors generated stay within the given range? I need to write this in <code>C#</code> for <code>Windows 8</code>. The only color generation option it shows me in <code>Windows.UI.Color</code> is the <code>FromArgb</code> method. Any ideas on how I could achieve that?</p>\n"},{"tags":["c#",".net","xml","comments"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2971,"score":5,"question_id":2875674,"title":"How to ignore comments when reading a XML file into a XmlDocument?","body":"<blockquote>\n  <p>Possible duplicate: <a href=\"http://stackoverflow.com/questions/1874132/how-to-remove-all-comment-tags-from-xmldocument\">How to remove all comment tags from XmlDocument</a></p>\n</blockquote>\n\n<p>Hello, I am trying to read a XML document with C#, I am doing it this way:</p>\n\n<pre><code>XmlDocument myData = new XmlDocument();\nmyData.Load(\"datafile.xml\");\n</code></pre>\n\n<p>anyway, I sometimes get comments when reading XmlNode.ChildNodes.</p>\n\n<p>For the benefit of who's experiencing the same requirement, here's how I did it at the end:</p>\n\n<pre><code>/** Validate a file, return a XmlDocument, exclude comments */\nprivate XmlDocument LoadAndValidate( String fileName )\n{\n    // Create XML reader settings\n    XmlReaderSettings settings = new XmlReaderSettings();\n    settings.IgnoreComments = true;                         // Exclude comments\n    settings.ProhibitDtd = false;                           \n    settings.ValidationType = ValidationType.DTD;           // Validation\n\n    // Create reader based on settings\n    XmlReader reader = XmlReader.Create(fileName, settings);\n\n    try {\n        // Will throw exception if document is invalid\n        XmlDocument document = new XmlDocument();\n        document.Load(reader);\n        return document;\n    } catch (XmlSchemaException) {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Thank you<br />\nTommaso</p>\n"},{"tags":["c#","sms","sms-gateway"],"answer_count":2,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":1252,"score":5,"question_id":3524742,"title":"SMS Gateway for Windows + C#","body":"<p>I am a little confused with SMS and how to send them. I been searching around and I see you can purchase sms texts. I seen some where you get 10k text msgs for $490 but I find this very expensive and I am wonder if there is a better way that would be well free.</p>\n\n<p>I know many sites use have SMS reminders such as google calendar. I am sure google hosts there own server or something. </p>\n\n<p>I also know of alot smaller sites that charge $3/month for their service and one of the features in their service is to send you sms alerts. I highly doubt that they are paying 4cents at text and allow unlimited reminders.</p>\n\n<p>So is there a gateway that I can host myself that is free? Preferably something that works on windows machines.</p>\n\n<p>Or do these sites use like email to sms or something like that and thats how they get it for free?</p>\n\n<p>I am trying to figure out how to make it free on my end to send. I find it kinda stupid that services have to pay to send these messages. I would have figured it would be like email where you can send them for free.</p>\n\n<p>I understand the person receiving the SMS message might have to pay but that depends on their cell phone plan.</p>\n"},{"tags":["c#","winforms","autocomplete"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":229,"score":3,"question_id":12972761,"title":"textbox auto complete (Multi Line)","body":"<p>I am making a auto suggestion / complete textbox in C#, i followed below link, but text box isnt showing the suggestions</p>\n\n<p><a href=\"http://stackoverflow.com/questions/5648476/how-to-create-autosuggest-textbox-in-windows-forms\">How to create autosuggest textbox in windows forms?</a></p>\n\n<pre><code>//-------- Get all distinct description -----------------------------\nOleDbCommand command = new OleDbCommand(Queries.qry16, Connection);\nOleDbDataReader reader = command.ExecuteReader();\n\n//--------- Storing ------------------------------------\nwhile (reader.Read())\n{\n    namesCollection.Add(reader.GetValue(0).ToString());\n}\n\n//----------- Close after use ---------------------------------------\nreader.Close();\n\n//----------- Set the auto suggestion in description box ------------\ndescriptionBox.AutoCompleteMode = AutoCompleteMode.Suggest;\ndescriptionBox.AutoCompleteSource = AutoCompleteSource.CustomSource;\ndescriptionBox.AutoCompleteCustomSource = namesCollection;\n</code></pre>\n\n<p>Here is my code , it is in load function of winform. And the nameCollection initializtion is in constructor... kindly please help to make it working.</p>\n\n<p>I am editing my post rather then creating new... I have tried the my own code in single line textbox and it worked. Now i want the same in multi line... For research i googled more then 2 days trying different codes (one with intelli sense) but it didnt worked as auto suggestion available in textbox. Can any one give me suggestion to code the whole procedure to multi line.. Thank you.</p>\n"},{"tags":["c#",".net","pre-buildevent","app-globalresources"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13267077,"title":"Copy resx files to App_GlobalResources","body":"<p>I have two projects, first is MyPackag.Language project that holds all my resx files and some supporting classes. My other project is a web project that holds a Reference to MyPackage.Language project. When I build my web project I use the following Pre-Build event on my MyPackage.Language project:</p>\n\n<pre><code>mkdir \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\" \ncopy \"$(ProjectDir)Resources\\*.resx\" \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\"\n</code></pre>\n\n<p>All the resx files are copied into the App_GlobalResources folder in the web.\nMy problem: The web project cant find the resources files using:</p>\n\n<pre><code>&lt;asp:Label runat=\"server\" Text=\"&lt;%$ Resources: MyResourceFile, KeyName%&gt;\"&gt;&lt;/asp:Label&gt;\n</code></pre>\n\n<p>All the files are copied correctly and if i manuelly copy them before into VS2010 to the web project everything works as intended.</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13266841,"title":"C# LINQ to XML: number of elements, that have two same attributes?","body":"<p>I have something like this:</p>\n\n<pre><code>&lt;Books&gt;\n    &lt;Book&gt;\n        &lt;Number&gt;\n        &lt;Title&gt;\n        &lt;Author&gt;\n        &lt;NumberOfCopies&gt;\n    &lt;/Book&gt;\n&lt;/Books&gt;\n</code></pre>\n\n<p>The <code>NumberOfCopies</code> element means how many same copies the library has of the same book. (Same books=same author, same title). The <code>Number</code> element is different for each book, it is for storing them in the library.</p>\n\n<p>When I add a new book, I would like to find out how many copies the library has.(int number) How to do this?</p>\n\n<pre><code>XDocument doc = XDocument.Load(\"books.xml\");\nvar q = from x in doc.Descendants(\"Books\")\n        where x.Element(\"Author\").Value == newBook.Author\n              &amp;&amp; x.Element(\"Title\").Value == newBook.Title\n        select x;\n\nint number = (int)q;\n</code></pre>\n\n<p>This doesn't work. What am I doing wrong?</p>\n"},{"tags":["c#",".net","aop"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":221,"score":0,"question_id":4760055,"title":"Dynamically building method/property bodies","body":"<p>So I've got this boilerplate code that I want to apply to a bunch of properties of certain classes, that is essentially identical for each one. Rather than have to type this same code out again and again for all of these properties, I was wondering if there was any way I could dynamically build these property methods either post-compile or at runtime, by assigning a C# attribute to the property that includes the slight difference for each method (a string) and then finding these properties by reflection.</p>\n\n<p>I'm aware of PostSharp, but I'm looking for something free or open source.</p>\n\n<p>For example, instead of having to do this:</p>\n\n<pre><code>public string Name {\n    get { return _member.GetValue( \"othername\" ); }\n    set { _member.SetValue( \"othername\", value ); }\n}\n</code></pre>\n\n<p>...for each property I have, I just want to say this:</p>\n\n<pre><code>[MapTo( \"othername\" )]\npublic string Name { get; set; }\n</code></pre>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#","data-binding","collections"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13265892,"title":"data binding of collections","body":"<p>I just want to bind one collection to another one:\nLets say there is a </p>\n\n<pre><code>List&lt;string&gt; original = new List&lt;string&gt;();\n</code></pre>\n\n<p>and there is a</p>\n\n<pre><code>List&lt;string&gt; extended = \n           new List&lt;string&gt;(from curItem in originals select curItem + \"_extension\");\n</code></pre>\n\n<p>So the items of the extended are just the same than the original's but with an \"_extension\" at the end.</p>\n\n<p>What I want is to bind the extended to the original, so that if the original becomes changed, the extended also changes.</p>\n\n<p>I know I could use events and recreate the extended every time. \nBut I think this is not efficient.</p>\n\n<p>Edit:\nLets say: original is large and it is too exhausting to recreate the single elements of the extended and its also exhausting to create a single element at all.\nSo I want to have two lists (or collections) where on observes the other one and adds or removes the changes, like the data binding in Wpf, but adding an extension.</p>\n"},{"tags":["c#","asp.net","web-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13262804,"title":"Upload from server db and open file on client machine","body":"<p>How to organize a file downloading from server database and open it on the client machine?</p>\n\n<p>my code works only when the page is opened on the server:</p>\n\n<pre><code>        OracleCommand oracleCom = new OracleCommand();\n        oracleCom.Connection = oraConnect;\n        oracleCom.CommandText = \"Select m_content, f_extension From \" + Session[\"tableNameIns\"] +\n                                            \" where i_id = \" + rowData;\n        OracleDataAdapter adapter = new OracleDataAdapter();\n        DataTable tableD = new DataTable();\n        tableD.Locale = System.Globalization.CultureInfo.InvariantCulture;\n        adapter.SelectCommand = oracleCom;\n        adapter.Fill(tableD);\n\n        string FileName = Path.GetTempPath();\n        FileName += \"tempfile\" + tableD.Rows[0][1];\n\n        byte[] file = new byte[0];\n        file = (byte[])tableD.Rows[0][0];\n        FileStream fs = new FileStream(FileName, FileMode.OpenOrCreate, FileAccess.Write);\n        fs.Write(file, 0, file.GetUpperBound(0) + 1);\n        fs.Close();\n        System.Diagnostics.Process.Start(FileName);\n</code></pre>\n"},{"tags":["c#","winforms","serialization","designer","initializecomponent"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":10272123,"title":"How can I customize the code generation of InitializeComponent? More specifically, how can I post-process all of the generated code?","body":"<p>I'm trying to customize the Windows Forms Designer's code generation for <code>InitializeComponent</code>. The MSDN article <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers'\">\"Customizing Code Generation in the .NET Framework Visual Designers\"</a> contains a section <a href=\"http://msdn.microsoft.com/en-us/library/ms973818.aspx#custcodegen_topic8\" rel=\"nofollow\" title=\"MSDN article: 'Customizing Code Generation in the .NET Framework Visual Designers', section 'Controlling Code Generation'\">\"Controlling Code Generation\"</a> that explains the basics of how this can be done.</p>\n\n<p>I've closely followed an example in the above article:</p>\n\n<pre><code>//using System.ComponentModel.Design.Serialization;\n\nclass SomeFormSerializer : CodeDomSerializer\n{\n    public override object Serialize(IDesignerSerializationManager manager,\n                                     object value)\n    {\n        // first, let the default serializer do its work:\n        var baseSerializer = (CodeDomSerializer)manager.GetSerializer(\n                             typeof(Form).BaseType, typeof(CodeDomSerializer));\n        object codeObject = baseSerializer.Serialize(manager, value);\n\n        // then, modify the generated CodeDOM -- add a comment as the 1st line:\n        if (codeObject is CodeStatementCollection)\n        {\n            var statements = (CodeStatementCollection)codeObject;\n            statements.Insert(0, new CodeCommentStatement(\"CODEDOM WAS HERE\"));\n        }\n\n        // finally, return the modified CodeDOM:\n        return codeObject;\n    }\n}\n</code></pre>\n\n<p>Now I hook this up to my form <code>SomeForm</code>:</p>\n\n<pre><code>[DesignerSerializer(typeof(SomeFormSerializer), typeof(CodeDomSerializer))]\nclass SomeForm : Form { … }\n</code></pre>\n\n<p>The Forms Designer might then generate the following <code>InitializeComponent</code> code:</p>\n\n<pre><code>private void InitializeComponent()\n{\n    … /* (general setup code, such as a call to `this.SuspendLayout`) */ \n\n    // \n    // someButton\n    // \n    … /* (someButton's properties are set) */\n\n    // CODEDOM WAS HERE!\n    // \n    // SomeForm\n    // \n    … /* (form's properties are set) */\n\n    … /* (general setup code, such as a call to `this.ResumeLayout`) */ \n}\n</code></pre>\n\n<p>Note that the comment <code>// CODEDOM WAS HERE</code> was not added as the very first line in <code>InitializeComponent</code>, but only as the first line of the code block that deals with the properties of the form object itself.</p>\n\n<p>What would I have to do if I wanted to be able to modify the generated CodeDOM of the whole method, and not just of the part that deals with a specific object? </p>\n\n<blockquote>\n  <p><strong>Background: Why do I want to do this?</strong> In Windows Forms, if one wants flexible value conversion during data binding, one usually has to resort to subscribing to the <code>Format</code> and <code>Parse</code> events of some particular <code>Binding</code> object. So I'm creating a specialized <code>Binding</code> subclass (let's call it <code>ConvertingBinding</code>) that simplifies this process a bit.</p>\n  \n  <p>Now, the issue is that when data bindings are set up in the Windows Forms Designer, the generated code creates instances of <code>Binding</code>; however, I would want the designer to instantiate my specialized subclass instead. My current approach is to let the designer create a CodeDOM tree first, then walk that tree and replace all instantiations of <code>Binding</code> by instantiations of <code>ConvertingBinding</code>.</p>\n</blockquote>\n"},{"tags":["c#","visual-studio-2010",".net-4.0"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":83,"score":6,"question_id":13266397,"title":"What is the most optimal method of checking if a string is empty?","body":"<p>To check whether a string is empty I use</p>\n\n<pre><code>var test = string.Empty; \nif (test.Length == 0) Console.WriteLine(\"String is empty!\");\nif (!(test.Any())) Console.WriteLine(\"String is empty!\");\nif (test.Count() == 0) Console.WriteLine(\"String is empty!\");\nif (String.IsNullOrWhiteSpace(test)) Console.WriteLine(\"String is empty!\");\n</code></pre>\n\n<ol>\n<li><p>All the above statements produces the same output. What is the optimal method that I should use?</p>\n\n<pre><code>var s = Convert.ToString(test);    \ns = test.ToString(CultureInfo.InvariantCulture);\n</code></pre></li>\n<li><p>Again, both statements does the same thing. What is the best method to use?</p></li>\n</ol>\n\n<p>I tried debugging and how to benchmark the performance of a C# statement?</p>\n"},{"tags":["c#","xml","asp.net-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13262279,"title":"Populate KeyValue Model from XML File in .Net MVC","body":"<p>I have a database model with several KeyValue entities where values will not change often.  Rather than storing this data in a database, I am hoping to store in a code file or xml file.  I was wondering how I can get a list of these KeyValues through my application.  I was thinking an XML file in app_data folder would be ideal, but I don't know who to consume such a file through a model class.  Maybe there is a better alternative?</p>\n"},{"tags":["c#","xml","file"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13266496,"title":"Easily write a whole class instance to XML File and read back in","body":"<p>I have a main class called <code>theGarage</code>, which contains instances of  our customer, supplier, and jobs classes.</p>\n\n<p>I want to save the program data to an XML file, I have used the code below (just a snippet, I have matching code for the other classes). I am wondering if there is an easier way for me to do this, like write the whole theGarage class to an XML file and read it in without having to write all this code like I have below. </p>\n\n<pre><code>   public void saveToFile()\n    {\n        using (XmlWriter writer = XmlWriter.Create(\"theGarage.xml\"))\n        {\n            writer.WriteStartDocument();\n\n            ///\n            writer.WriteStartElement(\"theGarage\");\n            writer.WriteStartElement(\"Customers\");\n\n            foreach (Customer Customer in Program.theGarage.Customers)\n            {\n                writer.WriteStartElement(\"Customer\");\n                writer.WriteElementString(\"FirstName\", Customer.FirstName);\n                writer.WriteElementString(\"LastName\", Customer.LastName);\n                writer.WriteElementString(\"Address1\", Customer.Address1);\n                writer.WriteElementString(\"Address2\", Customer.Address2);\n                writer.WriteElementString(\"Town\", Customer.Town);\n                writer.WriteElementString(\"County\", Customer.County);\n                writer.WriteElementString(\"PostCode\", Customer.Postcode);\n                writer.WriteElementString(\"TelephoneHome\", Customer.TelephoneHome);\n                writer.WriteElementString(\"TelephoneMob\", Customer.TelephoneMob);\n\n                //begin vehicle list\n                writer.WriteStartElement(\"Vehicles\");\n\n                foreach (Vehicle Vehicle in Customer.Cars)\n                {\n                    writer.WriteStartElement(\"Vehicle\");\n                    writer.WriteElementString(\"Make\", Vehicle.Make);\n                    writer.WriteElementString(\"Model\", Vehicle.Model);\n                    writer.WriteElementString(\"Colour\", Vehicle.Colour);\n                    writer.WriteElementString(\"EngineSize\", Vehicle.EngineSize);\n                    writer.WriteElementString(\"Registration\", Vehicle.Registration);\n                    writer.WriteElementString(\"Year\", Vehicle.YearOfFirstReg);\n                    writer.WriteEndElement();\n                }\n                writer.WriteEndElement();\n                writer.WriteEndElement();\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","rest","asp.net-web-api"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13223470,"title":"Backward compatibility in a RESTful API","body":"<p>I am currently designing an RESTful API implemented using the ASP.NET Web API.<br>\nOne very important point is backward compatibility.<br>\nI would like to keep the actual API code free of any thoughts about backward compatibility, to ensure clean and up-to-date design.<br>\nI thought about solving this by having a layer of version translators.<br>\nEach of these translators knows how to transform the requests and responses of one specific version (vPrevious) into those of another specific version (vCurrent).<br>\nThese translators could easily be stacked to ensure backward compatibility with an arbitrary number of old versions.<br>\nEach of these translators would be responsible for doing all kinds of stuff, like setting default values for new properties or even performing an array of different operations.</p>\n\n<p>I thought about implementing a <code>DelegatingHandler</code> that examines the version number of the API the client wants to use and based on that knows which translators to use.<br>\nHowever, I fail to see how I would actually go about implementing this.\nAs I see it, each translator actually needs to be a full blown ASP.NET Web API of its own, along with a routing table and controllers. That actually would be acceptable, but how would that translator controller route the data to the next one in the chain?</p>\n"},{"tags":["c#","unit-testing","enterprise-library"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":15338,"score":4,"question_id":4030436,"title":"Activation error occured while trying to get instance of type Database, key \"\" <-- blank","body":"<p>I'm trying out the Enterprise Library 5.0 and was doing some unit-tests on my BL, do I need to have a app.config on the DL or on the Test project?</p>\n\n<p>note: I already have the configuration settings on my web.config on my web project.</p>\n\n<p><strong>how I use the DAAB:</strong></p>\n\n<pre><code>private static Database db = DatabaseFactory.CreateDatabase();\n\ndb.ExecuteNonQuery(\"spInsertSalesman\", salesman.Fullname);\n</code></pre>\n\n<p><strong>my app.config on DL:</strong></p>\n\n<pre><code>&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;section name=\"dataConfiguration\" type=\"Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" requirePermission=\"false\" /&gt;\n    &lt;/configSections&gt;\n    &lt;dataConfiguration defaultDatabase=\"DBTEST\" /&gt;\n    &lt;connectionStrings&gt;\n        &lt;add name=\"DBTEST\" connectionString=\"Data Source=[dbsource];Initial Catalog=[dbname];User Id=sa;Password=password;\"\n            providerName=\"System.Data.SqlClient\" /&gt;\n    &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["c#","visual-studio-2010","passwords"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13265694,"title":"Login Page C# (Inconsistency)","body":"<p>I am doing a login page that makes use of controller and login form. When i enter a invalid username i am not able to login. But when i just enter my username and a wrong password.. i am allowed to login. What is wrong with my codes?</p>\n\n<p><strong>User Controller Codes</strong></p>\n\n<pre><code> using System;\n using System.Collections.Generic;\n using System.Linq;\n using System.Text;\n using System.Data;\n using System.Data.OleDb;\n using System.Data.SqlClient;\n using System.Windows.Forms;\n using System.Security.Cryptography;\n using System.IO;\n\n namespace Privacy_Biometric_Defender\n{\nclass UserController{\n    User[] user;\n    User searchUser;\n    DataRowCollection rows;\n    DataSet uds;\n    OleDbDataAdapter dbAdapter;\n    DataTable userTable;\n\n    //A kind of gobal var to share in project\n    public static string uNameExist;\n    public static string passwordExist;\n    public static string roleExist;\n\n    public UserController(){\n\n    // Set up Connection String\n    OleDbConnection dbConn = new OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n    // Setup SQL select statement\n    string sqlStatement = \"Select * from [User]\";\n\n    // Setup DBAdapter (Scientist Table)\n\n    dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n    OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n    // Create a Data Set to hold data from DB\n    uds = new DataSet();\n\n    // fill ds with data from DB\n    dbAdapter.Fill(uds);\n\n    // get contacts table\n    DataTable userTab = uds.Tables[0];\n\n    // get all rows\n    rows = userTab.Rows;\n    }\n\n    public User[] GetAllUsers()\n    {\n        DataRow row;\n\n        user = new User[rows.Count];\n\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            row = rows[i];\n            user[i] = new User();\n            user[i].SetId((Int32)row[\"ID\"]);\n            user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n            user[i].SetUsername((string)row[\"Username\"]);\n            user[i].SetFName((string)row[\"FName\"]);\n            user[i].SetLName((string)row[\"LName\"]);\n            user[i].SetPassword((string)row[\"Password\"]);\n            user[i].SetEmail((string)row[\"Email\"]);\n            user[i].SetContact((Int32)row[\"Contact\"]);\n            user[i].SetRole((string)row[\"Roles\"]);\n        }\n        return user;\n    }\n\n    public User SearchUser(string uname)\n    {\n        searchUser = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            if (user[i].GetUsername() == uname)\n            {\n                searchUser.SetId(user[i].GetId());\n                searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                searchUser.SetUsername(user[i].GetUsername());\n                searchUser.SetFName(user[i].GetFName());\n                searchUser.SetLName(user[i].GetLName());\n                searchUser.SetPassword(user[i].GetPassword());\n                searchUser.SetEmail(user[i].GetEmail());\n                searchUser.SetContact(user[i].GetContact());\n                searchUser.SetRole(user[i].GetRole());\n            }\n        }\n        return searchUser;\n    }\n\n    public User SearchUserName(string userName)\n    {\n    User searchUserName = new User();\n\n    //get all rows from DB\n    GetAllUsers();\n    for (int i = 0; i &lt; rows.Count; ++i)\n    {\n        //Get UserName to store in this container\n        string checkUname = user[i].GetUsername();\n        if (checkUname == userName)\n        {\n            uNameExist = \"Exists\";\n            roleExist = user[i].GetRole();\n        }\n    }\n    return searchUserName;\n    }\n\n    // Search password for Login function\n    public User SearchPassword(string password)\n    {\n    User searchPassword = new User();\n\n    //get all rows from DB\n    GetAllUsers();\n    for (int i = 0; i &lt; rows.Count; ++i)\n    {\n        //Get password to store in this container\n\n        string checkPassword = user[i].GetPassword();\n        if (checkPassword == password)\n        {\n            passwordExist = \"Exists\";\n        }\n    }\n    return searchPassword;\n}\n    public static string GetSHA512(string text)\n    {\n        UnicodeEncoding UE = new UnicodeEncoding();\n        byte[] hashValue;\n        byte[] message = UE.GetBytes(text);\n\n        SHA512Managed hashString = new SHA512Managed();\n        string hex = \"\";\n\n        hashValue = hashString.ComputeHash(message);\n        foreach (byte x in hashValue)\n        {\n            hex += String.Format(\"{0:x2}\", x);\n        }\n        return hex;\n    }\n\n\n}\n\n}\n</code></pre>\n\n<p><strong>Login Page: Form</strong></p>\n\n<pre><code>    private void LoginButton_Click(object sender, EventArgs e)\n    {\n        string userName = this.LoginUsernameTextBox.Text;\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();\n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(passwd);\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n</code></pre>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266475,"title":"Missing larger/smaller option for Windows Live Tile","body":"<p>I am referring to <a href=\"http://code.msdn.microsoft.com/windowsapps/app-tiles-and-badges-sample-5fc49148\" rel=\"nofollow\">App tiles and badges sample</a></p>\n\n<p>By running the sample, and right click on the icon, I realize I can have larger/smaller option.</p>\n\n<p><img src=\"http://i.stack.imgur.com/fYc6g.png\" alt=\"enter image description here\"></p>\n\n<p>However, for my own project, I cannot find such option.</p>\n\n<p><img src=\"http://i.stack.imgur.com/5cWYJ.png\" alt=\"App tiles and badges sample\"></p>\n\n<p>I go through all settings in the project sample but unable to figure out differences. I would like to have my project having larger/smaller option. Is there anything I had missed out?</p>\n"},{"tags":["c#","datetime"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":13264038,"title":"C# Month and Day Occurrence in between the dates","body":"<p>I've a Month and day list and i need to search each month and day in this list in between the given dates. Can any one suggest me to do best way to get desired output.</p>\n\n<p>Eg:   </p>\n\n<blockquote>\n  <p>Month day list -> 01/11, 03/15, 05/25, 09/01</p>\n  \n  <p>Between dates -> 01/01/2012 to 07/01/13</p>\n</blockquote>\n\n<p>Expected result: </p>\n\n<blockquote>\n  <p>01/11/2012, 01/11/2013</p>\n  \n  <p>03/15/2012, 03/15/2013</p>\n  \n  <p>05/25/2012, 05/25/2013</p>\n  \n  <p>09/01/2012</p>\n</blockquote>\n\n<p>I tried like this but it gives memory exception and time and memory complexity increases if from date and to date having number of years gap, is there any quick solution to get it?</p>\n\n<pre><code>DateTime[] dateDates = new DateTime[dateTypeList.Rows.Count];\n//convert strings to datetimes:\nfor (int i = 0; i &lt; dateTypeList.Rows.Count; i++)\n{\n    dateDates[i] = Convert.ToDateTime(Convert.ToDateTime(string.Format(\"{0}/{1}\", Convert.ToInt32(dateTypeList.Rows[i][\"Month\"]), Convert.ToInt32(dateTypeList.Rows[i][\"Day\"]))));\n}\n\n//define start and end time:\nDateTime dateStart = new DateTime(2012, 1, 1);\nDateTime dateEnd = new DateTime(2013, 7, 1);\n\nList&lt;DateTime&gt; results = new List&lt;DateTime&gt;();\n//loop days between start and end time:\nfor (DateTime a = dateStart; a &lt;= dateEnd; a.AddDays(1))\n{\n    for (int i = 0; i &lt; dateDates.Length; i++)\n    {\n        if (dateDates[i] == a)\n        {\n            results.Add(a);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","sms","way2sms"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":7043,"score":0,"question_id":1590353,"title":"sending sms through way2sms help needed","body":"<p>I am building a desktop app in Visual C# 2.0 that can send sms through way2sms.com. anyone of you ve tried such thing...? please help.</p>\n"},{"tags":["c#","wpf","datagrid","colors"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13251789,"title":"WPF datagrid change color when text change","body":"<p>I want to change the color of the cell in a datagrid when the user changes the text or content of that cell.</p>\n\n<p>I am using WPF an C#.</p>\n\n<p>I have a simple datagrid: </p>\n\n<pre><code>&lt;DataGrid x:Name=\"dataGrid1\" Grid.RowSpan=\"2\" Margin=\"5\" ItemsSource=\"{Binding Source=Horreos}\" KeyDown=\"dataGrid1_KeyDown\" SelectedCellsChanged=\"dataGrid1_SelectedCellsChanged\"&gt; &lt;DataGrid.Columns &gt; &lt;/DataGrid.Columns&gt; &lt;/DataGrid&gt; \n</code></pre>\n\n<p>This events: keydown and selectedcellschange are tests for change my color cell. In the .cs I tried changing the cel.... but I failed.</p>\n\n<p><strong>I need an event that is released when the content changes</strong></p>\n"},{"tags":["c#","asp.net","iis","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":158,"score":0,"question_id":13162545,"title":"Handler \"ExtensionlessUrlHandler-Integrated-4.0\" has a bad module \"ManagedPipelineHandler\" in its module list","body":"<p>To be honest, I've tried to turn a dirty trick on IIS and just when I thought that I was going to get away with it, I realized my workaround doesn't work. Here's what I've tried to do:</p>\n\n<p>1) I have ASP.NET application which has <strong>Preloader</strong> class that inherits <strong>IProcessHostPreloadClient</strong> and does all the heavy initialization in <em>Preload</em> method implementation (application is complex and it's a part of an enormous system, so it requires approximately 2 minutes to establish connections to all necessary services and pre-instantiate some Unity registrations).</p>\n\n<p>2) I have a lot of work that needs to be done on application shutdown (unsubscribing, disconnecting, disposing,...), and I guess the best place to do it is in *Application_End* method located in <strong>Global.asax</strong>.</p>\n\n<p>3) Everything works just fine when I have user activity (first request after the Application Pool that contains aforementioned web application is started will cause *Application_Start* to be called and afterwards *Application_End* is called on Application Pool stop or recycle), but problems occur when there is no user activity and application tries to restart itself after being active for 48 hours (configured requirement). Since there was no requests, application officially didn't get started. Ergo, it can't be gracefully stopped since *Application_End* won't be called.</p>\n\n<p>4) Now comes the messy part... I've tried to make a GET request from code at the end of the <em>Preload</em> method, and it worked. But this solution seemed bad to me, even though it worked. So, I've tried a lot of things, and the last thing I tried was this:</p>\n\n<pre><code>SimpleWorkerRequest swr = new SimpleWorkerRequest(string.Empty, string.Empty, tw);\nHttpRuntime.ProcessRequest(swr);\n</code></pre>\n\n<p>... and that has done it's purpose. *Application_Start* was called, (I've checked response, it was containing login page that was supposed to be displayed in initial request) and on Application Pool shutdown application ended gracefully by doing necessary work in *Application_End*.</p>\n\n<p><strong>BUT</strong></p>\n\n<p>After the application was started (preloaded and initiated) in this manner, this is what happened when I wanted to reach application via Web browser:</p>\n\n<blockquote>\n  <p>HTTP Error 500.21 - Internal Server Error\n  Handler \"ExtensionlessUrlHandler-Integrated-4.0\" has a bad module \"ManagedPipelineHandler\" in its module list</p>\n</blockquote>\n\n<p>I am unable to figure this out. Can anybody tell me why this happens and how to fix it?</p>\n\n<p>If I don't figure this out, I will go back to first solution (sending GET request from code) but this problem will bug me since I don't even have an idea what's wrong.</p>\n"},{"tags":["c#","web-services","header","service-reference","c#-4.5"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13266468,"title":"Add Header to the Simple Web Service Request","body":"<p>I have a Console application, I add a Web reference simply by write click and use \"Add Service Reference\", then my .Config file changed to:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;system.serviceModel&gt;\n        &lt;bindings&gt;\n            &lt;basicHttpBinding&gt;\n                &lt;binding name=\"FServiceSoapBinding\" /&gt;\n            &lt;/basicHttpBinding&gt;\n        &lt;/bindings&gt;\n        &lt;client&gt;\n            &lt;endpoint address=\"http://ServiceAdd/FService\" binding=\"basicHttpBinding\"\n                bindingConfiguration=\"FServiceSoapBinding\" contract=\"MyReference.MService_\"\n                name=\"FServicePort\" /&gt;\n        &lt;/client&gt;\n    &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>So, every thing is fine and it seems I can use the service successfully, but the service documentation said I need set username and password on the header of the requests, and this is the example of the documentation:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\nxmlns:web=\"http://namespace.com/\"&gt;\n  &lt;soapenv:Header&gt;\n    &lt;Account&gt;\n      &lt;username&gt;user&lt;/username&gt;\n      &lt;password&gt;password&lt;/password&gt;\n    &lt;/Account&gt;\n  &lt;/soapenv:Header&gt;\n  &lt;soapenv:Body&gt;\n    &lt;web:oneofservicemethods&gt;\n      &lt;items&gt;\n        &lt;item&gt;...&lt;/item&gt;\n      &lt;/items&gt;\n    &lt;/web:oneofservicemethods&gt;\n  &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>So How can I add username and password to the header? any suggestion?</p>\n"},{"tags":["c#",".net","wpf","winapi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2962,"score":0,"question_id":1776382,"title":"How do I remove the icon and title from a WPF Window but display it in the taskbar?","body":"<p>I'm trying to create a WPF window, which has no icon and no title displayed in the titlebar.</p>\n\n<p>I already found some examples how the icon can be removed (for example <a href=\"http://www.danrigsby.com/blog/index.php/2008/05/26/remove-icon-from-wpf-window/\" rel=\"nofollow\">here</a>), but all these solutions work if I'm debugging the application in Visual Studio but they don't work when I'm just running the executable.</p>\n\n<p>I would also like the title not to be shown. Of course I could leave the title blank, but I would like the title to be disyplayed in the taskbar (similiar to what Windows Explorer does in Vista/7)</p>\n"},{"tags":["c#","windows-7","wifi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13266704,"title":"View information on stored wifi profiles and keys","body":"<p>How can I get a list of stored wifi profiles, and their keys?</p>\n"},{"tags":["c#","pdf-generation","blur"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13266687,"title":"Transform a nice pdf into a blurry pdf in c#","body":"<p>I have a pdf file and I want to modify or create a similar pdf but blurry, foggy or ugly. It is possible to do this in c#? I have no idea how can do this so any indication will be welcomed:).</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","windows-8","winrt","oauth-2.0","windows-store-apps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13140663,"title":"WinRT - OAuth2 get access token","body":"<p>I am trying to create a Windows Store app which needs an authentication through OAuth2.</p>\n\n<p>Prefered way should be WebAuthenticationBroker:</p>\n\n<pre><code>const string url = @\"https://my.server.srv/mobile-auth/index.pl?\"\n                          + \"client_id=CLIENTID\"\n                           + \"&amp;redirect_uri=https%3A%2F%2Fmy.server.srv\n                           + \"&amp;response_type=code\"\n\nUri startUri = new Uri(url);\nUri endUri = new Uri(\"https://my.server.srv\");\n\nWebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(WebAuthenticationOptions.None, startUri, endUri);\nif (webAuthenticationResult.ResponseStatus == WebAuthenticationStatus.Success)\n{\n    string token = webAuthenticationResult.ResponseData;\n}\n</code></pre>\n\n<p>but the token is empty. There should be the server response, which is</p>\n\n<pre><code>code=a-secret-code&amp;expires_in=600&amp;token_type=bearer\n</code></pre>\n\n<p>passed in GET, which is compilant to OAuth2.</p>\n\n<p>Do you know how to get that parameters, please?</p>\n\n<p><strong>EDIT:</strong> SOLVED. It started to work after passing \"https://localhost\" as redirect_uri / endUri.</p>\n"},{"tags":["c#","windows-8","file-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13266423,"title":"Windows 8 App and access to file system","body":"<p>I'm at the beginning of my project and I wonder which technology I should use.\nIn my little research I found WinRT API being kind of pleasant and I really like tile grid concept in UI.</p>\n\n<p>The only problem is that my app will generate tons of data - important data - which I have to store somewhere on the local machine. By 'somewhere' I mean use of a different partition than the OS.</p>\n\n<p>So, why not to try this simple code.</p>\n\n<pre><code>await Windows.Storage.PathIO.WriteTextAsync(@\"d:\\tests\\test.txt\", \"Hello World\");\n</code></pre>\n\n<p>Because <code>E_ACCESSDENIED</code>, that's why. Windows 8 slaps me in face screaming \"Access Denied\".</p>\n\n<p>Is there any way I can store my data in a way I like or <code>Win8</code> is too <code>h4x0r</code> proof?</p>\n\n<p>And no, \"Make a desktop application\" is not a correct answer.</p>\n"},{"tags":["c#","asp.net","html"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13266409,"title":"Conditional writing of HTML","body":"<p>I am currently trying to create a statement where if it returns false then a label will display on the page with an error message. I have tried using <code>Response.Write</code> with no results.</p>\n\n<pre><code>if (bannedDomainText.Text.Contains(\".\"))\n    File.AppendAllText(MapPath(FILE_PATH), \"\\r\\n\" + bannedDomainText.Text);\nelse\n    Response.Write(\"&lt;label&gt;This isn't working!&lt;/label&gt;\");\n</code></pre>\n"},{"tags":["c#","data-structures","dictionary","path","trie"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13230439,"title":"Efficient data structure for associating data with filesystem paths?","body":"<p>I need to keep some data in memory about a possibly large number of files and directories (typically up to a few hundreds of thousands). The obvious approach is to use a <code>Dictionary&lt;string, Something&gt;</code> with the path as the key, but there are two problems with this:</p>\n\n<ul>\n<li>many of the files will have a large part of their path in common, so it's probably a waste of memory to store the full path of each file</li>\n<li>I need to be able to quickly access the data about all the descendants of a directory; with a dictionary, the only way to do this is to test each key and check if it starts with the specified path, which is quite inefficient</li>\n</ul>\n\n<p>This problem seems like a good candidate for using a prefix tree (or <a href=\"http://en.wikipedia.org/wiki/Trie\" rel=\"nofollow\">trie</a>), with segments of the path as \"characters\". I tried to implement it, and the performance is not too bad for lookup by prefix (about 4 times faster than a dictionary), but it has two issues:</p>\n\n<ul>\n<li>the memory consumption is not reduced, probably because of the overhead of the list of children for each node</li>\n<li>the construction time is much worse than with a dictionary (about 4 times slower to fill the collection)</li>\n</ul>\n\n<p>I'm sure it must be a very common problem, so perhaps there are well known solutions that I'm not aware of?</p>\n"},{"tags":["c#","asp.net","ldap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13266563,"title":"Get all the displaynames that matches with the user provided name from ldap in grid in asp.net c#","body":"<p>Am working with ldap. I have a textbox where the user types a name. On click of a button i need to get all names that matches the user name in a grid so that the user can select the name he wants. Is it possible to do so.I havent impleted this part of the code yet. Below is the code till this part. Any suggestions will be of great help.Thank you.</p>\n\n<pre><code>    &lt;div id=\"show\" runat=\"server\"&gt;\n&lt;asp:Label ID=\"lbl1\" runat=\"server\" Text=\"Display Name:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtdisname\" runat=\"server\" Width=\"202px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label4\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n       &lt;asp:Button ID=\"Button2\" Text=\"Ok\" runat=\"server\" Width=\"50px\"  /&gt; &lt;%--on click should display all the matching names--%&gt;\n\n    &lt;br /&gt;\n&lt;asp:Label ID=\"lbl2\" runat=\"server\" Text=\"Employee ID:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtempid\" runat=\"server\" Width=\"202px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label5\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n\n    &lt;br /&gt;\n&lt;asp:Label ID=\"lbl3\" runat=\"server\" Text=\"Email Address:\"&gt;&lt;/asp:Label&gt; &amp;nbsp;&amp;nbsp;\n&lt;asp:TextBox ID=\"txtmail\" runat=\"server\" Width=\"201px\" Height=\"25px\"&gt;&lt;/asp:TextBox&gt;\n\n\n        &lt;asp:Label id=\"Label6\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n   &lt;asp:Button ID=\"btn\" Text=\"Ok\" runat=\"server\" Width=\"50px\" \n        onclick=\"btn_Click\"  /&gt;\n&amp;nbsp;\n&lt;/div&gt;\n</code></pre>\n\n<p>HERE IS THE CODE BEHIND</p>\n\n<pre><code>      protected void Button2_Click(object sender, EventArgs e)\n    {\n\n        PrincipalContext ctx = new PrincipalContext(ContextType.Domain, \"DOMAINNAME\");\n        UserPrincipal qbeUser = new UserPrincipal(ctx);\n        UserPrincipal qbeUser1 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser2 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser3 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser4 = new UserPrincipal(ctx);\n        UserPrincipal qbeUser5 = new UserPrincipal(ctx);\n\n        qbeUser.DisplayName = txtdisname.Text;\n        qbeUser1.EmployeeId = txtempid.Text;\n        qbeUser2.EmailAddress = txtmail.Text;\n        qbeUser3.EmailAddress = txt_To.Text;\n        qbeUser4.EmailAddress = txt_From.Text;\n        qbeUser5.EmailAddress = txt_cc.Text;\n\n        PrincipalSearcher srch = new PrincipalSearcher(qbeUser);\n        PrincipalSearcher srch1 = new PrincipalSearcher(qbeUser1);\n        PrincipalSearcher srch2 = new PrincipalSearcher(qbeUser2);\n        PrincipalSearcher srch3 = new PrincipalSearcher(qbeUser3);\n        PrincipalSearcher srch4 = new PrincipalSearcher(qbeUser4);\n        PrincipalSearcher srch5 = new PrincipalSearcher(qbeUser5);\n\n\n\n\n        UserPrincipal found = srch.FindOne() as UserPrincipal;\n        UserPrincipal found1 = srch1.FindOne() as UserPrincipal;\n        UserPrincipal found2 = srch2.FindOne() as UserPrincipal;\n\n\n        if (found == null)\n        {\n            string strfromlabel;\n            strfromlabel = \"Invalid\";\n            Label4.Text = strfromlabel;\n        }\n\n        if( found1 ==null)\n        {\n          string strfromlabel1;\n             strfromlabel1 = \"invalid\";\n             Label5.Text = strfromlabel1; \n        }\n\n        if( found2 ==null)\n        {\n          string strfromlabel2;\n             strfromlabel2 = \"invalid\";\n             Label5.Text = strfromlabel2; \n        }\n\n        UserPrincipal found3 = srch3.FindOne() as UserPrincipal;\n\n         if (found == null || found2 ==null || found1==null)\n         {\n             string strfromlabel1;\n             strfromlabel1 = \"Invalid\";\n             Label1.Text = strfromlabel1;\n         }\n\n        UserPrincipal found4 = srch4.FindOne() as UserPrincipal;\n\n        if (found4 == null)\n        {\n\n            string strfromlabel2;\n            strfromlabel2 = \"Invalid\";\n            Label2.Text = strfromlabel2;\n\n        }\n\n        UserPrincipal found5 = srch5.FindOne() as UserPrincipal;\n        if (found5 == null)\n        {\n            string strfromlabel3;\n            strfromlabel3 = \"Invalid\";\n            Label3.Text = strfromlabel3;\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","multithreading","thread-safety"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":90,"score":5,"question_id":13261300,"title":"Is it okay to \"double check\" before and inside a lock before running the code inside?","body":"<p>On working with thread-safety, I find myself always \"double checking\" before executing code in a lock block and I wondered if I was doing the right thing. Consider the following three ways of doing the same thing:</p>\n\n<p>Example 1:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    if(MyCollection[key] == null)\n    {\n         lock(locker)\n         {\n              MyCollection[key] = DoSomethingExpensive(); \n         }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    lock(locker)\n    {\n         if(MyCollection[key] == null)\n         {\n              MyCollection[key] = DoSomethingExpensive(); \n         }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>Example 3:</p>\n\n<pre><code>private static SomeCollection MyCollection;\nprivate static Object locker;\nprivate void DoSomething(string key)\n{\n    if(MyCollection[key] == null)\n    {\n        lock(locker)\n        {\n             if(MyCollection[key] == null)\n             {\n                  MyCollection[key] = DoSomethingExpensive(); \n             }\n        }\n    }\n    DoSomethingWithResult(MyCollection[key]);\n}\n</code></pre>\n\n<p>I always lean towards Example 3, and here's why I think I'm doing the right thing</p>\n\n<ul>\n<li>Thread 1 enters <code>DoSomething(string)</code></li>\n<li><code>MyCollection[key] == null</code> so Thread 1 obtains a lock, just as Thread 2 enters</li>\n<li><code>MyCollection[key] == null</code> is still true, so Thread 2 waits to obtain the lock</li>\n<li>Thread 1 calculates the value for <code>MyCollection[key]</code> and adds it to the collection</li>\n<li>Thread 1 releases the lock and calls <code>DoSomethingWithResult(MyCollection[key]);</code></li>\n<li>Thread 2 obtains the lock, by which time <code>MyCollection[key] != null</code></li>\n<li>Thread 2 does nothing, releases the lock and continues on its merry way</li>\n</ul>\n\n<p>Example 1 would work, but there is a big risk that Thread 2 could redundantly calculate <code>MyCollection[key]</code>.</p>\n\n<p>Example 2 would work, but every thread would obtain a lock, even if it didn't need to - which could be a (admittedly very small) bottleneck. Why hold up threads if you don't need to?</p>\n\n<p>Am I overthinking this and if so, what is the preferred way of handling these situations?</p>\n"},{"tags":["c#",".net","sql-server","subtract"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13266422,"title":"Mssql Subtract certain percent","body":"<p>Im trying to subtract a certain percent of my price, into a AS columm.</p>\n\n<pre><code>SELECT TOP 2 *, price - (price * (discount/100)) AS discountedPrice FROM products WHERE discount != 0\n</code></pre>\n\n<p>But this seems not to work. What have i done wrong?</p>\n\n<p>I want it like this, let's say price is 500 and discount is 20. Then it'll have to subtract those 20 as percent of the 500.</p>\n\n<p>So 500 - 20%, just in Mssql format.</p>\n"},{"tags":["c#","sql-server","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13265981,"title":"Execute SQL Server Stored Procedure with SqlHelper.ExecuteDataSet() and Get Return Value","body":"<p>I have an <code>SQL Server Stored Procedure</code>. This procedure have an output parameter.\nOn my <code>C#.NET</code> Appliaction, I execute this procedure via <code>SqlHelper.ExecuteDataSet()</code> and it returns a query result <code>DataSet</code>.\nHow can I get the output parameter from the stored procedure procedure while using <code>SqlHelper.ExecuteDataSet()</code>.\nSome article said that I need to use <code>SqlHelper.ExecuteNonQuery()</code> but I need the <code>DataSet</code> too.</p>\n\n<p>This is my code:</p>\n\n<pre><code>        public DataSet GetDataPerTable(string spName, string a, string b, out int c)\n        {\n            try\n            {\n                c = 0;\n\n                SqlParameter[] spParameter = new SqlParameter[3];\n\n                spParameter[0] = new SqlParameter(\"@a\", SqlDbType.Char, 4);\n                spParameter[0].Direction = ParameterDirection.Input;\n                spParameter[0].Value = a;\n\n                spParameter[1] = new SqlParameter(\"@b\", SqlDbType.Char, 1);\n                spParameter[1].Direction = ParameterDirection.Input;\n                spParameter[1].Value = b;\n\n                spParameter[2] = new SqlParameter(\"@c\", SqlDbType.Int);\n                spParameter[2].Direction = ParameterDirection.ReturnValue;                \n                c = Convert.ToInt32(spParameter[2].Value);\n\n                return SqlHelper.ExecuteDataset(Configuration.MyConnectionString, CommandType.StoredProcedure, spName, spParameter);\n            }\n            catch (Exception ex)\n            {\n\n                throw ex;\n            }\n        }\n</code></pre>\n\n<p>My <code>c</code> variable always return 0. Any Idea? Thanks in advance :)</p>\n\n<p>My Procedure is about like this:</p>\n\n<pre><code>CREATE PROCEDURE [dbo].SPR_MyProcedure (@a Char(4), @bChar(1), @c Int Output)  \nSELECT * \nFROM MyTable\nSet @c = 1\n</code></pre>\n"},{"tags":["c#","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13266404,"title":"Entity framework: automatic deletion of parent entity","body":"<p>Consider the following model classes:</p>\n\n<pre><code> public class Thing\n{\n    public int Id { get; set; }\n    [Required]\n    public Text Subject { get; set; }\n    [Required]\n    public Text Body { get; set; }\n}\n\npublic class Text\n{\n    public int Id { get; set; }\n    public string Value { get; set; }\n}\n</code></pre>\n\n<p>The model is simple - each Thing must reference to two Text entities. Each Text entry at any point in time should be referenced only by a single entity of any other type (Thing is not the only one).</p>\n\n<p>Is it possible to configure EF5 to automatically delete all referenced Texts when Thing gets deleted (via <code>context.Set&lt;Thing&gt;().Remove</code>), or should it be done with a database trigger?</p>\n"},{"tags":["c#","pdf","pdfsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13263252,"title":"C# PDF Sharp position in document","body":"<p>Hi I am using PDF sharp to print user input onto positions in a template document.</p>\n\n<p>The  data (fields) are collected from user (web page) and written at appropriate positions on the document using drawstring method.</p>\n\n<p>Currently I am finding the Pixel position of each templated field in each page by trial and error .It would be much easier if there is a way to determine pixel position of each field in pdf page.</p>\n\n<p>Any suggestion would be most helpful.</p>\n\n<p>thanks</p>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13265684,"title":"Change win app labels and text","body":"<p>I remember in <code>VB6</code> i was able to get the handle of a form of a software that's currently running, and change it from outside with some API functions.\nIs it possible to do with c#? how? The problem is that this software is in a different language. I want to change some of it to English.</p>\n"},{"tags":["c#","javascript","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13266120,"title":"TextBox filtering according to RadioButton selection","body":"<p>I've a <code>RadioButtonList</code> and a <code>TextBox</code>. Accordindg to RadioButtonList selection, I want to filtrering textbox.</p>\n\n<pre><code> &lt;asp:RadioButtonList ID=\"RadioButtonList1\"  runat=\"server\"  AutoPostBack=\"True\" OnSelectedIndexChanged=\"RadioButtonList1_SelectedIndexChanged\"&gt;\n      &lt;asp:ListItem Text=\"NUMBER\" Value=\"1\" Selected=\"True\"&gt;&lt;/asp:ListItem&gt;\n      &lt;asp:ListItem Text=\"TEXT\" Value=\"2\"&gt;&lt;/asp:ListItem&gt;\n&lt;/asp:RadioButtonList&gt;\n\n &lt;asp:TextBox ID=\"txtID\" runat=\"server\"&gt;\n</code></pre>\n\n<p>When I click listitem with value <code>1</code>, user can enter number to textbox. value <code>2</code>, number + text.\nalso I want to set the length. Can someone show me how to do this?</p>\n"},{"tags":["c#","asp.net","xml","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":55,"score":1,"question_id":13265220,"title":"Encrypting of XML File","body":"<p>I want to encrypt an XML File. I took the help of the following code:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.encryptedxml.aspx\" rel=\"nofollow\"> MSDN Page Link </a></p>\n\n<p>Now the problem is coming when the encrypt function is called. After all the values have been inserted into the xml file, I call the encrypt function. It goes to the switch case 256. But it remains the same.</p>\n\n<pre><code>  XmlElement machmac = doc.CreateElement(\"Mach_MAC\");\n        machmac.InnerText = txtMachMac.Text;\n        root.AppendChild(machmac);\n\n        doc.AppendChild(root);\n        doc.Save(@\"D:\\DEV\\Gener_Lic.xml\");\n        lblmsg.Text = \"Your data is saved\";\n\n        RijndaelManaged key = null;\n\n        try\n        {\n            // Create a new Rijndael key.\n            key = new RijndaelManaged();\n            // Load an XML document.\n            XmlDocument xmlDoc = new XmlDocument();\n\n            xmlDoc.Load(\"D:\\\\DEV\\\\Gener_Lic.xml\");\n\n            // Encrypt the \"Generate_License\" element.\n            Encrypt(xmlDoc, \"Generate_License\", key);\n\n            Console.WriteLine(\"The element was encrypted\");\n\n            Console.WriteLine(xmlDoc.InnerXml);\n\n            //Decrypt(xmlDoc, key);\n\n            //Console.WriteLine(\"The element was decrypted\");\n\n            //Console.WriteLine(xmlDoc.InnerXml);\n\n\n        }\n        catch (Exception exc)\n        {\n            Console.WriteLine(exc.Message);\n        }\n        finally\n        {\n            // Clear the key. if (key != null)\n            {\n                key.Clear();\n            }\n        }\n    }\n\n    catch (Exception ex)\n    {\n        Console.WriteLine(\"error : \" + ex.Message);\n    }\n\n\n}\n</code></pre>\n\n<p>The encryption code is as follows:</p>\n\n<pre><code> public static void Encrypt(XmlDocument Doc, string ElementName, SymmetricAlgorithm Key)\n{\n    // Check the arguments \n\n    if (Doc == null)\n        throw new ArgumentNullException(\"Doc\");\n    if (ElementName == null)\n        throw new ArgumentNullException(\"ElementToEncrypt\");\n    if (Key == null)\n        throw new ArgumentNullException(\"Alg\");\n\n    // Find the specified element in the XmlDocument // object and create a new XmlElemnt object.\n\n    XmlElement elementToEncrypt = Doc.GetElementsByTagName(ElementName)[0] as XmlElement;\n\n    // Throw an XmlException if the element was not found. \n\n    if (elementToEncrypt == null)\n    {\n        throw new XmlException(\"The specified element was not found\");\n\n    }\n\n    // Create a new instance of the EncryptedXml class\n    // and use it to encrypt the XmlElement with the\n    // symmetric key.\n\n    EncryptedXml eXml = new EncryptedXml();\n\n    byte[] encryptedElement = eXml.EncryptData(elementToEncrypt, Key, false);\n\n    // Construct an EncryptedData object and populate\n    // it with the desired encryption information\n\n    EncryptedData edElement = new EncryptedData();\n    edElement.Type = EncryptedXml.XmlEncElementUrl;\n\n    // Create an EncryptionMethod element so that the\n    // receiver knows which algorithm to use for decryption\n    // Determine what kind of algorithm is being used and\n    // supply the appropriate URL to the EncryptionMethod element. \n\n    string encryptionMethod = null;\n\n    if (Key is TripleDES)\n    {\n        encryptionMethod = EncryptedXml.XmlEncTripleDESUrl;\n    }\n    else if (Key is DES)\n    {\n        encryptionMethod = EncryptedXml.XmlEncDESUrl;\n    }\n    if (Key is Rijndael)\n    {\n        switch (Key.KeySize)\n        {\n            case 128:\n                encryptionMethod = EncryptedXml.XmlEncAES128Url;\n                break;\n            case 192:\n                encryptionMethod = EncryptedXml.XmlEncAES192Url;\n                break;\n            case 256:\n                encryptionMethod = EncryptedXml.XmlEncAES256Url;\n                break;\n        }\n    }\n    else\n    {\n        // Throw an exception if the transform is not in the previous categories \n        throw new CryptographicException(\"The specified algorithm is not supported for XML Encryption.\");\n    }\n\n    edElement.EncryptionMethod = new EncryptionMethod(encryptionMethod);\n\n    // Add the encrypted element data to the\n    // EncryptedData object.\n    edElement.CipherData.CipherValue = encryptedElement;\n\n    /// Replace the element from the original XmlDocument\n    // object with the EncryptedData element\n    EncryptedXml.ReplaceElement(elementToEncrypt, edElement, false);\n}\n</code></pre>\n\n<p>Please tell me where am I going wrong.</p>\n"},{"tags":["c#",".net","web-config","membership-provider"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13263450,"title":"altering the type field in sqlmembership provider","body":"<p>Let us  consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\"&gt;\n  &lt;connectionStrings&gt;\n\n  &lt;/connectionStrings&gt;\n  &lt;system.web&gt;\n    &lt;pages theme=\"PetShop\" styleSheetTheme=\"PetShop\" controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"&gt;\n      &lt;controls&gt;\n        &lt;add tagPrefix=\"blt\" namespace=\"BLToolkit.Web.UI\" assembly=\"BLToolkit.4\" /&gt;\n      &lt;/controls&gt;\n    &lt;/pages&gt;\n    &lt;!--\n            Set compilation debug=\"true\" to insert debugging \n            symbols into the compiled page. Because this \n            affects performance, set this value to true only \n            during development.\n        --&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n    &lt;!--\n            The &lt;authentication&gt; section enables configuration \n            of the security authentication mode used by \n            ASP.NET to identify an incoming user. \n         --&gt;\n    &lt;authentication mode=\"Forms\"&gt;\n      &lt;forms name=\"PetShopAuth\" loginUrl=\"SignIn.aspx\" protection=\"None\" timeout=\"60\" /&gt;\n    &lt;/authentication&gt;\n    &lt;!--\n            The &lt;customErrors&gt; section enables configuration \n            of what to do if/when an unhandled error occurs \n            during the execution of a request. Specifically, \n            it enables developers to configure html error pages \n            to be displayed in place of a error stack trace.\n        --&gt;\n    &lt;customErrors defaultRedirect=\"Error.aspx\" mode=\"RemoteOnly\" /&gt;\n    &lt;sessionState mode=\"Off\" /&gt;\n    &lt;anonymousIdentification enabled=\"true\" /&gt;\n    &lt;profile automaticSaveEnabled=\"false\" defaultProvider=\"ShoppingCartProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"ShoppingCartProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"WishListProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"AccountInfoProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n      &lt;/providers&gt;\n      &lt;properties&gt;\n        &lt;add name=\"ShoppingCart\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"ShoppingCartProvider\" /&gt;\n        &lt;add name=\"WishList\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"WishListProvider\" /&gt;\n        &lt;add name=\"AccountInfo\" type=\"PetShop.ObjectModel.Address\" allowAnonymous=\"false\" provider=\"AccountInfoProvider\" /&gt;\n      &lt;/properties&gt;\n    &lt;/profile&gt;\n    &lt;!-- Membership Provider for SqlServer --&gt;\n    &lt;membership defaultProvider=\"SQLMembershipProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"SQLMembershipProvider\" type=\"System.Web.Security.SqlMembershipProvider\" connectionStringName=\"MembershipDB\" applicationName=\".NET Pet Shop 4.0\" enablePasswordRetrieval=\"false\" enablePasswordReset=\"true\" requiresQuestionAndAnswer=\"false\" requiresUniqueEmail=\"false\" passwordFormat=\"Hashed\" /&gt;\n      &lt;/providers&gt;\n    &lt;/membership&gt;\n    &lt;caching&gt;\n      &lt;sqlCacheDependency enabled=\"true\" pollTime=\"10000\"&gt;\n        &lt;databases&gt;\n          &lt;add name=\"MSPetShop4\" connectionStringName=\"SQLConnString1\" pollTime=\"10000\" /&gt;\n        &lt;/databases&gt;\n      &lt;/sqlCacheDependency&gt;\n    &lt;/caching&gt;\n  &lt;/system.web&gt;\n  &lt;location path=\"UserProfile.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"CheckOut.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>by reading the above config file i need to change the attribute value of type field in membership providers nodes. </p>\n\n<pre><code>    type=\"System.Web.Security.SqlMembershipProvider\" \n</code></pre>\n\n<p>to new value </p>\n\n<p>type=\"sample.SqlMembershipProvider\"</p>\n\n<p>through c#.net lamda expressions</p>\n\n<p>waiting for your responses</p>\n"},{"tags":["c#",".net","winforms","performance","logging"],"answer_count":7,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":6076,"score":1,"question_id":5057567,"title":"How to do logging in c#?","body":"<p>I would like to implement logging in my application but would rather not use any outside frameworks like log4net.</p>\n\n<p>So I would like to do something like Dos's echo to file. What is the most effective way to do it?</p>\n\n<p>Is there a way to log unhandled exceptions logged without using an outside framework?</p>\n"},{"tags":["c#","visual-studio","windows-server-2008-r2","system.diagnostics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":860,"score":1,"question_id":5936719,"title":"Calling dism.exe from System.Diagnostics.Process Fails","body":"<p>For enabling Microsoft-Hyper-V and Microsoft-Hyper-V-Management in Windows 2008 R2 Server(64bit), I'm calling dism.exe as a process. The command I've used is </p>\n\n<blockquote>\n  <p>Dism.exe /online /Get-FeatureInfo\n  /FeatureName:Microsoft-Hyper-V</p>\n  \n  <p>Dism.exe /online /Get-FeatureInfo\n  /FeatureName:Microsoft-Hyper-V-Management-Clients</p>\n</blockquote>\n\n<p>This works fine when I execute this from the command line but it fails when I try to execute it through my code. I've tried the 64bit version of Dism.exe under the C:\\Windows\\SysWoW64 folder but it fails too. Here is the error message I get,</p>\n\n<blockquote>\n  <p>You cannot service a running 64-bit\n  operating system with a 32-bit version\n  of DISM.  Please use the version of\n  DISM that corresponds to your\n  computer's architecture.</p>\n</blockquote>\n\n<p>What am I missing here?</p>\n\n<p>UPDATE: SLaks was right, but the issue turned out to be that MS Visual studio express edition by default targets x86 which I had to manually edit in the .csproj file to AnyCPU to make it work.</p>\n"},{"tags":["c#","casting"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13266305,"title":"Casting data to type of variables stored in object[]","body":"<p>I am trying to emulate the way fortran reads data from text files in C#. In fortran you have something like</p>\n\n<pre><code>        READ(60,2005,ERR=9880,END=8000) A,B,C,D\n  2005  FORMAT(I8,A20,2F10.3)\n</code></pre>\n\n<p>and A, B, C, D are automatically set to the correct type based on the format statement.</p>\n\n<p>I have tried things along the lines of:</p>\n\n<pre><code>    private static void Example(string[] Data, ref object[] Variables)\n    {\n        for (int i = 0; i &lt; Data.Length; i++)\n            Variables[i] = (typeof(Variables[i]))Data;\n    }\n</code></pre>\n\n<p>but can't even get code that will compile.</p>\n\n<p>At the moment I'm assigning to the variables by passing out all the data in an object array, like this</p>\n\n<pre><code>    private static object[] Example(string[] Data)\n    {\n        object[] output = new object[Data.Length - 1];\n\n        for (int i = 0; i &lt; Data.Length; i++)\n        {\n            int dummyInt;\n            if (int.TryParse(Data[i], out dummyInt))\n                output[i] = dummyInt;\n            /// Try to parse other possible data types\n        }\n\n        return output;\n    }\n\n    private static void UseExample()\n    {\n        object[] values = Example(new string[] { \"     356\", \"Some text           \", \"   956.365\", \"564050.201\" });\n        int A = (int)values[0];\n        string B = (string)values[1];\n        double C = (double)values[2];\n        double D = (double)values[3];\n    }\n</code></pre>\n\n<p>This is simplified, but is in essence what I am doing: determining the type of the data, casting to that type and passing all fields out as an object and then casting again when I assign to the variables that hold the data.\nWhich requires knowing what variables will come out and also a lot of extra coding if there are lots of data fields.</p>\n\n<p>I am looking for a way I can pass in all the variables that should be set and set them to the correct value value, but for that I need to be able to cast the data to the type of the appropriate variable.</p>\n\n<p>Can this be done? If it is possible, how can it be done?</p>\n"},{"tags":["c#","wpf","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13265891,"title":"I have issues with the C# WPF WebBrowser class","body":"<p>I have issues with the C# WPF WebBrowser class</p>\n\n<p>I have a C# WPF application which uses a WebBrowser class.  I have overwritten the LoadComplete method as well as several other methods to try to get the html content after the pages is loaded:</p>\n\n<pre><code>    String URL = textBox1.Text;\n\n    URL = URL.Replace(' ', '+');\n\n    webbrowser1 = new WebBrowser();\n\n    webbrowser1.LoadCompleted += new LoadCompletedEventHandler(webbrowser1_LoadCompleted);\n    webbrowser1.Loaded += new RoutedEventHandler(webbrowser1_Loaded);\n    webbrowser1.Navigated += webbrowser1_Navigated;\n\n    grd.Children.Add(webbrowser1);\n\n    int i = 0;\n    webbrowser1.Navigate(new Uri(\"https://www.google.com/#q=\" + URL + ....\n</code></pre>\n\n<p>I have put breakpoints in these methods and I have written code to grap the Inner HTML from the HTMLDocument of the WebBrowser class and I have output the html text to different files for each method.</p>\n\n<p>Then I have run the program.  While the program runs, I watch the actual program to see if the document loads.  The web page that is loading is the results page of a google search query.</p>\n\n<p>Visually, the output is a blank, white page when eaqch method for LoadComplete, Loaded and Navagated is hit while I run through the code.  It is only after the methods have been hit (some a couple of times) and the program is idle does the display show the results page.</p>\n\n<p>The HTML code that is output to files does not represent the google search results page.  Instead, it represents the google home page and does not have ny of the results.  Any ideas?  How can I programatically get the results page?</p>\n"},{"tags":["c#","json","rest","json.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13266100,"title":"Deserializing JSON data containing a varying number of parameters to C# (using Json.NET)","body":"<p>I'm trying to deserialize the following JSON response:</p>\n\n<pre><code>[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Yes\", \"1\":\"No\"} … ]\n</code></pre>\n\n<p>A problem arises, however, in the fact that the number of parameters following \"category\" can vary from 0 to 10. Meaning all the following are possible JSON responses:</p>\n\n<pre><code>[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\"} … ]\n[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Yes\", \"1\":\"No\"} … ]\n[{\"pollid\":\"1\", \"question\":\"This is a test\", \"start\":\"2011-06-28\", \"end\":\"2012-03-21\", \"category\":\"Roads\", \"0\":\"Bad\", \"1\":\"OK\", \"2\":\"Good\", \"3\":\"Very good\"} … ]\n</code></pre>\n\n<p>I'm deserializing responses to objects of the following form:</p>\n\n<pre><code>class Poll\n    {\n        public int pollid { get; set; }\n        public string question { get; set; }\n        public DateTime start { get; set; }\n        public DateTime end { get; set; }\n        public string category { get; set; }\n\n        [JsonProperty(\"0\")]\n        public string polloption0 { get; set; }\n        [JsonProperty(\"1\")]\n        public string polloption1 { get; set; }\n        [JsonProperty(\"2\")]\n        public string polloption2 { get; set; }\n        [JsonProperty(\"3\")]\n        public string polloption3 { get; set; }\n        [JsonProperty(\"4\")]\n        public string polloption4 { get; set; }\n        [JsonProperty(\"5\")]\n        public string polloption5 { get; set; }\n        [JsonProperty(\"6\")]\n        public string polloption6 { get; set; }\n        [JsonProperty(\"7\")]\n        public string polloption7 { get; set; }\n        [JsonProperty(\"8\")]\n        public string polloption8 { get; set; }\n        [JsonProperty(\"9\")]\n        public string polloption9 { get; set; }\n    }\n</code></pre>\n\n<p>My questions is: Is there perhaps a better way to handle the storing of a varying number of parameters? Having 10 class properties which may or may not be used (depending on the response) seems like such a \"hack\".</p>\n\n<p>Any help would be truly appreciated!</p>\n\n<p>Many thanks,\nTed</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":68,"score":-2,"question_id":13265713,"title":"Update string in List","body":"<p>I have loaded a txt comma delimited into multiple lists. For example</p>\n\n<pre><code>static public void File()    \n{    \n    var order_no = new List&lt;String&gt;();    \n    var quantity = new List&lt;String&gt;();    \n    order_no.Add(fields[0]);    \n    quantity.Add(fields[1]);    \n}       \n</code></pre>\n\n<p>Now what i am trying to is in a loop while the same order is found down the list and the quantity is null then update the quantity in the previous.  </p>\n\n<p>For example</p>\n\n<blockquote>\n  <p>order NO : 1     quantity: null</p>\n  \n  <p>order NO : 5     quantity: 2</p>\n  \n  <p>order no : 1     quantity: 1</p>\n</blockquote>\n\n<p>what it should do is to update the quantity in the first value to 1.</p>\n\n<p>How can i accomplish that?</p>\n"},{"tags":["c#",".net-4.0","windows-services"],"answer_count":7,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1973,"score":6,"question_id":6441614,"title":"Cannot find windows service (just installed)","body":"<p>I just installed a windows service using VS 2010, using the installutil.exe, the cmd prompt window said the commit phase completed successfully, but I cannot see the windows service in the local services folder.  </p>\n\n<p>What did I miss here?</p>\n\n<p>I am using Windows 7 and VS 2010</p>\n\n<p><strong>UPDATE:</strong><br>\nI un-installed the service (which was named service1) changed the name to something that made sense, installed the service (same process as above), still cannot find it in the services browser.  </p>\n\n<p>FWIW... I renamed my service1.cs in the properties window (filename value).. but it was still showing service1 in the services browser. I ended up changing the values in the code behind as well (auto generated code) this.serviceInstaller1.ServiceName = \"service1\";</p>\n\n<p><strong>Update (2)</strong>\nI created a dummy windows service, and was able to successfully install that (it prompted me for Domain Login ID &amp; password) and I was able to see it in the services browser.</p>\n\n<p>However, I am not able to see the actual windows service (related to my project) in the services browser. Obviously I have permissions, since I was able to install the dummy service.</p>\n\n<p>According this this site <a href=\"http://www.pcreview.co.uk/forums/cant-see-windows-service-after-installation-t2273909.html\" rel=\"nofollow\">Can't see windows service after installation</a></p>\n\n<p>I cannot see the service in the registry in \"HKLM\\System\\CurrentControlSet\\Services\" path.</p>\n\n<p><strong>Update (3)</strong><br>\nThe log file says </p>\n\n<blockquote>\n  <p>No public installers with the\n  RunInstallerAttribute.Yes attribute\n  could be found in the C:..</p>\n</blockquote>\n\n<p>however, I do have a ProjectInstaller.cs file in the project solution.</p>\n\n<p>I added </p>\n\n<blockquote>\n  <p>[RunInstaller(true)]</p>\n</blockquote>\n\n<p>to the ProjectInstaller.cs file, still no luck  </p>\n\n<p>Any suggesstions?</p>\n"},{"tags":["c#","asp.net","response"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3376,"score":1,"question_id":374555,"title":"Closing a Pop-Up Window after Writing File to Response","body":"<p>In my code, I am using javascript to fire off a window.open on an ASPX page. In the page-load of that page, I'm outputting a file:</p>\n\n<pre><code>Response.Clear();\nResponse.ClearContent();\nResponse.ClearHeaders();\nResponse.Charset = \"\";\nResponse.ContentType = \"application/octet-stream\";\nResponse.AddHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + filename + \"\\\";\");\noutputStream.WriteTo(Response.OutputStream);\noutputStream.Flush();\noutputStream.Close();\nResponse.Flush();\nResponse.Close();\n</code></pre>\n\n<p>After this, I would ideally like to close the popup window. However, because I have changed my response type, I cannot output the normal window.close javascript. It will merely get appended to the file being given to the users. The closest I have come to a solution is this thread:</p>\n\n<p><a href=\"http://forums.asp.net/t/1186371.aspx?PageIndex=1\" rel=\"nofollow\">http://forums.asp.net/t/1186371.aspx?PageIndex=1</a></p>\n\n<p>But even there in the end the guy didn't get any answers. As far as I can see, there is no way to do this. However, I'd like to ask you for your help before I give it up entirely and just have something telling the users to close the window manually. Any suggestions?</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13265223,"title":"Stop Location Sensor error from prompting","body":"<p>I am using the below code to retrieve the GPS, but because the location sensor is not install, an error is prompted, how do I stop it?</p>\n\n<pre><code>// Get the latitude and longitude\nGeoCoordinateWatcher watcher = new GeoCoordinateWatcher();\n\n// Do not suppress prompt, and wait 1000 milliseconds to start.\nwatcher.TryStart(false, TimeSpan.FromMilliseconds(1000));\n\nGeoCoordinate coord = watcher.Position.Location;\n</code></pre>\n\n<p>The Prompt message is :</p>\n\n<pre><code>Enter a default location.\n</code></pre>\n"},{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13265618,"title":"Repeating controls in windows form application","body":"<p>I am developing a Windows Forms application to generate incentive reports for staff in different groups. In order to match the report template, I need to manually put controls in the form for only one staff. If I finished all the logic inside, how can I make it dynamic so that it could auto generate reports for all the staff by using same template?</p>\n"},{"tags":["c#","exception-handling","quartz.net"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":843,"score":6,"question_id":3246277,"title":"Handle JobExecutionException in Quartz.net","body":"<p>Probably a stupid question... but here goes anyway...</p>\n\n<p>I have set up quartz, and can schedule jobs, and I can confirm that jobs (implementing the IJob interface) are working. Looking at the documentation on the site, (Lesson 3 of the tutorial) \"The only type of exception that you are allowed to throw from the execute method is JobExecutionException.\" I would like that when an exception occurs that I haven't explicitly handled, it should throw a JobExecutionException, so that I can log it in the 'parent' application. I have wrapped my code in a try catch, and have thrown the JobExecutionException, but now where to handle it?</p>\n\n<p>I don't call the execute method anywhere, that is handled by Quartz (on a separate thread). So, how do I handle that error when it occurs. I don't really want to swallow the error in the Job</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","android","html"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13209876,"title":"Mono for Android Get table value from HTML website","body":"<p>I'm using MonoDevelop (Android C#). Is there a way to get values from a HTML table from a specified URL?</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":30,"score":-1,"question_id":13265883,"title":"non closable window in windows form using c#?","body":"<p>When I click a submit button on the windows form, it should throw up a popup window (asking for yes or no) which doesn't have a close (X) button even if we click wherever that popup window should blink for that response.</p>\n\n<p>So how to do it?</p>\n"},{"tags":["c#","android"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13235794,"title":"Mono for Android Release error","body":"<p>I'm using Mono for Android (C#). I'm trying to get the .apk file using MonoDevelop, but when I set project for release (using this guide: <a href=\"http://docs.xamarin.com/Android/Guides/Deployment,_Testing,_and_Metrics/publishing_an_application/Part_1_-_Preparing_an_Application_for_Release\" rel=\"nofollow\">LINK</a>) I get this Error:</p>\n\n<blockquote>\n  <p>Error MSB4018: The \"GenerateJavaStubs\" task failed unexpectedly.\n  System.InvalidOperationException: /manifest/@package attribute MUST\n  contain a period ('.').    at\n  Xamarin.Android.Tasks.ManifestDocument.Merge(List<code>1 subclasses, List</code>1\n  selectedWhitelistAssemblies, Boolean embed)    at\n  Xamarin.Android.Tasks.GenerateJavaStubs.Execute()    at\n  Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()\n  at\n  Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost\n  taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost\n  taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask,\n  Boolean&amp; taskResult) (MSB4018)</p>\n</blockquote>\n"},{"tags":["c#","oop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13265690,"title":"How to know derived class which method is called/executed from the base class","body":"<p>I have a class called <strong>logIT</strong></p>\n\n<pre><code>public class LogIT\n{\n    public string strMessage = string.Empty;\n    public string strClassName = string.Empty;\n    public string strMethodName = string.Empty;\n    public LogIT()\n    {\n        strMethodName = new StackFrame(1).GetMethod().Name;\n        strClassName = new StackFrame(1).GetMethod().DeclaringType.Name;\n    }\n}\n</code></pre>\n\n<p>Another class which inherits the LogIT class named \"<strong>product</strong>\"</p>\n\n<pre><code>public class Product : LogIT\n{\n    public Product()\n    {\n\n    }\n    public void GetProduct()\n    {\n\n    }\n\n    public void AddEditProduct()\n    {\n\n    }\n}\n</code></pre>\n\n<p>THis is my <strong>main</strong> method:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        Product objProduct = new Product();\n        objProduct.GetProduct();\n    }\n</code></pre>\n\n<p>My question is, when i call the <strong>product</strong> class's <strong>GetProduct</strong> method, i want <strong>logit</strong> class constructor to be called and known which method of <strong>dervied</strong> class has been called.</p>\n\n<p>Please suggest how to accomplish it or any other alternative for the same.\nThanks</p>\n"},{"tags":["c#","pwm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":16,"score":-3,"question_id":13266036,"title":"dimming LEDs using Software PWM","body":"<p>I want to let LEDs pulse. After some googeling I found out I have to use pulse width modulation to achieve this.</p>\n\n<p>My board doesn't support hardware pwm. That's why I have to use software pwm. </p>\n\n<p>Can anyone provide me a good link where I can get a sample in C# how to do software pwm and in addition it would be good this sample doesn't use a while(true)-loop because of the CPU usage.</p>\n"},{"tags":["c#",".net","string"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":76,"score":4,"question_id":13246313,"title":"Format a String literal","body":"<p>I want to format a string value by a certain format that the <code>first letter</code> of it be in <code>Uppercase</code>.<br>\ne.g:  </p>\n\n<pre><code>string.Format(\"{0}\", \"myName\"); //Output must be : \"MyName\"\n</code></pre>\n\n<p>How can I do it?</p>\n"}]}
{"total":375450,"page":17,"pagesize":100,"questions":[{"tags":["c#","ef-code-first","one-to-many","entity-framework-5","one-to-one"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13258314,"title":"Both One-To-One and One-To-Many relationships in Entity Framework 5 Code First","body":"<p>i tried the whole day to get this working. I learned a lot about EF's Fluent API (e.g. <a href=\"http://weblogs.asp.net/manavi/archive/2010/12/19/entity-association-mapping-with-code-first-one-to-one-shared-primary-key-associations.aspx\" rel=\"nofollow\">this</a> is an excellent article), however i had no success.</p>\n\n<p>I have three Entities:</p>\n\n<pre><code>public class Address\n{\n   [Key]\n   public virtual int AddressId { get; set; }\n   public virtual string AddressString { get; set; }\n}\npublic class User\n{\n   [Key]\n   public virtual int UserId { get; set; }\n   public virtual ICollection&lt;Address&gt; Addresses { get; set; }\n}\npublic class House\n{\n   [Key]\n   public virtual int HouseId { get; set; }\n   public virtual Address Address { get; set; }\n}\n</code></pre>\n\n<p>and tried all combinations of <code>HasMany, HasOptional, WithOptional, WithOptionalDependent</code> and <code>WithOptionalPrincipial</code> i could think of for both <code>User</code> and <code>House</code> in the </p>\n\n<pre><code>protected override void OnModelCreating(DbModelBuilder modelBuilder)\n</code></pre>\n\n<p>I just cannot get it to work. I think it should be clear, what i want. A User may have more than one address (in the first place i want to force at least one, but now i would be happy if a user may have the addresses optional...) while a House has exactly one Address - and this is required. It would be nice if the address of a house would be cascading deleted.</p>\n"},{"tags":["c#","asp.net","way2sms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1365,"score":0,"question_id":12204551,"title":"Send Sms Using way2sms api in c#","body":"<p>I want to send SMS using way2sms. I have tried following code</p>\n\n<p><strong>login.aspx.cs</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\nnamespace WebApplication1\n{\npublic partial class Login : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void btnconnect_Click(object sender, EventArgs e)\n    {\n        Session[\"id\"] = txtmobileno.Text;\n        Session[\"pw\"] = txtpw.Text;\n        Response.Redirect(\"/send.aspx\");\n    }\n  }\n }\n</code></pre>\n\n<p><strong>send.aspx.cs</strong></p>\n\n<pre><code>using System;\nusing System.Data;\nusing System.Configuration;\nusing System.Collections;\nusing System.Web;\nusing System.Web.Security;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Web.UI.WebControls.WebParts;\nusing System.Web.UI.HtmlControls;\nusing System.IO;\nusing System.Net;\nusing System.Text;\nusing System.Text.RegularExpressions;\n\nnamespace WebApplication1\n{\npublic partial class send : System.Web.UI.Page\n{\n    string mbno, mseg, ckuser, ckpass;\n    private HttpWebRequest req;\n    private CookieContainer cookieCntr;\n    private string strNewValue;\n    public static string responseee;\n    private HttpWebResponse response;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (Session[\"id\"] == null &amp;&amp; Session[\"pw\"] == null)\n        {\n            Server.Transfer(\"login.aspx\");\n        }\n        connect();\n\n        try\n        {\n\n            lblError.Text = \"\";\n            lblError.Visible = false;\n            if (!(IsPostBack))\n            {\n                btnSend.Attributes.Add(\"onclick\", \"return Validate('\" + txtTo.ClientID + \"','\" + txtMessage.ClientID + \"');\");\n                txtMessage.Attributes.Add(\"onchange\", \"TextChange('\" + txtMessage.ClientID + \"','\" + lblLeft.ClientID + \"');\");\n                txtMessage.Attributes.Add(\"onkeyup\", \"TextChange('\" + txtMessage.ClientID + \"','\" + lblLeft.ClientID + \"');\");\n            }\n        }\n        catch (Exception ex)\n        {\n            lblError.Text = ex.Message;\n            lblError.Visible = true;\n        }\n    }\n\n    protected void btnSend_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            mbno = txtTo.Text;\n            mseg = txtMessage.Text;\n\n            sendSms(mbno, mseg);\n            txtTo.Text = \"\";\n            txtMessage.Text = \"\";\n        }\n        catch (Exception ex)\n        {\n            lblError.Text = ex.Message;\n            lblError.Visible = true;\n        }\n    }\n\n    public void connect()\n    {\n        ckuser = Session[\"id\"].ToString();\n        ckpass = Session[\"pw\"].ToString();\n\n        try\n        {\n            this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com/auth.cl\");\n\n            this.req.CookieContainer = new CookieContainer();\n            this.req.AllowAutoRedirect = false;\n            this.req.Method = \"POST\";\n            this.req.ContentType = \"application/x-www-form-urlencoded\";\n            this.strNewValue = \"username=\" + ckuser + \"&amp;password=\" + ckpass;\n            this.req.ContentLength = this.strNewValue.Length;\n            StreamWriter writer = new StreamWriter(this.req.GetRequestStream(), Encoding.ASCII);\n            writer.Write(this.strNewValue);\n            writer.Close();\n            this.response = (HttpWebResponse)this.req.GetResponse();\n            this.cookieCntr = this.req.CookieContainer;\n            this.response.Close();\n            this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com//jsp/InstantSMS.jsp?val=0\");\n            this.req.CookieContainer = this.cookieCntr;\n            this.req.Method = \"GET\";\n            this.response = (HttpWebResponse)this.req.GetResponse();\n            responseee = new StreamReader(this.response.GetResponseStream()).ReadToEnd();\n            int index = Regex.Match(responseee, \"custf\").Index;\n            responseee = responseee.Substring(index, 0x12);\n            responseee = responseee.Replace(\"\\\"\", \"\").Replace(\"&gt;\", \"\").Trim();\n            this.response.Close();\n\n            pnlsend.Visible = true;\n            lblErrormsg.Text = \"connected\";\n        }\n        catch (Exception ex)\n        {\n            lblErrormsg.Text = \"Error connecting to the server...\";\n            Session[\"error\"] = \"Error connecting to the server...\";\n            lblError.Text = ex.ToString();\n\n            lblError.Text= ex.ToString();\n            //Server.Transfer(\"login.aspx\");\n        }\n    }\n    public void sendSms(string mbno, string mseg)\n    {\n        if ((mbno != \"\") &amp;&amp; (mseg != \"\"))\n        {\n            try\n            {\n                this.req = (HttpWebRequest)WebRequest.Create(\"http://wwwd.way2sms.com//FirstServletsms?custid=\");\n                this.req.AllowAutoRedirect = false;\n                this.req.CookieContainer = this.cookieCntr;\n                this.req.Method = \"POST\";\n                this.req.ContentType = \"application/x-www-form-urlencoded\";\n                this.strNewValue = \"custid=undefined&amp;HiddenAction=instantsms&amp;Action=\" + responseee + \"&amp;login=&amp;pass=&amp;MobNo=\" + this.mbno + \"&amp;textArea=\" + this.mseg;\n\n                string msg = this.mseg;\n                string mbeno = this.mbno;\n\n                this.req.ContentLength = this.strNewValue.Length;\n                StreamWriter writer = new StreamWriter(this.req.GetRequestStream(), Encoding.ASCII);\n                writer.Write(this.strNewValue);\n                writer.Close();\n                this.response = (HttpWebResponse)this.req.GetResponse();\n\n                this.response.Close();\n                lblErrormsg.Text = \"Message Sent..... \" + mbeno + \": \" + msg;\n            }\n            catch (Exception)\n            {\n                lblErrormsg.Text = \"Error Sending msg....check your connection...\";\n            }\n        }\n        else\n        {\n            lblErrormsg.Text = \"Mob no or msg missing\";\n        }\n    }\n\n    protected void btnLogOut_Click(object sender, EventArgs e)\n    {\n        Session[\"id\"] = null;\n        Session[\"pw\"] = null;\n        Session[\"error\"] = null;\n        Server.Transfer(\"login.aspx\");\n    }\n\n  }\n}\n</code></pre>\n\n<p>But it doesn't work. Is there any changes in this code that I have to do? \nPlease tell me any other way to <strong>send sms</strong> from desktop application or web application</p>\n"},{"tags":["c#",".net","database","asp.net-membership","membership-provider"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13265957,"title":"Setting Membership provider's database at runtime...?","body":"<p>We're using ASP.Net membership providers (the SQL Server provider), and I want to be able to change only the database name in the class . To do this, I need the ASP.Net membership provider configured so that my installer can use it </p>\n\n<p>i used code as</p>\n\n<pre><code>public class CodeFirstMembershipProvider : SqlMembershipProvider\n    {    \n      public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)  \n      { \n          base.Initialize(name, config);  \n\n          // hard coded for testing  \n          string connectionString = @\"server=localhost;database=masterdb;uid=master;pwd=password\";\n\n          // Set private property of Membership provider.  \n          FieldInfo connectionStringField = GetType().BaseType.GetField(\"_sqlConnectionString\", BindingFlags.Instance | BindingFlags.NonPublic);  \n          if(connectionStringField != null)\n            connectionStringField.SetValue(this, connectionString);  \n      }\n}\n</code></pre>\n\n<p>in above code i need to enter and change the full connection string values..</p>\n\n<p>it too works fine .....</p>\n\n<p>but my query is to change only the database name only of the current connection string mentioned in web.config file..</p>\n\n<p>So is there a way to switch the databse name through an ASP.Net membership through code ?</p>\n"},{"tags":["c#",".net","design-patterns","data-access-layer"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13265445,"title":"Should my DAL return Person or Datatable?","body":"<p><em>After reading <a href=\"http://stackoverflow.com/questions/836621/should-my-dal-return-datatables-or-i-whatever\">this</a>  , I still have a question :</em> </p>\n\n<p>I use this code to query the db : </p>\n\n<p><kbd>c# : </kbd></p>\n\n<pre><code>new BLL().GetPersonById(1)\n</code></pre>\n\n<p><kbd>BLL : </kbd></p>\n\n<pre><code>public Person GetPersonById(int id)\n{\n  return new DAL ().GetPersonById(1);\n}\n</code></pre>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public Person  GetPersonById(int id)\n{\n   // goto db and create instance of Person and fill its data...\n}\n</code></pre>\n\n<p>However , am I doing it wrong , </p>\n\n<p>Should my DAL return <code>DataTable</code> <strong>instead</strong> ?  ( so the BLL will create Person .... ?)</p>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public DataTable  GetPersonById(int id)\n{\n   // goto db ...\n}\n</code></pre>\n\n<p>Thank you.</p>\n\n<p>Edit : </p>\n\n<p>the Person object is defined in <strong>BE</strong> dll ( business entity).</p>\n"},{"tags":["c#","msbuild","culture","stylecop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12514750,"title":"C# + StyleCop + MSBuild + Global culture settings failing to be picked up","body":"<p>I've got my C# project file set up to import a StyleCop.Targets project that runs all the StyleCop rules on build. This is great and I've got the project down to zero errors when compiling through Visual Studio.</p>\n\n<p>However when I compile through MSBuild (on the same machine) I get errors along the line of :</p>\n\n<p><code>The documentation text within the constructor's summary tag must begin with the text: Initializes a new instance of the &lt;see cref=\"MyClass\" /&gt; class.</code></p>\n\n<p>Focus on the 'Z' in initialises... I've configured my Settings.StyleCop with an <strong>en-GB</strong> global setting so that I don't get errors about Americanisms within the code. However I can't fathom out why this causes errors in MSBuild.</p>\n\n<p>I know MSBuild is using the same Settings.StyleCop file as if I change a rule (say TabsMustNotBeUsed) MSBuild (and Visual Studio) picks this change up and throws errors all over the place.</p>\n\n<p>I am using StyleCop 4.7, Visual Studio 2012 and MSBuild 4.</p>\n\n<p>Here is a snippet of my Settings.StyleCop file :</p>\n\n<pre><code>&lt;StyleCopSettings Version=\"105\"&gt;\n  &lt;GlobalSettings&gt;\n    &lt;StringProperty Name=\"Culture\"&gt;en-GB&lt;/StringProperty&gt;\n  &lt;/GlobalSettings&gt;\n  &lt;Parsers&gt;\n    &lt;Parser ParserId=\"StyleCop.CSharp.CsParser\"&gt;\n      &lt;ParserSettings&gt;\n        &lt;BooleanProperty Name=\"AnalyzeDesignerFiles\"&gt;False&lt;/BooleanProperty&gt;\n      &lt;/ParserSettings&gt;\n    &lt;/Parser&gt;\n  &lt;/Parsers&gt;\n  &lt;Analyzers&gt;\n    &lt;Analyzer AnalyzerId=\"StyleCop.CSharp.SpacingRules\"&gt;\n      &lt;Rules&gt;\n        &lt;Rule Name=\"TabsMustNotBeUsed\"&gt;\n          &lt;RuleSettings&gt;\n            &lt;BooleanProperty Name=\"Enabled\"&gt;False&lt;/BooleanProperty&gt;\n          &lt;/RuleSettings&gt;\n        &lt;/Rule&gt;\n      &lt;/Rules&gt;\n      &lt;AnalyzerSettings /&gt;\n    &lt;/Analyzer&gt;\n  &lt;/Analyzers&gt;\n&lt;/StyleCopSettings&gt;\n</code></pre>\n\n<p>Any clues ?</p>\n\n<p>Cheers!</p>\n"},{"tags":["c#",".net","class"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13123061,"title":"Updating GUI components in class B from class A in c#","body":"<p>EDIT: I see I'm getting a lot of downvotes on this post. I've tried to explain what I try to do, where my errors and in which direction want to go. I'm asking for insight in what I'm doing wrong. If you downvote; pleas tell me why, so I can improve the question. Thanks.</p>\n\n<p>I'm creating an application where I have one main form, and several different User Controls which the user works on. This helps me splitting the code, managing the different parts of the program. And it would be easy to expand the application later on.</p>\n\n<p>I'm trying to create a class where I manage the active controls I want to call one function in that class with as argument the form that should become active.</p>\n\n<p>An image can illustrate how I try to setup this application. <img src=\"http://i.stack.imgur.com/Jwimk.png\" alt=\"Illustration\"> Note that the control manager class is not a seperate class in the code i show below, but a partial class of the mainform. Any tips on how to get it like in the image are very welcome :)</p>\n\n<p>The class to manage all active forms looks like this: Please note that all user controls are just a user control with some buttons/textboxes etc on it. No code is added at all yet.</p>\n\n<pre><code>    public partial class STP2Main \n        {\n// I make each UserControl accessable for the whole class\n            SetupDeviceControl.SetupDevice SetupDev = new SetupDeviceControl.SetupDevice();\n            GenConfigFileControl.GenConfigFileControl GenConfFile = new GenConfigFileControl.GenConfigFileControl();\n            Monitoring.MonitoringControl Monitor = new Monitoring.MonitoringControl();\n            GenEncKeyControl.GenEncKeyControl GenEncKey = new GenEncKeyControl.GenEncKeyControl();\n            MenuControl.MenuControl MenuControl = new MenuControl.MenuControl();        \n\n            public void SelectActiveWindow()\n            {\n                // Any active control should be hidden thats what this function does:\n                HideCurrentActiveControl();\n                // Check whether the window is already created\n                if (!WindowExists())\n                { // if not created; create the windows: \n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl: // control 1:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated = true;\n                            SetupDev.Parent = this;\n                            SetupDev.Location = new Point(3, 30);\n                            SetupDev.Show();\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl: //control 2:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            STP_Design.ProgramParameters.C.MonitoringControlIsCreated = true;\n                            Monitor.Parent = this;\n                            Monitor.Location = new Point(3, 125);\n                            Monitor.Show();\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.MenuControl: // control 3\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            STP_Design.ProgramParameters.C.MenuControlIsCreated = true;  \n                            MenuControl.Location = new Point(3, 30);\n                            MenuControl.Parent = this;\n                            MenuControl.Show();\n                            MenuControl.BringToFront();\n                            break;\n                    }\n                }\n                else\n                { // window is already created so needs to be called to front again:\n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            Monitor.Visible = true;\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.AdvancedMenu:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.AdvancedMenu;\n                            tabControl1.Visible = true;\n                            tabControl1.BringToFront();\n                            break;\n\n                        case STP_Data.Data.MenuControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            MenuControl.Visible = true;\n                            MenuControl.BringToFront();\n                            break;\n                    }\n\n                }\n                btnMenu.BringToFront();\n\n            }\n    // some functions which are called above are not shown; not relevant for this question\n    }\n</code></pre>\n\n<p>What I experience is the following: I get no errors at all. But the controls simply not change at all. If I call a window, it is created only once, because I did make it as partial class of my Mainform. (I've tried a complete seperate class, which did result in errors with threading, As I am not an experienced c# programmer, I tried to avoid that using a partial class.)</p>\n\n<p>I'll add another function; which does not do anything at all: </p>\n\n<pre><code>    private void HideCurrentActiveControl()\n    {\n        switch (STP_Design.ProgramParameters.C.CurrentActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                SetupDev.Visible = false;\n                break;\n            case STP_Data.Data.MonitoringControl:\n                tabControl1.Visible = false;\n                Monitor.Visible = false;\n                break;\n            case STP_Data.Data.GenConfFileControl:\n                GenConfFile.Visible = false;\n                break;\n            case STP_Data.Data.GenEncKeyControl:\n                GenEncKey.Visible = false;\n                break;\n            case STP_Data.Data.MenuControl:\n                MenuControl.Visible = false;\n                break;\n            case STP_Data.Data.AdvancedMenu:\n                tabControl1.Visible = false;\n                break;\n            default:\n                tabControl1.Visible = false;\n                break;\n\n        }\n    }\n</code></pre>\n\n<p>I've tried debugging this part of code and it executes the statements, but I see no changes at all.</p>\n\n<p>I think I've shown what I am trying to do; and how I try to do that. My question is: How do I acces those forms so I can manage them from a seperate class (or in this case partial class of the main form).</p>\n\n<p>Then I have this last function, which does some wierd things. Before I call the SelectActiveWindow() function I update the variable STP_Design.ProgramParameters.C.NextActiveControl to for example:  ...AdvancedMenu. (this was before that ...MenuControl) But it does always show that it is still MenuControl. Nowhere in my code is something where I change that value besides right before I start the function. (I've also tried to make the nextcontrol as an argument of the function SelectActiveWindow() but this did the same)</p>\n\n<pre><code>    private bool WindowExists()\n    {\n        switch (STP_Design.ProgramParameters.C.NextActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                if (STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.MonitoringControl:\n                if (STP_Design.ProgramParameters.C.MonitoringControlIsCreated)\n                    return true;\n                else\n                return false;\n            case STP_Data.Data.GenConfFileControl:\n                if (STP_Design.ProgramParameters.C.GenConfFileIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.GenEncKeyControl:\n                if (STP_Design.ProgramParameters.C.GenEncKeyControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.AdvancedMenu:\n                return true;\n            case STP_Data.Data.MenuControl:\n                if (STP_Design.ProgramParameters.C.MenuControlIsCreated)\n                    return true;\n                else\n                    return false;\n\n            default:\n                return false;\n        }\n    }\n</code></pre>\n\n<p>Summery of what I am looking for: \nI am having a main form where display different user controlls in. I am trying to create a seperate class which is accessable from each control/form in my project. This class should manage the controls which are shown. In the code above I illustrated how I tried to do this, but this does not result in the expected result.</p>\n"},{"tags":["c#","wcf"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":424,"score":2,"question_id":11043909,"title":"how to detect WCF service shutdown or disconnect from client?","body":"<p>I'm building a WCF service,after a client connects to this service,when the service disconnect, the client doesn't notice that, and it doesn't fire any action, i would like to close client form whenever the connection lost,so how would i detect WCF service disconnect or shutdown from client side.</p>\n"},{"tags":["c#",".net","winforms","datagridview","editmode"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13261895,"title":"Exit edit mode from a control hosted in a cell","body":"<p>I have a custom datagridviewcolumn, a custom control hosted in a cell. I want to programmatically exit edit mode and validate the current value in the cell (this value is correct). I have checked below ways but without success:</p>\n\n<pre><code>this.datagridview.currentCell.datagridview.endEdit()\nthis.EditingControlDataGridView.endEdit()\nthis.datagridview.endEdit();\n</code></pre>\n\n<p>also by forcing the current cell to change:</p>\n\n<pre><code>this.datagridview.currentCell = this.datagridview.Rows[rowIndex].Cells[columnIndex]\n</code></pre>\n\n<p>I need to programmatically force the commit of the pending value in the cell because for example, there are cases that I need to delete a row of datagridview but as cell (in the same row being deleted) is in edit mode, I cannot do it if I do not commit changes for the cell and exit edit mode before.</p>\n\n<p>Also, I have similar strange behaviour when I want to exit edit mode but, in this case, discarding the changes in the cell: depending on the state of my application, sometimes doing this.datagridview.CancelEdit() works and sometimes not.</p>\n\n<p>Using C#, .NET Framework 4.0, WinForms.</p>\n"},{"tags":["c#",".net","winforms","picturebox","imagelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263608,"title":"populate PictureBox with Images using Foreach loop","body":"<p>In my project I have collection of PictureBoxes and a filled ImageList. I want to populate each pictureBox with the each Image in ImageList using <code>foreach</code> Loop. I know how to do using For loop but I dont know how to do it using foreach loop. I am asking this just for knowledge purpose. I think this can be achieved using Linq inside foreach loop but I am a beginner so I have no Idea how to do it.</p>\n\n<p>I tried the below code in for loop:</p>\n\n<pre><code>        for (intimgcount = 0; intimgcount &lt; intMaxPics; intimgcount++)\n        {                \n            pbxCollection[intimgcount].Image = imglst.Images[intimgcount];          \n        }     \n</code></pre>\n\n<p>the code which  I want to use in <code>foreach</code> loop is:</p>\n\n<pre><code>        var pbxCollection = new List&lt;PictureBox&gt;();  //PictureBox collection\n</code></pre>\n\n<p>EDIT:  How to set the positions of Picture Box collection in the form?</p>\n\n<p>I tried:</p>\n\n<pre><code>        var i = 0;\n        foreach (var pbx in pbxCollection)\n        {\n            pbx.Image = imglst.Images[i++];\n            //set location:\n            pbx.Width = 100;\n            pbx.Height = 100;\n            pbx.Location = new Point(0, pbx.Height * i);\n            //add to form:\n            this.Controls.Add(pbx);\n        }  \n</code></pre>\n"},{"tags":["c#","datetime","time","timezone","nodatime"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":12902043,"title":"Is noda-time applicable in this case?","body":"<p>The project I work on is basically a data collector.  By way of orientation, it may help to think of it as Wireshark (or equivalent) with parsing/analysis capabilities of the Application layer (OSI Layer 7).  The current version is a legacy MFC application with 15+ years under its belt.  It still works, but maintenance, stability, and scalability are real concerns that we are facing.  The project leadership team has recently agreed that we need to begin developing the next generation of the product, and we are targeting .NET as the product is strictly a Windows desktop-based product.</p>\n\n<p>Given that our users routinely analyze log files collected literally around the world, message timestamping is very important.  The current product uses <code>_ftime_s()</code> to assign a timestamp, and I had assumed we would simply use <code>System.DateTime.UtcNow</code> to get timestamps in the future on the .NET side.  That is, until I read about <a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a>.  Now, I'm thinking that our problem domain requires more care concerning time-related functionality than I had ever cared to consider.</p>\n\n<p>So a few questions.</p>\n\n<ol>\n<li><p>From the description I've provided above, does it make sense to incorporate <a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a> using <code>NodaTime.Instant</code> for timestamping?</p></li>\n<li><p>Given a choice, I'd much prefer to pay for dedicated support than use an open-source project for fear (paranoia?) that the project is abandoned.  Any thoughts or guidance on this point from those more inclined to embrace the open-source philosophy?</p></li>\n<li><p><a href=\"http://code.google.com/p/noda-time/\" rel=\"nofollow\">noda-time</a> is currently in its 2nd beta.  Is there a target date for NodaTime 1.0.0?</p></li>\n</ol>\n"},{"tags":["c#",".net","vb.net","richtextbox","rtf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13265762,"title":"How to add a rtf formatting in the text string for a Richt Text Box?","body":"<p>In a .NET project I have a long plain text build as concatenation of several strings</p>\n\n<pre><code>StringLongText = text1 + text2 + ... + textN\n</code></pre>\n\n<p>each string \"textX\" is the result of an evaluation. \nAt the end of a started process, I show the result in a RichTextBox doing simply:</p>\n\n<pre><code>rtfTxt.Text = StringLongText\n</code></pre>\n\n<p>All works fine, but I am not able to add any text formatting in the previous text1, text2, textN blocks.</p>\n\n<p>For example I would like to write some words in bold or italic including the formatting directly in the strings before concatenating them.</p>\n\n<p>Doing</p>\n\n<pre><code>text1 = \"This is some {\\b bold} text\"\nrtfTxt.Text = text1\n</code></pre>\n\n<p>did not work.</p>\n\n<p>Any suggestion? Thank you for your help.</p>\n"},{"tags":["c#","asp.net","jquery-ui","internet-explorer-7"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2479,"score":0,"question_id":405043,"title":"Response.Redirect with # anchor, does not work in IE7","body":"<pre><code>Response.Redirect(string.Format(\"myprofile.aspx?uid={0}&amp;result=saved#main\",user.UserID));\n</code></pre>\n\n<p>said code translates to</p>\n\n<p>IE7 - myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&amp;result=saved</p>\n\n<p>FF- myprofile.aspx?uid=933fdf8e-1be0-4bc2-a269-ac0b01ba4755&amp;result=saved#main</p>\n\n<p>why does IE7 drop my anchor?</p>\n\n<p>edit: I should mention I am using this in conjunction with jQuery UI's tab control.  I want the postback to tab into a specific tab.</p>\n"},{"tags":["c#","ports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13265757,"title":"How do I make sure my packet goes to my router before returning to my pc?","body":"<p>I'm new to socket programming and trying to create a port scanner to check if my router ports are open but I dont know how I can make it go via the router, can someone help please? Here is my code: </p>\n\n<pre><code>int port;\n    IPAddress ipa;\n    private void scanPort()\n    {\n            ipa = IPAddress.Parse(tbIP.Text);\n            for (port = Convert.ToInt32(tbMinPort.Text); port &lt;= Convert.ToInt32(tbEndPort.Text); port++)\n            {\n                listener = new Thread(listening);//create listener\n                listener.Start();\n                try\n                {\n                    sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n                    sock.Connect(ipa, port);\n                    if (sock.Connected == true)  // Port is in use and connection is successful\n                        lboxPortOpen.Invoke(new MethodInvoker(delegate { lboxPortOpen.Items.Add(port.ToString()); lboxPortOpen.SelectedIndex += 1; }));\n                    sock.Close();\n                }\n                catch (SocketException ex)\n                {\n                    if (ex.ErrorCode == 10061)  // Port could not establish connection \n                        lboxPortClosed.Invoke(new MethodInvoker(delegate { lboxPortClosed.Items.Add(port.ToString() + \"*\"); lboxPortClosed.SelectedIndex += 1; }));\n                    else //blocked for a other reason\n                        lboxPortClosed.Invoke(new MethodInvoker(delegate { lboxPortClosed.Items.Add(port.ToString()); lboxPortClosed.SelectedIndex += 1; }));\n                }\n            }\n    }\n    TcpClient client;\n    private void listening()\n    {\n        try\n        {\n            TcpListener server = new TcpListener(ipa, port);\n            server.Start();\n            client = server.AcceptTcpClient();\n            client.Close();\n        }\n        catch (SocketException e)\n        {\n            MessageBox.Show(\"SocketException: \" + e);\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13265704,"title":"Conversion error from database smallint into C# nullable int","body":"<p>I have a security_role_cd column in database of <code>smallint</code> datatype. I am selecting this column using following code into a <code>nullable int</code> variable. </p>\n\n<p>I am getting following error: </p>\n\n<blockquote>\n  <p>Error     3       Type of conditional expression cannot be determined because there is no implicit conversion between 'null' and 'short'        </p>\n</blockquote>\n\n<p>What is the correct code to overcome this error?</p>\n\n<pre><code>SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = 'Admin'\n</code></pre>\n\n<p>C# </p>\n\n<pre><code>        int? roleID = null;\n        string commandText = \"SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = @roleName\";\n        SqlCommand command = new SqlCommand(commandText, connection);\n        command.CommandType = System.Data.CommandType.Text;\n        command.Parameters.AddWithValue(\"@roleName\",roleName);\n        SqlDataReader readerRole = command.ExecuteReader();\n        if (readerRole.HasRows)\n        {\n            while (readerRole.Read())\n            {\n                roleID = readerRole.GetInt16(0) == 0 ? null : readerRole.GetInt16(0) ;\n\n            }\n        }\n        readerRole.Close();\n</code></pre>\n"},{"tags":["c#","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13262949,"title":"Change Cursor when combobox dropdown is open","body":"<p>I want to change the cursor to \"Hand\" when dropdown of a combobox is open.\nSo I did the below on <code>comboBox1_DropDownOpened</code> event. But the problem is cursor changes. But when I move through the menu Items the Cursor is remaining  as a Arrow.</p>\n\n<p>Please advice me.</p>\n\n<pre><code>private void comboBox1_DropDownOpened(object sender, EventArgs e)\n{    \n    this.Cursor = Cursors.Hand;    \n}\n</code></pre>\n"},{"tags":["c#","design","model","resx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13242254,"title":"resx location relative to model classes","body":"<p>What's the recommended strategy for storing resource files that are used by data annotations in a model project? For example by the resourcetype property of the displayattribute.</p>\n\n<p>Should these resource files be stored in the same project as the model classes or contained separately elsewhere? </p>\n\n<p>I am just wondering if they should be stored elsewhere to allow the resource files to be updated without recompiling the model project.</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","svn","ssl"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1031,"score":5,"question_id":8121189,"title":"Ignoring invalid SSL certificate","body":"<p>I`m trying to print out log messages from our sub version. But I'm struggling with bypassing the invalid SSL certificate. This is the error:</p>\n\n<blockquote>\n  <p>OPTIONS of\n  'https://xxxxx/svn/SiteFabrics/trunk/AppLaunch/Bloc/Frontend': Server\n  certificate verification failed: certificate issued for a different\n  hostname, issuer is not trusted (https://xxxx)</p>\n</blockquote>\n\n<p>My attempt of ignoring the certificate error was to add this line:</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>However that didn't make any difference as the .net error is still the same. Below is the code, can anyone see what I am doing wrong?</p>\n\n<pre><code>        using (SvnClient client = new SvnClient())\n        {\n            Collection&lt;SvnLogEventArgs&gt; list;\n            client.Authentication.DefaultCredentials = new NetworkCredential(\"user\", \"pass\");\n\n            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n\n            SvnLogArgs la = new SvnLogArgs(); //{ Start=128; End=132; };\n            client.LoadConfiguration(Path.Combine(Path.GetTempPath(), \"Svn\"), true);\n            client.GetLog(new Uri(\"https://[svnurl]\"), la, out list);\n            ViewBag.SVNLog = list;\n        }\n</code></pre>\n\n<p>FOUND THE SOLUTION TO THIS PROBLEM:</p>\n\n<p>First add this:</p>\n\n<pre><code>        static void SVN_SSL_Override(object sender, SharpSvn.Security.SvnSslServerTrustEventArgs e)\n    {\n        e.AcceptedFailures = e.Failures;\n        e.Save = true;\n    }\n</code></pre>\n\n<p>and then replace my original magic line:</p>\n\n<pre><code>            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>client.Authentication.SslServerTrustHandlers += new EventHandler&lt;SharpSvn.Security.SvnSslServerTrustEventArgs&gt;(SVN_SSL_Override);\n</code></pre>\n"},{"tags":["c#","oop","inheritance"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13265284,"title":"Will a method overriden in a subclass still be called when the object of subclass is called as superclass?","body":"<p>Ok lets say I have two classes with the same method(sampleMethod) which is overridden by the child: ObjectParent and ObjectChild</p>\n\n<pre><code>ObjectChild ExampleVariable = new ObjectChild();\n(ExampleVariable as ObjectParent).sampleMethod();\n</code></pre>\n\n<p>Will this call the sampleMethod from ObjectChild or from ObjectParent??</p>\n\n<p>I think it will call the sampleMethod from ObjectChild, but I want to make sure before I throw down a bunch of code based on that assumption.</p>\n"},{"tags":["c#","jquery",".net","infragistics","ignite-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1282,"score":1,"question_id":734312,"title":"jQuery Modal Example with .Net 2.0 Infragistics Grid","body":"<p>I'm new to jQuery (I must have had my head buried in sand for the last few years!) and I'm wondering if I could use it with an Infragistics grid for updating and inserting instead of the edit row template. We're currently constrained to using the 2.0 framework, and I'm stuck with the infra grids as well.</p>\n\n<ul>\n<li><p>Does anyone know if this is possible?</p></li>\n<li><p>Do you think this is a bad/good idea?</p></li>\n<li><p>Any good sample/walk-throughs out<br />\nthere?</p></li>\n</ul>\n\n<p>Any, and all, advice/opinions appreciated! </p>\n"},{"tags":["c#","wpf","vb.net"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":176,"score":1,"question_id":9263965,"title":"How to calculate font size of TextBlock to fill in Canvas?","body":"<p>What I need is some <strong>formula</strong> to calculate <strong>font size</strong> of <code>TextBlock</code> for its owner -  <code>Canvas</code>.</p>\n\n<p>Let's say I have <code>Canvas</code> height 100.0 then which <strong><code>TextBlock</code> font size</strong> should be to fill all space of the <code>Canvas</code>?</p>\n\n<p><em>P.S. The main problem is that I scroll those TextBlocks horizontally...</em></p>\n"},{"tags":["c#","itunes","com-interop","itunes-sdk"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":218,"score":1,"question_id":6718142,"title":"How can I use iTunesLib in unattended mode?","body":"<p>I'm making a little app to automate my iPod update. My purpose is sync my iTunes library with my actual one and reencode songs in a lower quality for the iPod.</p>\n\n<p>I use the Interop \"iTunesLib\" from iTunes.exe and I'm working on C#.</p>\n\n<p>My program works pretty well but I have a big issue with iTunes. If a modal box is opened by iTunes during the process (could be \"error while importing song\", or just even \"a new update is available\" at iTunes startup...), then my app is completely stuck and must wait for the user to close the popup.</p>\n\n<p>This is annoying because I expected to run my app at night and the process of reimporting/reencoding takes a while.</p>\n\n<p>Is there any way to either tell iTunes to not pop any message, or to ask it to close an already opened one?</p>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":20,"score":-4,"question_id":13265560,"title":"write a string value into a excel sheet using c# with parameterized function","body":"<p>I have to write a set of string values into a excel sheet using function parameters to a particular cell row,col .</p>\n\n<p>Please give inputs   </p>\n"},{"tags":["c#","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13265483,"title":"Height/2 is equal to the maximum font size to fill the height. Is it correct?","body":"<p>I found that half of the text height is same as to the maximum font size to fill the Height.</p>\n\n<pre><code>double fontSize = textHeight/ 2;\n</code></pre>\n\n<p>Is it true?</p>\n"},{"tags":["c#",".net","eval","repeater"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13255146,"title":"Can I manage variables on #Eval inside a repeater?","body":"<p>Tried :</p>\n\n<pre><code>string immagine = (Eval(\"Immagine\").ToString());\n</code></pre>\n\n<p>inside a C# repeater .ascx, but seems that I can't? <em>System.InvalidOperationException: Databinding methods such as Eval(), XPath(), and Bind() can only be used in the context of a databound control.</em></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The only way I found is to write :</p>\n\n<pre><code>&lt;%#(Eval(\"Immagine\").ToString() != Eval(\"Immagine\").ToString() ? \"\" : \"\")%&gt;\n</code></pre>\n\n<p>Dunno why it doesnt works with an if/else statement...</p>\n"},{"tags":["c#","asp.net-mvc","razor","infragistics","ignite-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13121902,"title":"Infragistics grid's GET returning empty response","body":"<p>I'm trying to use Infragistics' grid to display a list of items from my Database. I'm using code-first method with Entity Framework in an MVC application with Razor engine. Every thing is working fine in the view except the Infragistics grid.</p>\n\n<p>Here is my home view:</p>\n\n<pre><code>@using Infragistics.Web.Mvc\n@model IEnumerable&lt;BusinessModel.Models.TestPlan&gt;\n\n@{\n    ViewBag.Title = \"Home\";\n}\n\n@( Html.Infragistics().Grid&lt;BusinessModel.Models.TestPlan&gt;(Model)\n.AutoGenerateColumns(true)\n.DataSourceUrl(Url.Action(\"igListTestPlan\"))\n.DataBind()\n.Render())\n</code></pre>\n\n<p>Here is my controller:</p>\n\n<pre><code>[GridDataSourceAction]\npublic ActionResult igListTestPlan()\n{\n    return View(service.getListTestPlan());\n}\n</code></pre>\n\n<p>Using firebug I can clearly see that the request is sent with a status code \"200 OK\", but the response tab is empty. It also causes an error in the console (in infragistics.js):</p>\n\n<pre><code>Uncaught TypeError: Cannot read property 'length' of undefined \n</code></pre>\n\n<p>I guess it's because of the empty response.</p>\n\n<p><strong>What I tried:</strong></p>\n\n<p>Debugging my controller showed me that <code>return View(service.getListTestPlan());</code> doesn't return an empty list: I have 3 valid items in.</p>\n\n<p>I also tried <code>Html.Infragistics().Grid&lt;BusinessModel.Models.TestPlan&gt;(Model__.ToList())</code> but nothing changed. Also <code>Html.Infragistics().Grid(Model)</code> tells me I've got invalid parameters</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net-mvc-3","stream"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13265392,"title":"The downloaded file as stream in controller (ASP.NET MVC 3) will automatically disposed?","body":"<p>Let's assume the controller which download selected file:</p>\n\n<pre><code> public FileResult Download( string f ) {\n\n         Stream file = MyModel.DownloadFiles( f );\n\n         return File( file, \"application/octet-stream\", (file as FileStream).Name );\n }\n</code></pre>\n\n<p>and <strong>MyModel</strong> contains</p>\n\n<pre><code>public static Stream DownloadFiles(string file){\n\n   return new FileStream(file, FileMode.Open, FileAccess.Read);\n}\n</code></pre>\n\n<p>If I use <code>using</code> keyword in controller then the exception will be thrown: <strong><code>Cannot access closed file</code></strong>.</p>\n\n<p>Well, I want to be sure that downloaded file will be disposed (I don't know if is possible, how to do that) or not ?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","odata","infragistics","ignite-ui"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":504,"score":2,"question_id":8711709,"title":"Mapping $filter from oData parameter to linq Where","body":"<p>I've got (what I think is a odata format) url like this:</p>\n\n<pre><code>http://localhost:2282/SSE.Web/History.cshtml?GetData=true&amp;itemId=AKE-00129&amp;pid=1&amp;%24filter=indexof(ItemType%2C%27Attri%27)+ge+0&amp;%24skip=0&amp;%24top=50&amp;%24inlinecount=allpages&amp;_=1325589443808\n</code></pre>\n\n<p>what is interesting here is the $filter parameter. It has the format \"indexof(ItemType,'Attri') ge 0\"</p>\n\n<p>The source is an grid (iggrid from infragistics) that is filtering on the ItemType column with text 'Attri'</p>\n\n<p>My question is: Mapping the top and skip parameters was trivial, but how to do the filter. Do I need to parse it and build my own linq, or are there some other ways?</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>        var skip = int.Parse(Request[\"$Skip\"]);\n    var top = int.Parse(Request[\"$top\"]);\n    var filter = Request([\"$filter\"]);\n\n    var db = Database.Open(\"SSEConnectionString\");\n\n    var entries = db.Query(\"select * from eHistory order by timestamp desc\")\n    Json.Write(new { results = entries.Where(????).Skip(skip).Take(top), totalRecCount = entries.Count() }, Response.Output);\n</code></pre>\n\n<p>Thanks for any help!</p>\n\n<p>Larsi</p>\n"},{"tags":["c#","qt","tcp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13256775,"title":"How can I compare arrived TCP/IP data in Qt","body":"<p>I’m trying to compare arrived data in TCP-Client with a QString. But I think, it’s a wring format for comparison. My TCP client is written in Qt and TCP server in C#. Here is example code of Qt my read-function: </p>\n\n<pre><code>void MyClient::slotReadyRead()\n{\n    QString okStr = \"OK!\";\n    ui-&gt;textEdit-&gt;append(okStr);\n    ui-&gt;textEdit-&gt;append(\"Reading...\");\n    QString str = socket-&gt;readAll();\n    ui-&gt;textEdit-&gt;append(str);\n    if(str == okStr)\n        ui-&gt;textEdit-&gt;append(\"OK! is true\");\n    else\n        ui-&gt;textEdit-&gt;append(\"OK! is false\");\n}\n</code></pre>\n\n<p>And here is C#-server code for writing commands “OK!”:</p>\n\n<pre><code>private void WriteOutput(Commands cmd)\n{\n    if (NS == null)\n        return;\n\n    string str = Enum.GetName(typeof(Commands), cmd);\n    StreamWriter writer = new StreamWriter(NS);\n    writer.WriteLine(str + \"!\");\n    writer.Flush();\n}\n</code></pre>\n\n<p>In this case cmd would be <strong>„OK“</strong>.In Qt-TCP Client I get following messages:\n<strong>OK!\nReading...\nOK!</strong></p>\n\n<p>OK! is false\nBut I would like to have a <strong>OK! is true</strong> :). Which data-format should I choose?</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265209,"title":"Executing SQL Function Using Linq","body":"<p>I have created a function in MSSQL 2005 and I want to run this function using linq. My function has 2 parameters. The definition is seen below:</p>\n\n<pre><code>USE [MobileGateway]\nGO\n/****** Object:  UserDefinedFunction [dbo].[Fn_GetNoLocationAddress]    Script Date: 11/07/2012 08:27:58 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER FUNCTION [dbo].[Fn_GetNoLocationAddress] \n(   \n    -- Add the parameters for the function here\n    @Site nvarchar(255),\n    @ReceivedDate int\n)\nRETURNS @noLocationAddress TABLE (\n\nRequestID int NOT NULL,\nBarcode varchar(50) NOT NULL,\nAdrID int NOT NULL,\nName varchar(50) NOT NULL,\nStreet varchar(50) NOT NULL,\nHouseNo varchar(4) NOT NULL,\nPostal varchar(8) NOT NULL,\nCity varchar(50) NOT NULL,\nCountry varchar(50) NOT NULL,\nLatitude varchar(50) NOT NULL,\nLongitude varchar(50) NOT NULL,\nReveivedDate datetime NOT NULL\n)\nAS \nBEGIN\n    -- Add the SELECT statement with parameter references here\nINSERT INTO @noLocationAddress \nSELECT     TOP (100) PERCENT Request1.RequestID, TrackIT.dbo.Sending.Barcode, TrackIT.dbo.Address_View.AdrID, TrackIT.dbo.Address_View.Name, \n                      TrackIT.dbo.Address_View.Street, TrackIT.dbo.Address_View.HouseNo, TrackIT.dbo.Address_View.Postal, TrackIT.dbo.Address_View.City, \n                      TrackIT.dbo.Address_View.Country, Request1.Latitude, Request1.Longitude, Request1.ReceivedDate\nFROM         (SELECT DISTINCT RequestID, LTRIM([Content]) AS Barcode, Latitude, Longitude, ReceivedDate\n                       FROM          dbo.RequestWithLocation\n                       WHERE      (Site LIKE @Site) AND ([Content] &lt;&gt; '') AND (AddressID = '0') AND (ReceivedDate &gt; DATEADD(day, -@ReceivedDate, GETDATE()))) AS Request1 INNER JOIN\n                      TrackIT.dbo.Sending ON Request1.Barcode = TrackIT.dbo.Sending.Barcode INNER JOIN\n                      TrackIT.dbo.Address_View ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\n\nORDER BY TrackIT.dbo.Address_View.AdrID\n\nRETURN\n\nEND\n</code></pre>\n\n<p>As you can see I have 2 parameters and I'm returning a table with the information. But I need to use linq for executing the this function.\nCan anyone help? thanks</p>\n"},{"tags":["c#","outlook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":19,"score":-4,"question_id":13265374,"title":"How to retrieve the URL in the email content from Outlook 2010","body":"<p>I try to develop an c# application which will retrieve the URL in the email content from Outlook 2010, means it will auto detect the URL in the email content. Is there any method to do that?</p>\n"},{"tags":["c#","jquery","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13265047,"title":"MVC 4.0 assign model property to j query varibale","body":"<p>Please assist here if its possible or suggest me the other way</p>\n\n<p>C# code is as</p>\n\n<pre><code> public ActionResult Create()\n    {\n        var newCircuit = new CircuitViewModel();\n        newCircuit.Workouts = _db.Workouts.ToList();\n        newCircuit.MemberId = _memberId;\n        return View(newCircuit);\n    }\n</code></pre>\n\n<p>on cshtml page code is as</p>\n\n<pre><code> @Html.DropDownList(\"ddlWorkout\", new SelectList(Model.Workouts, \"Id\", \"Name\"), \"--Select Workout--\", new { required = true, style = \"width:310px\", onchange = \"GetExercise(this)\" })\n</code></pre>\n\n<p>Jquey Code is as:</p>\n\n<pre><code>function GetExercise() {     \n    var Workouts = @Model.Workouts\n    var AllExercises = Workouts[0].Exercises; \n}\n</code></pre>\n\n<p>Basically in model I have workouts and under each workout there are multiple exercises, so when I select workout I want to show all exercises and If I choose another workout then so its relevant exercises, so on...</p>\n\n<p>So basically I want to set @Model.Workouts in jquery Workouts variable. But above jqury code is not working for me. </p>\n"},{"tags":["c#","asp.net","linq","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13261444,"title":"Appending LINQ to exist datasource/gridview in C#","body":"<p>I have the following in my .aspx page:</p>\n\n<pre><code>&lt;asp:GridView ID=\"Table1\" runat=\"server\" AutoGenerateColumns=\"False\"    BorderColor=\"Black\" OnRowCreated=\"Table1_RowCreated\" OnRowDataBound=\"Table1_RowDataBound\" CellPadding=\"3\" CellSpacing=\"0\" DataSourceID=\"Table1DataSrc\" DataKeyNames=\"Field1\"&gt;\n&lt;Columns&gt;\n&lt;asp:BoundField DataField=\"Field1\" HeaderText=\"Field1\" SortExpression=\"Field1\"&gt;\n     &lt;ItemStyle HorizontalAlign=\"Left\" Font-Size=\"8\" Wrap=\"false\" /&gt;\n     &lt;HeaderStyle CssClass=\"header\" Font-Size=\"8\" /&gt;\n &lt;/asp:BoundField&gt;\n &lt;/Columns&gt;\n &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Where the gridview has a DataSource that loads a few fields. In my C# code behind, I have the following function which runs a LINQ query to process a stored procedure (on a different server than my other datasource) </p>\n\n<pre><code>    private void RenderTables()\n    {\n        SqlDataAdapter adapter = new SqlDataAdapter();\n        DataTable dt = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString))\n        {\n            conn.Open();\n            SqlCommand cmd = new SqlCommand(\"sp_special\", conn);\n            cmd.CommandType = System.Data.CommandType.StoredProcedure;\n            cmd.Parameters.AddWithValue(\"@AmIY\", \"Y\");\n            adapter.SelectCommand = cmd;\n            adapter.Fill(dt);\n            adapter.Dispose();\n            conn.Close();\n        }\n        var enumvar = dt.AsEnumerable();\n        var query = from x in enumvar\n                    orderby x.Field&lt;string&gt;(3)\n                    select new \n                    { \n                        Field3 = x.Field&lt;string&gt;(3),\n                        Field4 = x.Field&lt;int&gt;(4),\n                    };\n        //I do some data manipulation using LINQ, but omitted here\n        //do something with query.....\n    }\n</code></pre>\n\n<p>How would I add new columns Field3 and Field4 to my Gridview and bind these new records? I do not want to store anything in temp tables on either servers</p>\n"},{"tags":["c#","sql-server","linq","linq-to-sql","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":13262409,"title":"Why not get the desired output from stored procedure","body":"<p>To fulfill one of my requirements I need to pass a SQL query as a parameter to a stored procedure.</p>\n\n<p>My stored procedure syntax is:</p>\n\n<pre><code>create PROCEDURE spSelect \n    @Query VARCHAR(500)\nAS \n    EXEC( @Query)  \n    return  \n</code></pre>\n\n<p>To execute that stored procedure, I use this C# code:</p>\n\n<pre><code>DataContex db=new DataContex();\n    String sSQL = \" SELECT OrderID,ShipName FROM dbo.Orders\";\n    var result = db.spSelect(sSQL);\n</code></pre>\n\n<p>After execution, the <code>result</code> is <code>0</code>.</p>\n\n<p>Need help to understand what happen, why not I get desired output</p>\n\n<p>If have any query please ask, thanks in advance</p>\n"},{"tags":["c#","asp.net","web-services","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13263674,"title":"Which object will I spend from client to webservices function?","body":"<p>I use AddWebReference in VisualStudio tools.\nIt auto generate Reference.cs class.\nI don't know which object class will I need to pass from web client to webservices function.\nIt's seem use \"out\" parameter at Webservices function.So that,It can't pass a object from client to webservices.</p>\n\n<pre><code>[SoapRpcMethod(\"\", RequestNamespace = \"urn:ALBAPI\", ResponseNamespace = \"urn:ALBAPI\")]\npublic ResponseInfo getAdvSoftware(out AdvSoftwareValues values);\npublic void getAdvSoftwareAsync();\npublic void getAdvSoftwareAsync(object userState);\n\n[Serializable]\n[DesignerCategory(\"code\")]\n[GeneratedCode(\"System.Xml\", \"2.0.50727.4927\")]\n[SoapType(Namespace = \"urn:ALBAPI\")]\n[DebuggerStepThrough]\npublic class AdvSoftwareValues\n{\n    public AdvSoftwareValues();\n\n    [SoapElement(IsNullable = true)]\n    public string configDownloadDate { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string confirmNewConfigIP { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string downloadFilename { get; set; }\n    [SoapElement(IsNullable = true)]\n    public string filename { get; set; }\n}\npublic void call()\n    {\n        string WebserviceUrl = \"http://192.168.2.22:3333/ALBAPI.wsdl\";\n        string serviceName = \"ALBAPI\";\n        string methodName = \"getSetupLicenseRows\";\n        object[] args = new object[1];//-I didn't pass parameter in here.So that,It generate error.Which object will I need pass to webservices function\n        object sSessionID = CallWebService(WebserviceUrl, serviceName, methodName, args);\n        foreach (PropertyInfo property in sSessionID.GetType().GetProperties())\n        {\n            object value = property.GetValue(sSessionID, null);\n\n            Console.WriteLine(\"{0} = {1}\", property.Name, value);\n        }\n    }\n\npublic object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n{\n    System.Net.WebClient client = new System.Net.WebClient();\n    //-Connect To the web service\n    using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n    {\n        //--Now read the WSDL file describing a service.\n        ServiceDescription description = ServiceDescription.Read(stream);\n        ///// LOAD THE DOM /////////\n        //--Initialize a service description importer.\n        ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n        importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n        importer.AddServiceDescription(description, null, null);\n        //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n        //--Generate properties to represent primitive values.\n        importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n        //--Initialize a Code-DOM tree into which we will import the service.\n        CodeNamespace nmspace = new CodeNamespace();\n        CodeCompileUnit unit1 = new CodeCompileUnit();\n        unit1.Namespaces.Add(nmspace);\n        //--Import the service into the Code-DOM tree. This creates proxy code\n        //--that uses the service.\n        ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n        if (warning == 0) //--If zero then we are good to go\n        {\n            //--Generate the proxy code \n            CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n            //--Compile the assembly proxy with the appropriate references\n            string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n            CompilerParameters parms = new CompilerParameters(assemblyReferences);\n            CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n            //-Check For Errors\n            if (results.Errors.Count &gt; 0)\n            {\n                StringBuilder sb = new StringBuilder();\n                foreach (CompilerError oops in results.Errors)\n                {\n                    sb.AppendLine(\"========Compiler error============\");\n                    sb.AppendLine(oops.ErrorText);\n                }\n                throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n            }\n            //--Finally, Invoke the web service method \n            Type foundType = null;\n            Type[] types = results.CompiledAssembly.GetTypes();\n            foreach (Type type in types)\n            {\n                if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                {\n                    Console.WriteLine(type.ToString());\n                    foundType = type;\n                }\n            }\n\n            object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n            MethodInfo mi = wsvcClass.GetType().GetMethod(\"getSetupLicenseRows\");\n            object o = new object();//I didn't pass parameter in here.So that,It generate error.Which object will I need pass to webservices function\n            Line error:o = mi.Invoke(wsvcClass, args);\n        return o;\n    }\n    else\n    {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Thanks for any helping</p>\n"},{"tags":["c#",".net","image","bitmap"],"answer_count":3,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":12176,"score":13,"question_id":946926,"title":"Image vs Bitmap class","body":"<p>As this is my first post, let me introduce myself, I am Kadrin. I'm a developer at a large corporation in the central United States and have been out of college for about 1 year. </p>\n\n<p>Anyway, I've been reading up on my C# a lot lately (my team is slowly moving over to C#) and am having trouble understanding the differences between the <code>Image</code> class and the <code>Bitmap</code> class. Now I know <code>Bitmap</code> inherits the Image class but from what I understand both are very similar. Can anyone shed some light on this please? </p>\n"},{"tags":["c#","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13263818,"title":"RawData is equal null for jpg images","body":"<p>I want to add image to pdf file. I'm using iTextSharp for this.\nI have the following code:</p>\n\n<pre><code>var imageBanner = iTextSharp.text.Image.GetInstance(bannerImagePath);\n</code></pre>\n\n<p>The problem in that the <code>RawData</code> property is equal <code>NULL</code> for <code>jpg</code> images, but for <code>png</code> is all ok.</p>\n"},{"tags":["c#","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":13265053,"title":"Background Worker vs Thread","body":"<p>For long runnings tasks(Asynchronous) in C# 4.0 windows Application.</p>\n\n<p>The choices are:</p>\n\n<ol>\n<li><p>BackgroundWorker (Thread Pool)</p></li>\n<li><p>Thread</p></li>\n</ol>\n\n<p>The above two are recommended for long running tasks(throughout application lifetime). Any other choices? In Additon,</p>\n\n<ul>\n<li><p><strong>BackgroundWorker</strong> - Uses ThreadPool Thread and for long running process with UI updates.</p></li>\n<li><p><strong>Thread</strong> - User defined Thread (Thread Creation overhead etc.) and for long running process (can use priority)</p>\n\n<p>Which would be a best choice </p>\n\n<ol>\n<li><p>if no need for UI update,priority and for Thread (which is created only on application/process start)?</p></li>\n<li><p>if number of tasks increased? (Care of ThreadPool Starvation)</p></li>\n</ol></li>\n</ul>\n\n<p>Any other interesting things?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":358,"score":0,"question_id":7659286,"title":"CRC_CCITT Kermit 16 in C#","body":"<p>I'm currently working on a hard way that requires the CRC_CCITT Kermit 16 protocol with the formula (X16 + X12 + X5 + 1). However some of the code I've found online both on this site or the web in general I don't seem to get my desired result. I saw this website (http://www.lammertbies.nl/comm/info/crc-calculation.html) that actually provides me with the exact match I want but it was written in C++. So can anyone help me with this? </p>\n\n<p>I look forward to hearing from you.</p>\n\n<p>Kind regards</p>\n\n<p>Michael</p>\n"},{"tags":["c#","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":32,"score":-7,"question_id":13265225,"title":"\"Enumeration yielded no results\" in sqldatareader","body":"<p>I getting this error in my application \n\"Enumeration yielded no results\". I don't know how to solve. can any one please help me</p>\n"},{"tags":["c#","wpf","file","process","delete"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13262548,"title":"Delete a file being used by another process","body":"<p>I'm trying to programmically delete a file, but the file is apparently being used by another process (which happens to be my program). Basically, the program loads images from a folder by using FromUri to create a Bitmap, which is then loaded into an Image array, which in turn becomes the child of a stackpanel. Not very efficient, but it works.</p>\n\n<p>I've tried clearing the stackpanel's children, and making the images in the array null, but I'm still getting the IOException telling me that the file is being used by another process.</p>\n\n<p>Is there some other way to remove the file from my application's processes?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13264645,"title":"MVC3 Display the edit view on the same page as the list of items","body":"<p>I have a list of transactions. When I click one of them, I'd like to be able to display the edit form (populated with the selected item's data) to the right of the list. Any ideas?</p>\n\n<p>Below is the partial view that displays the list of transactions.</p>\n\n<pre><code>@model IEnumerable&lt;BudgetPlus.Models.Transaction&gt;\n@{\n    ViewBag.Title = \"Index\";\n}\n&lt;p&gt;\n    @Html.ActionLink(\"Create New\", \"Create\", null, new { @class = \"button-link\" })\n&lt;/p&gt;\n&lt;table&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th class=\"column-Date\"&gt;Date&lt;/th&gt;\n            &lt;th class=\"column-Description\"&gt;Description&lt;/th&gt;\n            &lt;th class=\"column-Category\"&gt;Category&lt;/th&gt;\n            &lt;th class=\"column-Amount\"&gt;Amount&lt;/th&gt;\n            &lt;th class=\"action-button\"&gt;&lt;/th&gt;\n            &lt;th class=\"action-button\"&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        @foreach (var item in Model)\n        {\n            &lt;tr&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Date)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Description)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Category.DisplayName)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.DisplayFor(modelItem =&gt; item.Amount)\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.ActionLink(\"Edit\", \"Edit\", new { id = item.Id })\n                &lt;/td&gt;\n                &lt;td&gt;\n                    @Html.ActionLink(\"Delete\", \"Delete\", new { id = item.Id })\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        }\n    &lt;/tbody&gt;\n&lt;/table&gt;\n&lt;div&gt;\n    @Html.EditorForModel(\"Edit\")\n&lt;/div&gt;\n</code></pre>\n\n<p>And this is what the edit method in my TransactionController looks like.</p>\n\n<pre><code>    public ActionResult Edit(int id)\n    {\n        Transaction transaction = db.Transactions.Find(id);\n        ViewBag.CategoryId = new SelectList(db.Categories, \"Id\", \"DisplayName\", transaction.CategoryId);\n        return View(transaction);\n    }\n</code></pre>\n"},{"tags":["c#","string","encryption","salt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":11182535,"title":"Retrieving salt stored as plaintext alongside ciphertext using C#","body":"<p>I am writing a C# app designed to encrypt text files using Rijndeal (block size 128, key size 256, in other words AES256). I use the user supplied password and a random salt to generate a key using PBKDF2. (The IV is also derived from the password and salt)</p>\n\n<p>I want to store the salt as cleartext prepended to the ciphertext. In other words, line 1 would contain something like <code>&gt;&gt;&gt;SALTGOESHERE</code>. Line 3 and onward would store the ciphertext. </p>\n\n<p>How should I go about retrieving the salt for decryption?</p>\n\n<p>I'm very new to C#, this is my first real app, so please bear with my ignorance. Thanks.</p>\n"},{"tags":["c#","pdf","itextsharp","password-protection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13264688,"title":"Email a existing pdf file with password protection","body":"<p>I have created a pdf using itextsharp. The requirement is that while sending the pdf as attachment in an email, it should be password protected.</p>\n\n<p>I know that we can make a pdf password protected while creating it using itextsharp. </p>\n\n<p>Is there any way to make an existing pdf password protected?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","php","jquery","xml","rss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13262991,"title":"Item section of an rss xml - any unique field","body":"<p>I have a specification not to include the description element in a returned rss items to a mobile device. This is because the client claims the description text is too big for the mobile device to handle. The client is now asking there should be a unique field to identify each item that when sent to my application would retrieve the description for that item section.</p>\n\n<p>My question is which of these elements value can be used to identify the item? I read that the <code>&lt;guid&gt;</code> element is not reliable and is an optional element.</p>\n\n<pre><code>  &lt;item&gt;\n    &lt;title&gt;RSS Tutorial&lt;/title&gt;\n    &lt;link&gt;http://www.w3schools.com/rss&lt;/link&gt;\n    &lt;description&gt;New RSS tutorial on W3Schools&lt;/description&gt;\n    &lt;guid&gt;http://www.w3schools.com/rss/item0768&lt;/guid&gt;\n    ...\n    ...\n  &lt;/item&gt;\n</code></pre>\n\n<p>What I currently have in mind now is assume the items will always have a fixed position [1,2,3,4,5]. items[1] will always be items[1]. So I want to add another element <code>&lt;index&gt;i&lt;/index&gt;</code>. Any suggestion? Thanks.</p>\n\n<p><strong>update</strong></p>\n\n<p>I think I need to focus on the implementation at hand. According to the rss specification, sub-elements in the item element are optional, and so is guid. Now it is present in the rss am working with, and I think I'll use that</p>\n"},{"tags":["c#","asp.net","sql","database","informix"],"answer_count":7,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":9533,"score":11,"question_id":7026566,"title":"Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints","body":"<p>I make an outer join and executed successfully in the <code>informix</code> database but I get the following exception in my code:</p>\n\n<pre><code>DataTable dt = TeachingLoadDAL.GetCoursesWithEvalState(i, bat);\n</code></pre>\n\n<blockquote>\n  <p>Failed to enable constraints. One or more rows contain values\n  violating non-null, unique, or foreign-key constraints.</p>\n</blockquote>\n\n<p>I know the problem, but I don't know how to fix it.</p>\n\n<p>The second table I make the outer join on contains a composite primary key which are null in the previous outer join query.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<pre><code>    SELECT UNIQUE a.crsnum_e,  a.crsnum_e  || '/ ' || a.crstteng crs_name, b.period,\n           b.crscls, c.crsday, c.from_lect, c.to_lect,\n           c.to_lect - c.from_lect + 1 Subtraction, c.lect_kind, e.eval, e.batch_no,\n           e.crsnum, e.lect_code, e.prof_course\n    FROM rg1course a, rg3crsgrp b, ct1table c, ct1tablelect d,\n         OUTER(cc1assiscrseval e)  \n    WHERE a.crsnum = b.crsnum \n    AND b.crsnum = c.crsnum \n    AND b.crscls = c.crscls \n    AND b.batch_no = c.batch_no \n    AND c.serial_key = d.serial_key  \n    AND c.crsnum = e.crsnum  \n    AND c.batch_no = e.batch_no  \n    AND d.lect_code= e.lect_code \n    AND d.lect_code = .... \n    AND b.batch_no = ....\n</code></pre>\n\n<p>The problem happens with the table <code>cc1assiscrseval</code>. The primary key is (batch_no, crsnum, lect_code).</p>\n\n<p>How to fix this problem?</p>\n\n<p>EDIT:</p>\n\n<p>According to @PaulStock advice:\nI do what he said, and i get:</p>\n\n<blockquote>\n  <p>? dt.GetErrors()[0] {System.Data.DataRow} HasErrors: true ItemArray:\n  {object[10]} RowError: \"Column 'eval' does not allow DBNull.Value.\"</p>\n</blockquote>\n\n<p>So I solve my problem by replacing  <code>e.eval</code> to ,<code>NVL (e.eval,'') eval</code>.and this solves my problem.\nThanks a lot.</p>\n"},{"tags":["c#","exchange","ews"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":22,"score":-2,"question_id":13265096,"title":"Get mailbox count from Exchange 2010 using EWS","body":"<p>Can anyone help me to find number of mailboxes in my Exchange Server instance using Exchange Web Service.</p>\n\n<p>Thanks in advance.\nSebastian</p>\n"},{"tags":["c#","asp.net-mvc-3","dapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13254846,"title":"A parameterless default constructor is required to allow for dapper materialization error when reading object with list of child objects","body":"<p>I have this:</p>\n\n<pre><code>public class object_a\n{\n    public int ta_Id { get; set; }\n    public string ta_Label { get; set; }\n    public IEnumerable&lt;table_c&gt; SomeName { get; set; }\n}\n\npublic class table_b\n{\n    public int Id {get;set;}\n    public int SomeId {get;set;}\n    public int FK_A {get;set;}\n}\n\npublic class table_c\n{\n    public int Id {get;set;}\n    public int Max {get;set;}\n    public string Label {get;set;}\n    public int FK_A {get;set;}\n}\n</code></pre>\n\n<p>Using Dapper I retrieve a list of <code>object_a</code> with any number of child objects <code>table_c</code></p>\n\n<pre><code>using (System.Data.SqlClient.SqlConnection sqlConnection = new System.Data.SqlClient.SqlConnection(_con))\n{\n        sqlConnection.Open();\n        var sql = string.Format(\n        @\"\n        select ta.Id as ta_Id, ta.Label as ta_label, splitLimit = '', tc.Id, tc.Max, tc.Label\n        from table_a as ta\n        left join table_b as tb\n        on tb.FK_A = ta.Id\n        left join table_c as tc\n        on tc.FK_A = ta.Id\n        where tb.SomeId = SomeInt);\n\n        var items = sqlConnection.Query&lt;object_a, IEnumerable&lt;table_c&gt;, object_a&gt;(sql, (a, c) =&gt; { a.c = table_c; return a; }, splitOn: \"splitLimit\");\n        return items;\n    }\n</code></pre>\n\n<p>When calling the Dapper code from a controller I get this error:</p>\n\n<blockquote>\n  <p><em>A parameterless default constructor is required to allow for dapper materialization</em></p>\n</blockquote>\n\n<p>I have also tried this:</p>\n\n<pre><code>var items = sqlConnection.Query&lt;object_a,IEnumerable&lt;table_c&gt;, object_a&gt;(sql, (a, c) =&gt; \n{ \n                    if (c!= null) \n                    {\n                        a.SomeName = c;\n                    } \n                    return a; \n\n                }, splitOn: \"splitLimit\");\n</code></pre>\n\n<p>I think it might has something to do with the <code>IEnumerable&lt;table_c&gt;</code> but I don't understand what I am doing wrong here. I have read related questions that SO suggest, but I don't 'get' it.</p>\n\n<p>I would like to know what I am doing wrong and what the correct code is. Thanks!</p>\n"},{"tags":["c#","report","viewer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":10,"score":-3,"question_id":13265034,"title":"Use more data sources in Report Viewer VS2010","body":"<p>how I can Use more data sources in Report Viewer VS2010\"</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11502803,"title":"Gridview not showing records?","body":"<p>I just attached linq data to gridview it is not showing row ?<br></p>\n\n<blockquote>\n<pre><code>    DataDataContext db = new DataDataContext();\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n            BindData();\n    }\n\n    private void BindData()\n    {\n\n        var source = from n in db.Names\n                     select n;\n\n        gridSample.DataSource = source.ToList&lt;Name&gt;();\n        gridSample.DataBind();'\n    }\n\n\n\n\n    &lt;asp:UpdatePanel ID=\"panelGrid\" runat=\"server\"&gt;\n                        &lt;ContentTemplate&gt;\n                            &lt;asp:GridView runat=\"server\" ID=\"gridSample\" AutoGenerateColumns=\"false\"&gt;\n                                &lt;Columns&gt;\n                                    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtFirstName\" runat=\"server\" Text='&lt;%Bind(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblFirstName\" Text='&lt;%Eval(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtLastName\" runat=\"server\" Text='&lt;%Bind(\"LastName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblLastName\" Text='&lt;%Eval(\"LastName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Date of Birth\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtDOB\" runat=\"server\" Text='&lt;%Bind(\"DOB\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblDOB\" Text='&lt;%Eval(\"DOB\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                             &lt;/Columns&gt;\n                   &lt;/asp:GridView&gt;\n           &lt;/ContentTemplate&gt;\n       &lt;/asp:UpdatePanel&gt;\n</code></pre>\n</blockquote>\n"},{"tags":["c#","xaml","microsoft-metro","winrt","share"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13249102,"title":"How to set subject and message part in email with attachment while share charm usage in XAML/C# Windows store app","body":"<p>my app has share charm. It is used to share files and rich text. I have set <code>Title</code> (TextBlock) and <code>Description</code> (RichEditBox) properties and used <code>SetStorageItems()</code> &amp; <code>SetRtf()</code> methods to share files of class <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/br205873.aspx\" rel=\"nofollow\"><code>DataPackage</code></a>, but while using mail app in share charm the <code>Title</code> should be fill as subject and the <code>Description</code> should be set as body of email but it is not working, please help me.</p>\n\n<p>If I use only <code>SetText()</code> then it sets automatically.</p>\n\n<p>PS : Here the <a href=\"http://code.msdn.microsoft.com/windowsapps/Sharing-Content-Source-App-d9bffd84\" rel=\"nofollow\">sample</a> for sharing source content</p>\n"},{"tags":["c#","winforms","create-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13264620,"title":"Inserting Selected Item on Specific Folder [SOLVED]","body":"<p>I have 2 buttons (Button1 - Browse ; Button2 - Upload) and 1 textBox </p>\n\n<p>Here is the scenario. When I click on Browse, it will open a window and will browse for a specific item.\nThe selected item will display on textbox.</p>\n\n<pre><code>private void Browse_Click(object sender, EventArgs e)\n{\n    btnSample.Title = \"Sample File Upload\";\n    btnSample.InitialDirectory = @\"c:\\\";\n    btnSample.Filter = \"TIF|*.tif|JPG|*.jpg|GIF|*.gif|PNG|*.png|BMP|*.bmp|PDF|*.pdf|XLS|*.xls|DOC|*.doc|XLSX|*.xlsx|DOCX|*.docx\";\n    btnSample.FilterIndex = 2;\n    btnSample.RestoreDirectory = true;\n    if (btnSample.ShowDialog() == DialogResult.OK)\n    {\n        textBox1.Text = btnSample.FileName;\n    }\n}\n</code></pre>\n\n<p>When I click on the Upload Button the file on the textbox will be on the created folder.\nI'm done with creating the folder. but my problem is how can i insert the selected file on the folder.</p>\n\n<pre><code>private void button4_Click(object sender, EventArgs e)\n{\n    string path = @\"C:\\SampleFolder\\NewFolder\";\n    if (!Directory.Exists(path))\n    {\n        Directory.CreateDirectory(path);\n        MessageBox.Show(\"Successfully Created New Directory\");\n    }\n    else\n    {\n        MessageBox.Show(\"Filename Exist\");\n    }\n}\n</code></pre>\n"},{"tags":["c#","setup-deployment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13264232,"title":"Antivirus prevents setup program from running","body":"<p>Hi all: <br />I'm working on a visual Studio setup program. The problem is that the antivirus (AVG) reports that I don't have enough permissions to run the setup program. When I disable the antivirus, the setup works fine. My setup does't modify the registry and it is so simple. It just installs a program in the program files(x86). I log in to my computer as administrator and I run the setup as administrator too. <br />Could anyone point out how I can bypass the antivirus?<br />\nThanks</p>\n"},{"tags":["c#","quartz.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":610,"score":2,"question_id":5114698,"title":"Setting a Quartz.NET trigger to fire on a specific object instance","body":"<p>How can I get Quartz to fire a trigger on an already created &amp; initialized object?</p>\n\n<p>e.g.</p>\n\n<pre><code>public class Foo : IJob\n{\n    public Foo ( configuration items ... ) { }\n}\n\n// Calling Code...\nFoo f = new Foo( /*Non empty constructor*/ );\nSchedular sched = new SchedulerFactory().GetScheduler();\nJobDetail jD = new JobDetail(\"fooDetail\", null typeof(Foo));\nTrigger trig = TriggerUtils.MakeSecondlyTrigger(15);\nsched.ScheduleJob( jD, trig );\nsched.Start();\n</code></pre>\n\n<p>As foo doesn't have a 0 args constructor Quartz.NET is having issues instantiating the Job and running it. Is there any way I can get Quartz to trigger the instance of Foo, f?</p>\n\n<p>Please forgive me if I'm missing a fundamental fact about Quartz and its usage.</p>\n"},{"tags":["c#","winforms","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13264150,"title":"How do I change color of cell which have greater than zero value in datagrid","body":"<p><code>enter code here</code><p> i have two cell in grid i want to chage one cell color and value by zero when i entered in other cell greater then zero value </p></p>\n\n<pre><code>    private void grdDetail_CellBeginEdit(object sender, DataGridViewCellCancelEventArgs e)\n        { \n            if (this.IsLoadComplete) \n              { \n                UpdateValueofQtyCell(e.ColumnIndex); \n              } \n       }\n  private void UpdateValueofQtyCell(int index)\n        {\n            int cur_row = grdDetail.CurrentRow.Index;\n\n            if (index == 1)\n            {\n                grdDetail[1, cur_row].Style.BackColor = Color.White;\n                grdDetail[2, cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[2, cur_row].Value = 0;\n            }\n           else  if (index == 1)\n            {\n                grdDetail[2, cur_row].Style.BackColor = Color.White;\n                grdDetail[1 cur_row].Style.BackColor = Color.FromArgb(224, 224, 224);\n                grdDetail[1, cur_row].Value = 0;\n             }\n        }\n</code></pre>\n"},{"tags":["c#","serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13264754,"title":"How to get File Name when Exception in Serialization Constructor Occures?","body":"<p>I do serialization via a serialization constructor like this:</p>\n\n<pre><code>private MyClass(SerializationInfo info, StreamingContext c)\n{\n   try\n   {\n      MyIntVar = info.GetInt32(\"MyIntVar\");\n   }\n   catch(Exception)\n   {\n      Trace.WriteLine(\"Exception occured! Setting default value.\");\n      MyIntVar = 4711;\n   }\n}\n</code></pre>\n\n<p>What I'm now trying to achieve is to trace the name and path of the file that is beeing serialized when this exception occures.</p>\n\n<p>Something like:</p>\n\n<pre><code>if( c is file)\n{\n   Trace.WriteLine(\"Don't bother, I proceed anyway, but maybe you should repair the file \" + FilePath);\n}\n</code></pre>\n\n<p>So I have two questions concerning this:</p>\n\n<ol>\n<li>How can I determine that the current serialization context is a file?</li>\n<li>How can I get the corresponding file name and path of this file?</li>\n</ol>\n"},{"tags":["c#","sql","ms-access","exception-handling","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13264491,"title":"Syntax error in FROM clause on DataAdapter.Fill()","body":"<p>I am having a problem with my codes, not knowing whats the issue. Can anyone advise?</p>\n\n<p>The whole program is for a biometric program. This is just the login User controller. How can i solve this problem?</p>\n\n<p>I am facing this problem in the line: </p>\n\n<pre><code>dbAdapter.Fill(uds);\n</code></pre>\n\n<p>Stating:</p>\n\n<blockquote>\n  <p>OleDbException was unhandled:Syntax error in FROM clause. </p>\n</blockquote>\n\n<p>My codes are below: \n<strong>USER CONTROLLER</strong> </p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\n    class UserController\n    {\n        User[] user;\n        User searchUser;\n        DataRowCollection rows;\n        DataSet uds;\n        OleDbDataAdapter dbAdapter;\n        DataTable userTable;\n\n        //A kind of gobal var to share in project\n        public static string uNameExist;\n        public static string passwordExist;\n        public static string roleExist;\n\n        public UserController(){\n\n        // Set up Connection String\n        OleDbConnection dbConn = new  OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n        // Setup SQL select statement\n        string sqlStatement = \"Select * from User\";\n\n        // Setup DBAdapter (Scientist Table)\n\n        dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n        OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n        // Create a Data Set to hold data from DB\n        uds = new DataSet();\n\n        // fill ds with data from DB\n        dbAdapter.Fill(uds);\n\n        // get contacts table\n        DataTable userTab = uds.Tables[0];\n\n        // get all rows\n        rows = userTab.Rows;\n        }\n\n        public User[] GetAllUsers()\n        {\n            DataRow row;\n\n            user = new User[rows.Count];\n\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                row = rows[i];\n                user[i] = new User();\n                user[i].SetId((Int32)row[\"ID\"]);\n                user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n                user[i].SetUsername((string)row[\"Username\"]);\n                user[i].SetFName((string)row[\"FName\"]);\n                user[i].SetLName((string)row[\"LName\"]);\n                user[i].SetPassword((string)row[\"Password\"]);\n                user[i].SetEmail((string)row[\"Email\"]);\n                user[i].SetContact((Int32)row[\"Contact\"]);\n                user[i].SetRole((string)row[\"Roles\"]);\n            }\n            return user;\n        }\n\n        public User SearchUser(string uname)\n        {\n            searchUser = new User();\n\n            //get all rows from DB\n            GetAllUsers();\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                if (user[i].GetUsername() == uname)\n                {\n                    searchUser.SetId(user[i].GetId());\n                    searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                    searchUser.SetUsername(user[i].GetUsername());\n                    searchUser.SetFName(user[i].GetFName());\n                    searchUser.SetLName(user[i].GetLName());\n                    searchUser.SetPassword(user[i].GetPassword());\n                    searchUser.SetEmail(user[i].GetEmail());\n                    searchUser.SetContact(user[i].GetContact());\n                    searchUser.SetRole(user[i].GetRole());\n                }\n            }\n            return searchUser;\n        }\n\n        public User SearchUserName(string userName)\n        {\n        User searchUserName = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get UserName to store in this container\n            string checkUname = user[i].GetUsername();\n            if (checkUname == userName)\n            {\n                uNameExist = \"Exists\";\n                roleExist = user[i].GetRole();\n            }\n        }\n        return searchUserName;\n        }\n\n        // Search password for Login function\n        public User SearchPassword(string password)\n        {\n        User searchPassword = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get password to store in this container\n\n            string checkPassword = user[i].GetPassword();\n            if (checkPassword == password)\n            {\n                passwordExist = \"Exists\";\n            }\n        }\n        return searchPassword;\n    }\n        public static string GetSHA512(string text)\n        {\n            UnicodeEncoding UE = new UnicodeEncoding();\n            byte[] hashValue;\n            byte[] message = UE.GetBytes(text);\n\n            SHA512Managed hashString = new SHA512Managed();\n            string hex = \"\";\n\n            hashValue = hashString.ComputeHash(message);\n            foreach (byte x in hashValue)\n            {\n                hex += String.Format(\"{0:x2}\", x);\n            }\n            return hex;\n        }\n    }\n}\n</code></pre>\n\n<p>This is my login page form: With the following codes. Whenever i click login, the errors come up. Whats wrong with my codes?</p>\n\n<p>My codes are below:<strong>LOGIN PAGE FORM</strong></p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\npublic partial class Login : Form\n{\n    //A kind of gobal var to share in project\n    public static string fixedUName;\n\n    public Login()\n    {\n        InitializeComponent();\n    }\n\n    private void LoginClearButton_Click(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Clear();\n        LoginPasswordTextBox.Clear();\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void Login_Load(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void LoginButton_Click(object sender, EventArgs e)\n    {\n\n        string userName = this.LoginUsernameTextBox.Text;\n        MessageBox.Show(\"Codes Stops Here\");\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();      \n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(UserController.GetSHA512(passwd));\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n\n    private void LoginUsernameTextBox_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["c#","pdf","itextsharp"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":259,"score":4,"question_id":13027074,"title":"How to insert files into folders of an existing PDF portfolio with folders using iTextsharp","body":"<p>Using the answers in <a href=\"http://stackoverflow.com/questions/9833572/how-to-merge-pdf-using-itextsharp-into-a-pdf-portfolio\">How to merge PDF using itextsharp; into a PDF Portfolio?</a>, I've been able to create an PDF portfolio using iTextSharp. However, using Adobe Acrobat I'm able to create folders, and I'm able to put files in those folders.</p>\n\n<p>How do I create folders and how do I put files in those folders in a PDF portfolio using iTextSharp?</p>\n\n<p>I've tried using a pdf inspector program to see the differences between a portfolio with and without folders, but I haven't been able to see any. I guess I'm looking in the wrong places</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For this specific use case of mine it is actually possible to create the PDF portfolio with folder up front. So it's way more important to be able to insert files in folders in an existing PDF portfolio as opposed to actually creating the folders themselves.</p>\n"},{"tags":["c#","winforms","datagridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263288,"title":"Unchecking the user checked checkbox in the datagridview cell","body":"<p>I have a column in my <code>DataGridView</code> which has the <code>DataGridViewCheckBoxColumn</code> as column template. When user checks the checkbox, I need to uncheck it programmatically if it fails some conditions. I have done this, but this uncheck logic only takes effect after I change the focus from the cell manually. I tried changing the focus programmatically but didn't work. Is there any solution for this?</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13263646,"title":"Menu in child process inside a tab not shown on mouse click","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. When i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["c#","nunit","resharper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13264573,"title":"nunit agent hangs even after using .NET 4.0 in config file","body":"<p>I am facing issues with nunit.</p>\n\n<p>When I run unit tests and close the nunit application, the application closes with significant delay and nunit86.exe process remains in memory. I need to kill it to build the code again with changes.</p>\n\n<p>I face the same issue when I run the unit test cases with ReSharper. </p>\n\n<p>After searching on web, I came across <a href=\"http://stackoverflow.com/questions/4303421/nunit-2-5-8-lots-of-nunit-agent-exe\">this</a> and <a href=\"https://bugs.launchpad.net/nunitv2/+bug/602761\" rel=\"nofollow\">this</a> solution.</p>\n\n<p>I made the required changes in config file and found that the application closes promptly but a pop up comes saying \"Nunit agent stopped working\". I had to close it each time.</p>\n\n<p>It is really painful as we are also using nunit on CC.NET.</p>\n\n<p>Any solution for this will be appreciated.</p>\n\n<p>I have used following version's of Nunit but no success</p>\n\n<ol>\n<li>NUnit 2.5.5</li>\n<li>NUnit 2.5.9</li>\n<li>NUnit 2.5.10</li>\n<li>NUnit 2.6.2</li>\n</ol>\n\n<p>I tried it using following version's of Nunit.</p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13264463,"title":"Suspend camera when user switches away from app, and resume camera when user switches back to app","body":"<p>Currently, I would like to suspend my camera when user switches away from my app, and resume camera when user switches back to app</p>\n\n<p>I am referring to <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx#app_suspend\" rel=\"nofollow\">Application lifecycle (Windows Store apps) (Windows)</a></p>\n\n<p>However, <strong>Suspending | suspending event</strong> isn't being triggered immediately once the user switches away from my app. You need to wait for few seconds (Or it will not trigger at all if OS decides not to do so).</p>\n\n<p>So, how I can know, when I should run my camera suspension code when user switches away from my app.</p>\n\n<p>If I referring to <a href=\"http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622\" rel=\"nofollow\">Media capture using capture device sample</a>, they are using</p>\n\n<p><code>Windows.Media.MediaControl.SoundLevelChanged += m_soundLevelHandler;</code></p>\n\n<p>They run camera suspension code when there is a sound level changes? But this is also not what I want. As detecting <code>SoundLevelChanged</code> event, is not able to let me know, whether user is <strong>switching away from my app</strong>, or <strong>switching back to my app</strong>. <code>SoundLevelChanged</code> event will be triggered in both scenarios.</p>\n"},{"tags":["c#","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13264190,"title":"Restrict all the special characters through a regex","body":"<p>There is a long set of characters that are not allowed to validate an input box of winform app.</p>\n\n<p>So i figured that rather than making the long list that are not allowed make the shorter one that are allowed.</p>\n\n<p>The set that is allowed are <code>(a-z,A-Z, 0-9,@,.)</code> .Rest every thing that can be entered are not allowed.</p>\n\n<p>This is the regex that i have made for this.</p>\n\n<pre><code>Regex.IsMatch(textBox1.Text, @\"[@\\.\\w]+$\")\n</code></pre>\n\n<p>It seem to work in some cases but when i enter the data in this format <code>normal character or number special character normal character or number</code> it seems to break few example <code>ee(vv, 55)44,aba&amp;3B</code>. </p>\n\n<p>Not able to figure out whats wrong in this.</p>\n"},{"tags":["c#","arrays","variables"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":6,"view_count":118,"score":-1,"question_id":13256433,"title":"C# array of variables","body":"<p>Is it possible to do something like this:</p>\n\n<pre><code>string A = \"A\";\nstring B = \"B\";\n\nobject[] O = { A, B };\nO[0] = \"C\";\n</code></pre>\n\n<p>Where <code>A</code> will hold the value <code>\"C\"</code> in the end?</p>\n\n<p>The code above will replace <code>O[0]</code> with <code>\"C\"</code>, but <code>A</code> remains unchanged.</p>\n"},{"tags":["c#","asp.net","excel","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13259420,"title":"Export GridView into Excel","body":"<p>I'm trying to export my GridView into a 2010 Excel file <code>.xlsx</code> format.  It works with an <code>.xls</code> I was wondering if anyone could help me out.  Here is what I have so far:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n        Response.Clear();\n        Response.Buffer = true;\n        Response.AddHeader(\"content-disposition\",\n        \"attachment;filename=GridViewExport.xls\");\n        Response.Charset = \"\";\n        Response.ContentType = \"application/vnd.xls\";\n        StringWriter sw = new StringWriter();\n        HtmlTextWriter hw = new HtmlTextWriter(sw);\n        GridView1.AllowPaging = false;\n        GridView1.DataBind();\n\n        GridView1.HeaderRow.Style.Add(\"background-color\", \"#FFFFFF\");\n\n        GridView1.HeaderRow.Cells[0].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[1].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[2].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[3].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[4].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[5].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[6].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[7].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[8].Style.Add(\"background-color\", \"#D1EEEE\");\n        for (int i = 0; i &lt; GridView1.Rows.Count; i++)\n        {\n\n            GridViewRow row = GridView1.Rows[i];\n            row.BackColor = System.Drawing.Color.White;\n            row.Attributes.Add(\"class\", \"textmode\");\n            if (i % 2 != 0)\n            {\n\n                row.Cells[0].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[1].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[2].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[3].Style.Add(\"background-color\", \"#FFFFFF\");\n\n            }\n        }\n        GridView1.RenderControl(hw);\n        string style = @\"&lt;style&gt; .textmode { mso-number-format:\\@; } &lt;/style&gt;\";\n        Response.Write(style);\n        Response.Output.Write(sw.ToString());\n        Response.Flush();\n        Response.End();\n\n    }\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","extension-methods","timeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13235110,"title":"TimelineJS in C# Mvc","body":"<p>How to add TimelineJS (<a href=\"http://timeline.verite.co/\" rel=\"nofollow\">http://timeline.verite.co/</a>) to your website with C# Mvc.\nIf you want to view a complete project, visit <a href=\"http://www.m33.se/timelinejs.html\" rel=\"nofollow\">http://www.m33.se/timelinejs.html</a>.\nI know there's several peoples that wonder how to get the TimelineJs to be displayed.\nI've created some helper classes that makes it easy to extend from your original class.</p>\n\n<p>What I'm doing right now is to extend the TimlineJS javascript file with an extension that will set the current slide from (or nearest) from today's date.</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Helpers for the Timeline classes to return Json objects\n/// &lt;/summary&gt;\npublic class date\n{\n    public string startDate { get; set; }\n    public string endDate { get; set; }\n    public string headline { get; set; }\n    public string text { get; set; }\n}\n\n\npublic class timeline\n{\n    public string headline { get; set; }\n    public string text { get; set; }\n    public string type { get; set; }\n    public string lang { get; set; }\n    public List&lt;date&gt; date { get; set; }\n    public string font { get; set; }\n}\n\n\npublic class Wrapper\n{\n    public timeline timeline { get; set; }\n}\n\npublic static class Ext\n{\n    public static string Quote(this string text)\n    {\n        return string.Format(\"\\\"{0}\\\"\", text);\n    }\n\n    public static string Embed(this string text)\n    {\n        if ((!text.Contains(\"&lt;p&gt;\")) &amp;&amp; (!text.Contains(\"&lt;/p&gt;\")))\n            return string.Format(\"&lt;p&gt;{0}&lt;/p&gt;\", text);\n        return text;\n    }\n}   \n\n public JsonResult GetTimelineJs(Int32 ? pageid)\n    {\n        //Create your own list from your datasource below.\n        var tm = ActiveRecordMediator&lt;Timeline&gt;.FindFirst(Restrictions.Eq(\"PageId\", pageid));\n\n        var events = new List&lt;date&gt;();\n        var datelist = tm.GetItems();\n\n        foreach (var item in datelist) {\n            if (!item.Active) continue;\n\n            events.Add( new date {  \n                headline = item.Title, \n                text = item.Html.Embed(),   \n                startDate = new DateTime(item.EventDate.Year, item.EventDate.Month, item.EventDate.Day, item.EventDate.Hour, item.EventDate.Minute, item.EventDate.Second).ToShortDateString().Replace(\"-\", \",\"), \n                endDate = new DateTime(item.EndEventDate.Year, item.EndEventDate.Month, item.EndEventDate.Day, item.EndEventDate.Hour, item.EndEventDate.Minute, item.EventDate.Second).ToShortDateString().Replace(\"-\", \",\") }\n            );\n        }\n        //The wrapper class just surrounds the timline object.\n        var wrapper = new Wrapper\n        {\n            timeline = new timeline()\n            {\n                headline = tm.Title,\n                text = tm.Html.Embed(),\n                type = \"default\",\n                lang = \"sv\",\n                font = \"Arvo &amp; PT Sans\",\n                date = events\n            }\n        };\n\n         string json2 = JsonConvert.SerializeObject(wrapper, Formatting.Indented);\n         var dez = JsonConvert.DeserializeObject&lt;Wrapper&gt;(json2);\n\n         return Json(dez, JsonRequestBehavior.AllowGet);\n    }\n\n//This produces a timline data (Json).\n\n{\"timeline\":\n{\n\"headline\":\"Headline text\",\n\"text\":\"\\u003cp\\u003eThis is some markup text\\u003c/p\\u003e\",\n\"type\":\"default\",\n\"lang\":\"sv\",\n\"date\":[\n    {\"startDate\":\"2012,08,10\",\"endDate\":\"2012,08,15\",\"headline\":\"Love at First Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text one\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,09,09\",\"endDate\":\"2012,09,09\",\"headline\":\"Love at Second Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,10,10\",\"endDate\":\"2012,10,10\",\"headline\":\"Love at third Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,11,10\",\"endDate\":\"2012,11,12\",\"headline\":\"Love at fourth Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"},\n    {\"startDate\":\"2012,12,10\",\"endDate\":\"2012,12,15\",\"headline\":\"Love at Fifth Feel\",\"text\":\"\\u003cp\\u003eThis is some markup text two\\u003c/p\\u003e\"}],\n\"font\":\"Arvo \\u0026 PT Sans\"}\n}\n</code></pre>\n\n<p>IMPORTANT!! \nI noticed that is Timeline.js there's this line(about line 7000):</p>\n\n<pre><code>VMM.getJSON(raw_data + \"?callback=onJSONP_Data\", VMM.Timeline.DataObj.parseJSON);\n</code></pre>\n\n<p>If you send any other data to your controller it will break and not function.\nTo allow other parameters, just change to the line below:</p>\n\n<pre><code>VMM.getJSON(raw_data + \"&amp;callback=onJSONP_Data\", VMM.Timeline.DataObj.parseJSON);\n</code></pre>\n\n<p><strong>I'm not sure that this always will return the closest date. Can anyone verify this?</strong></p>\n\n<pre><code>    public Int32 GetClosestDate(Int32 pageid)\n    {\n        var tm = ActiveRecordMediator&lt;Timeline&gt;.FindFirst(Restrictions.Eq(\"PageId\", pageid));\n        List&lt;CDate&gt; datelist = new List&lt;CDate&gt;();\n        DateTime today = DateTime.Now;\n\n        int slide = 1;\n        foreach (var item in tm.GetItems().OrderBy(d =&gt; d.Id))\n        {\n            datelist.Add(new CDate { Date = DateTime.ParseExact(item.EventDate.ToShortDateString(), \"yyyy-mm-dd\", null), Slide = slide, Diff = DateDiff(today, item.EventDate) });\n            slide++;\n        }\n\n        var closest = datelist.OrderBy(d =&gt; d.Diff).First();\n        return closest.Slide;\n    }\n\n private int DateDiff(DateTime Date1, DateTime Date2)\n    {\n        TimeSpan time = Date1 - Date2;\n        return Math.Abs(time.Days);\n    }\n</code></pre>\n"},{"tags":["c#","version-control","github","changes"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13263774,"title":"How to discard Git changes between files","body":"<p>I have a repository cloned from GitHub, and I made changes to file A, however Git is detecting\nchanges to file B,C and D. All three files are detecting the changes as basically the entire contents of B,C,D. i.e. +all lines in B,C,D, -all lines in B,C,D.</p>\n\n<p>I don't want to commit this as it makes for a dirty commit. Why is git detecting these changes and how to I get git to ignore these changes forever?</p>\n\n<p>The project is in C#, I use the GitHub windows application and the IDE is VS Express 2012.</p>\n\n<p><strong>Edit:</strong>\nI realize the files have changed, but is there a way to a) find out what changed and b) tell git to ignore them and not pick them up again between commits. It seems my editor is modifying files B,C,D in some way after I first openened the cloned project.</p>\n\n<p>Even after running a git reset --hard, git diff still reports the changes.</p>\n"},{"tags":["c#","syntax","tags","formating","human-readable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13263867,"title":"C# human readable formating of a special syntax","body":"<p>Hi all i kinda need some help at creating a function for turning a plain syntax in human readable format:</p>\n\n<p>Syntax looks like this:</p>\n\n<pre><code>[OPENTAG]\n(type)name:value\n[OPENTAG]\n(type)name:value\n(type)name:value\n(type)name:value\n[/CLOSETAG]\n[/CLOSETAG]\n</code></pre>\n\n<p>Would like to turn this into this:</p>\n\n<pre>\n\n    [OPENTAG]\n         (type)name:value\n         [OPENTAG]\n             (type)name:value\n             (type)name:value\n             (type)name:value\n         [/CLOSETAG]\n    [/CLOSETAG]\n\n</pre>\n\n<pre><code>    private string textFormater(string input)\n    {\n        string[] lines = Regex.Split(input, \"\\r\\n\");\n        int tabs = 0;\n        string newtext = \"\";\n        foreach (string line in lines)\n        {\n\n            Match m = Regex.Match(line, \"\\\\[.*\\\\]\");\n            bool isTop;\n            bool isTopClose = false;\n            string tabtext = \"\";\n\n            if (m.Success)\n            {\n                if (line.Contains(\"/\"))\n                {\n                    tabs--;\n                    isTopClose = true;\n                }\n                else\n                {\n                    tabs++;\n                }\n                isTop = true;\n            }\n            else\n            {\n                isTop = false;\n            }\n\n            if (isTop &amp;&amp; !isTopClose &amp;&amp; tabs == 1)\n            {\n                newtext += line;\n            }\n            else if (isTop &amp;&amp; !isTopClose)\n            {\n                for (int i = 1; i &lt;= tabs - 1; i++)\n                {\n                    tabtext += \"\\t\";\n                }\n                newtext += \"\\r\\n\" + tabtext + line;\n            }\n            else\n            {\n                for (int i = 1; i &lt;= tabs; i++)\n                {\n                    tabtext += \"\\t\";\n                }\n                newtext += \"\\r\\n\" + tabtext + line;\n            }\n\n        }\n        return newtext;\n    }\n</code></pre>\n\n<p>I have atm a solution but the code is so messy and slow, in a 2mb file it takes ages :)\nThanks for your help!</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","api","rest","permissions","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13262302,"title":"Amazon S3 file storage via Rest API in C# with roles","body":"<p>I'm building a project that will use Amazon S3 to store documents. In particular there are two apps:</p>\n\n<ul>\n<li>A public facing app will allow users to create and upload documents</li>\n<li>An admin app where you can view documents available and download them</li>\n</ul>\n\n<p>...so the public app should only have 'write' permission, and the admin tool 'read' and 'list' permissions.</p>\n\n<p>The coding for this project will be done with ASP.NET and C#, and the preference is to use S3's REST API. This use case (uploading, listing and downloading documents) seems pretty basic, but I haven't had much luck finding simple examples. Can some you suggest some links?</p>\n"},{"tags":["c#","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13261991,"title":"Get last index of character with LINQ to Entities","body":"<p>I'm getting the error:</p>\n\n<pre><code>LINQ to Entities does not recognize the method 'Int32 LastIndexOf(System.String)' \nmethod, and this method cannot be translated into a store expression.\n</code></pre>\n\n<p>When using this code to tell if a person's last name starts with certain characters:</p>\n\n<pre><code>persons = persons.Where(c =&gt; c.FullName.IndexOf(\" \") &gt; 0 &amp;&amp;\nc.FullName.Substring(c.FullName.LastIndexOf(\" \")+1).StartsWith(lastNameSearch));\n</code></pre>\n\n<p>Any clue how to achieve this without using LastIndexOf()? Maybe I have to check for this after I grab results from the database using ToList()?</p>\n"},{"tags":["c#","json","json.net","deserialization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13263931,"title":"Convert JSON String to List of Dynamic Objects in C#","body":"<p>Ive got a JSON string im sending from my web client to my webapi. This JSON string kind of dynamically formed.</p>\n\n<p>So I want to know if there is a way if I can convert this JSON string into a list/array of dynamic objects. So can handle it along the same line as:</p>\n\n<pre><code>var DynamicArray = WhatEverJSONConvertor(JSONString);\n\nfor (int i = 0; i &lt; DynamicArray.length; i++)\n{\n      Console.WriteLine(DynamicArray[i].AFieldInTheObject);\n}\n</code></pre>\n\n<p>Is this possible? What JSON convertor would I use this to accomplish this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13264149,"title":"Dll changes or not if i do change in my web.config file","body":"<p>I have UPDATED my web.config code , now i have to send patch for the changed code to be deployed on the production.\nI am not sure that .dll file should be send along with web.config file or not?</p>\n\n<p>if yes then why?\nif not then why?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":59,"score":1,"question_id":13264057,"title":"is there is any globalization issues using '==' operator and string.Equals() method for comparing a string?","body":"<p>Are there any globalization issues using '<code>==</code>' operator and <code>string.Equals()</code> method for comparing a string? If yes what is the solution to avoid this?</p>\n"},{"tags":["c#","c#-4.0"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":7,"view_count":52,"score":-5,"question_id":13264123,"title":"C#.NET - Windows Forms","body":"<p>C#.NET - Windows Forms</p>\n\n<p>Do a simple Event Alert Application as follows,</p>\n\n<ol>\n<li>A simple screen to get input name, email and event description</li>\n<li>There should be a button says Alert</li>\n<li>Once user click on the Alert the name and email should gets stored in the database and a email should trigger to the admin. </li>\n<li>Upon successfully database entry the application screen should close automatically else exception should raise and notify user. </li>\n</ol>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13264095,"title":"How to Detect color from the image object","body":"<p>Hello I want to detect the color of car in image\nFollowing Steps I've done \nI have detected the car in image,\n    i have created  the bins of colors for example ranging the  value 0-25 will be equal to  0  and have ten bins for each part of color of <code>RGB</code> so could you have any algorithm to get the color of <code>car/object</code>.</p>\n"},{"tags":["c#","xaml","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13262782,"title":"Using style in StandardStyle xaml from another Style xaml","body":"<p>I have a custom Color.xaml as</p>\n\n<pre><code>&lt;ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n    &lt;SolidColorBrush x:Key=\"MyColor1\" Color=\"#7d897d\"/&gt;\n    &lt;SolidColorBrush x:Key=\"MyColor2\" Color=\"#078ab4\"/&gt;\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>And App.xaml as</p>\n\n<pre><code>&lt;Application.Resources&gt;\n        &lt;ResourceDictionary&gt;\n            &lt;ResourceDictionary.MergedDictionaries&gt;\n                &lt;!-- Defines the colors used in the app--&gt;\n                &lt;ResourceDictionary Source=\"Color.xaml\"/&gt;\n                &lt;!-- Styles that define common aspects of the platform look and\n                     feel Required by Visual Studio project and item templates--&gt;\n                &lt;ResourceDictionary Source=\"StandardStyles.xaml\"/&gt;\n                &lt;ResourceDictionary&gt;\n                ............\n</code></pre>\n\n<p>In My StandardStyle.xaml I'm not able to use the Color defined in the xaml.</p>\n\n<pre><code>&lt;Style x:Key=\"HeadingTextStyle\" TargetType=\"TextBlock\"&gt;\n    &lt;Setter Property=\"FontWeight\" Value=\"SemiLight\"/&gt;\n    &lt;Setter Property=\"FontSize\" Value=\"20\"/&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource MyColor1}\"/&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>It gives me an exception when I run the code</p>\n\n<pre><code>\"Cannot find a Resource with the Name/Key MyColor1 [Line: 20 Position: 44]\"\n</code></pre>\n\n<p>However I'm able to use this color in the UI xaml files.</p>\n"},{"tags":["c#","ftp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13264173,"title":"How to read files one by one from ftp server using c#?","body":"<p>I am getting files from ftp folder like this.</p>\n\n<pre><code>request = (FtpWebRequest)FtpWebRequest.Create(new Uri(\"ftp://ipaddress/foldername\"));\n                request.UseBinary = true;\n                request.Credentials = new NetworkCredential(\"username\", \"password\");\n                request.Method = WebRequestMethods.Ftp.ListDirectory;\n                request.UseBinary = true;\n\n                WebResponse response = request.GetResponse();\n\n                StreamReader reader = new StreamReader(response.GetResponseStream());\n\n                    string line = reader.ReadLine();\n                    while (line != null)\n                    {\n                        result.Append(line);\n                        result.Append(\"\\n\");\n                        line = reader.ReadLine();\n                    }\n                    // to remove the trailing '\\n'\n                    result.Remove(result.ToString().LastIndexOf('\\n'), 1);\n                    reader.Close();\n                    response.Close();\n\n                    string[] results = result.ToString().Split('\\n');\n\n                    foreach (string filename in results)\n\n                    {\n connetionString = \"Data Source=testservername;Initial Catalog=testdb;User ID=sa;Password=sa\";\n                   connection = new SqlConnection(connetionString);\n\n\n                   FtpWebRequest request1 = (FtpWebRequest)FtpWebRequest.Create(new Uri(\"ftp://servername/\"  + filename));\n                   request1.Method = WebRequestMethods.Ftp.DownloadFile;\n                   request1.UseBinary = true;\n                   request1.Credentials = new NetworkCredential(\"username\", \"password\");\n                   responses = (FtpWebResponse)request1.GetResponse();\n                   StreamReader reader1 = new StreamReader(responses.GetResponseStream());\n\n                   string xml = reader1.ReadToEnd();\n\n\n\n                   ds.ReadXml(new XmlTextReader(new StringReader(xml)));\n\n                   int i = 0;\n                   connection.Open();\n                   for (i = 0; i &lt;= ds.Tables[1].Rows.Count - 1 ; i++)\n                    {\n\n                   sql = \"insert into Details values('\" + ds.Tables[1].Rows[i].ItemArray[0]            \n                                                       + \"')\";\n\n                        command = new SqlCommand(sql, connection);\n                        adpter.InsertCommand = command;\n                        adpter.InsertCommand.ExecuteNonQuery();\n\n                    }\n\n\n                        FtpWebRequest requestDelete = (FtpWebRequest)WebRequest.Create(\"ftp://sername/\" + filename);\n                        requestDelete.Method = WebRequestMethods.Ftp.DeleteFile;\n                        requestDelete.UseBinary = true;\n                        requestDelete.Credentials = new NetworkCredential(\"username\", \"password\");\n                        responseDelete = (FtpWebResponse)requestDelete.GetResponse();\n                        try\n                        {\n                            string res = responseDelete.StatusDescription;\n                            if (res == \"250 Delete operation successful.\")\n                            {\n                                MessageBox.Show(\"Done......\");\n\n                            }\n                        }\n                        catch (Exception ex)\n                        {\n                            System.Windows.Forms.MessageBox.Show(ex.Message);\n\n                        }\n                    }\n\n                    responseDelete.Close();\n                    connection.Close();\n                    responses.Close();\n\n\n\n            }\n            catch (Exception ex)\n            {\n               System.Windows.Forms.MessageBox.Show(ex.Message);\n\n            }\n        }\n</code></pre>\n\n<p>Hi need to get files from ftp folder and read that xml files one by one and save it as records in my Databse after that need to delete that file ftp folder.</p>\n\n<p>if for testing i placed two files in ftp folder first files reading successfully .but getting error for reading second file like \"Object Reference is not set instance of object \"in the below line. </p>\n\n<pre><code>ds.ReadXml(new XmlTextReader(new StringReader(xml)));\n</code></pre>\n\n<p>please tell me any thing wrong in my code.i am sending ftp request multiple times it is good or suggest me by seeing above lines of code how to do that?</p>\n"},{"tags":["c#","add-in"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12949301,"title":"How to Load MS Word 2010 Add-in load after login and unload when exit","body":"<p>I have windows application which enables user log-in. After Login I want the Add-in get loaded. and when user Exits that paticular Word instance(Only one instance of word can exists when the login application runs) then add-in is also unloaded. I have tried to do it by </p>\n\n<pre><code> addin.Connect = false;//Application.COMAddins. Connect \n</code></pre>\n\n<p>It sets the LoadBehaviour( COM add-ins list) to 2\nand when it loads i set it to 3</p>\n\n<p>Its working but MSword displays so many error messages while exit and sometimes disables my add-in. \nIs there any other way to load and unload add-in dynamically?</p>\n"},{"tags":["c#",".net","pcap.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13117290,"title":"How to get audio data from rtp packet...?","body":"<p>I'm using .net to do call recroding with pcap.net.</p>\n\n<p>till now I have got the rtp packet. And its length is 32 bytes.</p>\n\n<p>The codec used is G729 and payload type is 18.</p>\n\n<pre><code>byte[] bytes = HexString2Bytes(udp.Payload.ToHexadecimalString());          \nstring rtppayload = ASCIIEncoding.ASCII.GetString(bytes);\n</code></pre>\n\n<p>I need to get the actual rtp payload.\n Plz help me...</p>\n"},{"tags":["c#","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13263167,"title":"Easy with with large nested xml document to prevent NULL Ref Exceptions","body":"<p>Is there an easy way to prevent NULL ref exceptions on larger nested xml documents when there is  chance that portions of the xml may not exist in some of the transmission messages? So for example if I am using Linq to Xml to traverse an xml doc and need to get to something like the CustomerName xml tag, but the parent node \"Customer\" is for whatever reason not present.  I know you can write if statements to check and you can use extension methods (I couldn't get those to work on deeply nested docs)?</p>\n\n<p>I also had tried using some of the linq \"let\" statements to check if an element exists, but that is also giving me some strange behavior when the element is not present.</p>\n\n<p>Are there other options?</p>\n\n<p>Code example below where if the entire customer node is not present I can prevent myself from getting a NULL Ref on OrderName?</p>\n\n<pre><code>    class Program\n{\n    static void Main(string[] args)\n    {\n        Order order = new Order();\n        XDocument xdoc = XDocument.Parse(\"&lt;business&gt;\" +\n                                        \"&lt;customer&gt;\" + \n                                            \"&lt;customername&gt;Mike&lt;/customername&gt;&lt;order&gt;&lt;ordernumber&gt;101010&lt;/ordernumber&gt;&lt;orderitem&gt;orderitem&lt;/orderitem&gt;&lt;/order&gt;\"+\n                                            \"&lt;/customer&gt;\" +\n                                            \"&lt;/business&gt;\");\n        var busXml = xdoc.Descendants(\"business\").FirstOrDefault();\n        order.Customer = (string)busXml.Element(\"customer\").Element(\"customername\");\n        order.OrderName = (string)busXml.Element(\"customer\").Element(\"order\").Element(\"ordernumber\");\n\n        Console.WriteLine(\"Customer: {0} Order: {1} OrderItem: {2}\", order.Customer, order.OrderName, order.OrderItem);\n        Console.Read();\n    }\n}\n\npublic class Order\n{\n    public string Customer { get; set; }\n    public string OrderName { get; set; }\n    public string OrderItem { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc-4","iis-7.5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13263002,"title":"Is there a way to change .net mvc bin dir location?","body":"<p>I have a fairly standard and simple MVC4 website.</p>\n\n<p>In root dir we have: bin, content, scripts, views. Using default settings the project's DLL, let's call it \"web.dll\" and all the necessary extras go in the bin dir.</p>\n\n<p>Somehow, ASP.NET dev server and IIS7.5 both know to look for \"web.dll\" in the bin folder when hosting the site, and if it's not there they throw error: \"Could not load type 'CVD.Web.MvcApplication'\". The standard solution for that error is to build directly into bin folder, which doesn't work for me because...</p>\n\n<p>For debugging purposes, I'd like to be able to build Debug &amp; Release configurations into into bin/Debug and bin/Release respectively and then deploy both dirs, then change a setting either in IIS, web.config, global.asax, or anywhere else to pick whether Debug or Release build should be loaded and executed by the server.</p>\n\n<p>I haven't been able to find if that's possible or if .net webapps have a silly hard-coded rule saying all code must live in the bin dir.</p>\n"},{"tags":["c#","nhibernate","fluent-nhibernate","foreign-key-relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13249462,"title":"Fluent NHibernate one to one mapping insert issue","body":"<p>One to one mapping works fine when retriving the values based on bellow mapping. But when inserting values </p>\n\n<blockquote>\n  <p>unable to resolve property: MasterData </p>\n</blockquote>\n\n<p>is thrown. </p>\n\n<p>Tables are listed bellow</p>\n\n<blockquote>\n  <p>MasterDataTable [MasterDataID (PK), Name ]</p>\n  \n  <p>OtherDataTable [MasterDataID (PK)(FK), OtherName]</p>\n</blockquote>\n\n<p>Fluent NHibernare Classes are </p>\n\n<pre><code>Public class MasterData{\npublic virtual long MasterDataID {get;set;}\npublic virtual string Name {get;set;}\npublic virtual OtherData OtherDataProp {get;set;}\n}\n\npublic class OtherData{\npublic virtual long MasterDataID {get;set;}\npublic virtual string OtherName {get;set;}\n}\n\npublic class MasterDataMap: ClassMap&lt;MasterData&gt;{\n public MasterDataMap(){\n //table declaration\n\n   Id(x =&gt; x.MasterDataID).Column(\"MasterDataID\").GeneratedBy.gui.Sequence(\"MASTER_DATA_SEQ\");\n Map(x =&gt; x.Name).Column(\"Name\");\n}\n}\n\npublic class OtherDataMap: ClassMap&lt;OtherData&gt;{\n public OtherDataMap(){\n //table declaration\n\n   Id(x =&gt; x.MasterDataID, \"MASTER_DATA_ID\").GeneratedBy.Foreign(\"MasterData\")\n Map(x =&gt; x.Name).Column(\"OtherName\");\n}\n}\n</code></pre>\n\n<p>Please let me know what other information is needed to resolve this. I am able to retrieve values but when i insert values i am not able. </p>\n\n<p>Regards,\nDesmond</p>\n"},{"tags":["c#","crystal-reports","dataset","subreport","ondemand"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3076,"score":2,"question_id":529400,"title":"Crystal Reports Subreport Using DataSets","body":"<p>I use Crystal Reports XI with C# Visual Studio 2005.\nI am trying to create a subreport from a summary dataset.\nA simple example would be Company listing with Employees.\nI load the Company dataset (with CompanyId).\nI want to create a subreport which is linked by CompanyId whereby the dataset is loaded (obviously) on demand.  I can create this subreport if I load all the detail into one monster dataset, but in my real-world implementation this would involve loading millions of detail rows (not an option).</p>\n\n<p>Is there a way I can capture the SubReport event and load the dataset from my database connection?  I basically want to intercept the subreport link call to build the dataset myself.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13262727,"title":"how to check Object Reference?","body":"<p>I have like this entity,</p>\n\n<pre><code>public class Receiving{\n  [Key]\n  public int ID {get; set;}\n  public string shipperID {get; set;}\n\n  [Foregign(\"shipperID\")]\n  public virtual Shipper shipper {get; set;}\n}\n</code></pre>\n\n<p>the Shipper relationship could be <strong>1:0 or 1:1</strong></p>\n\n<p>and I got an error when the shipper is 0.</p>\n\n<pre><code>var result = from p in productRepository\n             join o in receivingRepository\n             on p.fk equals o.ID\n             select new {\n               test = o.shipper.name // if the shipper is nothing related then it occur an error.\n             }\n</code></pre>\n\n<p>The error message say,\n<strong>\"Object reference not set to an instance of an object.\"</strong></p>\n\n<p>How can I check that in select {}?</p>\n\n<p>I tried,</p>\n\n<pre><code>select new {\n  test = o.shipper.name ?? \"\"\n}\n</code></pre>\n\n<p>but it is not working.</p>\n"},{"tags":["c#",".net","collections","concurrency","thread-safety"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":82,"score":3,"question_id":13096519,"title":"Making a \"modify-while-enumerating\" collection thread-safe","body":"<p>I want to create a thread-safe collection that can be modified while being enumerated.</p>\n\n<p>The sample <code>ActionSet</code> class stores <code>Action</code> handlers. It has the <code>Add</code> method that adds a new handler to the list and the <code>Invoke</code> method that enumerates and invokes all of the collected action handlers. The intended working scenarios include very frequent enumerations with occasional modifications while enumerating.</p>\n\n<p>Normal collections throw exception if you modify them using the <code>Add</code> method while the enumeration is not over. I've created a sample \"recursion-safe\" collection that allows adding new values even while enumerating. If you add new values while the main <code>_actions</code> collection is being enumerated, the values are added to the temporary <code>_delta</code> collection instead of the main one. After all enumerations are finished, the <code>_delta</code> values are added to the <code>_actions</code> collection. If you add some new values while the main <code>_actions</code> collection is being enumerated (creating the <code>_delta</code> collection) and then re-enter the Invoke method again we have to create a new merged collection (<code>_actions</code> + <code>_delta</code>) and replace <code>_actions</code> with it.</p>\n\n<p>So, this collection looks \"recursion-safe\", but I want to make it thread-safe. I think that I need to use the <code>Interlocked.*</code> constructs, classes from <code>System.Threading</code> and other synchronization primitives to make this collection thread-safe, but I don't have a good idea on how to do that.</p>\n\n<p>How to make this collection thread-safe?</p>\n\n<pre><code>class ActionSet {\n    List&lt;Action&gt; _actions = new List&lt;Action&gt;(); //The main store\n    List&lt;Action&gt; _delta; //Temporary buffer for storing added values while the main store is being enumerated\n    int _lock = 0; //The number of concurrent Invoke enumerations\n\n    public void Add(Action action) {\n        if (_lock == 0) { //_actions list is not being enumerated and can be modified\n            _actions.Add(action);\n        } else { //_actions list is being enumerated and cannot be modified\n            if (_delta == null) {\n                _delta = new List&lt;Action&gt;();\n            }\n            _delta.Add(action); //Storing the new values in the _delta buffer\n        }\n    }\n\n    public void Invoke() {\n        if (_delta != null) { //Re-entering Invoke after calling Add:  Invoke-&gt;Add,Invoke\n            Debug.Assert(_lock &gt; 0);\n            var newActions = new List&lt;Action&gt;(_actions); //Creating a new list for merging delta\n            newActions.AddRange(_delta); //Merging the delta\n            _delta = null;\n            _actions = newActions; //Replacing the original list (which is still being iterated)\n        }\n        _lock++;\n        foreach (var action in _actions) {\n            action();\n        }\n        _lock--;\n        if (_lock == 0 &amp;&amp; _delta != null) {\n            _actions.AddRange(_delta); //Merging the delta\n            _delta = null;\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","file-io","unmanaged-memory"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13263825,"title":"How to create a file from UmanagedMemoryStream in C#","body":"<p>How to create a file on disk from an UnManagedMemoryStream.\nIs there any direct command exists in C# for it, or some simple procedure for it.</p>\n"},{"tags":["c#",".wav"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13263783,"title":"Playing Multiple wav files simultaneously","body":"<p>I have to play 5-10 wav files together.In my application, When any camera(each camera has a different wav file to play as alarm on motion detection) detects a motion an alarm(wav) file is played.\nwhen multiple cameras (5-10) gets motion detection simultaneously then there we have to play multiple alarms(wav files) which are different for each camera.If I am using WMPlayer then the alarms are getting interrupted and also the whole wave is not getting played.</p>\n\n<p>code for WMPlayer</p>\n\n<pre><code>var player = new WindowsMediaPlayer();\n                ////player.settings.rate = .5; //slow\n                player.URL = soundfilepath;\n                player.controls.play();\n</code></pre>\n\n<p>I also tried Windows API but it pauses my application(cameras) during which the alarm is getting played</p>\n\n<p>Code for Windows API</p>\n\n<pre><code>PlaySound(soundfilepath, IntPtr.Zero, SoundFlags.SND_FILENAME | SoundFlags.SND_SYNC);\n\npublic enum SoundFlags : int\n    {\n        SND_SYNC = 0x0000,  // play synchronously (default) \n        SND_ASYNC = 0x0001,  // play asynchronously \n        SND_NODEFAULT = 0x0002,  // silence (!default) if sound not found \n        SND_MEMORY = 0x0004,  // pszSound points to a memory file\n        SND_LOOP = 0x0008,  // loop the sound until next sndPlaySound \n        SND_NOSTOP = 0x0010,  // don't stop any currently playing sound \n        SND_NOWAIT = 0x00002000, // don't wait if the driver is busy \n        SND_ALIAS = 0x00010000, // name is a registry alias \n        SND_ALIAS_ID = 0x00110000, // alias is a predefined ID\n        SND_FILENAME = 0x00020000, // name is file name \n        SND_RESOURCE = 0x00040004  // name is resource name or atom \n    }\n</code></pre>\n\n<p>Now My problem is how to play multiple wav files simultaneously without interruption?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wcf","authorization","role"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13206862,"title":"WCF service Role-based authorization. Retrieving roles from database","body":"<p>I have Wcf service (Instanscontext mode - PerCall, concurrency - Multiple) and I want to use this thing:</p>\n\n<pre><code>    [PrincipalPermission(SecurityAction.Demand, Role = \"customrole\")]\n    public string AnyMethod()\n    {\n        //any implementation\n    }\n</code></pre>\n\n<p>According this <a href=\"http://msdn.microsoft.com/en-us/magazine/cc948343.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/magazine/cc948343.aspx</a>\nGetRolesForUser looks like this:</p>\n\n<pre><code>    class CustomRoleProvider : RoleProvider\n    {\n         public override string[] GetRolesForUser(string username)\n         {\n              //?? n Hibernate initialization\n\n              //implementation role retrieving from database\n         }\n\n         public override bool IsUserInRole(string username, string roleName)\n         {\n              return GetRolesForUser(username).Contains(roleName);\n         }\n    }\n</code></pre>\n\n<p>I need to retrieve roles from database and I don't want to initialize n Hibernate inside GetRolesForUser. What should i do to avoid initialize n Hibernate in GetRolesForUser ?\nIs there a good approach initialize ORM from service class constructor?</p>\n"},{"tags":["c#","silverlight","datagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":119,"score":1,"question_id":11781859,"title":"The checkbox in the DataGridTemplateColumn is malfunctional","body":"<p>I add a DataGridTemplateColumn with a checkbox to my Datagrid in Silverlight. The Checkbox is successfully added to the datagrid as a column. However,if I check more that one chcekbox, some other checkboxes in this column will be affected automatically (i.e.,changed from checked to unchecked, or vise versa.). I didn't add any event handler for this checkbox, so how could this happen? It seems to me, if I scroll the datagrid to view more records, the datagrid is refreshed/updated automatically, and the checkboxes are messed up at that point. My code is listed below:</p>\n\n<pre><code>            DataGridTemplateColumn templateColumn = new DataGridTemplateColumn() { Header = \"header\",Width=new DataGridLength(50) };               \n            StringBuilder CellTemp = new StringBuilder();\n            CellTemp.Append(\"&lt;DataTemplate \");\n            CellTemp.Append(\"xmlns='http://schemas.microsoft.com/winfx/\");\n            CellTemp.Append(\"2006/xaml/presentation' \");\n            CellTemp.Append(\"xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' &gt;\");\n            CellTemp.Append(\"&lt;CheckBox  x:Name='\" + \"checkBoxHeader\" + \"' Margin='4'  IsChecked='False'/&gt;\");\n            CellTemp.Append(\"&lt;/DataTemplate&gt;\");\n            templateColumn.CellTemplate = (DataTemplate)XamlReader.Load(CellTemp.ToString());\n            ftrDataGrid.Columns.Add(templateColumn);\n</code></pre>\n\n<p>How should I resolve this problem, should I add an event handler to this datagrid, but how? </p>\n\n<p>Many thanks for your input,</p>\n\n<p>Wei</p>\n"},{"tags":["c#","entity-framework","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13263557,"title":"db.savechanges() is not working","body":"<p>I'm following this tutorial <a href=\"http://msdn.microsoft.com/en-us/data/ff706685.aspx\" rel=\"nofollow\">Creating Master-Details Windows Forms with the Entity Framework</a>\nbut the <code>db.Savechanges()</code> isn't working if I modified some column or add a new row. According to this video tutorial it will work but it doesn't.</p>\n\n<p><b>Product_Form.cs</b></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace RemoteSynchronizer\n{\n    public partial class Product : Form\n    {\n\n        ProductsEntities db = new ProductsEntities();\n        public Product()\n        {\n            InitializeComponent();\n        }\n\n        private void Product_Form_Load(object sender, EventArgs e)\n        {\n            product_DBindingSource.DataSource = db.Product_D.ToList();\n        }\n\n        private void bindingNavigatorAddNewItem_Click(object sender, EventArgs e)\n        {\n\n        }\n\n        private void product_DBindingNavigatorSaveItem_Click(object sender, EventArgs e)\n        {\n            // Product_D obj = new Product_D();\n            // obj.PCode = pCodeTextBox.Text;\n            // obj.Name = nameTextBox.Text;\n            // obj.Batch = batchTextBox.Text;\n            // obj.Expiry = expiryTextBox.Text;\n            // obj.Price = priceTextBox.Text;\n\n            //try\n            // {\n            //     Product_D temp = db.Product_D.Single(t =&gt; t.PCode == pCodeTextBox.Text);\n\n            //     MessageBox.Show(\"Product Exists\");\n            // }\n            // catch \n            // {\n            //     db.Product_D.Add(obj);\n                 db.SaveChanges();\n\n             //}\n\n        }\n\n        private void bindingNavigatorDeleteItem_Click(object sender, EventArgs e)\n        {\n\n        }\n\n    }\n}\n</code></pre>\n\n<p>When I try to use comment method in code it gives an error</p>\n\n<p><b>Error</b></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>************** Exception Text **************\nSystem.Data.Entity.Infrastructure.DbUpdateException: Unable to update the EntitySet 'Product_D' because it has a DefiningQuery and no &lt;InsertFunction&gt; element exists in the &lt;ModificationFunctionMapping&gt; element to support the current operation. ---&gt; System.Data.UpdateException: Unable to update the EntitySet 'Product_D' because it has a DefiningQuery and no &lt;InsertFunction&gt; element exists in the &lt;ModificationFunctionMapping&gt; element to support the current operation.\n   at System.Data.SqlClient.SqlGen.DmlSqlGenerator.ExpressionTranslator.Visit(DbScanExpression expression)\n   at System.Data.Common.CommandTrees.DbScanExpression.Accept(DbExpressionVisitor visitor)\n   at System.Data.SqlClient.SqlGen.DmlSqlGenerator.GenerateInsertSql(DbInsertCommandTree tree, SqlVersion sqlVersion, List`1&amp; parameters)\n   at System.Data.SqlClient.SqlGen.SqlGenerator.GenerateSql(DbCommandTree tree, SqlVersion sqlVersion, List`1&amp; parameters, CommandType&amp; commandType, HashSet`1&amp; paramsToForceNonUnicode)\n   at System.Data.SqlClient.SqlProviderServices.CreateCommand(DbProviderManifest providerManifest, DbCommandTree commandTree)\n   at System.Data.SqlClient.SqlProviderServices.CreateCommand(DbCommandTree commandTree)\n   at System.Data.Mapping.Update.Internal.UpdateTranslator.CreateCommand(DbModificationCommandTree commandTree)\n   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.CreateCommand(UpdateTranslator translator, Dictionary`2 identifierValues)\n   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)\n   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)\n   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)\n   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)\n   at System.Data.Entity.Internal.InternalContext.SaveChanges()\n   --- End of inner exception stack trace ---\n   at System.Data.Entity.Internal.InternalContext.SaveChanges()\n   at System.Data.Entity.Internal.LazyInternalContext.SaveChanges()\n   at System.Data.Entity.DbContext.SaveChanges()\n   at RemoteSynchronizer.Product.product_DBindingNavigatorSaveItem_Click(Object sender, EventArgs e) in e:\\Study\\Project\\RemoteSynchronizer\\RemoteSynchronizer\\Product_Form.cs:line 50\n   at System.Windows.Forms.ToolStripItem.RaiseEvent(Object key, EventArgs e)\n   at System.Windows.Forms.ToolStripButton.OnClick(EventArgs e)\n   at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)\n   at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)\n   at System.Windows.Forms.ToolStripItem.FireEventInteractive(EventArgs e, ToolStripItemEventType met)\n   at System.Windows.Forms.ToolStripItem.FireEvent(EventArgs e, ToolStripItemEventType met)\n   at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\n   at System.Windows.Forms.ScrollableControl.WndProc(Message&amp; m)\n   at System.Windows.Forms.ToolStrip.WndProc(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n\n\n************** Loaded Assemblies **************\nmscorlib\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.18010 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/mscorlib.dll\n----------------------------------------\nRemoteSynchronizer\n    Assembly Version: 1.0.0.0\n    Win32 Version: 1.0.0.0\n    CodeBase: file:///E:/Study/Project/RemoteSynchronizer/RemoteSynchronizer/bin/Debug/RemoteSynchronizer.exe\n----------------------------------------\nSystem.Windows.Forms\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Windows.Forms/v4.0_4.0.0.0__b77a5c561934e089/System.Windows.Forms.dll\n----------------------------------------\nSystem.Drawing\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Drawing/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll\n----------------------------------------\nSystem\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.18016 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System/v4.0_4.0.0.0__b77a5c561934e089/System.dll\n----------------------------------------\nSystem.Configuration\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Configuration/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll\n----------------------------------------\nSystem.Xml\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.dll\n----------------------------------------\nSystem.Web\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Web/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Web.dll\n----------------------------------------\nSystem.Core\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Core/v4.0_4.0.0.0__b77a5c561934e089/System.Core.dll\n----------------------------------------\nEntityFramework\n    Assembly Version: 5.0.0.0\n    Win32 Version: 5.0.20627.0\n    CodeBase: file:///E:/Study/Project/RemoteSynchronizer/RemoteSynchronizer/bin/Debug/EntityFramework.DLL\n----------------------------------------\nSystem.Data.Entity\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Data.Entity/v4.0_4.0.0.0__b77a5c561934e089/System.Data.Entity.dll\n----------------------------------------\nAnonymously Hosted DynamicMethods Assembly\n    Assembly Version: 0.0.0.0\n    Win32 Version: 4.0.30319.18010 built by: FX45RTMGDR\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/mscorlib/v4.0_4.0.0.0__b77a5c561934e089/mscorlib.dll\n----------------------------------------\nAccessibility\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/Accessibility/v4.0_4.0.0.0__b03f5f7f11d50a3a/Accessibility.dll\n----------------------------------------\nSystem.Data\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Data/v4.0_4.0.0.0__b77a5c561934e089/System.Data.dll\n----------------------------------------\nSystem.Transactions\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Transactions/v4.0_4.0.0.0__b77a5c561934e089/System.Transactions.dll\n----------------------------------------\nSystem.Numerics\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Numerics/v4.0_4.0.0.0__b77a5c561934e089/System.Numerics.dll\n----------------------------------------\nSystem.Data.OracleClient\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Data.OracleClient/v4.0_4.0.0.0__b77a5c561934e089/System.Data.OracleClient.dll\n----------------------------------------\nSystem.Xml.Linq\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml.Linq/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.Linq.dll\n----------------------------------------\nSystem.EnterpriseServices\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.EnterpriseServices/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.EnterpriseServices.dll\n----------------------------------------\nEntityFrameworkDynamicProxies-RemoteSynchronizer\n    Assembly Version: 1.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Data.Entity/v4.0_4.0.0.0__b77a5c561934e089/System.Data.Entity.dll\n----------------------------------------\nSystem.Runtime.Serialization\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Runtime.Serialization/v4.0_4.0.0.0__b77a5c561934e089/System.Runtime.Serialization.dll\n----------------------------------------\nSystem.ComponentModel.DataAnnotations\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.ComponentModel.DataAnnotations/v4.0_4.0.0.0__31bf3856ad364e35/System.ComponentModel.DataAnnotations.dll\n----------------------------------------\nMicrosoft.SqlServer.Types\n    Assembly Version: 11.0.0.0\n    Win32 Version: 2011.0110.2100.060 ((SQL11_RTM).120210-1917 )\n    CodeBase: file:///C:/Windows/assembly/GAC_MSIL/Microsoft.SqlServer.Types/11.0.0.0__89845dcd8080cc91/Microsoft.SqlServer.Types.dll\n----------------------------------------\n\n************** JIT Debugging **************\nTo enable just-in-time (JIT) debugging, the .config file for this\napplication or computer (machine.config) must have the\njitDebugging value set in the system.windows.forms section.\nThe application must also be compiled with debugging\nenabled.\n\nFor example:\n\n&lt;configuration&gt;\n    &lt;system.windows.forms jitDebugging=\"true\" /&gt;\n&lt;/configuration&gt;\n\nWhen JIT debugging is enabled, any unhandled exception\nwill be sent to the JIT debugger registered on the computer\nrather than be handled by this dialog box.\n</code></pre>\n\n<p>How to get rid of this problem? I'm trying to solve this by simple method <code>db.savechanges()</code> but it won't work.</p>\n"},{"tags":["c#"],"answer_count":10,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":262,"score":1,"question_id":3196207,"title":"Stuck with List<>","body":"<p>I have this:</p>\n\n<pre><code>public class accounts\n{\n    private string mName;\n    private string mEmail;\n    private string mAddress;\n\n    public accounts(string Name,\n    string Email,\n    string Address)\n    {\n        this.mName = Name;\n        this.mEmail = Email;\n        this.mAddress = Address;\n    }\n}\n</code></pre>\n\n<p>then, somewhere else, I create this:</p>\n\n<pre><code>private static List&lt;accounts&gt; mlocalaccountList = new List&lt;accounts&gt;()\n</code></pre>\n\n<p>then I fill it like this:</p>\n\n<pre><code>mlocalaccountList.Add(new accounts(\"John Smith\",\"johnsmith@mail.com\",\"CA USA\"));\n</code></pre>\n\n<p>Now, everything is OK, except, how can I access the list&lt;> items?? </p>\n"},{"tags":["c#","regex"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":279,"score":5,"question_id":9096811,"title":"Parsing strings recursively","body":"<p>I am trying to extract information out of a string - a fortran formatting string to be specific. The string is formatted like:</p>\n\n<pre><code>F8.3, I5, 3(5X, 2(A20,F10.3)), 'XXX'\n</code></pre>\n\n<p>with formatting fields delimited by \",\" and formatting groups inside brackets, with the number in front of the brackets indicating how many consecutive times the formatting pattern is repeated. So, the string above expands to:</p>\n\n<pre><code>F8.3, I5, 5X, A20,F10.3, A20,F10.3, 5X, A20,F10.3, A20,F10.3, 5X, A20,F10.3, A20,F10.3, 'XXX'\n</code></pre>\n\n<p>I am trying to make something in C# that will expand a string that conforms to that pattern. I have started going about it with lots of switch and if statements, but am wondering if I am not going about it the wrong way? </p>\n\n<p>I was basically wondering if some Regex wizzard thinks that Regular expressions can do this in one neat-fell swoop? I know nothing about regular expressions, but if this could solve my problem I am considering putting in some time to learn how to use them... on the other hand if regular expressions can't sort this out then I'd rather spend my time looking at another method.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":13252643,"title":"Child Application Menu not shown in a Chrome like application","body":"<p>I am developing a chrome like application. I do have two applications Say Parent and Child Application. Child application contains menus. \nWhen i am attaching an instance of child application to a tab of parent application. Menu in child application is not shown on mouse click.</p>\n\n<p>Code snippet used for attaching process is</p>\n\n<pre><code>Process P = Process.GetProcessesByName(\"Child\");\nP.WaitForInputIdle();\nIntPtr handle = P.MainWindowHandle;\nSetParent(handle, this.tabPage1.Handle);\nMoveWindow(handle, rec.X, rec.Y, rec.Width, rec.Height, true);\n</code></pre>\n\n<p>I cannot make any changes to Child application.</p>\n"},{"tags":["c#","sql-server","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13259655,"title":"Data integrity in Entity Framework","body":"<p>Are there any consensus as to what is considered the best method in always maintaining data integrity in Entity Framework. i.e. when adding or deleting entities, how do I make sure the loaded model is the most recent, and that nothing has changed on the db behind my back?</p>\n\n<p>A rough method that seem to work for me in the majority of cases, is to reload the context between sessions, i.e. not to have a persistent model, and reload/refresh in case of an error. This seems to work in cases of low data clashes, however is very costly when lots of changes happen in different services. Is there a flag to query if the data/row on disk have changed or event to make this refresh automatic, i.e. update any subscribers of certain tables/rows?</p>\n"},{"tags":["c#","printing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2951,"score":0,"question_id":5563788,"title":"How to check a print job status with C#","body":"<p>I'm printing a PDF file by executing a commandline application from within my C# application. Now I wanna know when this job is printed. I was hoping there would be some kind of event I could subscribe to, and handle it. But I couldn't find it.</p>\n\n<p>So now I'm resorting to polling. And checking the JobStatus of a PrinterSystemJobInfo object. But in my case this either gives me JobStatus = None or JobStatus = Printing.</p>\n\n<pre><code>PrinterSystemJobInfo.JobStatus\n</code></pre>\n\n<p>Can someone tell me how to reliably check a print job status using C#?</p>\n"},{"tags":["c#",".net","silverlight","xaml","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12812670,"title":"Critical Viewer Error - Cannot Load XAML Resource","body":"<p>I have a silverlight application and it works completely fine in VS2010 then when I upload it to IIS7 and try to browse it I get an error saying</p>\n\n<p>\"An error occurred during initialization and the Viewer could not be started. This may be due to network connectivity problems, viewer configuration problems, or site configuration problems\" </p>\n\n<p>Further details of the error are:</p>\n\n<p>\"Cannot load Xaml resource from /config/themes/map/map.xaml.\"</p>\n\n<p>If I navigate to the folder where it says that it cannot load it I can see that it is there and that it looks to be in the correct formatting(as it should be if it was working on my local machine). So I thought maybe permissions were stopping it so I checked that and there are sufficint permissions to access the file. </p>\n\n<p>Does anyone know what might be causing this error and how to fix it?</p>\n"},{"tags":["c#","string","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":953,"score":1,"question_id":9648381,"title":"how to prevent manual input into a ComboBox in C#","body":"<p>i have a form in C# that uses ComboBox\nhow do i prevent a user form manualy input text in the ComboBox in C#?</p>\n\n<pre><code>this.comboBoxType.Font = new System.Drawing.Font(\"Arial\", 15.75F);\n            this.comboBoxType.FormattingEnabled = true;\n            this.comboBoxType.Items.AddRange(new object[] {\n            \"a\",\n            \"b\",\n            \"c\"});\n            this.comboBoxType.Location = new System.Drawing.Point(742, 364);\n            this.comboBoxType.Name = \"comboBoxType\";\n            this.comboBoxType.Size = new System.Drawing.Size(89, 32);\n            this.comboBoxType.TabIndex = 57;   \n</code></pre>\n\n<p>i want A B C to be the only options</p>\n"},{"tags":["c#","winforms","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":23,"down_vote_count":0,"view_count":18787,"score":23,"question_id":598447,"title":"How to disable editing of elements in combobox for c#?","body":"<p>I have some elements in a ComboBox (WinForms with C#). I want their content to be static so that a user cannot change the values inside when the application is ran. I also do not want the user adding new values to the ComboBox</p>\n"},{"tags":["c#","database","caching","dynamic","storage"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":184,"score":3,"question_id":13108416,"title":"Best approach to incremently update application data","body":"<p>I have been working on an application for a couple of years that I updated using a back-end database. The whole key is that everything is cached on the client, so that it never requires an network connection to operate, but when it does have a connection it will always pickup the latest updates. Every application updated is shipped with the latest version of the database and I wanted it to download only the minimum amount of data when the database has been updated.</p>\n\n<p>I currently use a table with a timestamp to check for updates. It looks something like this.</p>\n\n<pre><code>ID - Name - Description- Severity - LastUpdated\n0 - test.exe - KnownVirus - Critical - 2009-09-11 13:38\n1 - test2.exe - Firewall - None - 2009-09-12 14:38\n</code></pre>\n\n<p>This approach was fine for what I previously needed, but I am looking to expand more function of the application to use this type of dynamic approach. All the data is currently stored as <code>XML</code>, but I do not want to store complete XML files in the database and only transmit changed data.</p>\n\n<p>So how would you go about allowing a fairly simple approach to storing dynamic content (text/xml/json/xaml) in a database, and have the client only download new updates? I was thinking of having logic that can handle XML inserted directly</p>\n\n<pre><code>ID - Data - Revision\n15 - XXX - 15\n</code></pre>\n\n<p><code>XXX</code> would be something like <code>&lt;Content&gt;&lt;File&gt;Test.dll&lt;File/&gt;&lt;Description&gt;New DLL to load.&lt;/Description&gt;&lt;/Content&gt;</code> and would be inserted into the cache, but this would obviously be complicated as I would need to load them in sequence. </p>\n\n<p>Another approach that has been mentioned was to base it on something similar to Source Control, storing the version in the root of the file and calculating the delta to figure out the minimal amount of data that need to be sent to the client.</p>\n\n<p>Anyone got any suggestions on how to approach this with no risk for data corruption? I would also to expand with features that allows me to revert possibly bad revisions, and replace them with new working ones.</p>\n"},{"tags":["c#","visual-studio-2010","stylecop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13229961,"title":"Using stylecop to set boolean variable rule","body":"<p>A boolean variable must have a prefix is, such as: <code>bool isFinished;</code>\nHow can I write a custom rule for it? (I'm using stylecop)</p>\n"},{"tags":["c#","linq","sorting","paging"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13263216,"title":"Entity IQueryable with page, search and sort","body":"<p>I'm sure this has been answered before, but can't seem to find it.</p>\n\n<p>I'm looking for a simple download (or tutorial) for building an IQueryable that can be sorted, paged and searched.</p>\n\n<p>e.g.</p>\n\n<pre><code>IQueryable&lt;T&gt; myThings , params[] searchKeyValuePairs, params[] orderKeyValuePairs, int pageSize, int pageNumber\n</code></pre>\n\n<p>Or something similar.  Guessing it will be using Dynamic Linq.</p>\n\n<p>My requirement is for a number of MVC3 views for broadly similar data.  BA specified about 20 views of each of 10 data types...but MOST of these views are simply \"All Today\" and \"Sorted by Cost\" type views.</p>\n\n<p>Data is from SQL or Oracle through EF4.</p>\n"}]}
{"total":375450,"page":18,"pagesize":100,"questions":[{"tags":["c#","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13263099,"title":"pass object between forms c#","body":"<p>I am working on a form application that has two windows. In the main window, Form1 I create an instance of the class Treatment. I would like to pass that instance, once a image is clicked to the other window form2. So far I have:\nForm1:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n\n    private Treatment treatment;\n\n//method where i inistantiate the treatment\nprivate void processTreatment(int id, Button button)\n    {\n        treatment = new Treatment(wirelessResult, id);\n        Alarm alarm = new Alarm(count, treatment);\n        wirelessResult.GenerateNumber();\n        alarm.setColor();\n        events.add(alarm);\n        if (getResult(treatment) == true)\n        {\n            storeSuccess(button);  \n        }\n        else if (getResult(treatment) == false)\n        {\n            storeFailed(button);\n        }\n    }\n// image clicked   \nprivate void treatmentStation1_Click(object sender, EventArgs e)\n    {\n\n        Form2 secondForm = new Form2(treatment);\n        secondForm.Show();\n    }\n</code></pre>\n\n<p>and in form2:</p>\n\n<pre><code>public partial class Form2 : Form\n{\n    private Treatment treatment;\n\n\n    public Form2()\n    {\n        InitializeComponent();\n\n    }\n\n    public Form2(Treatment treatment)\n    {\n        InitializeComponent();\n        this.treatment = treatment;\n    }\n  }\n}\n</code></pre>\n\n<p>I get 1 error : Error   1   Inconsistent accessibility: parameter type 'WasteTreatment.Treatment' is less accessible than method 'WasteTreatment.Form2.Form2(WasteTreatment.Treatment)'</p>\n\n<p>Someone can help me to fix this?</p>\n"},{"tags":["c#","authentication","azure"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13259938,"title":"Azure Data Service Authentication","body":"<p>So I am trying to connect to a azure data service using <strong>basic authentication</strong>:</p>\n\n<pre><code>string ROOT_URL = \"https://api.datamarket.azure.com/Data.ashx/MelissaData/AddressCheck/v1\";\nprivate Uri serviceUri = new Uri(ROOT_URL);\nprivate AddressCheckContainer context = new AddressCheckContainer(serviceUri);\nstring SECURE_ACCOUNT_ID = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";\ncontext.Credentials = new NetworkCredential(\"\", SECURE_ACCOUNT_ID);\n</code></pre>\n\n<p>I get this error even though I am using basic authentication: <br/>\n<code>The authorization type you provided is not supported.  Only Basic and OAuth are supported</code> <br/></p>\n"},{"tags":["c#","javascript","jquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13221230,"title":"How to view an image when scroll position is located at the bottom of the page?","body":"<p>I need the browser to scroll my ASP.NET page to the top when the user\nclicks on a server-side link or button at the bottom of the page. </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;div id=\"box\" style=\" position: fixed; bottom:5px;\"&gt;\n&lt;a href=\"#top\" &gt;Back to up&lt;img  height=\"40\" src=\"../images/btnup.png\" /&gt;&lt;/a&gt; \n</code></pre>\n\n<p></p>\n\n<p>I use this code for it:</p>\n\n<pre><code> $(document).ready(function () {\n\n        $('a[href=#top]').click(function () {\n            $('html, body').animate({ scrollTop: 0 }, 'slow');\n            return false;\n        });\n\n    });\n</code></pre>\n\n<p>I want to show this button when the scroll position is at the bottom of the page and don't want to show this when the scroll position is at the top of the page.</p>\n\n<p>How to view this button when the scroll position is at the bottom of the page?</p>\n"},{"tags":["c#",".net","templates","ms-word","template-engine"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13195973,"title":"What template engines are there that allow creating templates in Microsoft Word?","body":"<p>In a project I'm working on we will (most likely) need the following feature: the user uploads a word document (can be limited to DOCX, I believe), that is a template with placeholders. The system then takes this document, fills in the placeholders with data, and produces a final word document (and optionally also converts it to a PDF).</p>\n\n<p>In the worst case I can dig through the bowels of DOCX myself, we did this with XLSX in another project (using the low-level library Microsoft provides), but it was quite painful, and I wonder if there is something premade.</p>\n\n<p><strong>Added:</strong> Completely forgot - we're working in Visual Studio 2012, C# 4.5.</p>\n"},{"tags":["c#","ruby","openssl","padding","ruby-1.9.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13241489,"title":"How to set Padding Mode with Ruby/OpenSSL decryption / encryption?","body":"<p>I am starting with the following <code>C#</code> encryption code, and want to decrypt with <code>Ruby</code>. My problem is that I don't know how to set the padding mode in <code>Ruby/OpenSSL</code>. I specifically need to use <code>PKCS7</code>.</p>\n\n<p><strong>C# encryption</strong></p>\n\n<pre><code>System.Security.Cryptography.Aes c = new System.Security.Cryptography.AesManaged();\nc.Mode = CipherMode.CBC;\nc.Padding = PaddingMode.PKCS7;   # &lt;-- how to set this in Ruby world?\nc.KeySize = 256;\nc.BlockSize = 128;\nc.Key = key;\nc.IV = iv;\n...\n</code></pre>\n\n<p><strong>Ruby decryption</strong></p>\n\n<pre><code>d = OpenSSL::Cipher.new('AES-128-CBC') # oops, this should have been AES-256-CBC\nd.decrypt\nd.key = key\nd.iv  = iv\n...\n</code></pre>\n\n<p>I am currently using <code>Ruby 1.9.2</code>, but can use whatever version necessary.</p>\n"},{"tags":["c#","asp.net","appfabric","windows-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13262839,"title":"datacacheexception Cache referred to does not exist","body":"<p>I get the following error when I invoke the call factory.GetDefaultCache()... </p>\n\n<p><strong>ErrorCode:SubStatus:Cache referred to does not exist. Contact administrator or use the Cache administration tool to create a Cache.</strong></p>\n\n<p>Please help.. thanks..</p>\n\n<p>Here is my simple application: </p>\n\n<pre><code>var config = new Microsoft.ApplicationServer.Caching.DataCacheFactoryConfiguration();\nvar servers = new List&lt;Microsoft.ApplicationServer.Caching.DataCacheServerEndpoint&gt;();\nservers.Add(new Microsoft.ApplicationServer.Caching.DataCacheServerEndpoint(\"mymachine123\", 22233));\nconfig.Servers = servers;\nvar factory = new Microsoft.ApplicationServer.Caching.DataCacheFactory(config);\n\n////var factory = _cacheFactory;\n\nvar cache = factory.GetDefaultCache();  &lt;---- *** Error happens here..***\nvar key = \"mykey\";\nvar obj = cache[key];\nif (obj == null)\n{\n    cache[key] = \"I am data for caching\";\n}\nobj = cache[key];\nConsole.WriteLine(obj);\n</code></pre>\n\n<p>When I run the command: start-cachecluster, I get the following:</p>\n\n<p>HostName : CachePort      Service Name            Service Status Version Info\n--------------------      ------------            -------------- ------------\nmymachine123:22233         AppFabricCachingService UP             1 [1,1][1,1]</p>\n"},{"tags":["c#","asp.net","web-services","webservices-client"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13244829,"title":"Connect multiple server by webservices from asp.net","body":"<p>Thanks for reading my question.I wondered if you have any idea about this problem.</p>\n\n<ol>\n<li><p>I wrote a SOAP-SERVER. Running it at CentOS. Changing Soap-Server's IPAddress for match with CentOS Ifconfig.</p></li>\n<li><p>Running SOAP-SERVER in CentOS.</p></li>\n<li><p>Using VisualStudio tools for AddWebReference .It'll auto generate a define object class.In this class,It containt all of function of SOAP-SERVER.</p></li>\n<li><p>Developer will use these function for do something at ASP.Net-Client.</p></li>\n</ol>\n\n<p>But,When I want to connect from ASP-NET to more SOAP-SERVER(in other CentOSs).And we musn't using AddWebReference .Because User will use web form for input IPAddress of these SOAP-SERVER.</p>\n\n<p>Do you have any idea? Thanks for helping by anyway.Thanks</p>\n"},{"tags":["c#","php","wcf","flash","real-time"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13262992,"title":"real-time web update using WCF","body":"<p>I have been reading a lot of forums regarding the use of WCF in web, most specifically, this topic: <a href=\"http://stackoverflow.com/questions/3306744/wcf-with-flash-tutorial\">WCF with Flash tutorial</a>, but I am really confused. </p>\n\n<p>I have an existing feed server that is using WCF service. It is, with no problems, supplying real-time information to its windows applications clients. What i would like to do is to have a web application to subscribe to the feeds that i am supplying to the windows application clients. With the forum that i have read (the one i have indicated), it seems like it will be a request reply method. And i think, using that, i wouldn't be able to achieve the real-time transfer of feeds for it. </p>\n\n<p>I would like to know if there is an equivalent for the callback function in web development.</p>\n"},{"tags":["c#","asp.net","web-services","asmx"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13188860,"title":"Get Custom Class from webservices","body":"<p>After calling <code>Webservices</code>, it returns an object (This object is a custom object class) to client. So, I want to convert from this object to custom class.</p>\n\n<p>-Webservices:</p>\n\n<pre><code>[WebMethod]\npublic Cls_ROLES GetRoles(int firstNum)\n{\n    Cls_ROLES o = new Cls_ROLES();\n    o.Role_ID = 2;\n    o.RoleName = \"binh\";\n    return o;\n}\n</code></pre>\n\n<p>-Client:</p>\n\n<p>+Function:</p>\n\n<pre><code>public object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n{\n    System.Net.WebClient client = new System.Net.WebClient();\n    //-Connect To the web service\n    using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n    {\n        //--Now read the WSDL file describing a service.\n        ServiceDescription description = ServiceDescription.Read(stream);\n        ///// LOAD THE DOM /////////\n        //--Initialize a service description importer.\n        ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n        importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n        importer.AddServiceDescription(description, null, null);\n        //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n        //--Generate properties to represent primitive values.\n        importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n        //--Initialize a Code-DOM tree into which we will import the service.\n        CodeNamespace nmspace = new CodeNamespace();\n        CodeCompileUnit unit1 = new CodeCompileUnit();\n        unit1.Namespaces.Add(nmspace);\n        //--Import the service into the Code-DOM tree. This creates proxy code\n        //--that uses the service.\n        ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n        if (warning == 0) //--If zero then we are good to go\n        {\n            //--Generate the proxy code \n            CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n            //--Compile the assembly proxy with the appropriate references\n            string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n            CompilerParameters parms = new CompilerParameters(assemblyReferences);\n            CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n            //-Check For Errors\n            if (results.Errors.Count &gt; 0)\n            {\n                StringBuilder sb = new StringBuilder();\n                foreach (CompilerError oops in results.Errors)\n                {\n                    sb.AppendLine(\"========Compiler error============\");\n                    sb.AppendLine(oops.ErrorText);\n                }\n                throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n            }\n            //--Finally, Invoke the web service method \n            Type foundType = null;\n            Type[] types = results.CompiledAssembly.GetTypes();\n            foreach (Type type in types)\n            {\n                if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                {\n                    Console.WriteLine(type.ToString());\n                    foundType = type;\n                }\n            }\n\n            object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n            MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n            object o = new object();\n            o=mi.Invoke(wsvcClass, args);\n            return o;\n        }\n        else\n        {\n            return null;\n        }\n    }\n}\n</code></pre>\n\n<p>+Page_Load function:</p>\n\n<pre><code>Line 1:object[] args=new object[1];\nLine 2:args[0]=1;  \nLine 3:o = this.CallWebService(\"http://localhost:1814/HelloServices/Service.asmx\", \"Hello\", \"GetRoles\", args);\n</code></pre>\n\n<p>it returns an object at Line3 (This object is a custom object class) to client. So, I want to convert from this object to custom class(Cls_Role object).\n//======================================================================================\n//======================================================================================\n//======================================================================================\nAs Selalu_Ingin_Belajar's answer,I can get value from webservices to client fine.</p>\n\n<p>object yourObject = new object();</p>\n\n<pre><code>foreach (PropertyInfo property in yourObject.GetType().GetProperties())\n{           \n    object value = property.GetValue(yourObject , null);\n    Console.WriteLine(\"{0} = {1}\", property.Name, value);\n}\n</code></pre>\n\n<p>Beside it,When I apply to another project,It show another error: Parameter count mismatch.\nIf I use AddWebReference by VisualStudio tool.\nIt'll auto generate Reference.cs file.It contain:</p>\n\n<pre><code>/// &lt;remarks/&gt;\n    [System.Web.Services.Protocols.SoapRpcMethodAttribute(\"\", RequestNamespace=\"urn:ALBAPI\", ResponseNamespace=\"urn:ALBAPI\")]\n    [return: System.Xml.Serialization.SoapElementAttribute(\"info\")]\n    public ResponseInfo getSetupLicenseRows(out SetupLicenseRowsValues values) {\n        object[] results = this.Invoke(\"getSetupLicenseRows\", new object[0]);\n        values = ((SetupLicenseRowsValues)(results[1]));\n        return ((ResponseInfo)(results[0]));\n    }\n</code></pre>\n\n<p>So that,It's easy to call from webClient by passing a object SetupLicenseRowsValues class.\nNow,I must pass parameter to WebServices by manually.Don't use this generate file.</p>\n\n<p>Client:</p>\n\n<pre><code>public object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args)\n        {\n            System.Net.WebClient client = new System.Net.WebClient();\n            //-Connect To the web service\n            using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\"))\n            {\n                //--Now read the WSDL file describing a service.\n                ServiceDescription description = ServiceDescription.Read(stream);\n                ///// LOAD THE DOM /////////\n                //--Initialize a service description importer.\n                ServiceDescriptionImporter importer = new ServiceDescriptionImporter();\n                importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2.\n                importer.AddServiceDescription(description, null, null);\n                //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client;\n                //--Generate properties to represent primitive values.\n                importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties;\n                //--Initialize a Code-DOM tree into which we will import the service.\n                CodeNamespace nmspace = new CodeNamespace();\n                CodeCompileUnit unit1 = new CodeCompileUnit();\n                unit1.Namespaces.Add(nmspace);\n                //--Import the service into the Code-DOM tree. This creates proxy code\n                //--that uses the service.\n                ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1);\n                if (warning == 0) //--If zero then we are good to go\n                {\n                    //--Generate the proxy code \n                    CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\");\n                    //--Compile the assembly proxy with the appropriate references\n                    string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" };\n                    CompilerParameters parms = new CompilerParameters(assemblyReferences);\n                    CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1);\n                    //-Check For Errors\n                    if (results.Errors.Count &gt; 0)\n                    {\n                        StringBuilder sb = new StringBuilder();\n                        foreach (CompilerError oops in results.Errors)\n                        {\n                            sb.AppendLine(\"========Compiler error============\");\n                            sb.AppendLine(oops.ErrorText);\n                        }\n                        throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString());\n                    }\n                    //--Finally, Invoke the web service method \n                    Type foundType = null;\n                    Type[] types = results.CompiledAssembly.GetTypes();\n                    foreach (Type type in types)\n                    {\n                        if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol))\n                        {\n                            Console.WriteLine(type.ToString());\n                            foundType = type;\n                        }\n                    }\n\n                    object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString());\n                    MethodInfo mi = wsvcClass.GetType().GetMethod(methodName);\n                    object o = new object();\n                    Line error: o = mi.Invoke(wsvcClass, new object[0]);\n                    return o;\n                }\n                else\n                {\n                    return null;\n                }\n            }\n        }\npublic void call()\n    {\n        string WebserviceUrl = \"http://192.168.2.19:3333/ALBAPI.wsdl\";\n        string serviceName = \"ALBAPI\";\n        string methodName = \"getSetupLicenseRows\";\n        object[] args=new object[0];\n        object sSessionID = CallWebService(WebserviceUrl, serviceName, methodName,args);\n        foreach (PropertyInfo property in sSessionID.GetType().GetProperties())\n        {\n            object value = property.GetValue(sSessionID, null);\n\n            Console.WriteLine(\"{0} = {1}\", property.Name, value);\n        }\n\n    }\n</code></pre>\n\n<p>Now,It show error \"Parameter count mismatch\" at Line error.\nThanks for your help anyway</p>\n"},{"tags":["c#","cross-platform","bytearray","long-integer","endianness"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13262021,"title":"LongToByte and LongFromByte","body":"<p>I have the two functions shown below which I built for serialisation of long and byte[] values.</p>\n\n<pre><code>    public static byte[] LongToByte(long Value)\n    {\n        byte[] Output = new byte[8];\n        Output[0] = (byte)Value;\n        Output[1] = (byte)(Value &gt;&gt; 8);\n        Output[2] = (byte)(Value &gt;&gt; 16);\n        Output[3] = (byte)(Value &gt;&gt; 24);\n        Output[4] = (byte)(Value &gt;&gt; 32);\n        Output[5] = (byte)(Value &gt;&gt; 40);\n        Output[6] = (byte)(Value &gt;&gt; 48);\n        Output[7] = (byte)(Value &gt;&gt; 56);\n        return Output;\n    }\n\n    public static long LongFromByte(byte[] Value)\n    {\n        long Output = Value[0];\n        Output += ((long)Value[1] &lt;&lt; 8);\n        Output += ((long)Value[2] &lt;&lt; 16);\n        Output += ((long)Value[3] &lt;&lt; 24);\n        Output += ((long)Value[4] &lt;&lt; 32);\n        Output += ((long)Value[5] &lt;&lt; 40);\n        Output += ((long)Value[6] &lt;&lt; 48);\n        Output += ((long)Value[7] &lt;&lt; 56);\n        return Output;\n    }\n</code></pre>\n\n<p>Will using the above methods ensure endianness remains the same across any platform which is using them.</p>\n\n<p>Or will the result of either or change based on the endianness of the system processing the code?</p>\n\n<p>Thanking all.</p>\n"},{"tags":["c#","pdf","text-files"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":6101,"score":4,"question_id":1944576,"title":"Convert a pdf file to text in C#","body":"<p>I need to convert a .pdf file to a .txt file (or .doc, but I prefer .txt).</p>\n\n<p>How can I do this in C#?</p>\n"},{"tags":["c#","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13262936,"title":"Proper way to perform camera preview mirroring mode","body":"<p>Currently, when tested using <a href=\"http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622\" rel=\"nofollow\">Media capture using capture device sample</a>, I realize the camera is not something I want. <strong>I wish it to be in mirroring mode. Currently, it is not.</strong></p>\n\n<ol>\n<li><p>For a camera preview to be in mirroring mode, may I know is it hardware dependent or hardware independent. Possible that if I run the same code with different hardware, the camera preview will be in mirroring mode? If it is hardware dependent, how can I check whether my camera preview is in mirroring/non-mirroring mode?</p></li>\n<li><p>To make it in mirroring mode, I try to follow <a href=\"http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/51d3d2c2-0407-4c6d-9691-942939344aac\" rel=\"nofollow\">this thread</a>. I try <code>MediaCapture.SetPreviewMirroring(true)</code>. No effect as all. The camera preview is still in non-mirroring mode.</p></li>\n<li><p>I try <code>captureElement.RenderTransform = new ScaleTransform() { ScaleX = -1 };</code>. The whole camera preview become plain grey color.</p></li>\n<li><p>The last approach I would like to try, is try to perform flipping in C++ code through <code>MediaCapture.AddEffectAsync()</code>. However, that need to go back to my <strong>first question</strong>. Can I just simply perform flipping, or do I first need to check whether the incoming buffer is in mirroring/non-mirroring mode? If yes, how do I check?</p></li>\n</ol>\n"},{"tags":["c#","mysql","query","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13262638,"title":"Search datetime in MySQL","body":"<p>I have a MySQL database, there's a table which have column Time's Type is <strong>Nvachar(50)</strong> and <strong>its values</strong> is <strong>kind like this \"05/09/2012 20:53:40:843\"</strong> *<em>(Month-date-year hour:mins:second:msecond)</em>*</p>\n\n<p>Now I want to query to get a record have Time after \"10/05/2012 01:00:30 PM\".\nI had code in C# to converted it to \"05/10/2012 13:00:30\" before making a query.\nMy Query : </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>But i got no record. So please tell me how can I can make it return record have time after the time above ???  </p>\n\n<p>More Info My C# code :</p>\n\n<pre><code>string tableName = \"ABCDFEGH\";\nstring date = \"05/10/2012 13:00:30\";\n\nvar query = \"SELECT * FROM \" + tableName + \" WHERE capTime &gt; '\" + date + \"' LIMIT 0, 1\";\n\nvar cmd = new MySqlCommand(query, connection);\nMySqlDataReader dataReader = null;\ntry\n{\ndataReader = cmd.ExecuteReader();\n}\n</code></pre>\n\n<p>I'm so so so so so so sorry. I made a mistake the query must be</p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>This query is successful return the record i need :)</p>\n\n<p>But soemhow I have mistyped it into </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05-10-2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>Sorry again, topic close. But tks for evveryone tried :) </p>\n"},{"tags":["c#","asp.net","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13244767,"title":"unable to read a particular cell from excel using reader","body":"<p>I am importing excel into sql server db the excel sheet has three columns :   </p>\n\n<blockquote>\n  <p>id(number only)|data|passport  </p>\n</blockquote>\n\n<p>before importing it i want to check for certain things such as:<br>\n\n<li>the passport should begin a letter and rest of the characters must be numbers </li>\n<li>id must be numeric only </li></p>\n\n<p>I am able to check for passport but i am not able to check id even though i am using same code i used for checking passport. </p>\n\n<pre><code>             using (DbDataReader dr = command.ExecuteReader())\n        {\n            // SQL Server Connection String\n            string sqlConnectionString = \"Data Source=DITSEC3;Initial Catalog=test;Integrated Security=True\";\n\n            con.Open();\n            DataTable dt7 = new DataTable();\n            dt7.Load(dr);\n            DataRow[] ExcelRows = new DataRow[dt7.Rows.Count];\n            DataColumn[] ExcelColumn = new DataColumn[dt7.Columns.Count];\n\n            //=================================================\n            for (int i1 = 0; i1 &lt; dt7.Rows.Count; i1++)\n            {\n\n                if (dt7.Rows[i1][\"passport\"] == null)\n                {\n                    dt7.Rows[i1][\"passport\"] = 0;\n\n                }\n                if (dt7.Rows[i1][\"id\"] == null)\n                {\n                    dt7.Rows[i1][\"id\"] = 0;\n                }\n\n                string a = Convert.ToString(dt7.Rows[i1][\"passport\"]);\n                string b = dt7.Rows[i1][\"id\"].ToString();\n\n                if (!string.IsNullOrEmpty(b))\n                {\n                    int idlen = b.Length;\n\n                    for (int j = 0; j &lt; idlen; j++)\n                    {\n                        if (Char.IsDigit(b[j]))\n                        {\n                            //action\n                        }\n                        if(!Char.IsDigit(b[j]))\n                        {\n                            flag = flag + 1;\n                            int errline = i1 + 2;\n                            Label12.Text = \"Error at line: \" + errline.ToString();\n                            //Label12.Visible = true;\n                        }\n                    }\n                    if (!String.IsNullOrEmpty(a))\n                    {\n                        int len = a.Length;\n\n                        for (int j = 1; j &lt; len; j++)\n                        {\n                            if (Char.IsLetter(a[0]) &amp;&amp; Char.IsDigit(a[j]) &amp;&amp; !Char.IsSymbol(a[j]))\n                            {\n                                //action\n                            }\n                            else\n                            {\n                                flag = flag + 1;\n                                int errline = i1 + 2;\n                                Label12.Text = \"Error at line: \" + errline.ToString();\n                                //Label12.Visible = true;\n                            }\n\n\n                    }\n                }\n\n\n\n\n                 }\n</code></pre>\n\n<p>For some strange reason when i use breakpoint i can see the values of id as long as id is numeric in excel the moment flow comes to cell which has id as 25h547 the value if b turn \"\" any reason for this? i can give you entire code if you require. </p>\n"},{"tags":["c#","casting","floating-point","double","naudio"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":13259482,"title":"Loss of double precision C#","body":"<p>I am experiencing precision loss when im using doubles and i cant seem to find where the precision is lost.\nI am writing a software synthesizer and for some reason the input frequency for an oscillator(sound-wave generator) gets heavily aliased somewhere along the way.\nThe oscillator is supposed to generate a triangle waveform and the correct frequency is passed to the method but when the result is played in the speakers i can clearly hear that the sound snaps to different frequencies.</p>\n\n<p>I am using NAudio (http://naudio.codeplex.com/) and this method is run once for every sample i want to generate.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>double counter = 0;\nint samplecounter = 0;\n\npublic double GetNextTriangle(double frequency)\n{\n    double samplesperwave = (double)Parent.WaveFormat.SampleRate / frequency;\n    double length = (double)samplecounter / samplesperwave;\n    if (length.CompareTo(0.25) == -1)\n    {\n        counter = length * 4.0;\n    }\n    else if (length.CompareTo(0.75) == -1)\n    {\n        counter = 1.0 - (length - 0.25) * 4.0;\n    }\n    else\n    {\n        counter = -1.0 + (length - 0.75) * 4.0;\n    }\n    samplecounter++;\n    samplecounter = samplecounter &gt; samplesperwave ? 0 : samplecounter;\n    return counter;\n}\n</code></pre>\n\n<p>Thanks in advance! //Mats</p>\n"},{"tags":["c#","sap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13250845,"title":"bapi_material_savedata","body":"<p>I'm connecting .NET application with SAP using SAP .NET Connector.its working fine with \"BAPI_MATERIAL_SAVEDATA\" BAPI .\ni need to update field \"J_1IMTCHID - J_1IGRXREF\" which is not available in this bapi .Is it possible to update this field using extension of this bapi?</p>\n\n<p>or kindly help me for any other standard bapi for  updating this field \"J_1IMTCHID - J_1IGRXREF\" in sap while creating material?</p>\n\n<p>thanks in advance\nVignesh</p>\n"},{"tags":["c#","tabcontrol"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":237,"score":0,"question_id":7386777,"title":"C#: Add TabControl tab by name","body":"<p>I have form with TabControl. I can add Tab by doing:</p>\n\n<p><code>TabControl.TabPages.Add(TabPage)</code></p>\n\n<p><code>TabPage</code> is name of one of tab pages I have.</p>\n\n<p>I would like to do</p>\n\n<p><code>TabControl.TabPages.Add(\"TabPage\")</code></p>\n\n<p>Where <code>TabPage</code> is String object.</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["c#","filesysteminfo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13262755,"title":"DirectoryInfo().GetFileSystemInfos() - how to avoid hidden folders?","body":"<p>If I do this:</p>\n\n<pre><code>var entries = new DirectoryInfo(@\"C:\\Folder1\")\n                   .GetFileSystemInfos(\"test*\", SearchOption.AllDirectories);\n</code></pre>\n\n<p>when I have a folder structure like this, where the \"HiddenFolder\" is hidden but the \"test.txt\" file is not hidden:</p>\n\n<pre><code>C:\\Folder1\\\nC:\\Folder1\\HiddenFolder\\\nC:\\Folder1\\HiddenFolder\\test.txt\n</code></pre>\n\n<p>Then how can I code to NOT get the \"test.txt\" file?</p>\n\n<p>(You might think that GetFileSystemInfos would skip hidden folders, but it doesn't.)</p>\n\n<h3>Here is a partial solution</h3>\n\n<p>This code strips out hidden files and folders, but doesn't handle a non-hidden file inside a hidden folder!</p>\n\n<pre><code>  var includeLocalFolderNames = true; // to include folder names in the list\n\n  var hiddenFolders = new List&lt;FileSystemInfo&gt;();\n  return entries\n    .Where(entry =&gt;\n      {\n        // skip if this entry is hidden, or it is in a hidden folder\n\n        var isHidden = (entry.Attributes &amp; FileAttributes.Hidden) != 0;\n        if (isHidden)\n        {\n          hiddenFolders.Add(entry);\n          return false;\n        }\n        return !hiddenFolders.Any(fsi =&gt; entry.FullName.StartsWith(fsi.FullName));\n      })\n    .Where(entry =&gt;\n      {\n        // include folder names if requested...\n\n        if (includeLocalFolderNames) return true;\n        return (entry.Attributes &amp; FileAttributes.Directory) == 0;\n      })\n    .Select(entry =&gt; {\n        // do something...\n        return entry.Name;\n      });\n</code></pre>\n"},{"tags":["c#",".net","smtp","smtpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13260772,"title":"SmtpException: The client or server is only configured for e-mail addresses with ASCII local-parts","body":"<p>The <a href=\"http://msdn.microsoft.com/en-us/library/swas0fwc.aspx\" rel=\"nofollow\">SmtpClient.Send()</a> method is throwing this exception when I try to send an email to an address containing an accentuated character (é):</p>\n\n<blockquote>\n  <p>System.Net.Mail.SmtpException: The client or server is only configured\n  for e-mail addresses with ASCII local-parts: léo.xxx@xxx.com.<br>\n    at System.Net.Mail.MailAddress.GetAddress(Boolean allowUnicode)<br>\n    at System.Net.Mail.SmtpClient.ValidateUnicodeRequirement(MailMessage...)<br>\n    at System.Net.Mail.SmtpClient.Send(MailMessage message)  </p>\n</blockquote>\n\n<p>The formulation of the message makes me thing there might be a setting that I can activate to make this work, though I haven't found anything on this subject.</p>\n\n<p>I have tried several SMTP servers, including Gmail. Here are the relevant bits for a repro:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>var msg = new MailMessage();\nmsg.Subject = \"Test\";\nmsg.From = new MailAddress(\"xxx@gmail.com\");\nmsg.To.Add(new MailAddress(\"léo.yyy@gmail.com\"));\n\nnew SmtpClient().Send(msg);\n</code></pre>\n\n<p><strong>app.config</strong></p>\n\n<pre><code>&lt;system.net&gt;\n    &lt;mailSettings&gt;\n        &lt;smtp from=\"xxx@gmail.com\"&gt;\n            &lt;network host=\"smtp.gmail.com\" port=\"587\" userName=\"xxx@gmail.com\" password=\"password\" enableSsl=\"true\" /&gt;\n        &lt;/smtp&gt;\n    &lt;/mailSettings&gt;\n&lt;/system.net&gt;\n</code></pre>\n\n<p>Would appreciate any pointers. Thanks.</p>\n"},{"tags":["c#","c","mono","monomac","cfstring"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":191,"score":2,"question_id":7027962,"title":"Mono C# PInvoke - Get CFString from external lib","body":"<p>I have a lib that returns a CFString, and I'm trying to get that string value in C#..\nThe problem is that I don't know how to do this in C#..</p>\n\n<p>Making the external function return a CFString won't work as it throws an exception \"Type MonoMac.CoreFoundation.CFString which is passed to unmanaged code must have a StructLayout attribute.\"</p>\n\n<p>Then I thought that I could get the string as a byte array and then convert it to a string in C#, but then, I have another problem, I don't know how to convert in C the CFString to a byte array :/</p>\n\n<pre><code>C# Dll Import stuff\n[DllImport(\"lib\")]\npublic static extern MonoMac.CoreFoundation.CFString  test();   \n\n[DllImport(\"lib\")]\npublic static extern byte[] test();     \n\n\nC Library sample\nCFStringRef test()\n{\nreturn CFSTR(\"test string\");\n}\n</code></pre>\n\n<p>If anyone knows a way to do this please help me out ;)</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","spellchecking","stylecop"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":12682642,"title":"Specify path to CustomDictionary file for StyleCop spellchecking","body":"<p>Spell checking of the comments was added to the recent versions of StyleCop. It seems I can reuse my existing CustomDictionary file (that I created for FxCop) with StyleCop. SA1650 rule <a href=\"http://www.stylecop.com/docs/SA1650.html\" rel=\"nofollow\">documentation</a> does not say that it is possible. But in <a href=\"http://stylecop.codeplex.com/downloads/get/386813\" rel=\"nofollow\">release notes</a> for version 4.7.39 I see </p>\n\n<blockquote>\n  <p>Add support for specifying dictionary folders in the settings.StyleCop\n  file.</p>\n</blockquote>\n\n<p>How do I configure StyleCop to search for this file in the root folder of my solution?</p>\n"},{"tags":["c#","winforms","rdlc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":299,"score":0,"question_id":7412249,"title":"Khmer unicode doesn't display correctly in Microsoft Client Side Report(rdlc)","body":"<p>I building a winform application that records information using khmer unicode font. For my application i use c# with sqlserver and microsoft client report (rdlc) to generate reports. \nNow i have a problem with the rdlc report that does not display khmer unicode font correctly.\nIt displays like the image in the links below:</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRViewer.png</a></p>\n\n<p>It should look like this</p>\n\n<p><a href=\"http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png\" rel=\"nofollow\">http://i1138.photobucket.com/albums/n522/sandeep251183/CRExportHTML-1.png</a></p>\n\n<p>Can anyone find a solution for me?</p>\n"},{"tags":["c#","path","mono","monodevelop","monomac"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":424,"score":3,"question_id":6395688,"title":"Finding the path of an image file inside a monomac project","body":"<p>I am new to mono and monomac and i got stuck with something that i hope should be really easy to fix. </p>\n\n<p>In my application i want to change some images at runtime, so i created an \"Images\" folder with my pics inside the root of the project.\nBut when i try to change the image in my code the image can't be found, so i think i'm writing the wrong path.</p>\n\n<p>I try to get the image like this:</p>\n\n<pre><code>NSImage image = new NSImage(\"Images/image2.jpg\"); // I tried with different paths but nothing changed...\npic1.Image = image;\n</code></pre>\n\n<p>If i use the full path to the image, everything work fine, but i need to use a relative one.\nHow should i get the right relative path?</p>\n\n<p>I'm using Monodevelop.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","bing-maps-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13262745,"title":"Bing Map Service Auto Suggestion If Location Is Not Found","body":"<p>Does Bing have such a feature that if the query I sent doesn't have a match, it would return suggestions that might possibly match the location? </p>\n\n<p>Same with the <strong>Find Near</strong> in the <a href=\"http://www.bing.com/maps/\" rel=\"nofollow\">http://www.bing.com/maps/</a></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","export-to-excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13232408,"title":"How to export from sql to a formatted excel","body":"<p>I have a C# WPF application which interacts with SQL Server Database. In application I want user be able to export some kind of data from SQL to Excel. I'm trying firstly to fill a Datatable and then export it to excel file. Everything was fine, untill I faced up with a task to export a datatable filled with this sql query:<img src=\"http://i.stack.imgur.com/1zyeO.jpg\" alt=\"enter image description here\"></p>\n\n<p>to a formatted excel file like this:\n<img src=\"http://i.stack.imgur.com/CxKka.jpg\" alt=\"report\"></p>\n\n<p>So how can I sort selldetails of every sell in one region in excel file?\nIt's been a long time I'm puzzling my mind over this problem, please, help me!</p>\n"},{"tags":["c#","exit","monomac"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":181,"score":4,"question_id":7843097,"title":"Application shutdown in MonoMac","body":"<p>I'm trying to shutdown a MonoMac application by using <code>Environment.Exit(0)</code>. However, this call for some reason does not return. It does not throw an exception, either. When I execute the function in the immediate window in MonoDevelop, it times out.</p>\n\n<p>I have no idea how to approach debugging this. I thought that Environment.Exit kills the process...</p>\n"},{"tags":["c#","multicast"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13262639,"title":"C# udp multicast not reaching","body":"<p>I'm trying to make a simple discovery program. I am using UDP and multicast in order to make it but the problem is that it works on the loopback but it doesn't work on lan with my other computers.</p>\n\n<p>I would to know if I'm missing something in my code or maybe if my router could not have that functionality enabled... </p>\n\n<p>I am using the ipadress 230.0.0.1 which is meant to be used for multicast with the port 5567. Whenever I send something, the message box only appears on the sending computer, and not on the other comps.</p>\n\n<pre><code>using System;\nusing System.Net;\nusing System.Net.Sockets;    \nusing System.Text;\nusing System.Threading;\nusing System.Windows.Forms;\n\nnamespace Cobalt\n{\npublic class Discovery\n{\n\n    private IPAddress group;\n    private int port;\n    private Socket server;\n    private byte[] buffer;\n\n    public Discovery(IPAddress group, int port)\n    {\n        this.group = group;\n        this.port = port;\n\n        server = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);\n        //server.SetSocketOption(SocketOptionLevel.Udp,SocketOptionName.NoDelay,1);\n        //server.SetSocketOption(SocketOptionLevel.Socket,SocketOptionName.ReuseAddress,1); \n\n        server.Bind(new IPEndPoint(IPAddress.Any, port));\n\n        server.SetSocketOption(SocketOptionLevel.IP,SocketOptionName.MulticastTimeToLive, 1); \n        server.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(group));\n        buffer = new byte[1024];\n    }\n\n    public void Start()\n    {\n        var endPoint = (EndPoint) new IPEndPoint(IPAddress.Any, port);\n\n        server.BeginReceiveFrom(buffer, 0, buffer.Length, SocketFlags.None, ref endPoint, ReceiveData, null);\n    }\n\n    public void Send(String message)\n    {\n        var bytes = Encoding.UTF8.GetBytes(message);\n\n        var endPoint = (EndPoint) new IPEndPoint(group, port);\n\n        server.BeginSendTo(bytes, 0, bytes.Length, SocketFlags.None, endPoint, SendData, null);\n    }\n\n    // Callback!\n    private void SendData(IAsyncResult iar)\n    {\n        server.EndSendTo(iar);\n    }\n\n\n    // Callback!\n    private void ReceiveData(IAsyncResult iar)\n    {\n        var endPoint = (EndPoint)new IPEndPoint(IPAddress.Any, port);\n\n        int size = server.EndReceiveFrom(iar, ref endPoint);\n\n        if (size != 0)\n        {\n            MessageBox.Show(Encoding.UTF8.GetString(buffer).Trim());\n        }\n\n\n        server.BeginReceiveFrom(buffer, 0, buffer.Length, SocketFlags.None, ref endPoint, ReceiveData, 0);\n    }\n\n\n}\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","spark"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13262585,"title":"How to override view folder for one controller with Spark","body":"<p>I have two controllers which I want to use the same view folder.</p>\n\n<p>My two controllers are DocumentTypeAController and DocumentTypeBController which both inherit from a general document controller.</p>\n\n<p>My views are currently inside the ~\\views\\DocumentTypeA and I want the DocumentTypeB to reference the same views.</p>\n\n<p>How can I do this with the Spark view engine? (I'm using it with MVC2 [might be an oldish version])</p>\n"},{"tags":["c#","xaml","windows-8","winrt","winrt-xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13246151,"title":"Access Page resource element","body":"<p>How can I access page resource element in C# coding? I have the following piece of code in my XAML. I want to access the <code>image</code> element in my C# Code, but it is not accessible.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Page.Resources&gt;\n &lt;DataTemplate x:Key=\"Standard250x250ItemTemplate\"&gt;\n     &lt;Grid HorizontalAlignment=\"Left\" Width=\"150\" Height=\"150\"&gt;\n         &lt;Border Background=\"{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}\"&gt;\n             &lt;Image x:Name=\"image\" Source=\"{Binding Image}\"  Stretch=\"UniformToFill\" AutomationProperties.Name=\"{Binding Title}\" /&gt;\n         &lt;/Border&gt;    \n     &lt;/Grid&gt;\n &lt;/DataTemplate&gt;\n</code></pre>\n"},{"tags":["c#","mvvm","service","prism"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13254606,"title":"Force a service to close on Windows closing - Prism","body":"<p>I'm using a Prism and the MVVM pattern</p>\n\n<p>I've got a service running in a repository that is registered in my container like this:</p>\n\n<pre><code>_container.RegisterType&lt;ITheService, TheService&gt;();\n_container.RegisterType&lt;IRepository&lt;Order&gt;, Repository&gt;(new ContainerControlledLifetimeManager());\n</code></pre>\n\n<p>The constructor of the repository will subscribe to the service, that will then received new element (like 5 to 10 every second). \nThe problem is that because of this subscription, when i close the window of my GUI, the module holding the service is not closed, and the service keeps on running, instead of being shut down by the dispose. </p>\n\n<p>If i wasn't in MVVM i would just unsubsribe the service when i close the the window, but the shell window can't do that. </p>\n\n<p>I see 2 solutions\n* have an eventaggregator that will let my repository know when the shell close, and then unsubscribe the service (not sure it would work though)\n* resolve the repository from the shell (as it's registered as a singleton), and unsubscribe when the service, but that would be very ugly....</p>\n"},{"tags":["c#",".net","multithreading","architecture","software-engineering"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13261769,"title":"Best architecture to set a realtime logging window to write from different threads like output window in visualstudio","body":"<p>I am designing an application and it runs different components each on a different thread. I need a way to report back to the user interface the state of those components and the tasks they complete and if any errors occurred. My first approach was to write from all the different components to a log file. And then I monitored that file for changes, to reload the changes in a text box (my output window). However I noticed that using file monitor does not perform very well, and it slows downs the component threads and their tasks. So I was thinking to create something like the output windows in vs2010, where they can log any data while debugging, it seems to be very efficient, and can hold a lot of data. Any ideas what would be the best approach? One important fact, is that there should be a way to communicate all the component threads with the logging output window, to display results, avoid collisions, etc. I am using .NET 4.0</p>\n"},{"tags":["c#","windows","forms","upload","ftp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":46,"score":-1,"question_id":13262253,"title":"How to upload a folder through FTP?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2252000/upload-a-folder-by-ftp\">Upload a folder by FTP</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to upload a folder (and its content) through FTP but when I try to do it, I keep getting an error saying no file is selected.</p>\n\n<p><strong>Do you know any way to make it so it'll upload the folder and its content?</strong></p>\n\n<p>Here's the code I am using. (I want to upload all the files in the folder Plugins):</p>\n\n<pre><code>UploadFile(@\"C:\\\\MainPlugins\\\\Plugins\", \"ftp://testsiteurl.com/public_html/wp-content/plugins/test plugin\", \"username\", \"password\");\n</code></pre>\n\n<p>This is the sub I am using:</p>\n\n<pre><code>public void UploadFile(string _FileName, string _UploadPath, string _FTPUser, string _FTPPass)\n{\n    System.IO.FileInfo _FileInfo = new System.IO.FileInfo(_FileName);\n\n    // Create FtpWebRequest object from the Uri provided\n    System.Net.FtpWebRequest _FtpWebRequest = (System.Net.FtpWebRequest)System.Net.FtpWebRequest.Create(new Uri(_UploadPath));\n\n    // Provide the WebPermission Credintials\n    _FtpWebRequest.Credentials = new System.Net.NetworkCredential(_FTPUser, _FTPPass);\n\n    // By default KeepAlive is true, where the control connection is not closed\n    // after a command is executed.\n    _FtpWebRequest.KeepAlive = false;\n\n    // set timeout for 20 seconds\n    _FtpWebRequest.Timeout = 20000;\n\n    // Specify the command to be executed.\n    _FtpWebRequest.Method = System.Net.WebRequestMethods.Ftp.UploadFile;\n\n    // Specify the data transfer type.\n    _FtpWebRequest.UseBinary = true;\n\n    // Notify the server about the size of the uploaded file\n    _FtpWebRequest.ContentLength = _FileInfo.Length;\n\n    // The buffer size is set to 2kb\n    int buffLength = 2048;\n    byte[] buff = new byte[buffLength];\n\n    // Opens a file stream (System.IO.FileStream) to read the file to be uploaded\n    System.IO.FileStream _FileStream = _FileInfo.OpenRead();\n\n    try\n    {\n        // Stream to which the file to be upload is written\n        System.IO.Stream _Stream = _FtpWebRequest.GetRequestStream();\n\n        // Read from the file stream 2kb at a time\n        int contentLen = _FileStream.Read(buff, 0, buffLength);\n\n        // Till Stream content ends\n        while (contentLen != 0)\n        {\n            // Write Content from the file stream to the FTP Upload Stream\n            _Stream.Write(buff, 0, contentLen);\n            contentLen = _FileStream.Read(buff, 0, buffLength);\n        }\n\n        // Close the file stream and the Request Stream\n        _Stream.Close();\n        _Stream.Dispose();\n        _FileStream.Close();\n        _FileStream.Dispose();\n    }\n    catch (Exception ex)\n    {\n        MessageBox.Show(ex.Message, \"Upload Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n    }\n}\n</code></pre>\n"},{"tags":["c#","wpf","data-binding","binding","datagrid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13251456,"title":"Binding datagrid","body":"<p>I've been trying to bind DataGridTextColumns column-wise to arrays (int[] I think) and have been unsuccessful. Nothing I've found on msdn, stackoverflow etc has been particularly helpful .</p>\n\n<pre><code>&lt;DataGrid AutoGenerateColumns=\"False\" VerticalAlignment=\"Top\" Margin=\"0,47,0,0\" Height=\"351\" Name=\"dataGrid1\" IsReadOnly=\"True\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Slave Address\" Width=\"100\" Binding=\"{Binding SlaveAddressValues}\"/&gt;\n                &lt;DataGridTextColumn Header=\"Meter Readings\" Width=\"100\" Binding=\"{Binding MeterReadingValues}\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n</code></pre>\n\n<p>I've tried a number of things including putting binding in with datagrid instead or as well as datagridtextcolumns (itemsource etc), defining datacontext in code (I'd like to keep as much as possible out of code for mvvm reasons), using paths and sources, and also trying to combine my two arrays in a class (which isn't really what I want anyway). However nothing has worked in getting even the following simple test case to properly bind with the datagrid.</p>\n\n<pre><code>private int[] SlaveAddressValues = { 0, 0, 0, 0 };\nprivate int[] MeterAddressValues = { 2, 2, 2, 3 };\n</code></pre>\n\n<p>Anyone got any ideas?</p>\n\n<p>Right, maybe I should have put my solution here but it was a bit long so I put it as an answer. it's one of many ways anyway so post another answer if you feel so inclined.</p>\n"},{"tags":["c#",".net","reference-type","idictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":101,"score":4,"question_id":13262106,"title":"Dictionary.ContainsKey() - How does it work?","body":"<p>I've read the MSDN documentation on how <code>Dictionary.ContainsKey()</code> works, but I was wondering how it actually makes the equality comparison? Basically, I have a dictionary keyed to a reference type* and I want the <code>ContainsKey()</code> method to check a certain property of that reference type as its basis for determining if the key exists or not. For example, if I had a <code>Dictionary(MyObject, int)</code> and <code>MyObject</code> has a public property (of <code>int</code>) called \"TypeID\", could I get <code>ContainsKey(MyObject myObject)</code> to check to see if one of the keys has a <code>TypeID</code> that is equal to <code>myObject</code>? Could I just overload the <code>==</code> operator?</p>\n\n<ul>\n<li>The reference type is an object called \"Duration\" which holds a value (<code>double Length</code>); \"Duration\" is a base type used in my music program to denote how long a particular sound lasts. I derive classes from it which incorporate more sophisticated timing concepts, like Western musical time signatures, but want all of them to be comparable in terms of their length.</li>\n</ul>\n\n<p>EDIT: As suggested, I implemented IEquitable on my object like so:</p>\n\n<pre><code> public class Duration : IEquatable&lt;Duration&gt;\n {\n    protected double _length;\n\n    /// &lt;summary&gt;\n    /// Gets or Sets the duration in Miliseconds.\n    /// &lt;/summary&gt;\n    public virtual double Length\n{\n        get\n        {\n            return _length;\n        }\n        set\n        {\n            _length = value;\n        }\n    }\n\n// removed all the other code that as it was irrelevant\n\n    public override bool Equals(object obj)\n    {\n        Duration otherDuration = (Duration)obj;\n        if (otherDuration._length == _length)\n        {\n            return true;\n        }\n        else\n        {\n            return false\n        }\n    }\n\n}\n</code></pre>\n\n<p>Is this all I need to do?</p>\n"},{"tags":["c#","xml-parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":47,"score":-3,"question_id":13262424,"title":"What are the popular ways of parsing XML?","body":"<p>I've seen a number of threads that are about 3 years old now about parsing XML in C#.</p>\n\n<p>Have any new methods arisen, aside from XML Document? I saw a reference in a thread about LINQ to XML, but the examples for converting the XML document into an object was a bit thin. </p>\n"},{"tags":["c#","asp.net","c#-3.0","metadata","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1423,"score":1,"question_id":8291733,"title":"ASP.NET login control connection string error : Keyword not supported: 'metadata'","body":"<p>I was working with normal connection until now and everything was smooth\nbut now I have switched to data entity model and with new connection string, I am having this error... How can i keep my entity string for my data manipulation and use the regular conn string only for login control?</p>\n\n<pre><code>Keyword not supported: 'metadata'.\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.\n\nException Details: System.ArgumentException: Keyword not supported: 'metadata'.\n\nSource Error:\n\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.\n\nStack Trace:\n\n[ArgumentException: Keyword not supported: 'metadata'.]\n   System.Data.Common.DbConnectionOptions.ParseInternal(Hashtable parsetable, String connectionString, Boolean buildChain, Hashtable synonyms, Boolean firstKey) +5055124\n   System.Data.Common.DbConnectionOptions..ctor(String connectionString, Hashtable synonyms, Boolean useOdbcRules) +98\n   System.Data.SqlClient.SqlConnectionString..ctor(String connectionString) +64\n   System.Data.SqlClient.SqlConnectionFactory.CreateConnectionOptions(String connectionString, DbConnectionOptions previous) +24\n   System.Data.ProviderBase.DbConnectionFactory.GetConnectionPoolGroup(String connectionString, DbConnectionPoolGroupOptions poolOptions, DbConnectionOptions&amp; userConnectionOptions) +150\n   System.Data.SqlClient.SqlConnection.ConnectionString_Set(String value) +59\n   System.Data.SqlClient.SqlConnection.set_ConnectionString(String value) +4\n   System.Data.SqlClient.SqlConnection..ctor(String connectionString) +26\n   System.Web.DataAccess.SqlConnectionHolder..ctor(String connectionString) +54\n\n[ArgumentException: An error occurred while attempting to initialize a System.Data.SqlClient.SqlConnection object. The value that was provided for the connection string may be wrong, or it may contain an invalid syntax.\nParameter name: connectionString]\n   System.Web.DataAccess.SqlConnectionHolder..ctor(String connectionString) +136\n   System.Web.DataAccess.SqlConnectionHelper.GetConnection(String connectionString, Boolean revertImpersonation) +119\n   System.Web.Security.SqlMembershipProvider.GetPasswordWithFormat(String username, Boolean updateLastLoginActivityDate, Int32&amp; status, String&amp; password, Int32&amp; passwordFormat, String&amp; passwordSalt, Int32&amp; failedPasswordAttemptCount, Int32&amp; failedPasswordAnswerAttemptCount, Boolean&amp; isApproved, DateTime&amp; lastLoginDate, DateTime&amp; lastActivityDate) +827\n   System.Web.Security.SqlMembershipProvider.CheckPassword(String username, String password, Boolean updateLastLoginActivityDate, Boolean failIfNotApproved, String&amp; salt, Int32&amp; passwordFormat) +105\n   System.Web.Security.SqlMembershipProvider.ValidateUser(String username, String password) +106\n   System.Web.UI.WebControls.Login.AuthenticateUsingMembershipProvider(AuthenticateEventArgs e) +60\n   System.Web.UI.WebControls.Login.OnAuthenticate(AuthenticateEventArgs e) +129\n   System.Web.UI.WebControls.Login.AttemptLogin() +127\n   System.Web.UI.WebControls.Login.OnBubbleEvent(Object source, EventArgs e) +101\n   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37\n   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +125\n   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +167\n   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10\n   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13\n   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36\n   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563\n</code></pre>\n\n<p>Connection string</p>\n\n<pre><code>&lt;connectionStrings&gt;\n    &lt;add name=\"LoginDB\" connectionString=\"Data Source=****;Initial Catalog=int422_113b16;User ID=****;Password=****\" /&gt;\n    &lt;add name=\"BlogEntities\" connectionString=\"metadata=res://*/App_Code.BlogModel.csdl|res://*/App_Code.BlogModel.ssdl|res://*/App_Code.BlogModel.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source****;initial catalog=int422_113b16;user id=****;password=****;multipleactiveresultsets=True;App=EntityFramework&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n&lt;/connectionStrings&gt;\n</code></pre>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":1118,"score":-1,"question_id":9096078,"title":"How to download a file to a specific path in from a given url in a windows form?","body":"<p>I need to download pdf files from a specified links(url) to a specific folder in a windows application using winforms please any one can suggest me with a solution.</p>\n"},{"tags":["c#","casting","boxing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13262024,"title":"Trying to understand Type Casting & Boxing/Unboxing","body":"<p>I'm currently trying to get my head around casting and boxing. As i understand it currently:</p>\n\n<ul>\n<li>Boxing - Value Type to Reference Type (ie int to object)</li>\n<li>Unboxing - Reference Type to Value Type (ie object to int)</li>\n<li>Type Casting - Seems to me at the moment to be similar to boxing but\nallows you to assign what type of object you would like the Reference\nType to be of. (ie int to customObjectType)</li>\n</ul>\n\n<p>The example im working with at the moment to try and get my around it.\nSay I have 2 classes, a method in one class calls the constructor of the other.</p>\n\n<pre><code>//1st class\npublic class FirstClass\n{\n  //code for fields,constructor &amp; other methods\n\n  public void CallOtherClass(int firstClassID)\n  {\n   int x = firstClassID;\n   SecondClass test = new SecondClass(x);\n  }\n\n}\n\n//2nd class\npublic class SecondClass\n{\n   public SecondClass(FirstClass firstClass)\n   {\n    //set some fields\n   }\n} \n</code></pre>\n\n<p>Ok, so in the above scenario we would have a problem as the method CallOtherClass attempts to set the constructor of SecondClass, however the constructor of SecondClass takes a parameter of type FirstClass and all we can provide is an int.</p>\n\n<p>So as i understand it this would be a good time to use type casting? Something like below.</p>\n\n<pre><code>//1st class\npublic class FirstClass\n{\n  //code for fields,constructor &amp; other methods\n\n  public void CallOtherClass(int firstClassID)\n  {\n   int x = firstClassID;\n\n   FirstClass a;\n   a = (FirstClass)x;\n\n   SecondClass test = new SecondClass(a);\n  }\n\n}\n\n//2nd class\npublic class SecondClass\n{\n   public SecondClass(FirstClass firstClass)\n   {\n    //set some fields\n   }\n}\n</code></pre>\n\n<p>In my head this seems to me to change the type of x to a reference type of FirstClass. Obviously my understanding is way off some where along the lines as it produces an error</p>\n\n<pre><code>\"Cannot convert type 'int' to 'Namespace.FirstClass\"\n</code></pre>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#","drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13262078,"title":"Draw a overlaying rectangle (example)","body":"<p>How would I go about drawing a rectangle like this image?\n(Notice rectangle slight grey in the middle)\n<a href=\"http://puu.sh/1niK2\" rel=\"nofollow\">Screenshot</a></p>\n\n<p>I've got drawing Rectangles on Forms/PictureBox's ect but for the of me can't figure out how to do it over all your open applications.</p>\n\n<p>Any feedback will be much appreciated</p>\n"},{"tags":["c#","sql-server","vs2010-express"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":130,"score":0,"question_id":13213644,"title":"Windows Form Application and SQL Server","body":"<p><strong>UPDATE 2</strong></p>\n\n<p>I fixed the error by adding <code>System.Configuration</code> to the reference file.   I had already added it to my class with <code>using System.Configuration;</code><br>\nI found the answer here: <a href=\"http://stackoverflow.com/questions/1274852/the-name-configurationmanager-does-not-exist-in-the-current-context/1836938#comment18074599_1836938\">The name 'ConfigurationManager' does not exist in the current context</a></p>\n\n<p>Any further issues will be addressed in a new question.</p>\n\n<p><strong>Original(ish) Post</strong></p>\n\n<p>I have Microsoft SQL Server Management Studio. In the studio I created a database called <code>Logbook</code> that exists locally on my computer.   </p>\n\n<p>I have also created a user interface using a Windows forms application in VS C# Express. I would like to connect it to my logbook database in order to update, select, delete, and insert entries into the database through the UI.</p>\n\n<p>However, I cannot figure out how connect the two. I have played around with the \"Add new data source\" wizard to no avail. I also cannot find anything helpful in the MSDN or other tutorials online.   </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I created a new database and project to work with until I figure out how to properly do this so I don't accidently break anything in my project.<br>\nThe Schema is:</p>\n\n<pre><code>Student(sid: int, fname: char(10), lname: char(10), age:int, major:char(10))\nCourse(cid:int, desc:char(50), dept:char(10))\nEnrolled(sid:int, cid:int, quarter:char(10), grade:char(10))\n</code></pre>\n\n<p>Here is the connection string generated by the \"Add Data Source\" wizard</p>\n\n<pre><code>&lt;add name=\"boathouseLogConnectionString\"\n        connectionString=\"Data Source=.\\SQLEXPRESS;AttachDbFilename=&amp;quot;C:\\Program Files\\Microsoft SQL Server\\MSSQL11.SQLEXPRESS\\MSSQL\\DATA\\boathouseLog.mdf&amp;quot;;Integrated Security=True;Connect Timeout=30;User Instance=True\"\n        providerName=\"System.Data.SqlClient\" /&gt;\n</code></pre>\n\n<p>I have successfully gotten my database into the project.  However, when I try running a stored procedure I get this error <code>Argument Exception was unhandled.  Format of the initialization string does not conform to specification starting at index 0.</code></p>\n\n<p>The error occurs on line 2.  </p>\n\n<pre><code>        DataTable dt = new DataTable();\n        SqlConnection sqlConn = new SqlConnection(selectedConnectionString);\n        SqlCommand myCommand = new SqlCommand(\"proc_getMember\", sqlConn);\n        myCommand.CommandType = CommandType.StoredProcedure;\n        SqlDataAdapter da = new SqlDataAdapter(myCommand); \n</code></pre>\n\n<p>the <code>selectedConnectionString</code> variable is set to <code>boathouseLogConnectionString</code></p>\n"},{"tags":["c#","oop","design","srp"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13246977,"title":"Understand Single Responsibility Principle of SOLID design","body":"<p>I'm currently trying to learn the SOLID design principles along with behavior driven development, but am having quite the hard time getting my head around the Single Responsibility Principle.  I've tried to find a good tutorial for c# that uses test driven development, but haven't been able to find anything worthwhile in that vein.  Anyway, after spending a few days reading about it, I decided the best way to learn is by experience, so I started creating a small app using those principles best I can.  </p>\n\n<p>It's a simple bowling score calculator.  I figured the best way to go about it was to work from the simplest part up, so I started at the ball (or throw) level.  Right now I have created tests and an interface and class for dealing with ball(throw) scores, which makes sure they aren't invalid, ie. <code>&lt;10</code> or <code>&gt;0</code>.  After implementing this I realized that the ball class is basically just a nullable integer, so maybe I don't even need it... but for now it's there.</p>\n\n<p>Following the ball, I decided the next logical thing to add was a frame interface and class.  This is where I have gotten stuck.  Here is where I'm at:</p>\n\n<pre><code>namespace BowlingCalc.Frames\n{\n    public interface IFrame : BowlingCalc.Generic.ICheckValid\n    {\n        void AddThrow(int? score);\n        int? GetThrow(int throw_number);\n    }\n}\n\nnamespace BowlingCalc.Frames\n{\n    public class Frame : IFrame\n    {\n        private List&lt;Balls.IBall&gt; balls;\n        private Balls.IBall ball;\n        private int frame_number;\n\n        public Frame(Balls.IBall ball, int frame_number)\n        {\n            this.ball = ball;\n            this.frame_number = frame_number;\n            balls = new List&lt;Balls.IBall&gt;();\n            check_valid();\n        }\n\n        public void AddThrow(int? score)\n        {\n            var current_ball = ball;\n            current_ball.Score = score;\n            balls.Add(current_ball);\n        }\n\n        public int? GetThrow(int throw_number)\n        {\n            return balls[throw_number].Score;\n        }\n\n        public void check_valid()\n        {\n            if (frame_number &lt; 0 || frame_number &gt; 10)\n            {\n                throw (new Exception(\"InvalidFrameNumberException\"));\n            }\n        }\n\n    }\n}\n</code></pre>\n\n<p>The frame uses my previously implemented ball class through dependency injection to add ball scores to the frame.  It also implements a way to return the score for any given ball in the frame.</p>\n\n<p>What I want to do, and where I'm stuck, is I want to add a way to make sure the frame score is valid. (For the moment just the simple case of frames 1-9, where the combined score of both balls must be 10 or less.  I will move on to the  much more complicated frame 10 case later.)</p>\n\n<p>The problem is I have no idea how to implement this in a SOLID way.  I was thinking of adding the logic into the class, but that seems to go against the single responsibility principle.  Then I thought to add it as a separate interface/class and then call that class on each frame when its score updates.  I also thought of creating a separate interface, <code>IValidator</code> or something like that, and implementing that in the Frame class.  Unfortunately, I have no idea which, if any, of these is the best/SOLID way of doing things.</p>\n\n<p>So, what would be a good, SOLID way to implement a method that validates the score of a frame?</p>\n\n<hr>\n\n<p>Note: Any critique of my code is very welcome.  I am very excited learn to create better code, and happy to receive any help given.</p>\n"},{"tags":["c#","process","foreach"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13261997,"title":"Launch processes one after another in C#","body":"<p>Is there a way to iterate through an array/list and launch a process, and wait until it's exited until launching the next, and so on?</p>\n\n<p>I have the code:</p>\n\n<pre><code>string[] processPaths = new string[]{ @\"c:\\foo.exe\", @\"c:\\bar.exe\" };\nforeach(string s in processPaths){\n    Process p = new Process();\n    p.Exited += (obj, ev) =&gt; { continue; };\n}\n</code></pre>\n\n<p>but obviously processes are executed asynchronously and the lambda function isn't part of the <code>foreach</code> loop. It's a console application, and I don't mind if it runs on the main thread.</p>\n"},{"tags":["c#","dependency-injection","ninject"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":13214047,"title":"Ninject Property Injection on base class","body":"<p>I'm attempting to inject a property using <code>ninject</code>. Given the two bindings in the <code>ninject</code> module below, I would expect the <code>ConcreteDependency</code> to be injected into <code>B</code>. <br>However, it seems that <code>WhenInjectedInto</code> doesn't consider the type being injected into, just the declaring type of the target (property in this case).</p>\n\n<p>Is there a way to achieve the behaviour I expected?</p>\n\n<pre><code>static void Main(string[] args)\n{\n    var kernel = new StandardKernel(new TestModule());\n    var b = kernel.Get&lt;B&gt;();\n    var c = kernel.Get&lt;C&gt;();\n}\n\nclass TestModule : NinjectModule\n{\n    public override void Load()\n    {\n        Bind&lt;IDependency&gt;().To&lt;EmptyDependency&gt;();\n        Bind&lt;IDependency&gt;().To&lt;ConcreteDependency&gt;().WhenInjectedInto&lt;B&gt;();\n    }\n}\n\nabstract class A\n{\n    [Inject]\n    public IDependency Dependency { get; set; }\n}\n\nclass B : A {}\n\nclass C : A {}\n\ninterface IDependency {}\n\nclass EmptyDependency : IDependency { }\n\nclass ConcreteDependency : IDependency { }\n</code></pre>\n"},{"tags":["c#",".net","httpwebrequest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13261046,"title":"Executing web requests inside of a loop only works on the first pass","body":"<p>I am taking a string message and breaking it up into chunks so that I can send it to an sms service (that consequently doesn't break it up for you). I after I do my work for break those messages up, I try loop through the resulting array and execute a web request. The problem is that it only works for the first message, and then hangs after that. After a short time, I get an error message saying \"The connection was closed unexpectedly.\" This occurs at the second time it attempts GetResponse(); I've seen a few other posts on here that were simply saying to close and dispose the response and request streams. This isn't working for me at all. This is where my code is currently:</p>\n\n<pre><code>private static void Main(string[] args)\n{\n    var oldMessage = GetFileString();\n    Console.WriteLine(string.Format(\"Old message: {0}\", oldMessage.Length));\n\n    var newMessage = UrlPathEncodeString(oldMessage);\n    Console.WriteLine(string.Format(\"New message: {0}\", newMessage.Length));\n\n    var brokenUp = SplitByLength(newMessage, 145).ToArray();\n    for(var i = 0; i &lt; brokenUp.Count(); i++)\n    {\n        brokenUp[i] = brokenUp[i].Insert(0, UrlPathEncodeString(string.Format(\"({0:D2} of {1:D2})\", i + 1, brokenUp.Count())));\n        Console.WriteLine(string.Format(\"Appended length: {0}\", brokenUp[i].Length));\n    }\n\n    System.Net.ServicePointManager.DefaultConnectionLimit = 100;\n    foreach (var block in brokenUp)\n    {\n        Thread.Sleep(1500);\n        SendSms((HttpWebRequest)WebRequest.Create(\"http://172.20.5.214:90/method/sendsms\"), block);\n    }\n    Console.ReadKey();\n}\n\npublic static void SendSms(HttpWebRequest request, string message)\n{\n    //build the request\n    var url = \"http://ipaddress/method/sendsms\";\n    //var request = (HttpWebRequest)WebRequest.Create(url);\n    request.Method = \"POST\";\n    request.ContentType = \"application/x-www-form-urlencoded\";\n\n    var fields = \"CellNumber={0}&amp;Message={1}\";\n    fields = string.Format(fields, \"16021234567\", message);\n\n    var fieldsBytes = Encoding.UTF8.GetBytes(fields);\n    request.ContentLength = fieldsBytes.Length;\n    var length = fieldsBytes.Length;\n\n    using (var requestStream = request.GetRequestStream())\n    {\n        requestStream.Write(fieldsBytes, 0, length);\n\n        using (var response = request.GetResponse())\n        {\n            using (var responseStream = response.GetResponseStream())\n            {\n                responseStream.Close();\n            }\n        }\n        requestStream.Close();\n    }\n}\n\npublic static byte[] ReadFully(Stream stream)\n{\n    var buffer = new byte[32768];\n    using (var ms = new MemoryStream())\n    {\n        while (true)\n        {\n            int read = stream.Read(buffer, 0, buffer.Length);\n            if (read &lt;= 0)\n                return ms.ToArray();\n            ms.Write(buffer, 0, read);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","directx","texture","directx-11","sharpdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13261427,"title":"SharpDX: Initializing a Texture2D from a DataStream fails (though Texture1D works fine)","body":"\n\n<p>I'm trying to create a SharpDX.Direct3D11.Texture2D from in-memory data but always get a SharpDXException (HRESULT: 0x80070057, \"The parameter is incorrect.\"). I have used a Texture1D for this purpose before which can be created without a problem.</p>\n\n<p>I have reduced the code to this sample which still produces the exception:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using (var device = new Device(DriverType.Hardware, DeviceCreationFlags.Debug)) {\n    // empty stream sufficient for example\n    var stream = new DataStream(16 * 4, true, true);\n\n    var description1D = new Texture1DDescription() {\n        Width = 16,\n        ArraySize = 1,\n        Format = Format.R8G8B8A8_UNorm,\n        MipLevels = 1,\n    };\n    using (var texture1D = new Texture1D(device, description1D, new[] { new DataBox(stream.DataPointer) })) {\n        // no exception on Texture1D\n    }\n\n    var description2D = new Texture2DDescription() {\n        Width = 8,\n        Height = 2,\n        ArraySize = 1,\n        MipLevels = 1,\n        Format = Format.R8G8B8A8_UNorm,\n        SampleDescription = new SampleDescription(1, 0),\n    };\n    using (var texture2D = new Texture2D(device, description2D, new[] { new DataBox(stream.DataPointer) })) {\n        // HRESULT: [0x80070057], Module: [Unknown], ApiCode: [Unknown/Unknown], Message: The parameter is incorrect.\n    }\n}\n</code></pre>\n\n<p>Creating the texture without passing the data works fine. Can someone tell me how to fix the Texture2D initialization?</p>\n"},{"tags":["c#","webbrowser","web-scraping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":13261927,"title":"c# HTML web scriping how to handle link click to download files","body":"<p>In C# windows app, I am using WebBrowser Control and loading a page. I am able to push the required input details into the dropdowns and also hitting a button. It shows me a list of records with links to download files. I want to click and save the document in my c# windows app. How can i do that?</p>\n\n<p><a href=\"http://www.ceoandhra.nic.in/ceonew/home.aspx\" rel=\"nofollow\">http://www.ceoandhra.nic.in/ceonew/home.aspx</a></p>\n\n<p>In this site, Click on PDF Electrol Rolls.</p>\n\n<p>Please help me out.....</p>\n"},{"tags":["c#","error-handling","comexception"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":181,"score":1,"question_id":11729385,"title":"C# - UrlHistoryWrapper class - Not enough storage is available to process this command. (Exception from HRESULT: 0x80070008)","body":"<p>I am getting values from a database, and trying to insert them into Internet Explorers history, using the UrlHistoryWrapper class. When I set the <code>for</code> conditions to something in the thousands, I will get this error, however, when I set the for condition to less than 100, it will run fine. I have checked the memory usage, and it should cause no problems. How can I make this code able to run, if chrome.URLs and firefox.URLs have thousands of values?</p>\n\n<p>This is my code:</p>\n\n<pre><code>UrlHistoryWrapperClass urlHistory;\n        UrlHistoryWrapperClass.STATURLEnumerator enumerator;\n        List&lt;STATURL&gt; list = new List&lt;STATURL&gt;();\n        urlHistory = new UrlHistoryWrapperClass();\n        enumerator = urlHistory.GetEnumerator();\n        bool display = false;\n        chrome.GetHistory(display);\n        for (int i = 0; i &lt; chrome.URLs.Count; i++ )\n        {\n            URL url = chrome.URLs[i];\n            urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        }\n        Firefox firefox = new Firefox();\n        firefox.GetHistory(display:false);\n        foreach (URL url in firefox.URLs)\n        {\n            MessageBox.Show(url.url);\n\n            urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        }\n</code></pre>\n\n<p>And this is my error:</p>\n\n<blockquote>\n  <p><em><strong></em>**<em>*</em>**<em></strong> Exception Text <strong></em>**<em>*</em>****</strong> \n  System.Runtime.InteropServices.COMException (0x80070008): Not enough\n  storage is available to process this command. (Exception from HRESULT:\n  0x80070008)    at UrlHistoryLibrary.IUrlHistoryStg2.AddUrl(String\n  pocsUrl, String pocsTitle, ADDURL_FLAG dwFlags)    at\n  UrlHistoryLibrary.UrlHistoryWrapperClass.AddHistoryEntry(String\n  pocsUrl, String pocsTitle, ADDURL_FLAG dwFlags)    at\n  Namespace.IE.SyncIE() in C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\URLHistory.cs:line 270    at\n  Namespace.Program.SyncAll() in C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\URLHistory.cs:line 152    at\n  TestURLGUI2.Form1.button11_Click(Object sender, EventArgs e) in\n  C:\\Users\\Chris\\documents\\visual studio\n  2010\\Projects\\TestURLGUI4\\TestURLGUI4\\Form1.cs:line 247    at\n  System.Windows.Forms.Control.OnClick(EventArgs e)    at\n  System.Windows.Forms.Button.OnClick(EventArgs e)    at\n  System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)    at\n  System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons\n  button, Int32 clicks)    at\n  System.Windows.Forms.Control.WndProc(Message&amp; m)    at\n  System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)    at\n  System.Windows.Forms.Button.WndProc(Message&amp; m)    at\n  System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n  at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp;\n  m)    at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32\n  msg, IntPtr wparam, IntPtr lparam)</p>\n</blockquote>\n\n<p>Edit:</p>\n\n<p>Here is my new code:</p>\n\n<pre><code>    for (var i = 0; i &lt; firefox.URLs.Count; i++ )\n    {\n        URL url = firefox.URLs[i];\n        urlHistory.AddHistoryEntry(url.url, url.title, ADDURL_FLAG.ADDURL_ADDTOHISTORYANDCACHE);\n        Thread.Sleep(3);\n        form.label1.Text = i + \"/\" + firefox.URLs.Count;\n      //  MessageBox.Show(url.url);\n        Application.DoEvents();\n    }\n</code></pre>\n\n<p>Now, with this code, I can go up to 8447 without getting this error, but then it gets thrown.</p>\n\n<p>I had someone else try to do this, and this is what he said:</p>\n\n<blockquote>\n  <p>Just tried your code and and it seems that there is a limit on the\n  number of the url records that can be added.   I did the following\n  steps.</p>\n  \n  <ol>\n  <li>In Internet Explorer, Clear the history of websites I've visited.</li>\n  <li>I tried your code.</li>\n  <li>Got a COMException (0x80070008): Not enough storage is available to process this command. The exception is thrown at record number 41021\n  for me (Windows 7, 64bit).</li>\n  <li>I tried your code again, and Got a very same exception. This time, No record have be added.   To add the url records again. I have\n  to clear the history of websites in Internet Explorer.   I could not\n  find a way to fix the problem.</li>\n  </ol>\n</blockquote>\n\n<p>For anyone who needs to know, the source code for the URLhistoryWrapper can be found on <a href=\"http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=7500\" rel=\"nofollow\">this CodeProject project</a>.</p>\n"},{"tags":["c#","linq-to-xml"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12838207,"title":"C# - Linq to XML - Exclude elements from query","body":"<p>I have this XML file:</p>\n\n<pre><code>&lt;MyXml&gt;\n    &lt;MandatoryElement1&gt;value&lt;/MandatoryElement1&gt;\n    &lt;MandatoryElement2&gt;value&lt;/MandatoryElement2&gt;\n    &lt;MandatoryElement3&gt;value&lt;/MandatoryElement3&gt;\n    &lt;CustomElement1&gt;value&lt;/CustomElement1&gt;\n    &lt;CustomElement2&gt;value&lt;/CustomElement2&gt;\n&lt;MyXml&gt;\n</code></pre>\n\n<p>All 3 elements that are called 'MandatoryElementX' will always appear in the file. The elements called 'CustomElementX' are unknown. These can be added or removed freely by a user and have any name.<br><br>\nWhat I need is to fetch all the elements that are not MandatoryElements. So for the file above I would want this result:</p>\n\n<pre><code>&lt;CustomElement1&gt;value&lt;/CustomElement1&gt;\n&lt;CustomElement2&gt;value&lt;/CustomElement2&gt;\n</code></pre>\n\n<p>I don't know what the names of the custom elements may be, only the names of the 3 MandatoryElements, so the query needs to somehow exclude these 3.</p>\n\n<p><strong>Edit</strong>:<br>\nEven though this was answered, I want to clarify the question. Here is an actual file:</p>\n\n<pre><code>&lt;Partner&gt;\n    &lt;!--Mandatory elements--&gt;\n    &lt;Name&gt;ALU FAT&lt;/Name&gt;\n    &lt;InterfaceName&gt;Account Lookup&lt;/InterfaceName&gt;\n    &lt;RequestFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Requests\\ALURequests&lt;/RequestFolder&gt;\n    &lt;ResponseFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Responses&lt;/ResponseFolder&gt;\n    &lt;ArchiveMessages&gt;Yes&lt;/ArchiveMessages&gt;\n    &lt;ArchiveFolder&gt;C:\\Documents and Settings\\user1\\Desktop\\Archive&lt;/ArchiveFolder&gt;\n    &lt;Priority&gt;1&lt;/Priority&gt;\n\n    &lt;!--Custom elements - these can be anything--&gt;\n    &lt;Currency&gt;EUR&lt;/Currency&gt;\n    &lt;AccountingSystem&gt;HHGKOL&lt;/AccountingSystem&gt;\n&lt;/Partner&gt;\n</code></pre>\n\n<p>The result here would be:</p>\n\n<pre><code>&lt;Currency&gt;EUR&lt;/Currency&gt;\n&lt;AccountingSystem&gt;HHGKOL&lt;/AccountingSystem&gt;\n</code></pre>\n"},{"tags":["c#","ocr","screen-scraper"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":649,"score":2,"question_id":1494035,"title":"Screen scraper application (not HTML)","body":"<p></p>I need screen scraper application which will recognize text from the screen (and not use winapi to do this so source could be in image file). I found a lot of commercial solutions, but I need something open source or free.\nI plan to include it in my C# project, so there should be some SDK available.\n</p>Thanks.</p>\n"},{"tags":["c#",".net","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13261314,"title":"Windows Forms controls decoration","body":"<p>I am new to C# and I am trying to build my own simplified Windows Explorer. I want to apply Windows theme to decorate treeview and listview. I cam accross this great <a href=\"http://stackoverflow.com/questions/3014816/visualstylerenderer-and-themes-winforms\">link</a>, but have no idea how to attach these to my treeview. I am looking for detailed answer. As far, I understood only that I need to set DrawMode to OwnerDrawAll. What is next?</p>\n"},{"tags":["c#","wcf","x509certificate","ws-security"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":323,"score":6,"question_id":12832213,"title":"How to make WCF Client conform to specific WS-Security - sign UsernameToken and SecurityTokenReference","body":"<p>I need to create a wcf client to call a service that I have no control over. </p>\n\n<p>I have been given a wsdl and a working soapui project.</p>\n\n<p>The service uses both a username/password and a x509 certificate.</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>I now understand what the problem is, but am still unsure what steps I need to take to be able to create the required message, so any help would be much appreciated.</p>\n\n<p>I need to sign both the UsernameToken and the SecurityTokenReference.</p>\n\n<p>The code I had to create the custom binding has been removed from this post as its no longer used. I no longer add a SecurityBindingElement to the binding, instead I add a new behaviour that writes the security element into the header.</p>\n\n<p>So the security node is created from scratch by subclassing the SignedXml class, adding signing references and then calling ComputeSignature to create the Signature node within the Security header.</p>\n\n<p>You need to pass the xml to sign into the SignedXml constructor for this to work. It is no problem passing in the UsernameToken and this appears to be signed correctly.</p>\n\n<p>The problem is that the SecurityTokenReference is only created when ComputeSignature() is called, so I'm not able to add a signing Reference to this element, as it does not exist at the time it is required (within the overridden GetIdElement method of SignedXml which is called prior to ComputeSignature())</p>\n\n<hr>\n\n<p>The code I'm using to create the signature block to insert into the Security header is as follows</p>\n\n<pre><code>   string certificatePath = System.Windows.Forms.Application.StartupPath + \"\\\\\" + \"Certs\\\\sign-and-    enc.p12\";\n\n    XmlDocument xd = new XmlDocument();\n    xd.LoadXml(xml);\n\n    // Set Certificate \n    System.Security.Cryptography.X509Certificates.X509Certificate2 cert = new X509Certificate2(certificatePath, \"password\");\n    MySignedXml signedXml = new MySignedXml(xd);\n    signedXml.SigningKey = cert.PrivateKey;\n\n    // Create a new KeyInfo object. \n    KeyInfo keyInfo = new KeyInfo();\n    keyInfo.Id = \"\";\n\n    MemoryStream keyInfoStream = new MemoryStream();\n    XmlWriter keyInfoWriter = XmlWriter.Create(keyInfoStream);\n\n    WSSecurityTokenSerializer.DefaultInstance.WriteKeyIdentifierClause(keyInfoWriter, new LocalIdKeyIdentifierClause(\"token_reference\", typeof(X509SecurityToken)));   \n\n    keyInfoWriter.Flush();\n    keyInfoStream.Position = 0;\n    XmlDocument keyInfoDocument = new XmlDocument();\n    keyInfoDocument.Load(keyInfoStream);\n\n    XmlAttribute attrib = keyInfoDocument.CreateAttribute(\"ValueType\");\n    attrib.InnerText = \"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\";\n    keyInfoDocument.ChildNodes[1].ChildNodes[0].Attributes.Append(attrib);\n\n    KeyInfoNode keyInfoNode = new KeyInfoNode();\n    keyInfoNode.LoadXml(keyInfoDocument.DocumentElement);\n    keyInfo.AddClause(keyInfoNode);\n\n    // Add the KeyInfo object to the SignedXml object. \n    signedXml.KeyInfo = keyInfo;\n\n    // Need to use External Canonicalization method. \n    signedXml.SignedInfo.CanonicalizationMethod = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n\n    // Create a reference to be signed. \n    Reference reference = new Reference();\n    reference.Uri = \"#UsernameToken-1\";\n\n    XmlDsigEnvelopedSignatureTransform env = new XmlDsigEnvelopedSignatureTransform();\n    env.Algorithm = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n    reference.AddTransform(env);\n    reference.DigestMethod = \"http://www.w3.org/2000/09/xmldsig#sha1\";\n    signedXml.AddReference(reference);\n\n\n    Reference reference2 = new Reference();\n    reference2.Uri = \"#token_reference\";\n    XmlDsigEnvelopedSignatureTransform env2 = new XmlDsigEnvelopedSignatureTransform();\n    env2.Algorithm = \"http://www.w3.org/2001/10/xml-exc-c14n#\";\n    reference2.AddTransform(env2);\n    reference2.DigestMethod = \"http://www.w3.org/2000/09/xmldsig#sha1\";\n    signedXml.AddReference(reference2);\n\n    // Add the Signature Id \n    signedXml.Signature.Id = \"MYSIG_ID\";\n\n    // Compute the signature. \n    signedXml.ComputeSignature();\n\n    XmlElement xmlDigitalSignature = signedXml.GetXml();\n</code></pre>\n\n<p>where the xml variable is the the UsernameToken xml string, and the MySignedXml class is a subclassed SignedXml with the GetIdElement method overridden (to try to find and correctly refreence the non-existant SecurityTokenReference)</p>\n\n<p>I've spend days researching and testing this now, and unfortunately the company supplying the service isn't any help - but I need to use their service.</p>\n\n<p><strong>Full working soap message (soapUI project)</strong></p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:urn=\"urn:XXXXX\"&gt;\n   &lt;soapenv:Header xmlns:ebxml=\"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/\"&gt;\n   &lt;wsse:Security soapenv:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"&gt;\n    &lt;wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"CertId-D05E596B5ABC341FEB13505090224061\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;MIIEnDCCBAWgAwIBAgIBAjANBgkqhkiG9w0BAQUFADCBxDELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxHjAcBgNVBAMTFWRldmNhLmIyYi5pcmQuZ292dC5uejEXMBUGA1UEKRMORGV2ZWxvcG1lbnQgQ0ExKDAmBgkqhkiG9w0BCQEWGWNocmlzLnNjaHVsdHpAaXJkLmdvdnQubnowHhcNMTEwOTE1MDIwNjIwWhcNMjEwOTEyMDIwNjIwWjCByTELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxJTAjBgNVBAMTHHNpZ24tYW5kLWVuYy5kZXYuaXJkLmdvdnQubnoxFTATBgNVBCkTDHNpZ24tYW5kLWVuYzEoMCYGCSqGSIb3DQEJARYZY2hyaXMuc2NodWx0ekBpcmQuZ292dC5uejCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAykyZHVnXjsG220zB3kNOsGBeGP2rdNbLlIqW1D8yZO1fcj3/RhRiqsopbUrb8AU1ClpfhbH2K68kg7V91VAY0qrwNxP+pPPo1vYKMU6pT38qJGQzffr+iV2BCJshZvSk9E7QSWO5mFNstdg19xc+5ST1Lgb3fefuRG2KZVxPx0sCAwEAAaOCAZUwggGRMAkGA1UdEwQCMAAwEQYJYIZIAYb4QgEBBAQDAgZAMDQGCWCGSAGG+EIBDQQnFiVFYXN5LVJTQSBHZW5lcmF0ZWQgU2VydmVyIENlcnRpZmljYXRlMB0GA1UdDgQWBBSczRKXKPe3Sin7eFrVXfI7MXckzzCB+QYDVR0jBIHxMIHugBSLWxPSZd9otEj16vhLyovMCI9OMaGByqSBxzCBxDELMAkGA1UEBhMCTloxDTALBgNVBAgTBFdHVE4xEzARBgNVBAcTCldlbGxpbmd0b24xGDAWBgNVBAoTD0lSRFN0dWR5bGlua0IyQjEUMBIGA1UECxMLRGV2ZWxvcG1lbnQxHjAcBgNVBAMTFWRldmNhLmIyYi5pcmQuZ292dC5uejEXMBUGA1UEKRMORGV2ZWxvcG1lbnQgQ0ExKDAmBgkqhkiG9w0BCQEWGWNocmlzLnNjaHVsdHpAaXJkLmdvdnQubnqCCQDL/qDdlx2j6DATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQEFBQADgYEAS4ZPIVVpgTOGN4XcIC3SiYlxF8wYg7qnUhH5wJsAD3VCKfj68j9FSJtdBWLlWvvRxEoDP2lZ0IbFl6Rjnl+2ibzFnyac2G1AVm5mwPrNKHBQJ9J5eDJi0iUVY7Wphz86tKnqj34GvlHPNXmrF7oGEcDhPwK0T8zRdE/pvKIUiJc=&lt;/wsse:BinarySecurityToken&gt;\n    &lt;ds:Signature Id=\"Signature-2\" xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;ds:SignedInfo&gt;\n            &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n            &lt;ds:Reference URI=\"#CertId-D05E596B5ABC341FEB13505090224061\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n                &lt;ds:DigestValue&gt;3iVAUEAt8vAb7Ku+jf2gwSkSm0Q=&lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n            &lt;ds:Reference URI=\"#UsernameToken-1\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n                &lt;ds:DigestValue&gt;r4HLEAWJldJwmEmcAqV6Y8rnTPE=&lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n        &lt;/ds:SignedInfo&gt;\n        &lt;ds:SignatureValue&gt;\n        YGh2I3VcukqjT0O7hKItiykWN5tlID18ZXRCwQjXriHmnVsO4wGcHjWfmhuNDecq+xRN+SjG8E7M\n        2Rx/5/BbFKbVlNOkQOSbSxIs1YT9GaThK16pMrX5KRkkJme1W3R0pGIIQh6gGRSUf79RZUIYxyVl\n        LqdIe561TXXDdtbt/6Q=\n        &lt;/ds:SignatureValue&gt;\n        &lt;ds:KeyInfo Id=\"KeyId-D05E596B5ABC341FEB13505090224372\"&gt;\n            &lt;wsse:SecurityTokenReference wsu:Id=\"STRId-D05E596B5ABC341FEB13505090224373\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n                &lt;wsse:Reference URI=\"#CertId-D05E596B5ABC341FEB13505090224061\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"/&gt;&lt;/wsse:SecurityTokenReference&gt;\n        &lt;/ds:KeyInfo&gt;\n    &lt;/ds:Signature&gt;\n    &lt;wsse:UsernameToken wsu:Id=\"UsernameToken-1\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n        &lt;wsse:Username&gt;XXXXXX&lt;/wsse:Username&gt;\n        &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;XXXXXXX&lt;/wsse:Password&gt;\n        &lt;/wsse:UsernameToken&gt;\n    &lt;/wsse:Security&gt;\n  &lt;ebxml:Messaging xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n     &lt;ebxml:UserMessage&gt;\n        &lt;ebxml:MessageInfo&gt;\n           &lt;ebxml:Timestamp&gt;2002-02-02T14:18:02.0Z&lt;/ebxml:Timestamp&gt;\n           &lt;ebxml:MessageId&gt;bf9433d9-c6e9-4c12-9c98-724008a09c21&lt;/ebxml:MessageId&gt;\n        &lt;/ebxml:MessageInfo&gt;\n        &lt;ebxml:PartyInfo&gt;\n           &lt;ebxml:From&gt;\n              &lt;ebxml:PartyId type=\"identifier\"&gt;Trading Partner X&lt;/ebxml:PartyId&gt;\n              &lt;ebxml:Role&gt;Provider&lt;/ebxml:Role&gt;\n           &lt;/ebxml:From&gt;\n           &lt;ebxml:To&gt;\n              &lt;ebxml:PartyId type=\"identifier\"&gt;XXXXXXX&lt;/ebxml:PartyId&gt;\n              &lt;ebxml:Role&gt;Requestor&lt;/ebxml:Role&gt;\n           &lt;/ebxml:To&gt;\n        &lt;/ebxml:PartyInfo&gt;\n        &lt;ebxml:CollaborationInfo&gt;\n           &lt;ebxml:AgreementRef&gt;urn:XXXXXXXXX&lt;/ebxml:AgreementRef&gt;\n           &lt;ebxml:Service type=\"Web Service\"&gt;urn:XXXXXXXX&lt;/ebxml:Service&gt;\n           &lt;ebxml:Action&gt;customerInformation&lt;/ebxml:Action&gt;\n           &lt;ebxml:ConversationId&gt;e302426a-b2d9-4ff1-a14b-fbbc2f40a017&lt;/ebxml:ConversationId&gt;\n        &lt;/ebxml:CollaborationInfo&gt;\n     &lt;/ebxml:UserMessage&gt;\n  &lt;/ebxml:Messaging&gt;\n   &lt;/soapenv:Header&gt;\n   &lt;soapenv:Body&gt;\n  &lt;urn:ConnectionTest&gt;\n     &lt;Message&gt;Bonjour&lt;/Message&gt;\n  &lt;/urn:ConnectionTest&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>We were supplied with some documentation. The security section is copied below</p>\n\n<p>The following security must be applied to each request in the following order:\nA wsse:UsernameToken must be included and contain:</p>\n\n<ol>\n<li>The Agent‟s Portal Username for the value of the wsse:Username element</li>\n<li><p>The Agent‟s Portal Password for the value of the wsse:PasswordText (clear text) in the Password element\nA Signature block:\nDigital Signatures are created using x509 certificates. Each software provider is required to hold and protect a valid certificate and private key issued by [To Be Determined]. With each service request the software must:</p></li>\n<li><p>Include the Certificate that matches the private key used for signing as a wsse:BinarySecurityToken and use it as the wsse:SecurityTokenReference for the Signature</p></li>\n<li>Sign the wsse:BinarySecurityToken</li>\n<li>Sign the wsse:UsernameToken</li>\n<li>Use Canonicalization Method Algorithm: <a href=\"http://www.w3.org/2001/10/xml-exc-c14n#\" rel=\"nofollow\">http://www.w3.org/2001/10/xml-exc-c14n#</a></li>\n<li>Use Signature Method Algorithm: <a href=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" rel=\"nofollow\">http://www.w3.org/2000/09/xmldsig#rsa-sha1</a></li>\n<li>Use Digest Method Algorithm: <a href=\"http://www.w3.org/2000/09/xmldsig#sha1\" rel=\"nofollow\">http://www.w3.org/2000/09/xmldsig#sha1</a></li>\n</ol>\n"},{"tags":["c#","wpf","wpf-controls","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261815,"title":"Extracting raw RTF from a RichTextBox","body":"<p>There's got to be a better way to do this than what I'm doing.</p>\n\n<p>I'm trying to extract the raw RTF from a WPF RichTextBox.  Well, really I'm trying to take a bunch of my custom classes and turn it into an RTF string, but I'm using a RichTextBox to do it because I don't particularly want to write my own RTF library.</p>\n\n<p>The method I'm using (modified from something first seen <a href=\"http://stackoverflow.com/questions/3003984/how-to-set-rtf-from-winforms-to-wpf-richtextbox\" title=\"here\">here</a> and used to extract XML <a href=\"http://stackoverflow.com/questions/601838/get-rtf-from-richtextbox\">here</a>) is as follows:</p>\n\n<pre><code>RTB.Selection.Save(memstream, DataFormats.Rtf);\nmemstream.Seek(0, SeekOrigin.Begin);\nvar sr = new StreamReader(memstream);\nvar myText = sr.ReadToEnd();\n</code></pre>\n\n<p>This works, but seems ridiculously clumsy.  And I'm worried about the performance implications on large amounts of text.  Is there a better way?  (For the purpose of this question, let's assume that I can't use the WinForms RichTextBox.)</p>\n"},{"tags":["c#","internet-explorer","download","lotus-domino","rightclick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13255346,"title":"How can I added a right click menu to download all attachment in some web page","body":"<p>I encountered a web page that contains several attachments that can only be downloaded one by one.</p>\n\n<p>How can I create a program that adds a right click menu in IE that shows a manu with an option to \"Save All\"?</p>\n\n<p>Please note that I am a Domino Administrator, not a programmer, but do know a little C#.  Can somebody describe how to implement this feature??</p>\n"},{"tags":["c#","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":57,"score":-1,"question_id":13261405,"title":"Eclipse like console in Visual Studio 2010 C#","body":"<p>I am going to do some code in c# using visual studio 2010. The problem is that every time I run program it does appear in command prompt.</p>\n\n<p>I would like place the output of the program in the console like in the Eclipse. <code>System.Diagnostics.Debug.Write(\"abc\");</code> this does not work cause if I look at the output I see much more information than I want. <em>I would like to see only data which would show in the command prompt</em>.</p>\n"},{"tags":["c#","asp.net","gridview","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3043,"score":1,"question_id":3075044,"title":"how to add checkbox column to gridview","body":"<p>How to add checkbox column to gridview .</p>\n\n<p>i've tried:</p>\n\n<pre><code>foreach (GridViewRow objRow in GridView1.Rows)\n{\n   TableCell tcCheckCell = new TableCell();\n   CheckBox chkCheckBox = new CheckBox();\n   tcCheckCell.Controls.Add(chkCheckBox);\n\n   objRow.Cells.Add( tcCheckCell);\n}\n</code></pre>\n\n<p>How can i add the <code>objrow</code> to gridview? Or is there any other method of adding a checkbox column to an ASP.net <code>GridView</code>?</p>\n"},{"tags":["c#",".net","sockets"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13261625,"title":"One server many clients: Threads or classes","body":"<p>I'm doing an application in C#, with a server and some clients (not more than 60), and I would like to be able to deal with each client independently. The communication between server and client is simple but I have to wait for some ack's and I don't want to block any query.</p>\n\n<p>So far, I've done two versions of the server side, one it's based on this:</p>\n\n<p><a href=\"http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html\" rel=\"nofollow\">http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html</a></p>\n\n<p>and in the other one, I basically create a new thread for each client. Both versions work fine...but I would like to know pros and cons of the two methods.</p>\n\n<p>Any programming pattern to follow in this sort of situation?</p>\n"},{"tags":["c#","wpf","firefox","browser","gecko"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1788,"score":5,"question_id":7552144,"title":"Embed Firefox/Gecko in WPF/C#","body":"<p>i want to embed the current Gecko in my WPF-Project.\ni know there is the possibility with the Winforms-Host and the Skybound-Gecko-Libary.</p>\n\n<p>But i use not the standard wpf-theme für my application. its another and the scrollbar of the control will not be styled. furthermore this is an old libary which is designed for firefox 3.</p>\n\n<p>which is the best libary/strategy to use the current gecko in wpf?\nthanks for your help</p>\n"},{"tags":["c#","dynamic"],"answer_count":4,"favorite_count":5,"up_vote_count":23,"down_vote_count":0,"view_count":10016,"score":23,"question_id":4939508,"title":"Get value of c# dynamic property via string","body":"<p>I'd like to access the value of a <code>dynamic</code> c# property with a string:</p>\n\n<p><code>dynamic d = new { value1 = \"some\", value2 = \"random\", value3 = \"value\" };</code></p>\n\n<p>How can I get the value of d.value2 (\"random\") if I only have \"value2\" as a string? In javascript, I could do d[\"value2\"] to access the value (\"random\"), but I'm not sure how to do this with c# and reflection. The closest I've come is this:</p>\n\n<p><code>d.GetType().GetProperty(\"value2\")</code> ... but I don't know how to get the actual value from that.</p>\n\n<p>As always, thanks for your help!</p>\n"},{"tags":["c#","asp.net",".net","wcf","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13261184,"title":"How to open service port?","body":"<p>I'm getting an error code 10061 when calling a WCF service.  The error is </p>\n\n<blockquote>\n  <p>Could not connect to <code>&lt;service uri</code>>.  The connection attempt lasted for a time span of   xxxx.  TCP error code 10061.  No connection could be made because the target machine actively refused it.</p>\n</blockquote>\n\n<p>When I do a </p>\n\n<pre><code>netstat -a\n</code></pre>\n\n<p>I don't see that the port this net.tcp service address should be on is listening.  In IIS, the website this service is under has started.  Any ideas why the port isn't listed in TCP as listening or how I can get it to listen?</p>\n"},{"tags":["c#","wcf","azure","servicebus","azureservicebus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12896570,"title":"Microsoft ServiceBus - The argument entityName is null or empty","body":"<p>I am using Servicebus as a link between a web-application and BizTalk.\nIn the web-application i earlier had the whole endpoint defined in the web.config but the endpoints has to be dynamic so i tried to set the endpoint by code.</p>\n\n<p>After the change i only get an exception when i try to send a message to the queue. (ArgumentException - The argument entityName is null or empty)</p>\n\n<p>Here is the code sending the message to the queue:</p>\n\n<pre><code>string queuename = Company.GetQueueName(O.companyId);\nvar factory = new ChannelFactory&lt;IOrder&gt;(\"requestQueueClientEndpoint\", new EndpointAddress(ServiceBusEnvironment.CreateServiceUri(\"sb\", queuename, string.Empty)));\nvar OrdRspChannel = factory.CreateChannel();\n\nOrdRspChannel.Order(O);\n</code></pre>\n\n<p>And here is the configuration:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n&lt;behaviors&gt;\n  &lt;endpointBehaviors&gt;\n    &lt;behavior name=\"securityBehavior\"&gt;\n      &lt;TransportClientEndpointBehavior&gt;\n        &lt;tokenProvider&gt;\n          &lt;sharedSecret issuerName=\"owner\" issuerSecret=\"SECRET REMOVED\" /&gt;\n          &lt;serviceCertificate&gt;\n            &lt;authentication revocationMode=\"NoCheck\"/&gt;\n          &lt;/serviceCertificate&gt;\n        &lt;/tokenProvider&gt;\n      &lt;/TransportClientEndpointBehavior&gt;\n    &lt;/behavior&gt;\n  &lt;/endpointBehaviors&gt;\n&lt;/behaviors&gt;\n\n&lt;bindings&gt;\n  &lt;netMessagingBinding&gt;\n    &lt;binding name=\"netMessagingBinding\" sendTimeout=\"00:10:00\" receiveTimeout=\"00:10:00\" openTimeout=\"00:10:00\" closeTimeout=\"00:10:00\" sessionIdleTimeout=\"00:10:00\" prefetchCount=\"-1\"&gt;\n      &lt;transportSettings batchFlushInterval=\"00:00:01\" /&gt;\n    &lt;/binding&gt;\n  &lt;/netMessagingBinding&gt;\n&lt;/bindings&gt;\n\n&lt;client&gt;\n  &lt;!-- Invoke BizTalk via Service Bus Queue --&gt;\n  &lt;endpoint address=\"ADDRESS REMOVED\" behaviorConfiguration=\"securityBehavior\" binding=\"netMessagingBinding\" bindingConfiguration=\"netMessagingBinding\" contract=\"Procurement_MVC3.IOrder\" name=\"requestQueueClientEndpoint\" /&gt;\n&lt;/client&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Here is the StackTrace:</p>\n\n<pre><code>{System.ArgumentException: The argument entityName is null or empty.\nParameter name: entityName\n\nServer stack trace: \n   at Microsoft.ServiceBus.Messaging.MessagingFactory.CheckValidEntityName(String entityName, Int32 maxEntityNameLength, Boolean allowSeparator, String paramName)\n   at Microsoft.ServiceBus.Messaging.MessagingFactory.&lt;&gt;c__DisplayClass1d.&lt;BeginCreateMessageSender&gt;b__1b(AsyncCallback c, Object s)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1.BeginOpenCompleted(IAsyncResult result)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1.BeginOpen()\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.OpenOnceManagerAsyncResult`1..ctor(OpenOnceManager openOnceManager, TimeSpan openTimeout, AsyncCallback callback, Object state, Func`3 beginOperation, EndOperation`1 endOperation)\n   at Microsoft.ServiceBus.Messaging.OpenOnceManager.Begin[T](AsyncCallback callback, Object state, Func`3 beginOperation, Func`2 endOperation)\n   at Microsoft.ServiceBus.Messaging.MessagingFactory.BeginCreateMessageSender(String entityPath, TimeSpan timeout, AsyncCallback callback, Object state)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OpenMessagingFactoryAndMessageSenderAsyncResult.CreateFactoryComplete(IAsyncResult result)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OpenMessagingFactoryAndMessageSenderAsyncResult..ctor(ServiceBusOutputChannel outputChannel, TimeSpan timeout, AsyncCallback callback, Object state)\n   at Microsoft.ServiceBus.Messaging.Channels.ServiceBusOutputChannel.OnOpen(TimeSpan timeout)\n   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)\n   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)\n   at System.ServiceModel.Channels.ServiceChannel.EnsureOpened(TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)\n   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)\n   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)\n\nException rethrown at [0]: \n   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)\n   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type)\n   at Procurement_MVC3.IOrder.Order(Order Order)\n   at Procurement_MVC3.Controllers.HomeController.ViewOrder(String id, Nullable`1 date, Nullable`1 confirmqty, String orderrowid, String supplierorderId, Boolean confirm) in c:\\Projects2\\trunk\\Procurement_MVC3\\Procurement_MVC3\\Controllers\\HomeController.cs:line 229}\n</code></pre>\n\n<p>I have searched both Google and StackOverflow for similar scenarios but found nothing.\nI also have to update a production-environment with this code and this is the last piece of the puzzle so it's starting to drag on.</p>\n"},{"tags":["c#","asp.net","customvalidator"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":903,"score":2,"question_id":10172406,"title":"CustomValidator ServerValidate method does not fire","body":"<p>I've put a <code>CustomValidator</code> on my form. I have not set its <code>ControlToValidate</code> property. In its <code>ServerValidate</code> event I've written the following:</p>\n\n<pre><code>protected void CustomValidator1_ServerValidate(object source,      \n                                               ServerValidateEventArgs args)\n{\n    args.IsValid = false;\n}\n</code></pre>\n\n<p>I put a breakpoint to this method but it seems to never come to that point. But if I do this on another form it works like a charm.</p>\n\n<ol>\n<li>The <code>ValidationGroup</code> property of both the button and the <code>CustomValidator</code> are the same</li>\n<li>I tried deleting this property in both the button and the <code>CustomValidator</code>, still does not work.</li>\n</ol>\n\n<p>It seems as there's something formwide. I just put a <code>CustomValidator</code> on the form and do not touch any of its properties other than just setting its <code>ServerValidate</code> event method.</p>\n\n<p>EDIT: Here's the aspx part:</p>\n\n<pre><code> &lt;asp:CustomValidator ID=\"CustomValidator2\" runat=\"server\" \n       ErrorMessage=\"This is a test\" \n   onservervalidate=\"CustomValidator1_ServerValidate\" \n   ValidationGroup=\"PA\"&gt;&lt;/asp:CustomValidator&gt;\n\n\n&lt;asp:Button ID=\"btnPensionersOK\" runat=\"server\" Text=\"OK\" Width=\"75px\" \n          onclick=\"Button1_Click\" ValidationGroup=\"PA\" /&gt;\n</code></pre>\n"},{"tags":["c#","visual-studio-2010","stackoverflow"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":78,"score":-1,"question_id":13258634,"title":"How to force Visual Studio to ignore 'System.StackOverflowException'?","body":"<p>I've implemented recursive algorithm that can be found under this <a href=\"http://stackoverflow.com/questions/12978253/whats-the-fastest-way-to-find-deepest-path-in-a-3d-array\">link</a>.\nIt works very fine when the 3d array is 10x10x10.</p>\n\n<p>I'm trying to make it run for 200x200x200 array however, Visual Studio says that I might be ussing infinite resursive (I'm pretty sure my prog is OK). Is there any way to handle that? I've tried putting <code>[DebuggerNonUserCode]</code> right before the recursive method, but it haven't worked.</p>\n\n<p>Forgot to mention, it's Visual Studio 2010.</p>\n\n<p>Here's recursive function from my program. I'm running that for every cell, that is marked as Unvisited.</p>\n\n<pre><code>    public static int tmp_lowest_floor = 0;\n    public static int tmp_maks_size = 0;\n\n    static void function1(Point[, ,] array, int pos_y, int pos_z, int pos_x) // recursive function\n    {\n        Point cell = array[pos_y, pos_z, pos_x];\n\n        if (cell.Visited == false &amp;&amp; cell.IsCave)\n        {\n            cell.Visited = true; // changing to visited so we do not count anything for this cell anymore\n            tmp_maks_size++; // increasing for each cell in this cave (in this run)\n\n            if (tmp_lowest_floor &lt; pos_y) { tmp_lowest_floor = pos_y; }\n            cell.FillNeighbourList(array, pos_y, pos_z, pos_x);// adds neighbours into cell's list (max 6) up, down, north, east, south, west\n\n            foreach (Point p in cell.neighbours) // max 6 times recursion in here (I know it sounds horrible, but once I check all the neighbours for a cell, I'll not have to check it ever again)\n            {\n                if (p != null)\n                {\n                    if (p.IsCave == true &amp;&amp; p.Visited == false)\n                    {\n                        function1(tablica, p.pos_y, p.pos_z, p.pos_x);\n                    }\n                }\n            }\n\n        }\n\n    }\n</code></pre>\n\n<p>p.s.\nI know I can do it in a iterative way, however, the homework says it has to be done with recursion</p>\n"},{"tags":["c#","rounding"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":116,"score":7,"question_id":13241245,"title":"When is it beneficial to convert from float to double via decimal","body":"<p>Our existing application reads some floating point numbers from a file. The numbers are written there by some other application (let's call it <em>Application B</em>). The format of this file was fixed long time ago (and we cannot change it). In this file all the floating point numbers are saved as floats in binary representation (4 bytes in the file). </p>\n\n<p>In our program as soon as we read the data we convert the floats to doubles and use doubles for all calculations because the calculations are quite extensive and we are concerned with the spread of rounding errors.</p>\n\n<p>We noticed that when we convert floats via decimal (see the code below) we are getting more precise results than when we convert directly. Note: Application B also uses doubles internally and only writes them into the file as floats. Let's say Application B had the number 0.012 written to file as float. If we convert it after reading to decimal and then to double we get exactly 0.012, if we convert it directly, we get 0.0120000001043081. </p>\n\n<p>This can be reproduced without reading from a file - with just an assignment: </p>\n\n<pre><code>    float readFromFile = 0.012f;\n    Console.WriteLine(\"Read from file: \" + readFromFile); \n    //prints 0.012\n\n    double forUse = readFromFile;\n    Console.WriteLine(\"Converted to double directly: \" + forUse);\n    //prints 0.0120000001043081\n\n    double forUse1 = (double)Convert.ToDecimal(readFromFile);\n    Console.WriteLine(\"Converted to double via decimal: \" + forUse1); \n    //prints 0.012\n</code></pre>\n\n<p>Is it always beneficial to convert from float to double via decimal, and if not, under what conditions is it beneficial?</p>\n\n<p>EDIT: Application B can obtain the values which it saves in two ways:</p>\n\n<ol>\n<li>Value can be a result of calculations</li>\n<li>Value can be typed in by user as a decimal fraction (so in the example above the user had typed 0.012 into an edit box and it got converted to double, then saved to float)</li>\n</ol>\n"},{"tags":["c#","visual-studio","visual-studio-2010","preprocessor"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":257,"score":8,"question_id":10548319,"title":"Can visual studio automatically indent / format preprocessing directives?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1321228/how-to-force-indentation-of-c-sharp-conditional-directives\">How to force indentation of C# conditional directives?</a>  </p>\n</blockquote>\n\n\n\n<p>Say I want to type this in Visual Studio:</p>\n\n<pre><code>    class Program\n    {\n        private const Byte NUM_THREADS =\n        #if DEBUG\n            1;\n        #else\n            8;\n        #endif\n    }\n</code></pre>\n\n<p>If I simply type it out (i.e. not manually fix any indentation), Visual Studio will format it like this:</p>\n\n<pre><code>    class Program\n    {\n        private const Byte NUM_THREADS =\n#if DEBUG\n 1;\n#else\n        8;\n#endif\n    }\n</code></pre>\n\n<p>Is there anything I can do so it automatically indents so it looks like the first example?</p>\n"},{"tags":["c#","asp.net","resharper","visual-studio-2010-sp1"],"answer_count":4,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":2463,"score":10,"question_id":5539131,"title":"Resharper: Cannot resolve symbol 'Eval' in VS2010 SP1","body":"<p>I just installed SP1 for VS2010, and since then I get error messages from Resharper for stuff that used to work and be ok for Resharper (5.1) before.</p>\n\n<p>The error messages are \"Cannot resolve symbol 'Eval'\" and some other methods other than Eval.</p>\n\n<p>How do I solve this?\nIs there a fix?\nIs there some resharper cache that I must delete/clear?</p>\n\n<p>(The code compiles and runs as usual)</p>\n"},{"tags":["c#","datagridview","add","rows"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13261464,"title":"Adding values to a DataGridView","body":"<p>I'm trying to display the values of an object in a DataGridView, but my code isn't working though it seems to match other code I've found around the net.  Any clues?</p>\n\n<pre><code>foreach (Package p in displayList)\n        {\n            senderDg.Rows.Add(p.SenderName, p.SenderAddress, p.SenderCity,\n                p.SenderState, p.SenderZipCode);\n            recipientsDg.Rows.Add(p.RecipientName, p.RecipientAddress, p.RecipientCity,\n                p.RecipientState, p.RecipientZipCode);\n        }\n</code></pre>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":383,"score":4,"question_id":3251104,"title":"Is it possible to screenshot a minimized application","body":"<p>I know it's possible to capture a screen of an application that is behind another application, but I can't seem to find anything on capturing the screen of a minimized application.  </p>\n\n<p>Anyone happen to know if this is possible?  I don't want to get into things like maximizing and minimizing the application really quick.</p>\n"},{"tags":["c#","sharepoint2010","httpcookie","httpcookiecollection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261316,"title":"Sharepoint 2010 setting a cookie expiration date seemsto work when viewed from browser but server code sees 01/01/0001 expiration","body":"<p>here is the to add the cookie to the request</p>\n\n<pre><code>    HttpCookie cookie = new HttpCookie(myCookie);\n    cookie.Expires = DateTime.Now.AddDays(30);\n    cookie.Value = myValue;\n    cookie.Domain = myDomain;\n    cookie.HttpOnly = true;\n    response.Cookies.Add(cookie);\n</code></pre>\n\n<p>Seems fine, until during a Sharepoint 2010 context.PostAuthenticateRequest event when i try to read the cookie</p>\n\n<pre><code>    HttpCookieCollection cookies = request.Cookies;\n        HttpCookie tosCookie = cookies.Get(TOS_COOKIE_KEY_ACKNOWLEDGEMENT);\n        tosCookie.Expires\n</code></pre>\n\n<p>i get the date 01/01/0001 when in the browser i see the cookie expiration date as 12/6/2012</p>\n"},{"tags":["c#","asp.net-mvc","razor"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":13201250,"title":"How to get custom annotation attributes for a controller action in ASP.NET MVC 4?","body":"<p>I am working with a permission based authorization system for my app in ASP.NET MVC. \nFor this I have created a custom authorization attribute</p>\n\n<pre><code>public class MyAuthorizationAttribute : AuthorizeAttribute\n{\n    string Roles {get; set;}\n    string Permission {get; set;}\n}\n</code></pre>\n\n<p>so that I can authorize a user by both role or a specific permission key with annotation for actions like</p>\n\n<pre><code>public class UserController : Controller\n{\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_ADD\")]\n    public ActionResult Add()\n\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_EDIT\")]\n    public ActionResult Edit()\n\n    [MyAuthorization(Roles=\"ADMIN\", Permissions=\"USER_DELETE\")]\n    public ActionResult Delete()\n}\n</code></pre>\n\n<p>then I override AuthorizeCore() method in MyAuthorizationAttribute class with similar logic(pseudo code)</p>\n\n<pre><code>protected override bool AuthorizeCore(HttpContextBase httpContext)\n{\n    if(user not authenticated)\n        return false;\n\n    if(user has any role of Roles)\n        return true;\n\n    if(user has any permission of Permissions)\n        return true;\n\n    return false;\n}\n</code></pre>\n\n<p>Up to this is working fine. </p>\n\n<p>Now I need some sort of extension methods so that I can dynamically generate action url in view pages that will return action url based on MyAuthorization attribute authorization logic for the given action. Like</p>\n\n<pre><code>@Url.MyAuthorizedAction(\"Add\", \"User\")\n</code></pre>\n\n<p>will return url to \"User/Add\" if user has admin role or has permission of \"USER_ADD\" (as defined in attributes for the action) or return empty string otherwise.</p>\n\n<p>But after searching in internet for few days I could not figure it out. :(</p>\n\n<p>So far I have found only this <a href=\"http://stackoverflow.com/questions/2721869/security-aware-action-link/2722026\">&quot;Security aware&quot; action link?</a> which works by executing all action filters for the action until it fails.</p>\n\n<p>It's nice, but I think it would be an overhead to execute all the action filters for each time I call the MyAuthorizedAction() method. Besides It also didn't work with my version (MVC 4 and .NET 4.5)</p>\n\n<p>What all I need is to check authenticated user's role, permissions (will be stored in session) against authorized role and permission for the given action. Like something as following (pseudo code)</p>\n\n<pre><code>MyAuthorizedAction(string actionName, string controllerName)\n{\n    ActionObject action = SomeUnknownClass.getAction(actionName, controllerName)\n    MyAuthorizationAttribute attr = action.returnsAnnationAttributes()\n\n    if(user roles contains any in attr.Roles \n       or \n       user permissions contains any attr.Permissions)\n    {\n        return url to action\n    }\n    return empty string\n}\n</code></pre>\n\n<p>I am searching the solution of getting action attributes value for quite a long time, could not find enough good resources at all. Am I missing out right keywords? :/</p>\n\n<p>If anyone can provide me the solution that would be truly a great help.\nThanks in advance for the solutions</p>\n"},{"tags":["c#","asp.net","content-management-system","sitecore","sitecore6"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13261332,"title":"Sitecore tree expand event handler","body":"<p>Does anyone know which event/pipeline/command I can hook into when someone clicks on a item node to expand the tree?</p>\n"},{"tags":["c#","tcp","network-programming"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13260960,"title":"Network Programming : receiving image file in dynamic Image Object in TCP client server","body":"<p>um use this code to store a received Image in the Hard disk Memory <br>\ni try to edit this code to store the received Image file in dynamic Image Object with out storing in the Hard disk Memory </p>\n\n<pre><code>    private void StartReceiving()\n    {\n        try\n        {\n              string hstServer = Dns.GetHostName();\n             IPAddress ipaLocal =\"127.0.0.1\";\n\n\n            if (tlsServer == null)\n            {\n                tlsServer = new TcpListener(ipaLocal, Convert.ToInt32(txtPort.Text));\n            } \n            tlsServer.Start(); \n            TcpClient tclServer = tlsServer.AcceptTcpClient(); \n            strRemote = tclServer.GetStream(); \n            int bytesSize = 0;\n            byte[] downBuffer = new byte[2048];\n            bytesSize = strRemote.Read(downBuffer, 0, 2048);\n           FileName = System.Text.Encoding.ASCII.GetString(downBuffer, 0, bytesSize);\n           try\n           {\n               strLocal = new FileStream(FileName, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);\n           }catch(Exception exp)\n           {\n               strLocal = new FileStream(FileName.Substring(0,5), FileMode.Create, FileAccess.Write, FileShare.ReadWrite);\n           }\n            downBuffer = new byte[2048];\n\n            bytesSize = strRemote.Read(downBuffer, 0, 2048);\n\n            downBuffer = new byte[2048];\n\n            while ((bytesSize = strRemote.Read(downBuffer, 0, downBuffer.Length)) &gt; 0)\n            {\n                strLocal.Write(downBuffer, 0, bytesSize);\n            }\n\n        }\n        finally\n        {\n            strLocal.Close();\n            strRemote.Close();\n\n        }\n    }\n</code></pre>\n\n<p>edit by using CopyTo in .net 4 </p>\n\n<pre><code>            tlsServer.Start(); \n            TcpClient tclServer = tlsServer.AcceptTcpClient();\n           tclServer.GetStream().CopyTo(ms);\n\n            //Get the image out of the stream\n            Image img = Image.FromStream(ms);\n\n\n        }\n        finally\n        {\n            m = Image.FromStream(strLocal);\n            strLocal.Close();\n            strRemote.Close();\n\n        }\n</code></pre>\n"},{"tags":["c#","linq-to-sql","datacontext","transactionscope","submitchanges"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13261299,"title":"DataContext.Submit and TransactionScope","body":"<p>Please explain me pseudocode below.</p>\n\n<p>My idea is: 3-nd SubmitChanges will commit o.Status and will not commit o.TransactionId, and my object will get corrupted in database (I mean it will not be consistent anymore).</p>\n\n<pre><code>XDataContext DB = .....; \nXOrder o = DB.XOrders.Single(.......);\n\ntry\n{\n    using (var t = new TransactionScope())\n    {\n        o.Status = XOrderStatus.Completed;\n        DB.SubmitChanges(); // 1\n        string s = null;\n        s.Trim(); // crash here;\n        o.TransactionId = ......; // some calculations here\n        DB.SubmitChanges(); // 2\n        t.Complete();\n    }\n}\ncatch (Exception ex)\n{\n    XEvent e = new XEvent();\n    e.Type = XEventType.Exception;\n    e.Data = .........; // some calculations here\n    DB.XEvents.InsertOnSubmit(e);\n    DB.SubmitChanges(); // 3\n}\n</code></pre>\n\n<p>Is it any 'best practices' for my case?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13259816,"title":"Editable combobox with valid selection","body":"<p>I have a editable combobox in WPF (IsEditable=True). I would also like to ensure that the values which the user enters are in the list only. I don't want user to add their own values to the combo. I cannot make IsReadonly=true as that will not allow users to type. So is validation the only option in SelectionChange event? or is there a better way to do the same?</p>\n\n<p>Thanks\nShankara Narayanan.</p>\n"},{"tags":["c#","email","oauth","linkedin","hammock"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":192,"score":1,"question_id":12860359,"title":"Retrieve Linkedin email address","body":"<p>I'm using the Hammock library and C# to get the basic profile and email address of user from linked in following post <a href=\"http://ovaismehboob.wordpress.com/2011/09/12/linkedin-authentication-in-asp-net/\" rel=\"nofollow\">here</a> . </p>\n\n<p>I've also followed these posts <a href=\"http://mrsarker.wordpress.com/2011/08/20/linkedin-rest-api-in-asp-net-mvc/\" rel=\"nofollow\">here</a> and <a href=\"http://www.suddenelfilio.net/2010/08/24/linkedin-oauth-using-hammock-in-csharp-asp-net/\" rel=\"nofollow\">here</a></p>\n\n<p>However for the life of me I cannot get the email address of the linkedin user. </p>\n\n<p>Reading <a href=\"https://developer.linkedin.com/forum/can-we-get-email-address\" rel=\"nofollow\">this</a> linkedin post I got new created a new application to get new keys however still no luck.</p>\n\n<p>Went through <a href=\"http://developer.linkedin.com/forum/permission-scope-request-token-query-not-working\" rel=\"nofollow\">this</a> linkedin post but could not get it to work either</p>\n\n<p>I'm posting the code below but it's heavily lifted form the links I followed</p>\n\n<pre><code>var credentials = new OAuthCredentials\n            {\n\n                CallbackUrl = \"http://localhost:2715/Callback.aspx\",\n\n                ConsumerKey = \"my consumer key\",//not shown\n\n                ConsumerSecret = \"my consumer secret\",//not shown\n\n                Type = OAuthType.RequestToken,\n\n            };\n\n\n        var client = new RestClient\n            {\n                Authority = \"https://api.linkedin.com/uas/oauth\",\n                Credentials = credentials\n            };\n\n        //var scope = HttpUtility.UrlEncode(\"r_basicprofile r_emailaddress\");\n\n        var request = new RestRequest\n                        {\n                            Path = \"requestToken?scope=r_basicprofile+r_emailaddress\",\n                        };\n</code></pre>\n\n<p>I get this screen when user navigates to linkedin.</p>\n\n<p><img src=\"http://i.stack.imgur.com/mg5x9.png\" alt=\"enter image description here\"></p>\n\n<p>To actually request the email I use this code below</p>\n\n<pre><code> var request = new RestRequest { Path = \"people/~/email-address\" };\n\n        var credentials = new Hammock.Authentication.OAuth.OAuthCredentials\n\n        {\n\n            Type = OAuthType.AccessToken,\n\n            SignatureMethod = OAuthSignatureMethod.HmacSha1,\n\n            ParameterHandling = OAuthParameterHandling.HttpAuthorizationHeader,\n\n            ConsumerKey = \"my consumer key\", //not shown\n\n            ConsumerSecret = \"my consumer secret\", //not shown\n\n            Token = Session[\"AccessToken\"].ToString(),\n\n            TokenSecret = Session[\"AccessSecretToken\"].ToString(),\n\n            Verifier = Session[\"Verifier\"].ToString()\n\n        };\n\n\n        var client = new RestClient()\n        {\n            Authority = \"http://api.linkedin.com/v1/\",\n            Credentials = credentials,\n            Method = WebMethod.Get\n        };\n\n\n        var MyInfo = client.Request(request);\n\n        String content = MyInfo.Content;\n</code></pre>\n\n<p>This is the error I get on MyInfo.Content</p>\n\n<p><img src=\"http://i.stack.imgur.com/nzTSY.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks in advance for your help.</p>\n\n<p>On trying Kamyar's suggestion I get the following error message. What else should I try?</p>\n\n<p><img src=\"http://i.stack.imgur.com/MA619.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","asp.net","winforms","logging","log4net"],"answer_count":9,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":7547,"score":6,"question_id":2898120,"title":"Creating a new log file each day","body":"<p>As the title implies how can I create a new log file each day in C#? Now the program may not necessarily run all day and night but only get invoked during business hours. So I need to do two things.</p>\n\n<ol>\n<li>How can I create a new log file each day? The log file will be have the name in a format like MMDDYYYY.txt</li>\n<li>How can I create it just after midnight in case it is running into all hours of the night?</li>\n</ol>\n"},{"tags":["c#","extension-methods"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":757,"score":1,"question_id":1831072,"title":"Extension Method to return random alphabet","body":"<p>How to develop an extension method that may return random character(single character) from alphabet (a,b,....z).</p>\n\n<pre><code>public static char RandomLetter(this char randomchar)\n{\n\n}\n</code></pre>\n"},{"tags":["c#","iis7","iis-7.5","wmi","adsi"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13144657,"title":"How to enable/disable/get status for extended protection for authentication in IIS using WMI/ADSI and C#?","body":"<p>Can someone provide a code sample or resource which can help me programatically <strong>get status, enable and disable</strong> extended protection for authentication in IIS 7/IIS 7.5 using C#?</p>\n\n<p>C# with WMI/ADSI is preferred. </p>\n\n<p>i.e I am asked to use <strong>System.Management</strong> API or <strong>Microsoft.Web.Administration</strong> API using C# and i need to determine if <strong>EAP is enabled or not on a web server level</strong> (as web server default for all future websites).</p>\n\n<p>Any other solution using C# is also welcome.</p>\n\n<p>Looking forward to helpful answers. Thanks</p>\n\n<p>Steve</p>\n"},{"tags":["c#","windows-mobile","compact-framework","smartdevice"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":653,"score":2,"question_id":2533266,"title":"SmartDevice application hide on startup","body":"<p>I made a <code>SmartDevice</code> application runs on startup and it should be hidden at first time launch.</p>\n\n<p>I've tried <code>this.Hide()</code>, <code>this.Visible = false</code> and <code>ShowWindow(Handle, SW_HIDE)</code> in Form <code>Load()</code> event and <code>InitializeComponent()</code> with no luck.</p>\n\n<p>Anyone can help?</p>\n"},{"tags":["c#","encryption","hash","md5"],"answer_count":5,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":4863,"score":11,"question_id":2435695,"title":"Converting a md5 hash byte array to a string","body":"<p>How can I convert the hashed result, which is a byte array, to a string?</p>\n\n<pre><code>byte[] bytePassword = Encoding.UTF8.GetBytes(password);\n\nusing (MD5 md5 = MD5.Create())\n{\n    byte[] byteHashedPassword = md5.ComputeHash(bytePassword);\n} \n</code></pre>\n\n<p>I need to convert <code>byteHashedPassword</code> to a string. </p>\n"},{"tags":["c#",".net","c#-4.0","json.net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":120,"score":2,"question_id":12381636,"title":"Why is JSON.NET is not working with inheritance while deserializing","body":"<p>I am deserializing the JSON string to root object by using the following class which works fine .</p>\n\n<pre><code>[Serializable]\n    public class MoviesListRootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n        public List&lt;Response&gt; response { get; set; }\n    }\n</code></pre>\n\n<p>...................................  </p>\n\n<pre><code>var json = wc.DownloadString(jsonRequestURL);\nvar rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n\n<p>But if I am generalizng the root object bt creating parent class and then inheriting from it , then I get null after deserialization!!!!</p>\n\n<pre><code>[Serializable]\n    public class RootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n    }\n\n[Serializable]\n    public class MoviesListRootObject:RootObject\n    {\n        public List&lt;MovieResponse&gt; movieResponse { get; set; }\n\n    }\n</code></pre>\n\n<p>..............................................</p>\n\n<pre><code> var json = wc.DownloadString(jsonRequestURL);\n var rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n"},{"tags":["c#","wpf","codebehind","attached-properties"],"answer_count":3,"favorite_count":5,"up_vote_count":26,"down_vote_count":0,"view_count":12202,"score":26,"question_id":541420,"title":"How to I access an attached property in code behind?","body":"<p>I have a rectangle in my XAML and want to change its <code>Canvas.Left</code> property in code behind:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;UserControl x:Class=\"Second90.Page\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n    Width=\"400\" Height=\"300\" KeyDown=\"txt_KeyDown\"&gt;\n    &lt;Canvas&gt;\n        &lt;Rectangle \n            Name=\"theObject\" \n            Canvas.Top=\"20\" \n            Canvas.Left=\"20\" \n            Width=\"10\" \n            Height=\"10\" \n            Fill=\"Gray\"/&gt;\n    &lt;/Canvas&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>But this doesn't work:</p>\n\n<pre><code>private void txt_KeyDown(object sender, KeyEventArgs e)\n{\n    theObject.Canvas.Left = 50;\n}\n</code></pre>\n\n<p>Does anyone know what the syntax is to do this?</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":33,"score":-5,"question_id":13259741,"title":"Fileupload control display","body":"<p>how do we need to code a fileupload control so that it appears same in all browsers. Each browser shows the fileupload button in different ways. How do we need to code the CSS so that it displays the same in all browsers.</p>\n"},{"tags":["c#","messagebox","cross-threading","synchronizationcontext"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260891,"title":"is it possible to return a value with synchronizationcontext .send","body":"<p>We have a need to use SynchronizationContext to return a value (specifically a MessageBox DialogResult) via Send (we don't want asynch via 'Post'). Just not sure of the syntax.\nWe were having issues with MessageBox appearing behind main window which was thought to be caused by not being able to access the main forms IWin32Window value easily...We're using this, but to be honest I'm uncomfortable with it. </p>\n\n<pre><code> DialogResult dr;\n SynchronizationContext synchContext;\n\n //in main forms constructor\n  {\n       ...\n       synchContext = AsyncOperationManager.SynchronizationContext;\n  }\n\n void workerThread( object obj, DoWorkEventArgs args)\n {\n\n   // SynchronizationContext passed into worker thread via args\n   sc.Send( delegate {dr = MessageBoxEx.Show( \"Yes or no?\", \"Continue?\",   MessageBoxButtons.OKCancel, MessageBoxIcon.Question );},null);\n }\n</code></pre>\n"},{"tags":["c#","list","extension-methods","reverse","shuffle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13261135,"title":"How is sample2 code different from sample1 code?","body":"<p>I have the following shuffle extension method,</p>\n\n<pre><code>    //from http://stackoverflow.com/a/13255957/677607\n    //Fisher-Yates_shuffle http://en.wikipedia.org/wiki/Fisher-Yates_shuffle\n\n    private static readonly ThreadLocal&lt;Random&gt; RandomThreadLocal = new ThreadLocal&lt;Random&gt;(() =&gt; new Random());\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list, int seed)\n    {\n        list.Shuffle(new Random(seed));\n    }\n\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)\n    {\n        list.Shuffle(null);\n    }\n\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list, Random rand)\n    {\n        var r = rand ?? RandomThreadLocal.Value;\n\n        var len = list.Count;\n        for (var i = len - 1; i &gt;= 1; --i)\n        {\n            var j = r.Next(i);\n            var tmp = list[i];\n            list[i] = list[j];\n            list[j] = tmp;\n        }\n    }\n</code></pre>\n\n<p>I have the following button click which works well,</p>\n\n<p><strong>Sample1:</strong></p>\n\n<pre><code>    private async void button1_Click(object sender, RoutedEventArgs e)\n    {\n         await Task.Factory.StartNew(words.Sort);\n         await Task.Factory.StartNew(words.Reverse);\n         await Task.Factory.StartNew(() =&gt; words.Shuffle());\n    }\n</code></pre>\n\n<p>but the following doesn't work,</p>\n\n<p><strong>Sample2:</strong></p>\n\n<pre><code>    private async void button1_Click(object sender, RoutedEventArgs e)\n    {\n         await Task.Factory.StartNew(words.Sort);\n         await Task.Factory.StartNew(words.Reverse);\n         await Task.Factory.StartNew(words.Shuffle);\n    }\n</code></pre>\n\n<p>it raises an exception,</p>\n\n<pre><code>    Common Language Runtime detected an invalid program.\n    System.InvalidProgramException\n</code></pre>\n\n<p>could someone explain why, </p>\n\n<p><code>await Task.Factory.StartNew(words.Sort);</code> and</p>\n\n<p><code>await Task.Factory.StartNew(words.Reverse);</code> works and </p>\n\n<p><code>await Task.Factory.StartNew(words.Shuffle)</code> doesn't work but only </p>\n\n<p><code>await Task.Factory.StartNew(() =&gt; words.Shuffle());</code> works for Shuffle extension method? Whats the difference?</p>\n\n<p>I am testing this in <strong>Visual Studio 2010</strong> and <strong>Async CTP Library</strong>.</p>\n"},{"tags":["c#","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13261101,"title":"Alternative to FiddlerCore? Or a Better Webbrowser Control?","body":"<p>Hello guys I have an issue bugging me for the past few weeks. </p>\n\n<p>What I'm trying to accomplish: I need a webbrowser control with the ability to change user agent (once at start) and referrer. But most important The ability to see the urls responses. What I mean by that for example if you navigate to a website you get back Images/Javascripts files in response I need access to those urls (Regular Webbrowser Control will not show you those &amp; you can't access it in any way). </p>\n\n<p>I was able to do that with webbrowser + fiddlercore I can see and do what ever with those urls addresses. The problem was if you run few instances of this program (or sometimes once if the program has some automation to work with the url responses) It gets stuck or doesn't work. I tried fixing it and making it work but it's kind of a hacky solution that doesn't work right. I need a simple way to access those urls just as if you used httpwebrequest but as a webbrowser. Why I need it as a webbrowser? The way I work I need the execution of all the tracking pixels and scripts and images etc.. a normal webbrowser behaivor in httpwebrequest if you want google analytics you have to create a code to re create it, you can't just navigate and all the scripts will be execute as webbrowser, or can you? </p>\n\n<p>can you guys can offer me some help or guide me in what direction should I look? \nThanks a lot!</p>\n"},{"tags":["c#","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13260964,"title":"Cast to Int from a VB Collection","body":"<p>Do you see wrong code in here? I am getting a InvalidCaseException on the foreach loop that is using an INT variable:</p>\n\n<pre><code> Microsoft.VisualBasic.Collection oHeaders = GetFieldIdsByName(msREPORT_HEADER);\n\nforeach (int FieldId in oHeaders)\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13260951,"title":"How to proxy a REST API with .NET 4","body":"<p>I'm trying to write a simple, pass-through proxy in .NET.</p>\n\n<p>I have a REST api hosted at some external domain (http://exampleapi.com),</p>\n\n<p>And I want to pass through all requests sent to my application (get, post, etc). JSONP isn't an option.</p>\n\n<p>So if I ask for  <code>GET localhost:1234/api/pages</code>  =>  <code>GET http://exampleapi.com/pages</code>\nLikewise if I <code>POST localhost:1234/api/pages</code>  =>  <code>POST http://exampleapi.com/pages</code></p>\n\n<p>The big problem I have, and what I can't seem to find elsewhere - is that I <em>don't</em> want to parse this JSON. Everything I've searched through seems to center around <code>HttpClient</code>, but I can't seem to figure out how to use it correctly.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>public ContentResult Proxy()\n{\n    // Grab the path from /api/*\n    var path = Request.RawUrl.ToString().Substring(4);\n    var target = new UriBuilder(\"http\", \"exampleapi.com\", 25001);\n    var method = Request.HttpMethod;\n\n    var client = new HttpClient();\n    client.BaseAddress = target.Uri;\n\n    // Needs to get filled with response.\n    string content;\n\n    HttpResponseMessage response;\n    switch (method)\n    {\n        case \"POST\":\n        case \"PUT\":\n            StreamReader reader = new StreamReader(Request.InputStream);\n            var jsonInput = reader.ReadToEnd();\n\n            // Totally lost here.\n            client.PostAsync(path, jsonInput);\n\n            break;\n        case \"DELETE\":\n            client.DeleteAsync(path);\n            break;\n        case \"GET\":\n        default:\n            // need to capture client data\n            client.GetAsync(path);\n            break;\n    }\n\n    return Content(content, \"application/json\");\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13242945,"title":"converting textbox string to int","body":"<p>I'm trying to compare and multiply 2 random number variables with the int value entered in textboxes. If it is the correct increment the correct answers it does not increase the number although it increment works alone but it does not work with the textbox.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    int x = Randomnumber.Next(12);\n    int z = Randomnumber.Next(12);\n\n    //int cv = +correct;\n    textBox2.Text = x.ToString();\n    textBox3.Text = z.ToString();\n\n    int s = x * z;\n    if (s == int.Parse(textBox4.Text))\n    {\n        correct++;\n        numbercorrect.Text = correct.ToString();\n    }\n}\n</code></pre>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13260771,"title":"How to solve the following method issue in c#","body":"<p>I have this in my main:</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        Money m1 = new Money(2315.99);\n\n        Money m2 = new Money(4000, 25);\n\n        Console.WriteLine(m1);\n        Console.WriteLine(m2);\n\n        Console.WriteLine(m1.IncrementMoney(m2));\n    }\n\n\n\n    public void IncrementMoney(Money x)\n    {\n        //what do I put in here?\n    }\n</code></pre>\n\n<p>So\n <br/><code>Money m1 = new Money(2315.99);</code><br/> is supposed to turn 2315.99 into \"$2315.99\"</p>\n\n<p>and </p>\n\n<p><code>Money m2 = new Money(4000, 25);</code><br/> forms \"$4000.25\"</p>\n\n<p>I have all that done in Money class and it works fine.            </p>\n\n<p>Now what I'm supposed to do is add those two together using \n     <br/>       <code>m1.IncrementMoney(m2);</code></p>\n\n<p>This is my \"Money\" class</p>\n\n<pre><code>class Money\n{\n\n    //instance variables\n    private int dollars;\n    private int cents;\n\n\n    double amount;\n\n\n    public int Dollars\n    {\n        get { return dollars; }\n        set\n        {\n            if (value &gt; 0)\n                dollars = value;\n        }\n    }\n\n\n\n    public int Cents\n    {\n        get { return cents; }\n        set\n        {\n            if (value &gt; 0)\n                cents = value;\n        }\n    }\n\n\n\n    public Money(int Dol, int Cen)\n    {\n        Dollars = Dol;\n        Cents = Cen;\n\n        double Dollar = Convert.ToDouble(Dollars);\n        double Cent = Convert.ToDouble(Cents);\n\n        amount = Dollar + (Cent / 100);\n\n    }\n\n\n    public Money(double am)\n    {\n        int dol = Convert.ToInt32(am);\n\n        if (dol &gt; am)\n            Dollars = dol - 1;\n\n        else if (dol &lt; am)\n            Dollars = dol;\n        //Dollars\n\n        double cen = am % 1;\n\n        cen = cen * 100;\n\n        Cents = Convert.ToInt32(cen);\n        //Cents\n\n        double Dollar = Convert.ToDouble(Dollars);\n        double Cent = Convert.ToDouble(Cents);\n\n        amount = Dollar + (Cent / 100);\n    }\n\n    //override ToString()\n    public override string ToString()\n    {\n        return string.Format(\"{0:c}\", amount);\n    }\n\n\n}//end class Money\n</code></pre>\n\n<p>But I have no idea what to put into the <code>IncrementMoney</code> method. <br/>Please help?\n<br/>and if not too much trouble, maybe a little insight to how it works? I'd really like to know.</p>\n\n<p>Sorry if I didn't give enough info,\n<br/>If anything else is required please let me know.\n<br/>and thanks!</p>\n"},{"tags":["c#","service","xmlhttprequest"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13260691,"title":"Best Practice: Converting an application to a service with a schedule","body":"<p>I'm a bit of a beginner as far as programming is concerned. And looking at stack overflow I haven't found anything that quite answers my question. \nI have created a C# console application that is used to push an XML file to a web service that I don't control. It does this by creating an http webrequest. The service will probably be running on windows server 2008, or a win 7 varient. Development is done in VS 2010.\nMy end goal is to run this program twice a day with little user involement. And I was told that services were the best way to do this. I know that services do not take user input and that outputs are usually to a log file. My console app dosn't take user input but must have the ability to C.R.U.D. files. Beacuse it creates and then reads an XMl file into the web request. If needed I should have no problems having it write any errors to a log file, but at current though it creates/sends an error report via email. </p>\n\n<p>I have 2 questions:</p>\n\n<p>Question 1:\nI would like this service to call the application every 12 hours, Is it more reliable/better practice to use a service to determine when to run the application? Or use windows' built in scheduler, or a .net solution like quark? I'm looking for reliability and also, little user involvement. Kind of a set and forget deal.</p>\n\n<p>Question 2: \nWhat would the suggested  best practice be for converting my program?\nINFO: I have previously created a empty windows service that I would like to fold my application into. (This was done via tutorial, the service contains all that is needed to for a service but it dosn't do anything... yet! OnStart, OnStop, installer etc.) What would be the best way to do it? Should I call my application inside the service's OnStart() method? Our should I add the application as a dll to the service. It's not that I don't think I could do it. It's just my searches on the matter seem to point out that it would be better to just start from a service and add some code to that. My goal would be to minimise the code needed to convert this application.</p>\n\n<p>Thanks for all your help,\nChris </p>\n"},{"tags":["c#","inheritance","serialization","xml-serialization"],"answer_count":7,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3998,"score":6,"question_id":1708924,"title":".NET XML Serialization and inheritance","body":"<p>I have structure like this:</p>\n\n<pre><code>public interface A\n{\n    public void method();\n}\n\npublic class B : A\n{\n}\n\npublic class C : A\n{\n}\n\nList&lt;A&gt; list;\n</code></pre>\n\n<p>List contains objects of type B and C they also have some fields that I would like to keep, can I now serialize it, deserialize back and get the proper object instances? \nPreferably to XML</p>\n\n<p>EDIT:</p>\n\n<p>Is there any simple way to serialize this list that contains interfaces, and then deserialize it back to B and C instances?</p>\n"},{"tags":["c#","compact-framework","sql-server-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":667,"score":0,"question_id":3152248,"title":"problem with sql server compact 3.5 and smart device project","body":"<p>Recently i downloaded SQLServer Compact 3.5 from Microsoft web site, and i have already installed Visual Studio 2008.\nWhen i make a new Smart Device project and try to connect some Dataset to local database, the following error rises :\n\"Error  1   Custom tool error: This operation requires a reference to SQL Server Compact 3.5. The project has a reference to a different version. Update the reference and try again.\"</p>\n\n<p>i tried reinstalling  Visual Studio 2008, but it did not work.</p>\n"},{"tags":["c#","asp.net","vb.net","visual-studio","webforms"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13260995,"title":"How to get a collection of page elements?","body":"<p>On Page_Init, I check if Button1 was pressed, if so I create a series of LiteralControls in a Panel, called Panel1:</p>\n\n<pre><code>   Panel1.Controls.Add(new LiteralControl(\"&lt;table&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;tr&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 1&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 2&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Header 3&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;/tr&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;tr&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Data 1&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;Data 2&lt;/td&gt;\"));\n   Panel1.Controls.Add(new LiteralControl(\"&lt;td&gt;&lt;input type=\\\"text\\\" name=\\\"txtCode3\\\"&gt;&lt;/td&gt;\"));                \n   Panel1.Controls.Add(new LiteralControl(\"&lt;/tr&gt;\"));\n\n   Panel1.Controls.Add(new LiteralControl(\"&lt;/table&gt;\"));\n</code></pre>\n\n<p>I have a second button, that on click, I want to fill a NameValueCollection (or any other list) with all table cell elements (or values).</p>\n\n<p>How can I do this?\nI've tried:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n             NameValueCollection coll = Request.Form;\n    }\n</code></pre>\n\n<p>But this only gives me:</p>\n\n<pre><code>AllKeys:\n    [0] \"_VIEWSTATE\"\n    [1] \"_EVENTVALIDATION\"\n    [2] \"Button2\"\n    [3] \"txtCode3\"\n</code></pre>\n\n<p>As you can see, I can't get all cell elements.\nI should get:</p>\n\n<pre><code>AllKeys:\n    [0] \"_VIEWSTATE\"\n    [1] \"_EVENTVALIDATION\"\n    [2] \"Button2\"\n    [3] Header 1\n    [4] Header 2\n    [5] Header 3\n    [6] Data 1\n    [7] Data 2\n    [3] \"txtCode3\"\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["c#","visual-studio-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13260788,"title":"Can´t add item to ListBox in different form","body":"<p>I´m trying to build an application that can store different persons in a ListBox-control. </p>\n\n<p>My ListBox-control is located in <strong>Form1</strong> and so is this method that´s giving me some problem:</p>\n\n<pre><code>  public void addPersonToList(Person person) {\n            string newPerson = person.firstName + \" \" + person.lastName + \" \" + person.age;\n\n            personList.Items.Add(newPerson);\n\n }\n</code></pre>\n\n<p>In another Form, I call the addPersonsToList-method like this:</p>\n\n<pre><code>Form1 form1 = new Form1();\n  form1.addPersonToList(person);\n</code></pre>\n\n<p>Now, I´ve checked (while debugging) that the string <strong>newPerson</strong> in addPersonToList actually stores the correct string. <strong>The problem is that the string won´t show up in my ListBox</strong>(named personList).</p>\n\n<p>Any suggestions? </p>\n"},{"tags":["c#","database","entity-framework","ef-code-first","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":13260306,"title":"Entity Framework 5: Code-First Cyclical Relationship Issues","body":"<p>I understand why EF does not allow \"cyclical references\" in the PK/FK relationships. I am looking for advice on how to alter my model to make the following scenario work.</p>\n\n<h3>Scenario</h3>\n\n<p>Three entities: <code>Employee</code>, <code>Agency</code>, <code>WorkRecord</code>. Their purpose is to log Employee time spent doing work. <code>Employee</code> then contains reference to the <code>Agency</code> he/she is employed by, and his/her <code>WorkRecord</code> contain reference to the <code>Agency</code> the work was done for.</p>\n\n<pre><code>public class Employee\n{\n    [Key]\n    public int Id { get; set; }\n\n    public string Name { get; set; }\n\n    public int AgencyId { get; set; }\n    public virtual Agency Agency { get; set; }\n\n    public virtual IEnumerable&lt;WorkRecord&gt; WorkRecords { get; set; }\n}\n\npublic class Agency\n{\n    [Key]\n    public int Id { get; set; } \n}\n\npublic class WorkRecord\n{\n    [Key]\n    public int Id { get; set; } \n\n    public int Hours { get; set; } \n\n    public int AgencyId { get; set; } \n    public virtual Agency Agency { get; set; } \n\n    public int EmployeeId { get; set; }\n    public virtual Employee { get; set; }\n}\n</code></pre>\n\n<p>Like this, it bitches: <code>FK_dbo.WorkRecords_dbo.Employees_EmployeeId</code> causes a cyclical reference.</p>\n\n<h3>Experiments</h3>\n\n<p>My first thought was because of the bi-directional virtual properties, so I decided to designate one of the two a top-level entity with a 1-way relationship:</p>\n\n<p>First, I designated <code>WorkRecord</code> as a top-level entity and remove the virtual <code>WorkRecords</code> reference reference from the <code>Employee</code> entity... the same message is produced.</p>\n\n<p>Second, I made <code>Employee</code> the top-level entity, leaving its virtual <code>WorkRecords</code> collection, and removing the virtual <code>Employee</code> reference property from the <code>WorkRecord</code> entity... works fine but does not achieve my goal.</p>\n\n<p>After more investigation, I find it is the Agency virtual reference property on both entities that causes the circular reference. If one entity removes this, the <code>Employee</code>/<code>WorkRecord</code> entity relationships work in all directions. </p>\n\n<h3>Question:</h3>\n\n<p>So, clear as i can ask - how can I express this business model, using <code>WorkRecord</code> as my top-level entity, without making EF5 upset?</p>\n"},{"tags":["c#","math","rounding","significant-digits"],"answer_count":10,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":20350,"score":12,"question_id":374316,"title":"Round a double to x significant figures","body":"<p>If I have a double (234.004223) etc.\nI would like to round this to x significant digits in C#</p>\n\n<p>So far I can only find ways to round to x decimal places but this simply removes the precision if there are any 0s in the number.</p>\n\n<p>e.g. 0.086 to 1 decimal place becomes 0.1 but I would like it to stay 0.08.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wcf","wcf-client","wcf-hosting"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1495,"score":1,"question_id":1959383,"title":"Hosting and Consuming WCF Service from Same Process","body":"<p>Can you become a client of a WCF Service from with the Process that is hosting the WCF Service?  I have tried creating seperate App Domains within the same process and still no success.  The service is confirmed to be available on Http, Net.TCP and Net.Pipe.</p>\n\n<p>Thank you for any help!</p>\n\n<p>Nat</p>\n"},{"tags":["c#","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":15,"down_vote_count":1,"view_count":126,"score":14,"question_id":13258315,"title":"Check if two strings share the same pattern of repeated characters","body":"<p>Is there an efficient Regex to assert that two string share the same pattern of repeated characters.</p>\n\n<pre><code>(\"tree\", \"loaa\") =&gt; true\n(\"matter\", \"essare\") =&gt; false\n(\"paper\", \"mime\") =&gt; false\n(\"acquaintance\", \"mlswmodqmdvp\") =&gt; true\n(\"tree\", \"aoaa\") =&gt; false\n</code></pre>\n\n<p>Event if it's not through Regex, I'm looking for the most efficient way to perform the task</p>\n"},{"tags":["c#","xpath","html-agility-pack","selectnodes"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":89,"score":5,"question_id":13225438,"title":"HtmlAgilityPack SelectNodes expression to ignore an element with a certain attribute","body":"<p>I am trying to select nodes except from script nodes and a ul that has a class called 'relativeNav'. Can someone please direct me to the right path? I have been searching for this for a week and I can't find it anywhere. Currently I have this but it obviously selecting the //ul[@class='relativeNav'] as well. Is there anyway to put an NOT expression of it so that SelectNode will ignore that one?</p>\n\n<pre><code>        foreach (HtmlNode node in doc.DocumentNode.SelectNodes(\"//body//*[not(self::script)]/text()\"))\n        {\n            Console.WriteLine(\"Node: \" + node);\n            singleString += node.InnerText.Trim() + \"\\n\";\n        }\n</code></pre>\n"},{"tags":["c#","search","windows-8","windows-store-apps"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13195477,"title":"How do you actually implement the Search Contract? (C#)","body":"<p>I'm having some trouble understanding and getting the search contract to work in my Store app. I have been unable to find any sort of documentation or guide that explains the structure of using the contract. (I've looked at the quickstarts on MSDN, the Search Contract sample and the build video, but that only really deals with javascript)</p>\n\n<p>So far I've been able to run a query and get a list (of Custom Objects) into my search contract page, and from there I try to assign that to defaultviewmodel.results, but no matter what query I type nothing shows up I on the page. Is there something else I need to set?\nWhat I have so far is as follows (excerpts):</p>\n\n<p>App.xaml.cs </p>\n\n<pre><code>protected override void OnSearchActivated(Windows.ApplicationModel.Activation.SearchActivatedEventArgs args)\n        {\n            SearchCharmResultsPage.Activate(args.QueryText, args.PreviousExecutionState);\n            SearchCharmResultsPage.ProcessSearchQuery(args.QueryText);\n        }    \n\n\npublic async static void ProcessSearchQuery(string queryString)\n        {\n            try\n            {\n                StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync(\"recipeCustomObject                  Debug.WriteLine(\"Database exists, connecting\");\n                SQLiteAsyncConnection connection = new SQLiteAsyncConnection(\"CustomObject_db\");\n                List&lt;CustomObject&gt; resultsList = new List&lt;CustomObject&gt;();\n                string query = \"SELECT * FROM CustomObjectDB\";\n                resultsList =  await connection.QueryAsync&lt;RecipeRecord&gt;(query);  \n            }\n            catch (FileNotFoundException fnfExc)\n            {\n                Debug.WriteLine(\"FNFEXC: \" + fnfExc.ToString());\n            }\n        }\n</code></pre>\n\n<p>I think it is possible that here lies the problem, though I'm not sure if it is, or how to change it.\nthe resultsList list is created here, but because the method it asynchronous, I can't return from the method. Because of this I'm guess that when I try to assign <code>this.DefaultViewModel[Results] = resultsList;</code> in the LoadStateMethod, the object doesn't exist (thought the program throws no error). When I try to add the same line in the <code>ProcessSearchQuery</code> method, i'm told that <code>this</code> is not valid in a static method, but I think I need the method to be static? My problem might just be a fundamental logic error?</p>\n"}]}
{"total":375450,"page":19,"pagesize":100,"questions":[{"tags":["c#","asp.net","asp.net-mvc","webclient"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13259348,"title":"Show downloadable link to csv","body":"<p>I am trying to show a stream of data in a downloadable .csv file with the following code:</p>\n\n<pre><code>WebClient wc = new WebClient();\n                    byte[] csvBytes = wc.DownloadData(url);\n                    return File(csvBytes, \"text/csv\", \"Test.csv\");\n</code></pre>\n\n<p>The URL returns data in this format:</p>\n\n<p>\n    \"PAUL\",\"SMITH\",\"A &amp; P CONSTRUCTION\",\"211 N JACKSON ST\",\"New York\",\"NY\",\"98055\"\n    \"JEROME\",\"HALSEY\",\"A A A LOCATING INC\",\"1906 SOUTHVIEW DR\",\"PAPILLION\",\"NE\",\"68046\"\n    \"MIKE\",\"GIBILISCO\",\"ABSOLUTE SECURITY INC\",\"944 S JEFFERSON ST\",\"PAPILLION\",\"NE\",\"84102\"\n</p>\n\n<p>The above works well, and I get a downloadable link ... but when I open the .csv file - I get the records in just one row:</p>\n\n<pre><code>\\\"PAUL\\\"    \\\"SMITH\\\"   \\\"A &amp; P CONSTRUCTION\\\"  \\\"211 N JACKSON ST\\\"    \\\"PAPILLION\\\"   \\\"NE\\\"  \\\"68046\\\"...\n</code></pre>\n\n<p>How should I modify the above code so that I get the values in the right format (without the \"\\\" and under the right columns)?</p>\n"},{"tags":["c#","methods","iterator","enumerator","yield-return"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13213130,"title":"How can yield return statement return no elements?","body":"<p>I'm practicing deletion of nodes on a binary search tree, and I created a special type for null links (<strong>NullNode</strong>) using null pattern, so I can add some desirable behaviour to \"null\" types. Both <strong>Node</strong> type and <strong>Nullnode</strong> type share the same <strong>INode</strong> interface, which includes recursive methods.</p>\n\n<p>The <strong>INode</strong> interface includes <strong>IEnumerable</strong> recursive methods por PreOrder, InOrder and PostOrder traversal, but I don't want NullNode to return any element (through yield return statements).</p>\n\n<p>What can I do?</p>\n\n<p>I know that I can use an impossible if-condition and then put there a yield return statement in the method, but I don't think this solution is good. There should be a better approach.</p>\n"},{"tags":["c#","asp.net-mvc-3","linq-to-sql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13259088,"title":"Linq redundant db access for related models","body":"<p>Why does my model go out to the DB again for related properties which have already been loaded in a separate LINQ join statement?</p>\n\n<p><strong>Background info:</strong></p>\n\n<p>I recently ran some Performance profiling on my ASP.NET MVC3 Linq application I got some puzzling results that I hope to resolve. </p>\n\n<p>Here is a simplified version of db structure. Foreign key relationships are set up. </p>\n\n<p><strong>Table Client:</strong></p>\n\n<pre><code>ID|Client Name|Vertical ID|\n___________________________\n1 |Client1    |2          |\n2 |Client2    |5          |\n3 |Client3    |           |\n</code></pre>\n\n<p><strong>Table Vertical</strong></p>\n\n<pre><code>ID|Vertical Name|\n_________________\n2 |Life         |\n5 |Guilt        |\n</code></pre>\n\n<p>When I display the list of clients, I am displaying them the client name and the vertical. My Controller is simple:</p>\n\n<pre><code>public ActionResult Index()\n    {\n        ...\n    var model = repository.GetAllClients();\n        return View(model);\n    }\n</code></pre>\n\n<p>Get all clients runs the join on the vertical table (as well as a few others). </p>\n\n<pre><code> public IEnumerable&lt;client&gt; GetAllClients()\n    {\n        OperationsMetricsDataContext db = new OperationsMetricsDataContext();\n        var clients = from c in db.clients\n                      join v in db.verticals on c.vertical equals v into tmp1\n                      from v in tmp1.DefaultIfEmpty()\n                      join sm in db.cel_sm_staffs on c.sm_id equals sm.cel_sm_id into tmp2\n                      from sm in tmp2.DefaultIfEmpty()\n                      join cel in db.cel_sm_staffs on c.cel_id equals cel.cel_sm_id into tmp3\n                      from cel in tmp3.DefaultIfEmpty()\n                      select c;\n        return clients;\n    }\n</code></pre>\n\n<p>In my View, I then attempt to display the vertical name I have bound using this method in my partial client class</p>\n\n<pre><code>public string getVerticalName()\n    {\n        return this.vertical == null ? \"N/A\" : this.vertical.vertical_name;\n    }\n</code></pre>\n\n<p><strong>The problem:</strong></p>\n\n<pre><code>@foreach (var item in Model) {\n&lt;tr&gt;\n    &lt;td&gt;\n        @Html.Raw(item.client_name)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.Raw(item.getVerticalName())\n    &lt;/td&gt;\n</code></pre>\n\n<p>The problem that I uncovered is that even though I specified the join in the original model,  (and I've been able to verify that the vertical property has a value loaded before the model is passed to the view), each time I call the getVerticalName method, Linq automatically goes out to the db again to load the vertical so that I can access the vertical name. This is pretty inefficient because I end up with a separate db call for each client just to get their vertical information.</p>\n\n<p>What am I missing here? Shouldn't LINQ know that the property is already bound and not go out to the db to retrieve it or is there something I need to specify to tell LINQ that my information already exists in the model?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260688,"title":"how to remove the default control buttons from a windows form","body":"<p>The image describes what I am trying to do.</p>\n\n<p>I have a \"connect four\" game which works perfectly well but I want to remove the default buttons provided at the top right hand corner of the window. Any quick help on this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ws3ss.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#"],"answer_count":15,"favorite_count":6,"up_vote_count":57,"down_vote_count":0,"view_count":31391,"score":57,"question_id":1859248,"title":"how to change time in datetime","body":"<p>How can i change the time alone in DateTime variable in c#.</p>\n\n<pre><code>DateTime s = some datetime;\n</code></pre>\n\n<p>i need to the change the time alone in the 's'..</p>\n"},{"tags":["c#","wpf","xaml","multibinding","syncfusion"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13256286,"title":"WPF MultiBinding fails in Syncfusion TabItemExt header","body":"<p>I have a subclass of <code>TabItem</code> as follows, for which I'm trying to set the <code>Header</code> property. I've tried this with a <code>MultiBinding</code>:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n            &lt;Binding Path=\"BoundVariable1\" /&gt;\n            &lt;Binding Path=\"BoundVariable2\" /&gt;\n        &lt;/MultiBinding&gt;    \n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>But it fails as such:</p>\n\n<pre><code>System.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\nSystem.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')\n</code></pre>\n\n<p>I'd always thought the <code>StringFormat</code> served the role of the converter, but perhaps not?</p>\n\n<p>Wrapping the fields together in some kind of container, like a <code>Label</code>, also doesn't seem to work:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Label&gt;\n            &lt;Label.Text&gt;\n                &lt;MultiBinding StringFormat=\"Hello world {0} {1}\"&gt;\n                    &lt;Binding Path=\"BoundVariable1\" /&gt;\n                    &lt;Binding Path=\"BoundVariable2\" /&gt;\n                &lt;/MultiBinding&gt;    \n            &lt;/Label.Text&gt;\n        &lt;/Label&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>In this case, the <code>.ToString()</code> representation of the label (\"<code>System.Windows.Controls.Label</code>\") is shown as the header.</p>\n\n<p>Note that a single binding works just fine:</p>\n\n<pre><code>&lt;DataEditPane x:TypeArguments=\"MyType\" x:Class=\"MyDataEditPane\"&gt;\n    &lt;DataEditPane.Header&gt;\n        &lt;Binding Path=\"BoundVariable1\" /&gt;\n    &lt;/DataEditPane.Header&gt;\n&lt;/DataEditPane&gt;\n</code></pre>\n\n<p>If it matters, I'm using the Syncfusion <code>TabItemExt</code> as one of my superclasses in the inheritance hierarchy, but as that class doesn't override the <code>Header</code> property I don't think that makes a difference.</p>\n\n<p>What am I doing wrong? I know I can make another property in the ViewModel to act as the Header (and then single-bind that) but I want to learn how to do this properly in XAML.</p>\n"},{"tags":["c#",".net","dynamic","expression","iqueryable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13252206,"title":"Dynamic IQueryable order by using string","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/41244/dynamic-linq-orderby\">Dynamic LINQ OrderBy</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to create a dynamic sorting to Iqueryable.<br>\nSo bellow you can see that I am following some examples I see here in stackoverflow.</p>\n\n<pre><code> var query = dalSession.Query&lt;T&gt;();\n            var res = (from x in query orderby Extensions.Sort&lt;T&gt;(query, \"FirstName\") select x).Skip((paging.CurrentPageRecord)).Take(paging.PageSize);\n\n\npublic static class Extensions\n{\n    public static IQueryable&lt;T&gt; Sort&lt;T&gt;(this IQueryable&lt;T&gt; query,\n                                             string sortField)\n    {\n        return query.OrderByDescending(s =&gt; s.GetType()\n                                             .GetProperty(sortField));\n\n    }\n} \n</code></pre>\n\n<p>This is the exception that I get:</p>\n\n<blockquote>\n  <p>System.Linq.IQueryable<code>1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable</code>1[Partners.BusinessObjects.Affiliate], System.String)</p>\n</blockquote>\n\n<pre><code>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.NotSupportedException: System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate], System.String)\n</code></pre>\n"},{"tags":["c#","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13260322,"title":"how to use .NET Action to execute a method with unknown number of parameters?","body":"<p>Certaintly this is a dumb and basic question but i i'm trying to figure out how this works. </p>\n\n<p>What i want to achieve is to execute some operations on a worker thread while displaying a progress bar to the user. I've created a class </p>\n\n<pre><code>public class ProgressBar\n\n {\n   public void StartAsyncTask(Action action)\n    {\n      Task t = new Task(action);\n      t.start();\n    }\n }\n</code></pre>\n\n<p>I found out that i can send any  method to the StartAsyncTask in the following way:</p>\n\n<pre><code>      ProgressBar pb = new ProgressBar();\n      pb.StartAsyncTask( () =&gt; DoSomething(15, \"something\"));\n\n\n      public void DoSomething(int i, string s)\n       {\n          //do something\n       }\n</code></pre>\n\n<p>First of all, i can't seem to understand what is and how is lambda () => expression translated and how is the Action object passed a delegate with an unknown number of parameters. </p>\n\n<p>I would like to use a </p>\n\n<pre><code>    BackgroundWorker \n</code></pre>\n\n<p>with my ProgressBar but in this case i would need to invoke the action. So something like this:</p>\n\n<pre><code>    void m_backgroundWorker_DoWork(object sender, DoWorkEventArgs e)\n    {\n        Action action = e.Argument as Action; //same action here passed through EventArgs\n       //but already in a worker thread so no need for the Task object \n\n\n       //and now i need to somehow invoke the action object but i don't know what the parameters are. \n\n       action.Invoke( ? ); \n\n        }\n</code></pre>\n\n<p>How is it possible in the first example to execute the action without knowing the parameters in </p>\n\n<pre><code>         StartAsyncTask(Action action) method. \n</code></pre>\n\n<p>Why do i need to know the parameters when invoking the action in this case? </p>\n\n<p>Everything about how/why/when to use \"Action\" is pretty unclear to me even if i read msdn documentation and some other threads here on stackoverflow. \nAny information on this will help me.</p>\n\n<p>Thank you,\nDan</p>\n"},{"tags":["c#","java","c++","oop"],"answer_count":16,"favorite_count":1,"up_vote_count":13,"down_vote_count":1,"view_count":917,"score":12,"question_id":2289642,"title":"The best learning route into Object Oriented Programming from C?","body":"<p>What is the best route to go for learning OOP if one has done some programming in C.</p>\n\n<p>My intention was first to take the natural leap and \"increment with one\" and go for Stroustrup. But since I got my hands on the little old Bertrand Meyers OOSC2 and I qoute from the appendix page 1135 <em>\"..according to Donald Knuth, it would make Edsger Dijkstra 'physically ill to think of programming in C++\"</em>\nAnd Meyer himself <em>\"..that C++ is not the ideal OOP language...\"</em></p>\n\n<p>And what about this A critiqe on C++ on this question: <a href=\"http://burks.brighton.ac.uk/burks/pcinfo/progdocs/cppcrit/\" rel=\"nofollow\">A critique of C++</a></p>\n\n<p>Should I skip C++ and go for C# and or Java directly if my intention is a great and deep understanding of a modern OOP-language, or do I miss good points on this subject in C++?</p>\n\n<p>Well I know this is a discussion-thing but I mark it wiki and you're answers could mean a lot for me in choices to come.</p>\n"},{"tags":["c#","xml","xdocument","xelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260437,"title":"How can I get a node from an XML document based on its attribute value and into an XElement object?","body":"<p>I need to inject some XML into a pre-existing XML file under a certain node.  Here is the code I have to create my XML:</p>\n\n<pre><code>//Define the nodes\nXElement dataItemNode = new XElement(\"DataItem\");\nXElement setterNodeDisplayName = new XElement(\"Setter\");\nXElement setterNodeOU = new XElement(\"Setter\");\n\n//Create the tree with the nodes\ndataItemNode.Add(setterNodeDisplayName);\ndataItemNode.Add(setterNodeOU);\n\n//Define the attributes\nXAttribute nameAttrib = new XAttribute(\"Name\", \"OrganizationalUnits\");\nXAttribute displayNameAttrib = new XAttribute(\"Property\", \"DisplayName\");\nXAttribute ouAttrib = new XAttribute(\"Property\", \"OU\");\n\n//Attach the attributes to the nodes\nsetterNodeDisplayName.Add(displayNameAttrib);\nsetterNodeOU.Add(ouAttrib);\n\n//Set the values for each node\nsetterNodeDisplayName.SetValue(\"TESTING DISPLAY NAME\");\nsetterNodeOU.SetValue(\"OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com\");\n</code></pre>\n\n<p>Here is the code I have so far to load up the XML document and try to get the node that I need to insert my XML under:</p>\n\n<pre><code>//Load up the UDI Wizard XML file\nXDocument udiXML = XDocument.Load(\"UDIWizard_Config.xml\");\n\n//Get the node that I need to append to and then append my XML to it\nXElement ouNode = THIS IS WHAT I DONT KNOW HOW TO DO\nouNode.Add(dataItemNode);\n</code></pre>\n\n<p>Here is the XML from the existing document I am trying to work with:</p>\n\n<pre><code>&lt;Data Name=\"OrganizationalUnits\"&gt;\n        &lt;DataItem&gt;\n          &lt;Setter Property=\"DisplayName\"&gt;TESTING DISPLAY NAME&lt;/Setter&gt;\n          &lt;Setter Property=\"OU\"&gt;OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com&lt;/Setter&gt;\n        &lt;/DataItem&gt;\n</code></pre>\n\n<p>I have multiple nodes that with the name of \"Data\", but I need to get the node that is , and I don't know how.  Just learning how to use XML with C#.</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","session","service","user-profile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13259488,"title":"How can I detect when a user's session has finished logging off","body":"<p>I have a Windows service that is successfully detecting SessionLogon and SessionLogoff (and most of the othes) by overriding the ServiceBase object. This works well. However, it appears these events are fired immediately after authentication and immediately after the user clicks the Log off button (or some automated process logs the user off). In addition to knowing when the user first starts to log in and first starts to log out, I need to know about when the user finishes logging on and finishes logging off. I currently look for the user's shell process to start executing (typically explorer.exe) for log in and for the most part that works pretty well. By the time their shell has launched if they're using roaming profiles or other log in actions are taking place, I can pretty much be sure that by the time the shell is running that the lion's share of the log on process has occurred. </p>\n\n<p>However for log off, this hasn't proven to be reliable. I'm looking for a way to accurately detect when a user's log off has finished including when all their profile information has finished being synchronized or copied and whatever other log off actions have occurred. Simply watching for their shell program to end doesn't seem to be enough as it may take from a few seconds to several minutes for log off to occur (say if they have a roaming profile).</p>\n\n<p>So in short, <strong>I'm looking for a programmatic way in C# to detect when the full log off has occurred and all profile synchronization or what have you has finished <em>after the SessionLogoff event</em> has fired.</strong></p>\n\n<p>I've looked high and wide, but haven't seen anyone talking about the time difference between when that event occurs and when the actual log off finishes.</p>\n\n<p>NOTE: I also cannot rely on the disconnect event because the user might disconnect after logoff but before their profile finishes synchronizing/copying what have you. I'm looking for a way to detect (within a few seconds of it occuring) the finished log off.</p>\n"},{"tags":["c#",".net","flash","youtube","youtube-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13260361,"title":"How to control the youtube flash player with c#?","body":"<p>So far this is what I have:</p>\n\n<pre><code>private AxShockwaveFlashObjects.AxShockwaveFlash player;\nplayer.movie = \"http://youtube.googleapis.com/v/9bZkp7q19f0\"\n...\nprivate void playBtn_Click(object sender, EventArgs e)\n{\n    player.CallFunction(\"&lt;invoke name=\\\"playVideo\\\" returntype=\\\"xml\\\"&gt;&lt;/invoke&gt;\");\n}\n</code></pre>\n\n<p>Unfortunately this returns: </p>\n\n<pre><code>\"Error HRESULT E_FAIL has been returned from a call to a COM component.\"\n</code></pre>\n\n<p>What am I missing? Should I load a different URL? <a href=\"https://developers.google.com/youtube/articles/youtube_as3_chromeless\" rel=\"nofollow\">The documentation</a> states that YouTube player uses <strong>ExternalInterface class</strong> to control it from JavaScript or AS3 so <a href=\"http://bojolais.livejournal.com/251383.html\" rel=\"nofollow\">it should work with c#</a>.</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":33,"score":-3,"question_id":13260426,"title":"Create form not affected by ShowDialog()","body":"<p>I'm currently doing a security assessment of an extremely large C# application.  I have wrote a tool to help me do the assessment that also runs in C#.  The entire application uses ShowDialog aka modal forms.  I'm trying to come up with a way where I can still use my tool (click on it for example) while modal dialog boxes are popped up.  I figure, this may require another thread or something else.  If anyone has any easy tips on a way to make it so that my form doesn't get blocked by ShowDialog, that would be great.  </p>\n"},{"tags":["c#","multithreading"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12470991,"title":"Know Thread Count","body":"<p>i have developed application which uses threads to finish the task and i want to close the running application in middle of the process its closes but thread is running in background. </p>\n\n<p>now i want to show active threads by which my application is created. but difficulty is, when i start the application from vs threads are shown in task manager like 14-19 threads without running the application.</p>\n\n<p>can u tell me to display only those threads which is created by my application and not by system.</p>\n"},{"tags":["c#","wpf","c#-4.0","xamdatagrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13256056,"title":"How to add a tooltip to the XamDataGrid record programmatically","body":"<p>I already know how to set the tooltip for a XamDataGrid using a style, e.g.:</p>\n\n<pre><code>&lt;Style TargetType={x:Type ig:DataRecordCellArea&gt;...\n</code></pre>\n\n<p>However, for a specific reason (don't have time to explain it all), I really need to invoke the tooltip programmatically, preferably hooked to a <code>MouseOver</code> event. </p>\n\n<p>I would really appreciate it if someone could illustrate the way.  What have I done so far? Not much, because the Infragistics site is full of XAML examples and doesn't offer any guidance on doing this programmatically (except for one trivial cell-level tooltip example).</p>\n"},{"tags":["c#","filesystemwatcher"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13257203,"title":"FileSystemWatcher: max number of folders","body":"<p>I have a server where my app is using FileSystemWatcher to monitor a folder say, <strong>e:\\A</strong>.\nInside the folder A, there are as many as 16,000 folders and each subfolder has numerous other folders and files.</p>\n\n<p>The app is crashing to desktop in about 1 hour.\nWhen there were fewer folders, the app was working fine.\nI have increased the internal buffer to twice the default value. </p>\n\n<p>Is there a limit on the maximum number of folders to be monitored?\nOr the folder itself is unstable due to the huge number of folders?</p>\n\n<p><strong>Update:</strong>\nThe app runs on a virtual machine(vmware).<br/>\nWindows Server 2008.<br/>\ndual 2.53 Intel Xeon.<br/>\n4 GB of RAM.<br/>\nRAID. [ 1.3TB, may be increased. ]</p>\n"},{"tags":["c#","mvvm","prism","enterprise"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13259308,"title":"Localization in enterprise application","body":"<p>where would you place \"localization &amp; globalization\" in an enterprise application 3-layered builded in c# WPF with MVVM and Prism? I mean in an application built like the pattern describe in msdn (http://msdn.microsoft.com/en-us/library/ee658124.aspx) in which layer would you put the logic for localization? what kind of approach would you use (resx files, db...)?</p>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":397,"score":4,"question_id":1724128,"title":"C# - custom explicit conversion with checked/unchecked operator","body":"<p>I'm learning to write custom type conversions in C# and I have a question I can't manage to resolve with Google / MSDN / earlier posted SO items.</p>\n\n<p>Normally, a C# program that narrows a numeric type does that via unchecked explicit conversion, e.g.:</p>\n\n<pre><code>int i = 256;\nbyte b = (byte)i; // b == 0\n</code></pre>\n\n<p>however, the following will give an overflow exception:</p>\n\n<pre><code>byte b = checked((byte)i);\n</code></pre>\n\n<p>My question is as follows: is the behavior of the checked / unchecked keyword implementable in an custom type conversion, e.g.:</p>\n\n<pre><code>class Foo {\n  public static explicit operator int(Foo bar) {\n    if (checked)\n      throw someEception\n    else\n      return some Foo to int conversion\n  }\n}\n</code></pre>\n\n<p>Of course, the code above is not the answer, but does anyone know if something like this is possible?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13260315,"title":"LINQ query for the following","body":"<p>Could someone help formulate a LINQ query for the following problem.\nI have the following list of Key-Value number sets (mind that Duplicate Keys are allowed). There are thousands of such sets.</p>\n\n<pre><code>{4,3}, {4,1}, {4,8}, {4,9}, {2,3}, {4,9}, {3,1} , {3,4}\n</code></pre>\n\n<p>What data structure would suit me best.\nAlso, I want to group the above list of key-pairs, and OrderByDescending() so that i can extract the highest Key-Value pair of a Key-group.</p>\n\n<p>For example in the above case, expected output:</p>\n\n<pre><code>{4,9}, {4,9}, {4, 8}, {4, 3}, {4, 1}, {2, 3}, {3, 4}, {3, 1}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","wpf","video-streaming","expression","broadcasting"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":268,"score":4,"question_id":10990427,"title":"wpf application for broadcasting video with 15sec delay","body":"<p>I have a WPF application for broadcasting video using Microsoft.expression.encoder and framework 4.0, but i got a delay of 15 sec while broadcasting.Is there any suggestion to reduce the delay while broadcasting.</p>\n\n<p>below is the Code</p>\n\n<pre><code>using Microsoft.Expression.Encoder.Live; \nusing Microsoft.Expression.Encoder;\n\nprivate void button1_Click(object sender, RoutedEventArgs e)\n{ \n    try \n    { \n        EncoderDevice video = null; \n        EncoderDevice audio = null;\n        GetSelectedVideoAndAudioDevices(out video, out audio);\n        StopJob();\n\n        if (video == null)\n        {\n            return;\n        }\n\n        StopJob();\n        _job = new LiveJob();\n\n        if (video != null &amp;&amp; audio != null)\n        {\n            //StopJob();\n            _deviceSource = null;\n            _deviceSource = _job.AddDeviceSource(video, audio);\n            _job.ActivateSource(_deviceSource);\n\n            // Finds and applys a smooth streaming preset        \n            //_job.ApplyPreset(LivePresets.VC1HighSpeedBroadband4x3);\n\n            // Creates the publishing format for the job\n            PullBroadcastPublishFormat format = new PullBroadcastPublishFormat();\n            format.BroadcastPort = 9090;\n            format.MaximumNumberOfConnections = 50;\n\n            // Adds the publishing format to the job\n            _job.PublishFormats.Add(format);\n\n            // Starts encoding\n            _job.StartEncoding();\n        }\n        //webCamCtrl.StartCapture();\n    }\n    catch (Exception ex)\n    {\n        WriteLogFile(this.GetType().Name, \"button1_Click\", ex.Message.ToString());\n    }\n\n}\n</code></pre>\n\n<p>I am using MediaElement to show  the webcam both on my server and client systems.</p>\n\n<p>on Client Side </p>\n\n<pre><code> try\n            {\n\n                theMainWindow.getServerIPAddress();\n                IP = theMainWindow.machineIP;\n                MediaElement1.Source = new Uri(\"http://\" + IP + \":9090/\");\n            }\n            catch (Exception ex)\n            {\n            }\n</code></pre>\n"},{"tags":["c#","winforms","path","treeview","directory"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13259963,"title":"Why does Path.GetFileName() return the name of the correct folder, but Path.GetDirectoryName() returns it parent folder?","body":"<p>I have found that using Path.GetFileName() in the code below works as I intend and gives me the name of the correct folder, but if I use Path.GetDirectoryName() it returns the name of the parent (UserGeneratedContent) folder instead. Why does this occur when both methods are passed the same path as a string? And why does Path.GetFileName() work on directories?</p>\n\n<p>When I use Path.GetFileName() the text of the nodes in the Treeview are those of the folders it finds - this is what I want to happen, but if I use Path.GetDirectoryName() the text is the full path from @\"UserGeneratedContent\" on down for each node. Why does that happen?</p>\n\n<p>And lastly, can my code be improved?      </p>\n\n<pre><code>private void CheckForBaseFolder()\n    {\n\n        if (Directory.Exists(@\"UserGeneratedContent\"))\n        {\n\n            DirectoryInfo info = new DirectoryInfo(@\"UserGeneratedContent\");\n            DirectoryInfo[] subdirs = info.GetDirectories();\n\n            if (subdirs.Length != 0)\n            {\n\n                string path = Path.Combine(@\"UserGeneratedContent\", subdirs[0].ToString());\n\n                treeView1.Nodes.Add(CheckForSubFolders(path));\n\n                treeView1.SelectedNode = treeView1.Nodes[0];\n\n            }\n            else { MessageBox.Show(\"No User-Generated Folders Or Files Found\");}\n\n        }\n        else\n        {\n\n            Directory.CreateDirectory(@\"UserGeneratedContent\");\n\n        }\n\n    }\n\n    private TreeNode CheckForSubFolders(string path)\n    {\n\n        TreeNode folder = new TreeNode(path);\n\n        folder.Text = Path.GetFileName(path); // Works as intended, but.....\n        folder.Text = Path.GetDirectoryName(path); // Returns the name of the parent folder \n\n        foreach(var subdirectory in Directory.GetDirectories(path))\n        {\n\n            folder.Nodes.Add(CheckForSubFolders(subdirectory));\n\n        }\n\n        folder.ImageIndex = 0;\n        folder.SelectedImageIndex = 1;\n\n        return folder;\n\n    }\n</code></pre>\n"},{"tags":["c#","windows-azure-storage","azure-storage-tables","azure-diagnostics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13260298,"title":"Tracking and scheduling Azure diagnostic Performance Metrics on demand","body":"<p>I've been reading many MSDN articles on the Diagnostics API's that the Azure platform provides and I'm having a bit of trouble. I listed my problems and showed below how I'm implementing my logic. </p>\n\n<p>My issue's are: \n1, that it seems I can only start keeping track of metrics at the start of a WebRole (RoleEntryPoint). This means if I want to turn off the diagnostics, I'll need to stop the webrole and restart it. </p>\n\n<p>2, The most recent counters I see are always from ~2 minutes in the past, despite my settings to record and transfer the counters every 10 seconds. (I will need to look into what sampling rates and transfer rates are appropriate)</p>\n\n<p>3, All the Counters are 0 when I look at the list's data. How can I assure they are measuring what I'm looking for? Currently I am opening a thread and sending requests (Posts to a URL) to the role for 30 seconds. I assume Requests/sec should be above 0. </p>\n\n<p>It looks like in the OnStart() method within the WebRole.cs class I must add the diagnostic performance counters I want to be tracked, as well as how often they should be sampled and transferred (to storage), as well as a max buffer size. I've done it as follows:</p>\n\n<pre><code>public override bool OnStart(){\n    DiagnosticMonitorConfiguration diagnosticConfig = DiagnosticMonitor.GetDefaultInitialConfiguration();       \n   // this is for scaling tests to measure WCF load\n   // Add a performance counter for requests per second.\n   // Use 5 Seconds for the performance counter sample rate.\n   TimeSpan perfSampleRate = TimeSpan.FromSeconds(5.0);\n   // Limit amount of data to be stored\n   diagnosticConfig.PerformanceCounters.BufferQuotaInMB = 1;\n   // Transfer the counters every 10 seconds\n   diagnosticConfig.PerformanceCounters.ScheduledTransferPeriod = TimeSpan.FromSeconds(10.0);\n   diagnosticConfig.PerformanceCounters.DataSources.Add(new PerformanceCounterConfiguration()\n   {\n        CounterSpecifier = @\"\\ASP.NET\\Requests/Sec\",\n        SampleRate = perfSampleRate\n   });\n   diagnosticConfig.PerformanceCounters.DataSources.Add(new PerformanceCounterConfiguration()\n   {\n       CounterSpecifier = @\"\\ASP.NET\\Requests Queued\",\n       SampleRate = perfSampleRate\n   });\n</code></pre>\n\n<p>then upon wanting to view the data I perform the following to put the data into a list of performance metrics:</p>\n\n<pre><code>        CloudStorageAccount storageAccount = CloudStorageAccount.Parse(\n                \"UseDevelopmentStorage=true\");\n\n        CloudTableClient cloudTableClient = storageAccount.CreateCloudTableClient();\n\n        TableServiceContext serviceContext = cloudTableClient.GetDataServiceContext();\n\n        IQueryable&lt;PerformanceCountersEntity&gt; performanceCountersTable =\n            serviceContext.CreateQuery&lt;PerformanceCountersEntity&gt;(\"WADPerformanceCountersTable\");\n\n        // Get all performance counters that exist from the last 10 seconds\n        var selection = from row in performanceCountersTable\n                        where row.EventTickCount &gt; DateTime.UtcNow.AddMinutes(-10.0).Ticks\n                        //where row.CounterName.Equals(@\"\\ASP.NET\\Requests/Sec\")\n                        select row;\n        CloudTableQuery&lt;PerformanceCountersEntity&gt; query = selection.AsTableServiceQuery&lt;PerformanceCountersEntity&gt;();\n\n        // Use the Execute commmand explicitly on the TableServiceQuery to \n        // take advantage of continuation tokens automatically and get all the data.\n        IEnumerable&lt;PerformanceCountersEntity&gt; result = query.Execute();\n\n        List&lt;PerformanceCountersEntity&gt; list = result.ToList();\n</code></pre>\n"},{"tags":["c#","wpf","webkit","webbrowser"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":0,"view_count":6479,"score":18,"question_id":4001547,"title":"C# WPF WebBrowser alternative","body":"<p>I need a web browser inside my .NET 3.5 application and I don't want to use the default webbrowser (because it feels buggy and slow). I tried Chris Cavanagh's chromium but I just couldn't get it to work... are there any easier to use alternatives? I'm looking for something very simple and light on the computer, it will host a webstore front if that matters.</p>\n"},{"tags":["c#","xna","xna-4.0","deferred-rendering"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13259725,"title":"XNA Deferred Shader, Replace BasicEffect","body":"<p>I have implemented deferred shading in my XNA 4.0 project, meaning that I need all objects to start out with the same shader \"<em>RenderGBuffer.fx</em>\". How can I use a custom Content Processor to:</p>\n\n<ol>\n<li>Not load any textures by default (I want to manually do this)</li>\n<li>Use \"<em>RenderGBuffer.fx</em>\" as the default shader instead of BasicEffect</li>\n</ol>\n\n<p>Below is the work so far:</p>\n\n<pre><code>public class DeferredModelProcessor : ModelProcessor\n{\n   EffectMaterialContent deferredShader;\n\n   public DeferredModelProcessor()\n   {\n\n   }\n\n   protected override MaterialContent ConvertMaterial(MaterialContent material, ContentProcessorContext context)\n   {\n       deferredShader = new EffectMaterialContent();\n       deferredShader.Effect = new ExternalReference&lt;EffectContent&gt;(\"DeferredShading/RenderGBuffer.fx\");         \n\n       return context.Convert&lt;MaterialContent, MaterialContent&gt;(deferredShader, typeof(MaterialProcessor).Name);\n   }\n}\n</code></pre>\n"},{"tags":["c#","xaml","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13243763,"title":"TextBlock won't display the rest of it's text even when it's resized","body":"<p>An app I'm working on retrieves information from the Internet and displays it in-app in a series of Grids inside of a StackPanel, itself nested inside of a ScrollViewer.</p>\n\n<p>My problem is this: The app shows a short summary of the content, and the idea is that clicking the content makes the Grid and TextBlock expand to show the rest of the content, however resizing the TextBlock doesn't show the text that was cut off by being too short originally. The TextBlock is created dynamically in c# code.</p>\n\n<p>Additionally, but not vital: I don't know how to get the full required height from the TextBlock to change it's text to, and without it I have to set the new size to a static number, which I feel detracts from the UX of my app.</p>\n\n<p>Thanks,\nJase</p>\n\n<hr>\n\n<p><strong>Update:</strong> This is the code used to generate the TextBlock:</p>\n\n<pre><code>this.message = new TextBlock()\n{\n    VerticalAlignment = VerticalAlignment.Top,\n    TextWrapping = TextWrapping.Wrap,\n    MaxWidth = getWidth()\n};\nif(post.message != null) { message.Text = post.message; }\n</code></pre>\n\n<p><strong>Update 2:</strong> This is the code that creates the StackPanel (XAML):</p>\n\n<pre><code>&lt;ScrollViewer Grid.Column=\"1\" Style=\"{StaticResource MainColumn}\" VerticalScrollBarVisibility=\"Auto\" SizeChanged=\"Feed_SizeChanged\"&gt;\n    &lt;StackPanel x:Name=\"Feed\"/&gt;\n&lt;/ScrollViewer&gt;\n</code></pre>\n\n<p>This is where the parent Grid is generated:</p>\n\n<pre><code>Post grid = new Post() { Margin = new Thickness(0, 0, 0, 5) };\nFeed.Children.Add(grid);\ngrid.layoutPost(oldCount, count--, post, Feed, this);\n</code></pre>\n\n<p>The height of the Grid is set in the layoutPost method, and ends up at 75px, Post is a class that extends Grid, and is defined here:</p>\n\n<pre><code>class Post : Windows.UI.Xaml.Controls.Grid\n</code></pre>\n"},{"tags":["c#","linq","divide-by-zero"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":205,"score":0,"question_id":10243382,"title":"How to prevent division by zero?","body":"<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / (x.Amount / 100) &gt;= filter.Persent);\n</code></pre>\n\n<p>if x.Amount == 0 I have error \"Divide by zero error encountered.\"</p>\n\n<p>like me in this request is to avoid?</p>\n\n<p><strong>update:</strong></p>\n\n<p>this helped, but I do not like the decision:</p>\n\n<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / ((x.Amount / 100)==0?0.1:(x.Amount / 100)) &gt;= filter.Persent);\n</code></pre>\n\n<p>there is another way?</p>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13260084,"title":"Route URLs from a web client back to the web client","body":"<p>I have an ASP.NET Controller, that has a function, that simply returns a ContentResult of a WebClient.</p>\n\n<p>In this case, CNN is my testbed, my WebClient, downloads CNN as a string, into it's content, and returns the result as an ActionResult/ContentResult on a controller.</p>\n\n<p>I'm calling a RenderPartial on this action, to get CNN to display \"below\" and to the right of my current content, in its own box.</p>\n\n<p>The problem I'm running into, is when you click a link on CNN, it redirects to a \"relative\" url sometimes, and that relative url, doesn't exist in my localhost, and won't exist on my web server, thus the link fails.</p>\n\n<p>When it does redirect to an absolute url, that's also a problem, as the resulting page \"replaces\" my .NET shell.</p>\n\n<p>What I need it to do, is take any URLs that are inside that ContentResult I returned, and if any of those URLs are clicked, pass them back to my .NET application, to be downloaded by the WebClient, and rendered back in that shell.</p>\n\n<p>I'm aware I could use an IFRAME to do this instead of WebClient, but an IFRAME is impossible in my case, as its restricted by the public API we're consuming, its restricted/has flaws in the framework that API is servicing, and its blocked on some of our client machines, which we have no control over.</p>\n\n<p>Also, the client machines will be off our network, so I can't use an AJAX load, as that'd be XSS.</p>\n\n<p>One idea that I can think of, is basically to create custom routes, with filters/rules, that look for \"CNN\" like links, and pass them to my controller, as a parameter; then have my controller render my page, and pass those links to the web client.</p>\n\n<p>This would obviously be a lot of work, and not even really sure where to start with it in the routing engine.</p>\n\n<p>The only other thing I can think of that might work, is checking the validity of the URL, by attempting to see if it points to a valid link. If it doesn't point to a valid link, adding CNN's url prefix to it, and seeing if that is then a valid link. But that seems like a lot of work, for a solution that would be a heavy hit on performance, as checking each link on a page like CNN, could be very costly. Also, since I'd be running each link twice, that'd be a problem where POST operations were required, as it'd essentially run each operation twice, and being that this is a public API I'm consuming off a public framework, I wouldn't have control of the source code to safeguard against that.</p>\n\n<p>Any other suggestions?\nIs there any way to accomplish what I'm trying to do easily?</p>\n"},{"tags":["c#","visual-studio-2010","intellisense"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":9181890,"title":"Intellisense Issues in strings and methods/members","body":"<p>While coding in C# for Visual Studio 2010, I've noticed, that for some reason, after creating a delegate method, or using the \"Extract method\" menu option from Visual Studio, my IntelliSense decides it wants to go overboard. It starts activating inside a string, trying to complete stuff from outside (for instance, if I type \"To be continued...\" as I start to type continued, it suggests \"const\" as an option, thinking I'm still coding, and not recognizing I'm in a string.</p>\n\n<p>Also, when it starts doing the above, it also starts doing stuff like suggesting a while loop, while trying to do a Debug.WriteLine, and the Debug class has no members listed in the IntelliSense popup window, all it lists is base classes for my current namespaces.</p>\n\n<p>Now if I push <kbd>ctrl</kbd> <kbd>space</kbd> manually, I get the proper intellisense options.</p>\n\n<p>Sometimes, closing all open files, and reopening them fixes it; sometimes I have to completely close visual studio and reopen it to fix it.</p>\n\n<p>Is anyone else experiencing similar issues, or know of any fixes to the issue?</p>\n"},{"tags":["c#","mono","monodevelop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":10766998,"title":"MonoDevelop Addin: how to set the CopyToOutput build option in the \"xpt.xml\" file","body":"<p>I was wonder how you set the \"Copy to output directory\" option to \"copy if newer\" when making MonoDevelop Addins for new project types??</p>\n\n<p>Take this block of code for example, ... what do I need to add to get the \"manifest.json\" to copy to the output directory at build time?</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Template originator = \"Andrew Witte\"&gt;\n\n    &lt;TemplateConfiguration&gt;\n        &lt;_Name&gt;MonoNaCl Project&lt;/_Name&gt;\n        &lt;_Category&gt;C#/MonoNaCl&lt;/_Category&gt;\n        &lt;LanguageName&gt;C#&lt;/LanguageName&gt;\n        &lt;_Description&gt;Creates a MonoNaCl project.&lt;/_Description&gt;\n    &lt;/TemplateConfiguration&gt;\n\n    &lt;!-- Actions --&gt;\n    &lt;Actions&gt;\n        &lt;Open filename = \"Internal.c\"/&gt;\n        &lt;Open filename = \"Main.cs\"/&gt;\n    &lt;/Actions&gt;\n\n    &lt;Combine name = \"${ProjectName}\" directory = \".\"&gt;\n        &lt;Options&gt;\n            &lt;StartupProject&gt;${ProjectName}&lt;/StartupProject&gt;\n        &lt;/Options&gt;\n        &lt;References&gt;\n            &lt;Reference type=\"Gac\" refto=\"System\" /&gt;\n        &lt;/References&gt;\n        &lt;Project name = \"${ProjectName}\" directory = \".\" type = \"MonoNaCl\"&gt;\n            &lt;Options Target = \"Exe\"/&gt;\n            &lt;Files&gt;\n&lt;File name=\"manifest.json\"&gt;\n&lt;![CDATA[{\n\"name\": \"MonoNaCl\",\n  \"description\": \"Mono for NaCl project.\",\n  \"version\": \"1.0.0\",\n  \"icons\": {\n  },\n  \"requirements\": {\n    \"3D\": {\n      \"features\": [\"css3d\", \"webgl\"]\n    }\n  },\n  \"app\": {\n    \"launch\": {\n      \"local_path\": \"${ProjectName}.html\"\n    }\n}\n}\n]]&gt;&lt;/File&gt;\n&lt;/Files&gt;\n        &lt;/Project&gt;\n    &lt;/Combine&gt;\n&lt;/Template&gt;\n</code></pre>\n"},{"tags":["c#","vb.net","operator-overloading","operator-keyword"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":77,"score":4,"question_id":13259162,"title":"VB.Net Power operator (^) overloading from C#","body":"<p>I am writing a C# class that is exposed to VB.Net. I would like to overload the vb.net <code>^</code> operator so that I can write:</p>\n\n<pre><code>Dim c as MyClass\nSet c = New ...\nDim d as MyClass\nSet d = c^2\n</code></pre>\n\n<p>In C#, the <code>^</code> operator is the <code>xor</code> operator and the power operator doesn't exist. Is there a way I can do this anyway?</p>\n"},{"tags":["c#","asp.net","postback"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1629,"score":4,"question_id":9136510,"title":"ASP.NET postback from wrong dropdownlist after using browser Back button","body":"<p>I've got an ASP.NET 2.0 web application that is partly navigated by using <code>DropDownList</code> controls.  When one of them is changed, it causes a postback, which is then redirected to another URL depending on what was chosen in the dropdown.</p>\n\n<p>I've noticed strange behavior when using the browser's Back button after using the dropdowns.  The procedure is this:</p>\n\n<ol>\n<li>Make a selection in one of the dropdowns, causing a postback and redirect.  Good so far.</li>\n<li>Click the browser's Back button.</li>\n<li>In another navigation dropdown <b>below the one used before</b> (they're all contained in one <code>div</code>), make a selection.  The page redirects to the same URL as the first time, not what it should redirect to based on this other dropdown.</li>\n</ol>\n\n<p>I've tried this in both Firefox 10 and IE9 and seen the same thing.  I looked at the Net tab in Firebug and saw that in the POST for step 3, the correct control is referenced.  But when I debug it, the event handler for the wrong dropdown (the one used in step 1) fires.</p>\n\n<p>The code is pretty simple and straightforward.  Example of markup:</p>\n\n<pre><code>&lt;asp:DropDownList runat=\"server\" ID=\"ddlTest\" AutoPostBack=\"true\" /&gt;\n</code></pre>\n\n<p>The dropdowns actually aren't plain <code>&lt;asp:DropDownList ... /&gt;</code> elements; I'm inserting <code>optgroup</code> elements with an approach similar to <a href=\"http://www.codeproject.com/Articles/15505/ASP-NET-DropDownList-with-OptionGroup-support\" rel=\"nofollow\">this</a>.</p>\n\n<p>Example of C#:</p>\n\n<pre><code>ddlTest.Click += new EventHandler(ddlTest_SelectedIndexChanged);\n</code></pre>\n\n<p>And in <code>ddlTest_SelectedIndexChanged</code>:</p>\n\n<pre><code>if (ddlTest.SelectedValue != \"\")\n{\n   Response.Redirect(MyUtilClass.GetUrl(ddlTest.SelectedValue));\n}\n</code></pre>\n\n<p>What's going on here?</p>\n\n<p><b>UPDATE 2/6/2012</b>: I've fixed this by checking for the content of <code>Request[\"__EVENTTARGET\"]</code> in my <code>SelectedIndexChanged</code> event handlers.  I'm still curious why it happens, though.  Why is the first event repeated?  And why does it only happen when the second postback happens from a control below the first one?</p>\n"},{"tags":["c#","regex","string"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13259723,"title":"Extracting value from string","body":"<p>I've got problem with extracting a string from a html code (that's basically problem with regex expression).\nHere's the code:</p>\n\n<pre><code>string wheretosearch = @\"\n&lt;td class=\"\"name\"\"&gt;\n&lt;div&gt;\n&lt;a href=\"\"/addr1.html\"\" class=\"\"link \"\"&gt;\n&lt;span&gt;Title1&lt;/span&gt;\n&lt;/a&gt;&lt;/td&gt;\n\n[some code]\n\n&lt;td class=\"\"name\"\"&gt;\n&lt;div&gt;\n&lt;a href=\"\"/addr2.html\"\" class=\"\"link \"\"&gt;\n&lt;span&gt;Title2&lt;/span&gt;\n&lt;/a&gt;&lt;/td&gt;\";\n</code></pre>\n\n<p>I want to extract titles between  tags. What my problem is that I cannot put the unknown number of chars in regex (.* section after td class=\"\"name\"\"  ):</p>\n\n<pre><code>&lt;td class=\"\"name\"\"&gt;.*&lt;span&gt;(?&lt;title&gt;.*)&lt;/span&gt;\n</code></pre>\n\n<p>To put things simply: I want regex to find <code>&lt;td class=\"\"name\"\"&gt;</code> and then after unknown number of characters find first occurrence of <code>&lt;span&gt;</code> and then take the value between that first <code>&lt;span&gt;</code> and <code>&lt;/span&gt;</code>.</p>\n\n<p>What it actually does it takes the last occurrence of <code>&lt;span&gt;</code> and gives the last title only.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Okay, besides the HTML issue, the problem is like:\nI've got string:</p>\n\n<p><em>\"This is a text: NICE. This is a great text: NICE TOO.\"</em></p>\n\n<p>I would like to take \"This\" then unknown number of characters, then string between \": \" and \".\" How this could be done?</p>\n\n<p>Of course I'm interested in each occurance of that complex expression, so the output would be \"NICE\" and \"NICE TOO\" in collection. </p>\n\n<p>For my expression  like <code>\"This.*(?&lt;title&gt;.*).\"</code> i get only the \"NICE TOO\" string, as @urlreader mentioned, it finds the max length matched string.</p>\n"},{"tags":["c#",".net","uri"],"answer_count":4,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":8118,"score":14,"question_id":2884551,"title":"Get individual query parameters from Uri","body":"<p>I have a uri string like: <a href=\"http://example.com/file?a=1&amp;b=2&amp;c=string%20param\">http://example.com/file?a=1&amp;b=2&amp;c=string%20param</a></p>\n\n<p>Is there an existing function that would convert query parameter string into a dictionary same way as ASP.NET Context.Request does it.</p>\n\n<p>I'm writing a console app and not a web-service so there is no Context.Request to parse the URL for me.</p>\n\n<p>I know that it's pretty easy to crack the query string myself but I'd rather use a FCL function is if exists.</p>\n"},{"tags":["c#","asp.net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13257173,"title":"selected value of dropdown list not changing in template field","body":"<p>I have a dropdown list in a template field that has it's selected value on load set to another field in the gridview. In the rowupdating event the dropdown goes back to the initial selected value and does not retain the new value. I have the method that fills the grid wrapped in a if this.page.IsPostBack on the page_load event. How do I bind the control's new selected value during rowupdating event and ignore it's initial databind?? </p>\n\n<p>I have the auto post back property set to true as well. </p>\n\n<p>Here is the rowupdating event ( I am actually inserting into a different table NOT updating this grid)</p>\n\n<pre><code>protected void grd_add_bins__RowUpdating(object sender, GridViewUpdateEventArgs e)\n        {\n            GridViewRow row = (GridViewRow)grd_add_bins.Rows[e.RowIndex];\n            //int id = Int32.Parse(grdBins.DataKeys[e.RowIndex].Value.ToString());\n\n            Label room1 = (Label)row.FindControl(\"grd_add_room\");\n            Label grower1 = (Label)row.FindControl(\"grd_add_grower_id\");\n            TextBox bins1 = (TextBox)row.FindControl(\"grd_add_txtbins_to_pack\");\n            DropDownList packas1 = (DropDownList)row.FindControl(\"grd_add_ddl_pack_as\");\n            TextBox block1 = (TextBox)row.FindControl(\"grd_add_txt_block\");\n            Label pool1 = (Label)row.FindControl(\"grd_add_pool\");\n\n            SqlCommand cmd = new SqlCommand();\n            cmd.CommandText = \"insert into t_run_schedule_lots  \" +\n                              \"(record_key,room_id,grower_id,block_id,pool_id,total_bins,pack_as) \" +\n                              \"values (@rec_id,@room,@grower,@block,@pool,@bins,@pack_as)\";\n\n            cmd.Parameters.Add(\"@rec_id\", SqlDbType.VarChar).Value = lblRec_key.Text;\n            cmd.Parameters.Add(\"@room\", SqlDbType.VarChar).Value = room1.Text;\n            cmd.Parameters.Add(\"@grower\", SqlDbType.VarChar).Value = grower1.Text;\n            cmd.Parameters.Add(\"@bins\", SqlDbType.Int).Value = Convert.ToInt32(bins1.Text);\n            cmd.Parameters.Add(\"@pack_as\", SqlDbType.VarChar).Value = packas1.Text;\n            cmd.Parameters.Add(\"@block\", SqlDbType.VarChar).Value = block1.Text;\n            cmd.Parameters.Add(\"@pool\", SqlDbType.VarChar).Value = pool1.Text;\n\n            cmd.CommandType = CommandType.Text;\n            cmd.Connection = this.sqlConnection1;\n            this.sqlConnection1.Open();\n            // execute insert statement\n            cmd.ExecuteNonQuery();\n            this.sqlConnection1.Close();\n\n            fill_grid();&lt;-- fills other grid that shows the result of the insert\n            fill_bins_grid();&lt;-- fills this grid\n            //Reset the edit index.\n            grd_add_bins.EditIndex = -1;\n            //Bind data to the GridView control.\n            grd_add_bins.DataBind();\n\n\n\n        }\n</code></pre>\n"},{"tags":["c#","sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13257925,"title":"Update the dataset after rows changed","body":"<p>Scenario:</p>\n\n<ol>\n<li>Excel file is read and displayed in datagrid.</li>\n<li>Values in sql server must be updated  if excel values are different.</li>\n<li>Table in Sql server don't have primary key</li>\n</ol>\n\n<p>After all these steps, when I am about to update the table, it throws the error saying \"Update requires a valid UpdateCommand when passed DataRow collection with modified rows.\" </p>\n\n<p>There is no primary key. So I need to use update command. BUt how and what would be in update command? importdata is dictionary where data from excel are stored. PLz help!!! What should I do now? I have No idea....</p>\n\n<pre><code>foreach (DataColumn column in ds.Tables[0].Columns)\n{\n    string fieldName = column.ColumnName;\n    string fieldNameValueE = string.Empty;\n    if (importdata.ContainsKey(fieldName))\n    {\n        fieldNameValueE = importdata[fieldName];\n        foreach (DataRow dr in ds.Tables[0].Rows)\n        {\n            string fieldNameValueD = dr[fieldName].ToString();\n            if (fieldNameValueD != fieldNameValueE)\n            {\n                dr[fieldName] = fieldNameValueE;\n\n            }\n        }\n\n    }\n\n}\n\nda.Update(ds);\nconnection.Close();    \n</code></pre>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13259533,"title":"Is there a better way to split an array into a string","body":"<p>I am trying to pass an Array to a method and then return a string I can use for a SQL WHERE clause.  I have the following and it works just fine.  But is there a better way?  I am looking for one of the two results;</p>\n\n<ol>\n<li><code>WHERE (ColumnName IN (12, 34, 56, 78, 90))</code></li>\n<li><code>WHERE (ColumnName IN ('12', '34', '56', '78', '90'))</code></li>\n</ol>\n\n<hr/>\n\n<pre><code>    public static string setInSearchFilter(string psSearchFilter, string psColumnName, \n        string[] paObjectValues, bool pbIsString)\n    {\n        string lsDelimiter = \"'\", lsRetVal = string.Empty, lsObjectValues = string.Empty;\n\n        if (!pbIsString)\n        {\n            lsDelimiter = string.Empty;\n        }\n\n        if (!string.IsNullOrEmpty(psSearchFilter))\n        {\n            lsRetVal = psSearchFilter + \" AND \";\n        }\n\n        for (int i = 0; i &lt;= paObjectValues.GetUpperBound(0); i++)\n        {\n            lsObjectValues += lsDelimiter + paObjectValues[i] + lsDelimiter;\n\n            if (i &lt; paObjectValues.GetUpperBound(0))\n            {\n                lsObjectValues += \", \";\n            }\n        }\n\n        return lsRetVal += \"(\" + psColumnName + \" IN (\" + lsObjectValues + \"))\";\n    }\n</code></pre>\n"},{"tags":["c#","deserialization","datacontract","datamember"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13259840,"title":"Why do I need to specify [DataMember(IsRequired=false)] on a property of a Class when it is contained in a list by a parent Class?","body":"<p>I have a class MyClass that has a list of another class MyOtherClass</p>\n\n<pre><code>[Serializable]\n[DataContract(Namespace = \"\")]\npublic class MyClass\n{\n    public string Something { get; set; }\n    public Guid SomethingElse { get; set; }\n    [DataMember]\n    public string Name { get; set; }\n    [DataMember]\n    public List&lt;MyOtherClass&gt; Things { get; set; }\n</code></pre>\n\n<p>}</p>\n\n<p>In this example, Name and Things are expected to be set in the incoming Json. The props without a DataMember attribute are allowed to be ignored.</p>\n\n<pre><code>{\"Things\":[{\"Value\":\"$$$\",\"Id\":\"8836C0C2-EDB2-4A8A-ACCB-44EC7C566551\"},{\"Value\":\"qwerty\",\"Id\":\"AF987F24-6EBC-4D3B-A48A-DCE5FF1A660F\"},{\"Value\":\"asdf\",\"Id\":\"226CECC6-BE9C-4D14-B355-F52D414FCD97\"}],\"Name\":\"poi\"}\n</code></pre>\n\n<p>I also wanted the same sort of behaviour in MyOtherClass</p>\n\n<pre><code>[Serializable]\n[DataContract(Namespace = \"\")]\npublic class MyOtherClass\n{\n    [DataMember(IsRequired = true)]\n    public Guid Id { get; set; }\n    [DataMember(IsRequired = false)]\n    public String Description { get; set; }\n    [DataMember(IsRequired = true)]\n    public string Value { get; set; }\n}\n</code></pre>\n\n<p>But I found if I didn't specify a DataMember attribute on the properties I wasn't requiring, in this case Description, I would get a DataContract de-serialization error stating that no value was provided for Description.</p>\n\n<p>Deserialization is not as strict for the parent class, which doesn't give out errors for missing values when DataMember is not attached.</p>\n\n<p>So as depicted in my example, I had to attach DataMemeber to each property of MyOtherClass and explicitly specify IsRequired=false for properties that aren't necessary.</p>\n\n<p>Why can't I just forgo the DataMemeber attribute?</p>\n"},{"tags":["c#","rally"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13241881,"title":"Rally API: Adding Users to a Project","body":"<p>I'm new to the Rally world and am struggling through how to use the RallyRestAPI. There are a number of examples of how to query Rally to get back pertinent information that I have found most helpful. What I'm trying to do is create a C# command line tool to add users to a project. It appears that I use the RallyRestAPI.Create(\"projectpermission\",some dynamic json object) interface to accomplish the creation. My problem is understanding the \"some dynamic json object\" part. I'm not sure how to correctly set it up. If someone has a small example of how to set it up, I would appreciate it.</p>\n"},{"tags":["c#","javascript","ajax","mvc","web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13259774,"title":"How can I debug a 500 Internal Server Error when calling a WebApi from ajax?","body":"<p>I am receiving a 500 Internal Server Error in a MVC 4.5 WebApi project.  I can successfully call my webservice with a GET and a GET with an Id.  But, when I POST a file I am getting the error.  I can set a breakpoint in <code>Application_BeginRequest()</code> and confirm that I am receiving first an OPTIONS request and then the POST.  The method in the controller is not getting called and I have added an <code>Application_Error()</code> method to Global.asax.cs that does not get hit either.  The html page is doing a CORS but I have already handled that using <a href=\"http://nuget.org/packages/Thinktecture.IdentityModel\" rel=\"nofollow\">ThinkTecture.IdentityModel</a>.  I am following the code <a href=\"http://stackoverflow.com/questions/5392344/sending-multipart-formdata-with-jquery-ajax\">here</a> for the file upload.</p>\n\n<p>Any ideas?</p>\n\n<p>Here is the client code:</p>\n\n<pre><code>    &lt;script type=\"text/javascript\"&gt;\n        var UploadDocument = function () {\n            var url = sessionStorage.getItem(\"url\");\n            var auth = sessionStorage.getItem(\"auth\");\n            var data = new FormData();\n\n            jQuery.each($('#fileToUpload')[0].files, function (i, file) {\n                data.append('file-' + i, file);\n            });\n\n            jQuery.support.cors = true;\n            $.ajax({\n                type: \"POST\",\n                url: url,\n                data: data,\n                cache: false,\n                processData: false,\n                contentType: false,\n                //dataType: \"json\",\n                headers: { Authorization: 'Basic ' + auth },\n                crossDomain: true,\n                success: function (data, textStatus, jqXHR) {\n                    alert('Success');\n                },\n                error: function (jqXHR, textStatus, errorThrown) { alert('Error: ' + textStatus + ' ' + errorThrown.message); }\n            });\n        };\n\n    &lt;/script&gt;\n</code></pre>\n\n<p>My controller code looks like this:</p>\n\n<pre><code>    public int Post(HttpPostedFileBase FileToUpload)\n    {\n        // Do stuff with the file\n    }\n</code></pre>\n\n<p>The request and response look like this:</p>\n\n<pre><code>Request URL:http://localhost:51234/api/TaxDocument\nRequest Method:POST\nStatus Code:500 Internal Server Error\n\nRequest Headers\nAccept:*/*\nAccept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3\nAccept-Encoding:gzip,deflate,sdch\nAccept-Language:en-US,en;q=0.8\nAuthorization:Basic YmNhbGxlbjpuZWxsYWM=\nConnection:keep-alive\nContent-Length:2054044\nContent-Type:multipart/form-data; boundary=----WebKitFormBoundaryIGzPKhvRVwFXbupu\nHost:localhost:51234\nOrigin:http://localhost:52386\nReferer:http://localhost:52386/Upload.html\nUser-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4\n\nResponse Headers:\nAccess-Control-Allow-Credentials:true\nAccess-Control-Allow-Origin:http://localhost:52386\nCache-Control:no-cache\nContent-Length:1133\nContent-Type:application/json; charset=utf-8\nDate:Tue, 06 Nov 2012 21:10:23 GMT\nExpires:-1\nPragma:no-cache\nServer:Microsoft-IIS/8.0\nX-AspNet-Version:4.0.30319\nX-Powered-By:ASP.NET\nX-SourceFiles:=?UTF-8?B?QzpccHJvamVjdHNcU2F2ZU15VzJcU2F2ZU15VzIuV2Vic2VydmljZVxhcGlcVGF4RG9jdW1lbnQ=?=\n</code></pre>\n"},{"tags":["c#","sql-server-2008","iis","iis7","iis-7.5"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13154836,"title":"One application pool keeps hanging IIS 7","body":"<p>For some reason my application pool keeps crashing once in a couple of days. The biggest problem is that there are no logs about errors or warnings in my administrative events about this pool. (there are several warnings in other pools, but it is only this pool that keeps crashing). Changes I make can only be tested if they worked if I wait a couple of days.</p>\n\n<p>I tried to bring my code back to the stage where the problems did not occur, but this does not seem to help.</p>\n\n<p>Most crashes happen when the site is not very busy, although not that inactive that IIS shuts it down for inactivity.</p>\n\n<p>Windows server 2008 R2 (SP 1),\nIIS Build 7.5.76,\nUmbraco,\nSql server 2008</p>\n\n<p>IIS logs: only showing some recycling of the pool (once every 3 hours)\nRapid fail detection: disabled</p>\n\n<p>Where should I start with solving this problem?</p>\n"},{"tags":["c#","neo4jclient"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12884172,"title":"Neo4jClient C# How to get all nodes","body":"<p>I am using Neo4jClient and Neo4j graph database in C# and I am wondering how I can retrieve all nodes with Neo4jClient.</p>\n\n<p>Here is the cypher query to retrieve all nodes which have a relationship to \"KNOWS\" independently of the relationship direction :</p>\n\n<pre><code>start n =node(*) match n-[r:KNOWS]-(friend) return friend;\n</code></pre>\n\n<p>And here is the C# code with Neo4jClient :</p>\n\n<pre><code>var client = new GraphClient(new Uri(\"http://localhost:7474/db/data\"));\nclient.Connect();\n\nvar cypherFluentQueryReturned = client.RootNode\n                .StartCypher(\"n\")\n                .Match(\"n-[:KNOWS]-&gt;friend\")\n                .Return&lt;Node&lt;Person&gt;&gt;(\"friend\");\n</code></pre>\n\n<p>However Neo4jClient doesn't allow to retrieve all nodes from * but only from a start point, here the root node.<br>\nHow can I say with Neo4jClient to retrieve all nodes and not only nodes attached to root node?</p>\n\n<p>It seems there is no way to query nodes from * through Neo4jClient.GraphClient.</p>\n\n<p>However I can do that by executing a query with RawGraphClient :</p>\n\n<pre><code>CypherQuery query = new CypherQuery(\"start n=node(*) match n-[KNOWS]-(person) return person\", new Dictionary&lt;string, object&gt;(), CypherResultMode.Set);\nvar persons = ((IRawGraphClient)client).ExecuteGetCypherResults&lt;Person&gt;(query).ToList();\n</code></pre>\n"},{"tags":["c#","math","overflow","checked"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":76,"score":1,"question_id":13259408,"title":"Why doesn't C# use arithmetic overflow checking by default?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/103654/why-dont-languages-raise-errors-on-integer-overflow-by-default\">Why don’t languages raise errors on integer overflow by default?</a>  </p>\n</blockquote>\n\n\n\n<p><strong>Why doesn't C# use arithmetic overflow checking by default?</strong></p>\n\n<p>I figure that it would generally be better to have exceptions occur when this occurs so that errors aren't obscured. I know that it's occasionally useful to take advantage of the 'wrapping' behaviour that occurs, but the <code>unchecked</code> keyword could be used in these circumstances to make the intentions explicit.</p>\n\n<p>I expect that this decision was made intentionally, perhaps to increase compatibility with other C-based languages.</p>\n"},{"tags":["c#","asp.net","vb.net","visual-studio","webforms"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13259505,"title":"How to preserve user input in literal control on postback?","body":"<p>On Page_Init, if is post back, I check if a button called Button1 was clicked, if so I add a LiteralControl to a Panel called Panel1:</p>\n\n<pre><code>Panel1.Controls.Add(new LiteralControl(\"Enter Code:&lt;input type=\\\"text\\\" name=\\\"txtCode\\\"&gt;&lt;/td&gt;\"));  \n</code></pre>\n\n<p>As you can see, it is just the text \"Enter Code:\" followed by a TextBox called txtCode.</p>\n\n<p>I have a second button (Button2) that, when clicked, I would like to retrieve the text entered in txtCode:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n        foreach (Control c in Panel1.Controls)\n        {\n            if (c is LiteralControl) ...                \n        }\n    }\n</code></pre>\n\n<p>I'm not sure how to do this... How can I get the text entered in txtCode?</p>\n"},{"tags":["c#","polygons"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":35,"score":-5,"question_id":13259637,"title":"Converting a triangle List to a triangle strip","body":"<p>I'm working with polygons in C#, and I have the following problem:<br>\nI have a list of triangles which form a polygon, and I need to convert it to a triangle strip, since another module I use requires a strip.<br>\nSo far I found two versions of such an algorithm, both in C++. I'm looking for something based on C# to make it simpler to integrate in my code.</p>\n\n<p>Does someone happen to know any implementation for the issue?</p>\n\n<p>Thanks, Dima.</p>\n"},{"tags":["c#","linq","entity-framework","type-conversion","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13259608,"title":"Cannot convert source type 'void' to target type 'ICollection<Character>'","body":"<p>I have a <code>DataContract</code> class that I'm trying to convert to another class, <code>Movie</code> but for the property <code>Movie.Characters</code> I'm getting the error...</p>\n\n<blockquote>\n  <p>Cannot convert source type '<code>void</code>' to target type '<code>ICollection&lt;Character&gt;</code>'</p>\n</blockquote>\n\n<p>How can I create a new <code>Movie</code> so the <code>Character</code> property is set properly mapped to each <code>Person</code> and <code>Movie</code>?</p>\n\n<pre><code>var movies = dataContract.Movies.Select(m =&gt; new Movie {\n    Id = m.Id,\n    Title = m.Title,\n    Characters = m.AbridgedCast.ToList().ForEach(p =&gt; new Person { Name = p.Name, \n        RottenTomatoesId = p.Id, \n        Characters = p.Characters.ToList().ForEach(c =&gt; new Character { Name = c })})\n});\n</code></pre>\n\n<p><strong>MoviesDataContract.cs</strong></p>\n\n<pre><code>public class MoviesDataContract {\n    [DataMember(Name = \"total\")]\n    public int Total { get; set; }\n\n    [DataMember(Name = \"movies\")]\n    public IEnumerable&lt;Movie&gt; Movies { get; set; }\n\n    #region Internal Classes\n\n    [DataContract]\n    public class Movie {\n        [DataMember(Name = \"id\")]\n        public int Id { get; set; }\n\n        [DataMember(Name = \"title\")]\n        public string Title { get; set; }\n\n        [DataMember(Name = \"abridged_cast\")]\n        public virtual IEnumerable&lt;Person&gt; AbridgedCast { get; set; }\n    }\n\n    [DataContract]\n    public class Person {\n        [DataMember(Name = \"name\")]\n        public string Name { get; set; }\n\n        [DataMember(Name = \"id\")]\n        public int Id { get; set; }\n\n        [DataMember(Name = \"characters\")]\n        public IEnumerable&lt;string&gt; Characters { get; set; }\n    }\n\n    #endregion  \n}\n</code></pre>\n\n<p><strong>Movies.cs</strong></p>\n\n<pre><code>public partial class Movie {\n    public Movie() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n\n    public int Id { get; set; }\n    public string Title { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n}\n\npublic partial class Character {\n    public System.Guid Id { get; set; }\n    public int MovieId { get; set; }\n    public System.Guid PersonId { get; set; }\n    public string Name { get; set; }\n\n    public virtual Movie Movie { get; set; }\n    public virtual Person Person { get; set; }\n}\n\npublic partial class Person {\n    public Person() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n\n    public System.Guid Id { get; set; }\n    public string Name { get; set; }\n    public int RottenTomatoesId { get; set; }\n\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","string-formatting"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1329,"score":1,"question_id":5908200,"title":"String.Format is not formating phone number","body":"<pre><code>String.Format(\"{0:###-###-####}\", customer.ContactHome); //NOT working (9891205789)\n</code></pre>\n\n<p><strong>BUT</strong></p>\n\n<pre><code>String.Format(\"{0:###-###-####}\", Convert.ToInt64(customer.ContactHome)); //Works fine (989-120-5789)\n</code></pre>\n\n<p>but I don't want to Cast phone no due to some reason. How can I format phone no without casting?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13254648,"title":"Application closes after user input","body":"<p>I'm trying to construct a game on the console, but after a player is asked to input either A or B, the application closes. It shouldn't!</p>\n\n<p>I have two classes. This one is Window.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace MyAdventure\n{\npublic class Window\n{\n    public static void theWindow()\n    {\n        string playerInput = Console.ReadLine();\n\n        Console.Clear();\n        Console.WriteLine(\"You approach the window, and you look outside.\");\n        Console.WriteLine(\"You see lots of trees, but you can't put a name on the location.\");\n        Console.WriteLine(\"You pull the handle on the window in an attempt to open it.\");\n        Console.WriteLine(\"You succeed and escape the room through the window.\");\n        Console.WriteLine(\"\\nAs you look around, you still don't know where you are.\");\n        Console.WriteLine(\"You suddenly hear someone approaching from behind.\");\n        Console.WriteLine(\"You turn around and see a man drenched in blood.\\nHe's pale, and he looks sick. He moans at you.\");\n        Console.WriteLine(\"\\n\\nWhat do you do?\\nA. Ask if he's alright and who he is\\nB. Try to find something tod defend yourself with, just in case...\");\n\n        if (playerInput.StartsWith(\"A\", StringComparison.CurrentCultureIgnoreCase))\n        {\n            Console.WriteLine(\"You ask if he's alright, but he doesn't respond.\\nYou ask then who he is, but he still doesn't respond.\");\n            Console.WriteLine(\"Before you even get to think, he lunges towards you in a surprise!\");\n            Console.WriteLine(\"He holds on to you and tries to bite you.\\nUnfortunately, he manages to do so and takes a chunk from your neck.\");\n            Console.WriteLine(\"As he's consuming you, you scream aloud in pain as you slowly fade away...\");\n            Console.WriteLine(\"\\n\\nGAME OVER!\\nUnfortunately, your choices got you killed.\\nPlease, restart the game and try again.\");\n            Console.WriteLine(\"\\n\\n(Press any key to exit\");\n            Console.ReadKey();\n            Environment.Exit(0);\n        }\n        else if (playerInput.StartsWith(\"B\", StringComparison.CurrentCultureIgnoreCase))\n        {\n            //Insert next class and method here...\n        }\n\n\n\n    }\n}\n}\n</code></pre>\n\n<p>My other class is Program.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace MyAdventure\n{\nclass Program\n{\n    static void Main(string[] args)\n    {\n\n        Console.WriteLine(\"You cannot feel your body. You don't know where you are.\\nThe room you're in is dark. You cannot see much.\");\n        Console.WriteLine(\"You decide to stand up, and take a look around. You see a door and a window.\\nWhich do you check out first?\");\n        Console.WriteLine(\"A. Window\\nB. Door\");\n\n        string playerInput = Console.ReadLine();\n\n        if (playerInput.StartsWith(\"A\", StringComparison.CurrentCultureIgnoreCase))\n        {\n            Window.theWindow();\n        }\n        else if (playerInput.StartsWith(\"B\", StringComparison.CurrentCultureIgnoreCase))\n        {\n            Console.Clear();\n            Console.WriteLine(\"You chose the door.\");\n            Console.WriteLine(\"\\nUnfortunately, the door is locked.\\nYou cannot leave through the door.\");\n            Console.WriteLine(\"You turn to the window.\");\n            Console.WriteLine(\"\\n(Press Enter to continue...)\");\n            Console.ReadKey();\n            Window.theWindow();\n        }\n\n        Console.ReadKey();\n\n    }\n}\n}\n</code></pre>\n\n<p>Could anyone please help? Big thanks in advance.</p>\n"},{"tags":["c#","javascript",".net","signalr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13258362,"title":"SignalR doesn't work with custom serializer","body":"<p>I'm trying to configure signalr to send JSON object with lower case members. Currently I'm configuring with a custom ContractResolver, and have put this in my startup code:</p>\n\n<pre><code>var serializer = new JsonNetSerializer(new JsonSerializerSettings\n{\n    ContractResolver = new CamelCasePropertyNamesContractResolver()\n});\nGlobalHost.DependencyResolver.Register(typeof (IJsonSerializer), () =&gt; serializer);\n</code></pre>\n\n<p>However, no javascript calls are received when it is configured like this. Any ideas what's wrong? Thanks</p>\n"},{"tags":["c#","button","if-statement","statement"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":107,"score":3,"question_id":13254942,"title":"This code changes the textbox instantly to red. I want it like, click button then red, again then green","body":"<p>This code changes the textbox instantly to red. I want it like, click button then red, again then green.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n\n    textBox1.BackColor = System.Drawing.Color.Black;\n\n    if (textBox1.BackColor.Equals(System.Drawing.Color.Black)) \n    {\n        textBox1.BackColor = System.Drawing.Color.Red;\n    }\n\n\n\n    if (textBox1.BackColor.Equals(System.Drawing.Color.Red))\n    {\n        textBox1.BackColor = System.Drawing.Color.Green;\n    }\n\n\n\n    if (textBox1.BackColor.Equals(System.Drawing.Color.Green))\n    {\n        textBox1.BackColor = System.Drawing.Color.Blue;\n    }\n\n\n\n    if (textBox1.BackColor.Equals(System.Drawing.Color.Blue))\n    {\n        textBox1.BackColor = System.Drawing.Color.Red;\n    }\n}\n</code></pre>\n"},{"tags":["c#","command-prompt"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13259373,"title":"Want to execute a command in command prompt window","body":"<p>In my console application, I need to execute a series of commands:  </p>\n\n<pre><code>D:\ncd d:\\datafeeds\ngrp -encrypt -myfile.xls\n</code></pre>\n\n<p>This set of commands actually encrypt a file using a tool (gpg).<br>\nHow will I do it ?</p>\n"},{"tags":["c#","events","notifyicon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13258637,"title":"NotifyIcon DoubleClick events aren't fired","body":"<p>Currently working on notifyIcon, I followed this tutorial in order to set Minimize to Tray option.\n<a href=\"http://www.codeproject.com/Articles/27599/Minimize-window-to-system-tray\" rel=\"nofollow\">http://www.codeproject.com/Articles/27599/Minimize-window-to-system-tray</a></p>\n\n<p>So when the user click on Window minimize button, it makes the tray icon appear.</p>\n\n<p>This tutorial work fine, when I have only one form. When I instantiate a new form  (different from the main one) that contains a timer in it, the notifyIcon DoubleClick event isn't fired, so the main form can't pop-up.</p>\n\n<p>Do anyone the reason of this behaviour? Is it possible to see events in real-time without a adding a breakpoint?</p>\n\n<p>EDIT:</p>\n\n<p>it seems that it's not a timer problem. In my second form, I'm using AttachThreadInput (http://msdn.microsoft.com/en-us/library/windows/desktop/ms681956(v=vs.85).aspx) function, and when I comment it, the doubleClick event is trigerred. So I think the problem is because I attach another thread to the second thread form. But I don't understand why it blocks the event in the main form...</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13259426,"title":"how to get values in GridView using C#","body":"<p>How can I access a value in a GridView, in this case i have a <code>target_date</code> in there and would like to get that value and convert it to string. Here is what I have:</p>\n\n<pre><code>foreach (GridViewRow gr in GridView1.Rows)\n{\n   CheckBox cb = (CheckBox)gr.FindControl(\"chkItem\");\n   if (cb.Checked)\n   {\n      string strTargetDate = \"???\"; // TODO\n   }\n}\n</code></pre>\n"},{"tags":["c#","asp.net","asp.net-mvc-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13253964,"title":"DisplayFormat ApplyFormatInEditMode","body":"<p>I use MVC 3 in C#, I have a class with this Attribute  </p>\n\n<pre><code>[DisplayFormat(DataFormatString = \"{0:dd MMM yyyy}\", ApplyFormatInEditMode = true)]\n</code></pre>\n\n<p>I would like to enforce Validation when a User is in <code>EDIT MODE</code></p>\n\n<p>Data in database is stored with type <code>datetime</code> formatted like this</p>\n\n<pre><code>  6/15/2009 1:45:30 PM\n</code></pre>\n\n<p>I receive this error\n    Error String is not in correct format</p>\n\n<p>I beleive the problem is in</p>\n\n<p>DataFormatString = \"{0:dd MMM yyyy}\"</p>\n\n<p>any idea how to fix it?</p>\n"},{"tags":["c#","winforms","data-binding","datetime","nullable"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2709,"score":5,"question_id":1640306,"title":"Binding to a Nullable<DateTime> control property","body":"<p>We have a custom control that has a \"Value\" property of type System.Nullable (aka System.DateTime?).  We have an object with a \"Received\" property of the same type.  When we try to bind the control to the object, the following <em>InvalidCastException</em> is thrown:</p>\n\n<p><strong>Invalid cast from 'System.DateTime' to 'System.Nullable`1[[System.DateTime, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]'.</strong></p>\n\n<p>Here is what we're doing:</p>\n\n<p>Object property:</p>\n\n<pre><code>private System.DateTime? _dateTimeReceived;\npublic System.DateTime? DateTimeReceived\n{\n    get\n    {\n        return this._dateTimeReceived;\n    }\n    set\n    {\n        this._dateTimeReceived = value;\n        this.OnChanged(\"DateTimeReceived\", value); //Implements INotifyPropertyChanged and fires PropertyChanged event\n    }\n}\n</code></pre>\n\n<p>Control property:</p>\n\n<pre><code>private System.DateTime? _value;\n[System.ComponentModel.Category(\"Behavior\")]\n[System.ComponentModel.Description(\"The current date value for this control\")]\npublic new System.DateTime? Value\n{\n    get\n    {\n        return this._value;\n    }\n\n    set\n    {\n        this._value = value;\n    }\n}\n</code></pre>\n\n<p>In the application, here is where the exception is thrown:</p>\n\n<pre><code>this.dateReceived.DataBindings.Add(\"Value\", this._object, \"DateTimeReceived\");\n</code></pre>\n\n<p>As you can see, the object's property (this._object.DateTimeReceived) is a System.DateTime? type and the control's property (this.dateReceived.Value) is a System.DateTime? type.</p>\n\n<p>Why would this cause an <em>InvalidCastException</em>?  And how can we correct this so that it binds correctly?</p>\n\n<p><strong>Update 2009-10-29 14:26 CDT:</strong></p>\n\n<p>Here is the stack trace:</p>\n\n<blockquote>\n  <p>at System.Convert.DefaultToType(IConvertible value, Type targetType,\n  IFormatProvider provider)<br> at\n  System.DateTime.System.IConvertible.ToType(Type type, IFormatProvider\n  provider) <br> at System.Convert.ChangeType(Object value, Type\n  conversionType, IFormatProvider provider) <br> at\n  System.Windows.Forms.Binding.FormatObject(Object value)<br> at\n  System.Windows.Forms.Binding.PushData(Boolean force) <br> at\n  System.Windows.Forms.Binding.UpdateIsBinding() <br> at\n  System.Windows.Forms.Binding.CheckBinding() <br> at\n  System.Windows.Forms.Binding.SetListManager(BindingManagerBase\n  bindingManagerBase) <br> at\n  System.Windows.Forms.ListManagerBindingsCollection.AddCore(Binding\n  dataBinding) <br> at\n  System.Windows.Forms.BindingsCollection.Add(Binding binding) <br> at\n  System.Windows.Forms.BindingContext.UpdateBinding(BindingContext\n  newBindingContext, Binding binding)<br> at\n  System.Windows.Forms.Binding.SetBindableComponent(IBindableComponent\n  value)<br> at\n  System.Windows.Forms.ControlBindingsCollection.AddCore(Binding\n  dataBinding) <br> at\n  System.Windows.Forms.BindingsCollection.Add(Binding binding) <br> at\n  System.Windows.Forms.ControlBindingsCollection.Add(String\n  propertyName, Object dataSource, String dataMember, Boolean\n  formattingEnabled, DataSourceUpdateMode updateMode, Object nullValue,\n  String formatString, IFormatProvider formatInfo) <br> at\n  System.Windows.Forms.ControlBindingsCollection.Add(String\n  propertyName, Object dataSource, String dataMember)<br></p>\n</blockquote>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":57,"score":1,"question_id":13258986,"title":"Combo Box selected value validating","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13296801/how-to-validate-combo-box-values-in-c-sharp\">How to validate combo box values in c#</a>  </p>\n</blockquote>\n\n\n\n<p>I have 6 combo boxes in c# form that all fill from database from same column.\ni-e for making student result combo boxes fill subject names.\nnow I want is how to delete Subject name from 2nd combo box if the Subject is already selected in the previous combo box.</p>\n"},{"tags":["c#","asp.net","entity-framework","json.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":775,"score":2,"question_id":7983428,"title":"json.net; serialize entity framework object (circular reference error)","body":"<p>I have an entity framework entity that i want to serialize as a json object. I looked around and found out that json.net (http://james.newtonking.com/projects/json-net.aspx) should be able to serialize objects with circular references \"out of the box\". So i tried using</p>\n\n<pre><code>string json = JsonConvert.SerializeObject(/* my ef entity */);\n</code></pre>\n\n<p>But im still getting the same error. The problem might be that i need to use <code>ReferenceLoopHandling.Ignore</code> and a <code>ContractResolver</code>, but im not sure how to use them. Any help is much appreciated! Thanks</p>\n"},{"tags":["c#","entity-framework","entity-framework-4.1","repository-pattern"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13259299,"title":"EF DbContext.Set<T> filtered record only ... doesn't work","body":"<p>While developing a data access solution that utilizes generic repository and unit of work pattern over entity framework 4.2. I am seeing some abnormal behavior. To make my repositories generic, I have utilized the Set method of DbContext like:</p>\n\n<pre><code>public class MyGenericRepository&lt;T&gt; \n{\n     protected readonly IDbContext context;\n     public virtual IEnumerable&lt;T&gt; FindBy(Func&lt;T, bool&gt; predicate)\n     {\n        return context.GetDbSet&lt;T&gt;().Where(predicate).First();\n     }\n}\n</code></pre>\n\n<p>where IDbContext is like: </p>\n\n<pre><code>public interface IDbContext\n{\n    void Commit();\n    void Attach&lt;T&gt;(T obj) where T : class;\n    void Add&lt;T&gt;(T obj) where T : class;\n    DbSet&lt;T&gt; GetDbSet&lt;T&gt;() where T : class;\n    bool Remove&lt;T&gt;(T item) where T : class;\n}\n</code></pre>\n\n<p>The DbContext class implements the IDbContext as: </p>\n\n<pre><code>public partial class MyEntities : IDbContext\n{\n\n    public DbSet&lt;T&gt; GetDbSet&lt;T&gt;() where T : class\n    {\n        return this.Set&lt;T&gt;();\n    }\n}  \n</code></pre>\n\n<p>When I do repository.FindBy(c => c.CompanyId == 45), Sql Profiler shows the query to <strong>NOT</strong> contain any filter (company_id = 45). The query does a Select *.</p>\n\n<p>Expecting a filter to be present, i started researching and came across this,</p>\n\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/7d6705ac-f875-4c89-960b-842be6f6e5ed\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/7d6705ac-f875-4c89-960b-842be6f6e5ed</a>\nand \n<a href=\"http://stackoverflow.com/questions/9362145/ef-dbcontext-sett-filtered-record-only\">EF DbContext.Set&lt;T&gt; filtered record only</a></p>\n\n<p>These threads confirms my thought process but the results are different. Any solutions?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","controller","joystick","emulate"],"answer_count":0,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12756523,"title":"Simulate A Gamepad Input With C#","body":"<p>I'll simplify the situation to get rid of confusion.</p>\n\n<p>I want to make a program that only has 1 button in the program. Upon clicking the button, the program will simulate a generic gamepad button. I'm sure when the program starts, it will have to somehow emulate a gamepad. The gamepad that is being emulated should be visible in the Control Panel. (<code>joy.cpl</code> to be more specific)</p>\n\n<p>I have to do this without making a driver or relying on a 3rd party library/API- I know it can be done this way since I've seen some programs that actually do this already but my program will have a completely different use than those. I cannot find any good information on where to start, so pushing me in the right direction would be nice or showing me some code in <code>C#</code> would be cool, too!</p>\n\n<p><strong>Thanks, guys!</strong></p>\n"},{"tags":["c#","winrt","c#-5.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13234072,"title":"IAsyncOperation in delegate, is it possible?","body":"<pre><code>public delegate string IAsyncOperation&lt;IEnumerable&lt;string&gt;&gt; ThisReceiveStringHandler();\n...\npublic event ThisReceiveStringHandler ThisReceiveString;\n</code></pre>\n\n<p>I'm trying do a async event, but but the above code don't work. \nCould anyone tell me if there is any possibility of creating asynchronous events? Or if there is a more elegant approach?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","java","c++","c"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":2,"view_count":155,"score":1,"question_id":13259169,"title":"Should break statements be avoided?","body":"<p>Should a developer avoid using <code>break</code> statements as much as possible in Java, C#, and C++, C. I know using <code>goto</code> statements are deemed as bad practice but what about <code>break</code> statements to exit a loop ahead of time</p>\n"},{"tags":["c#","permissions","network-share"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2844,"score":0,"question_id":1136502,"title":"Access denied running C# program using reference DLL from network share","body":"<p>I am developing two projects which are both managed by ClearCase, which means that for Windows, it looks like they are located on a network share.</p>\n\n<p>The first project is a DLL written using VS 2003 in managed C++ and is intended to provide a managed interface for some legacy DLLs written in VS2003 C++.</p>\n\n<p>The second project is written in C# (.NET 3.5, VS2008) and includes the DLL generated by the first project as a reference to make use of the legacy DLLs via the wrapper.</p>\n\n<p>Now when I try to start the C# project, I get the following error message:</p>\n\n<blockquote>\n  <p><strong>FileLoadException was unhandled</strong></p>\n  \n  <p>Could not load file or assembly\n  '(my managed c++ wrapper), Version=(version\n  number), Culture=neutral,\n  PublicKeyToken=null' or one of its\n  dependencies. Access is denied.</p>\n</blockquote>\n\n<p>Looking at the details, this is a System.Io.FileLoadException containing an inner System.UnauthorizedAccessException (\"Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))\"</p>\n\n<p>Now when I copy the C# project to the local hard drive, everything works fine, even if the managed C++ project stays on the network drive.</p>\n\n<p>I've had permission problems with network drives before but these vanished when upgrading to .NET 3.5 SP1. I also tried changing the Permission Set for the All_Code code group to \"Full Trust\" for .Net Configuration 1.1. and 2.0, as suggested on the internet, but this did not help either. Btw, I also checked if the DLL is readonly, but it isn't.</p>\n\n<p>Thanks in advance for any help!</p>\n\n<p>Update: I also tried signing both assemblies with a Strong Name and giving these keys full trust but to no avail. There must be some other reason but I am out of ideas.</p>\n"},{"tags":["c#","image","api","internationalization","weather"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258246,"title":"Is there a way to download Met Office rainfall radar images?","body":"<p>I am developing a weather radar app in c#. It currently works only in the United States, because I have not found a way to download any international radar. For the United States, there is an easy way to access radar from the national weather service, they keep all the radar images <a href=\"http://radar.weather.gov/ridge/RadarImg\" rel=\"nofollow\">here</a> and all the maps and overlays <a href=\"http://radar.weather.gov/ridge/Overlays\" rel=\"nofollow\">here</a> and documentation <a href=\"http://www.srh.noaa.gov/jetstream/doppler/ridge_download.htm\" rel=\"nofollow\">here</a>. Is there any official radar feed for Met Office, or any other way to access the radar images? I have poked around on their <a href=\"http://www.metoffice.gov.uk/\" rel=\"nofollow\">website</a> with no luck.</p>\n"},{"tags":["c#","linq","entity-framework","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13234447,"title":"Datetime check in Linq where statement","body":"<p>Please see the code below:</p>\n\n<pre><code>var pcPageList = db.PcPages\n        .Where(m =&gt; \n            m.Quarter == exactQuarter &amp;&amp; \n            m.Url == pageUrl &amp;&amp; \n            m.UpdatedOn.ToDateTime().Date.ToString(\"dd/MMM\").ToLower() == \"02/nov\")\n        .OrderBy(m =&gt; m.UpdatedOn)\n        .FirstOrDefault();\n</code></pre>\n\n<p>When I run this above, the application throws error says: \"ToDateTime\" is not implemented yet. Anyone please can advice ?</p>\n"},{"tags":["c#","algorithm","artificial-intelligence","markov-chains"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13216357,"title":"Is it possible to guide a Markov chain toward certain keywords?","body":"<p>I'm writing a chat bot for a software engineering course in C#.</p>\n\n<p>I'm using Markov chains to generate text, using Wikipedia articles as the corpus. I want it to respond to user input in an (at least slightly) intelligent way, based on their input, but I'm not sure how to do it.</p>\n\n<p>My current thinking is that I'd try and extract keywords from the user's input, then use those to guide the sentence generation. But because of the Markov property, the keywords would have to be the first words in the sentence, which might look silly. As well, for an <code>n</code> order chain, I'd have to extract <em>exactly</em> <code>n</code> keywords from the user every time.</p>\n\n<p>The data for the generator is a dictionary, where the keys are lists of words, and the values are lists of words combined with a weight depending on how often the word appears after the words in the key. So like: </p>\n\n<pre>{[word<sub>1</sub>, word<sub>2</sub>, ..., word<sub>n</sub>]: [(word, weight), (word, weight), ...]}</pre>\n\n<p>It works in a command-line test program, but I'm just providing an <code>n</code> word seed for each bit of text it generates.</p>\n\n<p>I'm hoping there's some way I can make the chain prefer words which are nearby words that the user used, rather than seeding it with the first/last <code>n</code> words in the input, or <code>n</code> keywords, or whatever. Is there a way to do that?</p>\n"},{"tags":["c#","linux","mono","daemon","mono-service"],"answer_count":7,"favorite_count":14,"up_vote_count":35,"down_vote_count":0,"view_count":8752,"score":35,"question_id":186493,"title":"How do I code a Mono Daemon","body":"<p>I'm trying to write a Mono C# daemon for linux.</p>\n\n<p>I'd like to do a starts and stops of it when its done processing instead of just killing the process.</p>\n\n<p>Does anyone have any examples of this?</p>\n\n<p>Edit: I figured out how to use start-stop-daemon --background in debian, so I think I'll just use that for now.</p>\n\n<p>Edit: I'm implementing this in java as well and they have this nice addShutdownHook that catches terminating the app. I need to spend a little more time sorting out the dependencies for mono service, or find a way to catch app termination. </p>\n\n<p>There is the SessionEnd event, but thats only available for services and not console apps</p>\n\n<p><strong>Answer:</strong>\n<a href=\"http://stackoverflow.com/questions/351971/using-mono-service-to-wrap-a-windows-service-on-linux\">using mono-service to wrap a windows service on linux</a></p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13259118,"title":"Getting type name of boxed object c#","body":"<p>how can I get the type name (in string) of instance boxed in object.\nI can't use is or as operators.\nFor example:</p>\n\n<pre><code>    object a= student1; //student1 is instance of Student class\n</code></pre>\n\n<p>Next I will get it object in another library, where no Student class inside and no reference.\nAnd I need something like this:</p>\n\n<pre><code>string typeName=GetTypeNameInsideObject(obj1)\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net","ajaxcontroltoolkit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13259195,"title":"Two Modal Popups in one ASPX page","body":"<p>I'm having an issue having multiple popups on one page.  Note that I am calling them one at a time and not at the same time depending on the user's behavior.</p>\n\n<pre><code>&lt;asp:ModalPopupExtender \n    ID=\"modalPopupQuestion\" \n    runat=\"server\"\n    DropShadow=\"true\"\n    TargetControlID=\"hfQuestion\"\n    PopupControlID=\"pnlQuestion\" \n    BackgroundCssClass=\"modalBackground\" &gt;\n        &lt;Animations&gt;\n            &lt;OnShown&gt;&lt;Fadein Duration=\"0.50\" /&gt;&lt;/OnShown&gt;\n        &lt;/Animations&gt;\n&lt;/asp:ModalPopupExtender&gt;\n\n&lt;asp:HiddenField ID=\"hfQuestion\" runat=\"server\"&gt;\n&lt;/asp:HiddenField&gt;\n\n&lt;asp:Panel ID=\"pnlQuestion\" runat=\"server\" CssClass=\"panelAppeal\"&gt;\n              &lt;div&gt;\n                    &lt;asp:Label ID=\"lblQuestionOne\" runat=\"server\" Text=\"Question One\" \n                        Font-Bold=\"True\" ForeColor=\"Black\"&gt;&lt;/asp:Label&gt;\n                        &amp;nbsp;\n                    &lt;asp:RequiredFieldValidator ID=\"rvQuestionOne\" runat=\"server\" \n                        ErrorMessage=\"Please select an option.\" \n                        ControlToValidate=\"rbQuestionOneAnswers\" ForeColor=\"#CC0000\"&gt;*&lt;/asp:RequiredFieldValidator&gt;\n                    &lt;asp:ValidatorCalloutExtender ID=\"vceQuestionOne\" \n                        runat=\"server\" Enabled=\"True\" TargetControlID=\"rvQuestionOne\"&gt;\n                    &lt;/asp:ValidatorCalloutExtender&gt;\n                    &lt;br /&gt;\n                    &lt;br /&gt;\n                    &lt;asp:RadioButtonList ID=\"rbQuestionOneAnswers\" runat=\"server\" ForeColor=\"Black\"&gt;\n                        &lt;asp:ListItem&gt;Answer 1&lt;/asp:ListItem&gt;\n                        &lt;asp:ListItem&gt;Answer 2&lt;/asp:ListItem&gt;\n                        &lt;asp:ListItem&gt;Answer 3&lt;/asp:ListItem&gt;\n                    &lt;/asp:RadioButtonList&gt;\n                &lt;/div&gt;\n   &lt;div class=\"messageFooter\"&gt;\n        &lt;asp:LinkButton ID=\"btnNext\" runat=\"server\" Text=\"Next\" \n                CausesValidation=\"true\" onclick=\"btnNext_Click\" /&gt;\n                        &amp;nbsp;\n        &lt;asp:LinkButton ID=\"btnCancel\" runat=\"server\" Text=\"Cancel\" \n                CausesValidation=\"false\" onclick=\"btnCancel_Click\" /&gt;\n   &lt;/div&gt;\n\n&lt;/asp:Panel&gt;\n\n&lt;asp:Panel ID=\"pnlQuestionTwoContainer\" runat=\"server\" Visible=\"False\"&gt;\n&lt;!-- SECOND MODAL POPUP WITH QUESTIONS --&gt;\n    &lt;asp:ModalPopupExtender \n        ID=\"mpopupQuestionTwo\" \n        runat=\"server\"\n        DropShadow=\"true\"\n        TargetControlID=\"hfQuestionTwo\"\n        PopupControlID=\"pnlQuestionTwo\"\n        BehaviorID=\"mpopupQuestionTwo\"\n        BackgroundCssClass=\"modalBackground\" &gt;\n            &lt;Animations&gt;\n                &lt;OnShown&gt;&lt;Fadein Duration=\"0.50\" /&gt;&lt;/OnShown&gt;\n            &lt;/Animations&gt;\n\n    &lt;/asp:ModalPopupExtender&gt;\n\n    &lt;asp:HiddenField ID=\"hfQuestionTwo\" runat=\"server\" /&gt;\n\n    &lt;asp:Panel ID=\"pnlQuestionTwo\" runat=\"server\" CssClass=\"panelAppeal\"&gt;\n\n            &lt;div&gt;\n                &lt;div&gt;\n                    &lt;asp:Label ID=\"lblQuestionTwo\" runat=\"server\" Text=\"Question Two\" \n                        Font-Bold=\"True\" ForeColor=\"Black\"&gt;&lt;/asp:Label&gt;\n                        &amp;nbsp;\n                    &lt;asp:RequiredFieldValidator ID=\"rvQuestionTwo\" runat=\"server\" \n                        ErrorMessage=\"Please select an option.\" \n                        ControlToValidate=\"rbQuestionTwoAnswers\" ForeColor=\"#CC0000\"&gt;*&lt;/asp:RequiredFieldValidator&gt;\n                    &lt;asp:ValidatorCalloutExtender ID=\"vceQuestionTwo\" \n                        runat=\"server\" Enabled=\"True\" TargetControlID=\"rvQuestionTwo\"&gt;\n                    &lt;/asp:ValidatorCalloutExtender&gt;\n                    &lt;br /&gt;\n                    &lt;br /&gt;\n                    &lt;asp:RadioButtonList ID=\"rbQuestionTwoAnswers\" runat=\"server\" ForeColor=\"Black\"&gt;\n                        &lt;asp:ListItem&gt;Yes&lt;/asp:ListItem&gt;\n                        &lt;asp:ListItem&gt;No&lt;/asp:ListItem&gt;\n                    &lt;/asp:RadioButtonList&gt;\n                &lt;/div&gt;\n                &lt;div class=\"messageFooter\"&gt;\n                    &lt;asp:LinkButton ID=\"btnNextTwo\" runat=\"server\" Text=\"Next\" \n                        CausesValidation=\"true\" onclick=\"btnNextTwo_Click\"\n                            /&gt;\n                        &amp;nbsp;\n                    &lt;asp:LinkButton ID=\"btnCancelTwo\" runat=\"server\" Text=\"Cancel\" \n                        CausesValidation=\"false\" onclick=\"btnCancelTwo_Click\" \n                            /&gt;\n                &lt;/div&gt;\n            &lt;/div&gt; \n\n    &lt;/asp:Panel&gt;\n&lt;/asp:Panel&gt;\n</code></pre>\n\n<p>I tried the suggestion on this other Stackoverflow question <a href=\"http://stackoverflow.com/questions/9255715/adding-two-ajax-modal-popup-in-a-single-page\">Adding two ajax modal popup in a single page</a> which is to place the second ModalPopup inside a Panel that is set to visibile=false and set it to true in the code behind when calling the second popup but that didn't work.</p>\n\n<pre><code> protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n            // Show first pop up\n            pnlQuestion.Style[\"display\"] = \"block\";\n            modalPopupQuestion.Show();\n        }\n        else\n        {\n        }\n    }\n\n    protected void btnCancel_Click(object sender, EventArgs e)\n    {\n        // Hide first Popup\n        modalPopupQuestion.Hide();\n        // Solve flicker problems of popup\n\n        // Redirect to Home page\n        Response.Redirect(\"StuHome.aspx\");\n    }\n\n    protected void btnNext_Click(object sender, EventArgs e)\n    {\n        modalPopupQuestion.Hide();\n\n        pnlQuestionTwoContainer.Visible = true;\n\n        if (rbQuestionOneAnswers.Items[0].Selected)\n        {\n            // Redirect to Informal Appeal\n            Response.Redirect(\"InformalOne.aspx\");\n        }\n        else if (rbQuestionOneAnswers.Items[1].Selected || rbQuestionOneAnswers.Items[2].Selected)\n        {\n            mpopupQuestionTwo.Show();\n        }\n\n    }\n</code></pre>\n"},{"tags":["c#","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13255882,"title":"Pass data by CommandParameter","body":"<p>I am trying to pass <strong>UserName</strong> by <code>CommandParameter</code>.</p>\n\n<pre><code>&lt;GridViewColumn   Width=\"Auto\" Header=\"UserName\" &gt;\n   &lt;GridViewColumn.CellTemplate&gt;\n       &lt;DataTemplate&gt;\n          &lt;Button Click=\"Button_Click\" Content=\"...\" CommandParameter=\"{Binding Path=UserName}\"&gt;&lt;/Button&gt;                                                                                                         &lt;/DataTemplate&gt;\n    &lt;/GridViewColumn.CellTemplate&gt;\n&lt;/GridViewColumn&gt;\n</code></pre>\n\n<p>But here I am not sure what do I have to use to catch it...</p>\n\n<pre><code>private void Button_Click(object sender, RoutedEventArgs e)\n{\n    // How to get UserName  here?\n}\n</code></pre>\n\n<p>Any clue?</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13111010,"title":"Why in ZedGraph the Y axis is very small ? the height of the bars are not as it suppose to be","body":"<p>I have this ZedGraph control code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing ZedGraph;\nusing Extracting_Frames;\n\nnamespace Lightnings_Extractor\n{\n    public partial class Histogram_Graphs : Form\n    {\n\n        public long[] histogram;\n\n        public Histogram_Graphs()\n        {\n            InitializeComponent();\n\n            histogram = Form1.GetHistogramValue;\n            this.DoubleBuffered = true;\n            CreateGraph_GradientByZBars(zedGraphControl1);\n\n        }\n\n        private void Histogram_Graphs_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        private void CreateGraph_GradientByZBars(ZedGraphControl z1)\n        {\n            GraphPane myPane = z1.GraphPane;\n            myPane.Title.Text = \"Demonstration of Multi-Colored Bars with a Single BarItem\";\n            myPane.XAxis.Title.Text = \"Bar Number\";\n            myPane.YAxis.Title.Text = \"Value\";\n\n            PointPairList list = new PointPairList();\n            Random rand = new Random();\n\n            for (int i = 0; i &lt; histogram.Length; i++)\n            {\n                double x = (double)i + 1;\n                //double y = (double)i + 1;//rand.NextDouble() * 1000;\n                double z = i / 4.0;\n                list.Add(x, histogram[i], z);\n            }\n\n            BarItem myCurve = myPane.AddBar(\"Multi-Colored Bars\", list, Color.Blue);\n            Color[] colors = { Color.Red, Color.Yellow, Color.Green, Color.Blue, Color.Purple };\n            myCurve.Bar.Fill = new Fill(colors);\n            myCurve.Bar.Fill.Type = FillType.GradientByZ;\n\n            myCurve.Bar.Fill.RangeMin = 0;\n            myCurve.Bar.Fill.RangeMax = 4;\n\n            myPane.Chart.Fill = new Fill(Color.White, Color.FromArgb(220, 220, 255), 45);\n            myPane.Fill = new Fill(Color.White, Color.FromArgb(255, 255, 225), 45);\n            // Tell ZedGraph to calculate the axis ranges\n            z1.AxisChange();\n        } \n    }\n}\n</code></pre>\n\n<p>The problem is in the loop:</p>\n\n<pre><code>for (int i = 0; i &lt; histogram.Length; i++)\n                {\n                    double x = (double)i + 1;\n                    //double y = (double)i + 1;//rand.NextDouble() * 1000;\n                    double z = i / 4.0;\n                    list.Add(x, histogram[i], z);\n                }\n</code></pre>\n\n<p>Befote Y was random. Now i want to use the values in the histogram List.\nSo for example in index[0] there is a number: 34118 then in index<a href=\"http://i.stack.imgur.com/L54q5.jpg\" rel=\"nofollow\">1</a> 1521 index[2] 522\nThere are 256 indexs in the List.</p>\n\n<p>When i see the Graph is see the bard height very very short. </p>\n\n<p>In the beginning of the graph i see one line very high but all the next lines are very short.\nAnd on the Y axis i see on the side numbers start from 0 to 40 and on the x axis i see numbers from 0 to 300.</p>\n\n<p>On the axis Y i should see numbers from 0 to the highest value in the histogram i guess and on the axis X i should see from 0 to 256.</p>\n\n<p>Big mess here.</p>\n\n<p>How should i fix it ?</p>\n\n<p>Thanks.</p>\n\n<p><img src=\"http://i.stack.imgur.com/L54q5.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","c#-4.0","razor","telerik","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13081158,"title":"How to trigger the button by pressing enter key on a input textbox in the cshtml page","body":"<p>My Code:</p>\n\n<p>Textbox field:</p>\n\n<pre><code>   &lt;input id=\"LastName\" type=\"text\" filtercolumn=\"LastName\" class=\"filterCtrl\" style=\"width:135px; height:15px\"/&gt;\n</code></pre>\n\n<p>Want to trigger the following button when pressing enter key on the above text box:</p>\n\n<pre><code>&lt;input type=\"button\" class=\"button w100\" onclick=\"javascript:btnAdvanceSearchClick();\" value=\"Search\" /&gt;\n</code></pre>\n\n<p>Javascript function for ajax requesting the grid when button is clicked:</p>\n\n<pre><code>function btnAdvanceSearchClick() {\n        _loadData = true;\n        var $grid = $('#AdvanceSearchGrid').data('tGrid'); \n        $grid.ajaxRequest();\n        $('div#divSearchGrid').show();\n}\n</code></pre>\n\n<p>My Search ActionControl method is called from the following code:</p>\n\n<pre><code>  @(Html.Telerik().Grid&lt;Web.Mvc.Models.Search.SearchModel&gt;()\n    .Name(\"AdvanceSearchGrid\")\n    .DataBinding(db =&gt; db.Ajax()\n        .Select(\"SearchUserByFilter\", \"Search\", new { _loadData, _filter }).Enabled(true)\n                )\n</code></pre>\n\n<p>How to hit the button when the user clicked enterkey in the textbox. Please Help. Thanks</p>\n"},{"tags":["c#","asp.net-mvc","mvc","html-helper","application-start"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13258944,"title":"Access HtmlHelper right after it is created, and before the view","body":"<p>I know that i from Application_Start can ActionFilterAttribute add a custom global filter and manipulate the ModelState and what not.</p>\n\n<p>Is there a similar way, to access the @Html (HtmlHelper) Before it get's send to the view?</p>\n\n<p>The reason for this is that i want to edit (or remove and recreate) the UnobtrosiveValidationAttributes. And if i try to do that in the View like this: <code>@Html.GetUnobtrusiveValidationAttributes(\"PhoneNumber\").Clear();</code> Nothing happens, but i'm thinking it might would work if i got to it earlier?</p>\n\n<p>(If you are wondering why: i need to translate the ErrorMessages inside)</p>\n"},{"tags":["c#","razor","telerik","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12999468,"title":"Calendar is not displaying","body":"<p>My Code:</p>\n\n<pre><code>@(Html.Telerik().DatePicker()\n    .Name(\"DatePickerDOB\")\n    .HtmlAttributes(new { style = \"width: 140px; \" })\n)\n</code></pre>\n\n<p>Calendar is not displaying and only Textbox like field is displaying. When I am clicking on that, Calendar is not displaying. How to make display the calendar. Thanks.</p>\n\n<p><strong>EDIT</strong>: Full code</p>\n\n<pre><code>@using Telerik.Web.Mvc.UI;\n@using Telerik.Web.UI;\n\n@{\n    ViewBag.Title = \"Home Page\";\n}\n&lt;script type=\"text/javascript\" src=\"~/Scripts/jquery-1.8.0.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"~/Scripts/jquery-ui-1.8.11.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"~/Scripts/jquery-ui-1.8.20.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n    console.log($)\n&lt;/script&gt;\n@(Html.Telerik().DatePicker()\n    .Name(\"DatePickerDOB\")\n    .HtmlAttributes(new { style = \"width: 140px; \" })\n)\n\n@section featured {\n    &lt;section class=\"featured\"&gt;\n        &lt;div class=\"content-wrapper\"&gt;\n            &lt;hgroup class=\"title\"&gt;\n                &lt;h1&gt;@ViewBag.Title.&lt;/h1&gt;\n                &lt;h2&gt;@ViewBag.Message&lt;/h2&gt;\n            &lt;/hgroup&gt;\n            &lt;p&gt;\n                To learn more about ASP.NET MVC visit &lt;a href=\"http://asp.net/mvc\" title=\"ASP.NET MVC Website\"&gt;\n                    http://asp.net/mvc&lt;/a&gt;. The page features &lt;mark&gt;videos, tutorials,\n                        and samples&lt;/mark&gt; to help you get the most from ASP.NET MVC. If you have\n                any questions about ASP.NET MVC visit &lt;a href=\"http://forums.asp.net/1146.aspx/1?MVC\"\n                    title=\"ASP.NET MVC Forum\"&gt;our forums&lt;/a&gt;.\n            &lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/section&gt;\n}\n&lt;h3&gt;We suggest the following:&lt;/h3&gt;\n&lt;ol class=\"round\"&gt;\n    &lt;li class=\"one\"&gt;\n        &lt;h5&gt;Getting Started&lt;/h5&gt;\n        ASP.NET MVC gives you a powerful, patterns-based way to build dynamic websites that\n        enables a clean separation of concerns and that gives you full control over markup\n        for enjoyable, agile development. ASP.NET MVC includes many features that enable\n        fast, TDD-friendly development for creating sophisticated applications that use\n        the latest web standards. &lt;a href=\"http://go.microsoft.com/fwlink/?LinkId=245151\"&gt;Learn\n            more&lt;/a&gt;&lt;/li&gt;\n    &lt;li class=\"two\"&gt;\n        &lt;h5&gt;Add NuGet packages and jump start your coding&lt;/h5&gt;\n        NuGet makes it easy to install and update free libraries and tools. &lt;a href=\"http://go.microsoft.com/fwlink/?LinkId=245153\"&gt;\n            Learn more&lt;/a&gt;&lt;/li&gt;\n    &lt;li class=\"three\"&gt;\n        &lt;h5&gt;Find Web Hosting&lt;/h5&gt;\n        You can easily find a web hosting company that offers the right mix of features\n        and price for your applications. &lt;a href=\"http://go.microsoft.com/fwlink/?LinkId=245157\"&gt;Learn\n            more&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n</code></pre>\n"},{"tags":["c#","json","telerik","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13062397,"title":"Not able to assign the Model to the Cache","body":"<p>My Code:</p>\n\n<pre><code>public class MyCustomGridActionResultFactory : IGridActionResultFactory\n{\n    public System.Web.Mvc.ActionResult Create(object model)\n    {\n        ResultCache.AdvanceSearchGridResult = model as List&lt;Models.Search.SearchGridModel&gt;;\n\n        //return a custom JSON result which have json serializer set to int.MaxValue\n        return new CustomJsonResult\n        {\n            Data = model\n        };\n    }\n}\n</code></pre>\n\n<p>Result Cache code:</p>\n\n<pre><code>public static class ResultCache\n{\n    public static List&lt;Models.Search.SearchGridModel&gt; AdvanceSearchGridResult\n    {\n        get { return System.Web.HttpContext.Current.Session[\"AdvanceSearchGridResult\"] as List&lt;Models.Search.SearchGridModel&gt;; }\n        set { System.Web.HttpContext.Current.Session[\"AdvanceSearchGridResult\"] = value; }\n    }\n}\n</code></pre>\n\n<p>**</p>\n\n<blockquote>\n  <p>model as <code>List&lt;Models.Search.SearchGridModel&gt;</code> returns NULL value</p>\n</blockquote>\n\n<p><strong>NOTE</strong>:</p>\n\n<p><code>ResultCache.AdvanceSearchGridResult = model;</code> gives error message as \"cannot convert from object to list\"</p>\n\n<p>**. How to solve this. Thanks.</p>\n"},{"tags":["c#","asp.net","string","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12968310,"title":"Error Message as \"String was not recognized as a valid DateTime.\"","body":"<p>My Code:</p>\n\n<pre><code>DateTime? birthDate = DateTime.Parse(filterDictionary.ContainsKey(\"DOB\") ? filterDictionary[\"DOB\"] : string.Empty);\n</code></pre>\n\n<p>I am getting Error Message as \"String was not recognized as a valid DateTime.\" How to solve this issue. Thanks.</p>\n"},{"tags":["c#","excel","razor","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13012119,"title":"\"Do you want to Open or save\" not displaying","body":"<p>My Code:</p>\n\n<pre><code>    [AcceptVerbs(HttpVerbs.Get)]\n    public ActionResult Export()\n    {\n        DataTable table = ListToDataTable();\n\n        var rows = table.AsEnumerable().AsQueryable() as IEnumerable&lt;DataRow&gt;;\n        var output = CreateXlsStream(rows);\n        return File(output, \"application/vnd.ms-excel\", \"Export.xls\");\n    }\n</code></pre>\n\n<p>\"Do you want to Open or save\" not displaying. I want to display \"Do you want to Open or save\" by default after executing this \"return File(output, \"application/vnd.ms-excel\", \"Export.xls\");' line.Thanks.</p>\n"},{"tags":["c#","dynamic","asp.net-mvc-4","ienumerable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13174827,"title":"To convert IEnumerable<dynamic> to IEnumerable<DataRow>","body":"<p>My Code:</p>\n\n<p>I converted datatable to dynamic rows using IEnumerable<code>&lt;dynamic&gt;</code></p>\n\n<pre><code>var dynamicRows = DataTableX.AsDynamicEnumerable(dt);\nvar rows = dynamicRows.AsQueryable().ToGridModel(1, 0, orderBy, string.Empty, filter).Data;\n</code></pre>\n\n<p>Now I need to create Excel of these rows. SO I used the following code which is of type IEnumerable<code>&lt;DataRow&gt;</code></p>\n\n<pre><code>var output = CreateXlsStream(rows);\n</code></pre>\n\n<p>Now I can't able to assign the rows since it is of type IEnumerable<code>&lt;DataRow&gt;</code> and source is of type IEnumerable<code>&lt;dynamic&gt;</code>. I don't know how to convert from IEnumerable<code>&lt;dynamic&gt;</code> to IEnumerable<code>&lt;DataRow&gt;</code></p>\n"},{"tags":["c#",".net","restsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258279,"title":"Rest client response always null","body":"<p>I create a GUI application to retrieve issue's data from redmine using RestSharp. I followed exactly what is supposed to be done from their documentation, but I keep on receiving a null response. Why is it always null, is there a connection issue?</p>\n\n<p>The <code>var response = client.Execute&lt;T&gt;(request)</code> is always null when <code>request.RootElement = \"issue\"</code> is commented out. When I <em>do</em> use it, I get an exception of \"Object was not instantiated\".</p>\n\n<p>The RestSharp recommended code --> <a href=\"https://github.com/restsharp/RestSharp/wiki/Recommended-Usage\" rel=\"nofollow\">Click here</a></p>\n\n<p>EDIT: I tried it on another server and I get the error <code>Invalid JSON string</code></p>\n\n<p><strong>Manager.cs</strong></p>\n\n<pre><code>public class Manager\n{\n    private string _baseUrl;\n    private string _user;\n    private string _password;\n\n    public Manager(string user, string password, string baseUrl)\n    {\n        _user = user;\n        _password = password;\n        _baseUrl = baseUrl;\n    }\n\n    private T Execute&lt;T&gt;(RestRequest request) where T : new()\n    {\n        var client = new RestClient();\n\n        client.BaseUrl = _baseUrl;\n\n        client.Authenticator = new HttpBasicAuthenticator(_user, _password);\n\n        //TODO: replace string 4110 with a passed ticket # as parameter\n        //request.AddParameter(\"issueId\", \"4110\", ParameterType.UrlSegment); // used on every request\n        var response = client.Execute&lt;T&gt;(request);\n\n        if (response.ErrorException != null)\n        {\n            throw response.ErrorException;\n        }\n\n        return response.Data;\n    }\n\n    public Issue GetIssue(int issueId)\n    {\n        var request = new RestRequest();\n        request.Resource = \"issues/{id}\";\n        //request.RootElement = \"issue\";\n\n        request.AddParameter(\"id\", issueId, ParameterType.UrlSegment);\n\n        return Execute&lt;Issue&gt;(request);\n    }\n</code></pre>\n\n<p><strong>Form1.cs</strong></p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Manager manager = new Manager(\"user\", \"password\", \"http://website/redmine\");\n\n    Issue issue = manager.GetIssue(4110);\n}\n</code></pre>\n\n<p><strong>Issue</strong></p>\n\n<pre><code>public class Issue\n{\n    //public List&lt;Custom_field&gt; Custom_fields { get; set; }\n\n    public int Id { get; set; }\n\n    public Element Project { get; set; }\n\n    public Element Author { get; set; }\n\n    public Element Tracker { get; set; }\n\n    public Element Status { get; set; }\n\n    public Element Priority { get; set; }\n\n    public Element Assigned_to { get; set; }\n\n    public Element Category { get; set; }\n\n    public string Subject { get; set; }\n\n    public string Description { get; set; }\n\n    public string Start_date { get; set; }\n\n    public int Done_ratio { get; set; }\n\n    public double Estimated_hours { get; set; }\n\n    public DateTime Due_date { get; set; }\n\n    public string Created_on { get; set; }\n\n    public string Updated_on { get; set; }\n\n}\n</code></pre>\n"},{"tags":["c#","razor","telerik","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13006795,"title":"How to access grid","body":"<pre><code>@(Html.Telerik().Grid&lt;Test.Model&gt;()\n        .Name(\"TestGrid\")\n</code></pre>\n\n<p>How to access the grid?</p>\n"},{"tags":["c#","asp.net","telerik","radwindow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12891169,"title":"control not found message is displayed","body":"<pre><code>Error Message displayed as \"AddFavoriteRadWindow not found\"\n</code></pre>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>protected void btnAddReport_Click(object sender, ImageClickEventArgs e)\n    {\n         this.form1.Controls.Add(AddFavoriteRadWindow); // working fine\n    }\n\nprotected void btnOk_Click(object sender, EventArgs e)\n{\n    if (txtReportFavorite.Text != string.Empty)\n    {\n        // code for inserting into db..\n        AddFavoriteRadWindow.Visible = false; // not working \n    }\n}\n</code></pre>\n\n<p>\"AddFavoriteRadWindow not found\" message is displayed when I want to hide the rad window</p>\n"},{"tags":["c#","asp.net","telerik","rad"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12860720,"title":"Need the control name","body":"<p>When I am clicking an image button, I need to open a popup window in which it has a textbox, Ok and Cancel buttons. For this I thought of using RadWindow.</p>\n\n<p>But I need someother control which exactly match this requirement. I don't know which control to use. Currently I am working in <strong>Telerik</strong> with <strong>aspx</strong>. I need the control name.Thanks.</p>\n"},{"tags":["c#","asp.net","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12909701,"title":"How to replace the alert message box with RadWindow","body":"<p>My Code:</p>\n\n<pre><code>&lt;telerik:RadWindow ID=\"UpdateFavoriteRadWindow\" Width=\"300\" Height=\"150\" VisibleOnPageLoad=\"false\" CssClass=\"radwindow\" runat=\"server\"&gt;\n    &lt;ContentTemplate&gt;\n        &lt;div align=\"center\" class=\"addFavoriteborder\"&gt;\n            &lt;br /&gt;&lt;br /&gt;\n            &lt;div&gt;\n                &lt;asp:Label ID=\"lblUpdateFavorite\" runat=\"server\" Text=\"Changes Updated\"&gt;&lt;/asp:Label&gt;\n            &lt;/div&gt;\n            &lt;br /&gt;\n        &lt;/div&gt;\n    &lt;/ContentTemplate&gt;\n&lt;/telerik:RadWindow&gt;\n\nprotected void btnUpdateReport_Click(object sender, ImageClickEventArgs e)\n{\n    // code to update\n    Response.Write(\"&lt;script&gt;alert('Changes Updated')&lt;/script&gt;\"); // how to replace this message box with RadWindow\n}\n</code></pre>\n\n<p>I want to show the RadWindow instead of alert message box. Thanks</p>\n"},{"tags":["c#","wpf","datagrid","entity","inotifycollectionchanged"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13257888,"title":"Is there a way to trigger some kind of `OnPropertyChanged` event for a computed property that uses a property of a \"child entity\" in a collection?","body":"<p>Is there a way to trigger some kind of <code>OnPropertyChanged</code> event for a computed property that uses a property of a \"child entity\" in a collection?</p>\n\n<p>A small example:</p>\n\n<p>I have a simple  WPF application with a DataGrid showing Customer properties.\nI am using Entity Framework 5, CodeFirst approach, so I wrote my classes manually with my own INotifyPropertyChanged implementation.</p>\n\n<pre><code>public partial class Customer : INotifyPropertyChanged\n{\n    private string _firstName;\n    public virtual string FirstName\n    {\n        get { return _firstName; }\n        set\n        {\n            _firstName = value;\n            OnPropertyChanged(\"FirstName\");\n            OnPropertyChanged(\"FullName\");\n        }\n    }\n\n    private string _lastName;\n    public virtual string LastName\n    {\n        get { return _lastName; }\n        set\n        {\n            _lastName = value;\n            OnPropertyChanged(\"LastName\");\n            OnPropertyChanged(\"FullName\");\n        }\n    }\n\n    public virtual ICollection&lt;Car&gt; Cars { get; set; }\n    public virtual ICollection&lt;Invoice&gt; Invoices { get; set; }\n\n    ...\n}\n</code></pre>\n\n<p>Now in that same class I created 3 computed properties:</p>\n\n<pre><code>    public string FullName\n    {\n        get { return (FirstName + \" \" + LastName).Trim(); }\n    }\n\n    public int TotalCars\n    {\n        get\n        {\n            return Cars.Count();\n        }\n    }\n\n    public int TotalOpenInvoices\n    {\n        get\n        {\n            if (Invoices != null)\n                return (from i in Invoices\n                        where i.PayedInFull == false\n                        select i).Count();\n            else return 0;\n        }\n    }\n</code></pre>\n\n<p>The <code>FullName</code> is automatically updated in the DataGrid because I'm calling <code>OnPropertyChanged(\"FullName\");</code></p>\n\n<p>I found an example of the INotifyCollectionChanged implementation that I can probably use to auto update the <code>TotalCars</code> when something is added to or removed from the ICollection:\n<a href=\"http://www.dotnetfunda.com/articles/article886-change-notification-for-objects-and-collections.aspx\" rel=\"nofollow\">http://www.dotnetfunda.com/articles/article886-change-notification-for-objects-and-collections.aspx</a></p>\n\n<p>But what is the best approach to trigger the <code>OnPropertyChange(\"TotalOpenInvoices\")</code> when a property (<code>PayedInFull</code>) inside the ICollection (<code>Invoices</code>) changes?</p>\n\n<p>Doing something like <code>OnPropertyChanged(\"Customer.TotalOpenInvoices\");</code> in the Invoice class doesn't seem to do the trick... :)</p>\n"},{"tags":["c#","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13258959,"title":"Dropdown List styles","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8356797/how-to-bold-the-first-option-of-a-select-across-all-browsers\">How to bold the first option of a select across all browsers?</a>  </p>\n</blockquote>\n\n\n\n<p>How do we need to code for a drop down list so that only first item among the dropdownlist is in italics and in different color.</p>\n"},{"tags":["c#","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13258884,"title":"Regex Matching Optional Parameters with same groups","body":"<p>What is the best way to match all these lines.  In the first two lines I will have 3 groups, user/password/mode, but in the last one I would ideally like to have all three groups, but just the value for 3 is an empty string.  </p>\n\n<pre><code>set admin user \"user1\" password \"password1\" privilege \"all\"\nset admin user \"user2\" password \"password2\" privilege \"all\"\nset admin user \"user3\" password \"password3\" \n</code></pre>\n\n<p>My current regex only matches the first 2. </p>\n\n<pre><code>set admin user \"(?&lt;user&gt;[\\w-]+)\" password \"(?&lt;password&gt;.*)\"(\\s+privilege\\s+\"(?&lt;mode&gt;[\\w-]+)\")\n</code></pre>\n"},{"tags":["c#","asp.net","excel","file","csv"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":13244875,"title":"Generate CSV file in ASP.Net","body":"<p><br/>\nI am using the code below on an aspx page on button click event to generate csv file. This works when I do not name my file but when I try to use:\n    Response.AddHeader(\"Content-Disposition\", \"attachment;filename=myfilename.csv\");</p>\n\n<p>to name the file as myfilename.csv, the excel sheet generated is the screen shot of the web page instead of having text in it. Can someone help me with this problem.<br>\nThanks!</p>\n\n<pre><code>DataGrid dg = new DataGrid();\ndg.DataSource = GetData();\nhtmlTextWriter.WriteLine(\"&lt;b&gt;Details&lt;/b&gt;\");\n//Get the html for the control\ndg.HeaderStyle.Font.Bold = true;\ndg.HeaderStyle.BackColor = System.Drawing.Color.Gray;\ndg.DataBind();\ndg.RenderControl(htmlTextWriter);\n\n//Write the HTML back to the browser.\nResponse.Clear();\nResponse.ContentType = \"application/vnd.ms-excel\";\n//Response.AddHeader(\"Content-Disposition\", \"attachment;filename=myfilename.csv\");\n            this.EnableViewState = false;\nResponse.Write(textWriter.ToString());\nResponse.End();\n\nprivate System.Data.DataTable GetData()\n{\n        System.Data.DataTable dt = new System.Data.DataTable(\"TestTable\");\n        dt.Columns.Add(\"SSN\");\n        dt.Columns.Add(\"Employee ID\");\n        dt.Columns.Add(\"Member Last Name\");\n        dt.Columns.Add(\"Member First Name\");\n        dt.Columns.Add(\"Patient Last Name\");\n        dt.Columns.Add(\"Patient First Name\");\n        dt.Columns.Add(\"Claim No.\");\n        dt.Columns.Add(\"Service Line No.\");\n        dt.Columns.Add(\"Error Code\");\n        dt.Columns.Add(\"Error Message\");                \ndt.Rows.Add(123456789,4455,\"asdf\",\"asdf\",\"sdfg\",\"xzcv\",\"dsfgdfg123\",1234,135004,\"some    error\");            \ndt.Rows.Add(123456788,3344,\"rth\",\"ojoij\",\"poip\",\"wer\",\"aadf124\",1233,135005,\"Some Error\");\ndt.Rows.Add(123456787,2233,\"dfg\",\"sdfg\",\"vcxb\",\"cxvb\",\"UHCAL125\",1223,135006,\"another error\");\n        return dt;\n    }\n</code></pre>\n"},{"tags":["c#","imaging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":11108168,"title":"How to use managed Imaging API example?","body":"<p>I am trying to implement the WIMGAPI API into a c# program. I have put <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/dd834960.aspx\" rel=\"nofollow\">this</a> class into my  program already. I just pretty much copied and pasted the whole class on that link into a C# Class file. This is what I have on the form so far:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading;\nusing System.Windows.Forms;\nusing Microsoft.WimgApi;\n\nnamespace Recovery\n{\n    public partial class Form1 : Form\n    {\n\n        WindowsImageContainer wim = new WindowsImageContainer(\"C:\\\\Users\\\\User\\\\Desktop\\\\test.wim\", WindowsImageContainer.CreateFileMode.OpenAlways, WindowsImageContainer.CreateFileAccess.Write);\n\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void capture()\n        {\n            wim.CaptureImage(\"C:\\\\Program Files\\\\\");\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            wim.ProgressEvent += new WindowsImageContainer.DefaultImageEventHandler(wim_ProgressEvent);\n            wim.ScanningEvent += new WindowsImageContainer.DefaultImageEventHandler(wim_ScanningEvent);\n\n            Thread capWIM = new Thread(capture);\n            capWIM.Start();\n\n\n\n        }\n\n        void wim_ProgressEvent(object sender, DefaultImageEventArgs e)\n        {\n            label1.Text = e.LeftParameter.ToString();\n\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n\n        }\n\n        void wim_ScanningEvent(object sender, DefaultImageEventArgs e)\n        {\n            label1.Text = e.LeftParameter.ToString();\n        }\n    }\n}\n</code></pre>\n\n<p>When I press the button to start the image capture, it's supposed to call the scanning and progress event. The only problem is that it's not. Anyone know what I am doing wrong? Or if I am supposed to call the wim a different way? Thanks!</p>\n"},{"tags":["c#","web-services","c#-4.0"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":75,"score":0,"question_id":13258713,"title":"pass a variable to catch block","body":"<p>Basically I have a string errorMessage, I want to pass it to catch block. Please help.</p>\n\n<pre><code>[WebMethod]\npublic List&lt;SomeResult&gt; Load(string userName)\n{\n   string errorMessage;\n    using (VendorContext vendorContext = new VendorContext())\n    {\n         // ....\n          foreach(....)\n          {\n               if(something happens)\n                  errorMessage = \"Vote Obama\";\n                else\n                  errorMessage =\"vote Romney\";\n              // blah\n               try\n                     {\n                        // blah         \n                     }\n               catch (Exception e)\n               {\n                    logger.Trace(errorMessage);\n               }\n          }\n     }\n }  \n</code></pre>\n\n<p>update:</p>\n\n<p>error:  use of Unassigned local variable 'errorMessage' </p>\n"},{"tags":["c#",".net","gui","user-interface"],"answer_count":4,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":4145,"score":10,"question_id":2841180,"title":"How to add an extra button to the window's title bar?","body":"<p>I've seen that some apps (maybe not .NET apps) that have an extra button on the left from the minimize button on the form's title bar? How can I achieve this in C#?</p>\n"},{"tags":["c#","winforms","mouse"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13253041,"title":"Middle button click to scroll","body":"<p>How do I achieve this in a WinForms container control when the scroll bars are visible?</p>\n\n<p>Highlighted here (Google Chrome browser):</p>\n\n<p><img src=\"http://i.stack.imgur.com/SpnMB.png\" alt=\"enter image description here\"></p>\n\n<p>EDIT: This cursor is the only one that is visible on a screenshot. I hope it's clear what i mean.</p>\n\n<p>EDIT:\nTried this on my control. Does not work.</p>\n\n<pre><code>    const int WM_MBUTTONDOWN = 0x207;\n    protected override void WndProc(ref Message m)\n    {\n        if (m.Msg == WM_MBUTTONDOWN)\n            DefWndProc(ref m);\n        else\n            base.WndProc(ref m);\n    }\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":5,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":1847,"score":10,"question_id":4364665,"title":"static destructor","body":"<p>c# has static constructor which do some initialization. (Likely Do some unmanaged resource initialization) I am wondering if there is static destuctor?</p>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13258697,"title":"Removing request validation from page","body":"<p>I have a page that is part of a CMS control panel where the user can fill certain textboxes with javascipt code to be saved in a database. The callbacks are being blocked by the server with the following exception:</p>\n\n<blockquote>\n  <p>Exception message: A potentially dangerous Request.Form value was detected from the client (ctl00$ContentPlaceHolder1$txtMenuAdsenseCode=\"\n</blockquote>\n\n<p>I am not exactly sure why the server is complaining about a textbox value when I am not doing a full postback, but is there any way to turn this off? I put <code>ValidateRequest=\"false\"</code> in the page and this in the <code>web.config</code>:</p>\n\n<pre><code>  &lt;location path=\"~/Admin/Settings.aspx\"&gt;\n      &lt;system.web&gt;\n        &lt;httpRuntime requestValidationMode=\"2.0\" /&gt;\n      &lt;/system.web&gt;\n    &lt;/location&gt;\n</code></pre>\n\n<p>But it is still throwing the exception.</p>\n"},{"tags":["c#","javascript","jquery","asp.net","sharepoint"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13257061,"title":"small Q on js and sharepoint","body":"<p>A simple question on interacting between js and sharepoint</p>\n\n<p>I created a js in the asp page to retrieve the list item from sharepoint, I wrote like that:</p>\n\n<pre><code>$(document).ready(function () { ExecuteOrDelayUntilScriptLoaded(find, \"sp.js\"); });\n window.onload = function () {\n find();\n}\nfunction loadConstants() {     \n    var clientContext = new SP.ClientContext.get_current(); ;\n    this.web = clientContext.get_web();     \n    var lists = web.get_lists();\n    var list = lists.getByTitle(\"Weekend's Notes\");\n    var camlQuery = new SP.CamlQuery();\n    this.items = list.getItems(camlQuery);\n    clientContext.load(items);     \n    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));\n\n}\n</code></pre>\n\n<p>below is the finding method</p>\n\n<pre><code>function onQuerySucceeded(sender, args) {\n        var listItemInfo = '';\n        var listItemEnumerator = collListItem.getEnumerator();\n        while (listItemEnumerator.moveNext()) {\n            var oListItem = listItemEnumerator.get_current();\n            //document.getElementById(\"ctl00_m_g_826af611_885a_4a36_8141_91157fa66535_ctl00_TextArea1\").innerHTML = oListItem.get_item('Note');\n\n        }\n    }\n</code></pre>\n\n<p>everytime it refreshed the browser, it shows that it <strong>Uncaught TypeError: Cannot read property 'get_current' of undefined</strong>\nCan anybody give me a hand? Totally have no ideas about that...</p>\n"},{"tags":["c#","youtube-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13226103,"title":"The remote server returned an error: (403) Forbidden in Youtube api","body":"<p>I am using Youtube API to upload videos. Its working fine in my local machine but it throws below exception after I implemented my code into server.</p>\n\n<pre><code>The remote server returned an error: (403) Forbidden.\n</code></pre>\n\n<p>I have mentioned username, developerkey, password correctly. Could you please any one help me that where I am wrong?</p>\n"},{"tags":["c#","xml-parsing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258253,"title":"c# XElement.Parse() retrieve WOEID from yahoo API","body":"<p>I will strat with what I have done already. So I have following XMLfile:</p>\n\n<pre><code>&lt;places yahoo:start=\"0\" yahoo:count=\"23\" yahoo:total=\"23\"&gt;\n    &lt;place yahoo:uri=\"http://where.yahooapis.com/v1/place/523920\" xml:lang=\"en-us\"&gt;\n        &lt;woeid&gt;523920&lt;/woeid&gt;\n        &lt;placeTypeName code=\"7\"&gt;Town&lt;/placeTypeName&gt;\n        &lt;name&gt;Warsaw&lt;/name&gt;\n        &lt;country type=\"Country\" code=\"PL\" woeid=\"23424923\"&gt;Poland&lt;/country&gt;\n        ...\n    &lt;/place&gt;\n    ...\n&lt;/places&gt;\n</code></pre>\n\n<p>I skip parts, which are not neccesary (I believe so atleast). Anyway There is &lt;places&gt; which contains variable number of &lt;place&gt; in this particular case it's 23. I do following code:</p>\n\n<pre><code>List&lt;XElement&gt; list = XElement.Parse(e.Result).Elements().ToList();\n</code></pre>\n\n<p>As a result I have list of 23 XElements (place), but from some reason I can't get value which is inside &lt;woeid&gt; Bellow code doesn't work :-(</p>\n\n<pre><code>foreach (XElement element in list) {\n    String woeid = element.Element(\"woeid\").Value;\n    // ... sth else to do with each woeid\n}\n</code></pre>\n\n<p>Can you help me get those values?</p>\n\n<p>[UPDATE]</p>\n\n<p>I think I have found what you have been asking for @L.B by getting page source from context menu, here is it. Can you help me?</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;places xmlns=\"http://where.yahooapis.com/v1/schema.rng\" xmlns:yahoo=\"http://www.yahooapis.com/v1/base.rng\" yahoo:start=\"0\" yahoo:count=\"23\" yahoo:total=\"23\"&gt;\n</code></pre>\n\n<p>[SOLVED]</p>\n\n<p>Thanks for a hint about namespaces. Using Trials and Errors method I have done it. Answer is that, you have to add namespace in bracket before element name as bellow.</p>\n\n<pre><code>String woeid = element.Element(\"{http://where.yahooapis.com/v1/schema.rng}woeid\").Value;\n</code></pre>\n\n<p>And now it just simply works. Thanks once again.</p>\n"},{"tags":["c#","mysql","linq","entity-framework","entity-framework-5"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":1,"view_count":115,"score":4,"question_id":13257760,"title":"Why does Entity Framework SQL generation create a nested query?","body":"<p>Why does Entity Framework SQL generation create a nested query?</p>\n\n<p>I have this code</p>\n\n<pre><code>    var db = new Context();\n    var result = db.Network.Where(x =&gt; x.ServerID == serverId)\n        .OrderBy(x=&gt; x.StartTime)\n        .Take(limit);\n</code></pre>\n\n<p>Which will be transleted into this! (Note the dubble select statement)</p>\n\n<pre><code>SELECT\n`Project1`.`Id`, \n`Project1`.`ServerID`, \n`Project1`.`EventId`, \n`Project1`.`StartTime`\nFROM (SELECT\n`Extent1`.`Id`, \n`Extent1`.`ServerID`, \n`Extent1`.`EventId`, \n`Extent1`.`StartTime`\nFROM `Networkes` AS `Extent1`\n WHERE `Extent1`.`ServerID` = @p__linq__0) AS `Project1`\n ORDER BY \n`Project1`.`StartTime` DESC LIMIT 5\n</code></pre>\n\n<p>How could I change it into one <code>select</code> statement?\nI'm using MySQL and Entity Framework with code first</p>\n\n<h1>Update</h1>\n\n<p>I have the same result whatever type I use as parameter to the <code>OrderBy()</code> method.</p>\n\n<h1>Update 2 with some timeing</h1>\n\n<pre><code>Total Time (hh:mm:ss.ms)    05:34:13.000\nAverage Time (hh:mm:ss.ms)  25:42.000\nMax Time (hh:mm:ss.ms)  51:54.000\nCount   13\nFirst Seen  Nov 6, 12 19:48:19\nLast Seen   Nov 6, 12 20:40:22\n</code></pre>\n\n<p>Raw query:</p>\n\n<pre><code>SELECT `Project?`.`Id`, `Project?`.`ServerID`, `Project?`.`EventId`, `Project?`.`StartTime` FROM (SELECT `Extent?`.`Id`, `Extent?`.`ServerID`, `Extent?`.`EventId`, `Extent?`.`StartTime`, FROM `Network` AS `Extent?` WHERE `Extent?`.`ServerID` = ?) AS `Project?` ORDER BY `Project?`.`Starttime` DESC LIMIT ?\n</code></pre>\n\n<p>I use a program to take snapshots from the current process in MySQL.</p>\n\n<p>It's other querys that could be executed at the same time. But when I change it to just one SELECT statement, it NEVER goes over one second. Maybe I have something else that's going on, I'm asking couse I'm not so into DBs...</p>\n\n<h1>Update 3 The explain statement</h1>\n\n<p>The entity framework generated</p>\n\n<pre><code>'1', 'PRIMARY', '&lt;derived2&gt;', 'ALL', NULL, NULL, NULL, NULL, '46', 'Using filesort'\n'2', 'DERIVED', 'Extent?', 'ref', 'serveridneventid,serverid', 'serveridneventid', '109', '', '45', 'Using where'\n</code></pre>\n\n<p>One liner</p>\n\n<pre><code>'1', 'SIMPLE', 'network', 'ref', 'serveridneventid,serverid', 'serveridneventid', '109', 'const', '45', 'Using where; Using filesort'\n</code></pre>\n\n<p>This is from my QA enviroment, so the timeing I pasted above is not realted to this row count explain statements. I think that there is about 500,000 records that match one server id.</p>\n"},{"tags":["c#","xml-rpc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13014851,"title":"Passing array of XmlRpcStruct in XML-RPC throws error in C#","body":"<p>I am using XML_RPC v2.5.0 for .Net to make few calls to web service to send product data. All calls are working OK except one scenario. I am sending product data to the web service that is expected to be in the below format(Format is defined in PhP language) - </p>\n\n<pre><code>$order['products'][] = ['sku', 'quantity']\n</code></pre>\n\n<p>I am using the below code to pass this data - </p>\n\n<pre><code>XmlRpcStruct dic = new XmlRpcStruct();\nDataTable dt1 = GetData();\nXmlRpcStruct[] prod = new XmlRpcStruct[dt1.Rows.Count];\nfor (int i = 0; i &lt; dt1.Rows.Count; i++)\n{\n   prod[i] = new XmlRpcStruct();\n   prod[i].Add(\"sku\", dt1.Rows[i][0].ToString());\n   prod[i].Add(\"quantity\", dt1.Rows[i][1].ToString());\n}\ndic.Add(\"products\", prod);\nobject orderID = proxy.SubmitOrder(dic, custID, accessKey);\n</code></pre>\n\n<p>The above code works when there is only 1 row in the data table dt1 and I get the orderID successfully. However, if there are more than 1 records in the data table, I am getting an exception as  - </p>\n\n<blockquote>\n  <p>A parameter is of, or contains an instance of, type CookComputing.XmlRpc.XmlRpcStruct which cannot be mapped to an XML-RPC type</p>\n</blockquote>\n\n<p>I think I am missing something silly here. Please help and let me know what mistake I am doing here.\nThanks in advance!</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13256246,"title":"linq to entity framework with join","body":"<p>I have in my DB 2 tables: </p>\n\n<ol>\n<li><p>Documents (Document_Id ,document_Name) </p></li>\n<li><p>Person_Documents (person_ID ,Documet_Id document_Done)</p></li>\n</ol>\n\n<p>I use entity framework and ,and I want to fill <code>DataGrid</code> with the data <code>document_Name</code> and <code>document_Done</code>,</p>\n\n<p>I have tried the following with no results:</p>\n\n<pre><code>      vagEntities projectE = new vagEntities();\n      var doc = from c in projectE.Person_Documents                   \n          join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n          where c.Person_Id == 150\n          select c;\n\n      DocGrid.ItemsSource = doc;\n</code></pre>\n\n<p>Please, where am I wrong?\nun the xaml i write this</p>\n\n<pre><code>                &lt;DataGridTextColumn Binding=\"{Binding Path=Document_Name}\" MinWidth=\"100\"   Header=\"document\"  /&gt;\n\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=Document_done}\" Header=\"Do\" /&gt;\n</code></pre>\n"},{"tags":["c#","javascript","jquery","asp.net-mvc-3"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13256355,"title":"How to implement multiple dropdown lists in MVC","body":"<p>Let's say I want to show multiple Drop Down Boxes each with the same values within them within a View using the @Html.DropDownList.\nIs there an easy way to be able to render all of these Drop Down Boxes without having to bind something like the ViewBag to each of the months returned?</p>\n\n<p>For example:</p>\n\n<p>Controller</p>\n\n<pre><code>List&lt;SelectListItem&gt; items = new List&lt;SelectListItem&gt;();\n\nvar values = (from v in db.Values select v);\n\nforeach (var value in values)\n{\n    items.Add(new SelectListItem { Text = value.Name, Value = value.Id });\n}\n\nViewBag.Values = PopulateSelectList(\"Values\");\n</code></pre>\n\n<p>View</p>\n\n<pre><code>@Html.DropDownList(\"Values\")\n</code></pre>\n\n<p>But what the goal would be is to have something like</p>\n\n<pre><code>&lt;div class=\"control-group\"&gt;\n    @Html.LabelFor(model =&gt; model.DesignStyle)\n    &lt;div class=\"controls\"&gt;\n        @Html.DropDownList(\"Values\")    @Html.DropDownList(\"Values\")\n        @Html.DropDownList(\"Values\")    @Html.DropDownList(\"Values\")\n        @Html.DropDownList(\"Values\")    @Html.DropDownList(\"Values\")\n        @Html.DropDownList(\"Values\")    @Html.DropDownList(\"Values\")\n        @Html.DropDownList(\"Values\")    @Html.DropDownList(\"Values\")\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>My guess is I would need some sort of <code>@foreach (item in Model)</code> to populate each of the DropDowns on the View</p>\n\n<p>Here is a sample of my initial thought on how to get something going.</p>\n\n<pre><code>List&lt;SelectListItem&gt; results = new List&lt;SelectListItem&gt;();\nSelectListItem item = null;\n\nvar values = (from v in db.Values select v);\n\nfor (int i = 0; i &lt;= 15; i++)\n{\n     item = new SelectListItem();\n\n     item.Text = \"Select a value\";\n     item.Value = \"1\";\n\n     results.Add(item);\n\n     foreach (var thread in threads)\n     {\n         item.Text = thread.Name;\n         item.Value = thread.Id;\n\n         results.Add(item);\n     }\n }\n</code></pre>\n\n<p>What I don't want to do is duplicate the logic to populate a SelectListItem multiple times and put each of those in a separate ViewBag item.</p>\n"},{"tags":["c#",".net","nlog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13258094,"title":"How to log Exceptions in Nlog2?","body":"<p>I am a bit confused what way is the right way to log exceptions</p>\n\n<pre><code> Log.Fatal(exception format, args);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>  logger.FatalException(\"Got exception.\", ex);\n</code></pre>\n"},{"tags":["c#",".net","vb.net","json","json.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13258163,"title":"JSON Deserialization in .NET","body":"<p>I've had a look at a few threads but what I'm aiming for I can't seem to find.<br>\nI have the following JSON strings returned:</p>\n\n<p>On success:</p>\n\n<pre><code>{\"success\":{\"username\":\"key\"}}\n</code></pre>\n\n<p>On Error: </p>\n\n<pre><code>{\"error\":{\"type\":101,\"address\":\"/\",\"description\":\"link button not pressed\"}}\n</code></pre>\n\n<p>I need to be able to de-serialize these into a class and determine whether I've got an error or a success message to carry on doing it. Any ideas on how to achieve this?</p>\n\n<p>thanks,</p>\n\n<p>Adam</p>\n"}]}
{"total":375450,"page":20,"pagesize":100,"questions":[{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13193574,"title":"Searching a GridView bound to SQLDataSource using Textboxes","body":"<p>My scenario is a Gridview which is bound to a stored procedure using asp:SQLDataSource. This was quickly done using the wizard where i selected the SP and all data was dispalyed.\nThe SP was created in such a way that it contains 4 parameters. When such parameters are null, they will return all values in the query.</p>\n\n<p>I have created 3 textboxes and a dropdown list to populate these parameters, binding them to a  button in an attempt to create a search functionality. I have tried many ways and methods, especially by research on this site but none seem to work. I cant quite find my issue so I appreciate any help on the matter. Below is my code.</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"sqlSourceID\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:DBCONNSTRING%&gt;\"\n            SelectCommand=\"storedProcedureName\" SelectCommandType=\"StoredProcedure\"&gt;                \n        &lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>The above is the SQL stored procedure bind.</p>\n\n<p>I have attemtped to bind the controls as parameters for the SQL server. Prior to this code, the page used to load all records fine without search parameters as the SP was assuming a null value. Now nothing loads.</p>\n\n<pre><code>            &lt;SelectParameters&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox1\" PropertyName=\"Text\" Name=\"1\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox2\" PropertyName=\"Text\" Name=\"2\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox3\" PropertyName=\"Text\" Name=\"3\" Type=\"String\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"ddl1\" PropertyName=\"SelectedText\" Name=\"4\" Type=\"String\" /&gt;\n            &lt;/SelectParameters&gt;\n</code></pre>\n\n<p>Where the Control ID represents the textbox ID</p>\n\n<p>Below is my code behind.</p>\n\n<pre><code>        sqlSourceID.SelectParameters[\"textbox1\"].DefaultValue = this.textbox.Text;\n        sqlSourceID.SelectParameters[\"textbox2\"].DefaultValue = this.textbox1.Text;\n        sqlSourceID.SelectParameters[\"textbox3\"].DefaultValue = this.textbox2.Text;\n        sqlSourceID.SelectParameters[\"ddl1\"].DefaultValue =    Convert.ToString(this.ddl.SelectedText);\n</code></pre>\n\n<p>Well that is my problem. I need to find a way to pass parameters from the textboxes when the Search Button is clicked and assume null on page load or if nothing is written.</p>\n\n<p>Thanks to all those who contribute in advance.</p>\n"},{"tags":["c#","regex","string","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13258477,"title":"C# Regex.Split force result to not escape characters","body":"<p>I am attempting to do some string manipulations and I have a need to take  multi-line strings and create a <code>List&lt;String&gt;</code> by splitting on <code>\\r\\n</code> so that I end up with a list of the lines found in the string.</p>\n\n<p>However, after doing the Regex.Split I'm ending up with lines that have every single <br> \n<code>\"</code> escaped with a <code>\\</code>.</p>\n\n<p>For example, a snippet of an input string is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;g2s:g2sMessage xmlns:g2s=\"http://www.gamingstandards.com/g2s/schemas/v1.0.3\"&gt;\n   &lt;g2s:g2sBody g2s:dateTimeSent=\"2012-11-06T09:12:38.006-08:00\" g2s:egmId=\"RBG_1234\"\n                g2s:hostId=\"1\"&gt;\n      &lt;g2s:communications g2s:commandId=\"37102\" g2s:dateTime=\"2012-11-06T09:12:38.004-08:00\"\n                          g2s:deviceId=\"1\"\n                          g2s:errorCode=\"G2S_none\"\n</code></pre>\n\n<p>When I do the following to split this string into a <code>List&lt;String&gt;</code> using:</p>\n\n<pre><code>List&lt;string&gt; lines = new List&lt;string&gt;(Regex.Split(message, \"\\r\\n\"));\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?&gt;\n&lt;g2s:g2sMessage xmlns:g2s=\\\"http://www.gamingstandards.com/g2s/schemas/v1.0.3\\\"&gt;\n   &lt;g2s:g2sBody g2s:dateTimeSent=\\\"2012-11-06T09:12:38.006-08:00\\\" g2s:egmId=\\\"RBG_1234\\\"\n            g2s:hostId=\\\"1\\\"&gt;\n      &lt;g2s:communications g2s:commandId=\\\"37102\\\" g2s:dateTime=\\\"2012-11-06T09:12:38.004-08:00\\\"\n            g2s:deviceId=\\\"1\\\"\n            g2s:errorCode=\\\"G2S_none\\\"\n</code></pre>\n\n<p><strong>How would I do this without ending up with strings that have <code>\"</code> escaped?</strong> <br>\n<strong>Is C# really escaping the characters, or is it just the way the debugger is showing the strings?</strong></p>\n"},{"tags":["c#","recursive-query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13258274,"title":"Turn recursive into iterative code","body":"<p>I want to \"transform\" recursive code into iterative code. The example is:</p>\n\n<pre><code> public int CalcTime(double AnnualIncome, int Time, double Value)\n {\n     if (AnnualIncome / 12 &gt; Value / Time) \n         return Time;\n     else\n         return CalcTime(AnnualIncome, Time + 1, Value);\n }\n</code></pre>\n\n<p>I tried but could not...</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["c#","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":77,"score":4,"question_id":13257896,"title":"Passing object to viewmodel","body":"<p>Question on the MVVM pattern where I think I have it wrong.</p>\n\n<p>When a touchdown event occurs in a view I want to popup a message i.e.:</p>\n\n<pre><code>private void marker_TouchDown(MessageObject msgData)\n{\n    CustomMessageControl message = new CustomMessageControl() {Width = 610, Height = 332};\n    CustomMessageViewModel messageVM = new CustomMessageViewModel(msgData);\n    message.DataContext = messageVM;\n    //Add to canvas\n}\n</code></pre>\n\n<p>My viewmodel:</p>\n\n<pre><code>public class CustomMessageViewModel\n{\n    public MessageObject message { get; set; }\n\n    public CustomMessageViewModel(MessageObject message)\n    {\n        this.MessageObject = message;\n    }\n}\n</code></pre>\n\n<p>This works but doesn't feel right. Is this an acceptable way to populate the view model? </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13258453,"title":"Running a Windows application as a Command Line application","body":"<p>I am working on a migration tool that is primarily a Windows Forms application. What I want to do is provide the ability to run the application as a sort of command line utility where parameters can be passed in and the migration occurs completely void of the GUI.  This seems straight forward enough and the entry point for my application looks like this:</p>\n\n<pre><code>    [STAThread]\n    static void Main(string[] args)\n    {\n        if (args.Length == 0)\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            Application.Run(new MainWindow());\n        }\n        else\n        {\n            //Command Line Mode\n            Console.WriteLine(\"In Command Line Mode\");\n            Console.ReadLine();\n        }\n    }\n</code></pre>\n\n<p>The problem I am running into is that when execution passes into the else block the text is not wrote back to the user at the command prompt which is problematic as I want to update the user at the command prompt as various executions complete.  I could easily write a standalone console application but I was hoping to provide a single tool that allowed to different types of entries for a given scenario.  Is what I am looking to do possible and, if so, how is it achieved? </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13258539,"title":"i want to play a song that i have stored in assets folder of my windows 8 app how can i set the source for a button to that song?","body":"<p>xaml.cs</p>\n\n<pre><code>void playButton_Click(object sender, RoutedEventArgs e) \n{\n    this.mediaplayer.Source = new Uri(\"Assets/heydude.mp3\", UriKind.Relative);\n    this.mediaplayer.Play();\n} \n</code></pre>\n"},{"tags":["c#","dependency-injection","ninject","ninject-extensions","ninject-interception"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13248507,"title":"Ninject Method-level interception with params","body":"<p>I've noticed in the tutorials for interception that you can target a method and intercept it. I.e.</p>\n\n<pre><code> Kernel.Bind&lt;Foo&gt;().ToSelf();\n Kernel.InterceptReplace&lt;Foo&gt;(foo =&gt; foo.ThrowsAnError(), invocation =&gt; {} );\n</code></pre>\n\n<p>The documentation/tutorial does not cover what to do in the instance that the method you're trying to intercept has parameters i.e if <i> ThrowsAnError</i> accepted a string as a parameter. </p>\n\n<pre><code> Kernel.Bind&lt;Foo&gt;().ToSelf();\n Kernel.InterceptReplace&lt;Foo&gt;(foo =&gt; foo.ThrowsAnError(**param goes here**), invocation =&gt; {} );\n</code></pre>\n\n<p>At the time of binding I do not have access to the params so I was wondering whether I am going about this the wrong way?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I got it to work as per the accepted answer, I feel that somewhere should have a working example so I will paste my working example here and later upload it to GitHub after I've tidied it a bit, apologies.  Notice I am passing in 0 to the method, as Steven mentioned, this doesn't matter, it will intercept the correct argument at runtime.</p>\n\n<p><strong>Program.cs</strong></p>\n\n<pre><code>class Program\n{\n      static void Main()\n    {\n        var kernel = new StandardKernel(new NinjectSettings() { LoadExtensions = true });\n        kernel.InterceptAfter&lt;Repository.Repository&gt;(foo =&gt; foo.GetById(0),\n                                          invocation =&gt; new LoggerInterceptor().Intercept(invocation));\n        kernel.Bind&lt;IRepository&gt;().To&lt;Repository.Repository&gt;();\n\n        var start = new StartApplication(kernel.Get&lt;IRepository&gt;());\n        start.DoStuff();\n    }\n\n    private static Action&lt;IInvocation&gt; Action()\n    {\n        return invocation =&gt; new LoggerInterceptor().Intercept(invocation);\n    }\n}\n</code></pre>\n\n<p><strong>StartApplication.cs</strong></p>\n\n<pre><code>using Ninject.Repository;\n\nnamespace Ninject\n{\n    public class StartApplication\n    {\n        private readonly IRepository _repository;\n\n        public StartApplication(IRepository repository)\n        {\n            _repository = repository;\n        }\n\n        public void DoStuff()\n        {\n            _repository.GetById(3);\n        }\n    }\n}\n</code></pre>\n\n<p><strong>LoggerInterceptor.cs</strong></p>\n\n<pre><code>    using System;\n    using Ninject.Extensions.Interception;\n    namespace Ninject\n    {\n        public class LoggerInterceptor : IInterceptor\n        {\n            public void Intercept(IInvocation invocation)\n            {\n                Console.WriteLine(\"Logged method call\");\n                invocation.Proceed();\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>Repository.cs</strong></p>\n\n<pre><code>namespace Ninject.Repository\n{\n    public class Repository : IRepository\n    {\n        public virtual string GetById(int id)\n        {\n            return \"lol\";\n        }\n    }\n\n    public interface IRepository\n    {\n        string GetById(int id);\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13258420,"title":"Getting information from the cookie made by FormsAuthentication.RedirectFromLoginPage in C#","body":"<p>Hi I used this in C#:</p>\n\n<pre><code>FormsAuthentication.RedirectFromLoginPage(userID, chkPersistCookie.Checked) \n</code></pre>\n\n<p>to create a cookie for my web app. </p>\n\n<p>I need to know how to get the userID back from the cookie?</p>\n"},{"tags":["c#","asp.net","web-services","reflection","web-applications"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1321,"score":4,"question_id":2622340,"title":"Object of type 'customObject' cannot be converted to type 'customObject'","body":"<p>I receive the following error when I invoke a custom  object<br>\n<code>\"Object of type 'customObject' cannot be converted to type 'customObject'.\"</code></p>\n\n<p>Following is the scenario when I am get this error:</p>\n\n<ul>\n<li>I invoke a method in a dll dynamically.</li>\n<li>Load an assembly</li>\n<li>CreateInstance....</li>\n</ul>\n\n<p>When calling MethodInfo.Invoke() passing int, string as a parameter for my method works fine => No exceptions are thrown.</p>\n\n<p>But if I try and pass one of my own custom class objects as a parameter, then I get an <code>ArgumentException</code> exception, and it is not either an <code>ArgumentOutOfRangeException</code> or <code>ArgumentNullException</code>.</p>\n\n<p><code>\"Object of type 'customObject' cannot be converted to type 'customObject'.\"</code></p>\n\n<p>I am doing this in a web application.</p>\n\n<p>The class file containing the method is in a different project. Also the custom object is a separate class in the same file.</p>\n\n<p>There is no such thing called a <code>static assembly</code> in my code. I am trying to invoke a webmethod dynamically. this webmethod is having the customObject type as an input parameter. So when i invoke the webmethod i am dynamically creating the proxy assembly and all. From the same assembly i am trying to create an instance of the cusotm object assinging the values to its properties and then passing this object as a parameter and invoking the method. everything is dynamic and nothing is created static.. :( </p>\n\n<p>add reference is not used.\nFollowing is a sample code i tried to create it</p>\n\n<pre><code>public static object CallWebService(string webServiceAsmxUrl, string serviceName, string methodName, object[] args) \n    { \n        System.Net.WebClient client = new System.Net.WebClient(); \n        //-Connect To the web service \n        using (System.IO.Stream stream = client.OpenRead(webServiceAsmxUrl + \"?wsdl\")) \n        { \n            //--Now read the WSDL file describing a service. \n            ServiceDescription description = ServiceDescription.Read(stream); \n            ///// LOAD THE DOM ///////// \n            //--Initialize a service description importer. \n            ServiceDescriptionImporter importer = new ServiceDescriptionImporter(); \n            importer.ProtocolName = \"Soap12\"; // Use SOAP 1.2. \n            importer.AddServiceDescription(description, null, null); \n            //--Generate a proxy client. importer.Style = ServiceDescriptionImportStyle.Client; \n            //--Generate properties to represent primitive values. \n            importer.CodeGenerationOptions = System.Xml.Serialization.CodeGenerationOptions.GenerateProperties; \n            //--Initialize a Code-DOM tree into which we will import the service. \n            CodeNamespace nmspace = new CodeNamespace(); \n            CodeCompileUnit unit1 = new CodeCompileUnit(); \n            unit1.Namespaces.Add(nmspace); \n            //--Import the service into the Code-DOM tree. This creates proxy code \n            //--that uses the service. \n            ServiceDescriptionImportWarnings warning = importer.Import(nmspace, unit1); \n            if (warning == 0) //--If zero then we are good to go \n            { \n                //--Generate the proxy code  \n                CodeDomProvider provider1 = CodeDomProvider.CreateProvider(\"CSharp\"); \n                //--Compile the assembly proxy with the appropriate references \n                string[] assemblyReferences = new string[5] { \"System.dll\", \"System.Web.Services.dll\", \"System.Web.dll\", \"System.Xml.dll\", \"System.Data.dll\" }; \n                CompilerParameters parms = new CompilerParameters(assemblyReferences); \n                CompilerResults results = provider1.CompileAssemblyFromDom(parms, unit1); \n                //-Check For Errors \n                if (results.Errors.Count &gt; 0) \n                { \n                    StringBuilder sb = new StringBuilder(); \n                    foreach (CompilerError oops in results.Errors) \n                    { \n                        sb.AppendLine(\"========Compiler error============\"); \n                        sb.AppendLine(oops.ErrorText); \n                    } \n                    throw new System.ApplicationException(\"Compile Error Occured calling webservice. \" + sb.ToString()); \n                } \n                //--Finally, Invoke the web service method  \n                Type foundType = null; \n                Type[] types = results.CompiledAssembly.GetTypes(); \n                foreach (Type type in types) \n                { \n                    if (type.BaseType == typeof(System.Web.Services.Protocols.SoapHttpClientProtocol)) \n                    { \n                        Console.WriteLine(type.ToString()); \n                        foundType = type; \n                    } \n                } \n\n                object wsvcClass = results.CompiledAssembly.CreateInstance(foundType.ToString()); \n                MethodInfo mi = wsvcClass.GetType().GetMethod(methodName); \n                return mi.Invoke(wsvcClass, args); \n            } \n            else \n            { \n                return null; \n            } \n        } \n    } \n</code></pre>\n\n<p>I can't find anything <code>static</code> in what I do.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Regards,\nPhani Kumar PV</p>\n"},{"tags":["c#","winforms","textbox","treeview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":283,"score":0,"question_id":11084027,"title":"C#:Search from treeview","body":"<p>I got a treeview data loaded from a XML file. I want to perform a search when the user types something in the textbox. Is that the right way of doing it?? I just want to filter the data. Please show me some example.</p>\n\n<p>The below code is not working.</p>\n\n<pre><code> textBox1.Enter += new EventHandler(txtSearch_TextChanged);\n\n private void txtSearch_TextChanged(object sender, EventArgs e)\n        {\n\n            foreach (TreeNode node in this.treeView1.Nodes)\n            {\n\n                if (node.Text.ToUpper().Contains(this.textBox1.Text.ToUpper()))\n                {\n\n                    treeView1.SelectedNode = node;\n\n                    break;\n\n                }\n  }\n</code></pre>\n"},{"tags":["c#","html","asp.net-mvc","kendo-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13253930,"title":"Batch Grid cell takes DataValueField from DropDownList when cell leaves edit mode","body":"<p>What I want to do is display text for a company name in the drop down AND the cell (when it's not being edited), but have the ID of the company be the data that is passed back to the server when \"Save\" is clicked.</p>\n\n<p>Everything works perfectly, except that when I click on the next cell to continue my edits (which causes the cell with the DDL to leave edit mode), the read only cell in its place displays the ID instead of the Company's name.</p>\n\n<p>This picture illustrates what I mean:\n<img src=\"http://i.stack.imgur.com/ZkpnT.png\" alt=\"enter image description here\"></p>\n\n<p>Does anyone know a way to fix this or a different way to achieve the functionality that I need?</p>\n\n<p><strong>Editor Template</strong></p>\n\n<pre><code>@(Html.Kendo().DropDownList()\n.Name(\"Company\")\n.DataTextField(\"Name\")\n.DataValueField(\"EnterpriseID\")\n.BindTo((IEnumerable&lt;BlueGrace.BlueShip.Business.Enterprise.EnterpriseChildListingItem&gt;)ViewBag.RefCarrierLiabilityEnterpriseListing))\n</code></pre>\n\n<p><strong>Controller (ViewBag population)</strong></p>\n\n<pre><code>var enterpriseListing = Business.Enterprise.EnterpriseChildListing.Get(false, customIdentity.EnterpriseID, false).ToList();\n        ViewBag.RefCarrierLiabilityEnterpriseListing = enterpriseListing;\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>    @(Html.Kendo().Grid(Model.GlobalDictionary.RefCarrierLiabilityModels)\n        .Name(\"CarrierLiabilityDictionaryGrid\")\n    .Columns(columns =&gt;\n    {\n        columns.Bound(item =&gt; item.CarrierName)\n            .EditorTemplateName(\"RefCarrierListing\").Width(250);\n        columns.Bound(item =&gt; item.Company)\n            .EditorTemplateName(\"RefCarrierLiabilityEnterpriseListing\");\n        columns.Bound(item =&gt; item.MaxLiability)\n            .EditorTemplateName(\"RefCarrierLiabilityMaxLiability\");\n        columns.Bound(item =&gt; item.IsValueOfGoodsMaxLiability);\n        columns.Command(command =&gt;\n        {\n            command.Destroy();\n        }).Width(100);\n    })\n    .ToolBar(toolbar =&gt;\n    {\n        toolbar.Create();\n        toolbar.Save();\n    })\n    .Editable(editable =&gt; editable.Mode(GridEditMode.InCell).CreateAt(GridInsertRowPosition.Top))\n    .Pageable()\n    .Sortable()\n    .Scrollable()\n    .Filterable()\n    .Resizable(resize =&gt; resize.Columns(true))\n    .Reorderable(reorder =&gt; reorder.Columns(true))\n    .DataSource(dataSource =&gt; dataSource\n        .Ajax()\n        .Batch(true)\n        .ServerOperation(false)\n        .Model(model =&gt;\n        {\n            model.Id(i =&gt; i.RefCarrierLiabilityID);\n            model.Id(i =&gt; i.RefCarrierID);\n        })\n        .Read(read =&gt; read.Action(\"GetCarrierLiabilities\", \"Dictionary\"))\n        .Create(create =&gt; create.Action(\"CreateCarrierLiabilities\", \"Dictionary\"))\n        .Update(update =&gt; update.Action(\"UpdateCarrierLiabilities\", \"Dictionary\"))\n        .Destroy(delete =&gt; delete.Action(\"DeleteCarrierLiabilities\", \"Dictionary\"))\n    )\n)\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","datetime","serialization","json.net"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13257891,"title":"JSON.NET Custon serialization and ASP.NET MVC Model attributes","body":"<p>How to access MVC Model property attributes in Custom JSON.NET serialization? For example i want to access [DataType(DataType.Date)] model property attribute in custom JSON.NET serializer and make some decisions depending on that attribute. </p>\n"},{"tags":["c#","asp.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13257994,"title":"I have a table that is based on two foreign keys","body":"<p>I have a table that is based on two foreign keys. One is <code>memberID</code>, and the second is <code>movieID</code>. I need to take from this table the row that connects these two and get from the same row <code>RentDays</code>, which is an <code>int</code>.</p>\n\n<p>i did this but i think its not good:</p>\n\n<pre><code>public int  GetRentDays(int memberID, string movieID)\n{      \n    var movieRentDays = \n        from Rents in videoLibDB.Rents\n        where Rents.MemberID == memberID &amp;&amp; Rents.MovieID == movieID\n        select Rents.RentDays;\n        return  movieRentDays ;\n}\n</code></pre>\n"},{"tags":["c#","setup-project","startup","registry"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1033,"score":1,"question_id":8039429,"title":"Visual Studio Setup Project and placing application in startup path","body":"<p>I've created a function that executes in the beginning of an installation to create a registry key in the SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run path, so the app can start when the computer starts. </p>\n\n<p>The function works in a XP / 2003 machine but not on Windows 7. The install application Elevates the privileges during installation automatically because it is installing a windows service program. So I'm wondering what am I doing wrong again?</p>\n\n<p>Here is the function:</p>\n\n<pre><code>private void RegisterInStartup(bool isChecked)\n{\n    try\n    {\n        string t_registeryPath = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\";\n\n        RegistryKey registryKey =\n            Registry.LocalMachine.OpenSubKey(t_registeryPath, true);\n\n        if (registryKey == null)\n            registryKey = Registry.LocalMachine.CreateSubKey(t_registeryPath);\n\n        if (isChecked)\n        {\n            string tgt_dir = Context.Parameters[\"targetPath\"];\n            if (!Directory.Exists(tgt_dir))\n                return;\n\n            string t_exeName = Path.Combine(tgt_dir, \"AppTaskbarNotificator.exe\");\n            if (!File.Exists(t_exeName))\n                return;\n\n            registryKey.SetValue(\"AppTaskbar\", t_exeName);\n        }\n        else\n        {\n            registryKey.DeleteValue(\"AppTaskbar\");\n        }\n    }\n    catch (Exception)\n    {\n        return;\n    }\n}\n</code></pre>\n\n<p>and it is placed in the Install function which is overridden in the Installer Class of the App in mind. </p>\n\n<pre><code>public override void Install(IDictionary stateSaver)\n{\n    base.Install(stateSaver);\n    System.Diagnostics.Debugger.Break();\n\n    RegisterInStartup(true);\n    StartApp();\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","sorting","observablecollection"],"answer_count":8,"favorite_count":2,"up_vote_count":16,"down_vote_count":0,"view_count":24908,"score":16,"question_id":1945461,"title":"How do I sort an observable collection?","body":"<p>I have a following class :</p>\n\n<pre><code>[DataContract]\npublic class Pair&lt;TKey, TValue&gt; : INotifyPropertyChanged, IDisposable\n{\n    public Pair(TKey key, TValue value)\n    {\n        Key = key;\n        Value = value;\n    }\n\n    #region Properties\n    [DataMember]\n    public TKey Key\n    {\n        get\n        { return m_key; }\n        set\n        {\n            m_key = value;\n            OnPropertyChanged(\"Key\");\n        }\n    }\n    [DataMember]\n    public TValue Value\n    {\n        get { return m_value; }\n        set\n        {\n            m_value = value;\n            OnPropertyChanged(\"Value\");\n        }\n    }\n    #endregion\n\n    #region Fields\n    private TKey m_key;\n    private TValue m_value;\n    #endregion\n\n    #region INotifyPropertyChanged Members\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected void OnPropertyChanged(string name)\n    {\n        PropertyChangedEventHandler handler = PropertyChanged;\n        if (handler != null)\n        {\n            handler(this, new PropertyChangedEventArgs(name));\n        }\n    }\n\n    #endregion\n\n    #region IDisposable Members\n\n    public void Dispose()\n    { }\n\n    #endregion\n}\n</code></pre>\n\n<p>Which I've put in an ObservableCollection :</p>\n\n<pre><code>ObservableCollection&lt;Pair&lt;ushort, string&gt;&gt; my_collection = \n    new ObservableCollection&lt;Pair&lt;ushort, string&gt;&gt;();\n\nmy_collection.Add(new Pair(7, \"aaa\"));\nmy_collection.Add(new Pair(3, \"xey\"));\nmy_collection.Add(new Pair(6, \"fty\"));\n</code></pre>\n\n<p>Q : How do I sort it by key ?</p>\n"},{"tags":["c#"],"answer_count":6,"favorite_count":25,"up_vote_count":57,"down_vote_count":0,"view_count":33886,"score":57,"question_id":2082615,"title":"Pass Method as Parameter using C#","body":"<p>I have several methods all with the same signature (parameters and return values) but different names and the internals of the methods are different.  I want to pass the name of the method to run to another method that will invoke the passed in method.</p>\n\n<pre><code>public int Method1(string)\n{\n    ... do something\n    return myInt;\n}\n\npublic int Method2(string)\n{\n    ... do something different\n    return myInt;\n}\n\npublic bool RunTheMethod([Method Name passed in here] myMethodName)\n{\n    ... do stuff\n    int i = myMethodName(\"My String\");\n    ... do more stuff\n    return true;\n}\n\npublic bool Test()\n{\n    return RunTheMethod(Method1);\n}\n</code></pre>\n\n<p>This code does not work but this is what I am trying to do.  What I don't understand is how to write the RunTheMethod code since I need to define the parameter.</p>\n"},{"tags":["c#","jquery","asp.net","html","defaultbutton"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13256517,"title":"Set default button inside div - but I don't know ID / class","body":"<p>I have a page where user controls are loaded dynamically into a div/panel. I don't know anything about the content of these user controls, besides they have a button. </p>\n\n<p>When the user is inside this div / panel (using the user control), I want the button inside the div/panel, to be the default button.\nRight now, my sidewide search button is the default button no matter what.</p>\n\n<p>I can't add \"defaultButton=mybutton\" in the user controls, and I can't add a class to the buttons. </p>\n\n<p>How do I solve the problem?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["c#",".net","ado.net","odbc","prepared-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13257401,"title":"C# Prepared Statement and multiple queries","body":"<p>Is it possible to execute multiple queries with the same prepared statement (same <code>OdbcCommand</code> object)?</p>\n\n<p>Below is the code I have and is throwing the following exception: <code>System.Data.Odbc.OdbcException was caught\n  Message=ERROR [07006] [IBM][CLI Driver] CLI0102E  Invalid conversion. SQLSTATE=07006</code></p>\n\n<pre><code> ...\n        odbcConnection = myConnection.getOdbcConnection();\n        odbcConnection.Open();\n        odbcCommand = odbcConnection.CreateCommand();\n        odbcTrans = odbcConnection.BeginTransaction(IsolationLevel.ReadCommitted);\n        odbcCommand.Transaction = odbcTrans;\ntry{\n    odbcCommand.CommandText = queryStatement1();\n            odbcCommand.Parameters.AddWithValue(\"?ID1\", parameter1);\n            odbcCommand.Parameters.AddWithValue(\"?ID2\", parameter2);\n    ...\n    odbcCommand.Parameters.AddWithValue(\"?ID11\", parameter3);\n    odbcCommand.Prepare();\n            odbcCommand.ExecuteNonQuery();\n\n\n    odbcCommand.CommandText = queryStatement2();\n    odbcCommand.Parameters.AddWithValue(\"?ID1\", parameter4);\n            odbcCommand.Parameters.AddWithValue(\"?ID2\", parameter5);\n    ...\n    odbcCommand.Parameters.AddWithValue(\"?ID13\", parameter6);\n    odbcCommand.Prepare();\n            odbcCommand.ExecuteNonQuery();\n    odbcTrans.Commit();\n} catch(Exception e){ ... }\n...\n</code></pre>\n\n<p>Same <code>OdbcCommand</code> object, two different queries...</p>\n"},{"tags":["c#",".net","itextsharp","syntax-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13238708,"title":"Trying to debug some iTextSharp code that is designed to convert an web page into a PDF document via a string variable","body":"<p>I am stuck trying to debug some code that is designed to convert an web page into a PDF document via a string variable.  It uses the iTextSharp c# tool (xmlworker) and is a modification of the example code that comes with the sourceforge source code called html2pdf.csproj.  This example code converts an existing html file into a PDF file and saves it in the same directory as the file that was converted.  I have a string variable containing html formatted text and I am trying to make it able to be returned as a byte array that will be passed to the client side in a web environment for printing purposes.  The problem is that I get an \"IOException was unhandled by user code\" message that states \"The document has no pages.\"  I'm a little unsure what this is suppose to mean, nor how to go about diagnosing the problem.  The example code using the file based system works and I have successfully converted a static version of the html string to PDF.  Below is the modified code:</p>\n\n<pre><code>       private byte[] createPDF(string html, string filename) {\n            MemoryStream msOutput = new MemoryStream();\n            string printPDFCSS = Server.MapPath(\"/content/printPDF.css\");\n            Document doc = new Document(PageSize.LETTER);\n            doc.SetMargins(doc.LeftMargin, doc.RightMargin, 35, 0);\n            PdfWriter pdfWriter = PdfWriter.GetInstance(doc, msOutput);\n\n            doc.Open();\n            Dictionary&lt;String, String&gt; substFonts = new Dictionary&lt;String, String&gt;();\n            substFonts[\"Arial Unicode MS\"] = \"Helvetica\";\n            CssFilesImpl cssFiles = new CssFilesImpl();\n            cssFiles.Add(XMLWorkerHelper.GetCSS(new FileStream(printPDFCSS, FileMode.Open)));\n            StyleAttrCSSResolver cssResolver = new StyleAttrCSSResolver(cssFiles);\n            HtmlPipelineContext hpc = new HtmlPipelineContext(new CssAppliersImpl(new UnembedFontProvider(XMLWorkerFontProvider.DONTLOOKFORFONTS, substFonts)));\n            hpc.SetImageProvider(new ImageProvider(filename));\n            hpc.SetAcceptUnknown(true).AutoBookmark(true).SetTagFactory(Tags.GetHtmlTagProcessorFactory());\n            HtmlPipeline htmlPipeline = new HtmlPipeline(hpc, new PdfWriterPipeline(doc, pdfWriter));\n            IPipeline pipeline = new CssResolverPipeline(cssResolver, htmlPipeline);\n            XMLWorker worker = new XMLWorker(pipeline, true);\n            XMLParser xmlParse = new XMLParser(true, worker);\n            xmlParse.Parse(msOutput);\n            doc.Close();\n            return msOutput.ToArray();\n        }\n</code></pre>\n"},{"tags":["c#","wcf","serialization","datacontract"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13257301,"title":"WCF - Entity framework, generated entities serialization error","body":"<p>I'm new to WCF and today I have encountered a problem with DataContracts. I'm getting exception when objects are returned to client from WCF Service.</p>\n\n<p>SvcTraceViewer shows the next exception:</p>\n\n<blockquote>\n  <p><strong>Type</strong>\n  'System.Data.Entity.DynamicProxies.Person_7C797A477DD73534D4E8E743E1FCC1C75DAB75933D03B845A097A8B83F2DD748'\n  <strong>with data contract name</strong>\n  'Person_7C797A477DD73534D4E8E743E1FCC1C75DAB75933D03B845A097A8B83F2DD748:http://schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies'\n  <strong>is not expected.</strong> Consider using a DataContractResolver or add any\n  types not known statically to the list of known types - for example,\n  by using the KnownTypeAttribute attribute or by adding them to the\n  list of known types passed to DataContractSerializer.</p>\n</blockquote>\n\n<p>I have several projects in solution.</p>\n\n<ul>\n<li>DataAccess (EntityFramework EDMX file is placed here)</li>\n<li>Model (Entities generated by DbContextGenerator are here)</li>\n<li>WCF Service (DataContracts are implemented in <code>Model</code> project)</li>\n<li>WPF Application (runs ServiceHost)</li>\n<li>Console Application (calls WCF project or service hosted in WPF Application)</li>\n</ul>\n\n<p>Here is operation contract in WCF:</p>\n\n<pre><code>[OperationContract]\nPerson[] GetAllPersons(int version);\n</code></pre>\n\n<p>interface implementation:</p>\n\n<pre><code>public Person[] GetAllPersons(int version)\n{\n    return StorageService.GetAllPersons(version);\n}\n</code></pre>\n\n<p>The excepion is thrown when the data is recieved on the client side (ConsoleApp).</p>\n\n<p>I guess the problem is related to generated entities, because they are partial classes</p>\n\n<p>Here is Person class:</p>\n\n<pre><code>public partial class Person\n{\n    public Person()\n    {\n        this.Project = new HashSet&lt;Project&gt;();\n    }\n\n    public int Id { get; set; }\n    public Nullable&lt;long&gt; AddressId { get; set; }\n    public string LastName { get; set; }\n    public string MiddleName { get; set; }\n    public string FirstName { get; set; }\n    public Nullable&lt;long&gt; GeoLocationId { get; set; }\n    public string FullGeoLocationName { get; set; }\n    public Nullable&lt;long&gt; SupervisorId { get; set; }\n    public Nullable&lt;long&gt; PositionId { get; set; }\n    public string Position { get; set; }\n    public string Office { get; set; }\n    public string NativeName { get; set; }\n    public string Location { get; set; }\n    public string FullName { get; set; }\n    public Nullable&lt;long&gt; PmcPersonId { get; set; }\n\n    public virtual ICollection&lt;Project&gt; Project { get; set; }\n    public virtual PersonDataVersion DataVersion { get; set; }\n    public virtual Workspace Workspace { get; set; }\n}\n</code></pre>\n\n<p>I tried to mark class and it's members with <code>[DataContract]</code> and <code>[DataMember]</code> attributes, but error still happens. <code>[KnownType(typeof(Person)]</code> attribute also didn't help.</p>\n\n<p>Is it possible to use generated entities as data contracts?</p>\n"},{"tags":["c#","parsing","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13236777,"title":"Allow null value when parsing file to datatable","body":"<p>Parsing a file into a datable how do I allow it to add a null value if for say their is no value for that row in the csv file?     </p>\n\n<pre><code>string fileName = @\".csv\";\n\nusing (StreamReader stream = new StreamReader(fileName))\n{\n\n    DataTable dt = CsvParser.Parse(stream);\n\n    foreach (DataRow row in dt.Rows)\n    {\n        try\n        {\n            string lname = Convert.ToString(row[0].ToString().Trim());\n            string fname = Convert.ToString(row[1].ToString().Trim());\n            long s = Convert.ToInt64(row[2]);\n            string b = Convert.ToString(row[3]);\n            rec = row[0].ToString() + \",\" +\n                    row[1].ToString() + \",\" +\n                    row[2].ToString() + \",\" +\n                    row[3].ToString() + \",\";\n            write.WriteLine(rec);\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["c#","lambda"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":249,"score":3,"question_id":5573838,"title":"How to avoid variable capturing in lambda expression?","body":"<p><br>\nLately I've read C# in Depth and it taught me about lambda expression, I've been using them to pas data to click events and such like:</p>\n\n<pre><code>image.MouseDown+=(o ,e)=&gt;MethodToDoSomething(DataNeededForAction);\n</code></pre>\n\n<p>now the problem with those is variable capturing when used in a foreach loop (thank you Jon Skeet for making that part really clear :), when initializing several objects that have events that I subscribe to I usually bump into an issue with variable capturing. consider the following example:</p>\n\n<pre><code>foreach (var game in GamesCollection)\n{\n    Image img = new Image();\n    img.Width = 100;\n    img.MouseDown+=(o,e) =&gt; MyMethod(game.id);\n}\n</code></pre>\n\n<p>To avoid capturing in this situation I have to add some variable to assign game to and then pass that variable to the method, this creates extra unclear code and mostly, additional clutter.\nIs there a way to bypass this? Something that'll at least look cleaner?</p>\n\n<p>Thx, Ziv</p>\n"},{"tags":["c#","xml","windows-phone-7.1"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13257642,"title":"Read XML file from a file using C#","body":"<p>I have a xml file with this structure. The node \"settings\" is repeated only 1 time. The node \"Reminders\" can appear + 1 time.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--Name App--&gt;\n&lt;AllSettings&gt;\n  &lt;Settings&gt;\n    &lt;tax1&gt;21&lt;/tax1&gt;\n    &lt;tax2&gt;0&lt;/tax2&gt;    \n  &lt;/Settings&gt;\n  &lt;Reminders&gt;\n    &lt;Name&gt;s8&lt;/Name&gt;\n    &lt;Title&gt;xxxxx&lt;/Title&gt;\n    &lt;Content&gt;xxxxxxxxx&lt;/Content&gt;\n    &lt;BeginTime&gt;09/11/2012 10:00:00&lt;/BeginTime&gt;\n  &lt;/Reminders&gt;\n  &lt;Reminders&gt;\n    &lt;Name&gt;s2&lt;/Name&gt;\n    &lt;Title&gt;zzzzzzzzz&lt;/Title&gt;\n    &lt;Content&gt;zzzzzzzzzzz&lt;/Content&gt;\n    &lt;BeginTime&gt;07/11/2012 13:00:00&lt;/BeginTime&gt;    \n  &lt;/Reminders&gt;  \n&lt;/AllSettings&gt;\n</code></pre>\n\n<p>I can read data in \"settings\" node using the bottom code. But how I can read the data from each node \"reminders\"?</p>\n\n<pre><code>IsolatedStorageFileStream isoFileStream = myIsolatedStorage.OpenFile(myXmlFile, FileMode.Open);\nisoFileStream.Position = 0;\nXmlReader xmlReader;\nxmlReader = XmlReader.Create(isoFileStream);                                           \nxmlReader.MoveToContent(); \n\nwhile (xmlReader.Read())\n{    \n\n  if (xmlReader.NodeType == XmlNodeType.Element &amp;&amp; xmlReader.LocalName == \"Settings\"\n  {\n     while (xmlReader.NodeType != XmlNodeType.EndElement)\n     {\n          xmlReader.Read();\n\n          if (xmlReader.Name == \"tax1\")\n          {\n                _tax1 = xmlReader.ReadElementContentAsString();\n          }\n          else if (xmlReader.Name == \"tax2\")\n          {\n                _tax2 = xmlReader.ReadElementContentAsString();\n          }\n\n      } // end while\n  } \n  else if (xmlReader.NodeType == XmlNodeType.Element &amp;&amp; xmlReader.LocalName == \"Reminders\")\n  {\n       // ????            \n  }\n\n} // end while\n</code></pre>\n"},{"tags":["c#","winforms","listview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":11230123,"title":"ListView Autosize based on whether or not contents exist","body":"<p>I have a <code>ListView</code> with a view of <code>View.Details</code> and I want to AutoSize the columns. I am aware of the <code>ColumnHeader</code>'s <code>AutoResize</code> method and currently I'm just iterating through them like so:</p>\n\n<pre><code>var lMode = ( listView.Items.Count == 0 ) ? ColumnHeaderAutoResizeStyle.HeaderSize : ColumnHeaderAutoResizeStyle.ColumnContent;\nforeach ( ColumnHeader lColumnHeader in listView.Columns )\n{\n    lColumnHeader.AutoResize(lMode);\n}\n</code></pre>\n\n<p>The problem with this technique is that if I have a column which happens to have no data in it, the width gets set to a point the header is no longer available. Is there a nice way of conditionally setting the <code>ColumnHeaderAutoResizeStyle</code> based on whether or not there are contents in the column?</p>\n\n<p>If there is something in the column I want to use <code>ColumnHeaderAutoResizeStyle.ColumnContent</code>, but if there is nothing in the column, I want to use <code>ColumnHeaderAutoResizeStyle.HeaderSize</code>.</p>\n"},{"tags":["c#","asp.net","code-generation","roslyn"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13034989,"title":"How to change code behind implementation in asp.net","body":"<p>I am exploring possible implementation of roslyn framework as a dynamic code generator for asp.net . So far, it looks amazing. At the moment I am stuck at generating code behind implementation for asp.net page (web application). I have managed to create an assembly, which contains both page.design.cs and page.aspx.cs code, but I do not know how to link the result to the existing .aspx page (this scenario worked well when I set the code behind in (one) separate class within my project, and in <code>Inherit</code> attribute I set the namespace.class_name to it). I have changed the <code>Inhertit</code> attribute to point to class, which is the result of the roslyn code generation. However, this does not seem to work, since (I guess) the .aspx page is expecting code behind instance to be available at compile time, but I am trying to supply this definition at runtime. </p>\n\n<p>Is there any way I can trick the .aspx to think that it has code behind definition, which I can supply at runtime, and how can I link my custom code behind class with .aspx page?</p>\n\n<p>Best regards.</p>\n"},{"tags":["c#","enums"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13257941,"title":"Is it wise to define a \"catchall\" for a flags-type enum?","body":"<p>I have an <code>enum</code> that is declared in the following manner (but with more options - about 15 or so) since I wanted an easy way to define all options without having to explicitly list them.</p>\n\n<pre><code>[Flags]\nenum Options\n{\n    Option1 = 1,\n    Option2 = 2,\n    Option3 = 4,\n    Option4 = 8,\n    AllOptions = 15\n}\n</code></pre>\n\n<p>So that instead of saying</p>\n\n<pre><code>Options foo = Options.Option1 | Options.Option2 | Options.Option3 |... ad nauseum\n</code></pre>\n\n<p>I can just say</p>\n\n<pre><code>Options foo = Options.AllOptions;\n</code></pre>\n\n<p>Is this wise? Or is there perhaps a better way to give a variable all available options without explicitly having to list them?</p>\n"},{"tags":["c#","windows-7","camera"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":77,"score":-1,"question_id":12913917,"title":"capture images from usb camera in windows 7 using c#","body":"<p>Well i noticed that Microsoft seams to try to drop WIA \nThere are tricks around it (downloading dll's register them etc)\nBut i wonder if i like to grab pictures fast over USB\nWhat would the 'official' Microsoft way now be these days ?\nI'm using windows 7 and visual studio express 2010</p>\n\n<p>Perhaps you can hint me some code suggestion if possible, or articles about it.</p>\n"},{"tags":["c#","winforms"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13257590,"title":"PrintpreviewDialog document fail to send printer?","body":"<p>I have a strange problem.  My print document appears in printprieviewdialoge but after clicking on print icon I am getting blank paper by printer.\nIs there problem of PrintPriviewDialoge?\nIf I send document to printer before getting in showdialog it works but after showdialog does not print.</p>\n\n<pre><code>for (int i = 0; i &lt; caixasFiscais.Count; i++)\n{\nCaixaECF caixa = new CaixaECF(loja, caixasFiscais[i], data1, data2);\nposicaoDaLinha = margemSup + (linhaAtual * Convert.ToInt32(fonteNormal.GetHeight(e.Graphics)));\ne.Graphics.DrawLine(new Pen(Brushes.LightSteelBlue, 30), margemEsq, posicaoDaLinha, margemDir, posicaoDaLinha);\ne.Graphics.DrawString(\"CAIXA FISCAL \" + caixa.numero, fonteNegrito, Brushes.Black, margemEsq, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"CREDITOS\", fonteNegrito, Brushes.Black, margemEsq + 150, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"DEBITOS\", fonteNegrito, Brushes.Black, margemEsq + 350, (posicaoDaLinha - 5.5f), new StringFormat());\ne.Graphics.DrawString(\"GAVETA\", fonteNegrito, Brushes.Black, margemEsq + 550, (posicaoDaLinha - 5.5f), new StringFormat());\nlinhaAtual++;}\n</code></pre>\n\n<p>i also tried to save as pdf file but same not saving data. but printpreviewdialog showing absolutely well report.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":76,"score":1,"question_id":13257109,"title":"get single out parameter","body":"<p>I have this C# function: </p>\n\n<pre><code>Fct( double [] x, out double a, out double b, out double c) \n{\n    // ***\n}\n</code></pre>\n\n<p>I proceed as follows to get the value of <code>a</code>:</p>\n\n<pre><code>double a , b, c;\nFct( myArray, out a, out b, out c) \n</code></pre>\n\n<p>How can I access <code>a</code> without having to define <code>b</code> and <code>c</code>?</p>\n"},{"tags":["c#","multithreading","wcf","socket-timeout-exception"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":110,"score":3,"question_id":12977580,"title":"Starting multiple services on threads","body":"<p>I am trying to open a proxy on a thread (in background), the thread makes a new instance of the proxy, calls a method of the service and immediately after disposes the service.</p>\n\n<p>All of this happens on a thread :</p>\n\n<pre><code>var background = new Thread(() =&gt;\n{\n    var proxy = new AssignmentSvcProxy(new EndpointAddress(worker.Address));              \n\n    try\n    {\n        proxy.Channel.StartWork(workload);\n        proxy.Dispose();                   \n    }\n    catch (EndpointNotFoundException ex)\n    {\n        logService.Error(ex);                        \n        proxy.Dispose();\n        proxy = null;\n    }\n    catch (CommunicationException ex)\n    {\n        logService.Error(ex);\n        proxy.Dispose();\n        proxy = null;\n    }\n    catch (TimeoutException ex)\n    {\n        logService.Error(ex);                    \n        proxy.Dispose();\n        proxy = null;\n    }\n    catch (Exception ex)\n    {\n        logService.Error(ex);                    \n        proxy.Dispose();\n        proxy = null;\n    }                \n\n}) { IsBackground = true };\n\nbackground.Start();\n</code></pre>\n\n<p>I keep seeing intermittent timeout issues happening even though I have set the timeout to max for CloseTimeout, OpenTimeout, ReceiveTimeout, SendTimeout.</p>\n\n<p>I just want to make sure design wise this is not an issue i.e. opening a service on a thread and disposing it?</p>\n\n<p>EDIT :</p>\n\n<p>Proxy internally establishes a channel with custom binding on different endpoints for each thread.</p>\n"},{"tags":["c#","httpwebrequest"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":11713,"score":3,"question_id":702079,"title":"Why Does my HttpWebRequest Return 400 Bad request?","body":"<p>The following code fails with a 400 bad request exception. My network connection is good and I can go to the site but I cannot get this uri with HttpWebRequest.</p>\n\n<pre><code>private void button3_Click(object sender, EventArgs e)\n{\n    WebRequest req = HttpWebRequest.Create(@\"http://www.youtube.com/\");\n    try\n    {\n        //returns a 400 bad request... Any ideas???\n        WebResponse response = req.GetResponse();\n    }\n    catch (WebException ex)\n    {\n        Log(ex.Message);                \n    }\n}\n</code></pre>\n"},{"tags":["c#","java","stream","network-programming","protocol-buffers"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":97,"score":1,"question_id":13068767,"title":"Google protocol buffers-Sending a message form C# client to a java Server","body":"<p>The Client sends a 1481 bytes array.\nThe server can read all the 1481 bytes message without any problems but by parsing the given messsage from the received binary array i get this <strong>exeption</strong>:</p>\n\n<p><code>\ncom.google.protobuf.InvalidProtocolBufferException: Protocol message contained an invalid tag (zero).\n</code></p>\n\n<p>The binary data is the same. I checked that I am using the right version of the proto files. I am a bit at a loss tbh. Any help appreciated.</p>\n\n<p><strong>Code</strong></p>\n\n<p><code>byte [] data= IOUtils.toByteArray(br1, \"ASCII\");\nSystem.out.println(\"SIZE:\" + data.length);<br>\nAddressBook adb1 = AddressBook.parseFrom(data);         System.out.println(\"Server: Addressbook:\" + adb1.getPersonCount());         System.out.println(\"Server: Addressbook:\" + adb1.getPerson(0).getName());</code></p>\n\n<p><strong>Question:</strong></p>\n\n<p>I need to find a way to correctly parse the received Adressbook msg from the read 1481 bytes arry.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","visual-studio","debugging","breakpoints"],"answer_count":6,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":2509,"score":15,"question_id":5744506,"title":"A curious case of Visual Studio 2010 debugger(it can not hit a break point)","body":"<p>A curious case of Visual Studio 2010 debugger(it can not hit a break point)</p>\n\n<p>This is the code that reproduces the problem:</p>\n\n<pre><code>class Program {\n  static void Main(string[] args) {\n    bool b = false;\n\n    if (b) {\n        List&lt;string&gt; list = new List&lt;string&gt;();\n        foreach (var item in list) {\n\n        }\n    } else {\n        Console.WriteLine(\"1\");\n    }\n    Console.WriteLine(\"2\");//add a break point here in VS2010\n  }\n  //1. configuration: release\n  //2. platform target: x64 or Any Cpu\n  //3. debug info: pdb only or full\n  //4. OS: Win7 x64\n  //5. optimize code: enabled\n}\n</code></pre>\n\n<p>Add a break point to the last statement of the code, then debug it in vs2010, you'll see that the break point can not be hit.</p>\n\n<p>To reproduce this curious case, you'll need to meet the following conditions:</p>\n\n<ol>\n<li>Operation system: windows 7 x64;</li>\n<li>VS build configuration: release;</li>\n<li>VS build platform target: x64 or Any Cpu;</li>\n<li>VS build debug info: pdb only or full;</li>\n<li>VS build optimize code: enabled;</li>\n</ol>\n\n<p>I am not sure those conditions are sufficient to reproduce it, but it's how my machine was configured when I found this issue.</p>\n\n<p>Why is the debugger not able to hit the break point?</p>\n\n<p>Thanks in advance!</p>\n\n<p>And if you can reproduce this issue, please consider voting on <a href=\"http://connect.microsoft.com/VisualStudio/feedback/details/664400/a-curious-case-of-visual-studio-2010-debugger-it-can-not-hit-a-break-point#tabs\" rel=\"nofollow\">this post.</a></p>\n"},{"tags":["c#","asp.net","entity-framework","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13257097,"title":"What is EF Templated Code Generation used for?","body":"<p>I've seen several <a href=\"http://geekswithblogs.net/iupdateable/archive/2009/11/19/getting-started-with-entity-framework-4---templated-code-generation.aspx\" rel=\"nofollow\">examples</a> / tutorials of using Entity Framework with Templated Code Generation.</p>\n\n<p>What is this tool doing? Is creating a new DataContext and a new set of EntityObjects? or is replacing the old ones? Why you will use a Code Generation instead of working directly with the ones created by the designer?</p>\n"},{"tags":["c#","asp.net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13257454,"title":"Get enum index from string","body":"<p>How can I get the index integer (in this case 0) from an enum when I have a string to compare against the enum?</p>\n\n<p>Enum:</p>\n\n<pre><code>public enum Animals\n{\n    Dog = 0,\n    Cat = 1\n}\n\nstring myAnimal = \"Dog\";\n</code></pre>\n\n<p>Obviously the following line won't work but it might help you to understand what I want to achieve:</p>\n\n<pre><code>int animalNumber = (int)Animals.[myAnimal];\n</code></pre>\n"},{"tags":["c#","twitter","twitter-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13257730,"title":"twitter api v. 1.1 search query not working using C# wrapper (twitterizer)","body":"<p>I am modifying twitterizer version 1.0 to be compatible with recent twitter api v. 1.1.</p>\n\n<p>while modifying and testing I got stuck with twitter api 1.1 search</p>\n\n<pre><code>https://api.twitter.com/1.1/search/tweets.json\n</code></pre>\n\n<p>I am using twitterizer v. 1.0.</p>\n\n<p>Has anybody successfully called the above url and got json back? </p>\n"},{"tags":["c#","arrays","string"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":82,"score":0,"question_id":13257458,"title":"Check if a value is in an array (C#)","body":"<p>How do I check if a value is in an array in C#?</p>\n\n<p>Like, I want to create an array with a list of printer names.</p>\n\n<p>These will be fed to a method, which will look at each string in turn, and if the string is the same as a value in an array, do that action.</p>\n\n<p>For example:</p>\n\n<pre><code>string[] printer = {\"jupiter\", \"neptune\", \"pangea\", \"mercury\", \"sonic\"};\nforeach (p in printer)\n{\n   PrinterSetup(p);\n\n}\n</code></pre>\n\n<p>These are the names of the printers, they are being fed to the PrinterSetup method.</p>\n\n<p>PrinterSetup will look sorta like this (some pseudocode):</p>\n\n<pre><code>public void PrinterSetup(printer)\n{\n   if (printer == \"jupiter\") \n   {\n      Process.Start(\"BLAH BLAH CODE TO ADD PRINTER VIA WINDOWS EXEC\"\");\n   }\n}\n</code></pre>\n\n<p>How do I format <code>if (printer == \"jupiter\") {</code> in a way that C# can recognize?</p>\n"},{"tags":["c#","tiff","aforge"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12823072,"title":"C# Altering TIFF Photometric Interpretation","body":"<p>I have the following method that resizes an image and returns the newly resized image as a TIFF (I am using the AForge library which is where the ResizeBilinear object comes from). </p>\n\n<pre><code>private System.Drawing.Image shrinkImageBilinear(System.Drawing.Image original, float newWidthInches, float newHeightInches)\n    {\n        float imageProportion = (float)original.Width / (float)original.Height;\n        float newWidthPixels = original.HorizontalResolution * newWidthInches;\n        float newHeightPixels = newWidthPixels / imageProportion;\n\n        ResizeBilinear filter = new ResizeBilinear((int)newWidthPixels, (int)newHeightPixels);\n        Bitmap image = new Bitmap(original);\n        image = filter.Apply(image);\n        Rectangle imageRect = new Rectangle(0, 0, image.Size.Width, image.Size.Height);\n        image = image.Clone(imageRect, PixelFormat.Format1bppIndexed);\n\n        MemoryStream byteStream = new MemoryStream();\n        image.SetResolution(200, 200);\n\n        image.Save(byteStream, ImageFormat.Tiff);\n\n        Image returnImage = System.Drawing.Image.FromStream(byteStream);\n        return returnImage;\n    }\n</code></pre>\n\n<p>The specification that I need to write to is that the Photometric Interpretation in the TIFF header cannot leverage a color palette, therefore the Photometric Interpretation can only be a 0 or 1, in this case it is a 3 since I am using PixelFormat.Format1bppIndexed. Another requirement in the spec I am writing to is that the image must be 1bpp.</p>\n\n<p>So my question is, how can I create this image without leveraging a color palette (thereby making the photometric interpretation a 1 or 0), maintaining 1bpp, keeping the resolution at 200 ppi and keeping the format as a TIFF?</p>\n"},{"tags":["c#","forms","overloading"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13257254,"title":"Overload invalid argument","body":"<p>Hi i'm brand new so don't judge to hard on my rookie question,</p>\n\n<pre><code>namespace Oef5_3_ShowIncome\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void Button_Click(object sender, EventArgs e)\n        {\n            int YearSalary = Convert.ToInt32(YearSalaryTextBox.Text);\n            int numberOfYears = Convert.ToInt32(numberOfYearsTextBox.Text);\n            ShowIncome(YearSalary, numberOfYears);\n            MessageBox.Show(\"something something \", Convert.ToString(ShowIncome)));\n        }\n\n        private int ShowIncome(int lalala, int dadada)\n        {\n            int results = lalala * dadada;\n            return results;\n        }\n    }\n}\n</code></pre>\n\n<p>in... MessageBox.Show(\"something something \"  Convert.ToString(ShowIncome)));\ni receive the following error: the best overloaded method match for windows.form.messagebox.show(string, string) has some invalid arguments.</p>\n"},{"tags":["c#"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":12,"view_count":83,"score":-11,"question_id":13257468,"title":"jumping from one function to another function C#","body":"<p>As the title states , I want to take the control from one point to another. if I want to do it in a single function , I may go with goto statement . but in this case the goto statement goes out of scope </p>\n\n<pre><code>public void function1()\n{\n//do something here \n//leave this function and control should goto function 2\n}\npublic void function2()\n{\n//do something here\n//control from function1 comes here \n//execute something\n}\n</code></pre>\n\n<p>is it possible in c# ? is there any way to handle this problem with try catch throw or some other concepts ?! </p>\n"},{"tags":["c#",".net","wpf","draggable","attachedbehaviors"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":121,"score":2,"question_id":13076056,"title":"Is there a good solution for a ItemsControl in WPF that can have its elements reordered by vertical drag and drop?","body":"<p>So here's the scenario I'm working with:</p>\n\n<p>I've got a priority list currently represented as an ItemsControl/ListView, bound to an observable collection of priority items.  I want to provide tightly visually constrained vertical dragging for element reordering.</p>\n\n<p>So, no drag adorners, no horizontal movement, only vertical movement.  When a list item moves past the midpoint of another item, it should \"swap positions\" through animation.  I am sure this can be done by working with mousedown/mousemove on the containers themselves, and I'm sure render transforms can be applied to do this, but my ideal solution would have two components to it:</p>\n\n<ol>\n<li><p>The functionality could be attached as a WPF interactions <a href=\"http://wpftutorial.net/Behaviors.html\" rel=\"nofollow\">behavior</a>.</p></li>\n<li><p>The system would be MVVM friendly and not require any significant code behind.</p></li>\n</ol>\n\n<p>Has this been done? Where can I find it?  If it hasn't how could I go about putting all the bits together in order to do this?</p>\n\n<p>EDIT: <strong>Bounty opened. Please direct questions to me via comments and I will reply as fast as possible.</strong></p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13257208,"title":"Create class instance with activationCustomData parameter","body":"<p>Want to create instance of a class with activation custom data. Like following:</p>\n\n<pre><code>var repo = Activator.CreateInstance(Type.GetType(repoFullName),\n                new string[] { connectionString }) as IRepository;\n</code></pre>\n\n<p>If I don't pass second parameter which is string array in CreateInstance method everything works fine, but with custom data parameter method throws the exception</p>\n\n<p>System.MissingMethodException: Constructor on type 'Namespase.MockRepository' not found.</p>\n\n<p>Public constructors of instantiated type </p>\n\n<pre><code>public MockRepository(string[] customData) {...}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>public MockRepository(Object[] customData) {...}\n</code></pre>\n\n<p>didn't change the effect. What do I do wrong?</p>\n"},{"tags":["c#","wpf","pdf","xps","print-preview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13255879,"title":"Creating print previews of documents","body":"<p>I need to create a software which will create print previews of the documents of following formats: the MS Office documents (<code>.doc(x)</code>, <code>.ppt(x)</code>, <code>.xls(x)</code>), images, <code>.txt</code> files and PDF files. I have made a working prototype using <code>XPS</code> files. So basically I do the following: I convert the office files to <code>.xps</code> using Office Automation and then I render the <code>.xps</code> documents to images. I simply create XPS files from images and <code>.txt</code> by adding text or an image to <code>FlowDocument</code>, then rendering it. But I have found out that there is no way to convert PDF to XPS fast (A document which has 600 pages takes more than 2 minutes to convert and this is totally not suitable). So I am stuck at this point. It seems that I should start over again, using the different file format. Should I rewrite my program using PDF, for example, or is there any other way to accomplish my task? And if I should use PDF, could you, please, suggest me a good PDF C# library to render previews of pages as fast as possible? I tried using <strong>Websupergoo's ABCPdf</strong>, but it is too slow, because it does not allow me to render the previews to <code>System.Windows.Media.Imaging.BitmapSource</code>, only <code>System.Drawing.Bitmap</code>, so I have to convert <code>Bitmap</code> to <code>BitmapSource</code> and it takes up a lot of time.<br>\nThanks in advance.</p>\n"},{"tags":["c#"],"answer_count":3,"favorite_count":4,"up_vote_count":14,"down_vote_count":2,"view_count":8269,"score":12,"question_id":3559821,"title":"how to convert IEnumerable to ObservableCollection?","body":"<p>how to convert IEnumerable to ObservableCollection?</p>\n"},{"tags":["c#","asp.net","frame-rate","aforge"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13083894,"title":"Changing Framerate & System.Threading Aforge.video C# ASP.NET","body":"<p>I have a small project whereby I capture images from a webcam and decode the qr.</p>\n\n<p>The following code captures an image and stores it to a local file, <em>but</em> only when it is not in the while loop. The system.threading appears to make the captured image just black. If i don't use it(the loop), it captures far too many images a second.</p>\n\n<p><strong>So is there a way of changing the aforge.video framerate so that i can capture an image every x seconds without while loop?</strong></p>\n\n<pre><code>   public partial class WebForm1 : System.Web.UI.Page\n{\n    public int FrameRate { get; set; }\n\n    private FilterInfoCollection VideoCaptureDevices;\n    private VideoCaptureDevice FinalVideo;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        inputDevices.Items.Clear();\n\n        VideoCaptureDevices = new FilterInfoCollection(FilterCategory.VideoInputDevice);\n        foreach (FilterInfo VideoCaptureDevice in VideoCaptureDevices)\n        {\n            inputDevices.Items.Add(VideoCaptureDevice.Name);\n        }\n        inputDevices.SelectedIndex = 0;     \n    }\n\n    public void Start_OnClick(object sender, EventArgs e)\n    {\n        FinalVideo = new VideoCaptureDevice(VideoCaptureDevices[inputDevices.SelectedIndex].MonikerString);\n        FinalVideo.NewFrame += new NewFrameEventHandler(FinalVideo_NewFrame);\n        FinalVideo.Start();\n    }\n    void FinalVideo_NewFrame(object sender, NewFrameEventArgs eventArgs)\n    {\n        int i = 0;\n        while (i &lt; 10)\n        {\n            Bitmap video = (Bitmap)eventArgs.Frame.Clone();\n            video.Save(\"C:\\\\Users\\\\Wayneio\\\\Desktop\\\\image\\\\test\" + i + \".jpg\");\n            i++;\n            System.Threading.Thread.Sleep(5000);\n        }\n\n    }\n    public void Stop_OnClick(object sender, EventArgs e)\n    {\n        this.FinalVideo.Stop();\n    }\n}\n</code></pre>\n\n<p>Additionally I get this error when trying to stop the capture via the asp button:</p>\n\n<pre><code> Object reference not set to an instance of an object on this.FinalVideo.Stop();\n</code></pre>\n\n<p>Tried this to no avail:\n     ((VideoCaptureDevice)FinalVideo).DesiredFrameRate = 10;</p>\n"},{"tags":["c#","image-processing","opencv","aforge"],"answer_count":3,"favorite_count":6,"up_vote_count":20,"down_vote_count":0,"view_count":7244,"score":20,"question_id":749241,"title":"Differences between AForge and OpenCV","body":"<p>I am just learning about computer vision and C#. It seems like two prominent image processing libraries are <a href=\"http://opencv.willowgarage.com/wiki/\" rel=\"nofollow\">OpenCV</a> and <a href=\"http://code.google.com/p/aforge/\" rel=\"nofollow\">AForge</a>. What are some of the differences of the two?</p>\n\n<p>I am making a basic image editor in C# and while researching I have come across articles on both. But I don't really know why I would choose one over the other. I would like to eventually improve the app to include more advanced functions.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","asp.net","excel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13250769,"title":"Read Excel file from a set index","body":"<p>Is it possible to read a file from a set column \"eg <code>A2</code>\" and read the whole document?</p>\n\n<p>Current code:</p>\n\n<pre><code>(\"Select  * FROM [\" + excelSheet[i] + \"]\", excelConnection); \n</code></pre>\n"},{"tags":["c#","reflection","reflection.emit"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13236616,"title":"How do I emit a call to [mscorlib]System.Console::Write(char)?","body":"<p>I am currently emitting a call to <code>[mscorlib]System.Console::Write(char)</code> as follows:</p>\n\n<pre><code>ilg.EmitCall(OpCodes.Call,\n             typeof(Console).GetMethods().First(m =&gt;\n                 m.Name == \"Write\" &amp;&amp; m.GetParameters().Length == 1 &amp;&amp;\n                 m.GetParameters().Any(p =&gt; p.ParameterType == typeof(char))),\n             null);\n</code></pre>\n\n<p>But is there a <strong>cleaner way</strong> on how I can reference the <code>Console.Write(char)</code> method, possibly without actually iterating through the formal arguments?</p>\n"},{"tags":["c#","mongodb","moq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13257198,"title":"How would I use moq to test a MongoDB service layer?","body":"<p>I have a service layer between my app and the mongo database.</p>\n\n<p>I'm trying to build a unit test using moq \nI'm quite new to moq so I started with what I thought would be a trivial test.</p>\n\n<p>Code to test:</p>\n\n<pre><code>    public List&lt;BsonDocument&gt; GetAllSettings()\n    {\n        var collection = MongoDatabase.GetCollection&lt;BsonDocument&gt;(\"Settings\");\n        var query = from e in collection.AsQueryable()\n                    select e;\n\n        var settings = query.ToList();\n        return settings;\n    }\n</code></pre>\n\n<p>Where:\nSettings is a Collection \nMongoDatabase is a MongoDBDriver.MongoDatabase</p>\n\n<p>I've tried this as my test:</p>\n\n<pre><code>    [Test()]\n    public void GetAllSettingsTest()\n    {\n        //Arrange\n        BsonDocument doc01 = new BsonDocument();\n        BsonDocument doc02 = new BsonDocument();\n\n        var mongoDatabase = new Mock&lt;MongoDatabase&gt;();\n        var collection = new Mock&lt;MongoCollection&lt;BsonDocument&gt;&gt;();\n        mongoDatabase.Setup(f =&gt; f.GetCollection(MongoCollection.Settings)).Returns(collection.Object);\n        collection.Object.Insert(doc01);\n        collection.Object.Insert(doc02);\n\n        ILogger logger = new Logger();\n        DatabaseClient.DatabaseClient target = new DatabaseClient.DatabaseClient(logger);\n        target.MongoDatabase = mongoDatabase.Object;\n\n        MongoCursor&lt;BsonDocument&gt; cursor = collection.Object.FindAllAs&lt;BsonDocument&gt;();\n\n        List&lt;BsonDocument&gt; expected = cursor.ToList();\n        List&lt;BsonDocument&gt; actual;\n\n        //Act\n        actual = target.GetAllSettings();\n\n        //Assert\n        Assert.AreEqual(expected, actual);\n    }\n</code></pre>\n\n<p>I'm getting an error of \"Could not find a parameterless constructor\" at:</p>\n\n<p>mongoDatabase.Setup(f => f.GetCollection(MongoCollections.Settings)).Returns(collection.Object);</p>\n\n<p>The error refers to the MongoCollection object.  I didn't think it had a constructor.</p>\n\n<p>What can I do to get my test to run?</p>\n"},{"tags":["c#",".net","webclient","socks","webclient-download"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13122369,"title":"Use WebClient with socks proxy","body":"<p>Is there any way to use a socks proxy with <code>WebClient</code>? Specifically with the <code>DownloadString</code> method that it provides?<br>\nI don't want to use any third party stuff like privoxy,freecap whatever and I can't use commercial libraries like those from Chilkat. I tried using stuff from <a href=\"http://www.mentalis.org/\" rel=\"nofollow\">http://www.mentalis.org/</a> in fact I used their <code>WebRequest</code> implementation but they don't seem to have something similar for WebClient.</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13223917,"title":"Why does ShowDialogue() fire Close() when setting Visible = false in Show()?","body":"<p>When I set Visible = false in the show event of a Form shown with ShowDialogue() the form will automatically call it's close event.  I don't want to close the form...just hide it.  So I have to call Show() instead.  But, this doesn't block.  </p>\n\n<p>Why does setting Visible = false causes form close to fire with ShowDialogue()?  Is this a bug?</p>\n"},{"tags":["c#","wpf","binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13256687,"title":"wpf binding to another control property","body":"<p>so i have this usercontrol :</p>\n\n<pre><code>&lt;UserControl x:Class=\"Client.SpectrumSpace\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n             xmlns:my=\"clr-namespace:Client\" \n             mc:Ignorable=\"d\" d:DesignHeight=\"150\" d:DesignWidth=\"350\"&gt;\n    &lt;Canvas&gt;\n        &lt;Rectangle Width=\"350\" Height=\"150\" Fill=\"Transparent\" Stroke=\"White\" StrokeThickness=\"1\"&gt;\n            &lt;Rectangle.ContextMenu&gt;\n                &lt;ContextMenu Name=\"contextMenu\"&gt;\n                    &lt;MenuItem Name=\"ctxItem1\" Header=\"AntennaName\" \n                              IsEnabled=\"{Binding MainWindow.availeableAntennas[0]}\"/&gt;\n                &lt;/ContextMenu&gt;\n            &lt;/Rectangle.ContextMenu&gt;\n        &lt;/Rectangle&gt;\n    &lt;/Canvas&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>and as you can see im trying to bind the MainWindow.availableAntennas[0] property to the MenuItem.IsEnabled property</p>\n\n<p>this is how i declared the array on MainWindow class:</p>\n\n<pre><code>public  bool[]      availableAntennas   = new bool[9];\n</code></pre>\n\n<p>my problem is that the IsEnabled property is always true and yes i double checked the availeableAntennas[0] is false, so what am i doing wrong here?</p>\n"},{"tags":["c#","asp.net","asp.net-mvc","selenium","bdd"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13257306,"title":"Setup web server when using selenium webdriver c#","body":"<p>Im using selenium webdriver to make behavior tests on ASP.NET MVC application (C#).\nI want to have a server that will automatically open when I run those tests, like the IIS server which automatically runs when I debug my application.\nHow do I do that ?\nBTW, Im using the ChromeDriver if that matters.\nThanks.</p>\n"},{"tags":["c#","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13255718,"title":"Boolean Converter not hitting converter","body":"<p>I'm using a boolean converter in my XAML in a WPF project. I want to disable a few buttons while \"IsBusy\" is true. I am absolutely sure that IsBusy is being set to true/false properly. I am able to successfully bind directly to IsBusy without the converter. The following does not currently work. I've put breakpoints in the actual converter class and the \"Convert\" and \"ConvertBack\" methods are never hit. What is wrong here?</p>\n\n<pre><code>IsEnabled=\"{Binding IsBusy, Converter={StaticResource InvertedBooleanConverter}}\"\n</code></pre>\n\n<p>Resources:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;converters:InvertedBooleanConverter x:Key=\"InvertedBooleanConverter\" /&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>Converters:</p>\n\n<pre><code>xmlns:converters=\"clr-namespace:MyProject.Converters\"\n</code></pre>\n\n<p>The converter:</p>\n\n<pre><code>namespace MyProject.Converters\n {\n\n    [ValueConversion(typeof(bool), typeof(bool))]\n    public class InvertedBooleanConverter : IValueConverter\n    {\n        #region IValueConverter Members\n\n        public object Convert(object value, Type targetType, object parameter,\n            System.Globalization.CultureInfo culture)\n        {\n            if (targetType != typeof(bool))\n                throw new InvalidOperationException(\"The target must be a boolean\");\n\n            return !(bool)value;\n        }\n\n        public object ConvertBack(object value, Type targetType, object parameter,\n            System.Globalization.CultureInfo culture)\n        {\n            throw new NotSupportedException();\n        }\n\n        #endregion\n    }\n}\n</code></pre>\n"},{"tags":["c#","string","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13255733,"title":"Windows-1252 Encoding in StreamWriter return ANSI encoded file","body":"<p>I try to encode a string in Windows-1252 with a StreamWriter. The input string (dataString) is encode in UTF8.</p>\n\n<pre><code>StreamWriter sw = new StreamWriter(@\"C:\\Temp\\data.txt\", true, Encoding.GetEncoding(1252));\nsw.Write(dataString);\nsw.Close();\n</code></pre>\n\n<p>When I open the file in Notepad++ I get a ANSI file. I need a Windows-1252 encoded file.</p>\n\n<p>Someone have an idea?</p>\n"},{"tags":["c#","linq","clr"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13242762,"title":"Can I use LINQ to get all components of a certain type?","body":"<p>I'm fairly new to <code>C#</code> and got a bit of a problem that I'm sure has a good solution using LINQ.</p>\n\n<p><strong>Background:</strong>\nThere's a project I've inherited that uses CrystalReports, the reports themselves all have viewer-forms [containing components/controls] associated with them in a uniform way (I'm fairly sure they were machine generated), one of these is a component descended from <code>ReportClass</code> which contains a database property. The database property is the <strong>only</strong> thing that differentiates a method (<code>Log_On_Database</code>) that appears in all of these classes. What I would like to do is create a common base class that searches the form for <code>ReportClass</code> and uses that to populate its local database variable w/ the value from the property so I can implement <code>Log_On_Database</code> in a single location.</p>\n\n<p><strong>Question:</strong>\nHow does one use LINQ to get all of the <code>components</code> (not [just] controls) belonging to a form and recursively for those that <em>are</em> controls (and thus can have their own)? </p>\n\n<p><strong>NOTE:</strong> Getting the result in a <code>List</code> would be great, as I could then test for a length of 0 (something went horribly wrong), 1 (expected), or more (and then I could do what I need to on those odd cases) -- even if this is all generated code, I don't trust it to <em>not</em> have been modified in horrendously painful ways.</p>\n"},{"tags":["c#","isnull"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":77,"score":2,"question_id":13256992,"title":"How to make a IsNull() method","body":"<p>I'm trying to make a method similar to .ToString() that checks whether the object is null or not. I just done know how to make it accessible without calling the class</p>\n\n<pre><code>public class ObjectExtensions\n{\n    public static bool IsNull(object obj)\n    {\n        bool val = false;\n        if (obj == null)\n        { val = true; }\n        return val;\n    }\n}\n</code></pre>\n"},{"tags":["c#","c++","templates","template-meta-programming"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13257117,"title":"c# generics Turing-complete?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11984490/is-c-sharp-4-0-compile-time-turing-complete\">Is C# 4.0 compile-time turing complete?</a>  </p>\n</blockquote>\n\n\n\n<p>It is well-known that C++ template meta\"language\" is Turing-complete. I guess, C# (or Java) generics are not (i.e. you cannot write an arbitrary metaprogram using those).</p>\n\n<p>Has anybody proved that yet?</p>\n"},{"tags":["c#","string","comparison","boolean"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":96,"score":-1,"question_id":13256493,"title":"C# Can a comparison in a String value return a Boolean value. eg. \"5 < 10\" return true","body":"<p>Is there a way a comparison in a string value can return a <code>Boolean</code> value. Example.\nIf (5 > 5000) would obviously return a false value. But what i wanted to do is have the \"5 > 5000\" return a false value. </p>\n\n<p>Example.</p>\n\n<pre><code>string com = \"5 &gt; 10\";\n</code></pre>\n\n<p>so is there a way to make this <code>com</code> variable return a <code>false</code> value as if it was a comparison between integers. </p>\n"},{"tags":["c#","sharepoint2007","workflow","sharepoint-designer"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13254959,"title":"How to create a new sharepoint site based on a template after a new item is added to a List","body":"<p>the help that I need is to know how can I create a new sharepoint site based on a template after a new item is added to a list, for example I have the the sharepoint sita \"A\" with a list with info about projects, and the idea is that after I add a new project to that list, I need to create automatically a new sharepoint site(teamspace) for that project. Also I want to know if it is possible to create this using a workflow or maybe if I can call the webservice(c#) with the workflow.</p>\n"},{"tags":["c#","java","stream"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":13186848,"title":"\"StreamCorruptedException: invalid stream header\" when reading ObjectInputStream sent from C# client","body":"<p><strong>Problem</strong></p>\n\n<p>I'm trying to send a protobuf message from a C# client to this Java Server but I get this exception:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>java.io.StreamCorruptedException: invalid stream header: 0A290A08 \njava.io.StreamCorruptedException: invalid stream header: 0A290A08\n    at java.io.ObjectInputStream.readStreamHeader(Unknown Source)\n    at java.io.ObjectInputStream.&lt;init&gt;(Unknown Source)\n</code></pre>\n\n<p>I'm a bit at a loss to be honest. Any help is appreciated. Thanks!</p>\n\n<ul>\n<li><strong>Java server</strong></li>\n</ul>\n\n<pre class=\"lang-java prettyprint-override\"><code>    public ControllerThread(Socket s){\n    this.s = s; try {\n\n        this.objectInputStream = new ObjectInputStream(s.getInputStream());\n        byte size = objectInputStream.readByte();System.out.println(\"Server: BYTES SIZE:\" +     size);\n        byte[] bytes = new byte[size];\n        objectInputStream.readFully(bytes);\n        AddressBook adb = AddressBook.parseFrom(bytes);\n        System.out.println(\"Server: Addressbook:\" + adb.getPersonCount());\n\n    } catch (IOException e) { \n        System.out.println(\"Server: BufferedReader oder PrintWriter von ThermoClient konnte nicht erstellt werden\");\n        e.printStackTrace(); } \n        } }\n</code></pre>\n\n<p><strong>C# code</strong></p>\n\n<pre><code>public AddressBook InitializeAdressBook()\n{\n    Person newContact = new Person();\n\n    AddressBook addressBookBuilder = new AddressBook();\n    Person john = new Person();\n    //john.id=1234;\n    john.name=\"John Doe\";\n    john.email=\"jdoe@example.com\";\n    Person.PhoneNumber nr = new Person.PhoneNumber();\n    nr.number=\"5554321\";\n    john.phone.Add(nr);\n    addressBookBuilder.person.Add(john);\n    TextBox.Text += (\"Client: Initialisiert? \" + addressBookBuilder.ToString()) + \"\\t\" + \"\\n\";\n    TextBox.Text += \" Erster Person \" + addressBookBuilder.person.First().name + \"\\t\" + \"\\n\";\n\n    return addressBookBuilder; \n}\n</code></pre>\n\n<p><strong>c# OutputStream</strong></p>\n\n<pre><code>    public void SendMessage(Stream ns, byte[] msg)\n    {\n        byte size = (byte)msg.Length;\n\n        try\n        {\n            ns.WriteByte(size);\n            ns.Write(msg, 0, msg.Length);\n            ns.Flush();\n            ns.Close();\n        }\n        catch (ArgumentNullException ane)\n        {\n            TextBox.Text += \"ArgumentNullException : {0}\" + ane.ToString();\n        }\n        catch (Exception e)\n        {\n            TextBox.Text += (\"Unexpected exception : {0}\" + e.ToString());\n        }\n\n\n    }\n</code></pre>\n"},{"tags":["c#","sql-server"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13257037,"title":"C# function call never reaches first line of executable code, only on a particular pc","body":"<p>I have a piece of code that creates a new SQL-Server Express Database, and then runs a predefined table generation/population script.  Its a pretty straight forward and simple task, and the code works wonderfully under normal operations.  On one of our testing machines, this creation function stalls after creating the DB,  but before populating it.\nIt simply hangs with no error message, no deadlock (ui still responsive), and no CPU usage.  </p>\n\n<p>Further investigation and debugging determines that the line immediately before the LoadDatabaseTables() function call is executed, but the first line inside LoadDatabaseTables() is never reached. How exactly can a function be called, but then have the program fail to execute even the first line of the function?  </p>\n\n<p>The code in question is written in C#:</p>\n\n<pre><code>    ...snip...\n    bool success=false;\n    try\n    {\n        //...code that creates db, working as intended...\n    }\n    catch(Exception e)\n    {\n        //...error handling...\n    }\n    finally\n    {\n        //Params is a locally defined struct, containing int, bool, and string members\n        if(CreateScript(Params))  //generates appropriate script successfully, returns true\n        {\n            System.Windows.MessageBox.Show(\"About to enter load script\");\n            if(LoadDatabaseTables(Params))\n            {\n               success=true;\n            }\n        }\n    }\n    return success;\n}\n\nprivate bool LoadDatabaseTables(DatabaseParams Params)\n{\n    System.Windows.MessageBox.Show(\"Entered the load script\");\n    bool success = false;\n    Server server = null;\n    try\n    {\n        //...sql calls...\n        success = true;\n    }\n    catch (Exception ex)\n    {\n        //...exception handling...\n    }\n    return success;\n}\n...snip...\n</code></pre>\n\n<p>The first message \"About to enter load script\" is reached but the \"Entered the load script\" is not displayed, and the rest of the function does not execute, no exceptions are raised, nothing is returned.</p>\n\n<p>Unfortunately, this machine does not have the necessary tools/licenses to run full debugging, and the problem only occurs on this one machine.  The message boxes obviously are not included in the regular version of the code, and a just being used to attempt to diagnose the problem.  The code executes normally on other systems with and without these message boxes.</p>\n\n<p>Has anyone come across this kind of error before?  Any help would be most appreciated!</p>\n"},{"tags":["c#","javascript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13242504,"title":"Javascript Canvas in ASP.net","body":"<p>I’m trying to draw an image on a canvas in a Visual Studio application and then have that image get displayed on a PDF file after clicking a button.  I’m using javascript and C#.  So far I created a Web Page called “A” and in the .aspx page I created a canvas and button, but I’m unsure how I can get this image in the .aspx.cs page (where it says “<strong>Image Here</strong>”) so it can write to the PDF file.  I’m pretty sure my code currently puts my canvas image in base 64.  Any help is greatly appreciated.  Thanks!</p>\n\n<pre><code>//A.aspx:\n//Create canvas and save as base 64\n&lt;head&gt;\n&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function() {\n$('#saveButton').click(saveDrawing);\n});\n  &lt;/script&gt;  \n&lt;/head&gt;\n&lt;canvas id =\"canvas1\" class=\"pad\" width=\"198\" height=\"55\"&gt;&lt;/canvas&gt;\n  &lt;input type=\"button\" name=\"saveButton\" id=\"saveButton\" value=\"Save Drawing\"&gt;\n  &lt;script type=\"text/javascript\"&gt;\n      function saveDrawing() {\n          var canvas = document.getElementById(\"canvas1\");\n          var context = canvas.getContext(\"2d\");\n          var imgData = canvas.toDataURL();\n          //window.open(imgData);  //Not sure if I need this or not\n      }      \n&lt;/script&gt;\n\n\n//A.aspx.cs: Code Behind\n  public void Method(string A)\n {\nPdfStamper pdfStamper = new PdfStamper(pdfReader, new FileStream(newFile, FileMode.Create));\nAcroFields pdfForm = pdfStamper.AcroFields;\npdfForm.SetField(\"Picture is\", (**Image Here**)); //This is where I need to get the image from A.aspx\n         }\n</code></pre>\n"},{"tags":["c#","linq","dictionary","key","key-value"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13255426,"title":"C# .net 3.5+ Dictionary<string, string> key/value pair displaying value as default choice – MVC select list","body":"<p>I’m trying to figure out any way to retrieve certain elements of a particular class instance for use within a drop-down list that I’m attempting to perform some maintenance on. The goal is to select and assign all Contacts to a key/value pair string array (Contacts being a related entity of Company, specifically, a 1:n relationship - 1 company has multiple contacts) then selecting the first contact’s first and last name attributes out of the sequence where the Boolean class attribute, Primary, is set to True.  </p>\n\n<pre><code>public class Company \n{\n    public string Name { get; set; }\n    public virtual ICollection&lt;Contact&gt; Contacts { get; set; }\n}\n\npublic class Contact\n{\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n        public bool IsPrimary { get; set; }\n}\n</code></pre>\n\n<p>The following code:  </p>\n\n<pre><code>private Company CreateViewModel(Company company)\n{\n    var contacts = _contactService.CompanyContacts(company);\n\n}\n\npublic Dictionary&lt;string, string&gt; CompanyContacts(Company company)\n            {\n                    var results = new Dictionary&lt;string, string&gt;();\n\n                    foreach (var contact in company.Contacts)\n                    {\n                            var key = string.Format(\"{0} {1}|{2}\", contact.FirstName, contact.LastName, contact.IsPrimary());\n\n                            var val = string.Format(\"{0} {1}|{2}\", contact.FirstName, contact.LastName, contact.IsPrimary());\n\n                            if (results.ContainsKey(key)) continue;\n\n                            results.Add(key, val);\n                    }\n\n                    return results;\n            }\n\n    public void InitContactList(Dictionary&lt;string, string&gt; contacts)\n    {\n\n        var firstOrDefault = contacts\n            .Where(x =&gt; x.Key.Contains(\"true\"))\n            .Select(x =&gt; x.Value)\n            .FirstOrDefault();\n\n        var selectedContact = contacts.FirstOrDefault().Value;\n\n            if (firstOrDefault != null)\n            {\n                var selectedContact =  firstOrDefault;\n\n                ContactList = new SelectList(contacts, \"Key\", \"Value\")\n                .SelectByText(selectedContact.ToString()).ToList();\n            }\n\n            ContactList = new SelectList(contacts, \"Key\", \"Value\")\n                .SelectByText(selectedContact.ToString()).ToList();\n    }\n</code></pre>\n\n<p>doesn't display the first 'is primary' contact by default in the select-list though. I would like the first isPrimary=1 contact to be the first selection in the picklist. I’m pretty sure the firstOrDefault variable in the InitContactList needs to have the key do something other than .contains(“true”) Any help would be appreciated.\nThank you in advance.</p>\n"},{"tags":["c#","object","dictionary","boxing"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":72,"score":1,"question_id":13256844,"title":"Getting an object from a dictionary of objects","body":"<p>I'm trying to pull an object from a dictionary of objects, and return said object however I'm having a bit of a problem with types. The class in question looks something like this, I'm wondering how I go about returning the actual object rather than the variable (which I assume is a string by default).</p>\n\n<pre><code> public Object GetObject(string foo){\n\n if(someDict.ContainsKey(foo))\n {\n   var pulledObject = someDict[foo];\n\n }\n  return pulledObject;\n }\n</code></pre>\n\n<p>I had thought boxing was needed, something like</p>\n\n<pre><code> object pulledObject = someDict[foo];\n</code></pre>\n\n<p>But that doesn't seem to work, any advice that could point me in the right direction.</p>\n"},{"tags":["c#",".net","xml","linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13253395,"title":"Altering NHibernate config file using c# linq","body":"<p>let us consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;section name=\"hibernate-configuration\" type=\"NHibernate.Cfg.ConfigurationSectionHandler, NHibernate\"/&gt;\n  &lt;/configSections&gt;\n  &lt;hibernate-configuration xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n    &lt;session-factory&gt;\n      &lt;property name='proxyfactory.factory_class'&gt;NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle\n      &lt;/property&gt;\n      &lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n\n     &lt;property name=\"connection.connection_string\"&gt;\n         Server=myServerAddress;Port=1234;Database=myDataBase;Uid=myUsername;Pwd=myPassword;\n      &lt;/property&gt;\n      &lt;property name=\"dialect\"&gt;\n        NHibernate.Dialect.MySQLDialect\n      &lt;/property&gt;\n      &lt;property name=\"show_sql\"&gt;\n        false\n      &lt;/property&gt;\n      &lt;property name=\"hbm2ddl.keywords\"&gt;none&lt;/property&gt;\n    &lt;/session-factory&gt;\n  &lt;/hibernate-configuration&gt;\n   &lt;startup&gt;\n  &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;&lt;/startup&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;qualifyAssembly partialName=\"MySql.Data\" fullName=\"MySql.Data, Version=5.1.7.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d\" /&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>My query is to change the value in the <strong></strong> tag</p>\n\n<p><strong>old value:</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p><strong>new value</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n      Sample.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p>For that I used:</p>\n\n<pre><code> XDocument doc = XDocument.Load(\"path to webconfig\");\n\n var xElems = from x in doc.Descendants()\n            where x.Name.LocalName == \"property name=\\\"connection.provider\\\"\"\n                  select x;\n\n                foreach (var xElem in xElems)\n                {\n                    Console.WriteLine(xElem.Attribute(\"name\"));\n                }\n</code></pre>\n\n<p>But while I view the document I get the view in xdoc as:</p>\n\n<pre><code>//&lt;property name=\"connection.provider\" xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n</code></pre>\n\n<p>How can I solve this issue?</p>\n"},{"tags":["c#","java",".net","dependency-injection","inversion-of-control"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":55,"score":-2,"question_id":13256826,"title":"IoC/DI in world of .NET/Java","body":"<p>I`am a professional .NET developer and i know a lot of places, where IoC and in particular DI can improve application architecture (modularity, different interfaces abstractions, design-time proxies, advanced unit-testing, etc).\nI know a lot of different frameworks for building loose-couple application design, such as Prism, MEF, Castle, ets., and every one implement/support IoC(DI) principles. </p>\n\n<p>But i also interested in Java development, and i want to know:\n<em>is IoC/DI are popular in world of Java and if it so, i want to figure out the most used area of this concepts and the most popular frameworks which can provide best facilities of using it?</em></p>\n"},{"tags":["c#","c++",".net","com-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13256440,"title":"What is the equivalent of _bstr_t in C#","body":"<p>I am working on a project where I need to convert C++ code to C#.</p>\n\n<p>I came across <code>_bstr_t</code> in the code I would like to know how the equivalent in C#.</p>\n"},{"tags":["c#","collections","collection-initializer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13256787,"title":"Initialize list with both a single object and another list of objects","body":"<p>I want to initialize a list with an object and a list of objects in that specific order. Currently, I am doing:</p>\n\n<pre><code>List&lt;MyObject&gt; list = new List&lt;MyObject&gt;();\nlist.Add(object1); // object1 is type MyObject\nlist.AddRange(listOfObjects); // listOfObjects is type List&lt;MyObject&gt;\n</code></pre>\n\n<p>I was hoping to consolidate that into an initialization statement (the syntax is wrong of course):</p>\n\n<pre><code>List&lt;MyObject&gt; newList = new List&lt;MyObject&gt;() { object1, listOfObjects };\n</code></pre>\n\n<p>Is there a way to do this concisely?</p>\n"},{"tags":["c#","select","text","textbox"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13256720,"title":"Disable selecting text in a textbox","body":"<p>I have a textbox with the following (important) properties:</p>\n\n<pre><code>this.license.Multiline = true;\nthis.license.ReadOnly = true;\nthis.license.ScrollBars = System.Windows.Forms.ScrollBars.Vertical;\nthis.license.ShortcutsEnabled = false;\n</code></pre>\n\n<p>It looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Xhwsc.png\" alt=\"Textbox with highlighted text in it\"></p>\n\n<p>How can I disable the user to highlight text in this textbox (I do not want to disable the textbox completely)?</p>\n"},{"tags":["c#","winforms","visual-studio-2005","tab-ordering"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1220,"score":1,"question_id":3063829,"title":"WinForms TabOrder tool: Broken or just confusing?","body":"<p>I have a form with a bunch of panels, and some panels inside groupboxes. When using the TabOrder tool in Vs2005, the controls outside of containers are given integers (0), the controls inside panels are given decimals (72.0), and the controls within panels within groupboxes are given three-part values (73.73.0). Unfortunately the resulting tab order has nothing to do with the order I clicked my controls.</p>\n\n<p>Does this tool simply not support nested containers? Am I doing something wrong? Perhaps holding Shift- or Ctrl- when I click (I've tried these with no success)?</p>\n\n<p>Am I going to be forced to manually type in three-part tab orders for all my controls? That would be a bummer.</p>\n"},{"tags":["c#","exception","dll",".net-3.5","xslt-1.0"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13256209,"title":"What assembly is XslTransformException in?","body":"<p>I have some code which is throwing an XslTransformException.  This is the desired behavior (the XSL contains an xsl:message element with @terminate set to yes).  </p>\n\n<p>I'm trying to catch this exception in my code, but can't find the assembly containing this exception's class, and can't find any documentation on this exception in MSDN to get an idea of a suitable inherited class (i.e. to avoid using the class Exception in my catch block).</p>\n\n<p>I've got the System.Xml and Sytem.Xml.Linq assemblies referenced and have the following using statements:</p>\n\n<pre><code>using System.Xml;\nusing System.Xml.Xsl;\n</code></pre>\n\n<p>The exception is in the System.Xml.Xsl namespace; i.e.:</p>\n\n<pre><code>System.Xml.Xsl.XslTransformException\n</code></pre>\n\n<p>Any idea which assembly I need to reference?  </p>\n\n<p><strong>EDIT:</strong>\nAs requested, please find below sample code to reproduce this exception:</p>\n\n<pre><code>using System;\nusing System.Xml;\nusing System.Xml.Xsl;\nusing System.Text;\n\nnamespace StackOverflowDemo\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            XmlDocument xmsl = new XmlDocument();\n            xmsl.LoadXml(\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;xsl:stylesheet version=\\\"1.0\\\" xmlns:xsl=\\\"http://www.w3.org/1999/XSL/Transform\\\" xmlns:msxsl=\\\"urn:schemas-microsoft-com:xslt\\\" exclude-result-prefixes=\\\"msxsl\\\"&gt;&lt;xsl:output method=\\\"xml\\\" indent=\\\"yes\\\"/&gt;&lt;xsl:template match=\\\"@* | node()\\\"&gt;&lt;xsl:message terminate=\\\"yes\\\"&gt;this should throw an exception&lt;/xsl:message&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\\\"@* | node()\\\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;\");\n\n            XslCompiledTransform xsl = new XslCompiledTransform();\n            xsl.Load(xmsl.CreateNavigator());\n\n            XmlDocument xml = new XmlDocument();\n            xml.LoadXml(\"&lt;root /&gt;\");\n\n            StringBuilder sb = new StringBuilder();\n            XmlWriter writer = XmlWriter.Create(sb);\n            /*\n            try\n            {\n            */\n                xsl.Transform(xml.CreateNavigator(), writer);\n            /*\n            }\n            catch(XslTransformException e) //&lt;-- this class does not exist\n            {\n                Console.WriteLine(e.ToString());\n            }            \n            */\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","web-applications","asp.net-mvc-4","asp.net-web-api","ravendb"],"answer_count":0,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":95,"score":6,"question_id":13147077,"title":"RavenDB-Embedded Unstable In Cooperation With ASP .Net Web API Using 2-Tier Architecture","body":"<p>My application is used <strong>RavenDB-Embedded Unstable 1.2.2137</strong> that it's intracted with ASP .Net Web API in the separated assemblies.</p>\n\n<p>When I use <strong>\"UseEmbeddedHttpServer = true\"</strong> on the document store, first time I send a request to RavenDB, it executes properly but when I try for the second time my application displays Raven Studio.</p>\n\n<p>However, if UseEmbeddedServer setting be removed then my application will be running without any problems.</p>\n\n<p>My RavenDB is configured with the following codes in data tier :</p>\n\n<pre><code>this.documentStore = new EmbeddableDocumentStore\n{\n    ConnectionStringName = \"RavenDB\",\n    UseEmbeddedHttpServer = true\n}\n</code></pre>\n\n<p>and  implementation of Web.config have these settings in the service tier :</p>\n\n<pre><code>&lt;connectionStrings&gt;\n    &lt;add name=\"RavenDB\" connectionString=\"~\\App_Data\\RavenDatabase\" /&gt;\n&lt;/connectionStrings&gt;\n</code></pre>\n\n<p>Is there a setting I missed?</p>\n"},{"tags":["c#","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13254929,"title":"Can I have a DataGridView cell where I can type OR choose from a drop-down list?","body":"<p>This is my first time using the DataGridView, and it's a bit overwhelming (so many options!).</p>\n\n<p>I'd like to display a list of properties, one per row. Each row is a name/value pair. The names of the properties are fixed, but the user is free to enter any value.</p>\n\n<p>Now, since each property has a <strong>list of already-used values</strong>, I'd like those to be available to the user in a <strong>drop-down list</strong>. However, I'd also like the user to be able to <strong>type a new value</strong>. Ideally, the value should auto-complete as the user types.</p>\n\n<p>I've tried using a column with the DataGridViewComboBoxColumn style, and since a standard combo box supports the type-or-edit way of working, I though that this would work. However, it seems to <em>only</em> allow selecting from the list (plus, pressing a key will automatically select the first matching entry from the list). There seems to be no way to type a new value. </p>\n\n<p>Which of the 844 properties should I set? :-)</p>\n"},{"tags":["c#","windows-mobile"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":119,"score":3,"question_id":13048272,"title":"Sending mail in Windows mobile application in Windows","body":"<p>I am new to Windows Mobile Application. In my project, I want to send emails using <code>microsoft.windowsmobile.pocketoutlook</code>. I have the following code so far:</p>\n\n<pre><code>private void btnsubmit_Click(object sender, EventArgs e)\n{\n    try\n    { \n        totleave();\n        OutlookSession ol = new OutlookSession();\n        EmailMessage em = new EmailMessage();\n        //Recipient  s1 = em.From;\n        //Console.WriteLine(s1);\n        Recipient r = new Recipient(\"iyalarasi.r\", \"iyalarasi.r@winxsolutions.com\");\n        em.To.Add(r);\n        em.Subject = \"Request For Leave\";\n        em.BodyText =txtename.Text +\"(Emp id:\"+txteno.Text+ \")\" + \" request \"+ cb1.SelectedItem.ToString()+\" leave from \"+dtpfrom .Value\n            .ToShortDateString ()+\" to \"+dtpto .Value.ToShortDateString ()  + \"\\n The reason is \" + txtreason.Text;\n        EmailAccount ea = ol.EmailAccounts[0];\n        ea.Send(em);\n        // em.Send(\"iyalarasi.r\");//Account name in outlook\n        //MessagingApplication.Synchronize(\"iyalarasi.r\");\n        MessageBox.Show(\"mail sent\");\n        f2.Show();\n        f2.lblmsg.Text = \"You have Applied Leave\";\n    }\n    catch (PocketOutlookException ex)\n    {\n        lblmsg1.Text = ex.ToString();\n    }\n    catch (Exception e1)\n    {\n        lblmsg1.Text = e1.ToString();\n    }\n}\n</code></pre>\n\n<p>With this code, emails appear in the outbox, but never appears in the inbox.\nUsing Gmail, It shows the following message:</p>\n\n<blockquote>\n  <p>Messages could not be sent. Check that you have network coverage, and that your account information is correct, and then try again.</p>\n</blockquote>\n\n<p>My account information is correct. What is going on?</p>\n"},{"tags":["c#","windows-8","winrt","network-connection"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13256737,"title":"How can I check if a Windows 8 device is currently sending/receiving data on an wifi/mobile data connection?","body":"<p>I want to see if there is mobile data activity. How can I do this using the WinRT api (c#)? \nI can check if the device has active mobile data, ethernet or wifi connections, but can't seem to check if any of those connections are currently sending/receiving data.</p>\n"},{"tags":["c#","asp.net","ajax","gridview"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13256676,"title":"asp.net c# gridview sorting by an AJAX rating control","body":"<p>I have added an Ajax rating control to my Gridview as below:</p>\n\n<pre><code>  &lt;asp:BoundField DataField=\"Wrms_QueryId\" HeaderText=\"Warms_QueryId\" ReadOnly=\"True\" SortExpression=\"Wrms_QueryId\" /&gt;\n            &lt;asp:TemplateField HeaderText=\"Favourites\"&gt;\n                &lt;ItemTemplate&gt;\n                    &lt;asp:Rating ID=\"Rating1\" runat=\"server\" AutoPostBack=\"true\"  CurrentRating='&lt;%# Bind(\"num\") %&gt;' MaxRating=\"3\" RatingAlign=\"Horizontal\"\n                        RatingDirection=\"LeftToRightTopToBottom\" StarCssClass=\"ratingStar\" WaitingStarCssClass=\"savedRatingStar\"\n                        FilledStarCssClass=\"filledRatingStar\" EmptyStarCssClass=\"emptyRatingStar\" Tag='&lt;%# Bind(\"Wrms_QueryId\")%&gt;' OnChanged=\"Rating1_Changed\"&gt;\n                    &lt;/asp:Rating&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:TemplateField&gt;\n</code></pre>\n\n<p>and in .cs</p>\n\n<pre><code> protected void Rating1_Changed(object sender, EventArgs e)\n{\n    Rating ra= (Rating)sender; \n    GridViewRow gr=(GridViewRow) ra.Parent.Parent;          \n\n    // table update required?\n\n    Rating r = sender as Rating;\n     int id = Convert.ToInt32(r.Tag);\n     int lf = Convert.ToInt32(r.CurrentRating);\n     string strSQL2 = \"UPDATE [dbo].[wrms_config_m] set QueryId = \" + lf + \" where  Wrms_QueryId = \" + id;\n     ExecuteSQLUpdate(strSQL2);\n\n\n}    \n</code></pre>\n\n<p>but I don't know how to add sorting to the rating column. Normally I would just add SortExpression=\"####\" but this doesn't seem to be supported for the rating column. </p>\n\n<p>I have looked through lots of forums and can't find an answer. any help would be gratefully received please.</p>\n\n<p>thanks </p>\n"},{"tags":["c#","picturebox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13256668,"title":"Load full Image in PictureBox","body":"<p>I want to load the full Image in Picturebox. Then drag it with mouse.</p>\n\n<pre><code>private void pictureBox1_MouseDown(object sender, MouseEventArgs e)\n{\n    if (e.Button == MouseButtons.Left)\n    {\n        mx = e.X;\n        my = e.Y;\n    }\n}\n\nprivate void pictureBox1_MouseMove(object sender, MouseEventArgs e)\n{\n    if (e.Button == MouseButtons.Left)\n    {\n        pictureBox1.Left += (e.X - mx);\n        pictureBox1.Top += (e.Y - my);\n    } \n}\n</code></pre>\n\n<p>Yes it can be dragged. But the problem is, the PictureBox cuts the Image according to picturebox's width and height. What to do if I want Image's original width and height (means full Image) to be loaded? After loaded, dragging will let me see the rest part of the Image.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","vb.net","operators","null-coalescing-operator"],"answer_count":4,"favorite_count":7,"up_vote_count":50,"down_vote_count":0,"view_count":9131,"score":50,"question_id":403445,"title":"Is there a VB.NET equivalent for C#'s ?? operator?","body":"<p>Is there a VB.NET equivalent for C#'s ?? operator?</p>\n"},{"tags":["c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7076,"score":0,"question_id":2269773,"title":"C# Datagridview ComboBox Select Value Stick","body":"<p>I want to be able to display the selected intem in a combobox in the datagridview. I already have the combobox populated and I already know how to get the selected value from a database. What I am trying to accomplish is anytime the form is loaded any pre-selected values in the combobox are automatically pre-selected to show the user what they selected last. I have a database that stores the selections and they are easily accessed. Again, how can I make the selections stick to whatever a user selects so they are remembered each and everytime they open the form, unless of course someone changes their selection and its saved. I don't see a value.selected in the datagridview combobox like you normally do. Has anyone ever gotten this to work?</p>\n\n<p>Here is an example:</p>\n\n<p>I have a combobox imbedded in a datagridiew called test as the column name</p>\n\n<p>there are 4 fields to select:   </p>\n\n<blockquote>\n  <ol>\n  <li>test1</li>\n  <li>test2</li>\n  <li>test3</li>\n  <li>test4</li>\n  </ol>\n</blockquote>\n\n<p>Lets say this time I select test3 as my choice. I close the form and the selection is saved to a database. Now I know how to retrieve that value from the database, but how do I make test 3 show when the form loads as the displaymember and still be able to select another if I choose to?</p>\n"},{"tags":["c#","unity","enterprise-library"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":8632,"score":4,"question_id":3952109,"title":"Unity application block 2.0 - The given assembly name or codebase was invalid","body":"<p><strong>Interfaces (In the assembly named \"Interfaces\". In project :- Interfaces)</strong></p>\n\n<pre><code>namespace Interfaces\n{\n    public interface IDoSomeWork1\n    {\n        string DoSomeWork1();\n    }\n}\n\nnamespace Interfaces\n{\n    public interface IDoSomeWork2\n    {\n        string DoSomeWork2();\n    }\n}\n</code></pre>\n\n<p><strong>Dependencies (In the assembly named \"Entities\". In project :- Entities)</strong></p>\n\n<pre><code>namespace Entities\n{\n    public class ClassB : IDoSomeWork1\n    {\n        public string DoSomeWork1()\n        {\n            return this.ToString();\n        }\n    }\n}\n\nnamespace Entities\n{\n    public class ClassC : IDoSomeWork2\n    {\n        public string DoSomeWork2()\n        {\n            return this.ToString();\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Class (In project :- UsingUnity)</strong></p>\n\n<pre><code>public class ClassA\n    {\n        [Dependency]\n        public IDoSomeWork1 DoSomeWork1 { get; set; }\n        [Dependency]\n        public IDoSomeWork2 DoSomeWork2 { get; set; }\n\n\n        public void SomeMethodInClassA()\n        {\n            Console.WriteLine(DoSomeWork1.DoSomeWork1());\n            Console.WriteLine(DoSomeWork2.DoSomeWork2());\n        }\n    }\n</code></pre>\n\n<p><strong>App.Config (In a console application project :- ConsoleUsingUnity)</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;section name=\"unity\"\n                 type=\"Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,\n                   Microsoft.Practices.Unity.Configuration\" /&gt;\n    &lt;/configSections&gt;\n    &lt;unity&gt;\n        &lt;containers&gt;\n            &lt;container&gt;\n                &lt;types&gt;\n                    &lt;type type=\"Interfaces.IDoSomeWork1, Interfaces\"\n                          mapTo=\"Entities.ClassB, Entities\" /&gt;\n                    &lt;type type=\"Interfaces.IDoSomeWork2, Interfaces\"\n                          mapTo=\"Entities.ClassC, Entities\" /&gt;\n                &lt;/types&gt;\n            &lt;/container&gt;\n        &lt;/containers&gt;\n    &lt;/unity&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p><strong>The client (In a console application project :- ConsoleUsingUnity)</strong></p>\n\n<pre><code>public class Class1\n    {\n        static void Main(string[] args)\n        {\n            IUnityContainer container = new UnityContainer();\n\n            // Load from config file\n            UnityConfigurationSection section = (UnityConfigurationSection)ConfigurationManager.GetSection(\"unity\");\n            section.Configure(container);\n\n            ClassA classA = container.Resolve&lt;ClassA&gt;();\n            classA.SomeMethodInClassA();\n        }\n    }\n</code></pre>\n\n<p>And when I run the client, I get the following error at  section.Configure(container);:-</p>\n\n<blockquote>\n  <p>The given assembly name or codebase\n  was invalid. (Exception from HRESULT:\n  0x80131047)</p>\n</blockquote>\n\n<p>I am not sure If there is anything wrong with the config or the type. Could anyone please point out the mistake here?</p>\n"},{"tags":["c#","wpf","mvvm","binding","dependency-properties"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":192,"score":2,"question_id":13052100,"title":"Binding from DependecyProperty to DataContext (ViewModel) in XAML","body":"<p>Assume this situation:<br>\nI have created a new control (\"MyControl\") with DependencyProperty \"SuperValue\".<br>\nNow, in XAML i set \"SuperValue\" to \"TestValue\":</p>\n\n<pre><code>&lt;local:MyControl SuperValue=\"TestValue\" /&gt;\n</code></pre>\n\n<p>This control has a ViewModel (DataContext).<br>\nI want to pass value of DependencyProperty (in this example \"TestValue\") to property in ViewModel.</p>\n\n<p>How can I do this?</p>\n\n<p>Assume that ViewModel of my control do something calculations, for example: User inputs name of country, and control give him a time which is currently there.</p>\n\n<p>The problem is: How can I provide the result of calculation? Assume that this is public property \"Results\" in ViewModel. I want to create a property like \"TextBox.Text\", \"ListView.SelectedItem\" which provides a part of ViewModel data \"to outside\".</p>\n\n<p>For example TextBox and Text property:</p>\n\n<pre><code>&lt;TextBox Text={Binding GiveMeTextValue} /&gt;\n</code></pre>\n\n<p>In this case DP \"Text\" provides to outside a ViewModel property which currently stores inputted text.</p>\n\n<p>I want to use my control in the same way.<br></p>\n"},{"tags":["c#","java","porting"],"answer_count":14,"favorite_count":6,"up_vote_count":36,"down_vote_count":1,"view_count":33451,"score":35,"question_id":78811,"title":"Is there an effective tool to convert C# code to Java code?","body":"<p>Is there an effective tool to convert C# code to Java code?</p>\n"},{"tags":["c#"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12459164,"title":"How to display Reportviewer in other system?","body":"<p>i am using WinForm App. C#2010 with 4.0 ,after deploying application to another computer i have error i have copied all references along with reports which i used but still error in uploading report.\"Could not load file or assembly error\nmicrosoft.reportviewer.processing object model version = 10.0.0.0,\nculture = neutral\"</p>\n"},{"tags":["c#","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13255961,"title":"Regex for named value of field after a colon","body":"<p>Using c# I am trying to use regular expressions to get the value of a piece of text that appears after a colon. I know the field name, but there is a following colon that is in a variable position. The value would end at the next whitespace. </p>\n\n<p>Thus:</p>\n\n<p>KnownFieldName       : Value</p>\n\n<p>I'd then like to place the value into a group. </p>\n\n<p>I've found a number of similar questions but none that actually points me in the direction of solving this.</p>\n\n<p>This is part of a larger piece of code, but basically it fits in here:</p>\n\n<pre><code>     foreach (var v in fieldsToParse)\n                {\n                    var match = Regex.Match(line, v.pattern, RegexOptions.IgnorePatternWhitespace);\n\n                    if (match.Success)\n                        v.value = match.Groups[v.name].Value;\n                }   \n</code></pre>\n"},{"tags":["c#","winforms",".net-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13255802,"title":"TextBox values are not updated from external method?","body":"<p>I have a simple GUI with 6 textboxes.</p>\n\n<p>I have a method that takes 7 parameters, 1 being a long string and the other 6 being the textboxes.  The method looks like this:</p>\n\n<pre><code>SetTextBoxesFromTokens(string s, string a, string b, string c, string d, string e, string f)\n{\nstring[] tokens = s.Split('-');\n\na = tokens[0];\nb = tokens[1];\nc = tokens[2];\nd = tokens[3];\ne = tokens[4];\nf = tokens[5];\n}\n</code></pre>\n\n<p>I am calling the above method like so, but it is not updating the text boxes:</p>\n\n<pre><code>SetTextBoxesFromTokens(\"1-2-3-4-5-6\",\n        txtA.Text,txtB.Text,txtC.Text,txtD.Text,txtE.Text,txtF.Text);\n</code></pre>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13256290,"title":"EF get Keyvalues of added objects","body":"<p>Is it possible to get the entity keyvalues of added objects?</p>\n\n<p>The keyvalues are set after context.SaveChanges(). But unfortunately after context.SaveChanges the EntityState.Added is gone.</p>\n"},{"tags":["c#","asp.net-mvc","mvc","razor","orchardcms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":13237264,"title":"Orchard CMS Blog View / Layout","body":"<p>I'm new to Orchard CMS &amp; MVC so please take this into account. Any help -the more the better- will be greatly received.</p>\n\n<p>I want to add widgets to my blog summary page. What is the best way to achieve this? Ive tried creating a layer for the blog summary page defined by the rules for the layer, so as to be unique to this page. However, this only allows me to add widgets into the layer zones.</p>\n\n<p>What i need/want to do is to effectively create a side bar with a tag cloud and a blogroll showing titles of other posts, and a couple of other bits of content. This would mean moving the blog summary content into another zone inorder that i can fit widgets down the side.</p>\n\n<p>Is this the correct approach? If so how do i shift the summary stuff into another zone??\nIf this isnt the best approach, what is???</p>\n\n<p>Is this where projections come in???</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","web-applications","asp.net-mvc-4","asp.net-web-api","odata"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":87,"score":4,"question_id":13121645,"title":"The query specified in the URI is not valid using Web API OData","body":"<p>My project is created based on ASP.Net MVC Web API 4 application. If it's model have the following implementations :</p>\n\n<pre><code>public class BaseEntity\n{\n    public  object Id {get; set;}\n}\n\npublic class Entity1 : BaseEntity\n{\n    public  string Name {get; set;}\n}\n</code></pre>\n\n<p>And Wep API controller is :</p>\n\n<pre><code>public class Entity1Controller : ApiController\n{\n    ...\n\n    [Queryable]\n    public IQueryable&lt;T&gt; Get()\n    {\n        return repository.Table.AsQueryable();\n    }\n}\n</code></pre>\n\n<p>And Web API configuration have this setting :</p>\n\n<pre><code>public class WebApiApplication : System.Web.HttpApplication\n{\n    protected void Application_Start()\n    {\n        ...\n\n        ODataModelBuilder modelBuilder = new ODataConventionModelBuilder();\n        modelBuilder.EntitySet&lt;BaseEntity&gt;(\"BaseEntity\");\n        modelBuilder.EntitySet&lt;Entity1&gt;(\"Entity1\");\n        IEdmModel model = modelBuilder.GetEdmModel();\n\n        GlobalConfiguration.Configuration.SetEdmModel(model);\n    }\n}\n</code></pre>\n\n<p>so, when one request is generated in the client side application :</p>\n\n<pre><code>$.getJSON(\"api/Entity1?$filter=Id eq '\" + id + \"'\",\nfunction (data) {\n        ...\n    });\n</code></pre>\n\n<p>my application encounter with the following error :</p>\n\n<pre><code>{\"Message\":\"The query specified in the URI is not valid.\",\"ExceptionMessage\":\"Type 'Entity 1' does not have a property 'Id'.\"}\n</code></pre>\n\n<p>Why the query specified in the URI is not valid using Web API OData ?</p>\n"},{"tags":["c#","winforms","coded-ui-tests"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13250842,"title":"How get checkbox or checked property from WinTreeItem into WinTree (Coded UI)?","body":"<p>I created Coded UI test which works with WinTree element.\nI need to check 'checked' prorerty from some WinTreeItem.</p>\n\n<p>'Checked' prorperty I can get from WinCheckBoxTreeItem, but I don't know how to get this checkbox.</p>\n\n<p>Maybe do you know way to convert WinTreeItem to WinCheckboxTreeItem or get WinCheckbox from WinTreeItem.</p>\n\n<p>You are only last hope! </p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","zip","folder","archive","compress"],"answer_count":8,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":22920,"score":18,"question_id":905654,"title":"Zip folder in C#","body":"<p>What is an example (simple code) of how to zip a folder in C#?</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>I do not see namespace <code>ICSharpCode</code>. I downloaded <code>ICSharpCode.SharpZipLib.dll</code> but I do not know where to copy that DLL file. What do I need to do to see this namespace?</p>\n\n<p>And do you have link for that MSDN example for compress folder, because I read all MSDN but I couldn't find anything.</p>\n\n<hr>\n\n<p>OK, but I need next information.</p>\n\n<p>Where should I copy <code>ICSharpCode.SharpZipLib.dll</code> to see that namespace in Visual Studio?</p>\n"},{"tags":["c#","web-services","infopath2010","custom-error-handling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13256420,"title":"Display custom error message in web service for InfoPath client","body":"<p>I have a custom web service that submits the record to the database,</p>\n\n<p>The JF_ID value that gets submitted to the table references to the JF_ID value of the main/source table. So if a user tries to submit for non-existant JF_ID, sql exception is caught saying 'referential integrity violation etc...</p>\n\n<p>Here's what my web service looks like:</p>\n\n<pre><code>[WebService(Namespace = \"http://microsoft.com/webservices/\")]\nclass POReqEntryForm : WebService \n{\n    [WebMethod(Description = \"Submits data to [Req_entry].\")]\n    public void AddRecordPOReqIdEntry(int JF_ID, int ReqId, string PONum, string POLineNum, float POAmount, string Submitter, string DateSubmitted)\n    {\n\n        string connectionString =\n          ConfigurationManager.ConnectionStrings[\"REQdb\"].ConnectionString;\n\n        using (SqlConnection conn = new SqlConnection(connectionString))\n        {\n            SqlCommand cmd = new SqlCommand();\n            cmd.CommandType = System.Data.CommandType.Text;\n\n\n            cmd.CommandText = \"INSERT INTO [REQdb].[dbo].[Req_entry] \"\n                + \"(JF_ID, Req_id, Po_num, Po_line_num, po_amount, Submitter, Date_Submitted ) \"\n                + \"VALUES (@JF_ID, @ReqId, @PONum, @POLineNum, @POAmount, @Submitter, @DateSubmitted)\";\n\n            cmd.Parameters.AddWithValue(\"JF_ID\", JF_ID);\n            cmd.Parameters.AddWithValue(\"ReqId\", ReqId);\n            cmd.Parameters.AddWithValue(\"PONum\", PONum);\n            cmd.Parameters.AddWithValue(\"POLineNum\", POLineNum);\n            cmd.Parameters.AddWithValue(\"POAmount\", POAmount);\n            cmd.Parameters.AddWithValue(\"Submitter\", Submitter);\n            cmd.Parameters.AddWithValue(\"DateSubmitted\", DateSubmitted);\n\n            cmd.Connection = conn;\n\n            try\n            {\n                conn.Open();\n                cmd.ExecuteNonQuery();\n\n            }\n\n            catch\n            {\n                // Handle the error using your own preferred error-handling method\n            }\n            finally\n            {\n                conn.Close();\n            }\n        }\n\n\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>There could be a number of fault data entries by a user. For e.g., user inputs string instead of integer value,\nIf he tries to submit the entry for the non-existing JF_ID, it violates referential integrity.</p>\n\n<pre><code>The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_Req_Entry_JF_ID\". The conflict occurred in database \"REQdb\", table \"dbo.Main_Form\", column 'JF_ID'.\n</code></pre>\n\n<p>How do I make sure that such type of SQL exception when caught, a user friendly custom error message(Such as the entered ID doesn't exist.Data insertion failed!) is passed from my web service. In the end, I would like to pass this friendly error message to InfoPath client.</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["c#","sql-server","type-conversion"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13177330,"title":"how to convert string datatype to SQL's varbinary equivalent datatype?","body":"<p>Sorry for asking stupid question as I am newbie to C#.</p>\n\n<p>Currently doing a task in c# using OLEDB. The scenario is, I want to insert in one table which has information like username, pasword, etc. The Database is SQL Server. The column Pasword has a datatype varbinary(100). </p>\n\n<p>I want to convet from string datatype to SQL's varbinary equivalent datatype. I tried a little bit, but didn't succeed.</p>\n\n<p>Initially I just tried with <code>reader.GetString(5)</code>. But exception I got is : </p>\n\n<pre><code>\"Specified cast is not valid.\"\n</code></pre>\n\n<p><strong>* I forgot to mentioned below things *</strong></p>\n\n<p>Reader I used is OleDbDataReader.</p>\n\n<pre><code>oleParameter[7] = new OleDbParameter(\"@Password\", OleDbType.VarBinary, 100);\noleParameter[7].Value = reader1.GetBytes(5);\n</code></pre>\n\n<p>(Here I am reading from one table and inserting into another table.)</p>\n\n<p>Please help me.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","list","extension-methods","reverse","shuffle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13255909,"title":"How to implement extension method Shuffle like List's Reverse without return?","body":"<p>I have the following code for Shuffle so far,</p>\n\n<pre><code>    public static IList&lt;T&gt; Shuffle&lt;T&gt;(this IList&lt;T&gt; list)\n    {\n        var rnd = new Random();\n        return list.OrderBy(element =&gt; rnd.Next());\n    }\n</code></pre>\n\n<p>and i use it like,</p>\n\n<pre><code>    list = list.Shuffle();\n</code></pre>\n\n<p>i want to be able to use it like</p>\n\n<pre><code>    list.Shuffle(); // like list.Reverse();\n</code></pre>\n\n<p>so basically i want to shuffle by reference</p>\n\n<p>I tried the following code,</p>\n\n<pre><code>    public static void Shuffle&lt;T&gt;(this ref IList&lt;T&gt; list)\n    {\n        var rnd = new Random();\n        list.OrderBy(element =&gt; rnd.Next());\n    }\n</code></pre>\n\n<p>but it doesn't work.</p>\n\n<p>Any help is greatly appreciated!</p>\n"},{"tags":["c#","windows","visual-studio-2010","windows-7","console"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13255832,"title":"Console application closes immediatly after opening in visual studio","body":"<p>I am trying to open a console application in visual studio built in C#. As soon as I open it, it closes immediately.</p>\n\n<p>I know windows sets this is a a safety default(atleast I think). How do I fix this? </p>\n\n<p>I know I can compile it and create a shortcut and modify the target so it has the location of the command prompt in it before the applications location. Although the programmer who created this has it generating information into the output of visual studio, so it's imperative that  I only open it there.</p>\n\n<p>It happens with most applications and not just in visual studio, just in this case I need it to open in VS 2010. I am using Windows 7 .Thanks.</p>\n"},{"tags":["c#","facebook","facebook-c#-sdk"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":39,"score":-1,"question_id":13256048,"title":"How to get the list of all pages that i like on facebook and post on their wall","body":"<p>i have tried this </p>\n\n<pre><code>string accessToken = \"MYTOKEN\";\n        FacebookClient fbClient = new FacebookClient(accessToken);\n        var args = new Dictionary&lt;string, object&gt;();\n        args[\"message\"] = richTextBoxMessage.Text;           \n        fbClient.Post(\"/PAGENAME/feed\", args);\n</code></pre>\n\n<p>i have this error </p>\n\n<blockquote>\n  <p>(OAuthException - #200) (#200) The user hasn't authorized the\n  application to perform this action</p>\n</blockquote>\n\n<p>if i can post on the page wall by that code,so what is the permission name that i should add on the App settings.\nAnd how can i get the names of all pages that i liked</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","fakeiteasy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13256001,"title":"How to get access to parameters value in Returns() using FakeItEasy?","body":"<p>I have an interface to a factory used to create some data objects.</p>\n\n<pre><code>interface IFactory\n{\n    IData Create (string name, string data);\n}\n\ninterface IData\n{\n    // ....\n}\n\nclass Data : IData\n{\n    public Data (string name, string data)\n    {\n        // .....\n    }\n}\n</code></pre>\n\n<p>I need to create a mock factory to pass to another module and this module will use this mock to create data.</p>\n\n<p>For a quick example, a simple module looks like:</p>\n\n<pre><code>class QuickModule\n{\n    private readonly IFactory _factory;\n\n    public QuickModule (IFactory factory)\n    {\n        _factory = factory;\n    }\n\n    public IEnumerable&lt;IData&gt; GetData ()\n    {\n        yield return _factory.Create (\"name1\", \"abc\");\n        yield return _factory.Create (\"name2\", \"def\");\n    }\n}\n</code></pre>\n\n<p>So, the factory is called two times with two sets of parameters.</p>\n\n<p>Using Moq, this is easy:</p>\n\n<pre><code>var factoryMock = new Mock&lt;IFactory&gt; ();\nfactoryMock.Setup (x =&gt; x.Create (It.IsAny&lt;string&gt; (), It.IsAny&lt;string&gt; ()))\n                    .Returns ((string name, string data) =&gt; new Data (name, data));\nvar module = new QuickModule (factoryMock.Object);\nvar list = module.GetData ();\n</code></pre>\n\n<p>However using FakeItEasy this would not seem to be possible:</p>\n\n<pre><code>var factory = A.Fake&lt;IFactory&gt; ();\nA.CallTo (() =&gt; factory.Create (A&lt;string&gt;.Ignored, A&lt;string&gt;.Ignored))\n              .Returns (new Data (???, ???));\nvar module = new QuickModule (factory);\nvar list = module.GetData ();\n</code></pre>\n\n<p>How can I access the parameters values?</p>\n"},{"tags":["c#","wpf","dispatchertimer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13256164,"title":"send a extra argument in Dispatchertimer.Tick event","body":"<p>my question is how can i send some arguments in Dispatchertimer.Tick event\n here is the code: what i wanted to is receive a integer value at dispatcheTimer_Tick</p>\n\n<pre><code>    dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick);\n\n    private void dispatcherTimer_Tick(object sender, EventArgs e)\n    {\n        //.Text = DateTime.Now.Second.ToString();\n\n    }\n</code></pre>\n\n<p>what i wanted to do is something  like this</p>\n\n<pre><code>    private void dispatcherTimer_Tick(object sender, EventArgs e,int a)\n    {\n        //.Text = DateTime.Now.Second.ToString();\n\n    }\n</code></pre>\n\n<p>how to send a value from a calling point??</p>\n"},{"tags":["c#","osx","network-programming","ipv6","arp"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":744,"score":3,"question_id":4085304,"title":"Get a remote MAC adress via IPv6","body":"<p>Hey guys,\ni searched the web for a solution, but i found nothing! :(</p>\n\n<p>Is it possible to get the MAC from an another PC in the same Network via IPv6 (without WMI)? With IPv4 it is easy (ARP). \nIPv6 uses the \"Neighbor Discovery Protocol\" (NDP) to get the MAC adress. Are there any methods in .Net for this?</p>\n\n<p>Any suggestions?\nThanks for your help!</p>\n\n<p>Regards</p>\n\n<p>Fabian</p>\n"},{"tags":["c#","jenkins","nunit"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":38,"score":2,"question_id":13255716,"title":"Running NUnit tests written in C# with Jenkins on Linux","body":"<p>Is it possible to run tests (written in C# with NUnit) with Jenkins on Linux OS?</p>\n\n<p>I can find a lot of info on running NUnit tests with Jenkins but can't find any speak of my situation.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Looks like it's <a href=\"http://jenkins.361315.n4.nabble.com/Hooks-to-execute-windows-dll-and-exe-builds-tp3400504p3400853.html\" rel=\"nofollow\">possible</a>. I'll need to use a Master Jenkins in Linux to run a Slave Jenkins in Windows. Described in the <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+as+a+Windows+service\" rel=\"nofollow\">article</a>.</p>\n"}]}
