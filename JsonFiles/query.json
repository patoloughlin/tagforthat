{"count":20691,"tag":"query","questions":[{"tags":["query","parameters","nginx"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1130,"score":2,"question_id":8130692,"title":"with nginx,how to forward query parameters?","body":"<pre><code>upstream apache {\n   server 127.0.0.1:8080;\n}\nserver{\n   location ~* ^/service/(.*)$ {\n      proxy_pass http://apache/$1;\n      proxy_redirect off;\n   }\n }\n</code></pre>\n\n<p>Above snippet will  redirect part of requests within that url includes string \"service\" to another server,but not include query parameters.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13280045,"title":"Getting rid of duplicates based on older date in mysql","body":"<p>Picture this... a person adds a row of data about a computer into mysql and he again adds another row of essentially same row of data except that the date is different where each date is always stamped with the insert. </p>\n\n<p>I want to be able to eliminate duplicates and show only the most recent row. </p>\n\n<p>Let's say we have a \"computers\" table with 3 fields: ID, COMPUTER, DATEADD</p>\n\n<p>inside the table goes like this</p>\n\n<pre><code>1, dell, 2010-10-09\n2, dell, 2011-10-10\n3, gateway, 2010-03-03\n4, dell, 2010-02-02\n</code></pre>\n\n<p>simple, ok... how do I get rid of dups of dell and only get dell with the latest date? </p>\n\n<p>I tried this query:</p>\n\n<pre><code> SELECT * \n  FROM  `computers` \n  GROUP BY computer\n  ORDER BY dates ASC \n</code></pre>\n\n<p>it doesnt perform as I expect - the date is not the latest.</p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":12,"score":-1,"question_id":13281216,"title":"hard mysql stmnt about creating this view using various tables","body":"<p>So here are three relations:</p>\n\n<p><strong>Table Members</strong></p>\n\n<blockquote>\n  <p>Members(member_id, name, city, state)</p>\n</blockquote>\n\n<p>where member_id is the primary key</p>\n\n<p><strong>Table Borrowed</strong></p>\n\n<blockquote>\n  <p>Borrowed(borrow_id, lib_id, member_id)</p>\n</blockquote>\n\n<p>where borrow_id is the primary key </p>\n\n<p><strong>Table Libraries</strong></p>\n\n<blockquote>\n  <p>Libraries(lib_id, lib_address, lib_city, lib_state)</p>\n</blockquote>\n\n<p>where lib_id is the primary key</p>\n\n<p>Both lib_id and member_id are foreign keys</p>\n\n<p>Create a view called frequent_borrowers that reports, for every library, the member that has borrowed from that library the largest number of times. The view should contain the columns: (lib_id, member_id, name, num_borrowed). The last column is a count of how many times the borrower has made a check out at the library. (Note that you are not counting how many items the borrower has borrowed, but the number of times the borrower has gone to the library and checked out things.) In situations where multiple members tie for the most visits to a given library, include all such members in your results. Make sure your view includes every library, even ones where no members have checked out anything. Stores with no borrows should have NULL values for all columns except the lib_id column. </p>\n"},{"tags":["query","mongodb","find","cross-database"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13278814,"title":"MongoDB cross database query","body":"<p>I know I've seen this solution somewhere, but I can't seem to find it now.  I'm trying to query one MongoDB database while connected to another.  This should be possible without explicitly connecting to the other database before running the query.  Does anyone know the correct syntax to do this?</p>\n"},{"tags":["mysql","sql","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13280677,"title":"How to do a moving average on a range of dates in SQL?","body":"<p>Let's just say I have two columns, DATE and VALUE. The dates are not necessarily regularly spaced intervals. How can I create a moving average on VALUE over the past N days? I'm using postgres but mysql solutions would also be helpful.</p>\n\n<p>Data:</p>\n\n<pre><code>DATE    VALUE\n2012-11-05 10\n2012-10-29 31\n2012-10-22 108\n2012-10-17 3654\n2012-10-16 1187\n2012-10-15 12033\n2012-10-09 41\n2012-10-01 85\n2012-09-25 20\n2012-09-24 285\n2012-09-17 20\n2012-09-10 20\n2012-09-04 41\n2012-08-27 63\n2012-08-20 52\n2012-08-13 160\n</code></pre>\n"},{"tags":["sql","sql-server","performance","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13280548,"title":"Performance issue in retrieving multiple output of the same column with different values from a single table","body":"<p>is there anyway to get the following results from query without joining the same table three times (or) without reading the same \"wordlocation\" table three times (or more if there are more words)? If there are three or more words, it takes about over a minute for the results to be returned.</p>\n\n<p>Currently \"wordlocation\" table has three rows being (\"bookid\",\"wordid\",\"location\") and it currently has 917802 rows.</p>\n\n<p>What I am trying to do is </p>\n\n<ol>\n<li>retrieve the \"bookid\" that contains all the words specified in the query by \"wordid\".</li>\n<li>sum word count of all words (from the query) from each book</li>\n<li>minimum values of each word location, e.g. (min(w0.location), min (w1.location)</li>\n</ol>\n\n<p>I have tried commenting out count(w0.wordid) and min(location) calculations to see whether they are affecting the performance but this is not the case. Joining the same table multiple time was the case.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SYLB7.jpg\" alt=\"enter image description here\"></p>\n\n<p>(this is the same code as the above image)   </p>\n\n<pre><code>select \n    w0.bookid, \n    count(w0.wordid) as wcount, \n    abs(min(w0.location) + min(w1.location) + min(w2.location)) as wordlocation, \n    (abs(min(w0.location) - min(w1.location)) + abs(min(w1.location) - min(w2.location))) as distance \n    from \n    wordlocation as w0 \n    inner join \n    wordlocation as w1 on w0.bookid = w1.bookid \n    join \n    wordlocation as w2 on w1.bookid = w2.bookid \n    where \n    w0.wordid =3 \n    and \n    w1.wordid =52 \n    and \n    w2.wordid =42\n    group by w0.bookid \n    order by wcount desc;\n</code></pre>\n\n<p>This is the result that I am looking for, and which I got from running the above query, but it takes too long if I specify more than 3 words, e.g. (w0 = 3, w1 = 52 , w2 = 42, w3 = 71)</p>\n\n<p><img src=\"http://i.stack.imgur.com/08dD5.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["python","sql","query","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13271894,"title":"Interfacing with Sqlalchemy query object to extend, custom query types","body":"<p>I'm working on adding pagination functionality to my models. I could do this with a method in a mixin, I think I understand what pagination is in this context, but I'm looking to add queries so I can pass in pagination wherever I want without hard coding a model method and without a mixin e.g.:</p>\n\n<pre><code>Mymodel.query.filter(Mymodel.attr=='X').paginate(**args, **kwargs)\n</code></pre>\n\n<p>flask-sqlalchemy does this, but I'm not using that, though I've gone over it to attempt to extract some of the functionality.</p>\n\n<p>So if I have something like this method:</p>\n\n<pre><code>def paginate(self, page, per_page=20):\n        items = self.limit(per_page).offset((page - 1) * per_page).all()\n        return Pagination(self, page, per_page, self.count(), items)\n</code></pre>\n\n<p>How do I insert that as something with an interface in and out in the sqlalchemy query chain? I somewhat do and don't follow how it is being done in flask-sqlalchemy, but I want to extract/learn how to do this and more control over querying in the future, refine my use of sqlalchemy, so I do not exactly know where I'm going with it, just asking a question and going from there.</p>\n\n<p>Long answer: to keep reading the sqlalchemy docs and code until I achieve greater understanding. I'm looking to extend orm.Query -- which I've done, but I don't see how I can tie this into my project yet because I don't understand the underlying mechanics of sqlalchemy, but I think I just need to add my paginate query to the declarative base Base I'm using but will see once I get back to working on it. </p>\n"},{"tags":["php","mysql","database","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13279604,"title":"What would be a sql query of \" USA State\" come first?","body":"<p>I have MySQL table named employees with </p>\n\n<pre><code> 1. id \n 2. employee \n 3. state\n</code></pre>\n\n<p>I am not getting an idea how I can query the database where state with the name \"New York\" will come first and all other records will come normally. Here is what I have so far </p>\n\n<pre><code>$sql = \"select * from employees order by\";\n</code></pre>\n"},{"tags":["query","lucene.net","term"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13273718,"title":"Lucene.net query for contains and avoiding empty string fields","body":"<p>I have a Lucene index setup which I can query fine. I just am not able to get a \"field not equals to empty string\" condition to work. For example in the below code specimen, I want to have 3 conditions </p>\n\n<ol>\n<li>Where \"country tag\" field contains \"{4ED2F7EE-5C2A-418C-B2F6-236F94166BA1}\".</li>\n<li>Where \"country tag\" field is not empty string.</li>\n<li><p>Where \"date\" range is between \"20110101T000000\" and \"20121001T000000\".</p>\n\n<pre><code>    WildcardQuery taggingQuery = new WildcardQuery(new Term(\"country tag\", \"*\" + ShortID.Encode(\"{4ED2F7EE-5C2A-418C-B2F6-236F94166BA1}\").ToLowerInvariant() + \"*\"));\n    TermQuery taggingNotQuery = new Term(\"country tag\", \" \"));\n\n    RangeQuery rangeQuery = new RangeQuery(new Term(\"date\", \"20110101T000000\"), new Term(\"date\", \"20121001T000000\"), true);\n\n    BooleanQuery booleanQuery = new BooleanQuery();\n    booleanQuery.Add(taggingQuery, BooleanClause.Occur.MUST);\n    booleanQuery.Add(taggingNotQuery, BooleanClause.Occur.MUST_NOT);\n    booleanQuery.Add(rangeQuery, BooleanClause.Occur.MUST);\n</code></pre></li>\n</ol>\n\n<p>I have a feeling I am doing this wrong or my query is wrong somehow. I should not need a condition where I should have to look out for empty or null fields.</p>\n\n<p>Any help is appreciated!</p>\n"},{"tags":["query","ms-access-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13279878,"title":"I need Example for student attendence in Access 2010","body":"<p>Please, I need to make attendance in Access </p>\n\n<p>And want to know how count:</p>\n\n<ol>\n<li>number of absences </li>\n<li>number of attendance</li>\n</ol>\n\n<p>Please, if any one has an example send it to me .. Thanks a lot</p>\n"},{"tags":["query","freebase"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13183878,"title":"Freebase currency query","body":"<p>I have a little problem, maybe can you help me. I'm trying to get the \"currency features\" from freebase. So I tried to do : \"/base/schemastaging/person_extra/net_worth\": null but, I can't get the value written on freebase (for example, with Madonna, it's 650,000,000). Do you know, why it's not working ?</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278632,"title":"Not sure how to write a query to return column associated with max value in group by","body":"<p>This query in postgres 9.2:</p>\n\n<pre><code>select max(amount) as max_analyte,concat(sarea,' ',sloc) as location,analyte\nfrom sample natural join station\ngroup by analyte,location\norder by max_analyte desc;\n</code></pre>\n\n<p>returns the following results:</p>\n\n<pre><code>max_analyte;location;analyte\n24196;\"CANDLESTICK POINT WINDSURFER CIRCLE\";\"COLI_TOTAL  \"\n19863;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_TOTAL  \"\n14136;\"CRISSY FIELD EAST\";\"COLI_TOTAL  \"\n12033;\"CHINA BEACH/BAKER BEACH BAKER BEACH WEST\";\"COLI_TOTAL  \"\n4352;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_E      \"\n3076;\"CHINA BEACH/BAKER BEACH BACKER BEACH EAST\";\"COLI_TOTAL  \"\n2851;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"ENTERO      \"\n2064;\"AQUATIC PARK SHORELINE\";\"COLI_TOTAL  \"\n1918;\"CRISSY FIELD EAST\";\"ENTERO      \"\n...\n...\n\n74;\"CHINA BEACH/BAKER BEACH CHINA BEACH\";\"ENTERO      \"\n41;\"CRISSY FIELD WEST\";\"ENTERO      \"\n41;\"OCEAN BEACH NORTH LINCOLN WAY\";\"ENTERO      \"\n31;\"OCEAN BEACH NORTH LINCOLN WAY\";\"COLI_E      \"\n</code></pre>\n\n<p>The data set contains the levels of 3 types of bacteria (COLI_TOTAL, COLI_E, ENTERO) sampled at various locations around the Bay Area on many different dates. The query above finds the max value at each location for each type of bacteria, but now I'd like to find which type of bacteria is associated with the maximum value for each location. I'm just not sure how to write that query. I should mention I'm doing this to improve my SQL skills. Thanks for any help/suggestions.</p>\n\n<p>The tables schemas are as follows:</p>\n\n<pre><code>CREATE TABLE sample\n(\n  analyte character(12),\n  amount integer,\n  sdate date,\n  sid character varying(20)\n)\n\nCREATE TABLE station\n(\n  sid character(20),\n  sarea character varying(24),\n  sloc character varying(24),\n  sfreq character varying(24)\n)\n</code></pre>\n"},{"tags":["android","query","sqlite","optimization","select"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13278376,"title":"Android SQLite Select query speed","body":"<p>I would like help speeding up a fairly simple select query in my <code>SQLite</code> database.  </p>\n\n<p>The query is searching a table of approx 6500 rows and currently returns in about 600ms.  I don't know if that is acceptable or not, but I had hoped that it would be faster than that.  I will be putting this into an <code>AsyncTask</code> eventually, but wanted to optimize as much as possible.  In the code snippet below you can see what I have tried.<br>\nKEY_songPath is indexed.</p>\n\n<pre><code>public ArrayList&lt;Song&gt; getCurrentDirSongs(String currentDir) {\nlong startTime = System.currentTimeMillis();\nArrayList&lt;Song&gt; songsList = new ArrayList&lt;Song&gt;();\n\nString selectQuery = \"\";\nint strLength = currentDir.length();\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" &gt;= '\" + currentDir + \"')\";\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" GLOB '\" + currentDir + \"*')\";\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" LIKE '\" + currentDir + \"%')\";\n    selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE \" + KEY_ID +\n                    \" IN (SELECT \" + KEY_ID +\" FROM \"+ TABLE_SONGS + \" WHERE length(\" + KEY_songPath + \")&gt;= \"+ strLength +\") AND \" + \n                    \"(\" + KEY_songPath + \" LIKE '\" + currentDir + \"%')\";\n\nSQLiteDatabase db = this.getReadableDatabase();\n\nCursor cursor = db.rawQuery(selectQuery, null);\n\n// looping through all rows and adding to list\nif (cursor.moveToFirst()) {\n    do {\n        Song song = new Song();\n        song.setSongTitle(cursor.getString(1));\n        song.setSongPath(cursor.getString(2));\n        song.setSongArtist(cursor.getString(3));\n        song.setSongAlbum(cursor.getString(4));\n        song.setTrackNumber(cursor.getString(5));\n        song.setID(Integer.parseInt(cursor.getString(6)));\n        song.setAlbumID(Integer.parseInt(cursor.getString(7)));\n        song.setArtistID(Integer.parseInt(cursor.getString(8)));\n        song.setSongCheckedStatus(Boolean.parseBoolean(cursor.getString(9)));\n        song.setSongPosition(Integer.parseInt(cursor.getString(10)));\n        song.setSongDuration(Integer.parseInt(cursor.getString(11)));\n        // Adding song to list\n        songsList.add(song);\n    } while (cursor.moveToNext());\n}\nlong estimatedTime = System.currentTimeMillis() - startTime;\nLog.d(\"AMCDatabase Database Handler: \", \"SongsList.size(): \"+ getSongsCount(\"SongsList\") + \" Time: \" + estimatedTime + \"ms\");\n// return contact list\nreturn songsList;\n</code></pre>\n\n<p>}</p>\n\n<p>This has returned with the following result:\nSongsList.size(): 6390 Time: 588ms</p>\n\n<p>Any help gratefully received!  </p>\n\n<p>P.S This may all be a non-issue - is that time of a second acceptable to query and 6000 values to an <code>ArrayList</code>?</p>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13278880,"title":"sql query returning multiple result using WHERE","body":"<p>There is a table name <code>Top_Up</code>. Its current snapshot is:\n<img src=\"http://i.stack.imgur.com/5CQha.png\" alt=\"Top_Up Table\">  </p>\n\n<p>When I run query <code>SELECT * FROM Top_Up WHERE Top_up_ID = (round(random() * 9 ) + 1);</code> on it, I am getting random result. Sometimes it is returning with two tuples, sometimes no tuples and sometime one tuple.  </p>\n\n<p>To debug I run the query <code>Select (round(random() * 9 ) + 1);</code> and it is always returning only one tuple in the result.  </p>\n\n<p><strong>Why I am getting this vague and random result?</strong></p>\n"},{"tags":["php","mysql","query","sorting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2470,"score":0,"question_id":4537784,"title":"how to sort mysql result set after the query's done","body":"<p>I am writing a query for mysql database having 2 parameters.</p>\n\n<p>Its a basic search but the problem is I want to sort the order of the results on the basis of the selection.\nSo after I've clicked the <em>search</em> button and the browser displayied the result set I want to order this specific result set by <em>expiration-date</em> or by <em>price</em> depending wich button i click.</p>\n\n<pre><code>   //SELECTION DATA FORM \n   &lt;form action=\"EVENTS_SELECTION.PHP\"&gt;\n     &lt;select name=\"Type\"&gt;\n     &lt;option value=\"\"&gt;SPORT\n     &lt;option value=\"\"&gt;CULTURE       \n     &lt;option value=\"\"&gt;LEISURE\n     &lt;option value=\"\"&gt;GASTRONOMY\n     &lt;/select&gt;  \n\n     &lt;select name=\"WHERE\"&gt;\n     &lt;option&gt;ROME ALL\n     &lt;option&gt;ROME SOUTH\n     &lt;option&gt;ROME WEST\n     &lt;option&gt;ROME EAST\n     &lt;option&gt;ROME NORTH\n     &lt;/select&gt;\n\n     &lt;input type=\"submit\" value=\"search\"&gt;   \n &lt;/form&gt; \n</code></pre>\n\n<p>how can I achieve that??\nthanks\nLuca</p>\n"},{"tags":["sql","query","dbms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":9593727,"title":"Inverted SQL query on a movie DBMS","body":"<p>I've got a task that says, find all firstname and surnames for those people who have been casting and directing in exactly same amount off movies, but where he/she has not been acting but only directing. Take in account only those who have been directing more than ten(10) movies.</p>\n\n<p>Here is the new query I tried:</p>\n\n<pre><code>SELECT p.firstname, p.lastname, COUNT(*) as CASTDIRECTING from PERSON p\n  INNER JOIN Filmparticipation fpCast ON fpCast.personid = p.personid\n  INNER JOIN Filmparticipation fpDirector ON fpDirector.personid = p.personid\n  INNER JOIN FilmItem fi ON fi.filmid = fpCast.filmid AND fi.filmid = fpDirector.filmid\n  INNER JOIN Film f ON f.filmid = fi.filmid\nWHERE (fpCast.parttype = 'cast' AND fpDirector.parttype = 'director' AND fpCast.personid = fpDirector.personid)\nGROUP BY p.lastname, p.firstname\nHAVING count(*) = (SELECT count(*) as DirectedOnly FROM Person p \n       INNER JOIN filmparticipation fpDirector ON fpDirector.personid = p.personid \n       INNER JOIN filmparticipation fpCast ON fpCast.personid = p.personid \n       WHERE (fpCast.parttype!='cast' AND fpDirector.parttype = 'director' AND \n           fpDirector.personid = fpCast.personid) \n       HAVING count(*) &gt; 10)\nORDER BY p.lastname ASC, p.firstname ASC;\n</code></pre>\n\n<p>Now it's returning empty rows. Do anyone see the errors in the query?</p>\n\n<p>Here are some relevant tables regarding the task..</p>\n\n<pre><code>create table filmparticipation (\n    partid int primary key,\n    personid int not null references person (personid),\n    filmid int not null references filmitem (filmid),\n    parttype text not null);\n\n\ncreate table person (\n    personid int primary key,\n    lastname text not null,\n    firstname text not null,\n    gender char(1),\n    check (gender = 'M' or gender = 'F'));\n\ncreate table filmitem (\n    filmid int primary key,\n    filmtype varchar(4) not null);\n\ncreate table film (\n    filmid int primary key references filmitem (filmid),\n    title text not null,\n    prodyear int);\n\ncreate index filmtitleindex on film (title);\ncreate index filmyearindex on film (prodyear);\n</code></pre>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13278372,"title":"Calculate mode in SQL","body":"<p>I have seen the answer from a previous post, which works fine but I have a small dilemma.\nTaking the same scenario:</p>\n\n<p><br>A table that list students' grades per class. I want a result set that looks like: </p>\n\n<pre><code>BIO...B \nCHEM...C \n</code></pre>\n\n<p><br>Where the \"B\" and \"C\" are the modes for the class and want to get the mode for the class.</p>\n\n<p>Once I applied the below query, i got the following output:</p>\n\n<pre><code>Class | Score | Freq  |  Ranking \n2010  |   B   | 8     |    1 \n2010  |   C   | 8     |    1 \n2011  |   A   | 10    |    1 \n2012  |   B   | 11    |    1\n</code></pre>\n\n<p>In 2010, I have two grades with the same frequency. What if..I just want to display the highest score, in this case will be \"B\". How can I achieve that? I would need to assign rankings to the letter grades, but I'm not sure how. Please advise.\nThanks.</p>\n\n<p>Prior post:\n<a href=\"http://stackoverflow.com/questions/2045075/sql-server-mode-sql\">SQL Server mode SQL</a></p>\n\n<p>The query I used to retrieve the data was the answer from Peter:</p>\n\n<pre><code>;WITH Ranked AS ( \nSELECT \n    ClassName, Grade \n    , GradeFreq = COUNT(*) \n    , Ranking = DENSE_RANK() OVER (PARTITION BY ClassName ORDER BY COUNT(*) DESC) \nFROM Scores \nGROUP BY ClassName, Grade \n) \nSELECT * FROM Ranked WHERE Ranking = 1\n</code></pre>\n"},{"tags":["php","mysql","query","phpexcel"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13243332,"title":"Removing fields from excel using phpexcel after MYSQL query","body":"<p>I'm using PHPExcel to export data from a MYSQL database and import it into an excel file.</p>\n\n<p><strong>I've got a database that looks like this (this is also what my excel file currently looks like when I generate it using PHPExcel):</strong></p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n| &lt;p&gt; Select an Answer&lt;p&gt;             |              | \n|----------------------------------------------------|\n|Are you a Male or female             |      M       | \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>I want my excel file to look like this:</strong></p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n|Are you a Male or female             |      M       | \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>I'm using this code:</strong></p>\n\n<pre><code>$objPHPExcel = new PHPExcel();\n\n$col = 1; \nwhile($row_data = mysql_fetch_assoc($result)) {\n    $row = 1;\n    if ($col == 1) {\n        $row_headings = array_keys($row_data);\n        foreach($row_headings as $value) {\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n            $row++;\n        }\n        $row = 1;\n        $col++;\n    }\n    foreach($row_data as $value) {\n      if (!strstr('&lt;p&gt;', $value)){\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n\n    $row++;\n         }\n    }\n    $col++;\n}\n</code></pre>\n"},{"tags":["java","query","jpa-2.0","criteria-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13270857,"title":"JPA 2 criteria API: How to select values from various joined tables without using Metamodel?","body":"<p>I have the following type of query that I wish to convert into a jpa criteria query and the following table structure:</p>\n\n<pre><code>Table A 1--&gt;1 Table B  1&lt;--* Table C (proceedings) *--&gt;1 Table D(prcoeedingsstatus)\n--------      --------       -------                     -------\n aID           bID           cID                         dID\n ...           ....          timestamp                   textValue\n f_bID         ....          f_bID       \n                             f_dID\n</code></pre>\n\n<p>1 A has 1 B, 1 B has many proceedings and each proceeding has a proceedingstatus.</p>\n\n<pre><code>SELECT a.*\n\nFROM ((a LEFT JOIN b ON a.f_b = b.id)\n        LEFT JOIN proceedings ON b.id = proceedings.f_b)\n        RIGHT JOIN proceedingsstatus ON proceedings.f_d = proceedingsstatus.id\n\nWHERE   d.textValue IN (\"some unique text\")\n        AND c.timestamp BETWEEN 'somedate' AND 'anotherdate'\n</code></pre>\n\n<p>When I now try to do something like this for the predicates:</p>\n\n<pre><code>Predicate conditions = (root.join(\"tableB\")\n                            .joinList(\"proceedings\")\n                            .join(\"proceedingsstatus\").get(\"textValue\"))\n                            .in(constraintList.getSelectedValues());\n\nPredicate time = cb.between((root.join(\"tableB\")\n                            .joinList(\"proceedings\")\n                            .&lt;Date&gt;get(\"timestamp\")), dt1.toDate(), dt2.toDate());\n\nconstraints = cb.and(conditions, time);\n</code></pre>\n\n<p>Right now it selects entries A where there is at least 1 occurrence of the right proceedingsstatus according to the conditions-predicate if in any of A's proceedings the 'timestamp' matches the time-predicate that I built.\nSo it would also select an entry A when C.timestamp is correct for a proceeding with the wrong textValue in D, if there is at least one entry C belonging to A with the right textvalue in D.  </p>\n\n<p>How can I change it so that it only selects A's where the proceedingsstatus has the right value AND the time of proceeds is correct?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13276318,"title":"Returning not found values in query","body":"<p>I'm working on a project, and I have a list of several thousand records that I need check.  I need to provide the list of the ones NOT found, and provide the query I use to locate them so my superiors can check their work.</p>\n\n<p>I'll admit I'm relatively new to SQL. I don't have access to create temporary tables, which is one way I had thought of to do this.</p>\n\n<p>A basic idea of what I'm doing:</p>\n\n<pre><code>select t.column1, t.column2\nfrom table1 t\nwhere t.column1 in ('value1','value2','value3')\n</code></pre>\n\n<p>If value1 and value3 are in the database, but value2 is not, I need to display value2 and not the others.</p>\n\n<p>I have tried <code>ISNULL</code>, embedding the query, and trying to select <code>NOT</code> values from the query.  </p>\n\n<p>I have searched for returning records not found in a query on Google and on this site, and still found nothing.</p>\n"},{"tags":["sql","query","ms-access","ms-jet-ace"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13277677,"title":"SQL for the following equation. Todays EMA = (Price * (2/11)) + ((1 - (2/11)) * Yesterdays EMA)","body":"<p>May I ask for your help with the following, please?</p>\n\n<p>I want to create an MS Jet/Ace/Access Query that returns a 10 day Exponential Moving Average (EMA) from a table of price data. The table format and a small set of its data is as follows …</p>\n\n<pre><code>TableName = Spot\nID (AutoNumber) aDate (DateTime)        Settle (Double)\n1               01/10/2007              16.056\n2               02/10/2007              15.625\n3               03/10/2007              15.655\n4               04/10/2007              15.686\n5               05/10/2007              15.810\n6               08/10/2007              15.665\n7               09/10/2007              15.908\n8               10/10/2007              16.004\n9               11/10/2007              16.319\n10              12/10/2007              16.233\n</code></pre>\n\n<p>In case you are not aware of Exponential Moving Averages, the following websites may help explain them …</p>\n\n<p><a href=\"http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a\" rel=\"nofollow\">http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a</a></p>\n\n<p><a href=\"http://www.pandacash.com/technical-analysis/moving-average/exponential.htm\" rel=\"nofollow\">http://www.pandacash.com/technical-analysis/moving-average/exponential.htm</a></p>\n\n<p>However, hopefuly I can explain the equation to you. </p>\n\n<pre><code>Todays EMA = (Settle * Exponent) + ((1 - Exponent) * Yesterdays EMA)\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>Settle = Closing price of the Stock / Asset\nExponent = (2 / (10 Days + 1)) ie 0.1818\n</code></pre>\n\n<p>I have a query that returns some of the values I need, but I am unable to find a solution to the whole thing.</p>\n\n<p>My Query, so far (hopefully the formatting makes it clearer to read)</p>\n\n<pre><code>SELECT aDate, Settle, \n\n   (SELECT((SELECT Settle \n            FROM   SPOT AS SubQ \n            WHERE  SubQ.ID = SS.ID)) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS YesterdaySettle,\n\n   ( 2 / 11 ) AS Exponent,\n\n   (SELECT Settle \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID) * ( Exponent ) AS [Part A],\n\n   ( 1 - Exponent ) AS [Part B],\n\n   (SELECT ((SELECT Settle \n              FROM   SPOT AS SubQ \n              WHERE  SubQ.ID = SS.ID) * ( 2 / 11 )) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS [Yesterdays Part A],\n\n   (SELECT SUM(Settle) \n    FROM   SPOT AS SubQ \n    WHERE  ID BETWEEN Spot.ID AND Spot.ID -9) / Iif(Spot.id &gt; 10, 10, Spot.id) AS [10DMA] \n\nFROM   SPOT\nORDER  BY aDate; \n</code></pre>\n\n<p>Based on the field names of my Query, my equation would be …</p>\n\n<pre><code>Todays EMA = ([Part A])  + ([Part B] * [Part C])\n</code></pre>\n\n<p>And I would expect results similar to the following.</p>\n\n<pre><code>[10DMA] [Exponent]  [Part A]    [Part B]    [Part C] (Previous EMA)     [EMA]\n15.896  0.181818182 2.919272727 0.818181818     USE 10DMA ie 15.896     15.925\n15.911  0.181818182 2.840909091 0.818181818                 15.925      15.871\n15.945  0.181818182 2.846363636 0.818181818                 15.871      15.831\n15.985  0.181818182 2.852       0.818181818                 15.831      15.805\n16.027  0.181818182 2.874545455 0.818181818                 15.805      15.806\n16.037  0.181818182 2.848181818 0.818181818                 15.806      15.780\n16.052  0.181818182 2.892363636 0.818181818                 15.780      15.803\n16.054  0.181818182 2.909818182 0.818181818                 15.803      15.840\n16.039  0.181818182 2.967090909 0.818181818                 15.840      15.927\n16.025  0.181818182 2.951454545 0.818181818                 15.927      15.983                  \n</code></pre>\n\n<p>The problem is I can’t figure out how to create the [Part C] field.</p>\n\n<p>Some points are …</p>\n\n<ul>\n<li>If there is no EMA for a day, then the [Part C] value should be\n[10DMA]. For example, the first record will not have a EMA so I need\nto use [10DMA]. </li>\n<li>If there is an EMA from yesterday, then use that value for todays [Part C].</li>\n</ul>\n\n<p>May I ask for some advice please. I kind of stumbled across what I have so far, But I am stumped for the Part C value.</p>\n\n<p>I thought I could do something along the lines of …</p>\n\n<pre><code>iif (EMA &lt;&gt; 0, EMA, [10DMA]) AS [Part C],\n    (([Part A]) + ([Part B] * [Part C])) AS EMA\n</code></pre>\n\n<p>However, I get an error relating to </p>\n\n<pre><code>Circular reference caused by alias 'Part C'.\n</code></pre>\n\n<p>Any advice would be gratefully received. Many thanks for your time.</p>\n\n<p>John.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13274827,"title":"MySQL query with MATCH on keyword","body":"<p>I'm having troubles understanding the MATCH in MySql. I have a table with Full Text Index on a \"keywords\"-field. The keywords are comma-separated.</p>\n\n<p>I'm testing with 3 rows, with the keywords: prep,rat,mouse</p>\n\n<p>When I search for either \"prep\" or \"rat\", I get the result I want. But if I search for \"mouse\", I get no results. This is the query I'm using:</p>\n\n<pre><code>SELECT *, MATCH(Keywords) AGAINST('mouse') AS Score\nFROM fs_Files\nWHERE MATCH(Keywords) AGAINST('mouse')\nORDER BY score DESC;\n</code></pre>\n\n<p>I've also tried with <code>IN BOOLEAN MODE</code> after 'mouse', but it's the same result.</p>\n\n<p><strong>EDIT</strong>\nIn my database-entry where I used the word 'mouse', I actually used the word 'mus' (which is mouse in Norwegian). I found that if I changed this to 'musebart' (just made the word longer), the search picks it up. Could it be too short with only 3 chars? Is MySql ignoring it (stopword?) since it only contains 3 chars?</p>\n\n<p><strong>EDIT AGAIN:</strong>\nBingo, it has to be at least 4 characters to be searchable. Or else, you have to change it (if you have the permission to do so) Link: <a href=\"http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html</a>.</p>\n"},{"tags":["mysql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13277453,"title":"Populating fields in MySQL Database","body":"<p>I have currently created a total of 12 tables in MySQL database. 11 of those tables share correlated data and are indexing with each other. I am undergoing some difficulties populating the values in each individual field of the tables and making sure they index properly. I was wondering if there is an easier way that I can populate each field in all tables for one record without doing it manually and having to worry for the proper <code>foreign_key</code> matches with the other table(indexing). Possibly a query can do the job but I am not sure how I can build such query. Or any other suggestions specifically tying to this example.</p>\n\n<p>Below are links to the desing of tables and a query if you will like to create an exact copy of tables in my database.</p>\n\n<p><a href=\"http://webprolearner.ueuo.com/class_des/table_structure.php\" rel=\"nofollow\">TABLE STRUCTURE/DESIGN</a></p>\n\n<p><a href=\"http://webprolearner.ueuo.com/class_des/query_create.php\" rel=\"nofollow\">QUERY FOR CREATING ALL TABLES</a></p>\n"},{"tags":["query","mongodb","absolute-value"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13275491,"title":"mongodb - Find document with closest integer value","body":"<p>Let's assume I have a collection with documents with a ratio attribute that is a floating point number.</p>\n\n<pre><code>{'ratio':1.437}\n</code></pre>\n\n<p>How do I write a query to find the single document with the closest value to a given integer without loading them all into memory using a driver and finding one with the smallest value of <code>abs(x-ratio)</code>?</p>\n"},{"tags":["ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13276375,"title":"ActiveRecord include with order","body":"<p>I have models:</p>\n\n<pre><code> class FirstModel &lt; AR::B\n   belongs_to :second_model\n end\n\n class SecondModel &lt; AR::B\n   #name\n   has_many :first_model\n end\n</code></pre>\n\n<p>I have code:</p>\n\n<pre><code> @a = FirstModel.where(#some query)\n @a.include([:second_model])\n</code></pre>\n\n<p>How i can include SecondModel with order by name?   </p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13276240,"title":"SQL query - whats the best way to do this","body":"<p>I have this query...</p>\n\n<pre><code>select * from selection_value where id = 14702\n14702\n14704\n14724\n14710\n14738\n14717\n14719\n14719\n14738\n14722\n14721\n14724\n14725\n14706\n14730\n14708\n14731\n14715\n14708\n14749\n14752\n14754\n14755\n14757\n14795\n14753\n14760\n14761\n14759\n14762\n14763\n14785\n14764\n14765\n14785\n14766\n14768\n14796\n14771\n14772\n14774\n14776\n14764\n14780\n14781\n14767\n14784\n14785\n14786\n14788\n14789\n14790\n14791\n14785\n14772\n14792\n14796\n14785\n14797\n14798\n14799\n14800\n14802\n14778\n14803\n14758\n14765\n14762\n14781\n14785\n14786\n14808\n14793\n14805\n14807\n14808\n</code></pre>\n\n<p>Now I know this will not work, I was just wondering whats the best way to get the data for all of these ids in this order?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["mysql","query","group-by","range"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1181,"score":1,"question_id":6687534,"title":"group by range in mysql","body":"<pre><code>Table:   \nnew_table                                                    \nuser_number  | diff                  \n     2       |  0                      \n     1       |  28  \n     2       |  32  \n     1       |  40  \n     1       |  53  \n     1       |  59  \n     1       |  101  \n     1       |  105  \n     2       |  108  \n     2       |  129  \n     2       |  130    \n     1       |  144  \n\n\n            |(result)\n            v\n\nrange  | number of users  \n0-20   |  2  \n21-41  |  3  \n42-62  |  1  \n63-83  |  2  \n84-104 |  1  \n105-135|  0  \n136-156|  3\n\n\nselect t.range as [range], count(*) as [number of users]  \nfrom (  \n  select case    \n    when diff between 0 and 20 then ' 0-20'  \n    when diff between 21 and 41 then ' 21-41'  \n    when diff between 42 and 62 then ' 42-62'  \n    when diff between 63 and 83 then ' 63-83'  \n    when diff between 84 and 104 then ' 84-104'  \n    when diff between 105 and 135 then ' 105-135'  \n    else '136-156'   \n     end as range  \n  from new_table) t  \ngroup by t.diff  \n\nError:\n\nYou have an error in your SQL syntax, near '[range], count(*) as [number of users]  \nfrom (  \n  select case  \n    when' at line 1  \n</code></pre>\n"},{"tags":["sql","query","dynamics-crm","dynamics-crm-2011","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13273956,"title":"SQL Query in CRM Report","body":"<p>A \"Case\" in CRM has a field called \"Status\" with four options.  </p>\n\n<p>I'm trying to\n build a report in CRM that fills a table with every week of the year (each row is a different week), and then counts the number of cases that have each Status option (the columns would be each of the Status options).</p>\n\n<p>The table would look like this </p>\n\n<pre><code>         Status 1    Status 2    Status 3\nWeek 1       3         55          4\nWeek 2       5         23          5\nWeek 3       14        11          33\n</code></pre>\n\n<p>So far I have the following: </p>\n\n<pre><code>SELECT \n    SUM(case WHEN status = 1 then 1 else 0 end) Status1,\n    SUM(case WHEN status = 2 then 1 else 0 end) Status2,\n    SUM(case WHEN status = 3 then 1 else 0 end) Status3,\n    SUM(case WHEN status = 4 then 1 else 0 end) Status4,\n    SUM(case WHEN status = 5 then 1 else 0 end) Status5\nFROM [DB].[dbo].[Contact]\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   2         43          53\n</code></pre>\n\n<p>Now I need to somehow split this into 52 rows for the past year and filter these results by date (columns in the Contact table).  I'm a bit new to SQL queries and CRM - any help here would be much appreciated.  </p>\n\n<p>Here is a SQLFiddle with my progress and sample data: <a href=\"http://sqlfiddle.com/#!2/85b19/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/85b19/1</a></p>\n"},{"tags":["wordpress","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13275354,"title":"What is wrong with this custom post type/custom field query?","body":"<p>Im trying to get related posts for actual post that user is seeing (custom post type named property)</p>\n\n<p>At the moment it only gives me the related post from the same 'pcategory' which are the categories for the post type.</p>\n\n<p>What I need is same post type category as it is now and also with the same post type custom field ('location').</p>\n\n<p>Tried many ways but was not able to get it. What is wrong?</p>\n\n<pre><code>$querystr = \"\nSELECT * FROM $wpdb-&gt;posts\nLEFT JOIN $wpdb-&gt;postmeta ON($wpdb-&gt;posts.ID = $wpdb-&gt;postmeta.post_id)\nLEFT JOIN $wpdb-&gt;term_relationships ON($wpdb-&gt;posts.ID = $wpdb-&gt;term_relationships.object_id)\nLEFT JOIN $wpdb-&gt;term_taxonomy ON($wpdb-&gt;term_relationships.term_taxonomy_id = $wpdb-&gt;term_taxonomy.term_taxonomy_id)\nLEFT JOIN $wpdb-&gt;terms ON($wpdb-&gt;term_taxonomy.term_id = $wpdb-&gt;terms.term_id)\n    WHERE $wpdb-&gt;terms.term_id in (\".$catId.\")\nAND $wpdb-&gt;term_taxonomy.taxonomy = 'pcategory'\nAND $wpdb-&gt;posts.post_status = 'publish'\nAND $wpdb-&gt;posts.post_type = 'property'\nAND $wpdb-&gt;postmeta.meta_key = 'location'\n\nORDER BY $wpdb-&gt;posts.ID LIMIT 0 ,$limit\";\n</code></pre>\n"},{"tags":["query","sql-server-2008-r2","left-join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13259980,"title":"How do I get a single result, from two tables, where the 2nd table contains an updated version of a record from the 1st?","body":"<p>I have two tables, <code>CompanyAddresses</code> &amp; <code>MyCompanyAddresses</code>. <em>(Names changed to protect the guilty).</em></p>\n\n<p><code>CompanyAddresses</code> holds a list of default addresses for companies. These records are immutable. The user can change the details of a company address, but those changes are stored <code>MyCompanyAddresses</code>.</p>\n\n<p>How can I produce a single list of addresses from both tables, excluding records from <code>CompanyAddresses</code> where a corresponding record exists in <code>MyCompanyAddresses</code>?</p>\n\n<h3>Sample Data</h3>\n\n<p>CompanyAddresses</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    1      | Guid1 | APL  | Apple     | 1 Infinite Loop   | Cupertino | 95014  | 11/1/2012\n    2      | Guid2 | MS   | Microsoft | One Microsoft Way | Redmond   | 98052  | 11/1/2012\n</code></pre>\n\n<p>MyCompanyAddresses</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    5      | Guid3 | APL  | Apple     | Updated Address   | Cupertino | 95014  | 11/6/2012\n</code></pre>\n\n<p>Desired Results</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    2      | Guid2 | MS   | Microsoft | One Microsoft Way | Redmond   | 98052  | 11/1/2012\n    5      | Guid3 | APL  | Apple     | Updated Address   | Cupertino | 95014  | 11/6/2012\n</code></pre>\n\n<p>I've tried various permutations of MS SQL's <code>UNION</code>, <code>EXCEPT</code> &amp; <code>INTERSECT</code> to no avail. Also, I don't believe <code>JOIN</code>'s are the answer either, but I'll be happily proven wrong.</p>\n\n<p>The database design <em>can</em> be changed, but it would be preferable if it stayed the same.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13276404,"title":"mysql run second query based on time stamp of an id from first query","body":"<p>I have a table \"test\". the stamp gets updated everytime table is updated.</p>\n\n<pre><code>id  |  text    |   stamp  \n__________________________ \n1   |  textA   |   2012-11-06 01:06:34\n2   |  textB   |   2012-11-06 01:01:34\n3   |  textC   |   2012-11-06 01:03:34\n4   |  textD   |   2012-11-06 01:05:34\n5   |  textE   |   2012-11-06 01:02:34\n6   |  textF   |   2012-11-06 01:08:34\n7   |  textG   |   2012-11-06 01:09:34\n8   |  textH   |   2012-11-06 01:04:34\n</code></pre>\n\n<p>I run a query \n\"SELECT * from test ORDER BY stamp DESC LIMIT 3\" (This returns rows with id 7,6 and 1)</p>\n\n<p>Now I have the id of the last row returned (ie 1). How do I use that id to run a second query to fetch next 3 rows where the time stamp &lt; stamp of id ? </p>\n\n<p>Expected result is rows 4,8,3.</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13273966,"title":"SQL: unique constraint and aggregate function","body":"<p>Presently I'm learning (MS) SQL, and was trying out various aggregate function samples. The question  I have is: Is there any scenario (sample query that uses aggregate function) where having a unique constraint column (on a table) helps when using an aggregate function.</p>\n\n<p>Please note: I'm not trying to find a solution to a problem, but trying to see if such a scenario exist in real world SQL programming.</p>\n"},{"tags":["mysql","sql","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13275271,"title":"SQL Joining another table based on the ID of the initial table","body":"<p>I really just can't seem to grasb the sytanx of SQL Joins, etc ... so I'm needing some help with this (which I think is quite simple)</p>\n\n<p>I'm querying <code>bid_tag</code> as follows:</p>\n\n<pre><code>SELECT paid_date, term, pet_id FROM bid_tag WHERE active = 1\n</code></pre>\n\n<p>And I need to use the <code>pet_id</code> to then grab some information from another table <code>wp_postmeta</code>, where the table is actually in a <code>meta_key</code> <code>meta_value</code> structure (WordPress) ...</p>\n\n<p>So I need to grab the <code>meta_value</code> of <code>meta_key</code> \"bid_name\", for example... amongst other values.</p>\n\n<pre><code>TABLE\nid | meta_key | meta_value\n1    bid_name    Max\n</code></pre>\n\n<p>That <code>ID</code> is the same <code>ID</code> that I need to connect the initial table to...</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["sql","query","search","search-engine","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13275510,"title":"How to retrieve records based on multiple bit of strings present in those records?","body":"<p>I am using Ruby on Rails v3.2.2 and the MySQL database. I have a database table containing data as-like the following (note: the <code>column1</code> contains comma separated strings):</p>\n\n<pre><code>id   | column1                          | column2 | columnM    \n-----|-----------------------------------------------------\n1    | one1                             | value1  |  ...\n2    | one1, two1                       | value1  |  ...\n3    | one1, two1, three1               | value1  |  ...\n4    | one2                             | value2  |  ...\n5    | one2, two2                       | value2  |  ...\n6    | one2, two2, three2               | value2  |  ...\n...  | ...                              | ...     |  ...\n1000 | oneN                             | valueN  |  ...\n1001 | oneN, twoN                       | valueN  |  ...\n1002 | oneN, twoN, threeN               | valueN  |  ...\n1003 | oneN, twoN, threeN, fourN        | valueN  |  ...\n</code></pre>\n\n<p>I would like to write a SQL query so to retrieve <em>records starting at the same time with one or more bit of strings</em> present in the <code>column1</code>. That is, for instance, given I search the <code>column1</code> for <em>strings</em></p>\n\n<pre><code>Case 1: \"thr\"\nCase 2: \"two1 thr\"\nCase 3: \"two thr\"\nCase 4: \"wo\"\nCase 5: \"one\"\nCase 6: \"four one\"\n</code></pre>\n\n<p>Then, I would like to get respectively records with following <code>id</code>s:</p>\n\n<pre><code>Case 1: 3, 6, 1002, 1003                         # returns all records starting with \"thr\"\nCase 2: 3                                        # returns all records starting with \"two1\" and at the same time starting with \"thr\" \nCase 3: 3, 6, 1002, 1003                         # returns all records starting with \"two\" and at the same time starting with \"thr\"\nCase 4:                                          # nothing to return\nCase 5: 1, 2, 3, 4, 5, 6, 1000, 1001, 1002, 1003 # returns all records starting with \"one\"\nCase 6: 1003                                     # returns all records starting with \"four\" and at the same time starting with \"one\"\n</code></pre>\n\n<p><em>How can I make the SQL query to behave as the above</em> (maybe, by using something as like wildcards or other things unknown to me)<em>?</em> Since I am trying to implement a \"simple\" search engine, what do you advice about? Is there some prescriptions?</p>\n"},{"tags":["sql","query","sqlite","parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13242543,"title":"Parsing simplified SQL queries with Perl into SQLite","body":"<p>I am trying to turn a \"simplified\" sql query into a working SQLite one to use against XnViews databases, meaning the database layout is at best suboptimal for what I'm trying to do AND I can't change anything about that.</p>\n\n<p>Example would be \"(cat_10 and cat_12) and (cat_5 or cat_7)\".</p>\n\n<p>This should be used against the table \"t3\", which has the fields \"if\" (fileID) and \"ic\" (categoryID).</p>\n\n<p>The entries look like this:</p>\n\n<pre><code>if, ic\n7, 10\n7, 12\n7, 4\n9, 10\n9, 12\n9, 5\n10, 10\n10, 12\n10, 7\n</code></pre>\n\n<p>The simplified query above should only select the files 9 and 10 as 7 does have the wanted categories 10 and 12 but has neither 5 nor 7.</p>\n\n<p>The actual problem now is building that hell of a query statement because it took me already some hours to simply get an AND between two categories working.</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\n</code></pre>\n\n<p>This gives me all fileIDs that contain category 10 and 12, but I have no idea how I should combine that with the remaining \" and (cat_5 or cat_7)\".</p>\n\n<p>When I planned these simplified sql statements (made by a click-it-together-builder made in html and js) I was planning to simply replace \"cat_5\" with \"t3.ic = 5\" and leave the rest as it is.</p>\n\n<p>Of course I didn't forsee that it wouldn't work as where checks the entry as a whole and there can't be ic = 5 AND ic = 7. That pretty much broke everything.</p>\n\n<p>So I'm wondering if anyone would have an idea how I could translate these simple queries in actual working ones, keeping in mind that it might not be limited to ( x and y ) pairs.</p>\n\n<p>Edit: I worked out how to do the example I've given, I think atleast:</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\nINTERSECT if FROM t3 WHERE ic IN (5, 7) GROUP BY if\n</code></pre>\n\n<p>But the main problem now is resolving the ( ) in the right order.</p>\n\n<p>Edit 2: I think I'm giving grouping the categories into one field with group_concat() a try, then I should be able to simply to cats LIKE \"  \" AND which would be small blocks I could easy throw together, then just the brackets and it should work. Highlighting the 'should'.</p>\n"},{"tags":["windows","query","c#-4.0","wmi","groups"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5,"score":1,"question_id":13275158,"title":"How to get all windows groups along with their permissions using WMI C#?","body":"<p>I am trying to read</p>\n\n<ol>\n<li>All <strong>Groups</strong> of Users in Windows</li>\n<li><strong>Permissions</strong> (ACL, DACL etc) on each group.</li>\n</ol>\n\n<p>Here is my code</p>\n\n<pre><code>public List&lt;GroupPermissions&gt; GetGroups()\n    {\n        var scope = new ManagementScope(\"\\\\\\\\.\\\\ROOT\\\\cimv2\");\n        var sQuery = new SelectQuery(\"Select * from Win32_SecurityDescriptor\");\n        var secDesc = new List&lt;GroupPermissions&gt;();\n        try\n        {\n            var mSearcher = new ManagementObjectSearcher(scope,sQuery);\n\n            foreach (ManagementObject mObject in mSearcher.Get())\n            {\n                var sDObj = new GroupPermissions();\n                var aceList = new List&lt;ACE&gt;();\n                var saceList = new List&lt;ACE&gt;();\n\n                var aceobjs = (ManagementObjectCollection)mObject[\"DACL\"];\n                var aceobjsS = (ManagementObjectCollection)mObject[\"SACL\"];\n                var gpTt = (ManagementObject)mObject[\"Group\"];\n                var ownerTt = (ManagementObject)mObject[\"Owner\"];\n                var sids = (UInt16[]) gpTt[\"SID\"];\n                    var osids= (UInt16[]) ownerTt[\"SID\"];\n                    var groupTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(gpTt[\"Domain\"]),\n                                               Name = Convert.ToString(gpTt[\"Name\"]),\n                                               SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                                               SID = sids\n                                           };\n                      var ownerTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(ownerTt[\"Domain\"]),\n                                               Name = Convert.ToString(ownerTt[\"Name\"]),\n                                               SIDString = Convert.ToString(ownerTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(ownerTt[\"SidLength\"]),\n                                               SID = osids\n                                           };\n\n                foreach (ManagementObject ace in aceobjs)\n                {\n                    var dTrustee = (ManagementObject)ace[\"Trustee\"];\n                    var daclSids= (UInt16[]) dTrustee [\"SID\"];\n                    var daclTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(gpTt[\"Domain\"]),\n                                               Name = Convert.ToString(gpTt[\"Name\"]),\n                                               SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                                               SID = daclSids\n                                           };\n\n                    aceList.Add(new ACE()\n                                    {\n                                        AccessMask = Convert.ToUInt32(ace[\"AccessMask\"]),\n                                        AceFlags = Convert.ToUInt32(ace[\"AceFlags\"]),\n                                        GuidInheritedObjectType = Convert.ToString(ace[\"GuidInheritedObjectType\"]),\n                                        AceType = Convert.ToUInt32(ace[\"AceType\"]),\n                                        GuidObjectType = Convert.ToString(ace[\"GuidObjectType\"]),\n                                        Trustee = daclTrustee \n\n                                    });\n                }\n                foreach (ManagementObject sace in aceobjsS)\n                {\n                    var dTrustee = (ManagementObject)sace[\"Trustee\"];\n                    var daclSids = (UInt16[])dTrustee[\"SID\"];\n                    var daclTrustee = new Trustee()\n                    {\n                        Domain = Convert.ToString(gpTt[\"Domain\"]),\n                        Name = Convert.ToString(gpTt[\"Name\"]),\n                        SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                        SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                        SID = daclSids\n                    };\n\n                    saceList.Add(new ACE()\n                    {\n                        AccessMask = Convert.ToUInt32(sace[\"AccessMask\"]),\n                        AceFlags = Convert.ToUInt32(sace[\"AceFlags\"]),\n                        GuidInheritedObjectType = Convert.ToString(sace[\"GuidInheritedObjectType\"]),\n                        AceType = Convert.ToUInt32(sace[\"AceType\"]),\n                        GuidObjectType = Convert.ToString(sace[\"GuidObjectType\"]),\n                        Trustee = daclTrustee\n\n                    });\n                }\n\n\n\n\n                sDObj.ControlFlags = Convert.ToUInt32(mObject[\"ControlFlags\"] ?? 0);\n                sDObj.DACL = aceList.ToArray();\n                sDObj.Group = groupTrustee;\n                sDObj.Owner = ownerTrustee;\n                sDObj.SACL = saceList.ToArray();\n                secDesc.Add(sDObj);\n            }\n        }\n        catch (Exception ex)\n        {\n\n        }\n        return secDesc;\n\n    }\n</code></pre>\n\n<p>and dependent classes that i have created (in copy of WMI classes)</p>\n\n<pre><code>    public class GroupPermissions\n    {\n        public UInt32 ControlFlags;\n        public ACE[] DACL;\n        public Trustee Group;\n        public Trustee Owner;\n        public ACE[] SACL;\n    }\n\n    public class ACE\n    {\n        public UInt32 AccessMask;\n        public UInt32 AceFlags;\n        public UInt32 AceType;\n        public string GuidInheritedObjectType;\n        public string GuidObjectType;\n        public Trustee Trustee;\n    };\n\n    public class Trustee\n    {\n        public string Domain;\n        public string Name;\n        public UInt16[] SID;\n        public UInt32 SidLength;\n        public string SIDString;\n    };\n</code></pre>\n\n<p>It returns nothing. The list object is empty. I am definitely doing something wrong. Can some one please help me out? Thank you</p>\n\n<p>Steve</p>\n"},{"tags":["mysql","sql","query","sql-order-by","order"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13271667,"title":"MySQL order by multiple columns while grouping by one","body":"<p>So I have a weird scenario where I want the following data to be ordered in a certain way. Let the table data be:</p>\n\n<pre><code>abc 111 2     priority\nabc 111 blah  data\nabc 222 1     priority\nabc 222 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>I want to order that data based on column three (where column 4 is priority) but keep the return order grouped by column 2. So the expected query result would look like:</p>\n\n<pre><code>abc 222 1     priority\nabc 222 blah  data\nabc 111 2     priority\nabc 111 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>What's the best possible way of doing this. I can think of doing a query up front and an in clause, but then I would have to account for all possible priorities.</p>\n\n<p>Thanks in advance. FYI, its MySQL that I am using.</p>\n\n<p>ANSWER (but still looking to see if someone has a more efficient way)\ngiven - </p>\n\n<pre><code>CREATE TABLE my_data( name VARCHAR(20),groupid INT(5), attributekey VARCHAR(10),attributevalue VARCHAR(10));\n\nINSERT INTO my_data VALUES(\"abc\", 111, \"priority\", \"2\");\nINSERT INTO my_data VALUES(\"abc\", 111, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"priority\", \"1\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"priority\", \"3\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"someattr\", \"blah\");\n</code></pre>\n\n<p>solution -</p>\n\n<pre><code>SELECT m1.*,\n(select attributevalue from my_data m2\n   where m1.groupid=m2.groupid \n   AND m2.attributekey='priority' \n) groupidpriority \nFROM my_data m1\norder by groupidpriority;\n</code></pre>\n"},{"tags":["mysql","sql","query","optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13241119,"title":"Problems with a slow Dependent Subquery","body":"<p>I have a query I'm running in MySQL.  As you can see, every part of the query is on indexed fields.  Nevertheless, the query takes forever (tens of minutes, longer than I'm willing to wait).  The Connect tables consist of two integers and two indexes (one field one, field two, the other field two, field one). Source and target are tables with a single indexed int field.  Given all the indexes, I expected this query to finish in seconds.  Any suggestions on 1: why it's taking so long, and 2: how to make it faster?</p>\n\n<p>Thanks!</p>\n\n<pre><code>mysql&gt; explain \nSELECT DISTINCT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n  JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n  JOIN InDels2 AS source ON source.id = snpEConnect.indelID \n  WHERE geneConnect.geneSymbolID NOT IN (\n    SELECT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n    JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n    JOIN InDels3 AS target ON target.id = snpEConnect.indelID);\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n| id | select_type        | table       | type  | possible_keys     | key      | key_len | ref                                                                   | rows | Extra                          |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n|  1 | PRIMARY            | source      | index | id                | id       | 4       | NULL                                                                  | 5771 | Using index; Using temporary   |\n|  1 | PRIMARY            | snpEConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.source.id                                           |    2 | Using index                    |\n|  1 | PRIMARY            | geneConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.snpEConnect.snpEffectID                             |    1 | Using where; Using index       |\n|  2 | DEPENDENT SUBQUERY | geneConnect | ref   | snpEList,geneList | geneList | 4       | func                                                                  |    1 | Using index                    |\n|  2 | DEPENDENT SUBQUERY | target      | index | id                | id       | 4       | NULL                                                                  | 6297 | Using index; Using join buffer |\n|  2 | DEPENDENT SUBQUERY | snpEConnect | ref   | snpEList          | snpEList | 8       | treattablebrowser.target.id,treattablebrowser.geneConnect.snpEffectID |    1 | Using index                    |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n</code></pre>\n\n<p>6 rows in set (0.01 sec)</p>\n"},{"tags":["python","django","query","order","concatenation"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13273805,"title":"django : concatenate 2 queries or special order?","body":"<p>I have to make such query :</p>\n\n<pre><code>similar_brokers_ = Profile.objects.filter(Q(tp=broker.tp) |  Q(md=broker.md)).exclude(Q(id=broker.id))[:4]\n</code></pre>\n\n<p>i need to get 4 similar brokers, which have the same <code>tp</code> field or <code>md</code> field</p>\n\n<p>so this query does it, but i need brokers with the same <code>tp</code> field go first, after them should go brokers with the same <code>md</code> field.</p>\n\n<p>how can i do it better?</p>\n\n<p>for example :</p>\n\n<pre><code>broker1  with tp=1, md=100\nbroker2  with tp=2, md=100\nbroker3  with tp=1, md=99\n</code></pre>\n\n<p>get brokers similat to <code>broker1</code> :\nfirst should go <code>broker3</code> (with <code>tp</code>=1) and after <code>broker2</code> (with <code>md</code>=100)</p>\n"},{"tags":["sql","database","query","count","db2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13273023,"title":"DB2 - Printing info in a Count","body":"<p>Here is the question and my attempt at an answer. I believe that it's successfully selecting records that have borrowed more than one book, I just don't know how to print the book info.</p>\n\n<p>--Find the cardholders (b_name, b_addr) who have borrowed exactly 3 books. Include in your answer the author and title of the borrowed books. </p>\n\n<pre><code>SELECT DISTINCT b_name, b_addr\nFROM cardholder ch, copy c, book k\nWHERE ch.borrowerid IN (SELECT borrowerid\n                        FROM borrows b\n                        WHERE b.borrowerid = ch.borrowerid \n                        AND c.accession_no = b.accession_no\n                        GROUP BY borrowerid\n                        HAVING COUNT(DISTINCT l_date) = 3);\n</code></pre>\n"},{"tags":["sql","sql-server","query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13274256,"title":"Swapping rows and columns in a \"Group by\" query","body":"<p>I currently have the following: </p>\n\n<pre><code>SELECT status,count(status) AS count\n  FROM [DB].[dbo].[contact]\n  GROUP BY status\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   |   12\nStatus 2   |   23\nStatus 3   |   63\n</code></pre>\n\n<p>I'm trying to get the table to look like this: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   12        23         63\n</code></pre>\n\n<p>Eventually the table will look like this: </p>\n\n<pre><code>                 Status 1   Status 2   Status 3  \nDate Range 1        12        23         63\nDate Range 2        23        2           3       \n</code></pre>\n\n<p>I'm just not sure what to do now.  What kind of SQL commands / syntax should I study to get this done?  This is my first time looking at SQL so any pointers would be awesome.  </p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13267870,"title":"optimizing a delete query for table with no index?","body":"<p>Let's say we have the following tables:\nr(a, b, c)\nwhere a is some integer, and the table has 50 rows\ns(d, e, f, a)\ns.a is a foreign key onto t.a.\neach tuple is 400 bytes and s is a multiset since this is a SQL database.\ns holds about 1 million tuples. \nwhen a table is added, the database server automatically creates an index on the primary-­‐key columns in the table so for example t has an index on a. However, Oracle does not create indexes on columns that are foreign keys. So s has no index.\nWe want to delete 15 rows from t. So here is what we do:\n1) We remove rows from s that have the same a values in t. This takes 10 minutes.\n2) Then we run the statement DELETE FROM t WHERE a IN (values we are trying to remove, 15 of them to be exact)\nThis takes about 6 hours. </p>\n\n<p>So my guess is the second step takes a long time because for every tuple in t, we are comparing the value of a to every value within the query list. So how can we optimize this query to get the same result but much faster!?</p>\n"},{"tags":["php","database","security","query","hash"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":3426,"score":14,"question_id":3665247,"title":"Fastest hash for non-cryptographic uses?","body":"<p>I'm essentially preparing phrases to be put into the database, they may be malformed so I want to store a short hash of them instead (I will be simply comparing if they exist or not, so hash is ideal).</p>\n\n<p>I assume MD5 is fairly slow on 100,000+ requests so I wanted to know what would be the best method to hash the phrases, maybe rolling out my own hash function or using <code>hash('md4', '...'</code> would be faster in the end?</p>\n\n<p>I know MySQL has MD5(), so that would complement a bit of speed on the query end, but maybe there's further a faster hashing function in MySQL I don't know about that would work with PHP..</p>\n"},{"tags":["query","ms-access","microsoft"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":33,"score":-3,"question_id":13272320,"title":"Number of Columns in Ms Access 2010?","body":"<p>I have 52 Yes/No Columns for attendance Weekly .. I want to make query to know the number of columns that put in it a Yes or No .. Can anyone help me to solve this problem ?.. And if any recommend sites or community to Access Query ... So you will have my Thanks.</p>\n"},{"tags":["sql","sql-server-2008","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13273705,"title":"SQL to bring back material names","body":"<p>The below code is a result of a query i have created, it all works fine apart from one thing.  I have Material ID's for material names:</p>\n\n<pre><code>1 = bath\n2 = sink\n3 = toilet\n</code></pre>\n\n<p>The below works but displays sink for every material</p>\n\n<pre><code>Select cu.FName + '  ' + cu.SName as 'Name', \ncu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \ncu.PostCode, \nco.DateOrdered,\nco.Material1,\nma.MaterialName,\nco.material2, \nma.MaterialName, \nma.Price as 'Item Price' \nfrom Customers cu \nleft join CustomerOrder co on co.CustomerID = cu.CustomerID\nleft join ItemOrder it on it.OrderID = co.OrderID \nleft join Materials ma on ma.MaterialID = co.Material1 \nor co.material2 = ma.MaterialItemID or co.material3 = ma.MaterialItemID\n</code></pre>\n\n<p>it displays as follows (just the materials are listed to stop confusion)</p>\n\n<pre><code>Material1 | MaterialName | Material2 | Material2Name | Material3 | Material3Name\n    1          Sink            2           Sink           3             Sink\n</code></pre>\n\n<p>Can anybody help with this?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13273343,"title":"REPLACE new line character in MYSql not working","body":"<p>I executed following query and for some reason its not replacing new line character in database . It says Rows matched 1 but no change . What can be wrong ?</p>\n\n<pre><code>mysql&gt; UPDATE aboutme SET abouttext=REPLACE(abouttext,'\\\\n','') WHERE userid='5099a95cd944b8.22468149';\nQuery OK, 0 rows affected (0.00 sec)\nRows matched: 1  Changed: 0  Warnings: 0\n</code></pre>\n"},{"tags":["query","erp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13273248,"title":"epicor baq search not working","body":"<p>I have created a BAQ in epicor 905700c. Under the BAQ Search tab I have selected Part.PartNum as the \"Like\" column. But when I try to use this BAQ for a part search it doesn't work properly. </p>\n\n<p>For instance, if I open Part Maintenance, and click the part button to search for available parts, the search form pops up. I select the BAQ search I just created. The search actually returns results, but when I try to select one, it does not populate the part field.</p>\n\n<p>This happens for every BAQ I have hooked up by way of partnum. All other BAQ searches work. </p>\n\n<p>I assume there is a setting somewhere in Epicor that did not get turned on properly when we did the install. Can anyone shed any light on why this is happening and how to fix it? Thanks!</p>\n"},{"tags":["mysql","sql","database","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":17,"score":3,"question_id":13272230,"title":"mysql - sum columns from multiple tables based on multiple id's","body":"<p>I have a mySQL database with a couple of identical tables. I need to join all the tables and sum up the views and hits every time the <code>id1</code> and <code>id2</code> are equal in at least 2 tables, or simply show the row if not. </p>\n\n<p>Please see below the tables structure:</p>\n\n<pre><code>Table1:\nid..id2...views...hits\n1...102...55......12\n2...103...12......22\n\nTable2:\nid..id2...views...hits\n1...123...512......13\n2...103...123......43\n\nTable3:\nid..id2...views...hits\n1...102...232......43\n2...103...100......70\n</code></pre>\n\n<p>The end result should be the following table:<br></p>\n\n<pre><code>id...id2...views...hits\n1....102...287....65   &lt;-- This one is the result of adding 1st row of table1 and 2nd row of table 2\n1....123...512....13   &lt;-- This is the 1st row of table2 as there's no other id2 = 123\n2....103...235....135 &lt;-- This is the sum of 2nd row in table1 + 2nd row in table2 + 2nd row in table3\n</code></pre>\n\n<p>I hope this makes sense and someone can help with it.</p>\n\n<p>Thanks !</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13272029,"title":"Efficient Way to Select if a database row value match a group of string","body":"<p>Efficient Way to Select if a database row value match a group of string</p>\n\n<pre><code>  SELECT id FROM tablename where \n    LeadStatus like \"%Contact Attempt 1%\" or \n    LeadStatus like \"%Contact Attempt 2%\" or \n    LeadStatus like \"%Contact Attempt 3%\" or \n    LeadStatus like \"%Contact Attempt 4%\" or \n    LeadStatus like \"%Contact Attempt 5%\" or \n    LeadStatus like \"%Contact Attempt 6%\" or \n    LeadStatus like \"%Contact Attempt 7%\" or \n    LeadStatus like \"%Call Back/Follow-up%\" or \n    LeadStatus like \"%Working%\" or \n    LeadStatus like \"%Credit Pulled%\" or \n    LeadStatus like \"%Selected other Lender%\" or \n    LeadStatus like \"%Pre-Approved%\" or \n    LeadStatus like \"%Application Taken/Sent%\" or \n    LeadStatus like \"%Application Received%\" or \n    LeadStatus like \"%Submitted%\" or \n    LeadStatus like \"%Funded%\" or \n    LeadStatus like \"%Future Opportunity%\" or \n    LeadStatus like \"%Manager Review%\"\n</code></pre>\n\n<p>I think it clear enough that what I want?</p>\n\n<p><strong>Note :</strong> I can't change the <code>LeadStatus</code> value as it is fetched from a API not in my control </p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","query","webhooks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13272004,"title":"RnR: Long running query, Heroku timeouts: webhooks? Ajax?","body":"<p>So here's the issue, we have a data that the users want displayed.  The query, we optimized and indexed to be as fast as I think its going get.  We might shave off a second or two but with the amount of data, not much we can do.  </p>\n\n<p>Anyway, so the query runs great when limited to a day or two of data, however the users are running it for a week or two of data.  So the query for two or three weeks of data takes about 40 seconds, with a Heroku timeout of 30 seconds, that doesn't work.  So we need a solution.  </p>\n\n<p>So searching here and Google, I see comments that webhooks or Ajax would work as out solution.  However, I've been unable to find a real concrete example.  I also saw a comment where someone was saying we could send some kind of response that would \"reset the clock.\" But again sounded intriguing but couldn't find an example.  </p>\n\n<p>We're kind of under the gun, the users are unhappy, so we need a solution that is fast and simple.  Thanks in advance for your help! </p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13244369,"title":"MySql Query for generating report","body":"<p>I have one table which is having three fields:</p>\n\n<pre><code>Id, Creation Time, Fuel Level\n</code></pre>\n\n<p>Every two minutes we are getting data and inserting to database.For generating a fuel credit/debit statement i want to get starting(Stating of the day) and ending(End of the Day) Fuel Level.Can anyone help to form a query to generate this report?</p>\n\n<p>Search parameters will be date range.</p>\n\n<p>Id=10;creation time =2019-02-15 16:32:59;Fuel Level =20</p>\n\n<p>I created one sample schema here\n<a href=\"http://sqlfiddle.com/#!2/76dd5\" rel=\"nofollow\">http://sqlfiddle.com/#!2/76dd5</a></p>\n"},{"tags":["xml","query","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13267628,"title":"XPath query to check multiple nodes each has required value","body":"<p>My example XML is as follows:</p>\n\n<pre><code>&lt;FileList&gt;\n  &lt;File&gt;\n    &lt;Name&gt;20120427_1.pdf&lt;/Name&gt;\n    &lt;Size&gt;654441&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Country&lt;/Name&gt;\n      &lt;Value&gt;United States&lt;/Value&gt;\n    &lt;/Property&gt;\n   &lt;/File&gt;\n   &lt;File&gt;\n    &lt;Name&gt;Name2&lt;/Name&gt;\n    &lt;Size&gt;2147483647&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name4&lt;/Name&gt;\n      &lt;Value&gt;Value4&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name5&lt;/Name&gt;\n      &lt;Value&gt;Value5&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name6&lt;/Name&gt;\n      &lt;Value&gt;Value6&lt;/Value&gt;\n    &lt;/Property&gt;\n  &lt;/File&gt;\n  &lt;File&gt;\n    &lt;Name&gt;Name3&lt;/Name&gt;\n    &lt;Size&gt;2147483647&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name7&lt;/Name&gt;\n      &lt;Value&gt;Value7&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name8&lt;/Name&gt;\n      &lt;Value&gt;Value8&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Country&lt;/Name&gt;\n      &lt;Value&gt;UK&lt;/Value&gt;\n    &lt;/Property&gt;\n  &lt;/File&gt;\n&lt;/FileList&gt;\n</code></pre>\n\n<p>The requirement is that every file node has a Country value in the Propery/Name element. So far I've created an XPath query:</p>\n\n<pre><code>/FileList/File/Property/Name/text()='Country'\n</code></pre>\n\n<p>This passes as true as query is looking at all nodes when the answer should be false. How do I change it so it checks each 'File' node instead?</p>\n"},{"tags":["mysql","query","distinct","max"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13216762,"title":"Selecting most recent MySQL rows by MAX(time) WHERE time <= x","body":"<p>I am selecting the most recent entries of a MySQL table with:</p>\n\n<pre><code>SELECT MAX(time) as most_recent, userID\nFROM TableName\nGROUP BY userID\nORDER BY most_recent DESC\n</code></pre>\n\n<p>My problem is, if I want to limit the maximum time with:</p>\n\n<pre><code>WHERE time &lt;= nnn\n</code></pre>\n\n<p>The query does not work anymore. Is there a solution for with without a subquery?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["java","sql","database","query","jdbc"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":65,"score":-1,"question_id":13270154,"title":"SQL statements are being stored into database instead of values (simple but challenging )","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority.</p>\n\n<p>In the application, suppose a user's email address is \"david.ferno@gmail.com\". He will have to input only \"david.ferno\" in the JTextBox, and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices.</p>\n\n<p>I have used PreparedStatement for the SQL retrieval from database but when values are being inserted to the , instead of saving User ID like \"user88\", it is saving the SQL statement itself inside the database.</p>\n\n<p>What I mean to say is, in the \"priority\" table, instead of saving user88 (as an example), it is saving \"SELECT User_ID FROM user WHERE email_address\"</p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here is the \"user\" table structure >></strong> <br/></p>\n\n<pre><code> COLUMNNAME     TYPE\n ------------------- \n User_ID        Text\n full_name      Text \n last_name      Text\n email_address  Text\n phone          Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key</p>\n\n<p><strong>Here is the \"priority\" table structure >></strong> <br/></p>\n\n<pre><code>COLUMNNAME  TYPE \n----------------\nUser_ID     Text \nBook1       Text \nBook2       Text \nBook3       Text\nBook4       Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key </p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\n  public class Handleraddclassroom implements ActionListener{\n\n      public void actionPerformed(ActionEvent event) {\n          String name = ((JButton)event.getSource()).getText();\n\n          if (name.equals(\"Confirm\")) {\n              String filename = \"C:/JAVA/book.accdb\";\n              String database = \"jdbc:odbc:booking\";\n\n              if(txt_mail.getText().equals(\"\")) {\n                   JOptionPane.showMessageDialog(\n                                     addpriority.this, \n                                     \"Your Username Field cannot be blank\");\n              } else {\n                   try {\n                       Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                       //username &amp;password not being used\n                       Connection con = DriverManager.getConnection(database ,\"\",\"\"); \n                       Statement s = con.createStatement(\n                                          ResultSet.TYPE_SCROLL_INSENSITIVE, \n                                          ResultSet.CONCUR_READ_ONLY);\n\n                       String squery = \"SELECT User_ID FROM bookuser WHERE \" +\n                                        + \"email_address LIKE ?\";\n                       PreparedStatement pstmt = con.prepareStatement(squery);\n                       pstmt.setString (1, txt_mail.getText() + '*');\n                       pstmt.executeQuery();\n\n                       String sql = \"INSERT INTO priority VALUES('\" \n                                                 + squery + \"','\"\n                                                 + txt_book1.getText() + \"','\"\n                                                 + txt_book2.getText() + \"','\" \n                                                 + txt_book3.getText() + \"','\"\n                                                 + txt_book4.getText()+ \"')\";\n\n                       JOptionPane.showMessageDialog(addpriority.this,\n                                                     \"Choice Records Saved.\");\n\n                       dispose();\n                       Mainmenulecturer mml = new Mainmenulecturer();\n\n                       s.execute(sql);\n\n                       s.close();\n                       con.close();\n\n                   } catch (Exception e) {\n                        System.out.print(\"Error: \" + e);\n                   }\n              }\n          }\n      }   \n\n}\n</code></pre>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":27,"score":5,"question_id":13261636,"title":"Query: Tables with indexing/foregeing keys/correlated data","body":"<p>I am currently working with a MySQL database table structure. I found a great table structure online but i am not sure how to duplicate such thing. I am new to this and I am requesting help in creating a query that will create all tables( which have correlated data(index), foreign keys, many to many relationships, etc.). </p>\n\n<p><strong>Random</strong> I was able to make a query to select all fields:</p>\n\n<pre><code>SELECT *\n\nFROM schedule \n\nINNER JOIN semester \n\nON schedule.semester_id = semester.id\n\nINNER JOIN office_hours\n\nON office_hours.schedule_id = schedule.semester_id\n\nINNER JOIN faculty\n\nON faculty.id = office_hours.faculty_id\n\nINNER JOIN faculty_titles\n\nON faculty_titles.faculty_id = faculty.id\n\nINNER JOIN faculty_education\n\nON faculty_education.faculty_id = faculty.id \n\nINNER JOIN section\n\nON section.faculty_id = faculty.id \n\nINNER JOIN class\n\nON class.id = section.class_id\n\nINNER JOIN major_class_br\n</code></pre>\n"},{"tags":["sql","sql-server","query","datepart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270325,"title":"Using DATEPART for AM works correctly but does not work for PM query","body":"<p>I'm using a query to pull a report for our 3rd shift folks.  </p>\n\n<p>The issue I just noticed when the report was mailed with 0 results is that I have it set right now to run from 6pm to 5:59am the next morning.  Since I have the date field = the <code>GETDATE</code>, it doesn't see the results from the night prior(1800-2359).  I was thinking of having this just pull from like -12 hours, but the button can be pressed at anytime to look at results.  </p>\n\n<p>So if they pushed it before the end of the shift, it would show some of 1st shifts entries.  I want it to only run from 1800-0559 the next morning, no matter if the button is pressed before midnight or after midnight.  I hope this makes sense.  I'm not even sure if the between recognizes to go to 00 after it's hit 2359.  I have this built into a VB.net application, and they can press the button anytime they want to get results.  This is for management to track what is being done as the employees are required to enter data real time when issues are taking place.  </p>\n\n<p>Thanks for any help.  Hope I made enough sense!  :D</p>\n\n<pre><code>SELECT \n   Assignment, Datemodified, General, \n   IncNumber, NextSteps, PDCRStatus, \n   RootCause, Status, Summary, \n   Timings, UserID \nFROM \n   Turnover \nWHERE DATEPART(HOUR, datemodified) between 18 and 05 \nAND CONVERT(NVARCHAR(50),datemodified,103) = CONVERT(NVARCHAR(50),GETDATE(),103);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13263023,"title":"Need advice to re-create history of a table based on audit tables","body":"<p>OK folks, I have an urgent need. I am tasked with re-creating an accurate history of changes to  multiple fields of an active table retroactively based on individual audit tables for each field.  I have a SQL Server Agent job that does this currently on a daily basis starting 10/16/2012, but need to immediately add records to retrofit the history back to 1/1/2012.</p>\n\n<p>To compound my issue, I need to reflect daily changes to the full hierarchy from the top down based on these audit records.</p>\n\n<p>Here's what I have:</p>\n\n<p>Active Table:</p>\n\n<pre><code>empId varchar(20),\nfirst_name varchar(50),\nlast_name varchar(50),\ncost_center varchar(20), -- need to re-create history\nmgr_empId varchar(20), -- need to re-create history\nstart_dt date, -- starting date range of active record\nend_dt date, -- end of active record - default value of 12/31/2999 = active record\nhierarchy_empId varchar (200), --derived field from a nasty self-referencing function (12x)\nhierarchy_name varchar(1000) -- derived from the same functino as the field above.\n</code></pre>\n\n<p>Example:</p>\n\n<p>Employee A1000, Tim Lee enters the org on 3/1/2012 with manager Bill A with emp Id B1000 into cost center 01552.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   12/31/2999   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999   B1000         Bill A\n</pre>\n\n<p>On 5/1/2012 the nightly job picks up a delta for Tim, and Tim's cost center changes to  31550.  So his current record is updated with an end date of yesterday, and a new \"current\" record is entered, reflected below:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   4/30/2012   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999  B1000         Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012   12/31/2999  B1000>A1000   Bill A>Tim Lee\n</pre>\n\n<p>On 6/15/2012, a new manager Ben C, emp Id C1000, was hired underneath Tim's manager:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000         Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    12/31/2999  B1000               Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000         Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   12/31/2999  A1000>C1000         Bill A>Ben C\nA1000  Tim Lee  31550   B1000   6/15/2012   12/31/2999  B1000>C1000>A1000   Bill A>Ben C>Tim Lee\n</pre>\n\n<p>These updates must trickle down the hierarchy.  So, if something changes above Tim, it also must be reflected in his record.   </p>\n\n<p>On 7/15, Tim's original manager Bill A gets a new manager, Mark S, emp Id X3000.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000               Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    7/14/2012   B1000                     Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000               Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   7/14/2012   A1000>C1000               Bill A>Ben C\nA1000  Tim Lee  31550   C1000   6/15/2012   7/14/2012   B1000>C1000>A1000         Bill A>Ben C>Tim Lee\nX3000  Mark S   01000   NULL    7/15/2012   12/31/2999  X3000                     Mark S\nA1000  Tim Lee  31550   C1000   7/15/2012   12/31/2999  X3000>B1000>C1000>A1000   Mark S>Bill A>Ben C>Tim Lee\nB1000  Bill A   01552   X3000   7/15/2012   12/31/2999  X3000>B1000               Mark S>Bill A\nC1000  Ben C    31550   B1000   7/15/2012   12/31/2999  X3000>B1000>C1000              Mark S>Bill A>Ben C\n\n</pre>\n\n<p>I have these audit tables:</p>\n\n<p><strong>tblManagerAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimestamp datetime,\noldMgr varchar(20),\nnewMgr varchar(20)\n</code></pre>\n\n<p><strong>tblCostCenterAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimnestamp datetime,\noldCostCenter varchar(20),\nnewCostCenter varchar(20)\n</code></pre>\n\n<p>I have struggled with how to combine the audit records for a very long time and appreciate any input.</p>\n"},{"tags":["query","filter","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13248426,"title":"Query with multiple field values specified","body":"<p>I'm trying to perform an elasticsearch query with multiple fields specified. Here is some pseudo code which hopefully illustrates my intention:</p>\n\n<pre><code>\"query\" : {\n  \"query_string\" : { \"query\" : \"william\" }\n},\n\"filter\" : {\n  \"missing\" : { \"field\" : \"membership_expires_on\" }\n},\n\"filter\" : {\n  \"missing\" : { \"field\" : \"gender\" }\n},\n\"filter\" : {\n  \"terms\" : { \"status\" : \"p\"}\n},\n\"filter\" : {\n  \"terms\" : { \"unit_id\" : \"4\"}\n}\n</code></pre>\n\n<p>I'm trying to AND all these filters together, but from the <a href=\"http://www.elasticsearch.org/guide/reference/query-dsl/missing-filter.html\" rel=\"nofollow\">elasticsearch doc</a> I can't figure out how to put these specific filters into a single query. Any help would be greatly appreciated!</p>\n\n<p><strong>UPDATE</strong>: Here is what I have so far:</p>\n\n<pre><code>{\n  \"from\": 0,\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"missing\": {\n                \"field\": \"membership_expires_on\"\n              }\n            },\n            {\n              \"term\": {\n                \"status\": \"p\"\n              }\n            },\n            {\n              \"missing\": {\n                \"field\": \"gender\"\n              }\n            },\n            {\n              \"term\": {\n                \"unit\": \"4\"\n              }\n            }\n          ]\n        }\n      },\n      \"query\": {\n        \"query_string\": {\n          \"query\": \"william\"\n        }\n      }\n    }\n  },\n  \"size\": 10\n}\n</code></pre>\n\n<p>But this returns no results, so I'm doing something wrong. Am I wielding the bool filter with the array inside in an illegal manner?</p>\n\n<p><strong>Update 2</strong>: I've confirmed that the JSON above indeed is a valid query, so there's probably something amiss with my data/index. That will be a question for another day :-)</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13248287,"title":"appending 2 columns into one list in sql","body":"<p>I have 2 tables and each table has some 3 columns. i want to get one column such that one column from each table are apended one after the other</p>\n\n<pre><code> eg:- suppose one column in a table contains  hai, how, are, you.\n and another column in another column contains i, am, fine.\n i want a query which gives hai, how, are, you,i,am,fine. in just one column\n</code></pre>\n\n<p>can anybody give a query for this in sql...</p>\n"},{"tags":["sql","query","left-join","where-clause"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13266786,"title":"How to use where clause in Query with LEFT JOIN?","body":"<p>how to write my sql query correct? I would like to use WHERE clause in query, but I don't know  how is correct. This is my query with mistake:</p>\n\n<pre><code>**SELECT pil.[Buy-from Vendor No_],  pil.No_, pil.Amount, pil.Quantity \nFROM dbo.[„blk“ 2011$Purch_ Inv_ Line]AS pil\nWHERE pil.Type=5\nLEFT JOIN dbo.[„blk“ 2011$Purch_ Inv_ Header] AS pih\nON pil.[Document No_]=pih.No_\nORDER BY pil.amount**\n</code></pre>\n"},{"tags":["query","namespaces","space"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13155091,"title":"I don't query in storeprocedure Because head name fields have space","body":"<p>In Sql Server 2008. Have Fields \"First Name\". But this name have space. I try query this fields error: Invalid column name 'First'.</p>\n\n<p>How can i query this fields?</p>\n\n<p>Code:</p>\n\n<pre><code>SELECT em.First Name\nFROM Emp em\n</code></pre>\n\n<p>Thanks you for your time. :) </p>\n"},{"tags":["c#","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13266580,"title":"Complex Linq c# query","body":"<p>I tried this in LinqPad</p>\n\n<p>I have the following data and linq query which should return only 1 record and 2 images but returns 2 records and 4 images. </p>\n\n<p>I know i have something wrong but don't know what. I am looking for the users details + car details + images fro user: 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 </p>\n\n<p>It has something to do with the bids as when I delete one of he bids for user (0b3c2ba5-1538-4557-a6c0-7de701fd83e7 ) i then get 1 record and 2 images</p>\n\n<p><strong>TABLES<br>\n------</strong> </p>\n\n<h2>TABLE bids</h2>\n\n<pre><code>id      cardid  bidamount   dateplaced          usedid  \n\n43  83  625 2012-11-05 16:12:51.600 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n44  86  575 2012-11-05 16:15:02.257 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n45  83  650 2012-11-05 16:15:07.283 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n46  86  600 2012-11-05 17:45:04.140 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n47  86  625 2012-11-05 17:45:08.867 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n49  83  750 2012-11-07 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7  \n52  83  850 2012-11-08 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 \n</code></pre>\n\n<h2>TABLE userdetails</h2>\n\n<pre><code>userid                                  city    state  \n0b3c2ba5-1538-4557-a6c0-7de701fd83e7    Sydney  NSW  \n</code></pre>\n\n<h2>TABLE cars</h2>\n\n<pre><code>id  name     descr   listingOption priceStarting priceReserve  \n83  Valiant  Old Car     2              1000         1500  \n86  Volvo    Safe Car    3              3000         4500 \n</code></pre>\n\n<h2>TABLE auction_images</h2>\n\n<pre><code>id         image                                              belongs_to  \n71  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  83  \n72  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   83  \n75  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  86  \n76  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   86  \n</code></pre>\n\n<p><strong>QUERY\n-----</strong></p>\n\n<pre><code> var query = (from c in cars\n                         from ud in users_details\n                         from bd in bids\n                         orderby c.listingOption descending\n                         where a.userID == ud.userid\n                        &amp;&amp; c.id == bd.carID\n                        &amp;&amp; c.enabled == true\n                        &amp;&amp; bd.userID == new Guid(\"0b3c2ba5-1538-4557-a6c0-7de701fd83e7\")\n                         let images = from ai in auction_images\n                                      where ai.belongs_to == c.id\n                                      select ai\n\n                         let bid = (from b in bids\n                                    orderby b.id descending\n                                    where b.carID == c.id\n                                    select b.bidamount).FirstOrDefault()\n                         select\n                         new\n                         {\n                             images,\n                             bidamount = (bid != null ? bid : 0),\n                             ud.city,\n                             ud.state,\n                             c.name,\n                             c.descr,\n                             c.id,\n                             c.listingOption,\n                             c.priceStarting,\n                             c.priceReserve,\n                             bd.userID\n                         }\n                         );\n\nquery.Distinct().Dump();\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13261087,"title":"How to generate the mapping table in a many to many insert","body":"<p>I have a table of trades for Companys in an exchange. So for a given day I can have many trades for a company. I now want to take these trades and group them into positions.</p>\n\n<p>A trade can below to many positions depending on its attributes like country, type etc\na position can be made up of many trades.</p>\n\n<p>So I have the following tables</p>\n\n<p><strong>Table Trades</strong><br/></p>\n\n<pre><code>Id   Date      Company   Trade  Type\n1 2012-11-01     IBM     1000    A\n2 2012-11-01     IBM     3000    B\n3 2012-11-01     Dell    1000    A\n4 2012-11-01     HP      5000    A\n5 2012-11-01     HP      6000    A\n6 2012-11-01     HP      7000    B\n</code></pre>\n\n<p><strong>Table TradePositionMapping</strong><br/></p>\n\n<pre><code>PK     TableTradeID      PositionID\n1          1                100      --IBM 1000\n2          1                101      --IBM 1000\n3          2                101      --IBM 3000\n4          3                102      --Dell 1000\n5          4                103      --HP 5000\n6          5                103      --HP 6000\n7          4                104      --Hp 5000\n7          5                104      --Hp 6000\n7          6                104      --Hp 7000\n</code></pre>\n\n<p><strong>Table Position</strong><br/></p>\n\n<pre><code>PK   Company Position\n100   IBM      1000\n101   IBM      4000\n102   Dell     1000\n103   Hp      11000\n104   Hp      18000\n</code></pre>\n\n<p>So in the Positions above the IBM Trade ID 1 went to 2 Positions 100 and 101. Trade Id 2 also went to Position 101 giving a total of 4000</p>\n\n<p>Ok so the idea being that a trade can make up 1 or more positions and a position can have many trades. The business logic will determine what positions the trades flow to, so I have used A and B as flags for now just as an example.</p>\n\n<p>So to the question which is..</p>\n\n<p>When I select and aggregate from the Trades Table, I insert all the new positions that are made up from the various trades into the Positions table. Now what is the best way to create the mapping table.</p>\n\n<p>What I do at the moment is that I store the newly created Position Ids in a tempory table and then repeat the select that I would do to generate the postions in the first place.. and join to the tempory table. THis seems like a lot of duplication of code and I would like to know what the best practice is out there to do such a thing.</p>\n\n<p>best regards Mick</p>\n"},{"tags":["php","mysql","sql","query","opencart"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13257360,"title":"Using quotation mark in MySQL","body":"<p>I have a list of 1000 products I am currently importing into OpenCart. Some of the product titles contains an quotation mark to symbolise the inches (for example 5\").</p>\n\n<p>I have imported all of these products successfully using this query:</p>\n\n<pre><code>$data['name'] = mysql_escape_string($data['name']);\n$sql = \"INSERT INTO \".DB_PREFIX.\"product-description SET language_id = '1', name = '\".$data['name'].\"'\";\n$query = mysql_query($sql);\n</code></pre>\n\n<p>When I am in OpenCart the list of products also show proberly however when I go to edit the product the title input field (which is meant to show the title) cuts out the title from the \" symbol onwards.</p>\n\n<p>Here is a visual example:\n<img src=\"http://i.stack.imgur.com/HIpsV.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title is complete\n<img src=\"http://i.stack.imgur.com/93t7G.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title as been cut out after the \".</p>\n\n<p>I can confirm it is not an OpenCart coding error because if I manually insert products from the interface with a \" it works fine. The error must lie within my query.</p>\n\n<p>If there is a problem with my query, is there a query where I can update all the products rather than re-insert them?</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13266299,"title":"Query to Update Table using another table as information?","body":"<p>I have two tables, <code>Staff</code> and <code>Wages</code></p>\n\n<p><code>Staff</code> Contains </p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        \n  2   Name2       4      \n  3   Name3       1      \n  4   Name4       2      \n</code></pre>\n\n<p><code>Wages</code> Contains</p>\n\n<pre><code> JobID, Wage\n   1    1500\n   2    800\n   3    1600\n   4    2000\n</code></pre>\n\n<p>(There are alot more columns in the actual one I have just took the top 4)</p>\n\n<p>I am missing the wages inside the <code>Staff</code> table, and the wages I need in the staff table are the rates in the <code>Wages</code> table..</p>\n\n<p>So I need a query which would make the <code>Staff</code> table look like:</p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        800\n  2   Name2       4        2000\n  3   Name3       1        1500\n  4   Name4       2        800\n</code></pre>\n\n<p>An example Query which I tried was:</p>\n\n<pre><code>UPDATE `Staff` \nSET wage = (SELECT wage FROM `Wages`) \nWHERE jobID = (Select jobId FROM `Wages`)\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["query","lucene","wildcard","elasticsearch","proximity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13258997,"title":"elasticsearch Query - Wildcard or Stemming within a Span (i.e. Proximity Query)","body":"<p>I would like to construct an elasticsearch query (or filter) that detects whether two words with wildcards are within a certain distance of each other.  Is this possible with elasticsearch?</p>\n\n<p>For example, I would like a query that detects whether <code>pret*</code> and <code>ug*</code> are within five words of each other. Such a query should match <code>\"She is pretty and he is ugly.\"</code> </p>\n\n<p>I think I would need to use the <code>span_near</code> query, but <code>span_near</code> only accepts a series of <code>span_term</code>'s as arguments and <code>span_term</code> doesn't appear to allow wildcards.</p>\n\n<p>Is it possible to do this with elasticsearch? If not, is this possible with Lucene directly?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13265250,"title":"Query to return Pokemon with HP by Type","body":"<p>I have a database full of Pokemon Cards, and I want to do a query to find the pokemon that has the highest HP by each type. I want the view to show just the name, type, and HP of that pokemon.</p>\n\n<pre><code>SELECT MAX(HP), Type, name FROM `Pokemon` group by Type\n</code></pre>\n\n<p>I have this code. It returns the max HP but not the correct Pokemon. \nWill this code show multiple rows with the same HP for a single type?</p>\n"},{"tags":["sql-server-2008","query","table","select","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13263699,"title":"Is there any way to send a column value from outer query to inner sub query?","body":"<p>'Discussions' table schema</p>\n\n<pre><code>title      description    desid    replyto    upvote    downvote   views\nbrowser    used           a1        none        1          1       12\n-          bad topic      b2        a1          2          3       14\nsql        database       a3        none        4          5       34\n-          crome          b4        a3          3          4       12\n</code></pre>\n\n<p>The above table has two types of content types Main Topics and Comments. Unique content identifier 'desid' used to identify that its a main topic or a comment. 'desid' starts with 'a' for Main Topic and for comment 'desid' starts with 'b'. For comment 'replyto' is the 'desid' of main topic to which this comment is associated. </p>\n\n<p>I like to find out the list of the top main topics that are arranged on the basis of (upvote+downvote+visits+number of comments to it) addition. The following query gives top topics list in order of  (upvote+downvote+visits)</p>\n\n<p><code>select *</code> with highest number of <code>upvote+downvote+views</code> by query </p>\n\n<pre><code>select * \nfrom [DB_user1212].[dbo].[discussions] \nwhere desid like 'a%'\norder by (upvote+downvote+visited) desc\n</code></pre>\n\n<p>For (comments+upvote+downvote+views ) i tried </p>\n\n<pre><code>select *\nfrom [DB_user1212].[dbo].[discussions]\nwhere desid like 'a%'\norder by (select count(*)\n           from [DB_user1212].[dbo].[discussions]\n           where replyto = desid )+upvote+downvote+visited) desc \n</code></pre>\n\n<p>but it didn't work . Because its not possible to send desid from outer query to innner subquery. Please tell me how to solve this. Please note that I want solution in query language only.</p>\n"},{"tags":["sql-server","query","search","casting","binary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13264305,"title":"SQL Server : Like Syntax and Add operator Error","body":"<p>I am using this syntax and it should work well if only it doesn't get an error.</p>\n\n<pre><code>SELECT\n   e.user_key,\n   e.char_key,\n   CONVERT(VARCHAR,substring(e.char_data, 9, 16)) AS name,\n   p.CHAR_DATA\nFROM \n   CHAR_DATA0 AS e\nINNER JOIN  \n   CHAR_DATA1 AS p ON e.CHAR_KEY = p.CHAR_KEY\nWHERE \n   p.CHAR_DATA LIKE '%'+CAST(cast(reverse(CONVERT(BINARY, 9998)) as BINARY(2)) AS BINARY(2))+'%'\nORDER BY \n   char_key\n</code></pre>\n\n<p>I need help. How to change this code for it to work?</p>\n\n<p><code>CHAR_DATA</code> column is of type <code>BINARY(2000)</code></p>\n\n<p>I have data like so: (got it using select)</p>\n\n<pre><code> 0x04005C03020F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBA3B8C08000000BB3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBC3B8C08000000BD3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBE3B8C08000000BF3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFC03B8C08000000C13B8C08000000B5388B08020000B5388B08020000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBA3B8C08000000BB3B8C08000000B5388B08020000B5388B08020000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBC3B8C08000000BD3B8C080000000E2789080100000E278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBE3B8C08000000BF3B8C080000000E2789080100000E278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFC03B8C08000000C13BFFFF000000FFFFFFFFFFFFFFFFFFFFFFFFFFFF0F27FFFF0100000F27FFFF0100000E2789080000000E278908000000FFFFFFFFFFFFFF7E107F08000000EC168408000000B0177D080000000F27FFFF0100000F27FFFF0100000E2789080000000E27890800000052167C081E000052167C081E0000E2167D08000000271F2005000000FFFFFFFFFFFFFFFFFFFFFFFFFFFF0E2787080100000E27870801000052167C081E000052167C081E0000FFFFFFFFFFFFFF13127F08000000C813FFFF1E0000C813FFFF1E00000E2787080100000E27870801000028127A08000000BF3B2D05000000FFFFFFFFFFFFFF13127F08000000C813FFFF1E0000C813FFFF1E0000FFFFFFFFFFFFFFFFFFFFFFFFFFFF28127A08000000FFFFFFFFFFFFFF1B1A80081A00001B1A80081A0000E915FFFF1B0000E915FFFF1B000023067A0800000024147B0800000020120D05000000084792080100001B1A80081A00001B1A80081A0000E915FFFF1B0000E915FFFF1B000025067A0800000024147B0800000020120D05000000E21610050000000000009D000000FFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n</code></pre>\n\n<p>I need to search somewhere in those lines if it contains the entry I'm trying to find.</p>\n\n<p>What I'm trying to find is always 2 bytes. So I'm looking for 0x0E27 in the syntax above.</p>\n\n<p>This is a working syntax but its not what I want to do:</p>\n\n<pre><code>SELECT \n   CONVERT(INT,cast(reverse(substring(char_data, 37, 2)) as BINARY(2))) AS helm \nFROM CHAR_DATA0 \nWHERE CHAR_KEY = 5\n</code></pre>\n\n<p>Another this is if I use nvarchar(MAX) it gives results that doesn't even contain the data I'm trying to find.</p>\n"},{"tags":["mysql","sql","wordpress","query","posts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13071035,"title":"SQL query to extract all WordPress posts with categories","body":"<p>I need to extract all posts from my WordPress DB along with the associated categories and not sure how to write this query. I've taken a couple of stabs at it already with no joy and would appreciate the help?</p>\n\n<p><strong>EDIT: Here's what I have tried already:</strong></p>\n\n<pre><code>SELECT post_title, wpr.object_id, wp_terms.name\nFROM wp_terms\nINNER JOIN wp_term_taxonomy ON wp_terms.term_id = wp_term_taxonomy.term_id\nINNER JOIN wp_term_relationships wpr ON wpr.term_taxonomy_id = \nwp_term_taxonomy.term_taxonomy_id\nINNER JOIN wp_posts ON ID = wpr.object_id\nWHERE taxonomy = 'category' \nAND post_type = 'post' \nORDER by post_title\n</code></pre>\n\n<p>This seems to work but it returns 1,553 where I know I only have 1343 in my DB.</p>\n\n<p><strong>EDIT:</strong> \nWe did the same thing on another SQL query a little while ago and found that it was pulling in the revisions and other post types but thought that this was resolved using post_type = 'post'</p>\n\n<p><strong>EDIT:</strong>\nUpon looking at the number of categories in the DB, I come up with a total number of 216, 6 off the number if you subtract 1553 - 1343 = 216. So I think this total number of 1553 is coming from the wp_terms table which needs to be excluded and only those that are active with published posts should be shown?</p>\n\n<p><strong>EDIT:</strong>\nThe other possibility is that each post can have multiple categories, hence the reason for having more posts (1553). So how could I separate each posts into multiple categories?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13242249,"title":"Sorting mysql results by times from 3 tables","body":"<p>I have 3 tables: <code>questions</code>, <code>articles</code> and <code>pictures</code></p>\n\n<p>The rows in each table contain a current_timestamp column <code>posted</code>, and link to an id. I'd like to sort the results of the rows of all three by their timestamp and only echo the newest of the three (for example: if the question is newest from the ID, display that only)</p>\n\n<pre><code>if(count($interests) != 0){ foreach($interests as $interests_following){\n    $interestid = mysql_result(mysql_query(\"SELECT `id` FROM `interests` WHERE `name` = '$interests_following'\"),0);\n    $interestquestions = @mysql_result(mysql_query(\"SELECT `question_text`, `posted` FROM `questions` WHERE `interest` = '$interests_following'\"),0);\n    $interestarticles = @mysql_result(mysql_query(\"SELECT `article_title`, `posted` FROM `articles` WHERE `interest_id` = '$interestid'\"),0);\n    $interestpictures = @mysql_result(mysql_query(\"SELECT `interest_pic_title`, `posted` FROM `interest_pictures` WHERE `interest_id` = '$interestid'\"),0);\n\necho '.$interests_following.': //&lt;Only display 1 newest item (article/picture/question here&gt;\n</code></pre>\n"},{"tags":["query","solr","filter","schema"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13264580,"title":"Single schema versus multiple schemas in solr for different document types","body":"<p>What is the general rule of thumb when deciding between creating multiple schemas versus creating a single consolidated schema for different document types.</p>\n\n<p>For example, if I want to index a collection of products and a collection of articles, what general rules should be followed to determine whether they should be created in one schema (and then use solr fq filter query to filter on the document type) or created in two schemas. The number of overlapping fields? The need to return data across both document types and also be able to filter to a single type? </p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13264168,"title":"Query to delete where id is other than multiple values?","body":"<p>How would I make a query to  delete the column where id is other than multiple values?</p>\n\n<p>I tried</p>\n\n<pre><code>DELETE FROM `Player` WHERE `Player`.`Squad` != 3,\n4,\n8,\n9,\n10,\n11,\n21, \n31,\n36,\n43,\n64,\n65,\n66,\n71,\n74,\n103,\n105,\n154,\n171,\n190;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13263615,"title":"sql error(1242) : sub query returns more than 1 row","body":"<p>i have two tables <code>a_daily</code> and <code>o_daily_lcsgeneration</code>:</p>\n\n<p>i am trying this query : </p>\n\n<pre><code>update a_daily\nset\n  a_daily.Turbine_Generation =  \n   (\n     select sum(o_daily_lcsgeneration.Turbine_Generation) \n     from o_daily_lcsgeneration \n     where o_daily_lcsgeneration.Location = 1 \n     group by o_daily_lcsgeneration.Date\n  ) \n</code></pre>\n\n<p>but received the above error saying sub query more than 1 row</p>\n"},{"tags":["php","sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263569,"title":"Getting only the same result to appear in SQL","body":"<p>This is my code, later I will be putting it into php, but for the time being I am using it in a provided Query tester. We are doing the first degree of kevin bacon instead of the 6th.</p>\n\n<p><strong>My query is as follow:</strong> </p>\n\n<pre><code>SELECT name,year\nFROM actors\nJOIN roles ON roles.actor_id = actors.id\nJOIN movies ON movies.id=roles.movie_id\nWHERE actors.first_name= 'kevin' AND actors.last_name='bacon' OR actors.first_name= 'sean' AND actors.last_name='penn'\nORDER BY movies.name;\n</code></pre>\n\n<p><strong>it results in</strong> </p>\n\n<pre><code>Animal House 1978\nApollo 13 1995 \nFew Good Men, A 1992 \nFootloose 1984 \nHollow Man 2000 \nJFK 1991 \nMystic River 2003 \nMystic River 2003 \nPlanes, Trains &amp; Automobiles 1987 \nStir of Echoes 1999 \n</code></pre>\n\n<p><strong>How do I get it to show only Mystic River?</strong></p>\n"},{"tags":["sql","sql-server-2008","query","stored-procedures","triggers"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13193745,"title":"update column1 based on another column2 from same table without using trigger","body":"<p>scenario is :\nThere are many columns in my table like Col1 Col2 Col3 Col4.\nI want to set data of Col4 if VALUE of Col1 is changed. On firing update query value of Col1 may or may not change.</p>\n\n<p>I have implemented it through trigger.</p>\n\n<pre><code>Select @ISTDNotPossibleI = I.ISTDNotPossible From inserted i\nSelect @IsTDCompletedD = D.IsTDCompleted from deleted d\n\nIf (\n  (@IsTDCompletedD != @IsTDCompletedI) Or\n  (@ISTDNotPossibleD != @ISTDNotPossibleI) Or\n  (@IsTDDirectD != @IsTDDirectI) Or (\n    @IsTDCompletedD Is Null And\n    @IsTDCompletedI Is Not Null\n  ) Or (\n    @ISTDNotPossibleD Is Null And\n    @ISTDNotPossibleI Is Not Null\n  ) OR (\n    @IsTDDirectD Is Null And\n    @IsTDDirectI Is Not Null\n  )\n)\nBegin\n  Update \n    CRM_CarTDLog \n  Set\n    TDCompletedEventBy = @UpdatedBy,\n    TDCompletedEventOn = GetDate() \n  Where\n    Id = @UpdateID \nEnd\n</code></pre>\n\n<p>Problem is : this field is not likely to be updated regularly. But Col2 and Col3 are likely to be updated frequently. And since update query is being fired on this table frequently the trigger will be  fired frequently too. And it is increasing the overhead without serving any purpose.</p>\n\n<p>I want to solve this without using trigger. Please help me.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13262615,"title":"Construct query to create tables","body":"<p>I am currently working with a MySQL database table structure. I found a table structure online but i am not sure how to duplicate the exact tables structure. These tables share foreign keys and index with each other. I have attached a link that shows the tables are setup in the model I would like to duplicate. I am requesting help in creating a query that will create all tables with their correlated data.  <a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">LINK- TABLE STRUCTURE</a></p>\n\n<p><strong>Foreign keys</strong></p>\n\n<pre><code>semester_id\nfaculty_id\nschedule_id\nsection_id\nclass_id\nmajor_minor_id\n</code></pre>\n"},{"tags":["c#","mysql","query","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13262638,"title":"Search datetime in MySQL","body":"<p>I have a MySQL database, there's a table which have column Time's Type is <strong>Nvachar(50)</strong> and <strong>its values</strong> is <strong>kind like this \"05/09/2012 20:53:40:843\"</strong> *<em>(Month-date-year hour:mins:second:msecond)</em>*</p>\n\n<p>Now I want to query to get a record have Time after \"10/05/2012 01:00:30 PM\".\nI had code in C# to converted it to \"05/10/2012 13:00:30\" before making a query.\nMy Query : </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>But i got no record. So please tell me how can I can make it return record have time after the time above ???  </p>\n\n<p>More Info My C# code :</p>\n\n<pre><code>string tableName = \"ABCDFEGH\";\nstring date = \"05/10/2012 13:00:30\";\n\nvar query = \"SELECT * FROM \" + tableName + \" WHERE capTime &gt; '\" + date + \"' LIMIT 0, 1\";\n\nvar cmd = new MySqlCommand(query, connection);\nMySqlDataReader dataReader = null;\ntry\n{\ndataReader = cmd.ExecuteReader();\n}\n</code></pre>\n\n<p>I'm so so so so so so sorry. I made a mistake the query must be</p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>This query is successful return the record i need :)</p>\n\n<p>But soemhow I have mistyped it into </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05-10-2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>Sorry again, topic close. But tks for evveryone tried :) </p>\n"},{"tags":["query","hibernate","grails","data-binding","gorm"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13262418,"title":"GORM delay in binding SQL param to a query","body":"<p>Trying to tweak a long running grails service and going through the SQL logs I find this behavior that is puzzling me a bit. The hibernate generated query is parametrized and one would hope that the query would be cached in the db-server and the binding should be instantaneous as well (used Burt Beckwith's suggestions to implement the SQL logging). </p>\n\n<pre><code>2012-11-06 00:30:39,488 [Thread-22] DEBUG hibernate.SQL  -\n    /* criteria query */ select\n..\n..\n2012-11-06 00:30:39,605 [Thread-22] TRACE sql.BasicBinder  -  - binding parameter [1] as [TIMESTAMP] - \n</code></pre>\n\n<p>So, it looks like binding is happening after 100ms. I would like to know why should this happen? Other queries report the same time for query and binding. What can be done to make it more efficient?</p>\n"},{"tags":["php","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":7,"view_count":65,"score":-7,"question_id":13260741,"title":"Why doesn't this query return any results?","body":"<p>The query below returns nothing, and frankly I do not understand why. Any hint will be appreciated. Must be an error in the code</p>\n\n<pre><code>$query = sprintf(\"SELECT *, \n    unix_timestamp(StartDate) AS SD FROM %s AS a\n    FROM \" . AL_ARTICLES_TABLE . \" AS art\n    INNER JOIN \" . AL_USERS_TABLE . \" AS u ON art.AuthorID = u.UserID\n    WHERE a.Visible=1 AND a.Status=1  \n    AND a.IsFinished=1     LEFT JOIN \" . AL_CATASSOC_TABLE . \" \n    AS ca ON art.ArticleID = ca.ArticleID\n    INNER JOIN \" . AL_CATEGORIES_TABLE . \" \n    AS c ON ca.CategoryID = c.CategoryID \n    WHERE ca.CategoryID IN(%s) \n    AND art.Featured=1  \n    AND art.Visible=1 \n    AND c.inrecent=1  \n    AND art.Status=1  \n    AND unix_timestamp(a.StartDate) &lt;= unix_timestamp(now()) \n    AND (unix_timestamp(a.ExpiryDate) &gt;= unix_timestamp(now()) \n    OR a.EnableExpiry=0) %s  \n    ORDER BY StartDate DESC, ArticleID DESC %s\", \n    AL_ARTICLES_TABLE, AL_USERS_TABLE, AL_CATASSOC_TABLE, AL_CATEGORIES_TABLE, $podcastQuery, $limitArticles);\n</code></pre>\n"},{"tags":["mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13252509,"title":"Query for correlated tables","body":"<p>I am currently trying to run a query that will show all tables that correlate with each other. I did not make the table design. So I am running into some trouble in making: It's not clear how <code>office_hours</code> table correlates with <code>schedule</code> table? Overall how can I display properly all tables that correlate through a query? </p>\n\n<pre><code>SELECT * \nFROM schedule\nINNER JOIN semester ON schedule.semester_id = semester.id\nINNER JOIN office_hours ON office_hours.id = schedule.???\n</code></pre>\n"},{"tags":["java","query","sparql","jena"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13255744,"title":"Trying to create a Sparql query using Jena's java api","body":"<p>I created an Ontology model in Java using the Apache Jena library, and I entered pizza ontology.\nI am trying to make a sparql query but the table print is blank, although normaly there are answers to my query.\nAm I doing something wrong...?\nHere is the code:</p>\n\n<pre><code>OntModel model = ModelFactory.createOntologyModel( OntModelSpec.OWL_MEM_MICRO_RULE_INF);\nString inputFileName=\"pizza.owl\";\nInputStream in = FileManager.get().open( inputFileName );\nif (in == null) {\n    throw new IllegalArgumentException(\n         \"File: \" + inputFileName + \" not found\");\n}\nmodel.read(in, null);\n\nString queryString =\n        \"prefix pizza: &lt;www.co-ode.org/ontologies/pizza/pizza.owl#Pizza&gt; \"+        \n        \"prefix rdfs: &lt;\" + RDFS.getURI() + \"&gt; \"           +\n        \"prefix owl: &lt;\" + OWL.getURI() + \"&gt; \"             +\n        \"select ?pizza where {?pizza a owl:Class ; \"      +\n        \"rdfs:subClassOf ?restriction. \"                  +\n        \"?restriction owl:onProperty pizza:hasTopping ;\"  +\n        \"owl:someValuesFrom pizza:PeperoniSausageTopping\" +\n        \"}\";\nQuery query = QueryFactory.create(queryString);\nQueryExecution qe = QueryExecutionFactory.create(query, model);\ncom.hp.hpl.jena.query.ResultSet results =  qe.execSelect();\n\nResultSetFormatter.out(System.out, results, query);\nqe.close();\n</code></pre>\n"},{"tags":["query","vba","null","recordset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13257484,"title":"VBA Recordset.MoveNext Returning E_FAIL on NULL","body":"<p>Good day,</p>\n\n<p>I have been having a problem with a bit of simple VBA.  I wrote a script to take a text query (with no input parameters so no real user interaction, SQL Injection, etc.), run it against a database, and dump it to a new worksheet.  This is a simple one-off for some developer analysis so the features are extremely simple.</p>\n\n<p>If the query returns values for every column, there is no problem.  However, if the query has any null values in it (as the result of a ROLLUP(), in my case), the entire subroutine will fail at MoveNext (NOTE: not the assignment of the null value to a cell).  Originally, the script was failing before the null row was ever even accessed at </p>\n\n<pre><code>Range(Cells(2, 1), Cells(rsData.RecordCount + 1, rsData.Fields.Count)).NumberFormat = \"@\"\n</code></pre>\n\n<p>This was commented and moved to be cell-by-cell with the intent of adding a check if the current cell is null (by far the most common suggestion on the internet).</p>\n\n<p>The queries have been verified using a back-end SQL editor and are correct.  Every other article that I have read has either been specific to a product or not applicable.  The question, then, is simply: how is one supposed to handle null values in a Recordset?  I would like to avoid removing the nulls on the database side, as this sub is used for many different queries and the thought of having to pepper my queries with a bunch of NVL() statements is quite displeasing.</p>\n\n<p>Thank you in advance for any assistance.  Full code is as follows:</p>\n\n<pre><code>Sub runReport(query As String, sheetName As String)\n\n    Dim cnDatabase As ADODB.Connection\n    Dim rsData As ADODB.Recordset\n    Dim row As Integer\n    Dim column As Integer\n\n    'Create new worksheet\n    Sheets.Add.Name = sheetName\n    Excel.Application.Worksheets(sheetName).Select\n\n    'Connect to database\n    Set cnDatabase = New Connection\n    cnDatabase.ConnectionString = \"Provider=OraOLEDB.Oracle;Data Source=DB.EXAMPLE.COM;User ID=FOO;Password=BAR;ChunkSize=1000;FetchSize=100;\"\n    cnDatabase.Open\n\n    'Retrieve dataset\n    Set rsData = New Recordset\n    Set rsData.ActiveConnection = cnDatabase\n    rsData.Source = query\n    rsData.CursorLocation = adUseClient\n    rsData.CursorType = adOpenStatic\n    rsData.Open\n\n    'Output header row\n    For column = 1 To rsData.Fields.Count\n        Cells(1, column).Value = rsData.Fields(column - 1).Name\n        Rows(1).Font.Bold = True\n    Next\n\n    'Set all fields as text\n    'Range(Cells(2, 1), Cells(rsData.RecordCount + 1, rsData.Fields.Count)).NumberFormat = \"@\"\n\n    'Output retrieved data from database\n    row = 2\n    While Not rsData.EOF\n      For column = 1 To rsData.Fields.Count\n         Cells(row, column).NumberFormat = \"@\"\n         Cells(row, column).Value = rsData.Fields(column - 1).Value\n      Next\n\n      rsData.MoveNext\n      row = row + 1\n   Wend\n   cnDatabase.Close\n\nEnd Sub\n</code></pre>\n"},{"tags":["mysql","query","many-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13260335,"title":"Querying Many-to-One in Mysql","body":"<p>The following image illustrates how my database is organized:</p>\n\n<p><img src=\"http://akplebani.com/graphic.png\" alt=\"a busy cat\"></p>\n\n<p>What I'm looking for is a <strong>single</strong> query wich results gives me <strong>coordinate_name</strong>, <strong>title_project</strong>, <strong>title_solution</strong> and <strong>name_client</strong>, based on coordinate <strong>date</strong>.</p>\n\n<p>I'm trying something like this:</p>\n\n<pre><code>SELECT coordinate_name, title_project, title_solution, name_client FROM coordinate NATURAL JOIN client WHERE date BETWEEN ? AND ?\n</code></pre>\n"},{"tags":["sql","query","razor","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12854901,"title":"how to add and divide results from sql queries","body":"<p>I have a database which I am trying to create a webpage summary widget for. I am using MS Webmatrix and razor.</p>\n\n<p>I have several select queries set as variables, then my html asks for their values as a string and displays them. So far so good.<br>\nNow I want to add two results together, then subtract a third. EG: add todays processed orders ( I called it itotl) and todays partly processed orders (ppr) and subtract todays credits (ctotl).<br>\nThus, i want (itotl + ppr) - ctotl.<br>\nIf I try and do this by entering the @itotl and @ppr variables etc in my html, it fails.<br>\nThere will be a simple, industry best practice way to do it but I'm only learning, and the hard way at that!</p>\n\n<p>Any Suggestions? I can paste the whole code in here if it will help.\nHere:<br>\n<code>@{<br>\n    Layout = \"~/_SiteLayout.cshtml\";<br>\n    Page.Title = \"SCOREBOARD\";<br>\n    var db = Database.Open(\"data\");<br>\n    var itot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and SUBTOTAL &gt;0\");<br>\n    var isum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.DR_TRANS where TRANSDATE = 41192 and Subtotal &gt;0\");<br>\n    var qsum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Subtotal &gt;0\");<br>\n    var ppr = db.QueryValue(\"select sum(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0 and status = 1\");<br>\n    var psum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Status =1\");<br>\n    var qtot = db.QueryValue(\"SELECT SUM(SUBTOTAL) FROM dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0\");<br>\n    var ctot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    var csum = db.QueryValue(\"SELECT COUNT(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    &lt;META HTTP-EQUIV=\"REFRESH\" CONTENT=\"15\"&gt;&lt;/META&gt;;<br>\n}</code>\n<code>&lt;!DOCTYPE html&gt;</code></p>\n\n<p><code>&lt;html lang=\"en\"&gt;</code>\n   <code>&lt;head&gt;<br>\n        &lt;meta charset=\"utf-8\" /&gt;<br>\n        &lt;title&gt;&lt;/title&gt;<br>\n        &lt;style&gt;<br>\n            .column1 {color: blue; font-weight: bold; font-size: 1.6em;}<br>\n            .column2 {color: red;}<br>\n        &lt;/style&gt;<br>\n    &lt;/head&gt;<br>\n    &lt;body&gt;<br>\n        &lt;p&gt;@qsum.ToString() Quotes:<br>\n            &lt;span class=@(qtot &gt; 20000 ? \"column1\" : \"column2\")&gt;@qtot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@psum.ToString() Partly Processed:<br>\n            &lt;span class=@(ppr &gt; 18000 ? \"column1\" : \"column2\")&gt;@ppr.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@isum.ToString() Invoices:<br>\n            &lt;span class=@(itot &gt; 18000 ? \"column1\" : \"column2\")&gt;@itot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@csum.ToString() Credits:<br>\n            &lt;span class=@(ctot &gt; 18000 ? \"column1\" : \"column2\")&gt;@ctot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;Nett Sales:&lt;/p&gt;<br>\n    &lt;/body&gt;<br>\n&lt;/html&gt;</code>  </p>\n\n<p>How do I get my markup to show tidily in stack? This has rendered a little hard to read!</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13259028,"title":"SQL Server bulk insert - \"Bulk load data conversion error\"","body":"<pre><code>bulk insert dbo.A\nFROM 'd:\\AData.csv'\nWITH \n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>Inserting bulk data into a database, I approached an unexplainable error after review of the suspect data:</p>\n\n<blockquote>\n  <p><em>Msg 4867, Level 16, State 1, Line 6</em><br>\n  <em>Bulk load data conversion error (overflow) for row 1, column 42 (FES).</em></p>\n</blockquote>\n\n<p>Column FES was <code>tinyint</code>, now <code>smallint</code>. <code>d:\\AData.csv</code> contains a <code>2</code> in row 1, column 42. Are there any other sources for this type of error?</p>\n\n<p>---APPEND---</p>\n\n<p>I'm not sure how to properly post this. </p>\n\n<p>Create Table Script </p>\n\n<pre><code>create table AcsBy320082010Hus(\nserialnoId bigint,\nRT char,\nDIVISION tinyint,\nPUMA int,\nREGION tinyint,\nST tinyint,\nADJHSG int,\nADJINC int,\nWGTP int,\nNP tinyint,\nTYPE tinyint,\nACR tinyint,\nAGS tinyint,\nBDS tinyint,\nBLD tinyint,\nBUS tinyint,\nCONP smallint,\nELEP smallint,\nFS smallint,\nFULP int,\nGASP int,\nHFL tinyint,\nINSP varchar(6),\nKIT tinyint,\nMHP int,\nMRGI tinyint,\nMRGP int,\nMRGT tinyint,\nMRGX tinyint,\nPLM tinyint,\nRMS tinyint,\nRNTM tinyint,\nRNTP int,\nSMP int,\nTEL tinyint,\nTEN tinyint,\nVACS tinyint,\nVAL tinyint,\nVEH tinyint,\nWATP int,\nYBL tinyint,\nFES tinyint,\nFINCP int,\nFPARC tinyint,\nGRNTP int,\nGRPIP tinyint,\nHHL tinyint,\nHHT tinyint,\nHINCP int,\nHUGCL bit,\nHUPAC tinyint,\nHUPAOC tinyint,\nHUPARC tinyint,\nLNGI tinyint,\nMV tinyint,\nNOC tinyint,\nNPF tinyint,\nNPP bit,\nNR bit,\nNRC tinyint,\nOCPIP tinyint,\nPARTNER tinyint,\nPSF bit,\nR18 bit,\nR60 tinyint,\nR65 tinyint,\nRESMODE tinyint,\nSMOCP int,\nSMX tinyint,\nSRNT bit,\nSVAL bit,\nTAXP tinyint,\nWIF tinyint,\nWKEXREL tinyint,\nWORKSTAT tinyint,\nFACRP bit,\nFAGSP bit,\nFBDSP bit,\nFBLDP bit,\nFBUSP bit,\nFCONP bit,\nFELEP bit,\nFFSP bit,\nFFULP bit,\nFGASP bit,\nFHFLP bit,\nFINSP bit,\nFKITP bit,\nFMHP bit,\nFMRGIP bit,\nFMRGP bit,\nFMRGTP bit,\nFMRGXP bit,\nFMVYP bit,\nFPLMP bit,\nFRMSP bit,\nFRNTMP bit,\nFRNTP bit,\nFSMP bit,\nFSMXHP bit,\nFSMXSP bit,\nFTAXP bit,\nFTELP bit,\nFTENP bit,\nFVACSP bit,\nFVALP bit,\nFVEHP bit,\nFWATP bit,\nFYBLP bit,\nWGTP1 int,\nWGTP2 int,\nWGTP3 int,\nWGTP4 int,\nWGTP5 int,\nWGTP6 int,\nWGTP7 int,\nWGTP8 int,\nWGTP9 int,\nWGTP10 int,\nWGTP11 int,\nWGTP12 int,\nWGTP13 int,\nWGTP14 int,\nWGTP15 int,\nWGTP16 int,\nWGTP17 int,\nWGTP18 int,\nWGTP19 int,\nWGTP20 int,\nWGTP21 int,\nWGTP22 int,\nWGTP23 int,\nWGTP24 int,\nWGTP25 int,\nWGTP26 int,\nWGTP27 int,\nWGTP28 int,\nWGTP29 int,\nWGTP30 int,\nWGTP31 int,\nWGTP32 int,\nWGTP33 int,\nWGTP34 int,\nWGTP35 int,\nWGTP36 int,\nWGTP37 int,\nWGTP38 int,\nWGTP39 int,\nWGTP40 int,\nWGTP41 int,\nWGTP42 int,\nWGTP43 int,\nWGTP44 int,\nWGTP45 int,\nWGTP46 int,\nWGTP47 int,\nWGTP48 int,\nWGTP49 int,\nWGTP50 int,\nWGTP51 int,\nWGTP52 int,\nWGTP53 int,\nWGTP54 int,\nWGTP55 int,\nWGTP56 int,\nWGTP57 int,\nWGTP58 int,\nWGTP59 int,\nWGTP60 int,\nWGTP61 int,\nWGTP62 int,\nWGTP63 int,\nWGTP64 int,\nWGTP65 int,\nWGTP66 int,\nWGTP67 int,\nWGTP68 int,\nWGTP69 int,\nWGTP70 int,\nWGTP71 int,\nWGTP72 int,\nWGTP73 int,\nWGTP74 int,\nWGTP75 int,\nWGTP76 int,\nWGTP77 int,\nWGTP78 int,\nWGTP79 int,\nWGTP80 int)\n</code></pre>\n\n<p>Headers row </p>\n\n<blockquote>\n  <p>serialno,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BATH,BDSP,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,MHP,MRGI,MRGP,MRGT,MRGX,REFR,RMSP,RNTM,RNTP,RWAT,SINK,SMP,STOV,TEL,TEN,TOIL,VACS,VALP,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,KIT,LNGI,MULTG,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PLM,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBATHP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FMVP,FPLMP,FREFRP,FRMSP,FRNTMP,FRNTP,FRWATP,FSINKP,FSMP,FSMXHP,FSMXSP,FSTOVP,FTAXP,FTELP,FTENP,FTOILP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80</p>\n</blockquote>\n\n<p>Row 1</p>\n\n<blockquote>\n  <p>2008000000023,H,6,01300,3,01,1012650,1031272,00043,04,1,1,,1,02,02,2,0000,150,2,0002,020,3,00150,,2,00980,1,1,1,03,,,1,1,,1,1,1,1,,0210000,2,0080,09,2,000058100,2,,,4,1,000058100,0,3,3,3,1,1,1,3,02,04,0,0,02,024,0,1,0,1,0,0,1,01170,3,0,1,19,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,00112,00045,00068,00017,00044,00091,00071,00032,00036,00042,00048,00041,00013,00031,00063,00013,00037,00017,00063,00098,00026,00036,00017,00065,00036,00020,00014,00035,00037,00046,00047,00048,00080,00034,00012,00061,00031,00069,00043,00060,00011,00050,00016,00057,00050,00013,00016,00068,00056,00039,00042,00049,00081,00041,00012,00092,00050,00055,00049,00016,00062,00041,00103,00012,00048,00060,00073,00052,00063,00038,00047,00040,00017,00040,00059,00020,00042,00010,00038,00018</p>\n</blockquote>\n\n<p><a href=\"http://www.census.gov/acs/www/Downloads/data_documentation/pums/DataDict/PUMS_Data_Dictionary_2008-2010.pdf\" rel=\"nofollow\">Link to ACS 2008-2010 Data Dictionary</a></p>\n"},{"tags":["php","mysql","query","combine"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13259250,"title":"PHP & MySQL: How to combine UPDATE and SELECT (with min function) queries","body":"<p>I'm trying to select a row with the least value from a MySQL table and update the flag column for that row using PHP. But it's not working for me. If I break it into two queries, it works, but combining the two isn't going anywhere. What am I doing wrong?</p>\n\n<p>Here's what works:</p>\n\n<pre><code>$flag = 1;\n$query = \"SELECT MIN(value) FROM \". $myTable;\n$data = mysqli_query($dbh, $query);\n$dataSet = mysqli_fetch_row($data);\n$value = $dataSet[0];\n$queryUpdate = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' WHERE value='\" . $value. \"'\";\n$dataUpdate = mysqli_query($dbh, $queryUpdate);\n</code></pre>\n\n<p>Here are attempts I made but failed:</p>\n\n<pre><code>//attempt #1\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' WHERE value=( SELECT MIN(value) FROM '\". $myTable . \"')\";\n$data = mysqli_query($dbh, $query);\n\n// attempt #2\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' ORDER BY value ASC LIMIT 1\";\n$data = mysqli_query($dbh, $query);\n\n// attempt #3\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" T1 \nINNER JOIN ( SELECT MIN(value) FROM \". $myTable . \" ) T2\nON T1.id = T2.id\nSET T1.flag=\" . $flag;\n$data = mysqli_query($dbh, $query);\n</code></pre>\n\n<p>mysqli_error() returns </p>\n\n<blockquote>\n  <p>Warning: mysqli_error() expects exactly 1 parameter, 0 given [in the $data = mysqli_query($dbh, $query) lines.]</p>\n</blockquote>\n\n<p>Any help would be so appreciated.</p>\n"},{"tags":["php","mysql","query","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13241092,"title":"Stored MySQL Procedures vs. Dynamic MySQL Queries","body":"<p>I'm developing a basic php based function that executes MySQL queries in order to sort the data in the database and present it to the user. As a general statement, is it considered best practice to simply construct static queries and to execute them as needed, or simply piece together elements of a MySQL statement based on conditions? </p>\n\n<p>To narrow the question, I have a specific example:</p>\n\n<p>Say I have a few drop-down menus that define the search on the user's end. Let one drop-down simply contain a list of names, say Bob Smith, and the two others a date range. From there, I can easily create a search along the lines of <code>SELECT item FROM checkOUT WHERE...</code> I can definitely write a general query with parameters to be executed when ALL three of the parameters are present. Consider the case when only a date range is selected regardless of individuals - that would require only two parameters and a different general query. And what if the data is spread across multiple tables? That has to be taken into account. I should add as well that my function is based on drop-down menus - not original user input.</p>\n\n<p>Basically, what would be the best method to create the MySQL Query - prepared statements or dynamically created statements? Obviously, the end result will rely on a hybrid of the two, but to which side it leans the farthest is the issue. I'm asking this question as I am not too familiar with this particular side of handling multiple queries from one source. Typically, I simply have to execute one query to get what I need and work with it - not sorting.</p>\n\n<p>Any insight is appreciated.  </p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13254141,"title":"How do I use DateTime from one result set as start and end date for another query?","body":"<p>OK, I have product with serial numbers running through a production line. I read and store times when these serial number are read at different locations. </p>\n\n<p>I can query this data and get:</p>\n\n<pre><code>Tagname - Barcode reader identifier.\nDateTime - DateTime of read.\nValue - Serial Number.\n</code></pre>\n\n<p>I need to look at the process values of a tool from the time that the reader reads a specific Serial Number before the tool and the time it reads that same serial number after the tool. I would like to average, min/max, etc. the values but I haven't figured out how to use the DateTime of the barcode reads to act as the StartDate and EndDate of the process values query.</p>\n\n<p>Any help would be very much appreciated.</p>\n\n<p>Process Query:</p>\n\n<pre><code>SET NOCOUNT ON\nDECLARE @StartDate DateTime\nDECLARE @EndDate DateTime\nSET @StartDate = '20121106 08:48:26.000'\nSET @EndDate = '20121106 08:53:26.000'\nSET NOCOUNT OFF\nSELECT  * \nFROM (SELECT History.TagName, DateTime, Value, vValue, StartDateTime\n      FROM History\n      WHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\n      AND wwRetrievalMode = 'Average'\n      AND wwCycleCount = 10\n      AND wwVersion = 'Latest'\n      AND DateTime &gt;= @StartDate\n      AND DateTime &lt;= @EndDate) temp \nWHERE temp.StartDateTime &gt;= @StartDate\n</code></pre>\n\n<p>I want to get the data based on barcode reads before and after the tool. I tried some things like:</p>\n\n<pre><code>SELECT History.TagName, DateTime, Value\nFROM History\nWHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\nAND DateTime &gt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber',\n                                           'MES_110A.PVD1101R_In_SerialNumber' )\n                 AND Value = '100056134')\nAND DateTime &lt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110B.SCR1101_SerialNumber',\n                                           'MES_110B.SCR1102_SerialNumber')\n                 AND Value = '100056134')\n</code></pre>\n\n<p>OK, I made some changes. Now I have:</p>\n\n<pre><code>    SET NOCOUNT ON\n    DECLARE @StartDate DateTime\n    DECLARE @EndDate DateTime\n    SET @StartDate = (SELECT DateTime\n                              FROM History\n                              WHERE History.TagName IN  ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n                              AND Value = '100056130'\n                              AND DateTime &gt;= '20121106 05:39:48.000'\n                              AND DateTime &lt;= '20121106 23:39:48.000')\n    SET @EndDate = (SELECT DateTime\n                           FROM History\n                           WHERE TagName IN ('MES_110B.SCR1101_In_SerialNumber', 'MES_110B.SCR1102_In_SerialNumber' )\n                           AND Value = '100056130'\n                           AND DateTime &gt;= '20121106 05:39:48.000'\n                           AND DateTime &lt;= '20121106 23:39:48.000')\n    SET NOCOUNT OFF\n\n    SELECT TagName, AVG (Value) AS \"Average\"\n     FROM History\n     WHERE History.TagName IN  ('PVD1101_01.CHU1_Return_Water_Pressure', 'PVD1101_01.CHU1_Return_Water_Temp', 'PVD1101_01.5CT11_IN_Supply_Temp', 'PVD1101_01.5CT11_Out_Return_Temp')\n     AND DateTime &gt;= @StartDate\n     AND DateTime &lt;= @EndDate\n    GROUP BY TagName\n</code></pre>\n\n<p>This returns the values I am looking for. I will make the serial number value a parameter for the reports and it should work. Does this look totally convoluted and inefficient?</p>\n\n<p>I do need one more thing. This subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n</code></pre>\n\n<p>Returns Null. This Subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n     AND DateTime &gt;= '20121106 05:39:48.000'\n     AND DateTime &lt;= '20121106 23:39:48.000'\n</code></pre>\n\n<p>Returns a value. Why?</p>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13258021,"title":"distinct condition in case statement","body":"<p>I have a SQL that returns a cnt1 and cnt2 for each Event_ID, while testing a condition for column \"POSA\" </p>\n\n<p>this returns the following as desired:</p>\n\n<p>Event_ID | CNT1 | CNT2</p>\n\n<p>I would like to add another condition to each CASE statement that tests if another column \"S\" in the same table is distinct.  Below is the code snippet:</p>\n\n<pre><code>SELECT Event_ID, \n sum  \n (CASE WHEN POSA IN ('SX', 'DX')  THEN 1 \n    ELSE 0 \n END) \n AS cnt1,\nsum \n(CASE  \n    WHEN POSA IN ('SP', 'DP')  THEN 1 \n    ELSE 0 \n END) AS cnt2\n\n\nFROM Station_Processed_Info GROUP BY EVENT_ID;\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13258442,"title":"SELECT DISTINCT HAVING Count unique conditions","body":"<p>I've searched for an answer on this but can't find quite how to get this distinct recordset based on a condition.  I have a table with the following sample data:</p>\n\n<pre><code>Type    Color   Location    Supplier\n----    -----   --------    --------\nApple   Green   New York    ABC\nApple   Green   New York    XYZ\nApple   Green   Los Angeles ABC\nApple   Red     Chicago     ABC\nApple   Red     Chicago     XYZ\nApple   Red     Chicago     DEF\nBanana  Yellow  Miami       ABC\nBanana  Yellow  Miami       DEF\nBanana  Yellow  Miami       XYZ\nBanana  Yellow  Atlanta     ABC\n</code></pre>\n\n<p>I'd like to create a query that shows the count of unique locations for each distinct Type+Color where the number of unique locations is more than 1, e.g.</p>\n\n<pre><code>Type    Color   UniqueLocations\n----    -----   --------\nApple   Green   2\nBanana  Yellow  2\n</code></pre>\n\n<p>Note that {Apple, Red, 1} doesn't appear because there is only 1 location for red apples (Chicago).  I think I've got this one (but perhaps there is a simpler method).  I'm using:</p>\n\n<pre><code>SELECT Type, Color, Count(Location) FROM\n(SELECT DISTINCT Type, Color, Location FROM MyTable)\nGROUP BY Type, Color HAVING Count(Location)&gt;1;\n</code></pre>\n\n<p>How can I create another query that lists the <code>Type, Color</code>, and <code>Location</code> for each distinct <code>Type,Color</code> when the count of unique locations for that <code>Type,Color</code> is greater than 1?  The resulting recordset would look like:</p>\n\n<pre><code>Type    Color   Location\n----    -----   --------\nApple   Green   New York\nApple   Green   Los Angeles\nBanana  Yellow  Miami\nBanana  Yellow  Atlanta\n</code></pre>\n\n<p>Note that <code>Apple, Red, Chicago</code> doesn't appear because there is only 1 location for red apples.  Thanks!</p>\n"},{"tags":["sql","mysql","query","table","drop"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":5107,"score":11,"question_id":1589278,"title":"SQL: deleting tables with prefix","body":"<p>i know how to delete my tables in MySQL, </p>\n\n<pre><code>DROP TABLE\n</code></pre>\n\n<p>but now i need to know how to delete my tables who all have the prefix</p>\n\n<pre><code>myprefix_\n</code></pre>\n\n<p>How to?</p>\n\n<p>--I NEED TO DO THIS IN PHPMYADMIN, IN A BROWSER. NO TERMINAL STUFF PLEASE. BATCH STUFF IS ALWAYS APRECIATED.--</p>\n"},{"tags":["mysql","sql","query","reservation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13239084,"title":"MySQL Reservation System - Testing for multiple conditions","body":"<p>I'm working on a reservation system in MySQL and I'm having a bit of trouble with my query for finding the next available appointment slots.</p>\n\n<p>My days are broken down into 15-minute slots (00:00:00 - 00:14:59, 00:15:00 - 00:29:59, etc.).  Table structure so far:</p>\n\n<p><strong>appointments table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `appointments` (\n`appointmentID` int(9) unsigned NOT NULL AUTO_INCREMENT,\n`patientID` int(9) unsigned NOT NULL,\n`apptTitle` varchar(50) NOT NULL,\n`apptDT` datetime NOT NULL,\n`apptLength` int(4) NOT NULL,\n`apptStatus` varchar(25) NOT NULL,\n`physician` int(9) unsigned NOT NULL,\n`apptType` varchar(30) NOT NULL,\n`apptLocation` varchar(25) NOT NULL,\nPRIMARY KEY (`appointmentID`),\nKEY `patientID` (`patientID`),\nKEY `physician` (`physician`),\nKEY `apptStatus` (`apptStatus`),\nKEY `apptLocation` (`apptLocation`),\nKEY `apptType` (`apptType`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n</code></pre>\n\n<p><strong>apptSlots Table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `apptSlots` (\n`startDT` datetime NOT NULL,\n`endDT` datetime NOT NULL,\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>The apptSlots table is already filled with all the 15 minute slots for 2012, as I explained above.</p>\n\n<p>I have a query that can successfully show me the slots that aren't taken in any way (no appointments scheduled at all).</p>\n\n<pre><code>SELECT a.*\nFROM apptSlots AS a\nLEFT JOIN appointments AS b\nON a.endDT\nBETWEEN b.apptDT AND DATE_ADD(b.apptDT, INTERVAL b.apptLength MINUTE)\nAND b.appointmentID IS NULL\n</code></pre>\n\n<p>What I need to do now is search for appointment slots across multiple physicians, multiple rooms, etc.  For example, if Physician A makes an appointment for 7am - 8am, that time slot no longer shows up in my query above.  But Physician B and C don't have any appointments for that slot, so I need to be able to schedule them.  The same goes for rooms, Room A is used by the 7am appointment, but room B and C are still free to be scheduled.</p>\n\n<p>How can I determine open slots with all these variables?  I know I can test with WHERE conditions for each combination and this works if I need to test for a specific doctor, or a specific room for a treatment.  But, if I just want to see all slots across all doctors and rooms, my query doesn't work and testing all possible combinations individually doesn't seem right, it's just a matter of how to get the right conditions into the LEFT JOIN clause.</p>\n\n<p>Please let me know if I'm being unclear, but I think this is enough info.  If not, I'll add in whatever you ask for!</p>\n\n<p>Thank you for your help, my previous question on here got me as far as my query above, now I just need some refinement.  Ask any questions you need, I'll be here to answer them!</p>\n"},{"tags":["sql","sql-server","query","tsql","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13257860,"title":"When I run simple select query, is it possible not to show number of rows affected at the end?","body":"<p>I try to use OSQL in order to save query results in text file and later bulk insert those text file to a table. OSQL part is ok, however, in bulk insert, number of rows affected at the end of query results causes error. Here is an example;</p>\n\n<pre><code>select item_number, description, price from item\n\n3536114   Fruit mix     $3.99\n\n3536229   DO 20 liquid  $9.99\n\n3536251   Peppermint    $7.99\n\n(3 rows affected) ------&gt; I do not need this line.\n</code></pre>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13253814,"title":"MySQL query to retrieve items that have an exact match in a many-to-many relationship","body":"<p>I have the following tables:</p>\n\n<pre><code>Media:\n- mediaid\n- mediatitle\n\n\nMediaTag:\n- mediaid\n- mediatag\n\n\nTag:\n- tagid\n- tagname\n</code></pre>\n\n<p>The following tags:</p>\n\n<pre><code>Tag: (1) - Public\nTag: (2) - Premium\nTag: (3) - Restricted\n</code></pre>\n\n<p>The following media with tags:</p>\n\n<pre><code>Media: (1) - Public\nMedia: (2) - Premium &amp; Restricted\nMedia: (3) - Premium\nMedia: (4) - Restricted\nMedia: (5) - No tags\n</code></pre>\n\n<p>Assume that a user has permissions to see only <code>Public (1)</code> and <code>Restricted (3)</code> tags. If a media has a combination of tags that the user doesn't have explicit access to, he's not allowed to see it. If a media has no tag it's not visible at all. So the user in this case would be able to see only <code>Media 1</code> and <code>Media 4</code>.</p>\n\n<p>Is it possible to write a MySQL query to retrieve the media assuming I have the user permissions in the form of an array with tag IDs <code>(1,3)</code> ?</p>\n"},{"tags":["sql","database","performance","query","filter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257155,"title":"Architecture for a fast screener","body":"<p>I'm building a screener that should be able to search through a table about 50 columns wide and 7000 rows long really fast.</p>\n\n<p>Each row is composed of the following columns.</p>\n\n<p>primary_key, quantity1, quantity2, quantity3...quantity50.</p>\n\n<p>All quantities are essentially floats or integers. Hence a typical screener would look like this.</p>\n\n<pre><code>Get all rows which have quantity1 &gt; x and quantity2 &lt; y and quantity3 &gt;= z.\n</code></pre>\n\n<p>Indexing all columns should lead to really fast search times however some of the columns will be updating in realtime. Indexing everything obviously leads to very low insert/update times.</p>\n\n<p>A portion of the columns are fairly static though. Hence an idea was to segregate the data into two tables, one containing all columns that are static while the other containing data that is dynamic. Any screener would then be applied to both tables based on the actual query. And the results combined in the end.</p>\n\n<p>I am currently planning on using a MySQL engine, most probably INNoDB. However I'm looking to get much faster response times. An implementation of the same problem on a certain site was very snappy. Regardless of the query size, i was getting the results within 500 ms. Wondering what other options are available out there to implement this function.</p>\n\n<p>Any thoughts/hints towards a potential solution would be greatly appreciated.</p>\n"},{"tags":["sql","query","optimization","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13256383,"title":"SQL query: how to distinct count of a column group by another column","body":"<p>In my table I need to know if each <code>ID</code> has one and only one <code>ID_name</code>. How can I write such query?</p>\n\n<p>I tried:</p>\n\n<pre><code>select ID, count(distinct ID_name) as count_name \nfrom table \ngroup by ID \nhaving count_name &gt; 1\n</code></pre>\n\n<p>But it takes forever to run. </p>\n\n<p>Any thoughts?</p>\n"},{"tags":["mysql","query","search-engine","information-extraction","data-extraction"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":13,"score":-1,"question_id":13256513,"title":"Extraction Error in query processing","body":"<p>In our project we have to find errors in the result extraction from search engines.\nCan anybody explain what exactly is the extraction error in query processing and what may be an example of one?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13255478,"title":"Simple MySQL Query Help: How to Get All Users who have one field value but not another","body":"<p>Pretty bad at MySQL as I've only done light web design and SQL on oracle dbs. Say I have a table listing all the fruits people like.</p>\n\n<pre><code>name   fruit\n------------\njohn   bananas\njohn   oranges\nmarcy  bananas\ndave   oranges\nlucy   bananas\nlucy   oranges\n</code></pre>\n\n<p>Say I wanted to get all the names of people that liked oranges but didn't specify if they liked bananas. There's only two possible fruits in this table. (It may expand to more but there are generally only two).</p>\n\n<p>What would the query be? I want a query that only returns \"dave\" because marcy has only specified she likes bananas, and john and lucy say they like both. I don't think I need a join since this is only one table.</p>\n\n<p>I'm trying</p>\n\n<pre><code>select name from table\nwhere(--uhm.. use the stuff below somehow\nselect name from table\nwhere fruit like 'bananas';\nselect name from table\nwhere fruit like 'oranges';\n)\n</code></pre>\n\n<p>I would also be really happy with a query that returned all the people that like oranges but not bananas, or bananas but not oranges instead. I don't know which query would be easier.</p>\n\n<p>Also I'm sure I'd be able to find someone else with the same problem on the internet. What query would you use on google to answer my question?</p>\n"},{"tags":["query","couchdb","range"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13216640,"title":"CouchDB: getting number of keys in given key range","body":"<p>In my CouchDB database, all keys have the form \"A_xxxxxxxx\" where xxxxxxxx is zero-padded decimal number (e.g. \"A_00000001\" or \"A_12345678\")</p>\n\n<p>I want to get only <em>the number of keys</em> in a given key range.</p>\n\n<p>For example, to get the keys from A_10000000 to A_30000000, I can query something like:</p>\n\n<pre><code>GET DATABASE/_all_docs?startkey=\"A_00001000\"&amp;endkey=\"A_30000000\"&amp;include_docs=false\n</code></pre>\n\n<p>But the result contains all keys, and I need to count the elements in \"docs\" field of the output.</p>\n\n<p>Since the number of keys in my query will be huge, and all I want to know is the number of keys, not the actual list of the keys.</p>\n\n<p>The range start and range end value can be vary, which is not fixed.</p>\n\n<p>Is is possible to get only the number of keys of the given range, without retrieving actual key list?</p>\n\n<p>Thanks,</p>\n"},{"tags":["query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1742,"score":5,"question_id":2581394,"title":"How to get a dynamic attribute name in cfloop over query in ColdFusion","body":"<p>I'm inside a <code>cfloop</code> over a query. I want to get an attribute, but I won't know what that attribute will be until runtime. Using <code>#qryResult[MyAttr]#</code> fails with the error \"Complex object types cannot be converted to simple values.\"  What is the syntax for doing this?</p>\n\n<p>Here is a simplified example:</p>\n\n<pre><code>&lt;cfquery datasource=\"TestSource\" name=\"qryResult\"&gt;\n    SELECT * FROM MyTable\n&lt;/cfquery&gt;\n\n&lt;cfloop query=\"qryResult\"&gt;\n    &lt;cfset MyAttr=\"autoid\" /&gt;\n    &lt;cfoutput&gt;\n        Test 1: #qryResult.autoid# &lt;br/&gt;  &lt;!--- succeeds ---&gt;\n        Test 2: #qryResult[MyAttr]# &lt;br/&gt; &lt;!--- fails ---&gt;\n    &lt;/cfoutput&gt;\n&lt;/cfloop&gt;\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13254109,"title":"How to determine the place of a row in ordered SQL table?","body":"<p>I have a table of users and a 'points' column. I would like to determine the number/place of the row across all the users ordered by 'points'.</p>\n\n<p>I could just get result of all users data and then do while loop, and stop when id equals necessary user. But I believe there is a more efficient way do to that because my table will contain ~100 000 rows.</p>\n"},{"tags":["sql","sql-server","query","sql-server-2005"],"answer_count":9,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13253445,"title":"Select Part of Column","body":"<p>I was wondering if anyone could help with a query to select part of a column.</p>\n\n<p>The column 'criteriadata' contains data that would look like this:</p>\n\n<blockquote>\n  <p><strong>CriteriaData</strong></p>\n  \n  <p>14 27 15 C</p>\n  \n  <p>14 30 15 DD</p>\n  \n  <p>14 38 15 Pass</p>\n  \n  <p>14 33 15 Pass</p>\n</blockquote>\n\n<p>How can I select just the data that appears after the number 15.</p>\n\n<p>Many thanks.</p>\n"},{"tags":["php","mysql","query","where"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13242955,"title":"php mysql query error with \"where\"","body":"<p>I'm running a query on our customer order database to see the sales from the last week. The query looks like this:</p>\n\n<pre><code>select\ndistinct day(from_unixtime(customerorder.datetime)) as day,\ncount(distinct customerorder.customerorderid) as count_totalorders,\ncount(distinct customerorderpos.itemid) as count_differentitems,\nsum(customerorderpos.quantity_ordered) as quantity_ordered,\nsum(customerorderpos.itemsubtotal) as item_subtotal,\nsum(customerorderpos.pricechangetotal) as item_pricechangetotal,\nsum(customerorderpos.itemtotal) as item_total,\nsum(customerorderpos.purchase_price * customerorderpos.quantity_ordered) as item_purchasepricetotal,\nsum(distinct cart_discounttotal) as total_discount,\nsum(customerorderpos.itemtotal - (customerorderpos.purchase_price * customerorderpos.quantity_ordered) - (select distinct cart_discounttotal)) as item_earningstotal,\nsum(distinct cart_total_shipping) as total_shipping,\nsum(distinct cart_total_tax) as total_tax,\nsum(distinct cart_total_complete) as total_complete\nfrom customerorder\ninner join customerorderpos on customerorder.customerorderid = customerorderpos.customerorderid\nwhere\ncustomerorder.datetime &gt;= 1351494000 and\ncustomerorder.status_cancelled = \"0\"\ngroup by day(from_unixtime(customerorder.datetime))\norder by customerorder.datetime\n</code></pre>\n\n<p>When I enter the query in PhpMyAdmin in works fine and shows the last 7 days orders. But when we run it in our own software it gives an error.</p>\n\n<pre><code>$result = $db-&gt;query($query);\nwhile ($row = $result-&gt;fetch_assoc()){\n</code></pre>\n\n<p>This shows: \"Fatal error: Call to a member function fetch_assoc() on a non-object\"</p>\n\n<p>But.... if I take out \"where customerorder.datetime >= 1351494000\" from the query it works fine.\nIn other words the query works perfectly until I want to limit it to a specific time. Customerorder.datetime is an int(11) column with a timestamp.</p>\n\n<p>Any ideas what the problem could be?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["sql-server","query","tsql","time"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":48,"score":-1,"question_id":13246987,"title":"TSQL query to sum time periods per range","body":"<p>I need to create a query to sum day's hours and night's hours from a range intersec.\nFor example with this range:</p>\n\n<pre><code>8AM-8PM -&gt; day\n8PM-8AM -&gt; night\n</code></pre>\n\n<p>and one or more start-end time period:</p>\n\n<pre><code>7.30AM 10.00PM\n</code></pre>\n\n<p>I would like to get this values:</p>\n\n<pre><code>12 day's hours\n2.5 night's hours\n</code></pre>\n\n<p>I don't know which is the bast way to accomplish this function.</p>\n"},{"tags":["sql","performance","query","postgresql","postgresql-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13234812,"title":"Improving query speed: simple SELECT in big postgres table","body":"<p>I'm having trouble regarding speed in a SELECT query on a Postgres database.</p>\n\n<p>I have a table with two integer columns as key: (int1,int2)\nThis table has around 70 million rows.</p>\n\n<p>I need to make two kind of simple SELECT queries in this environment:</p>\n\n<pre><code>SELECT * FROM table WHERE int1=X;\nSELECT * FROM table WHERE int2=X;\n</code></pre>\n\n<p>These two selects returns around 10.000 rows each out of these 70 million. For this to work as fast as possible I thought on using two HASH indexes, one for each column. Unfortunately the results are not that good:</p>\n\n<pre><code>                                                               QUERY PLAN                                                               \n----------------------------------------------------------------------------------------------------------------------------------------\n Bitmap Heap Scan on lec_sim  (cost=232.21..25054.38 rows=6565 width=36) (actual time=14.759..23339.545 rows=7871 loops=1)\n   Recheck Cond: (lec2_id = 11782)\n   -&gt;  Bitmap Index Scan on lec_sim_lec2_hash_ind  (cost=0.00..230.56 rows=6565 width=0) (actual time=13.495..13.495 rows=7871 loops=1)\n         Index Cond: (lec2_id = 11782)\n Total runtime: 23342.534 ms\n(5 rows)\n</code></pre>\n\n<p>This is an EXPLAIN ANALYZE example of one of these queries. It is taking around 23 seconds. My expectations are to get this information in less than a second.</p>\n\n<p>These are some parameters of the postgres db config:</p>\n\n<pre><code>work_mem = 128MB\nshared_buffers = 2GB\nmaintenance_work_mem = 512MB\nfsync = off\nsynchronous_commit = off\neffective_cache_size = 4GB\n</code></pre>\n\n<p>Any help, comment or thought would be really appreciated.</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["python","django","query","mongodb","mongoengine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13204573,"title":"Trouble querying ListField with mongoengine","body":"<p>I'm using mongoengine, and I've got the following situation,</p>\n\n<p>My model:</p>\n\n<pre><code>class Item(Document):\n   ...\n   tags = ListField(StringField(max_length=30))\n</code></pre>\n\n<p>The query:</p>\n\n<pre><code>filters = {\n    'tags__contains': query\n}\ntags_with_counter = Item.objects.filter(**filters).item_frequencies('tags')\n</code></pre>\n\n<p>This returns a list of tuples containing the name of the tag, and the frequency. What I want to do is get only tags that contain <strong>query</strong> and their respective frequency. How can I do that?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13250351,"title":"MySql: Extract products with identical options","body":"<p>I'm trying to write a query that would extract products that have identical option values assigned to them. Affected tables are:</p>\n\n<pre><code>products\n| id |\n\nrel_product_options\n| product | option | value |\n\"option\" is an id from \"options\" table\n\"value\" is an option value id from \"values\" table (an option can have multiple values. eg. option \"color\" can have \"red\", \"blue\" etc.)\n</code></pre>\n\n<p>Every product has multiple option-value combinations ir \"rel_product_options\" table. Variations of the same product cannot have identical option-value pairs and that's why prior to changing any value on any option i need to check if the next value would no conflict with some other product. Let's assume</p>\n\n<ul>\n<li>product A (color: red, size: 10)</li>\n<li>product B (color: blue, size: 10)</li>\n</ul>\n\n<p>Now if i try to change color of \"product B\" to \"red\" - i should be able to find in the database that options of \"product A\" would be identical and cancel the change. I hope the question is clear and honestly i don't even know where to start: sql is something of a mystery to me no matter how many times i use it ... I've started with something like the code below, but i think it is probably wrong on more levels than i can count to so any help is very appreciated.</p>\n\n<pre><code># my thoughts\nSELECT P1.*, PO1.*, PO2.* FROM products AS P1\n# first select the product we want to extract all options from\n# THIS ALREADY IS WRONG, because one of the options is ABOUT TO CHANGE, but this code assumes it has already done that\nJOIN rel_product_options AS PO1 ON (PO1.product = P1.id AND PO1.product = 1)\n# now join all other products that do not have identical option-value pairs\nLEFT JOIN rel_product_options AS PO2 ON (PO1.product != PO2.product AND PO1.`option` = PO2.`option` AND PO1.value = PO2.value)\n# and ... i'm lost ...\n</code></pre>\n"},{"tags":["query","solr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13249717,"title":"Solr query syntax Issue","body":"<p>I'm trying to do the following query with Solr:</p>\n\n<pre><code>time:90000 OR (-time:[1521 TO *] AND -(time:[* TO 1519] OR time:[1521 TO *]))\n</code></pre>\n\n<p>it returns only one result with tag <code>time=90000</code>, but I have two items with tag <code>time</code> with value <code>90000</code> and <code>1520</code>. I would like them both.</p>\n\n<p>Can anyone give me some explaination? Thanks in advance.</p>\n"},{"tags":["mysql","sql","query","normalization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13242840,"title":"SQL query - Two tables with relation many to one (Normalization issue)","body":"<p>I have this example tables:</p>\n\n<pre><code>table ORDERS\n\nclient   orderno   cant1   code1   notes1   cant2   code2   notes2   cant[i]   code[i] [...]\n--------------------------------------------------------------------------------------\n1          1        3      AA01    Test      4      BB01    Testing\n2          2        10     XX05    Test      \n\n\n\ntable PRODUCTS\n\ncode   prod    price\n---------------------\nAA01   Engine   100  \nBB01   Wheel     50  \n\n\n\ntable CLIENTS\n\nclient   name      address     telephone\n-----------------------------------------\n  1     Maxwell   24 1st st    0987654321\n  2     Hammer    77 main st   1234567890\n</code></pre>\n\n<p>I need to relate them to get the quantity, name of the product and price for each of the product lines (they are 30 cant[i], code[i] and notes[i]) and the customer's information (name, address, etc)</p>\n\n<p>I found this case, but I don't understand how to apply it to mine: <a href=\"http://stackoverflow.com/questions/9420475/sql-query-two-tables-with-relation-one-to-many\">SQL query two tables with relation one-to-many</a></p>\n\n<p>I hope it's not too complex.</p>\n\n<p>Thanks in advance!</p>\n\n<h1>EDIT</h1>\n\n<p>Thanks to ElectricLlama I realized the problem here is the table where the order is storaged. According to his answer, the normalization of the database would improve the way I'm able to get the info.</p>\n\n<p>For anyone interested in this solution, I found this great website: <a href=\"http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/\" rel=\"nofollow\">http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/</a></p>\n\n<p>This SO answer clears it ALL! Super clear and understandable!\n<a href=\"http://stackoverflow.com/a/1258776/888292\">http://stackoverflow.com/a/1258776/888292</a></p>\n"},{"tags":["python","query","autocomplete","combobox","pyqt4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13197267,"title":"QSqlRelationalTableModel and autocomplete field (PyQt4)","body":"<p>I have created a single-field tableview using QSqlRelationalTableModel. The only field in this tableview is taken from a table (mysql) with a long list of names. What is the right way to create an autocomplete when I write a name in the field which is logically connected with a query \"like\".</p>\n\n<pre><code>self.model = QtSql.QSqlRelationalTableModel()\n\nself.model.setTable(\"archlibri\")\nself.model.setHeaderData(0, QtCore.Qt.Horizontal, \"ID\")\nself.model.setHeaderData(1, QtCore.Qt.Horizontal, \"Autore\")\nself.model.setHeaderData(2, QtCore.Qt.Horizontal, \"Titolo\")\nself.model.setRelation(1, QtSql.QSqlRelation(\"elAutori\", \"aID\", \"aNome\"))\nself.model.select()\n\ntabella.setModel(self.model)       \n\ntabella.setItemDelegate(QtSql.QSqlRelationalDelegate(tabella))\n</code></pre>\n\n<p>Tabella is a QTableView. The column \"Autore\" (column have relation delegate) is where i want add a autocomplete when i write a name</p>\n"},{"tags":["sql","sql-server","xml","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13249503,"title":"SQL XML query from column","body":"<p>How to select file names from this kind of XML in a SQL Server column?</p>\n\n<ol>\n<li><p>file name is in attribute <code>VALUE</code> only if high level tag is object with name <code>File</code>\nlike this</p>\n\n<pre><code>&lt;Object NAME=\"File\"&gt;\n    &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n&lt;/Object&gt;\n</code></pre></li>\n<li><p>This sub-hierarchy can be placed on any level of xml (see example below)</p></li>\n<li><p>XML column can contain 0-N file names, I need list like this:</p>\n\n<pre><code>id, filename\n--- ------------------------\n 1  \\\\mysvr\\fiels\\readme1.txt\n 1  \\\\mysvr\\fiels\\readme2.txt\n 2  \\\\mysvr\\fiels\\readme3.txt\n 2  \\\\mysvr\\fiels\\readme4.txt\n</code></pre></li>\n</ol>\n\n<p>Example of XML contents:</p>\n\n<pre><code>declare @t1 table\n(   id int,\n   x XML\n)\n\ninsert into @t1 (id, x)\nselect 1,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n   &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n&lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"10\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme2.txt\" /&gt;\n&lt;/Object&gt;\n&lt;Object NAME=\"bitmap\"&gt;\n              &lt;Parameter ID=\"11\" NAME=\"my1\" VALUE=\"bmp\" /&gt;\n&lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\nunion \nselect 2,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"13\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme3.txt\" /&gt;\n  &lt;/Object&gt;\n  &lt;Object NAME=\"Font\"&gt;\n              &lt;Parameter ID=\"22\" NAME=\"Tahoma\" VALUE=\"11\" /&gt;\n  &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"14\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme4.txt\" /&gt;\n  &lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\n</code></pre>\n"},{"tags":["c#","linq","query","tolist"],"answer_count":4,"favorite_count":2,"up_vote_count":13,"down_vote_count":0,"view_count":200,"score":13,"question_id":13250561,"title":"Does foreach execute the query only once?","body":"<p>I have a list of items and a LINQ query over them. Now, with LINQ's deferred execution, would a subsequent foreach loop execute the query only once or for each turn in the loop?</p>\n\n<p>Given this example (Taken from <a href=\"http://msdn.microsoft.com/en-us/library/bb397906.aspx\">Introduction to LINQ Queries (C#), on MSDN</a>)</p>\n\n<pre><code>    // The Three Parts of a LINQ Query: \n    //  1. Data source. \n    int[] numbers = new int[7] { 0, 1, 2, 3, 4, 5, 6 };\n\n    // 2. Query creation. \n    // numQuery is an IEnumerable&lt;int&gt; \n    var numQuery =\n        from num in numbers\n        where (num % 2) == 0\n        select num;\n\n    // 3. Query execution. \n    foreach (int num in numQuery)\n    {\n        Console.Write(\"{0,1} \", num);\n    }\n</code></pre>\n\n<p>Or, in other words, <strong>would there be any difference if I had</strong>:</p>\n\n<pre><code>    foreach (int num in numQuery.ToList())\n</code></pre>\n\n<p>And, would it matter, if the underlying data is not in an array, but in a Database?</p>\n"},{"tags":["mysql","sql","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13247632,"title":"postgresql query to mysql","body":"<p>I want create query in MySQL similiar to PostgreSQL below:</p>\n\n<pre><code>CREATE FUNCTION check_unique_pair(IN id1 INTEGER, IN id2 INTEGER) RETURNS INTEGER AS   $body$\nDECLARE retval INTEGER DEFAULT 0;\nBEGIN \n SELECT COUNT(*) INTO retval FROM (\n  SELECT * FROM edges WHERE a = id1 AND b = id2\n  UNION ALL\n  SELECT * FROM edges WHERE a = id2 AND b = id1\n)  AS pairs;\nRETURN retval;\nEND\n$body$\nLANGUAGE 'plpgsql';\n\nALTER TABLE edges ADD CONSTRAINT unique_pair CHECK (check_unique_pair(a, b) &lt; 1);\n</code></pre>\n\n<p>I am new to MySQL.</p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13249903,"title":"mysql select multiple rows by referencing to one data field","body":"<pre><code>===========================\n= id = model_id = property =\n===========================\n= 14 = 1        = 1       =\n===========================\n= 15 = 1        = 3       =\n===========================\n= 16 = 2        = 1       =\n</code></pre>\n\n<p>I have a table like above and I want to select model_ids only where property equals to 1 AND 3</p>\n\n<p>I'd be glad if you could show me how</p>\n\n<p>thanks in advance </p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13249281,"title":"Getting extra data in MYSQL count query","body":"<p>Hi all i've had help from bluefleet (BF) with a mysql query which i've now put in a php file, the query works fine but i find i need to get extra data as well as the count, so what i need is when a match is found i need to look up the username in table tview3.</p>\n\n<p>Whichever table the ip match is found there will be a column called UID, in the table tview3 there will also be a column called USERNAME, what i'd like to do is get the username(s) for the matches and then use them in a text file.</p>\n\n<p>I have to state i'm a complete newbie at this, all help is appreciated</p>\n\n<pre><code>$myquery= \"select sum(total)\nfrom\n(\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview v\n    where v.ipaddress = '$ips'\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview2 v1\n    where v1.ipaddress = '$ips'\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview3 v3\n    where v3.ipaddress = '$ips'\n) src\";\n\n $result = mysql_query($myquery);\n    $rowCount = mysql_num_rows($result);\n    If($rowCount !=0){\n       echo \"NOT EMPTY\";\n    }else{\n      echo \"EMPTY\";\n    }\n   mysql_free_result($result);\n\n$UAM = strtoupper($_SERVER['HTTP_USER_AGENT']);\n$ips = strtoupper($_SERVER['REMOTE_ADDR']);\n$fp = fopen(\"logtext.txt\", \"a\");\n$DateOfRequest = date('m-d-Y H:i:s');\n\nfwrite($fp, \"$DateOfRequest . \\nMatched Member: . $username . \\nWith User Agent:  . $UAM . \\n\\nIP: . $ips . \\n\\n\");\n</code></pre>\n\n<p>So i'd like to populate a variable <strong>$username</strong> with the username(s) where the matches were found.</p>\n\n<p>Regards,\nSilo</p>\n"},{"tags":["sql","query","group","wise","sub-query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13245223,"title":"SQL Inner/Sub group wise Query for a specific scenario","body":"<p>I have a table as below</p>\n\n<blockquote>\n  <p>Schema: ID | Category | Keyword | Bid Price</p>\n</blockquote>\n\n<p>Write a sql to fetch out top 5 keywords based on the bid price per category.</p>\n\n<p>Details:</p>\n\n<p>Table definition considered on oracle 10.x:</p>\n\n<pre><code>create table test (\n    ID number,\n    Category varchar (20),\n    Keyword varchar (20),\n    BidPrice number\n);\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>insert into test values (1, 'Category-A', 'Keyword-A1', 110);\ninsert into test values (2, 'Category-A', 'Keyword-A2', 121);\ninsert into test values (3, 'Category-A', 'Keyword-A3', 130);\ninsert into test values (4, 'Category-A', 'Keyword-A4', 125);\ninsert into test values (5, 'Category-A', 'Keyword-A5', 115);\ninsert into test values (6, 'Category-A', 'Keyword-A6', 133);\ninsert into test values (7, 'Category-B', 'Keyword-B1', 105);\ninsert into test values (8, 'Category-B', 'Keyword-B2', 111);\ninsert into test values (9, 'Category-B', 'Keyword-B3', 108);\ninsert into test values (10, 'Category-B', 'Keyword-B4', 128);\ninsert into test values (11, 'Category-B', 'Keyword-B5', 144);\ninsert into test values (12, 'Category-B', 'Keyword-B6', 101);\ninsert into test values (13, 'Category-C', 'Keyword-C1', 150);\ninsert into test values (14, 'Category-C', 'Keyword-C2', 137);\ninsert into test values (15, 'Category-C', 'Keyword-C3', 126);\ninsert into test values (16, 'Category-C', 'Keyword-C4', 121);\ninsert into test values (17, 'Category-C', 'Keyword-C5', 112);\ninsert into test values (18, 'Category-C', 'Keyword-C6', 118);\n</code></pre>\n\n<p><strong>Output expected:</strong></p>\n\n<pre><code>KEYWORD        CATEGORY        BIDPRICE\n-------------- --------------- ----------\n</code></pre>\n\n<blockquote>\n  <p><br>Keyword-A6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;133\n  <br>Keyword-A3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;130\n  <br>Keyword-A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;125\n  <br>Keyword-A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;115\n  <br>Keyword-B5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;144\n  <br>Keyword-B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;128\n  <br>Keyword-B2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;111\n  <br>Keyword-B3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;108\n  <br>Keyword-B1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;105\n  <br>Keyword-C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;150\n  <br>Keyword-C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;137\n  <br>Keyword-C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;126\n  <br>Keyword-C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;118\n  <br></p>\n</blockquote>\n\n<p><em>Note:  Answer has to be only in SQL without use of any Oracle or database specific function.</em></p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13248976,"title":"How to insert, update, delete when import data from table to table?","body":"<p>I have a query that I need to run more than once a day. This query is importing data from a database to another. </p>\n\n<p>The target table structure is:  </p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2\n</code></pre>\n\n<p>An application can also insert data to the target table. The records that are inserted by the application may not be updated also when this record exists in the source(temp table) table with another state.</p>\n\n<p>To make this possible I have an solution created. I will create an new column in the target table with a second state so that I can check.</p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State   StateSource\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2       2\n</code></pre>\n\n<p>Some Requirements:</p>\n\n<p>If a record is added by the application than StateSource will be NULL. Means that this record may not be deleted, updated or inserted again from the source table.</p>\n\n<p>If a Record is updated by the application than the value State and StateSource will be different. In this case I do not update this record.</p>\n\n<p>I will update if the state from the sourcetable and targettable are not same and the values from target table State = StateSource.</p>\n\n<p>I will INSERT a record when this is not exists in the target table. When records already exists do not insert (no matter if this is added by the application or my query on the first run).</p>\n\n<p>I will delete the records from the target when they are no more exists in my sourcetable and State=StateSource.</p>\n\n<p>I already have the following queries. I have decided to make 3 statements.</p>\n\n<pre><code>--Delete Statement first\nDelete from t\nfrom TargetTable t LEFT JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\nand t.State=t.StateSource\n\n--Just delete if a date is no more exists from the source table and this records is NOT\n--changed by the application (t.State=t.StateSource)\n\n\n--Update statement second\nUpdate t\nset t.State = s.State\nFrom Targettable t INNER JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\n\nThe problem here is:\n--when I have State 2 already in the targettable and in my sourcetable i have\n--another state then the state in the targettable changes. This would not be the case.\n\n\n--Insert Statement thirth\n\ninsert into TargetTable (Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource)\nselect Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource\nfrom SourceTable s \nWHERE Date not in (select Date \n                   from TargetTable t \n                   where t.id=s.id \n                   and t.PersonId=s.PersonId\n                   and t.date=s.date\n                   and t.department=s.department)     \n\n--I have no idea about how the insert should be because the application also can\n--insert records. When a record exists then no insert. What to do with the State?\n</code></pre>\n\n<p>Remember that the states that are changed by the application are leading.</p>\n\n<p>Can anyone help me with the desired result? </p>\n"},{"tags":["sql","database","query","postgresql","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13249348,"title":"Extrude 2d polygon into 3d polygon","body":"<p>I am using postgresql and I have a table containing 2d polygons. Now my question is how can I extrude this polygon into a nice 3d building.? </p>\n\n<p>Can anyone help please? because I couldn't find a good tutorial on it.</p>\n\n<p>Many thanks</p>\n"},{"tags":["css","query","media"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":13248378,"title":"How to revert back to Desktop website from Mobile Website when using CSS Media Queries?","body":"<p>I'm using CSS media queries to create a responsive theme. I want to add a link at the footer of the website labeled \"GO TO DESKTOP WEBSITE\". This link will specifically be displayed on the mobile devices. How can I do it so that when a visitor click on the desktop website link, the website is loaded with desktop media query, not of mobile. I hope I've made myself pretty clear on my issue. I've searched on Google for the solution but can not find anything related.</p>\n"},{"tags":["mysql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13247243,"title":"Regarding query for db2","body":"<p>I have the query, I have the below relationships among the following tables </p>\n\n<pre><code>select * from PRODGP_STRUCTURE\nselect * from PRODGP_STR_LINK\nselect * from PRODUCT_GROUP\nselect * from PROD_PGRP_LINK\nselect * from PRODUCT\n</code></pre>\n\n<p>the relationship is ...</p>\n\n<pre><code>select pstr.PSTR_NAME, PG.PRGP_NAME, PRD.PROD_NAME\nfrom prodgp_structure pstr\nJOIN PRODGP_STR_LINK pgstrlnk\n  ON pgstrlnk.PSTR_ID = pstr.PSTR_ID  \nJOIN PRODUCT_GROUP pg \n  ON pgstrlnk.PRGP_CHILD_ID = PG.PRGP_ID\nJOIN PROD_PGRP_LINK prdprdgp\n  ON prdprdgp.PRGP_ID = pg.PRGP_ID\nJOIN product prd\n  ON prdprdgp.PROD_ID = prd.PROD_ID;\n</code></pre>\n\n<p>I have come up to the following query, </p>\n\n<pre><code>select * from PRODGP_STRUCTURE where pstr_id in \n(select pstr_id from PRODGP_STR_LINK where PRGP_CHILD_ID  in\n(select  prgp_id from PRODUCT_GROUP where PRGP_ID in ( select  PRGP_ID from PROD_PGRP_LINK where PROD_ID in ( select PROD_ID from product where PROD_ID=2))))\n</code></pre>\n\n<p>Please let e know is there any other way to write this query..!!</p>\n"},{"tags":["java","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13247844,"title":"Delete state for sql query","body":"<p>I've met up with some problems regarding to sql statement. I screenshot a photo of tables for you guys to see.</p>\n\n<p><img src=\"http://i.stack.imgur.com/pXzYD.png\" alt=\"Picture delete\"></p>\n\n<p>Okay, so what I'm trying to do here is that i retrieve a parameter from the user, which is '14' in this case. So the query has to link the other foreign keys and delete them off. For this, 'User' table is the \"Parent\" of the other 2 tables which is 'camera' and 'mob_dev'. However, camera can't be deleted as there is another foreign key connected to the table 'camera' which is 'device'. So is there any idea on how I can delete the 4 tables by only inputting a single parameter at 'User' table 'userid'. I tried it by doing this in the controller:</p>\n\n<pre><code>String querycam = \"DELETE FROM ip_camera where user_id =\"  +params.userinput\nString querydevice = \"DELETE FROM mobile_device where user_id =\"  +params.userinput\nString queryvalue = \"DELETE FROM sec_user where id =\"  +params.userinput\n</code></pre>\n\n<p>Or is there a better way for doing this? Thanks in advance to anyone who can solve this :).</p>\n"},{"tags":["sql","query","postgresql","otrs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13237579,"title":"querying otrs database","body":"<p>I have a problem with creating a query on a postgresql database from OTRS.  I need to get an asset list with some data that is stored in the CMDB, but I am having trouble with the way that the data is stored.</p>\n\n<p>This query works ok as far as it goes but as soon as I add another left join to get some more data it just runs for ever without returning any results.</p>\n\n<p>As far as I can see, the problem is that all the information is contained in the xml_storage table without any relationships so I need to repeatedly query that table to get the data.  There is also a mix of data types where an integer is stored as a varyable character in some cases and this prevents me from using that value to get additional information from the general catalog.</p>\n\n<p>I have been banging my head against a brick wall for days on this so i would really appreciate any help</p>\n\n<pre><code>SELECT \n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      array_agg(service),\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    FROM \n      public.configitem_version,\n      public.general_catalog,\n      public.configitem \n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS asset_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Asset Number''}[1]{''Content''}')   as select_asset on last_version_id::int = select_asset.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS manufacturer_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Manufacturer''}[1]{''Content''}' ) as select_manufacturer on last_version_id::int = select_manufacturer.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS model_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Model''}[1]{''Content''}' ) as select_model on last_version_id::int = select_model.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS serial_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''SerialNumber''}[1]{''Content''}' ) as select_serial on last_version_id::int = select_serial.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS fqdn_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''FQDN''}[1]{''Content''}' ) as select_fqdn on last_version_id::int = select_fqdn.xml_key::int\n\n    left join\n      (SELECT \n      link_relation.source_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.target_key::int = service.id AND\n      link_relation.target_object_id::int = 2 AND link_relation.source_object_id::int = 3\n      UNION\n      SELECT \n      link_relation.target_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.source_key::int = service.id AND\n      link_relation.target_object_id::int = 3 AND link_relation.source_object_id::int = 2) as select_service on configitem.id = configitem_id::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS purchasedate_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''PurchaseDate''}[1]{''Content''}' ) as select_purchasedate on last_version_id::int = select_purchasedate.xml_key::int\n\n    left join\n      (SELECT\n      general_catalog.name AS status_value,\n      general_catalog.id\n      FROM\n      public.general_catalog) as select_status on configitem.cur_depl_state_id::int = select_status.id::int\n\n    WHERE\n      configitem.last_version_id = configitem_version.id AND\n      configitem.class_id = general_catalog.id AND\n      (configitem.class_id = 32 OR configitem.class_id = 33)\n\n\n    GROUP BY\n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    ;\n</code></pre>\n"},{"tags":["sql","sql-server","query","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13244832,"title":"SQL Server 2000 Query of total value and value from max date","body":"<p>I have this RoomTable with value</p>\n\n<pre><code>SID   Room   Date        APhase   BPhase   ACount  BCount\n1     One    10/28/2012  4        5         3       6\n2     One    10/29/2012  2        3        -1      -1\n3     One    10/30/2012  4        5         7      -1\n4     Two    10/28/2012  8        3         2       3\n5     Two    10/30/2012  3        5         4       6\n6     Three  10/29/2012  5        8         2      -1\n7     Three  10/30/2012  5        6        -1       4\n8     Four   10/29/2012  6        2        -1      -1\n9     Four   10/30/2012  5        8        -1      -1\n</code></pre>\n\n<p>What I want is to return the following:</p>\n\n<ol>\n<li>Total sum of APhase and BPhase of each Room.</li>\n<li>Value of ACount and BCount from max date of each Room</li>\n<li>If ACount value is -1 then use the previous date. Same as BCount.</li>\n<li>If ACount value is -1 and the previous date is -1 and so on. Then use 0. Same as BCount.</li>\n</ol>\n\n<p>I can get the query of number 1 with this query</p>\n\n<pre><code>SELECT Room, sum(APhase) as TotalAPhase, sum(BPhase) as TotalBPhase \nFROM RoomTable \nWHERE Date between '10/28/2012' and '10/30/2012'\ngroup by Room\norder by Room\n</code></pre>\n\n<p>But I'm confused on how to include the number 2-4 query.</p>\n\n<p>This is the output I want</p>\n\n<pre><code>Room  TotalAPhase  TotalBPhase  ACount   BCount\nOne   10           13           7        6\nTwo   11           8            4        6\nThree 10           13           2        4\nFour  11           10           0        0\n</code></pre>\n\n<p>Any ideas will be much appreciated. Thanks. </p>\n"},{"tags":["sql","query","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13245424,"title":"Join in Db2 query","body":"<p>I have joined two tables using inner join. Here primary key of table <code>TPREG</code> is <code>co_id</code> and <code>pol_id</code></p>\n\n<pre><code> SELECT (SELECT etbl_desc_txt\n       FROM uding604.tedit e\n       WHERE etbl_typ_id = 'PITCD'\n       AND   co_id = 'CP'\n       AND   etbl_valu_id = p.pol_ind_typ_cd) pol_ind_typ_cd,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYT'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_TYP_CD) POL_BILL_TYP_CD,\n       POL_PAC_DRW_DY,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYM'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_MODE_CD) POL_BILL_MODE_CD,\n       t.SOURCE_CD\nFROM uding604.tpol p,\n     uding604.TPREG t\nWHERE p.co_id = t.co_id\nAND   p.pol_id = t.pol_id\nAND   p.co_id = 'CP'\nAND   p.pol_id = '000000011'\nAND   t.co_id = 'CP'\nAND   t.pol_id = '000000011'\n</code></pre>\n\n<p>How to make this query more simple?</p>\n\n<p>Please guide.</p>\n"},{"tags":["mysql","query","stored-procedures","prepared-statement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13245390,"title":"Removing Parameters from where clause to display records","body":"<p>I have a real estate website where people can search property based on Location, Property Type and Builder.</p>\n\n<p>I have a Table like below.</p>\n\n<pre>\n\nCREATE TABLE Project(ProjectId INT NOT NULL PRIMARY KEY AUTO_INCREMENT, \n                     Location  VARCHAR(255), \n                     PropertyType VARCHAR(255), \n                     Builder VARCHAR(255), \n                     ProjectName  VARCHAR(255),\n                     Status TINYINT)\n\n\nINSERT INTO Project(Location, PropertyType, Builder, ProjectName)\n             VALUES('Location A', 'Flats',     'Builder A', 'Project A', 1),\n                   ('Location A', 'Villas',    'Builder B', 'Project B', 1),\n                   ('Location B', 'Flats',     'Builder A', 'Project C', 1),\n                   ('Location C', 'Villas',    'Builder C', 'Project D', 1),\n                   ('Location B', 'Plots',     'Builder B', 'Project E', 1),\n                   ('Location A', 'Row House', 'Builder C', 'Project F', 1),\n                   ('Location A', 'Plots',     'Builder A', 'Project G', 1),\n                   ('Location C', 'Plots',     'Builder C', 'Project H', 1),\n                   ('Location C', 'Flats',     'Builder B', 'Project I', 1),\n                   ('Location C', 'Villas',    'Builder B', 'Project J', 1),\n                   ('Location A', 'Villas',    'Builder A', 'Project K', 1),\n                   ('Location C', 'Flats',     'Builder B', 'Project L', 1);\n\n</pre>\n\n<p>The search procedure which I use is in such a way that It brings back search result as per the parameters they selected i.e Property Type, Location, Builder Name</p>\n\n<p>Now there may be projects for some search parameters as below</p>\n\n<p>Flats by Builder A at Location C </p>\n\n<p>I want to change procedure in such a way the parameters in filters in where clause should change to bring result all the time by considering other possibilities like for the above </p>\n\n<p>Flats by Builder A at Location C </p>\n\n<p>There is no Flats by Builder A at Location C so it should display Flats at Location C by Other Builders</p>\n\n<pre>\n\n      Location C   Flats     Builder B    Project I\n\n</pre>\n\n<p>The Filter should Consider  PropertyType, Location and Builder Name</p>\n\n<p>Villas at Location B </p>\n\n<p>There is No Villas at Location B So </p>\n\n<pre>\n\nLocation A    Villas   Builder B   Project B\nLocation C    Villas   Builder B   Project J\nLocation A    Villas   Builder A   Project K\n\n</pre>\n\n<p>The search should happen by </p>\n\n<pre>\n\n       PropertyType -> Location -> Builder\n\n</pre>\n\n<p>If there is No project for a particular Builder in that Location then </p>\n\n<pre>\n\n       PropertyType -> Location\n\n</pre>\n\n<p>If there is No project for a particular Location then </p>\n\n<pre>\n\n       PropertyType\n\n</pre>\n\n<p>The parameters in the filters should be eliminated in such a way it brings similar result to search param.</p>\n\n<pre>\n\n       PropertyType -> Location -> Builder       No Records\n       PropertyType -> Location                  No Records\n       PropertyType                              Records Found\n\n</pre>\n\n<p>The procedure I created is as Below</p>\n\n<pre>\n\n    DROP PROCEDURE  IF EXISTS getProjectResult;\n    CREATE PROCEDURE getProjectResult(IN PropertyType VARCHAR(255), IN Location VARCHAR(255), IN BuilderName VARCHAR(255))\n    BEGIN\n      SET @strSQL = 'SELECT * \n                       FROM project\n                      WHERE status = 1 ';\n\n      IF PropertyType != '' THEN\n        SET @strSQL = CONCAT(@strSQL, ' AND PropertyType =\"', PropertyType, '\" ');\n      END IF;\n\n      IF Location != '' THEN    \n        SET @strSQL = CONCAT(@strSQL, ' AND Location =\"', Location, '\" ');\n      END IF;\n\n      IF BuilderName != '' THEN\n        SET @strSQL = CONCAT(@strSQL, ' AND Builder =\"', BuilderName, '\" ');\n      END IF;\n\n      PREPARE stmt FROM @strSQL;\n      EXECUTE stmt;  \n      DEALLOCATE PREPARE stmt; \n    END;\n\n</pre>\n\n<p>So My Procedure is Going to bring output as below</p>\n\n<pre>\n\n     CALL getProjectResult('Flats', 'Location C', 'Builder A');\n\n</pre>\n\n<p>No Output</p>\n\n<p>So it should display </p>\n\n<pre>\n\n       Location C    Flats     Builder B   Project L  \n\n</pre>\n\n<p>How to Change Procedure in such a way it remove parameters from filters so it brings result.\nThe parameters should be removed in following order builder, location and property type.</p>\n\n<p>Property type should be given highest preference followed Location and builder name</p>\n\n<p>Thanks for Reply</p>\n"},{"tags":["sql","sql-server","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13241518,"title":"sql query including month columns?","body":"<p>I was wondering if I could get some ideas or direction on a sql query that would output column months. Here is my current query..</p>\n\n<pre><code>select A.assetid, A.Acquisition_Cost, B.modepreciaterate from FA00100 A\ninner join FA00200 B on A.assetindex = B.assetindex\nwhere MoDepreciateRate != '0'\n</code></pre>\n\n<p>I would like to add more columns that look as such:</p>\n\n<pre><code>select assetid, acquisition_cost, perdeprrate, Dec_2012, Jan_2013, Feb_2013....\n\nwhere Dec_2012 = (acquisition_cost - MoDepreciateRate*(# of months))\nand Jan_2013 = (acquisition_cost - MoDepreciateRate*(# of months))\n</code></pre>\n\n<p>where # of months can be changed.</p>\n\n<p>Any help would be really appreciated. Thank you!</p>\n\n<p>Here is an example of what I would like the output to be with '# of months' = 4</p>\n\n<pre><code>assetid SHRTNAME    Acquisition_Cost    perdeprrate Dec_2012    Jan_2013    Feb_2013    Mar_2013\nCS-013  GEH INTEG   17490.14            485.83      17004.31    16518.48    16032.65    15546.82\nCS-014  WEB BRD     14560               404.4507    14155.5493  13751.0986  13346.6479  12942.1972\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13245476,"title":"Error (1093):You cant update target table for update in FROM Clause","body":"<p><strong>This is the select statement  which i have got the correct answer:</strong></p>\n\n<pre><code>select s_billing_cycle.Billing_cycle from s_billing_cycle \njoin o_daily_lcsgeneration_copy on o_daily_lcsgeneration_copy.Location=s_billing_cycle.Location where o_daily_lcsgeneration_copy.Date between s_billing_cycle.From_Date and s_billing_cycle.To_Date\n</code></pre>\n\n<p><strong>while updating the same query into another table i couldnt do that using update query getting :\nYou cant update target table \"o_daily_lcsgeneration_copy\" for update in FROM Clause \nthe query i have used is :</strong></p>\n\n<pre><code>update o_daily_lcsgeneration_copy  set o_daily_lcsgeneration_copy.Billing_cycle = (select s_billing_cycle.Billing_cycle from s_billing_cycle join o_daily_lcsgeneration_copy on o_daily_lcsgeneration_copy.Location=s_billing_cycle.Location where o_daily_lcsgeneration_copy.Date between s_billing_cycle.From_Date and s_billing_cycle.To_Date) \n</code></pre>\n\n<p>Help  me !!!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13243626,"title":"Efficient Query, Table Bridge/Indexing and strucuture","body":"<p>In my PhpMyAdmin database I have 9 tables. 8 of those tables are relevant to me at this moment. I would like my queries to be executed quickly enough but I am not sure the design/structure of the tables are the most effecient. Any suggestion of merging a table with another or creating another bridge table?  Also, I am struggling in building a query that will display bridge results from the following tables: <code>semester</code>, <code>schedule</code>, <code>office_hours</code>, <code>faculty</code>, <code>section</code>, <code>major_minor</code>, <code>major_class_br</code>, <code>class</code>?</p>\n\n<p><a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">TABLE STRUCTURE</a></p>\n\n<p>Basic Query- that shows class details</p>\n\n<pre><code>SELECT  class_name, class_caption, class_credit_hours, class_description\nFROM class  \n</code></pre>\n"},{"tags":["sql","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4055,"score":1,"question_id":4714239,"title":"How to delete last record(on condition) from a table in MySql","body":"<p>I have a <strong>LoginTime</strong> table like this:</p>\n\n<pre><code>id | user_id | datetime\n1  |   1     | 2011-01-17 18:51:05\n2  |   1     | 2011-01-18 18:51:05  \n3  |   1     | 2011-01-19 18:51:05  \n4  |   2     | 2011-01-19 18:51:05  \n</code></pre>\n\n<p>I want to delete last record for <code>user_id=1</code>. Last record of a user can be recognized by <code>datetime</code>.</p>\n\n<p>How can I do this with one query. </p>\n"},{"tags":["sql","sql-server","database","query","sql-server-2008-r2"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":11666009,"title":"SQL server query to get this output","body":"<p>I have a query which i am unable to get the output.\nBelow is the query to be executed</p>\n\n<p>Q: 2.   Write a query to find the city Name, Id and Count that has got maximum number of vehicles associated.</p>\n\n<p>Now, Given is the one table on which the query should be executed.</p>\n\n<pre><code>Vehicle_Detail_ID   City_ID\n56                    242\n57                    242\n58                    242\n59                    243\n60                    241\n61                    242\n62                    245\n</code></pre>\n\n<p>Another table which has the city name</p>\n\n<pre><code>City_ID City_Name\n242          Bangalore\n243          ChamarajNager\n241          Bellary\n245          Chitradurga\n</code></pre>\n\n<p>EXPECTED OUTPUT: </p>\n\n<pre><code>City_ID No_Vehicles\n242          4\n</code></pre>\n\n<p>Please tell me how to write the query which fetches me the right output.</p>\n\n<p>Given below is the query which gives the city Id and its vehicle count.\nTRIED: </p>\n\n<pre><code>SELECT c.city_id, COUNT(c.City_ID) AS NO_vehicles\n  FROM city c, vehicle_details v \n WHERE c.City_ID = v.City_ID\n GROUP BY c.City_ID\n</code></pre>\n\n<p>ACTUAL OUTPUT </p>\n\n<pre><code>City_ID No_Vehicles\n242             4\n243             1\n241             1\n245             1\n</code></pre>\n\n<p>Please help me to get max of these as shown in EXPECTED OUTPUT.</p>\n"},{"tags":["python","django","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13243575,"title":"Curious about how django achieves the ORM query optimization","body":"<p>I am no python expert and I am curious about how django optimize the following query</p>\n\n<pre><code>Model.objects.filter(field = 'abc')[0]\n</code></pre>\n\n<p>Somehow django will intelligently add '<code>limit 1</code>' to SQL query like '<code>select * from model where field = 'abc' limit 1</code>'</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13242632,"title":"SQL Query with INI data?","body":"<p>I have a simple data table with the a column structure including: name, email, paid, and params</p>\n\n<p>The 'params' column contains custom fields filled in by a form from the user.  I have provided a sample submission value AT THE BOTTOM OF THIS QUESTION.  I i would like to display:</p>\n\n<p>custom_field_value_1_person_1</p>\n\n<p>custom_field_value_2_person_1</p>\n\n<p>custom_field_value_3_person_1</p>\n\n<p>custom_field_value_4_person_1</p>\n\n<p>Is there any way to retrieve these from such data?</p>\n\n<p>Right now my simple query reads: </p>\n\n<pre><code>SELECT\n  R.ohanah_registration_id,\n  E.title AS Event,\n  R.name,\n  R.email,\n  R.paid\nFROM\n waqcl_ohanah_registrations R LEFT JOIN waqcl_ohanah_events E\n  ON R.ohanah_event_id = E.ohanah_event_id\n</code></pre>\n\n<p>SAMPLE SUBMISSION VALUE:\nfield_name_person_1=field_name_person_2=field_name_person_3=field_name_person_4=field_name_person_5=custom_field_value_1_person_1=\\CrossFit Gold\\\"custom_field_value_1_person_2=\\\"\\\"custom_field_value_1_person_3=\\\"\\\"custom_field_value_1_person_4=\\\"\\\"custom_field_value_1_person_5=\\\"\\\"custom_field_value_2_person_1=\\\"XL\\\"custom_field_value_2_person_2=\\\"\\\"custom_field_value_2_person_3=\\\"\\\"custom_field_value_2_person_4=\\\"\\\"custom_field_value_2_person_5=\\\"\\\"custom_field_value_3_person_1=\\\"m\\\"custom_field_value_3_person_2=\\\"\\\"custom_field_value_3_person_3=\\\"\\\"custom_field_value_3_person_4=\\\"\\\"custom_field_value_3_person_5=\\\"\\\"custom_field_value_4_person_1=\\\"916-952-..  </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13242569,"title":"Query to retrieve records containing Unix dates","body":"<p>One column in a table in my MySQL database stores date in Unix format.</p>\n\n<p>I am trying to retrieve all rows where the date is later than a specific date. How do I write a query to do this? I want something like:</p>\n\n<pre><code>SELECT * FROM table_name WHERE date &gt; \"yyyy-mm-dd\";\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","sql","query","group-by","case"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13228875,"title":"Using CASE WHEN with GROUP BY","body":"<p>Background: I'm trying to display a table with the headings: id, full_name, position_7, position_8, position_9...etc if a person was an active employee for Jul and Aug, then 2012_Jul and 2012_Aug will be displayed in position_7 and 8 on one line. If I don't use GROUP BY I get the output but on 2 lines. The reason this is happening is because in the BLMths table a single person will have multiple entries due to being employed for more than 1 month. </p>\n\n<p>The below query will get every persons id, full_name and month successfully...if I don't use GROUP BY. But the problem is, if I neglect to use GROUP BY I will have 4 lines (or more) for each person in my table.   When I do use GROUP BY, I have the desired output of 1 line for each person, but the data I need in the table isn't all there.</p>\n\n<p>Does anyone know what I'm doing wrong?  Or does anyone know why when I use GROUP BY the data from some of my CASE statements appear to be missing?</p>\n\n<p>I know the answer to this has to be simple, but I can't seem to solve it.  Any help is appreciated.   Many thanks in advance.</p>\n\n<pre><code>SELECT Blm.Ags, Blmths.Id, Ie.Full_Name, Blmths.Month,\n       CASE month\n       WHEN \"2012-07-01\" THEN 1\n           ELSE NULL\n       END AS Position_7,\n       CASE month\n       WHEN \"2012-08-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_8,\n       CASE Blmths.Month\n       WHEN \"2012-09-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_9,\n       CASE month\n       WHEN \"2012-10-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_10,\n       CASE Blmths.Month\n       WHEN \"2012-11-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_11,\n       CASE Blmths.Month\n       WHEN \"2012-12-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_12,\n       CASE month\n       WHEN '2013-01-01' THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_1,\n       CASE month\n       WHEN \"2013-02-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_2,\n       CASE month\n       WHEN \"2012-03-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_3,\n       CASE Blmths.Month\n       WHEN \"2013-04-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_4,\n       CASE Blmths.Month\n       WHEN \"2013-05-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_5,\n       CASE Blmths.Month\n       WHEN \"2013-06-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_6\n  FROM Bogus_Leadership_Months AS Blmths, Injection_Employees AS Ie,\nBogus_Leadership_Members AS Blm\n  WHERE Blmths.Id = Blm.Id\n    AND Ie.Ags = Blm.Ags\n    AND Ie.Centre_Id = '666'\n  GROUP BY Blm.Ags\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13242268,"title":"MYSQL Query: combine columns and get count","body":"<p>I have about 9 tables that contain the same type of field. I would like to combine the 9 of them FIRST, and then get the distinct count of unique values in that combined column. This is what I've tried so far, but to no avail. I'm not also not sure this is the most efficient way to return this value?</p>\n\n<pre><code>SELECT COUNT(DISTINCT aircraft_id) FROM \n(\nSELECT aircraft_id FROM database.a_message UNION ALL\nSELECT aircraft_id FROM database.b_message UNION ALL\nSELECT aircraft_id FROM database.c_message UNION ALL\nSELECT aircraft_id FROM database.d_message UNION ALL\nSELECT aircraft_id FROM database.e_message UNION ALL\nSELECT aircraft_id FROM database.f_message UNION ALL\nSELECT aircraft_id FROM database.g_message UNION ALL\nSELECT aircraft_id FROM database.h_message UNION ALL\nSELECT aircraft_id FROM database.i_message\n) ;\n</code></pre>\n"},{"tags":["query","date","datetime","sdk","rally"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13185167,"title":"Rally: how to pull latest testresult from a specific testset","body":"<p>I am trying to use the following code to get a pie chart for the latest testresult from a particular testset.</p>\n\n<pre><code>pieconfig = {\ntype: 'TestCaseResult',\nattribute: 'Verdict',\nquery: rally.sdk.util.Query.and(['TestSet = \"' + testsetDropdown.getValue() + '\"','Date &lt; \"2012-11-01\"'])\n            };\nvar pieChart = new rally.sdk.ui.PieChart(pieconfig,rallyDataSource);\npieChart.display(\"pieChartDiv\");\n</code></pre>\n\n<p>In this code I've put today's date manually, but I want to make this query as of a  generic type which should pull the latest testresult from a specific testset. Any hints...? Thank you.</p>\n"},{"tags":["php","mysql","database","query","many-to-many"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":10884677,"title":"A library database","body":"<p>So me and my colleague have been assigned for making a library database as the lesson's assignement and then make an html database interface where someone would be able to perform certain tasks within the database such as inserting rows, deleting rows, finding rows etc.</p>\n\n<p>We have created the database, imported it and all that but the problem is in inserting elements into it.</p>\n\n<p>Well for example the books table has a many-to-many relationship with the authors table (where primary keys of each table are the ISBN and the authors ID respectively) so when we want to insert a book with it's authors in our DB we don't know exactly how to do it because they are in different tables. We are confused as to how we would put data from a single form in multiple tables with different primary keys.</p>\n\n<p>We have been trying to find examples like that but to no avail.</p>\n\n<p><img src=\"http://i.stack.imgur.com/FCVs4.png\" alt=\"\"></p>\n\n<p>Even links to tutorials and whatnot are mostly welcome.</p>\n\n<p>Server side code is PHP.</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["sql","query","caching","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13239510,"title":"Caching database data","body":"<p>I am trying to cache some data from the database to reduce number of SQL queries to the database. Currently, what I am doing is that I will load a set of records from the database:</p>\n\n<pre><code>@records = Record.find(:all, :conditions =&gt; [\"id &lt; ?\", 100])\n</code></pre>\n\n<p>and then iterate through this array to find the records that I really want:</p>\n\n<pre><code>@needed_records = Array.new\n@records.each do |record|\n  if record.is_needed\n    @needed_records.push(record)\n  end\nend\n</code></pre>\n\n<p>So that whenever I need, i can just pass @records instead of actually accessing the database.</p>\n\n<p>My question is, is there any shortcoming doing it this way? Is there any better way to do the equivalent?</p>\n"},{"tags":["php","mysql","query","environment"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":65,"score":-4,"question_id":13240734,"title":"Using mysql query and result in php?","body":"<p>I've had some help from bluefleet (BF) with a mysql query, i now need to use that query in a php environment, this is what i've come up with, firstly can you tell me if it's correct and secondly do i need to release the query after i've done something with the result?</p>\n\n<p>Here's the query</p>\n\n<pre><code>    $myquery= \"select sum(total)\nfrom\n(\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview v\n    where v.ipaddress = $ips\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview1 v1\n    where v1.ipaddress = $ips\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview3` v3\n    where v3.ipaddress = $ips\n) src\";\n\nwhile ($row = mysql_fetch_array($myquery)) {\n\nIf($row !=0){\necho \"NOT EMPTY\";\n}else{\necho \"EMPTY\";\n}\n}\n</code></pre>\n"},{"tags":["php","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13239393,"title":"php- Query - need to adapt a line of code to act as another one (shown)","body":"<p>On one hand I have this part of code that list my recent articles correctly (wit the ones from Categories tagged as inrecent=1\n\"</p>\n\n<pre><code> $query = \"SELECT * FROM \" . AL_ARTICLES_TABLE . \" AS art\n    INNER JOIN \" . AL_USERS_TABLE . \" AS u ON art.AuthorID = u.UserID\n    LEFT JOIN \" . AL_CATASSOC_TABLE . \" AS ca ON art.ArticleID = ca.ArticleID\n    INNER JOIN \" . AL_CATEGORIES_TABLE . \" AS c ON ca.CategoryID = c.CategoryID\n    WHERE ca.CategoryID IN(%s) \n    AND art.Featured=0 \n    AND art.Visible=1 \n    AND c.inrecent=1 \n    AND art.Status=1 \n    AND art.StartDate &lt;= '\".GetMysqlDateTime().\"' \n    AND art.IsFinished=1 \n    AND (art.ExpiryDate &gt;= '\".GetMysqlDateTime().\"' \n    OR art.EnableExpiry=0)\n    GROUP BY art.ArticleID\n    ORDER BY art.StartDate DESC, art.ArticleID DESC\n    LIMIT \" . $this-&gt;numArticles;\n</code></pre>\n\n<p>On the other hand I am looking to prevent the Articles from categories tagged as inrecent=0 to be selected in the query below (and I will need help, please) :</p>\n\n<pre><code>$query = sprintf(\"SELECT *, \n    unix_timestamp(StartDate) AS SD FROM %s AS a \n    INNER JOIN %s AS u ON a.AuthorID = u.UserID \n    WHERE a.Visible=1 AND a.Status=1  \n    AND a.IsFinished=1 \n    AND unix_timestamp(a.StartDate) &lt;= unix_timestamp(now()) \n    AND (unix_timestamp(a.ExpiryDate) &gt;= unix_timestamp(now()) \n    OR a.EnableExpiry=0) %s \n    ORDER BY StartDate DESC, ArticleID DESC %s\", \n    AL_ARTICLES_TABLE, AL_USERS_TABLE, $podcastQuery, $limitArticles);\n</code></pre>\n\n<p>Thank you for your help - Hope I posted enough info.</p>\n"},{"tags":["mysql","query","table","count"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":26,"score":1,"question_id":13240115,"title":"MySql find match in any of three tables?","body":"<p>im trying to find a match for an ip address in any one of three tables but my query tells me the column i'm looking in is ambiguous?</p>\n\n<pre><code>SELECT COUNT(*) \nFROM `zz_tview`,`zz_tview1`,`zz_tview3` \nWHERE `ipaddress` =\"192.168.01.01\"\n</code></pre>\n\n<p>So i get this message \"Column 'ipaddress' in where clause is ambiguous\", how would i construct this firstly so it works and secondly so the query isn't too heavy as the tables have many thousands of rows?</p>\n\n<p>Regards,\nSimon</p>\n"},{"tags":["sql-server","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13234761,"title":"Multiple rows in one","body":"<p>I know there are similar questions like mine but unfortunately I haven't found the corresponding solution to my problem.</p>\n\n<p>First off here's a simplified overview of my tables:</p>\n\n<ul>\n<li><p><code>Partner</code> table: <code>PartnerID, Name</code></p></li>\n<li><p><code>Address</code> table: <code>PartnerID, Street, Postcode, City, ValidFrom</code></p></li>\n<li><p><code>Contact</code> table: <code>PartnerID, TypID, TelNr, Email, ValidFrom</code></p></li>\n</ul>\n\n<p>A partner can have one or more addresses as well as contact info. With the contact info a partner could have let's say 2 tel numbers, 1 mobile number and 1 email. In the table it would look like this:</p>\n\n<pre><code>PartnerID   TypID   TelNr                   Email               ValidFrom\n1           1       0041 / 044 - 2002020                        01.01.2010\n1           1       0041 / 044 - 2003030                        01.01.2011\n1           2       0041 / 079 - 7003030                        01.04.2011\n1           3                               myemail@hotmail.com 01.06.2011\n</code></pre>\n\n<p>What I need in the end is, combining all tables for each partner, is like this:</p>\n\n<pre><code>PartnerID   Name    Street              Postcode        City            TelNr                               Email\n1           SomeGuy MostActualStreet    MostActualPC    MostActualCity  MostActual Nr (either type 1 or 2)  MostActual Email\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["sql","sql-server","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13239312,"title":"Return 4 separate counts for single column in SSRS DataSet","body":"<p>I want to provide 5 counts to SSRS from a conditional count on a column.  For instance, suppose the column held the color of a product -- green ,blue, red and yellow.  What I would like to do is return the count of each in a single query.</p>\n\n<p>Although I can accomplish getting this done using a case statement:</p>\n\n<pre><code>Select\n      COUNT(*) 'Count',\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GR' then 'Green\n            Else 'All Others'\n      End as Payment\nFrom COLORS(NoLock)\nGroup by\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GRthen ‘Green’\n            Else 'All Others'\n      End\n</code></pre>\n\n<p>When I use the dataset is SSRS, all I get is the a single count.  I don't want to create 4 dataset queries as I'm actually selection the records by the parameters start and end date and I would end up having 5 sets of date parameters. </p>\n"},{"tags":["sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13239041,"title":"sql server 2008, altering the table layout","body":"<p>Please find the blow table.  </p>\n\n<p><strong>TABLE</strong>  </p>\n\n<pre><code>ClientID    Balance1    Balance2    Balance3    Balance4    Balance5    Balance6    Balance7    Balance8    Balance9\nA           NULL        NULL        NULL        3           Null        Null        Null        Null        Null\nB           10          null        Null        Null        20          Null        Null        Null        NULL\nC           Null        8           Null        10          Null        Null        1           Null        NULL\nD           Null        19          Null        Null        Null        Null        Null        Null        NULL\nE           Null        Null        50          Null        Null        Null        Null        Null        NULL\nF           NULL        NULL        NULL        30          NULL        NULL        NULL        NULL        NULL    \nG           NULL        NULL        NULL        NULL        80          NULL        NULL        NULL        NULL      \n</code></pre>\n\n<p>How can I modify the above table into as shown below by using query, Please help!    </p>\n\n<pre><code>ClientID    Balance1    Balance2    Balance3    Balance4    Balance5    Balance6    Balance7    Balance8    Balance9\nA           NULL        NULL        NULL        3           3           3           3           3           3   \nB           10          10          10          10          20          20          20          20          20\nC           Null        8           8           10          10          10          1           1           1\nD           Null        19          19          19          19          19          19          19          19\nE           Null        Null        50          50          50          50          50          50          50          \nF           NULL        NULL        NULL        30          30          30          30          30          30          \nG           NULL        NULL        NULL        NULL        80          80          80          80          80          \n</code></pre>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["query","web-scraping"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":12762425,"title":"Data Aggregation from multiple websites for a given query","body":"<p>Hi I am going to work on a project wherein i want to query few web sites and fetch similar data from them and present it to the user. for eg: if a user has a query with name-\"reebok shoes\" of size \"9.0\" between range \"$30 to $75\" , my application should scape a few websites (which i will be providing) for these queries and fetch the relevant data from them.Without saving the data in DB i need to format and fetch it to the user. I am new to this so need pointers on which framework to choose or which tool or any important stuff i should know abt web scraping. I did researched a few tools and framework but not sure which one is able to handle query specific web scraping.</p>\n"},{"tags":["wordpress","query","content","singlepage","development-approach"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13238747,"title":"Approach for creating a single-page WordPress site","body":"<p>I've lately come across several cases where the client wants a single-page WordPress site, be it a Parallax solution, a contained frame or just a regular page with all content gathered. So far I've used this approach for fetching the content:</p>\n\n<p>In the index.php file in the theme's folder, before any HTML I make a query for all content. This might be separated, such as a query for all pages, one for all posts of a specific category etc, so that they are more easily looped.\nThen I loop the queries,<br><br></p>\n\n<pre><code>while ( $query-&gt;have_posts() ) : $query-&gt;the_post();\n    // Sample\n    if ($post-&gt;ID == 1 ) {\n        $sample = get_the_content();\n    }\nendwhile;\n</code></pre>\n\n<p><br>and output the content at their respective part of the page. Now this works great for smaller sites, but put in an additional language and a couple of custom post types and it can get really messy. Now I'm wondering if there isn't a better approach, and one that particularly doesn't involve ID matching (i.e. running conditional statements for every article in the loop). Ideas?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13237570,"title":"MySQL query consuming an inordinate amount of processor time of the system's CPU","body":"<p>I have the following MySQL query which seems to be consuming an inordinate amount of processor time of the system's CPU.</p>\n\n<p>The query is suppose to get the news that has the highest number of comments in last week:</p>\n\n<pre><code>$timeago = strtotime(\"-1 week\");\n\n$query = \"SELECT * , \n    news.id, \n    news.title, \n    news.state, \n    news.date, \n    COUNT(comments.module_id) as comments_count, \n    comments.module, \n    comments.state \n    FROM news \n    LEFT OUTER JOIN comments on comments.module_id = news.id AND comments.module = 'news' AND comments.state = '1' \n    WHERE news.state = '2' \n    GROUP BY news.id, news.title, news.date \n    ORDER BY news.date &gt;= $timeago DESC, comments_count DESC limit 6\";\n\n$result = mysql_query($query) or die (mysql_error());\n$data = mysql_fetch_assoc($result);\n</code></pre>\n\n<p>The query servers me just right, it sorts out the news which has the highest number of comments in the last week. There is 17,290 record in news table. For this reason I am try to figure out to fix the query in a way that would be healthy for the CPU consumption.</p>\n\n<p>Any suggestions would be welcome.</p>\n\n<p>Explain plan says</p>\n\n<p>| id    | select_type   | table     | type  | possible_keys     | key   | key_len   | ref   | rows  | Extra</p>\n\n<p>| 1     | SIMPLE    | news  | ref   | state     | state     | 4     | const     | 17282     | Using where; Using temporary; Using filesort</p>\n\n<p>| 1     | SIMPLE    | comments  | ref   | module_id     | module_id     | 101   | saidasea_v2.news.id,const,const   | 4     </p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13237830,"title":"SQL Server 2008 query to fill the null values","body":"<p>I need a query on below table</p>\n\n<p>TABLE     </p>\n\n<pre><code>ClienName   Bal0    Bal1    Bal2        Bal3        Bal4        Bal5        Bal6    \n--------------------------------------------------------------------------------\nA           600     600     NULL        NULL        NULL        NULL        NULL    \nB           Null    100     NULL        NULL        NULL        NULL        NULL    \nC           NULL    NULL    200          NULL       NULL        NULL        NULL        \nD           NULL    NULL    NULL        NULL        NULL        130         130     \nE           510     510     NULL        510         510         NULL        NULL    \nF           170     170     NULL        170         170         NULL        170 \nG           210     210     NULL        210         210         210         210     \nH           20      20      NULL        20          NULL        NULL        NULL    \n</code></pre>\n\n<p><strong>Result:  I would like to see the above TABLE as below, which query can do it? please help</strong>  </p>\n\n<pre><code>ClienName   Bal0    Bal1    Bal2        Bal3        Bal4        Bal5        Bal6    \n--------------------------------------------------------------------------------\nA           600     600     600         600         600         600         600     \nB           100     100     100         100         100         100         100     \nC           200     200     200         200         200         200         200     \nD           130     130     130         130         130         130         130         \nE           510     510     510         510         510         510         510     \nF           170     170     170         170         170         170         170 \nG           210     210     210         210         210         210         210     \nH           20      20      20          20          20          20          20\n</code></pre>\n"},{"tags":["mysql","query","optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13236212,"title":"MySQL soccer league query optimization (player stats)","body":"<p>I'd like to optimize this query 'cause it really seems a mess to me... </p>\n\n<pre><code>SELECT\n    L.id,\n    L.role,\n    L.first_name,\n    L.last_name,\n    L.birth_date,\n    L.team_name,\n    L.team AS team_id,\n    L.photo,\n    L.email,\n    L.played,\n    L.vote_average,\n    L.goal_sum AS goal,\n    L.score + IFNULL(L.c_mvp, 0)*10 AS score,\n    L.y_card_sum AS y_card,\n    L.r_card_sum AS r_card,\n    IFNULL(L.c_mvp, 0) AS mvp,\n    IFNULL(unbeaten, 0) AS unbeaten\nFROM (\n    SELECT * FROM (\n        SELECT\n            dc_player. *,\n            dc_team.name AS team_name,\n            COUNT( dc_match_entry.player_id ) AS played,\n            AVG( dc_match_entry.vote ) AS vote_average,\n            SUM( dc_match_entry.goal ) AS goal_sum,\n            SUM( dc_match_entry.vote ) *10 + SUM( dc_match_entry.goal ) *10 - SUM( dc_match_entry.r_card ) *10 - SUM( dc_match_entry.y_card ) *5 - SUM( dc_match_entry.own_goal ) *10 AS score,\n            SUM( dc_match_entry.y_card ) AS y_card_sum,\n            SUM( dc_match_entry.r_card ) AS r_card_sum\n        FROM\n            dc_player,\n            dc_match_entry,\n            dc_team\n        WHERE \n            dc_player.id = dc_match_entry.player_id AND\n            dc_player.team = dc_team.id\n        GROUP BY\n            dc_player.id\n    ) LOL\n    LEFT JOIN (\n        SELECT\n            COUNT(dc_match.mvp) c_mvp,\n            mvp AS player_id\n        FROM dc_match\n        WHERE\n            dc_match.mvp IS NOT NULL\n        GROUP BY dc_match.mvp\n    ) ROFL\n    ON ROFL.player_id = LOL.id\n    ORDER BY \n        LOL.score DESC\n) L\nLEFT OUTER JOIN(\n    SELECT\n        dc_player.id,\n        COUNT(dc_match.id) AS unbeaten\n    FROM\n        dc_match,\n        dc_match_entry,\n        dc_player\n    WHERE\n        (\n            (dc_player.team=dc_match.host AND\n            dc_match.guest_score=0\n            ) OR\n            (\n                dc_player.team=dc_match.guest AND\n                dc_match.host_score=0\n            )\n        ) AND\n        dc_player.id = dc_match_entry.player_id AND dc_match.id = dc_match_entry.match_day\n    GROUP BY\n        dc_player.id\n) I\nON\n    L.id = I.id\nGROUP BY\n    id\n</code></pre>\n\n<p>I read about some subqueries mysql issues and afaik this query seems to be a little \"heavy\". Can anybody help me with it? Thanks a lot.</p>\n"},{"tags":["sql-server","query","tsql","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13235720,"title":"SQL Server append query","body":"<p>I have the following (not working) query:  </p>\n\n<pre><code>insert into [MyDB].[dbo].[Reports_StepsStat]  \n    (ActivityID,TaskID,StepIndex,StepStatus,TimeSpanInSeconds,Score)\nVALUES (\n  SELECT\n    tasks.ActivityID as ActivityID,\n    tasks.ID as TaskID,\n    [StepIndex]=item.value('(StepIndex)[1]', 'NVARCHAR(MAX)'),\n    [StepStatus]=item.value('(Status)[1]', 'NVARCHAR(MAX)'),\n    [TimeSpanInSeconds] = DATEDIFF(MINUTE, item.value('(StartedOn)[1]',    'datetime'),item.value('(FinishedOn)[1]', 'datetime')),\n    tasks.Score as Score\n  FROM \n    [MyDB].[dbo].[Tasks] as tasks \n  CROSS APPLY \n    [Progress].nodes ('//Progress/Steps/ProgressStep') Progress(item)\n)  \n</code></pre>\n\n<p>The inner select query (<code>SELECT task.ActivityID..</code>) works perfectly and produces the expected table.  </p>\n\n<p>The outer <code>insert into</code> part is supposed to append the result of the inner part to a table by the name of <code>Reports_StepsStat</code>. This does not work.  </p>\n\n<p>I have tried and succeeded doing that with <code>SELECT INTO</code>, but apparently <code>SELECT INTO</code> can only be used to create a new table, and not to append to an existing table, which is what I need.  </p>\n\n<p>The errors I get are:  </p>\n\n<blockquote>\n  <p><em>Msg 156, Level 15, State 1, Line 6</em><br>\n  <em>Incorrect syntax near the keyword 'SELECT'.</em><br>\n  <em>Msg 102, Level 15, State 1, Line 14</em><br>\n  <em>Incorrect syntax near ')'.</em></p>\n</blockquote>\n"},{"tags":["sql","query","count"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13235981,"title":"Count number of occurrences for each unique value","body":"<p>Basically I have a table similar to this:</p>\n\n<pre><code>time.....activities.....length  \n13:00........3.............1  \n13:15........2.............2  \n13:00........3.............2  \n13:30........1.............1  \n13:45........2.............3  \n13:15........5.............1  \n13:45........1.............3  \n13:15........3.............1  \n13:45........3.............2  \n13:45........1.............1  \n13:15........3.............3  \n</code></pre>\n\n<p>A couple of notes:</p>\n\n<ul>\n<li>Activities can be between 1 and 5</li>\n<li>Length can be between 1 and 3</li>\n</ul>\n\n<p>The query should return:</p>\n\n<pre><code>time........count  \n13:00.........2  \n13:15.........2  \n13:30.........0  \n13:45.........1  \n</code></pre>\n\n<p>Basically for each unique time I want a count of the number of rows where the activities value is 3.</p>\n\n<p>So then I can say: </p>\n\n<pre><code>At 13:00 there were X amount of activity 3s.\nAt 13:45 there were Y amount of activity 3s.\n</code></pre>\n\n<p>Then I want a count for activity 1s,2s,4s and 5s. so I can plot the distribution for each unique time.</p>\n"},{"tags":["sql","database","sql-server-2008","query","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13235606,"title":"SQL query :Copy one table to another from different servers","body":"<p>What's wrong with my query, I want to copy three columns to another server\\table if one of the column (ID_DIRCT) is not null :</p>\n\n<pre><code>INSERT INTO  System\\Syst3.Server1.dbo.TABLE_RESRC (NO_EMPLY,PR,NM_FAML,CO_DIRCT)\nSELECT NO_EMPLY, PR_EMPLY, NM_EMPLY, ID_DIRCT \nFROM System\\Syst3.Server2.dbo.RESRC\nWHERE System\\Syst3.Server2.dbo.RESRC.ID_DIRCT IS NOT NULL\n</code></pre>\n\n<p>Using SQL Server 2008 R2.</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","indexing"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13235094,"title":"Indexing mysql query","body":"<p>I have this query in mysql and I wanted to be indexed, what is the best index composition?</p>\n\n<pre><code>SELECT cometchat.id, cometchat.from, cometchat.to, cometchat.message, cometchat.sent, cometchat.read, cometchat.direction\nFROM cometchat\nWHERE (\n(\ncometchat.to =  '30411'\nAND cometchat.direction &lt;&gt;2\n)\nOR (\ncometchat.from =  '30411'\nAND cometchat.direction &lt;&gt;1\n)\n)\n</code></pre>\n\n<p>I've tried these indexes but they didn't work:</p>\n\n<pre><code>ALTER TABLE  `cometchat` ADD INDEX (  `from`,`to`,`direction`)\nALTER TABLE  `cometchat` ADD INDEX (  `from`,`to`)\nALTER TABLE  `cometchat` ADD INDEX (  `to`,`direction`)\nALTER TABLE  `cometchat` ADD INDEX (  `from`,`direction`)\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198395,"title":"Select with SQL the oldest payment associated to a list of persons","body":"<p>Having troubles with a SQL query on an Oracle database (11G I think).</p>\n\n<p>I need to make a query on two tables. The first one contains identifiers of persons. The second one contains payments (you can consider it as salaries), each record associated to the person with a foreign key.</p>\n\n<p>What I need to do is retrieve, for a known list of persons (let's say identifiers 1, 2, 5 and 10), the oldest payment (based on the payment date).</p>\n\n<p>What I made first is this : </p>\n\n<pre><code>select id_person, MIN(payment_date) \nfrom payment where id_person in (1, 2, 5, 10)\ngroup by id_person;\n</code></pre>\n\n<p>This retrieves something like :</p>\n\n<pre><code>1   19940623\n2   20100429\n5   20100204\n10  20100111\n</code></pre>\n\n<p>Now, how do I get, for each person, the complete record of the ´payment´ table which correspond to the oldest payment ?</p>\n\n<p>I cannot figure out a way of doing this...</p>\n\n<p>The answer must be in a single SQL query (I cannot make a call for each person, which would be very easy to do...)</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13233649,"title":"MySQL: Impossible WHERE noticed after reading const table","body":"<p>A very simple query always returns an empty result set, after running EXPLAIN, this is what I got:</p>\n\n<pre><code>EXPLAIN SELECT u.id, fname\nFROM user u\nWHERE (birthdate\nBETWEEN \"1992-04-05\"\nAND \"1990-04-05\")\nLIMIT 0,20\n</code></pre>\n\n<p>No matter, if I turn birthdays arround (1990-1992), it's the same... </p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  NULL    NULL    NULL    NULL    NULL    NULL    NULL    Impossible WHERE noticed after reading const table...\n</code></pre>\n\n<p>What does this error say? I only found other issues on SO where people tried to join tables, but this query is so simple, what is the matter with it? Any ideas would be highly appreciated, thank you already!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13233325,"title":"Get the ID for range with smallest difference","body":"<p>Lets say that I have a table A. This table has ID, X_value, Y_value. Here is content of table A:</p>\n\n<p>Table A</p>\n\n<pre><code>ID X_value Y_value\n1  100     150\n2  110     170\n3  120     190\n</code></pre>\n\n<p>Now, if I'm comparing number <strong>130</strong> with range numbers(X_value - Y_value) I would like to get ID of range with smallest(minimal) difference! If I can name it that way? Right away we see that number <strong>130</strong> will fall into all this ranges, but I need ID of range with smallest(minimal) difference between <strong>130</strong> and numbers of range. To elaborate that difference:</p>\n\n<pre><code>For range 1: 130-100=30 and 150-130=20\nFor range 2: 130-110=20 and 170-130=40\nFor range 3: 130-120=10 and 190-130=60\n</code></pre>\n\n<p>From this elaboration we see that minimal difference is at third range(that is <strong>10</strong>) so I would like to get ID <strong>3</strong>. What will be a query for this example if I have this table within MySQL db?! </p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13232681,"title":"Assistance with a regular expression mysql query","body":"<p>I have a database column with data that looks like  <strong>file_name|||file_id|||field_id</strong>  I would like to run a query to replace the data with just the <strong>file_id</strong>.</p>\n\n<p>So, my query, in essence needs to parse out the file_id between the pipes, and then update the field to replace the full string with just the file id.</p>\n"},{"tags":["query","activerecord","join","yii"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1154,"score":1,"question_id":8604350,"title":"Unknown column - multiple joins in CDbCriteria","body":"<p>I'm trying to get data from multiple tables and I've ended with this error:\nSQL: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'p.firstname' in 'field list'</p>\n\n<pre><code>    $criteria = new CDbCriteria;\n    $criteria-&gt;select = 'ohu_id, hash, p.firstname, p.surname, p.city, u.email AS Email';\n    $criteria-&gt;join = 'LEFT JOIN `profiles` p ON  p.user_id = user_id';\n    $criteria-&gt;join = 'LEFT JOIN users u ON user_id = u.id';\n    $criteria-&gt;condition = 'offer_id = :oID';\n    $criteria-&gt;params = array(':oID' =&gt; $_GET['id']);\n\n    $model = MyModel::model()-&gt;findAll($criteria);\n</code></pre>\n\n<p>Anyone know what I'm doing wrong?\nOr is there better way to get related data?</p>\n"},{"tags":["query","api","geolocation","wikipedia","geotagging"],"answer_count":6,"favorite_count":8,"up_vote_count":11,"down_vote_count":0,"view_count":1416,"score":11,"question_id":1400717,"title":"Reverse wikipedia geotagging lookup","body":"<p>Wikipedia is <a href=\"http://en.wikipedia.org/wiki/Geotagging\" rel=\"nofollow\">geotagging</a> a <a href=\"http://en.wikipedia.org/wiki/Aalborg\" rel=\"nofollow\">lot</a> <a href=\"http://en.wikipedia.org/wiki/British%5FIsles\" rel=\"nofollow\">of</a> <a href=\"http://en.wikipedia.org/wiki/Kent%27s%5FCavern\" rel=\"nofollow\">its</a> <a href=\"http://en.wikipedia.org/wiki/Aalborghus%5FCastle\" rel=\"nofollow\">articles</a>. (Look in the top right corner of the page.)</p>\n\n<p>Is there any API for querying all <a href=\"http://en.wikipedia.org/wiki/Wikipedia%3AWikiProject%5FGeographical%5Fcoordinates\" rel=\"nofollow\">geotagged pages</a> within a specified radius of a geographical position?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Okay, so based on lost-theory's answer I tried this (on <a href=\"http://dbpedia.org/snorql/\" rel=\"nofollow\">dbpedia query explorer</a>):</p>\n\n<pre><code>PREFIX geo: &lt;http://www.w3.org/2003/01/geo/wgs84_pos#&gt;\nSELECT ?subject ?label ?lat ?long WHERE {\n    ?subject geo:lat ?lat.\n    ?subject geo:long ?long.\n    ?subject rdfs:label ?label.\n    FILTER(xsd:float(?lat) - 57.03185 &lt;= 0.05 &amp;&amp; 57.03185 - xsd:float(?lat) &lt;= 0.05\n        &amp;&amp; xsd:float(?long) - 9.94513 &lt;= 0.05 &amp;&amp; 9.94513 - xsd:float(?long) &lt;= 0.05\n        &amp;&amp; lang(?label) = \"en\"\n    ).\n} LIMIT 20\n</code></pre>\n\n<p>This is very close to what I want, except it returns results within a (<a href=\"http://en.wikipedia.org/wiki/Local%5Fproperty\" rel=\"nofollow\">local</a>) square around the point and not a circle. Also I would like if the results where sorted based on the distance from the point. (If possible.)</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>I am trying to determine the euclidean distance as an approximation of the true distance, But I am having trouble on squaring a number in sparql. (<a href=\"http://stackoverflow.com/questions/1401401/power-in-sparql-and-other-math-functions\">Question opened here</a>.) When I get something useful I will update the question, but in the meantime I will appreciate any suggestions on alternative approaches.</p>\n\n<p><strong>Update 3</strong></p>\n\n<p>A final update. I gave up on using sparql trough dbpedia. I have written a simple parser which fetches the wikipedia article text nightly database dump and parses all articles for geocodes. It works rather nicely and it allows me to store information about geotagged articles however I wish.</p>\n\n<p>This is probably the solution I will continue using, and if I get around to create a nice interface to it I might consider allowing public API access and/or publishing the source to the parser.</p>\n\n<p>Thanks for all the suggestions, comments and help!</p>\n"},{"tags":["mysql","monitoring","query"],"answer_count":5,"favorite_count":33,"up_vote_count":43,"down_vote_count":0,"view_count":30384,"score":43,"question_id":568564,"title":"How can I view live MySQL queries?","body":"<p>I am just wondering if its possible to trace MySQL queries on my linux server as they happen?</p>\n\n<p>For example I'd love to set up some sort of listener, then request a web page and view all of the queries the engine executed, or just view all of the queries being run on a production server.</p>\n\n<p>Are there tools to do this?</p>\n"},{"tags":["eclipse","query","servlets","sparql","jena"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13225623,"title":"eclipse jena and tomcat query","body":"<pre><code>import java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport com.hp.hpl.jena.ontology.OntModel;\nimport com.hp.hpl.jena.rdf.model.*;\nimport com.hp.hpl.jena.rdf.model.ModelFactory;\nimport com.hp.hpl.jena.util.FileManager;\nimport com.hp.hpl.jena.sparql.*;\nimport java.io.InputStream;\nimport com.hp.hpl.jena.query.*;\nimport com.hp.hpl.jena.util.FileManager;\nimport com.hp.hpl.jena.ontology.*;\n\n/**\n * Servlet implementation class rdf\n */\npublic class rdf extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public rdf() {\n        super();\n        // TODO Auto-generated constructor stub\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n        String inputFileName = \"/home/jarboox/Documentos/Eclipse/workspace/Sparql/src/tres.rdf\";\n\n        try {\n\n              //create the reasoning model using the base\n              OntModel inf = ModelFactory.createOntologyModel();\n\n              // use the FileManager to find the input file\n              InputStream in = FileManager.get().open(inputFileName);\n              if (in == null) {\n                throw new IllegalArgumentException(\"File: \" + inputFileName + \" not found\");\n              }\n\n              inf.read(in, \"\");\n\n        } catch (Exception e) {\n            System.out.println(e.getMessage());    \n          } \n    }\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Tomcat problem: </p>\n  \n  <p>type Informe de Excepción</p>\n  \n  <p>mensaje La ejecución del Servlet lanzó una excepción</p>\n  \n  <p>descripción El servidor encontró un error interno que hizo que no\n  pudiera rellenar este requerimiento.</p>\n  \n  <p>excepción</p>\n  \n  <p>javax.servlet.ServletException: La ejecución del Servlet lanzó una\n  excepción causa raíz</p>\n  \n  <p>java.lang.NoClassDefFoundError: com/hp/hpl/jena/rdf/model/ModelFactory\n    rdf.doPost(rdf.java:55)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) causa\n  raíz</p>\n  \n  <p>java.lang.ClassNotFoundException:\n  com.hp.hpl.jena.rdf.model.ModelFactory\n    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)\n    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)\n    rdf.doPost(rdf.java:55)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) nota La\n  traza completa de la causa de este error se encuentra en los archivos\n  de diario de Apache Tomcat/6.0.36.</p>\n</blockquote>\n"},{"tags":["query","dns","resolver","dnspython"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13231344,"title":"dnsPython - answer from dns.resolver.query","body":"<p>I need some help with getting nameserver (NS) records from specific domains.\nSo far i had no problem with my script but now I realised that it has\nproblem getting answer from domains like this: fpv.ukf.sk\nWith simple domain like google.com, ukf.sk etc. I have no problem. </p>\n\n<p>used code:\nanswers = dns.resolver.query('fpv.ukf.sk', 'NS')</p>\n\n<p>I get this error:\n    answers = dns.resolver.query('fpv.ukf.sk', 'NS')\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 920, in query\n    raise_on_no_answer, source_port)\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 858, in query\n    raise_on_no_answer)\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 133, in <strong>init</strong>\n    raise NoAnswer\nNoAnswer</p>\n\n<p>any suggestions why I cant get answer when I send query for fpv.ukf.sk domain?</p>\n"},{"tags":["mysql","query","select","double","rename"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13230685,"title":"Fetching a result twice with deferend name","body":"<p><br/>I have 1 table with tasks named opentask:<br/>columns: id,title,description,expires,creator_id,creator_name, executer_id, executer_name, priority_id, status_id<br/>1 table with users named user:<br/>\nwith columns: user_id, username<br/>\nWhat I want is to create a query where there will be all columns from opentask table where the executer_id will be equal to the user_id of user table AND the creator_id will be equal to the user_id again. This creates a confusion because the first equality excludes the second.<br/><br/>So I need somehow to create a query where I will include the usernames for the executer with something like where \"opentask.executer_id=user_user_id\" and at the same time I will include the username again (as a differend name?) for the creator with something like \"where opentask.executer_id=user_user_id\"<br/><br/>So I try this, which of course I know that is missing something, can you help?</p>\n\n<blockquote>\n  <p>SELECT DISTINCT id, title, description, expires, creator_id, executer_id, oc_opentask.priority_id, oc_opentask.status_id, priority_name, status_name, user_id, username, (SELECT username FROM oc_opentask, oc_user WHERE oc_opentask.creator_id=oc_user.user_id) AS username2 FROM oc_opentask, oc_opentask_priority, oc_user, oc_opentask_status WHERE oc_opentask.priority_id=oc_opentask_priority.priority_id AND oc_opentask.executer_id=oc_user.user_id AND oc_opentask.status_id=oc_opentask_status.status_id ORDER BY oc_opentask.expires DESC</p>\n</blockquote>\n"},{"tags":["query","powershell","psobject"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13228769,"title":"Powershell Find specific row (querying) psobject","body":"<p>I'm new to Powershell. And I'm struggling with the most simplest of tasks.</p>\n\n<p>OK.  This is a really stupid question, but I have created a PSObject ... added members (4 columns, ID, Name, Status, TagFile; a number of rows) ... I have a loop ... for each i (iteration) ... I want it to use the values for the row in my object where ID = i.</p>\n\n<p>It's really not hard.  I have googled and haven't come up with an answer which is clear enough or concise enough to help me.</p>\n"},{"tags":["sql","query","typo3","raw","extbase"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13084863,"title":"Extbase - get created sql from query","body":"<p>i want to get some database tables from my typo3 extensions.\nThe Extension is based on extbase.</p>\n\n<p>The query always returns nothing but the data exists</p>\n\n<p>I've tried this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n$query-&gt;statement('SELECT * FROM `my_table`\n    WHERE field = ? ORDER BY date DESC LIMIT 1',\n    array($condition));\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n\n$query-&gt;matching($query-&gt;equals('field', $condition));\n$query-&gt;setOrderings(array('date' =&gt; Tx_Extbase_Persistence_QueryInterface::ORDER_DESCENDING));\n$query-&gt;setLimit(1);\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>both returns <em>null</em> as result.</p>\n\n<p>Is it possible to get the sql that the class creates to look where the bug is?</p>\n\n<p>I've looked in some extbase persistent classes but didn't find a clue</p>\n\n<p>EDIT: \nFor those who are interested.. i found a \"solution\".</p>\n\n<p>If you create the query with the statement() method, you can print the query with this function</p>\n\n<pre><code>echo $query-&gt;getStatement()-&gt;getStatement();\n</code></pre>\n\n<p>It doesn't replace the placeholder.\nBut you can get the Variables with this method</p>\n\n<pre><code>var_dump($query-&gt;getStatement()-&gt;getBoundVariables());\n</code></pre>\n\n<p>Thats the best Solution that i found, without editing the extbase extenstions</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":10430335,"title":"sql query to find absent tables from database","body":"<p>I am using ORACLE database. \n<strong>EDIT</strong>:</p>\n\n<p>I want only tables not present in a list, not all those tables in database.</p>\n\n<p>Ex: In my database following tables are present:</p>\n\n<pre><code>a\nb\nc\nd\ne\nr\ns\n</code></pre>\n\n<p>I am being given a list of tables:</p>\n\n<pre><code>a\nb\nc\nv\nh\n</code></pre>\n\n<p>out of which i want to find out which tables are <strong>absent(not present)</strong> in my database.</p>\n\n<p>so: a, b, c are those tables which are present in my database. So excluding these tables my answer will be:</p>\n\n<pre><code>v and h \n</code></pre>\n\n<p><strong>My answer is not d,e,r,s</strong></p>\n\n<p>How can i write a query for this to find out?</p>\n"},{"tags":["query","select","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13228535,"title":"SELECT old data state with DB2","body":"<p>Is it possible to access old data state in an DB2 database?</p>\n\n<p>Oracle has the clause <pre>select ... as of timestamp</pre> to do it. Does DB2 have something like it?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13226450,"title":"Get latest updated records","body":"<p>I have an \"Observation\" table in SQL Server 2008. This table has a locationId column for a bunch of geographic locations, a few columns for observation details and a column for latest updated date.</p>\n\n<p>Every week, a new observation record for each location is appended. So a location has many occurrences in the table.</p>\n\n<p>What I want to achieve is to be able to get the most recent observation record for each location.</p>\n\n<p>Can anyone help with any idea?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Cheers,\nAlex</p>\n"},{"tags":["query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13227878,"title":"postgres coalesce fields, sum and group by","body":"<p>maybe someone can help me out with a postgres query.</p>\n\n<p>the table structure looks like this</p>\n\n<pre><code>  nummer   nachname   vorname   cash\n +-------+----------+----------+------+\n   2       Bert       Brecht    0,758\n   2       Harry      Belafonte 1,568\n   3       Elvis      Presley   0,357\n   4       Mark       Twain     1,555\n   4       Ella       Fitz      0,333\n   …\n</code></pre>\n\n<p>How can I coalesce the fields where \"nummer\" are the same and sum the cash values?\nMy output should look like this:</p>\n\n<pre><code>   2       Bert, Brecht      2,326\n           Harry, Belafonte \n   3       Elvis, Presley    0,357\n   4       Mark, Twain       1,888\n           Ella, Fitz   \n</code></pre>\n\n<p>I think the part to coalesce should work something like this:</p>\n\n<pre><code> array_to_string(array_agg(nachname|| ', ' ||coalesce(vorname, '')), '&lt;br /&gt;') as name,   \n</code></pre>\n\n<p>Thanks for any help,</p>\n\n<p>tony</p>\n"},{"tags":["mysql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13187858,"title":"mysql query to find out non existing users","body":"<p>I am playing with 2 database tables. One is <strong>user</strong> table which contains user details like full name and active(whether the user is active or not) columns. The other one is <strong>tasks</strong> table which contains the task details of each user. So tasks table has columns called UserID and StartTime. The following query will display all user details who entered the tasks yesterday. </p>\n\n<pre><code>$today = mktime(0,0,0);\n$yesterday = $today - 86400;\n$res = $db-&gt;fetchAll(\"SELECT DISTINCT tasks.UserID,user.full_name FROM `tasks` JOIN `user` ON tasks.UserID=user.id WHERE user.active=1 AND tasks.StartTime &gt; \".$db-&gt;quote($yesterday,'integer').\" AND tasks.StartTime &lt; \".$db-&gt;quote($today,'integer'));\n</code></pre>\n\n<p>I need to find out the user details who doesn't enter the tasks yesterday. How can I modify the above query?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13227436,"title":"Excel data fetch query syntax","body":"<p>I have an .xlsx file with 15 columns from A to O. I can fetch the all data with a simple query;  OleDbCommand cmd = new OleDbCommand(\"SELECT *\" + \"FROM [Sheet1$]\", conn);</p>\n\n<p>Here is my problem ; I have missing datas all over the excel sheet and these are marked with '?' and spread randomly. I don't want to fetch the row even one attribute of the row is '?'. I tried ;</p>\n\n<pre><code>OleDbCommand cmd = new OleDbCommand(\"SELECT  [A],[B],[C],[D],[E],[F],[G],[H],[I],[J],[K],[L],[M],[N],[O]\" + \"FROM [Sheet1$]\" +  \n               \"Where A != ' ?' and B != ' ?' and C != ' ?' and D != ' ?' and E != ' ?' and F != ' ?' and G != ' ?' and H != ' ?' and I != ' ?' and J != ' ?' and K != ' ?' and L != ' ?' and M != ' ?' and N != ' ?' and O != ' ?'\", conn);\n</code></pre>\n\n<p>But I got the error : </p>\n\n<p>Syntax error (missing operator) in query expression.</p>\n\n<p>Can anyone help me with this ?</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","sql","perl","query","dbi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":13172755,"title":"Replace quotation marks in sql query in perl script","body":"<p>I have a text file of data that I am importing into a MySQL database. Some of the lines unfortunatley contain quotation marks, which causes my SQL queries to go haywire. I would like to get rid of any field that has quotation marks, or at very least ignore them in my query.</p>\n\n<p>I found something that might work, but being as this is run through a Perl script I am having issues \"escaping\" the quotation marks. I really don't know how and can't figure it out. I would like to just search through my table and delete any quotation marks (\") that it may find or replace it with a single quotation mark or space or anything really.</p>\n\n<pre><code>my $myreplacequery = \"REPLACE(s.Title, '\"','')\";\n$sth = $dbh-&gt;prepare($myreplacequery);\n$sth-&gt;execute;\n</code></pre>\n\n<p>Anyone have any ideas?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13226657,"title":"Insert text in each row of mysql field","body":"<p>I have a table with this structure :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | img.jpg\n2  | otherimg.png\n3  | img2.png \n4  | someimg.gif\n5  | otherelseimg.jpg\n6  | dummy.jpg\n7  | jusimg.jpg\n</code></pre>\n\n<p>How can I modified each row to become like this :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | folder/img.jpg\n2  | folder/otherimg.png\n3  | folder/img2.png \n4  | folder/someimg.gif\n5  | folder/otherelseimg.jpg\n6  | folder/dummy.jpg\n7  | folder/jusimg.jpg\n</code></pre>\n"},{"tags":["query","wordnet","expansion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13226629,"title":"WordNet, Query Expansion, Step by Step","body":"<p>I want to make a project about query expansion using wordnet,but it's hard to find step by step method to do it.</p>\n\n<p>i've found this article <a href=\"http://www.codeproject.com/Articles/11835/WordNet-based-semantic-similarity-measurement\" rel=\"nofollow\">http://www.codeproject.com/Articles/11835/WordNet-based-semantic-similarity-measurement</a> </p>\n\n<p>it is the step by step based on the articel</p>\n\n<p>input sentence to the program and then do this:</p>\n\n<p>1.Tokenization\n2. Tagging part of speech\n3. Stemming word\n4. Word sense disambiguation\n5. Semantic similiraity between two synset (it still confusing)</p>\n\n<p>and then we can conclude that word with larger score, is the query expansion from the input</p>\n\n<p>is there any source that i can learn about make query expansion using wordnet step by step?</p>\n\n<p>thank you</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13216427,"title":"mysql: row number for query results grouped by FK","body":"<p>I have a table that has the following columns:\nid | fk_id | rcv_date</p>\n\n<p>There may be multiple records with a common fk_id, which represents a foreign key id in a related table.</p>\n\n<p>I need to create a query that will assign a row number to each record, grouped by fk_id, sorted by rcv_date.</p>\n\n<p>I originally began with the following query, which works quite well for sorting and assigning row numbers:</p>\n\n<pre><code>SELECT @row:=@row +1 AS ordinality, c.fk_id, rcv_date\nFROM (SELECT @row:=0) r, mytable c\nORDER BY rcv_date\n</code></pre>\n\n<p>However -- the row count and sorting is done across the entire dataset. I need the counting to be within a common fk_id. For example, the following sample data would return (the first column represents the row count/ordinality):</p>\n\n<pre><code>1 | 5 | 2011-10-01\n2 | 5 | 2011-10-14\n3 | 5 | 2011-11-02\n4 | 5 | 2011-12-17\n1 | 8 | 2011-09-03\n2 | 8 | 2011-11-12\n1 | 9 | 2011-10-08\n2 | 9 | 2011-10-10\n3 | 9 | 2011-11-19\n</code></pre>\n\n<p>The middle column represents the fk_id. As you can see, the sorting and row count is within the fk_id \"grouping.\"</p>\n\n<p><strong>UPDATE</strong>\nI have a query that seems to be working, but would like some input as to whether it can be improved:</p>\n\n<pre><code>SELECT IF(@last = c.fk_id, @row:=@row +1, @row:=1) AS ordinality, @last:=c.fk_id, c.fk_id, rcv_date\nFROM (SELECT @row:=0) r, (SELECT @last:=0) l, mytable c\nORDER BY c.fk_id, rcv_date\n</code></pre>\n\n<p>So what this does is order by fk_id and then rcv_date -- which essentially handles my grouping. Then I use a second variable to compare the fk_id in the previous record with the current record: if it's the same, we increment the row; if different, we reset to 1.</p>\n\n<p>My tests with real data appear to be working. I suspect it's a pretty inefficient query though -- so if anyone has ideas for improving it, or see possible flaws, I would love to hear.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":53,"score":5,"question_id":13225620,"title":"Parse in MySQL using comma as delimiter","body":"<p>I have two tables</p>\n\n<p>Table1 with list of users comma separated</p>\n\n<pre><code>Name    UserID\nabc     A,B,C,D\ndef     A,B,C\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>Name   UserID\nabc    A\nabc    B\nabc    C\ndef    A\ndef    B\n</code></pre>\n\n<p>I need to find the users that are in table1 for each Name but not in table2 (There won't ever be an instance when a UserID to Name pair is present in table2 but not in table1 as CSV). </p>\n\n<p>The output should be</p>\n\n<pre><code>Name    UserID\nabc     D\ndef     C\n</code></pre>\n\n<p><em>I can do this with PHP but <strong>is there a way this can be done through a query?</em></strong> I am not sure where to begin in case I'm doing this as a query.  Can I parse in MySQL using comma as delimiter?</p>\n"},{"tags":["mysql","sql","query","constraints"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":765,"score":0,"question_id":5156281,"title":"Mysql adding a constraint: force a field to get specific values","body":"<p>I have a simple mysql table with the following attributes: <code>Name, Surname, Role</code>.</p>\n\n<p>I want the Role field to get only 2 possible values: <code>Supervisor</code> or <code>Operator</code> and to result in error when a query tries to insert something different from that 2 values.</p>\n\n<p>For example, i want the following query to return an error:</p>\n\n<pre><code>INSERT INTO tablename (name,surname,role) VALUES ('max','power','footballplayer');\n</code></pre>\n\n<p>I tried setting the field <code>Role</code> as a <code>ENUM</code> or <code>SET</code> type but it will just leave the field empty instead of firing and error :(</p>\n"},{"tags":["query","dojo","innerhtml","nodelist"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12713306,"title":"getting value of dojo NodeList inner elements","body":"<p>I am building a configuration dialog using dojo that I later need to interrogate for user input. There are multiple rows in the dialog each with the same format and tags. Here is the html that I use to build each row.  </p>\n\n<pre><code>html = '&lt;div class=\"cfgtxtrow\"&gt; &lt;label&gt;Label:&lt;/label&gt;\n&lt;input id=\"mac\" type=\"hidden\" name=\"mac\" value=\"'+mac+'\"/&gt;\n&lt;input id=\"label\" type=\"text\" maxlength=\"6\" name=\"label\" value=\"'+labl+'\"/&gt;\n&lt;/div&gt;';\n</code></pre>\n\n<p>That part all works and I can see the data in Firebug on return.</p>\n\n<p>I need to parse the values out and ultimately send them to the server using xhr. So I thought that I could use dojo query to get the nodelist and walk each node to get to the input values and build an associative array of them to send. I figured this to be much like validating the values programmatically.</p>\n\n<p>I can see the innerhtml on each node (using dojo.query(\".cfgtxtrow\").forEach( function(node)) but cannot figure out how to programmatically (using dojo) get to the values on each node. I thought that I would be able to use dojo.byId or query on the Nodelist to get to its inner elements but I just get errors back. </p>\n\n<p>I am beginning to suspect that my concepts are all wrong, as I thought this would be simple.</p>\n\n<p>Here is what I ended up with..</p>\n\n<pre><code>dojo.query(\".cfgtxtrow input\").forEach( function(node)\n{\n    id = dojo.attr(node, \"id\" );\n    console.debug( node );\n\n    if( id == \"mac\" ) mac = dojo.attr( node, \"value\" ); // since mac comes first this is safe..\n    if( id == \"label\" )\n    {\n        labl = dojo.attr( node, \"value\" );\n        console.debug( mac );\n        console.debug( labl );\n        macLabels[mac] = labl;\n    }\n});\nconsole.debug(macLabels[mac]);\n// send the data via the xhrPut call..\n</code></pre>\n\n<p>I thought it should be simple and the dojo.attr call seems to do the job..</p>\n\n<p>Is there a better way to do the same thing ?</p>\n"},{"tags":["sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":10897473,"title":"Complex SQL Server Database Query","body":"<p>Previously I had only one table (I have more, ofc, but these are the ones I'm struggling with), which was the <code>UNIVERSITY</code> table.</p>\n\n<p>I now want to create two more tables : <code>STATE</code> and <code>CITY</code>.</p>\n\n<h3>Table Attributes</h3>\n\n<pre><code>UNIVERSITY: ID, NAME, SHORTNAME, FK_STATE, FK_CITY\n\nSTATE: ID, NAME, SHORTNAME\n\nCITY : ID, NAME\n</code></pre>\n\n<h3>Problem</h3>\n\n<p>I am parsing a excel sheet for the universities (including the city and state in which this university resides). Once I have all this information in memory, the hardest part comes.</p>\n\n<p>How do I:</p>\n\n<blockquote>\n  <p>Insert all Universities in the database,including its state and city, but querying the STATE and CITY databases for their IDs, to set the FK's of the university correctly.</p>\n</blockquote>\n\n<p>Example:<br>\nOnce I add a University named 'PUC-RIO', it is presented in 'RIO DE JANEIRO', (city) 'RIO DE JANEIRO' (state aswell). Adding the university itself is not a problem, but, how can I update its foreign key to the 'RIO DE JANEIRO' Key on state and city tables?</p>\n"},{"tags":["mysql","query","table","search","optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13221136,"title":"How can I optimize the searching of two tables?","body":"<p>Let's say I'm some kind of newbie in MySQL. I have two tables:</p>\n\n<p>1st:</p>\n\n<pre>    CREATE TABLE IF NOT EXISTS `tags` (\n  `i` int(10) NOT NULL AUTO_INCREMENT,\n  `id` int(10) NOT NULL,\n  `k` varchar(32) COLLATE utf8_bin NOT NULL,\n  PRIMARY KEY (`i`),\n  KEY `k` (`k`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_bin AUTO_INCREMENT=1505426 ;\n</pre>\n\n<p>and 2nd:</p>\n\n<pre>CREATE TABLE IF NOT EXISTS `w` (\n  `id` int(7) NOT NULL,\n  `title` varchar(255) COLLATE utf8_bin NOT NULL,\n  `k1` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k2` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k3` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k4` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k5` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k6` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k7` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k8` varchar(24) COLLATE utf8_bin NOT NULL,\n  `w` int(5) NOT NULL,\n  `h` int(5) NOT NULL,\n  `s` varchar(32) COLLATE utf8_bin NOT NULL,\n  `r` varchar(11) COLLATE utf8_bin NOT NULL,\n  `v` int(7) NOT NULL,\n  `c` varchar(32) COLLATE utf8_bin NOT NULL,\n  `c1` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c2` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c3` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c4` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c5` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c6` varchar(6) COLLATE utf8_bin NOT NULL,\n  `m` varchar(4) COLLATE utf8_bin NOT NULL,\n  `t` int(10) NOT NULL,\n  `i` int(6) NOT NULL,\n  `o` int(6) NOT NULL,\n  `f` varchar(255) COLLATE utf8_bin NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `keywords` (`k1`,`k2`,`k3`,`k4`,`k5`,`k6`,`k7`,`k8`),\n  KEY `category` (`c`),\n  KEY `color1` (`c1`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin ROW_FORMAT=DYNAMIC;</pre>\n\n<p>I'm trying to search 2 words ($search1 + $search2) from table 'tags' and find id's at 'w' table.\n query:</p>\n\n<pre>SELECT w.id,w.title,w.k1,w.k2,w.k3,w.k4,w.k5,w.k6,w.k7,w.w,w.h,w.s,w.c1,w.c2,w.c3,w.c4,w.c5,w.c6,w.m,w.f\nFROM tags,tags as tags2,w\nWHERE tags.k ='$search1' AND tags2.k = '$search2'\nand tags.id = tags2.id and tags2.id = w.id\nORDER BY `w`.`id`desc limit 24</pre>\n\n<p>The problem is that EXPLAIN function shows \"Using where; Using temporary; Using filesort\"\nAlso I believe that there is another way to optimize this my type search system.\nActually all data is in 'w' table, I just have no idea how exactly to search it properly.\nI would be grateful for any help.</p>\n\n<p><strong>Edit</strong>:a bit more information about this</p>\n\n<p>table 'tags' 1505425 records InnoDB = 65,9 MiB</p>\n\n<p>table 'w' 398900 rercords, InnoDB = 140,3 MiB</p>\n\n<p>after this (<strong>updated</strong>) query:</p>\n\n<pre>select `w`.`id` AS `id`,`w`.`title` AS `title`,`w`.`k1` AS `k1`,`w`.`k2` AS `k2`,`w`.`k3` AS `k3`,`w`.`k4` AS `k4`,`w`.`k5` AS `k5`,`w`.`k6` AS `k6`,`w`.`k7` AS `k7`,`w`.`k8` AS `k8`,`w`.`w` AS `w`,`w`.`h` AS `h`,`w`.`s` AS `s`,`w`.`c1` AS `c1`,`w`.`c2` AS `c2`,`w`.`c3` AS `c3`,`w`.`c4` AS `c4`,`w`.`c5` AS `c5`,`w`.`c6` AS `c6`,`w`.`m` AS `m`,`w`.`f` AS `f` from `tags` join `tags` `tags2` join `w` where ((`tags`.`k` = '$search1') and (`tags2`.`id` = `tags`.`id`) and (`w`.`id` = `tags`.`id`) and (`tags2`.`k` = '$search2')) order by `tags`.`i` desc limit 0,24;</pre>\n\n<p>mysql still shows:\n<pre>\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n| id | select_type | table      | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra                       |\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n|  1 | SIMPLE      | tags       | ref    | k,id          | k       | 98      | const       |  902 |   100.00 | Using where; Using filesort |\n|  1 | SIMPLE      | tags2      | ref    | k,id          | id      | 4       | db.tags.id  |    4 |   100.00 | Using where                 |\n|  1 | SIMPLE      | w          | eq_ref | PRIMARY       | PRIMARY | 4       | db.tags2.id |    1 |   100.00 | Using where                 |\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n3 rows in set, 1 warning (0.00 sec)</p>\n\n<p></pre> 1 warning, also still everything remains the same, is there any solution for better performance? at the moment it works fine, but later everything will goes slower and slower i think.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13223565,"title":"How can I split one record into two and set null values?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning TuesdayEvening and so on\n1   2012-01-01          2               3               2              2\n2   2012-01-02          2               2               2              2\n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning  TuesdayEvening\n1   2012-01-01          2               NULL          2                 2\n1   2012-01-01          NULL            3             NULL              NULL\n2   2012-01-02          2               2             2                 2\n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>I already have a query but, neem some changes. See the query on\n<a href=\"http://sqlfiddle.com/#!3/d41d8/5712\" rel=\"nofollow\">SQL Fiddle</a>.\nThe output you can see here is the case where it goes wrong. For TuesdayEvening and MondayEvening I am expecting 2.</p>\n\n<p>The information on SQL Fiddle is:</p>\n\n<pre><code>Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)\nInsert Into @t Select '2012-01-01',0,2,0,2\n\nSELECT id\n    ,date\n    ,MondayMorning\n    ,(CASE WHEN MondayEvening &lt;&gt; MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,TuesdayMorning\n    ,(CASE WHEN TuesdayEvening &lt;&gt; TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t \n\nUNION ALL \n\nSELECT id\n    ,date\n    ,NULL AS MondayMorning\n    ,(CASE WHEN MondayEvening = MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,NULL AS TuesdayMorning\n    ,(CASE WHEN TuesdayEvening = TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t\nWHERE --MondayMorning &lt;&gt; MondayEvening\n--OR TuesdayMorning &lt;&gt; TuesdayEvening\nMondayMorning &lt;&gt; MondayEvening\nAND (MondayMorning != 0 and MondayEvening != 0)\nOR TuesdayMorning &lt;&gt; TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\n</code></pre>\n"},{"tags":["wordpress","query","timestamp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13222161,"title":"Wordpress custom query comparing two timestamp meta data","body":"<p>I am trying to query posts by comparing meta value.\nI have set two meta with the posts. i.e. 'start_date' and 'end_date'.\nthey are stored as UNIX timestamp.</p>\n\n<p>Now I want to query posts on following conditions:</p>\n\n<ol>\n<li>timestamp of current momment is after(greater than) 'start_date'.</li>\n<li>timestamp of current momment is before(smaller than) 'end_date'.</li>\n</ol>\n\n<p>In this case, I want both conditions to fulfill. So, I have used 'relation'=>'AND'. </p>\n\n<p>So here is the print_r of the query:</p>\n\n<pre><code>Array\n(\n   [post_type] =&gt; ads\n   [meta_query] =&gt; Array\n       (\n           [relation] =&gt; AND\n           [0] =&gt; Array\n               (\n                   [kye] =&gt; start_date\n                   [compare] =&gt; &lt;=\n                   [value] =&gt; 1352054503\n                   [type] =&gt; NUMERIC\n               )\n\n           [1] =&gt; Array\n               (\n                   [kye] =&gt; end_date\n                   [compare] =&gt; &gt;=\n                   [value] =&gt; 1352054503\n                   [type] =&gt; NUMERIC\n               )\n\n       )\n\n)\n</code></pre>\n\n<p>Note: ads is a custom post type.</p>\n\n<p>And here is meta of a post:</p>\n\n<pre><code>Array\n(   \n   [start_date] =&gt; Array\n       (\n           [0] =&gt; 1352160000\n       )\n\n   [end_date] =&gt; Array\n       (\n           [0] =&gt; 1352246400\n       )\n\n)\n</code></pre>\n\n<p>I see absolutely no reason why this post should show up.\nThe start date timestamp(1352160000) is bigger than the current timestamp(1352054503). Which breaks condition #1.\nSo, why is this still showing up?\nWhat do you think?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13222950,"title":"Assistance writing a mysql query based on conditions","body":"<p>I'm attempting to write a MySQL statement based on an if statement.</p>\n\n<p>Here's what I want to do: I need the query to collect rows based on whether or not an item is going to be due within two weeks or if it's already passed due.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>select\n  t_id,\n  firstName, \n  lastName, \n  checkTime,\n  due\nfrom (checkOut join People)\nwhere checkOut.p_id = People.p_id\norder by due IF(DATE(NOW()-checkOut.due) &lt;= 2 WEEK);\n</code></pre>\n\n<p>MySQL is stating that there is a syntax error near the IF statement (I'm not surprised as I'm not familiar with writing conditional statements in MySQL). </p>\n\n<p>Another question is regarding whether or not MySQL will yield a date that is negative (i.e. to indicate that an item is passed due). Thanks in advance.</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13221861,"title":"PDO fetchall() performance considerations?","body":"<p>After reading a few articles on the performance impact of PHP's PDO <code>fetchall()</code> function, I am curious if there is another way to accomplish the same outcome without invoking <code>fetchall()</code>.</p>\n\n<p>To explain, most agree that <code>fetchall()</code> tends to be resource intensive.  In my case, I don't believe it will be too big of an issue. Yes, I am having to pull an entire table from my database and display it to the user, but it is going to be about a 100 rows at the very most; I don't believe that will be an issue. Hypothetically, though, if I were needing to pull 100,000 rows, what would be a more optimal solution? </p>\n"},{"tags":["query","caching","filter"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":66,"score":5,"question_id":13024973,"title":"How to efficiently count totals for filter options","body":"<p>I am working on a webshop-type application. One feature I often see in other websites is a breakdown of filtering options, with after that a total of how many results that filtering option will have. You often see this on computer sites (e.g. Newegg) or used car sites. Example:</p>\n\n<pre><code>CPU:\n  * AMD (315)\n  * Intel (455)\n\nVideo card:\n  * ATI (378)\n  * Nvidia (402)\n</code></pre>\n\n<p>How can I efficiently calculate these totals? The website I a working on will have many different products (10.000+) with many different options. To make matters worse, the products are constantly changing.</p>\n\n<p>Trying to precalculate all the different filtering combination totals seems unfeasable. If I have 5 different filters with 4 options each, the number of option possibilities would be <code>20 * 16 * 12 * 8 * 4 = 122880</code>. It would take a long time to calculate that.</p>\n\n<p>Another option would be to query on-demand and cache the results (e.g. in Redis). But how could I manage the cache efficiently if products keep being added and removed? The caches would often be stale. I'm afraid I'd have to micro-manage cache invalidation somehow leading to a very complex and brittle implementation. The alternative would be to invalidate broad sections of cache. But immediately after invalidating, my database would be rushed by hunderds of queries from active users who need these totals recalculated.</p>\n\n<p>Is there a nice and elegant way to handle this?</p>\n"},{"tags":["sql","sql-server","query","insert","character"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13218271,"title":"SQL statement using special charter","body":"<p>Can anyone please help me in correcting below statement:</p>\n\n<pre><code>SET @cmd='BULK INSERT ' + @Database + '.dbo.' + @tmp + ' from ' + @Out + @tmp + '.csv \nWITH (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)' \n</code></pre>\n\n<p>Output of the above query is: </p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)</p>\n</blockquote>\n\n<p>I want to print this in below manner:</p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR =',', ROWTERMINATOR = '\\n')</p>\n</blockquote>\n"},{"tags":["php","sql","query","orm","kohana"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13219599,"title":"Kohana is not loading the result rows?","body":"<p>if i try to load a result with Kohana ORM, the query is correct, but the result is empty. If i copy the Query and use it in phpmyadmin, i receive 2 rows.</p>\n\n<p>This is the Kohana Code (ORM)</p>\n\n<pre><code>        // DB work\n        $ftps = ORM::factory('ftp');\n\n        // if we activate many (we load only ready)\n        if ($this-&gt;request-&gt;param('mode') == 'activate') {\n            $ftps-&gt;where('ready', '=', '1');\n\n        // if we activate many (we load only ready)\n        } elseif ($this-&gt;request-&gt;param('mode') == 'not_ready') {\n            $ftps-&gt;where('ready', '=', '0');\n        }\n\n        // DB work\n        $ftps-&gt;and_where('activated', '=', '0')\n             -&gt;order_by('lastcheck', 'ASC')\n             -&gt;limit(intval($post['number']))\n             -&gt;find_all();\n</code></pre>\n\n<p>This is the SQL Query (Debug) </p>\n\n<pre><code>SELECT `ftp`.* FROM `ftps` AS `ftp` WHERE `activated` = '0' ORDER BY `lastcheck` ASC LIMIT 100 (1)\n</code></pre>\n\n<p>Why is Kohana not able to load the same results like phpmyadmin does? It's the same query. I don't find a solution.</p>\n\n<p>Thank you for your help</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13219212,"title":"speed up mysql query with group by","body":"<p>I have a mysql query:</p>\n\n<p><code>SELECT date(FROM_UNIXTIME(time)) as date,<br>\ncount(view) as views<br>\nFROM ('table_1')<br>\nWHERE 'address' = 1<br>\nGROUP BY date(FROM_UNIXTIME(time))</code></p>\n\n<p>total rows in table is <code>270k</code></p>\n\n<p>this query have slow executing, in myql-slow.log is: </p>\n\n<blockquote>\n  <p>Query_time: 1.839096  Lock_time: 0.000042 Rows_sent: 155  Rows_examined: 286435</p>\n</blockquote>\n\n<p>view - it's auto increment and primary key,  (int(11))<br>\naddress - have index , (int(11))<br>\ntime - also have index, (int(11))</p>\n\n<p>with use EXPLAIN looks like below:</p>\n\n<blockquote>\n  <p>id &nbsp; select_type  &nbsp;&nbsp;&nbsp;   table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   type   possible_keys&nbsp;&nbsp;&nbsp; key       key_len &nbsp;&nbsp;&nbsp;ref   &nbsp;&nbsp;&nbsp; rows  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Extra<br>\n  1  SIMPLE  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   table_1  &nbsp; ref   &nbsp;&nbsp;&nbsp;address    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   address  5      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const  139138 &nbsp;  Using where; Using temporary; Using filesort</p>\n</blockquote>\n\n<p>maybe somebody know how to improve this query to speed up executing? maybe better will be if I will change date in php ? but I think in php take a date as timestamp next convert to human readable and make \"group by\" will take more time then one query in mysql .   <br><br>maybe somebody know how to make this query faster?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13218355,"title":"MySQL query: retrieve some rows based on keys in another table","body":"<p>I'm new at MySQL, so I will use an example to expose my problem...</p>\n\n<p>I have two tables:</p>\n\n<p><strong>Table1:</strong></p>\n\n<pre><code>+----+-----+-----+-----+-----+\n| id | a1  | b1  | c1  | d1  |\n+----+-----+-----+-----+-----+\n|  1 | ... | ... | ... | ... |\n|  2 | ... | ... | ... | ... |\n|  3 | ... | ... | ... | ... |\n|  4 | ... | ... | ... | ... |\n|  5 | ... | ... | ... | ... |\n|  6 | ... | ... | ... | ... |\n+----+-----+-----+-----+-----+\n</code></pre>\n\n<p><strong>Table2:</strong></p>\n\n<pre><code>+----+-----+-----+-----+---------------+\n| id | a2  | b2  | c2  | table1_row_id |\n+----+-----+-----+-----+---------------+\n|  1 | ... | ... | ... | ...           |\n|  2 | ... | ... | ... | 4             |\n|  3 | ... | ... | ... | ...           |\n+----+-----+-----+-----+---------------+\n</code></pre>\n\n<p>Table2 column <code>table1_row_id</code> is the key for table1.</p>\n\n<p>Which kind of query should I use to retrieve table1 data that is not referenced in <code>table2.table1_row_id</code> column?</p>\n\n<p>For instance, for the above tables, the query should return a table like:</p>\n\n<pre><code>+----+-----+-----+-----+-----+\n| id | a1  | b1  | c1  | d1  |\n+----+-----+-----+-----+-----+\n|  1 | ... | ... | ... | ... |\n|  2 | ... | ... | ... | ... |\n|  3 | ... | ... | ... | ... |\n|  5 | ... | ... | ... | ... |\n|  6 | ... | ... | ... | ... |\n+----+-----+-----+-----+-----+\n</code></pre>\n\n<p>Probably this is simple, but I don't know how should I do yet...</p>\n"},{"tags":["sql","vb.net","query","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13209090,"title":"No effect on rowstate after editing data in textbox binded to a binding source VB","body":"<p>I have a sql Query using join that fills the binding source</p>\n\n<pre><code>SELECT        \n  CustomerServiceLocation.id, \n  CustomerServiceLocation.custId, \n  CustomerServiceLocation.custSubId, \n  CustomerServiceLocation.locationId, \n\n  cust.firstNamePri, \n  cust.lastNamePri, \n  cust.phonePriPri, \n  cust.phoneAltPri, \n  cust.extPri, \n  cust.firstNameAlt, \n  cust.lastNameAlt, \n  cust.phonePriAlt, \n  cust.phoneAltAlt, \n  cust.extAlt, \n  cust.id AS Expr1, \n\n  location.custId AS Expr2, \n  location.city, \n  location.unitNum, \n  location.zip, \n  location.gated, \n  location.height, \n  location.code, \n  location.street, \n  location.email, \n  location.comments,\n  location.id AS Expr3 \nFROM            \n  CustomerServiceLocation \nINNER JOIN\n  Customer AS cust ON CustomerServiceLocation.custId = cust.id \nINNER JOIN\n  ServiceLocation AS location ON CustomerServiceLocation.locationId = location.id \nWHERE        \n  (CustomerServiceLocation.custSubId = @custId)\n</code></pre>\n\n<p>The query runs fine and the text boxes binded also display the corect information. When I edit datain text box and select save from navigation then the dataset shows no change in row state. This is the code I use behind the save button in navigation binder:</p>\n\n<pre><code>    Me.Validate()\n\n    Me.CustomerServiceLocationBindingSource.EndEdit()\n\n\n    Dim deletedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n    CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Deleted), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim newChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Added), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim modifiedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Modified), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n</code></pre>\n\n<p>But none of the variables show any changes in <code>deletedChildRecords</code>, <code>newChildRecords</code> &amp; <code>modifiedChildRecords</code></p>\n\n<p>Can anyone help me figure out what I am doing wrong.</p>\n\n<p>Thanks.</p>\n\n<p>UPDATE: if I make changes in fields that are part of CustomerServiceLocation table only those fields value are detected in getChanges and not the Joined tables fields. Can anyone explain how to get changes for joined tables fields that have been binded.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13217679,"title":"SHOW TABLES only shows tables starting with a space mysql","body":"<p>I have some code that needs to get a list of all of the tables in a database with a certain column equaling a certain thing. However, using the <code>SHOW TABLES</code> MySQL code is only listing tables that start with a space. Here is my code...</p>\n\n<pre><code>$result = mysql_query(\"SHOW FULL TABLES IN `db`\") or die(\"Error: \" . mysql_error());\nwhile ($word = mysql_fetch_array($result)) {\n    $word = $word[0];\n    $sql = \"SELECT * FROM `db`.`$word` WHERE col='$val'\";\n    $result = mysql_query($sql, $con) or die(\"Error: \" . mysql_error());\n    while ($col = mysql_fetch_array($result)) echo \"&lt;li&gt;&lt;a nav='$word' title='View $word'&gt;$word&lt;/a&gt;&lt;/li&gt;\";\n}\n</code></pre>\n\n<p>For some reason, the first <code>mysql_query()</code> is only returning one result, which happens to be a table beginning with a space. (It is the only table starting with a space in the whole thing)\nEdit: I just realized that I left out the line of code that turned $word from an array into a string... it's in there now.</p>\n"},{"tags":["sql","database","query","select"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13217069,"title":"Using max() in SQL","body":"<p>One part of my homework assignment is to find the student with the highest average from each department. </p>\n\n<p>QUERY: </p>\n\n<pre><code>SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\nFROM studentgrades g, student s\nWHERE g.sid = s.sid\nGROUP BY s.sid\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>1   Robert  ger 80.0000\n2   Julie   sta 77.0000\n3   Michael csc 84.0000\n4   Julia   csc 100.0000\n5   Patric  csc 86.0000\n6   Jill    sta 74.5000\n</code></pre>\n\n<p>To answer The question, I ran the query </p>\n\n<pre><code>SELECT dcode, averages.sfirstName, MAX(averages.average)\nFROM (\n    SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\n    FROM studentgrades g, student s\n    WHERE g.sid = s.sid\n    GROUP BY s.sid) averages\nGROUP BY dcode\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>csc Michael 100.0000\nger Robert  80.0000\nsta Julie   77.0000\n</code></pre>\n\n<p>Even though the averages are correct, the names are not!\nJulia is the one who has the average 100 in csc, so why does Michael show up?</p>\n\n<hr>\n\n<p>Here's an example:</p>\n\n<p>a student takes courses and gets grades for these courses. EG:</p>\n\n<pre><code>student1 from dept1 took course A and got grade 80\nstudent1 from dept1 took course B and got grade 90\nstudent2 from dept1 took course C and got grade 100\nstudent3 from dept2 took course X and got grade 90\n</code></pre>\n\n<p>AFTER RUNNING THE FIRST QUERY we get the averages for each student</p>\n\n<pre><code>student 1 from dept1 has average 85\nstudent 2 from dept1 has average 100\nstudent 3 from dept2 has average 90\n</code></pre>\n\n<p>Now we find the student with the highest average from each department</p>\n\n<pre><code>dept1, student2, 100\ndept2, student3, 90\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":211,"score":8,"question_id":12315573,"title":"How to write Oracle query to find a total length of possible overlapping from-to dates","body":"<p>I'm struggling to find the query for the following task</p>\n\n<p>I have the following data and want to find the total network day for each unique ID</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   03-Sep-12   07-Sep-12   5\n1   03-Sep-12   04-Sep-12   2\n1   05-Sep-12   06-Sep-12   2\n1   06-Sep-12   12-Sep-12   5\n1   31-Aug-12   04-Sep-12   3\n2   04-Sep-12   06-Sep-12   3\n2   11-Sep-12   13-Sep-12   3\n2   05-Sep-12   08-Sep-12   3\n</code></pre>\n\n<p>Problem is the date range can be overlapping and I can't come up with SQL that will give me the following results</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   31-Aug-12   12-Sep-12   9\n2   04-Sep-12   08-Sep-12   4\n2   11-Sep-12   13-Sep-12   3\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>ID  Total Network Day\n1   9\n2   7\n</code></pre>\n\n<p>In case the network day calculation is not possible just get to the second table would be sufficient.</p>\n\n<p>Hope my question is clear</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13216582,"title":"Issue with value being returned from PDO query","body":"<p>I am experiencing an issue with the values being returned from my PDO statement.</p>\n\n<p>This is my code:</p>\n\n<pre><code>//Execute test\n$this-&gt;checkConnect();\n$stmt = $this-&gt;dbh-&gt;prepare(\"SELECT p_id FROM People WHERE lastName = :param1 AND firstName = :param2\");\n$stmt-&gt;bindParam(':param1', $this-&gt;lName);\n$stmt-&gt;bindParam(':param2', $this-&gt;fName);\n$stmt-&gt;execute();\n$count = $stmt-&gt;rowCount();\n\n//Determine value of test\nif($count == FALSE)\n{\n    return FALSE;\n}\nelse\n{\n    $dummyvar = $stmt-&gt;fetch();\n    $this-&gt;p_id = implode($dummyvar);\n}\n</code></pre>\n\n<p>When I was going through my database records, I noticed that a certain value was off from what I had input. When I execute a query, it is supposed to grab the value of <code>p_id</code> from the table<code>People</code>. Simple enough. However, what happens is that the number is appended twice to itself. For instance, say <code>p_id</code> is equal to 1. <code>this-&gt;p_id</code> will be equal to 11. Or is <code>p_id</code> is equal to 2, the output will be 22. I've executed this query within MySQL and the value is correct. I'm not sure what is happening in my php code. Perhaps something to do with implode? I'm not sure.</p>\n\n<p>Any insight will be appreciated.</p>\n\n<p>Addition: I should also state that <code>p_id</code> is unique, thus only one value can be returned.</p>\n"},{"tags":["query","button","extjs","grid","next"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":11715065,"title":"Result lost with Extjs grid panel \"next button\"","body":"<p>I have a grid panel which works with a search function. Each time the search button is pressed, a query is passed and the grid panel is sorted and display</p>\n\n<p>The query works fine. But when I pressed the \"Next Page Button\" The query information got lost and returns to the original states [with no query execution]</p>\n\n<pre><code>bbar: new Ext.PagingToolbar(\n{\n    store: store,\n    pageSize: 20,\n    plugins: [new Ext.ux.Andrie.pPageSize()],\n    displayInfo: true,\n    width: '400',\n    refresh: function(pt, o) {\n        store.reload();\n        FormPanel.findById('grid').getView().refresh();\n    },\n    emptyMsg: \"No message to display\"\n    }\n)\n</code></pre>\n\n<p>Why is it so?</p>\n"},{"tags":["json","query","mongodb","rest","datetime"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13216304,"title":"Querying MongoDB with JSON / HTTP / REST Interface","body":"<p>I am building an ASP.Net web application and want to access data from MongoDB (remotely hosted). Any of my documents looks like this (have ensured index on Utc field);</p>\n\n<pre><code>{ \n   \"_id\" : { \"$oid\" : \"509501393e8785025c10bc21\" }, \n   \"Index\" : 1,\n   \"Url\" : \"http:...\", \n   \"CameraId\" : 123,  \n   \"Utc\" : { \"$date\" : 1351955858006 } \n}\n</code></pre>\n\n<p>Considering the performance on user end, I want to fetch this data at max speed. One option that i have tried is calling a local Web Service via JSON on Page.aspx which uses MongoDB C# driver to query documents between two Dates (Utc). That works but seems like using  web service adds some extra milliseconds in request/response cycle (request for single document using db.foo.findOne() is served in 1.3 seconds on average). Average number of documents in that collection is 50,000 which will increase up-to 30,00,000.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Am i right in saying that using web services adds some delay\n(millisecs) in request/response cycle ? (because MongoDB actually\ntakes few milliseconds to complete the query)</li>\n<li>Second Option is to use MongoDB's <a href=\"http://www.mongodb.org/display/DOCS/Http+Interface\" rel=\"nofollow\">HTTP / REST Interface</a>. That way i might avoid web services and directly query MongoDB. Here\ni need your opinion on,<br>\n<ul>\n<li>Is there a way to query MongoDB between two Dates using HTTP/REST ?,</li>\n<li>Is there a way to query MongoDB with '>' and '&lt;' conditions using HTTP/REST ?,</li>\n<li>How does it seem, accessing DB directly on Page.aspx with security point of view ?</li>\n</ul></li>\n<li>Any other querying alternative OR optimizations for above schema?</li>\n</ol>\n\n<p>My related question is <a href=\"http://stackoverflow.com/questions/13207217/having-large-number-of-collections-in-mongodb-need-schema-design-suggestions\">here</a>.</p>\n\n<p>Regards.</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13215553,"title":"Match a column from a column with concatenated values in sqlite","body":"<p>I have a table with a column that has concatenated values like this</p>\n\n<pre><code>Table CHILD:\n\n    ChildId       Values\n    2           x123,j455\n    3           f456,z789 \n    4           m333,y567\n    5           x123,h888\n</code></pre>\n\n<p>And I have a master table MASTER that has </p>\n\n<pre><code>Table MASTER:\n\n    MainValues\n    x123\n    f456\n    y567\n</code></pre>\n\n<p>I need to get a query that'll select the following data</p>\n\n<pre><code>ChildId MainValues\n2       x123\n3       f456\n4       y567\n5       x123\n</code></pre>\n\n<p>Basically match value from MASTER in child values and return only the master value. How can I do this ? I have tried IN and LIKE clause matching with second table but that doesnt help much since the values are csv. Is there a way to split and match in sqlite ? </p>\n\n<p>EDIT: Table and column names are fictional and intended just to explain this question better</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13215435,"title":"elasticsearch - How to reference multi-field when building query","body":"<p>I am unable to access multi fields using the navigation notation</p>\n\n<p>My mapping:</p>\n\n<pre><code>{\n\"mappings\":{\n    \"document\":{\n        \"properties\":{\n            \"tags\":{\n                \"type\":\"object\",\n                \"properties\":{\n                    \"title\":{\n                        \"fields\":{\n                            \"partial\":{\n                                \"search_analyzer\":\"main\",\n                                \"index_analyzer\":\"partial\",\n                                \"type\":\"string\"\n                            },\n                            \"title\":{\n                                \"type\":\"string\",\n                                \"analyzer\":\"main\"\n                            },\n                            \"title2\":{\n                                \"type\":\"string\",\n                                \"analyzer\":\"main\"\n                            }\n                        },\n                        \"type\":\"multi_field\"\n                    }\n                }\n            }\n        }\n    }\n},\n\n\"settings\":{\n    \"analysis\":{\n        \"filter\":{\n            \"name_ngrams\":{\n                \"side\":\"front\",\n                \"max_gram\":50,\n                \"min_gram\":2,\n                \"type\":\"edgeNGram\"\n            },\n            \"name_ngrams_back\":{\n                \"side\":\"back\",\n                \"max_gram\":50,\n                \"min_gram\":2,\n                \"type\":\"edgeNGram\"\n            },\n            \"name_middle_ngrams\":{\n                \"type\":\"nGram\",\n                \"max_gram\":50,\n                \"min_gram\":2\n            }\n        },\n\n        \"analyzer\":{\n            \"main\":{\n                \"filter\": [\"standard\", \"lowercase\", \"asciifolding\"],\n                \"type\": \"custom\",\n                \"tokenizer\": \"standard\"\n            },\n            \"partial\":{\n                \"filter\":[\"standard\",\"lowercase\",\"asciifolding\",\"name_ngrams\"],\n                \"type\": \"custom\",\n                \"tokenizer\": \"standard\"\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Test data:</p>\n\n<pre><code>curl -XPUT localhost:9200/testindex/document/1 -d '{\"title\": \"Fight for your life\"}'\ncurl -XPUT localhost:9200/testindex/document/2 -d '{\"title\": \"Fighting for your life\"}'\ncurl -XPUT localhost:9200/testindex/document/3 -d '{\"title\": \"Will you just start the    fight\"}'\n</code></pre>\n\n<p>Search:</p>\n\n<pre><code> curl -XGET 'localhost:9200/testindex/document/_search?q=title:life&amp;pretty=1'                   // Ok\n curl -XGET 'localhost:9200/testindex/document/_search?q=document.title:life&amp;pretty=1'     // Ok\n\n // Return 0 hits.  I expect this to return same result as the above queries.\n curl -XGET 'localhost:9200/testindex/document/_search?q=title.title2:life&amp;pretty=1'\n curl -XGET 'localhost:9200/testindex/document/_search? q=document.title.title2:life&amp;pretty=1'\n</code></pre>\n\n<p>How do I reference multi fields when building queries?</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13215466,"title":"Changed connection page to PDO and got mysql_error()","body":"<p>Was going over my code to turn all my queies into prepared queries (PDO). I changed my connection page accordingly. As I was cleaning up my functions page I came across the error <code>mysql_error() expects parameter 1 to be resource, integer given</code> which referred to my email function </p>\n\n<pre><code>email_exists($email){\n    $query1 = mysql_query(\"SELECT COUNT(user_id) FROM tempusers WHERE \n    `email` = '$email'\") OR die(mysql_error(0));\n    $email = sanitize($email);\n\n    return (mysql_result($query1,0)==1)? true : false;\n}\n</code></pre>\n\n<p>Because it is a function page meaning I can't call on the variables in my connection page coupled with the fact I'm still stuck in the old query ways I'm having a hard time fixing this query. I'd appreciate any ideas on the process of making this query work as well as any tips in general. </p>\n"},{"tags":["android","query","sqlite","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13215371,"title":"Android:Get single row from SQlLite, Null Pointer exception","body":"<p>I am trying to receive a row id from from a main activity and from there, display the content of that row. However I am getting a null pointer exception. I'm unsure of how to implement this properly.</p>\n\n<p>The exception is related to line 22 <strong>MODULEDATABASE.openToRead();</strong> I am an unsure if I need to open to read as I have done this in the main activity. If I comment out this line the next error refers to line 23  <strong>cursor = MODULEDATABASE.getRow(rowId);</strong> Any suggestions would be much appreciated</p>\n\n<p>LogCat error from **MODULEDATABASE.openToRead();</p>\n\n<pre><code>    10-23 09:12:52.572: E/AndroidRuntime(19778): Uncaught handler: thread main exiting due to uncaught exception\n10-23 09:12:52.582: E/AndroidRuntime(19778): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mycoursetimetable/com.example.mycoursetimetable.ViewCourse}: java.lang.NullPointerException\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.access$2200(ActivityThread.java:119)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.os.Handler.dispatchMessage(Handler.java:99)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.os.Looper.loop(Looper.java:123)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.main(ActivityThread.java:4363)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at java.lang.reflect.Method.invoke(Method.java:521)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at dalvik.system.NativeStart.main(Native Method)\n10-23 09:12:52.582: E/AndroidRuntime(19778): Caused by: java.lang.NullPointerException\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.example.mycoursetimetable.ViewCourse.onCreate(ViewCourse.java:22)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    ... 11 more\n10-23 09:12:52.603: I/dalvikvm(19778): threadid=7: reacting to signal 3\n10-23 09:12:52.603: E/dalvikvm(19778): Unable to open stack trace file '/data/anr/traces.txt': Permission denied\n10-23 09:12:59.232: I/Process(19778): Sending signal. PID: 19778 SIG: 9\n</code></pre>\n\n<p>LogCat cursor = MODULEDATABASE.getRow(rowId);</p>\n\n<pre><code>10-23 09:16:42.923: E/AndroidRuntime(20316): Uncaught handler: thread main exiting due to uncaught exception\n10-23 09:16:42.933: E/AndroidRuntime(20316): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mycoursetimetable/com.example.mycoursetimetable.ViewCourse}: java.lang.NullPointerException\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.access$2200(ActivityThread.java:119)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.os.Handler.dispatchMessage(Handler.java:99)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.os.Looper.loop(Looper.java:123)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.main(ActivityThread.java:4363)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at java.lang.reflect.Method.invoke(Method.java:521)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at dalvik.system.NativeStart.main(Native Method)\n10-23 09:16:42.933: E/AndroidRuntime(20316): Caused by: java.lang.NullPointerException\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.example.mycoursetimetable.ViewCourse.onCreate(ViewCourse.java:23)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    ... 11 more\n10-23 09:16:42.953: I/dalvikvm(20316): threadid=7: reacting to signal 3\n10-23 09:16:42.953: E/dalvikvm(20316): Unable to open stack trace file '/data/anr/traces.txt': Permission denied\n10-23 09:16:44.633: I/Process(20316): Sending signal. PID: 20316 SIG: 9\n</code></pre>\n\n<p>View Course activity</p>\n\n<pre><code>public class ViewCourse extends Activity {\nCursor cursor;\ndatabase MODULEDATABASE;\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_view_course);\n\n        Intent intent = getIntent();\n        String rowId = intent.getStringExtra(MyCourses.TEST);\n        //MODULEDATABASE.openToRead();\n        cursor = MODULEDATABASE.getRow(rowId);\n\n        TextView text_modulecode = (TextView)findViewById(R.id.viewModuleCode);\n        TextView text_modulename = (TextView)findViewById(R.id.viewModuleName);\n\n        text_modulecode.setText(cursor.getString(cursor.getColumnIndex(database.KEY_MODULECODE)));\n        text_modulename.setText(cursor.getString(cursor.getColumnIndex(database.KEY_MODULENAME)));\n\n    }\n</code></pre>\n\n<p>Database Class</p>\n\n<pre><code>public  database openToRead()throws SQLException{\n        myHelper = new DbHelper(myContext);\n        moduleDatabase = myHelper.getReadableDatabase();\n        return this;\n}\n\npublic Cursor getRow(String rowId)\n    {\n        String[] columns = new String [] {KEY_ROWID,KEY_MODULECODE, KEY_MODULENAME};\n        Cursor c = moduleDatabase.query(DATABASE_TABLE, columns,KEY_ROWID+ \"=\"+rowId , null, null, null, null);\n        if(c!=null){\n            c.moveToFirst();\n        }\n        return c;\n    }\n</code></pre>\n"},{"tags":["java","query","group-by","datanucleus","jdoql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13197072,"title":"Datanucleus jdoql group by having avg()","body":"<p>I'm trying to write a query that returns all departments whose average salary of employees is within the specified range.</p>\n\n<p>I have something like this:</p>\n\n<pre><code>Query query = pm.newQuery(Employee.class);\nquery.setResult(\"department, avg(salary)\");\nquery.setGrouping(\"department HAVING avg(salary) &gt;= :x &amp;&amp; avg(salary) &lt;= :y\");\nquery.setOrdering(\"2 desc\");\n</code></pre>\n\n<p>Problem is, that avg(salary) is counted again in HAVING, so I get all departments if avg(salary) is in the range or I get empty list of results otherwise. Any ideas?</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13213923,"title":"How to create sql query results in columns from rows?","body":"<p>From the following tables:</p>\n\n<ul>\n<li>store(store_id, ...) {1 ..., 2 ...} two stores</li>\n<li>film(film_id, ...)</li>\n<li>inventory(inventory_id, film_id, store_id)</li>\n<li>rental(rental_id, rental_date, inventory_id, return_date, ...)</li>\n<li>category(category_id, name)</li>\n<li>film_category(film_id, category_id)</li>\n<li>film(film_id, rental_duration, rental_rate, ...)</li>\n<li>customer(customer_id, store_id, ...)</li>\n</ul>\n\n<p>Can I have a query resutls on a table just like the follwoing?</p>\n\n<p>CategoryName | \"Store 1: avaliable items\" | \"Store 1: unavaliable items\" | \"Store 2: avaliable items\" | \"Store 2: unavaliable items\"</p>\n\n<p>Notice that the store fileds in the result table are inseperate columns not in the same columns !!</p>\n\n<p>I am not looking for the result query, I am looking for how to make them side by side store 1, store 2.</p>\n\n<p>Can case sql statement help here?</p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13213948,"title":"join two tables with different rows and multiple select statements","body":"<p>I have a result as</p>\n\n<pre><code>select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username\n</code></pre>\n\n<p>which gives me the columns as <code>username,EmaxViews</code> and gives me 93 rows</p>\n\n<p>and I have another table as <code>Users (username,date_registered,name)</code> which has 100 queries in it</p>\n\n<p>I would like to join my above two queries as a single table as</p>\n\n<pre><code>username, date_registered, EmaxViews\n</code></pre>\n\n<p>I tried like this</p>\n\n<pre><code>select name, date_registered,G.EmaxViews from Users F LEFT OUTER JOIN (select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username) G ON F.username=G.username ORDER BY F.date_registered;\n</code></pre>\n\n<p>Now I am getting 100 rows and proper values for name and date_registered but I am getting NULL for EmaxViews for all the rows..</p>\n\n<p>whats wrong in my query ?</p>\n"},{"tags":["java","mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13166471,"title":"MySQL syntax error using Java in Eclipse","body":"<p>I have the following prepared statement for sql  in Java :</p>\n\n<p>com.mysql.jdbc.JDBC4PreparedStatement@6e56103e:</p>\n\n<pre><code>INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)VALUES(2502591,'2000-03-02 02:02:02','5x5 aptb wdw','00:55:48','DotA v6.75b.w3x','aptb ')ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameStart),`Name`=VALUES(Name),`Lenght`=VALUES(Lenght),`MapVersion`=VALUES(MapVersion),`Mode`=VALUES(Mode).\n</code></pre>\n\n<p>When I execute it in Eclipse I get the following error:</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?,?,?,?)ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameSta' at line 1.\n</code></pre>\n\n<p>But at the same time when I execute the same query in SQLyog I don't get an error. Rows are updated. What can be a problem? Thanks in advance</p>\n\n<p>Code:</p>\n\n<pre><code>  Class.forName(\"com.mysql.jdbc.Driver\");\n    Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/dota\",\"root\",\"root\");\n    PreparedStatement updateGame = null;\n    String updatingGame = \"INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)\" +\n                \"VALUES(?,?,?,?,?,?)\" +\n                \"ON DUPLICATE KEY UPDATE \" +\n                \"`Id`=VALUES(Id),\"+\n                \"`GameStart` = VALUES(GameStart),\" +\n                \"`Name`=VALUES(Name),\" +\n                \"`Lenght`=VALUES(Lenght),\" +\n                \"`MapVersion`=VALUES(MapVersion),\" +\n                \"`Mode`=VALUES(Mode)\";\n    con.setAutoCommit(false);\n    updateGame=con.prepareStatement(updatingGame);\n                updateGame.setInt(1, game.Id);\n                Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);\n                updateGame.setTimestamp(2,timestamp);\n                updateGame.setString(3, game.GameName);\n                updateGame.setTime(4, (Time) game.Time);\n                updateGame.setString(5, game.MapVersion);\n                updateGame.setString(6, game.Mode);\n                updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>And on:</p>\n\n<pre><code>updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>I get an error</p>\n"},{"tags":["sql","query","table","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13205615,"title":"Advanced SQL SUM COLUMN FROM A SAME TABLE","body":"<p>I have this table...</p>\n\n<pre><code>+-----+--------+------+-----+-----+\n|categ| nAME   | quan |IDUNQ|   ID|\n+-----+--------+------+-----+-----+\n|   1 | Z      |    3 |   1 |  15 |\n|   1 | A      |    3 |   2 |  16 |\n|   1 | B      |    3 |   3 |  17 |\n|   2 | Z      |    2 |   4 |  15 |\n|   2 | A      |    2 |   5 |  16 |\n|   3 | Z      |    1 |   6 |  15 |\n|   3 | B      |    1 |   7 |  17 |\n|   2 | Z      |    1 |   8 |  15 |\n|   2 | C      |    4 |   8 |  15 |\n|   1 | D      |    1 |   8 |  15 |\n+-----+--------+------+-----+-----+\n</code></pre>\n\n<p>I need to get the <em>Z of category 1 + Z of category 2 - Z of category 3</em></p>\n\n<p>For example, <em>(3+3-1) = 5   ==>  3 of cat 1,  3 of cat 2, 1 of cat 3</em></p>\n\n<p>The final result should be...</p>\n\n<pre><code>Z ==&gt; 5\nA ==&gt; 5\nB ==&gt; 2\nC ==&gt; 4\n</code></pre>\n"},{"tags":["mysql","sql","query","select","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13210900,"title":"Sql Insert default value if Select returns nothing","body":"<p>I have the following SQL query which populates a table with details of various phone calls.</p>\n\n<pre><code>INSERT tblCalls (callerID, destinationNum)\nSELECT tblCallerID.callerID, tblSkyNums.skyID\nFROM tblCallerID, tblSkyNums\nWHERE tblCallerID.callerNumber = '\".$caller_id.\"'\nAND tblSkyNums.skyNum = '\".$dest_no.\"'\n</code></pre>\n\n<p>The query grabs a callerID and a skyID from two seperate tables and inserts them into a third table; tblCalls.</p>\n\n<p>My problem is sometimes no skyID exists for the number entered, and when this happens nothing is entered into tblCalls. Which means no data is recorded for this call.</p>\n\n<p>What I have been trying to do is if no such skyID exists, simply enter 'n/a' into the skyID field for that particular call.</p>\n\n<p>I have been at this for over two days now and cant seem to find a way to get it to work.\nAny help would be geatly appreciated.</p>\n"},{"tags":["python","query","google-app-engine","key","case-insensitive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13210408,"title":"case insensitive query for key_name","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3289781/how-to-make-case-insensitive-filter-queries-with-google-app-engine\">How to make case insensitive filter queries with Google App Engine?</a>  </p>\n</blockquote>\n\n\n\n<p>Can a GAE datastore be queried case insensitively for a key_name? Maybe query is not the right term. I really want to do a <code>get_by_key_name()</code> so the user does not have to have the correct case, but does have the correct text characters. </p>\n"},{"tags":["sql","sql-server","performance","sql-server-2008","query"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":35148,"score":7,"question_id":4193705,"title":"SQL Server SELECT LAST N Rows","body":"<p>This is a known question but the best solution I've found is something like:</p>\n\n<pre><code>SELECT TOP N *\nFROM MyTable\nORDER BY Id DESC\n</code></pre>\n\n<p>I've a table with lots of rows. It is not a posibility to use that query because it takes lot of time. So how can I do to select last N rows without using ORDER BY?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Sorry duplicated question of <a href=\"http://stackoverflow.com/questions/311054/how-do-i-select-last-5-rows-in-a-table-without-sorting\">this one</a></p>\n"},{"tags":["mysql","query","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13015489,"title":"Nested categories counting only one branch with products","body":"<pre><code>CREATE TABLE IF NOT EXISTS `site_location` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `level` int(11) NOT NULL,\n  `lft` int(11) NOT NULL,\n  `rgt` int(11) NOT NULL,\n  `name` varchar(50) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=13 ;\n\n///DATA\n    INSERT INTO `site_location` (`id`, `level`, `lft`, `rgt`, `name`) VALUES\n    (1, 0, 1, 24, 'United Kingdom'),\n    (2, 1, 2, 19, 'London'),\n    (3, 2, 13, 14, 'Central London'),\n    (4, 2, 11, 12, 'East London'),\n    (5, 2, 9, 10, 'North London'),\n    (6, 2, 7, 8, 'North West London'),\n    (7, 2, 5, 6, 'South East London'),\n    (8, 2, 3, 4, 'West London'),\n    (9, 2, 15, 18, 'South West'),\n    (10, 3, 16, 17, 'Battersea'),\n    (11, 1, 20, 23, 'Brighton'),\n    (12, 2, 21, 22, 'Guildford');\n\nCREATE TABLE IF NOT EXISTS `ads` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `category_id` int(11) NOT NULL,\n  `location` int(11) NOT NULL,\n  `title` varchar(255) CHARACTER SET utf8 NOT NULL,\n  PRIMARY KEY (`id`,`category_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=5 ;\n\nINSERT INTO `ads` (`id`, `category_id`, `location`, `title`) VALUES\n(1, 7, 10, 'Test1'),\n(2, 9, 3, 'Test2'),\n(3, 12, 10, 'Test3'),\n(4, 13, 4, 'Test4');\n</code></pre>\n\n<p>when ID is ID=1 to return this way</p>\n\n<pre><code>[ United Kingdom(4) ]\n    London(4)     \n    Brighton(0)\n</code></pre>\n\n<p>and when ID is ID = 2</p>\n\n<pre><code>    United Kingdom(4)\n      [ London(4) ]\n        South West(2)\n        Central London(1)\n        East London(1)\n      Brighton(0)\n</code></pre>\n\n<p>so when is selected \"London\" I need all its siblings and all its children</p>\n\n<p>the same when is selected \"South West\" I need all its siblings all its children, its parent all its parent siblings</p>\n\n<pre><code>    United Kingdom(4)\n      London(4)\n        [ South West(2) ]\n          Battersea(2)\n        Central London(1)\n        East London(1)\n      Brighton(0)\n</code></pre>\n\n<p>and as well how many ads have in the location, for example in UK has to have 4 because all ads in the table are 4, south west has to have 2 because in Battersea has 2</p>\n\n<p>when id is 11</p>\n\n<pre><code>United Kingdom(4)\n  London(4)\n  [ Brighton(0) ]\n      Guildford(0)\n</code></pre>\n\n<p>I have a query:\n South West lft:15, rgt:18, level:2</p>\n\n<pre><code> SELECT \n    node.id, \n    node.alias, \n    node.level, \n    node.name, \n    COUNT(ads.id) as ads,\n    IF(node.lft = node.rgt-1, \"0\", \"1\") AS `has_children`\n FROM \n    site_location AS parent LEFT JOIN\n    ads as ads ON (parent.id = ads.location),\n    site_location AS node\n WHERE\n    parent.lft BETWEEN node.lft AND node.rgt\n AND \n    parent.lft BETWEEN 15 AND 18\n AND \n    node.level &gt; 0\n AND\n   node.level &lt; 2 + 3\n GROUP BY node.id\n ORDER BY node.lft\n</code></pre>\n\n<p>this will return </p>\n\n<pre><code> London(4)\n  South West(2)\n   Battersea(2)\n</code></pre>\n\n<p>I need to be in this way</p>\n\n<pre><code> London(4)\n  South West(2)\n   Battersea(2)\n Brighton(0) \n</code></pre>\n\n<p>Is it possible to do this with single query :?\nIf anyone can help, It will be great. Thanks in advance!</p>\n"},{"tags":["mysql","query","group-by","subquery","not-exists"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13171867,"title":"MySQL query GROUPing from one table, excluding results found in another sub query","body":"<p>Let's say I have two tables - ADDONS and DOWNLOADS.</p>\n\n<p>ADDONS dictates which apps come with which addons for FREE.<br>\nDOWNLOADS logs addon downloads from all apps, those that include for free and not.</p>\n\n<pre><code>ADDONS  \nappname  | varchar  \nappaddon | varchar\n\nDOWNLOADS  \nid       | int  \nappaddon | varchar  \nappname  | varchar  \nsource   | varchar  \ndate     | datetime  \n</code></pre>\n\n<p>I am trying to write a query that shows the count of each appaddon in DOWNLOADS where it was NOT included for free in ADDONS.</p>\n\n<p>I got as far as:  <code>\"SELECT appaddon, count(id) FROM downloads GROUP BY appaddon ORDER BY count(id) DESC\"</code> - but that is inclusive of apps that included it for free and those that do not.</p>\n\n<p>Can anyone point me in the right direction on this?</p>\n\n<hr>\n\n<p>Update:  </p>\n\n<p>Example:  Imagine I have two holiday themed apps - one for Christmas, one for Halloween, and each app allows you to download costumes that are included with the app (for example Halloween lets you download a witch, skeleton or jack o lantern, and Christmas lets you download a Santa or elf).  BUT if someone upgrades from within the app, they can download ANY of the available costumes (so Christmas upgraded could download a skeleton, or Halloween upgraded could download an Elf).</p>\n\n<p>I am trying to get a count of the downloads that are NOT included without upgrading.  So I want to exclude the witches downloaded by Halloween, and the Santas downloaded by Christmas, but get a count of the witches, skeletons, elves, etc downloaded by the OTHER apps. </p>\n\n<p>Here is some example data:  </p>\n\n<pre><code>ADDONS  \nappname     | appaddon  \n========================  \nhalloween   | jackolantern  \nhalloween   | skeleton  \nhalloween   | witch  \nchristmas   | santa  \nchristmas   | elf  \nchristmas   | reindeer  \neaster      | bunny  \nallholidays | bunny\n\nDOWNLOADS  \nid | appaddon  | appname   | date  \n=======================================\n1  | skeleton  | halloween | 2012-10-15  \n2  | skeleton  | halloween | 2012-10-15  \n3  | witch     | halloween | 2012-10-16  \n4  | santa     | christmas | 2012-10-16  \n5  | elf       | christmas | 2012-10-16  \n6  | witch     | christmas | 2012-10-16  \n7  | bunny     | christmas | 2012-10-16  \n8  | bunny     | halloween | 2012-10-17  \n9  | bunny     | easter    | 2012-10-18\n</code></pre>\n\n<p>Based on above, I would expect the results:</p>\n\n<pre><code>appaddon  | count\n=================\nbunny     | 2\nwitch     | 1\n</code></pre>\n"},{"tags":["android","query","sqlite","android-contentprovider"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13210044,"title":"exist() method sqlite with ContentProvider","body":"<p>i'd like to create a method for \"exist tuple?\"</p>\n\n<p>my old method with classic StartManagingCursor way was :</p>\n\n<pre><code>public boolean exist(long uid){\n     boolean ex = false;\n\n     Cursor c= db.rawQuery(\"SELECT COUNT(*) FROM \" + Person.PERSON_TABLE + \" WHERE uid = \"+ \"'\" + uid + \"'\", null);\n            c.moveToFirst();\n  int jcount = c.getInt(0);\n\n  if (jcount &gt;0){\n            ex=true;                        \n    }\n     return ex;\n</code></pre>\n\n<p>}</p>\n\n<p>now i wanna do this with ContentProvider for my sqlite db. \nhow i can do this with query method of my contentprovider class?</p>\n"},{"tags":["mysql","query","adapter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13209815,"title":"Update the date column in mysql","body":"<p>Im struggling in update the date format in mysql. Before that while retrieval from Mysql(using netbeans) of date using adapter the format was is like that</p>\n\n<p><strong>\"Birth_Date\": \"1990-10-11T00:00:00.000Z\",</strong></p>\n\n<p>Now i want to modify the column of Birthdate into  <strong>1990-10-11</strong></p>\n\n<p>i dont want rest of character .. guide me how to achieve this</p>\n"},{"tags":["php","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13209734,"title":"PHP error: Warning: ociparse() parameter 1 to be resource","body":"<p>As there is not ready made function in oracle to validate the Query so created.\nSo I tried below code to check whether the QUERY is valid or not.</p>\n\n<pre><code>if(isset($_POST['btn_Submit_Query']))\n            {\n                $check_query=$_POST['txtQuery'];\n                echo $check_query;\n                $valid = false;\n                $stmt = oci_parse($DB, $check_query);\n                echo \"Statement\" . $stmt;\n                //oci_define_by_name($stmt, 'NUMBER_OF_ROWS', $number_of_rows);\n                oci_execute($stmt, OCI_DEFAULT);\n                echo oci_num_rows($stmt);\n            }\n</code></pre>\n\n<p>I got following Warnings in the Execution:</p>\n\n<pre><code>Warning: oci_parse() expects parameter 1 to be resource, object given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 899\nStatement\nWarning: oci_execute() expects parameter 1 to be resource, null given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 902\n\nWarning: oci_num_rows() expects parameter 1 to be resource, null given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 903\n</code></pre>\n\n<p>Kindly please tell me the PROBLEM where is my mistake.\nThanks and Regards in Advance</p>\n"},{"tags":["query","tsql","join","insert-update"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13195855,"title":"T-SQL Need assistance with complex join","body":"<p>I am really out of ideas of how to solve this issue and need some assistance - not only solution but idea of how to approach will be welcomed. </p>\n\n<p>I have the following table:</p>\n\n<pre><code>TABLE Data\n( \n     RecordID\n    ,DateAdd\n    ,Status\n)\n</code></pre>\n\n<p>with sample date like this:</p>\n\n<pre><code>11  2012-10-01 OK\n11  2012-10-04 NO\n11  2012-11-05 NO\n22  2012-10-01 OK\n33  2012-11-01 NO\n33  2012-11-15 OK\n</code></pre>\n\n<p>And this table with the following example data:</p>\n\n<pre><code>TABLE Periods\n(\n    PeriodID\n   ,PeriodName\n   ,DateStart\n   ,DateEnd\n)\n\n1 Octomer  2012-10-01 2012-10-31\n2 November 2012-11-01 2012-11-30\n</code></pre>\n\n<p>What I need to do, is to populate a new table:</p>\n\n<pre><code>TABLE DataPerPeriods\n(\n    PeriodID,\n    RecordID,\n    Status\n)\n</code></pre>\n\n<p>That will store all possible combinations of PeriodID and RecordID and the latest status for period if available. If status is not available for give period, then the status for previous periods. If there are no previous status at all - then NULL for status.</p>\n\n<p>For example with the following data I need something like this:</p>\n\n<pre><code>1 11 NO //We have status \"OK\" and \"NO\", but \"NO\" is latest for the period\n1 22 OK \n1 33 NULL//Because there are no records for this and previous periods\n2 11 NO //We get the previos status as there are no records in this periods\n2 22 OK //There are not records for this period, but record for last periods is available\n2 33 NO //We have status \"OK\" and \"NO\", but \"OK\" is latest for the period\n</code></pre>\n\n<p>EDIT: I have already populate the period ids and the records ids in the last table, I need more help on the status update.</p>\n"},{"tags":["python","django","query","orm","user"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13207416,"title":"Django : How to filter users with username__iexact by default?","body":"<p>Implementing username case-insensitive :</p>\n\n<p>I want to implicitly imply <code>iexact</code> when querying for <code>user</code> :</p>\n\n<pre><code>user = User.objects.get(username = 'yugal')  # Lowercase\nuser.id # 1\n\nuser = User.objects.get(username = 'YUgal')  # Mixcase\nuser.id # 1\n</code></pre>\n\n<p>How can I achieve this ? { somehow with <code>UserManager</code> }</p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>Also, <code>django.shortcuts.get_object_or_404</code> seems to use it as <code>User.objects.get_query_set().all().get()</code>. How can we make it work ?</li>\n</ul>\n"},{"tags":["mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":55,"score":5,"question_id":13207838,"title":"Disk space implications of setting MySQL column value to NULL instead of 0 or ''","body":"<p>I'm trying to understand the best way to handle columns which are mostly empty in terms of <strong>disk-space</strong> and <strong>index-performance</strong>. Is there a difference between putting in all empty places NULL vs '' (for varchar / text) vs 0 (for int).</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","optimization","group-by","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":13201809,"title":"MySQL very slow query using left joins","body":"<p>I have this query that runs on a fairly large set of data.<br>\nIt is <em>extremely</em> slow... </p>\n\n<p>I need to optimize this query, and not sure where to start (aside from indexes).</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>SELECT d.distributor_id, \nd.first_name,\nd.last_name,\nd.sponsor_id,\nCOUNT(f.business_level) AS total_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'EXECUTIVE' THEN 1 else 0 end)\n    AS executive_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'PERSONAL' THEN 1 else 0 end)\n    AS personal_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'PREFERRED CUSTOMER' THEN 1 else 0 end)\n    AS preferred_customer_enrollments,\nIFNULL(cf.commission_paid, 0) AS commission_paid,\nIFNULL(cf.retention_earned, 0) AS retention_earned,\nCOUNT(df.order_type) AS total_autoships,\nIFNULL(a.consecutive_streak, 0) AS autoship_streak,\nIFNULL(a.enrollment_date, \"Not Enrolled\") AS autoship_enrollment,\nd.highest_rank\n    FROM warehouse.distributor d\n        LEFT JOIN warehouse.enrollment_detail_fact f ON d.distributor_id = f.distributor_id\n        LEFT JOIN warehouse.country c ON d.country = c.name\n             AND c.country_id = 185\n        LEFT JOIN warehouse.autoship a ON d.distributor_id = a.distributor_id\n        LEFT JOIN warehouse.order_detail_fact df ON d.distributor_id = df.distributor_id\n            AND UPPER(order_type) = 'AUTOSHIP'\n            AND date_id IN(SELECT date_id FROM warehouse.date\n                WHERE DATE BETWEEN '2012-10-10'\n                AND '2012-10-11' ORDER BY date DESC)\n        LEFT JOIN warehouse.commission_detail_fact cf ON d.distributor_id = df.distributor_id\n        LEFT JOIN db.commission_level_type_details cl ON d.highest_rank = cl.name\nWHERE d.active = 1               \n    AND cl.commission_level_type_detail_id IN (23)\nGROUP BY distributor_id\nORDER BY first_name; \n</code></pre>\n"},{"tags":["ruby-on-rails","query","activerecord","nested-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207082,"title":"Rails Nested Query","body":"<p>I have follow query</p>\n\n<pre><code>  notes = Note.where('notes.id IN\n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      WHERE \"notes\".\"circle_id\" = ?\n  )\n  OR notes.id IN \n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      INNER JOIN \"circles_dreams\" \n      ON \"circles_dreams\".\"dream_id\" = \"notes\".\"dream_id\" \n      WHERE \"circles_dreams\".\"circle_id\" = ? \n  )', @circle.id, @circle.id)\n</code></pre>\n\n<p>How to simplify this query? \n Thanks.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13207618,"title":"MySQL JOIN query -","body":"<p>I know this question has already asked here, but I can't figure this one out from the previous answers.</p>\n\n<p>We've got 2 tables:</p>\n\n<pre><code>members\n-----------------------\n| id | country_iso_3 |\n-----------------------\n  1    USA\n  2    DZA\n  3    FRA\n  4    ILI\n  5    USA\n  6    USA\n\n\nmembers_details\n-----------------------\n| member_id | city    |\n-----------------------\n  1          AA\n  2          BB\n  3          CC\n  4          DD\n  5          EE\n  6          FF\n</code></pre>\n\n<p>Now I want to query members_details and select the cities which are from the same countries, here \"AA\", \"EE\" and \"FF\" should be the results (because the members are from USA)</p>\n\n<p>I know how to compare different cols from different tables, but here we need to check the second table 'member_id' and the first table 'id (country_iso_3)' somehow!</p>\n"},{"tags":["performance","query","google-app-engine","memcached","gae-datastore"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13205472,"title":"Most Efficient Way for Users to Search for all of a Database Model","body":"<p>I have two database models in my webapp and one has around 10,000 entries and the other has close to double that. I have it set up right now so that all of these entries are kept in memcache.  I also have it set up so that the user can search by certain constraints and I just filter the cache by those constraints with some if statements.  Part of this is so that I don't have to pay for the search quota with the Google Search API.</p>\n\n<p>I wanted to see if using memcache here is the best option or if I should simply do a DB query which will quickly run up my read quota or if there is any other good option.  One of my problems here is that as my database gets larger the searches are getting slower.</p>\n\n<p>Here is some example code where I am searching by location and then filtering by a sport category:</p>\n\n<pre><code>        #this is the cache I am using\n        groups = group_cache()\n        search_location = self.request.get(\"search_location\")\n        search_postsport = self.request.get(\"search_postsport\")\n        GPSlocation = None\n        error=None\n        groups_to_render = None\n\n        if search_location:\n            g = geocoders.Google()\n            searched_location = None\n            #to catch an error where there is no corresponding location\n            try:\n                #to catch an error where there are multiple returned locations\n                try:\n                    place, (lat, lng) = g.geocode(search_location)\n                    place, searched_location = g.geocode(search_location)\n                except ValueError:\n                    geocodespot = g.geocode(search_location, exactly_one=False)\n                    place, (lat, lng) = geocodespot[0]\n                    place, searched_location = geocodespot[0]\n                GPSlocation = \"(\"+str(lat)+\", \"+str(lng)+\")\"\n\n                groups = group_cache()\n                return_groups = []                   \n                for group in groups:\n                    distance.distance = distance.GreatCircleDistance\n                    location_distance = distance.distance(searched_location, point.Point(group.lat, group.lng)).miles\n\n                    if location_distance &lt; 300:\n                        return_groups.append(group)\n                groups = return_groups\n                search=True\n                groups_to_render = sorted(groups, key=attrgetter('recordCount'), reverse=True)\n                groups_to_render = groups_to_render[:10]\n</code></pre>\n"},{"tags":["html","query","google","parameters","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":11584551,"title":"Need information on query parameters for Google Books e.g. difference between &dq and &q, &f, &redir_esc, etc","body":"<p>In books with \"Snippet view\" available (where you can view snippets of text in a page) to link to highlighted text represented by <code>&lt;search_string&gt;</code>, I can any one of the following forms of the URL:</p>\n\n<pre><code>http://books.google.com/books?id=&lt;book_id&gt;&amp;q=&lt;search_string&gt;&amp;dq=&lt;search_string&gt;\nhttp://books.google.com/books?id=&lt;book_id&gt;&amp;q=&lt;search_string&gt;\nhttp://books.google.com/books?id=&lt;book_id&gt;&amp;dq=&lt;search_string&gt;\n</code></pre>\n\n<p>In books with \"Preview\" available (where you can view full pages) links to highlighted text add <code>&amp;pg=&lt;page_number&gt;</code> after <code>&amp;id=&lt;book_id&gt;</code> to a URL in one of the above forms. I've discovered that that such a URL always works when it has both <code>&amp;dq</code> and <code>&amp;q</code> but queries with only <code>&amp;dq</code> or only <code>&amp;q</code> don't work with some books.</p>\n\n<p>I've also noticed that <code>&amp;f=false</code> tends to be automatically appended to the query when you click on the link.</p>\n\n<p>What do these parameters <code>&amp;q</code>, <code>&amp;dq</code>, <code>&amp;f</code> and <code>&amp;redir_esc=y#v=onepage</code> mean? Where I can find this information and information on how to use query parameters in general for Google Books? I've searched but can't find anything with this specific information.</p>\n\n<p>Note: Different books use different page number formats. In my experience, <code>&lt;page number&gt;</code> in the URL for a book with \"Preview\" available can be one of the following forms:</p>\n\n<ul>\n<li><code>PAx</code> where x is the actual page number in the book.</li>\n<li><code>PTx</code> where x may not be actual page number in the printed book, which may not be shown on the page in the Google Books viewer.</li>\n<li><code>PRx</code> where x is the number of a page preceding the first chapter e.g. page iii in the book is linked to with <code>&amp;pg=PR3</code></li>\n<li><code>SLz-PAx</code> where the pages of the book are of the form <code>&lt;section&gt;&lt;page&gt;</code> with z as the index number of the section in the book and x the page number in that section e.g. page C17 is is linked to with <code>&amp;pg=SL3-PA17</code></li>\n</ul>\n"},{"tags":["query","query-optimization","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":11852025,"title":"Access 2010 Optimizing a bloated query","body":"<p>I have to have this query produce a monthly average availability for a selection of equipment. The query looks pretty ugly and rather bloated and I'm wondering if there's something I can do to make it better.  </p>\n\n<p>Right now I have an Expression column representing each month. In each month, take January for example, I need to check if the maintenance period occurred within the month, started before the month but ended during, started during the month but ended outside, completely encapsulates the month (if Jan 2012, then started maintenance Dec 2011 ended Feb 2012),  or not count it because it was fully operational throughout the month.  </p>\n\n<p>So as you can see checking these 4 cases and doing calculations afterwards really bloats up one month, let alone 12! So I'm just looking for a suggestion if there's something more I can be doing. I'm not afraid of some RnD if someone has articles they can point me towards. If this approach is not overly bad I don't mind, I would just like to do better if its possible.  </p>\n\n<p>Thanks in advanced!  </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203117,"title":"mysql distinct query based off non unique columns","body":"<p>I have a weird (probably bad table design) query question thatI cannot think of an easy way to  solve.</p>\n\n<p>here is a table layout like what I have:</p>\n\n<pre><code>| id                 | int(11)     | NO   | PRI | NULL    | auto_increment | \n| num                | varchar(15) | YES  | MUL | NULL    |                | \n| type               | varchar(4)  | YES  |     | NULL    |                | \n</code></pre>\n\n<p>type is actually,  enum(\"val1\",\"val2\",\"blah\")</p>\n\n<p>num can have 3 entries in the table,  one with each of the 3 different type.</p>\n\n<p>The query I need is the count of distinct number of \"num's\" that have both an entry for \"val1\" and \"val2\".</p>\n\n<p>I do not think there is a simple query to handle this.. but the only solution I have come up with is to dump distinct entries of val1 to a memory table,  distinct entries of val2 to a memory table.</p>\n\n<p>Then determine which table has the least number of records.,  then write a subquery based off the smaller table looking for number matches in the larger table.</p>\n\n<p>the above sounds like a bad hack though...</p>\n\n<p>Am I missing something here...Do any of you see a better way to do this?</p>\n"},{"tags":["c#","database","query","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13193514,"title":"connect with C# console application to internal DB of asp.net mvc 4 website","body":"<p>is there any chance to connect into default DB of asp.net mvc 4 application?</p>\n\n<p>I have one running website on server, and another C# console application, also on same server. And I'm trying to figure how to put some queries (insert/update) from that console app to database created in asp.net application. Of course website app is running.</p>\n\n<p>Any ideas?</p>\n\n<p>//edit</p>\n\n<p>I need this cause of creating web application for \"imports\" (it's bigger amount of data, about 300k records from Excel file). And I don't want push user to have opened website whole time while updating database (\"backside processing\"). If you have some another idea how to make it, I will be really happy to hear it</p>\n"},{"tags":["javascript","query","google-visualization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13201820,"title":"Using 2 queries in one dashboard google visualization","body":"<p>I am trying to put in 2 queries in one dashboard on Google Visualization. I'd like to create two tables: <code>transaction table</code> and <code>summary table</code> in one dashboard. However, as I have observed, <code>you can only pass one query</code>. In this case, <code>query.send(drawDashboard)</code>. Are there any tricks to pass 2 queries in a function?</p>\n\n<p><strong>Note:</strong> I have tried creating 2 queries inside <code>setQuery()</code> function, then created another function that would catch the query such as <code>drawTransaction()</code>. However, the page display does not allow it. </p>\n\n<p><strong>Query</strong></p>\n\n<pre><code>function setQuery() {\n    var query = new google.visualization.Query('&lt;spreadsheet here&gt;');\n    var queryString = 'select A,B,C';\n    //alert(queryString);\n    query.setQuery(queryString);\n    query.send(drawDashboard);\n}\n</code></pre>\n\n<p><strong>Draw Dashboard</strong></p>\n\n<pre><code>function drawDashboard(response) {\n    data = response.getDataTable();\n    var dateformatter = new google.visualization.DateFormat({\n        formatType: 'medium'\n    });\n    dateformatter.format(data,0);\n\n    var memberPicker = new google.visualization.ControlWrapper({\n        'controlType':'CategoryFilter',\n        'containerId':'memberPicker',\n        'options': {\n            'filterColumnLabel':'IssuedTo',\n            'ui': {\n                'label':'Member',\n                'labelStacking': 'vertical',\n                'allowTyping': false,\n                'allowMultiple': false                      \n            }\n        }\n    });\n    var table = new google.visualization.ChartWrapper({\n        'chartType':'Table',\n        'containerId':'dataTable',\n        'options': {\n            'width':920\n        }\n    });\n    new google.visualization.Dashboard(document.getElementById('dashboard')).\n    bind(memberPicker,table).\n    draw(data);\n}\n</code></pre>\n"},{"tags":["php","mysql","regex","query","strip"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13199470,"title":"Strip/delete all values from MySQL query using PHP regex?","body":"<p>How to strip/delete all values from MySQL queries using PHP Regex?</p>\n\n<p>Example:  </p>\n\n<p>original: <code>SELECT id, abc FROM mytable WHERE id IN (12, 15)</code><br>\nstriped: <code>SELECT id, abc FROM mytable WHERE id IN ()</code></p>\n\n<p>original:</p>\n\n<pre><code>SELECT ut.id, IF(stagiaire_devis.id IS NOT NULL, CONCAT(ut.prenom, ' (my lovely)', ut.prenom) AS value FROM quality AS uq, avocate, utility AS ut LEFT JOIN stagiaire_devis ON (stagiaire_devis.id_devis='1293049' AND stagiaire_devis.id_utilisateur=ut.id) WHERE uq.id_utilisateur = ut.id AND avocate.id_utilisateur = ut.id AND avocate.deleted = 0 AND avocate.id_avocat_liste_cabinet = 7 AND uq.id_liste_qualite IN (5,2,9) AND uq.actif = 2 ORDER BY ut.prenom\n</code></pre>\n\n<p>striped:</p>\n\n<pre><code>SELECT ut.id, IF(stagiaire_devis.id IS NOT NULL, CONCAT(ut.prenom, '', ut.prenom) AS value FROM quality AS uq, avocate, utility AS ut LEFT JOIN stagiaire_devis ON (stagiaire_devis.id_devis='' AND stagiaire_devis.id_utilisateur=ut.id) WHERE uq.id_utilisateur = ut.id AND avocate.id_utilisateur = ut.id AND avocate.deleted = AND avocate.id_avocat_liste_cabinet = AND uq.id_liste_qualite IN () AND uq.actif = ORDER BY ut.prenom\n</code></pre>\n\n<p>I cannot find right regex :(</p>\n"},{"tags":["query","scala","slick"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13097492,"title":"scala slick query return value","body":"<p>I am rather new at Scala and have been struggling with slick and can't see how to return the results of a query to the calling method</p>\n\n<p>I have a simple UserDto</p>\n\n<pre><code>case class UserDto(val firstName:String,\n  val lastName:String,\n  val userName:String,\n  val isAdmin:Boolean) {}\n</code></pre>\n\n<p>a User table object</p>\n\n<pre><code>object User extends Table[(String, String, String, Boolean)](\"USER\") {\n\n  def firstName = column[String](\"FIRST_NAME\")\n  def lastName = column[String](\"LAST_NAME\")\n  def userName = column[String](\"USER_NAME\")\n  def admin = column[Boolean](\"IS_ADMIN\")\n\n  def * = firstName ~ lastName ~ userName ~ admin\n\n}\n</code></pre>\n\n<p>and a query class</p>\n\n<pre><code>class UserQuerySlickImpl(dataSource:DataSource) {\n\n  def getResults(userName:String):Option[UserDto] = {\n    var resultDto:Option[UserDto] = None\n\n    Database.forDataSource(dataSource) withSession {\n      val q = for {u &lt;- User if u.userName is userName}\n      yield (u.firstName, u.lastName, u.userName, u.admin)\n\n      for (t &lt;- q) {\n        t match {\n          case (f:String, l:String, u:String, a:Boolean) =&gt; \n            resultDto = Some(new UserDto(f, l, u, a))\n        }\n      }\n    }\n    resultDto\n  }\n}\n</code></pre>\n\n<p>I can query the database and get the user that matches the username, but the only way I could figure out how to return that user is by creating a var outside of the <code>Database.forDataSource....{}</code>.</p>\n\n<p>Is there a better way that does not use the var but returns the <code>resultDto</code> directly.</p>\n\n<p>also is there a way to construct the <code>UserDto</code> directly from the first for comprehension rather than needing the second for (t &lt;- q) ...</p>\n\n<p>I am using  slick_2.10.0-M7, version 0.11.1.</p>\n"},{"tags":["query","rest","path","resteasy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13198043,"title":"RESTful webservices: query parameters","body":"<p>I am using JAX-RS with RESTEasy.</p>\n\n<p>I want to know if we can have represent different resources with path differentiated only  by order and number of query parameters?</p>\n\n<p>e.g.</p>\n\n<pre><code>/customer/1234\n/customer?id=1234\n/customer?name=James\n</code></pre>\n\n<p>Can I create three different methods e.g.</p>\n\n<pre><code>@Path(\"customer/{id}\")\npublic Response get(@PathParam(\"id\") final Long id) {\n..\n}\n\n@Path(\"customer?id={id}\")\npublic Response get(@QueryParam(\"id\") final Long id) {\n..\n}\n\n@Path(\"customer?name={name}\")\npublic Response get(@QueryParam(\"name\") final String name) {\n..\n}\n</code></pre>\n\n<p>Will this work, can I invoke different methods by differentiating path like this?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":46,"score":-2,"question_id":13195515,"title":"How to set a NULL in the first and second record?","body":"<p>I have the following query:  </p>\n\n<pre><code>Declare @t Table(Id int identity,Groep int,[Date] Datetime,MondayMorning      \nInt,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int ,WednesdayMorning    \nInt,WednesdayEvening Int)\nInsert Into @t Select 2,'2012-01-01',2,0,2,2,2,2\nunion all\nSelect 2,'2012-01-02', 2,2,2,3,2,2\nunion all\nSelect 3,'2012-01-03', 2,2,2,2,2,2\n\n\nselect Id, Groep ,[Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nfrom @t t\nunion all\nselect Id, Groep, [Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nFrom @t tt\n\nWHERE tt.MondayMorning &lt;&gt; tt.MondayEvening\nAND (tt.MondayMorning != 0 and tt.MondayEvening != 0)\nOR tt.TuesdayMorning &lt;&gt; tt.TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\nOR tt.WednesdayMorning &lt;&gt; tt.WednesdayEvening\nAND (tt.WednesdayEvening != 0 and tt.WednesdayMorning != 0)\n</code></pre>\n\n<p>This query gives me a result that is actually correct. I just need to set in TuesdayEvening a Null value in the first record with Id=2. In the second record from that Id=2 set TuesdayMorning = null</p>\n\n<p>To see how this works just run the query.</p>\n\n<p>any ideas?</p>\n"},{"tags":["jquery","query","filter","portfolio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":8837512,"title":"Filtering portfolio in jQuery","body":"<p>I want to add a filtering option to my <a href=\"http://lionwebmedia.com\" rel=\"nofollow\">portfolio</a>. I found a tutorial on CSS-Tricks which I follow with a few modifications (mostly it was deleting unnecessary code).</p>\n\n<p>The goal I want to achieve is to filter portfolio projects so if I you click on \"UI\" portfolio will show only projects related to UI by sliding all projects up and than sliding down all UI projects (just like in tutorial I mention).</p>\n\n<p>So far everything works fine, you can scroll to desired project and at the bottom of it you will find a filter list, everything works, portfolio is sorting but the problem is with sliding up, because website is sliding to the very top of the page. It should look like this:</p>\n\n<p>If we are in the middle of portfolio (or in any position) and we want to sort it to show only UI projects website should scroll to the top of the project list (right under the black header).</p>\n\n<p>JS can be found <a href=\"http://jsfiddle.net/lionwebmedia/spESn/\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["php","mysql","query","insert"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13196931,"title":"Inserting title into database","body":"<p>I want to add \" write title\". This script does not have write title option and I would like to add it to script. It already has the add video option so I though that write title should be similar to add video option . That's why I tried to do something like this and I just can't get the script to insert title in the database, if you could help me with this one I would be very thankful. Here is the srcipt</p>\n\n<pre><code> &lt;?\n  session_start();\n  include(\"../func/db_info\".\".php\");\n  include(\"logincheck\".\".php\");\n  logincheck();\n\n  $surl = $_SERVER['HTTP_HOST'] ;\n\n  if (strip_tags($_POST['add'])){\n  $vidid=mysql_real_escape_string(strip_tags($_POST['vidid']));\n\n  $url = \"$vidid\";\n  parse_str( parse_url( $url, PHP_URL_QUERY ), $my_array_of_vars);\n  $t1=mysql_real_escape_string(strip_tags($_POST['tit1']));\n  $title=\"$t1\";\n  parse_str( $title, $my_vars );\n  mysql_query(\"INSERT INTO `videos` (`id`, `videoid`, `views`, `title`) VALUES ('',                         '\".$my_array_of_vars['v'].\"', '0', '\".$my_vars['v'].\"');\") or die (mysql_error());\n  $message=\"&lt;img src=\\\"../img/tick-icon.jpg\\\"&gt;\";\n  }\n  if (strip_tags($_POST['rem'])){\n  $vidid2=mysql_real_escape_string(strip_tags($_POST['vidid2']));\n\n  $url = \"$vidid2\";\n  parse_str( parse_url( $url, PHP_URL_QUERY ), $my_array_of_vars );\n\n  mysql_query(\"DELETE FROM videos WHERE id=\".$my_array_of_vars['v'].\"\");\n\n  $message2=\"&lt;img src=\\\"../img/tick-icon.jpg\\\"&gt;\";\n  }\n  ?&gt;\n\n  &lt;div align=\"center\"&gt;&lt;form id=\"form1\" method=\"post\" action=\"\"&gt;\n  Youtube URL: &lt;input type=\"text\" name=\"vidid\" id=\"vidid\"&gt;\n  Title: &lt;input type=\"text\" name=\"tit1\" id=\"tit1\"&gt;\n  &lt;input name='add' type='submit' id='add' value='Add Video' /&gt; &lt;? echo\"$message\";?&gt;                        \n\n  Website URL: &lt;input type=\"text\" name=\"vidid2\" id=\"vidid2\"&gt;\n  &lt;input name='rem' type='submit' id='rem' value='Remove Video' /&gt; &lt;? echo\"$message2\";?  \n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13168483,"title":"How to select more rows from subquery","body":"<p>When I'm trying to run this query:</p>\n\n<pre><code> select * FROM `activity` \n WHERE user_id = 1\n AND activity_id NOT LIKE (select activity_id from activity where user_id = 1 ORDER BY activity_id DESC LIMIT 8)\n</code></pre>\n\n<p>I get the follow error:</p>\n\n<pre><code> Subquery returns more than 1 row\n</code></pre>\n\n<p>How can I solve this problem? I want to select the activity_id from the table excluding the latest 8 activity_id's for a certain user.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":13182272,"title":"PHP and MySQL Runs twice but only echos once","body":"<p>I'm troubleshooting a problem on my site and I have narrowed it down to the php being run twice. I assume this means the page is loaded twice but the catch is that the code is only echoed or printed once. I figured this out using ChromePHP to log some text. That text prints in the console twice every now and again.</p>\n\n<p>The main issue is that I'm making a mysql query and setting a variable. In an example. It prints the ID number it gets as 2, but then the code randomly loads again and that variable is now set to something else... lets say 15 or whatever. But visually the echoed variable is still 2. </p>\n\n<pre><code>include 'php/classes/ChromePhp.php';\n$link = mysqli_connect($host, $dbuser, $dbpass, $dbname );\n\nif (mysqli_connect_errno()) {\n    printf(\"Connect failed: %s\\n\", mysqli_connect_error());\n    exit();\n}\n\nif ($result = mysqli_query($link,'SELECT questionID FROM questions order by rand() limit 1')) {\n    $row = mysqli_fetch_array($result);\n    printf(\"Question \", $row['questionID']);\n    mysqli_free_result($result);\n    ChromePhp::log('QUESTIONID '.$row['questionID']);\n}       \nif($link) \n    mysqli_close($link);\n?&gt;\n</code></pre>\n\n<p>I've looked around and people say it could be the favicon being loaded separately or the .htaccess redirect which I use. I took the .htaccess off and I still have this issue.</p>\n\n<p>Any pointers to a direction would be nice.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13192736,"title":"writing a Select query to deduct one table from another","body":"<p>I am just a little confuse to how write the below query :</p>\n\n<p>I have two tables</p>\n\n<pre><code>tbl_one\nID      TEXT\n1       test1\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tbl_two\nID      userID      tblone_ID\n1       50          1\n2       100         1\n3       100         2\n</code></pre>\n\n<p>I am looking to get rows of tbl_one which are not appear in tbl_two but for the certain user .</p>\n\n<p>for example by below select  :</p>\n\n<pre><code>select * from tbl_one, tbl_two \nwhere (tbl_two.tblone_ID !=tbl_one.ID and tbl_two.userID==50) \n</code></pre>\n\n<p>my desire resault will be </p>\n\n<pre><code>Desire resalt:\nID      TEXT\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13189390,"title":"Rails select and sort by aggregate of has_many","body":"<p>I have a Course model which has_many reviews. My Review model has a rating field. What I would like is a query to find the top rated courses. I want to do this in the SQL in order to avoid returning all the course objects and then trying to rank and sort them.</p>\n"},{"tags":["mysql","sql","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13195501,"title":"mySQL query using two tables","body":"<p>I have one table (config) with the field 'type' in and another table (users) with the field 'status' in.</p>\n\n<p>Some values for the field 'status' are blank.</p>\n\n<p>I want to change the field 'status' to 'applied' ONLY if the field 'type' in the other table equals '3'.</p>\n\n<p>Can you please explain how to do this query?</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13191768,"title":"How to make two records from one?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning, and so on\n1   2012-01-01          2               3   \n2   2012-01-01          2               2 \n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning\n1   2012-01-01          2               NULL          2\n1   2012-01-01          NULL            3             2\n2   2012-01-01          2               2 \n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["performance","query","postgresql","index"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13183735,"title":"Query performance in PostgreSQL using 'similar to'","body":"<p>I need to retrieve certain rows from a table depending on certain values in a specific column, named <strong>columnX</strong> in the example:</p>\n\n<pre><code>select *\nfrom tableName \nwhere columnX similar to ('%A%|%B%|%C%|%1%|%2%|%3%')\n</code></pre>\n\n<p>So if <strong>columnX</strong> contains at least one of the values specified (A, B, C, 1, 2, 3), I will keep the row.  </p>\n\n<p>I can't find a better approach than using <strong>similar to</strong>.  The problem is that the query takes too long for a table with more than a million rows.</p>\n\n<p>I've tried indexing it:</p>\n\n<pre><code>create index tableName_columnX_idx on tableName (columnX) \nwhere columnX similar to ('%A%|%B%|%C%|%1%|%2%|%3%')\n</code></pre>\n\n<p>However, if the condition is variable (the values could be other than A, B, C, 1, 2, 3), I would need a different index for each condition.</p>\n\n<p>Is there any better solution for this problem?</p>\n\n<p>EDIT: Thanks everybody for the feedback.  Looks like I've achieved to this point maybe because of a design mistake (topic I've posted in a <a href=\"http://stackoverflow.com/questions/13194906/data-structure-design-for-database-replication-support\">separated question</a>).</p>\n"},{"tags":["query","tfs","items"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13162705,"title":"How to run a work items query for/on previous state of closed item in TFS","body":"<p>I just want to run a query in TFS, to get a list of work items which are currently in closed state. where the condition is  &amp; . </p>\n\n<p>Eg: If item A is finished coding and been assigned to person X for review with 'In code Review' as state, and later the item A went through all the states and is closed.</p>\n\n<p>so , now can I run a TFS query to get the list of closed items like A which were reviewed by person X?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":8038,"score":3,"question_id":1783784,"title":"SQL Delete Rows Based on Another Table","body":"<p>This is probably very easy, but it's Monday morning.  I have two tables:</p>\n\n<p>Table1:</p>\n\n<pre><code>Field        | Type             | Null | Key | Default | Extra\nid           | int(32) unsigned | NO   | PRI | NULL    | auto_increment\ngroup        | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>Field     | Type             | Null | Key | Default | Extra\ngroup     | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Ignoring other fields...I would like a single SQL DELETE statement that will delete all rows in Table1 for which there exists a Table2.group equal to Table1.group. Thus, if a row of Table1 has group=69, that row should be deleted if and only if there exists a row in Table2 with group=69.</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["sql","sql-server","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13008116,"title":"routing network function issue","body":"<p>Following on from a <a href=\"http://stackoverflow.com/q/12990638/398670\">this question</a>, I have some dynamic SQL I'm running successfully in PL/PgSQL with <code>EXECUTE</code>, but it doesn't seem to have the intended effect.</p>\n\n<p>The following code is part of a plpgsql function that I have created. This intends to go to each point that is lying on the same track and for each point find its nearest point in order to eventually I will create a network between all the tracks. For some reson it is not working properly.</p>\n\n<p>The i represent the number of the current track.</p>\n\n<pre><code> DECLARE\n    _r record;\n    i int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\nBEGIN\n\nWHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\nLOOP\n\nFOR _r IN EXECUTE ' SELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft'\n|| ' FROM ' || quote_ident (geom_table) ||' AS a INNER JOIN ' || quote_ident(geom_table) || ' As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY dist_ft '\n|| ' Limit 1 '\n\nLOOP\n\nsource_geom := _r.source;\ntarget_geom := _r.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = ''' || source_geom ||''' \n    , target = ''' || target_geom || ''' \n    WHERE ' || quote_ident(gid_cname) || ' =  ' || _r.id;\nEND LOOP;\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n\n<p>The thing is that I have tested the query in plain sql and it worked brilliantly. Now for some reason in plpgsql it is not working properly. Below you can find the same query in plain sql. </p>\n\n<pre><code>SELECT a.ogc_fid AS id, st_astext( a.wkb_geometry) AS source, st_astext(b.wkb_geometry) AS target, ST_Distance(a.wkb_geometry, b.wkb_geometry) As dist_ft\nFROM track_points AS a INNER JOIN track_points As b\nON ST_DWithin(a.wkb_geometry , b.wkb_geometry, 1000)\nWHERE b.ogc_fid &gt; a.ogc_fid AND b.track_fid = 0 AND a.track_fid = 0 \norder by dist_ft\n</code></pre>\n"},{"tags":["java","mysql","query","hql","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13193062,"title":"Strange mysql retrieve with hibernate criteria","body":"<p>In a web-service i have the following function which retreives some infos of a doctor and his patient based on patient's phone:</p>\n\n<pre><code>    public String findDoctorOfPatient(String phone) {\n    AnnotationConfiguration config = new AnnotationConfiguration();\n    config.configure(\"hibernate.cfg.xml\");\n    SessionFactory factory = config.buildSessionFactory();\n    Session session = factory.openSession();\n\n    session.beginTransaction();\n\n    Criteria query = session.createCriteria(doctor.class);\n    query.createCriteria(\"patients\", \"p\");\n    query.add(Restrictions.eq(\"p.phone\", phone));\n    List&lt;doctor&gt; doctorList = (ArrayList&lt;doctor&gt;) query.list();\n    session.getTransaction().commit();\n    String answear = \"\";\n    for (doctor d : doctorList) {\n        answear = answear.concat(\"docPhone\" + d.getPhone() + \"docEmail\"\n                + d.getEmail() + \"patDia\"\n                + d.getPatients().iterator().next().getDiastolic()\n                + \"patSys\"\n                + d.getPatients().iterator().next().getSystolic());\n    }\n    if (doctorList.isEmpty()) {\n        session.close();\n        factory.close();\n        return \"No Doctor!\";\n    } else {\n        session.close();\n        factory.close();\n        return answear;\n    }\n}\n</code></pre>\n\n<p>The problem is when i have one patient is ok , but when i add second patient it gives me the details of last patient despite i have set to criteria tha firt's patient phone!</p>\n\n<p>I have 2 tables:</p>\n\n<p>1.doctor(id,username,password,phone,email)\n2.patient(id,name,surname,phone,systolic,diastolic,doctorid(FK refers to doctor.id))</p>\n\n<p>I have configured properly the hibernate.cfg.xml.</p>\n\n<p>And i have set the class for doctor and patient:</p>\n\n<pre><code>@Entity\npublic class doctor {\n    @Id\n    private int id;\n    private String username;\n    private String password;\n    private String phone;\n    private String email;\n\n    @OneToMany(targetEntity = patient.class, cascade = CascadeType.ALL, mappedBy = \"doctor\")\n    @Cascade(value = org.hibernate.annotations.CascadeType.ALL)\n    private Collection&lt;patient&gt; patients = new ArrayList&lt;patient&gt;();\n\n    public Collection&lt;patient&gt; getPatients() {\n        return patients;\n    }\n\n    public void setPatients(Collection&lt;patient&gt; patients) {\n        this.patients = patients;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getPhone() {\n        return phone;\n    }\n\n    public void setPhone(String phone) {\n        this.phone = phone;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@Entity\npublic class patient {\n    @Id\n    private int id;\n    private String name;\n    private String surname;\n    private String phone;\n    private int systolic;\n    private int diastolic;\n\n    @ManyToOne\n    private doctor doctor;\n\n    public doctor getDoctor() {\n        return doctor;\n    }\n\n    public void setDoctor(doctor doctor) {\n        this.doctor = doctor;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getSurname() {\n        return surname;\n    }\n\n    public void setSurname(String surname) {\n        this.surname = surname;\n    }\n\n    public String getPhone() {\n        return phone;\n    }\n\n    public void setPhone(String phone) {\n        this.phone = phone;\n    }\n\n    public int getSystolic() {\n        return systolic;\n    }\n\n    public void setSystolic(int systolic) {\n        this.systolic = systolic;\n    }\n\n    public int getDiastolic() {\n        return diastolic;\n    }\n\n    public void setDiastolic(int diastolic) {\n        this.diastolic = diastolic;\n    }\n}\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/6YaGX.png\" alt=\"doctor\">\n<img src=\"http://i.stack.imgur.com/EH4Ii.png\" alt=\"patient\">\n<img src=\"http://i.stack.imgur.com/q19yD.png\" alt=\"patientRelationView![][3]\"></p>\n\n<p>In this web-service the response is always the same (given 6940861374 or 6981938435).\nIt gives me always the patSys=130 and patDia=80 which are the second's patient info!(dimitrios oikonomopoulos).Something must be wrong in the webservice but to me all seems ok!</p>\n"},{"tags":["mysql","sql","query","zend-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1046,"score":0,"question_id":6096147,"title":"zend framework insert() and LAST_INSERT_ID() screw up","body":"<p>so I tried to use Zend_Db_Adapter_Pdo_Mysql's insert() method....</p>\n\n<p>and then after that I issued the <code>SELECT LAST_INSERT_ID();</code> command....</p>\n\n<p>but then for some reason, that command always return 0 rather than the actual inserted ID...</p>\n\n<p>when I tried to use normal INSERT query, and then get the last insert id, it works just fine so I guess it's some zend framework screw up...</p>\n\n<p>does anybody know how to get around this? </p>\n\n<p>the insert() method only returns 1 if it succeeds rather than the id, so the solution for this: <a href=\"http://stackoverflow.com/questions/4842064/last-insert-id-with-zend-db-table-abstract\">last insert id with zend db table abstract</a>  doesn't seem to work </p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13192379,"title":"Convert unconventional string to mysql datetime in MySQL","body":"<p>I want to convert a field that represents a date-time but is currently a VARCHAR to a DATETIME field.\nCurrently the representation looks like: 'Sun May 20 01:04:39 +0000 2012'\nI want to do this operation in a query.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13192092,"title":"SQL Server : convert char to float and round it","body":"<p>I have a database with a column of <code>VARCHAR2</code> type keeping a value like: <code>398566,569885</code></p>\n\n<p>What I need is to cast this number to float and then to make it looking like: <code>398566,56</code>\nCasting it to float is <strong>not</strong> so important, if It's possible to trim the numbers it will be also ok.</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>select\ncast (p1.VALUE as float) as Total\nfrom Workflow p\nLEFT JOIN PA_PARAMETER p1 on p1.ID=p.ID AND p1.NAME = 'Total'\nWHERE p.TYPE = 'Marketing'\n</code></pre>\n\n<p>Is there a way to trim these numbers or to round it somehow?</p>\n"},{"tags":["query","gallery","cycle","numeric","pager"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13192189,"title":"Jquery Cycle plugin gallery counter use 0# of 0# images?","body":"<p>I'm using a counter on my website with the Jquery Cycle plugin. I would like to add 0's to the beginning of the numbers. Is there anyway to modify my code to achieve this?</p>\n\n<p>I'm not sure if I'm asking clearly but I want to go from this:</p>\n\n<p>&lt; 2 / 7 ></p>\n\n<p>to this:</p>\n\n<p>&lt; 02 / 07 ></p>\n\n<p>here is my code:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function(){ \n    $('#image').cycle({\n        fx:'fade', \n        speed:'300', \n        timeout: 0, \n        next:'.next',\n        prev:'.prev',\n        after: onAfter\n    });\n});\n\nfunction onAfter(curr,next,opts) {\n    var counter = (opts.currSlide + 1) + ' / ' + opts.slideCount;\n    $('.counter').html(counter);\n}\n&lt;/script&gt;\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13191127,"title":"SQL Query for Count value from the latest date","body":"<p>I need to have a query that returns the ff:</p>\n\n<ol>\n<li>Count from the latest Date in each Name</li>\n<li>If the value of Count from the latest Date is -1 then it will return the count of the Date before the latest Date</li>\n<li>If the value of Count from the latest Date is -1 and the other Date is -1. Then return 0</li>\n<li>If the value of Count from the latest Date is -1 and no other Date of that Name. Then return 0</li>\n</ol>\n\n<p>Example Table:</p>\n\n<pre><code>ID  Name  Date         Count\n1   Adj   09/29/2012   2\n2   Adj   09/30/2012   4\n3   Ped   09/29/2012  -1\n4   Ped   09/30/2012   5\n5   Mel   09/29/2012   3\n6   Mel   09/30/2012  -1\n7   Rod   09/30/2012   7\n8   Ney   09/30/2012  -1\n9   Jin   09/29/2012  -1\n10  Jin   09/30/2012  -1\n</code></pre>\n\n<p>Desired Output:</p>\n\n<pre><code>Name   Count\nAdj    4\nPed    5\nMel    3\nRod    7\nNey    0\nJin    0\n</code></pre>\n\n<p>I am very confused on how to approach this in SQL since I only knew simple query.</p>\n\n<p>Any idea on how to make a query for this? Thanks.</p>\n\n<p>Btw, I'm sorry I forgot to include this. I am using SQL Server 2000.</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13191522,"title":"SQL Server: rows to columns","body":"<p>sample datas</p>\n\n<pre><code> date     | num | name | value\n 01012012 |  1  |    A |  20\n 01012012 |  1  |    B |  30\n 01012012 |  2  |    C |  40\n</code></pre>\n\n<p>wish to  like this</p>\n\n<pre><code> date     | num |  A |  B |  C\n 01012012 |   1 | 20 | 30 | --\n 01012012 |   2 | -- | -- | 40\n</code></pre>\n\n<ul>\n<li>name is not fixed can allow many names</li>\n</ul>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13190731,"title":"Get the subtraction of two scores from two tables for several usres. Mysql","body":"<p>I need to access several tables, actually they are the same table but older versions, and get the max of subtracted score from both tables for each manager. </p>\n\n<p>let's say we tables r6 and r10 that have a field called scores. </p>\n\n<p>I need to get the scores from the two tables and subtract the new score (from latest table) form the old one (in an older table) to get the managers score for between period. </p>\n\n<p>let's say table r6 has score = 1 for manager A, and table r10 has score = 5 for manager A. So for manager A the yield score is 5-1 = 4. Which is basically (r10.scores - r6.scores) which will be totalScore. </p>\n\n<p>Now i need to get that totalScore (the score from 10-6) for all managers A-Z and also be able to find the highest one as well. </p>\n\n<p>The question is, how to achieve that in mysql, if not possible, what do u suggest? I am using php btw. </p>\n\n<p>Addition info: </p>\n\n<p>Table's Names:</p>\n\n<pre><code>1- ranking_gw6_260912 AS r6\n2- ranking_gw10_201012 AS r10 \n</code></pre>\n\n<p>Used Fields: </p>\n\n<pre><code>1- rx.manager_id\n2- rx.scores\n</code></pre>\n\n<p>These fields exist in both tables. </p>\n\n<p>n.b gw refers to game weeks of football matches, The website is for fantasy football and I am trying to get the winner of the contest who has the highest score from game week 6 to game week 10. Sadly, the database only stores the latest score overriding the on for the previous week. so I cannot get each week score and thus I am left with the overall score. Yet, we have a backup tables for each week that I will be using to get the between score. </p>\n"},{"tags":["sql","database","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":13190155,"title":"join tables sql","body":"<p>I have the following tables \n<img src=\"http://i.stack.imgur.com/gJCad.png\" alt=\"enter image description here\">\nDishes table:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ex0ps.png\" alt=\"enter image description here\"></p>\n\n<p>Category table:\n<img src=\"http://i.stack.imgur.com/NWNAO.png\" alt=\"enter image description here\"></p>\n\n<p>t_time table:\n<img src=\"http://i.stack.imgur.com/gMPGU.png\" alt=\"enter image description here\"></p>\n\n<p>To get connect a dish with the ingredients I have the following code which works:</p>\n\n<pre><code>$sql = \"SELECT d.name, i.item\\n\"\n    . \"FROM dish d\\n\"\n    . \"JOIN dish_ingredients di ON ( d.id = di.dish_id )\\n\"\n    . \"JOIN ingredients i ON ( di.ingredient_id = i.id )\\n\"\n    . \"WHERE d.id =1\\n\"\n    . \"LIMIT 0 , 30\";\n</code></pre>\n\n<p>but now I want to connect the dish with the matching <code>categories</code>/<code>t_time</code> and <code>cuisine</code> . instead of having time= 6 and Category 3 being displayed when I do the query I want it to display 60 and fish instead. What would be the easiest way to do this?  a good tutorial might help as well. </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":12984497,"title":"Single Row Friendship Database Schema with getting userid from one column or the other","body":"<p>I need help querying the friendID from a table.\nMy table stores the user id of two members who are friends together.</p>\n\n<p>But in order to store a \"friendhship\" b/w two members I would have to store two records like this:</p>\n\n<pre><code>friendshipID |  userID  |  friendID  \n1            |  5       |  10\n2            |  10      |   5\n</code></pre>\n\n<p>Yet, that seems heavy for the DB when we really only need to store the first record as that is sufficient as it contains both ids of both members.</p>\n\n<p>However, the trouble comes when I want to query the records of the friends of ID=5.  Sometimes the ID is in the userID column and other times it is in the friendID column.</p>\n\n<p>This is the query I am using:</p>\n\n<pre><code>SELECT *\nFROM friends\nWHERE userID = '5'\n   OR friendID = '5'\n</code></pre>\n\n<p>But what I want to do is something like this</p>\n\n<pre><code>SELECT \nif $userID=5 then userID as myfriend\nelse friendID=5 then friendID as myfriend\nFROM friends WHERE userID='5' OR myfriendID='5'\n</code></pre>\n\n<p>Hope that makes sense.  In the end I would like to have all the friends ID's of member #5 and not bring up results with #5 as the friend or user....but just his friends.</p>\n"},{"tags":["asp.net","linq","web-services","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13177023,"title":"Selected value from dropdownlist has to be tablename from linq query","body":"<p>I have a problem with my linq query. I want a search field (textbox) with a dropdownlist next to it. When i set the dropdownlist on \"ProductID\" he has to search only in the table \"ProductID\", And when i put it on \"Productinformation\", he has to search in the table \"productinformation\", i hope somebody understand this?</p>\n\n<p>So what i want is the following query:</p>\n\n<pre><code>    var textboxvalue = TextBox1.Text;\n            var dropdownsearch = DropDownList1.SelectedValue;    \n\nvar Metadata = from m in db.Metadatas\n                               join mm in db.Multimedias\n                               on m.multimediaID equals mm.multimediaID\n                               where (m. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue) ||\n                                      mm. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue))\n\n\n                               select new\n                               {\n                                   mm.ProductID,\n                                   mm.filename,\n                                   mm.filetype,\n                                   mm.filesize\n                               };\n</code></pre>\n\n<p>So, how can i get the selected value from the dropdownlist, as a table in the query? Normally you would put m.ProductID into the query, but i want the Selected value in it, something like <code>m.(Dropdownlist1.Selectedvalue)</code>... or <code>m.dropdownsearch</code>..\nIs that possible? And how?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13188603,"title":"can't specify target table for UPDATE in FROM clause","body":"<p>I am trying to execute the following query:</p>\n\n<pre><code>update table3 d set status = 'Complete'\nwhere d.id in \n(\n    select b.id from table1 a, table3 b, table2 c\n    where a.id = b.table1_id\n    and c.id = b.table2_id\n    and c.examId = 16637                 -- will be passed in by user\n    and a.id in (46,47,48,49)            -- will be passed in by user\n);\n</code></pre>\n\n<p>So, I'm trying to update multiple rows of <code>table3</code>. </p>\n\n<p><code>table3</code> is a join table between <code>table1</code> and <code>table2</code>. </p>\n"},{"tags":["query","sql-server-2008-r2","colon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13188471,"title":"SQL purpose of colon","body":"<p>My colleague wrote this SQL statement and I had a hard time understanding it. What exactly is the purpose of using colon in the where clause?</p>\n\n<pre><code>WHERE MGM_YYMM like :AS_YYMM\n</code></pre>\n\n<p>Full Query:</p>\n\n<pre><code>SELECT  A.MGM_YYMM,\n        A.MGM_DATE,\n        A.MGM_GB,\n        A.INDATE,\n        A.SUDATE,\n        A.EMPNUM,\nFROM  SE_MAGAM A(NOLOCK)\nWHERE MGM_YYMM like :AS_YYMM\nORDER BY MGM_YYMM DESC\n</code></pre>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":13163057,"title":"PostgreSQL - select only when specific multiple apperance in column","body":"<p>I'm using PostgreSQL.\nI have a table with 3 fields\nperson, recipe and ingredient</p>\n\n<pre><code>person = creator of the recipe\nrecipe = the recipe\ningredient = one of the ingredients in the recipe\n</code></pre>\n\n<p>I want to create a query which results in every person who whenever has added carrot to a recipe, the person must also have added salt to the same recipe.</p>\n\n<p>More than one person can have created the recipe, in which case the person who added the ingredient will be credited for adding the ingredient. Sometimes the ingredient is used more than once, even by the same person.</p>\n\n<p>If this the table:</p>\n\n<pre><code>person1, rec1, carrot\nperson1, rec1, salt\nperson1, rec1, salt\nperson1, rec2, salt\nperson1, rec2, pepper\nperson2, rec1, carrot\nperson2, rec1, salt\nperson2, rec2, carrot\nperson2, rec2, pepper\nperson3, rec1, sugar\nperson3, rec1, carrot\n</code></pre>\n\n<p>Then I want this result:\nperson1</p>\n\n<p>Because this person is the only one who whenever has added carrot also have added salt.</p>\n\n<p>\"Nothing but the carrot could affect the result. I only want persons who has added at least one carrot in one of their recipes, but I don't want persons who have not also added salt to all of the same recipes they've added carrot to. Sorry, but I just can't explain it any clearer than that.\"</p>\n"},{"tags":["php","mysql","forms","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13180011,"title":"PHP Variables disappearing","body":"<pre><code>    echo $t1, $t2, $t3, $t4, $uid;\n$querytotal = \"update customer_det set `t1` = $t1, `t2` = $t2, `t3` = $t3, `t4` = $t4 WHERE `id` = $uid \"; \necho $querytotal;\n</code></pre>\n\n<p>So I echo the variables, and I see them fine.  When I go to do the update statement and echo the statement afterwards, it drops all the variables.  I have no idea how that's even possible.  Mysql_error: ...for the right syntax to use near ' <code>t2</code> = , <code>t3</code> = , <code>t4</code> = WHERE <code>id</code> =' at line 1.  So it's skipping error on t1, but then kicks out at t2?  Is there something i'm missing here?</p>\n\n<p>Here's the echo'd query before it's ran <code>update customer_det set</code>t1<code>= '215',</code>t2<code>= '240',</code>t3<code>= '265',</code>t4<code>= '300' WHERE</code>id<code>= '273'</code></p>\n\n<p>and after <code>update customer_det set</code>t1<code>= '',</code>t2<code>= '',</code>t3<code>= '',</code>t4<code>= '' WHERE</code>id<code>= ''</code></p>\n"},{"tags":["mysql","sql","database","query","query-optimization"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13080770,"title":"mysql query optimization","body":"<p>I got tasked to help speed up this query and I think some of the indexes on these tables are not setup properly.  I also believe they're not all going to be used b/c a function is applied to the col that I have an index on. can anyone see how I can optimize these tables or query?   The <code>requests</code> table will be the largest table of the 3 and will have upwards of 200k+ records. <code>devices</code> currently is sitting ~500 records and <code>clients</code> will be smaller as well.</p>\n\n<p>Query:</p>\n\n<pre><code>explain extended SELECT MAX(Request.datetime) AS datetime, Device.id,\n       Device.client_id, Device.mac_address, Device.type, Device.manufacturer,\n       Device.model_number, Client.id, Client.email_address,\n       Request.device_id, Request.datetime, Request.ip_address\n  FROM livefi.devices AS Device\n  LEFT JOIN livefi.clients AS Client\n    ON (Client.id         = Device.client_id)\n INNER JOIN livefi.requests AS Request\n    ON (Request.device_id = Device.id)\n GROUP BY Request.device_id, Request.client_id\n\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n| id | select_type | table   | type   | possible_keys                                           | key           | key_len | ref                     | rows | filtered | Extra                           |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n|  1 | SIMPLE      | Device  | ALL    | PRIMARY                                                 | NULL          | NULL    | NULL                    |  617 |   100.00 | Using temporary; Using filesort |\n|  1 | SIMPLE      | Client  | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | livefi.Device.client_id |    1 |   100.00 |                                 |\n|  1 | SIMPLE      | Request | ref    | idx_device_id,inx_requests_deviceId_datetime_ip_address | idx_device_id | 5       | livefi.Device.id        |  144 |   100.00 | Using where                     |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n3 rows in set, 1 warning (0.04 sec)\n</code></pre>\n\n<p>Tables:</p>\n\n<pre><code>CREATE TABLE `clients` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `email_address` varchar(100) DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `email_address` (`email_address`),\n  KEY `idx_mac_address` (`mac_address`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `devices` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  `type` varchar(25) DEFAULT NULL,\n  `manufacturer` varchar(100) DEFAULT NULL,\n  `model_number` varchar(50) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `mac_address` (`mac_address`),\n  KEY `idx_mac_address` (`mac_address`),\n  KEY `fk_devices_clients1` (`client_id`),\n  CONSTRAINT `fk_devices_clients1` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=492 DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `requests` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `device_id` int(10) unsigned DEFAULT NULL,\n  `domain_id` int(10) unsigned DEFAULT NULL,\n  `ip_address` varchar(15) DEFAULT NULL,\n  `datetime` datetime DEFAULT NULL,\n  `gmt_offset` time DEFAULT NULL,\n  `request_method` varchar(15) DEFAULT NULL,\n  `url` text,\n  `http_protocol` varchar(20) DEFAULT NULL,\n  `http_status_code` varchar(20) DEFAULT NULL,\n  `request_size` int(10) unsigned DEFAULT '0',\n  `referer` text,\n  `user_agent` text,\n  `squid_cache_response` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `idx_client_id` (`client_id`),\n  KEY `idx_datetime` (`datetime`),\n  KEY `idx_device_id` (`device_id`),\n  KEY `idx_domain_id` (`domain_id`),\n  KEY `idx_id` (`id`),\n  KEY `idx_request_size` (`request_size`),\n  KEY `inx_requests_deviceId_datetime_ip_address` (`device_id`,`datetime`,`ip_address`),\n  CONSTRAINT `fk_requests_clients` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_devices1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_domains1` FOREIGN KEY (`domain_id`) REFERENCES `domains` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=200523 DEFAULT CHARSET=utf8\n</code></pre>\n"},{"tags":["sql","sql-server","query","datediff"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13185869,"title":"SQL query to get DateDiff of the last two records","body":"<p>I have a table called Event with eventNum as the primary key and date as a datetime2(7) in SQL Server 2008 R2.  I am trying to get the date of the last two rows in the table and get the difference in minutes. This is what I currently have:</p>\n\n<pre><code>Select DATEDIFF(MI, e.date,(Select e2.date from Event e2 where eventNum = (Select MAX(e2.eventNum))))\n    From Event e\n    Where eventNum = (Select MAX(e.eventNum)-1 from e)\n</code></pre>\n\n<p>and I get this error:</p>\n\n<blockquote>\n  <p>Invalid column name 'Select eventNum from Event Where eventNum =\n  Select MAX(eventNum) from Event'.</p>\n</blockquote>\n\n<p>I've changed this 100 times and can't get it to work. Any help? </p>\n"},{"tags":["sql","query","postgresql","distinct","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":13183817,"title":"Distinctly sum a column on a joined table?","body":"<p>This is a simple problem, and I'm not sure if its possible here. Here's the problem:</p>\n\n<p>=> <a href=\"http://sqlfiddle.com/#!12/584f1/7\" rel=\"nofollow\">http://sqlfiddle.com/#!12/584f1/7</a></p>\n\n<p>Explanation:</p>\n\n<ul>\n<li>A ticket belongs to an attendee</li>\n<li>An attendee has a revenue</li>\n<li>I need to group the tickets by section and get the total revenue.</li>\n<li>This double counts attendees because 2 tickets can belong to the same attendee, thus double counting it. I'd like to grab the sum of the revenue, but only count the attendees once.</li>\n</ul>\n\n<p>In my sqlfiddle example, I'd like to see:</p>\n\n<pre><code>section | total_revenue\n------------------------\nA       | 40            &lt;= 40 is correct, but I'm getting 50...\nB       | null\nC       | 40\n</code></pre>\n\n<p><em><strong>I'd like to solve this without the use of sub queries. I need a scalable solution that will allow me to do this for multiple columns on different joins in a single query. So whatever allows me to accomplish this, I'm open to suggestions.</em></strong></p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["php","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":215,"score":1,"question_id":586031,"title":"mssql_query accent","body":"<p>I hava  a problem with this mssql_query in PHP :</p>\n\n<pre><code>$query = 'SELECT Ville FROM tblLstManufacturiers where province = \"Québec\"';\n</code></pre>\n\n<p>The result is empty because I have an accent in Québec</p>\n\n<p>How can I do this?</p>\n"},{"tags":["mysql","sql","query","postgresql","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13184804,"title":"Setting defaults for empty fields returned in select","body":"<p>Given two tables:</p>\n\n<pre><code>image(id, cat_id, name)\nimage_translation(id, title, desc, lang)\n</code></pre>\n\n<p>(names and ids are unique)</p>\n\n<p>Query to select all translations for the particular file:</p>\n\n<pre><code>SELECT c.id           AS c__id, \n       c.cat_id       AS c__cat_id, \n       c.name         AS c__name, \n       c2.id          AS c2__id, \n       c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>c__id | c__cat_id  | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n------+------------+-----------+-----------+---------------+--------------+--------- \n114   | 2          | 114       | file.jpg  | default title | default desc | en\n114   | 2          | 114       | file.jpg  | NULL          | desc in de   | de\n114   | 2          | 114       | file.jpg  | title in fr   | ''           | fr\n</code></pre>\n\n<p>To select the translation for the particular file in particular language,\nobviously I need to add the where clause.</p>\n\n<p>But then it returns the default row content, which may contain empty fields in translation.</p>\n\n<p><strong>How can I merge the result with the default values and overwrite the empy fields with the default ones?</strong> The default values are returned for lang <em>en</em>:</p>\n\n<pre><code>SELECT c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \nAND WHERE ( c2.lang = 'en')\n</code></pre>\n\n<p>Sample results I expect:</p>\n\n<p>for german language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'de' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | default title | desc in de   | de\n</code></pre>\n\n<p>for french language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'fr' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | title in fr   | default desc | fr\n</code></pre>\n\n<p><strong>How to do it right in one smart query?</strong></p>\n\n<p>(I use MySQL and Doctrine ORM with I18N behavior)</p>\n"},{"tags":["mysql","database","query","join","inner-join"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13184949,"title":"Join columns from multiple tables","body":"<p>Below is part of a database that I need help with.</p>\n\n<pre><code>DROP DATABASE IF EXISTS bookex;\nCREATE DATABASE bookex;\nuse Bookex;\n\n\nCREATE TABLE Reviewer(\n   ReviewerID INT,\n   Name VARCHAR(20) NOT NULL,\n   EmployedBy CHAR(30),\n   constraint reviewer_reviewerID_pk PRIMARY KEY (reviewerID)\n);\n\nCREATE TABLE Book(\n   ISBN        CHAR(13),\n   Title       VARCHAR(70) NOT NULL,\n   Description VARCHAR(100),\n   Category    INT,\n   Edition     CHAR(30),\n   PublisherID INT         NOT NULL,\n   constraint book_ISBN_pk PRIMARY KEY (ISBN)\n);\n\nCREATE TABLE BookReview(\n   ISBN CHAR(13) NOT NULL,\n   ReviewerID INT NOT NULL,\n   Rating INT,\n   Comments VARCHAR(255),\n   constraint bookreview_pk PRIMARY KEY (ISBN, ReviewerID),\n   constraint bookreview_ISBN_fk FOREIGN KEY (ISBN) REFERENCES Book(ISBN),\n   constraint bookreview_reviewerID_fk FOREIGN KEY (ReviewerID) REFERENCES Reviewer(ReviewerID)\n);\n\n\n--\n-- Dumping data for table 'reviewer'\n--\n\nINSERT INTO reviewer VALUES (1,'Jacobs','Gadget Boy');\nINSERT INTO reviewer VALUES (2,'Troell','Dallas Underground');\nINSERT INTO reviewer VALUES (3,'Bills','The RIT Reporter');\nINSERT INTO reviewer VALUES (4,'Hill','Microsoft News');\nINSERT INTO reviewer VALUES (5,'Kurtz','MacIntosh News');\nINSERT INTO reviewer VALUES (6,'Leone',null);\nINSERT INTO reviewer VALUES (7,'Doubleday','Media Mania');\nINSERT INTO reviewer VALUES (8,'Wells','The RIT Reporter');\nINSERT INTO reviewer VALUES (9,'Worthington','The Annex');\nINSERT INTO reviewer VALUES (10,'Lawson','The Last Word');\nINSERT INTO reviewer VALUES (11,'Lasky',null);\nINSERT INTO reviewer VALUES (12,'Rozanski',null);\nINSERT INTO reviewer VALUES (13,'Whittington','JAVA Rocks');\nINSERT INTO reviewer VALUES (14,'Holden',null);\nINSERT INTO reviewer VALUES (15,'Stratton','Harvard Lampoon');\nINSERT INTO reviewer VALUES (16,'Johnson','NRA Weekly');\nINSERT INTO reviewer VALUES (17,'Mason','BMW Owners Quarterly');\nINSERT INTO reviewer VALUES (18,'Goodman','MacIntosh News');\nINSERT INTO reviewer VALUES (19,'Phelps','Detroit News');\nINSERT INTO reviewer VALUES (20,'Yacci','The Learning Channel');\nINSERT INTO reviewer VALUES (24,'Weeden','Scrye');\nINSERT INTO reviewer VALUES (25,'McVea','Programming Central');\nINSERT INTO reviewer VALUES (26,'Perez-Hardy','The Network Voice');\nINSERT INTO reviewer VALUES (27,'Heartthrob','Journal of Romance');\nINSERT INTO reviewer VALUES (28,'Bierre','JAVA Rocks');\nINSERT INTO reviewer VALUES (29,'Axelrod','JAVA Rocks');\n\n\n-- Dumping data for table 'book'\n--\n\nINSERT INTO book VALUES ('1-111-11111-4','Women are From Venus ORACLE is from Beyond Pluto','New York Times Best Seller 27 weeks',1,'4',1);\nINSERT INTO book VALUES ('1-222-32443-7','Calculus for Phys Ed Majors','Carry our 200 lb text book: learn integrals and keep in Shape',7,'3',7);\nINSERT INTO book VALUES ('1-295-84547-1','My Love\\'s Last Longing','Volume 1 of 4',1,'1',4);\nINSERT INTO book VALUES ('1-533-73363-8','From the Shores of Lake Erie to IT','One man\\'s Journey to IT',8,'2',1);\nINSERT INTO book VALUES ('1-559-68777-1','My Love\\'s Last Lingering Lost','Volume 2 of 4',1,'1',4);\nINSERT INTO book VALUES ('1-932-87447-6','The Science of Literature Searching','A Book Worth a Look is Worth a Good Look Up',6,'1',5);\nINSERT INTO book VALUES ('2-089-77869-5','Yes! Networking is for Bills Fans','How to Use a Spanning Tree to Exit Rich Stadium',9,'1',8);\nINSERT INTO book VALUES ('2-122-29058-5','How to Keep your Cellular Bill Down','How to carry 500 Miles of Fiber in Your Wallet',5,'2',2);\nINSERT INTO book VALUES ('2-221-11341-5','Tired of wired? Infrared instead!','500 Ways to pull out your hair while pulling out all your cable',5,'1',2);\nINSERT INTO book VALUES ('3-444-95595-4','ER, SOM, NF, DK/NF, SQL, JDBC, ODBC, and RELVAR','How U can avoid being trapped in Database acronyms',4,'1',3);\nINSERT INTO book VALUES ('3-445-43341-2','Master Wireless Through The Classic Comics','Infrared man triumphs over Cable Guy and CoAx NastyMan',2,'1',6);\nINSERT INTO book VALUES ('3-445-58668-5','How to Keep your Cable Bill Down','How to Avoid Tripping on 500 Miles of Fiber in your wallet',5,'1',10);\nINSERT INTO book VALUES ('4-344-22221-1','I Lasted my Love\\'s Last Lingering Longing','Volume 3 of 4',1,'2',4);\nINSERT INTO book VALUES ('4-668-39283-8','From Deep in the Heart of Texas to IT','One man\\'s Journey to IT',8,'1',1);\nINSERT INTO book VALUES ('5-538-55746-1','My Lost Love\\'s Long Last Lingering','Volume 4 of 4',1,'1',4);\nINSERT INTO book VALUES ('6-449-68668-8','From Brockport to IT','Prof. Johnson\\'s Journey to IT (about 25 min via 490)',8,'1',1);\nINSERT INTO book VALUES ('7-999-14432-2','Master HTML Through The Classic Comics','Using his Super Web thrower, Spiderman creates HTML docs',2,'2',6);\nINSERT INTO book VALUES ('8-330-69586-6','The Shortest Book in the World','A Guide to how Detroit will win the World Series in 2001',9,'1',3);\nINSERT INTO book VALUES ('9-333-44441-1','My Love\\'s at Long Last Lost his Lingering','Volume 5 of 4',1,'1',4);\nINSERT INTO book VALUES ('9-337-55467-3','How to add Class to your Programming','How to write programs in VB instead of C',3,'3',10);\nINSERT INTO book VALUES ('9-400-55555-2','Master C++ Through The Classic Comics','GeekMan triumphs over C++ program infected with Kryptonite virus',2,'1',6);\nINSERT INTO book VALUES ('9-444-43356-3','A language without Pointers? Priceless.','For Everything Else, there\\'s C++',3,'1',13);\nINSERT INTO book VALUES ('9-455-61223-3','JAVA: It\\'s more than Just a Programming Language','Achieve enlightenment through the mystery of the Swing package',3,'1',7);\n\n\nINSERT INTO bookreview VALUES ('1-111-11111-4',19,10,'Hold on to your hats, gang! If you think a cookbook or the yellow pages is exciting reading, you gotta read Professor Spadas remarkable treatise on enriching you personal relationships through your knowledge of ORACLE 8.1.6. In an easy-to-read fashion, s');\nINSERT INTO bookreview VALUES ('1-295-84547-1',27,10,'This is one of the most outstanding books ever written. Five thumbs up. Five stars. A must-read for everyone.');\nINSERT INTO bookreview VALUES ('1-533-73363-8',20,4,'A rather boring autobiography of a northern Ohio native who migrates to Rochester New York where he becomes a professor of Information Technology at RIT. Other than the chapters devoted to the Cleveland Indians (chapters 1, 2, 3, 6, 10, 11, 12, 13), The C');\nINSERT INTO bookreview VALUES ('1-559-68777-1',2,8,'A wonderful romance novel about Matt, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find himself.  Matt meets Margaret, a person with cowgirl charm in touch with her masculine self. Matt falls in lov');\nINSERT INTO bookreview VALUES ('1-559-68777-1',19,9,'A wonderful romance novel about Margaret, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find herself.  Margaret meets Matt, a person with tough cowboy swagger in touch with his feminine self. Margare');\nINSERT INTO bookreview VALUES ('2-089-77869-5',5,5,'Definitely dont buy this book if you are a Giants fan.  Two Giants fans tried this technique at the Giants game several weeks ago and they arent back yet.');\nINSERT INTO bookreview VALUES ('2-089-77869-5',13,8,'For any networking buff/Bills fan, Dr. Lutz treatise on the use of spanning trees to exit a Buffalo Bills game is a must. It is difficult to slog through in spots, but he shows you that by applying his minimalization technique you can get back to Rochest');\nINSERT INTO bookreview VALUES ('2-089-77869-5',15,6,'Dont buy this book unless your are  Bills fan.  Fans of any other team will find their departure time from a Bills game actually triples when the technique is applied. In fact, it probably accounts for why Dr. Lutz (and any other Bills fan who applies it');\nINSERT INTO bookreview VALUES ('2-122-29058-5',6,7,'Professor Hartpence shows you how to carry 500 miles of fiber in your wallet.  Warning to the unwary: dont buy this book unless you have deep pockets.');\nINSERT INTO bookreview VALUES ('2-122-29058-5',13,8,'Watch out Jim Carey .. this non-cable guy may leave you out of work. In his book, Professor Hartpence combines his cellular and networking skills with his experience in both the military and the commercial world and the practice of Zen to show you how to');\nINSERT INTO bookreview VALUES ('3-444-95595-4',3,4,'U lose if you ever bother to read this book.');\nINSERT INTO bookreview VALUES ('3-445-58668-5',6,7,'This book is a follow-up to Professor Hartpences book on how to carry 500 miles of fiber in your wallet.');\nINSERT INTO bookreview VALUES ('4-344-22221-1',24,7,'A wonderful romance novel about Nelson, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find himself.  Nelson meets Laura, a person with cowgirl charm in touch with her masculine self. Nelson falls in');\nINSERT INTO bookreview VALUES ('4-668-39283-8',6,6,'A sometimes boring autobiography of a Texan transplanted to Rochester New York where he becomes a professor of Information Technology at RIT. Other than the chapters devoted to the Dallas Cowboys (chapters 1, 2, 3, 6, 10, 11, 12, 13), The Presidential ele');\nINSERT INTO bookreview VALUES ('5-538-55746-1',15,9,'A wonderful romance novel about Laura, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find herself.  Laura meets Nelson, a person with tough cowboy swagger in touch with his feminine self. Laura falls');\nINSERT INTO bookreview VALUES ('6-449-68668-8',20,7,'The funny, often racy, autobiography of Daryl Johnson and his escapades to and from RIT. The book is largely about the excitement of commuting from the west side to RIT every day and how much fun it can be. A great book for those who live on the west side');\nINSERT INTO bookreview VALUES ('6-449-68668-8',26,10,'An absolutely outstanding autobiography of a Saint John Fisher Graduate and how he has adapted to his 20 minute ride (mostly on 490) to RIT every morning and his 20 ride (mostly on 490) home from RIT every night. The author uses thirteen chapters to vibra');\nINSERT INTO bookreview VALUES ('8-330-69586-6',5,10,'Geez .. no pages, no paragraphs, no words .. not even an illustration. But he did dedicate the book to Tony Clark. Says something for the fervor of this Detroit Tigers fan.');\nINSERT INTO bookreview VALUES ('8-330-69586-6',15,10,'Very accurate analysis of a problem that is not NP complete.');\nINSERT INTO bookreview VALUES ('9-333-44441-1',24,7,'Throwing the usual themes and twists of a romance novel to the winds, the author tells the store of Laura, a successful Dude Ranch owner in New Mexico, who resigns and moves to New York to seek her fortune as an editor for the New York Times. Laura meets');\nINSERT INTO bookreview VALUES ('9-337-55467-3',25,9,'These authors know their way around a coding pad, let me tell you! In clear, bell-shaped tones, with succinct wording and pinpoint accuracy, they nail this subject matter to the wall. Do you like inheritance? How about information hiding? Maybe you like e');\nINSERT INTO bookreview VALUES ('9-455-61223-3',13,9,'Professor Sonstein shows how oneness with the spiritual universe can be achieved by bringing the soul into rhytmn with the JAVA runtime machine. He shows that through various forms of self denial, such as writing code without pointers and heavy weight com');\n</code></pre>\n\n<p>I need help displaying the NAME of the the reviewer, the TITLE of the book and the RATING the reviewer gave the book. <strong>But only of reviewers whos EmployedBy field is empty.</strong></p>\n\n<p>This is what it should look like:</p>\n\n<pre><code> name  | title                                 | rating \n Leone | How to Keep your Cellular Bill Down   |      7 \n Leone | How to Keep your Cable Bill Down      |      7 \n Leone | From Deep in the Heart of Texas to IT |      6 \n</code></pre>\n\n<p>Do I need to use an Inner Join, a Union, or just a multiple SELECT?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13184325,"title":"Reference 2 rows on same column/table, from a different table","body":"<p>I'm working on a stat tracking webpage for a virtual hockey league on Xbox. I have my basic table layout setup, but I am struggling with how to create the query that will allow me to show the schedule. Below is my basic table layout, and what I'd like to do is have it display something like:</p>\n\n<p>Game 1:<br>\n New York vs Chicago<br>\n Detroit vs Boston</p>\n\n<p>Game 2:<br>\n Boston vs New York<br>\n Chicago vs Detroit</p>\n\n<pre><code>SELECT homeTeam.name AS HOME_TEAMNAME\nFROM GameSchedule Sched\n\nINNER JOIN GameStats GameStatsHome\nON Sched.ID = GameStatsHome.gameSchedule_ID\nAND Sched.homeTeam_ID = GameStatsHome.team_ID\n\nINNER JOIN Team homeTeam\nON homeTeam.ID = gameStatsHome.team_ID\n</code></pre>\n\n<p>I realize where I'm running into the problem is trying to pull the Team.name for both GameSchedule.awayTeam_ID and GameSchedule.homeTeam_ID. But I haven't been able to figure out how to do this. I feel like I'm close..but then again, I have no idea what I'm doing, and have spent about 3 days trying to figure this one query out. I think if someone can point me in the right direction, I should be good for the rest of what I need... Any help would be greatly appreciated.</p>\n\n<pre><code>Table: Team\n-----------------------------------------------------------\n| ID | name       | abbreviation | conference | division |\n-----------------------------------------------------------\n|  1  | New York  |      TMA     |      1     |     1    |\n|  2  | Chicago   |      TMB     |      1     |     1    |\n|  3  | Detroit   |      TMC     |      1     |     1    |\n|  4  | Boston    |      TMD     |      1     |     1    |\n-----------------------------------------------------------\n\nTable: GameSchedule\n------------------------------------------------\n| ID | awayTeam_ID | homeTeam_ID | gameTime_ID |\n------------------------------------------------\n| 1  |     1       |      2      |      1      |\n| 2  |     3       |      4      |      1      |\n| 3  |     4       |      1      |      2      |\n| 4  |     2       |      3      |      2      |\n------------------------------------------------\n\nTable: GameStats\n------------------------------------------\n| ID | gameSchedule_ID | team_ID | goals |\n------------------------------------------\n| 1  |        1        |    1    |   5   |\n| 2  |        1        |    2    |   3   |\n| 3  |        2        |    3    |   6   |\n| 4  |        2        |    4    |   1   |\n| 5  |        3        |    1    |   2   |\n| 6  |        3        |    4    |   5   |\n------------------------------------------\n</code></pre>\n"},{"tags":["mysql","query","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13170790,"title":"How can I update all fields in row matching `x` to `y` without looping through each individually?","body":"<p>I'm curious if I can update all matching fields in a row with a new value at once in MySQL.</p>\n\n<p>I know I can use <code>ALTER TABLE</code> to change default values, but I'm interested only in one row, not in changing the default values of an entire table.  I can iterate through each in a loop if necessary, but I'm curious if there is a way to accomplish this more elegantly.</p>\n\n<p>Imagine my row looks like this:</p>\n\n<pre><code>| 1 | Joe | Smith | null | X | X | X | Y | X | Y | Y | X | null | Y | X | null |\n</code></pre>\n\n<p>Is it possible to update all fields matching <code>X</code> to <code>Y</code> at once?</p>\n\n<p>So the result would look like this:</p>\n\n<pre><code>| 1 | Joe | Smith | null | Y | Y | Y | Y | Y | Y | Y | Y | null | Y | Y | null |\n</code></pre>\n\n<p>(assume <code>1</code> is a primary key, id... if that helps at all)</p>\n\n<p>Can this be done with only one <code>UPDATE</code> query?</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13183586,"title":"SQL query distinct with additional select","body":"<p>I need to perform a query in MySQL that returns distinct values for product_id but also I need to select and return 'id' field which is in that particular table.</p>\n\n<p>This query will return distinct product_id's without id:</p>\n\n<pre><code>SELECT DISTINCT product_id FROM orders_cart\n</code></pre>\n\n<p>This query will use distinct on both fields which and I want to use it on product_id and see the id</p>\n\n<pre><code>SELECT DISTINCT id, product_id FROM orders_cart\n</code></pre>\n\n<p>It would be quite easy to do on pgsql but I have no idea how to do this on mysql.</p>\n"},{"tags":["sql","query","oracle11g","entity-attribute-value"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13025135,"title":"How can I write a select query from a table which has columns like product,attribute,value?","body":"<p>I have tables like these</p>\n\n<pre><code> - Products: PID,ProductName...\n - Attributes:AID,AttributeName...\n - ProductAttributes:PID,AID,Value\n</code></pre>\n\n<p>and the values are</p>\n\n<pre><code>***ProductAttributes***\n\n - P1,A1,V1\n - P1,A2,V2\n - P1,A3,V3\n - P2,A1,V4\n - P2,A2,V2\n - P2,A3,V3\n - P3,A1,V1\n - P3,A2,V2\n - P3,A3,V5\n</code></pre>\n\n<p>I need a procedure which has 2 array parameters and it filters products by these parameters. If <code>Parameter1:{A1,A2}</code> and <code>Parameter2:{V1,V2}</code> procedure should select </p>\n\n<pre><code>P1,P3\n</code></pre>\n\n<p>How can I write this? Thanks</p>\n"},{"tags":["php","database","query","cakephp"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13183370,"title":"Query every time keypress or a inital big query? Which is better in cakePHP and jquery?","body":"<p>Hi I have a site develop in cakephp, in a page I have an input type text where a user can insert string like \"ban\" I make a query to the database to retrieve the data to obtain record which contain that string (in the example: \"banana\", \"banned\"...). Every time that the user digit another letter I make another query to retrieve data which containt taht string every time. The query is done in jquery every time that a user press a letter.\nI have for example 1 milion of record into my table and I don't know if a user start to digit letter if this solution is fast.\nAnother solution is: when I open that page I make a query to find all record and put it into an array. every time that a user digit a letter I search that string into the array to obtain a subarray with the result.</p>\n\n<p>Which is the best solution in terms of speed, RAM. Consider that in that table I can have 1 milion of record and many user can enter into that page simultaneously.\nMy database is MYSQL.</p>\n"},{"tags":["mysql","sql","query","join","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13183371,"title":"Tricky MySQL query with joins?","body":"<p>I have 4 tables (among a lot of others - just showing the relevant ones). They are:</p>\n\n<ul>\n<li>\"users\"\n<ul>\n<li>id</li>\n<li>name</li>\n<li>role_id</li>\n</ul></li>\n<li>\"roles\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n<li>\"chapter_role_view_permissions\"\n<ul>\n<li>id</li>\n<li>chapter_id</li>\n<li>role_id</li>\n</ul></li>\n<li>\"chapters\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n</ul>\n\n<p>I'm trying to build a query that will return to me a list of all users, their role name, all chapters per user, and whether or not they have view access to each chapter. So lets say there are 2 users and 2 chapter. User 1 is role_id=1 and User 2 is role_id=2. And the chapter_role_view_permissions has 1 record ( id:1 | chapter_id: 1 | role_id: 1 ) which means only users with role_id=1 can view chapter 1.</p>\n\n<p>The query result I am looking for should be something like:</p>\n\n<p>|---users.id---|--roles.id---|---chapters.id--|-can_view_chapter-|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 1 --------|----------- 1 -----------|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 1 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>Any idea what the query might look like? I don't want to have to make a new field in chapter_role_view_permissions that says \"allowed\" and insert new records for each role type with either allowed=1 or allowed=0</p>\n"},{"tags":["query","grails","alias","projection","criteria-api"],"answer_count":2,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":2228,"score":5,"question_id":5895091,"title":"Grails Criteria projections on joined table","body":"<p>I have an issue with grails criteria builder, I want to do a projection on a column that is on a table that is in one-to-many relation to parent table example:</p>\n\n<pre><code>Car.createCriteria() { \n   projections { \n     property('name') \n     property('wheels.name')// ???? \n   }\n\n   join 'wheels' \n   //or wheels {} ???\n}\n</code></pre>\n\n<p>or something similar exist? I think it is basic propblem with aliases</p>\n"},{"tags":["php","sql","query","results"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13168663,"title":"SQL query results returned, even if exact match not found","body":"<p>I hope this question isn't redundant.  What I am trying to accomplish is have a user select a bunch of checkboxes on a page and return the closest matching records if there are no matching rows. For example:</p>\n\n<p>A person checks off [x]Apples [x]Oranges [x]Pears [x]Bananas</p>\n\n<p>But the table looks like this:</p>\n\n<pre><code>Apples     Oranges      Pears     Bananas\n 1             1           1        null\n 1             1         null       1\n 1             1         null       null\n</code></pre>\n\n<p>(Obviously I missed the id column here, but you get the point I think.) So, the desired result is to have those three rows still be returned in order of most matches, so pretty much the order they are in now. I'm just not sure what the best approach to take on something like this. I've considered a full text search, the levenshtein function,  but I really like the idea of returning the exact match if it exists. No need for you to go at length with code if not needed. I'm just hoping to be sent in the right direction. I HAVE seen other questions sort of like this, but I still am unsure about which way to go.</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","post","node.js"],"answer_count":5,"favorite_count":12,"up_vote_count":18,"down_vote_count":0,"view_count":16440,"score":18,"question_id":5710358,"title":"how to get POST query in express node.js?","body":"<p>Here is my simple form:</p>\n\n<pre><code>&lt;form id=\"loginformA\" action=\"userlogin\" method=\"post\"&gt;\n        &lt;div&gt;\n            &lt;label for=\"email\"&gt;Email: &lt;/label&gt;\n            &lt;input type=\"text\" id=\"email\" name=\"email\"&gt;&lt;/input&gt;\n        &lt;/div&gt;\n&lt;input type=\"submit\" value=\"Submit\"&gt;&lt;/input&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my express node.js code:</p>\n\n<pre><code>app.post('/userlogin', function(sReq, sRes){\n\n    var email = sReq.query.email.;\n\n}\n</code></pre>\n\n<p>I tried <code>sReq.query.email</code> or <code>sReq.query['email']</code> or <code>sReq.params['email']</code> etc. None of them work.  They all return <code>undefined</code>. </p>\n\n<p>When I change to a Get call, it works, so .. any idea?</p>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1245,"score":1,"question_id":2952482,"title":"Advanced count and join in Rails","body":"<p>I am try to find the top <code>n</code> number of categories as they relate to articles, there is a habtm relationship set up between the two. This is the SQL I want to execute, but am unsure of how to do this with ActiveRecord, aside from using the <code>find_by_sql</code> method. is there any way of doing this with ActiveRecord methods:</p>\n\n<pre><code>SELECT \n  \"categories\".id, \n  \"categories\".name, \n  count(\"articles\".id) as counter \nFROM \"categories\"\nJOIN \"articles_categories\" \n  ON \"articles_categories\".category_id = \"categories\".id\nJOIN \"articles\" \n  ON \"articles\".id = \"articles_categories\".article_id\nGROUP BY \"categories\".id\nORDER BY counter DESC\nLIMIT 5;\n</code></pre>\n"},{"tags":["json","query","postgresql"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":826,"score":3,"question_id":6663665,"title":"PostgreSQL how to query json data based upon json attribs criteria","body":"<p>I am using PostgreSQL i want to store JSON data into table column.\nLater i want to retrieve data records criteria based upon JSON attributes.\nI know sort of this support available in MS SQL Server but i don't know that is it available in PostgreSQL or not.</p>\n"},{"tags":["mysql","arrays","query","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13181500,"title":"Looping through array field in mysql statement?","body":"<p>I was given a database that is a little weird, but I am not able to change it. There is a field that is set as an array but holds ids that I need to access in where clauses. Here is the field set up:</p>\n\n<pre><code>TABLE: PROMOS\npromo_id   |    contract_ids\n-----------------------------\n 1               23,34,54\n 2               13,34,55\n 3               20,30\n</code></pre>\n\n<p>I need to do an sql query to get all promo_ids where contract id = 34</p>\n\n<pre><code>mysql_query(\"SELECT promo_id FROM Promos WHERE contract_ids = '34'\n</code></pre>\n\n<p>Is there a way to do this?? Thanks for any help!</p>\n"},{"tags":["sql","query","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13181117,"title":"SQL - how to get out chained data?","body":"<p>I have 4 tables which were auto generated for me:</p>\n\n<ul>\n<li>User</li>\n<li>Challenge</li>\n<li>Exercise</li>\n<li>Challenge_Exercise</li>\n</ul>\n\n<p>One User may have many Challenges, and one Challenge will have many Exercises.</p>\n\n<p>What I noticed is that the Challenge table has a reference to it's parent User (called user_id) but Exercise do not have a reference in it's table to Challenge; their relation is stored in Challenge_Exercise as Challenge_id and exercise_id.</p>\n\n<p>My question is, how would I take out every Exercise that is linked to a specific user? For instance User with id = 1?</p>\n"},{"tags":["excel","odbc","query"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":16480,"score":3,"question_id":1285686,"title":"Excel: Use a cell value as a parameter for a SQL query","body":"<p>I'm using MS Excel to get data from a MySQL database through ODBC.<br />\nI successfully get data using an SQL query. But now I want that query to be parameterized.<br />\nSo I wonder If it is possible to use a cell value (a spreadsheet cell) as a parameter for such a query.<br />\nFor example, for this query:</p>\n\n<pre><code>select name from user where id=1\n</code></pre>\n\n<p>I'd like to get the id value from, say, cell D4 in the spreadsheet.</p>\n\n<p>Is that the proper approach to parameterize a query? and how can I do it?</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13180326,"title":"Basic SQL Update query in PHP","body":"<p>I am using a MVC framework and have a problem in a SQL query.</p>\n\n<p>The user that publish a post on my website receives an email containing a confirmation URL : </p>\n\n<pre><code>mywebsite.com/confirm/f9b83b3bf994e5db3b06ya20eb306a24/\n</code></pre>\n\n<p>The routing is made correctly, but I would like to change the SQL \"published\" field to 1 (it is set to 0 by default)</p>\n\n<p>So basically, everything is working except my UPDATE SQL query, it's probably something stupid but I am a beginner in this domain and I couldn't fix it after many tries.</p>\n\n<pre><code>    if(substr(ROUTE, 0, 8) == 'confirm/')\n        {\n            if(strlen($code = substr(ROUTE, 8, 32)) == 32)\n            {\n                if($row = db::fetch(db::query('SELECT `id` FROM `'.DB_PREFIX.'Posts` WHERE `published`=0 AND `confirm`=\"'.db::escape($code).'\"'), 'row'))\n                {\n\n//This is the problematic line\n                 db::query('UPDATE '.DB_PREFIX.'Posts SET published=1 WHERE published=0 AND confirm=\"'.db::escape($code).'\"');\n\n                }\n            }\n\n            header('Location: '.WEB.'publish_success.html');\n        } \n</code></pre>\n\n<p>Thank youf or your help :)</p>\n\n<p>Edit : Problem fixed adding the WHERE clause !</p>\n"},{"tags":["jquery","query","media"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13179056,"title":"Stop jQuery with media query","body":"<p>Simple question can I stop a jquery function with media queries.</p>\n\n<p>I have a jQuery slideshow that I want to stop when the window gets to phone size so i can adjust the layout.</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13178569,"title":"ms sql casting error","body":"<p>My question is regarding my <a href=\"http://stackoverflow.com/questions/13176788/ms-sql-2005-cant-compare-dates\">previous</a> topic.</p>\n\n<p>The problem I have is that when the date wich have to be casted is like: (25.09.2012) is throwing a strange <code>The conversion of a char data type to a datetime data type resulted in an out-of-range datetime value.</code>error. I lost 40 minutes trying to fix it without success.</p>\n\n<p>Here the code is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Is there a way to convert it? For example when I put <code>20.09.2012</code> im getting an error, but it's running with <code>10.09.2012</code> Please help me with this issue!</p>\n"},{"tags":["query","encoding","solr"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12749890,"title":"Solr query on Europe character (Beklædning)","body":"<p>in solr query search,\na search </p>\n\n<pre><code>q=*%3A*&amp;fq=grand_cat_str%3ABeklædning\n</code></pre>\n\n<p>Solr will read the fq as:<code>&lt;str name=\"fq\"&gt;grand_cat_str:BeklÃ¦dning&lt;/str&gt;</code></p>\n\n<p>and return no result. Doing wild search for Bekl*dning would return correct result.</p>\n\n<p>[edit]\nI added </p>\n\n<pre><code>    &lt;fieldType name=\"string\" class=\"solr.StrField\" sortMissingLast=\"true\" &gt;\n &lt;analyzer type=\"index\"&gt;\n        &lt;tokenizer class=\"solr.StandardTokenizerFactory\"/&gt;\n        &lt;filter class=\"solr.ASCIIFoldingFilterFactory\"/&gt;\n &lt;/analyzer&gt;\n\n&lt;/fieldType&gt;\n</code></pre>\n\n<p>but got a error:</p>\n\n<pre><code>&lt;org.apache.solr.common.SolrException: FieldType: StrField (string) does not support specifying an analyzer\n</code></pre>\n"},{"tags":["sql","sql-server","query","ide","formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":194,"score":1,"question_id":11061642,"title":"SQL server 2012 SP_HELPTEXT extra lines issue","body":"<p>I am using SQL server 2012, &amp; always use <code>SP_HELPTEXT</code> to get my previously created Stored Procedures, In previous versions of SQL server there were no issues in this process but in 2012, My Stored Procedures come with extra lines, for example this is the procedure that I wrote</p>\n\n<pre><code>Create proc SP_Test\nas\nbegin\n Select * \n from table_ABC\nend\n</code></pre>\n\n<p>Now after using <code>SP_HELPTEXT</code> with this procedure (or any other procedure), I am getting this output</p>\n\n<pre><code>Create proc SP_Test\n\nas\n\nbegin\n\n Select * \n\n from table_ABC\n\nend\n</code></pre>\n\n<p>Do any one else also facing this problem or I am the only one on this planet to struggle with this issue ??\nDoes any body know how to solve this issue ??</p>\n\n<p>Configuration of my SQL server is as follows (copied from <strong>Help -> About</strong> )</p>\n\n<pre><code>Microsoft SQL Server Management Studio          11.0.2100.60\nMicrosoft Analysis Services Client Tools        11.0.2100.60\nMicrosoft Data Access Components (MDAC)         6.1.7601.17514\nMicrosoft MSXML                     3.0 6.0 \nMicrosoft Internet Explorer             9.0.8112.16421\nMicrosoft .NET Framework                4.0.30319.269\nOperating System                    6.1.7601\n</code></pre>\n\n<p>Thanx in advance.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13179326,"title":"What is the best way to create a query with a big set of data?","body":"<p>I have about 360 lines of data which I need to make into 360 query's for SQL, Is there any quick way of putting all the data into one query instead of having to put them all in separate, for example here is just 3 lines of data I have:</p>\n\n<pre><code>   1,81,32\n   1,101,82\n   1,60,65\n</code></pre>\n\n<p>I have to make this data into query's so these 3 would look like:</p>\n\n<pre><code>   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,81,32);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,101,82);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (2,60,65);\n</code></pre>\n\n<p>But I have 360 lines of this, so It will be hard to make these all into query's 1 by 1, Is there any quicker way of doing this, Like just one query to insert them all?</p>\n"},{"tags":["query","ruby-on-rails-3.1","comments","polymorphism"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13167248,"title":"How do I Query Polymorphic Comments when commentables can belong to another commentable?","body":"<p>So I'm trying to do a relatively advanced query on a polymorphic model. I have the following models:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :project_stakeholders, :dependent =&gt; :destroy\n  has_many :features, :dependent =&gt; :destroy\n  has_many :iterations, :dependent =&gt; :destroy\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass ProjectStakeholder &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass Feature &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass Iteration &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :comments, :dependent =&gt; :destroy\nend\n\nclass Comment &lt; ActiveRecord::Base\n  belongs_to :commentable, :polymorphic =&gt; true\n  belongs_to :created_by, :class_name =&gt; 'User'\nend\n</code></pre>\n\n<p>I'm trying to find the current_user's comments for a particular project (project.comments, project.features.comments, project.iterations.comments, project.project_stakeholder.comments) and sort them in created_at descending order.</p>\n\n<p>The best I have come up with is:</p>\n\n<pre><code>Class Project &lt; ActiveRecord::Base\n  def all_comments_for_user(user)\n    Comment.where(:created_by_id =&gt; user.id).select { |c| c.commentable.attributes.has_key?('project_id') }.select { |c| c.commentable.project == self } | comments.where(:created_by_id =&gt; user)\n  end\nend\n</code></pre>\n\n<p>But this doesn't address the descending create_at sequence.</p>\n"},{"tags":["query","google","parameters","search-engine"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1546,"score":2,"question_id":2401115,"title":"Meaning of parameters in a Google query?","body":"<p>Are there any ressources on what the parameters in a Google query mean? Any analysis how the Google search pages work internally? </p>\n\n<p>Examples would be</p>\n\n<pre><code>http://www.google.com/#hl=en&amp;source=hp&amp;q=lol&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;fp=45675624562456\n</code></pre>\n\n<p>or</p>\n\n<pre><code>http://www.google.com/url?sa=t&amp;source=web&amp;ct=res&amp;cd=11&amp;ved=KJSGHFKSDJF&amp;url=sfdgagasdgasdgasgasg&amp;rct=j&amp;q=fghthwrteghedgf&amp;ei=asdfasdfsa&amp;usg=asdfasdfasf\n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13177901,"title":"How to find if a date is from a Odd or Even week?","body":"<p>In my table I have for each day:</p>\n\n<pre><code>Id_______Startdate _______ EndDate __________MondayMorning _____MondayEvening ___TuMorning  ....  \n121 _____2012-01-01________2012-12-31 ________2 ___________________2______________2   \n122 _____2012-02-01________2012-08-05 ________1 ___________________2______________3   \n</code></pre>\n\n<p>I already generated a list of dates using the Startdate and EndDate. </p>\n\n<p>I want to know if this dates belongs to a odd week or a even week so that I can filter days from my output that have number 3 Or 1 (see second record).</p>\n\n<p>how can I filter the days that belongs to  odd weeks and even weeks that have number 1 and 3?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13176788,"title":"ms sql 2005 can't compare dates","body":"<p>I have a huge database in ms sql. I have a date stored into a field of type: <code>VARCHAR2</code>\nI have the code, but it can't compare dates. What I mean? There is an input with a launch date. What I need is to get the launchdate inputs where the launchdate is bigger than a date and smaller than another. The problem is that when I change the year from 2012 to 2013 there are no results. Also when I have dates with 0 (like 01.01.2012) it can't compire them.</p>\n\n<p>What I have so far is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Can someone help me to get the correct results?</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>The date is stored as string in this format: yyyy-mm-dd</p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13173833,"title":"How to have many column from just one cloumn?","body":"<p>I have a table : </p>\n\n<p>IADATA</p>\n\n<pre><code>    Id     Studentid     Mon   Value  Type\n    1      ABC1           1      12     1\n    1      ABC1           1      02     2\n    1      ABC1           1      18     4\n    1      ABC1           1      09     7\n    1      ABC1           1      12     8\n    1      ABC1           1      22     10\n    1      ABC2           2      12     1\n    1      ABC2           2      02     2\n    1      ABC2           2      18     4\n    1      ABC2           2      09     7\n    1      ABC2           2      12     10\n    1      ABC2           3      05     1\n    1      ABC2           3      02     2\n    1      ABC2           3      20     4\n    1      ABC2           3      09     7\n    1      ABC2           3      12     10\n</code></pre>\n\n<p>In the above table we have two Students ABC1 and ABC2 and their data.</p>\n\n<p>Now the kind of result i want is:</p>\n\n<pre><code>   Id      Studentid      Mon     Obtained   Benefits   Max    Type\n    1        ABC1          1         12         02      18       I\n    2        ABC1          1         09         12      22       II\n    3        ABC2          2         12         02      18       I\n    4        ABC2          2         09         00      12       II\n    5        ABC2          3         05         02      20       I\n    6        ABC2          3         09         00      12       II\n</code></pre>\n\n<p>Now in the result you can see that i am placing the values according to the studentid and mon and the types in a certain order. if the type is I it should have obtained, then benefits then max and same with II. What can be the select query for it?</p>\n\n<p>The type in previous tables are linked. When it has the value 1,2,4 it should be like obtained, benefits and maximum for new type I and when 7,8,10, it should be like obtained,benefits and maximum for new type II. And when there is no column available, it should be zero. </p>\n"},{"tags":["php","mysql","sql","query","date"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13139318,"title":"Comparing a string-date with another string-date in MySql query","body":"<p>I'm trying to get entries from MySql server where the dates are <code>&gt; date_begin and &lt; date_end</code></p>\n\n<p>My problem is that the table column \"<code>date</code>\" is set to <code>VARCHAR</code>, and the string I am comparing it is also directly from an <code>&lt;input type=\"text\"/&gt;</code></p>\n\n<p>The date format ( as string / varchar ) in the mysql table and in the textbox will be <code>DD.MM.YYYY</code></p>\n\n<p>my problem is that if i do </p>\n\n<p>( php code )</p>\n\n<pre><code> $query = \"SELECT * FROM table WHERE date&gt;='\" . $dateBegin . \"' AND date&lt;='\" . $dateEnd . \"'\";\n</code></pre>\n\n<p>the result will be completely random.</p>\n\n<p>I know why this happening so the question is: How can I compare this to get the right result ?</p>\n\n<p>thank you all who can help</p>\n\n<p><strong>UPDATE :</strong> </p>\n\n<p>Now I've tryed this solution, but it also doesn't work.</p>\n\n<pre><code>$query = \"SELECT * FROM artikel WHERE STR_TO_DATE(datum, '%d.%m.%Y')&gt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\" . \"' AND STR_TO_DATE(datum, '%d.%m.%Y')&lt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\";\n</code></pre>\n\n<p>the <code>$_REQUEST['dateFrom']</code> and <code>$_REQUEST['dateTo']</code> came from 2 textboxes and the input is a string like this <code>\"05.06.2005\"</code>.</p>\n\n<p>in the db-table 'artikel' (german for articles) in the column 'datum' (german for date) the values are VARCHAR's with the same format ( \"05.06.2005\" ).</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13176338,"title":"Query single value with SQL","body":"<p>I want to get a single value(aktiv) out of a table called wartung. </p>\n\n<pre><code>include('blog/includes/db_connect.php');\n$query = $db-&gt;prepare(\"SELECT * FROM wartung\");\n$query-&gt;execute();\n$query-&gt;bind_result($wartung_id, $aktiv, $grund);\n</code></pre>\n\n<p>The value of aktiv in the database is 1.<br>\nbut this code doesn't get this 1 into the <code>$aktiv</code> variable.  </p>\n\n<p><sub>PS: I'm not used to code with MySQL and PHP so if there is a beginner-bug please don't be mad.</sub></p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13175550,"title":"MySQL database query returns empty result","body":"<p>I am doing a data migration and getting empty result of simple query with one join. Following is the query</p>\n\n<pre><code>Select * from users u INNER JOIN temp_users tu ON tu.uid = u.uid\n</code></pre>\n\n<p>There are hundreds of records which have same uid in both tables, but this query returns only one record.</p>\n\n<p>Following is the structure of tables</p>\n\n<pre><code>users table\nuid:  varchar(50)   utf8_general_ci         Yes     NULL \n\ntemp_users table\nuid: varchar(50)    utf8_general_ci         Yes     NULL\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":55,"score":5,"question_id":13172228,"title":"Require if in where condition SQL","body":"<p>I want to fetch the data based on the key_column in the table. I am having a procedure where i am passing the key character. If the key is 'A' only those records with key as 'A' should get selected . For any other key character other than 'A', I need all the records except the rows with the key_Column value 'A' </p>\n\n<p>sample code:</p>\n\n<pre><code>select * from tab1\nwhere \nif (@key_Char = 'A') Then key_Column=@key_Char \nELSE key_Column &lt;&gt;@key_Char \n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13175192,"title":"ms sql convert string to date changing the order from yyyy-mm-dd to dd.mm.yyyy","body":"<p>I have a field named <code>VALUE</code> of <code>VARCHAR2</code> type</p>\n\n<p>The string is in this format: <code>yyyy-mm-dd</code>\nIs it possible to change it to: <code>dd-mm-yyyy</code></p>\n\n<p>An then (again if possible) to convert it to date in this format?</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>SELECT convert(varchar, getdate(), 110)\n</code></pre>\n\n<p>but it's only for the current time. Is there a way to do this?</p>\n\n<p>Edit:\nHere my code is:</p>\n\n<pre><code>select\np1.VALUE as Sdate\nfrom Process p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.ID AND p1.NAME = 'Sdate'\nWHERE p.TYPE = 'Marketing' and convert(varchar, convert(date,p1.value), 103) ='22.08.2012'\n</code></pre>\n"},{"tags":["c#","string","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13174387,"title":"Query string using LINQ","body":"<p>For parsing SDP information from an RTSP, currently I use default c# string functions (like loop the string line by line) and foreach/switch methods. Default SDP information comes from a device in this form:</p>\n\n<pre><code>v=0\no=mhandley 2890844526 2890842807 IN IP4 126.16.64.4\ns=SDP Seminar\ni=A Seminar on the session description protocol\nu=http://www.cs.ucl.ac.uk/staff/M.Handley/sdp.03.ps\ne=mjh@isi.edu (Mark Handley)\nc=IN IP4 224.2.17.12/127\nt=2873397496 2873404696\na=recvonly\nm=audio 3456 RTP/AVP 0\nm=video 2232 RTP/AVP 31\nm=whiteboard 32416 UDP WB\na=orient:portrait\n</code></pre>\n\n<p>Im wondering is this string is query-able using LINQ or something instead of foreaching each line, switching the first character and then storing the rest as a value, because this method is very sensitive to malfunction and error (like when 2 attributes/params are on 1 line or the first character isn't accidentally the right one (e.g. with a space before)). Before I begin to cover every damn exception than can occur, I'm wondering if there's a technique to query a string for values/keys using LINQ.</p>\n"},{"tags":["mysql","database","oracle","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13174298,"title":"oracle select statement reuse?","body":"<p>This is an extract sql that gets days</p>\n\n<pre><code>AND S.Date          IN\n\n  (\n    SELECT Date\n    FROM\n      (\n      SELECT Date,\n        ROW_NUMBER() OVER (ORDER BY Date DESC )-1 Day\n      FROM CALENDAR_DIM\n      WHERE TYPE               = 'ABC'\n      )\n    WHERE BUS_DAY BETWEEN 0 AND 2\n  )\n</code></pre>\n\n<p>I want to run this code twice in two parts of my sql. How can i do that without pasting the same code. Also .. how could i rewrite the above code?. I am having some issues with performance. </p>\n"},{"tags":["query","mongodb","geo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13154419,"title":"slow Mongodb $near search with additional criteria","body":"<p>I have a collection, the data look like this:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"4e627655677c27cf24000000\"),\n    \"gps\" : {\n        \"lng\" : 116.343079,\n        \"lat\" : 40.034283\n    },\n    \"lat\" : 1351672296\n}\n</code></pre>\n\n<p>And I build a compound index:</p>\n\n<pre><code>{\n    \"v\" : 1,\n    \"key\" : {\n        \"gps\" : \"2d\",\n        \"lat\" : 1\n    },\n    \"ns\" : \"test.user\",\n    \"name\" : \"gps__lat_1\"\n}\n</code></pre>\n\n<p>A pure $near query like below can be very fast ( &lt; 20ms ):</p>\n\n<pre><code>&gt;db.user.find({\"gps\":{\"$near\":{\"lng\":116.343079,\"lat\":40.034283}}}).explain()\n{\n    \"cursor\" : \"GeoSearchCursor\",\n    \"nscanned\" : 100,\n    \"nscannedObjects\" : 100,\n    \"n\" : 100,\n    \"millis\" : 23,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"isMultiKey\" : false,\n    \"indexOnly\" : false,\n    \"indexBounds\" : {\n\n    }\n}\n</code></pre>\n\n<p>But the query with \"lat\" criteria is very slow ( 900ms+ ):</p>\n\n<pre><code>&gt;db.user.find({\"gps\":{\"$near\":{\"lng\":116.343079,\"lat\":40.034283}},\"lat\":{\"$gt\":1351413167}}).explain()\n{\n    \"cursor\" : \"GeoSearchCursor\",\n    \"nscanned\" : 3,\n    \"nscannedObjects\" : 3,\n    \"n\" : 3,\n    \"millis\" : 665,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"isMultiKey\" : false,\n    \"indexOnly\" : false,\n    \"indexBounds\" : {\n\n    }\n}    \n</code></pre>\n\n<p>Can anybody explain this? Great thx!</p>\n"},{"tags":["android","query","sqlite","date","sql-order-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13172245,"title":"SQLITE raw query result not the same as in aSQLiteManager","body":"<p>I make the following query in SQLitemanager (SQL DB App for Android):</p>\n\n<pre><code>SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY SUBSTR(fahrtenbuch.startdatum,7,4), SUBSTR(fahrtenbuch.startdatum,4,2), SUBSTR(fahrtenbuch.startdatum,1,2) ASC\n</code></pre>\n\n<p>The returned order is as expected. The date is correctly sorted by <strong>dd.mm.yyyy</strong>.</p>\n\n<p>But when I execute the query in my <strong>DB-Helper class</strong>, the order is not the same.\nIn the DB-Helper class:</p>\n\n<pre><code>final String MY_QUERY = \"SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY SUBSTR(fahrtenbuch.startdatum,7,4), SUBSTR(fahrtenbuch.startdatum,4,2), SUBSTR(fahrtenbuch.startdatum,1,2) ASC\";\nreturn mDb.rawQuery(MY_QUERY, null);\n</code></pre>\n\n<p>In my activity:</p>\n\n<hr>\n\n<pre><code>Cursor curCSV = mDbHelper.fetchAllFahrtenbuchASC();\ncurCSV.moveToFirst();\nwhile(curCSV.moveToNext()) \n{\n   System.out.println(\"Date of entry: \" +curCSV.getString(18));\n} \n\ncurCSV.close();\n</code></pre>\n\n<hr>\n\n<p>Does anyone know why this is not working?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13173585,"title":"How to check if a field is updated when inserting from table to table?","body":"<p>I have the following data inserted from TableA to TableB. I'm inserting the data from TableA to TableB using a query that automatically runs every 4 hours. The query contains a insert, update and a delete.</p>\n\n<blockquote>\n  <p>Date_<strong><em>_</em>__<em>_</em>_</strong><em>Group  <strong></em>____</strong><em>State  <strong></em>___</strong><em>BeginTime  <strong></em>___</strong><em>EndTime<br>\n  2012-11-1 <strong></em>_</strong><em>A  <strong></em>__<em>_</em>__<em>_</em>__</strong><em>1     <strong></em>__<em>_</em>____</strong><em>08:00   <strong></em>__<em>_</em>___</strong>_16:00</p>\n</blockquote>\n\n<p>The application that uses TableB can also change the field State but I need to check if this is changed by the application. There is no any attribute how I can check this.</p>\n\n<p>I tried to create a new column 'FromTableA' (bit) into TableB to hold a state that means, this data coming from TableA. But when the application changes the state, the attribute FromTableA stays TRUE so I can't check this.</p>\n\n<p>Any ideas to solve the problem, using just a query? Changes in the application are not allowed.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13173252,"title":"Count and insert comments from Xoops database","body":"<p>I am trying to convert Xoops posts to Wordpress. As part of that, I want to get comment count for a topic. Post and replies are on same \"topic_id\". How to count them and post it in to new column?</p>\n\n<p><strong>DB current status</strong></p>\n\n<pre><code>topic_id | subject             |comment_count|\n+________+_____________________+_____________+\n1    | welcome             | \n1    | Re: welcome         |\n2    | hello world         |\n2    | Re: hello world     |\n2    | Re: hello world     |\n3    | hello friends       |\n</code></pre>\n\n<p>from here I want to take the (count of topic_id - 1) as the number of replays (comment count). Guide me to query in MYSQL</p>\n\n<p>I want to place the output in the same table. (comment_count)</p>\n\n<p><strong>DB expected output</strong></p>\n\n<pre><code>   | topic_id | subject             |comment_count|\n   +________+_____________________+_____________+\n   | 1   | welcome             | 1 \n   | 1   | Re: welcome         | 1\n   | 2   | hello world         | 2\n   | 2   | Re: hello world     | 2\n   | 2   | Re: hello world     | 2\n   | 3   | hello friends       | 0\n</code></pre>\n"},{"tags":["mysql","query","count","group-by"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13171133,"title":"Select maximum date with group by another columns","body":"<p>I have a table like:</p>\n\n<p><strong>gold_2012</strong></p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 41.23     | 2012-01-01   \ncity1     | type 1    | 42.23     | 2012-02-02   \ncity1     | type 1    | 40.23     | 2012-03-03   \ncity2     | type 2    | 43.23     | 2012-01-01   \ncity2     | type 2    | 45.23     | 2012-02-02   \ncity2     | type 2    | 47.23     | 2012-03-03   \ncity3     | type 3    | 48.23     | 2012-01-01   \ncity3     | type 3    | 49.23     | 2012-02-02   \ncity3     | type 3    | 44.23     | 2012-03-03   \n</code></pre>\n\n<p>How can I get 1 last result order by <code>gold_selltime</code> desc each group by <code>gold_city</code> and <code>gold_type</code>.</p>\n\n<p>I used this:</p>\n\n<pre><code>SELECT * , COUNT( * ) \nFROM  gold_2012\nGROUP BY  gold_type ,  gold_city\nORDER BY gold_selltime DESC\n</code></pre>\n\n<p>but it didn't work.<br>\nI only have result like:</p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 41.23     | 2012-01-01   \ncity2     | type 2    | 43.23     | 2012-01-01   \ncity3     | type 3    | 48.23     | 2012-01-01   \n</code></pre>\n\n<p>but I need it like:</p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 40.23     | 2012-03-03   \ncity2     | type 2    | 47.23     | 2012-03-03   \ncity3     | type 3    | 44.23     | 2012-03-03   \n</code></pre>\n\n<p>Sorry! I forget sth! Please see my edited question above.</p>\n"},{"tags":["java","query","mongodb","results"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13155328,"title":"MongoDB & Java, add a value to the result","body":"<p>I have the code as shown below. I query the MongoDB and the results are serialized and returned. But I would like to add a new value to every record/document, in this case 'age'.\nSo I thought I would loop over the results and add them with one.put but the value is not showing in the returned json.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks for any help or suggestions!</p>\n\n<pre><code>    public String (int id){     \n        DBCollection collection = database.getCollection(\"collection\");\n        BasicDBObject query = new BasicDBObject();\n        query.put(\"id\", id);\n\n        DBCursor cursor = collection.find(query);       \n        if (cursor.hasNext()) {\n            DBObject one = cursor.next();\n            one.put(\"age\", 33);\n        }\n\n        String json = JSON.serialize(cursor)\n\n        return json;\n    }   \n</code></pre>\n"},{"tags":["mysql","sql","query","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":25,"score":0,"question_id":13171594,"title":"SQL Query Throws Error 150","body":"<pre><code>SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\nSET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\nSET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';\n\nCREATE SCHEMA IF NOT EXISTS `rsmad` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;\nUSE `rsmad` ;\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_flashobjects`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_flashobjects` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `flashobject_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_html`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_html` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `html_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_iframes`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_iframes` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `iframe_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_images`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_images` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `image_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_links`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_links` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `link_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_text`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_text` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `text_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`apps`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`apps` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `webpage_id` INT UNSIGNED NOT NULL ,\n  `timestamp` DATETIME NULL ,\n  `status` ENUM('ok','malicious','good') NOT NULL DEFAULT 'ok' ,\n  PRIMARY KEY (`id`) ,\n  CONSTRAINT `fk_apps_app_flashobjects1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_flashobjects` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_html1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_html` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_iframes1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_iframes` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_images1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_images` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_links1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_links` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_text1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_text` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE)\nENGINE = InnoDB;\n</code></pre>\n\n<p>Can anyone explain what the issue with these queries is?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13170717,"title":"MS Access SQL Query - Joining 3 Tables to receive Total Order Price","body":"<p>I would like to know the total price for a specific order ID. The information is contained in these tables:</p>\n\n<p>Order_line_t</p>\n\n<pre><code>Order_ID    Product_ID    Quantity\n--------    ----------    --------\n1006        4             1\n1006        5             2\n1006        7             2\n</code></pre>\n\n<p>Uses_t</p>\n\n<pre><code>Product_ID    Material_ID    Footage\n----------    -----------    -------\n4             16             20\n5             15             13\n7             10             16\n</code></pre>\n\n<p>Raw_Materials_t</p>\n\n<pre><code>Material_ID    Unit_Price\n-----------    ----------\n16             05.70\n15             16.72\n10             15.55\n</code></pre>\n\n<p>The total cost is computed by </p>\n\n<pre><code>Multiplying SUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\n</code></pre>\n\n<p>My current query only returns an error:</p>\n\n<pre><code>SELECT Order_line_t.Order_ID, Order_line_t.Product_ID, Uses_t.Product_ID   ,Uses_t.Footage , \nSUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\nFROM Order_line_t, Uses_t , Raw_Materials_t\nWHERE  Order_line_t.Order_ID = 1006;\n</code></pre>\n\n<p>Help appreciated! How exactly do I JOIN these tables? What am i missing?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13170561,"title":"PHP how to check if a returned row contains duplicate values?","body":"<pre><code>&lt;?php\ninclude('includes/connection.php');\n\n$query = 'select a, c from b';\n$result = mysql_query($query, $con);\n$num_rows = mysql_num_rows($result);\n\nif ($num_rows &gt; 0)\n{\n    echo '&lt;p&gt;';\n    while($row = mysql_fetch_array($result))\n    {\n         echo \"{$row[\"a\"]}\";\n    }\n    echo '&lt;/p&gt;';\n}\n?&gt;\n</code></pre>\n\n<p>Table \"b\" has these values in column \"a\"</p>\n\n<pre><code>Table b\n-------\na     c\n-     -\n1     a\n1     a1\n1     a2\n2     a\n3     b\n4     b\n</code></pre>\n\n<p>I would like to be able to in my while loop determine if the returned row is a duplicate and discard it. I only want the number 1 in this case to show up once. How can I go about doing this?</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13169921,"title":"Using SQL to create football fixtures?","body":"<p>Quite hard to explain but say I have a table named 'Teams' and It contains 5 teams like so:</p>\n\n<pre><code> team_id, teamname, manager\n   1,       Team1,    1\n   2,       Team2,    10\n   3,       Team3,    3\n   4,       Team4,    5\n   5,       Team5,    6\n</code></pre>\n\n<p>I need to create another table looking similar to this (named TeamFixtures for example)</p>\n\n<pre><code>  id, HomeTeam, HomeScore, AwayScore, AwayTeam\n                  NULL        NULL\n</code></pre>\n\n<p>How would I make the HomeTeam and AwayTeam be the team_id of the 'teams' table?</p>\n\n<p>Id need this for each team so they play against each other twice, home and away games.</p>\n\n<p>Is there a Query that could make this quicker for me, rather than typing out the fixtures 1by1</p>\n"},{"tags":["query","cakephp","cakephp-2.0","condition"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13167968,"title":"How do I restrict query results based on sub-results in CakePHP?","body":"<p>In CakePHP if I run the following find command</p>\n\n<pre><code>$this-&gt;Instructor-&gt;find('all');\n</code></pre>\n\n<p>the following is returned:</p>\n\n<pre><code>Array\n(\n    [0] =&gt; Array\n        (\n            [Instructor] =&gt; Array\n                (\n                    [id] =&gt; 1\n                    [user_id] =&gt; 3\n                    [bio] =&gt; A billionaire playboy, industrialist and ingenious engineer, Tony Stark suffers a severe chest injury during a kidnapping in which his captors attempt to force him to build a weapon of mass destruction. He instead creates a powered suit of armor to save his life and escape captivity. He later uses the suit to protect the world as Iron Man.\n                )\n\n            [User] =&gt; Array\n                (\n                    [id] =&gt; 3\n                    [first_name] =&gt; Tony\n                    [last_name] =&gt; Stark\n                    [asurite_user] =&gt; tstark\n                    [asurite_id] =&gt; \n                    [password] =&gt; \n                    [email] =&gt; tstark@example.com\n                    [created] =&gt; 2012-10-30 09:57:36\n                    [modified] =&gt; 2012-10-30 09:57:36\n                )\n\n            [Course] =&gt; Array\n                (\n                    [0] =&gt; Array\n                        (\n                            [id] =&gt; 1\n                            [slug] =&gt; beatles\n                            [sln] =&gt; AAA001\n                            [course_number] =&gt; \n                            [title] =&gt; The Beatles\n                            [description] =&gt; This is a class about the Beatles.  If this were a real description, more information would be listed here.\n                            [state] =&gt; \n                        )\n\n                    [1] =&gt; Array\n                        (\n                            [id] =&gt; 2\n                            [slug] =&gt; elvis\n                            [sln] =&gt; AAA002\n                            [course_number] =&gt; \n                            [title] =&gt; Elvis: The King of Rock\n                            [description] =&gt; All about the king of rock and roll, Elvis Presley.\n                            [state] =&gt; \n                        )\n\n                )\n\n        )\n\n    [1] =&gt; Array\n        (\n            ...\n</code></pre>\n\n<p>There is a many-to-many relationship between \"Instructor\" and \"Course\". How can I filter the results based on the \"Course\"s each \"Instructor\" belongs to?  I tried the following without success:</p>\n\n<pre><code>$instructors = $this-&gt;Instructor-&gt;find('all', array(\n    'conditions' =&gt; array('Course.id' = 2)\n));\n</code></pre>\n"},{"tags":["php","database","wordpress","query","multiple-tables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13169276,"title":"Unable to insert data into multiple wordpress tables","body":"<p>I am creating WordPress tags import/export plugin. but I am having an issue.</p>\n\n<p>As we know Tags are actually occupying <code>wp_terms</code> in the database and as well as <code>wp_term_taxonomy</code>.</p>\n\n<p>So I come up with a plan but its not working.</p>\n\n<p>Please check the following codes and let me know how can I fix the issue. Because I am importing <code>name</code> and <code>slug</code> from excel file and trying to save in <code>wp_terms</code> table as well as trying to save <code>term_id</code> into <code>wp_term_taxonomy</code>.</p>\n\n<pre><code>if (( $file_ext == \"xls\" ) &amp;&amp; ( $file_size &lt; 500000 )) \n{       \n    $data = new Spreadsheet_Excel_Reader();\n    $data-&gt;setOutputEncoding('CP1251');\n    $data-&gt;read($_FILES['tag_import']['tmp_name']);\n\n    for ($i = 1; $i &lt;= $data-&gt;sheets[0]['numRows']; $i++)\n    {\n        for ($j = 1; $j &lt;= $data-&gt;sheets[0]['numCols']; $j++)\n        {\n            // add the new category \n            $query = \"INSERT INTO $wpdb-&gt;terms (name, slug) VALUES (%s, %s)\";\n            $wpdb-&gt;query($wpdb-&gt;prepare($query, $data-&gt;sheets[0]['cells'][$i][0], $data-&gt;sheets[0]['cells'][$i][1])); \n\n            // create the relationship \n            $query = \"INSERT INTO $wpdb-&gt;term_taxonomy (term_id, taxonomy) VALUES (%d, %s)\";  \n            $wpdb-&gt;query($wpdb-&gt;prepare($query, LAST_INSERT_ID, 'post_tag'));           \n        }\n    }\n}\nelse  \n{\n    echo \"&lt;div class='error'&gt;&lt;p&gt;Invalid file or file size too big.&lt;/p&gt;&lt;/div&gt;\";\n}\n</code></pre>\n\n<p>Please check and let me know.</p>\n"},{"tags":["oracle","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13169095,"title":"SSRS BIDS Error when executing oracle query (This command is not supported by this provider)","body":"<p>I am creating a SSRS report which directly gets the data from oracle. </p>\n\n<p>When i run this query in the \"query designer\" then i am getting an error saying</p>\n\n<p>\"This Command is not supported by this provider\".</p>\n\n<p>I had tried using 'Oracle' and 'OLEDB' connection types but they didn't worked.</p>\n\n<p>I am using Microsoft Visual Studio 2008.</p>\n\n<p>Please advise me on this</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13169119,"title":"How to query a range of columns MYSQL","body":"<p>I have a table in MYSQL and I'd like to start querying after the first 5 columns and every column from then on. </p>\n\n<p>Is there a way I could something like</p>\n\n<pre><code> select * from table where column 5 begins  \n</code></pre>\n\n<p>Also I know that at the 5th column the headers are numbers. So it could also be something like </p>\n\n<pre><code>Select * from table where headers=[0-9]\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13168966,"title":"Structuring select statement from MySQL database","body":"<p>I have 4 tables that I am using to try and get the customer orders they are:</p>\n\n<pre><code>account\n- account_id\n- username\n\nproduct\n- product_number\n- product_name\n\ncustomer_order\n- customer_order_id\n- fk_account_id (foreign key)\n\ncustomer_order_details\n- fk_customer_order_id (foreign key)\n- fk_product_id (foreign key)    \n</code></pre>\n\n<p>This is my query... it's a bit confusing but:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT customer_order_details.fk_customer_order_id, product.product_name,\ncustomer_order_details.colour, customer_order_details.size\nFROM customer_order, customer_order_details, product, account\nWHERE customer_order.customer_order_id = \ncustomer_order_details.fk_customer_order_id\nAND customer_order_details.fk_product_id = product.product_id\nAND customer_order.fk_account_id = account.account_id\nAND account.username = 'user1'\nGROUP BY customer_order_details.fk_customer_order_id;\n</code></pre>\n\n<p>It should group by the foreign key (fk_customer_order_id) in the customer_order_details table. The results that I want are like this:</p>\n\n<pre><code>1\nMicrofleece Vest\nJacket With Hood\n\n2\nJacket With Hood\n</code></pre>\n\n<p>Instead I get something like:</p>\n\n<pre><code>1\nMicrofleece Vest\n\n2\nJacket With Hood\n</code></pre>\n\n<p>My PHP code is simply running through a while loop and printing out the product_name and fk_customer_order_id.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13166647,"title":"Trouble Joining 3 Tables","body":"<p>I am new to writing SQL queries and have been trying to pull information from 3 different tables and link it together.  </p>\n\n<p>Data resides in Microsoft SQL Server.  </p>\n\n<p>This is my current query (which is not working the way I intend it to):  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhpart, h.jhrev, h.jhcust, h.jhextd, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend \nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 \nORDER BY h.jhjob\n</code></pre>\n\n<p>To explain what I am trying to do.  I have a job header table <strong>Jhead</strong>, a job detail table <strong>jjops</strong> and a purchase order detail table <strong>hpodt</strong>.  I believe the job number is the primary key in the jhead table.</p>\n\n<p>Here is my problem:  As soon as I add the second left join I end up with a lot of extra lines of duplicated information. </p>\n\n<p>I have tried using the GROUP BY jhead.jhjob but get the following error: </p>\n\n<p>“Column ‘jhead.jhhold’ is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.”</p>\n\n<p>So I researched the error with one of the solutions being to make my GROUP BY look like this:\nGROUP BY jhead.jhjob, jhead.jhhold, jhead.jhpart, jhead.jhrev, jhead.jhcust, jhead.jhextd</p>\n\n<p>But then as soon as I put in jhead.jhextd I get this error:\n“The text, ntext, and image data types cannot be compared or sorted, except when using IS NULL or LIKE operator.”</p>\n\n<p>And have now hit a brick wall.  I did see that you can change the type to NVARCHAR.  I don’t really want to be sorting by the description field because it is unique and may be very taxing on the server.  Is there a better way to do this?  </p>\n\n<p><strong>Edit With Sample Data:</strong>\nI removed extra fields to simplify the query and have filtered the results for 1 job number.</p>\n\n<p>With only 1 left join:\n<img src=\"http://i.imgur.com/Gd3J5.jpg\" alt=\"With only 1 Left Join\"></p>\n\n<p>With both left joins:\n<img src=\"http://i.imgur.com/Woaog.jpg\" alt=\"Second\"></p>\n\n<p>ERP software as you can see has multiple jobs under 1 PO# and I am only interested in displaying lines with a job number that matches.\n<img src=\"http://i.imgur.com/nZzXx.jpg\" alt=\"Third\"></p>\n\n<p><strong>QUERY UPDATED</strong> </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd\nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo\nORDER BY h.jhjob\n</code></pre>\n\n<p>This is getting close to what I want.  The problem is now that my jadesc field is duplicating the first result when it should actually be different for each line.</p>\n\n<p><img src=\"http://i.imgur.com/9o7du.jpg\" alt=\"4\"></p>\n\n<p>I filtered to just display one job.  Their should only be one column.</p>\n\n<p><strong>Getting extra lines but have all the data I need</strong>  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd, p.hdseq \nFROM Jhead AS h \nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo AND p.hdseq = o.jaseq AND o.jaopr != 'PT') \n  OR (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND o.japo = 0 AND o.jaopr != 'PT')\nORDER BY h.jhjob, o.jaseq\n</code></pre>\n"},{"tags":["sql","query","sqlite","table","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13167464,"title":"query returning consecutive rows with matching value","body":"<p>assume i have the following table:</p>\n\n<pre><code>data_point (creation_datetime DATETIME PRIMARY KEY, \n            data_point INTEGER);\n</code></pre>\n\n<p>i am looking for an SQL query that would not only tell me if the most recent entry has a data_point value of X, but how many consecutive rows after it also have X as a value.</p>\n\n<p>for instance, assuming the following data:</p>\n\n<pre><code>creation_datetime       data_point\n2012-10-31 12:00:00     0\n2012-10-31 11:55:00     0\n2012-10-31 11:50:00     0\n2012-10-31 11:45:00     2\n2012-10-31 11:40:00     0\n</code></pre>\n\n<p>if i had X=0, the number i would want back here would be 3, because the most recent value matches X, and the next 2 rows also match it.</p>\n\n<p>i don't have any ID column or anything.  i could add one if need be, but i'd like to avoid it.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13163478,"title":"Updates which include auto increment column","body":"<p>I am using PostgreSQL and I would like to update a table which would include an auto number column id. I know it might something very simple but I have done something like this;</p>\n\n<pre><code>CREATE SEQUENCE  SEQ_ID\nMINVALUE 1\nSTART WITH 1\nINCREMENT BY 1\nCACHE 10\n\nupdate trk2\nset (id, track_id, track_point) =\n           (select nextval('seq_id'), trk1.track_fid, trk1.wkb_geometry\n              from track_points_1 as trk1\n             where track_fid = 0)\n</code></pre>\n\n<p>The thing is that it is giving me the following error (<em>code reformatted</em>):</p>\n\n<pre><code>ERROR:  syntax error at or near \"select\"\nLINE 3: set (id, track_id, track_point)=(select nextval('seq_id'), t...\n</code></pre>\n\n<p>Can anybody help please?</p>\n"},{"tags":["query","grails","groovy","gorm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":34,"score":0,"question_id":13167176,"title":"Grails Query, How to get a specific field in the result?","body":"<p>I have the domain class:</p>\n\n<pre><code>class Product {\n\n    String barcode\n    String name\n    String measurement\n\n    static constraints = {\n\n    }\n}\n</code></pre>\n\n<p>Now, I want to get a list with only one field like \"name\":</p>\n\n<blockquote>\n  <p>Product.findAllByNameIlike(\"%$params.name%\",[order: \"desc\" ])</p>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13167577,"title":"SQL add month to a query without calendar table","body":"<p>I have a pretty simple table here:</p>\n\n<hr>\n\n<p><strong>Table1</strong><br>\nID<br>\nDate1<br>\nDate2<br>\nDate3  </p>\n\n<hr>\n\n<p>I want to summarize the data by month and ID so the query result comes out like this:</p>\n\n<hr>\n\n<p><strong>Query Result of table1</strong><br>\nID<br>\nMonth<br>\nCount of Date1 from the month that's not null<br>\nCount of Date2 from the month that's not null<br>\nCount of Date3 from the month that's not null    </p>\n\n<hr>\n\n<p>I currently have this query below that only pulls one month depending on what @month is specified to:</p>\n\n<pre><code>Select ID, @month as [Month]  \nSum((Case When Month(Date1)=@month then 1 else 0 END)) as [Date1 Count],   \nSum((Case When Month(Date2)=@month then 1 else 0 END)) as [Date2 Count],  \nSum((Case When Month(Date3)=@month then 1 else 0 END)) as [Date3 Count],  \nFrom Table1  \nGroup by ID \n</code></pre>\n\n<p>But I want to pull <strong>all 12 month</strong>, however the database does not have a month table or calendar table, how can I create a query that will include all 12 month for each IDs and get their corresponding monthly counts for Date1, Date2, and Date3?  Btw, a lot of the entries have one of the Dates empty, e.g. Date1 and Date3 = Null whereas Date2 = '01/01/2008'.  Thanks in advance!</p>\n"},{"tags":["php","mysql","query","phpexcel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13166502,"title":"Hardcoding headers to excel file using PHP while dynamically querying SQL","body":"<p>I have this <strong>PHPExcel</strong> code:</p>\n\n<pre><code>/** Error reporting */\nerror_reporting(E_ALL);\ndate_default_timezone_set('Europe/London');\n\n/** Include PHPExcel */\nrequire_once '../Classes/PHPExcel.php';\n    $objPHPExcel = new PHPExcel();\n    //$objPHPExcel-&gt;setActiveSheetIndex(0)\n               // -&gt;setCellValue('A1', 'Hello')\n               // -&gt;setCellValue('A2', 'world!')\n\n$row = 2; \nwhile($row_data = mysql_fetch_assoc($result)) {\n    $col = 1;\n    foreach($row_data as $key=&gt;$value) {\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n$col++;\n    }\n        $row++;\n    }\n\n// Rename worksheet\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Results');\n\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n// Redirect output to a client’s web browser (Excel5)\nheader('Content-Type: application/vnd.ms-excel');\nheader('Content-Disposition: attachment;filename=\"Output.xls\"');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\n$objWriter-&gt;save('php://output');\nexit;\n</code></pre>\n\n<p>Basically I am dynamically querying the database and placing it into an excel file. </p>\n\n<p>I just want to hardcode in a few headers. So for A1 I'd like to hardcode in \"Hello\" and A2: \"World!\" while querying the database and putting the data starting in Column B</p>\n"},{"tags":["android","query","sqlite","date","sql-order-by"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13166445,"title":"SQLITE DB sort query by string formatted date field","body":"<p>I have a SQLITE DB with a string field which contains a date in the following format: \"01.01.2012\".\nWhat I want is to sort the by this string formatted date in a query.\nI tried this without success:</p>\n\n<pre><code>SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY strftime ('%d.%m.%Y', fahrtenbuch.startdatum)\n</code></pre>\n\n<p>What I am doing wrong?</p>\n"},{"tags":["php","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13121436,"title":"add an onChange function to this dynamically populated select field to echo result to a textfield","body":"<p>I checked the boards and Googled for this code but couldn't find anything.  Any help would be greatly appreciated.  </p>\n\n<p>I have worked through a tutorial that queries a database for a car model based on the car make.  In the code, the car make is hardcoded to the select while the car model is dynamic.  Here's the first part of the code: </p>\n\n<pre><code>    &lt;?php \n    require_once(\"Connections/xxx.php\"); // database connection\n\n    $make = $_POST['make'];\n\n\n    if ($make){\n    $query= sprintf(\"SELECT * FROM car_model where car_model_id='$make'\");\n    $result = @mysql_query($query); \n    $rowModel = mysql_fetch_array($result);\n    }\n    ?&gt;\n</code></pre>\n\n<p>Here's the select hard code:</p>\n\n<pre><code>&lt;select name=\"make\" onChange=\"document.forms[0].submit()\"&gt;\n&lt;option value=\"\"&gt;Select Make&lt;/option&gt;\n&lt;option value=\"1\" &lt;?php if(!(strcmp(1, $make))){echo \"selected\";}?&gt;&gt;Alfa Romeo&lt;/option&gt;\n&lt;option value=\"2\" &lt;?php if(!(strcmp(2, $make))){echo \"selected\";}?&gt;&gt;Audi&lt;/option&gt;\n&lt;option value=\"3\" &lt;?php if(!(strcmp(3, $make))){echo \"selected\";}?&gt;&gt;BMW&lt;/option&gt;\n&lt;option value=\"4\" &lt;?php if(!(strcmp(4, $make))){echo \"selected\";}?&gt;&gt;Citroen&lt;/option&gt;\n</code></pre>\n\n<p></p>\n\n<p>And this is the dynamically populated select:</p>\n\n<pre><code> &lt;select name=\"model\"&gt;\n&lt;option value=\"\"&gt;Select Model&lt;/option&gt;\n&lt;?php do {  ?&gt;\n&lt;option value=\"&lt;?php echo $rowModel['car_model_id']; ?&gt;\"&gt;&lt;?php echo $rowModel['car_model']; ?&gt;&lt;/option&gt;\n&lt;?php  }while ($rowModel = mysql_fetch_array($result));  ?&gt;\n</code></pre>\n\n<p></p>\n\n<p>I would like to add an onChange function to this dynamically populated select field to echo result to a textfield and I have tried many combinations but haven't been able to figure this out.  Thank you      </p>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13166566,"title":"sql how to write complicated query for noob?","body":"<p>Here is my tables</p>\n\n<pre><code> Student (sname, sid, gpa, level, deptno) \n Course (cno, cname, deptno, units) \n Dept (dname, deptno) \n Takes (sid, cno) \n</code></pre>\n\n<p>Write a SQL query that returns the names (i.e., snames) of students who have taken \nmore courses outside their department than inside their department.you can \nassume that all students in the database have taken at least one course inside their department.</p>\n\n<p>I am not looking for any solutions for this question, but still welcome for any answer.\nBut I more hoping people can tell me how to generate the steps to write a complicated query like this..</p>\n\n<p>My answer is </p>\n\n<pre><code> Select S.sname\n From Student S, Course C, Dept D, Takes T\n Where T.cno=C.cno and D.deptno=C.deptno and S.sid = T.sid\n Having COUNT(S.deptno=C.deptno) &gt; COUNT( S.deptno != C.deptno)\n</code></pre>\n\n<p>I am not sure I can use the count after HAVING in this way or not .\nThanks</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13165703,"title":"SQL update table data query","body":"<p>I want to run update query to update PercentAvailability column value 0 to 100 between specified date period in my case <code>2012-10-28 03:31:01 to 2012-10-28 08:31:01</code>. see following picture.</p>\n\n<p><img src=\"http://i.stack.imgur.com/HQdGV.png\" alt=\"enter image description here\"></p>\n\n<p>How do i run query to update above data between specified date?</p>\n\n<p>Note: I have many ApplicationID which has this issue so how could i run query against all ApplicationID, I believe we need to run JOIN syntax but it would be good if you give some short of hint. </p>\n"},{"tags":["sql","linq","query"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1467,"score":5,"question_id":6190620,"title":"how to convert linq query to sql","body":"<p>Just trying to get the sql that is generated by a linq query.</p>\n"},{"tags":["sql","sql-server","query","insert","where-in"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13165550,"title":"where in sql server query update number list one field to another","body":"<p>I am using SQL Server, and in the query below, I have a concern.  I am not sure if the field on the left will update with the field on the right (coming from the same table) when I do a where in list.</p>\n\n<pre><code>update loc \nset locShortName = locName \nwhere locid in (3,4,11,13,14,15,16,18,19,20,21,24,32,41,45,68,69,77,82,85)\n\nupdate loc set locShortName = locName where locid = 3 (move to next record in the list)      \nupdate loc set locShortName = locName where locid = 4 (move to next record in the list)\nupdate loc set locShortName = locName where locid = 11(move to next record in the list)\n</code></pre>\n\n<p>and so on...</p>\n\n<p>I would think it would take the fist number in the list and address the field value setting, then move to the next in the list.</p>\n\n<p>Are my expectations correct?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13159382,"title":"how can I add same value in two different tables","body":"<p>i m trying to add custom list of tags using excel file and I have done most of the work. but i am confused that how can I add same value in 2 different tables columns.</p>\n\n<p>i had inserted the values in </p>\n\n<pre><code>INSERT INTO `steve`.`wp_terms` (`term_id`, `name`, `slug`, `term_group`) VALUES (NULL, 'tag99', 'tag99', '0');\n</code></pre>\n\n<p>and </p>\n\n<pre><code>INSERT INTO `steve`.`wp_term_taxonomy` (`term_taxonomy_id`, `term_id`, `taxonomy`, `description`, `parent`, `count`) VALUES (NULL, '21', 'post_tag', '', '0', '0');\n</code></pre>\n\n<p>now i want to add term_id in both table .. could somebody tell me how can i do that?</p>\n\n<p>AND <code>term_id</code> is database generated value.</p>\n"},{"tags":["android","database","query","sms","contact"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13165469,"title":"Android: get all SMS from contact","body":"<p>I'm trying to get all SMS from all contacts.</p>\n\n<p>The problem is when I query database, same (bat not the same) number isn't recognized as a single entity. For example (IT international prefix is +39):\n    +39123456789\n    123456789\n    123 456 789\n    123-456-789</p>\n\n<p>This is 4 versions of same number, but database don't recognize equality.\nSo, how can I retrieve all SMS from contact number? Number of versions are virtually infinite, but all applications I founded in market haven't same issue.</p>\n\n<p>Any idea to get all SMS from address number in all versions?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":13163955,"title":"Find row which has unique values with respect to some of its columns","body":"<p>My SQL table is something like this:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n3, abc, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n5, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I want to write a Sql query which returns rows which has <strong>any</strong> of their values (read: value1,value2,value3,value4) changed. So the result output would be:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I understand, if I just needed values in output I could have used Distinct or Group by like:</p>\n\n<pre><code>select distinct value1,value2,value3,value4 from table;\n</code></pre>\n\n<p>But, here I need id and name columns too in output.</p>\n\n<p>Wondering if I really need to write a subquery or create virtual/inner table to get my result. Or, there is a smarter way?</p>\n\n<p>My question is not similar to <a href=\"http://stackoverflow.com/questions/6941049/how-to-find-out-whether-a-table-has-some-unique-columns\">How to find out whether a table has some unique columns</a>. Let me know if you think otherwise, I can clarify.</p>\n"},{"tags":["ruby","query","mongodb","mongoid3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13163897,"title":"How to find all and sort by count?","body":"<p>How to build a query that returns all entities sorted desc by count embedded post ids?</p>\n\n<p>Sample data:</p>\n\n<pre><code>{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test\",\n  \"post_ids\" : \n    [ ObjectId( \"5090f8061e7bf28095000010\" ) ],\n    [ ObjectId( \"5090f8061e7bf28095000011\" ) ] },\n{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test2\",\n  \"post_ids\" : [ \n    ObjectId( \"5090f8061e7bf28095000010\" ), \n    ObjectId( \"509104ec1e7bf2989b00000b\" ), \n    ObjectId( \"509105001e7bf2989b00000f\" ) ] }\n\n#my actual query returns only count:\ntags_by_count = Tag.desc(:post_ids).count\n</code></pre>\n"},{"tags":["php","sql","query","duplicates","ignore"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13163474,"title":"Do Not Duplicate VALUE if already exist on MySQL","body":"<p>I've been trying to accomplish this, but as other issues I just can't figured it out. I've been reading around for posibles solutions but non of them goes along with my code, or if they do I can't figure out how or where to use them.</p>\n\n<p>I have a DB where a user sends records. The database consist in few tables containing the Following \"<strong>Name, Lastname, Phone</strong>\". If any of this values is duplicate,  I would like my code to identify and <strong>Ignore</strong> the submission of the Form <strong>if ALL this VALUES already exist on the DB</strong>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>        &lt;?php\n\n        $con = mysql_connect(\"HOST\",\"USER\",\"PASS\");\n        if (!$con)\n          {\n          die('Could not connect: ' . mysql_error());\n          }\n\n        mysql_select_db(\"testdb\", $con);\n        $sql=\"INSERT INTO people (Name, LastName, Phone)\n        VALUES\n        ('$_POST[Name]','$_POST[LastName]','$_POST[Phone]')\";\n\n        if (!mysql_query($sql,$con))\n          {\n          die('Error: ' . mysql_error());\n          }\n\n        echo \"Record Added\";\n\n        mysql_close($con);\n        ?&gt;\n</code></pre>\n\n<p>Like I said, I've tried may ways but can't figure it out yet, I'm starting to learn, so excuse me if is something very simple. Thanks a lot everyone!!</p>\n"},{"tags":["query","tornado","unbound"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13163370,"title":"Array empty or not. How to choose to render with Tornado the page","body":"<p>In an handler of Tornado web server I have this code:</p>\n\n<pre><code>.........\n\n# Retrieve the sensors \n    sens = self.db.query(\"SELECT * FROM devices \\\n                          WHERE network_id=%s\", nid)\n    self.unlock_tables()\n..............\n# Render the networks page\n    self.render(\"sensors.html\", sensors=sens, perms=perms, net=net, action=action, writeable=writeable, sens_config=sens_config, users=user)\n..........\n</code></pre>\n\n<p>Now in the html page I have a part of code like this:</p>\n\n<pre><code> {% for sens in sensors %}\n .............\n {% end %}\n</code></pre>\n\n<p>But obviously when I have some sensors and then I delete them, after the last sensor delete I obtain this error:</p>\n\n<p><em>UnboundLocalError: local variable 'sens' referenced before assignment</em></p>\n\n<p>because the sens array in Tornado is empty I think.</p>\n\n<p>If I put the if...end block in a {% if sensors %}...{% end %} block is the same because the page didn't recognize at the same time the variable sens.</p>\n\n<p>How can I exclude the part in the if...end statement if the query result sens is empty?</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["sql-server","database","query","table","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13159879,"title":"SQL Select Data","body":"<p>I have a table set up, it is a customers' repayment schedule for a product.</p>\n\n<p>My table consists of the following fields:</p>\n\n<blockquote>\n  <p>SaleID | PaymentDueDate | AmountDue</p>\n</blockquote>\n\n<p>What I need for each Sale is:</p>\n\n<blockquote>\n  <p>SaleID | FirstPaymentDate | FirstPaymentValue | RegularPaymentValue | FinalPaymentvalue</p>\n</blockquote>\n\n<p>Each repayment schedule has the following characteristics:</p>\n\n<p>First payment amount is defined by the customer.\nRegular and final payments are dictated by the balance remaining.</p>\n\n<p>e.g</p>\n\n<p>Sale = £200\nTerm = 14 Weeks (14 Payments)</p>\n\n<p>First Payment = £50 (x1)</p>\n\n<p>Regular Payment = £12 (x12)</p>\n\n<p>Final Payment = £6 (x1)</p>\n\n<p>Please can you advise how I can retrieve what I need.</p>\n\n<p>ADDITION:\nCode So Far:</p>\n\n<p>This is what I have achieved so far, but this only gets me the First Payment and First Payment Date for each Sale:</p>\n\n<pre><code>SELECT      \nFP.SaleID, FP.FirstPaymentDate, RS.AmountDue AS FirstPayment \nFROM    \n(       \nSELECT SaleID, MIN(PaymentDueDate)AS FirstPaymentDate       \nFROM RepaymentSchedule          \nGROUP BY SaleID     \n) AS FP \nLEFT OUTER JOIN\nRepaymentSchedule AS RS ON FP.SaleID = RS.SaleID AND FP.FirstPaymentDate =   RS.PaymentDueDate ORDER BY RS.SaleID\n</code></pre>\n\n<p>ADDITION:\nData Sample:\n£280 over 14 Weeks</p>\n\n<pre><code>SaleID  PaymentDueDate            AmountDue\n41      2012-08-29 00:00:00.000   120.00\n41      2012-09-05 00:00:00.000   12.30\n41      2012-09-12 00:00:00.000   12.30\n41      2012-09-19 00:00:00.000   12.30\n41      2012-09-26 00:00:00.000   12.30\n41      2012-10-03 00:00:00.000   12.30\n41      2012-10-10 00:00:00.000   12.30\n41      2012-10-17 00:00:00.000   12.30\n41      2012-10-24 00:00:00.000   12.30\n41      2012-10-31 00:00:00.000   12.30\n41      2012-11-07 00:00:00.000   12.30\n41      2012-11-14 00:00:00.000   12.30\n41      2012-11-21 00:00:00.000   12.30\n41      2012-11-28 00:00:00.000   12.40\n</code></pre>\n\n<p>I guess the FinalPaymentValue is not too crucial.</p>\n\n<p>Really I just need to know how to work out what the regular payment is.</p>\n"},{"tags":["linq","query","exception","table","datacontext"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":909,"score":1,"question_id":4414523,"title":"LINQ Exception: \"Queries with local collections are not supported.\" but not using a local collection","body":"<p>Using the AdventureWorks database's Products table as the example, I have created a DBML and extended the properties of the DataContext to include a new property:</p>\n\n<pre>\npartial class AdventureWorksDataContext\n{\n  public IQueryable&lt;Product&gt; FinishedProducts\n  {\n    get { return Products.Where(p => p.FinishedGoodsFlag); }\n  }\n}\n</pre>\n\n<p>The Products property is part of the generated DataContext and all I've done is add a Where from the Table&lt;Product&gt; so it returns an IQueryable.</p>\n\n<p>Now, the problem comes in when trying to query it like this (dumb example but one that should show the problem):</p>\n\n<p><code>var queryFinishedProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.FinishedProducts.Max(p =&gt; p.ProductID));</code></p>\n\n<p>Iterating this query results in \"Queries with local collections are not supported\" exception. I don't understand why it would throw that error when there are no local collections being used. If I run it against the normal Products table (which is a <code>Table&lt;Product&gt;</code>):</p>\n\n<p><code>var queryProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.Products.Max(p =&gt; p.ProductID));</code></p>\n\n<p>...it works fine. The only difference is that I added a Where to the <code>Table&lt;Product&gt;</code> and returned it as an <code>IQueryable&lt;Product&gt;</code>.</p>\n\n<p>Anyone have any ideas? TIA</p>\n"},{"tags":["php","mysql","query","execute","page-refresh"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13160927,"title":"PHP include mysql query, use header to prevent query re-execution, but where to echo out the notifications?","body":"<p>My code when F5 re-executes a query:</p>\n\n<pre><code>if (isset($_POST['addnewproject']) )\n{\n    include(\"query/pm_addnewproject.php\");\n    echo $emailnotificationmessage;\n}\n</code></pre>\n\n<p>To prevent query re-execution after pressing F5 or page reload I have to modify a header and place it in the first rules (before any output) of the .php page. So:</p>\n\n<pre><code>    if (isset($_POST['addnewproject']) ) \n    {\n        include(\"query/pm_addnewproject.php\");\n        header(\"Location:pm_configureaccounting.php?edit=$_SESSION[accidsession]\");\n\n        echo $emailnotificationmessage; exit();\n\n    }\n</code></pre>\n\n<p>Because of the header, I now lose the $emailnotificationmessage I wanted to echo out somewhere middle of the page.</p>\n\n<p>What's the best thing to do now when I want to still echo this out?</p>\n\n<p>Now I changed the $emailnotificationmessages to $_SESSION['emailnotificationmessage'] and echo it out where I want it.</p>\n\n<p>But I need to unset this session too, else it keeps showing the user.</p>\n\n<p>So when I place <code>echo $_SESSION['bla']</code> somewhere middle of the page, it has a value there. It works. But I need to clear it after so when the user visits again, it wont show any message unless project is added again. So I place <code>$_SESSION['bla'] = \"\";</code> at the end of the page, and still, this SESSION gets the value <code>\"\"</code> ?! How is this possible? </p>\n"},{"tags":["mysql","database","query","constraints","unique"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13158079,"title":"How to add a constraint on all the columns of a table in a single query?","body":"<p>I have a database named dbapp. I need to add the constraint 'NOT NULL' to all the columns of all the tables in this database. I am unable to form this query. Even if I am able to perform it individually on each table, it would be fine. Please help.</p>\n"},{"tags":["sql","oracle","query","isqlquery"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13062683,"title":"Oracle SQL compare strings containing numbers, starting with 0 (zero)","body":"<p>I have a Date column, which is actually not in a date format.\nThe date looks like: <code>25/10/2012</code>.\nNow I have to compare 2 dates, but I cant find a pattern to do this, as the format is wrong.</p>\n\n<p>What I have tried is: </p>\n\n<pre><code> SELECT * \n   from PARAMETER\n  where NAME like 'Date_To' and SUBSTR(VALUE, 1, 2)&lt;'25' \n    and SUBSTR(VALUE, 1, 2)&gt;'05'\n</code></pre>\n\n<p>The problem I am facing is that this part: <code>SUBSTR(PA_VALUE, 1, 2)&gt;'05'</code> is not working as there is a 0(zero) infront of the number. Are there any solutions?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13159966,"title":"mysql timestamp in between query","body":"<p>In the below i have a table1,table2 ,i am stuck with a query.I want find the timestamps in table2 which are in between two consecutive timestamps of table1 .How to form this query.</p>\n\n<p>table1:</p>\n\n<pre><code>   id    timestamp\n    1    2012-08-15 01:11:11\n    1    2012-08-15 01:11:14\n    1    2012-08-15 01:11:16 \n    2    2012-08-15 01:22:11\n    2    2012-08-15 01:32:11\n    2    2012-08-15 01:33:11\n    2    2012-08-15 01:36:11\n</code></pre>\n\n<p>table 2: </p>\n\n<pre><code>   id    timestamp\n    1    2012-08-15 01:11:12\n    1    2012-08-15 01:11:15\n    1    2012-08-15 01:11:16 \n    2    2012-08-15 01:23:55\n    2    2012-08-15 01:26:11\n    2    2012-08-15 01:34:11\n    2    2012-08-15 01:36:01\n</code></pre>\n\n<p>Desired output:Get all rows of table2 which are in between the timestamps of table1 and if possible output timestamp of table1 also</p>\n"},{"tags":["java","query","hibernate","collate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13160476,"title":"How I should use COLLATE in Hibernate Query","body":"<p>I'am trying to use COLLATE statment in a Hibernate SQL query but, it doesn't reconise the statment.</p>\n\n<pre><code>CONSULTA: FROM Articulos WHERE activo=0 and (codigodearticulo like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' or descripcion like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI'  or descripcionadicional like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' ) and codigodelinea in (select CODIGODELINEA from Lineas where CATAUTOPARTES='1')\n</code></pre>\n\n<p>And when app compile, Hibernate return this exception :</p>\n\n<pre><code>- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- Error hibernate: unexpected token: COLLATE near line 1, column 107\n</code></pre>\n\n<p>I can't find the problem, in mi MSSQL Server it works fine.</p>\n\n<p>Thanks you!</p>\n"},{"tags":["sql","query","ms-access","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13158913,"title":"Concatenate 2 rows in a complex SQL query","body":"<p>I'm using MS-Access 2003 with the query creator. I select everything from one table (<code>FaitsSaillants</code>), then one specific row (<code>WHERE VARIABLE='TitreMandat'</code>) from another table (<code>tb_SOMMAIRE</code>). I want to select another row from that second table and concatenate it.</p>\n\n<h2>The query</h2>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS\n    [CurrAxe] Text ( 255 ), [CurrOTP] Text ( 255 ),\n    [CurrClient] Text ( 255 ), [StartDate] DateTime, [EndDate] DateTime;\nSELECT \n    tb_SOMMAIRE.Valeur AS Projet, tb_SOMMAIRE.VARIABLE, *\nFROM\n    (FaitsSaillants\n     LEFT JOIN Employes\n         ON FaitsSaillants.Utilisateur = Employes.CIP)\n    INNER JOIN tb_SOMMAIRE\n        ON FaitsSaillants.OTP = tb_SOMMAIRE.OTP\nWHERE\n    (((FaitsSaillants.OTP)=[CurrOTP]) AND \n     ((FaitsSaillants.Client) Like [CurrClient]) AND\n     ((FaitsSaillants.Axe) Like [CurrAxe]) AND\n     ((DateValue([DateInsertion]))&gt;=[StartDate] AND\n      (DateValue([DateInsertion]))&lt;=[EndDate]) AND\n     ((tb_SOMMAIRE.VARIABLE)='TitreMandat'))\nORDER BY\n    FaitsSaillants.DateInsertion DESC;\n</code></pre>\n\n<p>This query does add the <code>tb_SOMMAIRE.Valeur</code> field where the IDs (<code>OTP</code> field) match and where <code>tb_SOMMAIRE.VARIABLE='TitreMandat'</code>. It works like a charm. However, I want to add another row to the <code>tb_SOMMAIRE</code> results. I would like to get the row where <code>VARIABLE='TitreMandat'</code> (that part is actually working) and the row where <code>VARIABLE='NomInstallation'</code>. I will get 2 rows and I want those 2 rows to be concatenated and displayed when I ask for <code>Projet</code> (<code>tb_SOMMAIRE.Value as Projet</code>). Both rows' <code>OTP</code> (IDs) are the same as the one selected in <code>FaitsSaillants</code>.</p>\n\n<p>Sorry if it's in French.</p>\n\n<h2>Tables' structure</h2>\n\n<p>FaitsSaillants</p>\n\n<blockquote>\n<pre><code>Index AutoNumber\nProjet Text\nAxe Text\nClient Text\nOTP Text\nFaitSaillant Memo\nDateInsertion Date\nUtilisateur Text\n</code></pre>\n</blockquote>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP Text\nVARIABLE Text\nValeur Text\n</code></pre>\n</blockquote>\n\n<h2>Data example</h2>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP   VARIABLE        Valeur\nUGPSW NomInstallation PosteNemiscau\nUGPSW TitreMandat     oscilloperturbographe\nUGPSW RespIng         CU9656\nGWIHK NomInstallation AnotherInstallation\nGWIHK TitreMandat     Anytitle\nGWIHK Responsable     ImportantPerson\n</code></pre>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13152556,"title":"sql server queries related to case statement","body":"<p>My query like this</p>\n\n<p>case when statement1 = statement2 then offer1</p>\n\n<p>if offer1 is have value means  then i need to display offer1 value will be 'Yes'</p>\n\n<p>How to  write the query for this?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1252,"score":0,"question_id":11801911,"title":"Insert multiple rows into single column","body":"<p>I'm new to SQL, (using SQL 2008 R2) and I am having trouble inserting multiple rows into a single column.</p>\n\n<p>I have a table named <code>Data</code> and this is what I am trying</p>\n\n<pre><code>INSERT INTO Data ( Col1 ) VALUES\n('Hello', 'World')\n</code></pre>\n\n<p>That code was taken from <a href=\"http://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query\">this</a> question, but it, like many other examples I have found on the web uses 2 columns, I just want to use 1. What am I doing wrong?</p>\n\n<p>Thanks</p>\n"},{"tags":["query","sdk","rally","pie-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13151762,"title":"Rally SDK: creating pie chart using a query as an attribute","body":"<p>I have been trying to create pie chart using rally sdk with the following piece of code:</p>\n\n<pre><code>    &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Pie Chart Example&lt;/title&gt;\n &lt;meta name=\"Name\" content=\"Component Example: Pie Chart\" /&gt;\n &lt;meta name=\"Version\" content=\"1.32\" /&gt;\n &lt;meta name=\"Vendor\" content=\"Rally Software\" /&gt;\n &lt;script type=\"text/javascript\" src=\"/apps/1.32/sdk.js\"&gt;&lt;/script&gt;\n &lt;script type=\"text/javascript\"&gt;\n\n function showPie() {\n\n   var rallyDataSource = new rally.sdk.data.RallyDataSource('__WORKSPACE_OID__',\n                           '__PROJECT_OID__',\n                           '__PROJECT_SCOPING_UP__',\n                           '__PROJECT_SCOPING_DOWN__');\n   var pieConfig = {\n        type : \"TestCaseResult\",\n       attribute: \"Verdict\",\n        query: 'TestSet.Name=\"Alpha\"'\n     };\n   var pieChart = new rally.sdk.ui.PieChart(pieConfig, rallyDataSource);\n   pieChart.display(\"pieChartDiv\");\n }\n\n rally.addOnLoad(showPie);\n &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n   &lt;div id=\"pieChartDiv\" style=\"height:225px; width:250px\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>This isn't working. it says \"no data\" in place of the pie chart. But if I remove the following line...</p>\n\n<pre><code>query: 'TestSet.Name=\"Alpha\"'\n</code></pre>\n\n<p>...then i see the piechart but that's for all testcaseresults in the project. I need to create pie chart for testcaseresults from a specific testset only. How do I accomplish that? Thank you. </p>\n"},{"tags":["oracle","query","xmltype"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13159126,"title":"Split up query results after loading XML with fn:string-join in an Oracle table","body":"<p>I've loaded a few XML files into an Oracle database (11gr2 on Linux x64) and I had to use a fn:string-join to succesfully import the xml files which contain multiple records.</p>\n\n<p>After the data has landed/has been imported to an XMLTYPE table using SQL*LOADER, i've issued a query which transports the XML data from the XMLTYPE table to a regular table, lets call that one Table_A </p>\n\n<p>This table now contains all fields of the imported records (2 records in this case) together in the target fields, so for instance.</p>\n\n<p>The xml file contains an entry for computer_brand and the first record has the value 'Dell' and the second record has got the value 'Apple'.\nNow the two records from the XML file have been select/inserted in to Table_A but are in the same field, separated by a semi-colon.\nField name: computer_brand\nValues: Dell;Apple</p>\n\n<p>What I'd like to do is select the separate values from the table (regardless from the number of different values in the field, since this query needs to run from a scheduled job) and pass them through to insert all the values in their own separate fields.</p>\n\n<hr>\n\n<p>Here's an example of the things i've made/used:</p>\n\n<hr>\n\n<p>Table_A metadata:</p>\n\n<pre><code>CREATE TABLE table_a\n(\ncomputer_brand                           varchar2(41),\nowner                                    varchar2(101),\naddress                                  varchar2(101),\nserialnumber                             varchar2(21)\n)\n</code></pre>\n\n<p>I've selected and inserted the data imported from the xmltype table into Table_A with the following query:</p>\n\n<pre><code>insert into table_a\n(computer_brand,\n owner,\n address,\n serialnumber\n)\nselect\n a.computer_brand,\n a.owner,\n a.address,\n a.serialnumber\nfrom table_xml a,\n xmltable (xmlnamespaces('not mentioned due to security reasons' as \"tns\"),\n '//tns:Main' passing a.xml_file\n columns\n computer_brand      varchar2(41)  path 'fn:string-join(tns:/@computer_brand,\";\")',\n owner               varchar2(101) path 'fn:string-join(tns:/@owner,\";\")',\n address             varchar2(101) path 'fn:string-join(tns:/@address,\";\")',\n serialnumber        varchar2(21)  path 'fn:string-join(tns:/serialnumber,\";\")')\n(+) k\nwhere upper(file_name)=upper('xmlfile.xml');\n</code></pre>\n\n<p>The output for the above query is:</p>\n\n<pre><code>computer_brand\n--------------\ndell;apple\n\nowner\n--------------\npete;jack\n\naddress\n--------------\nbasement;attic\n\nserialnumber\n--------------\n123444;456555\n</code></pre>\n\n<p>Enormous thanks in advance if someone would know how to and help out? I was looking at <code>SUBSTR()</code> didn't really manage to fix it..</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13141181,"title":"Select from 2 tables with a left join","body":"<p>Here is probably an easy one if your used to SQL, which I'm not.</p>\n\n<p>I have this query:</p>\n\n<pre><code>SELECT * \nFROM myTable \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField\n</code></pre>\n\n<p>Actually, this query returns everything from myTable which meets the <em>join condition</em> (as far as my comprehension goes). This query works great, but I would like to select another field from another table. What I would like to do is something like this:</p>\n\n<pre><code>SELECT myTable.*, myTable2.aSpecificField \nFROM myTable, myTable2 \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField \nWHERE myTable.id = myTable2.id\n</code></pre>\n\n<p>However, this doesn't work, I get an error message about the <em>LEFT JOIN</em>. I would like the aSpecificField from myTable2 to be added to the rows where the ID of both tables match.</p>\n\n<p>Can you help me building this query correctly? Thank you.</p>\n"},{"tags":["php","query","url","seo","seo-friendly"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":43,"score":5,"question_id":13157673,"title":"arabic query string - url did not stored and displayed","body":"<p>I'm trying to make my links SEO friendly by addingdate and title. However, I some of the titles are in Arabic. The English ones work great, while the Arabic ones doesn't. Example:</p>\n\n<blockquote>\n  <p>خالد-على-20120923220529.html</p>\n</blockquote>\n\n<p>Following <a href=\"http://www.9lessons.info/2011/04/seo-friendly-urls-with-php.html\" rel=\"nofollow\">this tutorial</a>, I've produced this code:</p>\n\n<pre><code>$title=mysql_real_escape_string($_POST['title']);\n</code></pre>\n\n<p>i have error with insert title and URL didn't insert with Arabic character\nand when removing this code inserting done no problem but when select this url from database will redirect not found 404 \ni need t display my links </p>\n\n<blockquote>\n  <p><a href=\"http://dzeduc.org/%D8%A7%D9%84%D9%85%D8%B9%D8%A7%D8%AF%D9%84%D8%A7%D8%AA-%D9%88-%D8%A7%D9%84%D9%85%D8%AA%D8%B1%D8%A7%D8%AC%D8%AD%D8%A7%D8%AA-%D9%85%D9%86-%D8%A7%D9%84%D8%AF%D8%B1%D8%AC%D8%A9-1%D9%882/\" rel=\"nofollow\">http://dzeduc.org/%D8%A7%D9%84%D9%85%D8%B9%D8%A7%D8%AF%D9%84%D8%A7%D8%AA-%D9%88-%D8%A7%D9%84%D9%85%D8%AA%D8%B1%D8%A7%D8%AC%D8%AD%D8%A7%D8%AA-%D9%85%D9%86-%D8%A7%D9%84%D8%AF%D8%B1%D8%AC%D8%A9-1%D9%882/</a></p>\n</blockquote>\n\n<p>How can i resolve this problem?</p>\n\n<p>Note </p>\n\n<pre><code>$conn = mysql_connect($db_host,$db_user,$db_pass) or die(mysql_error());\nmysql_select_db($db_name,$conn);\n\nmysql_query(\"SET NAMES 'utf8'\");\nmysql_query('SET CHARACTER SET utf8'); \n</code></pre>\n\n<p>Meta Tags </p>\n\n<pre><code>&lt;meta charset=\"UTF-8\" /&gt;\n&lt;meta http-equiv=\"content-type\" content=\"application/xhtml+xml; charset=UTF-8\" /&gt; \n</code></pre>\n"},{"tags":["query","configuration","nosql","cassandra","oom"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13144232,"title":"Big Cassandra query causes daemon to crush","body":"<p>There is a need to read ~2.5Gb of records from cassandra 1.1.6 database running on CentOS release 6.3 virtual machine. When daemon with default out-of-the-box configuration is queried, i get error :</p>\n\n<pre><code> INFO [Thread-2] 2012-10-30 20:05:13,345 CassandraDaemon.java (line 212) Listening for thrift clients...\n WARN [ScheduledTasks:1] 2012-10-30 20:06:27,076 GCInspector.java (line 145) Heap is 0.8434091049049706 full.  You may need to reduce memtable and/or\n WARN [ScheduledTasks:1] 2012-10-30 20:06:27,077 StorageService.java (line 2855) Flushing CFS(Keyspace='system', ColumnFamily='Versions') to relieve m\n INFO [ScheduledTasks:1] 2012-10-30 20:06:27,077 ColumnFamilyStore.java (line 659) Enqueuing flush of Memtable-Versions@1970754472(83/103 serialized/l\n INFO [FlushWriter:2] 2012-10-30 20:06:27,078 Memtable.java (line 264) Writing Memtable-Versions@1970754472(83/103 serialized/live bytes, 3 ops)\n INFO [FlushWriter:2] 2012-10-30 20:06:27,096 Memtable.java (line 305) Completed flushing /var/lib/cassandra/data/system/Versions/system-Versions-hf-1\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,793 GCInspector.java (line 139) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 AutoSavingCache.java (line 156) Reducing KeyCache capacity from 2075306 to 12 to reduce memory pressu\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 GCInspector.java (line 145) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:28,795 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\n WARN [ScheduledTasks:1] 2012-10-30 20:06:30,181 GCInspector.java (line 145) Heap is 0.9984246325381808 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:30,182 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\n WARN [ScheduledTasks:1] 2012-10-30 20:06:34,740 GCInspector.java (line 145) Heap is 0.9983338780063149 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:34,741 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\nERROR [ReadStage:33] 2012-10-30 20:06:34,843 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:33,5,main]\njava.lang.OutOfMemoryError: Java heap space\n&lt;------&gt;at org.apache.cassandra.io.util.RandomAccessReader.readBytes(RandomAccessReader.java:323)\n&lt;------&gt;at org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:398)\n&lt;------&gt;at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:363)\n&lt;------&gt;at org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:120)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.deserializeNext(ColumnSortedMap.java:255)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:275)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:232)\n&lt;------&gt;at edu.stanford.ppl.concurrent.SnapTreeMap.&lt;init&gt;(SnapTreeMap.java:453)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns$Holder.&lt;init&gt;(AtomicSortedColumns.java:311)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns.&lt;init&gt;(AtomicSortedColumns.java:77)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns.&lt;init&gt;(AtomicSortedColumns.java:48)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns$1.fromSorted(AtomicSortedColumns.java:61)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:399)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:382)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:377)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:339)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:79)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:39)\n&lt;------&gt;at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:140)\n&lt;------&gt;at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:135)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SSTableSliceIterator.hasNext(SSTableSliceIterator.java:116)\n&lt;------&gt;at org.apache.cassandra.utils.MergeIterator$Candidate.advance(MergeIterator.java:147)\n</code></pre>\n\n<p>Don't have much time for calculating size of heap/memory tables etc., added</p>\n\n<pre><code>JVM_OPTS=\"-Xms4g -Xmx4g\"\n</code></pre>\n\n<p>to daemon config (test server has 8 gigs of ram). Query fails again with</p>\n\n<pre><code>ERROR [ReadStage:1] 2012-10-30 20:46:22,417 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:1,5,main]\njava.lang.RuntimeException: java.lang.IllegalArgumentException\n        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:71)\n        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:59)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\nCaused by: java.lang.IllegalArgumentException\n        at org.apache.cassandra.io.util.FastByteArrayOutputStream.&lt;init&gt;(FastByteArrayOutputStream.java:78)\n        at org.apache.cassandra.io.util.DataOutputBuffer.&lt;init&gt;(DataOutputBuffer.java:40)\n        at org.apache.cassandra.db.RangeSliceReply.getReply(RangeSliceReply.java:48)\n        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:64)\n        ... 4 more\n</code></pre>\n\n<p>and i can't debug further. Does anyone knows how can i tweak Cassandra so i can run that query? Database have ~500 of supercolumns ~7 mb each. I need to read them all and at some point have in memory (client machine has 40 gigs of ram so thats 100% not a lacking resources issue) for further processing. Query result is not returned into api at all.</p>\n"},{"tags":["mysql","query","group"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13079776,"title":"MySQL group by week returning strange intervals","body":"<p>For some odd reason, group by week is returning odd date intervals with a datetime field. </p>\n\n<p>\"Completed\" is a datetime field, and using:</p>\n\n<p>GROUP BY WEEK(Completed)   </p>\n\n<p>I'm getting:</p>\n\n<pre><code>Completed  ActivityCount    CompletedTimestamp\n2012-09-25  300            2012-09-25 00:00:00\n2012-10-02  764            2012-10-02 00:00:00\n2012-10-08  379            2012-10-08 00:00:00\n2012-10-17  659            2012-10-17 00:00:00\n2012-10-22  382            2012-10-22 00:00:00\n</code></pre>\n\n<p>some are 7 days apart, others are 6 days apart, others are 5.... and one is 9?</p>\n\n<p>Why does it group the dates by such strange intervals instead of just 7 days?</p>\n\n<p>Thanks much for any help.</p>\n"},{"tags":["query","ms-access","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13157441,"title":"How to get the best 10 (top 10) in a query that is also ordered by another field first?","body":"<p>For example I would like to get only the top 10 customer by seller. So it will look like this (without the top 10):</p>\n\n<pre><code>Select seller, customer, sells from table order by seller asc, sells desc\n</code></pre>\n\n<p>But this will give me all the values. I would only like to have the first 10 customers for each seller.</p>\n\n<p>Is this even possible in ms-access 2003? If yes, please give me a hint,\nthanks ;)</p>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13157277,"title":"Query in SQL Server (machines that are now in specific project)","body":"<p>I have a table including 3 fields which are <code>Machine Name</code>, <code>Project Name</code>, <code>Date Time</code>\nwhere <code>Date Time</code> indicates the exact time when machine was assigned to a project.</p>\n\n<p>Now I want to find machines which are now in a specific project (in fact it may be that one machine in different times be allocated to different projects).</p>\n\n<p>I want lasted specific project be latest project that machine assigned to it.</p>\n"},{"tags":["ruby-on-rails","query","syntax"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13156945,"title":"Rails query syntax","body":"<p>I'm kinda new on the Rails boat, I would like to know the difference between two types of syntax for queries</p>\n\n<p>The first one I tried is: </p>\n\n<pre><code>User.limit(8).order('created_at DESC').group('created_at').count\n</code></pre>\n\n<p>The second, which seems to be far more efficient and powerful: </p>\n\n<pre><code>User.count(:order =&gt;'DATE(created_at) DESC', :group =&gt;[\"DATE(created_at)\"], :limit =&gt; 8) \n</code></pre>\n\n<p>But I don't really understand the use case for both.\nI'm sure this is something obvious anyway... \nThanks!</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13156493,"title":"How to create a list of dates from a daterange without using a CTE","body":"<p>The following link explains how to turn a date range into a list of dates.\nI used this approach and it works fine but the query is not performing (I used Maxrecursion 0 to unlimit).</p>\n\n<p><a href=\"http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/\" rel=\"nofollow\">http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/</a></p>\n\n<p>Is there any other solution to get this done? (using subquery or declare table?)</p>\n"},{"tags":["query","join","mongodb","schema"],"answer_count":5,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":6351,"score":3,"question_id":4563205,"title":"How to join query in mongodb?","body":"<p>I have user document collection,like this:</p>\n\n<pre><code>User {\n   id:\"001\"\n   name:\"John\",\n   age:30,\n   friends:[\"userId1\",\"userId2\",\"userId3\"....]\n}\n</code></pre>\n\n<p><strong>some user have many many friends(10000)</strong>, How can I do like in SQL:</p>\n\n<p><code>select * from user where in (select friends from user where id=?) order by age</code>.</p>\n\n<p>I would like to have only one query but i dont know if its possible.</p>\n\n<p>Thanks</p>\n"},{"tags":["query","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13136729,"title":"How can I get a sorted children without access parent entity[many-to-many] in hibernate","body":"<p>For example, there is a many-to-many association between A and B. And<pre> <strong>A.bs</strong> is sorted List&lt;B> that sorted by an index-column in the middle-table: idx</pre>  So we haven't mapping idx column as Class field. </p>\n\n<p>Now we want to query the list of B individually and the main condition is A's id. But when query B directly, it comes out with an unsorted List (don't order by the idx field). </p>\n\n<p>I know we can retrieve A at first then collect the B into a List. However, considering the framework, we can do like that, it have to return a List without manual coding (don't want to describe too much about the framework. in one word, this limitation is caused by the pagination tool encapsulate by our self, I don't want to modify that.).</p>\n\n<p>Is there any methods to solve this problem via HQL/Criteria. Criteria are preferable.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13139202,"title":"mysql query error for timestamps","body":"<p>I hope the below error is self explanatory.I want to compare event_time with some few cart_time.I know that usually when we want any operation like this we need to use <code>in</code> but for timestamps how to compare it</p>\n\n<pre><code> mysql&gt; SELECT bsid\n        FROM access_aug15\n        WHERE event_time &lt; (SELECT cart_time \n                            FROM chat_final \n                            WHERE bsid in (SELECT bsid  \n                                           FROM access_aug15\n                                           WHERE eventid=\"11\"\n                                           AND current_page not like  '%cart%'));\n\n ERROR 1242 (21000): Subquery returns more than 1 row\n</code></pre>\n\n<p>EDIT:Table structure access_aug15</p>\n\n<pre><code>  +-------------------+--------------+------+-----+---------+-------+\n  | Field             | Type         | Null | Key | Default | Extra |\n  +-------------------+--------------+------+-----+---------+-------+\n  | vid               | varchar(200) | YES  |     | NULL    |       |\n  | bsid              | varchar(200) | YES  | MUL | NULL    |       |\n  | event_time        | datetime     | YES  | MUL | NULL    |       |\n  | eventid           | varchar(10)  | YES  | MUL | NULL    |       |\n  | current_page      | mediumtext   | YES  |     | NULL    |       |\n  | departmentid      | varchar(100) | YES  | MUL | NULL    |       |\n  | form_id           | varchar(100) | YES  |     | NULL    |       |\n  | form_name         | varchar(100) | YES  |     | NULL    |       |\n  | page_title        | varchar(200) | YES  |     | NULL    |       |\n  | report_date       | datetime     | YES  | MUL | NULL    |       |\n  +-------------------+--------------+------+-----+---------+-------+\n</code></pre>\n\n<p>table2:chat_final</p>\n\n<pre><code>  +-------------------+--------------+------+-----+---------+-------+\n  | Field             | Type         | Null | Key | Default | Extra |\n  +-------------------+--------------+------+-----+---------+-------+\n  | bsid              | varchar(200) | YES  | MUL | NULL    |       |\n  | chat_time         | datetime     | YES  |     | NULL    |       |\n  | cart_time         | datetime     | YES  |     | NULL    |       |\n  | customerid        | varchar(100) | YES  |     | NULL    |       |\n  | detail            | longtext     | YES  |     | NULL    |       |\n  | chat_type         | varchar(5)   | YES  |     | NULL    |       |\n  +-------------------+--------------+------+-----+---------+-------+\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":6,"view_count":37,"score":-4,"question_id":13154807,"title":"Query required for given output","body":"<p>Supose I have data in below format</p>\n\n<pre><code>FIELD1   F2       F3 \nLIN0_TMP    A0  1\nLIN0_TMP    B0  2\nLIN0_TMP    C0  3\nLIN_TMP     A   1\nLIN_TMP     B   2\nLIN_TMP     C   3\nLIN_TMP     D   4\nLIN2_TMP    A2  1\nLIN2_TMP    B2  2\nLIN2_TMP    C2  3\nLIN2_TMP    D2  4\n</code></pre>\n\n<p>i WANT output in below format using oracle sql query. </p>\n\n<pre><code>FIELD1   F2       F3   FLOW\n    LIN0_TMP    A0  1 FLOW1\n    LIN0_TMP    B0  2 FLOW1\n    LIN0_TMP    C0  3 FLOW1\n    LIN_TMP     A   1 FLOW2\n    LIN_TMP     B   2 FLOW2\n    LIN_TMP     C   3 FLOW2\n    LIN_TMP     D   4 FLOW2\n    LIN2_TMP    A2  1 FLOW3 \n    LIN2_TMP    B2  2 FLOW3\n    LIN2_TMP    C2  3 FLOW3\n    LIN2_TMP    D2  4 FLOW3\n</code></pre>\n\n<p>Number of record for field1 is not fixed for each LIN_TMP value..</p>\n"},{"tags":["sql","wpf","query","designer","builder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13156142,"title":"WPF query builder control","body":"<p>I wonder if there is any sql query builder out there meeting these conditions:</p>\n\n<ol>\n<li>Available as WPF control so that it can be integrated in my WPF app</li>\n<li>At least support of MS SQL Server and Oracle</li>\n<li>Visual representation and drag/drop support (tables, columns)</li>\n<li>SQL expression as a result property (no fancy \"user-friendly\" meta concept)</li>\n<li>Possibility to edit the SQL expression manually (with changes to the visual representation)</li>\n<li>No need to build up a metadata model before </li>\n</ol>\n\n<p>I already spend some time on the web with the following results </p>\n\n<ol>\n<li>ActiveQueryBuilder is functionally perfect but does not fit 1. (lacks WPF support)  [http://www.activequerybuilder.com/index.html?from=about&amp;edition=net]</li>\n<li>KorzhEasyQueryNET does not fit 5. (SQL is not written back to visual) and 6. (metadata model needed) [http://devtools.korzh.com]</li>\n<li>Query Objects is not a component but a standalone tool [http://www.query-objects.com/]</li>\n</ol>\n\n<p>So, is anybody out who knows of an alternative?</p>\n\n<p>Regards</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13155215,"title":"Elastic Search: Multiple queries and boosting","body":"<p>I want to make a search containing many searches with different boosts, and having the results returned by score. I tried making a search as follows, and I thought it worked very well, until I realized that only the first query was being run.</p>\n\n<p>How should I rephrase this to have a result with all the queries run, and the results ordered by score, where the scores will be added together if a result shows up for multiple queries?</p>\n\n<pre><code>[{\n    \"query\": {\n        \"fuzzy\": {\n            \"title\": {\n                \"value\": \"lord\",\n                \"boost\": 20,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"location\": {\n                \"value\": \"london\",\n                \"boost\": 1000,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"haircolour\": {\n                \"value\": \"dark\",\n                \"boost\": 500,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"description\": {\n                \"value\": \"senior\",\n                \"boost\": 100,\n                \"min_similarity\": 0.7\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"description\": {\n                \"value\": \"manager\",\n                \"boost\": 100,\n                \"min_similarity\": 0.7\n            }\n        }\n    }\n}]\n</code></pre>\n\n<p>Cheers</p>\n\n<p>Nik</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13150915,"title":"SQL - Average number of records within a time period","body":"<p>I'm trying to compile some lifetime value information for customers within one of our databases.</p>\n\n<p>We have an MS SQL Server database which stores all of our customer/transactional information.</p>\n\n<p>My issue is that I don't have much experience when it comes to MS SQL Server (or SQL in general) - I'd like to be able to run a query against the database that pulls AVG number of loans, and AVG revenue based on three criteria:</p>\n\n<p>1.) Loans be counted if they are 'approved'\n2.) Loans from a customer_id only be counted if the first loan (first identified by date_created field) be on or after a certain 'mm/yyyy'\n3.) I'm able to specify for how many months after the first 'mm/yyyy' to tally the number of loans / revenue to be included within the AVG</p>\n\n<p>Here is what the database would look like:</p>\n\n<pre><code>customer_id   | loan_status | date_created      | revenue\n111       | 'approved'  | 2010-06-20 17:17:09   | 100.00\n222       | 'approved'  | 2010-06-21 09:54:43   | 255.12\n333       | 'denied'    | 2011-06-21 12:47:30   | NULL\n333       | 'approved'  | 2011-06-21 12:47:20   | 56.87\n222       | 'denied'    | 2011-06-21 09:54:48   | NULL\n222       | 'approved'  | 2011-06-21 09:54:18   | 50.00\n111       | 'approved'  | 2011-06-20 17:17:23   | 100.00\n... loads' of records ...\n555       | 'approved'  | 2012-01-02 09:08:42   | 24.70\n111       | 'denied'    | 2012-01-05 02:10:36   | NULL\n666       | 'denied'    | 2012-02-05 03:31:16   | NULL\n555       | 'approved'  | 2012-02-17 09:32:26   | 197.10\n777       | 'approved'  | 2012-04-03 18:28:45   | 300.50\n777       | 'approved'  | 2012-06-28 02:42:01   | 201.80\n555       | 'approved'  | 2012-06-21 22:16:59   | 10.00\n666       | 'approved'  | 2012-09-30 01:17:20   | 50.00\n</code></pre>\n\n<p>If I wanted to find the avg transaction count (approved transactions), and average revenue per approved transaction for all customer's who's <strong>first</strong> loan was in/after 2012-01, and for a period of 4 months after then, how would I go about querying the database?</p>\n\n<p>Any help is greatly appreciated.</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13141241,"title":"create a statistics table using datetime MSSQL Query","body":"<p>I have little table which gives me a very hard time:</p>\n\n<pre><code>Person    datetime1                   datetime2\nEric      2012-10-01 09:00:05.000     2012-10-01 22:00:00.000\nAnna      2012-10-02 06:00:05.000     2012-10-03 12:00:05.000\nRichard   2012-10-03 09:00:05.000     2012-10-04 02:00:05.000\nChuck     2012-10-01 12:00:05.000     2012-10-01 23:00:05.000\n</code></pre>\n\n<p>I am trying to write a query, which gives me statistics table. This table contains information about when a user logged in and out (daily granularity):</p>\n\n<pre><code>Date        logged_in  logged_off\n2012-10-01  2          2\n2012-10-02  1          0\n2012-10-03  1          1\n2012-10-04  0          1\n</code></pre>\n\n<p>According to my research, a pivot command could solve the problem?</p>\n\n<pre><code>select Person,\nSUM(case when datetime1 = '2012-10-01' then 1 else 0 end) as [loggeed_in],\nSUM(case when datetime2 = '2012-10-01'  then 1 else 0 end) as [logged_of]\nfrom table\ngroup by Person\n</code></pre>\n\n<p>This is not working... Do you have any ideas?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13135580,"title":"mysql select related items based on current item","body":"<p>i have a scenario, lets say 3 users review a business of id 10, how can i get all the unique id of the user who review that business and and use that unique id to find another business review which is not equal to 10 ? </p>\n\n<p>sample table user_review:</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  1           2          10           3       20121030124001\n  2           2          9            3       20121022120627\n  3           2          10           4       20121023120627\n  4           3          10           4       20121024120627\n  5           3          6            3       20121022140627\n  6           4          10           2       20121025120627\n  7           4          10           5       20121030120627\n  8           3          10           2       20121010120627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>i should get result of these</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  2           2          9            3       20121022120627\n  5           3          6            3       20121022140627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>In a above result if there is 2 reviews for a same user_id and same business_id the latest one should be return.Thanks</p>\n"},{"tags":["css","ipad","query","media"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13076371,"title":"Media Query for iPad and desktop (max-width)","body":"<p><strong>I want some CSS code to target both iPad and desktop with max-width: 768.</strong></p>\n\n<p>This (I don't know why, would be glad to know) doesn't work for the iPad (only desktop):</p>\n\n<pre><code>@media only screen and (max-width: 768px)\n</code></pre>\n\n<p>so I had to to this for the iPad:</p>\n\n<pre><code>@media only screen and (device-width: 768px)\n</code></pre>\n\n<p>However, I have the exact same code inside both media queries, and that I cannot accept.</p>\n\n<p>I tried this also: </p>\n\n<pre><code>@media only screen and (max-width: 767px) or (device-width: 768px)\n</code></pre>\n\n<p>This one above doesn't work either - it actually works for the desktop, no matter what width, and not on iPad. Really strange.</p>\n\n<p>How to target both iPad and desktop with same media query?</p>\n"},{"tags":["query","request","touch","sencha","jsonp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13153407,"title":"Phonegap ==> not all variables are returned from server","body":"<p>I wrote a login in sencha touch. Quite simple. A simple form with username and password. Submit a request to the server where I execute a sql to search the corresponding username/password. If a result is found then return success=true and the member_id and member_username.</p>\n\n<p>It works in Chrome and also using Eclipse/Phonegap.</p>\n\n<p>Now I expanded the sql so also the password is returned from the sql. In md5 it is stored in the db. So I can store this in the localstorage. For some reason the password I get back from the server is always \"undefined\". Although in Chrome it works fine. In Eclipse/Phonegap the value is \"undefined\".</p>\n\n<p>Here is the code from the JSONP. The code \"console.log(response.user.member_pw);\" shows \"undefined\". Allthough in Chrome it is filled in correctly... With the md5 value of the password.</p>\n\n<pre><code>Ext.util.JSONP.request({\n        url: 'http://10.0.2.2/mobile/login.php',\n        params: options.data,\n        callbackKey: \"callback\",\n        scope: this, \n        callback: function(response) {\n            console.log(\"checklogin success\");\n             if (response.success == \"true\")\n             {\n                console.log(\"Paswoord returned:\");\n                console.log(response.user.member_pw);\n                 var member = Ext.ModelMgr.create({\n                    member_id: response.user.member_id,\n                    member_username: response.user.member_username,\n                    member_password: response.user.member_pw\n                }, 'Login');\n\n                app.subapps.Login.stores.login.add(member);\n                app.subapps.Login.stores.login.sync();\n\n                this.index(options);\n            }\n            else {\n                 Ext.Msg.alert('', response.errors.reason, '');\n                 console.log(\"failure\");\n            }\n        }\n    });\n}  \n</code></pre>\n\n<p>Here is the code from the login.php</p>\n\n<pre><code>         $username = $_GET['username'];\n    $pw = $_GET['password'];\n\n    $callback = $_REQUEST['callback'];\n\n    $sql_select = \"select member_id, member_username, member_password from member where member_username like '\".$username.\"' and member_password like '\".md5($pw).\"'\";\n    $sql_result = mysql_query($sql_select, $db) or die (\"Error: \".mysql_error());\n    $sql_number_records = mysql_num_rows($sql_result);\n\n    if ($sql_number_records == 1)\n    {\n        $sql_record         = mysql_fetch_array($sql_result);\n        $idRef_user         = $sql_record[0];\n        $member_username     = $sql_record[1];\n        $member_pw            = $sql_record[2];\n\n\n            $json_return = '{\"success\": \"true\", \"user\": { \"member_id\": \"'.$idRef_user.'\", \"member_username\": \"'.$member_username.'\", \"member_pw\": \"'.$member_pw.'\"}}';\n\n            if ($callback) {\n                header('Content-Type: text/javascript');\n                echo $callback . '(' . $json_return . ');';        \n            } else {\n                header('Content-Type: application/x-json');\n                echo $json_return;    \n            }\n        }\n        else\n        {\n            $json_return =  '{\"success\": \"false\", \"errors\": { \"reason\": \"Login failed\"}}';\n            if ($callback) {\n                header('Content-Type: text/javascript');     \n                echo $callback . '(' . $json_return . ');';\n            } else {\n                header('Content-Type: application/x-json');\n                echo $json_return;    \n            }\n        }\n    } \n</code></pre>\n\n<p>I also tried to do a select * or instead of returning the password returning another field from the table. But it keeps being \"undefined\". With Chrome is works, strange...     </p>\n\n<p>Update: even if I hard code the password, $member_pw = \"mypasswordcomeshereinmd5\"; it still is undefined...</p>\n\n<p>Update2: I also hard coded the password in de json object</p>\n\n<p>'{\"success\": \"true\", \"user\": { \"member_id\": \"'.$idRef_user.'\", \"member_username\": \"'.$member_username.'\", \"member_pw\": \"mypasswordcomeshereinmd5\"}}';</p>\n\n<p>Still undefined....</p>\n"},{"tags":["javascript","jquery","sql","query","jqgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13153287,"title":"JQgrid search string builder","body":"<p>Is there any way for search string builder for JQgrid ?\ni.e. when I press search button then it should automatically generate the search string for the search critaria provided for the grid.</p>\n"},{"tags":["mysql","query","query-optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13152796,"title":"MYSQL query - getting totals by month","body":"<p><a href=\"http://sqlfiddle.com/#!2/6a6b1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/6a6b1</a></p>\n\n<p>The scheme is given above.. all i want to do is get the results as total of sales / month... the user will enter a start date and end date and I can generate (in php) all the month and years for those dates. for example if i want ot know the total number of \"sales\" for 12 months i know i can run 12 individual queries with start and end dates...  but i am want to run only one query where the result will look like </p>\n\n<pre><code>Month     numofsale\nJanuary - 2  \nFeb-1\nMarch - 23\nApr - 10\n</code></pre>\n\n<p>so on ..</p>\n\n<p>or just a list of sales with out the months i can then pair it to the array of months generated in the php ...any ideas....</p>\n\n<p>Edit / schema and data pasted from sqlfiddle.com:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `lead_activity2` (\n  `lead_activity_id` int(11) NOT NULL AUTO_INCREMENT,\n  `sp_id` int(11) NOT NULL,\n  `act_date` datetime NOT NULL,\n  `act_name` varchar(255) NOT NULL,\n  PRIMARY KEY (`lead_activity_id`),\n  KEY `act_date` (`act_date`),\n  KEY `act_name` (`act_name`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1  ;\n\nINSERT INTO `lead_activity2` (`lead_activity_id`, `sp_id`, `act_date`, `act_name`) VALUES\n(1, 5, '2012-10-16 16:05:29', 'sale'),\n(2, 5, '2012-10-16 16:05:29', 'search'),\n(3, 5, '2012-10-16 16:05:29', 'sale'),\n(4, 5, '2012-10-17 16:05:29', 'DNC'),\n(5, 5, '2012-10-17 16:05:29', 'sale'),\n(6, 5, '2012-09-16 16:05:30', 'SCB'),\n(7, 5, '2012-09-16 16:05:30', 'sale'),\n(8, 5, '2012-08-16 16:05:30', 'sale'),\n(9, 5,'2012-08-16 16:05:30', 'sale'),\n(10, 5, '2012-07-16 16:05:30', 'sale');\n</code></pre>\n"},{"tags":["mysql","sql","query","like","where"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13150741,"title":"Specification in like query","body":"<p>I can't figure out what's wrong with this query. I just want to search in a specific genre, but this query gives me results of other genres. Would really like some help. This code is for my first site built in php.</p>\n\n<pre><code>SELECT * \nFROM news\nWHERE (titel LIKE '%keyword%') AND genre='politics'\n</code></pre>\n"},{"tags":["mysql","query","insert","union"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13152425,"title":"Cannot use UNION in INSERT MySQL?","body":"<p>I have a select query that works fine. But when I wrap it into an INSERT statement, I get an error.</p>\n\n<p>Error 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(SELECT DISTINCT NULL AS <code>id</code>,NULL AS <code>core_value_id</code>,NULL AS <code>translation_id</code>' at line 3</p>\n\n<p>I can solve this problem by using 1 insert for each source table. But is there any way to do it with a single query? Why isn't this working?</p>\n\n<p>Here's the query.</p>\n\n<pre><code>INSERT INTO `some_table`\n(\n(SELECT DISTINCT\nNULL AS `id`,\nNULL AS `core_value_id`,\nNULL AS `translation_id`,\nt1.`upc` AS `source_value`,\nt1.`upc` AS `value`,\nCOUNT(*) AS `count`\nFROM  `source_table_1` t1\nGROUP BY `upc`)\n\nUNION ALL\n(SELECT DISTINCT\nNULL,NULL,NULL,\nt1.`upc`,\nt1.`upc`,\nCOUNT(*) AS `count`\nFROM  `source_table_2` t1\nGROUP BY `upc`\n)\nORDER BY `count` DESC\n)\n</code></pre>\n\n<p>Here's the table definition:</p>\n\n<pre><code>CREATE TABLE `some_table` (\n `id` int(11) NOT NULL AUTO_INCREMENT,\n `core_value_id` int(11) DEFAULT NULL,\n `translation_id` int(11) DEFAULT NULL,\n `source_value` varchar(255) NOT NULL,\n `value` varchar(255) DEFAULT NULL,\n `count` int(11) NOT NULL,\n PRIMARY KEY (`id`),\n KEY `core_value_id` (`core_value_id`),\n KEY `translation_id` (`translation_id`),\n KEY `source_value` (`source_value`),\n KEY `value` (`value`),\n KEY `count` (`count`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>source_tables would look something like this:</p>\n\n<pre><code>CREATE TABLE `source_table_1` (\n `id` int(11) NOT NULL AUTO_INCREMENT,\n `upc` bigint(20) DEFAULT NULL,\n PRIMARY KEY (`id`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>The upc columns would have data like:</p>\n\n<pre><code>123456789012\n123456789013\n123456789014\n123456789015\n123456789016\n123456789017\n</code></pre>\n"},{"tags":["php","sql","query","search","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13150516,"title":"Search SQL with Date Range and Checkbox","body":"<p>I've been trying to develop a code where I have a form to search SQL tables according to date ranges and a checkbox status.</p>\n\n<p>I already have worked out the search query for the dates, but I haven't been able to make it work with the checkbox. I would like to combine both features in one search but I can't figure it out.</p>\n\n<p>For ex: Search between \"<strong>01/01/2012</strong>\" and \"<strong>12/31/2012</strong>\" where status is \"DONE! <strong>(Checkbox=Checked)</strong>\".</p>\n\n<p>Here is the code I'm using to do the search:</p>\n\n<p>The Form</p>\n\n<pre><code>&lt;form method = \"post\" action = \"&lt;?php echo $_SERVER['PHP_SELF'];?&gt;\"&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;span&gt;From&amp;nbsp:&lt;/span&gt;\n                    &lt;input type = \"date\" name = \"OLD\"&gt;\n                    To:\n                    &lt;input type = \"date\" name = \"NEW\"&gt;\n                    Status:\n                    &lt;input type='checkbox' name='Status' value='DONE'/&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;button type = \"submit\" name = \"search\" value = \"Search\" class=\"button orange\"&gt;Search&lt;/button&gt;\n                    &lt;button type = \"reset\" value = \"Clear\" class=\"button orange\"&gt;Reset&lt;/button&gt;\n                &lt;/td&gt;   \n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>The PHP</p>\n\n<pre><code>&lt;?php\n    if(!isset($_POST['search']))\n    {\n    ?&gt;\n\n    &lt;?php\n    }\n    else\n    {\n        $OLD = trim($_POST['from']);\n        $NEW = trim($_POST['to']);\n\n        $connection = mysql_pconnect(\"HOST\", \"USER\", \"PASS\") or die(\"Connection failed. \".myslq_error());\n        mysql_select_db(\"DATABASENAME\") or die(\"Unable to select db. \".mysql_error());\n        $query = \"SELECT * FROM table WHERE Date &gt;= '$OLD' AND Date &lt;= '$NEW' ORDER BY date ASC\";\n        $result = mysql_query($query) or die(mysql_error());\n\n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowa'&gt;&lt;b&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;Name&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;Last Name&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";\n        echo \"&lt;/table&gt;\";\n        while($record = mysql_fetch_object($result))\n        {   \n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowb'&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;\".$record-&gt;Name.\"&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;\".$record-&gt;LastName.\"&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";       \n        echo \"&lt;/table&gt;\";\n        }       \n    }\n?&gt;\n</code></pre>\n\n<p>Who can lead me in the right way to accomplish this?! Thanks a lot!</p>\n"},{"tags":["query","sqlalchemy","rowcount"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13145068,"title":"SQL Alchemy ResultProxy.rowcount should not be zero","body":"<p>Does anyone know how to get the row count from an SQL Alchemy query ResultProxy object without looping through the result set? The ResultProxy.rowcount attribute shows 0, I would expect it to have a value of 2. For updates it shows the number of rows affected which is what I would expect.</p>\n\n<pre><code>from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\n\nengine = create_engine(\n    'oracle+cx_oracle://user:pass@host:port/database'\n    )\n\nsession = sessionmaker(\n    bind = engine\n    , autocommit = False\n    , autoflush = False\n    )()\n\nsql_text = u\"\"\"\n    SELECT 1 AS Val FROM dual UNION ALL\n    SELECT 2 AS Val FROM dual\n    \"\"\"\n\nresults = session.execute(sql_text)\n\nprint '%s rows returned by query...\\n' % results.rowcount\nprint results.keys()\n\nfor i in results:\n    print repr(i)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 rows returned by query...\n\n[u'val']\n(1,)\n(2,)\n</code></pre>\n"},{"tags":["mysql","query","select","numbers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13150281,"title":"MYSQL Selection more than one value","body":"<pre><code>$query = $query.\"AND `category` != '(1,2)') ORDER BY id DESC LIMIT $a , $b\" ;\n</code></pre>\n\n<p>Long story short, can't find the right syntax for the above (1,2) and i don't want to write over with another AND because there may apear more values in future.</p>\n\n<p>Hope somebody can help me ;).</p>\n"},{"tags":["android","query","sqlite","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":885,"score":0,"question_id":6891684,"title":"Android SQLite query multiple tables","body":"<p>Im trying to do something like this (This is MySQL format)</p>\n\n<pre><code>SELECT q.question_id, q.question, q.answer\nFROM relationship r, questions q\nWHERE r.cat_id =1\nAND r.question_id = q.question_id\nLIMIT 0 , 30\n</code></pre>\n\n<p>So, I got questions stored in one table, then categories in another table. I have the relationship table set up so that a question can be in multiple categories. So say a question has an id of 5, and its in 3 different categories, the relationship table would look like this</p>\n\n<pre><code>relation_id, question_id, category_id\n    1            5            1\n    2            5            2\n    3            5            3\n    4            6            1  \n</code></pre>\n\n<p>So, say I wanna get all the questions with the cat_id of 1, I should get 2 results. That's basically what I'm trying to do.</p>\n"},{"tags":["php","mysql","query","pdo","count"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13148325,"title":"Counting rows by category-filter during fetching of categories from database","body":"<p>I have two tables in my database</p>\n\n<pre><code>table: products                   table: companies\n+-----------+------------+        +------+------------+\n| name      | company_id |        | id   | name       |\n+-----------+------------+        +------+------------+\n|Product 1  | 1          |        | 1    | Company 1  |\n|Product 2  | 1          |        | 2    | Company 2  |   \n|Product 3  | 3          |        | 3    | Company 3  |\n|Product 4  | 1          |        | 4    | Company 4  |\n|Product 5  | 1          |        | ...               |\n|Product 6  | 3          |        +------+------------+\n|Product 7  | 2          |\n|...                     |\n+-----------+------------+\n</code></pre>\n\n<p>Now I have to make <strong>company-selector</strong> (filtering products by company) using HTML <code>SELECT</code> element with names of all companies from table <code>companies</code> and <code>COUNT</code> of products after company name in the list.</p>\n\n<p>So, my goal is to get <code>SELECT</code> options like this:</p>\n\n<ul>\n<li>Company 1 (4)</li>\n<li>Company 2 (1)</li>\n<li>Company 3 (2)</li>\n<li>Company 4 (0)</li>\n</ul>\n\n<p><em>(note: counts inside the brackets are from example above)</em></p>\n\n<h2>What have I tried so far?</h2>\n\n<p>I was using <code>mysql_*</code> functions earlier and later it was <code>mysqli</code> procedural model. I can do this manually with one query for companies and another one inside <code>while</code> block to get <code>COUNT</code> of elements (filtered by current company's id in the loop). Now I'm trying to work with <code>PDO object</code> which is something new for me and I'm not very familiar with it.</p>\n\n<h2>Question</h2>\n\n<p>Is it somehow possible to get <code>COUNT</code> with one query (using <code>JOINs</code> or something)? If not, how I can do it with query inside the loop (old way) using my <code>$dbPDO</code> object? Or any other way?</p>\n\n<p>I've looked some examples here but nothing could adapt to fit my requirements. Maybe I missed something but working with PDO is still painful for me (and I must learn it ASAP). </p>\n\n<p>Looking at my own question, I don't think it's something hard, but the worst thing, I <strong>can't find solution</strong> by myself.</p>\n\n<p>At the end, I have solution in <code>mysqli</code>, just I don't like it so much and think there's easier way of making this task done!</p>\n\n<p>I thought this <a href=\"http://stackoverflow.com/questions/1803905/counting-all-the-posts-belonging-to-a-category-and-its-subcategories\"><strong>question</strong></a> is something I need but still don't understand that query in answer.</p>\n\n<p>So far I have this code and have no idea how to make it counts products:</p>\n\n<pre><code>  $dbPDO = new PDO('mysql:dbname=comixdb;host=localhost', 'root', '');\n  $sel_cat = ''; # selector HTML\n  $sql = \"SELECT * FROM categories ORDER BY name\";\n  foreach ($dbPDO-&gt;query($sql) as $row) {\n    $sel_cat .= \"&lt;option value=\\\"{$row['id']}\\\"&gt;{$row['name']}&lt;/option&gt;\";\n    }\n  $sel_cat = \"&lt;select&gt;&lt;option value=\\\"*\\\"&gt;All categories&lt;/option&gt;$sel_cat&lt;/select&gt;\";\n\n  echo $sel_cat;\n</code></pre>\n\n<p>Hope I've clarified question enough. Any help would be appreciated. </p>\n"},{"tags":["php","mysql","database","query","retrieve"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13148810,"title":"Wrong data retrieved from database","body":"<p>So, I want to retrieve the order of the elements of a list. The order is set before by the user, and are stored in the table below. Because I also want to retrieve name and description of the list elements I need to combine two tables (see below).</p>\n\n<p>However, what is actually retrieved is an array containing 16 elements (should be four because it only exists four elements as for now). The array is too long to post here, but I put it in a phpFiddle <a href=\"http://phpfiddle.org/main/code/b2a-vtp\" rel=\"nofollow\">to be found here</a> if you're interested.</p>\n\n<p>Well, I have really tried to find what's wrong (probably something easy as always), but with no luck.</p>\n\n<p>Thanks a lot for your time and help!</p>\n\n<p><strong>listModel.php:</strong></p>\n\n<pre><code>public function GetOrderedElements($userId, $listId) {\n\n// $userId = 46\n// $listId = 1\n\n        $query = \"SELECT le.listElemId, le.listElemName, le.listElemDesc, lo.listElemOrderPlace\n                    FROM listElement AS le\n                    INNER JOIN listElemOrder AS lo\n                    ON le.listId = lo.listId\n                    WHERE lo.userId = ?\n                    AND lo.listId = ?\n                    ORDER BY listElemId\";\n\n        $stmt = $this-&gt;m_db-&gt;Prepare($query);\n\n        $stmt-&gt;bind_param(\"ii\", $userId, $listId);\n\n        $listElements = $this-&gt;m_db-&gt;GetOrderedElements($stmt);\n\n        return $listElements;       \n    }\n</code></pre>\n\n<p><strong>database.php:</strong></p>\n\n<pre><code>public function GetOrderedElements(\\mysqli_stmt $stmt) {\n\n        if ($stmt === FALSE) {\n                throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        if ($stmt-&gt;execute() == FALSE) {\n                throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        if ($stmt-&gt;bind_result($listElemId, $listElemName, $listElemDesc, $listElemOrderPlace) == FALSE) {\n            throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        $listElements = array();\n\n        while ($stmt-&gt;fetch()) {\n            $listElements[] = array('listElemId' =&gt; $listElemId,\n                                 'listElemName' =&gt; $listElemName,\n                                 'listElemDesc' =&gt; $listElemDesc,\n                                 'listElemOrderPlace' =&gt; $listElemOrderPlace);\n        }\n\n        var_dump($listElements);\n\n        $stmt-&gt;Close();\n\n        return $listElements;\n    }\n</code></pre>\n\n<p><strong>from the database:</strong></p>\n\n<p><em>listElemOrder</em>:</p>\n\n<pre><code>listElemOrderId | listId | listElemId | userId | listElemOrderPlace\n      1              1          1          46           1\n      4              1          2          46           4\n      2              1          3          46           2\n      3              1          4          46           3\n</code></pre>\n\n<p><em>listElement</em>:</p>\n\n<pre><code>listElemId | listElemName | listId | listElemDesc | listElemOrderPlace\n      1          Elem A         1         Derp             NULL\n      2          Elem B         1         Herp             NULL\n      3          Elem C         1         Lorum            NULL\n      4          Elem D         1         Ipsum            NULL\n</code></pre>\n\n<p><strong>Note:</strong> 'listElemOrderPlace' in the table <em>listElement</em> is the final order of the elements (all users average), not to be mixed with the one with the same name in the other table, that's only a specific user's order of the list elements (which is the interesting one in this case).</p>\n"},{"tags":["database","query","configuration","nosql","ravendb"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":71,"score":5,"question_id":13083421,"title":"RavenDB Database Configuration","body":"<p>How to configure the RavenDB database that can be capable to sending too many requests, or receiving too large a response?</p>\n\n<p>By default, RavenDB will not allow operations that might compromise the stability of either the server or the client and a RavenDB session automatically enforces the following limitations:</p>\n\n<ol>\n<li><p>If a page size value is not specified, the length of the results will be limited to 128 results. At the server side as well, there is a hard limit to the page size of 1,024 results.</p></li>\n<li><p>The number of remote calls to the server per session is limited to 30.</p></li>\n</ol>\n\n<p>I want to configure DocumentStore/DocumentSession in the client that it increase limitation of page size value and number of remote calls the server per session.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":9689587,"title":"Can someone advise on simplifying a MySQL query so it doesn't take minutes to execute and/or display incorrect results","body":"<p>We are using SugarCRM with ZuckerReports at the office and need a specific statistic coming out. </p>\n\n<p>The issue lies within my MYSQL query.</p>\n\n<p>If I use the following query</p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1'\nGROUP BY\n      accounts.id    \n</code></pre>\n\n<p>it runs realtively fast but also the result shows     NULL    rows in    NextStatus    .\nIf I add the same check for </p>\n\n<blockquote>\n  <p>NextStatus</p>\n</blockquote>\n\n<p>in the</p>\n\n<blockquote>\n  <p>PreviousStatus</p>\n</blockquote>\n\n<p>query, but omitting the NULLs, it takes around 20 minutes to finish and show only NULLs for</p>\n\n<blockquote>\n  <p>NextStatus</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>PreviousStatus</p>\n</blockquote>\n\n<p>Here's the modified query: </p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id AND\n  (SELECT accounts_audit.after_value_string \n      FROM accounts_audit \n      WHERE     \n      accounts_audit.field_name = 'statuses_c' \n      AND MONTH(accounts_audit.date_created) = 3 \n      AND YEAR(accounts_audit.date_created) = 2012 \n      AND (accounts_audit.after_value_string='Active' OR accounts_audit.after_value_string='Semi') \n      AND accounts_audit.parent_id = accounts.id \n      ORDER BY accounts_audit.date_created DESC LIMIT 1)&lt;&gt;NULL\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1'\nGROUP BY\n      accounts.id    \n</code></pre>\n\n<p>Could anyone point me in the right direction here?</p>\n\n<p>Also the 4 tables that we use have between 30000 and 50000 records each.\nThanks in advance!</p>\n\n<p>Ok, I noticed that I am actually filtering records only in one of the subqueries and thus the NULLs in the result. After moving a filter to the main conditions:</p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1' AND\n      accounts.id IN (SELECT \n                      b.parent_id\n                      FROM\n                      accounts_audit b\n                      WHERE\n                      b.field_name = 'statuses_c' AND \n                      MONTH(b.date_created) = 3 AND \n                      YEAR(b.date_created) = 2012 AND \n                      (b.after_value_string = 'Active' OR \n                      b.after_value_string = 'Semi')\n                      GROUP BY  parent_id ORDER BY  b.date_created)\nGROUP BY\n      accounts.id\n</code></pre>\n\n<p>I've got 45 mins of execution/at least, so far/ and no result :(</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Here's some info about the tables:</p>\n\n<p>The <code>accounts</code> table holds <code>name</code> and <code>id</code>(along other info that's not in this situation.</p>\n\n<p>The <code>accounts_audit</code> table holds <code>parent_id</code> and statuses along with their dates of update.</p>\n\n<p>The <code>tp_trade_profile</code> contains shipment info.</p>\n\n<p>The <code>tp_trade_prile_accounts_c</code> holds shipment id and the id of the account(form <code>accounts</code>) that is the owner of the shipment.</p>\n"},{"tags":["php","query","script","http-get"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":43,"score":-5,"question_id":13147166,"title":"How to write a PHP script that receive report via HTTP GET?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13146605/how-to-retrieve-data-using-http-get-from-external-url-using-php\">How to retrieve data using HTTP GET from external URL using PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>A company is supposed to send me a report via HTTP GET. \nA report is sent to my url (www.myurl.com/report.php)as query paramaters for example:\nmessageID, batch_ID, complete_Time ...</p>\n\n<p>I would like to know how can I write a PHP script that could receive that report.</p>\n\n<p>Is it possible to save it to a file , or read that from a database?</p>\n\n<p>Thank you for your help.</p>\n\n<p>Meda</p>\n"},{"tags":["php","mysql","query","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13146949,"title":"transpose using php after querying a database","body":"<p>I am using PHP to query a MYSQL database, and I am trying to output the data to an excel file.</p>\n\n<p>I have used phpexcel, csv, etc. With each i have successfully been able to output the data to an excel file, but I can't seem to transpose it in the excel (transpose- flip all columns into rows, and rows into columns)</p>\n\n<p>I can't find any tutorials to help me out.</p>\n\n<p>My question is, is there a way to use php to transpose those rows and columns from MYSQL and import them into an excel file?</p>\n\n<p>thanks!</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>exportMysqlToCsv($tablename,$tokenmain, $id);\nfunction exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){\n    $sql_query = \"select * from $tablename where token=1\";\n\n  // Gets the data from the database\n   $result = mysql_query($sql_query);\n\n    $f = fopen('php://temp', 'wt');\n    $first = true;\n\n//trying to transpose the data \nfunction transpose($array) {\n    array_unshift($array, null);\n    return call_user_func_array('array_map', $array);}\n\n//inserting it into the excel file  \n  while ($row = mysql_fetch_assoc($result)) {\n\n        if ($first) {\n\n            fputcsv($f, array_keys($row));\n\n            $first = false;\n\n         }\n\n      fputcsv($f, $row);\n    }\n} //end while\n</code></pre>\n\n<p><strong>Database sample:</strong></p>\n\n<pre><code>=======================================\n|  Male/female  |    Favorite artist  |\n=====+========+===============+=======|\n|    F          | Britney Spears      |\n|-------------------------------------|\n</code></pre>\n\n<p><strong>What I want it to look like:</strong></p>\n\n<pre><code>=====================================\n|Question          |  Answer        |\n=====+========+===============+=====|\n|   Male/female    |   F            |\n|----+--------+---------------+-----|\n| Favorite artist  | Britney Spears |\n|----+--------+---------------+-----|\n</code></pre>\n\n<p><strong>HUGE NOTE:</strong> There is no changing the database/hardcoding out the array in php. I want it all dynamic and the database is going to stay the way it is </p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13102714,"title":"Fatal error: Call to a member function query() on a non-object in .php file","body":"<p>I'm new to PHP and SQL, but I'm trying to create a login script for my webapp.\nFor some reason I'm stuck. When the username or password-field is empty, there is an alert, but when they are both filled in correct or incorrect, there is no alert.</p>\n\n<p>When I open the website in my browser (Chrome) and inspect the page, I get:</p>\n\n<p><strong>\"POST ../App/auth.php 500 (Internal Server Error)\"</strong> </p>\n\n<p>When I open the error.log-file from my server, I get:</p>\n\n<p><strong>\"PHP Fatal error:  Call to a member function query() on a non-object in ../App/class.manageUsers.php on line 24, referer: ../App/login.php\"</strong></p>\n\n<p>line 24 in class.manageUsers.php is:</p>\n\n<pre><code>$query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE username = '$username' AND\npassword = '$password' LIMIT 1\");\n</code></pre>\n\n<p>class.manageUsers.php:</p>\n\n<pre><code>&lt;?php\n\ninclude_once('class.database.php');\n\nclass ManageUsers{\n\n    protected $link;\n\n    function __construct(){\n        $db_conn = new ManageDatabase;\n        $this-&gt;link = $db_conn-&gt;connect();\n        return $this-&gt;link;\n    }\n    function addUsers($username,$firstname,$lastname,$email,$password,$user_level){\n        $query = $this-&gt;link-&gt;prepare(\"INSERT INTO users (username,firstname,lastname,email,password,user_level)\n            VALUES (?,?,?,?,?,?)\n        \");\n        $values = array($username,$firstname,$lastname,$email,$password,$user_level);\n        $query-&gt;execute($values);\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n    function loginUsers($username,$password){\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE username = '$username' AND password = '$password' LIMIT 1\");\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;           \n    }\n    function listUsers($user_id = null){\n        if(isset($user_id))\n        {\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE id = '$user_id' LIMIT 1\");\n        }\n        else\n        {\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users ORDER BY id DESC\");\n        }\n        $rowCount = $query-&gt;rowCount();\n        if($rowCount &gt;= 1)\n        {\n            $result = $query-&gt;fetchAll();\n        }\n        else\n        {\n            $result = 0;\n        }\n        return $result;\n    }\n\n    function editUsers($user_id,$param){\n        foreach ($param as $key =&gt; $value)\n        {\n        $query = $this-&gt;link-&gt;query(\"UPDATE users SET $key = '$value' WHERE id = '$user_id' LIMIT 1\");\n        }\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n\n    function deleteUsers($user_id){\n        $query = $this-&gt;link-&gt;query(\"DELETE FROM users WHERE id = '$user_id' LIMIT 1\");\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n\n}\n\n?&gt;\n</code></pre>\n\n<p>class.database.php:</p>\n\n<pre><code>&lt;?php\n\nclass ManageDatabase{\n\n    protected $db_conn;\n    protected $db_host = 'localhost';\n    protected $db_name = 'jqueryMobile';\n    protected $db_user = 'root';\n    protected $db_pass = '';\n\n    function connect(){\n        try{\n            $this-&gt;db_conn = new PDO(\"mySQL:host=$this-&gt;db_host;dbname=$this-&gt;db_name\",$this-&gt;db_user,$this-&gt;db_pass);\n            return $this-&gt;db_conn;\n        }\n        catch(PDOexception $e){\n            return $e-&gt;getMessage();\n        }\n    }\n\n}\n?&gt;\n</code></pre>\n\n<p>I hope someone can find where it seems to go wrong. \nThanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13146304,"title":"How to Select Every Row Where Column Value is NOT Distinct","body":"<p>I need to run a select statement that returns all rows where the value of a column (i.e. EmailAddress) is not distinct.</p>\n\n<p>For example, if the table looks like below:</p>\n\n<pre><code>CustomerName     EmailAddress\nAaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJason            jason@gmail.com\nEric             eric@gmail.com\nJohn             aaron@gmail.com\n</code></pre>\n\n<p>I need the query to return:</p>\n\n<pre><code>Aaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJohn             aaron@gmail.com (peer edited from john@gmail.com)\n</code></pre>\n\n<p>I have read many posts and tried different queries to no avail.  The query that I believe should work is below.  Can someone suggest an alternative or tell me what may be wrong with my query?</p>\n\n<pre><code>select EmailAddress, CustomerName from Customers\ngroup by EmailAddress, CustomerName\nhaving COUNT(distinct(EmailAddress)) &gt; 1\n</code></pre>\n"},{"tags":["sql","query","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13146033,"title":"oracle querying","body":"<p>Assuming I'm using a model like <a href=\"http://www.eclipse.org/birt/phoenix/db/dbschema/ClassicModelsDBSchema.jpg\" rel=\"nofollow\">this</a> </p>\n\n<p>How would I be able to find the last customer to order a give product?<br>\n<img src=\"http://i.stack.imgur.com/OeJ06.jpg\" alt=\"enter image description here\"></p>\n\n<p>I got this far</p>\n\n<pre><code>   SELECT customerNumber\nFROM ORDERS\nWHERE orderNumber = (SELECT  TOP 1 OrderNumber FROM orderDetails WHERE productCode = 1\nORDER BY orderDate DESCENDING)\n</code></pre>\n\n<p>Now I'm stuck. Not sure what subquery(s) should be.</p>\n"},{"tags":["php","html","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13104939,"title":"How to search for special characters in my database with an sql query in an accent insensitive way?","body":"<p>I have a table in my db that contains several columns and in some of them there are special characters like á, é, í, ó, ú, Á, É, Í, Ó, Ú, ñ and Ñ. I have in my webpage a search box and by using this I make a query that searches my bd table and displays the results like this:</p>\n\n<p>searching form:</p>\n\n<pre><code>&lt;form action=\"resultado.php\" method=\"post\" name=\"form1\" id=\"form1\"&gt;\n    &lt;th scope=\"col\"&gt;&lt;label for=\"busqueda\"&gt;&lt;/label&gt;\n    &lt;input type=\"text\" name=\"buscar\" id=\"buscar\" width=\"auto\" placeholder=\"Buscar...\" height=\"auto\" /&gt;\n  &lt;/th&gt;\n  &lt;th scope=\"col\" align=\"center\" valign=\"top\"&gt;&lt;input type=\"submit\" name=\"ACTION\" class=\"button1\" value=\"Buscar\"&gt;&lt;/th&gt;\n&lt;/tr&gt;&lt;/form&gt;\n</code></pre>\n\n<p>Button function</p>\n\n<pre><code> if (@$_POST['ACTION']=='Buscar'){ \n $buscar = $_POST['buscar'];\n $query = \"SELECT * FROM Medios_table WHERE concat(id,UPPER(Id_Nombre),UPPER(Pais),UPPER(Estado),UPPER(Ciudad),UPPER(website),UPPER(Url),UPPER(Url2),UPPER(InfAnex) COLLATE uft8_unicode_ci) LIKE UPPER('%$buscar%') ORDER BY Id_Nombre ASC\";\n $busquedaresult = mysql_query($query);}\n</code></pre>\n\n<p>In my table I have several columns that contains words like \"Andalucía\" and \"España\" many times as a result from this query if I type in the search box \"andalucia\" nothing comes up, but if I type \"Andalucía\" now it does show up, if I search \"Espana\" nothing shows up but \"España\" works fine, i cannot make it accent insensitive. my table and column collation is utf8_unicode_ci and my webpage meta looks like this</p>\n\n<pre><code> &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n</code></pre>\n\n<p>I'm using a myPhpAdmin in my website to create or modify my db and it has the mySQL server 5.1.1</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13144230,"title":"Divisioning of results of two select SQL-statements","body":"<p>So this is my problem:</p>\n\n<p>I have 2 different sql select queries, which both return me a value (1425000 and 2850000)\nWhat i want to do now is the following:</p>\n\n<pre><code>Select (query1 / query 2)\nfrom xxxxx\nwhere xxxx;\n</code></pre>\n\n<p>But query 1 and query 2 are quiet complicated queries, having count and sum functions in it.</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["mysql","sql","query","phpmyadmin","sql-update"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140582,"title":"MySQL update query does not work #1064","body":"<p>Can anyone tell me what is wrong with this Query ?</p>\n\n<pre><code>UPDATE\n    violetta.navi__stop\nSET\n    violetta.navi__stop.endHour = VB.endHour\nFROM\n    violetta.navi__stop AS V\nINNER JOIN\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n\n<p>This code sample works for me on my database:</p>\n\n<pre><code>SELECT\nV.code, V.endHour\nFROM\n    violetta.navi__stop AS V\nUNIQUE\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n"},{"tags":["query","date","ms-access","transactions","max"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13140494,"title":"Get entire record for Max value (date) in one column","body":"<p>I am trying to query data for transactions. I want to get multiple columns for the latest dated transaction. PONumber, Vendor, Price for each item, last time purchased. For example:</p>\n\n<p>Data:</p>\n\n<pre><code>PONumber    Item    Vendor    Price    DateOrdered\n1           ABC     Wal-Mart  1.00     10/29/12\n2           ABC     BestBuy   1.25     10/20/12\n3           XYZ     Wal-Mart  2.00     10/30/12\n4           XYZ     HomeDepot 2.50     9/14/12\n</code></pre>\n\n<p>Desired Result Set:</p>\n\n<pre><code>PONumber    Item    Vendor    Price    DateOrdered\n1           ABC     Wal-Mart  1.00     10/29/12\n3           XYZ     Wal-Mart  2.00     10/30/12\n</code></pre>\n\n<p>Trying to use max function on DateOrdered, but when I include the vendor I get the last purchase for each vendor and item (too many rows). I need one record for each item. Any ideas on how to accomplish? Using MS Access 2007 with ODBC to oracle tables. Thanks in advance.</p>\n"},{"tags":["facebook","query","facebook-graph-api","facebook-fql"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":40,"score":4,"question_id":13144102,"title":"Using FQL to retrieve facebook status's of all users who are using My Facebook Application","body":"<p>I would like to retrieve status's of all users who are using my Facebook application.\nI am not interested in retrieving the user's friends statuses only interested in retrieving the users who are using my Facebook application and have granted my application the \"read_stream\" permission.</p>\n\n<p>I can successfully retrieve status's of the logged in user or one of the logged in user's friends by calling:</p>\n\n<pre><code>SELECT post_id, message, attachment, type FROM stream WHERE source_id = \"SOME ID\" AND type IN (46, 247)\n</code></pre>\n\n<p>But that is not my goal. I would like to get \"All\" users who are using my Facebook application and get their latest status feed without any particular user being logged in.</p>\n\n<p>For example: I am not logged in facebook now neither or you. But when you click the link below you will get an RSS Feed of this particular user. This user is actually a business page so it is open to the public. Click This <a href=\"https://www.facebook.com/feeds/page.php?format=rss20&amp;id=152237754851522\" rel=\"nofollow\">Link</a> </p>\n\n<p>I would like to retrieve this information from users who allow my application \"read stream\" permissions.</p>\n\n<p>I cannot retrieve this information on personal Facebook user pages. So I am under the impression I need to build a Facebook Application to do so.</p>\n"},{"tags":["sql","query","select","join","left-join"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":6,"view_count":42,"score":-6,"question_id":13144251,"title":"query has to many joins","body":"<p>I have this query and works fine. I want to know another way of doing this ?</p>\n\n<pre><code>SELECT  UP.PHYS_RESR_ID,  UP.EQMT_INIT,  UP.EQMT_NBR,  UP.PRIM_OWN_INIT, UP.AAR_CAR_TYPE,  UP.AAR_CAR_CODE ,UP.AAR_END_DOOR_TYPE, UP.TOTL_AXLE_CNT,  UP.LAST_UPTD_DT,  UP.LAST_UPTD_USER_ID,   \n     EXTHGT.DIMN_VALU as EXTHGT , EXTHGT.UOM_CODE   as UNIT_EXTHGT  \n   , EXTWD.DIMN_VALU as EXTWD , EXTWD.UOM_CODE   as UNIT_EXTWD  \n   , INHGT.DIMN_VALU as INHGT , INHGT.UOM_CODE   as UNIT_INHGT  \n   , INLGTH.DIMN_VALU as INLGTH , INLGTH.UOM_CODE   as UNIT_INLGTH  \n   , INWDTH.DIMN_VALU as INWDTH , INWDTH.UOM_CODE   as UNIT_INWDTH  \n   , OUTLGT.DIMN_VALU as OUTLGT , OUTLGT.UOM_CODE   as UNIT_OUTLGT  \n   , SDHGT.DIMN_VALU as SDHGT , SDHGT.UOM_CODE   as UNIT_SDHGT  \n   , SDWDTH.DIMN_VALU as SDWDTH , SDWDTH.UOM_CODE   as UNIT_SDWDTH \n\n   FROM EQU_EQMT UPE \n\n  left join EQU_EQMT_DIMN EXTHGT on EXTHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID and EXTHGT.DIMN_TYPE = 'EXTHGT' and   ( EXTHGT.POS_DESC is null      or  EXTHGT.POS_DESC =  'VALU'      or  EXTHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN EXTWD on  EXTWD.PHYS_RESR_ID = UP.PHYS_RESR_ID   and EXTWD.DIMN_TYPE =  'EXTWD'      and   ( EXTWD.POS_DESC is null      or  EXTWD.POS_DESC =  'VALU'      or  EXTWD.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INHGT on  INHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INHGT.DIMN_TYPE =  'INHGT'      and   ( INHGT.POS_DESC is null      or  INHGT.POS_DESC =  'VALU'      or  INHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INLGTH on  INLGTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INLGTH.DIMN_TYPE =  'INLGTH'      and   ( INLGTH.POS_DESC is null      or  INLGTH.POS_DESC =  'VALU'      or  INLGTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INWDTH on  INWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INWDTH.DIMN_TYPE =  'INWDTH'      and   ( INWDTH.POS_DESC is null      or  INWDTH.POS_DESC =  'VALU'      or  INWDTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN OUTLGT on  OUTLGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and OUTLGT.DIMN_TYPE =  'OUTLGT'      and   ( OUTLGT.POS_DESC is null      or  OUTLGT.POS_DESC =  'VALU'      or  OUTLGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDHGT on  SDHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDHGT.DIMN_TYPE =  'SDHGT'      and   ( SDHGT.POS_DESC is null      or  SDHGT.POS_DESC =  'VALU'      or  SDHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDWDTH on  SDWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDWDTH.DIMN_TYPE =  'SDWDTH'      and   ( SDWDTH.POS_DESC is null      or  SDWDTH.POS_DESC =  'VALU'      or  SDWDTH.POS_DESC =  'valu'           );\n</code></pre>\n\n<p>I WANT TO DO A NEW QUERY THAT GIVES ME THE SAME INFO ANY ADVICES ?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13133234,"title":"MySQL Join table export to CSV with HTML body column","body":"<p>I've got below query to export to CSV with column body that has HTML values.</p>\n\n<p>Problem is even though when I replace comma with space, it doesn't show up properly (as in not appearing correctly) and also rows are not terminating with line break.</p>\n\n<pre><code>SELECT j.id,j.title,j.featured,REPLCAE(j.body,',',' '),j.created,j.created_by,j.start_date,j.end_date,j.apply_link,o.name,o.website,o.logo,o.created,p.code,p.suburb,s.name INTO OUTFILE '/tmp/careersandjobs.csv'\nFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"'\nESCAPED BY '\\\\'\nLINES TERMINATED BY '\\n'\nFROM job j\nLEFT JOIN portfolio_job pj\nON pj.job_id = j.id\nLEFT JOIN organisation o\nON o.id = j.organisation_id\nLEFT JOIN postcode p\nON p.id = j.postcode_id\nLEFT JOIN state s\nON s.id = p.state_id\nWHERE published = 1\nAND end_date &gt; CURDATE()\nAND pj.port_id = 8\n</code></pre>\n\n<p>Is there a reason behind this?</p>\n\n<p>@Michael</p>\n\n<p>I've tried with what you suggested but it now generates this error:</p>\n\n<pre><code>Failed to execute SQL : SQL SELECT j.id,j.title,j.featured,REPLACE(j.body,',',' ') as body,j.created,j.created_by,j.start_date,j.end_date,j.apply_link,o.name,o.website,o.logo,o.created,p.code,p.suburb,s.name INTO OUTFILE '/tmp/careersandjobs.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' ESCAPED BY '\\\\' LINES TERMINATED BY \"\\n\" FROM job j LEFT JOIN portfolio_job pj ON pj.job_id = j.id LEFT JOIN organisation o ON o.id = j.organisation_id LEFT JOIN postcode p ON p.id = j.postcode_id LEFT JOIN state s ON s.id = p.state_id WHERE published = 1 AND end_date &gt; CURDATE() AND pj.port_id = 8 failed : Field separator argument is not what is expected; check the manual\n</code></pre>\n"},{"tags":["php","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13143965,"title":"PHP Export Date range","body":"<p>I have a working database export to xls but I need it to export a particular date range based on the 'closed' date. (See code below).</p>\n\n<p>For example, I'd like it to export all 'closed' dates for last month and/or this month (Range: Sept 1, 2012 to Sept 30, 2012  or  Oct 1, 2012 to Oct 31, 2012)</p>\n\n<pre><code>&lt;?PHP\n\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"ost_helpdesk\";                //your MySQL Database Name\n$DB_TBLName = \"ost_ticket\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select ticketID, name, company, subject, closed from $DB_TBLName ORDER BY closed DESC\";\n\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"MDT Database Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n\n     }\n}\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","query","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13143892,"title":"Is it really a good choice to transform every SQL query to functions call?","body":"<p>I would like to know if using functions call for most of SQL select in a software is a good idea ?</p>\n\n<p>Here are the pro argument that I found :</p>\n\n<ul>\n<li><p>faster, the sql engine already have the functions, and don't have to parse every query</p></li>\n<li><p>less data is transfered between the application and the sql engine</p></li>\n<li><p>better abstraction, as the application doesn't know about database implementation</p></li>\n<li><p>much bigger security, as the functions call are designed by a DBA</p></li>\n</ul>\n\n<p>I really don't like the idea of replacing most of my queries by functions call.</p>\n\n<p>I am wrong ? or is it really a great 'idea' ?</p>\n"},{"tags":["sql","query","join","row","max"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":54,"score":3,"question_id":13130524,"title":"SQL Query get data from one table, and get data from only one row from another table","body":"<p>I don't know how to explain my problem in the title, so I'll explain it better here...</p>\n\n<p>I have two tables</p>\n\n<pre><code>CREATE TABLE [dbo].[Ventas]\n(\n    [IdVenta] [int] IDENTITY(1,1) NOT NULL,\n    [FechaVenta] [date] NULL,\n    [HoraVenta] [varchar](10) NULL,\n    [Subtotal] [money] NULL,\n    [Iva] [money] NULL,\n    [Total] [money] NULL,\n    [Saldo] [money] NULL,\n    [Abono] [money] NULL,\n    [FormaDePago] [varchar](50) NULL,\n    [Plazos] [int] NULL,\n    [Estado] [varchar](50) NULL,\n)\n\nCREATE TABLE [dbo].[Plazos]\n(\n    [IdPlazo] [int] IDENTITY(1,1) NOT NULL,\n    [IdVenta] [int] NULL,\n    [NumeroPlazo] [int] NULL,\n    [FechaVencimiento] [date] NULL,\n    [FechaCorte] [date] NULL,\n    [FechaPenalizacion] [date] NULL,\n    [FechaLiquidacion] [date] NULL,\n    [Total] [money] NULL,\n    [Cargo] [money] NULL,\n    [Abono] [money] NULL,\n    [Estado] [varchar](50) NULL,\n)\n</code></pre>\n\n<p>now to add some data</p>\n\n<pre><code>INSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (182, CAST(0x54360B00 AS Date), N'11:20', 500.0000, 55.0000, 555.0000, 333.0000, 222.0000, N'A Credito', 5, N'Pendiente De Pago')\nINSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (183, CAST(0x54360B00 AS Date), N'12:29', 575.0000, 63.2500, 638.2500, 638.2500, 0.0000, N'Una Sola Exhibicion', 1, N'Pendiente De Pago')\n\n\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (93, 182, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (94, 182, 2, CAST(0x73360B00 AS Date), CAST(0x75360B00 AS Date), CAST(0x7A360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (95, 182, 3, CAST(0x91360B00 AS Date), CAST(0x94360B00 AS Date), CAST(0x99360B00 AS Date), NULL, 111.0000, 111.0000, 0.0000, N'Pendiente')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (96, 183, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), NULL, 639.0000, 639.0000, 0.0000, N'Pendiente')\n</code></pre>\n\n<p>Foreign Key On Ventas.IdVenta = Plazos.IdVenta</p>\n\n<p>Ok, Here's the deal...\nI need to use a query that brings data from all sales (Ventas), which only it supposed to be 2 rows...</p>\n\n<p>However, I need data from Plazos, but I only need data from Plazos \nWhat I need is to display data from plazos on the same row as Ventas, but only data from the most recent Plazo...</p>\n\n<p>you may notice that for example, in Plazos there is a column called NumeroPlazo which increases on the same IdVenta... what I need in this example is to display:</p>\n\n<p>Ventas IdVenta 182 with data from Plazos IdPlazo 95 (since from Plazos, IdPlazo 95 has the highest number on the column Numero Plazos...\nand of course IdVenta 183, but since it only has one Plazo, it will display data from that plazo...</p>\n\n<p>At the moment I had this query...</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>but it returns 4 rows (3 rows for Venta where IdVenta = 182, and one where IdVenta = 183)\nWhat I want is only 2 rows...</p>\n\n<p>Then I tried this query that worked... but only for one row</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nAND Plazos.NumeroPlazo = (SELECT MAX(Plazos.NumeroPlazo) FROM Plazos WHERE Plazos.IdVenta = 182)\nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>Obviously it only works for one sale since I specify Plazos.IdVenta = 182...\nMy question here is... how can I use the latter query to get the data I want for each sale...</p>\n\n<p>I hope yuo can help me...\nIf you need me to be more specific, please let me know.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13142611,"title":"Complex SQL query in string","body":"<p>I want to add this SQL Query into a php variable:</p>\n\n<p>But I have errors.. How can I add that SQL query in right format to the php variable..\nSo I can execute the query later on..</p>\n\n<pre><code>SELECT DISTINCT vtiger_account.account_no AS 'Accounts_Account_No'\n   , vtiger_account.accountname AS 'Accounts_Account_Name'\n   , vtiger_accountscf.cf_740 AS 'Accounts_Shipping_Street_Number'\n   , vtiger_accountshipads.ship_street AS 'Accounts_Shipping_Address'\n   , vtiger_accountshipads.ship_city AS 'Accounts_Shipping_City'\n   , vtiger_accountshipads.ship_state AS 'Accounts_Shipping_State'\n   , vtiger_accountshipads.ship_code AS 'Accounts_Shipping_Code'\n   , vtiger_accountshipads.ship_country AS 'Accounts_Shipping_Country'\n   , vtiger_accountshipads.ship_pobox AS 'Accounts_Shipping_Po_Box'\n   , vtiger_accountbillads.bill_state AS 'Accounts_Billing_State'\n   , vtiger_crmentity.crmid AS \"LBL_ACTION\"\nFROM vtiger_account\nINNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = vtiger_account.accountid\nINNER JOIN vtiger_accountbillads ON vtiger_account.accountid = vtiger_accountbillads.accountaddressid\nINNER JOIN vtiger_accountshipads ON vtiger_account.accountid = vtiger_accountshipads.accountaddressid\nINNER JOIN vtiger_accountscf ON vtiger_account.accountid = vtiger_accountscf.accountid\nLEFT JOIN vtiger_groups AS vtiger_groupsAccounts ON vtiger_groupsAccounts.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_account AS vtiger_accountAccounts ON vtiger_accountAccounts.accountid = vtiger_account.parentid\nLEFT JOIN vtiger_users AS vtiger_usersAccounts ON vtiger_usersAccounts.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users AS vtiger_lastModifiedByAccounts ON vtiger_lastModifiedByAccounts.id = vtiger_crmentity.modifiedby\nWHERE vtiger_account.accountid &gt; 0\n   AND vtiger_crmentity.deleted = 0\n   AND (\n      (\n         vtiger_accountshipads.ship_state = 'WA'\n         OR vtiger_accountbillads.bill_state = 'WA'\n         )\n      AND (\n         trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'HACO Australia'\n         OR trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'Sam'\n         )\n      )\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13142202,"title":"SQL query to different tables and show all","body":"<p>On my php web I have 3 content type saved on different tables with different number of columns</p>\n\n<p>for example:</p>\n\n<pre><code>Type 1 (X columns) (example: table_products)\nType 2 (Y columns) (example: table_customers)\nType 3 (Z columns) (example: table_posts)\n</code></pre>\n\n<p>I'm making a Search system that searchs on each type in the same Select, showing finally all results.</p>\n\n<p>Example:</p>\n\n<pre><code>I search: foo\n\nSystem searchs on: Type 1, type 2 and type 3 \"foo\" and shows:\n\n- Product foo1\n- Product foo2\n- Customer foo1\n- Customer foo2\n- Customer foo3\n- Post foo1\n (It's only an example)\n</code></pre>\n\n<p>Now I have three different functions to make the query on each type, but I don't like this because I can't paginate it.</p>\n\n<p><strong>I need to make a query that searchs on three tables at time.</strong></p>\n\n<p>Thank you</p>\n"},{"tags":["php","sql","database","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13142196,"title":"Export specific table columns to Excel","body":"<p>I'm trying to export specific column data (i.e., Ticket #, Company/Customer Name, Issue Subject, Date Closed) from my SQL DB table to Excel (.xls), I have the code written but it's exporting my entire Database table. (See code Below)</p>\n\n<p>Specific column data that needs to be exported:</p>\n\n<ul>\n<li>ticketID</li>\n<li>name</li>\n<li>company</li>\n<li>subject</li>\n<li>closed</li>\n</ul>\n\n<p>Also is there any way to add a function that only exports a specific range (i.e., Date range from October 1, 2012 to October 31, 2012)?</p>\n\n<p><pre></p>\n\n<code>&lt;?PHP\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"my_databse\";                //your MySQL Database Name\n$DB_TBLName = \"my_table\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select * from $DB_TBLName\";\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y H:i');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //following fix suggested by Josue (thanks, Josue!)\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n     }\n}\n\n?&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["query","jpa","entity","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13128588,"title":"Limiting size of jpa association query","body":"<p>The following query gets all the employees in the department:</p>\n\n<pre><code>List&lt;Employee&gt; employees = em.find(Department.class,departmentid).getEmployeeList();\n</code></pre>\n\n<p>However, i am looking to get only a limited number of results from the above query and not complete resultset.  Is it possible via the above query?</p>\n\n<p>I am aware of em.createQuery() alternative however would like to use the existing one-to-many association in the entity and not write a new query to get limited results.</p>\n\n<p>Any help or ideas would be great.</p>\n"},{"tags":["sharepoint","query","content","webparts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1227,"score":0,"question_id":6975151,"title":"Sharepoint Content Query Webpart untrusted xsl file","body":"<p>I have created a custom xsl file for the Content Query Webpart. I assigned the path of the xsl file to the property \"MainXsl\" of the CQW. After I put the CQW to a sub sitecollection, it show me the following message: \"The web part references an untrusted XSL file. Only XSL files contained in this site's Style Library may be referenced.\"</p>\n\n<p>I have checked up, there is my xsl file in the sub sitecollection (Style Library/XSL Style Sheets) and is published.</p>\n\n<p>Please tell me how to solve this problem.</p>\n\n<p>Thanks a lot in advance.</p>\n\n<p>Best regards\nG-Nosis.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","exists"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13141461,"title":"What can I do to speed up this SQL Query?","body":"<p>I've created this SQL query with the help of @Dems :-)</p>\n\n<p>Here is some detail, I tried to make a SQLFiddle but I kept getting errors with my variables... This works in Sql Server 2008...  My question is, how can I make my query faster? I know I'm doing a number of things wrong here (repeated nester queries), I'm hoping to get one of you SQL gurus to take a look and help me get this down from it's 30 minute execution time! :-S</p>\n\n<p>I'm not sure exactly how much information you need to be able to help me on this one, please fire away with any questions and I'll reply ASAP.  Sorry if the level of detail is lacking a little, I just don't know what you want/need to know!</p>\n\n<p>The basic idea behind the query is that in the game I want to find all players which haven't moved 5 units for a period of time, who have fired whilst stood still and did not fire for 60 minutes before they stopped moving.  The query works, but it's the <code>AND NOT EXISTS</code> clause which is slowing things down to a crawl, before I added that it took 16 seconds to run!  16 seconds is still a looong time, so any other improvements would be appreciated, but for now with this being my own POC game (just throwing bits and pieces together), 16 seconds is acceptable... </p>\n\n<pre><code>DECLARE @n INT , @DistanceLimit INT\nSELECT  @n = 2 , @DistanceLimit = 5;\n\nWITH    partitioned\n          AS ( SELECT   * ,\n                        CASE WHEN Distance &lt; @DistanceLimit THEN 1\n                             ELSE 0\n                        END AS PartitionID\n               FROM     EntityStateEvent\n               WHERE    ExerciseID = '8B50D860-6C4E-11E1-8E70-0025648E65EC'\n             ),\n        sequenced\n          AS ( SELECT   ROW_NUMBER() OVER ( PARTITION BY PlayerID ORDER BY EventTime ) AS MasterSeqID ,\n                        ROW_NUMBER() OVER ( PARTITION BY PlayerID, PartitionID ORDER BY EventTime ) AS PartIDSeqID ,\n                        *\n               FROM     partitioned\n             ),\n        filter\n          AS ( SELECT   MasterSeqID - PartIDSeqID AS GroupID ,\n                        MIN(MasterSeqID) AS GroupFirstMastSeqID ,\n                        MAX(MasterSeqID) AS GroupFinalMastSeqID ,\n                        PlayerID\n               FROM     sequenced\n               WHERE    PartitionID = 1\n               GROUP BY PlayerID ,\n                        MasterSeqID - PartIDSeqID\n               HAVING   COUNT(*) &gt;= @n\n             )\n    SELECT\nDISTINCT    ( sequenced.PlayerID ) ,\n            MIN(sequenced.EventTime) AS StartTime ,\n            MAX(sequenced.EventTime) AS EndTime ,\n            DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) AS StaticTime ,\n            Player.Designation AS 'Player'\n    FROM    filter\n            INNER JOIN sequenced ON sequenced.PlayerID = filter.PlayerID\n                                    AND sequenced.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                    AND sequenced.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n            INNER JOIN Events ON Events.FiringPlayerID = sequenced.PlayerID \n            INNER JOIN Player ON Player.PlayerID = sequenced.PlayerID\n                                 AND Player.Force = 'FR'\n                                 AND NOT EXISTS ( SELECT    *\n                                                  FROM      Events\n                                                  WHERE     Events.FiringPlayerID = Player.PlayerID\n                                                  GROUP BY  Events.FiringTime\n                                                  HAVING    Events.FiringTime BETWEEN DATEADD(minute,\n                                                              -60,\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ))\n                                                              AND\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ) )\n            INNER JOIN Player HitPlayer ON HitPlayer.PlayerID = Events.HitPlayerID\n    WHERE   HitPlayer.[FORCE] = 'HO'\n    GROUP BY GroupID ,\n            sequenced.PlayerID ,\n            Events.FiringPlayerID ,\n            Events.FiringTime ,\n            Player.Designation\n    HAVING  DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) &gt; 5\n            AND Events.FiringTime BETWEEN MIN(sequenced.EventTime)\n                                  AND     MAX(sequenced.EventTime)\n    ORDER BY StartTime\n</code></pre>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13141236,"title":"MYSQL insert into first empty column","body":"<p>I have a tbl, for example:</p>\n\n<pre><code>uniqueId     |    col1    |    col2   |   col3   \nu1                 8       \nu2\nu3                 13           89\n</code></pre>\n\n<p>What I want is to insert into the first empty column (can make them null if that helps). In the given if I'll add to u1 the value 2 it will be inserted into col2. If I do it for u2, it will enter col1. and for u3 it will enter to u3. These three queries will do the trick but I would rather do it in one.</p>\n\n<p><code>INSERT INTO tbl SET col1 = $toInsertVal WHERE uniqueId=u col1=''</code><br>\n<code>INSERT INTO tbl SET col2 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2=''</code><br>\n<code>INSERT INTO tbl SET col3 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2&lt;&gt;'' AND col3=''</code></p>\n"},{"tags":["c#","database","query","parameters","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13139950,"title":"C#.net Parametize OLE DB Query using MS Access as DB","body":"<p>ok i do have a OLEDB function that inserts data in the database. well i know the usual way on how to do SQL with OLEDB but what I want to do here is to parametize each data in the query string. </p>\n\n<p>Now I been in Google for almost 3 hours just know how to make parametized query in OLEDB but all of them are not working with me.</p>\n\n<p>Now at last my query seems to work fine in the code below but still an error occurs</p>\n\n<p><strong>my function code :</strong></p>\n\n<pre><code>private bool dbInsert(int [] inputNumbers, DateTime datetime){\n                try {\n                    String sql = \"INSERT INTO 655(1stNum, 2ndNum, 3rdNum, 4thNum, 5thNum, 6thNum, datedraw) VALUES(?, ?, ?, ?, ?, ? ,?)\";\n                    OleDbCommand dbcmd = new OleDbCommand(sql, app.oleDbConn());\n                    dbcmd.Connection.Open();\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[0];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[1];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[2];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[3];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[4];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[5];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.DBTimeStamp).Value = datetime;\n                    dbcmd.ExecuteNonQuery();\n                    dbcmd.Connection.Close();\n\n                }catch(OleDbException ex){\n                    showPrompt(\"Error reading the database\",Color.Red);\n                    Console.WriteLine(ex.ToString());\n                }\n                return true;\n            }\n</code></pre>\n\n<p><strong>this is the error log show in the console:</strong></p>\n\n<blockquote>\n  <p>System.Data.OleDb.OleDbException: Data type mismatch in criteria\n  expression.    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult\n  hr)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS\n  dbParams, Object&amp; executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp;\n  executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior\n  behavior, Object&amp; executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior\n  behavior, String method)    at\n  System.Data.OleDb.OleDbCommand.ExecuteNonQuery()</p>\n</blockquote>\n\n<p>the datatypes of my columns in my access db files are <strong>Numeric</strong> from 1stNum to 6thNum and <strong>Date/Time</strong> in datedraw, of course ID is <strong>AutoNumber</strong></p>\n\n<p>is there any mistake in the parametize query implementation? please help me.</p>\n\n<p><strong>Update</strong></p>\n\n<ul>\n<li>I change the OleDBType for nums to <strong>Numeric</strong> as in the Access file its <strong>Numeric</strong></li>\n</ul>\n"},{"tags":["ruby-on-rails","query","activerecord","count","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":633,"score":1,"question_id":4465591,"title":"ActiveRecord Grouping/Count Query Help Needed","body":"<p>I am using Rails 3.</p>\n\n<p>Suppose I have the following archetypical models:  Blog, Post, Comment, Category.  Blog has_many posts, Post has_many comments and belongs_to category.</p>\n\n<p>I want to know how many posts are in each category but only counting those that have comments.</p>\n\n<p>If I do the following:</p>\n\n<pre><code>blog.posts.group(\"category_id\").count\n</code></pre>\n\n<p>--This gives me an OrderedHash which is close to what I need but of course the problem is the count values include posts that have no comments.</p>\n\n<p>If I do:</p>\n\n<pre><code>blog.posts.group(\"category_id\").joins(\"comments\").count\n</code></pre>\n\n<p>--this gives me the number of comments that are in posts of that category (it does the same thing if I put the join before the grouping).</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["query","join","ms-access-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13128262,"title":"MS Access 07 - wildcard in JOIN query","body":"<p>I've got the following query</p>\n\n<pre><code>SELECT tblUsers.userfullname, \n       tblReports.reportdate, \n       tblReports.reportnumber, \n       tblRawData.reportcategory, \n       tblRawData.reportissue\nFROM tblRawData \nRIGHT JOIN (tblUsers RIGHT JOIN tblReports ON tblUsers.userID = tblReports.userID) ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum\nWHERE (\n       ((tblUsers.username) Like \"*\" &amp; [Forms]![frmSelect]![txtUser] &amp; \"*\") \n       AND\n       ((tblUsers.userShift) Like \"*\" &amp; [Forms]![frmSelect]![txtShift] &amp; \"*\")\n      );\n</code></pre>\n\n<p>Which works - except the part of </p>\n\n<pre><code>ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum\n</code></pre>\n\n<p>what i'm trying to match is instances where</p>\n\n<pre><code>tblReports.reportnumber = 410145\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tblRawData.reportnum = 12345.410145\n</code></pre>\n\n<p>or just </p>\n\n<pre><code>tblRawDatw.reportnum = 410145\n</code></pre>\n\n<p>but for some reason it just will not find that first match (ex: 12345.410145) unless the number is identical like the second match (ex: 410145).  I've tried formatting it as a number as well as text - and no luck.</p>\n\n<p>any idea what I may be missing?</p>\n\n<p>Update:  I tried making another query with just the two tables and it doesn't like to match.  i tried removing the \".\" (example: 12345.410145 into 12345410145) and no luck.  here's my second query.</p>\n\n<pre><code>SELECT tblReports.userID, \ntblRawData.reportnum,\ntblRawData.reportcategory,\ntblRawData.reportissue,\ntblReports.reportdate,\ntblReports.reportnumber\nFROM tblReports\nLEFT JOIN tblRawData ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum;\n</code></pre>\n\n<p>where if the data is like such.</p>\n\n<p>tblReports Report numbers:\n410145\n410144\n410143\n410142\n410141</p>\n\n<p>and tblRawData report numbers are such:\n12345.410145\n410143\n12344.410141</p>\n\n<p>the resulting query should show me all 5 records from tblReports - but three of those records have the notes and such from tblRawData.</p>\n"},{"tags":["mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13139717,"title":"MYSQL Query - need some assistance","body":"<p>I'm having a mysql table GAMES with the following columns: for example:</p>\n\n<pre><code>+-------+---------+\n| NAME  | PARTNER |\n+-------+---------+\n| Chris | Steven  |\n| Chris | Peter   |\n| Chris | Steven  |\n| Chris | Paul    |\n| Chris | Steven  |\n| Chris | Peter   |\n| Paul  | Chris   |\n| Paul  | Peter   |\n| Paul  | Steven  |\n| Paul  | Peter   |\n| Paul  | Peter   |\n| Paul  | Chris   |\n| Peter | Paul    |\n| Peter | Chris   |\n+-------+---------+\n</code></pre>\n\n<p>I would like to have a query for each name and the partner that they had most of the times, with an 'undefined' value if there is a ex aequo. So, for the above example the output should look something like this:</p>\n\n<pre><code>+-------+--------------+\n| NAME  | PARTNER_MOST |\n+-------+--------------+\n| Chris | Steven       |\n| Paul  | Peter        |\n| Peter | undefined    |\n+-------+--------------+\n</code></pre>\n\n<p>How could I achieve this in the most simple way? Thanks in advance!</p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13066509,"title":"can anyone please help me understand this query?","body":"<p>Can anyone help me understand this query? The <code>mktpgmvhclxref.mktpgmvhclxrefId.mktgPgm</code> part mostly. Generally it is <code>table_name.columnName</code> but here the format seems to be different </p>\n\n<pre><code>SELECT mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm, \n       mktpgm.mktgpgm, \n       mktpgmvhclxref.cmpgn, \n       campaign.cmpgndescription, \n       mktpgmvhclxref.mktpgmvhclxrefid.vhcl, \n       vhclhierarchy.modname, \n       mktpgmvhclxref.mktpgmvhclxrefid.modyr, \n       mktpgmvhclxref.userinsrt, \n       mktpgmvhclxref.rowinsrt \nFROM   mktpgmvhclxref mktpgmvhclxref, \n       mktpgm mktpgm, \n       vhclhierarchy vhclHierarchy, \n       campaign campaign \nWHERE  mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm = mktpgm.idmktgpgm \n       AND mktpgmvhclxref.cmpgn = campaign.campaignid \n       AND mktpgmvhclxref.mktpgmvhclxrefid.vhcl = vhclhierarchy.vhcl \n</code></pre>\n"},{"tags":["sql","oracle","query","plsql","plsqldeveloper"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":13138534,"title":"How to handle large string coming as an input parameter to the procedure?","body":"<p>I am getting 200 Supplier names as an input parameter with huge values to the stored procedure.I tried declaring in CLOB,VARCHAR2(32767).But when i try to execute it is not accepting.\nPlease anyone help me how to handle this   .</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE GMMT_PROC.or_rmce_RB_grid_sp (\n   p_plant_cd        IN VARCHAR2,\n   p_region_cd       IN VARCHAR2,\n   p_matrl_nbr       IN OUT VARCHAR2,\n   p_supplier_nbr    IN OUT VARCHAR2,\n   p_supplier_name   IN OUT CLOB,\n   p_mrpcontrollercd IN OUT VARCHAR2,\n   p_currency        IN   VARCHAR2,\n   oresultset        OUT  sys_refcursor,\n   p_err_cd          OUT  NUMBER,\n   p_err_msg         OUT  VARCHAR2\n)\nIS\nsqlquery varchar2(10000);\np1 varchar2(10);\np2 varchar2(20);\np3 varchar2(20);\np4 varchar2(20);\nv_percent varchar2(10):='%';\nV_FROM_CURRENCY VARCHAR2(5);\nV_EX_RATE NUMBER;\nv_matrl_nbr       VARCHAR2(10000);\nv_supplier_nbr    VARCHAR2(10000);\nv_supplier_name   CLOB;\nv_mrpcontrollercd  VARCHAR2(10000);\n\nBEGIN\np1:='matrl_nbr';\n v_matrl_nbr:=p_matrl_nbr;\n p2:='supplier_nbr';\n v_supplier_nbr :=p_supplier_nbr;\n p3:='supplier_name_txt';\n v_supplier_name :=p_supplier_name;\n p4:='mrp_controller_cd';\n v_mrpcontrollercd:=p_mrpcontrollercd; \nsqlquery:='select wk_nbr, nbr_working_days,'||p1||' as matrl_nbr ,'||p2||' as supplier_nbr,'||p3||' as supplier_name_txt,'||p4||' as mrp_controller_cd,sum(reqmnt_qty)reqmnt_qty , sum(proj_inven_qty)proj_inven_qty, sum(doh) doh,sum(proj_recpt_1) proj_recpt_1, sum(proj_recpt_2) proj_recpt_2, sum(proj_recpt_3) proj_recpt_3, sum(proj_recpt_4) proj_recpt_4,sum( proj_recpt_total_qty) proj_recpt_total_qty,sum(consumption_qty) consumption_qty, sum(consumption_var_qty) consumption_var_qty , sum(final_recpt_qty) final_recpt_qty,sum(recpt_var_qty) recpt_var_qty from GMMT_OWNER.OR_RMCE_GTT_PROJ_RECPT_T ';\nsqlquery:=sqlquery||' where ('''||v_matrl_nbr||''' IS NULL) OR matrl_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_matrl_nbr||'''))) OR matrl_nbr like '''|| v_matrl_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_nbr||''' IS NULL) OR supplier_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_nbr||'''))) OR supplier_nbr like '''|| v_supplier_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_name||''' IS NULL) OR supplier_name_txt IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_name||'''))) OR supplier_name_txt like '''|| v_supplier_name||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_mrpcontrollercd||''' IS NULL) OR mrp_controller_cd IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_mrpcontrollercd||'''))) OR mrp_controller_cd like '''|| v_mrpcontrollercd||v_percent||'''';\nsqlquery:=sqlquery||' group by wk_nbr, nbr_working_days,'||p1||','||p2||','||p3||','||p4||' order by wk_nbr';\n\nOPEN oresultset FOR sqlquery;\n\ndbms_output.put_line(sqlquery);\nEND;                \n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":44,"score":2,"question_id":13133208,"title":"MySQL Order by Two Columns","body":"<p>I have a Table Like Below</p>\n\n<pre>\n\n    CREATE TABLE Products(Product_id INT, ProductName VARCHAR(255), \n                          Featured enum('Yes', 'No'), Priority enum('p1', 'p2', 'p3'))\n\n\n    INSERT INTO Products(ProductName, Featured, Priority) \n                  VALUES('Product A', 'Yes', 'p1'),\n                        ('Product B', 'No',  'p2'),\n                        ('Product C', 'Yes', 'p1'),\n                        ('Product D', 'No',  'p1'),\n                        ('Product E', 'Yes', 'p3'),\n                        ('Product F', 'No',  'p2'),\n                        ('Product G', 'Yes', 'p1'),\n                        ('Product H', 'Yes', 'p2'),\n                        ('Product I', 'No',  'p2'),\n                        ('Product J', 'Yes', 'p3'),\n                        ('Product K', 'Yes', 'p1'),\n                        ('Product L', 'No',  'p3');\n\n\n</pre>\n\n<p>I Need to get the Featured products followed by product with priority p1, p2 and p3 </p>\n\n<pre>\n\nOp:\n   ProdName | Featured  | Priority\n\n    Product A   Yes         p1\n    Product C   Yes         p1\n    Product G   Yes         p1\n    Product K   Yes         p1\n    Product H   Yes         p2\n    Product E   Yes         p3\n    Product J   Yes         p3\n    Product D   No          p1\n    Product B   No          p2\n    Product F   No          p2\n    Product I   No          p2\n    Product L   No          p3\n\n</pre>\n\n<p>I Wrote a query below which ain't working..</p>\n\n<pre>                                           \n  SELECT * \n    FROM Products\n   ORDER BY Featured IN ('Yes') desc,\n            Priority IN ('p1', 'p2', 'p3') desc\n</pre>\n\n<p>Could u plz spot mistake in that</p>\n"},{"tags":["database","query","ms-access","report","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13134250,"title":"Two Queries: Group by Column, Subtract Similar Columns, Show Totals","body":"<p>I have the following two queries setup in Access.  Each query has only 1 line per org and the org names are consistent across the two queries.</p>\n\n<p>Query A (budget model based on Table A)</p>\n\n<pre><code>Org, Jan, Feb, ... Dec, Total\n-----------------------------\nA,   $68, $25, ... $51, $809\nB,   $23, $39, ... $13, $423\n...\nE,   $11, $90, ... $84, $789\n</code></pre>\n\n<p>Query B (budget model based on Table B)</p>\n\n<pre><code>Org, Jan, Feb, ... Dec, Total\n-----------------------------\nA,   $67, $25, ... $70, $821\nB,   $23, $39, ... $13, $423\n...\nE,   $15, $45, ... $71, $755\n</code></pre>\n\n<p>How can I create a report with all of the following information?  I'm having troubling bringing together the two queries, subtracting their values and then ultimately showing the totals rows all in the same report/query.</p>\n\n<pre><code>             Jan, Feb, ...  Dec,   Total\nOrg A:\n\n    Model A: $68, $25, ..., $51,   $809\n    Model B: $67, $25, ..., $70,   $821\n    A - B  : $ 1, $ 0, ..., ($19), ($12)\n\nOrg B:\n\n    Model A: $23, $39, ..., $13,   $423\n    Model B: $23, $39, ..., $13,   $423\n    A - B  : $ 0, $ 0, ..., $ 0,   $  0\n\n...\n\nOrg E:\n\n    Model A: $11, $90, ..., $84,   $789\n    Model B: $15, $45, ..., $71,   $755\n    A - B  :($ 4),$45, ..., $13,   $ 34\n\n-------------------------------------------\nTotals:\n\n    Model A: $102, $154, ..., $148,   $2021\n    Model B: $105, $109, ..., $154,   $1999\n    A - B  :($ 3), $45, ..., ($ 6),   $  22\n</code></pre>\n"},{"tags":["sql-server","query","sql-update","division","multiple-columns"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13137975,"title":"Divide by from selected columns","body":"<p>Sorry if the question was asked before i try search but not found. I'm still new on mssql so\nmaybe the answer are obvious just i cant find.</p>\n\n<p>My current query is:</p>\n\n<pre><code>SELECT gold_min, gold_max, gold_min_2, gold_max_2\nFROM m_rdb\n</code></pre>\n\n<p>I want to divide the values on current columns by 20 and then update, just not sure how to do.\nAny help are welcome. </p>\n"},{"tags":["php","mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":13136490,"title":"query for show nearest date descending in MySql","body":"<p>I have a event table which stored date (m/d/Y) in a following manner</p>\n\n<pre><code>eventid eventstart          eventend    status\n--------------------------------------------------------------\n    1       10/9/2012       10/27/2012  Active\n    2       4/3/2012        4/27/2012   Active\n    3       10/26/2012      10/27/2012  Active\n    4       2/7/2012        2/9/2012    Active\n    5       10/30/2012      10/31/2012  Active\n    6       10/9/2012       10/31/2012  Active\n    7       11/9/2012       10/19/2012  Active\n    8       10/31/2012      10/18/2012  Active\n</code></pre>\n\n<p>if i have input the date ie 10/29/2012 then i want to sort the startdate in the following manner </p>\n\n<pre><code>eventstart          \n-----------------\n10/30/2012\n10/31/2012 \n11/9/2012\n10/26/2012\n10/9/2012\n10/9/2012\n</code></pre>\n\n<p>can anyone help me</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13135552,"title":"oracle SQL how to remove time from date","body":"<p>I have a column named <code>StartDate</code> containing a date in this format: <code>03-03-2012 15:22</code></p>\n\n<p>What I need is to convert it to date. It should be looking like this: <code>DD/MM/YYYY</code></p>\n\n<p>What I have tried without success is:</p>\n\n<pre><code>select \np1.PA_VALUE as StartDate,\np2.PA_VALUE as EndDate\nfrom WP_Work p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.WP_ID AND p1.NAME = 'StartDate'\nLEFT JOIN PARAMETER p2 on p2.WP_ID=p.WP_ID AND p2.NAME = 'Date_To'\nWHERE p.TYPE = 'EventManagement2'\nAND TO_DATE(p1.PA_VALUE, 'DD/MM/YYYY') &gt;= TO_DATE('25/10/2012', 'DD/MM/YYYY')\nAND TO_DATE(p2.PA_VALUE, 'DD/MM/YYYY') &lt;= TO_DATE('26/10/2012', 'DD/MM/YYYY')\n</code></pre>\n\n<p>Is there a way to do this?</p>\n\n<p>EDIT1: the <code>PA_VALUE</code> column is: <code>VARCHAR2</code></p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13136022,"title":"select from the result of execute(@query)","body":"<p>I am using this SQL query</p>\n\n<pre><code>DECLARE @cols AS NVARCHAR(MAX),\n    @query  AS NVARCHAR(MAX)\n\nselect @cols = STUFF((SELECT distinct ',' + QUOTENAME(Animal2) \n                    from animals\n            FOR XML PATH(''), TYPE\n            ).value('.', 'NVARCHAR(MAX)') \n        ,1,1,'')\n\nset @query = 'SELECT Animal1, ' + @cols + ' from \n             (\n                select animal1, animal2, Corelation\n                from animals\n            ) x\n            pivot \n            (\n                min(Corelation)\n                for animal2 in (' + @cols + ')\n            ) p '\n\nexecute(@query)\n</code></pre>\n\n<p>See <a href=\"http://sqlfiddle.com/#!3/5b713/6\" rel=\"nofollow\">SQL Fiddle with demo</a></p>\n\n<p>When I execute the query I get a table as a return.</p>\n\n<p>How can I select from that table? I tried to use <code>SELECT * FROM (*past here the script*)</code> but it did not work. I just need to use the result of the execute(@query) as a table and select from it (to put it in a new table). How can I do it?</p>\n\n<p>Thanks</p>\n\n<p>NOTE: that query was an answer of <a href=\"http://stackoverflow.com/questions/13125187/sql-query-to-select-records-in-a-specific-format-using-pivot-or-other/\">this SO question</a></p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13134944,"title":"SQL finding out the common values in two tables","body":"<p>I have two tables as <code>vMerkmale</code> and <code>aREL_Adr_Merk</code>. They have one common attribute as <code>MID</code>. I want to bind <code>Mtitel</code> from <code>merkmale</code> whose  <code>MID</code>'s are common with <code>aREl_Adr_Merk</code>. BUT , the problem is that , when I choose two IDs then it binds all values of these two IDs. I JUST WANT  TO Bind their common  MTITEL Values. MY code is below..</p>\n\n<pre><code>   SELECT M.mtitel as Attribute FROM vMerkmale  M ,aREL_Adr_Merk R\n   where m.mid=R.MID and AdrID in(252674,247354) \n   group by M.MTitel\n</code></pre>\n"},{"tags":["php","wordpress","query","wordpress-plugin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13134813,"title":"Tags import export wordpress query","body":"<p>I have been try to code a plugin to import/export wordpres tags from excel file to database. but i am confused that what will be the SQL Query for that to extract the complete list of tags from wordpress database. </p>\n\n<p>please guide me how can i figure out this.</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","sql","query","date","max"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13121742,"title":"MySQL Query: Write max(Date) from whole table to each row","body":"<p>I need to find the max(n.LastEdited) (Latest Editing Date) for my whole table and write it on each row.</p>\n\n<p>What I have:</p>\n\n<pre><code>SELECT n.ID,\nn.Title,\nn.News,\n(SELECT max(n.LastEdited)) AS NewsLastEdited\nFROM News AS n\nORDER BY n.ID DESC\nLIMIT 0,20\n</code></pre>\n\n<p>What I get (not showing ID, Title, News, ...):</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:12\n2012-10-25 10:54:02\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n</code></pre>\n"},{"tags":["ruby-on-rails","query","controller","production"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":13130195,"title":"Rails - query works in view and controller in development, but only in view in production","body":"<p>I'm new to rails, so my question may have a simple answer. I am using rails 3.2.3. I have the following code to perform a search on my database:</p>\n\n<p><code>@search_results = User.search(\"test search\")</code></p>\n\n<p>Where <code>search</code> is defined in my model. This code works perfectly for me when <code>@search_results = Data.search(\"test search\")</code> is in either the view or controller in my development environment. In production, it works in the view, but not in the controller. I don't know why. Looking at my production log, there is a big difference in the SQL for the view and the controller:</p>\n\n<p>When query is from a view in production, this is what I see in the log:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (concat(field1, ' ', field2, ' ', field3) LIKE '%test%' AND concat(field1, ' ', field2, ' ', field3) LIKE '%search%'\n</code></pre>\n\n<p>That is exactly what I want. However, when query is from controller, the SQL turns into this:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (field1 LIKE '%test search%' OR field2 LIKE '%test search%' OR field3 LIKE '%test search%')\n</code></pre>\n\n<p>I don't understand what my controller in the production environment is doing to create this change.</p>\n\n<p>EDIT-Here is the <code>search</code> method:</p>\n\n<pre><code>def self.search(search)\n  if search\n    search_length = search.split.length\n     find(:all, :conditions =&gt; [([\"concat(field1, ' ', field2, ' ', field3) LIKE ?\"] *        search_length).join(' AND ')] + search.split.map { |name| \"%#{name}%\" }) \n  else\n    find(:all)\n  end\nend\n</code></pre>\n\n<p>I am using MySQL on both production and development.</p>\n"},{"tags":["oracle","query","notin"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":224,"score":3,"question_id":12982568,"title":"NOT IN query... odd results","body":"<p>I need a list of users in one database that are not listed as the <code>new_user_id</code> in another.  There are 112,815 matching users in both databases; <code>user_id</code> is the key in all queries tables.</p>\n\n<p><br />\nQuery #1 works, and gives me 111,327 users who are NOT referenced as a new_user_Id.  But it requires querying the same data twice.</p>\n\n<pre><code>-- 111,327 GSU users are NOT listed as a CSS new user \n--   1,488 GSU users ARE listed as a new user in CSS\n--\nselect count(gup.user_id)\nfrom   gsu.user_profile gup\n  join (select cud.user_id, cud.new_user_id, cud.user_type_code\n        from   css.user_desc cud) cudsubq\n    on gup.user_id = cudsubq.user_id\nwhere  gup.user_id not in (select cud.new_user_id \n                           from   css.user_desc cud\n                           where  cud.new_user_id is not null);\n</code></pre>\n\n<p><br />\nQuery #2 would be perfect... and I'm actually surprised that it's syntactically accepted.  But it gives me a result that makes no sense.</p>\n\n<pre><code>-- This gives me 1,505 users... I've checked, and they are not\n-- referenced as new_user_ids in CSS, but I don't know why the ones \n-- that were excluded were excluded.\n--\n-- Where are the missing 109,822, and whatexcluded them?\n-- \nselect count(gup.user_id)\nfrom   gsu.user_profile gup\n  join (select cud.user_id, cud.new_user_id, cud.user_type_code\n        from   css.user_desc cud) cudsubq\n    on gup.user_id = cudsubq.user_id\nwhere  gup.user_id not in (cudsubq.new_user_id);\n</code></pre>\n\n<p><br />\nWhat exactly is the where clause in the second query doing, and why is it excluding 109,822 records from the results?</p>\n\n<p><br />\n<strong>Note</strong>  The above query is a simplification of what I'm really after.  There are other/better ways to do the above queries... they're just representative of the part of the query that's giving me problems.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13131172,"title":"MySQL table value1 less than table value2","body":"<p>I have an issue here.\nThis is what I have: <code>mysql_query(\"SELECT * FROM hosts WHERE location='$locid' AND currentservers &lt; maxservers\");</code></p>\n\n<p>So, what I want to do is to select everything from a table where location is equal to the value and currentservers less than maxservers. I haven't tested this out yet since the whole function I'm making is quite large. currentservers and maxservers are columns in the table.</p>\n\n<p>Will this query work?\nAlso, I only want to return 1 row. How do I do that?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Best Regards,\nTom.</p>\n"},{"tags":["mysql","query","pagination","double"],"answer_count":7,"favorite_count":10,"up_vote_count":28,"down_vote_count":0,"view_count":12397,"score":28,"question_id":818567,"title":"MySQL pagination without double-querying?","body":"<p>I was wondering if there was a way to get the number of results from a MySQL query, and at the same time limit the results.</p>\n\n<p>The way pagination works (as I understand it), first I do something like</p>\n\n<pre><code>query = SELECT COUNT(*) FROM `table` WHERE `some_condition`\n</code></pre>\n\n<p>After I get the num_rows(query), I have the number of results. But then to actually limit my results, I have to do a second query like:</p>\n\n<pre><code>query2 = SELECT COUNT(*) FROM `table` WHERE `some_condition` LIMIT 0, 10\n</code></pre>\n\n<p>My question: Is there anyway to both retrieve the total number of results that would be given, AND limit the results returned in a single query? Or any more efficient way of doing this. Thanks!</p>\n"},{"tags":["mysql","query","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13129689,"title":"Speeding up MySQL SELECT queries with no results","body":"<p>I have a MySQL table of restaurants, described like so:</p>\n\n<pre><code> CREATE TABLE `restaurants` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `name` varchar(32) NOT NULL,\n    `description` varchar(512) NOT NULL,\n    `tags` varchar(512) DEFAULT NULL,\n    `type` enum('A','D','E','L','Q','R','P','T','Z') NOT NULL,\n    `popularity` int(11) DEFAULT '0',\n    PRIMARY KEY (`id`),\n    UNIQUE KEY `uc_type_name` (`type`,`name`),\n    KEY `name_idx` (`name`),\n    KEY `type_popularity_idx` (`type`,`popularity`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>Here is some status info about the table:</p>\n\n<pre><code>Name: restaurants\n    Engine: MyISAM\n    Version: 10\n    Row_format: Dynamic\n    Rows: 72999\n    Avg_row_length: 84\n    Data_length: 6204488\n    Max_data_length: 281474976710655\n    Index_length: 5280768\n    Data_free: 0\n    Auto_increment: 75634\n    Collation: utf8_general_ci\n    Checksum: NULL\n    Create_options:\n    Comment:\n</code></pre>\n\n<p>I am trying to build a query that returns the 6 most popular restaurants that match a given term for a given restaurant type:</p>\n\n<pre><code>SELECT `id`, `name`, `type`, `description` FROM `restaurants` \nWHERE `type` = 'A'\n      AND (`name` LIKE '%some restaurant%'\n           OR `description` LIKE '%some restaurant%' \n           OR `tags` LIKE '%some restaurant%')\nORDER BY `popularity` DESC\nLIMIT 6\n</code></pre>\n\n<p>One of the restaurant types, A, contains 61,500 of the restaurants. Furthermore, these A type restaurants often have relatively long descriptions and names. Therefore, when there are no results for the lookup for type A, the queries take as long as 0.8-0.9 seconds. When there are results, however, they run as fast as 0.1 seconds.</p>\n\n<p>How can I speed up the performance of this query?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13129705,"title":"How can I get data from database?","body":"<p>A guy did some php/database work for me a while back. He linked the pages to a menu (which had a separate function/table). I'm a little lost on how it's beneficial to link everything to a menu like that.</p>\n\n<p>Here's the code I'm trying to figure out:</p>\n\n<pre><code>function writeContent($page){\n$parentQ = \"select * from cdi_content where page=\\\"$page\\\"\";//query to obtain content for this page\n$parentResult = mysql_query($parentQ);//run query\n$link = mysql_fetch_assoc($parentResult);//result\necho $link['content'];//write content`\n}\n</code></pre>\n\n<p>With <code>&lt;?php writeContent(\"DDesign/index.php\");?&gt;</code> on the index.php page he created.</p>\n\n<p>From what I understand it runs through the menu function, but I'm just trying to get it to print what's in the \"content\" field in the database.</p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13128239,"title":"Getting data from multiple tables using joins","body":"<p>I have various tables like </p>\n\n<pre>Student\nprimary id , students name, course\n\nPapers\npaper id, papername, course, semester, type\n\nStudentOptions\nprimary id, studentid (foreign key - reference student id) and paperid (foreign key - references paper id)\n\nStudentsTerm\nstudentid (foreign key- references student id) and student semester</pre>\n\n<p>Now the kind of result i want is,</p>\n\n<p>I want to choose a course then the term, which will give me the number of papers/subject it has with their types (Mandatory/Optional) and with that i want to have the count of number of students studying those papers from all these tables.</p>\n\n<p>I don't wanna create any view or stuff, Just a normal select query will do. </p>\n\n<p>The query i am running is :</p>\n\n<pre><code>SELECT p_name,\n       p_id,\n       type,\n       Count(sps.studentid) AS counts\nFROM   students,\n       str,\n       papers\n       LEFT JOIN sps\n              ON sps.paperid = papers.p_id\nWHERE  sps.studentid = students.studentid\n       AND students.studentid = str.studentid\n       AND sps.studentid = str.studentid\n       AND str.semesterid = p_semid\n       AND str.sessionid = 12\n       AND students.course = c_id\n       AND c_id = 6\n       AND p_semid = 1\nGROUP  BY p_id \n</code></pre>\n\n<p>Thanks for your help in advance.</p>\n"},{"tags":["python","mysql","django","query","django-models"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13127526,"title":"Django Query Optimization - Using Itertools","body":"<p>I have an educational site that serves up curriculum based upon Grade level.</p>\n\n<ol>\n<li><p>The GradeLevel table stores all of the possible Grade Levels. Then I have LessonCategories and LessonCurriculum tables.</p></li>\n<li><p>The GradeLevel table has reverse relationships established with the curriculum and categories tables.</p></li>\n<li><p>I loop through each grade in the GradeLevel table, (8 grades), and grab the respective, curriculum and categories along the way.</p></li>\n<li><p>Upon completion, I stuff all of the collected curriculum and categories into a list and and pass that to my template.</p></li>\n</ol>\n\n<p>Now, the problem is that Django is evaluating each query AT LEAST twice. Once for the initial request and the second when I put it into the list. (I am using itertools to chain the results. Itertools is causing the queries to be run again.) This is having the adverse effect of slowing my server down to a crawl.</p>\n\n<p>My question is if someone could take a look at my models and queries and make a suggestion as to a better way to query as to avoid and/or mitigate this MAJOR performance bottle-neck.</p>\n\n<p><strong>GradeLevel Model:</strong></p>\n\n<pre><code>class GradeLevel(models.Model):\n    title = models.CharField('Grade',max_length=10, null=True, blank=True, db_index=True)\n    fullname = models.CharField('Description',max_length=100, null=True, blank=True, db_index=True)\n</code></pre>\n\n<p><strong>LessonCategory Model:</strong></p>\n\n<pre><code>class LessonCategory(models.Model):\n    title = models.CharField(max_length=255, null=True, blank=True, db_index=True)\n    ...\n    gradelevel = models.ManyToManyField(GradeLevel, related_name='grade_cats', null=True, blank=True)\n</code></pre>\n\n<p><strong>LessonCurriculum:</strong></p>\n\n<pre><code>class LessonCurriculum(models.Model):         \n    title = models.CharField(max_length=255, null=True, blank=True, db_index=True)\n    ...\n    gradelevel = models.ManyToManyField(GradeLevel, related_name='grade_curriculum', null=True, blank=True)\n</code></pre>\n\n<p>My View:</p>\n\n<pre><code>from itertools import chain\nfrom operator import attrgetter\n\ndef my_view(request):\n    grade_pk =  GradeLevel.objects.prefetch_related().get(title='pre-k')\n    grade_pk_categories = grade_pk.grade_cats.filter(active=True,featured=True)\n    grade_pk_galleries = grade_pk.grade_curriculum.filter(active=True,featured=True)\n\n    grade_k =  GradeLevel.objects.prefetch_related().get(title='k')\n    grade_k_categories = grade_k.grade_cats.filter(active=True,featured=True)\n    grade_k_galleries = grade_k.grade_curriculum.filter(active=True,featured=True)\n\n    grade_1 =  GradeLevel.objects.prefetch_related().get(title='1')\n    grade_1_categories = grade_1.grade_cats.filter(active=True,featured=True)\n    grade_1_galleries = grade_1.grade_curriculum.filter(active=True,featured=True)\n\n    grade_2 =  GradeLevel.objects.prefetch_related().get(title='2')\n    grade_2_categories = grade_2.grade_cats.filter(active=True,featured=True)\n    grade_2_galleries = grade_2.grade_curriculum.filter(active=True,featured=True)\n\n    grade_3 =  GradeLevel.objects.prefetch_related().get(title='3')\n    grade_3_categories = grade_3.grade_cats.filter(active=True,featured=True)\n    grade_3_galleries = grade_3.grade_curriculum.filter(active=True,featured=True)\n\n    grade_4 =  GradeLevel.objects.prefetch_related().get(title='4')\n    grade_4_categories = grade_4.grade_cats.filter(active=True,featured=True)\n    grade_4_galleries = grade_4.grade_curriculum.filter(active=True,featured=True)\n\n    grade_5 =  GradeLevel.objects.prefetch_related().get(title='5')\n    grade_5_categories = grade_5.grade_cats.filter(active=True,featured=True)\n    grade_5_galleries = grade_5.grade_curriculum.filter(active=True,featured=True)\n\n    grade_6 =  GradeLevel.objects.prefetch_related().get(title='6')\n    grade_6_categories = grade_6.grade_cats.filter(active=True,featured=True)\n    grade_6_galleries = grade_6.grade_curriculum.filter(active=True,featured=True)\n\n    grade_7 =  GradeLevel.objects.prefetch_related().get(title='7')\n    grade_7_categories = grade_7.grade_cats.filter(active=True,featured=True)\n    grade_7_galleries = grade_7.grade_curriculum.filter(active=True,featured=True)\n\n    grade_8 =  GradeLevel.objects.prefetch_related().get(title='8')\n    grade_8_categories = grade_8.grade_curriculum.filter(active=True,featured=True)\n    grade_8_galleries = grade_8.grade_curriculum.filter(active=True,featured=True)\n\n    gallery_list = list(set(sorted(chain(grade_pk_categories,grade_pk_galleries,grade_k_categories,grade_k_galleries,grade_1_categories,grade_1_galleries,grade_2_categories,grade_2_galleries,grade_3_categories,grade_3_galleries,grade_4_categories,grade_4_galleries,grade_5_categories,grade_5_galleries,grade_6_categories,grade_6_galleries,grade_7_categories,grade_7_galleries,grade_8_categories,grade_8_galleries), key=attrgetter('display_order'))))\n</code></pre>\n"},{"tags":["sql","mysql","query","join","subquery"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1244,"score":3,"question_id":4853203,"title":"SQL JOIN To Find Records That Don't Have a Matching Record With a Specific Value","body":"<p>I'm trying to speed up some code that I wrote years ago for my employer's purchase authorization app.  Basically I have a SLOW subquery that I'd like to replace with a JOIN (if it's faster).  </p>\n\n<p>When the director logs into the application he sees a list of purchase requests he has yet to authorize or deny. That list is generated with the following query:</p>\n\n<pre><code>SELECT * FROM SA_ORDER WHERE ORDER_ID NOT IN\n    (SELECT ORDER_ID FROM SA_SIGNATURES WHERE TYPE = 'administrative director');\n</code></pre>\n\n<p>There are only about 900 records in sa_order and 1800 records in sa_signature and this query still takes about 5 seconds to execute. I've tried using a LEFT JOIN to retrieve records I need, but I've only been able to get sa_order records with NO matching records in sa_signature, and I need sa_order records with \"no matching records with a type of 'administrative director'\".  Your help is greatly appreciated!</p>\n\n<p>The schema for the two tables is as follows:</p>\n\n<p>The tables involved have the following layout:</p>\n\n<pre><code>CREATE TABLE sa_order\n(\n    `order_id`        BIGINT       PRIMARY KEY AUTO_INCREMENT,\n    `order_number`    BIGINT       NOT NULL,\n    `submit_date`     DATE         NOT NULL,\n    `vendor_id`       BIGINT       NOT NULL,\n    `DENIED`          BOOLEAN      NOT NULL DEFAULT FALSE,\n    `MEMO`            MEDIUMTEXT,\n    `year_id`         BIGINT       NOT NULL,\n    `advisor`         VARCHAR(255) NOT NULL,\n    `deleted`         BOOLEAN      NOT NULL DEFAULT FALSE\n);\n\nCREATE TABLE sa_signature\n(\n    `signature_id`        BIGINT          PRIMARY KEY AUTO_INCREMENT,\n    `order_id`            BIGINT          NOT NULL,\n    `signature`           VARCHAR(255)    NOT NULL,\n    `proxy`               BOOLEAN         NOT NULL DEFAULT FALSE,\n    `timestamp`           TIMESTAMP       NOT NULL DEFAULT NOW(),\n    `username`            VARCHAR(255)    NOT NULL,\n    `type`                VARCHAR(255)    NOT NULL\n);\n</code></pre>\n"},{"tags":["mysql","database","performance","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13127703,"title":"need a sql query to find out the Database wait time ratio for MySQL","body":"<p>Oracle supports sql queries to <code>SYS.V_$SYSMETRIC</code> to find out Database Wait Time Ratio (% of wait or bottlenecks experienced in time spent on user-level calls)  <a href=\"http://www.oracle.com/technetwork/articles/schumacher-analysis-099313.html\" rel=\"nofollow\">http://www.oracle.com/technetwork/articles/schumacher-analysis-099313.html</a>. What is an equivalent query to find similar stats for MySQL database? </p>\n\n<p>I have looked at <code>information_schema.PROFILING</code> and <code>information_schema.PROCESSLIST</code> tables to calculate a similar measure but unable to comprehend what values to use / address.</p>\n\n<p>Any suggestions?</p>\n\n<p>I need it for both Windows and Linux Platforms with remote MySql server. I think a light-weight DB query would help as opposed to gathering CPU Utilization for the machine hosting MySQL server. </p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query","join","subquery"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13127389,"title":"SQL SubQuery from same data table","body":"<p>I'm having trouble wrapping my head around what should be a pretty simple query in MS SQL. I have two tables: <code>Employees</code> and <code>Departments</code>. </p>\n\n<p><code>Employees</code> consists of the standard items: <code>ID (pkey int)</code>, <code>FName</code>, <code>LName</code>, ... , <code>DepartmentID</code>.</p>\n\n<p><code>Departments</code> consists of <code>DepartmentID</code>, <code>DepartmentName</code>, ... , <code>ManagerID</code>.</p>\n\n<p>There is a relationship from <code>Employees.DepartmentID</code> to <code>Departments.DepartmentID</code>, and a relationship between <code>Departments.ManagerID</code> and <code>Employees.EmployeeID</code>. </p>\n\n<p>In other words, each employee has a department, and each department has a manager that is also an employee.</p>\n\n<p>I'm trying to create a view that will display the employee name, ... , department, and department manager.</p>\n\n<p>I keep getting an error that more than one value is being returned when using this code:</p>\n\n<pre><code>SELECT\nEmployees_1.EmployeeID, Employees_1.FirstName, Employees_1.LastName, \nDepartments_1.DepartmentName,\n(SELECT\n    dbo.Employees.LastName\n    FROM dbo.Employees \n    INNER JOIN dbo.Departments\n      ON dbo.Departments.DepartmentManager = dbo.Employees.EmployeeID\n) AS ManagerName\nFROM dbo.Employees AS Employees_1\nINNER JOIN dbo.Departments AS Departments_1 \n  ON Employees_1.Department = Departments_1.DepartmentID \n  AND Employees_1.EmployeeID = Departments_1.DepartmentManager\n</code></pre>\n\n<p>Any ideas on how to join back to the same table (different row) based on the relationship from a second table?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13127216,"title":"Improving query performance/rewriting query to be faster on MySQL","body":"<p>I have a couple of queries that run very slowly (several minutes) with the data currently in my database, and I'd like to improve their performance. Unfortunately they're kind of complex so the info I'm getting via google isn't enough for me to figure out what indexes to add or if I need to rewrite my queries or what... I'm hoping someone can help. I don't <em>think</em> they should be this slow, if things were set up properly.</p>\n\n<p>The first query is: </p>\n\n<pre><code>SELECT i.name, i.id, COUNT(c.id) \nFROM cert_certificates c \nJOIN cert_histories h ON h.cert_certificate_id = c.id \nLEFT OUTER JOIN inspectors i ON h.inspector_id = i.id\nLEFT OUTER JOIN cert_histories h2 \n  ON (h2.cert_certificate_id = c.id AND h.date_changed &lt; h2.date_changed)\nWHERE (h.cert_status_ref_id = ? OR h.cert_status_ref_id = ?) \n  AND h2.id IS NULL\nGROUP BY i.id, i.name\nORDER BY i.name</code></pre>\n\n<p>The second query is:</p>\n\n<pre><code>SELECT l.letter, c.number\nFROM cert_certificates c \nJOIN cert_type_letter_refs l ON c.cert_type_letter_ref_id = l.id\nJOIN cert_histories h ON h.cert_certificate_id = c.id\nLEFT OUTER JOIN cert_histories h2 \n  ON (h2.cert_certificate_id = c.id AND h.date_changed &lt; h2.date_changed)\nWHERE h.cert_status_ref_id = ? \n  AND h2.id IS NULL \n  AND h.inspector_id = ?\nORDER BY l.letter, c.number\n</code></pre>\n\n<p>The cert_certificates table contains nearly 19k records as does the cert_histories table (although in the future this table is expected to grow to approximately 2-3x the size of the cert_certificates table). The other tables are all quite small; less than 10 records each.</p>\n\n<p>The only indexes right now are on id for each table and on cert_certificates.number. I read in a couple of places (e.g. <a href=\"http://stackoverflow.com/questions/3658859/when-to-add-what-indexes-in-a-table-in-rails\">here</a>) to add indices for foreign keys, but in the case of the cert_histories table that'd be nearly all the columns (cert_certificate_id, inspector_id, cert_status_ref_id) which is also <a href=\"http://stackoverflow.com/questions/5447987/why-cant-i-simply-add-an-index-that-includes-all-columns\">not advisable</a> (according to some of the answers on that question e.g. Markus Winand's), so I'm kinda lost.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>ETA: The results from EXPLAIN on the first query are (sorry for the hideous formatting; I'm using SQLyog which presents it in a nice table but it seems StackOverflow doesn't support tables?):</p>\n\n<pre>id select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  h   ALL NULL    NULL    NULL    NULL    19740   Using where; Using temporary; Using filesort\n1   SIMPLE  i   ref index_inspectors_on_id  index_inspectors_on_id  768 marketing_development.h.inspector_id    1   \n1   SIMPLE  c   ref index_cert_certificates_on_id   index_cert_certificates_on_id   768 marketing_development.h.cert_certificate_id 91  Using where; Using index\n1   SIMPLE  h2  ALL NULL    NULL    NULL    NULL    19740   Using where</pre>\n\n<p>Second query:</p>\n\n<pre>id select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  h   ALL NULL    NULL    NULL    NULL    19795   Using where; Using temporary; Using filesort\n1   SIMPLE  c   ref index_cert_certificates_on_id   index_cert_certificates_on_id   768 marketing_development.h.cert_certificate_id 91  Using where\n1   SIMPLE  l   ALL index_cert_type_letter_refs_on_id   NULL    NULL    NULL    5   Using where; Using join buffer\n1   SIMPLE  h2  ALL NULL    NULL    NULL    NULL    19795   Using where</pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13124279,"title":"MYSQL query return empty result","body":"<p>I need to look up email preferences for users. </p>\n\n<p>This table contains the types of email a user can receive, broken down by category. </p>\n\n<pre><code>email_preferences_categories\n\n+----------+------------------+------+-----+---------+----------------+\n| Field    | Type             | Null | Key | Default | Extra          |\n+----------+------------------+------+-----+---------+----------------+\n| id       | int(10) unsigned | NO   | PRI | NULL    | auto_increment |\n| name     | text             | YES  |     | NULL    |                |\n| overview | text             | YES  |     | NULL    |                |\n+----------+------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>This table contains their preference for receiving various types. If they haven't set their preferences, this table won't have any rows for them.</p>\n\n<pre><code>email_preferences\n\n+------------+---------------------------------+------+-----+---------+----------------+\n| Field      | Type                            | Null | Key | Default | Extra          |\n+------------+---------------------------------+------+-----+---------+----------------+\n| id         | int(10) unsigned                | NO   | PRI | NULL    | auto_increment |\n| user_id    | int(10) unsigned                | NO   |     | NULL    |                |\n| name       | text                            | YES  |     | NULL    |                |\n| frequency  | enum('Daily','Monthly','None')  | YES  |     | Daily   |                |\n+------------+---------------------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>I need to construct a MYSQL query that returns the name and frequency corresponding to the email preferences for a given user. </p>\n\n<pre><code>SELECT name, frequency\nFROM email_preferences\nLEFT JOIN email_preferences_categories using (name)\nWHERE user_id = 42\n</code></pre>\n\n<p>Where I'm having trouble: If the user hasn't set their preferences, this query doesn't return any rows. I would like it to return the default of 'Daily' for email categories that are missing.</p>\n"},{"tags":["php","query","sugarcrm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":217,"score":0,"question_id":8838975,"title":"SugarCRM Get Last Email Date and Search on it","body":"<p>So I have been working with SugarCRM pretty extensively lately and I need to be able to display the last date a contact was emailed as well search based on how long ago a contact was emailed.  </p>\n\n<p>I can easily create a logic hook to get the last email date but I cannot search based on the value of that.</p>\n\n<p>So I looked in SearchFields.php and found the following code which obviously gets the email of the contact. </p>\n\n<pre><code>'email' =&gt; \n  array (\n    'query_type' =&gt; 'default',\n    'operator' =&gt; 'subquery',\n    'subquery' =&gt; 'SELECT eabr.bean_id FROM email_addr_bean_rel eabr JOIN email_addresses ea ON (ea.id = eabr.email_address_id) WHERE eabr.deleted=0 AND ea.email_address LIKE',\n    'db_field' =&gt; \n    array (\n      0 =&gt; 'id',\n    ),\n  ),\n</code></pre>\n\n<p>Using that data I decided to create a new array with the following code to get the last email date.  Obviously it will need to be sorted or something to get the actual last email date if the contact was emailed multiple times but you get the point.</p>\n\n<pre><code>'last_email_c' =&gt; \n  array (\n    'query_type' =&gt; 'default',\n    'operator' =&gt; 'subquery',\n    'subquery' =&gt; 'SELECT e.date_sent FROM emails e WHERE e.parent_type = \\'Contacts\\' AND e.parent_id = \\'{0}\\'',\n    'db_field' =&gt; \n    array (\n      0 =&gt; 'id',\n    ),\n  ),\n</code></pre>\n\n<p>My issue is, I don't know what to do with this new subquery, I checked in the listviewdefs and the searchdefs and cannot find any reference to either of these custom SearchFields.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["mysql","sql","database","query","one-to-many"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13108587,"title":"Selecting primary keys that does not has foreign keys in another table","body":"<p>For simplification, I have two tables related with one to many using a foreign key, for example:</p>\n\n<pre><code>Users table:\nid\nname\n\nActions table:\nid\nuser_id\n</code></pre>\n\n<p>one user may have many actions or not. I need an sql select that returns users ids that have not user_id value in the actions table.</p>\n\n<pre><code>Users Table:\nid      name\n1       John\n2       Smith\n3       Alice\n\nActions Table:\nid      user_id\n1       3\n2       1\n</code></pre>\n\n<p>So I need sql query that returns the user id 2 (Smith) because the foreign key values have not the id 2 </p>\n\n<p>I tried the following SQL, but it returns all users ids:</p>\n\n<pre><code>SELECT users.id from users left join actions on actions.user_id is null\n</code></pre>\n"},{"tags":["php","wordpress","query","post","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13102828,"title":"Multiple loop in wordpress with post type","body":"<p>I have this code to display all post:</p>\n\n<p><a href=\"http://pastie.org/5124323\" rel=\"nofollow\">http://pastie.org/5124323</a></p>\n\n<p>Shows the two types of post but does not work pagination. When I go to the next page shows the same post in the home page. I do not know what the problem is.</p>\n\n<p>And in the post_type \"articles\" category are not displayed.</p>\n"},{"tags":["php","sql","query","command-line"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13126050,"title":"Show each number sepparated after comma in php","body":"<p>I have two tables</p>\n\n<p>category</p>\n\n<pre><code>id | category\n------\n1  | One\n2  | Two\n</code></pre>\n\n<p>etc</p>\n\n<p>second one is</p>\n\n<p>mp_photos</p>\n\n<pre><code>id|name|test|CategoryID\n1 |name|test|1,2\n</code></pre>\n\n<p>So now i need to fetch data from mp_photos row CategoryID (1,2) every categoryid is seppareted by comma and link every number with Category name in first table </p>\n"},{"tags":["android","query","cursor","android-cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13125457,"title":"Query using where condition in Android","body":"<p>I want to set a query to get names which cointain the a particular string (here constraint). \nSO I coded: </p>\n\n<pre><code>Cursor contactCursor = cr.query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, new String[]{Phone.DISPLAY_NAME}, Phone.DISPLAY_NAME + \"like + ?\", new String[]{\"%\"+constraint+\"%\"}, Phone.DISPLAY_NAME + \" ASC\");\n</code></pre>\n\n<p>But I get en error. \nI know that I'm close. \nWhere I'm wrong?</p>\n"},{"tags":["mysql","query","table","inner-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13125473,"title":"Need help on creating a mysql query","body":"<p>I have three tables - 1-FriendShip, 2-Users, 3-Pages.\nFriendship table has fromUser, and toUser columns.\nfromUser column contains the user who initiated friend request. toUser contains who recieved friend request (Inspired from facebook)</p>\n\n<p>I want to select data from Pages table who are friends with a given user, say 'user1'.\nI can get the friends of user1 using this query:</p>\n\n<pre><code>  SELECT friends.`fromUser` AS `friend`\n    FROM friends\n    INNER JOIN users\n    ON friends.`fromUser` = users.`userid`\n    WHERE `friends`.`toUser`='user1'\n UNION\n  SELECT friends.`toUser` AS `friend`\n    FROM friends\n    INNER JOIN users\n    ON friends.`toUser` = users.`userid`\n    WHERE friends.`fromUser`='user1'\n</code></pre>\n\n<p>This gives me result like this:</p>\n\n<p>Friends<br/>\nuser2<br/>\nuser5<br/></p>\n\n<p>and so on...</p>\n\n<p>I want to select the pages of all these users and order them in descending order by timestamp column. Any one please provide a solution</p>\n"},{"tags":["sql","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13123118,"title":"The row must be shown same order in result set according to column value","body":"<p>I am using SQL Server 2008 R2.\nI have the following data:</p>\n\n<pre><code>ID   Value   OrderNumber\n1      A         NULL\n2      E          4\n3      C         NULL\n4      B         NULL\n5      F          2\n6      D         NULL\n</code></pre>\n\n<p>i want to write a query that must fetch data ordering by OrderNumber column considering OrderNumber values. The query result must be below:</p>\n\n<pre><code>ID      Value     OrderNumber\n1         A           NULL\n5         F            2  --indicates row must be second in result set. \n3         C           NULL\n2         E            4  --indicates row must be fourth in result set.\n4         B           NULL\n6         D           NULL\n</code></pre>\n\n<p>Thanks for reading and your answers.</p>\n"},{"tags":["java","query","hibernate","map","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13056216,"title":"Using HQL to search in a Map","body":"<p>I have a Java class (let's call it BigClass) which has a Map as attribute (Map&lt; MyClass, Integer >), what I would like to do is to make an HQL query to filter this classes depending on the values of this map.</p>\n\n<p>In fact, what I would like to do is to recover all instances (b) of BigClass which satisfy for a specific instance (m) of MyClass b.map.get(m) > 0.</p>\n\n<p>For example: I would like to recover an instance of BigClass, if its map has an entry like &lt; m, 2 >, and I would't like to recover an instance of BigClass if its map has an entry like &lt; m, 0 > or if m doesn't belong to the map keys.</p>\n\n<p>I've been searching and I found this post related to my problem:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10804664/using-hql-to-query-on-a-maps-values\">Using HQL to query on a Map&#39;s Values</a></p>\n\n<p>Although, it didn't give me a solution.</p>\n\n<hr>\n\n<p>These are some queries I've been trying with no success:</p>\n\n<pre><code>org.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( map[(SELECT b FROM MyClass b WHERE b.id = ?)] &gt; 0) ]\n\norg.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( index(map) = (SELECT b FROM MyClass b WHERE b.id = ?) ) &gt; 0) ]\n</code></pre>\n\n<p>Thanks in advance...</p>\n"},{"tags":["php","mysql","sql","database","query"],"answer_count":10,"favorite_count":0,"up_vote_count":3,"down_vote_count":5,"view_count":83,"score":-2,"question_id":13124338,"title":"How do I make sure rows are unique in sql?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3124793/how-to-ensure-that-mysql-rows-are-unique\">How to ensure that MySQL rows are unique?</a>  </p>\n</blockquote>\n\n\n\n<p>If I have a table where each column can have duplicate data, how do I keep it so each row is unique?</p>\n\n<p>Example:\nIf my table has (col_foo, col_bar) with the rows:</p>\n\n<ul>\n<li>A | X</li>\n<li>A | Y</li>\n<li>B | Y</li>\n</ul>\n\n<p>And I want to insert (A, X) how do I only end up with one row with values (A, X).</p>\n\n<p>I'll be using this in a web project, so it's going to be written in PHP.</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":99,"score":3,"question_id":13108525,"title":"MS Access 2010 query pulls same records multiple times, sql challenge","body":"<p>I'm currently working on a program that keeps track of my company's stock inventory, using ms Access 2010. I'm having a hard time getting the query, intended to show inventory, to display the information I want. The problem seems to be that the query pulls the same record multiple times, inflating the sums of reserved and sold product. </p>\n\n<p>Background: \nMy company stocks steel bars. We offer to cut the bars into pieces. From an inventory side, We want to track the length of each bar, from the moment it comes in to the warehouse, through it's time in the warehouse (where it might get cut into smaller pieces), until the entire bar is sold and gone. </p>\n\n<p>Database:\nThe query giving problems, is consulting 3 tables; </p>\n\n<ul>\n<li>Barstock (with the following fields)\n<ul>\n<li>BatchNumber (all the bars recieved, beloning to the same production heat)</li>\n<li>BarNo (the individual bar)</li>\n<li>Orginial Length (the length of the bar when recieved at the stock</li>\n</ul></li>\n</ul>\n\n<p>(BatchNumber and BarNo combined, is the primary key)</p>\n\n<ul>\n<li><p>Sales </p>\n\n<ul>\n<li>ID (primary key)</li>\n<li>BatchNumber</li>\n<li>BarNo</li>\n<li>Quantity Sold</li>\n</ul></li>\n<li><p>Reservation (a seller kan reserve some material, when a customer signals interest, but needs time to decide)</p>\n\n<ul>\n<li>ID (Primary key)</li>\n<li>BatchNumber</li>\n<li>BarNo</li>\n<li>Quantity reserved</li>\n</ul></li>\n</ul>\n\n<p>I'd like to pull information from the three tables into one list, that displays:\n-Barstock.orginial length As Received\n- Sales.Quantity sold As Sold\n- Recieved - Sold As On Stock\n- reservation.Quantity Reserved As Reserved\n- On Stock - Reserved As Available. </p>\n\n<p>The problem is that I suck at sql. I've looked into union and inner join to the best of my ability, but my efforts have been in vain. I usually rely on the design view to produce the Sql statements I need. With design view, I've come up with the following Sql: </p>\n\n<pre><code>SELECT \n  BarStock.BatchNo\n  , BarStock.BarNo\n  , First(BarStock.OrgLength) AS Recieved\n  , Sum(Sales.QtySold) AS SumAvQtySold\n  , [Recieved]-[SumAvQtySold] AS [On Stock]\n  , Sum(Reservation.QtyReserved) AS Reserved\n  , ([On Stock]-[Reserved])*[Skjemaer]![Inventory]![unitvalg] AS Available\nFROM \n  (BarStock \n    INNER JOIN Reservation ON (BarStock.BarNo = Reservation.BarNo) AND (BarStock.BatchNo = Reservation.BatchNo)\n  ) \n    INNER JOIN Sales ON (BarStock.BarNo = Sales.BarNo) AND (BarStock.BatchNo = Sales.BatchNo)\nGROUP BY \n  BarStock.BatchNo\n  , BarStock.BarNo\n</code></pre>\n\n<p>I know that the query is pulling the same record multiple times because; \n- when I remove the GROUP BY term, I get several records that are exactley the same.\n- There are however, only one instance of these records in the corresponding tables. </p>\n\n<p>I hope I've been able to explain myself properly, please ask if I need to elaborate on anything.</p>\n\n<p>Thank you for taking the time to look at my problem!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13123607,"title":"Create table as ( using a column and table name)","body":"<p>I need to build a table from several tables in MySql and I want it has two columns like:</p>\n\n<pre>-------------------\nname | table_name |\n-------------------</pre>\n\n<p>I'm doing this:</p>\n\n<pre><code>Create table teams as \n(\nSelect name from table1\nunion\nSelect name from table2\nunion\nSelect name from table3);\n</code></pre>\n\n<p>How could I include each table name as a second column??</p>\n\n<p>Thank you!</p>\n"},{"tags":["php","mysql","arrays","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13124040,"title":"php MySQL query not returning anything","body":"<p>I'm not sure exactly how to explain what the query does, however the problem isn't entirely with how it's set up, because it does work, in another instance, when I use it as an array, however it's not working when I use it with mysql_fetch_assoc(), so here is what my original query is(not the one im having trouble with):</p>\n\n<pre><code>SELECT * FROM \n(SELECT * FROM comments \n          WHERE postID='$id' AND state='0' \n          ORDER BY id DESC LIMIT 3\n) t ORDER BY id ASC\n</code></pre>\n\n<p>what this does is selects the last 3 comments on a post, then orders them in another way (so they show up in the correct order, old to new) Now this is the query for echoing out the array of comments directly.\nBut now what I want to do, is to just get the first id out of the 3 comments.</p>\n\n<p>here's what I have tried to do (and by the way, this query DOES work, when i replace my previous query to echo out the results in an array, but i need to get just the id for use, i don't want an array):</p>\n\n<pre><code>$previousIDq = mysql_fetch_assoc(mysql_query(\"\n                                   SELECT * FROM \n                                  (SELECT * FROM comments \n                                   WHERE postID='$id' AND state='0' \n                                   ORDER BY id DESC LIMIT 3\n                                  ) t ORDER BY id ASC LIMIT 1\"));\n\n $previousID = $previousIDq['id']; //this doesn't return the id as I want it to.\n</code></pre>\n"},{"tags":["sql-server","query","stored-procedures","join","outer-join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13124004,"title":"How show datetime select only in Sql Server?","body":"<p>I need show <code>datetime</code> when I select datetime only. Because I try to run SQL but show all <code>datetime</code>.</p>\n\n<p>Table <code>Emp</code>:</p>\n\n<pre><code>EmpNo   fullName\n00001   Midna\n00002   Klog\n00003   Porla\n00004   Seka\n00005   Mila\n</code></pre>\n\n<p>Table <code>tFile</code>:</p>\n\n<pre><code>EmpNo   cDate                     cTime\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000\n00001   2012-10-29 00:00:00.000   2012-10-29 19:00:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 19:32:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 18:35:00.000\n</code></pre>\n\n<p>This code</p>\n\n<pre><code>SELECT \n   em.EmpNo as 'EmpNo', \n   case \n       when tf.cDate &lt;&gt; null then tf.cDate \n            else coalesce(tf.cDate, '2012-10-29') \n   end as 'cDate', \n   Min(tf.cTime) as 'timeIn', \n   Max(tf.cTime) as 'timeOut'\nFROM \n   tFile tf \nFull Outer join \n   Emp em On tf.EmpNo = em.EmpNo\nGroup By \n   em.EmpNo,tf.cDate\nOrder By \n   'EmpNo'\n</code></pre>\n\n<p>returns this result:</p>\n\n<pre><code>EmpNo   cDate                     timeIn                     timeOut\n-------------------------------------------------------------------------------------\n00001   2012-10-21 00:00:00.000   2012-10-21 07:22:00.000    2012-10-21 17:35:00.000\n00001   2012-10-24 00:00:00.000   2012-10-24 07:30:00.000    2012-10-24 19:00:00.000\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000    2012-10-29 19:00:00.000\n00002   2012-10-25 00:00:00.000   2012-10-25 07:58:00.000    2012-10-25 18:35:00.000\n00002   2012-10-22 00:00:00.000   2012-10-22 08:04:00.000    2012-10-22 17:55:00.000\n00002   2012-10-24 00:00:00.000   2012-10-24 08:00:00.000    2012-10-24 18:45:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000    2012-10-29 19:32:00.000\n00003   2012-10-29 00:00:00.000   NULL                       NULL\n00004   2012-10-29 00:00:00.000   NULL                       NULL\n00005   2012-10-28 00:00:00.000   2012-10-28 07:30:00.000    2012-10-28 19:20:00.000\n00005   2012-10-27 00:00:00.000   2012-10-27 07:38:00.000    2012-10-27 19:30:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000    2012-10-29 18:35:00.000\n</code></pre>\n\n<p>But I need this result:</p>\n\n<p>I select date ex. <code>2012-10-29</code> then I need to show all rows with <code>2012-10-29</code> only.</p>\n\n<p>But some <code>Empno</code> don't have data in <code>2012-10-29</code> it's set NULL.</p>\n\n<pre><code>EmpNo   cDate                     timeIn                     timeOut\n---------------------------------------------------------------------------------------\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000    2012-10-29 19:00:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000    2012-10-29 19:32:00.000\n00003   2012-10-29 00:00:00.000   NULL                       NULL\n00004   2012-10-29 00:00:00.000   NULL                       NULL\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000    2012-10-29 18:35:00.000\n</code></pre>\n\n<p>Thanks for your time. :)</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","select"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13121094,"title":"Doing a comparison using the previous row?","body":"<p>I'm trying to work out an efficient way of comparing two rows in SQL Server 2008.  I need to write a query which finds all rows in the <code>Movement</code> table which have <code>Speed &lt; 10</code> N consecutive times.</p>\n\n<p>The structure of the table is:</p>\n\n<p>EventTime\nSpeed </p>\n\n<p>If the data were:</p>\n\n<pre><code>2012-02-05 13:56:36.980, 2\n2012-02-05 13:57:36.980, 11\n2012-02-05 13:57:46.980, 2\n2012-02-05 13:59:36.980, 2\n2012-02-05 14:06:36.980, 22\n2012-02-05 15:56:36.980, 2\n</code></pre>\n\n<p>Then it would return rows 3/4 (13:57:46.980 / 13:59:36.980) if I looked for 2 consecutive rows, and would return nothing if I looked for three consecutive rows.  The order of the data is EventTime/DateTime only.</p>\n\n<p>Any help you could give me would be great.  I'm considering using cursors but they're usually pretty inefficient.  Also, this table is approximately 10m rows in size, so the more efficient the better! :)</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","query","fuelphp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13123616,"title":"FuelPHP Query builder join on multiple fields","body":"<p>I need to create a query using the join on various parameters like:</p>\n\n<pre><code>SELECT foo.*, bar.* FROM foo LEFT JOIN bar ON foo.c1 = bar.c1 AND foo.c2 = bar.c2 WHERE foo c3 = \"somedata\";\n</code></pre>\n\n<p>The problem is that I can't find how to create \"AND\" using FuelPHP Query Builder.</p>\n\n<p>Thanks.</p>\n"},{"tags":["query","jpa","wildcard","like-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13122149,"title":"Using wildcards in column value in LIKE condition","body":"<p>I have a situation where I need to find an entity matching a given filename. The filename is in this form:</p>\n\n<pre><code>filename1 = \"ABCD_126518.pdf\";\nfilename2 = \"XYZ_32162.pdf\";\n</code></pre>\n\n<p>In the Oracle DB, I have entities with filename_patterns like the following:</p>\n\n<pre><code>ID | filename_pattern\n1  | ABCD_\n2  | KLM\n3  | XYZ_\n</code></pre>\n\n<p>I need to find the pattern ID that the given filename matches to. In the given example it should be ID = 1 for filename1 and ID = 3 for filename2. How should the query look like in Java for the named query?</p>\n\n<p>I need something like</p>\n\n<pre><code>SELECT p FROM FilenamePattern p WHERE p.filename_pattern || \"%\" LIKE :param;\n</code></pre>\n\n<p>We use Oracle DB and JPA 1.0.</p>\n"},{"tags":["sql-server","sql-server-2005","query"],"answer_count":7,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":8039,"score":10,"question_id":235515,"title":"Hierarchical Queries in SQL Server 2005","body":"<p>Way back when I was working in an Oracle shop I took the CONNECT_BY for granted.  Now I'm stuck working with SQL Server 2005 and have some nasty object hierarchies.  Specifically, we have a self referencing table where all child records have a column with their parent's id.  Currently we have a view that maps children to levels in the hierarchy and a nasty query that does the heavy lifting to connect parents with their children.  While this method works, it is far from elegant and reeks of taint.  I'm just curious how other people retrieve hierarchical data from SQL Server 2005.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13089625,"title":"Display products under product header PHP & MySQL","body":"<p>I have two tables; sublevel and subcat1. sublevel contains the products headers, or collective group name and the other one, subcat1 contains all the actual products..</p>\n\n<p>Here is sublevel table;</p>\n\n<p><code>\n<strong>CategoryID SublevelID  Name</strong><br /> \n67         1          Anaesthsia Thermometers<br />\n67         2          Forehead Thermometers<br />\n67         3          Drug Testing Thermometers<br />\n67         4          Drug Testing Thermometers\n</code></p>\n\n<p>and here is the other table, subcat1;</p>\n\n<p><code><strong>CategoryID SublevelID SubCatName</strong><br />\n67         2          12 Level Thermometer<br />\n67         1          Clinitrend<br />\n67         2          Forehead Thermometer<br />\n67         3          Briteline<br />\n67         3          BriteEvent\n</code></p>\n\n<p>The idea of what i want is the output and when i mean output i mean in php code to be something like this;</p>\n\n<p><strong>Anaesthesia Thermometers</strong> - Clinitrend</p>\n\n<p><strong>Forehead Thermometers</strong> - 6 Event Disposable, 6 Event Reusable, 12 Event</p>\n\n<p><strong>Drug Testing Thermometers</strong> - Briteline, BriteEvent</p>\n\n<p>The problem I keep running into is I keep repeating the same header with each product, but I only would like it once. I've tried GROUP BY, DISTINCT and LEFT JOIN but with every product that is retrieved it shows it's category header-I know I'm probably looking at the query the wrong way...everytime i think of something new that I could change the query I fail..</p>\n\n<p><a href=\"https://twitter.com/D_Azzopardi/status/258340698900819968/photo/1/large\" rel=\"nofollow\">I even drew out the table structure along with the ideal output</a> to see it differently, but my brain doesn't work that way.. </p>\n\n<pre><code>function catLevelsName(){\n\n// This would be used to select which category $cat_id = $_GET['cat_id'];\n\nglobal $dbc;\n\n$query = \"SELECT subcat1.SubCatName FROM subcat1 RIGHT JOIN sublevel ON sublevel.CategoryID = subcat1.CategoryID\";  \n$result = mysqli_query($dbc, $query) or die(mysqli_error(). \"&lt;p&gt;with query;&lt;br /&gt;$query\");\n\nwhile($row = mysqli_fetch_array($result)){\n\necho $row['Name'];\necho $row['SubCatName'];\n}\n</code></pre>\n\n<p>Any pointers to what I'm doing wrong?</p>\n\n<p>ps. A million apologies for my formatting.</p>\n"},{"tags":["query","vba","excel-2011"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":347,"score":0,"question_id":8280620,"title":"Excel 2011 (Mac) vba: text encoding fails when importing text files as QueryTables","body":"<p>I need to import text files to Excel sheets. The text files come both from Macs and PCs and contain characters from various languages. For Excel 2004 (PC) I have successfully used vba code like below for converting Mac-coded text to PC-coding:</p>\n\n<pre><code>Worksheets(\"A\").Cells.Clear\npth = Application.GetOpenFilename()\nWith Worksheets(\"A\").QueryTables.Add(Connection:=\"TEXT;\" &amp; pth, _\n Destination:=Worksheets(\"A\").Range(\"A1\"))\n    .TextFilePlatform = 10000\n    .TextFileColumnDataTypes = Array(xlTextFormat)\n    .Refresh\nEnd With\nWorksheets(\"A\").QueryTables(1).Delete\n</code></pre>\n\n<p>I am trying to use similar code for Excel 2011 to convert the coding from PC to Mac, using</p>\n\n<pre><code>.TextFilePlatform = xlWindows '=2\n</code></pre>\n\n<p>as suggested by running the macro recorder. Doing the importing manually works perfectly, changing the coding from PC to Mac, but the vba program run in Excel 2011 does not change the coding at all. The TextFilePlatform parameter can (in my version of Excel 2011; different language versions might possibly differ here) be set to 1, 2, or 3 (any other integer from -1000000 to 1000000 gives error 5), and the resulting text looks exactly the same for these three cases. Is there some other setting that overrules my attempt to convert the text coding? Any suggestion greatly appreciated!  </p>\n\n<p>Edit: I have confirmed that the code with .TextFilePlatform = xlWindows properly translates windows coded text to mac coding for Excel 10 (2001) and for Excel 11 (2004), contrary to the case for Excel 2011 described above.    </p>\n"},{"tags":["mysql","query","friends"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13090353,"title":"MySQL Query to find friends and number of mutual friends","body":"<p>I have looked through the questions but I cant find anything that does exactly what I need and I can't figure out how to do it myself.</p>\n\n<p>I have 2 tables, a user table and a friend link table. The user table is a table of all my users:</p>\n\n<pre><code>    +---------+------------+---------+---------------+\n    | user_id | first_name | surname |     email     |\n    +---------+------------+---------+---------------+\n          1         joe       bloggs    joe@test.com\n          2         bill      bloggs    bill@test.com\n          3         john      bloggs    john@test.com\n          4         karl      bloggs    karl@test.com\n</code></pre>\n\n<p>My friend links table then shows all relationships between the users, for example:</p>\n\n<pre><code>    +--------=+---------+-----------+--------+\n    | link_id | user_id | friend_id | status |\n    +---------+---------+-----------+--------+\n       1         1          3           a\n       2         3          1           a\n       3         4          3           a\n       4         3          4           a\n       5         2          3           a\n       6         3          2           a\n</code></pre>\n\n<p>As a note the a in the status column means approved, there could also be r(request) and d(declined).</p>\n\n<p>What I want to do is have a query where if a user does a search it will bring back a list of users that they are currently not already friends with and how many mutual friends each user has with them.</p>\n\n<p>I have managed to get a query for all users that are currently not friends with them. So if the user doing the search had the user id of 1:</p>\n\n<pre><code>SELECT u.user_id,u.first_name,u.surname\nFROM users u\n    LEFT JOIN friend_links fl\n        ON u.user_id = fl.user_id AND 1 IN (fl.friend_id)\nWHERE fl.friend_id IS NULL\nAND u.user_id != 1\nAND surname LIKE 'bloggs'\n</code></pre>\n\n<p>How then do I have a count of the number of mutual friends for each returned user?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just as an edit as I don't think I am being particularly clear with my question.</p>\n\n<p>The query that I currently have above will produce the following set of results:</p>\n\n<pre><code>    +---------+------------+---------+\n    | user_id | first_name | surname |\n    +---------+------------+---------+\n          2         bill      bloggs\n          4         karl      bloggs\n</code></pre>\n\n<p>Those are the users matching the surname bloggs that are not currently friends with joe bloggs (user id 1).</p>\n\n<p>Then I want to have how many mutual friends each of these users has with the user doing the search so the returned results would look like:</p>\n\n<pre><code>    +---------+------------+---------+--------+\n    | user_id | first_name | surname | mutual |\n    +---------+------------+---------+--------+\n          2         bill      bloggs     1\n          4         karl      bloggs     1\n</code></pre>\n\n<p>Each of these returned users has 1 mutual friend as joe bloggs (user id 1) is friends with john bloggs and john bloggs is friends with both returned users.</p>\n\n<p>I hope this is a bit more clear.</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","query-optimization","neo4j"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13120031,"title":"Map Neo4j on MySQL for fast select query","body":"<p>I designed Neo4j data schema but we want to take backup of neo4j database on MySQL.</p>\n\n<p>So we mapped nodes and relations as tables in mysql. ( we store nodes and relations number in tables too)</p>\n\n<p>Now for each page which user surf,we have near 1500 Socket.IO ( something like ajax but with a less overhead ) request to server. </p>\n\n<p>Is it good idea that query to MySQL database and get nodes and relations id of neo4j instead requesting Neo4j for do it?Is it faster or not?</p>\n\n<p><em>we mapped it to mysql because of fear of project provider to use new technology such as Neo4J</em></p>\n"},{"tags":["mysql","sql","regex","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":10827125,"title":"MySQL and word boundary in regex","body":"<p>How can I use regex word boundary in a MySQL query?</p>\n\n<p>For instance, I want to match either 'product' or 'newsletter',</p>\n\n<p>It works fine with <code>OR</code>, </p>\n\n<pre><code>IF(? = 'product' OR ? = 'newsletter', ... , ...)\n</code></pre>\n\n<p>But how about a regex? I assume it would be something like this below?</p>\n\n<pre><code>IF(? REGEXP '^('product'||'newsletter')+$', ..., ... ) \n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures","full-outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13118578,"title":"How can I use full outer join?","body":"<p>I need use join 2 table show all data.</p>\n\n<p><strong>Exam</strong></p>\n\n<p><strong>Table Contact</strong></p>\n\n<pre><code>numCode | fullName\n00001   | Midna \n00002   | Klog\n00003   | Porla\n00004   | Seka\n00005   | Mila\n</code></pre>\n\n<p><strong>Table dateFile</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n\n<p><strong>Code Sql Server</strong></p>\n\n<pre><code>SELECT df.numCode as 'numCode', tf.dateCurr as 'dateCurr'\nFROM dateFile df Full Outer join Contact ct On ct.numCode = df.numCode\nWHERE df.dateCurr = '2012-10-29'\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n\n<p><strong>But I need output get:</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00003   | 2012-10-29 00:00:00.000  (Insert Date from choose datetime)\n00004   | 2012-10-29 00:00:00.000  (Insert Date from choose datetime)\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n"},{"tags":["android","database","query","android-intent","sms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13118427,"title":"How to clear db when app is uninstalled in android","body":"<p>Im using database to store messages, and if i uninstall my app and again reinstall the same app, the db remains same, but i want to clear my database, how to solve this?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13118928,"title":"SQL new attribute join from another table","body":"<p>I have a SQL query like that</p>\n\n<pre><code>select M.mtitel as Attribute from aRel_adr_Merk R \ninner join vMerkmale M on M.mid=R.mid   \nwhere adrid in(\" + listdatenids + \")\", utilDB.conn()\n</code></pre>\n\n<p>I have another table called as aAdress. I want to bind adrID from aAdressen. But, they have no common attributes. I just want to show adrID also. How may I do it?</p>\n"},{"tags":["mysql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13117499,"title":"Update query on mutiple table in Sqlite or SQL","body":"<p>Hi I am new to SQL database.</p>\n\n<p>I have two tables one is a \"Master\" and other is \"Sub\" like this</p>\n\n<pre><code>Master \nuid(primary key)         f_name            l_name\n 1                        fAaa              lAaa\n 2                        fBbb              lBbb\n</code></pre>\n\n<p>second table</p>\n\n<pre><code>Sub \ntid(primary key)         uid(foreign key)      time           is_free\n  1                        1                   1:00AM           0\n  2                        1                   2:00AM           1 \n  3                        1                   3:00AM           0 \n  4                        2                   1:30PM           0\n  5                        2                   2:30PM           1   \n</code></pre>\n\n<p>from both table we can say that user fAaa lAaa is free at 2:00AM and NOT free at 1:00AM and 3:00AM.</p>\n\n<p>now I want to update like this, for user 1(fAaa lAaa), I want to delete time 2:00AM and want to insert new two time like 5:00AM and 6:00AM for user 1 than what should be my join query for update. </p>\n\n<p>please help me!\nThanks</p>\n"},{"tags":["sql","database","postgresql","query","indexes"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1497,"score":3,"question_id":4675605,"title":"Speeding up a group by date query on a big table in postgres","body":"<p>I've got a table with around 20 million rows. For arguments sake, lets say there are two columns in the table - an id and a timestamp. I'm trying to get a count of the number of items per day. Here's what I have at the moment.</p>\n\n<pre><code>  SELECT DATE(timestamp) AS day, COUNT(*)\n    FROM actions\n   WHERE DATE(timestamp) &gt;= '20100101'\n     AND DATE(timestamp) &lt;  '20110101'\nGROUP BY day;\n</code></pre>\n\n<p>Without any indices, this takes about a 30s to run on my machine. Here's the explain analyze output:</p>\n\n<pre><code> GroupAggregate  (cost=675462.78..676813.42 rows=46532 width=8) (actual time=24467.404..32417.643 rows=346 loops=1)\n   -&gt;  Sort  (cost=675462.78..675680.34 rows=87021 width=8) (actual time=24466.730..29071.438 rows=17321121 loops=1)\n         Sort Key: (date(\"timestamp\"))\n         Sort Method:  external merge  Disk: 372496kB\n         -&gt;  Seq Scan on actions  (cost=0.00..667133.11 rows=87021 width=8) (actual time=1.981..12368.186 rows=17321121 loops=1)\n               Filter: ((date(\"timestamp\") &gt;= '2010-01-01'::date) AND (date(\"timestamp\") &lt; '2011-01-01'::date))\n Total runtime: 32447.762 ms\n</code></pre>\n\n<p>Since I'm seeing a sequential scan, I tried to index on the date aggregate</p>\n\n<pre><code>CREATE INDEX ON actions (DATE(timestamp));\n</code></pre>\n\n<p>Which cuts the speed by about 50%.</p>\n\n<pre><code> HashAggregate  (cost=796710.64..796716.19 rows=370 width=8) (actual time=17038.503..17038.590 rows=346 loops=1)\n   -&gt;  Seq Scan on actions  (cost=0.00..710202.27 rows=17301674 width=8) (actual time=1.745..12080.877 rows=17321121 loops=1)\n         Filter: ((date(\"timestamp\") &gt;= '2010-01-01'::date) AND (date(\"timestamp\") &lt; '2011-01-01'::date))\n Total runtime: 17038.663 ms\n</code></pre>\n\n<p>I'm new to this whole query-optimization business, and I have no idea what to do next. Any clues how I could get this query running faster?</p>\n\n<p><strong>--edit--</strong></p>\n\n<p>It looks like I'm hitting the limits of indices. This is pretty much the only query that gets run on this table (though the values of the dates change). Is there a way to partition up the table? Or create a cache table with all the count values? Or any other options?</p>\n"},{"tags":["database","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13118268,"title":"Query with integers not working","body":"<p>I've been searching here on stackoverflow and other sources but not found a solution to this</p>\n\n<p>The query below works as expected expect for when either <code>custinfo.cust_cntct_id</code> or <code>custinfo.cust_corrcntct_id = ''</code> (blank not <code>NULL</code>) then I get no results. Both are integer fields and if both have an integer value then I get results.  I still want a value returned for either <code>cntct_email</code> or <code>corrcntct_email</code> even if <code>custinfo.cust_cntct_id</code> or <code>custinfo.cust_corrcntct_id = blank</code></p>\n\n<p>Can someone help me out in making this work? The database is PostgreSQL.</p>\n\n<pre><code>SELECT \n  cntct.cntct_email AS cntct_email, \n  corrcntct.cntct_email AS corrcntct_email\nFROM \n  public.custinfo, \n  public.invchead, \n  public.cntct, \n  public.cntct corrcntct\nWHERE \n  invchead.invchead_cust_id = custinfo.cust_id AND\n  cntct.cntct_id = custinfo.cust_cntct_id AND\n  corrcntct.cntct_id = custinfo.cust_corrcntct_id;\n</code></pre>\n"},{"tags":["php","mysql","wordpress","query","data"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3535,"score":0,"question_id":5449218,"title":"PHP getting data from mysql database for the Query string variable","body":"<p>Here is what i would like to do. I am passing an encoded data as a query valiable to my webpage. then in my php page, i am decoding the data and checking the same in my database. the code i am using is shown below:</p>\n\n<pre><code>&lt;?php\n// Get the ID from URL.\n$id = ( isset($_GET[\"id\"]) &amp;&amp; !empty($_GET[\"id\"]) ? $_GET[\"id\"] : \"\");\n\n// If \"id\" is not empty, proceed.\nif(!empty($id)) {\n    $id = base64_decode($id);\n    global $wpdb;\n    $res = $wpdb-&gt;query(\"SELECT * FROM S_redirect WHERE source = \".$id);\n    $tot = count($res);\n\n    echo $tot . \" records found.\";\n\n    for( $i=0; $i&lt;count($res); $i++) {\n        echo $res[$i]-&gt;id;\n    }\n    exit;\n}\nelse {\n    echo \"No ID\";\n    exit;\n}\n?&gt;\n</code></pre>\n\n<p>I have one record in my database. the above code correctly says \"1 records found\". I am not sure how to get the value of the field in that row. I have 3 columns. they are id, field1 and field2. The code \"<code>echo $res[$i]-&gt;id</code>\" returns nothing.</p>\n\n<p>Please help</p>\n\n<p><strong>BTW, I am trying this in my Wordpress blog.</strong></p>\n\n<p>Thannk you all for your suggestions. I tried your suggestions and here are my results:</p>\n\n<pre><code>$res = $wpdb-&gt;query(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";\n</code></pre>\n\n<p>it says 1 records found.</p>\n\n<pre><code>$res = $wpdb-&gt;get_row(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";\n</code></pre>\n\n<p>it says 0 records found.</p>\n\n<pre><code>$res = $wpdb-&gt;get_results(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";  \n</code></pre>\n\n<p>it says 0 records found.</p>\n\n<pre><code>while ($row = mysql_fetch_array($res)) {\necho $row[0];  \n}\n</code></pre>\n\n<p>If i use mysql_fetch_array, </p>\n\n<pre><code>Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource in /home/myfolder/mytheme/index.php on line 38.\n</code></pre>\n\n<p>line 38 is while ($row = mysql_fetch_array($res)) {.</p>\n\n<p><strong>What I am trying to accomplish:</strong></p>\n\n<p>I have a wordpress blog. All the above code goes into my index.php. I will pass a product id to my index.php via query string variable. I have created a new table called S_redirect in my wordpress database. i will retrieve the value of query string variable id and check the same in my database table. If record exists, then retrieve one of the column value (url of the product) from that table row and redirect to that product url. If the record doesn't exists then redirect to home page. hope this helps everyone to understand what I am doing.</p>\n\n<p>Thank you all :)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13116504,"title":"Mysql innerjoin clause doesn't working","body":"<p>I have 2 tables as follow:</p>\n\n<p><strong><code>talk</code> table</strong>:</p>\n\n<pre><code>topic_id | topic_name | user_id (user who create topic)\n  1           test1        1\n  2           test2        2\n</code></pre>\n\n<p><strong><code>talk_reply</code> table</strong>:</p>\n\n<pre><code>talk_reply_id | message | topic_id | user_id (user who reply to specific topic)\n     1            hi1        1         3\n     2            hi2        1         4\n</code></pre>\n\n<p><strong><code>user</code> table</strong>:</p>\n\n<pre><code>user_id  | name\n  1        mark\n  2        pedro\n  3        gates\n  4        steve\n</code></pre>\n\n<p>My query are as follow:</p>\n\n<pre><code>SELECT `tr`.`message`, \n       `tr`.`user_id`, \n       `tr`.`topic_id`,  \n       `u`.`name` \nFROM `talk_reply` AS `tr`\nINNER JOIN `users` AS `u` ON tr.user_id = u.user_id WHERE (tr.topic_id=1)\n</code></pre>\n\n<p>But I only get 1 result instead of 2, what am I missing here? Thanks.</p>\n"},{"tags":["query","selection","blank","alternate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":17,"score":-1,"question_id":13116518,"title":"I need a select query with alternate blank rows","body":"<p>I have a table named <code>tblemployee</code>.</p>\n\n<p>i want to be my selection to be like this</p>\n\n<pre><code>id     lastname      firsname     middlename\n1      Johnson       mark         rupert\n2      null          null         null\n3      Morris        Phillip      Stevens\n4      null          null         null\n5      Joe           John         Hefburn\n6      null          null         null\n</code></pre>\n"},{"tags":["query","programming-languages","sparql","dbpedia"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13094536,"title":"How do I consistently query dbpedia for programming languages by name?","body":"<p>There seems to be no consistent way to query for programming languages based on name. Examples:</p>\n\n<pre><code>http://dbpedia.org/page/D_(programming_language)\nrdfs:label \"D (programming language)\"@en\ndbpprop:name \"D programming language\"\nowl:sameAs freebase:\"D (programming language)\"\nfoaf:name \"D programming language\"\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>http://dbpedia.org/page/C++\nrdfs:label \"C++\"@en\ndbpprop:name \"C++\"\nowl:samwAs freebase:\"C++\"\nfoaf:name \"C++\"\n</code></pre>\n\n<p>Since there's no standard convention for whether \"programming language\", \"(programming language)\", \"programming_language\", \"(programming_language\", or \"\" is part of a name for a programming language in dbpedia, I have no idea how to consistently search by name.</p>\n\n<p>I'd like to create some sort of SPARQL query that returns <a href=\"http://dbpedia.org/page/D_(programming_language\" rel=\"nofollow\">http://dbpedia.org/page/D_(programming_language</a>) for \"D\" and <a href=\"http://dbpedia.org/page/C++\" rel=\"nofollow\">http://dbpedia.org/page/C++</a> for \"C++\", but I don't know how do to this.</p>\n\n<p>Unless at least one of the various triples for programming languages uses a consistent naming convention, I'll have to hack it by querying first against name + \" (programming_language)\", and falling back to name + \"(programming language\", name + \" programming language\" when no results are found. But I'd like a much more robust method.</p>\n"},{"tags":["php","sql","query","codeigniter","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12410322,"title":"Codeigniter db select","body":"<p>I want to select products from my table where is Akcie 1 and Stav also 1. But it it search query so I have there more like. It is not working why? Here is query</p>\n\n<pre><code>$q = $this-&gt;db-&gt;where('Akcia', 1)\n          -&gt;like('Titul', $vyraz)\n      -&gt;or_like('PodTitul', $vyraz)\n      -&gt;or_like('Autor1', $vyraz)\n      -&gt;or_like('Autor2', $vyraz)\n      -&gt;or_like('Autor3', $vyraz)\n      -&gt;or_like('Autor4', $vyraz)\n      -&gt;or_like('Prekladatel', $vyraz)\n      -&gt;or_like('Rozmer', $vyraz)\n      -&gt;or_like('Vydavatelstvo', $vyraz)\n      -&gt;or_like('ISBN', $vyraz)\n      -&gt;or_like('EAN', $vyraz)\n      -&gt;or_like('Popis', $vyraz)\n      -&gt;or_like('KratkyPopis', $vyraz)\n      -&gt;or_like('RokVydania', $vyraz)\n      -&gt;where('stav', 1)\n      -&gt;order_by('id', 'desc')\n      -&gt;limit($limit)\n      -&gt;offset($offset)\n     -&gt;get('knihy');\n\n         return $q-&gt;result();\n</code></pre>\n\n<p>This query is selcting also pruduts where Akcia is 0 why?</p>\n"},{"tags":["c#","linq","query","table","reference"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13114418,"title":"Including a junction table in a LINQ Query?","body":"<p>I'm having difficulty writing a LINQ query. Here is my scenario:</p>\n\n<p>Three database tables:<br />\n<strong>InterviewRequests</strong><br/>\n<strong>Contacts</strong><br />\n<strong>InterviewRequestContacts</strong> (a junction table containing <strong>ID</strong>, <strong>InterviewRequestID</strong>, <strong>ContactID</strong>)</p>\n\n<p>My goal is to have a table of <strong>InterviewRequests</strong>, and to display the <strong>Contact</strong> for each InterviewRequest. So I will need to fetch all InterviewRequests, and for each InterviewRequest the associated Contact using the <strong>InterviewRequestContacts</strong> junction table.</p>\n\n<p>How can I do this using LINQ? I've tried various methods but couldn't get it to work.</p>\n\n<p>EDIT: I'm using EntityFramework 5.0 and generated an .edmx ADO.NET Entity Data Model.</p>\n"},{"tags":["mysql","database","query","data","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13035610,"title":"Mysql query to copy new data from one DB to another","body":"<p>I have a situation. While we upgraded our server drives, we took a backup of our DB and then imported it again and then site was live, its after a weeks we realize that import did not copy entire backup from dump file as when we checked it was only 13 GB which it suppose to be 60 GB. The interesting thing is, there is one big table which we figured out is copied in a funny way, it is huge and its just copied few initial records, say like 2000-5000 and it copied last records say 400000-500000 and there is no records in between. isnt that weird? cause while we imported we checked initial and last entries and thought it copied everything. Then We created a new DB and imported a dump again and now it seems to be ok, but we have the new entry already in our live DB(13GB data), so we have to copy those and add to our newl imported DB. What will be the idle way to copy those new records in to recovered DB? I mean some query which will search the new DB and add only new records found. SO do I have to take dump of our 13 GB and then import? or is there anyways to copy from live DB?</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13114244,"title":"The idea for a nice MYSQL print data","body":"<p>e.g.</p>\n\n<pre><code>id - Name - Surname - Phone - Married\n1 - Ann - AnnS - 123 - No\n2 - Mary - MarryS - [empty] - Yes\n3 - Jane - JaneS - 321 - [empty]\n</code></pre>\n\n<p>Now I want to take a record by <strong>id</strong> and print the info smth like this (<strong>CHANGE THE ROW NAME TO SMTH ELSE and IF THE ROW IS EMPTY - NOT TO SHOW THE ROW AT ALL</strong>):</p>\n\n<pre><code>SELECT * FROM `girls` WHERE `id`='1'\n\nThe girls name - Ann \nThe girls surname - AnnS\nThe girls number - 123\nIs the girl married? - No\n</code></pre>\n\n<p>/-/</p>\n\n<pre><code>SELECT * FROM `girls` WHERE `id`='2'\n\nThe girls name - Ann\nThe girls surname - AnnS\nIs the girl married? - No\n</code></pre>\n\n<p><em>How is it easier to do without overloading the server (there are about 130 rows in a table) ?</em></p>\n"},{"tags":["php","mysql","query","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":59,"score":-3,"question_id":13085181,"title":"mysql search query and display all similar users","body":"<p>I have small question on mysql search query i need to make a search query php scripting with displaying all similar name , eg: if 100 similar names are found in the results the 100 results must show.</p>\n\n<p>Here is my script of search query system.</p>\n\n<pre><code>$result = mysql_Query(\"SELECT user FROM `UserData` WHERE user LIKE '%$username%'\") or die(mysql_error());\n        $fetch = mysql_num_rows($result);           \n\n        if( $fetch &gt; 0 )\n        {                   \n            $resultgg = mysql_Query(\"SELECT user FROM `theusers` WHERE user LIKE '%$username%' ORDER BY `user` ASC LIMIT 500\") or die(mysql_error());\n            $row = mysql_fetch_row($resultgg);\n            $users = $row[0];               \n            echo \"$users\";                  \n        }\n               }\n    else \n    {\n            echo \"&lt;br&gt;&lt;b&gt;Please Enter Valid Username!&lt;/b&gt;\";\n    }\n</code></pre>\n\n<p>Please Help me.</p>\n"},{"tags":["php","mysql","database","query","mysqli"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13112078,"title":"Display image if field is true","body":"<p>I have a table called user_badges and a field called badge1 with the default value written <strong>\"locked\"</strong> when a user unlocks the badge the field is updated to <strong>\"unlocked\"</strong></p>\n\n<p>What I want is the script to check the value in the field badge 1 in the table  <strong>WHERE $username = $_SESSION['username'];</strong> and display the image of the badge located in a folder on my site.</p>\n\n<p>I have an idea on how to go about it but not sure how to fully execute this. </p>\n\n<pre><code>//Connect to database\n&lt;?php\n$connect = mysql_connect(\"host\",\"username\",\"password\");\nmysql_select_db(\"database_name\");\n?&gt;\n\nif field (field_name) from table (table_name) value= unlocked\necho/display image from (images/badges/fanaticbadge.png)\n\nelse echo/display (images/badges/locked.png) \n</code></pre>\n\n<p>Is this possible? Thanks for any assistance !</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":63,"score":-1,"question_id":13112759,"title":"How to select a record that is between two dateranges and two input parameters StartDate and EndDate in SQL server?","body":"<p>In my database I have a group which can be active in a week with opening hours.<br>\nGroup A Startdate: 22-10-2012 EndDate: 28-10-2012 (Startdate is always beginning of the week)<br>\nGroup A Startdate: 29-10-2012 EndDate: 04-11-2012 (Always end of the week)</p>\n\n<p>Group A has two different opening hours in this two weeks. </p>\n\n<p>Now I have a stored procedure that returns the active group by looking the input parameters StartDate and EndDate. If this two parameters are between the startdate and end date of ONE week then I'm getting the right opening hours.</p>\n\n<p>But when the input parameters are about TWO weeks (Begindate: 22-10-2012 and EndDate: 30-10-2012) then I get the opening hours of two weeks.  </p>\n\n<pre><code>declare @Begindate datetime    \nset @Begindate = '2012-10-22'\n\ndeclare @Enddate datetime   \nset @Enddate = '2012-11-02'\n\n\nSELECT Id, Date, ..., ...   \nFROM Table1 t1  \nINNER JOIN Combinations c ON t1.Id=c.Table1Id\nINNER JOIN Group g ON c.GroupId=g.Id  \nWHERE t1.Date&lt;= @Enddate) AND (t1.Date&gt;= @Begindate  (gets dates I need)   \nAND g.BeginDate &lt;=@Enddate and g.Enddate &gt;= @Begindate (Gets active groups)\n\n\nSome table data:\n\nTable1:\n\nId    Date         GroupId\n1     2012-10-23   10\n1     2012-10-29   10\n\n\n\nCombinations: (holds the relation between Table1 and Group)\n\nID  Table1Id    GroupId\n1   10          1\n\n\nGroup Table:\n\nID    Name     StartDate   EndDate     MondayOpen   MondayClose ...\n1     Group A  2012-10-22  2012-10-28  08:00        18:00\n1     Group A  2012-10-29  2012-11-04  13:00        18:00\n</code></pre>\n\n<p>With this query I am getting a group two times because both the inputparametes are over two weeks. </p>\n\n<p>How can I get for the dates (from t1) the correct opening dates looking the group Begin and End date?</p>\n"},{"tags":["sql","query","ms-access","ms-access-2007","ms-access-2003"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":241,"score":3,"question_id":8049538,"title":"How does Access's query editor decide whether to discard my formatting?","body":"<p>Like a lot of developers who are comfortable with SQL syntax I get frustrated when working with Access's query editor. I'm talking about the raw <strong>SQL Syntax</strong> view, obviously.</p>\n\n<p>One of its many annoying properties is that upon saving it will discard my layout / formatting. When reopening the query all I see is a bunch of unformatted  SQL.</p>\n\n<p>However, if my syntax is long and/or complex enough I've noticed that Access <em>will</em> retain my formatting and layout and, oh joy, the query remains clear and readable. I'm looking at an example right now with a page of SQL containing couple of <code>UNIONs</code> all nicely laid out from a few days ago.</p>\n\n<p>At what point does Access flip over to allowing the user to retain his own formatting? Is it length? Complexity? And is there maybe even a trivial structural edit (if <em>trivial structural</em> isn't an oxymoron) I can make to all my queries which will force Access to leave my layout in place?</p>\n"},{"tags":["sql","oracle","query","top-n"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":13111390,"title":"how to get first female of each tool, oracle database","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2306744/oracle-sql-how-to-retrieve-highest-5-values-of-a-column\">Oracle SQL - How to Retrieve highest 5 values of a column</a>  </p>\n</blockquote>\n\n\n\n<p>I'm writing oracle query but stuck in the following problem</p>\n\n<p>table is like this:</p>\n\n<pre><code>**Tool**       **Name**       **Gender**\nFacebook   Alice        F\nFacebook   Alex         M\nFacebook   Loong        M\nFacebook   Jimmy        M\nTwitter    James        M\nTwitter    Jessica      F\nTwitter    Sam          M\nTwitter    Kathrine     F\nGoogle     Rosa         F\nGoogle     Lily         F\nGoogle     Bob          M\n</code></pre>\n\n<p>What I wanna get is the first female in each tool\nthe result should be like:</p>\n\n<pre><code>Facebook   Alice\nTwitter    Jessica\nGoogle     Rosa\n</code></pre>\n\n<p>I'm trying to get this by using query not functions or procedures\nThank for helping</p>\n"},{"tags":["php","mysql","string","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13106195,"title":"How can I find word matches from a string in a simple mysql/php words in string wordsolver app?","body":"<p>I have 27 tables in my database.  One word table (a scrabble word list), and 26 association tables.</p>\n\n<pre><code>Table  Fields\n================\nword   [id,word]\na      [word_id]\nb      [word_id]\n...\nz      [word_id]\n</code></pre>\n\n<p>I'm trying to figure out matching words given a string.</p>\n\n<p>For example, if the given string is <code>pant</code>, I want to know: <code>pant, apt, pat, tap, ant, tan, nap, pan, at, ta, pa, an, na</code>.</p>\n\n<p>My current strategy is to explode each letter in the string and find the associated words that match all the letters.</p>\n\n<p>For example:</p>\n\n<pre><code>SELECT word.word\nFROM word, p, a, n, t\nWHERE\n    word.id = p.word_id OR\n    word.id = a.word_id OR\n    word.id = n.word_id OR\n    word.id = t.word_id\n</code></pre>\n\n<p>But this ends up printing all words that have a p,a,n or t in them.</p>\n\n<p>And if I switch all the operators to <code>AND</code>, I'm stuck with only one match: <code>pant</code>.</p>\n\n<p>Can you help me solve this riddle?</p>\n\n<p>I'm also concerned with how to handle duplicate letters in the string.  For example, <code>PPANT</code> should find a match for <code>app</code>, when plain <code>PANT</code> should not.</p>\n\n<p>Am I on the right track with the association tables or is there a better way?</p>\n\n<p>I'm trying to handle this fairly efficiently in php/mysql.  I'm aware there are others who have solved this riddle before in C, perl, java and the like.</p>\n"},{"tags":["mysql","database","query","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13109104,"title":"MySQL Database - storing data in one table or using lookups","body":"<p>I'm in the middle of redesigning an app that has 100,000s of records in a particular table (currently 250K and growing). </p>\n\n<p>The table contains information of websites and domains.</p>\n\n<p>For the sake of speed and resources, should I include all the data needed about either entity in the original table, or should I be using two lookup tables to store information not shared - for example one lookup table which stores all domain specific info and one which stores all site specific info?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13111978,"title":"rendering Ruby statements inside of rails views?","body":"<p>So in my DB I want stored a ruby/HTML statement in the Database Table such as - \np This site is owned from 2000 - #{Time.now.year} by Acme Widget Co. /p </p>\n\n<p>Or let's say that I want people to be able to include in other code snippits - e.g. \nA client wants to run in a show view in the middle of a paragraph some magical partial such as  #{render 'my_magical_code'} </p>\n\n<p>On the view I have this being rendered as &lt;%= raw(@page.content) %>  </p>\n\n<p>But its like a double rendering and rails will just put on the page #{render 'my_magical_code'} or #{Time.now.year} </p>\n\n<p>So can / how do I solve this? </p>\n\n<p>Thanks! </p>\n"},{"tags":["sql","query","design","nested","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13095711,"title":"Query design for nested statements and CTEs","body":"<p>I have a query that sequentially joins 6 tables from their original data sources. Nested, it's a mess:</p>\n\n<pre><code>SELECT\nFROM\n(\n    SELECT\n    FROM\n    (\n        SELECT\n        FROM\n        (. . .)\n        INNER JOIN\n    )\n    INNER JOIN\n)\n</code></pre>\n\n<p>I switched to CTE definitions, and each definition is one join on a previous definition, with the final query at the end providing the result: </p>\n\n<pre><code>WITH\nTable1 (field1, field2) AS\n(\n    SELECT\n    FROM \n    INNER JOIN\n),\n\nTable2 (field2, field3) AS\n(\n    SELECT\n    FROM Table1\n    INNER JOIN\n), . . . \n\nSELECT \nFROM Table 6\n</code></pre>\n\n<p>This is a lot more readable, and dependencies flow downward in logical order. However, this doesn't seem like the intended use of CTEs (and also why I'm not using Views), since each definition is really only referenced once in order.</p>\n\n<p>Is there any guidance out there on how to construct sequentially nested joins like this that is both readable and logical in structure? </p>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13102762,"title":"mongoDB \"multiple\" select","body":"<p>I am not exactly sure on how this can be called, but what I want to do is select two different values with a limit; for example select 5 documents with of type \"A\", and 5 of type \"B\"; something like:</p>\n\n<pre><code>db.students.find({class: 'A'}).limit(10);\ndb.students.find({class: 'B'}).limit(10);\n</code></pre>\n\n<p>can this be done with only ONE query?\nThanks in advance.</p>\n"},{"tags":["php","mysql","database","forms","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":56,"score":-2,"question_id":12748539,"title":"Handling data from form to mysql database giving server error","body":"<p>I'm having difficulties making work a PHP script. This code handles a form  that should  add a product to the database.</p>\n\n<p>I've tried searching around for possible problems in my code but I am totally lost. I tried rewriting my code but nothing that I do seem to work for some reason. I am definitely  missing something.\n I would really appreciate if anyone can steer me towards the right direction as I've been suck with this for a couple of days plz.</p>\n\n<p>The code is as follows   </p>\n\n<pre><code>     &lt;form action=\"\" method=\"post\"&gt;\n\n    &lt;table width=\"436\" border=\"0px\"&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td width=\"132\"&gt;&lt;label for=\"title\"&gt;title&lt;/label&gt;&lt;/td&gt;\n            &lt;td width=\"333\"&gt;&lt;input type=\"text\" size=\"40px\" name=\"title\" value=\"\"  /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;tr class=\"odd\"&gt;\n        &lt;td&gt;&lt;label style=\" text-align:top\" for=\"icon_description\"&gt;short description&lt;/label&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;textarea name=\"icon_description\" rows=\"2\" cols=\"30\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"even\"&gt;\n      &lt;td height=\"95\"&gt;&lt;label for=\"full_description\"&gt;full description&lt;/label&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;textarea name=\"full_description\" cols=\"30\" rows=\"6\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n\n\n      &lt;tr class=\"odd\"&gt;\n        &lt;td&gt;&lt;label for=\"category\"&gt;category&lt;/label&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;select name=\"category\" &gt;\n            &lt;?php\n            foreach(get_categories() as $category)\n            {\n                ?&gt;\n                &lt;option value=\"&lt;?php echo $category['id']; ?&gt;\"&gt; &lt;?php echo $category['category_name']; ?&gt; &lt;/option&gt;\n                &lt;?php\n            }\n            ?&gt;\n\n        &lt;/select&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td&gt;&lt;label for=\"price\"&gt;price (&lt;em&gt;BsF&lt;/em&gt;)&lt;/label&gt;&lt;/td&gt;&lt;td&gt;&lt;textarea name=\"price\" rows=\"1\" cols=\"20\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"odd\"&gt;\n            &lt;td&gt;&lt;label for=\"stock\"&gt;stock&lt;/label&gt;&lt;/td&gt;&lt;td&gt;&lt;textarea name=\"stock\" rows=\"1\" cols=\"20\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td&gt;&lt;/td&gt;\n            &lt;td style=\"margin-top:30px\"&gt;&lt;p style=\"text-align:left; margin-left:20px;\"&gt;&lt;input type=\"submit\" value=\"Add Product\" /&gt;&lt;/p&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n          &lt;/form&gt;\n        &lt;/div&gt;\n</code></pre>\n\n<p>On the same page, at the top of the document I have this code to handle the data from form and send it to the actual function that adds it to database:</p>\n\n<pre><code>&lt;?php\n\ninclude_once('init.php');\ninclude_once('store.php');\n\n$products = get_all_available_products();\n\n\nif( isset($_POST['title'], $_POST['icon_description'], $_POST['category'], $_POST['price'], $_POST['stock']) )\n{\n\n    $title = $_POST['title'];\n    $icon_description = $_POST['icon_description'];\n    $category = $_POST['category'];\n    $price = $_POST['price'];\n    $stock = $_POST['stock'];\n\n\n    $errors = array();\n\n    if( empty($title) )\n    {\n        $errors[] = 'You need to add a title.';\n    }\n    else if( strlen($title) &gt; 125 )\n    {\n        $errors[] = 'Title cannot be longer than 255 characters.';\n    }\n    if( empty($icon_description))\n    {\n        $errors[] = 'Short description is empty.';\n    }\n    if( empty($price))\n    {\n        $errors[] = 'You need to specify a price.';\n    }\n    if( empty($stock))\n    {\n        $errors[] = 'You need to ad stock amount.';\n    }\n\n\n    add_product($title, $category, $icon_description, $price, $stock);\n\n    header('Location: products.php');\n    die();\n}\n</code></pre>\n\n<p>And the code where the add_product() function is:</p>\n\n<pre><code>include_once('init.php');\n\nfunction add_product($title, $category_id, $description, $price, $stock)\n{\n    $title =  mysql_real_escape_string($title);\n    $category_id = (int)($category_id);\n    $description = mysql_real_escape_string($description);\n    $price = doubleval($price);\n    $stock = (int)$stock;\n\n    $mysql_query(\"INSERT INTO `products` SET\n                `product_name` = '{$title}',\n                `product_description` = '{$description}',\n                `category_id` = {$category_id},\n                `price` = {$price},\n                `stock` = {$stock}\");\n}\n</code></pre>\n\n<p>All my other code to display the products in databse is working, so connection and configuration is ok (i think). The problem is when I try to add a product, when I click the button to submit the website gives me a server error. </p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":94,"score":0,"question_id":13108767,"title":"Select data from multiple tables","body":"<p>How can i join multiple rows in just one single row through mysql?</p>\n\n<p>Example :</p>\n\n<p>Student Table</p>\n\n<pre><code>Sno.|  Name |  Subjects\n1.  | ABC   |  1\n2.  | ABC   |  3\n3.  | ABC   |  4\n4.  | FMC   |  2\n5.  | ABC   |  4\n6.  | JBC   |  4\n</code></pre>\n\n<p>Papers Table:</p>\n\n<pre><code>Sno. | Paper Name | Type \n 1.      French     Optional\n 2.      English    Mandatory\n 3.      Japenese   Optional\n 4.      Maths      Optional\n</code></pre>\n\n<p>Now I want it in this format</p>\n\n<pre><code>Sno.| Name|   Sub1  |  Sub2    | Sub3  |  Sub4 |\n1.  | ABC |  French |  Japenese| Maths | Null  |\n2.  | FMC |  Null   | Null     | Null  | Null  |\n3.  | JBC |  Maths  | Null     | Null  | Null  |\n</code></pre>\n\n<p>What i want to select is papers name from papers table and student name, four subjects from the other table. I only want to see those paper which are optional. I am not sure what to do?</p>\n"},{"tags":["query","data","sparql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13109251,"title":"SPARQL query universities","body":"<p>I am trying to fetch the names of universities using SPARQL:</p>\n\n<p>The rdf data is the following (and a whole lot more, but that is irrelevant).</p>\n\n<pre><code>&lt;Organization rdf:about=\"http://data.semanticweb.org/organization/the-university-of-queensland\"&gt;\n    &lt;rdfs:label&gt;The University of Queensland&lt;/rdfs:label&gt;\n    &lt;homepage rdf:resource=\"http://www.uq.edu.au/\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/jane-hunter\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/kwok-cheung\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/robert-m-colomb\"/&gt;\n    &lt;name&gt;The University of Queensland&lt;/name&gt;\n&lt;/Organization&gt;\n</code></pre>\n\n<p>I have written a java program which queries the data. \nMy string to query the data is the following:</p>\n\n<pre><code>            queryString += \"PREFIX swrc:        &lt;http://swrc.ontoware.org/ontology#&gt; \\n\";\n            queryString += \"PREFIX dc:          &lt;http://purl.org/dc/elements/1.1/&gt; \\n\";\n            queryString += \"PREFIX foaf:        &lt;http://xmlns.com/foaf/0.1/&gt; \\n\";\n            queryString += \"PREFIX geo:         &lt;http://www.w3.org/2003/01/geo/wgs84_pos#&gt; \\n\";\n            queryString += \"PREFIX ical:        &lt;http://www.w3.org/2002/12/cal/ical#&gt; \\n\";\n            queryString += \"PREFIX rdf:         &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; \\n\";\n            queryString += \"PREFIX rdfs:        &lt;http://www.w3.org/2000/01/rdf-schema#&gt; \\n\";\n            queryString += \"PREFIX swc:         &lt;http://data.semanticweb.org/ns/swc/ontology#&gt; \\n\";\n            queryString += \"PREFIX swrc_ext:    &lt;http://www.cs.vu.nl/~mcaklein/onto/swrc_ext/2005/05#&gt; \\n\";\n            queryString += \"SELECT ?name WHERE {\\n\";\n            queryString += \"?university rdfs:label ?aff . \\n ?university foaf:name ?name FILTER(str(?aff)='uni') }\";\n</code></pre>\n\n<p>Unfortunatelly, this is not correct, as no result is returned:</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt; \n  &lt;sparql xmlns='w3.org/2005/sparql-results#'&gt; \n    &lt;head&gt; \n     &lt;variable name='name'/&gt; \n    &lt;/head&gt; \n    &lt;results&gt; \n    &lt;/results&gt; \n  &lt;/sparql&gt;\n</code></pre>\n\n<p>Can anyone point me in the right direction?</p>\n\n<p>P.S. If possible I'd like to only fetch 10 university names.</p>\n"},{"tags":["mysql","query"],"answer_count":8,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4156,"score":1,"question_id":1138292,"title":"MySQL Query to calculate Previous Week","body":"<p>I would like to calculate my total order amount in the previous week.</p>\n\n<p>I got the query for getting the data for the last 7 days from the current date.</p>\n\n<pre><code>SELECT SUM(goods_total) AS Total_Amount  FROM orders\nWHERE order_placed_date &gt;= date_sub(current_date, INTERVAL 7 day);\n</code></pre>\n\n<p>Now how can I get Previous week data only, excluding this week.</p>\n\n<p>For e.g. This week I made $15,000 and last week i made $14,000.</p>\n\n<p>I get the $15,000 by running the above query.</p>\n\n<p>But i dont know how to calculate previous week. </p>\n"},{"tags":["sql","query","time","recording"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13108316,"title":"Employee Attendance query","body":"<p>I am writing a time recording program where people can log in to record events, like when they have started work when they have finished work. Each event such as start and finish has a status code other events like \"attending training course\" has a diferent code. Each event is timestamped.</p>\n\n<p>The table looks like this:</p>\n\n<pre><code>staff_recording.staff_name\nstaff_recording.event_time\nstaff_recording.event_code\nstaff_recording.event_note\n</code></pre>\n\n<p>I have already written one query to go through each staff name and fetch the most recent event so it can be displayed on a status board.</p>\n\n<p>I am now trying to query events for each staff member within a specified date like a week period to count the time worked. So I need to count all time between each start work event (event_code = 0) and finish work (event_code = 1) for each day, summ it up and display in hours, minutes etc.</p>\n\n<p>If anyone can help I think I need a nested query but cannot make progress!\nAndy.</p>\n"},{"tags":["database","linq","query","entity-framework","linq-to-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13108228,"title":"Loading the last related record instantly for multiple parent records using Entity framework","body":"<p>Does anyone know a good approach using Entity Framework for the problem described below?</p>\n\n<p>I am trying for our next release to come up with a performant way to show the placed orders for the logged on customer.\nOf course paging is always a good technique to use when a lot of data is available I would like to see an answer without any paging techniques.</p>\n\n<p>Here's the story: a customer places an order which gets an orderstatus = PENDING. Depending on some strategy we move that order up the chain in order to get it APPROVED.\nEvery change of status is logged so we can see a trace for statusses and maybe even an extra line of comment per status which can provide some extra valuable information to whoever sees this order in an interface.</p>\n\n<p>So an Order is linked to a Customer. One order can have multiple orderstatusses stored in OrderStatusHistory.</p>\n\n<p>In my testscenario I am using a customer which has 100+ Orders each with about 5 records in the OrderStatusHistory-table.\nI would for now like to see all orders in one page not using paging where for each Order I show the last relevant Status and the extra comment (if there is any for this last status; both fields coming from OrderStatusHistory; the record with the highest Id for the given OrderId).</p>\n\n<p>There are multiple scenarios I have tried, but I would like to see any potential other solutions or comments on the things I have already tried.</p>\n\n<ul>\n<li>Trying to do Include() when getting Orders but this still results in multiple queries launched on the database. Each order triggers an extra query to the database to get all orderstatusses in the history table. So all statusses are queried here instead of just returning the last relevant one, plus 100 extra queries are launched for 100 orders. You can imagine the problem when there are 100000+ orders in the database.</li>\n<li>Having 2 computed columns on the database: LastStatus, LastStatusInformation and a regular Linq-Query which gets those columns which are available through the Entity-model.\nThe problem with this approach is the fact that those computed columns are determined using a scalar function which can not be changed without removing the formula from the computed column, etc...</li>\n</ul>\n\n<p>In the end I am very familiar with SQL and Stored procedures, but since the rest of the data-layer uses Entity Framework I would like to stick to it as long as possible, even though I have my doubts about performance.\nUsing the SQL approach I would write something like this:</p>\n\n<pre><code>WITH cte (RN, OrderId, [Status], Information)\nAS\n(\nSELECT ROW_NUMBER() OVER (PARTITION BY OrderId ORDER BY Id DESC), OrderId,    [Status], Information\nFROM OrderStatus\n)\nSELECT o.Id, cte.[Status], cte.Information AS StatusInformation, o.* FROM [Order] o\nINNER JOIN cte ON o.Id = cte.OrderId AND cte.RN = 1\nWHERE CustomerId = @CustomerId\nORDER BY 1 DESC;\n</code></pre>\n\n<p>which returns all orders for the customer with the statusinformation provided by the Common Table Expression.</p>\n\n<p>Does anyone know a good approach using Entity Framework?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":156,"score":1,"question_id":10187088,"title":"MySQL - Getting the top-level parent id in a hierarchy","body":"<p>Here's my table structure...</p>\n\n<p>TABLE : <strong>position_hierarchy_level</strong></p>\n\n<pre><code>id parent_position_id position_id\n 1 1                  2\n 2 2                  3\n 3 3                  4\n 4 4                  5\n 5 5                  6\n 6 6                  7\n 7 7                  8\n 8 8                  9\n 9 9                  10\n 10 10                11\n 11 11                12\n 12 12                13\n 13 13                14\n 14 14                15\n</code></pre>\n\n<p>My query for getting the <code>parent_position_id</code> of a certain <code>position_id</code> is:</p>\n\n<pre><code>select `parent_position_id` from `position_hierarchy_level` where position_id= 15;\n</code></pre>\n\n<p>But how can I get the top-most parent of a certain <code>position_id</code>? For example, the top-most <code>parent_position_id</code> of <code>position_id</code> 15 would be <code>1</code>.</p>\n\n<p>Is there a convenient way to get this value using a single query? Or do I need to create a loop in PHP?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13099319,"title":"Select row dependent on other rows in the table","body":"<p>Apologies if this has been asked before but I really didn't know what to search and thus not sure how to word the question title so fingers crossed. </p>\n\n<p>I'm building quite a common system where one product can have multiple categories and on the front-end, the user can search for products specifying multiple categories.</p>\n\n<p>Say we had the following schema and data ( I cant post images yet, apologies, please see link )- </p>\n\n<p><strong>table name: product_categories</strong></p>\n\n<p>Data: </p>\n\n<p><img src=\"http://i.stack.imgur.com/s7MaS.jpg\" alt=\"enter image description here\"> </p>\n\n<p><em>The products table is very standard - id, name, amount etc.</em></p>\n\n<p>So product 1 has 2 categories.</p>\n\n<p>If the user checks 2 tickboxes on the search page which represent category 2 and 3, how would I query that so only products which have both of those categories come back?</p>\n\n<p>Something such as follows doesn't work, as there is no one row in that which has a category id of 2 AND a category id of 3:</p>\n\n<pre><code>SELECT * from product_categories where `category_id` = 2 AND `category_id` = 3;\n</code></pre>\n\n<p>I've tried using WHERE IN aswell, however, this would return product 1 even if i was looking for products which had both category id 2 and 6 ( for example ) which I don't want.</p>\n\n<p>This is part of a bigger query however, I will be able to apply the solution if I manage to find one.</p>\n"},{"tags":["php","mysql","query","pagination"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13106918,"title":"Suggestions with pagination","body":"<p>I've a problem with pagination. The php code of pagination query is:</p>\n\n<pre><code>$ &lt;? if (isset($_GET[\"page\"])) { \n\n    $Page = preg_replace(\"/[^0-9]/\",\"\", $_GET[\"page\"]);\n} else {\n    $Page = 0;\n}\n$limit       = 10;\n$StartFrom  = $limit * $Page;\n$TotalFiles = mysql_num_rows(mysql_query(\"SELECT * FROM linkuri WHERE `categorie` = 'Afaceri' AND status = 1\"));\n$TotalPages = floor($TotalFiles / $limit); ?&gt;\n</code></pre>\n\n<p>And code to display it:</p>\n\n<pre><code>$i = 0; while ($TotalPages &gt;= $i) { echo '&lt;a class=\"active imgf\" style=\"opacity: 1;margin-bottom:3px; margin-top:3px;\" href=\"afaceri.php?page='.$i.'\"&gt;'.($i+1).'&lt;/a&gt;';$i++;}\n</code></pre>\n\n<p>The problem is I am trying to make the display as: <code>PAGES: \"BACK\" 1 2 3 4 5 \"NEXT\"</code></p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":224,"score":2,"question_id":3481752,"title":"MySQL relational view - join?","body":"<p>I'm relatively new to MySQL and I'm having no end of difficulty trying to work out how to do this. I've researched joining and such but I'm not really sure how to apply this.</p>\n\n<p>I have three tables:</p>\n\n<p><strong>Artists Table</strong>\nID,\nName,\nDescription</p>\n\n<p><strong>Albums Table</strong>\nID,\nTitle,\nYear,\nArtist_ID</p>\n\n<p><strong>Tracks Table</strong>\nID,\nTitle,\nAlbum_ID</p>\n\n<p>Tracks are assigned to albums and albums are assigned to artists. (I did this through the relation view in phpmyadmin, engine is InnoDB).</p>\n\n<p>What I'm trying to do is query ALL of the tracks for a particular artist (from their ID).</p>\n\n<p>Is anyone able to point me in the right direction? Thanks in advance!</p>\n"},{"tags":["c++","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13106706,"title":"Which scenario is more efficient?","body":"<p>ALL,\nI have a DB with some data.\nI also have a C++ application that communicates with the DB.</p>\n\n<p>Which scenario is more efficient?</p>\n\n<p>Scenario 1:</p>\n\n<ol>\n<li>User hit \"Edit Data\" button.</li>\n<li>Program reads data from DB and presents it for editing</li>\n<li>User edit the data and hit \"Save\" button</li>\n<li>Program creates new object with the newly saved data then makes the comparison with the old object.</li>\n<li>Program issues some UPDATE statements.</li>\n</ol>\n\n<p>Scenario 2:</p>\n\n<ol>\n<li>Steps 1-3 are the same.</li>\n<li>Program overwrites an old object data with the new data.</li>\n<li>Program issue DELETE/INSERT statements in one transaction.</li>\n</ol>\n\n<p>I'm inclined to say scenario 2.</p>\n"},{"tags":["query","symfony2","request"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13105236,"title":"Symfony2 Request extra query parameter missing","body":"<p>I need to use my route <code>site_edit</code> with an extra query parameter 'company'=1. The route is as follows:</p>\n\n<pre><code>@Route(\"/_sys/site/edit/{id}\", name=\"site_edit\", defaults={\"id\"=null})\n</code></pre>\n\n<p>Symfony2 generates the link <code>/_sys/site/edit?comp=1</code> which looks fine for me. It hits the action alright but Request#query is empty though $_GET is array('comp'=>'1').\nIf I adjust the query string to be <code>/_sys/site/edit/?comp=1</code> then no matching route is found. If I insert some value for {id} e.g. <code>/_sys/site/edit/new?comp=1</code> then all is fine ($id=\"new\" and Request#query is array('comp'=>'1') but this case is not tolerable by application logic I must not change.</p>\n\n<p>I need a route with very similar structure where exactly one of the parameters comp and id is present. So the urls need to be generated as [twig] <code>url('site_edit', {'id':positiveInteger})</code> or <code>url('site_edit', {'comp':positiveInteger})</code>.</p>\n\n<p>Is this a bug? IMHO in <code>/_sys/site/edit?comp=1</code> the part before ? should launch the action with {id}=null (ok) and the part after ? should ensure that Request#query-get('comp') yields '1' (fail).</p>\n"},{"tags":["sql","mysql","query","datetime","group-by"],"answer_count":4,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":6698,"score":5,"question_id":2793994,"title":"Group mysql query by 15 min intervals","body":"<p>I've got a monitoring system that is collecting data every n seconds (n ~=10 but varies).  I'd like to aggregate the collected data by 15 minute intervals.  Is there a way to corral the timestamp column into 15 minute chunks to allow for grouping to work?</p>\n"},{"tags":["sql","oracle","query","helper"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2406,"score":4,"question_id":1841183,"title":"Decent Visual SQL query Builder","body":"<p>I am a code developer, not a DBA, and I tend to get lost with loooong SQL queries, when I use many joins (10 joins is pretty common for me). </p>\n\n<p>I would like to find a Visual SQL Query Builder (free if possible) that could connect to Oracle and see all the tables there, so I would only select visually my keys that link the Joins, and select the fields I want to be shown.</p>\n"},{"tags":["string","query",".htaccess","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13103717,"title":"Redirecting in HTACCESS from Query String to URL","body":"<p>I am trying to redirect a URL with a query string to a URL without a query string, however, I would like to use values from the query string.</p>\n\n<p>In my example below I am using a single state however I want it to be dynamic, meaning it will parse any URL with a query string down to a clean URL which still contains the value from the query string.</p>\n\n<pre><code>Example: http://www.mywebsite.com/?state=CA redirects to http://www.mywebsite.com/CA/\n</code></pre>\n\n<p>I have tired to add the information below into my HTACCESS file with no luck:</p>\n\n<pre><code>Options +FollowSymlinks\nRewriteEngine On\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\\ /\\?state=([a-z]+)&amp;type=([a-z\\-]+)\nRewriteRule ^ /%1/%2? [L]\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\\ /\\?state=([a-z]+)($|\\ )\nRewriteRule ^ /%1? [L]\n</code></pre>\n\n<p>These have worked however I must input every redirect which I would like to avoid:<br/></p>\n\n<pre><code>RewriteCond %{QUERY_STRING} state=FL\nRewriteRule ^$ \"http://www.mywebsite.com/fl/?\" [R=301,L]\nRewriteCond %{QUERY_STRING} state=RI\nRewriteRule ^$ \"http://www.mywebsite.com/ri/?\" [R=301,L]\n</code></pre>\n\n<p>Any ideas? I am using WordPress on Apache. I believe everything is up to date.</p>\n"},{"tags":["mysql","query","select","like"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13104113,"title":"NOT LIKE MySQL statement","body":"<p>I have an issue with NOT LIKE statement. I have two sql tables setup as tag map. First table finds tag_id according to the search name and second finds resource_id based on tag_id found. When I run a NOT LIKE statement below, I receive the result: resource_id = 1.</p>\n\n<h3>Tag map tables</h3>\n\n<pre><code>tag_id name\n1      meat\n2      vegetarian\n\nresource_id tag_id\n1           1\n1           2\n</code></pre>\n\n<h3>Query</h3>\n\n<pre><code>SELECT \n    f.id, f.food_name, tm.resource_id, tm.tag_id, t.name \nFROM \n    tag as t, tagmap as tm JOIN item as f ON \n    (\n        f.id = tm.resource_id AND tm.tag_id IN \n        (\n        SELECT \n            t.tag_id \n        FROM \n            tag as t \n        WHERE \n            t.name NOT LIKE '%meat%' \n        ) \n     )\nGROUP by f.id\n</code></pre>\n\n<p>All I need this query to do is, if it finds a resource_id with tag name \"meat\" I don't want it to return this resource_id.</p>\n\n<p>If my explanation is not clear please let me know.</p>\n"},{"tags":["sql","regex","query","database-design"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13104790,"title":"Monitoring Updates over Time Frames and/or SQL Query with Regex counting dates within string","body":"<p>This is probably a fork in the road question.  I have a journal blog that date stamps a continuation of a single field within a record.</p>\n\n<p>Example:  </p>\n\n<p>Proj #1 (ID): Notes (memo field:) 10/12/2012 - visited site. 10/11/2012 - updated information. 10/11/2012 - call client. 10/10/2012 - Input information.</p>\n\n<p>Proj #2 (ID): Notes (memo field:) 10/10/12 - visited site. 10/10/2012 - call client. 10/9/2012 - Input information. 10/1/2012 - Started project. etc etc...</p>\n\n<p>I need to count how many updates where made over a specific time frame.  I know I can create a hidden field and add + 1 everytime there is an update which is useful for an OVERALL update count... but how can i keep track of number of updates over the last 5 days.  Like the example above you may update it twice in one day and I may not care about updates made 2 weeks ago.</p>\n\n<p>I think I need to create an SQL that counts the number of \"dates\" since 10/10/12 or since 10/2/12 etc.</p>\n\n<p>I have done the SQL: SELECT memo FROM Projects WHERE memo IN ('%10/10/12%', '%10/9/2012%' etc)\nand then the Len(memoStringCombined) - Len(Replace(searchword\"\"etc)/Len(searchword) and it works fine for countings a single date...  but if I have count multiple dates over 30 days it gets to be quite cumbersome to keep rewriting each search word.  Is there a regex or obj that can loop through this for me?</p>\n\n<p>Otherwise any other suggestions for counting updates between time frames would be greatly appreciated.</p>\n\n<p>BTW - I can't really justify creating a new table dedicated to tracking updates because there will be 100's of updates for close to 10,000 records which means the update tracking table will be more monstrous than the data... or am I wrong with that idea too?</p>\n"},{"tags":["actionscript-3","flash","query","sqlite","mdm-zinc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":8277381,"title":"MDM Zinc SQLite Query by arabic text Issue","body":"<p>I am connecting to an SQLite data base via MDM and as3 and run this query: </p>\n\n<pre><code>SELECT * FROM Branch WHERE name LIKE '%مرحبا%'\n</code></pre>\n\n<p>But, after after I run it my program closes. Can mdm execute query via Arabic text?</p>\n"},{"tags":["query","query-string"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3629,"score":1,"question_id":2939130,"title":"Passing Multiple values Through Query String?","body":"<p>I tried to pass more than one value through Query String from page1.aspx to page2.aspx.</p>\n\n<p>This is my Query string in the Grid View</p>\n\n<pre><code>&lt;a href=\"javascript:void(0);\" onclick='javascript:window.open(\"Update.aspx?Regno= &lt;%#Eval (\"ID\") %&gt;'+ \",\"'&amp;Fn=&lt;%#Eval (\"FIRSTNAME\") %&gt;' +\", \"'&amp;Ln=&lt;%#Eval (\"LASTNAME\") %&gt;'\")';&gt;\n                    Edit&lt;/a&gt;\n</code></pre>\n\n<p>On My Page2.aspx, my code behind on PageLoad is:</p>\n\n<pre><code>if (Page.IsPostBack) return;\n            string id = Request.QueryString[\"ID\"];\n            string Firstname = Request.QueryString[\"FIRSTNAME\"];\n            string LastName = Request.QueryString[\"LASTNAME\"];\n</code></pre>\n\n<p>My Visual Studio IDE shows a syntax error on this query string. I dont know the exact way to pass multiple values through Query String. How to make it work? Can anyone pls help me on this..</p>\n\n<p>Which is the right syntax to pass multiple query string?</p>\n"},{"tags":["database","query","function","google-spreadsheet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13088988,"title":"Alter data in google spreadsheet sheet via other sheet in the same spreadsheet","body":"<p><strong>Question:</strong></p>\n\n<p>Google Spreadsheet is great for viewing/filtering data, and great as DB of applications.<br/>\nBut is it possible to edit data on a sheet via another sheet?</p>\n\n<p><em><strong>Functional description:</em></strong></p>\n\n<p>We are a small group (5) non nerd that keep track of tasks we do. \nWe do this via a google spreadsheet, this works great :)\nWe recieve tasks via the phone and these get added to the sheet1.\nWhen someone pickups a task he/she addes his/her name to the appropriate column in sheet1 of the task (row).\nWe keep track of status updates etc, per task.</p>\n\n<p><em><strong>Reason for change:</em></strong></p>\n\n<p>Sheet1 of this spreadsheet is now to big to get a clear overview of the tasks of 1 person.\nSo I have 20 tasks in the big spreadsheet, but since ordering is not handy when new tasks are added, it would be nice to have a seperate sheet per person.\nThis can easily be done via the query() function.\nBut this is a one-way street. you can not alter this data and get it back in the main sheet.\nAnd using sheet1 as a report is also not handy, because how do you add new tasks?</p>\n\n<p><em><strong>Question rephrase:</em></strong></p>\n\n<ol>\n<li><p>So is it possible to alter data in the \"main\" sheet via an subset of\nthe data, available in an other sheet of the same spreadsheet?</p></li>\n<li><p>If not, is it possible to use a google spreadsheet as in interface\n(read/write/update) to an sqlite database in google app engine ?</p></li>\n</ol>\n"},{"tags":["sql","sql-server","sql-server-2008","query","query-optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13099463,"title":"Query Optimizing Request","body":"<p>I am very sorry if this question is structured in not a very helpful manner or the question itself is not a very good one!</p>\n\n<p>I need to <code>update</code> a <code>MSSQL</code> <code>table</code> call <code>component</code> every 10 minutes based on information from another <code>table</code> call <code>materials_progress</code></p>\n\n<p>I have nearly 60000 records in <code>component</code> and more than 10000 records in <code>materials_progress</code></p>\n\n<p>I wrote an <code>update query</code> to do the job, but it takes longer than 4 minutes to complete execution!\nHere is the <code>query</code> : </p>\n\n<pre><code>UPDATE component \nSET stage_id = \nCASE \n    WHEN t.required_quantity &lt;= t.total_received THEN 27\n    WHEN t.total_ordered &lt; t.total_received THEN 18\n    ELSE 18\nEND\nFROM\n    (\n    SELECT \n        mp.job_id,  \n        mp.line_no,  \n        mp.component,  \n        l.quantity AS line_quantity, \n        CASE WHEN mp.component_name_id = 2 THEN l.quantity*2\n            ELSE l.quantity\n        END AS required_quantity,\n        SUM(ordered) AS total_ordered, SUM(received) AS total_received ,\n        c.component_id \n    FROM line l \n    LEFT JOIN component c ON c.line_id = l.line_id\n    LEFT JOIN materials_progress mp ON l.job_id = mp.job_id AND l.line_no = mp.line_no AND c.component_name_id = mp.component_name_id \n    WHERE \n        mp.job_id IS NOT NULL  \n        AND (mp.cancelled IS NULL OR mp.cancelled = 0)\n        AND (mp.manual_override IS NULL OR mp.manual_override = 0)\n        AND c.stage_id = 18\n    GROUP BY  mp.job_id,  mp.line_no,  mp.component, l.quantity, mp.component_name_id, component_id\n    ) AS t\n\nWHERE \n    component.component_id = t.component_id\n</code></pre>\n\n<p>I am not going to explain the scenario as it too complex.. could somebody please please tell me what makes this query this much expensive and a way to get around it?</p>\n\n<p>Thank you very very much in advance!!!</p>\n\n<p>Edit 1:\nHere is the execution plan;\n<img src=\"http://i.stack.imgur.com/xNgxe.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql-server","query","sql-server-2008-r2","sql-function"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13103353,"title":"How to create a nullable record in SQL Server 2008 R2?","body":"<p>I create a <code>Inline table function</code> in SQL Server 2008 R2, and I realized some queries return any record. So I'd like when that happens, returns a record with all the empty columns.</p>\n\n<p>By example:</p>\n\n<pre><code>Col1   Col2   Col3\nNULL   NULL   NULL\n</code></pre>\n\n<p>UPDATE: Here is the function</p>\n\n<pre><code>ALTER FUNCTION [dbo].[GetWorksheetSummaryByObjective](@objectiveId [smallint], @testTemplateId [smallint])\nRETURNS @resultTable TABLE (\n    [AnsweredWorksheetId] [smallint] NOT NULL,\n    [LastDate] [date] NULL,\n    [BestScore] [smallint] NULL,\n    [ShouldBeMakeUp] [tinyint] NOT NULL\n)\nAS \nBEGIN\n\n    INSERT @resultTable\n    SELECT TOP 1 B.Id AS AnsweredWorksheetId, A.Date, CONVERT(smallint, B.Score * 100),\n        CASE\n        WHEN B.Score &gt;= 0.7 THEN 0\n        ELSE 1\n        END AS ShouldBeMakeUp\n    FROM AnsweredTest AS A\n    RIGHT JOIN AnsweredWorksheet AS B ON (A.Id = B.AnsweredTestId)\n    WHERE B.ObjectiveId = @objectiveId AND A.ExamTemplateId = @testTemplateId\n    ORDER BY B.Score DESC\n\n    RETURN\nEND\n</code></pre>\n"},{"tags":["query","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2643,"score":2,"question_id":5035365,"title":"How to specify multiple values in where with AR query interface in rails3","body":"<p>Per section 2.2 of rails guide on Active Record query interface <a href=\"http://guides.rubyonrails.org/active_record_querying.html#conditions\" rel=\"nofollow\">here</a>:</p>\n\n<p>which seems to indicate that I can pass a string specifying the condition(s), then an array of values that should be substituted at some point while the arel is being built. So I've got a statement that generates my conditions string, which can be a varying number of attributes chained together with either AND or OR between them, and I pass in an array as the second arg to the where method, and I get:</p>\n\n<blockquote>\n  <p>ActiveRecord::PreparedStatementInvalid: wrong number of bind variables (1 for 5)</p>\n</blockquote>\n\n<p>which leads me to believe I'm doing this incorrectly. However, I'm not finding anything on how to do it correctly. To restate the problem another way, I need to pass in a string to the where method such as \"table.attribute = ? AND table.attribute1 = ? OR table.attribute1 = ?\" with an unknown number of these conditions anded or ored together, and then pass something, what I thought would be an array as the second argument that would be used to substitute the values in the first argument conditions string. Is this the correct approach, or, I'm just missing some other huge concept somewhere and I'm coming at this all wrong? I'd think that somehow, this has to be possible, short of just generating a raw sql string.  </p>\n"},{"tags":["mysql","query","select","logical"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13103004,"title":"MySQL logical operation SELECT query","body":"<p>I have the following query and I seem to know what is causing the error however I lack experience to fix it myself.</p>\n\n<pre><code>SELECT \n    f.id, f.food_name, tm.resource_id, tm.tag_id, t.name\nFROM \n    tag as t, tagmap as tm\nJOIN \n    item as f \n    ON \n    (\n    f.id = tm.resource_id AND tm.tag_id = \n        (\n        SELECT \n            t.tag_id \n        FROM \n            tag as t \n        WHERE \n            t.name LIKE '%meat%' OR t.name LIKE '%vegan%'\n        ) \n    )\nGROUP by f.id\n</code></pre>\n\n<p>I believe the error is in line </p>\n\n<pre><code>f.id = tm.resource_id AND tm.tag_id = \n</code></pre>\n\n<p>It is looking for a single tag_id and receiving many thus the error: <em>Error executing the SQL statement</em></p>\n\n<p>What is the procedure to receive an array of tag_id 's? I know this statement works for a single ID because if I remove the second WHERE condition the query works.</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["mysql","query","subquery"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13101511,"title":"select * duplicates, then select * non-duplicates - mysql","body":"<p>The question is for the example table structure:</p>\n\n<p>mytable</p>\n\n<pre><code>fielda, fieldb\nval1    valx\nval2    valy\nval3    valz\nval1    vala\n</code></pre>\n\n<p>I want to select from mytable with a query:</p>\n\n<pre><code>fielda, fieldb\nval1    valx\nval1    vala\n</code></pre>\n\n<p>basically select * from table where fielda is duplicated.</p>\n\n<p>then with a different query select from mytable</p>\n\n<pre><code>fielda, fieldb\nval2    valy\nval3    valz\n</code></pre>\n\n<p>val1 on fielda was encountered as a duplicate therefore it wasn't selected and the rest were.</p>\n"},{"tags":["php","arrays","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13002829,"title":"How do I get a PHP query result into an array?","body":"<p>I know this is insanely easy, but I'm a noob and not sure what I'm doing wrong here:</p>\n\n<pre><code>1: $mysqli = new mysqli('test', 'test', 'test', 'test');\n2: if ($stmt = $mysqli-&gt;prepare($query)) {\n3:     if (!$stmt-&gt;execute()) {\n4:        $out .= \"Execute failed: (\" . $stmt-&gt;errno . \") \" . $stmt-&gt;error;\n5:    }\n6:    $out = $stmt-&gt;fetch_array();\n7: } else {\n8:   $out .= $mysqli-&gt;error;\n9: }\n</code></pre>\n\n<p>I get a <code>Fatal error: Call to undefined method mysqli_stmt::fetch_array()</code> error on line 6. </p>\n"},{"tags":["android","query","android-contentprovider"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13086992,"title":"What is the proper way to get data from content provider once you have the row uri?","body":"<p>I was wondering if it is possible to get the data which is present in a content provider row directly in a cursor (or other container) in the case where I already know the row uri (in other words, I already have the ContentURIs with the row id appended).</p>\n\n<p>Both an insert or a Content Observer OnChange (on android api 16) gives me back the inserted/changed URI and I would like to get the data from that row efficiently (without many queries or instructions). However, the only way I found was to parse the ID from the URI, build a query with a selection clause to that id and then get the cursor, as:</p>\n\n<pre><code>     long row = ContentUris.parseId(uri);\n     String mSelectionClause = ContentProvider.Table._ID + \" = ?\";\n     String[] mSelectionArgs = {Long.toString(row)};\n     Uri other_uri = Uri.parse(ContentProvider.AUTHORITY_STRING + ContentProvider.UriPathIndex.Table);\n     Cursor cursor = cr.query(other_uri ,null,mSelectionClause,mSelectionArgs,null);\n</code></pre>\n\n<p>Is there some other way of doing it? I was wondering if it was possible to directly use the row uri</p>\n"},{"tags":["mysql","query","datetime","gaps-and-islands","group-by-time-interval"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13100444,"title":"Mysql select distinct only if certain time difference exist","body":"<p>I have a rather strange question.\nI have a really big table which is the log of all the request made by everyone in my webservice.\nThis table has id, user_id, and a datetime field.\nI now want to select distinct \"sessions\".\nBy session I mean that I consider requests that have more than 5 mins difference and the same user_id a different \"session\".\nIs this possible without parsing programmatically each line ?</p>\n"},{"tags":["query","onload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13100488,"title":"My Jquery script wont run when the page loads","body":"<p>I'm trying to implement this script to centre and image on the screen. It won't run on the page load though, only when the browser is resized.</p>\n\n<p>I tried wrapping it with the:</p>\n\n<pre><code>$(document).ready(function() {});\n</code></pre>\n\n<p>But that just stops the script from working.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>&lt;script&gt;\n(function($){\n $.fn.extend({\n      center: function (options) {\n           var options =  $.extend({ // Default values\n                inside:window, // element, center into window\n                transition: 0, // millisecond, transition time\n                minX:0, // pixel, minimum left element value\n                minY:0, // pixel, minimum top element value\n                withScrolling:true, // booleen, take care of the scrollbar (scrollTop)\n                vertical:true, // booleen, center vertical\n                horizontal:true // booleen, center horizontal\n           }, options);\n           return this.each(function() {\n                var props = {position:'absolute'};\n                if (options.vertical) {\n                     var top = ($(options.inside).height() - $(this).outerHeight()) / 2;\n                     if (options.withScrolling) top += $(options.inside).scrollTop() || 0;\n                     top = (top &gt; options.minY ? top : options.minY);\n                     $.extend(props, {top: top+'px'});\n                }\n                if (options.horizontal) {\n                      var left = ($(options.inside).width() - $(this).outerWidth()) / 2;\n                      if (options.withScrolling) left += $(options.inside).scrollLeft() ||     0;\n                      left = (left &gt; options.minX ? left : options.minX);\n                      $.extend(props, {left: left+'px'});\n                }\n                if (options.transition &gt; 0) $(this).animate(props, options.transition);\n                else $(this).css(props);\n                return $(this);\n           });\n      }\n });\n})(jQuery);\n&lt;/script&gt;\n&lt;script&gt;\n$('#myDiv').center();\n$(window).bind('resize', function() {\n$('#myDiv').center({transition:20});\n});\n&lt;/script&gt;\n</code></pre>\n"},{"tags":["mysql","sql","query","view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13098871,"title":"how do I change my complex mysql query into mysql view","body":"<p>I'm a nubie in mysql queries, and I would like to ask, whether if there's someone who can help me to solve my problem. I have this complex(for me) sql. and I want to change it into a view.</p>\n\n<pre><code>SELECT \n    username, \n    user_id,\n    sum(result_points) AS count_points, \n    count(result_points) AS activity_done, \n    (\n        (\n            SELECT count(*) FROM `activity` WHERE periode_id = ''\n        ) + \n        (\n            SELECT\n                IFNULL(sum(acs.result_points), 0) \n            FROM \n                user_activity ua \n            WHERE \n                periode_id = '' \n            AND ua.user_id = user_activity.user_id\n            AND ua.result_points IS NOT NULL\n        )\n    ) AS total\n    FROM \n        user_activity \n        LEFT JOIN users ON users.id = user_activity.user_id \n    WHERE \n        periode_id = '' \n    and user_id &gt; 0 \n    GROUP BY user_id \n    ORDER BY total DESC\n</code></pre>\n\n<p>is there a way, to take out the \"where\" statement,so that i still can change it to view?</p>\n"},{"tags":["android","query","sqlite","boolean","bug"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13095277,"title":"Android - Database with ContentValue with boolean bug?","body":"<p>I created database table in my android app. I used this query:</p>\n\n<pre><code>CREATE TABLE foo (_id INTEGER PRIMARY KEY AUTOINCREMENT, mybool BOOLEAN)\n</code></pre>\n\n<p>Than I added row to the table, that the value of <code>mybool</code> will be <code>true</code>.<br>\nI ran the sqlite3 command to see the value in the table, and I saw:</p>\n\n<pre><code>  _id    |    mybool\n----------------------\n   1     |      1\n</code></pre>\n\n<p>That is corret, the <code>true</code> value became to 1.  </p>\n\n<p>The strange thing is in the reading. I read the table like that:</p>\n\n<pre><code>ContentValues values = new ContentValues();\nCursor cursor = db.rawQuery(\"SELECT * FROM foo\", null);\nDatabaseUtils.cursorRowToContentValues(cursor, values);\n</code></pre>\n\n<p>Then I get strange result:</p>\n\n<pre><code>values.getAsBoolean(\"mybool\"); // return false - WRONG\nvalues.getAsInteger(\"mybool\"); // return 1 = true - CORRECT\n</code></pre>\n\n<p>I use the code like that to get boolean value:</p>\n\n<pre><code>values.getAsInteger(\"mybool\") != 0; \n</code></pre>\n\n<p>But it's strange.</p>\n\n<p>Why I get always <code>false</code> in the <code>getAsBoolean</code> function? Is there any bug in the <code>ContentValues</code> class? Anyone else having this problem?</p>\n"},{"tags":["xml","performance","query","qt","xquery"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13098726,"title":"Qt: how to make generic (X)Query in Qt to different XML documents?","body":"<p>I'm new to QXmlQuery lib and I want to learn what is capable on with XML documents. I have maybe more than 1000 XML documents, some of them are the same (the xml scheme is the same), some of them are different.. But all of them have one common element called 'list' and this element have always children called 'item' (many items). I don't know the absolute path to the list element in each document, but I know that it is somewhere in. I want to make one query to all of this files and extract the 'items'.\nMay be this will illustrate my idea better:</p>\n\n<pre><code>QXmlQuery xquery;\nxquery.setQuery( \"doc('some_doc.xml')/list/item\");\nif (xquery.isValid())\n{\n    QXmlResultItems itemResult;\n    xquery.evaluateTo( &amp;itemResult );\n    //take an iterator or QStringList.. nevermind\n}\n</code></pre>\n\n<p>I have a code somewhere like this.</p>\n\n<p>There are two examples of these xml docs:</p>\n\n<pre><code>&lt;globalroot&gt;\n  &lt;list&gt;\n    &lt;item&gt;20.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;21.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;22.15.14447.2214&lt;/item&gt;\n  &lt;/list&gt;\n&lt;/globalroot&gt;\n</code></pre>\n\n<p>and the second example:</p>\n\n<pre><code>&lt;root&gt;\n &lt;sdmlt&gt;random text, not important&lt;/sdmlt&gt;\n &lt;localroot&gt;\n  &lt;list&gt;\n    &lt;item&gt;40.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;41.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;42.15.14447.2214&lt;/item&gt;\n  &lt;/list&gt;\n &lt;/localroot&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>The output must look like this:</p>\n\n<pre><code> //I need an iterator or QStringList that contains following down elements:\n //from the first doc:\n 20.15.14447.2214\n 21.15.14447.2214\n 22.15.14447.2214\n\n //from the second doc:\n 40.15.14447.2214\n 41.15.14447.2214\n 42.15.14447.2214\n</code></pre>\n\n<p>How can I make such a generic query? I know how to iterate over the tree and just run the xQuery over each node until (isValid() == true), but I need some mechanism in Qt that allows me to do that implicitly. Is it possible? If you know something about it you can give me a short example; suggestions, similar topics are welcomed too.</p>\n"},{"tags":["java","query","mongodb","freemarker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12705679,"title":"MongoDB, Java and Freemarker Templates (FLT)","body":"<p>I'm working on this web project with: Java, MongoDB and Freemarker Templates (FTL)</p>\n\n<p>The data is sent to the FTL pages within a Map. </p>\n\n<p>Now I would like to know if it's possible to convert the result from a Mongo query straight into a Map and then send this to the FTL template. </p>\n\n<p>For example:\nI would like to query all the members from a collection and put this in Map to use in the FTL template.</p>\n\n<pre><code>        public Map&lt;String, Object&gt; getAllMembers() {\n            DBCollection collection =database.getCollection(\"members\");\n            BasicDBObject query = new BasicDBObject();\n            DBCursor cur = collection.find(query);\n            DBObject one = cur.next();\n\n            HashMap&lt;String,Object&gt; result = one;\n\n            return result;\n        }\n</code></pre>\n\n<p>Or is this not possible and I would need to loop over the results putting each value into a Map? Like this:</p>\n\n<pre><code>        public Map&lt;String, Object&gt; getAllMembers(f){\n            DBCollection collection = database.getCollection(\"members\");\n            DBCursor cursor = collection.find();\n            Map&lt;String,Object&gt; itemMap = new HashMap&lt;String, Object&gt;();\n            DBObject one;\n            while(cursor.hasNext()) {\n                one = cursor.next();\n                itemMap.put((String)one.get(\"id\"),one.get(\"name\"));\n            }\n            return itemMap;\n        }           \n</code></pre>\n\n<p>Thanks for any help and suggestions!</p>\n"},{"tags":["android","query","android-sqlite","forceclose"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13097839,"title":"use existing database in android","body":"<p>I have written this code for using an existing database in android.</p>\n\n<p><strong>What I have is:</strong></p>\n\n<ul>\n<li>database: test</li>\n<li>table: t1</li>\n</ul>\n\n<p>I have saved my database in <code>asset</code> folder and if I run my project it give me <code>force-close</code> error.</p>\n\n<p>Where am i going wrong?</p>\n\n<pre><code>public class BDAdapter extends SQLiteOpenHelper {\n     private Context mycontext;\nint id=0;\n        private String DB_PATH = \"data/data/com.example.dd9/databases/\";\n        private static String DB_NAME = \"test.sqlite\";\n     //   public static final String KEY_ROWID = \"_id\";\n        public static final String KEY_QUOTE = \"name\";\n        private static final String DATABASE_TABLE = \"t1\";\n        private static final String TAG = \"BDAdapter\";\n        private static final String DATABASE_CREATE =\n                \"create table t1 ( \"\n                + \"name text not null );\";\n\n        private SQLiteDatabase db;\n\n\n\n        public BDAdapter(Context context) {\n            super(context, DB_NAME, null, 1);\n            this.mycontext = context;\n            boolean dbexist = checkdatabase();\n            if (dbexist) {\n            } else {\n                System.out.println(\"Database doesn't exist\");\n                try {\n                    createdatabase();\n                } catch (IOException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n            }\n\n        }\n\n        public void createdatabase() throws IOException {\n            boolean dbexist = checkdatabase();\n            if (dbexist) {\n            } else {\n                this.getReadableDatabase();\n                try {\n                    copydatabase();\n                } catch (IOException e) {\n                    throw new Error(\"Error copying database\");\n                }\n            }\n        }\n\n        private boolean checkdatabase() {\n            boolean checkdb = false;\n            try {\n                String myPath = DB_PATH + DB_NAME;\n                File dbfile = new File(myPath);\n                checkdb = dbfile.exists();\n            } catch (SQLiteException e) {\n                System.out.println(\"Database doesn't exist\");\n            }\n\n            return checkdb;\n        }\n\n        private void copydatabase() throws IOException {\n\n            // Open your local db as the input stream\n            InputStream myinput = mycontext.getAssets().open(DB_NAME);\n\n            // Path to the just created empty db\n            @SuppressWarnings(\"unused\")\n            String outfilename = DB_PATH + DB_NAME;\n\n            // Open the empty db as the output stream\n            OutputStream myoutput = new FileOutputStream(\n                    \"data/data/com.example.dd9/databases/test.sqlite\");\n\n            // transfer byte to inputfile to outputfile\n            byte[] buffer = new byte[1024];\n            int length;\n            while ((length = myinput.read(buffer)) &gt; 0) {\n                myoutput.write(buffer, 0, length);\n            }\n\n            // Close the streams\n            myoutput.flush();\n            myoutput.close();\n            myinput.close();\n\n        }\n\n        public void open() {\n            // Open the database\n            String mypath = DB_PATH + DB_NAME;\n            myDataBase = SQLiteDatabase.openDatabase(mypath, null,\n                    SQLiteDatabase.OPEN_READWRITE);\n\n        }\n\n        public synchronized void close() {\n            myDataBase.close();\n            super.close();\n        }\n\n        @Override\n        public void onCreate(SQLiteDatabase db) {\n            // TODO Auto-generated method stub\n            db.execSQL(DATABASE_CREATE);\n\n        }\n\n        @Override\n        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n            // TODO Auto-generated method stub\n            Log.w(TAG, \"Upgrading database from version \" + oldVersion + \" to \"\n                    + newVersion + \", which will destroy all old data\");\n            db.execSQL(\"DROP TABLE IF EXISTS t1\");\n            onCreate(db);\n\n\n        }\n\n        public long insertQuote(String Quote) \n        {\n            ContentValues initialValues = new ContentValues();\n            initialValues.put(KEY_QUOTE, Quote);\n            return db.insert(DATABASE_TABLE, null, initialValues);\n        }\n\n        public int getAllEntries() \n        {\n            Cursor cursor = db.rawQuery(\n                        \"SELECT COUNT(name) FROM t1\", null);\n                    if(cursor.moveToFirst()) {\n                        return cursor.getInt(0);\n                    }\n                    return cursor.getInt(0);\n\n        }\n\n        public String getRandomEntry() \n        {\n\n            id = getAllEntries();\n            Random random = new Random();\n            int rand = random.nextInt(getAllEntries());\n            if(rand == 0)\n                ++rand;\n            Cursor cursor = db.rawQuery(\n                      \"SELECT name FROM t1 \", null);\n                    //\"SELECT * FROM tblRandomQuotes\",null);\n                    if(cursor.moveToFirst()) {\n                        return cursor.getString(0);\n\n                    }\n                    return cursor.getString(0);\n\n        }\n\n        public Cursor getAllTitles() \n        {\n            return db.query(DATABASE_TABLE, new String[] {\n\n                    KEY_QUOTE,\n                    }, \n                    null, \n                    null, \n                    null, \n                    null, \n                    null);\n        }\n\n\n}\n\n\n\n//---------------------------Main class------------------------\n\npublic class MainActivity extends Activity\n{\n    BDAdapter db = new BDAdapter(this);\n    EditText name;\n    /** Called when the activity is first created. */\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.main);\n        // Capture our button from layout\n        Button setButton = (Button)findViewById(R.id.go);\n        Button getButton = (Button)findViewById(R.id.genRan);\n        // Register the onClick listener with the implementation above\n        setButton.setOnClickListener(mAddListener);\n        getButton.setOnClickListener(mAddListener);\n    }\n\n    // Create an anonymous implementation of OnClickListener\n    private OnClickListener mAddListener = new OnClickListener() \n    {\n        public void onClick(View v) \n        {\n            switch(v.getId())\n            {\n            case R.id.go:\n                db.open();\n                long id = 0;\n                // do something when the button is clicked\n                try\n                {\n                    name = (EditText)findViewById(R.id.Quote);\n                    db.insertQuote(name.getText().toString());\n\n\n                    id = db.getAllEntries();\n\n                    Context context = getApplicationContext();\n                    CharSequence text = \"The quote '\" + name.getText() + \"' was added successfully!\\nQuotes Total = \" + id;\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                    name.setText(\"\");\n                }\n                catch (Exception ex)\n                {\n                    Context context = getApplicationContext();\n                    CharSequence text = ex.toString() + \"ID = \" + id;\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                }\n\n                db.close();\n                break;\n            case R.id.genRan:\n                db.open();\n                //long id1 = 0;\n                // do something when the button is clicked\n                try\n                {\n                    //String quote = \"\";\n                    //quote = db.getRandomEntry();\n                    //Context context = getApplicationContext();\n                    //CharSequence text = quote;\n                    //int duration = Toast.LENGTH_LONG;\n\n                    //Toast toast = Toast.makeText(context, text, duration);\n                    //toast.show();\n\n                     db.open();\n                        Cursor c = db.getAllTitles();\n                       if (c.moveToFirst())\n                       {\n                          do {          \n                                DisplayTitle(c);\n                            } while (c.moveToNext());\n                       }\n                        db.close();\n\n\n                }\n                catch (Exception ex)\n                {\n                    Context context = getApplicationContext();\n                    CharSequence text = ex.toString();\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                }\n                db.close();\n            }\n        }\n\n    };\n    public void DisplayTitle(Cursor c)\n    {\n        Toast.makeText(this, \n                \"NAME: \" + c.getString(0) + \"\\n\" ,\n\n\n                Toast.LENGTH_LONG).show();        \n    } \n\n\n}\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13097320,"title":"How do I query a user value in one table to a column header and get value under header?","body":"<h2>Situation</h2>\n\n<p>I have two tables:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TDCPR.jpg\" alt=\"tables\"></p>\n\n<ul>\n<li>SGL= Single (one person in room)</li>\n<li>DBL = Double (two people in the room)</li>\n<li>TPL = Triple (three people).</li>\n</ul>\n\n<p>and so on.  (CHD = child in room; discounted occupancy).</p>\n\n<p>The <em>clients</em> table contains user inserted values.  The <em>tourprices</em> table is preset rates for roomtypes.</p>\n\n<h2>Question</h2>\n\n<p>Is there a way to query such that the user inserted roomtype is compared to the column header of tourprices table such that the result is the price for the date under that column header?</p>\n\n<p>For example:  the user wishes to book two people (DBL) onto the tour for 27-Feb-2012.  How do I write the query to pull the $200 rate based on the given?</p>\n\n<pre><code>SELECT c.roomtype, t.SGL, t.DBL, t.TPL, t.QUD, t.CHD\nFROM clients c, tourprices t\nWHERE c.roomtype = ??????\n</code></pre>\n\n<p>thanks!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13096830,"title":"Set the default schema order of a MySQL table to be reversed","body":"<p>I am currently running this query:</p>\n\n<pre><code>SELECT t.videolink, t.userid, t.tag\n    FROM (SELECT * FROM tagstrend ORDER BY timestamp DESC) AS t\n        WHERE t.timestamp &gt; ?\n        GROUP BY t.tag\n        ORDER BY SUM(t.tagcount) DESC\n        LIMIT ?, 20;\n</code></pre>\n\n<p>What I am doing is reversing the order of the table that I am selecting from before I run the rest of the query because when the I use \"GROUP BY\" I need that to take the top result which is the most recent row in the database.</p>\n\n<p>However doing this will take a hit on the performance/speed of the query because it needs to reverse the order of the table before it can query it.</p>\n\n<p>My question is, is there a way to set the default order of the table to be reversed? Because I will always be SELECTing from this table in reverse order.</p>\n\n<p>Unless someone knows a way of grouping by the most recent row in the database?</p>\n"},{"tags":["ios","query","parse.com"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12980105,"title":"Parse.com iOS queryWithClassName works for some and not others, why?","body":"<p>I have several Classes one of which one is User and another one is TestObject.  If I query User (which I learned by trial &amp; error that it should queried as _User) I get the correct record count, but if I query TestObject I get 0.  This happens for some Classes but not for all.  Why is that?</p>\n\n<pre><code>PFQuery *query = [PFQuery queryWithClassName:@\"_User\"];\n[query findObjectsInBackgroundWithBlock:^(NSArray *objects, NSError *error) {\n             if (error) {\n                 NSLog(@\"Error: %@ %@\", error, [error userInfo]);\n             } else {\n                 NSLog(@\"Successfully retrieved %d scores.\",objects.count);\n             }\n}];\n</code></pre>\n\n<p>This returns: </p>\n\n<blockquote>\n  <p>2012-10-19 13:55:03.239\n  TableViewParseDotCom[5497:10103]\n  Successfully retrieved 24 scores.</p>\n</blockquote>\n\n<p>But if I change the line, to:</p>\n\n<blockquote>\n  <p>PFQuery *query = [PFQuery\n  queryWithClassName:@\"TestObject\"];</p>\n</blockquote>\n\n<p>I get 0 count, but I know I have  45 records.  Why?</p>\n"},{"tags":["oracle","query","oracle11gr2"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":375,"score":5,"question_id":11083718,"title":"Query causes DB to fail with ORA-0113","body":"<p>I need to create a collection out of elements in a collection within an inline view. I've tryed to deaggregate the collection and aggregate it again using the collect and table functions, but it fails with ORA-03113.</p>\n\n<p>Below is a simplified version of the query causing the issue.</p>\n\n<p>In my Implementation I will have many levels of nested queries joined with unions in a single query that should aggregate all collections into a single one. For performance reasons (Expensive context switching), implementing PL/SQL code to aggregate the collections is not an option.</p>\n\n<p>Thanks a lot for your feedback/suggestions.</p>\n\n<h3>Script</h3>\n\n<hr>\n\n<pre><code>SELECT BANNER FROM V$VERSION\n/\n\nCREATE OR REPLACE TYPE OBJECT_ID_TAB_T IS TABLE OF NUMBER(11);\n/\n\nSELECT OWNER, CAST(COLLECT( MULTISET(SELECT COLUMN_VALUE FROM TABLE((OBJECT_ID_LIST) ))) AS OBJECT_ID_TAB_T) AS OBJECT_ID_LIST\nFROM  (SELECT OWNER, OBJECT_NAME, CAST(COLLECT(OBJECT_ID) AS OBJECT_ID_TAB_T)  AS OBJECT_ID_LIST\n       FROM ALL_OBJECTS\n       GROUP BY OWNER, OBJECT_NAME\n      )\nGROUP BY OWNER\n/\n</code></pre>\n\n<h3>Results</h3>\n\n<hr>\n\n<pre><code>BANNER                                                                          \n--------------------------------------------------------------------------------\nOracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production    \nPL/SQL Release 11.2.0.1.0 - Production                                          \nCORE    11.2.0.1.0  Production                                                      \nTNS for 64-bit Windows: Version 11.2.0.1.0 - Production                         \nNLSRTL Version 11.2.0.1.0 - Production                                          \n\n5 rows selected.\nType created.\nSELECT OWNER, CAST(COLLECT( MULTISET(SELECT COLUMN_VALUE FROM TABLE((OBJECT_ID_LIST) ))) AS OBJECT_ID_TAB_T) AS OBJECT_ID_LIST\nFROM  (SELECT OWNER, OBJECT_NAME, CAST(COLLECT(OBJECT_ID) AS OBJECT_ID_TAB_T)  AS OBJECT_ID_LIST\n       FROM ALL_OBJECTS\n       GROUP BY OWNER, OBJECT_NAME\n      )\nGROUP BY OWNER\n*\nError at line 0\nORA-03113: end-of-file on communication channel\nProcess ID: 8000\nSession ID: 154 Serial number: 164\n\nScript Terminated on line 25.\n</code></pre>\n"},{"tags":["mysql","sql","query","aggregate-functions","greatest-n-per-group"],"answer_count":4,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":8135,"score":14,"question_id":7745609,"title":"SQL Select only rows with Max Value on a Column","body":"<p>I have this table for documents (simplified version here):</p>\n\n<pre><code>+------+-------+--------------------------------------+\n| id   | rev   | content                              |\n+------+-------+--------------------------------------+\n| 1    | 1     | ...                                  |\n| 2    | 1     | ...                                  |\n| 1    | 2     | ...                                  |\n| 1    | 3     | ...                                  |\n+------+-------+--------------------------------------+\n</code></pre>\n\n<p>How do I select one row per id and only the greatest rev?<br>\nWith the above data, the result should contain two rows: <code>[1, 3, ...]</code> and <code>[2, 1, ..]</code>. I'm using MySQL.</p>\n\n<p>Currently I use checks in the <code>while</code> loop to detect and over-write old revs from the resultset. But is this the only method to acheive the result? Isn't there a SQL solution? </p>\n"},{"tags":["query","parsing","solr","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13091973,"title":"SOLR query coming from my application is not parsed the same as when i do it from SOLR admin console","body":"<p>I am fairly new to Solr/Lucene and am not a developer. I am troubleshooting issues where my queries that use AND/NOT are not returning the results as they should. When i run the search using them it seems to only treat the 1st word before the AND/NOT. I think i know why. see below</p>\n\n<p>I have tried several ways to no avail.</p>\n\n<p>Catalina log show the following when i run from our .net application</p>\n\n<pre><code>INFO: [] webapp=/solr path=/select params={spellcheck=true&amp;start=0&amp;q=content_en:\"GINGER+NOT+BRAD\"&amp;?=&amp;rows=1000} hits=0 status=0 QTime=0 \n</code></pre>\n\n<p>It appears to be putting my query in just one q=content_en: with the NOT included</p>\n\n<p>Catalina log show the following when i run from solr admin</p>\n\n<pre><code>INFO: [] webapp=/solr path=/select/ params={start=0&amp;version=2.2&amp;q=content_en:ginger++NOT+content_en:brad&amp;indent=on&amp;rows=10} hits=1 status=0 QTime=1 \n</code></pre>\n\n<p>It is properly treating each criteria by segregating them.</p>\n\n<p>I have tried EVERY single combination from my application front end and still no go.</p>\n\n<p>I'm sure you gurus will see this and tell me what's wrong.</p>\n"},{"tags":["query","filter","lucene","neo4j"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12155578,"title":"queryContext - filtering with numbers neo4j/lucene","body":"<p>I'm trying to filter a wildcard query in neo/lucene using numeric range.\nI want to search for all nodes (documents) having key \"actor\" starting with \"rob\" and age > 20:</p>\n\n<pre><code>WildcardQuery luceneQuery  = new WildcardQuery( new Term(\"actor\", \"rob*\" ));\nQueryContext qx = new QueryContext(luceneQuery)\n            .numericRange(\"age\", 20, null)\n                .sortNumeric(\"age\", true);      \nIndexHits&lt;Node&gt; hits = lucene.query(qx);\n</code></pre>\n\n<p>Once I add numeric range the wildCard query does not works, it only orders by numeric range.\nIs it possible to combine both wildcard and numeric?</p>\n\n<p>Thanks,\nDaniele</p>\n"},{"tags":["query","report","multiple"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13094169,"title":"copy the resultset from maindataset to subdataset in jasper report","body":"<p>I'm working on a JRXML report and want to display a detailed table and pie chart using the same query. Since I will have to sort and groupby the data to generate the pie chart and I dont want my table report to be sorted, I want to work on different datasets(with same data)</p>\n\n<p>Is there any way to copy the resultset from maindataset to subdataset in jasper report (JRXML)?</p>\n\n<p>Or can I write a query like <code>select * from MAINDATASET</code> in the querystring of the subdataset.</p>\n"},{"tags":["query","ms-access","access-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1298,"score":0,"question_id":7194224,"title":"How to query number of attachments from Attachment field in Microsoft Access?","body":"<p>One of my users has a Microsoft Access database and in the table he has an attachment field. In one of his queries, he wants to return the number of attachments that the field contains. I have tried to get this to work to no avail. I've tried creating a VBA module and passing into it the field but it errors on me. I've tried creating the parameter as a DAO.Recordset, DAO.Field, Attachment, etc.</p>\n\n<p>I've also tried querying the field like this [MyField].AttachmentCount.</p>\n"},{"tags":["sql","query","group-by","max","cascading"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13094338,"title":"Select latest month record from group of records for several groups","body":"<p>I have a table that generates a record each month for each project status report (PSR) if a PSR is/was generated. From a single table, I need to get the most recent record for each PSR.</p>\n\n<p>This gives me the list of PSR's I am looking for:</p>\n\n<pre><code>SELECT Max(Main.PSRMonth) AS MaxOfPSRMonth, Main.PE, Main.Loc, Main.EWO\nFROM Main\nGROUP BY Main.PE, Main.Loc, Main.EWO\nORDER BY Main.PE, Main.Loc, Main.EWO;\n\nTable:Main \nPrimary Key is PSRMonth + PE + EWO + LOC\n</code></pre>\n\n<p>Now, I need all fields <code>FROM Main</code> based on the selection above.\nI would like to do this with one SQL statement.</p>\n"},{"tags":["sql","xml","query","performance"],"answer_count":4,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":698,"score":1,"question_id":3701616,"title":"Speed Up XML Queries in SQL Server 2005","body":"<p>I store all my data in on XML column in SQL Server 2005.</p>\n\n<p>As more and more records are being inserted, I notice the queries are slowing down.  I've tried creaeting a Primary XML Index, as well as a Secondary VALUE index and this did not do anything to help the speed.</p>\n\n<p>Any tips,thoughts, or tricks that I'm missing?</p>\n\n<p>Sample View that I query:</p>\n\n<pre><code>SELECT Id\n, CaseNumber\n, XmlTest.value('(/CodeFiveReport/ReportEvent/StartDate)[1]', 'varchar(25)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/StartTime)[1]', 'varchar(25)') as StartDate\n, XmlTest.value('(/CodeFiveReport/@Status)[1]', 'varchar(10)') as [Status]\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Address/PatrolDistrict/@Name)[1]', 'varchar(100)') as PatrolDistrict\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@Name)[1]', 'varchar(40)') as PrimaryUnit\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@StreetNumber)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@StreetName)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/StreetSuffix/@Name)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@City)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/State/@Abbreviation)[1]', 'varchar(50)') + ' '  + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@ZipCode)[1]', 'varchar(50)') as Location\n, XmlTest.value('(/CodeFiveReport/ReportEvent/ReportType/@Name)[1]', 'varchar(50)') as ReportType\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Offenses/OffenseDescription/OffenseType/@CodeAndDescription)[1]', 'varchar(50)') as IncidentType\n, XmlTest as Report\n, CreatedBy as UserId\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@ID)[1]', 'integer') as UnitId\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@Code)[1]', 'varchar(6)') as UnitCode\n, XmlTest.value('(/CodeFiveReport/Owner/AgencyID)[1]', 'char(2)') as AgencyId   \n, IsLocked\n, LockedBy\n, XmlTest.value('(/CodeFiveReport/VersionUsed)[1]', 'varchar(20)') as VersionUsed\nFROM UploadReport\nWHERE XmlTest.value('(/CodeFiveReport/Owner/AgencyID)[1]', 'char(2)') = '06'\n</code></pre>\n"},{"tags":["django","query","chain"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13087511,"title":"Django Q chained queries","body":"<p>I need a little help with a Django Q query im trying to string together, it looks right, but its not quite working. The query is</p>\n\n<pre><code>( Q(src__lte=4) &amp; Q(src__startswith='2') ) | \n( Q(src__gt=4) &amp; ~Q(src__istartswith='713') &amp; ~Q(src__istartswith='281') ) )\n</code></pre>\n\n<p>what im trying to accomplish would be \"select where src is less than 4 AND startsiwth 2 OR src is greater than 4 and DOES NOT start with 713 OR 281\"</p>\n\n<p>the result is showing src's that start with 713 and 281, what am i doing wrong here? thanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13088856,"title":"SQL Server : add CSV programmable","body":"<p>I have the following code to insert a CSV file into a temp table:</p>\n\n<pre><code>USE [websitehere.com].[dbo]\nGO\nCREATE TABLE [websitehere.com].[dbo].[tmpTable]\n(ID INT,\n    Caller_Number VARCHAR(100),\n    Caller_Name VARCHAR(100),\n    GroupBy VARCHAR(100),\n    Campaign_Name VARCHAR(100),\n    DateAndTime VARCHAR(100),\n    Duration VARCHAR(100),\n    Call_Status VARCHAR(100))\nGO;\n\nBULK\nINSERT tmpTable \nFROM 'C:\\Users\\namehere\\Documents\\CallLog.csv' \nWITH\n(\n    FIELDTERMINATOR = ',',\n    ROWTERMINATOR = '\\n'\n)\nGO\n</code></pre>\n\n<p>But...</p>\n\n<ol>\n<li><p>It does not seem to add the <code>tmpTable</code>. It gives me an error </p>\n\n<blockquote>\n  <p><em>Msg 102, Level 15, State 1, Line 1<br>\n  Incorrect syntax near '.'.</em></p>\n</blockquote></li>\n<li><p>It won't add the insert command saying that</p>\n\n<blockquote>\n  <p><em>Msg 4834, Level 16, State 4, Line 8<br>\n  You do not have permission to use the bulk load statement.</em></p>\n</blockquote></li>\n</ol>\n\n<p>Any help would be great to take care of these 2 errors!</p>\n\n<p><strong>Update</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/Hxv6A.png\" alt=\"db user secutirys\"></p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13092702,"title":"How to iterate this SQL Query?","body":"<p>I've got this query: </p>\n\n<pre><code>SELECT TOP 1 A.ExamTemplateId, A.Id AS AnsweredTestId, AVG(B.Score) AS AvgScore, A.[Date]\nFROM AnsweredTest AS A\nINNER JOIN AnsweredWorksheet AS B ON (A.Id = B.AnsweredTestId)\nWHERE A.StudentId = 'OPA-3DKCL2' AND A.ExamTemplateId = 1\nGROUP BY A.Id, A.ExamTemplateId, A.[Date]\nORDER BY AvgScore DESC\n</code></pre>\n\n<p>Please check that I have a <code>WHERE</code> condition which receives a static number. The query result is:</p>\n\n<p>EXAMPLE 1\n<img src=\"http://i.stack.imgur.com/EZqHP.png\" alt=\"\"></p>\n\n<p>EXAMPLE 2\n<img src=\"http://i.stack.imgur.com/mAdO8.png\" alt=\"enter image description here\"></p>\n\n<p>And it is correct! But now, I'd like to show all the records from a ExamTemplate table. But now I don't know how can I accomplish that. I was thinking creating a function but I'm not sure, it's just an idea.</p>\n\n<p>The final output which I'd like to receive is the union of last records:</p>\n\n<pre><code>1   1   0.7 2012-10-21 19:50:11.697\n2   10  0.555555555555556   2012-10-22 18:58:24.163\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>UPDATE:</p>\n\n<p>I've got highlighted with yellow color the rows which I'm interested. I set in the last query <code>TOP 1</code> because I want to get the highest average score by <code>ExamTemplateId</code>. And that's will be all.</p>\n\n<p><img src=\"http://i.stack.imgur.com/VUALu.png\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","query","relationship"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13081264,"title":"Select Parent, Children, Children's Children, etc in single MySQL query","body":"<p>I feel like this must be a classic problem, but I can't find the answer.</p>\n\n<p>I have a table Person, which has basic details describing a person. Then, I have a ParentChildRelationship table, which looks something like this:</p>\n\n<pre><code>CREATE TABLE `ParentChildRelationship` (\n    `ParentId` INT(10) UNSIGNED NOT NULL,\n    `ChildId` INT(10) UNSIGNED NOT NULL,\n PRIMARY KEY(ParentId,ChildId),\n CONSTRAINT `FK_ParentRelationship`\n    FOREIGN KEY (`ParentId` )\n    REFERENCES `Person` (`idPerson` ),\n CONSTRAINT `FK_ChildRelationship`\n    FOREIGN KEY (`ChildId` )\n    REFERENCES `Person` (`idPerson` )\n);\n</code></pre>\n\n<p>I need a select query that simply returns all Person records for the Parent and all Children down the tree.</p>\n\n<p>For example, with the following data:</p>\n\n<pre><code>Parent   Child\n1        3\n1        8\n2        4\n3        5\n3        6\n6        9\n4        7\n</code></pre>\n\n<p>Select all Person records where the ParentId = 1 OR ChildId is in the tree <em>below</em> ParentId of 1. This query should return the Person information (SELECT * FROM <code>Person</code>...) for the following PersonId's:</p>\n\n<p>1,3,8,5,6,9</p>\n\n<p>I don't know if this matters, but the order of how these are returned do not matter, as I will need to order based off of something like \"LastName\" or something like that. In other words, the result could also have been 1,3,5,6,9,8.</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13092624,"title":"PostgreSQL Inner Join on the same table + second table?","body":"<p>If this is a stupid question, forgive me, I'm not very familiar with PostgreSQL.</p>\n\n<p>I've collected inventory data from used car dealerships in my area and stored it in a postgreSQL table. I've got a second table with particular details regarding certain makes and models. For example:</p>\n\n<p>The dealership table is structured like so:</p>\n\n<pre><code>-----------------------------------------\n| Dealership | Make | Model | Year | ID |\n----------------------------------------|\n|     A      | Ford | F250  | 2003 |  1 |\n|     A      | Chevy| Cobalt| 2005 |  2 |\n|     B      | Ford | F250  | 2003 |  1 |\n|     B      | Dodge| Chrgr | 2012 |  3 |\n-----------------------------------------\n</code></pre>\n\n<p>The details table is structured like so:</p>\n\n<pre><code>-----------------------------------------\n|     ID     | DetailA| DetailB| DetailC|\n-----------------------------------------\n|     1      |  data  |  data  |  data  |\n|     2      |  data  |  data  |  data  |\n|     3      |  data  |  data  |  data  |\n|     4      |  data  |  data  |  data  |\n-----------------------------------------\n</code></pre>\n\n<p>My goal is to retrieve vehicle matches from multiple dealerships and display the appropriate details. In the above example, I would like to see:</p>\n\n<pre><code>-----------------------------------------------------\n| Make | Model | Year | DetailA | DetailB | DetailC |\n-----------------------------------------------------\n| Ford | F250  | 2003 |   data  |  data   |  data   |\n-----------------------------------------------------\n</code></pre>\n\n<p>With this result, I will know that both A and B havea  2003 Ford F250 for sale, and can view the related details of the vehicle.</p>\n\n<p>I've tried many different queries, but most are variations on something like this:</p>\n\n<pre><code>SELECT DISTINCT\n    dealership_table.make,\n    dealership_table.model,\n    dealership_table.year\n            details_table.detaila,\n            details_table.detailb,\n            details_table.detailc\nFROM\n    dealership_table\nINNER JOIN\n    details_table\n    ON\n    dealership_table.id = details_table.id\nWHERE\n     dealership_table.dealership = 'A'\n     OR\n     dealership_table.dealership = 'B'\n</code></pre>\n\n<p>However this returns all of the distinct matches from the table where dealership is either A or B. I've tried multiple inner-joins, but I an error complaining <code>details_table</code> is specified multiple times.</p>\n\n<p>If I'm doing something really silly, I apologize. Like I said before, I'm pretty much an SQL noob.</p>\n\n<p>What am I doing wrong? How should I go about retrieving the desired results? Any suggestions, solutions, or advice is greatly appreciated!</p>\n"},{"tags":["query","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13092455,"title":"Lucene - search a subset with boolean query","body":"<p>I have an index with a field (eg. field1) with two rows, one is \"short greg\" and the second one is \"great greg\".\nif I search with (using Luke) : field1:g*  field1:greg </p>\n\n<p>the result will be both rows but with the same score!\nThese because both words have the same initial character G.</p>\n\n<p>My expectation is \"great greg\" with the maximum score, where G* give more weight to the score of \"GREAT GREG\".</p>\n\n<p>the question is : how to write this query ? \nthanks anyway </p>\n"},{"tags":["mysql","sql","query","random"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13092337,"title":"mysql select number overflow","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT (RAND() * (SELECT MAX(id) FROM frag.test))\n</code></pre>\n\n<p>Results in: -2.36835027969671e+18 <br>\nid is a: <code>id</code> bigint(20) unsigned</p>\n\n<p>The things is that</p>\n\n<pre><code>SELECT MAX(id) FROM frag.test\n</code></pre>\n\n<p>Results in 15783548581713655808</p>\n\n<p>And if I place the literal number instead of a select it works</p>\n\n<pre><code>SELECT (RAND() * 15783548581713655808\n</code></pre>\n\n<p>Results in  1.50243050315076e+19</p>\n\n<p>Also the following query:</p>\n\n<pre><code>SELECT RAND()*id from frag.test;\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>+----------------------+\n| RAND()*id            |\n+----------------------+\n| 2.90739099802377e+18 |\n| 3.18790581714312e+18 |\n| 4.55299756382674e+18 |\n| 8.53310890373737e+18 |\n| 5.32382972831492e+18 |\n| 1.13192831652015e+19 |\n+----------------------+\n</code></pre>\n\n<p>The problem appears to happen only when MAX() is used.</p>\n\n<p>Anyone have any thoughts on what might be happening here?</p>\n\n<p>Thank you!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As pointed out by coge, this has something to do with casting.\nI changed the query to</p>\n\n<pre><code>SELECT (RAND() * (SELECT cast(MAX(id) as decimal(30,10)) FROM frag.test));\n</code></pre>\n\n<p>And now it works as expected!</p>\n"},{"tags":["sql-server-2008","query","wildcard","like-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13077636,"title":"Parameterizing an SQL query which uses the NOT LIKE, \" ^ \" wildcard?","body":"<p>How can I parameterize the following query? (By the way I'm using a full text indexed table, hence the <code>CONTAINS()</code>)</p>\n\n<pre><code>SELECT * FROM Table WHERE CONTAINS(Column, 'cat OR dog') \nand ((column NOT LIKE '%[^ cat OR dog]%')); \n</code></pre>\n\n<p>This didn't work:</p>\n\n<pre><code> DECLARE @term1 VARCHAR(10);\n\n DECLARE @term2 VARCHAR(10);\n\n SET @term1 = 'cat';\n\n SET @term2 = 'dog';\n\nSET @term3 = @term1 + ' ' + 'OR' + ' ' + @term2;\n\nSET @term4 = '[^ @term1  OR  @term2 ]' ;\n\nSELECT * FROM table WHERE CONTAINS(column, @term3) &lt;--up to this point works\nAND (column NOT LIKE '%[@term4]%'); &lt;--this part doesn't include the second term (@term2)\n</code></pre>\n\n<p>If you'd like to fiddle with this on your end, my Full Text Indexed table looks like:</p>\n\n<pre><code> animalListID     AnimalsList\n       1           cat dog\n       2           cat\n       3           cat dog bird\n</code></pre>\n\n<p>(basically i need the parameterized version of the <code>SELECT</code> statement which returns the rows with 'cat dog' and 'cat' and NOT 'cat dog bird')</p>\n\n<p>**This is a VERY oversimplified version of my data, but the question is an exact match of the concept I'm trying to achieve. The table will have millions of rows, and many terms in each row.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13091620,"title":"How to check another row if value exists?","body":"<p>This is driving me nuts. I have dumped the imdb db using imdbpy. I'm trying to find US movies that have the actor data available by the first letter of the movie.</p>\n\n<p>Below is an example of a query that fetches the movies without acto data. This runs pretty quick:</p>\n\n<pre><code>SELECT DISTINCT title.id,title.title,title.production_year\nFROM  title\n\nINNER JOIN movie_info ON\n(movie_info.movie_id =  title.id\nAND\nmovie_info.info_type_id = 8\nAND\nmovie_info.info =  'USA') \n\nWHERE  title LIKE  'a%'\nAND  title.kind_id =  1\nLIMIT 75\n</code></pre>\n\n<p>The cast data is stored in a separate table called <code>cast_info</code> and contains about 22 million records. The <code>nr_order</code> column contains the order of credits for actors in a movie. For example, Tom Hank would be 1 in Forrest Gump. There are typically dozens of rows for each <code>movie_id</code>. </p>\n\n<p>So to check to see if the actor data is available, there should be at least one row that isn't null for that particular <code>movie_id</code>. If all the values in <code>nr_order</code> for a <code>movie_id</code> are null, it does NOT contain the data I need.</p>\n\n<p>To attempt to grab this information is used the query below:</p>\n\n<pre><code>SELECT DISTINCT title.id,title.title,title.production_year\nFROM  title\n\nINNER JOIN movie_info ON\n(movie_info.movie_id =  title.id\nAND\nmovie_info.info_type_id = 8\nAND\nmovie_info.info =  'USA') \n\nINNER JOIN cast_info ON \n(cast_info.movie_id = title.id\nAND\ncast_info.nr_order = 1)\n\nWHERE  title LIKE  'a%'\nAND  title.kind_id =  1\nLIMIT 75\n</code></pre>\n\n<p>For some reason the query becomes very slow. It takes .3-.7 for the first query and about 6-10 seconds for the second. I added an index on <code>cast_info</code>.<code>nr_order</code> but it didn't help.</p>\n\n<p>The EXPLAIN output:</p>\n\n<pre><code>+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n| id | select_type | table     | type  | possible_keys                                    | key               | key_len | ref          | rows  | Extra                       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n|  1 | SIMPLE      | title     | range | PRIMARY,title_idx_title,fk_kind_type_id_4        |  title_idx_title  | 257     | NULL         | 132801| Using where; Using temporary|\n|  1 | SIMPLE      | movie_info| ref   | ovie_info_idx_mid,info_type_id movie_info_idx_mid| movie_info_idx_mid| 4       | imdb.title.id| 4     | Using where; Distinct       |\n|  1 | SIMPLE      | table1    | ref   | cast_info_idx_mid,nr_order                       | cast_info_idx_mid | 4       | imdb.title.id| 12    | Using where; Distinct       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n</code></pre>\n\n<p>Any ideas would be very helpful!</p>\n\n<p>EDIT: EXPLAIN from 1st query</p>\n\n<pre><code>+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n| id | select_type | table     | type  | possible_keys                                    | key               | key_len | ref          | rows  | Extra                       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n|  1 | SIMPLE      | title     | range | PRIMARY,title_idx_title,fk_kind_type_id_4        |  title_idx_title  | 257     | NULL         | 132801| Using where; Using temporary|\n|  1 | SIMPLE      | movie_info| ref   | ovie_info_idx_mid,info_type_id movie_info_idx_mid| movie_info_idx_mid| 4       | imdb.title.id| 4     | Using where; Distinct       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13090690,"title":"MS SQL REPLACE not showing results","body":"<p>Hey all i have the following query:</p>\n\n<pre><code>SELECT REPLACE(REPLACE(REPLACE(REPLACE(tmpTable.Caller_Number,'-',''),'(',''),')',''),' ','') \nFROM tmpTable \nWHERE EXISTS \n(SELECT REPLACE(REPLACE(REPLACE(REPLACE(OnlineAppDetails.addPhone,'-',''),'(',''),')',''),' ','') \nFROM OnlineAppDetails \nWHERE OnlineAppDetails.addPhone = tmpTable.Caller_Number)\nORDER BY GroupsBy ASC;\n</code></pre>\n\n<p>It returns no records... However, when i do this query:</p>\n\n<pre><code>SELECT * \nFROM tmpTable \nWHERE EXISTS \n(SELECT * FROM OnlineAppDetails \nWHERE SUBSTRING(OnlineAppDetails.addPhone,2,3)+'-'+SUBSTRING(OnlineAppDetails.addPhone,7,4)+SUBSTRING(OnlineAppDetails.addPhone,11,4) = tmpTable.Caller_Number)\nORDER BY GroupsBy ASC;\n</code></pre>\n\n<p>It returns records..</p>\n\n<p>The phome number is formatted like:</p>\n\n<pre><code>for OnlineAppDetails: (xxx) xxx-xxxx\nfor         tmpTable: xxx-xxx-xxxx\n</code></pre>\n\n<p>All i am doing is taking out the <strong>- ( ) and [space]</strong> in the phone number just to be sure i am being returned all the records i should be. I know there are matches in both tables so taking out <strong>- ( ) and [space]</strong> should still result in records returned.</p>\n\n<p><strong>update</strong></p>\n\n<p>Duh.... knew it was going to be simple.</p>\n\n<pre><code>SELECT * \nFROM tmpTable \nWHERE EXISTS \n(SELECT * \nFROM OnlineAppDetails \nWHERE  REPLACE(REPLACE(REPLACE(REPLACE(OnlineAppDetails.addPhone,'-',''),'(',''),')',''),' ','') = REPLACE(REPLACE(REPLACE(REPLACE(tmpTable.Caller_Number,'-',''),'(',''),')',''),' ',''))\nORDER BY GroupsBy ASC;\n</code></pre>\n"},{"tags":["php","query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13091231,"title":"Mongo: Finding from multiple queries","body":"<p>New to Mongo here. I'm using the PHP lib and trying to work out how I can find in a collection from multiple queries. I could do this by repeating the query with a different query, but I wondered if it can be done in one.</p>\n\n<p>I.e.</p>\n\n<pre><code>$idsToLookFor = array(2124,4241,5553);\n$query = $db-&gt;thisCollection-&gt;find(array('id' =&gt; $idsToLookFor));\n</code></pre>\n\n<p>That's what I'd like to do. However it doesn't work. What I'm trying to do is find a set of results for all the id's at one time.</p>\n\n<p>Possible or just do a findOne on each with a foreach/for?   </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":243,"score":3,"question_id":8372121,"title":"Optimizing a mysql index on an ordered, range query","body":"<p>I'm looking for help with some offensive mysql queries I currently have running against my server. My goal is to show the most expensive ebay items with end time's less than one month ago.</p>\n\n<p>I'm using MySQL 5.1.</p>\n\n<p>My query is as follows ('ebay_items' has ~350,000 rows):</p>\n\n<pre><code>explain SELECT `ebay_items`.* FROM `ebay_items` \nWHERE (endtime &gt; NOW()-INTERVAL 1 MONTH) ORDER BY price desc\\G;\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>*************************** 1. row ***************************\nid: 1\nselect_type: SIMPLE\ntable: ebay_items\ntype: range\npossible_keys: endtime\nkey: endtime\nkey_len: 9\nref: NULL\nrows: 71760\nExtra: Using where; Using filesort\n1 row in set (0.00 sec)\n</code></pre>\n\n<p>This query results in an expensive 'filesort' using 71760 rows. </p>\n\n<pre><code>show indexes on ebay_items;\n</code></pre>\n\n<p>yields (I've only included the index in question, 'endtime'):</p>\n\n<pre><code>*************************** 7. row ***************************\nTable: ebay_items\nNon_unique: 1\nKey_name: endtime\nSeq_in_index: 1\nColumn_name: endtime\nCollation: A\nCardinality: 230697\nSub_part: NULL\nPacked: NULL\nNull: YES\nIndex_type: BTREE\nComment: \n*************************** 8. row ***************************\nTable: ebay_items\nNon_unique: 1\nKey_name: endtime\nSeq_in_index: 2\nColumn_name: price\nCollation: A\nCardinality: 230697\nSub_part: NULL\nPacked: NULL\nNull: YES\nIndex_type: BTREE\nComment: \n</code></pre>\n\n<p>Only the 'endtime' key of the composite endtime index (endtime, price) is being used. As far as I know, MySQL will not make use of a composite index effectively when dealing with a range query in conjunction with an 'order by' clause. </p>\n\n<p>Has anyone found a good workout for this issues? I'd primarily like to solve it at the DB level (either by a smarter use of indexes or schema changes) but I'm open to suggestions. </p>\n\n<p>One way that I could avoid the range query is to have a background task cycling through every X hours and marking an enum type field on ebay_items as '&lt; 1 day old', '&lt; 1 week old', '&lt; 1 month old', etc. I was hoping to solve the problem in a cleaner way.</p>\n\n<p>Is there any way to execute MySQL range query with an order by clause, queries in an efficient manner? </p>\n\n<p>Huge thanks for your help! </p>\n\n<p>Edit: Kohányi Róbert made the good point that I should clarify the exact problem I was having with the query. The query results in the disk I/O being pegged for it's duration. If several of these queries are running simultaneously, processes get backed up and the machine locks up. My assumption is that the filesort is eating the I/O. </p>\n\n<p>I should also mention that the table is using the MyISAM engine. Would it more performant and less I/O intensive to use the InnoDB engine? Thanks again.</p>\n"},{"tags":["query","mongodb","count","aggregate","output"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13087657,"title":"MongoDB aggregate query","body":"<p>In MongoDB I have a collection:</p>\n\n<pre><code>Statistics\n{\n    UserID:  int          //User id\n    Url: string           //Url\n    Clicks: [DateTime]    //A time array    \n}\n</code></pre>\n\n<p>When a user clicks an url add a date of the click date in Clicks array. My question is how can I write an aggregate query such as get a number of clicks that was from [date1] till [date2] and group by UserID? How can I output the, to a file?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":43,"score":4,"question_id":13089284,"title":"How can I select the most recent input for each member?","body":"<p>Assume I have a MySQL table:</p>\n\n<pre>\n╔══════╦═════╦═════════╦═════════╗\n║ time ║ mid ║ field_1 ║ field_2 ║\n╠══════╬═════╬═════════╬═════════╣\n║  100 ║   1 ║      32 ║      54 ║\n║  100 ║   2 ║       0 ║      34 ║\n║  100 ║   3 ║      44 ║      99 ║\n║  200 ║   1 ║       0 ║      45 ║\n║  200 ║   2 ║       0 ║      45 ║\n║  200 ║   3 ║       4 ║      59 ║\n║  200 ║   4 ║      45 ║      45 ║\n╚══════╩═════╩═════════╩═════════╝\n</pre>\n\n<p>time is a UNIX timestamp. mid is the member id. field_1 is supplied by the member. field_2 is filled automatically.</p>\n\n<p>I wish to select the row with the most recent non-zero field_1 for all members. So the query would result in:</p>\n\n<pre>\n╔══════╦═════╦═════════╦═════════╗\n║ time ║ mid ║ field_1 ║ field_2 ║\n╠══════╬═════╬═════════╬═════════╣\n║  100 ║   1 ║      32 ║      54 ║\n║  200 ║   3 ║       4 ║      59 ║\n║  200 ║   4 ║      45 ║      45 ║\n╚══════╩═════╩═════════╩═════════╝\n</pre>\n\n<p>The only solution I came up with does not seem very elegant:</p>\n\n<pre>\nSELECT *\nFROM (\n    SELECT *\n    FROM t1\n    WHERE field_1 > 0\n    ORDER BY time DESC\n) AS a\nGROUP BY mid\n</pre>\n\n<p>Is there a better way?</p>\n"},{"tags":["java","sql","query","ms-access","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13089118,"title":"How can I insert new values into two related tables?","body":"<p>I have a store program in java and a database made in access. I already have 2 tables in my database which are the customers table and the products table.</p>\n\n<p>I want to add an orders table wherein it's primary key is an autonumber and an order_line table to complete this app. I want to have tables like this..</p>\n\n<pre><code>customer(cust_id, name, ....)\norders(order_no, cust_id, date_purchased,...)\norder_line(order_no, product_id, ...)\nproducts(product_id, product_name, price,....)\n</code></pre>\n\n<p>When the customer purchased the products, i could insert new values to the orders table. The thing that is not clear to me is how could i insert also in the order_line table, because the order_no I created in access is of type autonumber.</p>\n\n<p>Would I make a select statement first to get the order_no value to put it to the order_no in order_line's table? Or I need to put this in one query only.</p>\n\n<p>Anyone with experience to this? Any advice is appreciated.</p>\n"},{"tags":["mysql","sql","query","pivot"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13080962,"title":"Row to column with total count","body":"<p>I have MySQL data that looks like this:</p>\n\n<pre><code>+----------------------------------------+\n|Name                | kode      | jum   |\n+----------------------------------------+\n| aman               |kode1      | 2     |\n| aman               |kode2      | 1     |\n| jhon               |kode1      | 4     |\n| amir               |kode2      | 4     |\n+--------------------+-----------+-------+\n</code></pre>\n\n<p>How can I make the table look like this one, using a MySQL query?</p>\n\n<pre><code>Name                 kode1    kode2     count\naman                  2         1        3  \njhon                  4         0        4\namir                  0         4        4\n</code></pre>\n"},{"tags":["query","syntax","hive"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":1869,"score":7,"question_id":5656899,"title":"HIve: writing column headers to local file?","body":"<p>Hive documentation lacking again:</p>\n\n<p>I'd like to write the results of a query to a local file as well as the names of the columns. </p>\n\n<p>Does Hive support this?</p>\n\n<blockquote>\n  <p>Insert overwrite local directory 'tmp/blah.blah' select * from table_name;</p>\n</blockquote>\n\n<p>Also, separate question: Is StackOverflow the best place to get Hive Help? @Nija, has been very helpful, but I don't to keep bothering them...</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13072320,"title":"MySQL subquery returns false data","body":"<p>I'm having an issue with a subquery / union.</p>\n\n<p>Here is what i want: i have a \"backup table\" (it is used for some purposes, not just backup) for orders, which i call dc_all_orders. I have two other tables, wb_orders and wb_printed. An order first gets into wb_orders and then, after a workflow step, it gets into wb_printed.\nwe have seen that some orderitems went missing, which we have in the backup table, but not in the two main order tables. I wanted to count the affected orderItems. I know 100% that the count should be more then 0, but it keeps returning zero. An example for an item which should count in:</p>\n\n<pre><code>mysql&gt; select orderId,productId from dc_all_orders where productId = '22040247153891';\n+---------------------+----------------+\n| orderId             | productId      |\n+---------------------+----------------+\n| 20319833369460309A  | 22040247153891 |\n+---------------------+----------------+\n1 row in set (2.06 sec)\n\n\nmysql&gt; select * from wb_orders where productId = '22040247153891';\nEmpty set (0.00 sec)\n\nmysql&gt; select * from wb_printed where productId = '22040247153891';\nEmpty set (0.00 sec)\n</code></pre>\n\n<p>So this productId should show up. Now: </p>\n\n<pre><code>mysql&gt; select count(*) from (select productId from wb_orders UNION select productId from wb_printed) as x;\n+----------+\n| count(*) |\n+----------+\n|  4295961 |\n+----------+\n1 row in set (2 min 51.80 sec)\n</code></pre>\n\n<p>So you know how much data we have. </p>\n\n<pre><code>mysql&gt; select count(*) from dc_all_orders WHERE productId NOT IN \n    -&gt; (select productId from wb_orders UNION select productId from wb_printed);\n+----------+\n| count(*) |\n+----------+\n|        0 |\n+----------+\n1 row in set (11 min 9.20 sec)\n</code></pre>\n\n<p>I cannot explain it. I tried it with different ways, but every way shows 0. All i can think of is the size of the subquery, but i checked the logs, no error and as you see, results are returned without an error. </p>\n\n<p>Am is missing the obvious? :)</p>\n\n<p>Here is an other way:</p>\n\n<pre><code>mysql&gt; select count(productId) from dc_all_orders WHERE productId NOT IN (select productId from wb_orders) AND  productId NOT IN (select productId from wb_printed);\n+------------------+\n| count(productId) |\n+------------------+\n|                0 |\n+------------------+\n1 row in set (6 min 3.07 sec)\n</code></pre>\n\n<p>Edit: MySQL version: \"Server version: 5.1.65-ius Distributed by The IUS Community Project\" on a CentOS 5.8</p>\n"},{"tags":["asp.net","sql","database","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13086360,"title":"DropDownList value into Linq query where clause","body":"<p>I am facing following problem. I want a search field with a DropDowList next to it, where user can pick an item for which he wants to search. I have to make it with this LINQ code not just a SQL query.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>var Metadata = from m in db.Metadatas\n    join mm in db.Multimedias\n    on m.multimediaID equals mm.multimediaID\n    where (m.   { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue) ||\n           mm.  { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue))\n           &amp;&amp; mm.filetype.ToString().Contains(radiobuttonvalue)\n</code></pre>\n\n<p>I want to put something like: \"Dropdownlist.selectedvalue\" into the area { Here would i have the selected value from the dropdownlist. }</p>\n\n<p>I hope you guys understand my idea and problem.</p>\n"},{"tags":["sql","query","date","sql-order-by"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22393,"score":2,"question_id":1545888,"title":"SQL ORDER BY date problem","body":"<p>Can you please help me in solving this problem. I am trying to order the results of an SQL query by date, but I'm not getting the results I need.</p>\n\n<p>The query I'm using is:</p>\n\n<pre><code>SELECT date FROM tbemp ORDER BY date ASC\n</code></pre>\n\n<p>Results are:</p>\n\n<pre><code>01/02/2009\n03/01/2009\n04/06/2009\n05/03/2009\n06/12/2008\n07/02/2009\n</code></pre>\n\n<p>Results should be:</p>\n\n<pre><code>06/12/2008\n03/01/2009\n01/02/2009\n07/02/2009\n</code></pre>\n\n<p>I need to select the date in the format above. </p>\n\n<p>Your help is much appreciated.</p>\n"},{"tags":["database","algorithm","query","math"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":233,"score":4,"question_id":12327004,"title":"How does the HyperLogLog algorithm work?","body":"<p>I've been learning about different algorithms in my spare time recently, and one that I came across which appears to be very interesting is called the HyperLogLog algorithm - which estimates how many unique items are in a set.</p>\n\n<p>This was particularly interesting to me because it brought me back to my MySQL days when I saw that \"Cardinality\" value (which I always assumed until recently that it was calculated not estimated).</p>\n\n<p>So I know how to write an algorithm in O(n) that will calculate how many unique items are in a set. I wrote this in Javascript</p>\n\n<pre><code>function countUniqueAlgo1(set) {\n    var Table = {};\n    var numUnique = 0;\n    var numDataPoints = set.length;\n    for (var j = 0; j &lt; numDataPoints; j++) {\n        var val = set[j];\n        if (Table[val] != null) {\n            continue;\n        }\n        Table[val] = 1;\n        numUnique++;\n    }\n    return numUnique;\n}\n</code></pre>\n\n<p>But the problem is that my algorithm, while O(n), uses a lot of memory (storing values in <code>Table</code>).</p>\n\n<p>I've been reading this paper about how to count duplicates in a set in O(n) time and using minimal memory.\n<a href=\"http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf\" rel=\"nofollow\">http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf</a></p>\n\n<p>It explains that by hashing and counting bits or something one can estimate within a certain probability (assuming the set is evenly distributed) the number of unique items in a set.</p>\n\n<p>I've read the paper but I can't seem to understand it. Can someone give a more layperson's explanation? I know what hashes are, but I don't understand how they are used in this HyperLogLog algorithm.</p>\n"},{"tags":["sql","query"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1972,"score":4,"question_id":3650689,"title":"SQL - exclude a column from SELECT query","body":"<p>I have 100 columns in a table, i want to list 99 columns except a particular one, how to exclude that columns name?</p>\n"},{"tags":["mysql","query","cakephp-1.3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13083543,"title":"CakePHP multiple nested query","body":"<p>I want my query as:</p>\n\n<pre><code>$conditions = array(\n                        'ManageTrackby.trackby_num NOT LIKE' =&gt; '%n/a%',\n                        'Balancesheet.subscriber_id' =&gt; $_SESSION['Auth']['User']['subscriber_id'],\n                        'Balancesheet.show_id' =&gt; $this-&gt;Session-&gt;read('openshowid'),\n                        'OR' =&gt; array('Balancesheet.season_id' =&gt; $season_id,  'Balancesheet.season_id is null'),\n                        'OR' =&gt; array('Balancesheet.episode_id'=&gt; $episode_id, 'Balancesheet.episode_id is null')\n                    );\n</code></pre>\n\n<p>which skips last <code>OR</code> option here and giving below result:</p>\n\n<pre><code>Array\n(\n[ManageTrackby.trackby_num NOT LIKE] =&gt; %n/a%\n[Balancesheet.subscriber_id] =&gt; 105\n[Balancesheet.show_id] =&gt; 56\n[OR] =&gt; Array\n    (\n        [Balancesheet.episode_id] =&gt; 86\n        [0] =&gt; Balancesheet.episode_id is null\n    )\n</code></pre>\n\n<p>)</p>\n\n<p>Here, it misses <code>SEASON_ID</code> from the condition, any idea why?</p>\n\n<p>Please guide me !</p>\n"},{"tags":["android","query","calendar","android-contentprovider"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1124,"score":1,"question_id":5735953,"title":"Create an event with attendees eMail on android","body":"<p>I try to create an event and add an email to it.</p>\n\n<p>i cant get it work, the time i get is 1970 and no email apears.</p>\n\n<p>any ideas?</p>\n\n<p>Thanks. </p>\n\n<p>This is the code i use:</p>\n\n<pre><code>    Uri calendars = null;\n   if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n   {\n         calendars = Uri.parse(\"content://com.android.calendar/calendars\");\n   }\n   else\n   {\n          calendars = Uri.parse(\"content://calendar/calendars\");\n   }\n\n   Cursor cursor = context.getContentResolver().query(calendars,                                                                  new String[] { \"_id\", \"displayName\" },                                                    \"selected=1\",                                                   null,                                                   null);\n\n   if (cursor != null &amp;&amp; cursor.moveToFirst()) \n   {\n       String[] calNames = new String[cursor.getCount()];\n   final int[] calIds = new int[cursor.getCount()];\n   for (int i = 0; i &lt; calNames.length; i++) \n   {\n    // retrieve the calendar names and ids               \n    calIds[i] = cursor.getInt(0);\n    calNames[i] = cursor.getString(1);\n    cursor.moveToNext();\n   } \ncursor.close();\n    String name = \"Name1\";\n    String eMail = \"name1@nnn.com\";\n    ContentValues event = new ContentValues();\n\n    int cal_id = calIds[which];\n    event.put(\"calendar_id\", cal_id);\n    event.put(\"title\", \"test title\");\n    event.put(\"eventLocation\", \"test location\");            \n    event.put(\"eventStatus\", 1);\n    event.put(\"visibility\", 0);\n    event.put(\"transparency\", 0);\n    event.put(\"hasAlarm\", 1);\n    event.put(\"hasAttendeeData\", \"1\");\n\n    Calendar c = Calendar.getInstance();\n    c.roll(Calendar.DAY_OF_MONTH, true);\n\n    Date date = c.getTime();\n    Date begine = new Date(date.getYear(), \n            date.getMonth(), \n            date.getDate(), \n            14, 0);         long dtstart = begine.getTime();\n    event.put(\"dtstart\", dtstart);\n\n    Date end = new Date(date.getYear(), \n                date.getMonth(), \n                date.getDate(), \n                15, 0);\n    long dtend = end.getTime();\n\n    event.put(\"dtend\", dtend);\nUri eventsUri = null;\n    if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n    {\n       eventsUri = Uri.parse(\"content://com.android.calendar/events\");\n    }\n    else\n{\n      eventsUri = Uri.parse(\"content://calendar/events\");\n    }\n    Uri url = context.getContentResolver().insert(eventsUri, event);\n    long id = -1;\n\n    if (url != null) \n    {\n         id = Long.parseLong(url.getLastPathSegment());\n        ContentValues values = new ContentValues();\n        values.put(\"event_id\", id);\n        values.put(\"method\", 1); //METHOD_ALERT\n        values.put(\"minutes\", 15); // 15 minutes\n        Uri reminder = Uri.parse(\"content://com.android.calendar/reminders\");\n            context.getContentResolver().insert(reminder, values);\n        if(name.length() &gt; 0 || eMail.length() &gt; 0)\n        {\n            ContentValues attendees = new ContentValues();\n            attendees.put(\"attendeeEmail\", eMail);\n            attendees.put(\"attendeeName\", name);\n            attendees.put(\"attendeeRelationship\", 2);//RELATIONSHIP_ATTENDEE\n            attendees.put(\"attendeeStatus\", 3); //ATTENDEE_STATUS_INVITED       \n            attendees.put(\"attendeeType\", 1); //TYPE_REQUIRED\n            attendees.put(\"event_id\", id);\n\n            Uri attendeesUri = null;\n            if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n            {\n                     attendeesUri = Uri.parse(\"content://com.android.calendar/attendees\");\n            }\n                else\n                {\n                    attendeesUri = Uri.parse(\"content://calendar/attendees\");\n                }\n            context.getContentResolver().insert(attendeesUri, attendees);\n\n            Intent i = new Intent(Intent.ACTION_EDIT); \n\n            i.setType(\"vnd.android.cursor.item/event\");\n            i.setData(url);\n\n            context.startActivity(i);\n        }\n        else\n        {\n            Toast.makeText(context, \"Could not create an event!\", Toast.LENGTH_LONG);               \n        }\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":63,"score":-2,"question_id":13087154,"title":"Find MAX and SUM From Two Tables","body":"<p>I am developing a point of sale system and in need of finding the customer who has the highest amount of purchase.</p>\n\n<p>I have these two tables, the first which holds the customer and transaction number, the second holds the transaction number and the total amount of the transaction. Here is the table</p>\n\n<pre><code>--------------------------\n| Customer | Transaction |\n--------------------------\n| 1000     | 902134      |\n--------------------------\n| 1001     | 798249      |\n--------------------------\n| 1001     | 312523      |\n--------------------------\n| 1002     | 741284      |\n--------------------------\n| 1000     | 122354      |\n-------------------------- \n\n------------------------------\n| Transaction | Total_Amount |\n------------------------------\n| 902134      | 9000.00      |\n------------------------------\n| 798249      | 3000.00      |\n------------------------------\n| 312523      | 5000.00      |\n------------------------------\n| 741284      | 4000.00      |\n------------------------------\n| 122354      | 1000.00      |\n------------------------------\n</code></pre>\n\n<p>I need to get the customer code 1000 which has 10,000.00 worth of transaction. </p>\n\n<p>I am using MySQL and PHP.</p>\n"},{"tags":["mysql","query","magento-1.7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13029709,"title":"Magento: Subtraction and Division on addAttributeToFilter","body":"<p>I'm a newbie with Magento getResourceModel, and I'm trying to add a simple filter to my query, but i can't figure that using getResourceModel.</p>\n\n<p>Original Query:</p>\n\n<pre><code>$collection = Mage::getResourceModel('catalog/product_collection');\nMage::getModel('catalog/layer')-&gt;prepareProductCollection($collection);\n$collection-&gt;addAttributeToFilter('promotion', 1)-&gt;setOrder('price', 'desc');\n</code></pre>\n\n<p>I just want add the where clause:</p>\n\n<pre><code> (`price` - `final_price`) &gt;= (`price` * 0.4) \n</code></pre>\n\n<p>Someone can help me to do this?</p>\n\n<p>This is all, thanks!</p>\n"},{"tags":["mysql","query","join","if-statement","count"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":2571,"score":0,"question_id":9798937,"title":"Count with if condition in mysql query","body":"<p>I have two tables one is for news and other one is for comments and i want to get the count for the comments whose status has been set as approved.</p>\n\n<pre><code>SELECT ccc_news . * , \ncount(if(ccc_news_comments.id = 'approved', ccc_news_comments.id, 0)) AS comments\nFROM ccc_news\nLEFT JOIN ccc_news_comments ON ccc_news_comments.news_id = ccc_news.news_id\nWHERE `ccc_news`.`category` = 'news_layer2'\nAND `ccc_news`.`status` = 'Active'\nGROUP BY ccc_news.news_id\nORDER BY ccc_news.set_order ASC\nLIMIT 20 \n</code></pre>\n\n<p>But the problem with this query is that minimum value that is fetched for the comments column is 1 whether there is any comment existent corresponding to that news or not.</p>\n\n<p>Any help would be highly appreciable.</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":273,"score":-1,"question_id":6571701,"title":"SQL Query Help obtaining last order date from 2 tables","body":"<p>I have the following table</p>\n\n<pre><code>Orders_All\nAccount\n</code></pre>\n\n<p>Orders all contains every order line many thousand records and the 2 records are <code>order_date</code> and <code>order_account_id</code>.</p>\n\n<p>This need to join into the Account so other queries can be run as well but I want a report that shows the account_id and the last order date but only one record per account.</p>\n\n<p>How can I create a query to acgieve this.</p>\n"},{"tags":["query","alfresco","cmis","workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12980624,"title":"Cant execute simple query to Alfresco with CMIS WORKBENCH","body":"<p>I am trying to execute this simple query to Alfresco with CMIS WORKBENCH and I am getting some errors:</p>\n\n<pre><code>SELECT * FROM cmis:document\n</code></pre>\n\n<p>When I check the log, there is a lot of exceptions. These are (to me) the relevants:</p>\n\n<blockquote>\n  <p>The Web Script /alfresco/service/cmis/queries has responded with a status of 500 - Internal Error.</p>\n  \n  <p>Message:   09180065 Wrapped Exception (with status template): 09185424 Failed to execute script 'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js': 09185423</p>\n  \n  <p>Exception:    java.security.cert.CertificateExpiredException - NotAfter:\n  Fri Aug 17 07:34:11 VET 2012\n  Exception:    java.security.cert.CertPathValidatorException - timestamp\n  check failed\n  Exception:    org.alfresco.repo.search.impl.lucene.LuceneQueryParserException\n  - 09185423 Exception: org.alfresco.scripts.ScriptException - 09185424 Failed to execute script\n  'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js':\n  Exception:    org.springframework.extensions.webscripts.WebScriptException\n  - 09180065 Wrapped Exception (with status template): 09185424 Failed to execute script\n  'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js':\n  09185423</p>\n</blockquote>\n\n<p>Does anybody knows what this exceptions means? Thanks for any help!</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12927356,"title":"Microsoft Access - Enter Parameter Value why?","body":"<p>I am encountering a problem for my database.</p>\n\n<p>And tried to do the query for how many transactions have movie \"Harry_Potter\"?</p>\n\n<p>so I used SQL query:</p>\n\n<pre><code>SELECT\nCOUNT(td.movie) AS number_of_occurrence,\ntd.transaction_number\nFROM\nTransactionDetails td,\nMovieDetails md\nWHERE\nmd.movie = Harry_Potter\n</code></pre>\n\n<p>But it asks for Harry_Potter enter parameter value why?\nThe relevant SQL statements are</p>\n\n<pre><code>CREATE TABLE TransactionDetails \n(\ntransaction_number INTEGER PRIMARY KEY,\nmovie VARCHAR(30) NOT NULL,\ndate_of_transaction DATE NOT NULL,\nmember_number INTEGER NOT NULL\n)\n\nCREATE TABLE MovieDetails\n(\nmovie VARCHAR(30) PRIMARY KEY,\nmovie_type VARCHAR(3) NOT NULL,\nmovie_genre VARCHAR(10) NOT NULL\n)\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT member_number_fk FOREIGN KEY (member_number) REFERENCES    LimelightMemberDetails(member_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT transaction_number_drink_fk FOREIGN KEY (transaction_number) REFERENCES DrinkTransactionDetails(transaction_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT transaction_number_food_fk FOREIGN KEY (transaction_number) REFERENCES FoodTransactionDetails(transaction_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT movie_fk FOREIGN KEY (movie) REFERENCES MovieDetails (movie);\n</code></pre>\n\n<p>Thank you for your help! If there is anything wrong with my database design please let me know! thank you!</p>\n"},{"tags":["query","fields","ms-access-2010"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":210,"score":0,"question_id":11527438,"title":"Access 2010 form not displaying query","body":"<p>I'm sure this is an easy fix but I can't seem to find it. I just have a form, that will be a subform of another, that needs to display the results of a query.</p>\n\n<p>The query is simple enough, just displays all fields of records that fall between specified dates. The query works great, but when I attach it to the form as its record source it doesn't display the data. I can see the correct amount of record selectors so I know its understanding the query but its as if all fields are hidden!  </p>\n\n<p>I have also tried building a query to the forms record source that was simply  Select query.* From query. Oddly I have had this working before but I had to specify every field. What I mean is:  </p>\n\n<p>Select title From query<br>\nSelect type From query<br>\nSelect date From query\n...  </p>\n\n<p>And so on for all the fields but this seems foolish, can anyone think of what I may be doing wrong?<br>\nThanks in advance!</p>\n\n<p><strong>Edit, forgot to mention I also tried the foolish solution that I mentioned above and it didn't work so its definitely some issue that I'm not seeing, some property that's probably not appropriately set</strong>    </p>\n\n<p>@sshekhar well its not really code at the moment I'm using Access 2010. I have a form that needs to display a subform that executes this query of displaying records that have a data field that fall between dates specified by  the user. The query works and displays the correct records, but the form that it is attached to only shows the record selectors and all the fields appear to be \"hidden.\" I thought it may be one of the form's properties set incorrectly but I checked on the test form from another database that I used and each have what appears to be identical settings. So I'm at a loss!</p>\n"},{"tags":["sql","query","cakephp-2.1","avg"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13085657,"title":"Avg Method for inner association in a query","body":"<p>I am using cakephp 2.1 and I wanna find out movie avg critic rating.\nI have written query as follows.</p>\n\n<pre><code>$latest_movies = $this-&gt;Movie-&gt;find('all', array(\n        'contain' =&gt; array('Language', 'CriticReview' =&gt; array('fields' =&gt; array('AVG(CriticReview.rating) AS avg_rating'))),\n        'limit' =&gt; 3,\n        'conditions' =&gt; array('Movie.release &lt;=' =&gt; date('Y-m-d')),\n        'order' =&gt; 'Movie.release DESC'));\n</code></pre>\n\n<p>The associations are</p>\n\n<pre><code>'Movie' =&gt; hasOne(Language),\n        =&gt; hasMany(CriticReview).\n</code></pre>\n\n<p>The array structure before including fields field in 'CriticReview' as follows</p>\n\n<pre><code>array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'release' =&gt; '2012-10-12',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '2',,\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4',\n        ),\n        (int) 1 =&gt; array(\n            'id' =&gt; '4',\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4',\n        )\n    )\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '1',\n            'rating' =&gt; '6',\n            'movie_id' =&gt; '1','\n        )\n    )\n),\n(int) 2 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'Eega',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '3',\n        'industry_id' =&gt; '2'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '3',\n        'name' =&gt; 'telugu'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '3',\n            'rating' =&gt; '5',\n            'movie_id' =&gt; '2',\n        )\n    )\n)\n</code></pre>\n\n<p>)</p>\n\n<p>The array structure after including fields field in 'CriticReview' as follows.</p>\n\n<pre><code>array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'release' =&gt; '2012-10-12',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array()\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'movie_id' =&gt; '1',\n        'CriticReview' =&gt; array(\n             (int) 0 =&gt; array(\n            'id' =&gt; '1',\n            'rating' =&gt; '4.75',\n            'movie_id' =&gt; '1','\n             )\n    )\n        )\n    )\n),\n(int) 2 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'Eega',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '3',\n        'industry_id' =&gt; '2'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '3',\n        'name' =&gt; 'telugu'\n    ),\n    'CriticReview' =&gt; array()\n)\n</code></pre>\n\n<p>)</p>\n\n<p>I am getting avg critic rating of all movies for movie id 1 but not for perticular movie.\nPlease help me to sort out that avg rating for each movie. The work will be more appreciable.</p>\n"},{"tags":["c#","sql-server","query","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":155,"score":0,"question_id":5648444,"title":"Error While passing long query","body":"<p>I have a query.</p>\n\n<pre><code>DECLARE  @fromDate AS DATETIME = '01/28/2009';\nDECLARE  @ToDate AS DATETIME = '01/28/2011';\nDECLARE  @IsMonthWise AS BIT = 1\nDECLARE  @temp AS TABLE(   userId BIGINT\n                         , Visits INT\n                         , DownLoads INT )\nDECLARE  @tempmonth AS TABLE(   userId BIGINT\n                              , Visits INT\n                              , DownLoads INT\n                              , MonthYear NVARCHAR( 50 ) )\n\nIF @IsMonthWise = 0\nBEGIN\n    INSERT INTO @temp(   UserId\n                       , Visits\n                       , DownLoads )\n    SELECT  Main.user_id             AS UserId\n          , COUNT( Main.user_id )    AS Visits\n          , ( SELECT  COUNT( user_id )\n              FROM  content_hits_tbl AS Sub\n              WHERE  content_id &lt;&gt; 0 AND\n                     Main.user_id = Sub.user_id AND\n                     visit_type = 2 AND\n                     CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n              GROUP BY  USER_ID )\n    FROM  content_hits_tbl AS Main\n    INNER JOIN users\n    ON  Main.user_id = users.user_id\n    WHERE  content_id = 0 AND\n           visit_type = 1 AND\n           users.user_deleted = 0 AND\n           CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n    GROUP BY  Main.user_id\n\n    SELECT  Users.last_name + ',' + Users.first_name AS User_Name\n          , REPLACE( REPLACE( REPLACE( REPLACE( region.value_string, '1', 'APR' ), '2', 'LAR' ), '3', 'EAMER' ), '4', 'US&amp;C' ) AS User_Region\n          , CASE\n                WHEN Users.membership_user = 0 THEN 'Internal'\n                ELSE 'External'\n            END AS User_Type\n          , Visits                   AS No_of_Visits\n          , ISNULL( DownLoads, 0 )   AS No_of_DownLoads\n          , Users.user_id            AS UserId\n          , ( SELECT  userData.value_string\n              FROM  dynamic_data_tbl AS userData\n              WHERE  userData.object_id = user_id AND\n                     definition_id = 2147483649 ) AS [Organizational Group]\n    FROM  users AS Users\n    INNER JOIN @temp AS temp\n    ON  temp.UserId = Users.user_id\n    INNER JOIN dynamic_data_tbl AS region\n    ON  region.object_id = Users.user_id\n    WHERE  region.definition_id = 43\n    ORDER BY  No_of_Visits DESC\nEND\nELSE\nBEGIN\n    INSERT INTO @tempmonth(   UserId\n                            , Visits\n                            , DownLoads\n                            , MonthYear )\n    SELECT  Main.user_id             AS UserId\n          , COUNT( Main.user_id )    AS Visits\n          , ( SELECT  COUNT( user_id )\n              FROM  content_hits_tbl AS Sub\n              WHERE  content_id &lt;&gt; 0 AND\n                     Main.user_id = Sub.user_id AND\n                     DATENAME( mm, Main.hit_date ) + '-' + DATENAME( yyyy, Main.hit_date ) = DATENAME( mm, Sub.hit_date ) + '-' + DATENAME( yyyy, Sub.hit_date ) AND\n                     visit_type = 2 AND\n                     CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n              GROUP BY  USER_ID\n                      , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date ) )\n          , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date ) AS MonthYear\n    FROM  content_hits_tbl AS Main\n    INNER JOIN users\n    ON  Main.user_id = users.user_id\n    WHERE  content_id = 0 AND\n           visit_type = 1 AND\n           users.user_deleted = 0 AND\n           CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n    GROUP BY  Main.user_id\n            , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date )\n\n    SELECT  Users.last_name + ',' + Users.first_name AS User_Name\n          , REPLACE( REPLACE( REPLACE( REPLACE( region.value_string, '1', 'APR' ), '2', 'LAR' ), '3', 'EAMER' ), '4', 'US&amp;C' ) AS User_Region\n          , CASE\n                WHEN Users.membership_user = 0 THEN 'Internal'\n                ELSE 'External'\n            END AS User_Type\n          , Visits                   AS No_of_Visits\n          , ISNULL( DownLoads, 0 )   AS No_of_DownLoads\n          , Users.user_id            AS UserId\n          , temp.MonthYear           AS MonthYear\n          , ( SELECT  userData.value_string\n              FROM  dynamic_data_tbl AS userData\n              WHERE  userData.object_id = user_id AND\n                     definition_id = 2147483649 ) AS [Organizational Group]\n    FROM  users AS Users\n    INNER JOIN @tempmonth AS temp\n    ON  temp.UserId = Users.user_id\n    INNER JOIN dynamic_data_tbl AS region\n    ON  region.object_id = Users.user_id\n    WHERE  region.definition_id = 43\n    ORDER BY  User_Name ASC\n            , MonthYear DESC\nEND\n\nDELETE FROM @temp\n\nDELETE FROM @tempmonth\n</code></pre>\n\n<p>IT Works fine if in run in SQL server. But if i pass the same as string from C# code(ExecuteReader).It is Not executing.</p>\n\n<p>If i copy the query from code behind and paste in sql server it is coming in single row.I think it is the reason why my query is not executing.</p>\n\n<p>Please let me know the way how to pass execute long query from my Application (C#)</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query","select","information-schema"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":608,"score":1,"question_id":5265684,"title":"Select tables that do not contain a certain column in MySQL","body":"<p>I am trying to select all tables that do not have column named 'unique'. I can select all tables that have it using:</p>\n\n<pre><code>SELECT DISTINCT TABLE_NAME \nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE COLUMN_NAME = 'unique'\nAND TABLE_SCHEMA ='database';\n</code></pre>\n\n<p>Is there a simple way to modify the SELECT statement so it lists all tables that do not have that column? This seems like it would be simple, but I can't figure it out, and can't find an answer on the forum.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","xml","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13065532,"title":"LINQ XML- Read XML data","body":"<p>I am having trouble with LINQ query for XML and can't solve</p>\n\n<p>I am trying to extract the  element values</p>\n\n<p>Here is the XML</p>\n\n<pre><code>&lt;response&gt;\n  &lt;make&gt;DODGE&lt;/make&gt;\n  &lt;make&gt;CHRYSLER&lt;/make&gt;\n  &lt;make&gt;JEEP&lt;/make&gt;\n  &lt;make&gt;RAM&lt;/make&gt;\n  .......etc\n&lt;/response&gt;\n</code></pre>\n\n<p>Here is the code I have so far...</p>\n\n<pre><code>        XElement parsedXml3 = XElement.Parse(xml3);\n        var query2 = from m in parsedXml3.Descendants(\"response\")\n                     select m.Elements(\"make\").Select(e =&gt; e.Value);\n        List&lt;string&gt; ls = new List&lt;string&gt;();\n        foreach (var o in query2)\n        {\n            ls = o.ToList();\n        }\n        ls.Sort();\n</code></pre>\n\n<p>Thanks for your help - extended explanations would be great </p>\n"},{"tags":["performance","query","tsql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":12854990,"title":"Why would ISNULL improve the performance of a query?","body":"<p>We're currently trying to speedup some queries and we've run into something which I (not a DBA just a .NET developer) cannot explain or comprehent. We're running this query on SQL Server 2005.</p>\n\n<p>We have the following query (made small and simple for the sake of argument);</p>\n\n<pre><code>SELECT    \n    *\nFROM    \n    RandomTable \nWHERE   \n    MoneyColumn &lt;&gt; 0\nGROUP BY\n    SomeColumn\n</code></pre>\n\n<p>This query run in around <strong>three</strong> seconds, then we randomly tried to following to speed it up (shot in the dark really)</p>\n\n<pre><code>SELECT    \n    *\nFROM    \n    RandomTable \nWHERE   \n    isnull(MoneyColumn,0) &lt;&gt; 0\nGROUP BY\n    SomeColumn\n</code></pre>\n\n<p>This reduces the query speed to around <strong>one</strong> second..</p>\n\n<p>This column has no NULL values (yet due to the database design beeing HORRIBLE) it is however NULLABLE...</p>\n\n<p>Is the fact that it's NULLABLE making SQL Server do something to account for this making it slow where the ISNULL isn't beeing mentioned? I simply have no idea why the ISNULL would make it perform faster (and by such a big margin). I'd think SQL would actually have more to do when there is a ISNULL statement in the query.</p>\n\n<p>Can anyone shed some light on this?</p>\n\n<p><strong>EDIT</strong> Execution plans added</p>\n\n<p><strong>With ISNULL</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;ShowPlanXML xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" Version=\"1.0\" Build=\"9.00.5000.00\" xmlns=\"http://schemas.microsoft.com/sqlserver/2004/07/showplan\"&gt;\n  &lt;BatchSequence&gt;\n    &lt;Batch&gt;\n      &lt;Statements&gt;\n        &lt;StmtSimple StatementCompId=\"1\" StatementEstRows=\"9019.76\" StatementId=\"1\" StatementOptmLevel=\"FULL\" StatementSubTreeCost=\"1.48105\" StatementText=\"SELECT    debiteur_id, MIN(Faktuurdatum) AS OldestOpenInvoiceDate, ISNULL(SUM(Totaal_Open),0) AS TotalOpenAmount&amp;#xD;&amp;#xA;FROM    dbo.tbl_Faktuur &amp;#xD;&amp;#xA;WHERE   (Afgehandeld_NeeJa = 0 OR Afgehandeld_NeeJa IS NULL)&amp;#xD;&amp;#xA;AND        (ISNULL(Totaal_Open,0) &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;--AND        (Totaal_Open &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;GROUP BY debiteur_id\" StatementType=\"SELECT\"&gt;\n          &lt;StatementSetOptions ANSI_NULLS=\"false\" ANSI_PADDING=\"false\" ANSI_WARNINGS=\"false\" ARITHABORT=\"true\" CONCAT_NULL_YIELDS_NULL=\"false\" NUMERIC_ROUNDABORT=\"false\" QUOTED_IDENTIFIER=\"false\" /&gt;\n          &lt;QueryPlan DegreeOfParallelism=\"1\" MemoryGrant=\"1520\" CachedPlanSize=\"54\" CompileTime=\"11\" CompileCPU=\"11\" CompileMemory=\"704\"&gt;\n            &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.000901976\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Compute Scalar\" NodeId=\"0\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"1.48105\"&gt;\n              &lt;OutputList&gt;\n                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                &lt;ColumnReference Column=\"Expr1005\" /&gt;\n              &lt;/OutputList&gt;\n              &lt;ComputeScalar&gt;\n                &lt;DefinedValues&gt;\n                  &lt;DefinedValue&gt;\n                    &lt;ColumnReference Column=\"Expr1005\" /&gt;\n                    &lt;ScalarOperator ScalarString=\"isnull([Expr1004],($0.0000))\"&gt;\n                      &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Identifier&gt;\n                            &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                          &lt;/Identifier&gt;\n                        &lt;/ScalarOperator&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/Intrinsic&gt;\n                    &lt;/ScalarOperator&gt;\n                  &lt;/DefinedValue&gt;\n                &lt;/DefinedValues&gt;\n                &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.291662\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Compute Scalar\" NodeId=\"1\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"1.48014\"&gt;\n                  &lt;OutputList&gt;\n                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                  &lt;/OutputList&gt;\n                  &lt;ComputeScalar&gt;\n                    &lt;DefinedValues&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"CASE WHEN [Expr1013]=(0) THEN NULL ELSE [Expr1014] END\"&gt;\n                          &lt;IF&gt;\n                            &lt;Condition&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Compare CompareOp=\"EQ\"&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Identifier&gt;\n                                      &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                                    &lt;/Identifier&gt;\n                                  &lt;/ScalarOperator&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Const ConstValue=\"(0)\" /&gt;\n                                  &lt;/ScalarOperator&gt;\n                                &lt;/Compare&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Condition&gt;\n                            &lt;Then&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Const ConstValue=\"NULL\" /&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Then&gt;\n                            &lt;Else&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Identifier&gt;\n                                  &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                                &lt;/Identifier&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Else&gt;\n                          &lt;/IF&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                    &lt;/DefinedValues&gt;\n                    &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.291662\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Aggregate\" NodeId=\"2\" Parallel=\"false\" PhysicalOp=\"Hash Match\" EstimatedTotalSubtreeCost=\"1.48014\"&gt;\n                      &lt;OutputList&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                      &lt;/OutputList&gt;\n                      &lt;MemoryFractions Input=\"1\" Output=\"1\" /&gt;\n                      &lt;RunTimeInformation&gt;\n                        &lt;RunTimeCountersPerThread Thread=\"0\" ActualRows=\"156794\" ActualEndOfScans=\"1\" ActualExecutions=\"1\" /&gt;\n                      &lt;/RunTimeInformation&gt;\n                      &lt;Hash&gt;\n                        &lt;DefinedValues&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"MIN([directpay].[dbo].[tbl_Faktuur].[Faktuurdatum])\"&gt;\n                              &lt;Aggregate AggType=\"MIN\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"COUNT_BIG([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                              &lt;Aggregate AggType=\"COUNT_BIG\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"SUM([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                              &lt;Aggregate AggType=\"SUM\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                        &lt;/DefinedValues&gt;\n                        &lt;HashKeysBuild&gt;\n                          &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;/HashKeysBuild&gt;\n                        &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.255\" EstimateIO=\"0.634196\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"27420\" LogicalOp=\"Index Seek\" NodeId=\"4\" Parallel=\"false\" PhysicalOp=\"Index Seek\" EstimatedTotalSubtreeCost=\"0.889196\"&gt;\n                          &lt;OutputList&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                          &lt;/OutputList&gt;\n                          &lt;RunTimeInformation&gt;\n                            &lt;RunTimeCountersPerThread Thread=\"0\" ActualRows=\"298726\" ActualEndOfScans=\"1\" ActualExecutions=\"1\" /&gt;\n                          &lt;/RunTimeInformation&gt;\n                          &lt;IndexScan Ordered=\"true\" ScanDirection=\"FORWARD\" ForcedIndex=\"false\" NoExpandHint=\"false\"&gt;\n                            &lt;DefinedValues&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                              &lt;/DefinedValue&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                              &lt;/DefinedValue&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/DefinedValue&gt;\n                            &lt;/DefinedValues&gt;\n                            &lt;Object Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Index=\"[_dta_index_tbl_Faktuur_5_583009158__K13_K9_K19_K2_5]\" /&gt;\n                            &lt;SeekPredicates&gt;\n                              &lt;SeekPredicate&gt;\n                                &lt;Prefix ScanType=\"EQ\"&gt;\n                                  &lt;RangeColumns&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                                  &lt;/RangeColumns&gt;\n                                  &lt;RangeExpressions&gt;\n                                    &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                      &lt;Const ConstValue=\"(0)\" /&gt;\n                                    &lt;/ScalarOperator&gt;\n                                  &lt;/RangeExpressions&gt;\n                                &lt;/Prefix&gt;\n                              &lt;/SeekPredicate&gt;\n                            &lt;/SeekPredicates&gt;\n                            &lt;Predicate&gt;\n                              &lt;ScalarOperator ScalarString=\"isnull([directpay].[dbo].[tbl_Faktuur].[Totaal_Open],($0.0000))&amp;lt;($0.0000) OR isnull([directpay].[dbo].[tbl_Faktuur].[Totaal_Open],($0.0000))&amp;gt;($0.0000)\"&gt;\n                                &lt;Logical Operation=\"OR\"&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Compare CompareOp=\"LT\"&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Identifier&gt;\n                                              &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                            &lt;/Identifier&gt;\n                                          &lt;/ScalarOperator&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                          &lt;/ScalarOperator&gt;\n                                        &lt;/Intrinsic&gt;\n                                      &lt;/ScalarOperator&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                      &lt;/ScalarOperator&gt;\n                                    &lt;/Compare&gt;\n                                  &lt;/ScalarOperator&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Compare CompareOp=\"GT\"&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Identifier&gt;\n                                              &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                            &lt;/Identifier&gt;\n                                          &lt;/ScalarOperator&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                          &lt;/ScalarOperator&gt;\n                                        &lt;/Intrinsic&gt;\n                                      &lt;/ScalarOperator&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                      &lt;/ScalarOperator&gt;\n                                    &lt;/Compare&gt;\n                                  &lt;/ScalarOperator&gt;\n                                &lt;/Logical&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Predicate&gt;\n                          &lt;/IndexScan&gt;\n                        &lt;/RelOp&gt;\n                      &lt;/Hash&gt;\n                    &lt;/RelOp&gt;\n                  &lt;/ComputeScalar&gt;\n                &lt;/RelOp&gt;\n              &lt;/ComputeScalar&gt;\n            &lt;/RelOp&gt;\n          &lt;/QueryPlan&gt;\n        &lt;/StmtSimple&gt;\n      &lt;/Statements&gt;\n    &lt;/Batch&gt;\n  &lt;/BatchSequence&gt;\n&lt;/ShowPlanXML&gt;\n</code></pre>\n\n<p><strong>Without ISNULL</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;ShowPlanXML xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" Version=\"1.0\" Build=\"9.00.5000.00\" xmlns=\"http://schemas.microsoft.com/sqlserver/2004/07/showplan\"&gt;\n  &lt;BatchSequence&gt;\n    &lt;Batch&gt;\n      &lt;Statements&gt;\n        &lt;StmtSimple StatementCompId=\"1\" StatementEstRows=\"1322.43\" StatementId=\"1\" StatementOptmLevel=\"FULL\" StatementOptmEarlyAbortReason=\"GoodEnoughPlanFound\" StatementSubTreeCost=\"0.274954\" StatementText=\"SELECT    debiteur_id, MIN(Faktuurdatum) AS OldestOpenInvoiceDate, ISNULL(SUM(Totaal_Open),0) AS TotalOpenAmount&amp;#xD;&amp;#xA;FROM    dbo.tbl_Faktuur &amp;#xD;&amp;#xA;WHERE   (Afgehandeld_NeeJa = 0 OR Afgehandeld_NeeJa IS NULL)&amp;#xD;&amp;#xA;--AND        (ISNULL(Totaal_Open,0) &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;AND        (Totaal_Open &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;GROUP BY debiteur_id\" StatementType=\"SELECT\"&gt;\n          &lt;StatementSetOptions ANSI_NULLS=\"false\" ANSI_PADDING=\"false\" ANSI_WARNINGS=\"false\" ARITHABORT=\"true\" CONCAT_NULL_YIELDS_NULL=\"false\" NUMERIC_ROUNDABORT=\"false\" QUOTED_IDENTIFIER=\"false\" /&gt;\n          &lt;QueryPlan CachedPlanSize=\"47\" CompileTime=\"9\" CompileCPU=\"9\" CompileMemory=\"528\"&gt;\n            &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.000132243\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"1322.43\" LogicalOp=\"Compute Scalar\" NodeId=\"0\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"0.274954\"&gt;\n              &lt;OutputList&gt;\n                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                &lt;ColumnReference Column=\"Expr1005\" /&gt;\n              &lt;/OutputList&gt;\n              &lt;ComputeScalar&gt;\n                &lt;DefinedValues&gt;\n                  &lt;DefinedValue&gt;\n                    &lt;ColumnReference Column=\"Expr1005\" /&gt;\n                    &lt;ScalarOperator ScalarString=\"isnull([Expr1004],($0.0000))\"&gt;\n                      &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Identifier&gt;\n                            &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                          &lt;/Identifier&gt;\n                        &lt;/ScalarOperator&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/Intrinsic&gt;\n                    &lt;/ScalarOperator&gt;\n                  &lt;/DefinedValue&gt;\n                &lt;/DefinedValues&gt;\n                &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.167304\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"1322.43\" LogicalOp=\"Aggregate\" NodeId=\"1\" Parallel=\"false\" PhysicalOp=\"Hash Match\" EstimatedTotalSubtreeCost=\"0.274822\"&gt;\n                  &lt;OutputList&gt;\n                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                  &lt;/OutputList&gt;\n                  &lt;MemoryFractions Input=\"0\" Output=\"0\" /&gt;\n                  &lt;Hash&gt;\n                    &lt;DefinedValues&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"MIN([directpay].[dbo].[tbl_Faktuur].[Faktuurdatum])\"&gt;\n                          &lt;Aggregate AggType=\"MIN\" Distinct=\"false\"&gt;\n                            &lt;ScalarOperator&gt;\n                              &lt;Identifier&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                              &lt;/Identifier&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/Aggregate&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"SUM([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                          &lt;Aggregate AggType=\"SUM\" Distinct=\"false\"&gt;\n                            &lt;ScalarOperator&gt;\n                              &lt;Identifier&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/Identifier&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/Aggregate&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                    &lt;/DefinedValues&gt;\n                    &lt;HashKeysBuild&gt;\n                      &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;/HashKeysBuild&gt;\n                    &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.030319\" EstimateIO=\"0.0771991\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"27420\" LogicalOp=\"Index Seek\" NodeId=\"2\" Parallel=\"false\" PhysicalOp=\"Index Seek\" EstimatedTotalSubtreeCost=\"0.107518\"&gt;\n                      &lt;OutputList&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                      &lt;/OutputList&gt;\n                      &lt;IndexScan Ordered=\"true\" ScanDirection=\"FORWARD\" ForcedIndex=\"false\" NoExpandHint=\"false\"&gt;\n                        &lt;DefinedValues&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                          &lt;/DefinedValue&gt;\n                        &lt;/DefinedValues&gt;\n                        &lt;Object Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Index=\"[_dta_index_tbl_Faktuur_5_583009158__K13_K9_K19_K2_5]\" /&gt;\n                        &lt;SeekPredicates&gt;\n                          &lt;SeekPredicate&gt;\n                            &lt;Prefix ScanType=\"EQ\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                  &lt;Const ConstValue=\"(0)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/Prefix&gt;\n                            &lt;EndRange ScanType=\"LT\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"($0.0000)\"&gt;\n                                  &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/EndRange&gt;\n                          &lt;/SeekPredicate&gt;\n                          &lt;SeekPredicate&gt;\n                            &lt;Prefix ScanType=\"EQ\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                  &lt;Const ConstValue=\"(0)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/Prefix&gt;\n                            &lt;StartRange ScanType=\"GT\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"($0.0000)\"&gt;\n                                  &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/StartRange&gt;\n                          &lt;/SeekPredicate&gt;\n                        &lt;/SeekPredicates&gt;\n                      &lt;/IndexScan&gt;\n                    &lt;/RelOp&gt;\n                  &lt;/Hash&gt;\n                &lt;/RelOp&gt;\n              &lt;/ComputeScalar&gt;\n            &lt;/RelOp&gt;\n          &lt;/QueryPlan&gt;\n        &lt;/StmtSimple&gt;\n      &lt;/Statements&gt;\n    &lt;/Batch&gt;\n  &lt;/BatchSequence&gt;\n&lt;/ShowPlanXML&gt;\n</code></pre>\n"},{"tags":["mysql","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13082066,"title":"to improve performance on query","body":"<p>I hava nest query:</p>\n\n<pre><code>SELECT PIXEL_X as 'X_Coord', PIXEL_Y as 'Y_Coord', \nCONVERTWATTS2DBM_udf(SUM(L2_VALUE)/SUM(L3_VALUE)) as 'Pixel_Value' \n   FROM table  \n   WHERE  \n      ('GSM 850/900' like CONCAT('%',FILTER2,'/%') OR \n       'GSM 850/900' like CONCAT('%/',FILTER2,'%') ) \nGROUP BY X_Coord, Y_Coord;\n</code></pre>\n\n<p>but takes a long time, could you help me to improve their performance?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","query","merge","duplicates","concatenation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13078062,"title":"Merging records with SQL, with some rules","body":"<p>I have a table with 4 records:</p>\n\n<pre><code>NAME    INSTRUMENT    BOOLEAN 1  BOOLEAN 2\nBob     Organ         TRUE       FALSE\nThomas  Violin        FALSE      FALSE\nBob     Piano         FALSE      TRUE\n</code></pre>\n\n<p>I want to merge records with same \"NAME\", in order to get  :</p>\n\n<pre><code>Bob     Organ Piano   TRUE       TRUE\nThomas  Violin        FALSE      FALSE\n</code></pre>\n\n<p>What's the rule that I want when merging ?</p>\n\n<ul>\n<li><p>\"text fields\" are just concatenated    (example : Organ + Piano ==> \"Organ Piano\")</p></li>\n<li><p>\"boolean fields\" are merged with a LOGICAL OR   (example : TRUE or FALSE = TRUE)</p></li>\n</ul>\n\n<p>My questions :</p>\n\n<p>1) I will choose which software to use in regard to the ability to do this!   Database with SQL queries (SQLite, MySQL or even Access)   or Excel ? </p>\n\n<p>2) If the best solution is a database,   what's the SQL query to do that ?</p>\n\n<p>Thanks a lot in advance!</p>\n"},{"tags":["php","mysql","query","phpmyadmin"],"answer_count":7,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":662,"score":5,"question_id":8536623,"title":"MySQL query works in phpmyadmin but not through php","body":"<p>Any ideas would help, I have been on this for a while now and just can't figure out what is wrong.</p>\n\n<p>Problem: query works fine until I added in the multiple word search which you can see bolded below. However, I echoed the sql query and then pasted in phpmyadmin and it worked perfectly but through the php it results with 0 records. It doesn't make any sense and I can't figure out what could be causing a result of 0.</p>\n\n<pre><code>SELECT \n        DISTINCT c.id \n    FROM \n        carpets AS c \n        INNER JOIN carpet_relations AS r1 ON c.id = r1.carpet_id \n        INNER JOIN carpet_relations AS r2 ON c.id = r2.carpet_id\n        INNER JOIN carpet_relations AS r3 ON c.id = r3.carpet_id\n    WHERE \n        c.active = '1' \n\n\n\n        AND ((c.title LIKE '%north tabriz%') OR **(c.title LIKE '%north%') OR (c.title LIKE '%tabriz%')** OR (c.item_no LIKE '%north tabriz%') OR **(c.item_no LIKE '%north%') OR (c.item_no LIKE '%tabriz%')** OR (c.pattern LIKE '%north tabriz%') OR **(c.pattern LIKE '%north%') OR (c.pattern LIKE '%tabriz%')** OR (c.period LIKE '%north tabriz%') OR **(c.period LIKE '%north%') OR (c.period LIKE '%tabriz%')** OR (c.country LIKE '%north tabriz%') **OR (c.country LIKE '%north%') OR (c.country LIKE '%tabriz%')**)\n\n        AND (c.width_feet BETWEEN '0' AND '22') \n        AND (c.width_inches BETWEEN '0' AND '11') \n        AND (c.height_feet BETWEEN '0' AND '49') \n        AND (c.height_inches BETWEEN '0' AND '11') \n    ORDER BY \n        c.item_no\n\n\nid  int(11) NO  PRI     NULL    auto_increment\nactive  int(11) NO      NULL    \ntitle   varchar(250)    NO      NULL    \nitem_no     varchar(250)    NO      NULL    \ncountry     varchar(250)    NO      NULL    \nperiod  varchar(250)    NO      NULL    \npattern     varchar(250)    NO      NULL    \nprice   float   NO      NULL    \nweb_special     float   NO      NULL    \nnotes   text    NO      NULL    \nwidth_feet  int(11) NO      NULL    \nwidth_inches    int(11) NO      NULL    \nheight_feet     int(11) NO      NULL    \nheight_inches   int(11) NO      NULL    \nrestrict    int(11) NO      NULL    \nviews_amount    int(11) NO      NULL    \nlast_modified   datetime    NO      NULL    \nmodified_by     int(11) NO      NULL\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13064117,"title":"Need help speeding up a MySQL query","body":"<p>I need a query that quickly shows the articles within a particular module (a subset of articles) that a user has NOT uploaded a PDF for. The query I am using below takes about 37 seconds, given there are 300,000 articles in the Article table, and 6,000 articles in the Module.</p>\n\n<pre><code>SELECT * \nFROM article a \nINNER JOIN article_module_map amm ON amm.article=a.id \nWHERE amm.module = 2 AND\n    a.id NOT IN ( \n        SELECT afm.article \n        FROM article_file_map afm \n        INNER JOIN article_module_map amm ON amm.article = afm.article \n        WHERE afm.organization = 4 AND \n            amm.module = 2 \n    ) \n</code></pre>\n\n<p>What I am doing in the above query is first truncating the list of articles to the selected module, and then further truncating that list to the articles that are not in the subquery. The subquery is generating a list of the articles that an organization has already uploaded PDF's for. Hence, the end result is a list of articles that an organization has not yet uploaded PDF's for. </p>\n\n<p>Help would be hugely appreciated, thanks in advance!</p>\n\n<p><strong>EDIT 2012/10/25</strong></p>\n\n<p>With @fthiella's help, the below query ran in an astonishing 1.02 seconds, down from 37+ seconds! </p>\n\n<pre><code>SELECT a.* FROM (\n    SELECT article.* FROM article \n    INNER JOIN article_module_map\n        ON article.id = article_module_map.article\n    WHERE article_module_map.module = 2\n) AS a\nLEFT JOIN article_file_map\n    ON a.id = article_file_map.article\n    AND article_file_map.organization=4\nWHERE article_file_map.id IS NULL\n</code></pre>\n"},{"tags":["php","mysql","query","table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13081132,"title":"Running two MySQL queries at a time in PHP mysql_query()","body":"<p>I need to use SELECT LAST_INSERT_ID() function of MySQL to get the ID of last inserted row .\nWhen I try to run this:-</p>\n\n<pre><code>  mysql_query(\"\n    INSERT INTO `posts`\n           (`user`, `body`, `time`, `pageID`)\n           VALUES('pachykutty', 'testMessage', '2012-10-26 04:59:43', 1);\n    SELECT LAST_INSERT_ID();\");\n</code></pre>\n\n<p>Gives me error. But When I run the two queries seperate like this:-</p>\n\n<pre><code>mysql_query(\"\nINSERT INTO `posts`\n       (`user`, `body`, `time`, `pageID`)\n       VALUES('pachykutty', 'testMessage', '2012-10-26 04:59:43', 1)\");\nmysql_query(\"SELECT LAST_INSERT_ID()\");\n</code></pre>\n\n<p>It is OK. I fear that If two clients ran the query same time, their LAST_INSERT_ID will conflict. So I want to run the two queries together without delay. Is there any Way?</p>\n"},{"tags":["query","search"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13080586,"title":"Search/Report Queries in Visual Studio (ASP.net Site)","body":"<p>My asp.net site linked to my access database needs to be able to allow the users to search;</p>\n\n<p>-By course code or course title\n-By course type\n-By course status\n-By courses which contain certain units\n-By a combination of these</p>\n\n<p>However I have no idea how to implement this. Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["query","postgresql","count","database-performance","postgresql-performance"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":71,"score":4,"question_id":13075210,"title":"Optimization of count query for PostgreSQL","body":"<p>I have a table in postgresql that contains an array which is updated constantly.</p>\n\n<p>In my application i need to get the number of rows for which a specific parameter is not present in that array column.  My query looks like this:</p>\n\n<pre><code>select count(id) \nfrom table \nwhere not (ARRAY['parameter value'] &lt;@ table.array_column)\n</code></pre>\n\n<p>But when increasing the amount of rows and the amount of executions of that query (several times per second, possibly hundreds or thousands) the performance decreses a lot, it seems to me that the counting in postgresql might have a linear order of execution (I’m not completely sure of this).</p>\n\n<p>Basically my question is:</p>\n\n<p>Is there an existing pattern I’m not aware of that applies to this situation? what would be the best approach for this?</p>\n\n<p>Any suggestion you could give me would be really appreciated.</p>\n"},{"tags":["php","mysql","ajax","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13079933,"title":"Many datbase calls that load less data or fewer database calls that load more data?","body":"<p>I have a website I'm working on that loads 8 rows of data by making an ajax call to a php content loader that calls my database each time the user hits a next button to load the new content.</p>\n\n<p>This method works very fast for me right now as a single user of the site. </p>\n\n<p>My question is though, if I have many users on the site, would it be better to load the next 16,32, etc rows of data up front when they hit next or keep the way it is now by loading in 8 rows each time they hit next? Does it matter?</p>\n"},{"tags":["mysql","query","join","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13079084,"title":"Subquery join and total dilemma again","body":"<p>So here is my latest endeaver .. trying to add the result of sub queries to get another field or total... but sumhow this <em>simple</em> syntax doesn't seem to work.. can somebody please point me to the right direction... thanks in advance</p>\n\n<pre><code>    SELECT \n    sub_events.name AS sub_event, \n    clients.name AS client, \n    divisions.name AS division, \n    subdivisions.name AS subdivision, \n    (SELECT CONCAT(name,' ',surname) FROM users WHERE id = bookings.host_id) AS host,\n    CONCAT(users.name,'  ',users.surname) AS name, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS flight, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 and itinerary_booking_id = 2 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS flight_change, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS hotel, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 and itinerary_booking_id = 3 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS hotel_change, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3  AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)  AS transfer, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS transfer_change\n    (SELECT SUM((SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 and itinerary_booking_id = 2 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 and itinerary_booking_id = 3 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3  AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL)) AS Total)\nFROM users \nJOIN bookings ON bookings.guest_id = users.id \nJOIN clients ON users.client_id = bookings.client_id \nJOIN details ON details.user_id = users.id \nJOIN divisions ON divisions.client_id = users.client_id \nJOIN subdivisions ON subdivisions.division_id = bookings.division_id \nJOIN sub_events ON sub_events.id = bookings.sub_event_id \nJOIN itineraries ON itineraries.booking_id = bookings.id \nGROUP BY bookings.id`\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13079846,"title":"How to group results of a query by 'less than equal to' grouping?","body":"<p>I need to have the count of all items with a specific status &lt;= a particular day. So if I group by 'day' then all the 'open' items till that day must be counted. So for the next 'day' it'd be a cumulative sum including the 'open' items from the previous day(s).</p>\n\n<p>Here's an example of the schema:</p>\n\n<p><img src=\"http://i.stack.imgur.com/LsO3d.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Query</strong>: How many items were in a specific status on a particular day?</p>\n\n<p><strong>Expected output:</strong></p>\n\n<pre>\n    day*| status | count\n    ---------------------\n     1  |  open  |  3\n     2  |  open  |  6 //3 today and 3 from the previous day\n     2  |  maybe |  1\n     2  |  agree |  2\n     2  |  open  |  6 //nothing new was 'open'\n     3  |  open  |  8 //2 new\n     3  |  agree |  4 //2 new\n\n*could also be date or some other format. Not a rule, but just for illustration\n</pre>\n\n<p>I'm quite stumped with how to formulate this. I'm sure you need a self (inner) join but I don't know on what to do the group-by and what exactly to count since it's a cumulative sum. I'm guessing I'd need some temporary variables and the like but not sure how to do this in MySQL. </p>\n"},{"tags":["sql","database","query","data","masking"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13079312,"title":"Measuring Data Masking Effectiveness","body":"<p>I'm in the process of analyzing how effective a vendor tool is at data masking a defined database. In order to objectively measure the effectiveness of the tool, I would be interested in examining the difference between the original data and the masked data. Is there an open source tool available for comparing data sets? I don't need to analyze whether there is a difference in the schema after the masking just the raw data. All suggestions are appreciated. Thank you in advance for your help.</p>\n"},{"tags":["android","eclipse","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13078835,"title":"SQLite \"no such table\"","body":"<p>I've made an Adnroid program in Eclipse that reads a csv file and inputs the info into an SQLite database, and using</p>\n\n<pre><code>dbCursor = database.query(DATABASE_TABLE, new String[]{KEY_ROWID, KEY_ITEMTYPE, KEY_QUANTITY},  null, null, null, null, null);  \n\n    int iRow = dbCursor.getColumnIndex(KEY_ROWID);\n    int iType = dbCursor.getColumnIndex(KEY_ITEMTYPE);\n    int iQuantity = dbCursor.getColumnIndex(KEY_QUANTITY);\n\n        for(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){\n            allData = allData + \" \" + dbCursor.getString(iRow) + \"\\t \" + dbCursor.getString(iType) + \"\\t\\t\\t \" + dbCursor.getString(iQuantity) + \"\\n\";      \n        }\n</code></pre>\n\n<p>and then printing out allData in a textview box has worked just fine.</p>\n\n<p>Then I wanted to use </p>\n\n<pre><code>dbCursor = database.rawQuery(\"SELECT KEY_ROWID , SUM(KEY_ITEMTYPE) FROM DATABASE_TABLE GROUP BY KEY_ROWID\", null);          \nfor(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){\n\n    allDataSum = allDataSum + \" \" + dbCursor.getString(0);\n} //I know this will probably not print what I want correctly but that's a problem for another day\n</code></pre>\n\n<p>When I try to print this I get the error \"10-25 22:06:35.016: I/Database(1911): sqlite returned: error code = 1, msg = no such table: DATABASE_TABLE\". </p>\n\n<p>I then opened DDMS File Explorer and copied the database onto my desktop and then tried viewing the database with a command tool but again got an error, \"SQL error: no such table: inventory\".</p>\n\n<p>How can the emulator show me what I want to see from .query() (but not from .rawQuery) when apparently there is no table in the database? Everything about I use the query and rawQuery is identical, so it's not a case of not opening the db for rawQuery or something like that. </p>\n"},{"tags":["mysql","query","data","record"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13078714,"title":"Many data to one record MYSQL","body":"<p>I have a table named medOrder. In this table I have orders. One order has many wishes. I tried to write a query that shows one record and all the names of the wishes but I don't think the query is as good as it  could be.</p>\n\n<pre><code>SELECT m.ordcode as koden, w.wish, r.meaName as rnamn, r.meaImg as bild, \n        r.meaPrice as pris, k.catName as cname from cats k, meals r, wishes w,\n        meaOrder m\n    join orders c on c.ordNR='7265'\n    WHERE m.ordNR=c.ordNR AND m.meaID=r.meaID AND m.wishesID=w.id\n        AND r.catID=k.catID\n    ORDER BY m.ordcode DESC;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/FgaNv.png\" alt=\"data schema\"></p>\n"},{"tags":["java","sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13078116,"title":"Best Practice - Building a query based on user selections","body":"<p>I am creating a small web based tool that allows users to query a large lookup table in various ways. Since its a small tool, I'm using JSP/Servlets. </p>\n\n<p>The lookup table has a definition something like this:</p>\n\n<p>column1 | column2 | column3 | date | user | count</p>\n\n<p>The user can query by column values or a range. Also, the results can be sorted by a specific column. Because the table has several hundred thousand of records, and growing rapidly, I'm using Oracle's ROWNUM and only returning a small subset of results.</p>\n\n<p>I have a form page that gets the search criteria from the user. I generate my query based on a series of conditions, for example:</p>\n\n<pre><code>query = \"SELECT * FROM mytable WHERE 1=1 \"\nif(searchCriteria1 != \"\")\n    query += \"AND column1='searchCriteria1' \"\nif(searchCriteria2 != \"\")\n    query += \"AND column2='searchCriteria2' \"\nif(searchCriteria2 != \"\")\n    query += \"AND column2='searchCriteria2' \"\nif(searchCriteria3 != \"\")\n    query += \"AND column3='searchCriteria3' \"\nif((searchCriteria4 != \"\") &amp;&amp; (searchCriteria5 != \"\"))\n    query += \"AND date&gt;='searchCriteria4' AND date&lt;='searchCriteria5' \"\netc...\n</code></pre>\n\n<p>(This is just simplified pseudo code)</p>\n\n<p>The sorting is handled after the first results page is displayed. The user clicks on the column header of that page to sort by that column. This would be doing a post back and querying the database. Basically, I run the same code above but with this at the end:</p>\n\n<pre><code>if(sortColumn1)\n    query += \"ORDER BY column1\"\nif(sortColumn2)\n    query += \"ORDER BY column2\"\nif(sortColumn3)\n    query += \"ORDER BY column3\"\n</code></pre>\n\n<p>So, as you might imagine, my query building code is very long with all these different conditions. Any suggestions on a better way to do this?</p>\n"},{"tags":["sql","query","sqlite","count","nested"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":84,"score":3,"question_id":13059892,"title":"simple sql query with count","body":"<p>I'm using SQLite.\nI need an help for an easy issue.\nHere's my three tables:</p>\n\n<pre><code>--------------\nproblem\n--------------\nid (primary key)\nquestion_id (foreign key)\n\n--------------\nquestion\n--------------\nid (primary key)\nanswer_id (foreign key)\n\n--------------\nanswer\n--------------\nid (primary key)\n</code></pre>\n\n<p>I would like to get ALL problems that have at least N answers in every question of a problem. I'll give you an example: </p>\n\n<pre><code>-------\nproblem\nid \n1\n2\n\n\n-------\nquestion \nid   problem_id\n1    1\n2    1\n3    1\n4    2\n\n-------\nanswer\nid   question_id\n1    1\n2    1\n3    1\n4    2\n5    2\n6    3\n7    4\n8    4\n</code></pre>\n\n<p>If n=2, my result should be problem_id=2.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>   select distinct question.problem_id \n   from answer, question\n   where answer.question_id = question.id\n   group by answer.question_id\n   having count(*) &gt;= 2\n</code></pre>\n\n<p>but it doesn't work because it gets problems with at least one question with at least 2 answers. All questions must satisfy that condition.</p>\n\n<p>Any problems?</p>\n"},{"tags":["sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13077797,"title":"Determine which join added row to result set","body":"<p>I started out with a question in this thread:\n<a href=\"http://stackoverflow.com/questions/12737572/need-sql-guru-for-a-complex-query\">Need SQL guru for a complex query</a></p>\n\n<p>I now have that solved (thanks to SO), but now need to extract a bit more data.</p>\n\n<p>Let's say I have a query that joins 2 other tables, where criteria in each of the three tables can cause a row to be added to the result set.  Something like:</p>\n\n<pre><code>    SELECT a.*\n    FROM tableA a\n    LEFT JOIN tableB b on a.b_id = b.id\n    LEFT JOIN tableC c on a.c_id = c.id\n    WHERE a.creator_id = 5 OR b.is_active = 1 OR c.can_attend = 1\n</code></pre>\n\n<p>Whatever the data is... basically what I need to do is determine, for each row in the result set, which criteria allowed it in.  Was it because creator_id was 5, or because it was active, etc.</p>\n\n<p>From this overly simplified example, you could say just look at the data, but notice the data for tables b and c are not being returned, and note that there are a variety of ways in which the join may add the row to the result set.</p>\n\n<p>What I am looking for, I think, is a way to inject a value when a row is added to the result set, or something to that effect.  Will make more sense if you look at the accepted answer in the linked question above.</p>\n\n<p>Thanks for any input!</p>\n"},{"tags":["sql","query","full-text-search","contains"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13058286,"title":"SELECT statement SQL Server (full text) similar to \"CONTAINS(column, 'term1 or term 2 or term3') AND NOT (anything else)\"","body":"<p>I have a full text search going with the following scenario:</p>\n\n<p>I'd like to look for rows containing exactly the terms I have specified, and nothing more. </p>\n\n<p>My column looks like:</p>\n\n<pre><code>        Col1\n        apples oranges grapes\n        apples oranges\n        apples strawberries\n        apples strawberries peaches\n        apples\n</code></pre>\n\n<p>But I want to search only for rows that contain apples and/or strawberries, and nothing else</p>\n\n<p>my result will look like:</p>\n\n<pre><code>1| apples strawberries\n2| apples \n</code></pre>\n\n<p>Thank you :)</p>\n"},{"tags":["query","cakephp","cakephp-2.1","avg"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13069353,"title":"CakePHP 2.1 Avg function for query","body":"<p>I am using cakephp 2.1 and I wanna get average of movie ratings for perticular movie.\nWhere 'Movie' is a model and it contains 'Language' and 'CriticReview' as models.\nThe array structure is as follows.</p>\n\n<pre><code>    array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'cover_image' =&gt; '/movies/4d0d1c41d956a2cb2ab93603d1fdf70c.jpg',\n        'release' =&gt; '2012-10-12',\n        'runtime' =&gt; '',\n        'budget' =&gt; '65 crore',\n        'box_office' =&gt; '',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4'\n        ),\n                    (int) 1 =&gt; array(\n                            'rating' =&gt; '3',\n                            'movie_id' =&gt; '4'\n                    )\n    )\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'cover_image' =&gt; '/movies/32aa2788fa5e1584d4c627c56214574e.jpg',\n        'release' =&gt; '2012-07-06',\n        'runtime' =&gt; '',\n        'budget' =&gt; '',\n        'box_office' =&gt; '',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'rating' =&gt; '6',\n            'movie_id' =&gt; '1'\n        ),\n                    (int) 1 =&gt; array(\n                            'rating' =&gt; '3',\n                            'movie_id' =&gt; '1'\n                    )\n    )\n));\n</code></pre>\n\n<p>So I have to avg of critic review. Please help me to find out the solution. The work will be appreciable.</p>\n"},{"tags":["ruby-on-rails","query","relationship","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13060036,"title":"Aggregate has_many With Another has_many Rails","body":"<p>I have the following models:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :subscriptions, as: :subscribable\n  has_many :user_to_high_school_subscriptions\n  has_many :high_school_subscriptions, through: :user_to_high_school_subscriptions\n\n  def all_subscriptions\n    self.subscriptions + self.high_school_subscriptions.subscriptions\n  end\nend\n\nclass UserToHighSchoolSubscription &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :high_school_subscription\nend\n\nclass HighSchoolSubscription &lt; ActiveRecord::Base\n  has_many :user_to_high_school_subscriptions\n  has_many :users, through: :user_to_high_school_subscriptions\n  has_many :subscriptions, as: :subscribable\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  belongs_to :subscribable, polymorphic: true\nend\n</code></pre>\n\n<p>Is there a clever way for me to get ALL <code>Subscription</code>s that a <code>User</code> has.</p>\n\n<p>I tried </p>\n\n<pre><code>u = User.first\nsubs = u.all_subscriptions\n</code></pre>\n\n<p>but that is erroring out (<code>undefined method subscriptions' for #&lt;ActiveRecord::Relation:</code>).  I think it's choking when I try to use the <code>has_many :subscriptions</code> on the <code>HighSchoolSubscription</code> because a <code>user</code> <code>has_many :high_school_subscriptions</code>. (This line: <code>self.high_school_subscriptions.subscriptions</code>).</p>\n\n<p>Is there a way to aggregate has_many on a has_many in Rails?</p>\n\n<p>Running rails 3.2.1 </p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13076565,"title":"table with multiple foreign keys joining 1 foriegn key in mysql","body":"<p>Hi I have a database table with the following information :</p>\n\n<pre><code>owner.primaryitowner, (bobsmith@mail.com)\nowner.secondaryitowner, \nowner.primarybusinessowner, \nowner.secondarybusinessowner\nusers.username (email bobsmith@mail.com)\nusers.displayname (e.g. Bob Smith)\n</code></pre>\n\n<p>The issue, is the owners are only stored as emails. There is another table I normally </p>\n\n<p><code>inner join users on users.username = owner.primaryitowner to get users.displayname</code> \nso the data reads correctly.` </p>\n\n<p>I am able to do this</p>\n\n<pre><code>select u.displayname\nfrom users u\ninner join owners o on\n    o.primaryitowner = u.username\n    or o.secondaryitowner = u.username\n    or o.primarybusinessowner = u.username\n    or o.secondarybusinessowner = u.username\n</code></pre>\n\n<p>The issue is I need to have unique columns not all into one column. </p>\n\n<p>PS I cannot change the database I am only a report writer.</p>\n\n<p>Thanks so much in advance</p>\n"},{"tags":["c#","asp.net","query","session","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":13076336,"title":"Compare data from two columns from data table against variables in ASP.NET C#","body":"<p><strong>So I am practicing using a databases with ASP.Net...</strong></p>\n\n<p>I have two datatable columns from Northwind database. One is <code>Product.ProductID</code> and the other is <code>Product.UnitsInStock</code>. I need to compare that with a collection (SortedList) of objects. Essentially comparing variables Product ID and quantity(client side). The objects are a <code>ICollection</code> Value saved in a <code>Session[\"cart\"]</code>. </p>\n\n<p>How can I compare the variables I have of product id and units in stock against the DataTable columns 1 is Products.ProductID and second column is Products.UnitsInStock?</p>\n\n<p>Here is the query and roughly how I thought I could grab these variables from the database.</p>\n\n<pre><code>DataTable dt = new DataTable();\n\nif (dt.Columns.Count != 0 &amp;&amp;\n       dt.Rows.Count != 0)\n    {\n        int quantityOfUnit = 0;\n        int productID = 0;\n        for (int index = 0; index &lt; dt.Columns.Count; index++)\n        {\n            if (index == indexOfUnitsInStock)//indexOfUnitsInStock = 1\n            {\n                quantityOfUnit = int.Parse(dt.Rows[0][index].ToString());\n            }\n            else//index = 0\n            {\n                productID = int.Parse(dt.Rows[0][index].ToString());\n            }\n        }\n</code></pre>\n\n<p>Building a new query:</p>\n\n<pre><code>foreach (object items in ((ShoppingCart)Session[\"cart\"]).Values)\n    {\n        OleDbConnection conn = new OleDbConnection((string)Application[\"DBConnectionString\"]);\n    string selectionString =\n        \"SELECT Products.ProductID, Products.UnitsInStock \" +\n            \"FROM Products\" +\n            \"WHERE Products.ProductID = \" +\n            ((ShoppingCart)Session[\"cart\"]).Values;\n    DataTable dt = new DataTable();\n    try\n    {\n        OleDbCommand cm = new OleDbCommand(selectionString, conn);\n        OleDbDataAdapter da = new OleDbDataAdapter();\n        da.SelectCommand = cm;   \n        da.Fill(dt);\n        da.Dispose();\n    }\n    catch(Exception ex)\n    {\n        txtUnderstockedItems.Text = \"There was a problem connecting to the database: \" + ex.Message ;\n    }\n    finally\n    {\n        conn.Close();\n    }\n    }\n</code></pre>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13068753,"title":"Alternatives to using SQL IN in this query","body":"<p>I have a string holding comma separated values = value1, value2, value3 .......</p>\n\n<p>I want to perform following operation:</p>\n\n<pre><code>SELECT col FROM table WHERE col IN :values\n</code></pre>\n\n<p>This works fine if values have less than 1000 entries. It gives error when values have more than 1000 entries. There is a limit on usage of IN.</p>\n\n<p>Is there any alternative way to perform this query? </p>\n\n<p>EDIT: \nIt is Oracle's Business Intelligence Publisher application. Customer/User can use any database underneath.</p>\n\n<p>I do not have control over database. So I cannot create a temp table or stored procedure. All I can do is select multiple values from UI screen (it forms comma separated string) and use it in a SQL query. Depending on which reports are generated.</p>\n\n<ul>\n<li>Cannot use EXISTS with static string values.</li>\n<li>Cannot use stored procedure or temp table.</li>\n</ul>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13075505,"title":"MySql: is it possibile to 'SUM IF' or to 'COUNT IF'?","body":"<p>I have a column 'hour'\nI have a column 'kind'  (it can be 1,2 or 3)</p>\n\n<p>I'd like to do something like: </p>\n\n<pre><code>SELECT count(id), SUM(hour) as totHour, SUM( IF ( kind = 1, 1, 0 ) ) as countKindOne\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SELECT count(id), SUM(hour) as totHour, COUNT( IF ( kind = 1 ) ) as countKindOne\n</code></pre>\n\n<p>But mysql tell me I've an error... what's the error !?</p>\n\n<p>PLEASE SEE THIS stackoverflow topic : <a href=\"http://stackoverflow.com/questions/9083283/mysql-sum-if-field-b-field-a\">MySQL SUM IF field b = field a</a></p>\n\n<p>.. I'm not able to reply this ... </p>\n"},{"tags":["mysql","query","cpu-usage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13075403,"title":"mySQL query killed the server","body":"<p>I am trying to find duplicate entries on a column so they can be fixed in preparation for creating a unique index on that column.  The database currently has around 4.5mil records.</p>\n\n<p>The query I used was:</p>\n\n<pre><code>SELECT `sig`, COUNT(*) c FROM `info` GROUP BY `sig` HAVING c &gt; 1;\n</code></pre>\n\n<p>This immediately locked me out of the server and the remote admin had to reboot it to restore function.  My question is, is there another better option for finding duplicates?  Some other way to mitigate the effect of the query?</p>\n"},{"tags":["php","mysql","regex","query"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13075058,"title":"Using reg ex in PHP to query MYSQL","body":"<p>I am trying to query a MYSQL database using regular expressions. I am looking to get the values under columns with this pattern 1234X32X12.</p>\n\n<p>I have written some pseudo-code, but I am unfamiliar with regular expressions, so I was hoping someone could help me out.</p>\n\n<p><strong>CODE:</strong> </p>\n\n<pre><code>if ($transposed_array[$i][0] starts with number)\n    {\n        $sid = regex something /^[0-9]*/\n        $gid = regex something /X[0-9]*X/\n        $gid = remove first and last character from $gid\n        $qid = regex something /[0-9]*$/\n\n        $question_text = mysql_query(\"select question from table where sid = \".$sid.\" and gid = \".$gid.\" and qid = \".$qid.\" limit 1\");\n        $transposed_array[$i][0] = $question_test\n    }\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["php","string","query",".htaccess","mod-rewrite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13073976,"title":"htaccess rewrite issue within subdirectory and using varibales... stumped","body":"<p>I have searched and searched and tried soo many different things that just didnt work... It is beyond me. I've tried at least 50 things with no luck.. someone please help!</p>\n\n<p>First I have a a file \"index.php\" page within the folder /blog that has a link that passes variables to a page called \"post\".. The MySQL in the \"post.php\" page pulls the MySQL data from row that matches ID and displays that specific post.</p>\n\n<p>What I am trying to do is have a much cleaner and SEO friendly URL...</p>\n\n<p>For example:\non the \"www.mydomain.com/blog/index.php\" page they click a link like \"post?title=This%20is%20a%20test%20title%20for%20the%20blog%20post...&amp;id=1\" which takes them to the \"post.php\" page in the same directory as the \"index.php\" page in \"/blog/\"..</p>\n\n<p>Every single htaccess rewrite I have found is not changing the URL to a much friendlier version at all.. everything ends up staying the same.. </p>\n\n<p>Someone please help. I would like it to show as www.mydomain.com/blog/title rather than showing the above! If anyone could help me remove the \"%\" that appear in post titles for spaces and replace with \"-\" that would be really great too.. </p>\n\n<p>::desperate::\nThanks again, \nAdam</p>\n\n<p>Currently Using this in a htaccess file located in the \"blog/\" directory.</p>\n\n<pre><code>Options +FollowSymLinks -MultiViews\nRewriteEngine On\nRewriteBase /\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,}\\s([^.]+)\\.php [NC]\nRewriteRule ^ %1 [R=301,NC,L]\nRewriteCond %{REQUEST_FILENAME}.php -f\nRewriteRule ^ %{REQUEST_URI}.php [L]\nRewriteEngine On\nRewriteCond %{HTTP_HOST} ^mydomain.com/blog/$ [NC]\nRewriteRule ^(.*)$ http://www.mydomain.com/blog/$1 [R=301,L]\nRewriteEngine On\nRewriteRule ^([^/]*)/([^/]*)$ /post?title=$1&amp;id=$2 [QSA,L]\n</code></pre>\n"},{"tags":["ruby-on-rails","query","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13073005,"title":"Order a merged DataMapper query and limit the number of records returned","body":"<p>Currently I have a query that DOES order my result set the way I want it, but I would like to limit the number of records returned. I am aware of limit in DataMapper but this has not worked for me because I am limiting each query return rather than the merged return. This is my query:</p>\n\n<pre><code> @activities = current_user.followed_users.activities(:order =&gt; [:created_at.desc]) + current_user.followed_centers.activities(:order =&gt; [:created_at.desc])\n</code></pre>\n\n<p>This merges the result set and orders them correctly. However, does anyone know if I can limit the return size of the merged result set? i.e if I said limit => 2... this would get the 2 newest activities either by a user or/and center.</p>\n"},{"tags":["mysql","sql","database","query","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13074062,"title":"mysql dump copy new and changed data to DB","body":"<p>I have a DB which is 60 GB and I have a live DB which is 13 GB , now on the live DB there are some new entries and updated entries too. Consider 13GB DB has same initial data which 60 GB has with some rows updated and last few entries are completely new. No I want to copy that 13 GB to 60 GB. I have the dump but the insert commands and when I try to import it, it shows me the forign key constarained error and says it canot delete or update. So I need a query for mysql import so that it will copy the new data and update the new if any, and also the dump file is regular dump file with create, insert all those and it is not possible to change anything inside it :(</p>\n"},{"tags":["sql","sql-server","database","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":13072992,"title":"Avoid \"SELECT TOP 1\" and \"ORDER BY\" in Queries","body":"<p>I have the very table in sql server 2008 with lot of data</p>\n\n<pre><code>|ID|Name|Column_1|Column_2|\n|..|....|........|........|\n</code></pre>\n\n<p>more than 18,000 records. So i need to the the row with the lowest value of <code>Column_1</code> that is date but could by any data type (that is unsorted) so I use these sentence</p>\n\n<pre><code>SELECT TOP 1 ID, Name from table ORDER BY Column_1 ASC\n</code></pre>\n\n<p>But this is very very slow. And i think that i don't need to to sort the whole table. My question es how to get the same date with out using <code>TOP 1</code> and <code>ORDER BY</code></p>\n"},{"tags":["query","email"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3019,"score":4,"question_id":3024819,"title":"How do I check if an email address is valid without sending anything to it?","body":"<p>I have a client with 5000 emails from an old list he has that he wants to promote his services to. He wants to know which emails on the list are still valid. I want to check them for him - without sending out 5K emails randomly and then being listed as a spammer or something. Ideas?</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":17,"score":-1,"question_id":13073651,"title":"Sql server Query to get the Table Altered Result","body":"<p>I have a table as below  </p>\n\n<pre><code>ClientID        AccountNumber   BalanceOnDay0       BalanceOnDay1   BalanceOnDay2       BalanceOnDay3       BalanceOnDay4       BalanceOnDay5       BalanceOnDay6       BalanceOnDay7\nABC1            123             10                  NULL            NULL                NULL                NULL                NULL                NULL                NULL    \nABC1            123             NULL                NULL            NULL                NULL                NULL                NULL                NULL                3       \n</code></pre>\n\n<p>I would like to see the result as beblow.  </p>\n\n<pre><code>ClientID        AccountNumber   BalanceOnDay0       BalanceOnDay1   BalanceOnDay2       BalanceOnDay3       BalanceOnDay4       BalanceOnDay5       BalanceOnDay6       BalanceOnDay7\nABC1            123             10                  NULL            NULL                NULL                NULL                NULL                NULL                3\n</code></pre>\n\n<p>Please suggest!</p>\n"},{"tags":["mysql","sql","query","index"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13072004,"title":"How to query in Mysql Index","body":"<p>I created a index of my employees Name. \nBut know I don´t know how to query that index, how do I query an Index? </p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12966873,"title":"MySQL: Why is NULL ignored in MySQL?","body":"<p>I have a table with the following possible values for the column field_value.</p>\n\n<p>But when I try to select all values which are not 'CB', the query result also ignores all NULL values.</p>\n\n<p>Why does this happen? </p>\n\n<pre><code>mysql&gt; select distinct field_value from TableName;\n+--------------+\n| field_value  |\n+--------------+\n| S            |\n| NULL         |\n| CA           |\n| CB           |\n+--------------+\n4 rows in set (6.32 sec)\n\nmysql&gt; select distinct field_value from TableName where field_value!='CB';\n+--------------+\n| field_value  |\n+--------------+\n| S            |\n| CA           |\n+--------------+\n2 rows in set (0.15 sec)\n\nmysql&gt;\n</code></pre>\n"},{"tags":["database","query","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":83,"score":4,"question_id":13048988,"title":"MS Access : Average and Total Calculation in Single Query","body":"<p><strong>INTRODUCTION TO DATABASE TABLE BEING USED -</strong></p>\n\n<p>I am working on a “Stock Market Prices” based Database Table. My table has got the data for the following FIELDS –</p>\n\n<p>ID</p>\n\n<p>SYMBOL</p>\n\n<p>OPEN</p>\n\n<p>HIGH</p>\n\n<p>LOW</p>\n\n<p>CLOSE</p>\n\n<p>VOLUME</p>\n\n<p>VOLUME CHANGE</p>\n\n<p>VOLUME CHANGE %</p>\n\n<p>OPEN_INT</p>\n\n<p>SECTOR</p>\n\n<p>TIMESTAMP</p>\n\n<p>New data gets added to the table daily “Monday to Friday”, based on the stock market price changes for that day. The current requirement is based on the “VOLUME “field, which shows the volume traded for a particular stock on daily basis.</p>\n\n<p><strong>REQUIREMENT –</strong>\nTo get the Average and Total Volume for last 10,15 and 30 Days respectively.</p>\n\n<p><strong>METHOD USED CURRENTLY -</strong>\nI created these 9 SEPARATE QUERIES in order to get my desired results –\nFirst I have created these 3 queries to take out the most recent last 10,15 and 30 dates from the current table.\n  qryLast10DaysStored\n  qryLast15DaysStored\n  qryLast30DaysStored</p>\n\n<p>Then I have created these 3 queries for getting the respective AVERAGES\n  qrySymbolAvgVolume10Days\n  qrySymbolAvgVolume15Days\n  qrySymbolAvgVolume30Days</p>\n\n<p>And then I have created these 3 queries for getting the respective TOTALS\n  qrySymbolTotalVolume10Days\n  qrySymbolTotalVolume15Days\n  qrySymbolTotalVolume30Days\n**\nPROBLEM BEING FACED WITH CURRENT METHOD -**\nNow, my problem is that I have ended up having these so many different queries, whereas I wanted to get the output into One Single Query, <strong>as shown in the Snapshot of the Excel Sheet.</strong></p>\n\n<p><a href=\"http://i49.tinypic.com/256tgcp.png\" rel=\"nofollow\">http://i49.tinypic.com/256tgcp.png</a></p>\n\n<p><strong>SOLUTION NEEDED -</strong>\nIs there some way by which I can get these required fields into ONE SINGLE QUERY, so that I do not have to look into multiple places for the required fields? Can someone please tell me how to get all these separate queries into one -\nA) Either by taking out or moving the results from these separate individual queries to one.\nB)** Or by making a new query which calculates all these fields within itself, so that these separate individual queries are no longer needed. This would be a better solution I think.**</p>\n\n<p><strong>One Clarification about Dates –</strong> Some friend might think why I used the method of using Top 10,15 and 30 for getting the last 10,15 and 30 Date Values. Why not I just used the PC Date for getting these values? Or used something like -  (\"VOLUME\",\"tbl-B\", \"TimeStamp BETWEEN Date() - 10 AND Date()\")\nThe answer is that I require my query to \"Read\" the date from the \"TIMESTAMP\" Field, and then perform its calculations accordingly <strong>for  LAST / MOST RECENT \"10 days, 15 days, 30 days”  FOR WHICH THE DATA IS AVAILABLE IN THE TABLE, WITHOUT BOTHERING WHAT THE CURRENT DATE IS. It should not depend upon the current date in any way.</strong></p>\n\n<p><strong>If there is any better method  or more efficient way to create these queries, then please enlighten.</strong></p>\n\n<p>Thanks a lot :)</p>\n\n<p>PS : I have attached a SAMPLE database which has the data for 6 months,  from 1 Nov 2011 to 30 April 2012 and it has also got the above mentioned queries in it.\n<a href=\"http://limelinx.com/448h\" rel=\"nofollow\">Sample Database with QUERIES</a></p>\n"},{"tags":["php","wordpress","query","if-statement","echo"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13072691,"title":"PHP/Wordpress - Including an IF function inside an Echo","body":"<p>I have the following WordPress query:</p>\n\n<pre><code>$my_query = new WP_Query($args);\nif ($my_query-&gt;have_posts()) {\n    echo '&lt;div class=\"' . $tax_term-&gt;slug . '\" style=\"display:none; background:url(' . $whatdoiputhere . ');\"&gt;';\n    while ($my_query-&gt;have_posts()) : $my_query-&gt;the_post();\n</code></pre>\n\n<p>In the background URL, I need to include an image URL that is generated by the following code:</p>\n\n<pre><code>&lt;?php if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); ?&gt;\n</code></pre>\n\n<p>How would I include this IF function inside the background URL?</p>\n\n<p>I tried this but as you can guess it didn't work:</p>\n\n<pre><code>background:url(' . if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); . ');\n</code></pre>\n\n<p>Would appreciate some help as to how I would do this.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13071766,"title":"SQL Server - Get highest values when previous date not blank","body":"<p>I have a table that contains information for player's steps taken for any given day, I want to get the 3 highest totals from the database, when the day before the day of the high total has a value added to it for that player. Since some players are not logging everyday, but rather lumping multiple days into one update.</p>\n\n<p>Data Structure:</p>\n\n<pre><code>|---------------------------------------------------------------|\n| id | player_id | steps | date       | submitted               |\n|----|-----------|-------|------------|-------------------------|\n| 1  | 16        | 5718  | 2012-09-06 | 2012-09-10 08:31:35.000 |\n| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |\n| 3  | 16        | 10432 | 2012-09-09 | 2012-09-10 08:30:54.000 |\n| 4  | 30        | 3973  | 2012-09-07 | 2012-09-10 09:34:42.000 |\n| 5  | 30        | 7104  | 2012-09-08 | 2012-09-10 09:35:05.000 |\n| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |\n| 7  | 9         | 6437  | 2012-09-07 | 2012-09-10 09:39:15.000 |\n| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |\n|---------------------------------------------------------------|\n</code></pre>\n\n<p>So what I want to return are the rows:</p>\n\n<pre><code>|---------------------------------------------------------------|\n| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |\n| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |\n| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |\n|---------------------------------------------------------------|\n</code></pre>\n\n<p>My query is currently:</p>\n\n<pre><code>SELECT TOP 3 p.name,\n             player_id,\n             steps,\n             date\nFROM   steppers_step_log\n       JOIN steppers_players P\n         ON player_id = P.id\nORDER  BY steps DESC \n</code></pre>\n\n<p>Which does not take into account whether there is an entry for the date prior on the top 3 from steps, which with my query in its current form will return 10432, 10916, and 9837 as the top steps.</p>\n\n<p>I am having trouble working out how to do the WHERE command to make sure that the previous day has an entry for that player_id and would appreciate any help in getting it working.</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":133,"score":7,"question_id":11509707,"title":"MySQL - Search PHP script","body":"<p>I'm currently coding my own CMS and I'm at the point of the <code>search.php</code>. I need to search in 4 tables that haves different columns name within only one query because my server is not the fastest.</p>\n\n<p>There's my DB arrangement:</p>\n\n<p><code>cmw_admin</code> (users table)</p>\n\n<pre><code>+-----------------+------------+------+-----+---------+----------------+\n| Field           | Type       | Null | Key | Default | Extra          |\n+-----------------+------------+------+-----+---------+----------------+\n| id              | int(11)    | NO   | PRI | NULL    | auto_increment |\n| role            | int(11)    | NO   |     | 1       |                |\n| username        | text       | NO   |     | NULL    |                |\n| password        | text       | NO   |     | NULL    |                |\n| email           | text       | NO   |     | NULL    |                |\n| phone           | text       | NO   |     | NULL    |                |\n| location        | text       | NO   |     | NULL    |                |\n| full_name       | text       | NO   |     | NULL    |                |\n| bio             | text       | NO   |     | NULL    |                |\n| website         | text       | NO   |     | NULL    |                |\n| last_login      | datetime   | NO   |     | NULL    |                |\n| registered_date | datetime   | NO   |     | NULL    |                |\n| registered_ip   | text       | NO   |     | NULL    |                |\n| credits         | tinyint(1) | NO   |     | NULL    |                |\n| online          | int(11)    | NO   |     | 0       |                |\n+-----------------+------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_blog</code> (articles table)</p>\n\n<pre><code>+------------+----------+------+-----+---------+----------------+\n| Field      | Type     | Null | Key | Default | Extra          |\n+------------+----------+------+-----+---------+----------------+\n| id         | int(11)  | NO   | PRI | NULL    | auto_increment |\n| title      | text     | NO   |     | NULL    |                |\n| content    | text     | NO   |     | NULL    |                |\n| date       | datetime | NO   |     | NULL    |                |\n| author     | int(11)  | NO   |     | NULL    |                |\n| categories | text     | NO   |     | NULL    |                |\n| media      | text     | NO   |     | NULL    |                |\n| thumb      | text     | NO   |     | NULL    |                |\n+------------+----------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_projects</code> (portfolio)</p>\n\n<pre><code>+-------------+------------+------+-----+---------+----------------+\n| Field       | Type       | Null | Key | Default | Extra          |\n+-------------+------------+------+-----+---------+----------------+\n| id          | int(11)    | NO   | PRI | NULL    | auto_increment |\n| owner_id    | int(11)    | NO   |     | NULL    |                |\n| title       | text       | NO   |     | NULL    |                |\n| content     | text       | NO   |     | NULL    |                |\n| date        | date       | NO   |     | NULL    |                |\n| link        | text       | NO   |     | NULL    |                |\n| img         | text       | NO   |     | NULL    |                |\n| type        | int(11)    | NO   |     | NULL    |                |\n| start_date  | date       | NO   |     | NULL    |                |\n| end_date    | date       | NO   |     | NULL    |                |\n| done        | tinyint(1) | NO   |     | 0       |                |\n| screenshots | text       | NO   |     | NULL    |                |\n+-------------+------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_services</code> (services table)</p>\n\n<pre><code>+-------------+---------------+------+-----+---------+----------------+\n| Field       | Type          | Null | Key | Default | Extra          |\n+-------------+---------------+------+-----+---------+----------------+\n| id          | int(11)       | NO   | PRI | NULL    | auto_increment |\n| cat_id      | int(11)       | NO   |     | NULL    |                |\n| name        | text          | NO   |     | NULL    |                |\n| description | text          | NO   |     | NULL    |                |\n| img         | text          | NO   |     | NULL    |                |\n| price       | decimal(11,2) | NO   |     | NULL    |                |\n+-------------+---------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>In my search, I need to search for string in every <code>name</code>/<code>title</code> columns and in all <code>description</code>/<code>content</code> columns too. In clear, I want to search all those table for one string, in only one query. Is that possible? I know that using <code>JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code> and <code>INNER JOIN</code> may be easy but I don't know how to use them. Google is not very explicit on that things!</p>\n"},{"tags":["mysql","sql","database","query","ms-access"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13069977,"title":"Very slow querying in Access, Can a SQL server do any better","body":"<p>I am working on MSAccess to quickly load the data and perform some analysis.\nSince the data exceeds over 200,000 records, it gets really very slow and takes for ever or never returns a result. I know that this is expected.</p>\n\n<p>Does installing a SQL server (freely availalbe) like MySQL do better in this scenario?\n(even for a million similar records)</p>\n\n<p>I cannot ask for paid software to perform analysis.</p>\n"},{"tags":["string","query",".htaccess","redirect","append"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13066142,"title":"htaccess Redirect if query string variable present","body":"<p>I need to add <code>style=2</code> to all urls within a directory ONLY if the url does NOT already contain <code>style=2</code>. </p>\n\n<p>Within the directory root, I have an .htaccess with the following:</p>\n\n<pre><code>RewriteCond %{QUERY_STRING} !(?style=|&amp;style=)\nRewriteRule ^(.*)$ %1&amp;style=2? [R=301,QSA]\n</code></pre>\n\n<p>I know it's wrong. Can anyone help?</p>\n"},{"tags":["sql","sql-server","query","backup"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13069025,"title":"SQL backup loop","body":"<p>I've built a backup query in SSMSE 2005 and saved as a text query.</p>\n\n<p>Is there a way to loop through DB and write each as a unique file?</p>\n\n<p>What I've done is copy/paste and find/replace database_name and run both in a single pass.  That works, but would like either:</p>\n\n<p>Run a single loop script which backs up each DB individually OR \nBatch backup from the SSMSE GUI</p>\n\n<pre><code>BACKUP DATABASE [ION_Data_Nov08] TO DISK =\nN'C:\\Documents and Settings\\DB.control\\Desktop\\ION Database Backups\\121025_0700\\ION_Data_Nov08'\nWITH noformat, init, name = N'ION_Data_Nov08-Full Database Backup', skip,\nnorewind, nounload, stats = 10 \n\ngo\n\nDECLARE @backupSetId AS INT \n\nSELECT @backupSetId = position\nFROM   msdb..backupset\nWHERE  database_name = N'ION_Data_Nov08' \n        AND backup_set_id = (SELECT Max(backup_set_id)\n                             FROM   msdb..backupset\n                            WHERE  database_name = N'ION_Data_Nov08')\n\n IF @backupSetId IS NULL\n   BEGIN\n       RAISERROR(\nN'Verify failed. Backup information for database ''ION_Data_Nov08'' not found.',\n 16,1)\nEND\n\n RESTORE verifyonly FROM DISK =\n  N'C:\\Documents and Settings\\DB.control\\Desktop\\ION Database Backups\\121025_0700\\ION_Data_Nov08'\n WITH FILE = @backupSetId, nounload, norewind\n\ngo\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13041605,"title":"Rails: How to fetch records that are 2 'has_many' levels deep?","body":"<p>I have these models set up:</p>\n\n<pre><code>Course\n  has_and_belongs_to_many Student\n\nStudent\n  has_and_belongs_to_many Course\n  has_many Books\n\nBook\n  belongs_to Student\n</code></pre>\n\n<p>How do I efficiently get all the Books for a Course with ActiveRecord?</p>\n"},{"tags":["mysql","sql","query","many-to-many"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":69,"score":1,"question_id":13063497,"title":"Mysql many-to-many realtionship multiple condition","body":"<p>I have three tables, for example:</p>\n\n<p>watch table</p>\n\n<pre><code>id(int)  name(varchar)  ref(int)\n1        tissot         1234567\n2        addidas        7654321\n3        nike           8976543\n</code></pre>\n\n<p>property table</p>\n\n<pre><code>id(int)  name(varchar)\n1        water_resistant\n2        material_body\n3        material_bracelet\n4        watch_type\n</code></pre>\n\n<p>property_material table</p>\n\n<pre><code>watch_id  property_id   value\n1              1          200\n1              2         steel\n1              3         leather\n1              4         quartz\n2              1          50\n2              2         plastic\n2              3         leather\n2              4         quartz\n3              1         100\n3              2         steel\n3              3         rubber\n3              4        mechanical\n</code></pre>\n\n<p>I want get all watches which have properties for example: </p>\n\n<ul>\n<li>water_resistant >= 100</li>\n<li>material_body = steel or plastic</li>\n<li>material_bracelet = leather or rubber</li>\n<li>watch_type = quartz.</li>\n</ul>\n\n<p>Help me please create query. Properties can be about 100.\nIn ideal i want get result:</p>\n\n<pre><code>watch_id name    ref   water_res mat_body mat_bracelet watch_type\n1        tissot  1234   200       steel    leather      quartz\n</code></pre>\n\n<p>I'm try: </p>\n\n<pre><code>select \n w.*, pm.value,pm.property_id \nfrom \n watch w \njoin \n  property_material pm \n on w.id = pm.watch_id \nwhere \n  pm.pid in (1,2,3) \nand \n pm.value in ('100','Steel','Leather');\n</code></pre>\n\n<p>But this query return all records, when value is Steel or Leather, bur I need where material_body is Steel and material_bracelet is Leather, for example.</p>\n\n<p><strong>UPDATE</strong>: What you are think about this query?</p>\n\n<pre><code>select \n  name, ref \nfrom\n  watch w\njoin\n(SELECT w.id\n  FROM watch w\n  JOIN property_material pm on w.id = pm.watch_id\n  WHERE (pm.property_id = 1 AND pm.value &gt; 100)\n   OR (pm.property_id = 2 AND pm.value IN ('steel','plastic'))\n   OR (pm.property_id = 3 AND pm.value IN ('leather','rubber'))\n   OR (pm.property_id = 4 AND pm.value = 'quartz')\n  Group by w.id\n  Having count(*) = 4) as t1\n on t1.id = w.id;\n</code></pre>\n\n<p><strong>LAST UPDATE</strong>:</p>\n\n<pre><code>select \n  w.name, \n  max(if(pm.property_id='1',pm.value,'')) water_resistant,\n  max(if(pm.property_id='2',pm.value,'')) material_body,\n  max(if(pm.property_id='3',pm.value,'')) material_bracelet,\n  max(if(pm.property_id='4',pm.value,'')) watch_type\nfrom\n  watch w\njoin\n(\n    SELECT w.id\n  FROM watch w\n       JOIN property_material pm on w.id = pm.watch_id\n  WHERE (pm.property_id = 1 AND pm.value &gt; 100)\n      OR (pm.property_id = 2 AND pm.value IN ('steel','plastic'))\n      OR (pm.property_id = 3 AND pm.value IN ('leather','rubber'))\n      OR (pm.property_id = 4 AND pm.value = 'quartz')\n  Group by w.id\n  Having count(*) = 4\n  ) as t1 on t1.id = w.id\n join property_material pm on w.id = pm.watch_id\nGROUP BY w.id\n</code></pre>\n"},{"tags":["php","mysql","query","insert"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13067121,"title":"MySQL: Get a return result from an INSERT SELECT","body":"<p>I have query that INSERTS both explicit values and SELECTd content. I'm also doing basic incrementing.</p>\n\n<pre><code>INSERT INTO `table` (`myID`, `myVal1`, `myVal2`) SELECT `myID` + 1, 'explValHere', 'otherValThere')\nFROM `table` ORDER BY `myID` DESC LIMIT 0,1\n</code></pre>\n\n<p>I am doing this as the table has multiple id's and incrementing within a specific column. So I can't, as you would first say, use auto incrementing and insert_id.</p>\n\n<p>The problem of course is the insert doesn't return the select, but can it? Is there a way of running this insert query and returning any of the result?</p>\n"},{"tags":["facebook","query","chat","history","fql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12094464,"title":"FQL Query for getting Chat conversation","body":"<p>Here is the code. In the result I want to see my conversation and my friend conversation. For conversation history functionality How can I do this? </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT message_id, thread_id, author_id, body, created_time, viewer_id \nFROM message WHERE thread_id IN \n(SELECT thread_id, subject, recipients FROM thread WHERE folder_id =0 )\nAND author_id = 'xxxxxxxxxxxxxxx' ORDER BY created_time DESC LIMIT 0,25\n</code></pre>\n\n<p>This code returns only my friend data.</p>\n"},{"tags":["c#","linq","query","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13064614,"title":"LINQ query... How to perform?","body":"<p>Say I got next sequence:</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</code></pre>\n\n<p>I need make next thing with Linq:</p>\n\n<pre><code>1,2;\n2,3;\n3,4;\n4,5;\n...\n9,10;\n</code></pre>\n\n<p>Can't get it.</p>\n"},{"tags":["sql","oracle","query","entity-attribute-value"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13064378,"title":"Oracle, Can't get details from the same column","body":"<p>I have a table named PARAMETER looking like this:</p>\n\n<pre><code>ID - number\nNAME - varchar2\nVALUE - varchar2\n</code></pre>\n\n<p>I have this query witch is 'extracting' the date from the string:</p>\n\n<pre><code>SELECT * from PARAMETER\nwhere (NAME = 'From') and SUBSTR(VALUE, 1, 2)&gt;='01' \nand SUBSTR(ALUE, -7, 5)&gt;='11' and SUBSTR(VALUE, -4, 4) &gt;='2012'\n</code></pre>\n\n<p>Now I need to run it again changing only: <code>where (NAME = 'From')</code>  to  <code>where (NAME = 'To')</code></p>\n\n<p>and compare the results. I can't find a way to do this. Is there a trick?</p>\n"},{"tags":["performance","query","optimization","expressionengine"],"answer_count":6,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":139,"score":9,"question_id":13041463,"title":"What's the optimal amount of queries an ExpressionEngine page should load?","body":"<p>I saw @parscale tweet: <a href=\"https://twitter.com/parscale/status/260808185424781312\">How many queries are you happy with for a home page? When do you say this is Optimized?</a></p>\n\n<p>I saw responses that &lt; 50 is good, 30 or less is best, and 100+ is danger zone. Is there really any proper number? And if say you do have > 50 queries running on your pages, what are some ways to bring it down?</p>\n\n<p>I generally have sites that run the gamut that are under 50 queries and some more, though the \"more\" don't seem to be too slow, I'm always interested in making it faster. How?</p>\n"},{"tags":["sql","query","jpa-2.0","java-ee-6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13065801,"title":"How can I convert this SQL Query into JPA Query?","body":"<p>I have a query like that:</p>\n\n<pre><code>Select p.* from MyTable p where \nid = 1 and version = (select MAX(version) from MyTable where id=1)\n</code></pre>\n\n<p>I try to convert it into JPA Query. How should it be?</p>\n\n<pre><code>select e from MyTable e where e.id=:id and version=(Select max(e.version) from MyTable e where e.id=:id) \n</code></pre>\n\n<p>Is it correct?</p>\n\n<p>Can I use for both id parameters the same name. (id) and handle them with only one setParameter?</p>\n"},{"tags":["query","ms-access","report"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13066392,"title":"I have a view-query in ms-access that has an order by sum(sells) and it works; The same query is not working in a report","body":"<p>When it runs into a report a dialog window opens to ask me for the \"sum(sells)\" variable as it didn't know what it was. The query is exactly the same as the view and the view shows correct data but the report don't.</p>\n\n<p>How might I fix?</p>\n"},{"tags":["query","prolog","stackoverflow","nfa"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12747324,"title":"Prolog query infinite search","body":"<p>I am a beginner to Prolog and I would like to ask a question about Prolog.</p>\n\n<p>My program is based on non-deterministic finite-state automaton.</p>\n\n<p>the start state is <strong>S0</strong> and the final state is <strong>S3</strong>.</p>\n\n<p>The diagram is</p>\n\n<p><img src=\"http://i.stack.imgur.com/LwhI7.png\" alt=\"enter image description here\"></p>\n\n<p>so if there is a string <code>[a,a,b,b,c,c]</code> it should be like</p>\n\n<pre><code>start(s0) \nedge(a, s0, s0) \nedge(a, s0, s1) \nedge(b, s1, s1) \nedge(b, s1, s2) \nedge(c, s2, s2) \nedge(c, s2, s3) \nfinal(s3)\n</code></pre>\n\n<p>There is a predicate <code>accepts(Ls)</code> if (there <code>Ls</code> is a list of string)</p>\n\n<pre><code>accepts (Ls) :- start(A), goesTo(Ls, A, B), final(B)\n</code></pre>\n\n<p>and assuming that the NFA goes from state <strong>Si</strong> to state <strong>Sj</strong> and in between them there is a state <strong>Sk</strong>, <code>goesTo</code> predicate is defined as</p>\n\n<pre><code>goesTo (Ls, Si, Sj) :- edge (L, Si, Sk), goesTo(Ls, Sk, Sj)\n</code></pre>\n\n<p>But if querying <code>accepts(Ls)</code> (any arbitrary list of string ranging from <code>a</code> to <code>c</code>)\nthe tutorial question says that it will almost certainly go into an infinite search and stack overflow will occur.</p>\n\n<p>However, I don't understand why the query will go into an infinite search and cause stack overflow. If you can give me the reason, it would be really great!</p>\n\n<p><em><strong>(edit:)</em></strong> the exact quote is:</p>\n\n<blockquote>\n  <p>\"a typical Prolog user might hope that his/her goesTo rules would be such tat the query accepts(X) would generate successive strings that are accepted by the NFA above. Almost certainly, given the above presentation of the given NFA, the Prolog system will go into an infinite search and stack overflow will occur. Say why this is so. (if your goesTo avoid this problem, say how you managed to avoid it).\"</p>\n</blockquote>\n"},{"tags":["mysql","performance","query","select-query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13048951,"title":"I need to speed up specific mysql query on large table","body":"<p>Hi I know there is a lot of topics dedicated to query optimizing strategies, but this one is so specific I couldnt find the answer anywhere on the interenet.</p>\n\n<p>I have large table of product in eshop (appx. 180k rows) and the table has 65 columns. Yeah yeah I know its quite a lot, but I store there information about books, dvds, bluerays and games.</p>\n\n<p>Still I am not considering a lot of cols into query, but the select is still quite tricky. There are many conditions that need to be considered and compared. Query below</p>\n\n<pre><code>SELECT *\nFROM products\nWHERE production = 1 \nAND publish_on &lt; '2012-10-23 11:10:06' \nAND publish_off &gt; '2012-10-23 11:10:06' \nAND price_vat &gt; '0.5' \nAND ean &lt;&gt; ''\nAND publisher LIKE '%Johnny Cash%'\nORDER BY bought DESC, datec DESC, quantity_storage1 DESC, quantity_storege2 DESC, quantity_storage3 DESC\nLIMIT 0, 20\n</code></pre>\n\n<p>I have already tried to put there indexes one by one on cols in where clause and even in order by clause, then I tried to create compound index on (production, publish_on, publish_off, price_vat, ean). </p>\n\n<p>Query is still slow (couple of seconds) and it need to be fast since its eshop solution and people are leaving as they are not getting their results fast. And I am still not counting the time I need to perform the search for all found rows so I can make paging.</p>\n\n<p>I mean, the best way to make it quick is to simplify the query, but all the conditions and sorting is a must in this case. </p>\n\n<p>Can anyone help with this kind of issue? Is it even possible to speed this kind of query up, or is there any other way how I can for example simplify the query and leave the rest on php engine to sort the results.. </p>\n\n<p>Oh, Iam really clueless in this.. Share your wisdom peple, please...</p>\n\n<p>Many thanks in advance</p>\n"},{"tags":["sql","query","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13064040,"title":"Pivot table in sql server 2005","body":"<p>This is my record in my table </p>\n\n<pre><code>GuestName      F1    H1    F2  H2  F3   H3\nRyan Palma     1200  Room  12  SC  14   VAT\nRichard Palma  1500  Room  15  SC  17   VAT\nRuth Palma     1600  Room  16  SV  18   VAT\n</code></pre>\n\n<p>I want an output like this</p>\n\n<pre><code>GuestName      Room  SC  VAT\nRyan Palma     1200  12  14\nRichard Palma  1500  15  17\nRuth Palma     1600  16  18\n</code></pre>\n\n<p>How can i do this using query,</p>\n\n<p>Thanks in advance, any help is appreciated</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13064062,"title":"hyphen in sql query is causing the issue","body":"<p>i am trying to query from database asking for data with this filter. i want that the word which is after not like not to exist in my result query. but my result is still having the that word. </p>\n\n<pre><code>select * from table where titel not like '%word-word%'\n</code></pre>\n\n<p>but i am still getting the query where the title has the word <code>'word-word'</code>. </p>\n\n<p>do i have to escape the query for <code>'-'</code></p>\n\n<p>is there any difference between <code>like</code> and <code>not like</code> in this sense ? </p>\n"},{"tags":["mysql","query","index"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13063943,"title":"mysql performance & index","body":"<p>I have 5 relation tables like </p>\n\n<pre><code>ID | FK_USER | FK_POST | DATE\n</code></pre>\n\n<p>Is it faster and efficient to user separate tables for each type of relation, or to create just one table like</p>\n\n<pre><code>ID | FK_USER | FK_POST | TYPE | DATE\n</code></pre>\n\n<p>where type is an Enum, and I put an INDEX on TYPE ?</p>\n\n<p>Assume that I search about \"subscription\" (which is one of my relation types) Is it faster to use separate table and search on it, or use combined table and add \"<code>where TYPE = 1</code>\" to query string?</p>\n"},{"tags":["c#","sql","linq","query","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13062518,"title":"How to convert IEnumerable to EntitySet","body":"<p>I have got way to convert <code>IEnumerable</code> to <code>EntitySet</code>. But I'm facing some issue in calling the function.</p>\n\n<p>My class is a sealed public class, so I have added extension method in separate static class within the same namespace.</p>\n\n<pre><code> public static class Conversion\n    {\n        public static EntitySet&lt;T&gt; ToEntitySet&lt;T&gt;(this IEnumerable&lt;T&gt; source) where T : class\n        {\n            var es = new EntitySet&lt;T&gt;();\n            es.AddRange(source);\n            return es;\n        }\n    }\n</code></pre>\n\n<p>My query is in sealed class, how can i call this method from my query. Here is my sql query</p>\n\n<pre><code>var p1 = (from v in dc.ptable\n                          where v.PtableId == ps.input.Id.Value\n                          select new DBModel\n               {\n\n                   MEntetyset = (v.Menteties.Where(t =&gt; t.Delf == null))\n\n               });\n</code></pre>\n\n<p>Kindly help. thanks in advance</p>\n"},{"tags":["java","mysql","query","procedure"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13063289,"title":"Mysql update query/procedure","body":"<p>I have a table with 2 columns, user and userMessage with table name as <strong>Messages</strong>\nI have another table with 2 columns as user and userMessageCount with table name as <strong>MessageCount</strong>.\nI am very new to programming. I need to write an update query or procedure something that will count the number of messages per user from <strong>Messages</strong> and store the count in <strong>MessageCount</strong>.</p>\n\n<p>I am not able to understand the proper way of doing this. I understand this is a very basic question and I should study to solve this. i am running very late for a deadline. Please help me on this query.</p>\n"},{"tags":["c#","oracle","query"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3540,"score":0,"question_id":1542594,"title":"Insert, Update, Delete for Oracle are not working in .NET C#?","body":"<p>It has been a while that i'm dealing with oracle and .net and they don't seem to be a perfect match together. That's this strange thing, i'm not finding any reason why it happens or how to fix it.</p>\n\n<p>I do simple insert, update and delete and they are not working. It fails on the </p>\n\n<pre><code>cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>Here's the piece of code:</p>\n\n<pre><code>sqlCommand = string.Format(@\" INSERT INTO TABLE_1\n                              (ID, NAME, DESCRIPTION)\n                              VALUES ((SELECT MAX(ID)+1 FROM TABLE_1),'{0}','{1}')\", name, description);\n\nusing (OracleConnection conn = new OracleConnection(connectionString))\n{\n OracleCommand cmd = new OracleCommand(sqlCommand, conn);\n cmd.CommandType = commandType;\n\n try\n {\n  conn.Open();\n  result = cmd.ExecuteNonQuery();                    \n }\n catch (Exception ex) { throw;}\n finally\n {\n  conn.Close();\n }\n</code></pre>\n\n<p>a simple insert, right?! when i debug, i get the cmd.Text value (that would be the sqlCommand), and i do execute it in the oracle db, it goes just fine. As i go the point of executing it in .Net it gives up. </p>\n\n<p>Is this a known situation? Is there any solution, any explanation for it?</p>\n\n<p>Thnx in advance</p>\n"},{"tags":["sql","query","duplicates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13062986,"title":"How to delete duplicate values from fields in SQL?","body":"<p>I have two tables (cd catalogs lets say) in my SQL DB. I want to put records from one table (that gets re-created nightly) into my main table. I only want to put items with a quantity greater than 0 into the main table. However, some items in the nightly table will have the same UPC barcode field as those in the main table. I do not want to put these in, provided those already in the main table have a quantity greater than 0. Otherwise I want all the entries with quantities greater than 0 to go from nightly to main table.</p>\n\n<p>I simply can't wrap my head around how to do this. Of course I have it set up now so that everything with a quantity>0 gets copied to the main table, but then that means I can have duplicate listings for the same item that was already in the main table (duplicates based on UPC).</p>\n\n<p>Anyone know how I can do this? My query as it stands:</p>\n\n<pre><code>INSERT INTO main ( id, title, artist, qty, barcode ) \nSELECT nightly.PID, \n       nightly.Title, \n       nightly.Artist, \n       nightly.QtyAvail, \n       nightly.UPC \nFROM nightly \nWHERE nightly.QtyAvail &gt; 0;\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":11560713,"title":"Generate insert script for selected records?","body":"<p>I have a table with the following data:</p>\n\n<pre><code>Pk_Id  ProductName           Fk_CompanyId       Price\n------------------------------------------------------\n1      AMX                   1                  10.00\n2      ABC                   1                  11.00\n3      APEX                  1                  12.00\n4      AMX                   1                  10.00\n5      ABC                   1                  11.00\n6      APEX                  1                  12.00\n7      AMX                   2                  10.00\n8      ABC                   2                  11.00\n9      APEX                  2                  12.00\n</code></pre>\n\n<p>I want to generate Insert script for migrating records whose Fk_CompanyId is 1.</p>\n\n<p>There is an insert script option to generate script for all records but I want to filter some records to migrate to another database.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13062133,"title":"MySQL query and count from other table","body":"<p>I would like to get the data from one table, and count all results from other table, depending on the first table data, here is what I tried:</p>\n\n<pre><code>SELECT\n    cars.*, (\n        SELECT\n            COUNT(*)\n        FROM\n            uploads\n        WHERE\n            uploads.cid = cars.customer\n    ) AS `count`,\nFROM\n    `cars`\nWHERE\n    customer = 11;\n</code></pre>\n\n<p>I dont really have an idea why its not working, as I'm not a regular MySQL user/coder...</p>\n\n<p>Could anyone direct me in the right direction with this one?</p>\n"},{"tags":["sql","database","query","sqlite3","aggregate-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13058721,"title":"How to select rows with max values on a certain column","body":"<p>For example, I have</p>\n\n<pre><code>tab1:\natt1|att2\nA|3\nB|4\nC|3\nD|4\nE|1\nF|2\n</code></pre>\n\n<p>And I want</p>\n\n<pre><code>B|4\nD|4\n</code></pre>\n\n<p>I know I can use</p>\n\n<pre><code>SELECT att1 att2\nFROM tab1 as T\nWHERE T.att2 =\n(\n   SELECT MAX(att2) FROM tab1;\n}\n</code></pre>\n\n<p>I wondering if there is a more clever way to do it. B/c if it takes a complicated query to get tab1, it is cumbersome to write it twice.\nBy the way, I am using Sqlite.</p>\n"},{"tags":["php","mysql","arrays","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":596,"score":0,"question_id":7985114,"title":"MYSQL Delete Where Field is Not Part of Array","body":"<p>I have a table \"groupdentlink\" where I want to delete all the rows that weren't checked in a form. </p>\n\n<p>In essence I want to perform a query like:</p>\n\n<pre><code>DELETE * FROM groupdentlink\nWHERE group_id = 'a'\nAND dentist_id IS NOT IN ARRAY 'b'\n</code></pre>\n\n<p>I think I could set a variable with a foreach loop and then keep adding the array values to it so I end up with:</p>\n\n<pre><code>DELETE * FROM groupdentlink\nWHERE group_id = 'a'\nAND dentist_id != 'D1'\nAND dentist_id != 'D5'\nAND dentist_id != 'D8'\n</code></pre>\n\n<p>...and so on.</p>\n\n<p>But is this really the right/best way to do this?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["query","sql-server-2012","results"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13061343,"title":"Getting SQL Procedure ResultSet Information","body":"<p>for SQL Server 2012, Any idea how to get the results from a SQL stored procedure without running it?</p>\n\n<p>Closest I found find is from sp_depends which has a selected but it gives me results even when its in the where statement.</p>\n\n<p>Hoping to find a way to find what columns are selected, but not in where statement</p>\n\n<p>Lemme rephrase a little bit..</p>\n\n<p>I dont need the data, just what columns it returns, so I can create my result classes via a T4</p>\n"},{"tags":["query","xdocument"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13061221,"title":"using Linq to query XDocument keeps throwing Null pointer exception","body":"<p>How do I use Linq to query an xml doc? When I use the code below the \"where\" clause is throwing \"Object reference not set to an instance of an object.\". Specifically, I think the node is null. Please help!</p>\n\n<p>My xml looks like this:</p>\n\n<pre><code>&lt;qbo:QboCompanyPreferences xmlns=\"http://www.intuit.com/sb/cdm/v2\" xmlns:qbp=\"http://www.intuit.com/sb/cdm/qbopayroll/v1\" xmlns:qbo=\"http://www.intuit.com/sb/cdm/qbo\"&gt;\n  &lt;qbo:Preference&gt;\n    &lt;Name&gt;TaxAccountId&lt;/Name&gt;\n    &lt;Value&gt;34&lt;/Value&gt;\n  &lt;/qbo:Preference&gt;\n  &lt;qbo:Preference&gt;\n    &lt;Name&gt;TaxPercent&lt;/Name&gt;\n    &lt;Value&gt;4.5%&lt;/Value&gt;\n  &lt;/qbo:Preference&gt;\n&lt;/qbo:QboCompanyPreferences&gt;\n</code></pre>\n\n<p>I'm using XDocument like this:</p>\n\n<pre><code>XDocument doc = XDocument.Parse(serviceResponse);\nstring taxNodeName = \"TaxPercent\";\nXNamespace qbo = \"http://www.intuit.com/sb/cdm/qbo\";\n\nvar Preference = (from node in doc.Descendants(qbo + \"Preference\")\n                        where node.Element(\"Name\").Value == taxNodeName\n                        select node).FirstOrDefault();\n\nResponse.Write(Preference.ToString());\n</code></pre>\n"},{"tags":["query","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13061067,"title":"Repeated Query API vs. Storing in DB","body":"<p>I'm new to programming in general, and I'm trying to learn a lot.</p>\n\n<p>Here's my question: When querying an external DB using an API, when is it appropriate to actually store the data internally vs. continually querying. For example, if I want to query multiple sets of data for multiple users, it seems like loadtime will be very slow. </p>\n\n<p>At the same time, it seems excessive to store a ton of data on my own db. </p>\n\n<p>Sorry for the ambiguity here - I know this is very theoretically-heavy topic. Just wanted to get some insight here!</p>\n\n<p>Thanks for the responses</p>\n"},{"tags":["query","excel","vba","export"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13059900,"title":"Having trouble exporting multiple MS Access 2010 queries to MS Excel 2010 from one \"Form Load\" or \"Form Open\"","body":"<p>I tried this several different ways but it keeps stopping after the first one. I tried adding other forms, form 1 to run one on open, then form 1 opens form 2 which runs one export etc but that didn't work. I tried pausing, <code>do while not isloaded(next form)</code> etc but that didn't work.</p>\n\n<pre><code>Option Compare Database\nPrivate Sub Form_Load()\nOn Error GoTo Err_Form_Load\n\n'I tried 9\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\n\n'I tried 12 and 12XML\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllFilteredABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\n\n'I tried it as a function\n'see function below the three exports\n\nCall exportData(\"All-FilteredABC\", _\n\"Y:\\Projects\\Folders\\All-FilteredABC.xlsx\")\nCall exportData(\"AllActiveABC\", _\n\"Y:\\Projects\\Folders\\AllActiveABC.xlsx\")\nCall exportData(\"AllABC\", _\n\"Y:\\Projects\\Folders\\AllABC.xlsx\")\n\n\nFunction exportData(queryName As String, strSaveFileName As String)\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, queryName, strSaveFileName, True \n\nEnd Function\n</code></pre>\n\n<p>No luck. I am so confused by all the things I've tried and the different outcomes I've had like, creating a new blank sheet in the existing workbook but with an _1 at the end, stopping after one export, exporting them all but all blank.</p>\n"},{"tags":["java","query","data","dynamically-generated"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13056902,"title":"Use a db table to control from 5 to several hundred subroutine callsfrom one location","body":"<p>There is one thought of including code like this in a Jave application.</p>\n\n<pre><code>Evaluate External Type Code\nWhen 1 \n  Call L.Services Parm1, Parm2, Parm3,Parm4, Parm5, Parm6\nWhen 2 \n  Call T.Services Parm1, Parm2, Parm3\nWhen 3 \n  Call C.Services Parm1, Parm2, Parm3,Parm4, Parm5, Parm6\nWhen 4\n  Call D.Services Parm1, Parm2\nWhen 4\n  Call X.Services Parm1, Parm2, Parm3,Parm4, Parm5\nWhen other\n  Call Invalid\nEnd Evaluate\n</code></pre>\n\n<p>There will be likely additions of calls added over the development cycle.  I haven't developed anything in Java, my experience is mainframe assembler, COBOL, PL/1, and database applications.\nThe Parm fields can be to/from and there will be a different number of parms for each subroutine.</p>\n\n<p>I know this can be done in assembler, C and PL/1 however Java?</p>\n\n<p>My preference would be to have a small table with the name of the called routine and a list of all the parameters.<br>\nThis would allow the query of the CALL Table with the CALL ID to return the routine name and all parmaters. (as an array?)\nWith this method, there would not be any code changes in the controlling module to add new functionallity, only an insert into the CALL Table.</p>\n\n<p>Can this be done in Java?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13060176,"title":"MS Access SQL Query - Showing total number of orders in a certain year","body":"<p>Me again. SQL appears to be more complex than I anticipated. My problem: for each customer, I would like to show the Customer ID and the total number of orders placed in 2011.</p>\n\n<p>My table looks like this</p>\n\n<pre><code>Table: Order_t\nOrder_ID    Order_Date    Customer_ID\n--------    ----------    -----------\n1001        10/21/2011    1\n1002        10/25/2011    8\n1003        10/26/2011    15\n1004        10/27/2011    5\n1005        11/24/2011    3\n1006        11/27/2011    2\n1007        11/28/2011    11\n1008        12/3/2011     12\n1009        12/5/2011     1\n1010         1/16/2012    4\n</code></pre>\n\n<p>I would like my query to display a table like this:</p>\n\n<pre><code>Customer_ID    Orders_Placed\n-----------    -------------\n1              2\n2              1\n3              1\n5              1\n8              1\n11             1\n12             1\n15             1\n</code></pre>\n\n<p>My current query is this (I am currently completely neglecting the Date part because I haven't even figured out the grouping yet:</p>\n\n<pre><code>SELECT Customer_ID, SUM(Order_ID) AS Orders_Placed\nFROM Order_t\nGROUP BY Order_ID, Customer_ID\n</code></pre>\n\n<p>And this is my obviously wrong query: </p>\n\n<pre><code>Customer_ID    Orders_Placed\n-----------    -------------\n1              1001\n8              1002\n15             1003\n5              1004\n3              1005\n2              1006\n11             1007\n12             1008\n1              1009\n4              1010\n</code></pre>\n\n<p>Thanks for help, but I would also like to understand where the problem is in my logic. What crucial part do I seem to not understand?</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","google-app-engine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13059763,"title":"Fetch a table from a url and store it in Google App Engine or Cloud Storage and using it with Big Query","body":"<p>I'm new to Google App Engine. Hope someone can help with my query.</p>\n\n<p>I want to scrap a table containing a stock's historical prices in Yahoo Finance or Google Finance using urlfetch and store it in Google Storage. Data needs to be refreshed regularly. </p>\n\n<p>I want to use BigQuery to query on prices on certain dates, find averages etc. similar to GoogleQuery in Google Apps. I have done this on Google Apps using Importhtml, ImportXml and GoogleQuery but I have concerns about filesize, execution limits etc. Hence, I want to migrate to Google App Engine.</p>\n"},{"tags":["sql","database","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13059732,"title":"MS Access SQL Query - Showing Total Quantity of product ordered by most popular","body":"<p>I have a table (Order_line_t) with the following format:</p>\n\n<pre><code>Order_ID    Product_ID    Quantity\n--------    ----------    --------\n1001        1             2\n1001        2             2\n1001        4             1\n1002        3             5\n1003        3             1\n1004        6             2\n1004        8             2\n1005        4             4\n1006        1             1\n1006        5             2\n1006        7             2\n1007        1             3\n1007        2             2\n1008        3             2\n1008        8             3\n1009        4             2\n1009        7             3\n1010        8             10\n</code></pre>\n\n<p>My goal is to show the total quantity that has been ordered by descending popularity for each product like this: (I used my current query and clicked on Descending Filter for Column Total_Quantity to achieve this result)</p>\n\n<pre><code>Product_ID    Total_Quantity\n----------    --------------\n8             15\n4             8\n3             8\n7             5\n1             5\n2             4\n6             2\n5             2\n</code></pre>\n\n<p>I have been trying to figure this out for 3 hours, and I don't know where I my error is. My current SQL Query is this:</p>\n\n<pre><code>SELECT  Product_ID, SUM(Quantity) AS Total_Quantity\nFROM Order_line_t\nGROUP BY Product_ID\n</code></pre>\n\n<p>My Query result is this:</p>\n\n<pre><code>Product_ID    Total_Quantity\n----------    --------------\n1             5\n2             4\n3             8\n4             8\n5             2\n6             2\n7             5\n8             15\n</code></pre>\n\n<p>Thanks in advance, I am just beginning to learn SQL. Please bear with me.</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13058861,"title":"What will happen if I kill a huge MySQL InnoDb DELETE Query?","body":"<p>I'm currently running a <code>DELETE</code> query that is taking a lot longer than expected (already 10hrs!). I would like to kill it through phpmyadmin processes, however am concerned about what might happen. Will the roll-back he automatically does take a lot of time also? Current query status shows \"updating\".</p>\n"},{"tags":["php","mysql","database","query","mongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":89,"score":0,"question_id":12235369,"title":"A lot of queries with \"or\"","body":"<p>I'm trying to convert a database from MySQL to MongoDB but I have a problem. I do not know how the query should look for MongoDB.</p>\n\n<pre><code>   $hd='';\n   $count = count($args[1]);\n   for($i=0;$i&lt;$count-1;$i++){\n       $hd.=\"playerId='\" . $args[1][$i] . \"' OR \";\n   }\n   $hd.=\"playerId='\".$args[1][$count-1].\"'\";\n   $h1=mysql_query(sprintf(\"SELECT * FROM player where \".$hd));\n</code></pre>\n\n<p>Anyone know how to fix it?</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13058646,"title":"INSERT with SELECT works once","body":"<p>I have 3 tables on my SQLite db as follow:</p>\n\n<p>TABLE first_names</p>\n\n<pre><code>id\nname\ngender\n</code></pre>\n\n<p>TABLE last_names</p>\n\n<pre><code>id\nname\n</code></pre>\n\n<p>TABLE names</p>\n\n<pre><code>id\nfirst\nlast\ngender\nbirthday (null)\nused (default 0)\n</code></pre>\n\n<p>Where first and last are unique and also have a index with both being unique on the names table.</p>\n\n<p>In order to fed names table I have used the below query, which worked the first time but after I had added a new name to the last_names and tried to use it again it failed.</p>\n\n<pre><code>INSERT INTO names (first, last, gender) \n       SELECT f.name AS first, l.name AS last, f.gender AS gender \n              FROM first_names f \n              LEFT JOIN last_names l \n              WHERE f.name NOT IN (SELECT first FROM names) AND \n                    l.name NOT IN (SELECT last FROM names)\n</code></pre>\n\n<p>Have also tried using <code>(first, last, gender, [birthday], [used])</code> with values as <code>null AS [birthday], 0 AS [used]</code> but since it birthday is set to null on the table design and used to 0 as default and it worked on the first time didnt think it would be needed nor it made any difference anyway.</p>\n\n<p>I would think it is because of the unique fields however I do have a WHERE to make sure the names are not already in the table names.</p>\n\n<p>I have tried the query using C# and SQLiteAdmin both executing without requesting result or else it doesnt work.</p>\n\n<p>What is wrong with my query and why it only works once ?</p>\n"},{"tags":["php","mysql","database","query","website"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13057480,"title":"Updating information into a MySQL Database using PHP","body":"<p>Within my code, I'm attempting to update my database with values from modifiable text fields in a form. However, when the query is ran, it wipes all fields (turning them to \"\") related to the record the user is attempting to edit. Can anyone see why at all?</p>\n\n<pre><code>&lt;?php\n$dbuser = 'test';\n$dbpass = 'test';\n$host = '127.0.0.1';\n$db = 'test';\nmysql_connect($host, $dbuser, $dbpass) or die(mysql_error());\nmysql_select_db($db) or die(mysql_error());\n\n$result = mysql_query(\"SELECT * from characters\");\n$id = $_REQUEST['combo'];\nwhile($row = mysql_fetch_array($result))\n{\n    if($id == $row['_Key'])\n    {\n        echo \"&lt;form action=\\\"webpagetests.php\\\" method=\\'post\\'&gt;\";\n        echo \"&lt;strong&gt;Player ID:&lt;/strong&gt;    \" . $row['_Key'] . \"&lt;/br&gt;\";\n        echo \"&lt;strong&gt;Steam Name:&lt;/strong&gt;   \" . $row['_SteamName'] . \"&lt;/br&gt;\";\n        echo \"&lt;strong&gt;Steam ID:&lt;/strong&gt;     \" . $row['_SteamID'] . \"&lt;/br&gt;&lt;/br&gt;\";\n\n        echo \"Name: &lt;/br&gt;&lt;input name = \\\"name\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Name'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Cash: &lt;/br&gt;&lt;input name = \\\"cash\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Cash'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Flags: &lt;/br&gt;&lt;input name = \\\"flags\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Flags'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Gender:&lt;/br&gt; &lt;input name = \\\"gender\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Gender'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Model:&lt;/br&gt; &lt;input name = \\\"model\\\" type=\\\"text\\\" size=\\\"50\\\" value=\\\"\" . $row['_Model'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Faction: &lt;/br&gt;&lt;input name = \\\"faction\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Faction'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Recognised Names: &lt;/br&gt;&lt;input name = \\\"names\\\" type=\\\"text\\\" size=\\\"50\\\" value=\\\"\" . $row['_RecognisedNames'] . \"\\\"&lt;/br&gt;\";\n        echo \"&lt;input name=\\\"submit2\\\" type=\\\"submit\\\" value=\\\"Update\\\" /&gt;\";\n        echo \"&lt;/form&gt;\";\n    }\n}\nif (isset($_POST['submit2'])) \n{\n    //$name = mysql_real_escape_string(htmlspecialchars($_POST['name']));\n    $name = \"Test\";\n    $cash = (int)$_POST['cash'];\n    $flags = mysql_real_escape_string(htmlspecialchars($_POST['flags']));\n    $gender = mysql_real_escape_string(htmlspecialchars($_POST['gender']));\n    $model = mysql_real_escape_string(htmlspecialchars($_POST['model']));\n    $faction = mysql_real_escape_string(htmlspecialchars($_POST['faction']));\n    $names = mysql_real_escape_string(htmlspecialchars($_POST['names']));\n\n    mysql_query(\"UPDATE  `test`.`characters` SET  `_Name` =  '$name',\n    `_Cash` =  '$cash',\n    `_Model` =  '$model',\n    `_Flags` =  '$flags',\n    `_Gender` =  '$gender',\n    `_Faction` =  '$faction',\n    `_RecognisedNames` =  '$names' \n    WHERE  `characters`.`_Key` ='$id'\") or die(mysql_error());\n    echo '&lt;META HTTP-EQUIV=\"Refresh\" Content=\"0; URL=webpagetest.php\"&gt;'; \n}?&gt;\n</code></pre>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13057824,"title":"Show one title and multiple dates from sql query","body":"<p>New to sql and php and trying to work through this one.  After reading several examples here, I still can't seem to get this done.  Right now I have the following query </p>\n\n<pre><code>$sql = \"SELECT e.id, e.event_name, e.recurrence_id, e.start_date, e.venue_title FROM \" . wp_events_detail . \" e  WHERE e.recurrence_id &lt;&gt;0 or e.recurrence_id = 0 and is_active = 'Y' GROUP BY e.event_name, e.start_date\"  ;\n                $posts = $wpdb-&gt;get_results($sql);\n\n                print(\"&lt;ul&gt;\");\n                foreach ($posts as $post)\n                {\n                    print('&lt;li&gt;'.$post-&gt;event_name.'|'.$post-&gt;event_desc.'&lt;br/&gt;');\n\n                     print('&lt;/li&gt;');\n                    print($post-&gt;start_date. '~' .$post-&gt;venue_title.'&lt;br/&gt;'); \n                }\n                print(\"&lt;/ul&gt;\");\n</code></pre>\n\n<p>This produces\nName of Class A\nStart Date 1\nName of Class A\nStart Date 2\nName of Class B\nStart Date 1\nName of Class B\nStart Date 2</p>\n\n<p>what I would like is \nName of Class A\nStart Date 1\nStart Date 2</p>\n\n<p>Name of Class B\nStart Date 1\nStart Date 2</p>\n\n<p>I know I need an array and define rows - Have tried several options with no luck.  Not understanding all the variables etc defined in this answer (which seems what I want this to do)</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9253070/show-year-only-once-in-archives-loop\">Show year only once in archives loop</a></p>\n\n<p>Any help greatly appreciated!  Even a point in the right direction;-)</p>\n"},{"tags":["android","query","listview","join","mergecursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13057462,"title":"How to combine data from two database tables into one listView","body":"<p>I am quite confused about how to combine two separate database queries into one listView.</p>\n\n<p>Currently, my listView is populated by the following adapter which queries the damaged component table in my database and provides a list of damaged components for a certain location:</p>\n\n<pre><code>private class MyListAdapter extends ResourceCursorAdapter { \n\n    // In your ListActivity class, create a new inner class that extends ResourceCursorAdapter. \n    //This inner class is the custom CursorAdapter we will use to manage how data is bound to a list item:\n\n    public MyListAdapter(Context context, Cursor cursor) { \n        super(context, R.layout.row_location, cursor);\n    } \n\n    @Override\n    public void bindView(View view, Context context, Cursor cursor) { \n        TextView text_first_line = (TextView) view.findViewById(R.id.location_row_item_main_text);\n        TextView text_second_line = (TextView) view.findViewById(R.id.location_row_item_secondary_text);\n        ImageView flagIcon = (ImageView) view.findViewById(R.id.flagIcon);\n\n        String row_text_component = cursor.getString(cursor.getColumnIndex(RMDbAdapter.COMPONENT));\n        String row_text_position = \", Position \" + cursor.getString(cursor.getColumnIndex(RMDbAdapter.POSITION));\n        if(row_text_position.equals(\", Position Not Applicable\")){\n            row_text_position = \"\";\n        }\n        String row_text_action = \" - \" + cursor.getString(cursor.getColumnIndex(RMDbAdapter.ACTION_REQUIRED));\n\n        text_first_line.setText(row_text_component + row_text_position + row_text_action);\n        text_second_line.setText(\"Dexion Speedlock, S Duty, 3000mm\");\n\n        String risk = cursor.getString(cursor.getColumnIndex(RMDbAdapter.RISK));\n        if (risk.equals(\"Red Risk\")){\n            flagIcon.setImageResource(R.drawable.red_flag);\n        }\n        else if (risk.equals(\"Green Risk\")){\n            flagIcon.setImageResource(R.drawable.green_flag);\n        }\n        else if (risk.equals(\"No Risk\")){\n            flagIcon.setImageResource(R.drawable.note);\n        }\n\n    }\n}\n</code></pre>\n\n<p>This is triggered when I call the following when the activity is started:</p>\n\n<pre><code>private void setAdapter(){\n\n    // Get a Cursor for the list items\n\n    Cursor listComponentCursor = rmDbHelper.fetchDamagedComponentsForLocation(locationId);\n    componentCursorSize = listComponentCursor.getCount();\n    startManagingCursor(listComponentCursor); \n    // set the custom list adapter     \n    setListAdapter(new MyListAdapter(this, listComponentCursor));\n\n}\n</code></pre>\n\n<p>So I would also like to create a second query on a separate table (this time issues table) and add this to the listView under the list of damaged components.  </p>\n\n<p>Reading this <a href=\"http://stackoverflow.com/questions/3539684/listview-from-multiple-tables\">Listview from multiple tables?</a>, I believe that I should use a Join <strong>or</strong> Merge cursor.  However, from what I have researched I still have no idea how to integrate either concept into my code.</p>\n\n<p>Can anyone point me in the right direction please?</p>\n"},{"tags":["sql","sql-server-2008","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13057029,"title":"SQL query to filter out match results","body":"<pre><code>        SELECT TOP 92 PERCENT \n        Convert(DateTime,Floor(Cast((DateTime) as Float)*24)/24,0) AS SummaryDateTime,\n        MIN(APM_ApplicationAvailability.PercentAvailability) AS MIN_of_ApplicationAvailability,\n        Nodes.Caption AS NodeName \n\n        FROM \n        (Nodes INNER JOIN APM_AlertsAndReportsData ON (Nodes.NodeID = APM_AlertsAndReportsData.NodeId))  INNER JOIN APM_ApplicationAvailability ON (APM_AlertsAndReportsData.ApplicationId = APM_ApplicationAvailability.ApplicationID)\n\n\n        WHERE \n        ( DateTime BETWEEN 40907 AND 41205 )\n         AND  \n        (\n          (APM_AlertsAndReportsData.ApplicationName LIKE '%HTTP%') AND \n          (Nodes.Caption = 'www.example.com')\n        )\nGROUP BY Convert(DateTime,Floor(Cast((DateTime) as Float)*24)/24,0), \nNodes.Caption\n\n\nORDER BY SummaryDateTime ASC\n</code></pre>\n\n<p>Above query giving me following result, which attached as an image. <img src=\"http://i.stack.imgur.com/zCENr.png\" alt=\"enter image description here\"> </p>\n\n<p>I want to write a query to filter out all <code>0.00%</code> results so it will just gives only <code>0.00%</code> data, because i don't care about <code>100%</code> data. I don't know how to filter data. </p>\n"},{"tags":["django","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":35,"score":-3,"question_id":13056497,"title":"Can i get field in another by pk in django","body":"<p>Can i query by django like this below SQL command.</p>\n\n<pre><code>select pk_2 from table2 where (id = pk1);\n\n( Table1 )\npk_1 = 17\n\n( Table2 )\npk_2 = 15\nid = 17\n</code></pre>\n\n<p>Please T^T</p>\n"},{"tags":["php","mysql","sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13048972,"title":"Calculating Mode within existing query to count rows in PHP and MySQL","body":"<p>I have a table <code>rel</code> with fields <code>id</code> <code>refid</code> <code>cellid</code> <code>cat</code> and some working PHP code to count the number of rows for each <code>cellid</code> and return this as an array for later use.</p>\n\n<pre><code>&lt;?php\n// connect to database\nrequire($DOCUMENT_ROOT . \"connect.php\");\n// count the number of relationships for each cell id\n  $cell_array = array();\n  if ($result = mysqli_query($link, \"SELECT cellid, COUNT(*) totalcount, cat FROM rel GROUP BY cellid\")) {\n    if (mysqli_num_rows($result)) {\n      while ($row = mysqli_fetch_assoc($result)) {\n        $cell_array[$row[\"cellid\"]] = $row['totalcount'];\n      }\n    }\n  }\n?&gt;\n</code></pre>\n\n<p>I now want to add an additional function, calculate the Mode (most common value) of <code>cat</code> for each <code>cellid</code> and include that value in the array. If there is more than one mode or no mode then return 9 (<code>cat</code> can only have values of 1 to 8).</p>\n\n<p>I've been reading around how to find the Mode and the common solution looks like this:</p>\n\n<pre><code>SELECT COUNT(*) frequency, cat, cellid\nFROM rel\nGROUP BY cat\nORDER BY COUNT(*) DESC\nLIMIT 1\n</code></pre>\n\n<p>But this does not return the most common <code>cat</code> for each <code>cellid</code> just the most common <code>cat</code> in general.</p>\n\n<p>I have been working using a sub-query</p>\n\n<pre><code>SELECT cellid, cat, COUNT( * ) \nFROM  `rel` \nGROUP BY cellid, cat\n</code></pre>\n\n<p>Which produces a row for each <code>cellid</code> <code>cat</code> combination, but I'm unsure how to then use this to find the total number of entries for each <code>cellid</code> and the the most common <code>cat</code> for each <code>cellid</code> </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have made some further progress, I now have a working query to find the mode <code>cat</code> for each <code>cellid</code></p>\n\n<pre><code>SELECT cellid, cat\nFROM rel t\nGROUP BY cellid, cat\nHAVING cat = ( \nSELECT cat\nFROM rel\nWHERE cellid = t.cellid\nGROUP BY cat\nORDER BY COUNT( * ) DESC , cat\nLIMIT 1 )\n</code></pre>\n\n<p>But I am still unsure how to combine the two queries are the output from one cannot be used in the other.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13052979,"title":"Many to Many restriction of one side","body":"<p>I have 3 tables</p>\n\n<pre><code>user\nid | etc |\n\ngame\nid | etc \n\nuser_game\nuser_id | game_id\n</code></pre>\n\n<p>I want to create a situation where <code>n</code> users couldn't create another game if and only if they already have a game between those <code>n</code> users.</p>\n\n<p>so for example, assume we have <code>user_ids: 1,2</code> and they're both playing in <code>game_id 1</code>, they can't create another game between them, they could however create a new game if <code>user_id 3</code> joins the game.</p>\n\n<p>Is it possible to query for such thing, if so - how could I go about it? tried playing with queries, joins, selects and where's for far too long :)</p>\n\n<p>EDIT: the end result should be that I query for severel users, and see if they're elgible to play together (ie. no records were found of those <code>n</code> users playing together).</p>\n"},{"tags":["string","query","mod-rewrite","rewrite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13047910,"title":"Remove query string - rewrite rule","body":"<p>How do i remove a query string from the end of a url?\nTo be more specific, this is my rewrite rule:</p>\n\n<pre><code>RewriteRule example-(.*).html$ examples/view-example.php?param1=parameter&amp;param2=$1&amp;split=-\n</code></pre>\n\n<p>and I want this to return a 404 or a redirect to <code>www.mydomain.com/example-one.html</code> :</p>\n\n<pre><code>www.mydomain.com/example-one.html?param1=parameter&amp;param2=one&amp;split=-\n</code></pre>\n\n<p>This is what i tried, it doesn't work:</p>\n\n<pre><code>RewriteCond %{REQUEST_URI}  /examples/view-example\\.php\nRewriteCond %{QUERY_STRING} param1=parameter&amp;param2=(.*)&amp;split=-\nRewriteRule ^(.*)$ http://mydomain.com/example-%1.html$\n</code></pre>\n\n<p>I think that <code>RewriteRule ^(.*)$ http://mydomain.com/example-%1.html$</code> isn't correct..</p>\n"},{"tags":["query","symfony2","doctrine","doctrine2","querybuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13053616,"title":"Doctrine2 QueryBuilder - variable in field name","body":"<p>I am trying to place a variable into the field name in the query , so I have a schema:</p>\n\n<pre><code>  id amazon - tesco - asda - happyshopper - \n\n  1   £5    - NULL  - NULL  -     £4.99\n  2   NULL  - £2.99 - NULL  -     NULL\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>$store = 'amazon'; \n\n$qb = $em-&gt;createQueryBuilder();\n        $products = $qb-&gt;select('p')-&gt;from('MyBundle:Product', 'p')\n        -&gt;where('p.:store IS NOT NULL')\n        -&gt;setParameter('store', $store)\n        -&gt;add('orderBy', 'p.onSale DESC')\n        -&gt;setMaxResults(40)\n        -&gt;getQuery()\n        -&gt;getResult();\n</code></pre>\n\n<p>Would return row 1. </p>\n\n<p>What I've done for :</p>\n\n<pre><code>-&gt;where('p.:store IS NOT NULL')\n-&gt;setParameter('store', $store)\n</code></pre>\n\n<p>Is incorrect and it errors. </p>\n\n<pre><code>-&gt;where(':store IS NOT NULL')\n-&gt;setParameter('store', $store)\n</code></pre>\n\n<p>does not error, but doesn't apply the store filter. </p>\n"},{"tags":["python","query","search"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13052762,"title":"python dictionary float search within range","body":"<p>Suppose I have some kind of dictionary structure like this (or another data structure representing the same thing.</p>\n\n<pre><code>d = {\n  42.123231:'X',\n  42.1432423:'Y',\n  45.3213213:'Z',\n  ..etc\n}\n</code></pre>\n\n<p>I want to create a function like this:</p>\n\n<pre><code>f(n,d,e):\n    '''Return a list with the values in dictionary d corresponding to the float n\n    within (+/-) the float error term e'''\n</code></pre>\n\n<p>So if I called the function like this with the above dictionary:</p>\n\n<pre><code>f(42,d,2)\n</code></pre>\n\n<p>It would return</p>\n\n<pre><code>['X','Y']\n</code></pre>\n\n<p>However, while it is straightforward to write this function with a loop, I don't want to do something that goes through every value in the dictionary and checks it exhaustively, but I want it to take advantage of the indexed structure somehow (or a even a sorted list could be used) to make the search much faster.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13053521,"title":"Combine two queries with different numbers of columns","body":"<p>I have two queries I want to combine into a single output, I can't use a UNIOn because they have different numbers of columns.</p>\n\n<p>The table is <code>ref</code> with fields <code>id</code> <code>refid</code> <code>cellid</code> <code>cat</code> all of which contain whole numbers </p>\n\n<p>Query 1: Finds the total number of rows for each unique <code>cellid</code></p>\n\n<pre><code>SELECT cellid, COUNT(*) totalcount, cat FROM rel GROUP BY cellid\n</code></pre>\n\n<p>Query 2: Finds the Mode (most common value) of <code>cat</code> for each unique <code>cellid</code></p>\n\n<pre><code>SELECT cellid, cat\nFROM rel t\nGROUP BY cellid, cat\nHAVING cat = (\nSELECT cat\nFROM rel\nWHERE cellid = t.cellid\nGROUP BY cat\nORDER BY COUNT(*) DESC, cat\nLIMIT 1\n)\n</code></pre>\n\n<p>To give an example of what I'm trying to do I want to query my table</p>\n\n<pre><code>id | refid | cellid | cat\n1  | 1     |  1     | 1\n2  | 2     |  2     | 2\n3  | 3     |  3     | 4\n4  | 1     |  1     | 2\n5  | 2     |  1     | 2\n6  | 3     |  1     | 3\n7  | 1     |  2     | 2\n8  | 1     |  1     | 2\n</code></pre>\n\n<p>and return</p>\n\n<pre><code>cellid | no_of_rows | Mode_of_cat\n 1     |  5         |  2\n 2     |  2         |  2\n 3     |  1         |  4\n</code></pre>\n"},{"tags":["string","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13051936,"title":"Redirect, and keep query string [javascript]","body":"<p>I want to create a re-direct in JavaScript for the following functionality;</p>\n\n<p>Once someone has landed on a webpage, there will be a JavaScript that will temporarily direct them onto a webpage (they will be on this webpage for a very short time, so the page can capture the cookie/IDs), and then redirected again to a different webpage;</p>\n\n<p>So for example:</p>\n\n<p>I land on www.bbc.co.uk?ID=1234, I then get directed to another webpage, which is carrying my query string, www.google.com?ID=1234, then immediately I get directed to the final webpage, www.facebook.com.</p>\n\n<p>And there maybe 1, or more query strings that will need to be carried over from bbc onto google. No query strings on the third and final webpage.</p>\n\n<p>I want to ask, if this is possible? It must be in JavaScript, I know to direct somebody in JS it's simply;</p>\n\n<p>So far, my workings as:</p>\n\n<blockquote>\n  <p>window.location.href =</p>\n</blockquote>\n\n<p>I can get the query strings by:</p>\n\n<blockquote>\n  <p>var vars = [], hash;\n      var q = document.URL.split('?')[1];\n      if(q != undefined){\n          q = q.split('&amp;');\n          for(var i = 0; i &lt; q.length; i++){\n              hash = q[i].split('=');\n              vars.push(hash[1]);\n              vars[hash[0]] = hash[1];\n          } }</p>\n</blockquote>\n\n<p>Help/Advise will be very appreciated! </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13049920,"title":"Left Join - Unknown Column Error 1054","body":"<p>I keep getting #1054 - Unknown column 'colour' in 'where clause'.</p>\n\n<p>A simplified version of my query is as follows.</p>\n\n<pre><code>SELECT *, \"red\" AS colour\nFROM (\n    SELECT *,'calls' AS 'tbl', id AS cid FROM calls) as c\nWHERE colour='red' \nORDER BY colour ASC, c.created_date DESC\n</code></pre>\n\n<p>If I remove the WHERE line the query executed fine and colour is recognised and all is well.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13050136,"title":"Register and call query in ElasticSearch","body":"<p>Is it possible to register query (like the percolate process) and call them by name to execute them.\nI am building an application that will let the user save search query associated with a label. I would like to save the query generated by the filter in ES.</p>\n\n<p>If I save the query in an index, I have to call ES first to retrieve the query, extract the field containing the query and then call ES again to execute it. Can I do it in one call ?</p>\n\n<p>The other solution is to register queries (labels with _percolator with an identifier of the user:\n/_percolate/transaction/user1_label1</p>\n\n<pre><code>{\n  \"userId\": \"user1\",\n  \"query\":{\n     \"term\":{\"field1\":\"foo\" }\n   }\n}\n</code></pre>\n\n<p>and when there is a new document use the percolator in a non indexing mode (filtered per userId) to retrieve which query match, and then update the document by adding a field  \"label\":[\"user1_label1\", \"user1_label2\"] and finaly index the document. SO the labelling is done at indexing time.</p>\n\n<p>What do you think ? \nThanks in advance.</p>\n"},{"tags":["query","client","postgresql","less"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":494,"score":2,"question_id":1982453,"title":"PSQL 8.3+ client query results display","body":"<p>Rather silly question, but I can't seem to find the answer in the docs or man pages.</p>\n\n<p>Starting with 8.3 I think, the psql CLI client will not display the results of a large query inline. It pipes to a 'less-like' result viewer that disappears when you hit q.</p>\n\n<p>This makes it very difficult to use data from the first query in subsequent queries or updates.</p>\n\n<p>Does anyone know of a switch or way to force psql to display the query results inline, like the old client did?</p>\n\n<p>edit: the \\x switch does this, but I need the multiple row view.</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13046634,"title":"Selecting distinct records that has last creation date in similar records","body":"<p>I have a table: <code>messages</code> with this structure:</p>\n\n<pre><code>`ID`   //  auto increment\n`SenderUserID`   // foreign key: `ID` from `User` table\n`ReceiverUserID`   // foreign key: `ID` from `User` table\n`Message`   \n`DateCreated`   // timestamp \n</code></pre>\n\n<p>I need to get distinct ReceiverUserIDs from table by this conditions: </p>\n\n<ol>\n<li>Sender user should have conversations with receiver users.</li>\n<li>Selected distinct <code>ReceiverUserID</code> should give us last <code>DateCreated</code> message.</li>\n</ol>\n\n<p>So in the results, I'll have user last conversations ordered by creation date DESC.</p>\n\n<p>When I distinct in select query, mysql return a first record, but I need maximum <code>DateCreated</code> for selected `ReceiverUserID to get last message in top of results.</p>\n\n<pre><code>SELECT DISTINCT `m`.`ReceiverUserID` AS `ID` FROM `messages` `m`\nWHERE (`m`.`SenderUserID` = :UserID OR `m`.`ReceiverUserID` = :UserID) \nORDER BY `m`.`DateCreated` DESC\n\n//:UserID means LogedInUserID\n</code></pre>\n\n<p><strong>It is good to know It will be exactly like facebook messages board.</strong></p>\n\n<hr>\n\n<pre><code>ID, SenderUserID, ReceiverUserID, Message,  DateCreated\n1, 12, 11, 'Hi admin', 2012-10-24 11:07:00\n2, 11, 12, 'Hi guy',  2012-10-24 11:08:00\n3, 11, 13, 'Hello dear customer',  2012-10-24 11:12:00\n4, 11, 13, 'Are you there?',  2012-10-24 11:13:00\n5, 13, 11, 'Hiiii',  2012-10-24 11:14:00  // last conversation betwen 11 &amp; 13\n</code></pre>\n\n<p>Current logedin user id: 11</p>\n\n<pre><code>SELECT `m`.`ReceiverUserID` AS `ID`, MAX(`m`.`DateCreated`) as `lastmsg` \nFROM `messages` `m` WHERE (`m`.`SenderUserID` = 11 OR `m`.`ReceiverUserID` = 11) \nGROUP BY `m`.`ReceiverUserID`\n</code></pre>\n\n<p>We have problem in this section:\nIt is not return our last conversation between 11 and 13 when receiver user answered the sender message, It will be not seen in results</p>\n\n<p>Results:</p>\n\n<pre><code>ID, lastmsg\n12, 2012-10-24 11:08:00\n13, 2012-10-24 11:13:00  // Should be: 13, 2012-10-24 11:14:00\n</code></pre>\n"},{"tags":["query","google-app-engine","gae-datastore","jdo"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13030340,"title":"Substring searching of text in Google App Engine Datastore entity","body":"<p>I have been working on with Google App Engine. I have found problem with searching sub strings and few other operations. The javax.jdo.Query provides options to set filter as per the need. There are several filters available like contains, inequality operators but I couldn't find any that matches my need.</p>\n\n<p>I am unable to find methods for following:\nHow to set query filter to </p>\n\n<ol>\n<li>search for a substring</li>\n<li>search by regular expression</li>\n<li>search by ignore case</li>\n</ol>\n\n<p>Is any of the above 3 operations possible with JDO?</p>\n"},{"tags":["sql","database","query","sqlite","design"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13050218,"title":"sqlite database: advanced SQL or redesign","body":"<p>I've been programming for several years, but I'm pretty new to SQL(ite).</p>\n\n<p>I'm designing a database for a sort of a bookkeeping program. What I've got so far:  </p>\n\n<pre><code>orders \n    (o INTEGER PRIMARY KEY, \n     customer INTEGER REFERENCES customers(c), \n     num_products INTEGER, \n     date STRING, \n     discount INTEGER, \n     comments TEXT, \n     status INTEGER)\n\no_products \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     p_0 INTEGER, \n     p_1 INTEGER, \n     p_2 INTEGER, etc.\n\no_qtys \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     q_0 INTEGER, \n     q_1 INTEGER, \n     q_2 INTEGER, etc.\n\no_prices \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     p_0 INTEGER, \n     p_1 INTEGER, \n     p_2 INTEGER, etc.\n</code></pre>\n\n<p>The customers and products tables are irrelevant.</p>\n\n<p>Now, this design works well for retrieving the products, quantities and prices in an order, but I'm not sure how to do something like <strong>figure out total quantity of a product ordered in all orders</strong>. I know I could run a lot of queries and sort through the data in my code, but I'm <strong>looking for one elegant query, something like SELECT sum(<em>ordered of this product</em>).</strong> I could turn the o_products table on its side, to list what orders each product is in, but then it would be hard to retrieve what products are in one specific order. I've done some searching, but I can't seem to find an answer.</p>\n\n<p>Is there a good way to do this, or should I redesign the database? If I should redesign it, <strong>how</strong>?</p>\n"},{"tags":["android","sql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":12974150,"title":"android sqlite how to order by time","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8948435/how-do-i-order-my-sqlite-database-in-descending-order-for-an-android-app\">How do i order my SQLITE database in descending order, for an android app?</a>  </p>\n</blockquote>\n\n\n\n<p>I've the following table where i'd like to select the contents of the table but order by the C_TAG_SCAN_TIME field DESC. </p>\n\n<pre><code>public static final String C_ID = BaseColumns._ID; // special for id internally in system\n    public static final String C_TYPE = \"type\";\n    public static final String C_COMPANY_ID = \"companyid\";\n    public static final String C_PERSON_ID = \"person\";\n    public static final String C_NAME = \"name\";\n    public static final String C_TAG_ID = \"tagid\";\n    public static final String C_STATUS = \"status\";\n    public static final String C_TAG_SCAN_TIME = \"tagscantime\";\n    public static final String C_TAG_SENTSERVER_TIME = \"tagsentservertime\";\n    public static final String C_TRANSACTIONS_LATITUDE = \"transactionslatitude\";\n    public static final String C_TRANSACTIONS_LONGITUDE = \"transactionslongitude\";\n</code></pre>\n\n<p>.</p>\n\n<p>This is my query to select everything from the table TRANSACTIONS.</p>\n\n<pre><code>return db.query(DBHelper.TABLETRANSACTIONS, null, null, null, null, null, null);\n</code></pre>\n\n<p>My question is how can i change the query to order descendingly on the C_TAG_SCAN_TIME column?</p>\n"},{"tags":["java","query","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13048733,"title":"Quering depending on children id","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3492018/how-to-write-jpa-query-where-parameter-is-a-set\">How to write JPA query where parameter is a set?</a>  </p>\n</blockquote>\n\n\n\n<p>I have 2 entities</p>\n\n<pre><code>@Entity\npublic class Container {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n\n    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    Set&lt;Child&gt; data = newHashSet();\n}\n@Entity\npublic class Child {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n}\n</code></pre>\n\n<p>Now I want select all containers that contains specified child.\nI wrote jpa query <code>select c from Container c where :child in c.data</code> that produce sql</p>\n\n<pre><code>select \n    container0_.id as id4_ \nfrom \n    Container container0_ \n    cross join Container_Child data1_, Child child2_ \nwhere \n    container0_.id=data1_.Container_id \nand data1_.data_id=child2_.id \nand (? in (.)) \nlimit ? [42001-168]\n</code></pre>\n\n<p>and fails with <code>JdbcSQLException</code>. How can I fix it?</p>\n"},{"tags":["java","sql","query","hibernate","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13049137,"title":"hibernate native query, count","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1372317/how-do-we-count-rows-using-hibernate\">How do we count rows using Hibernate?</a>  </p>\n</blockquote>\n\n\n\n<p>I want count number of records by criteria in database.<br>\nI try use next query  </p>\n\n<pre><code>String queryString = \"SELECT Count(*) FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString);  \n</code></pre>\n\n<p>but there is no method to execute this <code>Query query</code> and get result.<br>\nI know, that I can count records using   </p>\n\n<pre><code>String queryString = \"SELECT * FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString); \nquery.getResultList().size();  \n</code></pre>\n\n<p>so question, is query with <code>Count(*)</code> more performance, and if <code>yes</code>, then how can I execute query with <code>Count(*)</code>?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13047833,"title":"How to identify the the sql exec() execute a command properly","body":"<p>If i run a sql EXEC() command, then how i confirm that the command is executed properly.Because i don't find any success/failure return type of this command.\nLet say my command is: </p>\n\n<pre><code>EXEC('INSERT into '+@t1+'('+@c1+') values ('+@v1+')')\n</code></pre>\n\n<p>or any other way to be confirm that, the command is execute properly into the destination table.</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13047746,"title":"Changing column name in a SQL Server table with 1000+ records","body":"<p>I have a column and want to change its name but nothing else using query, what would be the best way of doing it.</p>\n"},{"tags":["sql","query","join","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13047972,"title":"SQL Join setting value from table2 to table1 where id is the same","body":"<p>i've the following table</p>\n\n<pre><code>+-----+------+\n| sID | name |\n+-----+------+\n|   2 | MXX  |\n|   3 | ISS  |\n|   4 | FSS  |\n|   5 | SSA  |\n|   6 | PSA  |\n+-----+------+\n</code></pre>\n\n<p>and the following table</p>\n\n<pre><code>+-----+-------+\n| sID | pname | \n+-----+-------+\n|   1 | qqq   |      \n|   1 | yyy   |         \n|   2 | zzz   |\n|   1 | lll   |\n|   2 | mmm   | \n|   3 | ttt   |\n|   3 | sss   |\n|   5 | xxx   |\n|   5 | iii   |\n+-----+-------+\n</code></pre>\n\n<p>and the join result should look like</p>\n\n<pre><code>+-----+-------+----------+\n| sID | pname | supplier |\n+-----+-------+----------+\n|   1 | qqq   |          |\n|   1 | yyy   |          |\n|   2 | zzz   | MXX      |\n|   1 | lll   |          |\n|   2 | mmm   | MXX      |\n|   3 | ttt   | ISS      |\n|   3 | sss   | ISS      |\n|   5 | xxx   | SSA      |\n|   5 | iii   | SSA      |\n+-----+-------+----------+\n</code></pre>\n\n<p>idea is to put the values of column <code>name</code> from first table in the second table where <code>sID</code> is the same</p>\n\n<p>i tried <code>Select * From TABLE1  c LEFT join TABLE2 T on c.sID=T.sID</code></p>\n"},{"tags":["android","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13047321,"title":"Update table using RawQuery() methos des not work","body":"<p>I tried the following SQLite query:</p>\n\n<pre><code>    int idServizo = 150;\n    String whereClause = id_servizio+\" = '\"+idServizio+\" ' \";\n    ContentValues cv = new ContentValues();\n    cv.put(\"sync\", 1);\n\n    int r = dbManager.updateTable(\"myTable\", cv, whereClause);\n</code></pre>\n\n<p>where fields sync and id_servizio are both integer.\nthe method updateTable is:</p>\n\n<pre><code> public int updateTable(String table, ContentValues values, String whereClause){\n    int r = mDb.update(table, values, whereClause, null);\n    return r;\n}\n\n // mDb is SQLiteDatabase object\n</code></pre>\n\n<p>All this works good. \nBut if I try with RawQuery() method defined as:</p>\n\n<pre><code> public Cursor RawQuery(String sqlQuery, String[] columns){\n    return mDb.rawQuery(sqlQuery, columns);    \n}\n</code></pre>\n\n<p>the table is not update! even if no error occurs.</p>\n\n<pre><code> int idServizo = 150;\n String updateQuery =\"UPDATE myTable SET sync = 1 WHERE id_servizio = \"+idServizio;\n dbManager.RawQuery(updateQuery, null);\n</code></pre>\n\n<p>Why this solution does not work?</p>\n"},{"tags":["query","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13036328,"title":"Update Query Access","body":"<p>I am trying to update a field inside one table, \"Todays_Deliveries\", from another table called \"Current_Delivery\". The field is a number field called \"Remaining\" which describes how many units there are of a particular item left on the daily deliveries.</p>\n\n<p>The \"Todays_Deliveries\" table is generated using an APPEND query from another master table with every delivery stored in it. Everytime the user opens a delivery on a form anything in the \"Current_Delivery\" table is removed using a DELETE query and then generated based on the delivery selected using an APPEND query from the \"Todays_Deliveries\" table.</p>\n\n<p>Both tables have identical fields and identical values, given one is generated from the data of the other.</p>\n\n<p>I have tried to create an UPDATE query to update the \"Todays_Deliveries\" table when a user edits the \"Current_Delivery\" table but it doesn't work. I recieve no error messages the field just doesn't update. The steps I took were as follows:</p>\n\n<ol>\n<li>Add both tables.</li>\n<li>Change to UPDATE query.</li>\n<li>Link tables using the Remaining field.</li>\n<li>Set the Field: Remaining and </li>\n<li>Set the Table: Current_Delivery.</li>\n<li>Set Update To: [Todays_Deliveries].[Remaining].</li>\n</ol>\n\n<p>Any advice/help would be greatly appreciated.</p>\n\n<p>EDIT:</p>\n\n<p>BEFORE:</p>\n\n<p><strong>Todays_Deliveries</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1900\n</code></pre>\n\n<p><strong>Current_Delivery</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1000\n</code></pre>\n\n<p>AFTER:</p>\n\n<p><strong>Todays_Deliveries</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1000\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I've got the query working using the below function</p>\n\n<pre><code>UPDATE Todays_Deliveries SET Remaining = DLookup(\"Remaining\",\"Current_Delivery\",\"[MP-Ref] = Form![MP-Ref] And [Cat No] ='\" &amp; [Cat No] &amp; \"'\")\nWHERE \"[MP-Ref] = Form![MP-Ref] And [Cat No] ='\" &amp; [Cat No] &amp; \"'\";\n</code></pre>\n\n<p>Where <em>MP-Ref</em> is the delivery reference that list a number of items, and <em>Cat No</em> is the individual item reference.</p>\n\n<p>The only problem is the other items in the _Daily_Deliveries_ table, the ones not in the _Current_Delivery_ table, have there remaining field set to 0 when I run it. Is there anyway to stop this?</p>\n"},{"tags":["c#","sql","visual-studio-2010","query","methods"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13043910,"title":"SQL query throws error C#","body":"<p>I have created a database and display the data in a gridview. I am trying to enable a method that searches for an employee's name and returns the results. </p>\n\n<p>The following SQL displays correct rows when the EXACT NAME is entered. -</p>\n\n<pre><code>SELECT personID, name, address, phoneNumber, age FROM dbo.person WHERE name Like @name \n</code></pre>\n\n<p><strong>I want to be able to display rows where the name is correct and partially correct.</strong> </p>\n\n<p>I have tried the following SQL - </p>\n\n<pre><code>SELECT personID, name, address, phoneNumber, age FROM dbo.person WHERE name Like @name% \n</code></pre>\n\n<p>But it throws the error \"no overload for method 'searchName' takes 2 arguments\".  </p>\n\n<p>When the \"search\" button is clicked, the following code is executed:</p>\n\n<pre><code>        this.personTableAdapter.searchName(this.personDataSet.person,\n        searchTextBox.Text);\n</code></pre>\n"},{"tags":["mysql","database","query","search","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":10059096,"title":"What is the most efficient approaches to advance search/sort database (MySql) information?","body":"<p>I'm curious what the popular opinion is for creating an advanced searching/sorting function for a database. I'm thinking something like these examples; <a href=\"http://www.amazon.com/gp/browse.html?node=241582011\" rel=\"nofollow\">Amazon</a> or <a href=\"http://www.cars.com/for-sale/advancedsearch.action\" rel=\"nofollow\">Cars.com</a>.</p>\n\n<p>I'm looking to use MySql and searching would be done completely by select, radio, and checkboxes. I would like to use chained select boxes much like the cars.com example where if a user does not make a selection all results for that category will be shown. I also want to make sure and keep myself secure, avoiding sql injection. </p>\n\n<p>My original design allowed for selections to be made by select boxes where if no selection was made it passed a variable to the sql SELECT statement but it seems dirty and long (mysql_real_escape_string not included). I have to establish a variable for each possible, searchable, category like so.</p>\n\n<pre><code>}\nif(!$_POST['ex1']) {\n$ex1='%';\n}\nelse {\n$ex1=$_POST['ex1'];\n}\n</code></pre>\n\n<p>Then I must use a select statement like</p>\n\n<pre><code>SELECT * FROM table WHERE ex1 LIKE '$ex1' AND ex2 LIKE '$ex2' AND numEx BETWEEN '$numEX1' AND '$numEX2' AND ex3 LIKE '$ex3' ORDER BY ex1  \n</code></pre>\n\n<p>I started with a very simple and clean version of this but as my needs grew I have developed what I feel is ugly and inefficient. Since I am needing to expand significantly, I thought now would be the best time to start from scratch.</p>\n\n<p>I'd love to hear others opinions as I know this self-made solution is far from best. I'm obviously not a professional, just a personal hobby and taking care of my needs independently.</p>\n"},{"tags":["database","query","mongodb","mongodb-csharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13046121,"title":"Insert documents into MongoDB only if all fields are unique","body":"<p>I have the following class structure:</p>\n\n<pre><code>public class DBTestItem\n{\n    public int p0;\n    public int p1;\n    public int p2;\n    public int p3;\n    public int p4;\n    public int p5;\n    public int p6;\n    public int p7;\n    public string data;\n}\n\npublic sealed class MongoTestItem : DBTestItem\n{\n    public ObjectId _id;\n}\n</code></pre>\n\n<p>_id is meaningless to me. p0 - p7 represent a composite key, and data represents the value.</p>\n\n<p>I want to save <code>MongoTestItem</code> documents where data is unique, and ideally without performing updates as they would be meaningless. In other words, save if data's value does not exist in the collection.</p>\n\n<p>I have looked at the documentation, but can't quite find how to write the statement to meet the above.</p>\n\n<p>I did create a different structure where p0 - p7 makes a composite _id and data is a List, in which case the statement is as follows:</p>\n\n<pre><code>var query = Query&lt;MdbData&gt;.EQ(x =&gt; x._id, doc._id);\nvar update = Update&lt;MdbData&gt;.Push(x =&gt; x.data, \"somenewvalue\");\ncol.Update(query, update, UpdateFlags.Upsert);\n</code></pre>\n\n<p>This has different semantics, so the upsert is OK.</p>\n\n<p>I want to write the above so I can evaluate the performance difference.</p>\n"},{"tags":["php","sql","query","cs-cart"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13046049,"title":"SQL Query or PHP Query from Excel Sheets","body":"<p>My suppliers in South Africa do not use live xmls for their stock lists.</p>\n\n<p>Each of our suppliers stock lists ( excel pricelists ) have very different layouts. The only way I currently do updates is by copying the code and the price into a new excel csv sheet and import. Then the product codes that it can’t pickup will automatically be put in the “products” category with just the code and the price. The rest I do manually. Adding the short description, product name and correct category.</p>\n\n<p>Is there anyway to make this more automated. We currently have over 15 different pricelists and in excess of 30k products. </p>\n\n<p>I want it to automatically fetch the products image from google based on the products name. Automatically add it to the correct category? I assume I would have to set conditions such as code starting with MO- go to computers///peripherals///mouses. Or for it to ask me to set conditions to look for in product code or short descriptions then it will do the rest?</p>\n\n<p>I also want that when a product is missing from the pricelists it gets hidden.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13046020,"title":"How to add ten new columns to SQL table with 1000+ records in it without losing any single record","body":"<p>I am looking for query that I can use to add ten new boolean columns to existing table without effecting anything else in database. Also by default these boolean columns should be set to true as default.</p>\n\n<p>Looking for best practices.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>\"Also by default these boolean columns should be set to true as default.\"</p>\n\n<p>Sorry I meant to say that for records already exists new column should have value set as true, there shouldn't be any default value as I will set it myself.</p>\n"},{"tags":["database","query","postgresql","indexing","database-optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13044668,"title":"Index not getting dropped on PostgreSQL","body":"<p>I was trying to figure out what is faster while querying a db:\n1. Chaining queries.\n2. Joins.</p>\n\n<p>So, I used EXPLAIN (QUERY) for both types for same query, and the result for chaining (1) was faster than joins (2).</p>\n\n<p>Then I tried to optimize it by indexing one column.</p>\n\n<p>The result of indexing was awesome. Both of my query got optimized tremendously, almost by 10 times. Again, chaining outperformed joins and this time on higher margin.</p>\n\n<p>Now, I wanted to drop the index on the table (that I created). DROP INDEX ran successfully but the query run time is still the same (i.e. the optimized one). I have checked that the index does no longer exist and even restarted system (making sure that no temporary storage), but still performance is the same. So now I can't understand what actually happened?</p>\n\n<p>P.S: I need to revert back to original to check other queries on that scenario.</p>\n\n<p>O/P for \\dt tablename:</p>\n\n<pre><code> Schema |       Name        | Type  | Owner  \n--------+-------------------+-------+--------\n public | feedback          | table | xxx\n</code></pre>\n\n<p>O/P for ANALYZE for chaining:</p>\n\n<p><a href=\"http://explain.depesz.com/s/Rner\" rel=\"nofollow\">http://explain.depesz.com/s/Rner</a></p>\n\n<p>O/P for ANALYZE for JOIN:</p>\n\n<p><a href=\"http://explain.depesz.com/s/6Hr\" rel=\"nofollow\">http://explain.depesz.com/s/6Hr</a></p>\n\n<p>These are the o/p after I indexed itemid in feedback table. Now I can't go back to my previous state (no index)</p>\n\n<p>The data-set is very low... But my main question is not about which one is faster, but why didn't my index got deleted? </p>\n"},{"tags":["vb.net","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12967418,"title":"Read information from text file and display in listbox","body":"<p>I am trying to figure out how to have one form where the user writes in the information they want to see on another form in a listbox. basically the user would write in the details that they want (title, author, stock, price, fiction or nonfiction) and then would press record details and the program would search a text file for those values and then another form would come up with a listbox where they would see all those selected books.</p>\n\n<p>Here is the code I have so far and it basically reads the text file information and stores it into an array:</p>\n\n<pre><code>    Dim Title As String\n    Dim Author As String\n    Dim Stock As Integer\n    Dim Price As Double\n    Dim Fiction As String\n    Dim NonFiction As String\n\nPrivate Sub btnRecord_Click(sender As System.Object, e As System.EventArgs) Handles btnRecord.Click\n\n\n    ''Read the information into a string''\n    Dim objReader As New StreamReader(\"C:\\Users\\Books.txt\")\n    Dim fileString As String = objReader.ReadToEnd()\n    objReader.Close()\n    objReader.Dispose()\n\n    ''Concert string into array''\n    Dim Array As Char() = fileString.ToCharArray()\n    Array(0) = CChar(\"BookName\")\n\n    ''Declare the string to hold the value''\n    Dim resultString As String = \",\"\n\n    ''Increment each item in the string''\n    Dim curChar As Char\n    For i As Integer = 0 To (Array.Length - 1)\n        curChar = Array(i)\n        If (Char.IsLetterOrDigit(curChar)) Then\n            Array(i) = Chr(Asc(curChar) + 1)\n        End If\n    Next\n\n    ''Conver the array back to string''\n    Dim newString As String = New String(Array)\n\n    ''Hide the details form when book inventory runs''\n    Me.Hide()\n\n    ''display inventory form''\n    frmInventory.Show()\n\nEnd Sub\n</code></pre>\n"},{"tags":["mysql","query","max","min"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":9668586,"title":"Use mysql to work out in and out times of vehicle at customer, multiple stops and entries for each customer","body":"<p>I have a mysql table that contains data as per the screenshot below.</p>\n\n<p>My requirement is to generate a mysql query that will show me the in and out time for each customer.\nthe issue I have is that I cannot use min or max as the vehicle might have visited the same customer two or three times within a period.</p>\n\n<p>So the output I am looking for is:</p>\n\n<pre><code>Vehicle: RB10\nCustomer: Hulamin\nIn: 10:19\nout: 10:35\nTime Taken: 16 min\nIn: 11:14\nout: 11:29\nTime Taken: 15 min\nave time taken: 15.5 min\n</code></pre>\n\n<p>and the same for each of the other sites and vehicles as required.</p>\n\n<p>How do I tell mysql to take the smallest in time before the corresponding out time and report?</p>\n\n<p>Many thanks for the assistance.</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12998043,"title":"Difference in outcome query between PhpMyAdmin en PDO","body":"<p>I have the following query being prepared in PHP/PDO.</p>\n\n<pre><code>SELECT\n    count(distinct(p.accid)) as aantal\nFROM \n    winter_accommodaties_prijzen p\nINNER JOIN winter_accommodaties a ON (a.id = p.accid)\nINNER JOIN winter_dorpen d ON (d.id = a.did)\nINNER JOIN winter_gebied g ON (g.id = d.gid)\nINNER JOIN winter_accommodaties_types t ON (a.tid = t.id)\nWHERE\n    g.lid IN(:lid0) AND \n    g.min_hoogte &gt;= :hoogte AND\n    (g.pistes_groen+g.pistes_blauw+g.pistes_rood+g.pistes_zwart) &gt;= :km AND \n    d.hoogte_dorp &gt;= :hoogte_dorp AND \n    d.afstand_utrecht &lt;= :afstand_utrecht AND \n    prijs &lt; : max_prijs AND \n    p.persons &gt;= :aantal_personen\n</code></pre>\n\n<p>Then I bind the following array to this query:</p>\n\n<pre><code> Array\n (\n  [:lid0] =&gt; 1\n  [:hoogte] =&gt; 500\n  [:km] =&gt; 50\n  [:hoogte_dorp] =&gt; 500\n  [:afstand_utrecht] =&gt; 2500\n  [:max_prijs] =&gt; 1200\n  [:aantal_personen] =&gt; 4\n )\n</code></pre>\n\n<p>Running this via PHP I get as a result for 'aantal': 97 (results).\nIf I run the above query, replacing all the variables with their corresponding value, I get via PhpMyAdmin 124 results. Running the same query on the old fashion way in PHP using mysql_query, I also get 124 results.</p>\n\n<p>What am I missing in the PDO query that results in the difference?</p>\n\n<p>UPDATE to the request of AL_ => Creation of the PDO connection:</p>\n\n<pre><code>$conn = new PDO(DB_DSN, DB_USER, DB_PASSWORD);\n$conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n$query = \"See query above\"\n\n$query_pag_no = $conn-&gt;prepare($query); // the above query\n$query_pag_no-&gt;execute($bind_array);    // the above array\n\n$aantal_resultaten = $query_pag_no-&gt;fetchColumn();\n</code></pre>\n\n<p>The outcome in $aantal_resultaten is then 97 (rows).</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13044490,"title":"Mysql group post_id by max count status","body":"<p>hi i have an mysql query where it will return post_id by max counts of status, The result it display currently is </p>\n\n<pre><code>POST_ID\n\n    3\n</code></pre>\n\n<p>Mysql Table:</p>\n\n<pre><code>(`post_id`, `user_id`, `status`, `date_created`)\n(2, 2, 'funny', 20121022120627)\n(2, 3, 'lame', 20121023120627)\n(3, 1, 'useful', 20121023120627)\n(3, 3, 'lame', 20121023120627)\n(3, 4, 'useful', 20121023120627)\n(4, 4, 'useful', 20121024120627)\n</code></pre>\n\n<p>But the result i need is, to display the count from max to min on desc order.if 2 result having same number, then the top result will be based on the latest date_created similar like this</p>\n\n<pre><code>POST_ID\n\n     3\n     2\n     4\n</code></pre>\n\n<p>My current query is</p>\n\n<pre><code>SELECT post_id\nFROM tableName\nGROUP BY post_ID\nHAVING COUNT(*) = \n(\n    SELECT MAX(x.counts)\n    FROM\n    (\n        SELECT post_id, COUNT(*) counts\n        FROM tableName\n        GROUP BY post_id\n    ) x\n)\n</code></pre>\n\n<p>The sample can be found on SQLFiddle <a href=\"http://sqlfiddle.com/#!2/a515e/1\" rel=\"nofollow\">SQLFiddle</a></p>\n"},{"tags":["mysql","query","indexing","database-management","mysql-slow-query-log"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13041479,"title":"how to determine slow queries?","body":"<p>My site is experiencing a really slow loading time. I have suspected that it might be javascript or php that causes longer loading time but i have tested my  site in YSlow and its grade is B which i think is not bad.</p>\n\n<p>Now i want to check my database if something is wrong with queries, database indexing that causes my site to load slower.</p>\n\n<p>Is there some tutorials or tricks i might read or try to test database to figure out if there is slow queries? Any tips for database management?</p>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13043731,"title":"Cursor limit in mongoDB","body":"<p>Iam using mongo as an db for my web app. Java code queries the data from mongo. Curntly there is >40000 in mongo . In one of my api it will return all that documents. So i need only 50 documents to show on the web page. I have tried <code>cursor.limit(50)</code> but it only reduces the time taken by while loop. so i think the whole time is taking from this code <code>DBCursor cursor=collection.find(query,field)</code> . Any ways to reduce it..?.</p>\n"},{"tags":["php","mysql","wordpress","query","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13042844,"title":"need help optimizing wordpress meta_query","body":"<p>I would some help in optimizing this wordpress query, it currently takes 100% cpu usage and have never got the chance for it to finish:</p>\n\n<pre><code>SELECT wp_posts.* FROM wp_posts INNER JOIN wp_postmeta ON (wp_posts.ID = wp_postmeta.post_id)\nINNER JOIN wp_postmeta AS mt1 ON (wp_posts.ID = mt1.post_id)\nINNER JOIN wp_postmeta AS mt2 ON (wp_posts.ID = mt2.post_id)\nINNER JOIN wp_postmeta AS mt3 ON (wp_posts.ID = mt3.post_id)\nINNER JOIN wp_postmeta AS mt4 ON (wp_posts.ID = mt4.post_id)\nINNER JOIN wp_postmeta AS mt5 ON (wp_posts.ID = mt5.post_id)\nINNER JOIN wp_postmeta AS mt6 ON (wp_posts.ID = mt6.post_id)\nINNER JOIN wp_postmeta AS mt7 ON (wp_posts.ID = mt7.post_id)\nINNER JOIN wp_postmeta AS mt8 ON (wp_posts.ID = mt8.post_id)\nINNER JOIN wp_postmeta AS mt9 ON (wp_posts.ID = mt9.post_id)\nINNER JOIN wp_postmeta AS mt10 ON (wp_posts.ID = mt10.post_id) WHERE 1=1 AND wp_posts.post_type = 'produkter' AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private') AND (wp_postmeta.meta_key = 'csv_product_month_sub'\nOR (mt1.meta_key = 'csv_product_type' AND CAST(mt1.meta_value AS CHAR) = 'Mobilt Bredbaand')\nOR (mt2.meta_key = 'csv_product_consumption' AND CAST(mt2.meta_value AS SIGNED) BETWEEN '0' AND '2')\nOR (mt3.meta_key = 'csv_product_consumption' AND CAST(mt3.meta_value AS SIGNED) BETWEEN '3' AND '9')\nOR (mt4.meta_key = 'csv_product_consumption' AND CAST(mt4.meta_value AS SIGNED) BETWEEN '10' AND '19')\nOR (mt5.meta_key = 'csv_product_download' AND CAST(mt5.meta_value AS SIGNED) BETWEEN '2' AND '9')\nOR (mt6.meta_key = 'csv_product_download' AND CAST(mt6.meta_value AS SIGNED) BETWEEN '10' AND '19')\nOR (mt7.meta_key = 'csv_product_download' AND CAST(mt7.meta_value AS SIGNED) BETWEEN '20' AND '29')\nOR (mt8.meta_key = 'csv_product_month_sub' AND CAST(mt8.meta_value AS SIGNED) BETWEEN '0' AND '49')\nOR (mt9.meta_key = 'csv_product_month_sub' AND CAST(mt9.meta_value AS SIGNED) BETWEEN '50' AND '99')\nOR (mt10.meta_key = 'csv_product_month_sub' AND CAST(mt10.meta_value AS SIGNED) BETWEEN '100' AND '149') ) GROUP BY wp_posts.ID ORDER BY wp_postmeta.meta_value+0 ASC \n</code></pre>\n"},{"tags":["mysql","sql","query","insert"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":12600527,"title":"Accessing last inserted row in mysql","body":"<p>On my db-server i am inserting data in a table having a auto increment field say 'id'. Now i want to use the value of this last inserted 'id' in subsequent steps. I can use this:-</p>\n\n<pre><code>  select * from table_name order by id desc limit 1; \n</code></pre>\n\n<p>But the problem here is, it is a server and many more insertions could be happening and there could be a case where i try to retrieve the data with the query i mentioned and get a different id ie. between my insert and select there could be some other insert and i wont get the value i inserted. Any way in which this could be addressed.?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","sql","visual-studio-2010","query","arguments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13043326,"title":"SQL Query accept a valid argument C#","body":"<p>I have created a database and have presented the data in a gridview using Visual Studio C#. I am trying to write a query method that will search for an employee's name and return all results that are similar to the name. </p>\n\n<pre><code>SELECT personID, name, address, phoneNumer, age FROM dbo.person WHERE name Like @name\n</code></pre>\n\n<p>Any advice/help on this would be hugely appreciated. I can't seem to find a solution. </p>\n"},{"tags":["php","mysql","query","checkbox","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":2286115,"title":"When exactly are PHP-MySQL variable assignments made?","body":"<p>[Status: learner] \nUsing checkboxes, the user selects rows from a displayed HTML table.  I then want to insert the date and the unique row id (\"select_id\") of the selected ('ticked') rows into a different table.  Maybe I'm off-base, but it seems to me that the first block of code <strong>does not work</strong>.  The second block of code <strong>does work</strong>.  If I'm correct, it appears that it matters where the $SQL statement is made.  WHY?  I mean, no variable assignments are made until the $sql is called by the mysql_query() function, right?</p>\n\n<p>(...If I'm wrong, nevermind, it is just a normal evening at home.)</p>\n\n<pre><code>$sql = \"INSERT INTO sap_id_select (  select_date\n                                   , select_id )\n        VALUES (  CURRENT_DATE ()\n                , '{$cSelected_id}' ) \n       \" ;\n\nif ( isset ( $_POST [ checkbox] ) ) \n   { \n      foreach ( $_POST [ checkbox ] as $cSelected_id )\n         {\n            mysql_query ( $sql ) or ( \"Error: \" . mysql_error () ) ;\n         }\n   }\n</code></pre>\n\n<p>================================</p>\n\n<pre><code> if ( isset ( $_POST [ checkbox] ) ) \n    { \n       foreach ( $_POST [ checkbox ] as $cSelected_id )\n          {\n             $sql = \"INSERT INTO sap_id_select (  select_date\n                                                , select_id )\n                     VALUES (  CURRENT_DATE ()\n                             , '{$cSelected_id}' ) \n                    \" ;\n\n             mysql_query ( $sql ) or ( \"Error: \" . mysql_error () ) ;\n          }\n    }\n</code></pre>\n"},{"tags":["sql","ruby","database","query","sequel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13037044,"title":"How do I combine AND and OR using Sequel?","body":"<p>I want to generate a SQL query like the following using Ruby's Sequel:</p>\n\n<pre><code>SELECT * FROM Objects WHERE (color = \"red\" AND shape = \"triangle\") OR \n                            (color = \"blue\" AND shape = \"square\") OR\n                            (color = \"green\" AND shape = \"circle\")\n</code></pre>\n\n<p>I want to build this query programmatically from a list of conditions, so that I can do something like this:</p>\n\n<pre><code>conditions = [[[:color, \"red\"], [:shape, \"triangle\"]],\n              [[:color, \"blue\"], [:shape, \"square\"]],\n              [[:color, \"green\"], [:shape, \"circle\"]]]\nDB[:Users].where(conditions.sql_or)\n</code></pre>\n\n<p>It doesn't have to follow that exact form, but I want to be able to build the conditions programmatically, so it's not sufficient to be able to construct this query by hand.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13042521,"title":"query result echoing results four times","body":"<p>I have a functioning query that is echoing the correct results, for 2 people in the reservation, except that it publishing the results four times instead of just once.</p>\n\n<p>Echo of results should be:</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p>Instead, the echo is:</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p>Here's the associated query and PHP code:</p>\n\n<pre><code>    $optquery = \"SELECT t.ibtp, c.ibt\n                FROM clients c, tourprices t \n                WHERE c.tourstart = t.tourstart\n                AND c.tourbk_id = t.tour_id\"; \n\n    $optresult = $db-&gt;query($optquery); \n\n    while ($optrate = mysqli_fetch_assoc($optresult))\n       {\n\n     $opttotalcost = $optrate['ibtp'] * $optrate['ibt']; \n        echo '&lt;strong&gt;',\"Total for Options :&lt;/strong&gt;  $ {$opttotalcost}&lt;br /&gt;\"; \n}\n</code></pre>\n\n<p>Any one see the problem?  </p>\n"},{"tags":["query","hibernate","join","one-to-many","jql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13042231,"title":"JQL for One To Many with join table","body":"<p>I have the following relationships: A CustomerApplication has a list of Customer objects as a OneToMany with a join table.  A CustomerApplication also has a OneToOne to a CustomerAgreement.  The code in the CustomerApplication class is as follows:</p>\n\n<pre><code>@OneToMany( fetch = FetchType.EAGER )  \n@JoinTable(  \n        name = \"customer_application_customer\",  \n        joinColumns = @JoinColumn( name = \"customer_application_id\" ),  \n        inverseJoinColumns = @JoinColumn( name = \"customer_id\" ) )  \nprivate List&lt;Customer&gt; customers = new ArrayList&lt;Customer&gt;();  \n\n@OneToOne( mappedBy = \"customerApplication\" )  \nprivate CustomerAgreement customerAgreement;\n</code></pre>\n\n<p>I need to use JQL to query all active agreements for customers with the same Social Security number.  I have the following, which gives the error: </p>\n\n<p>Errors in named queries: CustomerAgreement.fetchActiveForSsn  </p>\n\n<p>Here is the query.  </p>\n\n<p>@NamedQuery( name = \"CustomerAgreement.fetchActiveForSsn\", query = \"select o from CustomerAgreement o where o.status = :status and o.customerApplication.customers.customer.socialSecurityNumber = :ssn\" )</p>\n\n<p>It's the join between the CustomerApplication and the list of customers to check the social that I'm not sure of.  Can someone tell me how that's done?</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13041685,"title":"multiple MySQL SELECTS in same query","body":"<p>Is it possible to retrieve elements from multiple SELECTS into PHP?</p>\n\n<p>Take this one for example:</p>\n\n<pre><code>$query= mysql_query(\"SELECT ...; SELECT ...;\") \n</code></pre>\n\n<p>If it is possible how can we organize the information ?</p>\n\n<p>I don't think it's as simple as:</p>\n\n<pre><code>while($row = mysql_fetch_array($query))\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13041437,"title":"Alternative to INTERSECT Given Arbitrary Number of conditions","body":"<p>If I have a table similar to the following:</p>\n\n<pre><code>MyIds MyValues\n----- --------\n  1    Meat\n  1    Fruit\n  1    Veggies\n  2    Fruit\n  2    Meat\n  3    Meat\n</code></pre>\n\n<p>How do I create a query  such that if I am given an arbitrary list of distinct <code>MyValues</code>, it will give me all the <code>MyIds</code> that match <strong>all</strong> of <code>MyValues</code>.</p>\n\n<p>Example: If list of <code>MyValues</code> contained [Meat, Fruit, Veggies], I'd like to get <code>MyIds</code> of <code>1</code> back because <code>1</code> has an entry in the table for each value in MyValues.</p>\n\n<p>I know that this can be done with an INTERSECT if I'm given a specific list of <code>MyValues</code>. But I don't know how it can be done with an arbitrary number of <code>MyValues</code> </p>\n"},{"tags":["ruby-on-rails","query","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13041051,"title":"Trying not to repeat myself with Rails data manipulation","body":"<p>I'm fairly new to rails, an an intermediate programmer in general, but I'll try to be as clear as I can.</p>\n\n<p>I have a database table for Products, which owns a field called category. Category has two possible values, call them Category1 and Category 2. The goal is to retrieve all the Products and display them in HTML organized by Category. I can make this work, but I know there has to be a better way.</p>\n\n<p>My method now is to get my Products like so:</p>\n\n<pre><code>@category1_products = Product.all(conditions: { category: \"Category1\" })\n@category2_products = Product.all(conditions: { category: \"Category2\" })\n</code></pre>\n\n<p>and then output the data something like this:</p>\n\n<pre><code>&lt;table&gt;\n&lt;tr&gt;\n  &lt;td&gt;Category1 Name&lt;/td&gt;\n&lt;% @category1_products.each do |product| %&gt;\n  &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.description %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.price %&gt;&lt;/td&gt;\n&lt;% end %&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n  &lt;td&gt;Category2 Name&lt;/td&gt;\n&lt;% @category2_products.each do |product| %&gt;\n  &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.description %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.price %&gt;&lt;/td&gt;\n&lt;% end %&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I would like to accomplish this using a single instance: get all Products at once, group them by Category, and then output them by looping through one Category at a time (including the Category Names). This seems like a pretty elementary concept to me, but I'm having trouble getting my head around it.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12980911,"title":"Trouble creating a SQL query","body":"<p>I've been thinking about how to compose this SQL query for a while now, but after thinking about it for a few hours I thought I'd ask the SO community to see if they have any ideas.</p>\n\n<p>Here is a mock up of the relevant portion of the tables:</p>\n\n<h2>contracts</h2>\n\n<ul>\n<li>id</li>\n<li>date</li>\n<li>ar (yes/no)</li>\n<li>term</li>\n</ul>\n\n<h2>payments</h2>\n\n<ul>\n<li>contract_id</li>\n<li>payment_date</li>\n</ul>\n\n<p>The object of the query is to determine, per month, how many payments we expect, vs how many payments we received.</p>\n\n<p><strong>conditions for expecting a payment</strong>\nExpected payments begin on <code>contracts.term</code> months after <code>contracts.date</code>, <em>if <code>contracts.ar</code> is \"yes\"</em>. Payments continue to be expected until the month after the first missed payment.</p>\n\n<p>There is one other complication to this: <em>payments might be late, but they need to show up as if they were paid on the date expected.</em></p>\n\n<p>The data is all there, but I've been having trouble wrapping my head around the SQL query. I am not an SQL guru - I merely have a decent amount of experience handling simpler queries. I'd like to avoid filtering the results in code, if possible - but without your help that may be what I have to do.</p>\n\n<h2>Expected Output</h2>\n\n<pre><code>Month    Expected Payments    Received Payments\nJanuary  500                    450\nFebruary 498                    478\nMarch    234                    211\nApril    987                    789\n...\n</code></pre>\n\n<h2>SQL Fiddle</h2>\n\n<p>I've created an SQL Fiddle: <a href=\"http://sqlfiddle.com/#!2/a2c3f/2\" rel=\"nofollow\">http://sqlfiddle.com/#!2/a2c3f/2</a></p>\n"},{"tags":["mysql","sql","query","import","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13039168,"title":"mysql query to import data from dump to existing data and overwrite new entry","body":"<p>I want to import new DUMP file to my old database which has same schema. I want to overwrite if there is anychange in record with dump file record I am importing and want to add new records. I dont want to delete the existing records in the DB I am gonna import.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13039706,"title":"trying to multiply query results for a total","body":"<h2>Issue</h2>\n\n<p>I've produced a query to determine the total cost per person for a room and the total number of persons in the room; the total cost per person is returning correctly as is the total number of person in the room; however, when I try to echo the minor multiplication for the total, I am merely getting the display of the numbers I wish to multiply.  </p>\n\n<p><strong>For example:</strong>\nprice per person = $1207\ntotal number of person in the room = 2\nquery result ... \"1207*2\" ... </p>\n\n<h2>Question:</h2>\n\n<p>I'm certain it is something stupid or minor but could use a second set of eyes.  How do I rewrite the code below to produce the desired result of <strong>$2414</strong>?</p>\n\n<h2>Here's the query:</h2>\n\n<pre><code>$tourquery = \"SELECT t.roomprice, c.totpax \n         FROM clients c, tourprices t \n         WHERE c.roomtype1 = t.roomtype \n         AND c.tourstart = t.tourstart\n         AND c.tourbk_id = t.tour_id\"; \n$tourresult = $db-&gt;query($tourquery); \n\n\nwhile ($roomrate = mysqli_fetch_assoc($tourresult))\n   {\necho \"Per person amount : {$roomrate['roomprice']}&lt;br /&gt;\";\necho \"Total room amount : {$roomrate['roomprice']}*{$roomrate['totpax']}&lt;br /&gt;\";\n\n}\n</code></pre>\n"},{"tags":["mysql","query","union","subtraction"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13037149,"title":"Partial sum and subtraction (minus) in UNION Query","body":"<p>I have two similar tables (one for bills, the other payments) right now I show to users a union mixing data from both..</p>\n\n<pre><code>Table Bills                             \nCustomerId  Amount                      \n1           100                        \n2           100                        \n1           100                        \n2           100\n\nTable Payments\nCustomerId  Amount\n1           100\n2           100\n1           100\n</code></pre>\n\n<p>Right now my users can see the following informtation</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount\nB       1            100\nP       1            -100\nB       1            100\nP       1            -100\nTOTAL 0\n\nFrom Customer 2\nType    CustomerId   Amount\nB       1            100\nP       1            -100\nB       1            100\nTotal 100\n</code></pre>\n\n<p>Everything works fine using UNION Statement</p>\n\n<p>Right now I need to show Partial Balance on each record so users can keep in mind balanca while they are looking at records..</p>\n\n<p>Like this... (DESIRED)</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount    Partial\nB       1            100       100\nP       1            -100      0\nB       1            100       100\nP       1            -100      0\n</code></pre>\n\n<p>I've alredy try using Variables like @Partial := @Partial + Amount but it seems that it first sum the first part (bills) and then the rest (payments)... like this...</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount    Partial\nB       1            100       100\nP       1            -100      200\nB       1            100       200\nP       1            -100      100\n</code></pre>\n\n<p>it seems that first sum everything from bills and then start subtraction... anyone knows how to solve it?</p>\n\n<p><em><strong></em>**<em>*</em>**<em>*</em></strong> // update  // <strong><em>*</em>**<em>*</em>****</strong></p>\n\n<p>here original query ...</p>\n\n<p>(SELECT  'Bill' as cType   , b.type, b.tal , 'Customer', b.number , b.date , b.subtot, b.tax, IF(b.type='CA' or b.type='CB' or b.type='CC' or b.type='CX',b.total*-1,b.total) as total  FROM bills b WHERE b.idcustomer='000140') UNION ALL\n(SELECT  'Payment' as cType, 'CO'  , '1'   , ''    , c.idcash , c.date , 0       ,0     , -c.amount FROM cash c WHERE c.idcustomer='000140' and ( c.type='CO' or c.type='DM') ) order by date asc;</p>\n\n<p>this brings something like this</p>\n\n<p>Bill    FX  1   Customer    9   2011-02-25  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       37  2011-03-04  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    616 2011-03-23  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       751 2011-04-12  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    1267    2011-04-27  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       1157    2011-05-10  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    1974    2011-05-26  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       1654    2011-06-08  0.00    0.00    -100.00</p>\n\n<p>then When I try to sum patiars...using the following code</p>\n\n<p>set @running_total=0;\n(SELECT  'Bill' as cType   , b.type, b.tal , 'Customer', b.number , b.date , b.subtot, b.tax, IF(b.type='CA' or b.type='CB' or b.type='CC' or b.type='CX',b.total*-1,b.total) as total, ( @running_total := @running_total + total) AS RunningTotal  FROM bills b WHERE b.idcustomer='000140') UNION ALL\n(SELECT  'Payment' as cType, 'CO'  , '1'   , ''    , c.idcash , c.date , 0       ,0     , -c.amount, ( @running_total := @running_total-c.amount) AS RunningTotal FROM cash c WHERE c.idcustomer='000140' and ( c.type='CO' or c.type='DM') ) order by date asc;</p>\n\n<p>results...</p>\n\n<p>Bill    FX  1   Customer    9   2011-02-25  0.00    0.00    100.00  100.00</p>\n\n<p>Payment CO  1       37  2011-03-04  0.00    0.00    -100.00 1905.00</p>\n\n<p>Bill    FX  1   Customer    616 2011-03-23  0.00    0.00    100.00  200.00</p>\n\n<p>Payment CO  1       751 2011-04-12  0.00    0.00    -100.00 1805.00</p>\n\n<p>Bill    FX  1   Customer    1267    2011-04-27  0.00    0.00    100.00  300.00</p>\n\n<p>Payment CO  1       1157    2011-05-10  0.00    0.00    -100.00 1705.00</p>\n\n<p>As you Can See seems to sum first all from bills and then start substraccion from payments...</p>\n"},{"tags":["sql","query","sql-update","iterate","foxpro"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13034082,"title":"sql query to \"iterate\" and \"concatenate\" through table values","body":"<p>I have a table like this</p>\n\n<pre><code>name    group        id\n\njohn    employee     1\njoe     intern       i1\nsmith   intern       i2\n</code></pre>\n\n<p>i'm wondering if there is a sql technique that will allow me to group the rows with the same group type to have something like following :</p>\n\n<pre><code>name               group        id\n\njohn               employee     1\njoe, smith         intern       i1,i2\n</code></pre>\n\n<p>i'm looking for a query/solution in pure sql, no proprietary sql (e.g sql server, oracle...)\nI'm no sql guru, so pardon my ignorance.</p>\n"},{"tags":["php","sql-server","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13038942,"title":"Invalid column name in mysql PHP query","body":"<p>I had the following form working properly and populating MySQL DB.  I had since added on a new field 'type' to my database and also added it to the form.  However now when I try to add a new entry it says \"Invalid column name 'type'\".  Any help would be greatly appreciated.</p>\n\n<pre><code>&lt;script&gt;\n      $(document).ready(function() {\n        $(\"#datepicker\").datepicker();\n      });\n      &lt;/script&gt;\n\n  &lt;script&gt;\n$(document).ready(function() {\n$(\"#datepicker2\").datepicker();\n});\n&lt;/script&gt;\n\n &lt;/head&gt;\n &lt;body&gt;\n &lt;?php \n // if there are any errors, display them\n if ($error != '')\n {\n echo '&lt;div style=\"padding:4px; border:1px solid red; color:red;\"&gt;'.$error.'&lt;/div&gt;';\n }\n ?&gt; \n\n  &lt;form action=\"\" method=\"post\"&gt;\n &lt;div&gt;\n &lt;label for=\"Posted\"&gt;&lt;strong&gt;Posted: &lt;/strong&gt; &lt;/label&gt;\n &lt;input id=\"datepicker\"  name=\"posted\" value=\"&lt;?php echo $Posted; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Ends\"&gt;&lt;strong&gt;Ends: &lt;/strong&gt; &lt;/label&gt;\n &lt;input id=\"datepicker2\"  name=\"ends\" value=\"&lt;?php echo $Ends; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Position\"&gt;&lt;strong&gt;Position: &lt;/strong&gt;&lt;/label&gt;\n  &lt;input type=\"text\" name=\"position\" value=\"&lt;?php echo $Position; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n  &lt;label for=\"Location\"&gt;&lt;strong&gt;Location: &lt;/strong&gt; &lt;/label&gt;\n &lt;select name=\"location\"&gt;\n  &lt;option value=\" \"&gt;Select...&lt;?php echo $Location; ?&gt;&lt;/option&gt;\n  &lt;option value=\"Fargo\"&gt;Fargo&lt;/option&gt;\n  &lt;option value=\"Grand Forks\"&gt;Grand Forks&lt;/option&gt;\n&lt;/select&gt;&lt;br/&gt;&lt;br/&gt;\n\n&lt;label for=\"Application Type\"&gt;&lt;strong&gt;Application Type: &lt;/strong&gt; &lt;/label&gt;\n  &lt;select name=\"type\"&gt;\n  &lt;option value=\" \"&gt;Select...&lt;?php echo $Type; ?&gt;&lt;/option&gt;\n  &lt;option value=\"Driver\"&gt;Driver&lt;/option&gt;\n  &lt;option value=\"Employee\"&gt;Employee&lt;/option&gt;\n&lt;/select&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Hours\"&gt;&lt;strong&gt;Hours: &lt;/strong&gt; &lt;/label&gt;\n &lt;input type=\"text\" name=\"hours\" value=\"&lt;?php echo $Hours; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Pay\"&gt;&lt;strong&gt;Pay: &lt;/strong&gt; &lt;/label&gt;\n &lt;input type=\"text\" name=\"pay\" value=\"&lt;?php echo $Pay; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Benefits\"&gt;&lt;strong&gt;Benefits: &lt;/strong&gt; &lt;/label&gt;\n &lt;textarea cols=\"60\" rows=\"2\" name=\"benefits\" value=\"&lt;?php echo $Benefits; ?&gt;\" &gt;&lt;?php echo $Benefits; ?&gt;&lt;/textarea&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Description\"&gt;&lt;strong&gt;Description: &lt;/strong&gt; &lt;/label&gt;\n &lt;textarea cols=\"60\" rows=\"3\" name=\"description\" value=\"&lt;?php echo $Description; ?&gt;\" &gt;&lt;?php echo $Description; ?&gt;&lt;/textarea&gt;&lt;br/&gt;&lt;br/&gt;\n\n\n &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n &lt;/div&gt;\n &lt;/form&gt; \n &lt;/body&gt;\n &lt;/html&gt;\n &lt;?php \n }\n\n\n\n\n // connect to the database\n include('connect-db.php');\n\n // check if the form has been submitted. If it has, start to process the form and save it to the database\n if (isset($_POST['submit']))\n { \n // get form data, making sure it is valid\n\n function ms_escape_string($data) {\n        if ( !isset($data) or empty($data) ) return '';\n        if ( is_numeric($data) ) return $data;\n\n        $non_displayables = array(\n            '/%0[0-8bcef]/',            // url encoded 00-08, 11, 12, 14, 15\n            '/%1[0-9a-f]/',             // url encoded 16-31\n            '/[\\x00-\\x08]/',            // 00-08\n            '/\\x0b/',                   // 11\n            '/\\x0c/',                   // 12\n            '/[\\x0e-\\x1f]/'             // 14-31\n        );\n        foreach ( $non_displayables as $regex )\n            $data = preg_replace( $regex, '', $data );\n        $data = str_replace(\"'\", \"''\", $data );\n        return $data;\n    }\n\n    ms_escape_string($_POST);\n\n\n     $posted=$_POST['posted'];\n     $ends=$_POST['ends'];\n     $type=$_POST['type'];\n     $position=$_POST['position'];\n     $location=$_POST['location'];\n     $hours=$_POST['hours'];\n     $pay=$_POST['pay'];\n     $benefits=$_POST['benefits'];\n     $description=$_POST['description'];\n\n // check to make sure all fields are entered\n if ($posted == '' || $ends == '' || $type == '' || $position == '' || $location == '' || $hours == '' || $pay == '' || $benefits == '' || $description == '')\n {\n // generate error message\n $error = 'ERROR: Please fill in all required fields!';\n\n // if any fields are blank, display the form again\n renderForm($posted, $ends, $type, $position, $location, $hours, $pay, $benefits, $description, $error);\n }\n else\n {\n // save the data to the database\n    $SQL = \"INSERT INTO JobPosting (posted, ends, type, position, location, hours, pay, benefits, description) VALUES ('$posted', '$ends', '$type', '$position', '$location', '$hours', '$pay', '$benefits', '$description')\";\n\n     $result = mssql_query($SQL) \n        or die (mssql_get_last_message());  \n\n // once saved, redirect back to the view page\n header(\"Location: view.php\"); \n }\n }\n else\n // if the form hasn't been submitted, display the form\n {\n renderForm('','','','','','','','','','');\n }\n</code></pre>\n"},{"tags":["sql-server","vb.net","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13038389,"title":"Proper way to execute a large SQL query in vb.net","body":"<p>I have a SQL query that I used my vb.net application to run it, but i have a problem when It exceeds to its command timeout property. I set it to 300, any tips or suggestions?</p>\n\n<p>here is the snippet of my code in vb.net</p>\n\n<pre><code>  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .SecDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .SetDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .TranDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n</code></pre>\n\n<p>same script that run three times. this script gets all the data from the 3 databases which runs okie. however, when it is running...it exceeds the connection timeout of my code.</p>\n"},{"tags":["android","string","query","listview","trim"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13037546,"title":"How to get a part of a datastring from clicking a listview-item","body":"<p>I have a variable called current which holds the last clicked listview item data. The id of this data is to be used to query the db again for movies taht are similar.</p>\n\n<p>The problem that current = id=17985, title=the matrix, year=1999 when all i need is the actual id-number. I have tried to use substring to only use the correct places of the string. This works for the matrix since its id is exactly 5 digits long, but as soon as i try to click  movie with higher/lower amount of digits in its id of course it fucks up.</p>\n\n<p>String id = current.substring(4,9).trim().toString(); does not work for all movies.</p>\n\n<p>Heres some code:</p>\n\n<p>// search method: this is necessary cause this is the method thats first used and where the variable current is set. This is also the only method using three lines for getting data - id, title and year. </p>\n\n<pre><code> protected void search() {\n        data = new ArrayList&lt;Map&lt;String, String&gt;&gt;();\n        list = new ArrayList&lt;String&gt;();\n        EditText searchstring = (EditText) findViewById(R.id.searchstring);\n        String query = searchstring.getText().toString().replace(' ', '+');\n        String text;\n\n        text = searchquery(query);\n        try {\n            JSONObject res = new JSONObject(text);\n\n            JSONArray jsonArray = res.getJSONArray(\"movies\");\n\n            for (int i = 0; i &lt; jsonArray.length(); i++) {\n\n                JSONObject jsonObject = jsonArray.getJSONObject(i);\n                item = new HashMap&lt;String, String&gt;(2);\n                item.put(\"id\",jsonObject.getString(\"id\"));\n                item.put(\"title\",jsonObject.getString(\"title\"));\n                item.put(\"year\", jsonObject.getString(\"year\"));\n                data.add(item);\n\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }                   \n\n        aa = new SimpleAdapter(SearchTab.this, data,\n                R.layout.mylistview,\n                new String[] {\"title\", \"year\"},\n                new int[] {R.id.text1,\n                R.id.text2});\n        ListView lv = (ListView) findViewById(R.id.listView1);\n        lv.setAdapter(aa);\n        lv.setDividerHeight(5); \n\n        lv.setOnItemClickListener(new OnItemClickListener() {\n            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int pos, long id) {\n\n                Map&lt;String, String&gt; s = data.get((int) id);\n                current = s.toString();\n            }});\n    }\n</code></pre>\n\n<p>// similar method: this tries to build a list from the fetched data from \"current\"-string. As you can see i try to use 4,9 to only get right numbers, but this fails with others. Best would be to only to be ble to get the ID which I cant seem to do. The toast is just to see what is beeing fetched, much like a system out print.</p>\n\n<pre><code> protected void similar() {\n        data = new ArrayList&lt;Map&lt;String, String&gt;&gt;();\n        list = new ArrayList&lt;String&gt;();\n        String id = current.substring(4,9).trim().toString();\n        Toast.makeText(getApplicationContext(), id, Toast.LENGTH_SHORT).show();\n        String text;\n\n        text = similarquery(id);\n        try {\n            JSONObject res = new JSONObject(text);\n\n            JSONArray jsonArray = res.getJSONArray(\"movies\");\n\n            for (int i = 0; i &lt; jsonArray.length(); i++) {\n\n                JSONObject jsonObject = jsonArray.getJSONObject(i);\n                item = new HashMap&lt;String, String&gt;(2);\n                item.put(\"title\",jsonObject.getString(\"title\"));\n                item.put(\"year\", jsonObject.getString(\"year\"));\n                data.add(item);\n\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }                   \n\n        aa = new SimpleAdapter(SearchTab.this, data,\n                R.layout.mylistview2,\n                new String[] {\"title\", \"year\"},\n                new int[] {R.id.text1,\n                R.id.text2});\n        ListView lv = (ListView) findViewById(R.id.listView1);\n        lv.setAdapter(aa);\n        lv.setDividerHeight(5); \n\n    }\n</code></pre>\n"},{"tags":["query","sqlite","sqlite3","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":13030058,"title":"WebSQL query optimization help - CASE WHEN makes query 400 ms slow","body":"<p>Can somebody tell me why 'CASE WHEN' makes it so slow and how to optimize / fix it, please ?</p>\n\n<p>It is needed to get the items that are pinned to be put first in the result and in order.</p>\n\n<p>I could probably do it after the sql query but i think it would be faster, when done right, if this sorting is done inside the sql query.</p>\n\n<p>slow query ~490ms</p>\n\n<pre><code>SELECT \n    places.id AS place_id,\n    url,\n    title,\n    thumbnails.score AS score,\n    thumbnails.clipping AS clipping,\n    thumbnails.lastModified AS lastModified,\n    EXISTS (SELECT 1 FROM pinned pi WHERE pi.place_id = places.id) AS pinned\nFROM places\n    LEFT JOIN thumbnails ON (thumbnails.place_id = places.id)\n    LEFT JOIN pinned j ON (j.place_id = places.id) WHERE (hidden == 0)\nORDER BY case when j.id is null then 1 else 0 end,\n    j.id,\n    frecency DESC LIMIT 24\n</code></pre>\n\n<p>Removing the 'CASE WHEN' part:\nquery ~6ms</p>\n\n<pre><code>SELECT\n    places.id AS place_id,\n    url,\n    title,\n    thumbnails.score AS score,\n    thumbnails.clipping AS clipping,\n    thumbnails.lastModified AS lastModified,\n    EXISTS (SELECT 1 FROM pinned pi WHERE pi.place_id = places.id) AS pinned\nFROM places\n    LEFT JOIN thumbnails ON (thumbnails.place_id = places.id) WHERE (hidden == 0)\nORDER BY frecency DESC LIMIT 24\n</code></pre>\n\n<p>Table info:</p>\n\n<pre><code>var Create_Table_Places =\n    'CREATE TABLE places (' +\n        'id INTEGER PRIMARY KEY,' +\n        'url LONGVARCHAR,' +\n        'title LONGVARCHAR,' +\n        'visit_count INTEGER DEFAULT 0,' +\n        'hidden INTEGER DEFAULT 0 NOT NULL,' +\n        'typed INTEGER DEFAULT 0 NOT NULL,' +\n        'frecency INTEGER DEFAULT -1 NOT NULL,' +\n        'last_visit_date INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n\nvar Create_Table_Thumbnails =\n    'CREATE TABLE thumbnails (' +\n        'id INTEGER PRIMARY KEY,' +\n        'place_id INTEGER UNIQUE,' +\n        'data LONGVARCHAR,' +\n        'score REAL,' +\n        'clipping INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n\nvar Create_Table_Pinned =\n    'CREATE TABLE pinned (' +\n        'id INTEGER PRIMARY KEY,' +\n        'place_id INTEGER UNIQUE,' +\n        'position INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n</code></pre>\n"},{"tags":["sql","query","select","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13037468,"title":"if then statement in select query","body":"<pre><code>select \n     DISTINCT CONTACT.CONTACT_ID\n    , CONTACT.FIRST_NAME\n    , CONTACT.LAST_NAME\n    , CONTACT_ADDRESS.COMPANY_NAME\n    , CONTACT_ADDRESS.ADDRESS_LINE_1\n    , CONTACT_ADDRESS.ADDRESS_LINE_2\n    , CONTACT_ADDRESS.CITY\n    , CONTACT_ADDRESS.STATE_PROVINCE\n    , CONTACT_ADDRESS.POSTAL_CODE_1\n    , CONTACT_ADDRESS.POSTAL_CODE_2\n    , CONTACT_LABEL.CREATED_BY\n    , CONTACT_NOTE.CONTACT_NOTE_ID\n    , dbms_lob.substr( CONTACT_NOTE.NOTE_TEXT, 4000, 1) as note_text\n    , CONTACT_NOTE.NOTE_TYPE\n    , rep_profile.terr1\n    , ' ' as Territory\nfrom contact \n    INNER JOIN CONTACT_ADDRESS ON CONTACT.CONTACT_ID = CONTACT_ADDRESS.CONTACT_ID\n    INNER JOIN CONTACT_LABEL ON CONTACT.CONTACT_ID = CONTACT_LABEL.CONTACT_ID\n    INNER JOIN LABEL ON CONTACT_LABEL.LABEL_ID = LABEL.LABEL_ID\n    LEFT JOIN CONTACT_NOTE ON CONTACT.CONTACT_ID = CONTACT_NOTE.CONTACT_ID\n    left join \n    (\n        rep_profile \n        inner join terr_user on rep_profile.terr1 = terr_user.terr\n        inner join terr_version on \n            (terr_user.version = terr_version.version\n                and TERR_USER.ROLE_ID ='00007' \n                and TERR_VERSION.CURRENT_VERSION ='Y'\n            )\n    ) on contact.contact_id = rep_profile.contact_id\n\nWHERE \n    LABEL.DESCRIPTION='Holiday Card 2012' \n    AND (   CONTACT_NOTE.NOTE_TYPE='HC12' \n            or CONTACT_NOTE.NOTE_TYPE IS NULL\n        )\n</code></pre>\n\n<p>I need to put in an if-then-else statement which depends on what the <code>rep_profile.terr1</code> field shows.</p>\n\n<p>Pseudo-code:</p>\n\n<pre><code>if rep_profile.terr1 = 'W05' then Territory = 'Bob'\nelse if rep_profile_terr1 = 'W04' then Territory = 'Jack'\n...\nelse Territory = 'N/A'\n</code></pre>\n\n<p>There are 11 different <code>rep_profile.terr1</code>. Would appreciate any help on how to best do this. Many thanks in advance!</p>\n"},{"tags":["query","coldfusion","coldfusion-8"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13036134,"title":"Have you seen this weird QoQ Error [ColdFusion]?","body":"<p>I have confirmed that the first query works as expected</p>\n\n<pre><code>&lt;cfquery name=\"validation_info\" dbtype=\"query\"&gt;\n    select      shipViaName,TOTALSHIPRATE\n    from        s_c_c.qShipCalc\n    WHERE       sku in (#preserveSingleQuotes(validate)#)\n&lt;/cfquery&gt;\n&lt;cfquery name=\"validation_info2\" dbtype=\"query\"&gt;\n    select      TOTALSHIPRATE\n    from        validation_info\n    WHERE       shipViaName = \"FedEx 3 Day\"\n&lt;/cfquery&gt;\n</code></pre>\n\n<p>But on the second query, I get this error:</p>\n\n<blockquote>\n  <p>Encountered \"shipViaName. Incorrect conditional expression, Incorrect\n  conditional expression, Lexical error at line 0, column 0.\n  Encountered: \"\\\"\" (34), after : \"\"</p>\n</blockquote>\n\n<p>It says the error is happening on this line: </p>\n\n<pre><code>&lt;cfquery name=\"validation_info2\" dbtype=\"query\"&gt;\n</code></pre>\n\n<p>I was also getting this error when I had the two queries combined into one.</p>\n\n<p><strong>Update from comments:</strong></p>\n\n<p>Dump of the validation_info query:</p>\n\n<p>SHIPVIANAME TOTALSHIPRATE </p>\n\n<pre><code>1 | FedEx Ground | 11.9  ||\n2 | FedEx 3 Day  | 22.99 || \n3 | FedEx 2 Day  | 26.99 || \n4 | FedEx 1 Day  | 44.55 || \n5 | FedEx Ground | 0     || \n6 | FedEx 3 Day  | 23.63 || \n7 | FedEx 2 Day  | 26.71 || \n8 | FedEx 1 Day  | 41.9  ||\n</code></pre>\n"},{"tags":["ruby-on-rails","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13036604,"title":"Rails 3 merging scopes with joins","body":"<h1>Setup</h1>\n\n<p>For this question, I'll use the following three classes:</p>\n\n<pre><code>class SolarSystem &lt; ActiveRecord::Base\n  has_many :planets\n\n  scope :has_earthlike_planet, joins(:planets).merge(Planet.like_earth)\nend\n\nclass Planet &lt; ActiveRecord::Base\n  belongs_to :solar_system\n  belongs_to :planet_type\n\n  scope :like_earth, joins(:planet_type).where(:planet_types =&gt; {:life =&gt; true, :gravity =&gt; 9.8})\nend\n\nclass PlanetType &lt; ActiveRecord::Base\n  has_many :planets\n\n  attr_accessible :gravity, :life\nend\n</code></pre>\n\n<h1>Problem</h1>\n\n<p>The scope <code>has_earthlike_planet</code> does not work. It gives me the following error:</p>\n\n<blockquote>\n  <p>ActiveRecord::ConfigurationError: Association named 'planet_type' was\n  not found; perhaps you misspelled it?</p>\n</blockquote>\n\n<h1>Question</h1>\n\n<p>I have found out that this is because it is equivalent to the following:</p>\n\n<pre><code>joins(:planets, :planet_type)...\n</code></pre>\n\n<p>and SolarSystem does not have a <code>planet_type</code> association. I'd like to use the <code>like_earth</code> scope on <code>Planet</code>, the <code>has_earthlike_planet</code> on <code>SolarSystem</code>, and would like to avoid duplicating code and conditions. Is there a way to merge these scopes like I'm attempting to do but am missing a piece? If not, what other techniques can I use to accomplish these goals?</p>\n"},{"tags":["mysql","sql","query","subquery"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13028037,"title":"SQL query to select attendance per student using sub query cant use row from parent query","body":"<p>I have a problem in SQL, I'm trying to work out the student attendance for a class in a register system I'm building however it won't let me use the parent column in the sub query,</p>\n\n<pre><code>SELECT A.student_id, TRUNCATE((100 - ((100/B.reg_num) * C.abs_num)), 0) AS attendance FROM\nstudents A\nJOIN (\nSELECT COUNT(*) AS reg_num\nFROM students\nJOIN seminargroup_student ON seminargroup_student.student_id = students.student_id\nJOIN seminar_group ON seminar_group.seminar_group_id = seminargroup_student.seminar_group_id\nJOIN modules ON modules.module_id = seminar_group.seminar_group_module_id\nJOIN register_seminar ON register_seminar.seminar_id = seminar_group.seminar_group_id\nJOIN registers ON registers.register_id = register_seminar.register_id\nWHERE modules.module_id =1 AND students.student_id = A.student_id\n) B\nJOIN (\nSELECT COUNT(*) AS abs_num\nFROM students\nJOIN seminargroup_student ON seminargroup_student.student_id = students.student_id\nJOIN seminar_group ON seminar_group.seminar_group_id = seminargroup_student.seminar_group_id\nJOIN modules ON modules.module_id = seminar_group.seminar_group_module_id\nJOIN absence ON students.student_id = absence.student_id\nWHERE modules.module_id =1 AND students.student_id = A.student_id\n) C\n</code></pre>\n\n<p>This returns: #1054 - Unknown column 'A.student_id' in 'where clause'</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":13036780,"title":"PHP script wont connect to database?","body":"<p>When certain pages load on my site I have a script that will add points to the users table in the points row.  Here is my script</p>\n\n<pre><code>&lt;?php\n\nsession_start();\n$db = mysqli_connect(\"hostname\", \"username\", \"password\", \"database\");\n\n$username = $_SESSION['username']; \n\nmysqli_query($db, 'UPDATE login_users SET points_column=points_column+1 WHERE username=$username');\n\n\n?&gt;\n</code></pre>\n\n<p>I have already checked the host name, username and password details and everything is correct but I keep getting this error</p>\n\n<blockquote>\n  <p>Warning: mysqli_connect() [function.mysqli-connect]: (28000/1045): Access denied for user 'a5950626_jlf'@'10.1.1.34' (using password: YES) in /home/a5950626/public_html/application/home.php on line 5</p>\n  \n  <p>PHP Error Message</p>\n  \n  <p>Warning: mysqli_query() expects parameter 1 to be mysqli, boolean\n  given in /home/a5950626/public_html/application/home.php on line 9</p>\n</blockquote>\n\n<p>Any ideas what the problem could be or how to fix it? Thanks!</p>\n"},{"tags":["php","query","mongodb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13036776,"title":"I need another Mongodb query for my project","body":"<p>I need a query, all I need to do is,getting the row with \"n\" keyword and get the last two inserted rows that is nothing to do with \"n\" keyword. But I don't know if it is possible or not, thank you :), this is my first query, but It only finds one.</p>\n\n<pre><code>$ho = $collect-&gt;findOne(array(\"n\" =&gt; $key));\n</code></pre>\n"},{"tags":["c#","sql","query","sqlcommand"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13031362,"title":"Upload to database more quickly","body":"<p>I have some code that at the end of the program's life, uploads the entire contents of 6 different lists into a database. The problem is, they're parallel lists with about 14,000 items in each, and I have to run an Insert query for each of their separate item(s). This takes a long time, is there a faster way to do this? Here's a sample of the relevant code:</p>\n\n<pre><code>    public void uploadContent()\n    {\n        var cs = Properties.Settings.Default.Database;\n        SqlConnection dataConnection = new SqlConnection(cs);\n        dataConnection.Open();\n\n        for (int i = 0; i &lt; urlList.Count; i++)\n        {\n            SqlCommand dataCommand = new SqlCommand(Properties.Settings.Default.CommandString, dataConnection);\n            try\n            {\n                dataCommand.Parameters.AddWithValue(\"@user\", userList[i]);\n                dataCommand.Parameters.AddWithValue(\"@computer\", computerList[i]);\n                dataCommand.Parameters.AddWithValue(\"@date\", timestampList[i]);\n                dataCommand.Parameters.AddWithValue(\"@itemName\", domainList[i]);\n                dataCommand.Parameters.AddWithValue(\"@itemDetails\", urlList[i]);\n                dataCommand.Parameters.AddWithValue(\"@timesUsed\", hitsList[i]);\n\n                dataCommand.ExecuteNonQuery();\n            }\n            catch (Exception e)\n            {\n                using (StreamWriter sw = File.AppendText(\"errorLog.log\"))\n                {\n                    sw.WriteLine(e);\n                }\n            }\n\n        }\n        dataConnection.Close();\n    }\n</code></pre>\n\n<p>Here is the command string the code is pulling from the config file:</p>\n\n<p>CommandString:</p>\n\n<pre><code>INSERT dbo.InternetUsage VALUES (@user, @computer, @date, @itemName, @itemDetails, @timesUsed)\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13035871,"title":"Going wrong in SQL join","body":"<p>I've a table called <code>tbl_users</code></p>\n\n<pre><code>================================================================================\nsystem_name | user_id | username | password | system_id | group_id | user_level\n================================================================================\nDemo        | 12345   | demo     | demo     | 99999     | 54321    | Admin\n================================================================================\nDemo        | 78794   | demo2    | demo2    | 99999     |          | Employee\n================================================================================\n</code></pre>\n\n<p>And second table as <code>tbl_groups</code></p>\n\n<pre><code>=================================\nsystem_id | group_id | group_name\n=================================\n99999     | 54321    | engine     \n=================================\n</code></pre>\n\n<p>Am using this query :</p>\n\n<pre><code>SELECT username, user_level, system_name, tbl_users.system_id, tbl_users.user_id, tbl_users.group_id, group_name \nFROM tbl_users JOIN tbl_groups \nWHERE tbl_users.group_id = tbl_groups.group_id \nAND system_name = 'demo' \nAND tbl_users.system_id = '99999'\n</code></pre>\n\n<p>But using the above query am just getting a row of <code>Demo User</code>, I want Demo 2 also but can't get it done, If am removing <code>tbl_users.group_id = tbl_groups.group_id</code> I get both rows but in <code>group_name</code> it's printed <strong>engine</strong> in <code>Demo2 User</code> <code>group_name</code> column which is wrong as he has no group currently, so how can I query that I get all users and names of groups if a user is in or else I want group_name column blank if user is in no group.</p>\n"},{"tags":["mysql","query","select","query-optimization","distinct-values"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13035615,"title":"MySQL select count(distinct id) is very slow","body":"<p>I have a MyISAM table with about 70 million records. When I do <code>select count(distinct id)</code> it takes about 80 seconds to get the query results. This table is a de-normalized table, that's why I need to get the unique count for id, and it has to be done dynamically. If I add a where clause, depending on the range I give, it takes a shorter time between 4 - 90 secs.</p>\n\n<p>I'm wondering if there is any way I can optimize this to improve the query speed.</p>\n"},{"tags":["database","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13034367,"title":"Oracle select statement performance","body":"<p>i have the following select statement : </p>\n\n<blockquote>\n<pre><code>(\n  SELECT CAL_DATE,BUS_DAY\n  FROM risk_mart.vw_calendar_t5\n  WHERE type = 'RPC'\n  AND BUS_DAY BETWEEN 0 AND 1\n) CAL\n WHERE t.cal_date         = cal.cal_date\n</code></pre>\n</blockquote>\n\n<p>It selects all the dates and then filters them <code>between</code> 0 and 1 (displays only two dates e.g. '22-OCT-12','19-OCT-12').</p>\n\n<p>Now, i can re-write that manually as </p>\n\n<blockquote>\n  <p>WHERE t.cal_date in ('22-OCT-12','19-OCT-12')</p>\n</blockquote>\n\n<p>The difference is performance. The first example i get a return back within 90 seconds and the second example, i get it within 10 seconds. Why?. </p>\n\n<p>How can i improve the first statement/rewrite it? </p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12996899,"title":"Efficient way to SELECT a fixed range of high scores given only a user id","body":"<p>I have a table consisting of records of every match that every player has played.  I've gotten a pretty good head start from the top answer of this question: <a href=\"http://stackoverflow.com/questions/5436263/ranking-with-millions-of-entries\">Ranking with millions of entries</a>, and am currently using this query to retrieve each player's highest score and their rank:</p>\n\n<pre><code>SET @rank=0;\n\nSELECT user_id, score, rank FROM (\n    SELECT *, @rank := @rank + 1 as rank\n    FROM high_scores\n    JOIN (\n        SELECT user_id as user_id2, MAX(score) AS max_score         \n        FROM high_scores\n        GROUP BY user_id2\n        ORDER BY max_score DESC) AS max_score_table                \n    ON max_score = high_scores.score AND high_scores.user_id = user_id2) derived_table\nORDER BY rank;\n</code></pre>\n\n<p>Again, this gives me a nice ordered list of each player's top score and its rank; However, I'd also like to be able to supply a specific <code>user_id</code> and filter the results down to this user's score as well as X amount of surrounding higher and lower scores. </p>\n\n<p>I would think I'd need to perform a <code>SELECT ... WHERE</code> on \"derived_table\" for the <code>user id</code> and use the returned row's <code>'rank'</code> to filter the top-level <code>SELECT</code> statement, but in addition to the query not even being accepted ('derived_table doesn't exist'), the way I was doing it would have required me to re-query derived_table twice (for a greater-than and less-than test), making the query even less efficient than it probably should be.</p>\n\n<p>How can I filter the full list of high scores and ranks down to a single <code>user_id</code>'s entry and X amount of surrounding entries?  Any insight on the code I'm trying to come up with (or the code I currently have) would be greatly appreciated.</p>\n"},{"tags":["mysql","query","phpmyadmin"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13032835,"title":"MySQL error Subquery returns more than 1 row","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT \n    users.*,\n    classes.*, \n    evaluation.student_id, \n    evaluation.class_id, \n    evaluation.chapter_title,\n    (SELECT\n        `score`\n     FROM \n        `evaluation`\n     WHERE \n        `class_id` = 1 \n     AND \n        `id` \n     IN\n        (SELECT \n            MAX(`id`)\n         FROM\n            `evaluation`\n         WHERE\n            `class_id` = 1\n         GROUP BY\n            `chapter_title`)\n     GROUP BY\n        `chapter_title`) \n     AS\n        `score`,\n     (SELECT\n        `total_score`\n      FROM\n        `evaluation`\n      WHERE\n        `class_id` = 1\n      AND\n        `id`\n      IN\n        (SELECT \n            MAX(`id`)\n         FROM\n            `evaluation`\n         WHERE\n            `class_id` = 1\n         GROUP BY\n            `chapter_title`)\n      GROUP BY\n         `chapter_title`)\n      AS\n         `total_score`\n      FROM\n        (`evaluation`\n      INNER JOIN\n        `users`\n      ON \n        evaluation.student_id=users.id)\n      INNER JOIN\n        `classes`\n      ON\n        evaluation.class_id=classes.id\n      WHERE\n        users.role='student'\n      AND\n        evaluation.class_id = 1\n      AND\n        evaluation.student_id = 8\n</code></pre>\n\n<p>But when I execute this query in phpmyadmin it displays a error message saying:</p>\n\n<pre><code>#1242 - Subquery returns more than 1 row\n</code></pre>\n\n<p>Whats wrong in the query.Please help. Thanks in advance.</p>\n\n<p>I have this tables:</p>\n\n<p>users\n<img src=\"http://i.stack.imgur.com/aBc7e.jpg\" alt=\"enter image description here\"></p>\n\n<p>classes\n<img src=\"http://i.stack.imgur.com/YZyAD.jpg\" alt=\"enter image description here\"></p>\n\n<p>evaluation\n<img src=\"http://i.stack.imgur.com/4Akbx.jpg\" alt=\"enter image description here\"></p>\n\n<p>In the evaluation table(last image).. I would only want to return a distinct chapter_title or a grouped chapter_title that has the highest id and has a student_id of 8.</p>\n\n<p>I needed to use this query... but returns an error.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13026254,"title":"MYSQL query for a table","body":"<p>I have a table called visitors which contains IP and country columns.</p>\n\n<p>Now I want to query the table such that I get unique countries from the table and display the count of rows of that country. </p>\n\n<p>Table:</p>\n\n<pre><code>IP         Country \n1.1.1.1.    xyz \n1.2.3.4     xyz\n2.2.3.6     abc\n3.61.3.69   axy\n</code></pre>\n\n<p>Now I want the result as :</p>\n\n<pre><code>Country     No_Visitors\nxyz               2\nabc               1\naxy               1\n</code></pre>\n\n<p>I know how to do it by using 2 queries, get the unique country first and then again query the table for the country name. But how can I do it with single query.</p>\n"},{"tags":["sql","query","phpmyadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13033509,"title":"SQL Query error Subquery returns more than 1 row","body":"<p>Here is my query:</p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/92414/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/92414/1</a></p>\n\n<p>Please check it if what is wrong with my query</p>\n\n<p>I needed to return the query that has a distinct chapter title and the has the max id that is filtered by the student_id from the evaluation table..</p>\n\n<p>I need you help. thank you in advance</p>\n"},{"tags":["sql","database","query","rdbms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13032551,"title":"Omit all the results even if one row has a different value","body":"<p>I have a sample database:</p>\n\n<pre><code>Var1    Var2    Status\n=========================\nA1      SG1     Completed\nA2      SG2     Completed\nA2      SG1     Progress\n</code></pre>\n\n<p>Statuses can be as many as 10 different statuses.</p>\n\n<p>I want to pull all the records only when all the rows' Status is 'Completed'. Meaning in this case no rows will be pulled. Only if all rows = 'Completed' then only it will pull the entire database.</p>\n\n<p>How can I achieve this in lowest time?</p>\n"},{"tags":["php","mysql","sql","query","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13032302,"title":"Need to Create a PHP LOOP (Not sure how to proceed after many failure)","body":"<p>So its simple, I need to replace the number 1 with 2 then 3 and so on 32 times. I know how to create simple PHP loops and everything but want to leave this \"Clean\" so its easier for you guys to help me.</p>\n\n<p>Thank you for any help you can provide me.</p>\n\n<pre><code>&lt;?php\n  $con = mysql_connect(\"localhost\",\"user\",\"pass\");\n  if (!$con)\n    {\n    die('Could not connect: ' . mysql_error());\n    }\n\n  mysql_select_db(\"mbbcom1_rfhl\", $con);\n\n  $sql=\"UPDATE `mbbcom1_rfhl`.`_statbu`\n  SET gp= gp + '$_POST[gp1]', g= g + '$_POST[g1]', a= a + '$_POST[a1]', shot= shot + '$_POST[s1]', pm= pm + '$_POST[pm1]', ppg= ppg + '$_POST[ppg1]', shg= shg + '$_POST[shg1]', bs= bs + '$_POST[blk1]', gwg= gwg + '$_POST[gwg1]', sog= sog + '$_POST[sog1]', soa= soa + '$_POST[soa1]', pim= pim + '$_POST[pim1]' WHERE `season` =9 AND `_statbu`.`player_id` = 1\";\n  if (!mysql_query($sql,$con))\n    {\n    die('Error: ' . mysql_error());\n    }\n  mysql_close($con)\n  ?&gt;\n</code></pre>\n\n<p>So just to be clear, i need the next loop to do the same thing but with '$_POST[gp2]', g= g + '$_POST[g2]' ....ect</p>\n\n<p>Once again, thank you</p>\n"},{"tags":["android","database","query","sqlite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13032449,"title":"a query in sqlite on the first place in db","body":"<p>I'm trying to run a query on a DB that I've build but I have a strange problem\nwhen I run the query ( by name ) and extract the result .\nif I extract the first row in db than I can run another query on with other parameters.\nif I extract a row other than the first I can no longer access to the first row in my db</p>\n\n<pre><code>    Cursor cur =datasource.query( 2,new String[] {\"_id\",\"Player\",\"Num_of_wrong_ans\",\"Num_of_drunkness_checks\"} , PlayerDatabaseHelper.PLAYER + \" =? \" ,new String[] {array[1]} , null ); \n            if(cur.moveToFirst())\n            {                   \n                id = cur.getString(cur.getColumnIndex(PlayerDatabaseHelper.ID));\n\n            }\n            cur.close();    \n</code></pre>\n\n<p>the query method is this :</p>\n\n<pre><code>    public Cursor query( int indicator,String[] projection, String selection,\n        String[] selectionArgs, String sortOrder) {\n    SQLiteQueryBuilder qb = new SQLiteQueryBuilder();\n    String a;\n    switch (indicator) \n    { \n    case 1: \n        qb.setTables(PlayerDatabaseHelper.PLAYER_TABLE_NAME); \n        qb.setProjectionMap(projectionMap); \n        break; \n    case 2: \n        qb.setTables(PlayerDatabaseHelper.PLAYER_TABLE_NAME); \n        qb.setProjectionMap(projectionMap); \n        qb.appendWhere(PlayerDatabaseHelper.PLAYER);\n        break; \n    default: \n        throw new IllegalArgumentException(\"Unknown  \"); \n    } \n\n    // Get the database and run the query \n    SQLiteDatabase db = mHelper.getReadableDatabase(); \n    Cursor c = qb.query(db, projection, selection, selectionArgs, null, null, null); \n    return c; \n\n}    \n</code></pre>\n\n<p>what am I doing wrong ???</p>\n"},{"tags":["wordpress","query","multiple","taxonomy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13031125,"title":"WordPress query posts by several taxonomies","body":"<p>I was searching a lot on this issue, but can't find anything conslusive. Maybe someone can help me here!</p>\n\n<p>I have custom post type 'place' and two custom taxonomies 'place area' and 'place category'. I am building a dropdown filter by those two taxonomies. And all works great if the filter is empty and if both taxonomies are selected. But I can't figure out how to make it work if one of the taxonomies has value and another one is null.</p>\n\n<p>Here's my query:</p>\n\n<pre><code>if(($category == null) &amp;&amp; ($area == null)) {\n\n    //Usual query without taxonomy\n\n  } else {\n    $args = array(\n      'post_type'      =&gt; 'place',\n      'tax_query' =&gt; array(\n            array(\n                'taxonomy' =&gt; 'placecat',\n                'field' =&gt; 'slug',\n                'terms' =&gt; $category\n            ),\n            array(\n                'taxonomy' =&gt; 'placearea',\n                'field' =&gt; 'slug',\n                'terms' =&gt; $area\n            )\n        )\n    );\n  }\n  $the_query = new WP_Query( $args );\n</code></pre>\n\n<p>I thought that the null value will mean all taxonomy terms, but it seems like it's looking for a non-existent term and returns empty result.</p>\n\n<p>Any ideas how I can exclude taxonomy from query if the term value is null?</p>\n"},{"tags":["linq","query","sql-server-2005","entity-framework-4"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":396,"score":2,"question_id":10431578,"title":"Linq query giving Invalid column name \"xyz\" error","body":"<p>I am using this LINQ query</p>\n\n<pre><code>var db = new XYZ();\nvar product = (from cp in db.CatalogProducts\n               where cp.ProductID == productId\n               select cp).FirstOrDefault();\n</code></pre>\n\n<p>Running this query gives me an error </p>\n\n<blockquote>\n  <p>Invalid column name 'Cracker Cruncher'.<br>\n  Invalid column name 'crushing torque'.<br>\n  Invalid column name 'Slicing velocity'.</p>\n</blockquote>\n\n<p>Can any one help me in this matter?</p>\n\n<p>Gautam</p>\n"},{"tags":["ios","database","xcode","query","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":12686107,"title":"SQlite update is not working when switching between views in iOS","body":"<p>I have a Favorites view, that loads data from an sqlite database. It loads entry into cells obviously.</p>\n\n<p>The Favorites view class is named FavReal. I have enabled a canEditRowAtIndexPath with the action of deleting the entry from the database and removing it from the table View. It works fine! and also i have a clear all favorites button that removes all entry correctly.</p>\n\n<p>Now, if i click on a cell, it takes me to another View called Details22 view. In this view i get the details of the selected cell and it works.</p>\n\n<p>Now after clicking on an entry and going back to the Favorites View. If I try to delete an entry either by swipe gesture or by clear all button. It doesn't work :S no errors no nothing it just won't remove it from the database, and just remove it instantly from the table view.</p>\n\n<p>Here are my codes.</p>\n\n<p><b><i> /*  FavReal.m */ </b></i></p>\n\n<pre><code>//\n//  FavReal.m\n//  AuthorsApp\n//\n//  Created by georges ouyoun on 8/16/12.\n//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.\n//\n\n#import \"FavReal.h\"\n#import &lt;sqlite3.h&gt;\n#import \"Author.h\" \n#import \"Details22.h\"\n#import \"AuthorVC.h\"\n@interface FavReal ()\n\n@end\n\n@implementation FavReal\n@synthesize textLabel2;\n@synthesize theFav;\n@synthesize author; \nNSString *authorNAme;\nNSString *authorNAme3 , *authorNAme4;\nNSString *authorFav;\nNSString *PathDB;\n\n- (id)initWithStyle:(UITableViewStyle)style\n{\n    self = [super initWithStyle:style];\n    if (self) {\n        // Custom initialization\n    }\n    return self;\n}\n\n- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    NSLog(@\"entered the cellForRowAtIndexPath\");\n    static NSString *CellIdentifier2 = @\"FavoritesCell\";\n\n    UITableViewCell *cell2 = [tableView dequeueReusableCellWithIdentifier:CellIdentifier2];\n            NSLog(@\"Break before the if\");\n    if (cell2 == nil) {\n        NSLog(@\"Entered the nil cell 1 \");\n        cell2= [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier2];\n        NSLog(@\"Entered the nil cell 2 \");\n    }\n\n    Author *author8 = [self.theFav objectAtIndex:indexPath.row];\n    NSLog(@\"Author initialized\");\n    cell2.textLabel.text = author8.title;\n    NSLog(@\"This is the author8.title variable %@\" , author8.title);\n    NSLog(@\"Cell2 is initialized\");\n //   NSString *cellName = cell2.textLabel.text;\n\n //   [theFav release];\n        return cell2;\n\n}\n\n-(void)viewWillAppear:(BOOL)animated{\n//    [self.tableView cell];\n    NSLog(@\"§§§§§§§§§§§§§ VIew will appear phase 1 §§§§§§§§§§§§§§§§\");\n\n    [self authorList2];\n    [self.tableView reloadData] ;\n    NSLog(@\"§§§§§§§§§§§§§ VIew will appear §§§§§§§§§§§§§§§§\");\n   [self viewDidLoad];\n}\n\n- (void)viewDidLoad\n{\n      NSLog(@\"§§§§§§§§§§§§§ ViewDidLoad §§§§§§§§§§§§§§§§\");\n    UIBarButtonItem *nextButton = [[UIBarButtonItem alloc]\n                                   initWithTitle:@\"Clear All Favorites\"\n                                   style:UIBarButtonItemStyleBordered\n\n                                   target:self\n                                   action:@selector(deleteSomeStuff)];\n\n    [[self navigationItem] setLeftBarButtonItem:nextButton];\n\n    [nextButton release], nextButton = nil;\n\n    [self authorList2];\n    [super viewDidLoad];\n\n}\n\n- (void)viewDidUnload\n{\n\n    NSLog(@\"§§§§§§§§§§§§§ ViewDid UN-Load §§§§§§§§§§§§§§§§\");\n\n    [self setTextLabel2:nil];\n    [ClearBu release];\n    ClearBu = nil;\n    [super viewDidUnload];\n\n}\n\n-(void) viewWillDisappear:(BOOL)animated{\n\n}\n- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation\n{\n    return (interfaceOrientation == UIInterfaceOrientationPortrait);\n}\n\n#pragma mark - Table view data source\n\n- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView\n{\n#warning Potentially incomplete method implementation.\n    // Return the number of sections.\n    return 1;\n}\n\n- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section\n{\n#warning Incomplete method implementation.\n    int rowCount;\n\n     rowCount = theFav.count;\n    return rowCount;\n}\n\n-(NSMutableArray *) authorList2{\n\n    NSFileManager *fileManager = [NSFileManager defaultManager];\n\n    NSLog(@\"1\");\n    theFav = [[NSMutableArray alloc] initWithCapacity:1000000];\n\n    @try {\n        NSLog(@\"1 alpha:\");\n\n        BOOL success = [fileManager fileExistsAtPath:PathDB];\n        NSLog(@\"1 gamma\");\n        if(!success)\n        {\n            NSLog(@\"2\");\n            NSLog(@\"Cannot locate database file '%@'.\", PathDB);\n        }\n        NSLog(@\"Success\");\n        if(!(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK))\n        {\n            NSLog(@\"3\");\n            NSLog(@\"An error has occured: %@\", sqlite3_errmsg(db2));\n\n        }\n\n        NSLog(@\"Database opened\");\n        // const char *sql = \"SELECT F_Keyword FROM wordss\";  \n        const char *sql2 = \"SELECT Name FROM Fav\";\n\n        sqlite3_stmt *sqlStatement2;\n        if(sqlite3_prepare(db2, sql2, -1, &amp;sqlStatement2, NULL) != SQLITE_OK)\n        {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n        }else{\n            while (sqlite3_step(sqlStatement2)==SQLITE_ROW) {\n              //  NSLog(@\"Probleme not with the query but in here!!\");\n                Author * author2 = [[Author alloc] init];\n                //author2.fav = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement2,2)];\n                author2.title = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement2,0)];\n\n               // authorFav=author2.title;              \n                [theFav addObject:author2];\n\n            }\n        }\n    }\n    @catch (NSException *exception) {\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n\n        return theFav;\n    }\n}\n\n\n-(void)deleteSomeStuff{\n    NSLog(@\"Delete Button Clicked\");\n    @try {\n     //   NSLog(@\"This is the authorName2 variable %@\",authorNAme2);\n\n        sqlite3_stmt *compiled_statement1;\n\n        if(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK) {\n\n            NSString *formatedSql = [NSString stringWithFormat:@\"DELETE FROM Fav\"];\n\n            const char *sql = [formatedSql UTF8String];\n            NSLog(@\" !!!!!!!! In the middle of it !!!!!!!!!!!!\");\n            if (sqlite3_prepare_v2(db2, sql, -1, &amp;compiled_statement1, NULL) != SQLITE_OK) {\n                NSLog(@\"!!!!!!!!!!!!!!!!!!!ERRRRROOOOOOORRRRRRRRR!!!!!!!!!!!!!!!!!!!!!!!!!\");\n\n            }\n\n            NSLog(@\"This is the query %@\",formatedSql);\n\n\n            int success = sqlite3_step(compiled_statement1);\n\n            if (success != SQLITE_ERROR) {\n                NSLog(@\"Successfully Deleted!\");\n                sqlite3_last_insert_rowid(db2);\n            }\n\n            if(sqlite3_prepare(db2, sql, -1, &amp;compiled_statement1, NULL) != SQLITE_OK)\n            {\n                NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n\n            }else{\n\n                NSLog(@\"Got in the else tag where pictures should change \");\n\n                while (sqlite3_step(compiled_statement1)!=SQLITE_OK) {\n\n                    NSLog(@\"Got in the while tag\");\n                    break;\n                    }\n                }\n            }\n\n       // NSArray *arr;\n        [self.theFav removeAllObjects]; \n        [self.tableView reloadData];\n\n        }\n\n    @catch (NSException *exception) {\n\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n        sqlite3_close(db2);\n    }\n\n}\n\n/*\n// Override to support conditional editing of the table view.\n- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    // Return NO if you do not want the specified item to be editable.\n    return YES;\n}\n*/\n\n/*\n// Override to support editing the table view.\n- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    if (editingStyle == UITableViewCellEditingStyleDelete) {\n        // Delete the row from the data source\n        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];\n    }   \n    else if (editingStyle == UITableViewCellEditingStyleInsert) {\n        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view\n    }   \n}\n*/\n\n/*\n// Override to support rearranging the table view.\n- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath\n{\n}\n*/\n\n/*\n// Override to support conditional rearranging of the table view.\n- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    // Return NO if you do not want the item to be re-orderable.\n    return YES;\n}\n*/\n\n#pragma mark - Table view delegate\n\n- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath {\n    return YES;\n}\n- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {\n    if(editingStyle == UITableViewCellEditingStyleDelete)\n    {\n        @try{\n            if(!(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK))\n            {\n                NSLog(@\"3\");\n               // NSLog(@\"Could not open Db2\", sqlite3_errmsg(db2));\n\n            }\n            else {\n                NSLog(@\"Db2 is opened\");\n            }\n            NSIndexPath *indPath7= [NSIndexPath indexPathForRow:indexPath.row inSection:0]; \n            UITableViewCell *cell7 = [tableView cellForRowAtIndexPath:indPath7]; \n            NSString *cellText7 = cell7.textLabel.text;\n\n          //  NSLog(@\"§§§§§§§§§§§§§§§§§ This is the cell text §§§§§§§§§§\" , cellText3);\n            sqlite3_stmt *sqlStatement7;\n            NSString *titleString = [[[NSString alloc] initWithFormat:@\"%d\",indexPath.row] autorelease];\n\n            //const char *sql3 = [\"DELETE FROM Fav WHERE rowid = '%@'\" , titleString]  ;\n\n            NSString *formatedSql3 = [NSString stringWithFormat:@\"DELETE FROM Fav WHERE Name = '%@'\" ,cellText7];\n           // const char *formatedSql3 = [@\"DELETE FROM Fav WHERE rowid = '%@'\",titleString];\n\n            NSLog(@\"This is the DELETE Query %@\", formatedSql3);\n            const char *sql3 = [formatedSql3 UTF8String];\n            NSLog(@\"This is the titleString Variable %@ \" , titleString);\n\n            if(sqlite3_prepare(db2, sql3, -1, &amp;sqlStatement7, NULL) != SQLITE_OK)\n        {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n        }\n            else{\n\n                int successS = sqlite3_step(sqlStatement7);\n                if (successS != SQLITE_DONE) {\n                    NSLog(@\"An error Has occured during the delete of the specific record\");\n                }\n                else{\n\n                    NSLog(@\"Update Database successfull!\");\n                }\n            }\n        }    \n                @catch (NSException *exception) {\n                    NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n                }\n\n                @finally {\n                    //sqlite3_finalize(sql);\n                  //  sqlite3_close(db2);\n                    //return theFav;\n                }\n            [self.theFav removeObjectAtIndex:indexPath.row];\n            [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];\n\n    }\n}\n\n- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {\n\n    NSIndexPath *indPath3 = [NSIndexPath indexPathForRow:indexPath.row inSection:0]; \n    UITableViewCell *cell3 = [tableView cellForRowAtIndexPath:indPath3]; \n    NSString *cellText3 = cell3.textLabel.text;\n\n  //  NSLog(@\"This is at first : %@\" , authorNAme);\n  //   NSString *titleString2 = [[[NSString alloc] initWithFormat:@\"Element row number :  %d\",indexPath.row] autorelease];\n    NSLog(@\"This is the showDetailsForIndexPath\");\n\n    Details22 * vc4 = [self.storyboard instantiateViewControllerWithIdentifier:@\"Details22\"];\n    //FavReal* author;\n    NSLog(@\"This is the showDetailsForIndexPath 2\");\n\n    @try{\n            if(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK) {\n\n        NSString *titleString3 = [[[NSString alloc] initWithFormat:@\"Element row number :  %d\",indexPath.row] autorelease];\n        NSLog(@\"This is the row number chosen %@\",titleString3);\n\n       NSString *formatedSql333 = [NSString stringWithFormat:@\"Select * from Sheet1 where field3 = '%@'\" , cellText3 ];\n                const char *formatedSql3333 = [formatedSql333 UTF8String];\n\n        NSLog(@\"This is the SQLite Approriate Query %@\",formatedSql333);\n\n        sqlite3_stmt *sqlStatement3;\n\n        NSString *SearchedItem = cellText3;\n        NSLog(@\"This is the SearchedITem Variable %@\" , SearchedItem);\n\n        if(sqlite3_prepare(db2, formatedSql3333, -1, &amp;sqlStatement3, NULL) != SQLITE_OK)\n    {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }else{\n\n     while (sqlite3_step(sqlStatement3)!=SQLITE_ERROR) {\n\n         NSLog(@\"Entered the While tag\");   \n         NSString *SearchedItem = cellText3;\n         NSLog(@\"This is the SearchedITem Variable %@\" , SearchedItem);\n\n\n                Author * author3 = [[Author alloc] init];\n         NSLog(@\" Debug 1  \");\n\n                author3.name = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3,2)];\n                  NSLog(@\" Debug 2  \");\n\n                NSLog(@\"This is the author.name in the FavReal %@\" , author3.name);\n\n                author3.title = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3,3)];\n         NSLog(@\"This is the author.TITLE in the FavReal %@\" , author3.title);\n\n                author3.genre = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3, 6)];\n         NSLog(@\"This is the author.GENRE in the FavReal %@\" , author3.genre);\n         NSLog(@\"This is the authorName before %@\", authorNAme);\n         NSLog(@\"This is the authorName2 before %@\", authorNAme2);\n         authorNAme = author3.genre;\n         authorNAme2 = author3.name;\n\n         NSLog(@\"This is the authorName after %@\", authorNAme);\n         NSLog(@\"This is the authorName2 after %@\", authorNAme2);\n\n         NSLog(@\"Before the break\");\n         NSLog(@\"Before the animation part\");\n         [self.navigationController pushViewController:vc4 animated:true];   \n         NSLog(@\"Passed the should animate part\");\n\n         break;\n         NSLog(@\"After the break\");\n     }     \n               }\n    }\n    }\n\n    @catch (NSException *exception) {\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n        sqlite3_close(db2);\n        NSLog(@\"The database should NOT be closed here\");\n    }\n}\n\n- (UITableViewCellAccessoryType)tableView:(UITableView *)tableView accessoryTypeForRowWithIndexPath:(NSIndexPath *)indexPath {\n\n    //return UITableViewCellAccessoryDetailDisclosureButton;\n    return UITableViewCellAccessoryDisclosureIndicator;\n}\n\n- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath {\n\n    [self tableView:tableView didSelectRowAtIndexPath:indexPath];\n}\n\n- (void)dealloc {\n    [theFav release];\n    [self release];\n    [textLabel2 release];\n    [textLabel2 release];\n    [ClearBu release];\n    [super dealloc];\n}\n- (IBAction)ClearButtonAction:(id)sender {\n\n    NSLog(@\"Clear Button is Clicked\");\n}\n@end\n</code></pre>\n\n<p><b><i> /* Details22.m */ </b></i> </p>\n\n<pre><code>//\n//  Details.m\n//  AuthorsApp\n//\n//  Created by georges ouyoun on 7/17/12.\n//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.\n//\n\n#import \"AppDelegate.h\"\n#import \"Details22.h\"\n#import \"Author.h\"\n#import \"AuthorVC.h\"\n#import &lt;sqlite3.h&gt;\n#import \"FavReal.h\"\n//#import \"MTPopupWindow.h\"\n\n\n@interface Details22 ()\n\n@end\n\n@implementation Details22\n//@synthesize Favo;\n@synthesize text2;\n@synthesize WebV2;\n@synthesize labelText;\n@synthesize selectedAuthors;\n@synthesize author , infoRequest;\nNSUInteger textFontSize2 = 20;\nNSString *PathDB; \n- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil\n{\n    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];\n    if (self) {\n        // Custom initialization\n    }\n    return self;\n}\n\n- (void)viewDidLoad\n{\n    [super viewDidLoad];\n\n    NSLog(@\"In the viewDidLoad this is the current value of the textFontSize %d\" , textFontSize2);\n\n    NSString * htmlString = [NSString stringWithFormat:@\"\\\n                             &lt;html&gt;\\\n                             &lt;body&gt;\\\n                             &lt;p dir='rtl' style = 'font-size:40px;'&gt; %@ &lt;/p&gt;\\\n                             &lt;/body&gt;\\\n                             &lt;/html&gt;\",authorNAme];\n\n\n    [self.WebV2 setScalesPageToFit:YES];\n    [self.WebV2 loadHTMLString:htmlString baseURL:nil];\n\n    self.text2.text = authorNAme2;\n\n    /* ////////////////////////////////////////////         This is where the label text APPearsssssssss       ///////////////////////////          */\n\n    NSLog(@\"Everything is ok now !\");\n\n}\n- (void)viewDidUnload\n{\n    //  [self setLabelText:nil];\n    NSLog(@\"U have entered view did unload in Details22\");\n\n    //[FavReal initialize];\n\n    [self setText2:nil];\n\n    [self setWebV2:nil];\n\n    [sizeFontFromStepper release];\n    sizeFontFromStepper = nil;\n    [super viewDidUnload];\n\n    //[self setLabelText:Nil];\n    //[AuthorVC load];\n\n    //[self release];\n   // NSLog(@\" FAvReal should have been initialised \");\n    // Release any retained subviews of the main view.\n}\n\n-(void)viewWillAppear:(BOOL)animated\n{ \n    NSLog(@\"U have entered the viewWillAppear tag\");\n}\n\n-(void) viewWillDisappear:(BOOL)animated{\n\n      NSLog(@\"This is the view will disappear tag in Details22\");\n\n}\n\n- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation\n{\n    return YES;\n}\n\n- (void)dealloc {\n    [labelText release];\n\n    [text2 release];\n   // [fontStep release];\n    [WebV2 release];\n    [sizeFontFromStepper release];\n   // [sizeFontFromStepper release];\n    [super dealloc];\n}\n\n-(void)loadHTMLString:(int)textFontSize2\n{\n    NSString * htmlString = [NSString stringWithFormat:@\"\\\n                             &lt;html&gt;\\\n                             &lt;body&gt;\\\n                             &lt;p dir='rtl' style = 'font-size:%dpx;'&gt; %@ &lt;/p&gt;\\\n                             &lt;/body&gt;\\\n                             &lt;/html&gt;\",textFontSize2,authorNAme];\n\n    NSLog(@\"This is the loadHTMLString function with a textFonSize of %d\" , textFontSize2);\n\n    //[self.WebV setScalesPageToFit:YES];\n    [self.WebV2 loadHTMLString:htmlString baseURL:nil];\n\n}\n- (IBAction)loadHtmlNewFontSize:(int)textFontSize2 {\n\n    textFontSize2 = sizeFontFromStepper.value;\n\n    [self loadHTMLString:textFontSize2];\n\n    NSLog(@\"This is textFontSize %d\" , textFontSize2);\n}          \n\n@end\n</code></pre>\n\n<p>Anyone ?</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13028925,"title":"Remove duplicates when joining tables","body":"<p>I have a news table as follows</p>\n\n<p>News:</p>\n\n<pre><code>| id  | title                       | description\n| 1   | Breaking news               | bla bla bla\n| 2   | Heavy snowfall in london    | bla bla bla\n</code></pre>\n\n<p>a Type table as follows:</p>\n\n<pre><code>| id  | type_name   | type_code\n| 1   | weather     | 0567\n| 2   | city        | 0653\n</code></pre>\n\n<p>and a NewsType table as follows</p>\n\n<pre><code>|id | news_id | type_id | created_by |\n| 1 | 2       | 1       | \"John\"     |\n| 2 | 2       | 2       | \"Alex\"     |\n</code></pre>\n\n<p>As you can see from the NewsType table that a single news can fall into two or more types.</p>\n\n<p>I need to display news corresponding to types. A user might say give me all the news about cities and weather. To display this I am doing something like:</p>\n\n<pre><code>      select distinct n.* , nt.created_at\n      from news n, newstype nt, type t where\n      n.id = nt.news_id and\n      t.id = nt.type_id \n      order by nt.created_at\n      limit 25\n</code></pre>\n\n<p>The problem is this query returns the same news twice (I think it's because of the inner join I am doing). What should I change in the query so that if a news is classified as two types, and the user has requested to view the same two types of news, I get only single news item? instead of two!</p>\n"},{"tags":["sql","oracle","query","count"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13028358,"title":"Incorrect results with COUNT function?","body":"<p>I'm a beginner to SQL using ORACLE and have run into a few problems. I have a basic database with 4 tables (HOTEL,ROOM,BOOKING,GUEST) which are populated with data regarding price of rooms ext.</p>\n\n<p>I have a written query that is supposed to find the numbers and names of guests who booked rooms in the price range between 230 and 350 dollars. Also show also how many times they booked such rooms. However, it doesn't seem to be giving me the correct output and I can't figure out why. Here's the query:</p>\n\n<pre><code>SELECT GUEST.GUEST_NAME \"GUEST NAME\",GUEST.GUEST_NO \"GUEST NUMBER\", \nCOUNT(GUEST.GUEST_NO)     \"NUMBER OF TIMES BOOKED\"\nFROM ROOM, GUEST, BOOKING\nWHERE R_PRICE&gt;=260\nAND R_PRICE&lt;=350\nAND GUEST.GUEST_NO = BOOKING.GUEST_NO\nAND ROOM.HOTEL_NO = BOOKING.HOTEL_NO\nGROUP BY GUEST.GUEST_NO, GUEST.GUEST_NAME\nORDER BY \"NUMBER OF TIMES BOOKED\" ASC;\n</code></pre>\n\n<p>And the output: </p>\n\n<pre><code>Tina Duncan      G001    2\nJenny Freeman    G003    2\nMartin Ferguson  G006    3\nPaul Happy       G002    3\nSteve Kirkwood   G005    3\n</code></pre>\n\n<p>Here is sample for tables:</p>\n\n<p>ROOM: </p>\n\n<pre><code>   ROOM_NO HOTEL_NO R_TYPE\n------- -------- ------ ---------\n1       H100     S          220\n2       H100     D          230\n3       H100     F          310\n1       H200     S          260\n2       H200     D          170\n3       H200     S          250\n4       H200     F          180\n5       H200     F          295\n1       H300     D          200\n2       H300     S          420\n</code></pre>\n\n<p>BOOKING:</p>\n\n<pre><code>DATE_FROM DATE_TO   ROOM_NO\n--------- --------- -------\n15-AUG-12 17-AUG-12 1\n30-AUG-12 15-SEP-12 2\n01-AUG-12 02-AUG-12 2\n10-AUG-12 11-AUG-12 2\n01-SEP-12 15-SEP-12 3\n31-JUL-12 02-AUG-12 1\n11-JUL-12 01-AUG-12 1\n12-JUL-12 13-JUL-12 1\n14-JUL-12 15-JUL-12 1\n17-AUG-12 28-AUG-12 2\n31-JUL-12 01-SEP-12 1\n31-AUG-12 01-SEP-12 2\n31-AUG-12 15-SEP-12 4\n01-SEP-12 15-SEP-12 1\n</code></pre>\n\n<p>GUEST:</p>\n\n<pre><code>GUEST_NO G_NAME\n-------- --------------------\nG001     Tina Duncan\nG002     Paul Happy\nG003     Jenny Freeman\nG012     Dianne Kelly\nG005     Steve Kirkwood\nG006     Martin Ferguson\nG007     Vanessa Horton\nGoo8     Bianca Begg\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>Paul Happy       G002    2\nJenny Freeman    G003    1\nSteve Kirkwood   G005    1\nMartin Ferguson      G006    1\nDianne Kelly     G012    1\n</code></pre>\n\n<p>Hopefully I have given you enough, i'd appreciate it heaps if i could get a little help. Thanks guys! </p>\n"},{"tags":["sql","query","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13027608,"title":"Query explanation","body":"<p>I have a query similar to the following,</p>\n\n<pre><code>select * from T1 where abc in (select distinct abc from T2);\n</code></pre>\n\n<p>the scenario is that there is <strong>NO field named abc in table T2</strong>, so the inner query goes invalid, but still the whole query returns the output. </p>\n\n<p>What is the reason for this behaviour?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13027957,"title":"How to make query with ORDER BY and LIMIT work faster?","body":"<p>In my project I have a loop that runs the same query but with different limit values. In the first 10 loop cycles, query is executed with acceptable speed, but then slow down. Table to which I'm making query has 150K registers and <code>column1</code> is Integer and my query is:</p>\n\n<pre><code>SELECT * FROM my_table ORDER BY column1 ASC LIMIT 0,1000\n...\nSELECT * FROM my_table ORDER BY column1 ASC LIMIT 9000,10000\n</code></pre>\n\n<p>As I understood it sorts all 150K registers each time. But how can I sort register only between indicated range?\nHow can I make this query work faster? </p>\n"},{"tags":["c","windows","query","gpu","temperature"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":13017148,"title":"How do I get GPU usage per process?","body":"<p>I have a temperature monitor program I wrote a while back which monitors the temperatures and fans on my AMD Graphics cards, checking for fan failure OR overheats.\nThe problem with it, is that it needs to know in advance which process will be using the GPU(Graphics Processing Unit), in order to kill it or gracefully make it stop to avoid overheating.</p>\n\n<p>To make my program more dynamic, I needed a way to find which process is using the GPU, much like which process is using CPU time(Task Manager). One such application is Process Explorer from SysInternals.</p>\n\n<p>I am asking, how may I do this in Windows in C? I am aware that if there is such a way, it would target Vista and above.</p>\n"},{"tags":["query","hibernate","caching","second-level-cache","hazelcast"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13027369,"title":"clear specific query in the QueryRegion","body":"<p>How can I clear a specific query in some query region that I created, and not all of the query region.</p>\n\n<p>I'm using Hibernate and Hazelcast as second level cache.  </p>\n"},{"tags":["sql","query","grails-2.0","grails-controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13022595,"title":"MSSQL/SQL Query condition error","body":"<p>I have this 2 following SQL Queries on my grails controller:</p>\n\n<pre><code>def query1 = sql.rows(\"select abc from table_one where cond = 1\")\n</code></pre>\n\n<p>The return result from query1 gives me <code>[{abc=5}]</code></p>\n\n<pre><code>def query2 = sql.rows(\"select req from table_two where abc = \" +query1)\n</code></pre>\n\n<p>I am having an error trying to run query2 and I have no idea why.</p>\n\n<p>the column name <code>abc</code> exist in both <code>table_one</code> and <code>table_two</code>, I am trying to fetch the value of <code>abc</code> from <code>table_one</code>, whereby <code>cond = 1</code>, and assign it to variable query1.</p>\n\n<p>and with query2, I am trying to get the values of <code>req</code> from <code>table_two</code>, whereby the value of <code>abc</code> in <code>table_two</code> is equals to the value of query1.</p>\n\n<p>any help on this?</p>\n\n<p>Error message from query2:</p>\n\n<pre><code>Message:Unclosed quotation mark after the character string '[abc:5]'.\n</code></pre>\n"},{"tags":["php","mysql","database","query","triggers"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13017086,"title":"Update table value on page view?","body":"<p>I am trying to create a PHP trigger for when a user views certain pages on my website it will update the user table in the <strong>points</strong> section.</p>\n\n<p>I understand the process would work something like this</p>\n\n<pre><code>on page view &gt; update user &gt; where user id is (**get username from session**) &gt; add 5 to points row\n</code></pre>\n\n<p>Anyone have any idea how to set up something simple like this for giving users simple points for viewing pages? </p>\n\n<p>My site is using PHP and mySQL for the database.</p>\n"},{"tags":["php","sql","database","query","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13024545,"title":"PHP SQL Query error 22 no file found only on insertion","body":"<p>Hy,</p>\n\n<p>I'm making an website that inserts data into an db. It can pull all the data out of the db with no problem, but somehow it goes wrong when i insert the data.</p>\n\n<p>This is the part that gets the values and make the query and execute the query:</p>\n\n<pre><code>    $facility_id = $_POST['facilityID'];\n    $location_zone_area = $_POST['locationZoneArea'];\n    $facility_type = $_POST['facilityType'];\n    $structure_type = $_POST['structureType'];\n    $material_type = $_POST['materialType'];\n    $cause_of_defect = $_POST['causeOfDefect'];\n    $defect_outcome = $_POST['defectOutcome'];\n    $repair_strategy = $_POST['repairStrategy'];\n    $defect_description = $_POST['defectDescription'];\n    $defect_condition = $_POST['defectCondition'];\n    $likelihood_of_failure = $_POST['likelihoodOfFailure'];\n    $consequence_of_failure = $_POST['consequenceOfFailure'];\n    $value = $_POST['value'];\n    $risk = $_POST['risk'];\n    $inspection_frequency = $_POST['inspectionFrequency'];\n    $remarks = $_POST['remarks'];\n    $structure_plan = $_POST['structurePlan'];\n    $name_of_supervisor = $_POST['nameOfSupervisor'];\n    $date = $_POST['date'];\n    $email = $_POST['email'];\n\n    $sQueryInsertData = \"   INSERT INTO `\n                            \".DB_PREFIX.\"main` \n                            (`facility_id`,`location_zone_area`,`structure_type`,`material_type`,`cause_of_defect`,`defect_outcome`,`repair_strategy`,`defect_description`,`defect_condition`,`likelihood_of_failure`,`consequence_of_failure`,`value`,`risk`,`inspection_frequency`,`remarks`,`structure_plan`,`name_of_supervisor`,`date`,`email`,`facility_type`) VALUES ('$facility_id','$location_zone_area','$structure_type','$material_type','$cause_of_defect','$defect_outcome','$repair_strategy','$defect_description','$defect_condition','$likelihood_of_failure','$consequence_of_failure','$value','$risk','$inspection_frequency','$remarks','$structure_plan','$name_of_supervisor','$date', '$email','$facility_type')\";\n    $insertSuccesfull = do_query($sQueryInsertData,'INSERT');\n</code></pre>\n\n<p>The do_query:</p>\n\n<pre><code>function do_query($le_query_to_execute, $type_to_do) {\n    global $link2;\n    switch ($type_to_do) {\n        case 'SELECT' :\n            $return_value = mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)));\n            return $return_value;\n            break;\n        case 'UPDATE' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        case 'DELETE' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        case 'INSERT' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        default :\n            mysqlError($le_query_to_execute,'Er is geen keuze gemaakt wat voor soort type qeury het is.');\n            return FALSE;\n            break;\n    }\n    return FALSE;\n}\n</code></pre>\n\n<p>And the error i get:</p>\n\n<pre><code>There is an error in the query:\n\nINSERT INTO ` facilitydb_main` (`facility_id`,`location_zone_area`,`structure_type`,`material_type`,`cause_of_defect`,`defect_outcome`,`repair_strategy`,`defect_description`,`defect_condition`,`likelihood_of_failure`,`consequence_of_failure`,`value`,`risk`,`inspection_frequency`,`remarks`,`structure_plan`,`name_of_supervisor`,`date`,`email`,`facility_type`) VALUES ('mcot','nederland / hiero / daar','Administration','Concrete','Low cement content and finely ground cement','Highly permeable concrete','Repair','Defect descri','Lighthouse.jpg','2','1','2','Very Low','Inspection/maintenance in a maximum of 5 yearsâ€™ time','kaput','Hydrangeas1.jpg','Marc MEesters','now', 'abcdingetje@gmail.com','building')\n\nThis is the error mysqli gave: \nCan't find file: '.\\facilitydb2test\\@000d@000a@0009@0009@0009@0009@0009@0009@0009facilitydb_main.frm' (errno: 22)\n</code></pre>\n\n<p>Data of the table facility_main:</p>\n\n<pre><code>CREATE TABLE `facilitydb_main` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `facility_id` text NOT NULL,\n  `location_zone_area` text NOT NULL,\n  `structure_type` text NOT NULL,\n  `material_type` text NOT NULL,\n  `cause_of_defect` text NOT NULL,\n  `defect_outcome` text NOT NULL,\n  `repair_strategy` text NOT NULL,\n  `defect_description` text NOT NULL,\n  `defect_condition` text NOT NULL,\n  `likelihood_of_failure` int(11) NOT NULL,\n  `consequence_of_failure` int(11) NOT NULL,\n  `value` int(11) NOT NULL,\n  `risk` text NOT NULL,\n  `inspection_frequency` text NOT NULL,\n  `remarks` text NOT NULL,\n  `structure_plan` text NOT NULL,\n  `name_of_supervisor` text NOT NULL,\n  `date` text NOT NULL,\n  `email` text NOT NULL,\n  `facility_type` text,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n</code></pre>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13024058,"title":"Write a query Display Dept Name , Job Name , \"count of employees in job for each dept\" & \"Count of employees in dept\"","body":"<p>I need to display the count of employees in job for each dept and count employees in dept. My desired output is like this:</p>\n\n<pre><code>DNAME                JOB                    Count(*)    Count(*)\n-----                ---                    --------    --------\nSALES                Manager                       3           5\nACCOUNTING           SALESMAN                      4           2\n</code></pre>\n\n<p>How can I do this? Can I use a sub query?</p>\n"},{"tags":["query","asp-classic","parameterized","named-parameters"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4578,"score":2,"question_id":1092512,"title":"ASP Classic Named Parameter in Paramaterized Query: Must declare the scalar variable ","body":"<p>I'm trying to write a parameterized query in ASP Classic, and it's starting to feel like i'm beating my head against a wall. I'm getting the following error:</p>\n\n<blockquote>\n  <p>Must declare the scalar variable \"@something\".</p>\n</blockquote>\n\n<p>I would swear that is what the hello line does, but maybe i'm missing something...</p>\n\n<pre><code>&lt;% OPTION EXPLICIT %&gt;\n&lt;!-- #include file=\"../common/adovbs.inc\" --&gt;\n&lt;%\n\n    Response.Buffer=false\n\n    dim conn,connectionString,cmd,sql,rs,parm\n\n    connectionString = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Data Source=.\\sqlexpress;Initial Catalog=stuff\"\n    set conn = server.CreateObject(\"adodb.connection\")\n    conn.Open(connectionString)\n\n    set cmd = server.CreateObject(\"adodb.command\")\n    set cmd.ActiveConnection = conn\n    cmd.CommandType = adCmdText\n    cmd.CommandText = \"select @something\"\n    cmd.NamedParameters = true\n    cmd.Prepared = true\n    set parm = cmd.CreateParameter(\"@something\",advarchar,adParamInput,255,\"Hello\")\n    call cmd.Parameters.append(parm)\n    set rs = cmd.Execute\n    if not rs.eof then\n    \tResponse.Write rs(0)\n    end if\n\n\n%&gt;\n</code></pre>\n"},{"tags":["sql","database","query","ms-access","syntax-error"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12925244,"title":"Vague \"Syntax error in join operation\" - Access 2003","body":"<p>For some time, I've had this block of SQL which has worked for a month:</p>\n\n<pre><code>SELECT \n    F.[BRANCH] AS REGION\n    , F.[ACCOUNT]\n    , F.[EFFECTIVE]\n    , F.[POLICY]\n    , F.[DESC2]\n    , F.[DESC4]\n    , F.[GROSS]\n    , F.[COMM]\n    , F.[GST ON COMM]\n    , F.[ENTRYDATE]\n    , I.[TYPE] \nFROM (\n    (SELECT [POLP - Detailed Debtors Import].* \n     FROM [POLP - Detailed Debtors Import]  \n     WHERE [POLP - Detailed Debtors Import].[EFFECTIVE] &lt;= DateValue(\"30/05/2012\")  \n        AND [POLP - Detailed Debtors Import].[GROSS] &gt;= 0  \n        AND [POLP - Detailed Debtors Import].[DESC4] IN ('RNWL', 'NEWB', 'EP')  \n        AND [POLP - Detailed Debtors Import].[DUEYR] = 2012) AS F \n        INNER JOIN (SELECT IPM_ACCTXREF.* FROM IPM_ACCTXREF  \n                        WHERE IPM_ACCTXREF.TYPE \n                            IN (SELECT [Evolve - Account Types].[Account Types] \n                                FROM [Evolve - Account Types])\n                        ) AS I ON F.[ACCOUNT] = I.[ACCOUNT]\n    ) \n    LEFT JOIN (SELECT  [POLP - Detailed Debtors Import].* \n                  FROM [POLP - Detailed Debtors Import]  \n                  WHERE [POLP - Detailed Debtors Import].[DESC4] IN ('CS', 'CANC', 'JL')\n                  ) AS S ON F.[POLICY] = S.[POLICY] \nWHERE S.[POLICY] IS NULL\n</code></pre>\n\n<p>I then wanted to make a change to the DateValue parameter (which would be as simple as changing say, the 5 to a 6).</p>\n\n<p>Problem then is that I get a \"Syntax error in JOIN operation\" repeated three times. Clicking through each of them, the query then displays the resulting table but with \"#Name?\" populated in each field.</p>\n\n<p>Not sure what's happening here...</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13021528,"title":"MySQL select distinct dateTime. Cant figure this query out","body":"<p>My users answer two different questions, they are added to my answers_table as one row each. I'm trying to count how many users have answered my questions which seems simple at first. Count(*) and divide by 2. YES! But: the users can add new questions as they go, so suddenly there might be three questions, all answers/3 becomes an incorrect number of users if there was two  questions for a while and then three, for example!</p>\n\n<p>Can anyone figure out a query for doing this? So far I've got</p>\n\n<pre><code>SELECT COUNT(DISTINCT date) as totNum FROM login_answers\n</code></pre>\n\n<p>But it doesn't take the time in consideration. Meaning i just get the amount of answers in total for that day, not knowing how many questions was available that day.</p>\n\n<p>Here's my table:</p>\n\n<p>qid is the QuestionID so i guess thats somewhere to start?</p>\n\n<pre><code>id      qid answer  date                deviceID\n1502    2   2       2012-10-19 08:42:41 7\n1503    1   3       2012-10-19 08:51:53 7\n1504    2   2       2012-10-19 08:51:53 7\n1505    1   4       2012-10-19 09:05:23 7\n1506    2   2       2012-10-19 09:05:23 7\n1507    1   4       2012-10-19 09:40:59 7\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13021312,"title":"query to count MySQL rows","body":"<p>Trying to get a count (to later multiply with a rate) of names in upto (if data is present in one or more) four rows.  In other words, there is a price per person occupying a room.  So, I want to count the number of persons in the room by names entered on the form and saved in the database table.</p>\n\n<p>I <em>could</em> simply add a field where the user also selects the number of people in addition to completeing the name fields but this seems redundant (and prone to error).</p>\n\n<h2>Setup</h2>\n\n<p>Table: 1.<em>clients</em> which has columns: </p>\n\n<pre><code>id, \ntourbk_id, \ntourstart, \nroomtype1, \nclient1_name, \nclient2_name, \nclient3_name, \nclient4_name\n</code></pre>\n\n<h2>Question</h2>\n\n<p>I have a query which currently checks the roomtype to the per person price for that room type and is working to produce the result but, of course, it is only returning (for two people in a room) the price person for double occupancy.  </p>\n\n<p>E.g.: (per person prices)... single = $10; double = $20; triple = $30; quad = $40 </p>\n\n<p>My current result for double room is $20 (which echo's next to \"Price per person\".  I need a query to count the total persons in this double and multiple times the rate ... \"Total:  query[$20 * 2]\"</p>\n\n<p>How do I code a query to count the <em>\"client</em>_name\" entries in a table? </p>\n"},{"tags":["query","url","actionscript","parameters","swfaddress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13017581,"title":"SWFAddress used to change INDIVIDUAL params in the url","body":"<p>I am using SWFAddress in actionscript 3 to control urls for navigation and controls, and while I am able to target and change specific parameters, I feel like I am missing a cleaner and more consistent way of handling it, perhaps even a feature or method I am not aware of.</p>\n\n<p>Say I have a url and I want to change just the second param of <em>def</em> to <em>xyz</em>.</p>\n\n<p><code>http://localhost/some-page/#/?param1=abc&amp;param2=def&amp;param3=ghi</code> changed to\n<code>http://localhost/some-page/#/?param1=abc&amp;param2=xyz&amp;param3=ghi</code></p>\n\n<p>I currently am doing:</p>\n\n<pre><code>if (SWFAddress.getParameterNames().indexOf(\"param2\") &gt;= 0) {\n    SWFAddress.setValue(SWFAddress.getPath() + \"?\"\n       + SWFAddress.getQueryString().replace(\"param2=\" + SWFAddress.getParameter(\"param2\"), \"param2=xyz\"))\n</code></pre>\n\n<p>Essentially, checking if the param exists, checking what its current value is, then recreating the whole url using <em>base</em>, '?\", and <em>query</em>, making sure I replace the the parameter <em>and</em> the parameter's value, making sure I don't miss the <em>equal sign</em>. This get's sloppy, and is error prone if the param exists but is not set to anything, or whether or not there is an equal sign, and a host of other pitfalls.</p>\n\n<p>So, I can not just tell SWFAddress to update that one parameter in the url? A theoretical function of SWFAddress.setParam(\"param2, \"xyz\").</p>\n\n<p>Has anyone coded their own method to micro-manipulate SWFAddress and the url, beyond the single function they supply you with of setValue(val:String)?</p>\n"},{"tags":["query","node.js","mongodb","geddy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13001245,"title":"Query mongodb with geddy","body":"<p>While trying out the node.js framework geddy (on windows) and i've run into a bit of a problem.</p>\n\n<p>I'm trying to query mongodb, in my controller, using the .first() method from my Users Model like so:</p>\n\n<pre><code>geddy.model.User.first({name: 'jdoe'}, function (err, data) {\n  if (err) {\n    throw err;\n  } else {\n    console.log(data);\n  }\n\n});\n</code></pre>\n\n<p>Strangely enough i'm not getting any output, error, nothing. The user jdoe exists in the collection so it should output something, right ? Am i doing something wrong ?</p>\n\n<p>My model is defined as:</p>\n\n<pre><code>var User = function () {\n\n    this.defineProperties({\n      username: {type: 'string', required: true},\n      password: {type: 'string', required: true},\n    });\n\n    this.autoIncrementId = true;\n\n};\n\nUser = geddy.model.register('User', User);\n</code></pre>\n\n<p>The default adapter is set to mongo in development.js, when i ran geddy for the first time it created my database and it has inserted the Users collection correctly.</p>\n\n<p>Any idea on whats going wrong here ?</p>\n\n<p>UPDATE:</p>\n\n<p>added development.js as requested</p>\n\n<pre><code>var config = {\n  detailedErrors: true\n, debug: true\n, hostname: null\n, port: 4000\n, model: {\n    defaultAdapter: 'mongo',\n    }\n,db: {\n    mongo: {\n        dbname: 'knowledgebase'\n    }\n}\n, sessions: {\n    store: 'memory'\n  , key: 'sid'\n  , expiry: 14 * 24 * 60 * 60\n  }\n};\n\nmodule.exports = config;\n</code></pre>\n\n<p>also my collections on mongo ( created by geddy )</p>\n\n<pre><code>&gt; show collections\nUser\nsystem.indexes\nusers\n</code></pre>\n\n<p>note that somehow geddy is creating two collections instead of one</p>\n"},{"tags":["php","mysql","query","fatal-error"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13020298,"title":"Catchable fatal error: Object of class mysqli_result could not be converted to string","body":"<p>Trying to get my first multi-table MySQL database but i've gut an error I just can wrap my head around.  Can someone please suggest an approach before I toss my computer out a window?</p>\n\n<h2><strong>Setup</strong></h2>\n\n<p>I have two tables:  </p>\n\n<ol>\n<li><em>clients</em> which has rows: *id, tourbk_id, tourstart, roomtype1, client_name*</li>\n<li><em>tourprices</em> which has rows: *id, tour_id, tourstart, roomtype, roomprice*</li>\n</ol>\n\n<h2><strong>Goal</strong></h2>\n\n<p>I'm intending for the following query to look, in the <em>clients</em> table for the tour the client wishes to purchase, compare the tour date + tour name + room type in the <em>client</em> table, and echo the price.  </p>\n\n<h2><strong>My <em>fubar</em> Query</strong></h2>\n\n<pre><code>    $tourquery = \"SELECT t.roomprice \n         FROM clients c, tourprices t \n         WHERE c.roomtype1 = t.roomtype \n         AND c.tourstart = t.tourstart\n         AND c.tourbk_id = t.tour_id\"; \n$tourresult = $db-&gt;query($tourquery); \n\necho '&lt;strong&gt;',\"Per room amount:  \",'&lt;/strong&gt;'.$tourresult. \"\";\n\n$tourresult-&gt;free();\n</code></pre>\n\n<p>As-is, the result is just an error stating:\n<strong>Catchable fatal error: Object of class mysqli_result could not be converted to string</strong></p>\n\n<p>any help is much appreciated.</p>\n"},{"tags":["php","query","if-statement","statement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":56,"score":-4,"question_id":13020098,"title":"PHP Script Won't Execute Echo in If/Else","body":"<p>I'm populating a table with a sql query. One of the rows is $row['com'] and it just returns 1's or 0's. what I want to do is replace the 1's and 0's with an icon image (green.png/red.png). I'm trying to use a if/else statement but I'm not sure how to get it working. Any help would be appreciated. </p>\n\n<pre><code>    mysql_select_db(\"RRRC\", $con);\n\n    $result = mysql_query(\"SELECT * FROM mainreq WHERE roomnum=$loc\");\n\n    echo \"&lt;table border='0'&gt;\n    &lt;tr&gt;\n    &lt;th&gt;Requests&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;/tr&gt;\";\n\n    while($row = mysql_fetch_array($result))\n    {\n        echo \"&lt;tr&gt;\";\necho \"&lt;td&gt;&lt;a href='roomdata.php?loc=\".$row['roomnum'].\"&amp;uni=\".$row['uniint'].\"&amp;com=\".$row['com'].\"'&gt;\".$row['timesub'].\"&lt;/a&gt;&lt;/td&gt;\";\necho \"&lt;td&gt;&lt;center&gt;\" . \n\n  if ($row['com'] == 1)\n    {\n      echo \"&lt;img src=\"images/green.png\" alt=\"logo\"/&gt;\";\n    }\n  else\n    {\n      echo \"&lt;img src=\"images/red.png\" alt=\"logo\"/&gt;\";\n    } \n. \"&lt;/center&gt;&lt;/td&gt;\";\n        echo \"&lt;/tr&gt;\";\n    }\n    echo \"&lt;/table&gt;\";\n</code></pre>\n"},{"tags":["javascript","jquery","html","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13020038,"title":"Allow only one query result per table cell","body":"<p>I have a jquery script that accesses a db and returns a numeric result and writes that result into a table cell. This scripts runs when the page loads but also when the drop down menu is changed. I want to be able to limit only 1 result per table cell. </p>\n\n<p>Right now when page loads it writes the result to the cell and when the drop down menu is changed it just adds the new result to the cell instead of replacing it.</p>\n\n<p>I have search quite a bit trying to figure out how to do this and can not come up with anything. Can someone help me?</p>\n\n<p>Here is the jQuery:</p>\n\n<pre><code>$(document).ready(function(){\n\n$('.typeval').change(function(){\n    var movement    =  $(this).val();\n    var client_id   = $(this).parent().siblings().find('.clientval').val();\n    var class_id    = &lt;? echo $class_id; ?&gt;;\n        $count      = $(this).parents('tr').find('label.count');\n\n$.ajax({ \n  type: \"POST\",\n  url: \"movement_count.php\",\n  data: {movement:movement, client_id:client_id, class_id:class_id},\n  dataType: \"json\", \n  async: false,\n  success:(function(output) {      \n\n      $.each(output, function(index, value){\n     //alert(value);\n     $count.append(output[index]);\n     }); // each\n     })     \n}) // ajax\n\n}).change(); // .typeval\n\n});  // document\n</code></pre>\n\n<p>Here is the table cell where I only want to show one result at a time.</p>\n\n<pre><code>&lt;td&gt;&lt;label class=\"count\"&gt;5&lt;/label&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Please let me know if I have not provided enough info for the assistance needed.</p>\n"},{"tags":["sql","query","postgresql","plpgsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13019369,"title":"temporary table function and loop","body":"<p>I have a function in plpgsql where it creates a temporary table and than it has a loop. The thing is that each time it loops it executes also the part where it creates the temporary table and therefore an error pops up saying;</p>\n\n<pre><code>ERROR:  relation \"tmpr\" already exists\nCONTEXT:  SQL statement \"CREATE TEMPORARY TABLE tmpr (\n                id int,\n                source geometry,\n                target geometry,\n                dist_ft character varying\n        )\"\n</code></pre>\n\n<p>Is there any way how I can prevent from execute not more than once a part of the code?</p>\n\n<p>below you can find the code:</p>\n\n<pre><code>DECLARE\n    _r record;\n    t record;\n    i int := 0;\n    j int := 1;\n    count int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\n\nBEGIN\n\n     BEGIN \n\n        CREATE TEMPORARY TABLE tmpr (\n                id int,\n                source geometry,\n                target geometry,\n                dist_ft character varying\n        );\n\n  END;\n\n  BEGIN\n\n        CREATE TEMPORARY TABLE tmp (\n                ogc_fid int,\n                wkb_geometry character varying,\n                track_fid int\n        );\n   END;\n\nEND IF;\n\n\n    WHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\n\n LOOP\n\n--j := 1;\n\n--WHILE j &lt; 29 --DEPENDS ON THE NUMBER OF TRACK POINTS\n--LOOP\n\nEXECUTE 'INSERT INTO tmp (ogc_fid, wkb_geometry, track_fid)\nSELECT '|| quote_ident(gid_cname) ||' , ' ||quote_ident(geo_cname)||' , ' || quote_ident(tid_cname) ||'\nFROM ' ||quote_ident(geom_table)|| '\nWHERE ' ||quote_ident(tid_cname)|| ' = ' || i;\n\nFOR _r IN EXECUTE \n  ' SELECT *' \n||' FROM  tmp' \n\nLOOP\n\nEXECUTE 'INSERT INTO tmpr (id, source, target, dist_ft)\nSELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft '\n|| ' FROM tmp AS a INNER JOIN tmp As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY  dist_ft '\n|| ' Limit 1 ';\n\n\n--source_geom := temp.source;\n--target_geom := temp.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = tmpr.source\n    , target = tmpr.target\n    FROM tmpr\n    WHERE ' || quote_ident(gid_cname) || ' =  tmpr.id';\n\nEXECUTE 'delete from tmpr';\n\nEND LOOP;\n\n--j = j + 1;\n\n--END LOOP;\nEXECUTE 'delete from tmp';\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13019120,"title":"SQL Server 2008 Query to pull the max account date opened","body":"<p>i have the table as below,<br>\n        i would like to find the max(account_opened_date), if there is null date is existing, i have to show null values.</p>\n\n<p><strong>Scenario1</strong>  </p>\n\n<p><strong>Table1</strong>  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE\n11562               3880                07/05/2012\n11562               3884                08/05/2012\n11562               3885                09/06/2012\n11562               3886                10/06/2012\n11562               3881                NULL\n11562               3882                NULL  \n</code></pre>\n\n<p>the results are as below.  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE  \n11562               3882                NULL  \n</code></pre>\n\n<p>in the above scenario, i have to take null because, there is null values existing in account opened dates  </p>\n\n<p><strong>Scenario2</strong>  </p>\n\n<p><strong>Table1</strong>  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE  \n11563               3880                07/05/2012\n11563               3884                08/05/2012\n11563               3885                09/06/2012\n11563               3886                10/06/2012\n11563               3881                11/10/2011\n11563               3882                10/22/2012  \n</code></pre>\n\n<p>The results ARE AS below.  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE\n11563               3882                10/22/2012  \n</code></pre>\n\n<p>in the above scenario, i have to take 10/22/2012 because, there is no null values existing in account opened dates<br>\nPLEASE HELP!</p>\n"},{"tags":["php","mysql","query","transpose"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13019151,"title":"How to transpose MYSQL db in PHP","body":"<p>I am using PHP to query a MYSQL db to output data to a csv file. </p>\n\n<p>I am currently able to query the db and export the data to the CSV file.</p>\n\n<p>However i am unable to transpose the data so that the columns are rows, and rows are columns.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code> function transpose($array) {\n             if (!is_array($array) || empty($array)) {\n             return array();\n\n             else {\n                foreach ($array as $row_key =&gt; $row) {\n                    if (is_array($row) &amp;&amp; !empty($row)) { //check to see if there is a                  second dimension\n\n                foreach ($row as $column_key =&gt; $element) {\n                       $transposed_array[$column_key][$row_key] = $element;\n\n        else {\n               $transposed_array[0][$row_key] = $row;\n\n                   return $transposed_array;\n\n    }\n}\n\n    exportMysqlToCsv($tablename,$tokenmain, $id);\n    function exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){\n        $sql_query = \"select * from $tablename\";\n\n        // Gets the data from the database\n        $result = mysql_query($sql_query);\n\n        $f = fopen('php://temp', 'wt');\n        $first = true;\n\n        while ($row = mysql_fetch_assoc($result)) {\n\n            if ($first) {\n\n                fputcsv($f, array_keys($row));\n\n                $first = false;\n     }\n\n      fputcsv($f, $row);\n\n        } // end while\n\n        $size = ftell($f);\n        rewind($f);\n        header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n        header(\"Content-Length: $size\");\n\n     // Output to browser with appropriate mime type, you choose ;)\n        header(\"Content-type: text/x-csv\");\n        header(\"Content-type: text/csv\");\n        header(\"Content-type: application/csv\");\n        header(\"Content-Disposition: attachment; filename=$filename\");\n\n        fpassthru($f);\n\n        exit;\n    }\n</code></pre>\n\n<p>Somehow, those two functions should be intertwined to give me the output I need.</p>\n\n<p>Any help would be greatly appreciated. thanks!\n -Merica</p>\n"},{"tags":["java","sql","query","data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13019011,"title":"Need a recommendation for how to organize SQL result","body":"<p>I'm building a multi-tiered menu. So, for example, each main menu item might have 5-10 submenu items, and each of those might have 5-10 third level items. The menu items, no matter what tier they are from, are kept in a single table. The query I (currently) use to pull the data out looks like this:</p>\n\n<pre><code>SELECT *\nFROM menu_items AS m1\nLEFT JOIN (SELECT name AS slName, id AS slId, parent_id AS slPid FROM menu_items)\nm2 ON m1.id = m2.slPid\nLEFT JOIN (SELECT name AS tlName, id AS tlId, parent_id AS tlPid FROM menu_items)\nm3 ON m2.slId = m3.tlPid\nWHERE parent_id = 0\n</code></pre>\n\n<p>The result of this query visually looks like the menu I want, but now I'm thinking I may want to try and restructure so that I can stick it cleanly in an object, rather that just leaving it as a DataTable or whatever.</p>\n\n<p>Here's a sample result of the query above:</p>\n\n<p>For reference, sl means second level, tl means third level, etc.</p>\n\n<pre><code>{id=1, name=Industry, level=1, parent_id=0, slname=Equipment &amp; Machinery, slid=4, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Food, slid=5, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Fabricated Metal Products, slid=8, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Automotive, slid=9, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Chemicals and Allied Products, slid=10, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 1, slid=11, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 2, slid=12, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 3, slid=13, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 4, slid=14, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 1, slid=15, slpid=3, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 2, slid=16, slpid=3, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 3, slid=17, slpid=3, tlname=null, tlid=null, tlpid=null}\n</code></pre>\n\n<p>So the problem is now I end up with a bunch of rows which aren't really very nicely formatted to create a Menu object out of. I'm just looking for recommendations on how to restructure. Maybe change up the sql query so get a better base set of data or maybe an idea on how to format my current SQL. </p>\n"},{"tags":["query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13018556,"title":"Convert query letters to uppercase using Management Studio","body":"<p>Can I convert query syntax to uppercase using SQL Server Management Studio? I have a bunch of queries that are all written in lowercase letters, and I want to convert them all to uppercase letters. I'm looking for a built-in editor functionality. </p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13018192,"title":"How to write a query in SQL?","body":"<p>I have created some tables in SQL already, they are below:</p>\n\n<pre><code>CREATE TABLE Courses(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999) PRIMARY KEY,\n    Title VARCHAR(100) NOT NULL,\n    )\n\nCREATE TABLE CourseSections(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    SectionNo INTEGER,\n    InstructorNo INTEGER NOT NULL,\n    Year INTEGER,\n    Semester INTEGER,\n    RoomNo INTEGER NOT NULL,\n    Weekday INTEGER NOT NULL,\n    StartTime INTEGER NOT NULL,\n    FinishTime INTEGER NOT NULL,\n    Capacity INTEGER NOT NULL,\n    PRIMARY KEY(CourseNo, SectionNo, Year, Semester)\n    )\n\nCREATE TABLE Instructor(\n    InstructorNo INTEGER PRIMARY KEY,\n    FirstName VARCHAR(40) NOT NULL,\n    LastName VARCHAR(40) NOT NULL\n    )\n\nCREATE TABLE Students(\n    StudentNo INTEGER PRIMARY KEY,\n    FirstName VARCHAR(40) NOT NULL,\n    LastName VARCHAR(40) NOT NULL,\n    Year INTEGER,\n    GPA REAL\n    )\n\nCREATE TABLE Enrollments(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    Year INTEGER,\n    Semester INTEGER,\n    SectionNo INTEGER,\n    StudentNo INTEGER,\n    Grade REAL,\n    PRIMARY KEY(CourseNo, Year, Semester, SectionNo, StudentNo)\n    )\n\nCREATE TABLE Areas(\n    AreaName VARCHAR(40) PRIMARY KEY\n    )\n\nCREATE TABLE AreasOfCourse(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    AreaName VARCHAR(40),\n    PRIMARY KEY(CourseNo, AreaName)\n    )\n\nCREATE TABLE AreasOfInstructor(\n    InstructorNo INTEGER,\n    AreaName VARCHAR(40),\n    PRIMARY KEY(InstructorNo, AreaName)\n    )\n</code></pre>\n\n<p>Now, I wanna find the title of each course, and the total enrollment of that course for each semester, I have to write a query for this. So my work is below:</p>\n\n<pre><code>SELECT c1.Title, COUNT(e1.SectionNo), e1.Semester\nFROM Courses c1, Courses c2, Enrollments e1, Enrollments e2\nWHERE c1.CourseNo = c2.CourseNo AND e1.Semester = e2.Semester AND \n                  e1.SectionNo &lt;&gt; e2.SectionNo\n</code></pre>\n\n<p>There is an error comes up when I execute this query. The error is: </p>\n\n<blockquote>\n  <p>Column 'Courses.Title` is invalid in the select list because it is not\n  contained in either an aggregate function or the GROUP BY clause.</p>\n</blockquote>\n\n<p>Can anyone help me figure out how to solve this problem please?</p>\n"},{"tags":["mysql","query","rank"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":494,"score":2,"question_id":5347565,"title":"How to get a row rank?","body":"<p>HI,</p>\n\n<p>I actually posted similar (or same?) question yesterday, but I thought I need to post a new question since I have short, but clear question.</p>\n\n<p>I have the following table.</p>\n\n<pre><code>id  point\n1   30\n2   30\n3   29\n4   27\n5   28\n6   26\n</code></pre>\n\n<p>what I want:</p>\n\n<ol>\n<li><p>get all the users order by rank. user #1 and #2 should have 1 as their rank value because they both have 30 points</p></li>\n<li><p>I want to query a rank by user id. I like to get 1 as the result of my rank when I query user #1 and #2 because both of them have 30 points</p></li>\n</ol>\n\n<p><strong>Added on: 3/18</strong></p>\n\n<p>I tried Logan's query, but got the following result</p>\n\n<pre><code>id point   rank\n1   30  1\n2   30  1\n3   29  3\n4   27  5\n5   28  4\n6   26  6\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13017824,"title":"Count the number of nulls in each column","body":"<p>I've run into a DB that has tables that are excessively wide.  (600+ columns)  Even asking for the top 100 rows with no parameters takes 4 seconds.  I'd like to slim these tables down a bit.</p>\n\n<p>To figure out which columns can be most easily moved to new tables, or removed entirely, I would like to know how many nulls are in each column.  This should tell me what information is likely to be least important.</p>\n\n<p>How would I write a query that can find all columns and count the nulls inside those columns? </p>\n\n<p><strong>Edit</strong> The DB is SQL server 2008.  I'm <em>really</em> hoping not to type each of the columns individually.  It looks like sys.columns could help with this?</p>\n\n<p><strong>Edit2</strong> The columns are all different types.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13004638,"title":"Sum(count()) for last four months individually?","body":"<p>I have to find out tot(count) values with months for last 4 months individually how I can do this </p>\n\n<p>table stucture was </p>\n\n<pre><code>CREATE TABLE `lime_survey_16579` ( \n`id` int(11) NOT NULL auto_increment, \n`submitdate` datetime default NULL, \n`lastpage` int(11) default NULL, \n`startlanguage` varchar(20) collate utf8_unicode_ci NOT NULL, \n`token` varchar(36) collate utf8_unicode_ci default NULL, \n`16579X10X31` varchar(5) collate utf8_unicode_ci default NULLPRIMARY KEY (`id`) \n) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=480 ; \n</code></pre>\n\n<p>here $survey = lime_survey_16579 \nand $temp= 16579X10X31 \nhere 16579X10X31 has values like A1 A2 A3 .. </p>\n\n<p>How I can do this to give output like </p>\n\n<pre><code>tot month \n\n2 july \n4 aug \n6 sep \n9 oct \n</code></pre>\n\n<p>Can anybody help me? </p>\n"},{"tags":["python","django","query","django-mptt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13015828,"title":"Access get_root of a MPTT model through a query","body":"<p>Consider below example:</p>\n\n<pre><code>class ModelX(models.Model):\n    fieldX = models.ForeignKey(ModelY)\n\nclass ModelY(MPTTModel):\n\n    def root(self):\n        return get_root()\n\n    root = property(root)\n</code></pre>\n\n<p>Now I would like to make query like this</p>\n\n<pre><code>ModelX.objects.filter(fieldX__root=match)\n</code></pre>\n\n<p>or better yet directly calling <code>get_root()</code> like this</p>\n\n<pre><code>ModelX.objects.filter(fieldX__get_root=match)\n</code></pre>\n\n<p>which would make the <code>root()</code> method superfluous.</p>\n\n<p>None of the above seem to work though. Why is that? </p>\n"},{"tags":["sql-server-2008","query","full-text-search","contains"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12945479,"title":"How to do a CONTAINS() on two columns of Full Text Index Search SQL","body":"<p>I have a table (MyTable) with the following columns:</p>\n\n<p>Col1: NameID VARCHAR(50) PRIMARY KEY NOT NULL\nCol2: Address VARCHAR(255)</p>\n\n<p>Data Example:</p>\n\n<p>Name: '1 24'\nAddress: '1234 Main St.'</p>\n\n<p>and i did a full text index on the table after making the catalog using default params.</p>\n\n<p>How can I achieve the following query:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(NameID, '1')\n AND CONTAINS(Address, 'Main St.');\n</code></pre>\n\n<p>But my query is returning no results, which doesn't make sense because this does work:</p>\n\n<pre><code> SELECT * FROM MyTable\nWHERE CONTAINS(Address, 'Main St.');\n</code></pre>\n\n<p>and so does this:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(Address, 'Main St.')\n AND NameID LIKE '1%'\n</code></pre>\n\n<p>but this also doesn't work:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(NameID, '1');\n</code></pre>\n\n<p>Why can't I query on the indexed, primary key column (Name) when I selected this column to be included with\nthe Address column when setting up the Full Text Index?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["json","query","scala","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13014774,"title":"Retrieving nested element from MongoCursor","body":"<p>I am querying a Mongo DB in Scala and looping through the returned elements, that look like this: </p>\n\n<pre><code>{ \"_id\" : \"123:1350918540586068000:v\" , \n    \"i\" : { \n        \"vendorStyle\" : \"coolStyle\" , \n        \"createdAt\" : 1350918540580 , \n        \"productId\" : \"product123\" , \n        \"skuId\" : \"123\"\n    }\n}\n</code></pre>\n\n<p>My question is: how do I retrieve the value from skuId? I know you can use the notation parent.child in the 'find' method in Mongo, but that doesn't work when reading from the resulting DBObject</p>\n\n<p>This is the code:</p>\n\n<pre><code>val elems = SkuStorage.collection.find(MongoDBObject(\"i.productId\" -&gt; productId))\nelems.toSeq.map { element=&gt;\n    readSkuById(element.get(\"i.skuId\")) //breaks! \n}\n</code></pre>\n\n<p>Do I need to go get(\"i\") then parse the string into a JSON? Is there any better way of handling this?</p>\n"},{"tags":["sql","query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13015993,"title":"MS-SQL get difference value","body":"<p>I have this query that calculates current gallons value from all fuel tanks in my database.</p>\n\n<pre><code>SELECT DISTINCT y.TankNumber as TankNumber\n    , y.Gallons as Gallons\n    , y.timeUpdated\n    , y.FuelType as FuelType\nFROM (\n    SELECT TankNumber, max(timeUpdated) as maxdate\n    FROM someTable\n    GROUP BY TankNumber) as x\nJOIN someTable y\nON x.TankNumber = y.TankNumber\nAND x.maxdate = y.timeUpdated\nORDER BY y.TankNumber\n</code></pre>\n\n<p>Based on the fuel usage, data gets dumped in to my database automatically at any time. And query above will give me only the current gallons value in each fueltank:<br /></p>\n\n<pre><code>TankNumber  |  Gallons  |  timeUpdated        |  FuelType\n     1      |  14       |  2012-10-22 04:16   |  89\n     2      |  8        |  2012-10-22 04:14   |  93\n</code></pre>\n\n<p>and etc..<br />\nMy problem is, that I am trying to add another output value to my page, that will give me a difference how much fuel was used since last update. So it will look something like this:<br /></p>\n\n<pre><code>TankNumber  |  Gallons  |  timeUpdated        |  FuelType  |  GallonsUsed\n     1      |  14       |  2012-10-22 04:16   |  89        |  5\n     2      |  8        |  2012-10-22 04:14   |  93        |  -11\n</code></pre>\n\n<p>Unfortunately my SQL experience is not as solid for this type of problem and I have spent about two days trying to figure out or google something close. So, any help will be greatly appreciated.</p>\n"},{"tags":["mysql","query","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13011123,"title":"Why is this trigger making some of my inserts hang?","body":"<p>The trigger is as follows:     </p>\n\n<pre><code>DELIMITER //\nCREATE TRIGGER `Conturi_BI` BEFORE INSERT ON `Conturi` FOR EACH ROW BEGIN\nSET NEW.CUI_cod = digits(NEW.CUI);\nEND//\nDELIMITER ;\n</code></pre>\n\n<p>I'm just applying a digits function to a user input for faster matching and duplicates search, but ever since I implemented it some of my Inserts just hang. I made a similar one for updates and it doesn't have the same problem.</p>\n\n<p>The digits function is created by me and the trigger and inserts work fine most of the time.</p>\n\n<p>The digits function, as requested:</p>\n\n<pre><code>BEGIN\n  DECLARE i, len SMALLINT DEFAULT 1;\n  DECLARE ret CHAR(32) DEFAULT '';\n  DECLARE c CHAR(1);\n  SET len = CHAR_LENGTH( str );\n  REPEAT\n    BEGIN\n      SET c = MID( str, i, 1 );\n      IF c BETWEEN '0' AND '9' THEN \n        SET ret=CONCAT(ret,c);\n      END IF;\n      SET i = i + 1;\n      END;\n  UNTIL i &gt; len END REPEAT;\n  RETURN ret;\nEND\n</code></pre>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13014046,"title":"MS Access Query to display latest Active Part Number","body":"<p>I have following Table \"Replaced\" in MS Access.</p>\n\n<pre><code>ID  PartNumber  ReplacedNumber  Status\n4   b                       Active\n5   c           b           Replaced\n6   d           b           Replaced\n7   e           c           Replaced\n8   h           d           Replaced\n9   104308          408077-0102 Replaced\n10  310224          408077-0102 Replaced\n11  0R5888          408077-0102 Replaced\n12  4N6515          408077-0102 Replaced\n13  4N6860          408077-0102 Replaced\n14  408077-0102 408077-5102 Replaced\n15  408077-5102 408077-5102S    Replaced\n16  408077-5102S                Active\n</code></pre>\n\n<p>Query requirement</p>\n\n<p>The final answer for any of these numbers (104308, 310224, 0R5888, 4N6515, 4N6860, 408077-0102, 408077-5102, 408077-5102S) should be 408077-5102S as this number has superseded all the rest. So, if my query has a criteria, [Please Enter part number to find the latest number], the resultant number should be 408077-5102S. As, it is the only Active number and has superseded all the rest.</p>\n\n<p>Similarly, The final answer for any of these numbers (b, c, d, e, h) should be b as this number has superseded all the rest. So, if my query has a criteria, [Please Enter part number to find the latest number], the resultant number should be b. As, it is the only Active number and has superseded all the rest.</p>\n\n<p>Any ideas? I have also looked at <a href=\"http://stackoverflow.com/questions/12972219/replacing-values-in-sql-microsoft-access\">Replacing Values in SQL (Microsoft Access)</a> but it does not help.</p>\n"},{"tags":["sql","query","mysql-like"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12993752,"title":"select where string doesn't match exactly","body":"<p>It's my table rows:</p>\n\n<pre><code>++ id ---- text ++++++++++++++\n-- 1  ---- '90','80,'50' -----\n-- 2  ---- '30','2','1_2' --\n-- 3  ---- '10_2','5_3' -----\n</code></pre>\n\n<p>as you see, <code>text</code> contains 2 types of numbers, one doesn't have underscore, and the other does.</p>\n\n<p>I want to select rows which have at least one number without underscore (type 1). Something like this: (result-set)</p>\n\n<pre><code>++ id ---- text ++++++++++++++\n-- 1  ---- '90','80,'50' -----\n-- 2  ---- '30','2','1_2' --\n</code></pre>\n\n<p>(<code>3</code> is ignored)</p>\n\n<p>How to do that? (I think it's possible with <code>NOT LIKE</code>, but I don't know how to write)</p>\n"},{"tags":["sql","sql-server","performance","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":63,"score":1,"question_id":12558483,"title":"SQL query slow calculating cumulative totals","body":"<p>We are storing data readings at 5 minute intervals for a large number of gauges.</p>\n\n<p>The data tables involved are:</p>\n\n<pre><code>Table1 - GaugeData\nColumns - \n    GaugeID (int, primary key)\n    Timestamp (datetime, primary key)\n    Value (decimal)\n\nTable2 - GaugeSummaryData\nColumns - \n    GaugeID (int, primary key)\n    DayTimestamp (date, primary key)\n    DayTotal (decimal) - total for the current date/day\n    CumulativeTotal (decimal) - total up to and including the current date\n</code></pre>\n\n<p>Without changing the table structure in any way, what would be the most efficient way to copy and aggregate data from GaugeData into GaugeSummaryData?</p>\n\n<p>I have attempted this two ways already. Using a cursor takes 40 minutes to copy all data from GaugeData to GaugeSummaryData. Using insert/update statements took 2hrs+.</p>\n\n<p>Could somebody please suggest the most efficient way? Pseudocode or SQL appreciated.</p>\n"},{"tags":["mysql","database","string","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13014217,"title":"Mysql replace function returns null","body":"<p>I have a table activity_types which contains the text for activities e.g. <br />\n<code>New project has been assigned to {user} with name {project}</code> <br />\n<code>New discussion has been posted by {client} on {project}</code> <br />\n<code>Project {project} has been closed by {user}</code> <br />\n<code>A draft has been approved by {client} on {project}</code><br />\nand so on</p>\n\n<p>I have another table in which the id of these texts has been populated.</p>\n\n<p>Now my requirement is to fetch these by replacing the text within {} with their actual values like {client} should be replaced with client name, {project} should be replaced with project name. </p>\n\n<p>I have tried using nested replace mysql function but it returns null string. Here is my query</p>\n\n<pre><code>SELECT      REPLACE(REPLACE(REPLACE(att.type_text, '{project}', p.project_business_name), '{user}', u.user_fullname), '{client}', c.client_name) AS activity, a.*\nFROM        activities a\nLEFT JOIN   activity_types AS att ON att.type_id = a.activity_type\nLEFT JOIN   users u ON u.user_id = a.activity_user AND a.activity_user IS NOT NULL\nLEFT JOIN   projects p ON p.project_id = a.activity_project AND p.project_is_removed = '0'\nLEFT JOIN   clients c ON c.client_id = a.activity_client AND a.activity_client IS NOT NULL;\n</code></pre>\n\n<p>The problem is that if i replace the c.client_name with static text it works fine but when i replace the static string with c.client_name it return null in activities which does not have {client}. Any guesses where am i doing wrong?</p>\n"},{"tags":["mysql","sql","database","query","aggregate-functions"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":2116,"score":3,"question_id":6131197,"title":"mysql count the sum of all rows","body":"<p>I have a mysql table that has a number of rows, and in each row a field called \"value\",\nthe field value will differ from row to row.\nWhat I want, is to select all the rows and count the sum of all the \"value\" fields.</p>\n\n<p>any idea?</p>\n"},{"tags":["mysql","sql","query","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":4661,"score":1,"question_id":6715095,"title":"How to SUM and SUBTRACT using SQL?","body":"<p>I am using MySQL and I have two tables:</p>\n\n<p><code>master_table</code></p>\n\n<ul>\n<li>ORDERNO </li>\n<li>ITEM</li>\n<li>QTY</li>\n</ul>\n\n<p><code>stock_bal</code> </p>\n\n<ul>\n<li>ITEM </li>\n<li>BAL_QTY</li>\n</ul>\n\n<p>Master table has duplicate <code>ORDERNO</code> and <code>ITEM</code> values. I have get total <code>QTY</code> using SQL 'GROUP BY' clause.</p>\n\n<p>I need to deduct/subtract <code>BAL_QTY</code> from SUM of <code>ITEM</code> (master_table).  I've got SUM <code>QTY</code> value using query (actually there are many rows).</p>\n"},{"tags":["c#","query","usergroups","principalcontext","principalsearcher"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13012497,"title":"Query PrincipalSearcher for containing multiple strings","body":"<p>I want to be able to query the active directory give a list of all groups containing certain words like Users or Administrators below is what i've got so far</p>\n\n<pre><code>PrincipalContext ctx = new PrincipalContext(ContextType.Domain);\nGroupPrincipal qbeGroup = new GroupPrincipal(ctx);\nqbeGroup.DisplayName = \"Administrators\";\nqbeGroup.DisplayName = \"Users\";\nPrincipalSearcher srch = new PrincipalSearcher(qbeGroup);\nreturn srch.FindAll().Select(g =&gt; g.Name).ToArray();\n</code></pre>\n\n<p>This code doesn't even seem to filter out the the Group names that is not Administrators or Users. But anyway what I can't figure out is how to query if the group name contains? and not if group name is equal to and how to do this of multiple strings.</p>\n\n<p>I can do the same thing using DirectoryEntry so I put it here for referance</p>\n\n<pre><code>var groups = new List&lt;string&gt;();\nvar path = string.Format(\"LDAP://CN=Users,DC=company,DC=com\");\nvar computerEntry = new DirectoryEntry(path);\n\nif (computerEntry != null)\n   {\n       using (computerEntry)\n       {\n            var userNames =\n            from DirectoryEntry childEntry\n            in computerEntry.Children\n            where childEntry.SchemaClassName == \"Group\"\n            select childEntry.Name;\n            foreach (var name in userNames)\n            {\n                 if (name.Contains(\"Administrators\") || name.Contains(\"Users\"))\n            {\n             groups.Add(name);\n       }\n   }\n}\n}\nreturn groups.ToArray();\n</code></pre>\n"},{"tags":["oracle","query","join","group"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13002043,"title":"For each row of one table, count entries in another table pointing to each of those rows in Oracle","body":"<p>Not sure the title explains the problem well; this is what I'm working with,</p>\n\n<p>I have the following tables,</p>\n\n<pre><code>-- table = kms_doc_ref_currnt_v\nDOC_ID    VARCHAR2(19)\nTO_DOC_ID    VARCHAR2(19)\nBRANCH_ID    NUMBER(8)\nREF_TYP_CD    VARCHAR2(20)\n\n-- table = kms_fil_nm_t\nDOC_ID    VARCHAR2(19)    PRIMARY KEY    UNIQUE\n</code></pre>\n\n<p>For example, I can get a count of all <code>kms_doc_ref_currnt_v</code> records that have a <code>to_doc_id = 59678</code>, where 59678 is one value in <code>kms_fil_nm_t</code>, with this query,</p>\n\n<pre><code>select 'doc_id 59678 has ' || count(to_doc_id) as cnt from kms_doc_ref_currnt_v where branch_id=1 and ref_typ_cd in ('CONREF', 'KBA') and to_doc_id=59678;\n</code></pre>\n\n<p><code>kms_doc_ref_currnt_v.to_doc_id</code> is a field that has one of the <code>kms_fil_nm_t.doc_id</code> values. <code>kms_doc_ref_currnt_v.doc_id</code> is also one of the values in <code>kms_fil_nm_t</code>.</p>\n\n<p>The single query I'm looking for would loop over each <code>kms_fil_nm_t.doc_id</code> and count all the rows in <code>kms_doc_ref_currnt_v</code> that have a similar <code>to_doc_id</code>. Each row returned would look like the output of the query above. Here's example output,</p>\n\n<pre><code>doc_id 1 has 32\ndoc_id 2 has 314\ndoc_id 3 has 2718\ndoc_id 4 has 42\ndoc_id 5 has 128\ndoc_id 6 has 11235\n.\n.\n.\n</code></pre>\n\n<p>Probably simple but I just can't figure it out. Thanks</p>\n"},{"tags":["sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13011900,"title":"Need help to get records of current date?","body":"<p>I am trying to write Stored Procedure for getting records for current date, but I am not able to do so. I have created one for record display with latest first &amp; trying to modify the same </p>\n\n<p>Here is the code of same:-</p>\n\n<pre><code>SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[SP_SELECTTODAYRECORDS_Test]\nAS\nBEGIN \n    SELECT col_Source as 'country', \n    col_FirstName +' '+col_LastName as 'name',\n    description as 'state' ,\n    col_county\n    from tbl_Info_Test, tbl_CountySite \n    where col_Pic is not null\n    and col_Source = sourcecountry\n    and ISDATE(col_BookDate) = 1\n    order by CONVERT(datetime, col_BookDate) DESC\nEND\n</code></pre>\n\n<p>Could you please help me out to modify the same. thanks in advance.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13008949,"title":"How do I write an update query for duplicate records","body":"<p>My knowledge of MySQL is pretty basic and I struggle with complicated queries - for me, the following problem is complicated - hopefully it's not for you!</p>\n\n<p>I've been importing businesses to my database, some of which have the same company name. For instance, we have two Subway branches in the table, both with different addresses.</p>\n\n<p>I'd like to set the Company Name to be \"Company Name\" + \"Town\" so we end up with unique fields:</p>\n\n<ul>\n<li>Subway London </li>\n<li>Subway Manchester</li>\n</ul>\n\n<p>So far, all I've managed to do is check out which Company names appear in the db twice with:</p>\n\n<pre><code>SELECT CompanyName , count( CompanyName )\nFROM directorydata\nGROUP BY CompanyName \nHAVING count( CompanyName ) &gt;1\n</code></pre>\n\n<p>How do I go about updating each of the CompanyName field with it's current value, plus that of the Town field?</p>\n\n<p>Your help is greatly appreciated!</p>\n"},{"tags":["mysql","query","stored-procedures","csv","match-against"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":2,"view_count":396,"score":3,"question_id":9950216,"title":"Grouping a comma separated value on common data","body":"<p>I have a table with col1 id int, col2 as varchar(comma seperated value) and column 3 for assigning group to them.\nTable looks like</p>\n\n<pre><code>  col1          col2     group\n..............................\n       1        2,3,4       \n       2        5,6        \n       3        1,2,5\n       4        7,8\n       5        11,3\n       6        22,8\n</code></pre>\n\n<p>this is only the sample of real data, now i have to assign a group no to them in such a way that output looks like</p>\n\n<pre><code>  col1          col2       group\n..............................\n       1        2,3,4       1\n       2        5,6         1\n       3        1,2,5       1\n       4        7,8         2\n       5        11,3        1\n       6        22,8        2\n</code></pre>\n\n<p>The logic for assigning group no is that every similar comma seperated value of string in col2 have to be same group no as every where in col2 where '2' is there it has to be same group no but the complication is that 2,3,4 are together so they all three int value if found in any where in col2 will be assigned same group.\n   the major part is 2,3,4 and 1,2,5 both in col2 have 2 so all int 1,2,3,4,5 have to assign same group no.\nTried store procedure with match against on col2 but not getting desired result</p>\n\n<p>Most imp( i can't use normalization,because i cant afford to make new table from my original table which have millions of record) ,even normalization is not helpfull in my context.</p>\n\n<hr>\n\n<p>Achieved so far......\nIhave set the group column auto increment and then wrote this procedure:-</p>\n\n<pre><code>BEGIN\n  declare cil1_new,col2_new,group_new int;\n  declare done tinyint default 0;\n  declare group_new varchar(100);\n  declare cur1 cursor for select col1,col2,`group` from company ; \n  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=1;\n  open cur1;\n  REPEAT\n  fetch cur1 into col1_new,col2_new,group_new;\n  update company set group=group_new where\n  match(col2) against(concat(\"'\",col2_new,\"'\"));\n  until  done end repeat;\n  close cur1;\n  select * from company;\nEND\n</code></pre>\n\n<p>This procedure is working,no syntex mistake but the proble is that i am not acheiving the desired result exectly.</p>\n"},{"tags":["php","query","propel","generate","peer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12997208,"title":"propel generated peer and query filename","body":"<p>I added propel library in my codeigniter project\nCodeigniter 2.1.3 Propel 1.6.7\nbut apparently as propel users know it generates camelcase names</p>\n\n<p>ex. UsersQuery.php UsersPeer.php</p>\n\n<p>but codeigniter wont accept camelcase names when executing </p>\n\n<pre><code>$this-&gt;load-&gt;model('UsersQuery');\n</code></pre>\n\n<p>does anyone know how to change generated propel model class to lowercase filenames?\nbecause if i will just rename each file, i will do it everytime i generate classes and it's not efficient, thank you for your response.</p>\n"},{"tags":["javascript","css","query","printing","media"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":159,"score":7,"question_id":12371822,"title":"How can I print an image in a web page, fitting the paper size (A3, A4, A5, etc)?","body":"<p>I am currently using IE9 and media queries and I have no need to have this working from other browsers.</p>\n\n<p>I tried using a set of rules like:</p>\n\n<pre><code>@page {\n    size: auto;\n    margin: 10mm 10mm 10mm 10mm;\n}\n</code></pre>\n\n<p>//... rules to match the millimiters of all the A formats (A0, A1, A2, etc) including margins and tolerance</p>\n\n<pre><code>/* A4 210x297 mm */\n@media print and (min-height: 266mm) and (max-height: 288mm) and\n    (min-width: 179mm) and (max-width: 201mm) {\n    .img_port {\n        height: 267mm !important;\n    }\n}\n</code></pre>\n\n<p>// ...</p>\n\n<p>it seems to be working but it is not reliable because the size height and the width values passed to the CSS seems to depend on the printer even if the A4 format is always selected.</p>\n\n<p>What I want to ask is if there is any other possible way to obtain the same result (fitting the image on one page according to the paper size).</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13007172,"title":"Conditional query depending on 2 checkbox","body":"<p>I am creating a query that depends on several input form values, and at some point I am working on three values.  The first value queried has to be always 0, so I have this:</p>\n\n<pre><code>.. AND value_1 = 0\n</code></pre>\n\n<p>What I want to be able to do cleanly is the following:</p>\n\n<p>If checkbox_2 is checked:</p>\n\n<pre><code>... AND (value_1 = 0 OR value_2 = 0)\n</code></pre>\n\n<p>If checkbox_3 is checked</p>\n\n<pre><code>... AND (value_1 = 0 OR value_3 = 0)\n</code></pre>\n\n<p>If checkbox_2 and checkbox_3 are checked</p>\n\n<pre><code>... AND (value_1 = 0 OR value_2 = 0 OR value_3 = 0)\n</code></pre>\n\n<p>I am creating the SQL query in a string, and I am wondering what would be a clean way to do this.</p>\n"},{"tags":["database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":13005728,"title":"Slow Database Query","body":"<p>I have a query something like this: </p>\n\n<pre><code>SELECT title FROM Table WHERE friendly_url = 'friendlyurl'\n</code></pre>\n\n<p>But a Server says that the query is slow and consume a lot of server resources and they paste the actual query:</p>\n\n<pre><code>SELECT title FROM Table WHERE friendly_url =\n'friendlyurl' and 9=16 union select\nconcat(0x6D6E617879,(hex(compress(concat_ws(0x03,(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n120,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n121,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n122,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n123,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n124,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n125,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n126,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n127,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n128,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n129,1))))),0x7861306969) -- a' LIMIT 1 \n</code></pre>\n\n<p>Can anyone explain this to me? Please. </p>\n"},{"tags":["query","post"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":12997176,"title":"Update Table row on Particular date which is stored in another table","body":"<p>The problem I am facing is, I am having a table in which I have Cheque Amount And Cheque Date Field. So, Sometimes I might have <strong>post</strong> dated Cheque, may be of after 3-4 days.. So in this case, on particular date Cheque amount should add to related bank amount. Here I need some help.</p>\n"},{"tags":["database","sql-server-2008","query","grails-2.0","grails-controller"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12967518,"title":"SQL Querying Database","body":"<p>I have this following query\n <code>\"select abc from table where val = 1\"</code><br/>\nThe result i got was </p>\n\n<pre><code> [{abc=5}]\n</code></pre>\n\n<p>However, I <strong>need just the integer value 5</strong> from the result <strong>instead of the array[{abc=5}]</strong>.<br/>\nAnyone have any idea on how to do this? thanks\n*My friend told me that I will need to use substring to get just the 5 out from the [{abc=5}], but i have completely no clue on how to work on it. Any help will be appreciated!</p>\n\n<p>*edited </p>\n"},{"tags":["c#","xml","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13004201,"title":"LINQ XML Subquery - Need Assistance","body":"<p>My current LINQ query and example XML are below. What I'd like to do is select the primary image urls from the  as well as the other attributes such as trim, body, make, model, etc.</p>\n\n<p>What is the best way to do this?</p>\n\n<pre><code>&lt;response&gt;\n&lt;objects&gt;\n    &lt;object&gt;\n        &lt;trim&gt;LT&lt;/trim&gt;\n        &lt;body&gt;4dr Car&lt;/body&gt;\n        &lt;warranty_miles /&gt;\n        &lt;color&gt;WHITE&lt;/color&gt;\n        &lt;selling_price&gt;0.00&lt;/selling_price&gt;\n        &lt;vin&gt;1g1jc5sh3c4198042&lt;/vin&gt;\n        &lt;has_service_contract &gt;False&lt;/has_service_contract&gt;\n        &lt;year&gt;2012&lt;/year&gt;\n        &lt;alt_id&gt;&lt;/alt_id&gt;\n        &lt;stock_num&gt;1205362&lt;/stock_num&gt;\n        &lt;has_warranty&gt;False&lt;/has_warranty&gt;\n        &lt;warranty_month /&gt;\n        &lt;make&gt;CHEVROLET&lt;/make&gt;\n        &lt;date_manufactured /&gt;\n        &lt;interior_color&gt;Dark Pewter/Dark Titanium&lt;/interior_color&gt;\n        &lt;date_updated&gt;2012-10-17&lt;/date_updated&gt;\n        &lt;date_dealer_created&gt;2012-06-06&lt;/date_dealer_created&gt;\n        &lt;certification_warranty /&gt;\n        &lt;status/&gt;\n        &lt;vevo&gt;&lt;/vevo&gt;\n        &lt;image_urls&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/1764e186eabe4ae892f6230107b862cf.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/3eeb7050770849e8937191d09453d936.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/7f6c1f172f7b4944ac2d165c0dfbcb09.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/82d242ba07bb4bb9a7c8514ea1aadae7.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/93e3cac89d0f4872b86acd9c2d94695a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/edec4ffe9b2349ffabea9dcb25a78d1e.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/f2c1dbb15fec4cf6a62b7842db22763a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/fa7341e250654533a9de2a756d4274eb.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n          &lt;/image_urls&gt;\n       &lt;/object&gt;\n   &lt;/objects&gt;\n &lt;/response&gt;\n</code></pre>\n\n<p>Here is what I have so far</p>\n\n<pre><code>        var users = from m in main2.Elements(\"object\")\n                    select new Inventory \n                    {\n                        Make = (string)m.Element(\"make\"),\n                        Year = (string)m.Element(\"year\"),\n                        Model = (string)m.Element(\"model\"),\n                    };\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12679822,"title":"How to Determine the Age of a Person in aTable","body":"<p>I am trying to determine the age of the people that are listed in my database. This is what I came up with, but I can't seem to limit the query to show people who are only 18 and under.     </p>\n\n<pre><code>SELECT \n  * \nFROM \n  patientdetails \nWHERE \n  ageInYears IN (\n    SELECT \n      DATEDIFF(CURRENT_DATE, STR_TO_DATE(p.DOB, '%d-%m-%Y'))/365 AS ageInYears \n    FROM \n      patientdetails p\n  ) &lt; 19\n</code></pre>\n"},{"tags":["mysql","query","pdo","prepared-statement","max"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":11991752,"title":"Getting maximum value from a column in a MySQL table, increasing value by 1 and passing to variable","body":"<p>I am using the query below to extract the maximum value of a column called id in a MySQL table, so that I can increase it's value by 1 and pass it to a variable called $fav_id.  For some reason $fav_id is returning '0', instead of the value I want, i.e. if the maximum current value in the id column is 465, then $fav_id should be set to 466.  Perhaps someone could let me know where I am going wrong.</p>\n\n<pre><code>$sth2 = $pdo-&gt;prepare(\"SELECT MAX(id) AS id FROM tracks\");\n\n$sth2-&gt;setFetchMode(PDO::FETCH_OBJ);\n\nwhile($row = $sth2-&gt;fetch()) {\n    $fav_id = $row-&gt;id+1;\n}\n</code></pre>\n"},{"tags":["mysql","sql","json","query"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":12998610,"title":"MySQL view query without Json from a table containing some Json objects","body":"<p>Ive been trying to make a new MySQL view without Json from an existing MySQL table which contain some Json objects. Table 1 is the current table. Table 2 is the new MySQL view derived from Table 1. The content of table 2 will always reflect table 1 content. The difference is just the structure.</p>\n\n<p>Below are simplified tables for our example context where actually there are more than 20 columns.</p>\n\n<h1>Table 1 (3 columns)</h1>\n\n<pre><code>user_id | name |          params\n---------------------------------------------\n   1    | john |{\"age\":\"26\",\"gender\":\"male\"}\n   2    | amy  |{\"age\":\"28\",\"gender\":\"female\"}\n</code></pre>\n\n<h1>Table 2 (4 columns)</h1>\n\n<pre><code>user_id | name | age | gender\n-----------------------------\n   1    | john | 26  | male\n   2    | amy  | 28  | female\n</code></pre>\n\n<p>The data flow is like this: \nAt anytime, user key in data from 3rd party custom form and got saved into Table 1. The data however need to be pulled from the Table 2 format, also at anytime.</p>\n\n<p>How can we achieve this using only SQL queries? Thank you in advance. This will sure helps many developers out there coping with Json as new standard. Cheers!</p>\n"},{"tags":["python","query","django-orm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13002877,"title":"List out of index Error","body":"<p>I have a for loop such as:</p>\n\n<pre><code>staff = Staff.objects.all().order_by('person__full_name')\nfor k in staff:\n    categ = k.staff_job_categories.all()[1]\n    if categ.name == unicode(\"xxx\",\"utf-8\"):\n        t = categ.name\n</code></pre>\n\n<p>But for <code>categ = k.staff_job_categories.all()[1]</code>\nI get an List out of index Error.</p>\n\n<p>Any ideas? </p>\n"},{"tags":["mysql","query","optimization","join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13001981,"title":"How do I optimize my query?","body":"<p>I've written a query to pull a report from a WordPress database. The query is unbelievable slow so I want to optimize it. I've done a bit of research and am having trouble understanding what is the best way top speed up the query (which, even though I wrote, I barely understand what I did.) Can someone point me in the right direction toward optimizing this slow query.</p>\n\n<pre><code>SELECT\nwp1.meta_value as firstName,\nwp2.meta_value as middleName,\nwp3.meta_value as lastName,\nwp5.meta_value as email2,\nwp6.meta_value as address,\nwp7.meta_value as city,\nwp8.meta_value as state,\nwp9.meta_value as zip,\nwp10.meta_value as country,\nwp11.meta_value as phone,\nwp12.meta_value as dateOfBirth\nFROM wp99_usermeta wp1\nJOIN wp99_usermeta wp2 ON wp1.user_id = wp2.user_id and wp2.meta_key = 'middle_name'\nJOIN wp99_usermeta wp3 ON wp1.user_id = wp3.user_id and wp3.meta_key = 'last_name'\nJOIN wp99_usermeta wp5 ON wp1.user_id = wp5.user_id and wp5.meta_key = 'email2'\nJOIN wp99_usermeta wp6 ON wp1.user_id = wp6.user_id and wp6.meta_key = 'street_address'\nJOIN wp99_usermeta wp7 ON wp1.user_id = wp7.user_id and wp7.meta_key = 'city'\nJOIN wp99_usermeta wp8 ON wp1.user_id = wp8.user_id and wp8.meta_key = 'state'\nJOIN wp99_usermeta wp9 ON wp1.user_id = wp9.user_id and wp9.meta_key = 'zip'\nJOIN wp99_usermeta wp10 ON wp1.user_id = wp10.user_id and wp10.meta_key = 'country'\nJOIN wp99_usermeta wp11 ON wp1.user_id = wp11.user_id and wp11.meta_key = 'phone'\nJOIN wp99_usermeta wp12 ON wp1.user_id = wp12.user_id and wp12.meta_key = 'date_of_birth'\nWHERE wp1.meta_key = 'first_name' \n</code></pre>\n\n<p>The default <code>wp_usermeta</code> table structure:</p>\n\n<pre><code>CREATE TABLE `wp_usermeta` (\n  `umeta_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) unsigned NOT NULL DEFAULT '0',\n  `meta_key` varchar(255) DEFAULT NULL,\n  `meta_value` longtext,\n  PRIMARY KEY (`umeta_id`),\n  KEY `user_id` (`user_id`),\n  KEY `meta_key` (`meta_key`)\n) ENGINE=***  DEFAULT CHARSET=utf8 AUTO_INCREMENT=15 ;\n</code></pre>\n\n<p>Trying the ALTER TABLE suggestion. This is giving me an error at line 5</p>\n\n<p>ALTER TABLE wp99_usermeta\n    ADD INDEX meta_key__user_id \n      (meta_key, user_id) ;</p>\n\n<pre><code>SELECT\nwp1.meta_value as firstName,\nwp2.meta_value as middleName,\nwp3.meta_value as lastName,\nwp5.meta_value as email2,\nwp6.meta_value as address,\nwp7.meta_value as city,\nwp8.meta_value as state,\nwp9.meta_value as zip,\nwp10.meta_value as country\nFROM wp99_usermeta wp1\nJOIN wp99_usermeta wp2 ON wp1.user_id = wp2.meta_key__user_id = 'middle_name'\nJOIN wp99_usermeta wp3 ON wp1.user_id = wp3.meta_key__user_id = 'last_name'\nJOIN wp99_usermeta wp5 ON wp1.user_id = wp5.meta_key__user_id = 'email2'\nJOIN wp99_usermeta wp6 ON wp1.user_id = wp6.meta_key__user_id = 'street_address'\nJOIN wp99_usermeta wp7 ON wp1.user_id = wp7.meta_key__user_id = 'city'\nJOIN wp99_usermeta wp8 ON wp1.user_id = wp8.meta_key__user_id = 'state'\nJOIN wp99_usermeta wp9 ON wp1.user_id = wp9.meta_key__user_id = 'zip'\nJOIN wp99_usermeta wp10 ON wp1.user_id = wp10.meta_key__user_id = 'country'\nWHERE wp1.meta_key = 'first_name' \n</code></pre>\n"},{"tags":["mysql","sql","database","query","table"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":267,"score":2,"question_id":12932993,"title":"How to form a sql query","body":"<p>Hi all so here is the problem that I need to solve:</p>\n\n<p>This is the table that I need to get for each user.</p>\n\n<pre><code>Date        | Working time (day) | Night shifts (23:00 - 06:00) | Total(day + night) |             | Notes\n3.9.        |    7               |               2              |         9          |      1      | \n4.9.        |    8               |               0              |         8          |             |  \n5.9.        |    6               |               2              |         8          |             |\n6.9.        |    4               |               3              |         7          |             |\n7.9.        |    0               |               0              |         0          |             |\n8.9.        |    0               |               0              |         0          |             |\n9.9.        |    0               |               0              |         0          |             |\n10.9.       |    0               |               0              |         0          |             |\nTotal(week) |    25              |               7              |         32         |  Total(&gt;48h)|    0    \n</code></pre>\n\n<p>So let me explain this. User chooses the week in this example it is a from 3.9-10.9, user has unique key. Everything in this table needs to be generated in sql if this is possible. So the first column is date, second one is a working time which is between (06:00-23:00), third column is night shift between (23:00-06:00), fourth column is Total of day and night shift, fifth column is only filled if fourth column is bigger then 8 i.e. 9h of total - 8 is 1,sixth column is only filled if Total of(day and night shifts) at the bottom is bigger then 48h and then difference is written in that last column.</p>\n\n<p>My current table with data has this columns: <code>user_key,id,time</code></p>\n\n<p>Now this would be an example of what should query do:</p>\n\n<pre><code>    1. user_key(100), id(1), time(15:00); \n    2. user_key(200), id(2), time(15:05); \n    3. user_key(100), id(3), time(16:00); \n    4. user_key(100), id(4), time(16:05); \n    5. user_key(100), id(5), time(17:05); \n\n    3.-1. = 1h \n    5.-4. = 1h \n\n    Result: \n    user_key(100), day_shift(2h)\n</code></pre>\n\n<p>So we user_key is unique for each user and id is auto-incrementing, we always need to take first and the second record for the same user and save result and then second two records for that user and save working time and so on...\nHow to achieve this? I need to use some sql variables? Of course it has to have to options if it is a day shift and night shift as we don't want to save working time in the wrong column.</p>\n\n<p>EDIT:</p>\n\n<p>As I see that lot of you didn't understood what I really need.\nI will try to explain it a bit more.</p>\n\n<p>When user signs in it has it own user_key written. When he signs out then I wrote user_key(0) in the table after that another user can sing in and so on. So basically I need to see first unique user key in the for example day shift and get the last. The last user_key we can get just to check if the next user_key is different. If the next user key is the different then we have the first one and the last one and difference between them needs to be saved in the variable. Then for example we have some other users and later on we have again pair of user_key then we just need to add the difference between them to the same variable and so on...</p>\n\n<p>My problem can be solved in PHP too. For example we can get only values for certain user_key and for the certain time. Then in php we can go trough the data and check.</p>\n\n<p>Please provide me with some examples</p>\n\n<p>EDIT:</p>\n\n<p>Data:</p>\n\n<pre><code>1447, 0, 2012-10-21 13:32:15.453\n1448, 0, 2012-10-21 13:32:22.203\n1449, 0, 2012-10-21 13:32:29.203\n1450, , 2012-10-21 13:32:35.671\n1451, , 2012-10-21 13:32:44.515\n1452, , 2012-10-21 13:32:52.62\n1453, 0010154108, 2012-10-21 13:32:59.203\n1454, 0010154108, 2012-10-21 13:33:06.46\n1455, 0010154108, 2012-10-21 13:33:13.171\n1456, 0010154108, 2012-10-21 13:33:20.62\n1457, 0010154108, 2012-10-21 13:33:27.62\n1458, 0010154108, 2012-10-21 13:33:34.171\n1459, 0010154108, 2012-10-21 13:33:40.234\n1460, 0010154108, 2012-10-21 13:33:47 \n1461, 0010154108, 2012-10-21 13:33:53.812\n1462, 0010154108, 2012-10-21 13:33:59.828\n1463, 0010154108, 2012-10-21 13:34:05.859\n1464, 0010154108, 2012-10-21 13:34:11.828\n1465, 0010154108, 2012-10-21 13:34:18.843\n1466, 0010154108, 2012-10-21 13:34:24.828\n1467, 0010154108, 2012-10-21 13:34:30.781\n1468, 0010154108, 2012-10-21 13:34:36.765\n1469, 0010154108, 2012-10-21 13:34:43.156\n1470, 0010154108, 2012-10-21 13:34:49.375\n1471, 0010154108, 2012-10-21 13:34:55.593\n1472, 0010154108, 2012-10-21 13:35:03.156\n1473, 0010154108, 2012-10-21 13:35:10.875\n1474, 0010154108, 2012-10-21 13:35:16.734\n1475, 0010154108, 2012-10-21 13:35:24.875\n1476, 0010154108, 2012-10-21 13:35:31.750\n1477, 0010154108, 2012-10-21 13:35:38.765\n1478, 0010154108, 2012-10-21 13:35:45.859\n1479, 0010154108, 2012-10-21 13:35:54.203\n1480, 0010154108, 2012-10-21 13:36:01.62\n1481, 0010154108, 2012-10-21 13:36:08.93\n1482, 0010154108, 2012-10-21 13:36:15.109\n1483, 0010154108, 2012-10-21 13:36:21.109\n1484, 0010154108, 2012-10-21 13:36:28.109\n1485, 0010154108, 2012-10-21 13:36:34.93\n1486, 0010154108, 2012-10-21 13:36:40.93\n1487, 0010154108, 2012-10-21 13:36:46.78\n1488, 0010154108, 2012-10-21 13:36:54.921\n1489, 0010154108, 2012-10-21 13:37:01.93\n1490, 0010154108, 2012-10-21 13:37:08.93\n1491, 0010154108, 2012-10-21 13:37:14.78\n1492, 0010154108, 2012-10-21 13:37:20.78\n1493, 0010154108, 2012-10-21 13:37:26.78\n1494, 0010154108, 2012-10-21 13:37:33.93\n1495, 0010154108, 2012-10-21 13:37:39.140\n1496, 0010154108, 2012-10-21 13:37:45.156\n1497, 0010154108, 2012-10-21 13:37:51.171\n1498, 0010154108, 2012-10-21 13:37:58.562\n1499, 0010154108, 2012-10-21 13:38:05.93\n1500, 0010154108, 2012-10-21 13:38:11.125\n1501, 0010154108, 2012-10-21 13:38:18.109\n1502, 0010154108, 2012-10-21 13:38:24.78\n1503, 0010154108, 2012-10-21 13:38:30.15\n1504, 0010154108, 2012-10-21 13:38:36.15\n1505, 0010154108, 2012-10-21 13:38:42.984\n1506, 0010154108, 2012-10-21 13:38:48.984\n1507, 0010154108, 2012-10-21 13:38:55 \n1508, 0010154108, 2012-10-21 13:39:01.750\n1509, 0010154108, 2012-10-21 13:39:07.953\n1510, 0010154108, 2012-10-21 13:39:13.953\n1511, 0010154108, 2012-10-21 13:39:19.984\n1512, 0010154108, 2012-10-21 13:39:26 \n1513, 0010154108, 2012-10-21 13:39:32.984\n1514, 0010154108, 2012-10-21 13:39:38.953\n1515, 0010154108, 2012-10-21 13:39:44.937\n1516, 0010154108, 2012-10-21 13:39:50.937\n1517, 0010154108, 2012-10-21 13:39:57.968\n1518, 0010154108, 2012-10-21 13:40:03.968\n1519, 0010154108, 2012-10-21 13:40:10.15\n1520, 0010154108, 2012-10-21 13:40:16.15\n1521, 0010154108, 2012-10-21 13:40:22.968\n1522, 0010154108, 2012-10-21 13:40:28.953\n1523, 0010154108, 2012-10-21 13:40:34.953\n1524, 0010154108, 2012-10-21 13:40:40.984\n1525, 0010154108, 2012-10-21 13:40:48 \n1526, 0010154108, 2012-10-21 13:40:54.15\n1527, 0010154108, 2012-10-21 13:40:59.984\n1528, 0010154108, 2012-10-21 13:41:07.578\n1529, 0010154108, 2012-10-21 13:41:13.984\n1530, 0010154108, 2012-10-21 13:41:20.31\n1531, 0010154108, 2012-10-21 13:41:26.31\n1532, 0010154108, 2012-10-21 13:41:33.78\n1533, 0010154108, 2012-10-21 13:41:39.46\n1534, 0010154108, 2012-10-21 13:41:45.31\n1535, 0010154108, 2012-10-21 13:41:50.937\n1536, 0010154108, 2012-10-21 13:41:57.968\n1537, 0010154108, 2012-10-21 13:42:03.953\n1538, 0010154108, 2012-10-21 13:42:11.93\n1539, 0010154108, 2012-10-21 13:42:17.953\n1540, 0010154108, 2012-10-21 13:42:23.968\n1541, 0010154108, 2012-10-21 13:42:30.187\n1542, 0010154108, 2012-10-21 13:42:37.968\n1543, 0010154108, 2012-10-21 13:42:44 \n1544, 0010154108, 2012-10-21 13:42:50.15\n1545, 0010154108, 2012-10-21 13:42:56 \n1546, 0010154108, 2012-10-21 13:43:03.31\n1547, 0010154108, 2012-10-21 13:43:08.984\n1548, 0010154108, 2012-10-21 13:43:14.984\n1549, 0010154108, 2012-10-21 13:43:21.281\n1550, 0010154108, 2012-10-21 13:43:28.62\n1551, 0010154108, 2012-10-21 13:43:35 \n1552, 0010154108, 2012-10-21 13:43:41.78\n1553, 0010154108, 2012-10-21 13:43:48.78\n1554, 0010154108, 2012-10-21 13:43:54 \n1555, 0010154108, 2012-10-21 13:43:59.968\n1556, 0010154108, 2012-10-21 13:44:06.62\n1557, 0010154108, 2012-10-21 13:44:13.15\n1558, 0010154108, 2012-10-21 13:44:19.968\n1559, 0010154108, 2012-10-21 13:44:25.984\n1560, 0010154108, 2012-10-21 13:44:33.15\n1561, 0010154108, 2012-10-21 13:44:39.78\n1562, 0010154108, 2012-10-21 13:44:45.46\n1563, 0010154108, 2012-10-21 13:44:53.78\n1564, 0010154108, 2012-10-21 13:44:59.78\n1565, 0010154108, 2012-10-21 13:45:05.437\n1566, 0010154108, 2012-10-21 13:45:12.953\n1567, 0010154108, 2012-10-21 13:45:19.625\n1568, 0010154108, 2012-10-21 13:45:25.937\n1569, 0010154108, 2012-10-21 13:45:32.921\n1570, 0010154108, 2012-10-21 13:45:38.937\n1571, 0010154108, 2012-10-21 13:45:44.890\n1572, 0010154108, 2012-10-21 13:45:50.843\n1573, 0010154108, 2012-10-21 13:45:57.843\n1574, 0010154108, 2012-10-21 13:46:03.843\n1575, 0010154108, 2012-10-21 13:46:09.906\n1576, 0010154108, 2012-10-21 13:46:15.906\n1577, 0010154108, 2012-10-21 13:46:22.921\n1578, 0010154108, 2012-10-21 13:46:28.859\n1579, 0010154108, 2012-10-21 13:46:34.796\n1580, 0010154108, 2012-10-21 13:46:40.703\n1581, 0010154108, 2012-10-21 13:46:48.656\n1582, 0010154108, 2012-10-21 13:46:54.687\n1583, 0010154108, 2012-10-21 13:47:00.671\n1584, 0010154108, 2012-10-21 13:47:07.687\n1585, 0010154108, 2012-10-21 13:47:13.750\n1586, 0010154108, 2012-10-21 13:47:20.265\n1587, 0010154108, 2012-10-21 13:47:27.812\n1588, 0010154108, 2012-10-21 13:47:33.796\n1589, 0010154108, 2012-10-21 13:47:39.781\n1590, 0010154108, 2012-10-21 13:47:45.765\n1591, 0010154108, 2012-10-21 13:47:52.734\n1592, 0010154108, 2012-10-21 13:47:58.781\n1593, 0010154108, 2012-10-21 13:48:04.812\n1594, 0010154108, 2012-10-21 13:48:10.843\n1595, 0010154108, 2012-10-21 13:48:17.843\n1596, 0010154108, 2012-10-21 13:48:23.843\n1597, 0010154108, 2012-10-21 13:48:29.859\n1598, 0010154108, 2012-10-21 13:48:35.890\n1599, 0010154108, 2012-10-21 13:48:42.906\n1600, 0010154108, 2012-10-21 13:48:48.875\n1601, 0010154108, 2012-10-21 13:48:54.890\n1602, 0010154108, 2012-10-21 13:49:00.890\n1603, 0010154108, 2012-10-21 13:49:07.843\n1604, 0010154108, 2012-10-21 13:49:13.890\n1605, 0010154108, 2012-10-21 13:49:19.890\n1606, 0010154108, 2012-10-21 13:49:28.468\n1607, 0010154108, 2012-10-21 13:49:34.500\n1608, 0010154108, 2012-10-21 13:49:40.484\n1609, 0010154108, 2012-10-21 13:49:46.453\n1610, 0010154108, 2012-10-21 13:49:52.859\n1611, 0010154108, 2012-10-21 13:49:58.984\n1612, 0010154108, 2012-10-21 13:50:04.875\n1613, 0010154108, 2012-10-21 13:50:10.875\n1614, 0010154108, 2012-10-21 13:50:17.796\n1615, 0010154108, 2012-10-21 13:50:23.812\n1616, 0010154108, 2012-10-21 13:50:29.796\n1617, 0010154108, 2012-10-21 13:50:35.812\n1618, 0010154108, 2012-10-21 13:50:42.812\n1619, 0010154108, 2012-10-21 13:50:48.828\n1620, 0010154108, 2012-10-21 13:50:54.906\n1621, 0, 2012-10-21 13:51:00.828\n1622, 0, 2012-10-21 13:51:07.890\n1623, 0, 2012-10-21 13:51:13.796\n1624, 0, 2012-10-21 13:51:19.796\n1625, 0, 2012-10-21 13:51:25.812\n1626, 0, 2012-10-21 13:51:32.828\n1627, 0, 2012-10-21 13:51:38.828\n1628, 0, 2012-10-21 13:51:44.796\n1629, 0, 2012-10-21 13:51:50.781\n1630, 0, 2012-10-21 13:51:57.750\n1631, 0, 2012-10-21 13:52:03.718\n1632, 0, 2012-10-21 13:52:12.718\n1633, 0, 2012-10-21 13:52:18.765\n1634, 0, 2012-10-21 13:52:25.46\n1635, 0, 2012-10-21 13:52:32.796\n1636, 0, 2012-10-21 13:52:39.765\n1637, 0, 2012-10-21 13:52:45.781\n1638, 0, 2012-10-21 13:52:52.812\n1639, 0, 2012-10-21 13:52:59.218\n1640, 0, 2012-10-21 13:53:05.250\n1641, 0, 2012-10-21 13:53:12.765\n1642, 0, 2012-10-21 13:53:18.781\n1643, 0, 2012-10-21 13:53:24.875\n1644, 0, 2012-10-21 13:53:30.890\n1645, 0, 2012-10-21 13:53:37.765\n1646, 0, 2012-10-21 13:53:43.750\n1647, 0, 2012-10-21 13:53:49.734\n1648, 0, 2012-10-21 13:53:55.718\n1649, 0, 2012-10-21 13:54:02.859\n1650, 0, 2012-10-21 13:54:08.750\n1651, 0, 2012-10-21 13:54:14.781\n1652, 0, 2012-10-21 13:54:20.750\n1653, 0, 2012-10-21 13:54:27.703\n1654, 0, 2012-10-21 13:54:33.656\n1655, 0, 2012-10-21 13:54:39.671\n1656, 0, 2012-10-21 13:54:46.671\n1657, 0, 2012-10-21 13:54:53.671\n1658, 0, 2012-10-21 13:54:59.656\n1659, 0, 2012-10-21 13:55:05.656\n1660, 0, 2012-10-21 13:55:12.640\n1661, 0, 2012-10-21 13:55:18.640\n1662, 0, 2012-10-21 13:55:24.656\n1663, 0, 2012-10-21 13:55:30.718\n1664, 0, 2012-10-21 13:55:37.703\n1665, 0, 2012-10-21 13:55:43.703\n1666, 0, 2012-10-21 13:55:49.671\n1667, 0, 2012-10-21 13:55:55.609\n1668, 0, 2012-10-21 13:56:02.609\n1669, 0, 2012-10-21 13:56:08.625\n1670, 0, 2012-10-21 13:56:14.625\n1671, 0, 2012-10-21 13:56:20.593\n1672, 0, 2012-10-21 13:56:27.625\n1673, 0, 2012-10-21 13:56:33.687\n1674, 0, 2012-10-21 13:56:39.640\n1675, 0, 2012-10-21 13:56:45.578\n1676, 0, 2012-10-21 13:56:53.703\n1677, 0, 2012-10-21 13:56:59.984\n1678, 0, 2012-10-21 13:57:07.562\n1679, 0, 2012-10-21 13:57:14.562\n1680, 0, 2012-10-21 13:57:20.578\n1681, 0, 2012-10-21 13:57:27.625\n1682, 0, 2012-10-21 13:57:33.609\n1683, 0, 2012-10-21 13:57:39.546\n1684, 0, 2012-10-21 13:57:47.609\n1685, 0, 2012-10-21 13:57:55.765\n1686, 0, 2012-10-21 13:58:02.453\n1687, 0, 2012-10-21 13:58:08.609\n1688, 0, 2012-10-21 13:58:14.484\n1689, 0, 2012-10-21 13:58:22.500\n1690, 0, 2012-10-21 13:58:28.703\n1691, 0, 2012-10-21 13:58:35 \n1692, 0, 2012-10-21 13:58:42.656\n1693, 0, 2012-10-21 13:58:49.468\n1694, 0, 2012-10-21 13:58:55.453\n1695, 0, 2012-10-21 13:59:02.453\n1696, 0, 2012-10-21 13:59:08.453\n1697, 0, 2012-10-21 13:59:14.453\n1698, 0, 2012-10-21 13:59:20.453\n1699, 0, 2012-10-21 13:59:27.453\n1700, 0, 2012-10-21 13:59:33.484\n1701, 0, 2012-10-21 13:59:40.515\n1702, 0, 2012-10-21 13:59:47.515\n1703, 0, 2012-10-21 13:59:53.531\n1704, 0, 2012-10-21 14:00:01.437\n1705, 0, 2012-10-21 14:00:07.484\n1706, 0, 2012-10-21 14:00:13.484\n1707, 0, 2012-10-21 14:00:19.500\n1708, 0, 2012-10-21 14:00:25.531\n1709, 0, 2012-10-21 14:00:32.562\n1710, 0, 2012-10-21 14:00:38.531\n1711, 0, 2012-10-21 14:00:44.515\n1712, 0, 2012-10-21 14:00:50.484\n1713, 0, 2012-10-21 14:00:57.531\n1714, 0, 2012-10-21 14:01:04.62\n1715, 0, 2012-10-21 14:01:09.968\n1716, 0, 2012-10-21 14:01:17.531\n1717, 0, 2012-10-21 14:01:23.546\n1718, 0, 2012-10-21 14:01:29.546\n1719, 0, 2012-10-21 14:01:35.531\n1720, 0, 2012-10-21 14:01:42.546\n1721, 0, 2012-10-21 14:01:48.562\n1722, 0, 2012-10-21 14:01:54.531\n1723, 0, 2012-10-21 14:02:00.546\n1724, 0, 2012-10-21 14:02:07.671\n1725, 0, 2012-10-21 14:02:13.468\n1726, 0, 2012-10-21 14:02:19.921\n1727, 0, 2012-10-21 14:02:27.468\n1728, 0, 2012-10-21 14:02:33.484\n1729, 0, 2012-10-21 14:02:39.468\n1730, 0, 2012-10-21 14:02:45.484\n1731, 0, 2012-10-21 14:02:52.484\n1732, 0, 2012-10-21 14:02:58.484\n1733, 0, 2012-10-21 14:03:04.515\n1734, 0, 2012-10-21 14:03:12.500\n1735, 0, 2012-10-21 14:03:18.421\n1736, 0, 2012-10-21 14:03:24.437\n1737, 0, 2012-10-21 14:03:30.734\n1738, 0, 2012-10-21 14:03:37.484\n1739, 0, 2012-10-21 14:03:43.437\n1740, 0, 2012-10-21 14:03:49.437\n1741, 0, 2012-10-21 14:03:55.484\n1742, 0, 2012-10-21 14:04:02.484\n1743, 0, 2012-10-21 14:04:08.453\n1744, 0, 2012-10-21 14:04:14.531\n1745, 0, 2012-10-21 14:04:20.500\n1746, 0, 2012-10-21 14:04:27.484\n1747, 0, 2012-10-21 14:04:33.515\n1748, 0, 2012-10-21 14:04:39.484\n1749, 0, 2012-10-21 14:04:45.375\n1750, 0, 2012-10-21 14:04:52.375\n1751, 0, 2012-10-21 14:04:58.406\n1752, 0, 2012-10-21 14:05:04.421\n1753, 0, 2012-10-21 14:05:10.437\n1754, 0, 2012-10-21 14:05:17.406\n1755, 0, 2012-10-21 14:05:23.421\n1756, 0, 2012-10-21 14:05:29.453\n1757, 0, 2012-10-21 14:05:35.453\n1758, 0, 2012-10-21 14:05:42.468\n1759, 0, 2012-10-21 14:05:48.437\n1760, 0, 2012-10-21 14:05:54.437\n1761, 0, 2012-10-21 14:06:00.453\n1762, 0, 2012-10-21 14:06:07.406\n1763, 0, 2012-10-21 14:06:13.390\n1764, 0, 2012-10-21 14:06:19.343\n1765, 0, 2012-10-21 14:06:25.359\n1766, 0, 2012-10-21 14:06:32.343\n1767, 0, 2012-10-21 14:06:38.343\n1768, 0, 2012-10-21 14:06:44.359\n1769, 0, 2012-10-21 14:06:50.343\n1770, 0, 2012-10-21 14:06:57.343\n1771, 0, 2012-10-21 14:07:03.328\n1772, 0, 2012-10-21 14:07:09.312\n1773, 0, 2012-10-21 14:07:15.343\n1774, 0, 2012-10-21 14:07:22.812\n1775, 0, 2012-10-21 14:07:29.312\n1776, 0, 2012-10-21 14:07:35.328\n1777, 0, 2012-10-21 14:07:42.343\n1778, 0, 2012-10-21 14:07:48.296\n1779, 0, 2012-10-21 14:07:54.343\n1780, 0, 2012-10-21 14:08:00.343\n1781, 0, 2012-10-21 14:08:07.328\n1782, 0, 2012-10-21 14:08:13.312\n1783, 0, 2012-10-21 14:08:19.265\n1784, 0, 2012-10-21 14:08:26.46\n1785, 0, 2012-10-21 14:08:32.296\n1786, 0, 2012-10-21 14:08:38.296\n1787, 0, 2012-10-21 14:08:44.281\n1788, 0, 2012-10-21 14:08:50.296\n1789, 0, 2012-10-21 14:08:57.265\n1790, 0, 2012-10-21 14:09:03.828\n1791, 0, 2012-10-21 14:09:09.937\n1792, 0, 2012-10-21 14:09:17.265\n1793, 0, 2012-10-21 14:09:23.546\n1794, 0, 2012-10-21 14:09:30.468\n1795, 0, 2012-10-21 14:09:39.406\n1796, 0, 2012-10-21 14:09:49.453\n1797, 0, 2012-10-21 14:09:57.562\n1798, 0, 2012-10-21 14:10:04.359\n1799, 0, 2012-10-21 14:10:15.609\n1800, 0, 2012-10-21 14:10:22.187\n1801, 0, 2012-10-21 14:10:28.218\n1802, 0, 2012-10-21 14:10:34.218\n1803, 0, 2012-10-21 14:10:40.296\n1804, 0, 2012-10-21 14:10:50.250\n1805, 0, 2012-10-21 14:10:57.265\n1806, 0, 2012-10-21 14:11:03.125\n1807, 0, 2012-10-21 14:11:09.125\n1808, 0, 2012-10-21 14:11:15.125\n1809, 0, 2012-10-21 14:11:22.125\n1810, 0, 2012-10-21 14:11:28.109\n1811, 0, 2012-10-21 14:11:35.390\n1812, 0, 2012-10-21 14:11:42.15\n1813, 0, 2012-10-21 14:11:48.31\n1814, 0, 2012-10-21 14:11:54.46\n1815, 0, 2012-10-21 14:12:00.78\n1816, 0, 2012-10-21 14:12:08.140\n1817, 0, 2012-10-21 14:12:14.140\n1818, 0, 2012-10-21 14:12:20.171\n1819, 0, 2012-10-21 14:12:27.218\n1820, 0, 2012-10-21 14:12:33.171\n1821, 0, 2012-10-21 14:12:39.125\n1822, 0, 2012-10-21 14:12:46 \n1823, 0, 2012-10-21 14:12:52.93\n1824, 0, 2012-10-21 14:12:58.593\n1825, 0, 2012-10-21 14:13:05.484\n1826, 0, 2012-10-21 14:13:12.78\n1827, 0, 2012-10-21 14:13:18.93\n1828, 0, 2012-10-21 14:13:24.109\n1829, 0, 2012-10-21 14:13:30.140\n1830, 0, 2012-10-21 14:13:37.140\n1831, 0, 2012-10-21 14:13:43.203\n1832, 0, 2012-10-21 14:13:49.281\n1833, 0, 2012-10-21 14:13:57.296\n1834, 0, 2012-10-21 14:14:03.203\n1835, 0, 2012-10-21 14:14:09.671\n1836, 0, 2012-10-21 14:14:17.265\n1837, 0, 2012-10-21 14:14:23.171\n1838, 0, 2012-10-21 14:14:29.187\n1839, 0, 2012-10-21 14:14:35.109\n1840, 0, 2012-10-21 14:14:43.484\n1841, 0, 2012-10-21 14:14:49.515\n1842, 0, 2012-10-21 14:14:57.203\n1843, 0, 2012-10-21 14:15:03.187\n1844, 0, 2012-10-21 14:15:09.125\n1845, 0, 2012-10-21 14:15:17.156\n1846, 0, 2012-10-21 14:15:23.140\n1847, 0, 2012-10-21 14:15:29.109\n1848, 0, 2012-10-21 14:15:35.109\n1849, 0, 2012-10-21 14:15:42.125\n1850, 0, 2012-10-21 14:15:48.93\n1851, 0, 2012-10-21 14:15:54.125\n1852, 0, 2012-10-21 14:16:00.109\n1853, 0, 2012-10-21 14:16:07.546\n1854, 0, 2012-10-21 14:16:14.78\n1855, 0, 2012-10-21 14:16:20.156\n1856, 0, 2012-10-21 14:16:28.93\n1857, 0, 2012-10-21 14:16:34.546\n1858, 0, 2012-10-21 14:16:42.62\n1859, 0, 2012-10-21 14:16:50.437\n1860, 0, 2012-10-21 14:17:13.15\n1861, 0, 2012-10-21 14:17:20.593\n1862, 0, 2012-10-21 14:17:28.125\n1863, 0, 2012-10-21 14:17:35.578\n1864, 0, 2012-10-21 14:17:43.125\n1865, 0, 2012-10-21 14:17:52.484\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":13001285,"title":"How to use dropdown list in query?","body":"<p>I have this dropdown list and idea is i wanto to select all products that they are added(today,last week,last month,last year).This is format datetime in database:0000-00-00 00:00:00. </p>\n\n<pre><code>  &lt;select name=\"time\" id=\"time\" &gt;\n  &lt;option value=\"0\"&gt;Please Select&lt;/option&gt;\n  &lt;option name=\"1\" value=\"1\" &gt;Today&lt;/option&gt;\n  &lt;option name=\"2 \"value=\"2\"&gt;Last Week&lt;/option&gt;\n  &lt;option name=\"3 \"value=\"3\"&gt;Last Month&lt;/option&gt;\n  &lt;option name=\"4 \"value=\"4\"&gt;Last Year&lt;/option&gt;\n  &lt;/select&gt;\n</code></pre>\n"},{"tags":["php","query","mongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12987812,"title":"Converting a mysql query to mongodb using php","body":"<p>Currently I have an mysql table like this:</p>\n\n<pre><code>+---------+----------+------+-----+---------+----------------+\n| Field   | Type     | Null | Key | Default | Extra          |\n+---------+----------+------+-----+---------+----------------+\n| id      | int(11)  | NO   | PRI | NULL    | auto_increment |\n| mediaID | int(11)  | NO   |     | NULL    |                |\n| date    | datetime | NO   |     | NULL    |                |\n+---------+----------+------+-----+---------+----------------+\n</code></pre>\n\n<p>In this table I store every hit made for a specific media. I save mediaID and date when this hit happened. So ... when I want to show trending medias (most viewed medias for specific time period), I use this mysql query:</p>\n\n<pre><code>SELECT  mediaID, COUNT(*) as cnt FROM hits WHERE DATE(date) = CURDATE() - INTERVAL 1 DAY GROUP BY mediaID ORDER BY cnt DESC LIMIT 0,10\n</code></pre>\n\n<p>Now.. I'm planning to move this in MongoDB. Currently I have collection \"hits\" with the following documents:</p>\n\n<pre><code>{\n    _id: ObjectId(\"50827eaaae1c3ced6c00000f\"),\n    mediaID: \"2\",\n    ts: ISODate(\"2012-10-20T13:36:26+03:00\")\n}\n{\n    _id: ObjectId(\"50827ebeae1c3ced6c000010\"),\n    mediaID: \"1\",\n    ts: ISODate(\"2012-10-20T13:36:46+03:00\")\n}\n{\n    _id: ObjectId(\"50827ec3ae1c3c6167000008\"),\n    mediaID: \"2\",\n    ts: ISODate(\"2012-10-20T13:36:51+03:00\")\n}\n</code></pre>\n\n<p>So, my question is how to convert my previous query to be able to work with MongoDB? \nP.S. I'm using php with php mongodb driver.</p>\n\n<p>Greetings,\nMilen</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":86,"score":0,"question_id":12995863,"title":"Product Sales Report weekly monthly","body":"<p>how can i run a SQL query to retrieve weekly  and monthly sales reports.</p>\n\n<p><strong>Table: orders</strong></p>\n\n<h2>    ID |Product_id | order price | QTY | purchase date</h2>\n\n<pre><code>1        1           34         2        9/10/12\n2        1           34         2        8/10/12\n3        4           34         2        07/10/12\n4        3           34         2        22/09/12\n5        1           34         2        9/10/12\n6        1           34         2        22/09/12\n7        4           34         2        9/08/12\n8        3           34         2        22/09/12\n</code></pre>\n\n<p><strong>Table: Products</strong></p>\n\n<pre><code>ID | Name | description\n\n1    A       ksfjsdkf\n2    B       ksfjsdkf\n3    C       ksfjsdkf\n1    A       ksfjsdkf\n</code></pre>\n\n<p><strong>Expecting result</strong>\n:the following is an example result not accurate</p>\n\n<pre><code>product_name           Weekly Sum(QTY), weekly revenue,  Monthly SUM(QTY), monthly revenue\n\nA                           120             3000           2345                  234343\n</code></pre>\n"},{"tags":["regex","query","sqlite","query-string"],"answer_count":8,"favorite_count":9,"up_vote_count":12,"down_vote_count":0,"view_count":8667,"score":12,"question_id":5071601,"title":"How do I use regex in a SQLite query?","body":"<p>I'd like to use a regular expression in sqlite, but I don't know how.</p>\n\n<p>My table has got a column with strings like this: \"3,12,13,14,19,28,32\"\nNow if I type \"where x LIKE '3'\" I also get the rows which contain values like 13 or 32,\nbut I'd like to get only the rows which have exactly the value 3 in that string.</p>\n\n<p>Does anyone know how to solve this?</p>\n"},{"tags":["php","string","query",".htaccess","url"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12999700,"title":"remove query string form url with htaccess","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5464481/clean-urls-for-search-query\">Clean URLs for search query?</a>  </p>\n</blockquote>\n\n\n\n<p>I made a php webpage for checking the color code,here is the first four line</p>\n\n<pre><code>if(isset($_GET['c']))\n$hex = $_GET['c'];\nelseif(!isset($_GET['c']))\n$hex = $_POST['c'];\n</code></pre>\n\n<p>and my htaccess have:</p>\n\n<pre><code>RewriteEngine On\nRewriteRule ^([a-zA-Z0-9]{6})$ index.php?c=$1 [L]\n</code></pre>\n\n<p>if I type site.com/ffcdee it successfully show the color #ffcdee\nbut if i use the input box:</p>\n\n<pre><code>&lt;form action=\"\"&gt;\n&lt;input type=\"text\" name=\"c\" &gt;\n&lt;input type=\"submit\" value=\"Search\" id=\"search-submit\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>it show site.com/?c=ffcdee,\nI tried change input name to other word,but the script not work anymore..\nhow can I remove the ?c= from the url?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":54,"score":-2,"question_id":12998090,"title":"Is there a way to simplify the given mysql query","body":"<pre><code>SELECT \nt3.transaction_id,\nt3.transaction_no,\nt3.retrivel_ref_no,\nt3.transaction_type,\nt3.reversal_flag,\nt3.expires_on,\nt3.currency_code,\nt3.message_reason_code,\nt4.sales_person_id,\nt3.card_no,\nt3.transaction_amount,\nt3.transmission_date_time\nFROM TRANSACTION AS t4\nINNER JOIN\n(   SELECT\n    t2.transaction_id,\n    t2.transaction_no,\n    t2.retrivel_ref_no,\n    t2.transaction_type,\n    t2.reversal_flag,\n    t2.transmission_date_time,\n    t2.transaction_amount,\n    t2.card_no,\n    t2.expires_on,\n    t2.currency_code,\n    t1.message_reason_code\n    FROM\n    (   SELECT*\n        FROM    transaction_pci_details \n        WHERE   message_reason_code LIKE '%OUT%'|| \n            message_reason_code LIKE '%FAILED%'\n    ) AS t1\n    INNER JOIN\n    (   \n        SELECT*\n        FROM    transaction_pci_details \n        WHERE   action_code LIKE '%REQ%'\n    ) AS t2\n    ON t1.transaction_no = t2.transaction_no    \n) AS t3\nON t4.transaction_id = t3.transaction_id;\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":144,"score":0,"question_id":9098100,"title":"MySQL - Delete one row and re-order the others with the correct Sort ID","body":"<p>I have a table which contains a bunch of rows and a <strong>sort_order</strong>.  I was wondering how I can do this so when I delete a row, say I delete the highlighted row with a sort_order of 7.  Then instead of 7 just being removed, I would need to change #8 to #7 .. #9 to #8 .. #10 to #9 .. and #11 to #10.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/GVg3E.png\" alt=\"enter image description here\"></p>\n\n<p>Is something like this possible?</p>\n"},{"tags":["query","doctrine","doctrine-1.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":394,"score":0,"question_id":8563614,"title":"Doctrine Query calculate MAX value in WHERE clause","body":"<p>I have this tables:</p>\n\n<p><em>subscribers</em></p>\n\n<pre><code>id | name  |\n---+-------+\n1  | Hill  |\n2  | Sam   |\n3  | Joe   |\n</code></pre>\n\n<p>subscribers_years</p>\n\n<pre><code>subscriber_id | year  |\n--------------+-------+\n1             | 2009  |\n1             | 2010  |\n1             | 2011  |\n2             | 2009  |\n2             | 2010  |\n3             | 2010  |\n</code></pre>\n\n<p>I want to take an advanced search using only records that have a maximum as x.\nIf x = 2010\nResults query must be: Sam and Joe!</p>\n\n<p>I try this:</p>\n\n<pre><code>$query = $this-&gt;createQuery('su')\n            -&gt;select('su.id, su.name)\n            -&gt;addWhere(\n                '(SELECT MAX(year) AS maxYear FROM `subscribers_years` WHERE `subscriber_id`=`su.id`) = ?',\n                2010\n            );\n</code></pre>\n\n<p>but i have the message error: Message: Couldn't find class <code>subscribers_years</code> </p>\n\n<p>how should I write my query right way?</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<pre><code>$query-&gt;addWhere('(SELECT MAX(year) AS maxYear FROM SubscriberYear WHERE subscriber_id=su.id) = ?', 2010 );\n</code></pre>\n\n<p>my mistake was that I did not use the class name Doctrine as the From, but used the name of the table mysql! :S</p>\n"},{"tags":["android","query","sqlite","achartengine"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12995417,"title":"plotting sqlite data with achartengine","body":"<p>I am using achartengine to plot two fields from an sqlite table i set up. I believe that the retrieving of fields is working, but i cannot resolve some variable issues in the graphing activity. Any suggestions? Achartengine and sqlite are both new to me so any help is welcome. I am getting errors in the value1 ==null line and the mcurrentSeries and mChartView.</p>\n\n<p>My Database query:</p>\n\n<pre><code>public String getPlotX(long l) {\n    String[] column = new String[]{KEY_TIME, KEY_BGL, KEY_RANGE, KEY_LASTMEAL, KEY_MEALTIME};\n    Cursor c = ourDatabase.query(DATABASE_TABLE, column, KEY_ROWID + \"=\" + l, null, null, null, null);\n    if (c != null){\n    c.moveToFirst();\n    String value1 = c.getString(0);\n    return value1;\n    }\n    return null;\n    }\n\npublic String getPlotY(long l) {\n    String[] column = new String[]{KEY_TIME, KEY_BGL, KEY_RANGE, KEY_LASTMEAL, KEY_MEALTIME};\n    Cursor c = ourDatabase.query(DATABASE_TABLE, column, KEY_ROWID + \"=\" + l, null, null, null, null);\n    if (c != null){\n    c.moveToFirst();\n    String value1 = c.getString(1);\n    return value1;\n    }\n    return null;\n    }\n</code></pre>\n\n<p>And my graph activity class:\n         import org.achartengine.ChartFactory;\n         import org.achartengine.model.TimeSeries;\n         import org.achartengine.model.XYMultipleSeriesDataset;\n         import org.achartengine.renderer.XYMultipleSeriesRenderer;\n         import org.achartengine.renderer.XYSeriesRenderer;</p>\n\n<pre><code>     import android.app.Activity;\n     import android.content.Context;\n     import android.content.Intent;\n\n public class GraphActivity extends Activity {\npublic Intent getIntent(Context context){\n\n    DatabaseHandler getData = new DatabaseHandler(context);\n    getData.open();\n\n    for (int i = 1; value1 == null; i++) {\n    String value1 = getData.getPlotX(i);\n    String value2 = getData.getPlotY(i);\n\n    double x = Double.parseDouble(value1);\n    double y = Double.parseDouble(value2);\n\n    mCurrentSeries.add(x, y); \n\n    }\n    getData.close();\n\n    if (mChartView != null) {\n    mChartView.repaint();\n    }\n    }\n}\n</code></pre>\n"},{"tags":["c#","sql","database","query","oledb"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12994943,"title":"Joins not working in described condition","body":"<p>I have two tables.</p>\n\n<p>Table1->Payment</p>\n\n<pre><code>AdmissionNum(PK)  |  StudName |   Fees |\n\n       1               sagar      5000 \n       2               nilesh     6000\n       3               amar       4000  \n</code></pre>\n\n<p>Table2-> paymentDetails</p>\n\n<pre><code>AdmissionNum(FK) | RemainingFees |   Date       |  Payment\n        1             4000          1/1/2012          1000\n        2             5000          2/5/2012          1000\n        1             3500          2/10/2012         1500\n        1             2500          2/15/2012         1000\n        2             2500          2/20/2012         2500\n        3             0             3/25/2012         4000\n</code></pre>\n\n<p>I have tried different queries but was not able to make joint between payment table and paymentDetails table.\nI am making C# windows app. When particular student is paying fees his record is stored in paymentDetails table.\nI want to extract only outstanding fees details i.e. student whose Remaining Fees is greater than 0 but the last details in the paymentDetais table i.e. .</p>\n\n<p>My expected resut table is-</p>\n\n<pre><code>AdmissionNum  |  StudName |   Fees | RemainingFees\n\n       1           sagar      5000    2500\n       2           nilesh     6000    2500\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":12994444,"title":"How would I write this MySQL query for products?","body":"<p>I have 3 dropdown boxes, and I want to make a query depending what the user chooses. But what happens if they don't choose any option for the dropdown boxes?</p>\n\n<p>I want to display all products where <code>product=</code><em><code>first dropdownbox</code></em>, and <code>price</code> is between <code>$first</code> and <code>$last</code>, but I'm unsure how to do that.</p>\n\n<pre><code>SELECT * FROM Products where product=$rec AND PRICE &gt;=$first AND PRICE &lt;=$last\n</code></pre>\n"},{"tags":["php","mysql","sql","query","large-data"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12994326,"title":"optimizing large data in php page","body":"<p>I'm trying to speed up the time it takes to query 200K rows of data and show it in a web page, it normally takes around 20-30 seconds, but currently I've gotten it down to around 7-10 seconds. I still need it to go around 3-7 seconds at most. </p>\n\n<p>In my query, I'm selecting all the rows in a single table and placing around 5 columns into the PHP script. The query goes like this:</p>\n\n<pre><code>SELECT * FROM table where company = ? and division = ?;\n</code></pre>\n\n<p>I just add the parameters from my session. Then I send the query and the parameters in a <em>.inc</em> file and the <em>inc</em> runs the query. But it also runs a separate query for pagination of data. then it would compare the 2 queries to check for any irregularities between the two. Then it will place the data in a new window. </p>\n\n<p>Are there any known algorithms or techniques I could use to speed up the process? I've already removed any garbage code and sped up some functions but it's still slow.</p>\n\n<p>P.S.: <em>I also just handled the system around 2 days ago so I'm still familiarizing the structure.</em></p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12994131,"title":"SQL plus statement to a JAVA query","body":"<p>I am trying to execute:</p>\n\n<pre><code>SELECT P_NUMBER FROM RDIMARS;\n</code></pre>\n\n<p>In another part of my code, I can successfully execute this statement:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT TABLE_NAME FROM USER_TABLES \" +\n\" WHERE TABLE_NAME LIKE 'APL%'\" );\n</code></pre>\n\n<p>However when I try this:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT TABLE_NAME FROM USER_TABLES \" +\n\" WHERE RDIMARS LIKE 'P_NUMBER'\" );\n</code></pre>\n\n<p>as an attempt to mimic my first function code, it fails. What I would like to do is:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT P_NUMBER from RDIMARS );\n</code></pre>\n\n<p>This does not work for me. But that exact code works in SQLplus. Any idea what I am doing wrong?  The SQLplus command I use is <code>select P_NUMBER from RDIMARS;</code></p>\n"},{"tags":["sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":921,"score":0,"question_id":7739186,"title":"sql query to display the name,job,department name salary and grade","body":"<p>The question is </p>\n\n<p>CREATE A QUERY THAT WILL DISPLAY THE <code>NAME,JOB,DEPARTMENT NAME,SALARY</code> AND <code>GRADE</code>( FROM THE <code>SALGRADE</code> TABLE) FOR ALL <code>EMPLOYEE</code>S.</p>\n\n<p>MY CODE SO FAR GIVES AN OUTPUT</p>\n\n<pre><code>select e.ename, e.job, d.dname, e.sal, s.grade\nfrom emp e, dept d, salgrade s\nwhere e.deptno = d.deptno\n</code></pre>\n\n<p>This returns 70 rows, but the result should only produce 14 rows.</p>\n\n<pre><code>EMPLOYEE   EMP JOB   DEPT NAME      EMP SALARY SALARY GRADE                               \n---------- --------- -------------- ---------- ------------                               \nJAMES      CLERK     SALES                 950            1                               \nSMITH      CLERK     RESEARCH              800            1                               \nADAMS      CLERK     RESEARCH             1100            1                               \nMARTIN     SALESMAN  SALES                1250            2                               \nWARD       SALESMAN  SALES                1250            2                               \nMILLER     CLERK     ACCOUNTING           1300            2                               \nALLEN      SALESMAN  SALES                1600            3                               \nTURNER     SALESMAN  SALES                1500            3                               \nBLAKE      MANAGER   RESEARCH             2850            4                               \nCLARK      MANAGER   ACCOUNTING           2450            4                               \nJONES      MANAGER   RESEARCH             2975            4                               \nFORD       ANALYST   RESEARCH             3000            4                               \nSCOTT      ANALYST   RESEARCH             3000            4                               \nKING       PRESIDENT ACCOUNTING           5000            5         \n</code></pre>\n\n<ul>\n<li><code>emp</code> table has <code>empno, ename, job, deptno, comm, sal</code></li>\n<li><code>salgrade</code> table has <code>grade</code></li>\n<li><code>DEPT</code> table has <code>deptno, loc</code></li>\n</ul>\n\n<p>please help ONLY 14 rows should be selected</p>\n"},{"tags":["php","mysql","ajax","query","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12993249,"title":"Ajax and PHP with database connection","body":"<p>i have problems with the code below, I'm trying to bring a message of error if the email already exists, but I'm not having success .. Look at the code:</p>\n\n<p>Ajax an jQuery:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;  \n\n    // Centering the text content\n    jQuery(window).resize(function () {\n        boxHeight();\n    }).load(function() {\n        boxHeight();\n        // Show the content and focus the email input\n        $(\"#content\").fadeIn();\n        $(\"#email\").focus();\n\n\n    });\n\n    jQuery(document).ready(function($){\n        $('#subscribe').submit(function(e){\n            e.preventDefault();\n\n            email = $('input#email');           \n            email_regex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;           \n            if(!email_regex.test(email.val())) {\n                $('#response', form).fadeIn(500, function() {\n                    $('#response', form).html('&lt;p class=\"message warning\" align=\"center\"&gt;Invalid email&lt;/p&gt;');\n                });\n                return;\n            } else {\n                $('#response', form).html('&lt;p class=\"message\"&gt;Please Wait...&lt;/p&gt;');\n            }\n\n            var form = $(this);\n            var post_url = form.attr('action');\n            var post_data = form.serialize();               \n            $.ajax({\n                type: 'POST',\n                url: post_url,\n                data: post_data,\n                success: function(responseText) {  if(responseText == 1) {\n                    $('#response', form).html('&lt;p class=\"message\"&gt;Error...&lt;/p&gt;');\n                } else { if(responseText == \"\") {                       \n                    $(form).fadeOut(500, function(){\n                        form.html(msg).fadeIn();\n                    });\n\n                }\n                }\n            }\n            });\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>PHP Database connect:</p>\n\n<pre><code>    &lt;?php    \n$host=\"xxxx\"; // Host name\n$username=\"xxxx\"; // Mysql username\n$password=\"xxxx\"; // Mysql password\n$db_name=\"xxxx\"; // Database name\n$tbl_name=\"xxxx\"; // Table name\n\n// Connect to server and select database.\nmysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\");\nmysql_select_db(\"$db_name\")or die(\"cannot select DB\");\n\n// Get values from form\n$email = $_POST['email'];\n\n$query = mysql_query(\"SELECT email FROM banco_emails WHERE 'email' = '$email'\");\n    if(mysql_num_rows($query) == 1) { // if return 1, email exist.\n    echo '1';\n    } else {\n// Insert data into mysql\n$sql=\"INSERT INTO $tbl_name(email) VALUES ('\". $email . \"')\";\n$result=mysql_query($sql);\necho '&lt;p class=\"message\"&gt;Thanks for registering. Our bar is getting crowded!&lt;/p&gt;';\n</code></pre>\n\n<p>The problem is that the ajax code does not show the error message, only the message \"Please wait ...\" and nothing happens, i don't know why...</p>\n\n<p>Sorry for my bad english.</p>\n\n<p>Thanks in advanced!</p>\n\n<hr>\n\n<p>Problem solved, the problem was in the php code, I did it and it worked!</p>\n\n<pre><code>    $query = mysql_query(\"SELECT email FROM banco_emails WHERE email = '$email' LIMIT 1\");\n\n    $email_check = mysql_num_rows($query);\n     if ($email_check &gt; 0) {\n    echo '1';\n    } else if ($email_check == 0) {\n// Insert data into mysql\n$sql=\"INSERT INTO $tbl_name(email) VALUES ('\". $email . \"')\";\n$result=mysql_query($sql);\necho '&lt;p class=\"message\"&gt;Thanks for registering. Our bar is getting crowded!&lt;/p&gt;';\n</code></pre>\n"},{"tags":["mysql","django","query","django-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12989767,"title":"Django query based on foreign key relationship","body":"<p>I have two models, a Project and an Action:</p>\n\n<pre><code>class Project(models.Model):\n    name = models.CharField(\"Project Name\", max_length=200, unique = True)\n\nclass Action(models.Model):\n    name = models.CharField(\"Action Name\", max_length=200)\n    project = models.ForeignKey(Project, blank=True, null=True, verbose_name=\"Project\")\n    notes = models.TextField(\"Notes\", blank=True)\n    complete = models.BooleanField(default=False, verbose_name=\"Complete?\")\n    status = models.IntegerField(\"Action Status\", choices = STATUS, default=0)\n</code></pre>\n\n<p>I need a query that returns all the Projects for which there are no actions with status &lt; 2.</p>\n\n<p>I tried:</p>\n\n<pre><code>Project.objects.filter(action__status__gt = 1)\n</code></pre>\n\n<p>But this returns all the Projects because in each Project, there are some actions with status 2 and some actions with status less than 2.  Also, it repeated Projects in the resulting query.  My current solution is below:</p>\n\n<pre><code>Project.objects.filter(action__status__gt =1).exclude(action__status__lt =2).annotate()\n</code></pre>\n\n<p>This collapses the repeating results and shows only actions with action statuses greater than 1.  But is this the correct way to construct such a query?  What if I wanted to return Projects with actions statuses greater than 1 OR Projects with no actions?</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":41,"score":1,"question_id":12993179,"title":"SQL query of relationship between two items from the same table","body":"<p>I have 3 tables in sqlite, the first one is about an entity I call bar:</p>\n\n<pre><code>bar\n    *id\n    -name\n</code></pre>\n\n<p>and the other one keeps a relationship between two bars, I call this relationship foo:</p>\n\n<pre><code>foo\n    *id\n    -bar_one (fk-&gt;bar)\n    -bar_two (fk-&gt;bar)\n    -baz (fk-&gt;baz)\n</code></pre>\n\n<p>baz holds an attribute that qualifies the KIND relationship that foo represents:</p>\n\n<pre><code>baz\n    *id\n    -description\n</code></pre>\n\n<p>I need to show a query of foo that substitutes the foreign keys with the values of bar an baz, something like:</p>\n\n<pre><code>id    bar_one    bar_two    baz\n1     bar1       bar2       siblings\n2     bar2       bar3       acquaintances\n3     bar3       bar4       enemies\n</code></pre>\n\n<p>I'm not a specialist in DBs as you can see, I tried with a join and it works with foo and baz.</p>\n\n<pre><code>SELECT foo.id, baz.description FROM foo, baz WHERE foo.baz = baz.id;\n</code></pre>\n\n<p>But to show the two members of bar is difficult for me in this way. Some advice?</p>\n"},{"tags":["mysql","query","data","posts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12993040,"title":"trying to write Mysql query for my database","body":"<p>Here is a image on my database <a href=\"http://oi46.tinypic.com/2eb5lpw.jpg\" rel=\"nofollow\">http://oi46.tinypic.com/2eb5lpw.jpg</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/OYT6T.png\" alt=\"enter image description here\"></p>\n\n<p>,  i wonder if it possible to get posts from \"Meals\" by restID? </p>\n"},{"tags":["php","mysql","query","duplicates"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12992456,"title":"mysql query returning more than one value - should return one","body":"<p>I have a website where visitors can create \"battles\" and upload videos to compete in these battles.</p>\n\n<p>The following mySQL query is trying to retrieve details of every \"battle\" in a database. </p>\n\n<p>The problem I have is that if a \"battle creator\" has uploaded two \"videos\" to the same battle, a duplicate battle prints out.</p>\n\n<p>How can I make the query only print out one value for each battle, even if the videos table has two entries under the same battle_id?  </p>\n\n<p>Thanks!</p>\n\n<pre><code>SELECT * from Battles, Player, Video \nWHERE (Battles.battle_creator = Player.player_id \nAND Battles.battle_id = Video.battle_id \nAND Video.player_id = Battles.battle_creator) \nORDER BY Battles.battle_date DESC;\n</code></pre>\n"},{"tags":["sql-server","query","code-efficiency"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12988372,"title":"How can I make this query more efficient by reducing index seeks?","body":"<p>I have a function which I want to be more efficient. I know that most of the cost is in seeking index. I want to know if there is a way to merge these two index seeks into one.</p>\n\n<p>Here is my function</p>\n\n<pre><code>ALTER FUNCTION [dbo].[Search]\n(\n    @Query nvarchar(150)        \n)\nRETURNS @result TABLE \n(\n    ID int,\n    ResultPhrase nvarchar(max),\n    Domain nvarchar(50)\n)\nAS\n\nBEGIN\n\ndeclare  @id int,\n         @OffsetArticle nvarchar(50),\n         @OffsetProfile nvarchar(50),\n         @index int,\n         @domain nvarchar(50),\n         @StringResult nvarchar(max),\n         @substrIndex int,\n         @substrCount int,\n         @field nvarchar(40),\n         @begin int,\n         @end int\n\n        DECLARE pidCursor CURSOR FAST_FORWARD\n        FOR select id,OffsetArticle,OffsetProfile from PerfTest where contains (data,@Query)\n\n        open pidCursor\n        FETCH NEXT FROM pidCursor INTO @id,@OffsetArticle,@OffsetProfile\n\n        while (@@FETCH_STATUS = 0)\n        begin\n\n        select @index = CHARINDEX(@Query,data) from PerfTest where ID=@id\n\n        exec @domain =  dbo.FindDomain @id=@id ,@index=@index, @offsetArticle=@OffsetArticle, @offsetProfile=@OffsetProfile\n\n\n        if(@domain = N'Profile')\n            set @end = SUBSTRING(@offsetProfile,CHARINDEX(N'-',@offsetProfile)+1,len(@offsetProfile)-CHARINDEX(N'-',@offsetProfile))\n            set @begin = SUBSTRING(@offsetProfile,1,CHARINDEX(N'-',@offsetProfile)-1)\n\n        if(@domain = N'Article')\n            set @end = SUBSTRING(@OffsetArticle,CHARINDEX(N'-',@OffsetArticle)+1,len(@OffsetArticle)-CHARINDEX(N'-',@OffsetArticle))\n            set @begin = SUBSTRING(@OffsetArticle,1,CHARINDEX(N'-',@OffsetArticle)-1)\n\n\n\n        if(@index - 20 &lt; CAST(@begin as int))\n            set @substrIndex = @index\n        else\n            set @substrIndex = @index - 20\n\n        if(@index + 150 &gt; CAST(@end as int))\n            set @substrCount = @end\n        else\n            set @substrCount = @index + 150 \n\n\n        select @StringResult = SUBSTRING(data,@substrIndex,@substrCount) from PerfTest where ID=@id\n\n        insert @result (id,ResultPhrase,Domain) values (@id,@StringResult,@domain)\n\n\n        if(@@FETCH_STATUS = 0)\n            FETCH NEXT FROM pidCursor INTO @id,@OffsetArticle,@OffsetProfile\n\n        end\n        CLOSE pidCursor\n        DEALlOCATE pidCursor\n\nRETURN      \nEND\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":204,"score":1,"question_id":8228284,"title":"make sql subqueries stop complaining about duplicate columns","body":"<p>so suppose I have this query</p>\n\n<pre><code>SELECT COUNT(*) FROM (SELECT * FROM k JOIN j ON k.id = j.aid) k \n</code></pre>\n\n<p>suppose k and j have two columns with the same name, this entire query will complain with the duplicate columns error....</p>\n\n<p>while simply executing <code>SELECT * FROM k JOIN j ON k.id = j.aid</code> will execute just fine despite the duplicate columns....</p>\n\n<p>I know that you can use USING in the subquery to specify which column to use in case of duplicates, but is there a way to specify the query so that it'll automatically pic a specific column (whether randomly or using whatever rule) to use in case of duplicates without me having to manually specify them? </p>\n\n<p>ie do this without modifying the subquery (SELECT * FROM k etc) and only modify the superquery (SELECT COUNT(*) FROM...) and make it as abstract as possible so that it'll work regardless of what the subquery is</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":183,"score":0,"question_id":8237282,"title":"SQL_CALC_FOUND_ROWS not working","body":"<p>so I execute query: </p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS * FROM table l LIMIT 10, 20;\n</code></pre>\n\n<p>which returns 20 rows from table, and there are a total 553 rows in the table</p>\n\n<p>Then i immediately execute <code>SELECT FOUND_ROWS();</code></p>\n\n<p>But this instead only returns the number 1, despite the fact that there are 553 rows in my table (it's supposed to return 553, am I correct?)</p>\n\n<p>what did I do wrong? </p>\n"},{"tags":["php","mysql","query","insert"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":12990917,"title":"Why doesn't my query succeed? (PHP MySQL)","body":"<p>there is something wrong with my query but I have no idea what the problem is.</p>\n\n<p>Here are my queries:</p>\n\n<pre><code>$result=mysql_query(\"UPDATE user_info SET Money = '$newmoney' WHERE Username ='$user'\"); \n\n$result=mysql_query(\"INSERT INTO order (username, amount, stock, company) VALUES \n('$user','$amount','$stock','$symbol')\");\n</code></pre>\n\n<p>When I run it the first query works, but the second doesn't. There are now errors given.\nAny help would be great, thank you.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12990849,"title":"query multiple rows in mysql as variable","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/811153/php-simple-way-to-read-single-record-from-mysql\">PHP - Simple way to read single record from MySQL</a>  </p>\n</blockquote>\n\n\n\n<p>I want to query multiple rows in mysql as variable. for example:</p>\n\n<pre><code>SELECT name, tid FROM term_data WHERE vid = 2\n</code></pre>\n\n<p>this is the result:</p>\n\n<pre><code>name | tid\n-----|----\nJack | 55\nTony | 87\nJohn | 32\n</code></pre>\n\n<p>then I want to use while:</p>\n\n<pre><code>while (...) {\n\nprint \"My name is: $name and my ID is: $tid\";\n//name and tid should be printed from database. \n\n}\n</code></pre>\n\n<p>I can query one row and put it in a <code>while</code> but How is this possible?</p>\n\n<p><img src=\"http://i.stack.imgur.com/5F5Nl.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":73,"score":-1,"question_id":12990301,"title":"sql query to count rows that are not null","body":"<p>How do I construct an SQL query that does the following</p>\n\n<pre><code>Return the number of fields (or columns) in a table that start with \"xyz_\" \nand whose value is not null\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":43,"score":-2,"question_id":12990347,"title":"SQL query according to submit form","body":"<p>I want to query the database according to the input of the amount deposited. In the database the bank minimal amounts are stored. So the query consists in showing all banks with min_amount\n\n<p>The amount is defined $amount, and the row containing the minimum amounts is minimum. So i have done it like this but it tells me: Undefined index for $amount. ???</p>\n\n<pre><code> &lt;form name=\"test\" method=\"get\" action=\"this.php\"&gt;\n    Amount: &lt;input name=\"amount\"/&gt;\n    &lt;input type=\"submit\"/&gt;\n    &lt;/form&gt;\n\n    &lt;?php\n        $amount = $_GET[\"amount\"];\n\n        $result = mysql_query(\"SELECT * FROM list1 WHERE minimum &lt;= '$amount'\");\n\n        while($row = mysql_fetch_array($result))\n          {\n          echo $row['bank_name'] . \" - \" . $row['Tariff'];\n          echo \"&lt;br /&gt;\";\n          }\n        ?&gt;\n</code></pre>\n"},{"tags":["php","mysql","arrays","query","metadata"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2812,"score":0,"question_id":4729322,"title":"Selecting MySql table data into an array","body":"<p>I try to catch data from mysql to put them all in array.\nSuppose:</p>\n\n<pre><code>    users table\n    -----------------------\n    id| name | code \n    ----------------------\n    1| gorge | 2132\n    2| flix | ksd02\n    3| jasmen | skaod2\n\n    $sql = mysql_query(\"select id, name, code from users\");\n    $userinfo = array()\n    while($row_user = mysql_fetch_array($sql)){\n    $userinfo = $row_user[name] \n    }\n-------------------------\nforeach($userinfo as $usinfo){\necho $usinfo.\"&lt;br/&gt;\";\n}\n</code></pre>\n\n<p>Here is the problem i can only insert user name but cant insert also code &amp; id in userinfo array please help me to insert all data in same array.</p>\n\n<p>[P.S] No object oriented please.</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12989927,"title":"SQL query where value smaller than number","body":"<p>Ok i need to select from database banks wich have the minimum &lt;= 50 and than show the names of the banks and their tarifs. I did it like this but it doesn't work.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM list1 WHERE minimum &lt;= 50]\");\n\nwhile($row = mysql_fetch_array($result))\n  {\n  echo $row['bank_name'] . \" - \" . $row['Tarif'];\n  echo \"&lt;br /&gt;\";\n  }\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12989747,"title":"SQL query, by comparing values","body":"<p>I have a form where you have to input the ammount to deposit (number), and a mysql table where it has a list of banks with the minimal ammount of deposit (like first row = <code>name</code>, second row = <code>minimal amount</code>). </p>\n\n<p>The question is: <strong>How can i query the database in order to show me the banks which are right for me according to minimal deposit value?</strong> So example you want to deposit 50$, but not all banks allow you this as some of them have 100$ minimal deposit, so i want to show only those that have min.deposit below my amount.</p>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12986371,"title":"Oracle - merge rows into 1 from the output","body":"<p>When I run the following query:</p>\n\n<p><code>SELECT  datetime_up, logic_id,eqp_name,ack, created FROM NAS_db.main\nWHERE TRUNC(datetime_up,'DD') &gt;= TO_TIMESTAMP ('04/18/2012', 'MM/DD/YYYY') and\nTRUNC(datetime_up,'DD') &lt;= TO_TIMESTAMP ('04/21/2012', 'MM/DD/YYYY') AND eqp_name ='Router-A'\nGROUP BY datetime_up,eqp_name, logic_id,ack,created</code></p>\n\n<p>I get the following output:</p>\n\n<pre><code>datetime_up             logic_id    eqp_name      ack   created\n4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       1       0\n\n4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       0       0\n</code></pre>\n\n<p>Ok, Those are consecutive records, I need to... in the cases like this , that the first record has a 1, to take only that one, instead of 2.</p>\n\n<p>I mean, if I query and I have 1000 records showing a 1 after the RouterA, I will need to take only one, and avoid the other one, if they are only 0s, the same, only take one, so I would like to have my query to show this.</p>\n\n<pre><code>4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       1       0\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","xml","query","tsql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":82,"score":0,"question_id":12985491,"title":"SQL Server Query for getting column names of all tables as XML","body":"<p>In my database, I intend to get the - [TableName] as the first column and all columns of that table in a \", \" (comma followed by space - delimiter...as the second column--for all tables in the DB.</p>\n\n<pre><code>Table A | ColumnA1, ColumnA2, ColumnA3  \nTable B | ColumnB1, ColumnB2, ColumnB3\n......................................\n</code></pre>\n\n<p>And retrieve it as an XML</p>\n\n<pre><code>&lt;TableList&gt;  \n&lt;TableName&gt;TableA&lt;/TableName&gt; &lt;Columns&gt; ColumnA1, ColumnA2, ColumnA3&lt;/Columns&gt;  \n&lt;TableName&gt;TableB&lt;/TableName&gt; &lt;Columns&gt; ColumnB1, ColumnB2, ColumnB3&lt;/Columns&gt;  \n&lt;/TableList&gt;\n</code></pre>\n\n<p>How should the SQL Query be written?</p>\n"},{"tags":["java","mysql","query","callable-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12983359,"title":"how to get detail from a prepareCall when it gets a row of an array","body":"<p>I have a program that connects to Db, using prepareCall. there is a function that browse some element from Db.  this is part of this function:</p>\n\n<pre><code>Resource f = new Resource();\n        if (rs.next()) {\n            f.setAreaSrl(rs.getInt(1));\n            f.setAreaId(rs.getInt(2));\n            f.setAreaName(rs.getString(3));\n            f.setCenterX(rs.getFloat(4));\n            f.setCenterY(rs.getFloat(5));\n            f.setCenterZ(rs.getFloat(6));\n\n        }\n        return f;\n    } catch (SQLException e) {\n        JOptionPane.showMessageDialog(null, \"problem in accessing DB\");\n        e.printStackTrace();\n        return null;\n    }\n</code></pre>\n\n<p>and I have the folloing code in java: </p>\n\n<pre><code>Resource mzone = new Resource();\n          mzone.getOneEntityBase(\"areasrl=i\");\n</code></pre>\n\n<p>that will give me a row of table. how can i access to them, element by element? </p>\n\n<p>I want to do some calculation by this numbers, so i need to have them separately. </p>\n\n<p>I have found some way to do it, but it doesn't work. </p>\n\n<pre><code>Resource mzone = new ResourceAreaZone();\n          mzone.getOneEntityBase(\"areasrl=1\");\n          String name = mzone.getAreaName();              \n          centerX = (int) mzone.getCenterX();\n</code></pre>\n"},{"tags":["excel","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":2286382,"title":"Write Queries on Excel sheet in c#","body":"<p>I want to update specific row of excel sheet from my asp.net application. I m able to read excel, but how can i update the records.Can i write Update query . How . please send me code:</p>\n\n<pre><code>        string strQuery = \"UPDATE [Sheet1$]  SET Child Name=\" + \"\\\"\" + strDataToUpdate[0] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Point Name=\" + \"\\\"\" + strDataToUpdate[1] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus No=\" + \"\\\"\" + strDataToUpdate[2] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus Time=\" + \"\\\"\" + strDataToUpdate[3] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Point Name=\" + \"\\\"\" + strDataToUpdate[4] + \"\\\",\";\n        strQuery = strQuery + \"Drop Bus No=\" + \"\\\"\" + strDataToUpdate[5] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Bus Time=\" + \"\\\"\" + strDataToUpdate[6] + \"\\\",\";\n        strQuery = strQuery + \"Parent Name=\" + \"\\\"\" + strDataToUpdate[7] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 1=\" + \"\\\"\" + strDataToUpdate[8] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 2=\" + \"\\\"\" + strDataToUpdate[9] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 1=\" + \"\\\"\" + strDataToUpdate[10] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 2=\" + \"\\\"\" + strDataToUpdate[11] + \"\\\",\";\n        strQuery = strQuery + \"Service Mode=\" + \"\\\"\" + strDataToUpdate[12] + \"\\\",\";\n        strQuery = strQuery + \"WHERE Child Id=\" + strDataToUpdate[13];\n</code></pre>\n\n<p>This Query i am using giving Syntax error.Please guide</p>\n"},{"tags":["php","mysql","sql","wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12984692,"title":"MySQL: Help changing the column names in this query","body":"<p>I'm getting the wrong kind of column names from this query ... for example, I'm getting the column name <code>meta_value</code> for the \"resource_email\" and the \"resource_phone\" cells... they both have the column name of <code>meta_value</code></p>\n\n<pre><code>SET @centerLat = '48.428289';\nSET @centerLng = '-123.380585';\n\nSELECT wp_posts.*, resource_email.meta_value, resource_phone.meta_value,\n( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat.meta_value ) ) * cos( radians( lng.meta_value ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat.meta_value ) ) ) ) AS distance\n\nFROM wp_posts\n\nLEFT JOIN wp_postmeta AS lat \n    ON lat.post_id = wp_posts.id \n        AND lat.meta_key = 'bid_resource_lat'\n\nLEFT JOIN wp_postmeta AS lng \n    ON lng.post_id = wp_posts.id \n        AND lng.meta_key = 'bid_resource_lng'\n\nLEFT JOIN wp_postmeta AS resource_email \n    ON resource_email.post_id = wp_posts.id \n        AND resource_email.meta_key = 'bid_resource_primary_email'\n\nLEFT JOIN wp_postmeta AS resource_phone \n    ON resource_phone.post_id = wp_posts.id \n        AND resource_phone.meta_key = 'bid_resource_primary_phone'\n\nHAVING distance &lt; 5\nLIMIT 0 , 20\n</code></pre>\n\n<p>Not sure how I need to change this query in order to get the column names I really need.</p>\n"},{"tags":["python","query","cursor"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":12984607,"title":"Python MySQLdb failing to insert","body":"<p>I'm trying</p>\n\n<pre><code>title = \"Title here\"\nurl = \"http://www.mysite.com/url-goes-here\"\n\ncursor.execute(\"\"\"INSERT INTO `videos_justicevids` (`title`, `pageurl`) VALUES (%s, %s)\"\"\",(title, url))\n</code></pre>\n\n<p>I'm not getting an error, but it's not inserting into the database.</p>\n"},{"tags":["sql","sql-server-2008","query","sum","select-case"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12984396,"title":"SQL Sum with conditions in a select case","body":"<p>have the following sql query</p>\n\n<pre><code>select catalogid\n   , sum(numitems) numitems\n   , sum(allitems) - sum(numitems) ignoreditems\nfrom\n(\n   select i.catalogid\n      , case\n           when (ocardtype in ('PayPal','Sofort') OR\n                   ocardtype in ('mastercard','visa') and\n                   odate is not null)\n              AND NOT EXISTS\n              (\n                 select *\n                 FROM bookedordersids b\n                 where b.booked = o.orderid\n              )\n           then numitems\n           else 0\n        end AS numitems\n      , numitems AS allitems\n   from orders AS o\n   join oitems AS i on i.orderid = o.orderid\n) AS X\ngroup by catalogid\n</code></pre>\n\n<p>now i've 2 tables Here\norders and oitems table</p>\n\n<p>the query sums the <code>numitems</code> and <code>ignoreditems</code> based on the conditions you see, now what if i want to find the sum only when the value of a column called <code>oprocessed</code> in <code>oitems</code> table is <code>0</code> ,</p>\n\n<p>do i add the following before <code>X</code></p>\n\n<pre><code>where oprocessed=0\n</code></pre>\n\n<p>or should i add a condition to the SELECT CASE?</p>\n"},{"tags":["php","mysql","sql","wordpress","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12984021,"title":"MySQL: Searching one simple table, but combining the WordPress 'wp_usermeta' table with meta_key/meta_value","body":"<p>As I mention in the title, I'm doing a request for latitude and longitude within a 'bid_userloc' table ... but I need to combine information from the 'wp_usermeta' table ...</p>\n\n<pre><code>SET @centerLat = '48.531157';\nSET @centerLng = '-123.782959';\n\nSELECT *, ( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat ) ) ) ) AS distance FROM bid_userloc HAVING distance &lt; 25 ORDER BY distance LIMIT 0 , 20\n</code></pre>\n\n<p>And using the <code>user_id</code> that comes in from the <code>SELECT *</code>, I need to get some user data from the <code>wp_userdata</code> table that looks like this:</p>\n\n<pre><code>id\nmeta_key\nmeta_value\n</code></pre>\n\n<p>For example, I need the <code>meta_value</code> of <code>meta_key</code> \"nickname\" ... as well as a number of others, but once I see how it's done for one, I can add more.</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["mysql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12984231,"title":"MySql Query: Total Average for multiple tables","body":"<p>I want to calculate the overall average GPA for all of the students in one of the departments, this is what I came up with but it does it not work</p>\n\n<pre><code>COLUMN AVERAGE FORMAT 0.999  \nSELECT  AVG(GPA) \"AVERAGE\"  \nFROM    STUDENT  \nWHERE   (YEAR &lt; 4) AND \n        (MAJOR LIKE '%ACCT%') AND \n        (MAJOR LIKE '%FINA%') AND \n        (MAJOR LIKE '%MGMT%') AND \n        (MAJOR LIKE '%AISY%') AND \n        (MAJOR LIKE '%MINS%') AND \n        (MAJOR LIKE '%SCMS%');  \n</code></pre>\n\n<p>so they should be both undergraduates and be enrolled in one of those majors.</p>\n\n<p>Also as an additional question: is it possible to write such a query using \"GROUP BY ### and HAVING ###) ? how?</p>\n"},{"tags":["sql","tsql","query","sql-server-2000"],"answer_count":14,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":24264,"score":7,"question_id":982932,"title":"SQL query to return one single record for each unique value in a column","body":"<p>I have a table in SQL Server 2000 that I am trying to query in a specific way.  The best way to show this is with example data.</p>\n\n<p>Behold, <code>[Addresses]</code>:</p>\n\n<pre><code>Name         Street                 City          State\n--------------------------------------------------------\nBob          123 Fake Street        Peoria        IL\nBob          234 Other Street       Fargo         ND\nJim          345 Main Street        St Louis      MO\n</code></pre>\n\n<p>This is actually a simplified example of the structure of the actual table.  The structure of the table is completely beyond my control.  I need a query that will return a single address per name.  It doesn't matter which address, just that there is only one.  The result could be this:</p>\n\n<pre><code>Name         Street                 City          State\n--------------------------------------------------------\nBob          123 Fake Street        Peoria        IL\nJim          345 Main Street        St Louis      MO\n</code></pre>\n\n<p>I found a similar question <a href=\"http://stackoverflow.com/questions/715804/query-to-return-1-instance-of-a-record-with-duplicates\">here</a>, but none of the solutions given work in my case because I do not have access to <code>CROSS APPLY</code>, and calling <code>MIN()</code> on each column will mix different addresses together, and although I don't care which record is returned, it must be one intact row, not a mix of different rows.</p>\n\n<p>Recommendations to change the table structure will not help me.  I agree that this table is terrible, (it's worse than shown here) but this is part of a major ERP database that I can not change.</p>\n\n<p>There are about 3000 records in this table.  There is no primary key.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["query","solr","dismax"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":12963979,"title":"Solr End User Query Translation","body":"<p>I am wondering if there is anyway to transform an end user query to a more complicated solr query based on some rules.</p>\n\n<p>For example, if the user types in 32\" television, then I want to use the dismax query parser to let solr take care of this user query string like below:</p>\n\n<pre><code>http://localhost:8983/solr/select/?q=32\" television&amp;defType=dismax\n</code></pre>\n\n<p>However, if the user types in \"televisions on sale\", then I want to do a regular search for token televisions and onsale flag is true like below:</p>\n\n<pre><code>http://localhost:8983/solr/select/?q=name:televisions AND isOnSale:true\n</code></pre>\n\n<p>Is this possible? Or must this logic require an advance search form where the user can clearly state in a checkbox that they only want on sale items.</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","mysql","query","class","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12983906,"title":"query mysql database from inside a class","body":"<p>I'm trying to run a query to a MySQL database from within a class and it's not working for some reason.  I have the class in a separate file which I'm linking to with the <code>require_once()</code> function.</p>\n\n<p>here's what the main .php file looks like:</p>\n\n<pre><code>&lt;?php\n  require_once(\"connect.php\");\n  require_once(\"theClass.php\");\n\n  $a = new theClass;\n  $a-&gt;runQuery();\n}\n</code></pre>\n\n<p>connect.php:</p>\n\n<pre><code>&lt;?php\n//connect to mySQL database\n$mysqli = new mysqli(\"host\", \"user\", \"password\", \"db\");\nif ($mysqli-&gt;connect_errno)\n{\n    echo \"&lt;br&gt;&lt;h1&gt;Failed to connect to MySQL: (\" . $mysqli-&gt;connect_errno . \") \" . $mysqli-&gt;connect_error . \"&lt;/h1&gt;&lt;br&gt;\";\n}\n</code></pre>\n\n<p>theClass.php:</p>\n\n<pre><code>&lt;?php\nrequire_once('connect.php');\n\nclass theClass\n{\n  //class variables and other functions here\n\n  function runQuery()\n  {\n    $query = \"SELECT col_1 FROM db.table\";\n    $stmt = $mysqli-&gt;prepare($query);\n    stmt-&gt;execute();\n    $stmt-&gt;bind_result($r);\n\n    while($stmt-&gt;fetch())\n    {\n      echo $r . \"&lt;br&gt;\";\n    }\n  }\n};\n</code></pre>\n\n<p>I've tried copying the class into the main .php file and it still doesn't work; however, I have used the exact same code( the query, prepare, execute, bind_result, and fetch part) in an external .php file as well as inside the main .php file and it has worked both times.  This leads me to believe that you're not able to run queries from inside a class or that there is a different way of going about doing so.  Could anyone point me in the right direction? </p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","query","performance"],"answer_count":10,"favorite_count":1,"up_vote_count":11,"down_vote_count":1,"view_count":1270,"score":10,"question_id":561900,"title":"How many MySQL queries should I limit myself to on a page? PHP / MySQL","body":"<p>Okay, so I'm sure plenty of you have built crazy database intensive pages...  </p>\n\n<p>I am building a page that I'd like to pull all sorts of unrelated database information from.  Here are some sample different queries for this one page:</p>\n\n<ul>\n<li>article content and info</li>\n<li>IF the author is a registered user, their info</li>\n<li>UPDATE the article's view counter</li>\n<li>retrieve comments on the article</li>\n<li>retrieve information for the authors of the comments</li>\n<li>if the reader of the article is signed in, query for info on them</li>\n<li>etc...</li>\n</ul>\n\n<p>I know these are basically going to be pretty lightning quick, and that I could combine some; but I wanted to make sure that this isn't abnormal?</p>\n\n<p>How many fairly normal and un-heavy queries would you limit yourself to on a page?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12983182,"title":"SQL: Get column where it contains 1 or another","body":"<p>This is an \"either or\" kind of query that I can't figure out the best way to approach</p>\n\n<p><code>SELECT id, serial_number FROM bid_tag WHERE active = 1 AND house_id = 0 OR house_id = 14</code></p>\n\n<p>So I need to get a house_id that is either <strong>0</strong> or a specific number of \"14\"</p>\n"},{"tags":["sql","query","jpa"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2533,"score":4,"question_id":6276122,"title":"Can I get the SQL string from a JPA query object?","body":"<p>May I know how can I get the sql from a JPA query? or let's say, convert the JPA query to a SQL string? Thank you very much!</p>\n"},{"tags":["sql","database","query","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12981408,"title":"implementing substitution variables in access 2007","body":"<p>is there a way i can use substitution variables in access 2007, i wrote a query that returns rows which have a word okeu in them but i want to use substitution variables so that i can retrieve any word i want and if the word i want is not there i want to pop a message saying <code>word not there</code>  its easier to do it in oracle sqlplus but how can i apply it in access using sql queries??any ideas,thanks in advance</p>\n\n<p>this is my sql i made in access</p>\n\n<pre><code>SELECT MENU.NAME_REC, MENU.C_REC, AUTO.C_GROUP\nFROM MENU, AUTO\nWHERE (((MENU.NAME_REC)=\"okeu\"));\n</code></pre>\n"},{"tags":["query","ms-access"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":10842,"score":2,"question_id":96661,"title":"How can I make MS Access Query Parameters Optional?","body":"<p>I have a query that I would like to filter in different ways at different times.  The way I have done this right now by placing parameters in the criteria field of the relevant query fields, however there are many cases in which I do not want to filter on a given field but only on the other fields.  Is there any way in which a wildcard of some sort can be passed to the criteria parameter so that I can bypass the filtering for that particular call of the query?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12980002,"title":"SELECT DISTINCT not doing what I would hope it would do","body":"<p>I am trying to bring back a list of properties. Properties can have many \"passes\". I want to bring back a list of unique properties but if they have multiple passes, I want the one with the largest pass_id. This is what I have so far:</p>\n\n<pre><code>select * from passes\ninner join properties on properties.prop_id = passes.prop_id\nwhere pass_id NOT IN (select pass_id from queue where user_id = 1)\n\n+---------+---------+---------+---------+------------------+--------------+-------+\n| pass_id | prop_id | user_id | prop_id | full_street_name | house_number | zip   |\n+---------+---------+---------+---------+------------------+--------------+-------+\n|      18 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      20 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      21 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      22 |      22 |       1 |      22 |  E CHESTNUT ST   |          111 | 60611 |\n+---------+---------+---------+---------+------------------+--------------+-------+\n</code></pre>\n\n<p>I want it to return only pass_id 21 and 22 since 18 and 20 are duplicate properties of 21. Thanks in advance.</p>\n"},{"tags":["query","google-fusion-tables"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":12972778,"title":"Fusion Tables numeric ID","body":"<p>I'm working on a multiple query with Fusion Table. Till yesterday I used numericID but today creating a new Table, FT shows no numeric ID in the about menu. I tried to change NUmeric ID with Ecrypted one, but it doesn't work. This is the page:</p>\n\n<p><a href=\"http://siti-torino.hostei.com/test/test_09_02.html\" rel=\"nofollow\">http://siti-torino.hostei.com/test/test_09_02.html</a> ( <code>numeric ID</code>)\n<a href=\"http://siti-torino.hostei.com/test/test_09_03.html\" rel=\"nofollow\">http://siti-torino.hostei.com/test/test_09_03.html</a> ( <code>Encrypted ID</code>)</p>\n\n<p>It's quite clear that the query works correctly (the counter show the right result), but the script can't update the map. So I suppose the problem is at line 94-95</p>\n\n<pre><code>searchTracks = new google.maps.FusionTablesLayer(fusionTableId, { query: searchStr});\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["oracle","query","clob"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":222,"score":1,"question_id":12980038,"title":"ORA-00932: inconsistent datatypes: expected - got CLOB","body":"<p>Considering  that <code>TEST_SCRIPT</code> is a <code>CLOB</code>  why when I run this simple query from SQL*PLUS on Oracle , I get the error:</p>\n\n<pre><code>ORA-00932: inconsistent datatypes: expected - got CLOB\n</code></pre>\n\n<p>I have been reading a lot of questions about the same error but none of those is running a direct query from SQLPLUS </p>\n\n<pre><code>    UPDATE IMS_TEST \n       SET TEST_Category  = 'just testing'  \n     WHERE TEST_SCRIPT    = 'something'\n       AND ID             = '10000239' \n</code></pre>\n\n<p>Full example:</p>\n\n<pre><code>SQL&gt; create table ims_test(\n  2  test_category varchar2(30),\n  3  test_script clob,\n  4  id varchar2(30)\n  5  );\n\nTable created.\n\nSQL&gt; insert into ims_test values ('test1','something','10000239');\n\n1 row created.\n\nSQL&gt; UPDATE IMS_TEST\n  2  SET TEST_Category  = 'just testing'\n  3  WHERE TEST_SCRIPT    = 'something'\n  4  AND ID             = '10000239';\nWHERE TEST_SCRIPT    = 'something'\n      *\nERROR at line 3:\nORA-00932: inconsistent datatypes: expected - got CLOB\n</code></pre>\n"},{"tags":["sql","oracle","query","select","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12979452,"title":"Transposing Non-Aggregate Fields in an Oracle SELECT","body":"<p>For a table structured as such:</p>\n\n<pre><code>\"Object Attribute\" Table - Links objects with all of their attributes and values;\nObject ID       Attribute ID    Attribute String Value  ...\n1337            123             Example Object Title\n1337            124             Example Object Type\n1337            125             Example Object Description\n1337            126             Example Object Author\n0001            123             (null)\n0001            124             SomeType\n0001            125             This is an example record\n0001            126             Jiman\n0002            123             Bar\n0002            124             BarType\n0002            125             This is another\n0002            126             Jiman\n</code></pre>\n\n<p>EDIT: Attribute ID's have the following mapping:</p>\n\n<pre><code>Attribute ID    Attribute Name\n123             Title\n124             Type\n125             Description\n126             Author\n</code></pre>\n\n<p>How would I compose an Oracle query that returns a transposed set of data, where the Title field is NULL?</p>\n\n<p>Example output:</p>\n\n<pre><code>ID      Title       Type        Description             Author\n0001    (null)      FooType     This is an example...   Jiman\n</code></pre>\n\n<p>Can PIVOT be used to transpose non-aggregate values (i.e., those string attributes)?</p>\n"},{"tags":["mysql","sql","database","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12980075,"title":"Connecting table with multiple foreign keys in mysql","body":"<p>Hi I have a database table with the following information :</p>\n\n<pre><code>owner.primaryitowner, \nowner.secondaryitowner, \nowner.primarybusinessowner, \nowner.secondarybusinessowner\n</code></pre>\n\n<p>The issue, is the owners are only stored as emails. There is another table I normally inner join users on <code>users.username = owner.primaryitowner</code> to get <code>users.displayname</code> so the data reads correctly. The issue is I need to do this for all 4 columns, and when I can only figure out how to connect 1 column in a query. Thanks for the help</p>\n\n<p>PS I cannot change the database I am only a report writer.</p>\n\n<p>Thanks so much in advance</p>\n"},{"tags":["query","sharepoint","sorting","sql-order-by","caml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12935946,"title":"How can I sort items in a splistitemcollection?","body":"<p>I have a problem in sharepoint webpart.\nI have a custom list where in I have a column name order with type number.\nthen I created a webpart that display the list and sorted by the column order.</p>\n\n<p>I have this caml query<br/>\nstring test =<br/><code>&lt;Query&gt;</code> + <br/>\n                    &nbsp;&nbsp;   <code>&lt;OrderBy&gt;</code> + <br/>\n         &nbsp;           &nbsp;&nbsp;&nbsp;        <code>&lt;FieldRef Name='order0' Ascending='True' /&gt;</code> +<br/>\n                  &nbsp;&nbsp;     <code>&lt;/OrderBy&gt;</code> +<br/>\n             <code>&lt;/Query&gt;</code>;<br/></p>\n\n<p>my problem is when I loop like this sample</p>\n\n<p>foreach (SPListItem result in items)\n  {\n    .....\n }</p>\n\n<p>the result will always be like this:<br/>\n4 <br/>\n1<br/>\n2<br/>\n3<br/></p>\n\n<p>where I want to have like this:<br/>\n1<br/>\n2<br/>\n3<br/>\n4<br/></p>\n\n<p>Please I really need your help. I'm really new in sharepoint and I don't have a training for this.</p>\n\n<p>Thanks,<br/>\nGracela</p>\n"},{"tags":["php","sql","database","query","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12979722,"title":"The word Array is displayed instead of the database entry","body":"<p>I am trying to print selected product names from my database, however all i see is the word \"Array\" instead of the product name. It is displayed as many times as the number products it finds, and that number is correct, but it only shows \"Array\"...</p>\n\n<p>Here's my code:</p>\n\n<pre><code>public function lookup($product)\n    {\n\n        $camera = $this-&gt;db-&gt;query(\"SELECT name FROM products WHERE type = 'Camera' \");\n\n        $laptop = $this-&gt;db-&gt;query(\"SELECT name FROM products WHERE type = 'Laptop' \");\n\n\n        $data = array();\n\n        switch($product)\n        {\n            case 'camera' : \n            foreach ($camera-&gt;result() as $row)\n            {\n                $entry = array();\n                $entry['name'] = $row-&gt;name;\n                $data[] = $entry;\n            }\n            return $data; break;\n\n            case 'laptop' :\n            foreach ($laptop-&gt;result() as $row)\n            {\n                $entry = array();\n                $entry['name'] = $row-&gt;name;\n                $data[] = $entry;\n            }\n            return $data; break;\n\n        }   \n    }\n</code></pre>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12979008,"title":"Utilizing SQL datepart to indentify consecutive periods of time","body":"<p>I have a stored procedure that works correctly, but don't understand the theory behind why it works. I'm indentifying a consecutive period of time by utilizing a datepart and dense rank (found solution through help elsewhere). </p>\n\n<pre><code>        select \n            c.bom\n            ,h.x\n            ,h.z\n            ,datepart(year, c.bom) * 12 + datepart(month, c.bom) -- this is returning a integer value for the year and month, allowing us to increment the number by one for each month\n            - dense_rank() over ( partition by h.x order by datepart(year, c.bom) * 12 + datepart(month, c.bom)) as grp -- this row does a dense rank and subtracts out the integer date and rank so that consecutive months (ie consecutive integers) are grouped as the same integer\n\n        from \n            #c c\n\n            inner join test.vw_info_h h\n            on h.effective_date &lt;= c.bom\n            and (h.expiration_date is null or h.expiration_date &gt; c.bom)\n</code></pre>\n\n<p>I understand in theory what is happening with the grouping functionality.</p>\n\n<p><strong>How does multiplying year * 12 + month work? Why do we multiply the year? What is happening in the backend?</strong></p>\n"},{"tags":["java","mysql","database","query","jdbc"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":12963504,"title":"Preferred way to query a database multiple times?","body":"<p>When using JDBC in Java, the generally accepted method of querying a database is to acquire a connection, create a statement from that connection, and then execute a query from that statement.</p>\n\n<pre><code>// load driver\nConnection con = DriverManager.getConnection(..);\nStatement stmt = con.createStatement();\nResultSet result = stmt.executeQuery(\"SELECT..\");\n// ...\n</code></pre>\n\n<p>However, I am unsure of how to treat a second query to the same database.</p>\n\n<ol>\n<li><p>Can another query be executed safely on the same <code>Statement</code> object, or must another statement be created from the <code>Connection</code> object in order to execute another query?</p></li>\n<li><p>If the same <code>Statement</code> object can be used for multiple queries, what is the purpose of the <code>Statement</code> class (since it would then make more sense for a <code>Connection.executeQuery()</code> method to exist)?</p></li>\n</ol>\n"},{"tags":["visual-studio-2010","query","tfs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12976404,"title":"TFS 2010 Team query does not work","body":"<pre><code>AndOr   Field   Operator    Value\n    Team Project    =       @Project\nAnd Area Path       Under   MyProject \nAnd Iteration Path  Under   MyProject\\Iteration 5\nAnd Work Item Type  =       User Story\nOr  Work Item Type  =       Task\n</code></pre>\n\n<p>after I run the query, I see all the workitesm in the results.  I am looking only for the ones under MyProject\\Iteration 5 but I see everything under Iteration 4 , Iteration 3 , etc.</p>\n\n<p>The way I added my Iteration 5 was to go to Areas and Iterations and creating itttttt.  Any help is highly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":174,"score":2,"question_id":6399058,"title":"Order by polymorphic belongs_to attribute","body":"<p>How do I make an ActiveRecord query that orders by an attribute of a polymorphic belongs_to association?</p>\n\n<p>For example I have model called <code>Tagging</code> that has a polymorphic belongs_to association named <code>tagged_item</code>.</p>\n\n<p>Unfortunately <code>Tagging.joins(:tagged_item)</code> throws a <code>ActiveRecord::EagerLoadPolymorphicError</code>. So I can't do something like <code>Tagging.joins(:tagged_item).order(\"tagged_item.created_at DESC\")</code>.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["query","sharepoint","caml"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12815623,"title":"CAML filter to get the current month from the list?","body":"<p>In SharePoint 2010, I need to get items from a list based on a condition. Considering one of the fields to be 'Date' of type DateTime, the condition is:</p>\n\n<p>Get Current Month Data.</p>\n\n<p>How do I filter the list items based on this condition using CAML Qurey?</p>\n\n<p>By,\nRaji</p>\n"},{"tags":["performance","oracle","query","database-design","data-warehouse"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":12973618,"title":"Oracle explain plan over simple select performs multiple hash joins when multiple columns are indexed in a table","body":"<p>I am currently running into an issue with my Oracle instance.  I have two simple select statements:  </p>\n\n<pre><code>select * from dog_vets  \n</code></pre>\n\n<p>and  </p>\n\n<pre><code>select * from dog_statuses\n</code></pre>\n\n<p>and the following <a href=\"http://sqlfiddle.com/#!4/37754\" rel=\"nofollow\">fiddle</a></p>\n\n<p>My explain plan on <code>dog_vets</code> is as follows:  </p>\n\n<pre><code> 0 | Select Statement  \n 1 | Table Access Full Scan dog_vets\n</code></pre>\n\n<p>my explain plan on <code>dog_statuses</code>  is as follows:  </p>\n\n<pre><code>ID|Operation | Name | Rows |Bytes | cost | time    \n0 | Select Statement |  | 20G | 500M | 100000 | 999:99:17  \n1 | View  | index%_join_001 | 20G | 500M | 100000 | 999:99:17  \n2 | Hash Join  |  | | | |   \n3 | Hash Join  |  | | | |   \n4 | Index fast full scan dog_statuses_check_up  |  | 20G | 500M | 100000 | 32:15:00  \n5 | Index fast full scan dog_statuses_sick|  | 20G | 500M | 100000 | 35:19:00  \n</code></pre>\n\n<p>To get this type of output execute the following statement:  </p>\n\n<pre><code>explain plan for   \nselect * from dog_vets;\n</code></pre>\n\n<p>OR</p>\n\n<pre><code> explain plan for   \n    select * from dog_statuses;\n</code></pre>\n\n<p>and then  </p>\n\n<pre><code>select * from table(dbms_xplan.display);\n</code></pre>\n\n<p>Now my question is, why do multiple indexes imply a view (materialized  I assume) being created in my above statements and further what type of performance hit am I suffering on this type of query?  As it stands now <code>dog_vets</code> has ~300 million records and <code>dog_Statuses</code> has about 500 million.  I have yet to be able to get <code>select * from dog_statuses</code> to return in under 10 hours.  This is primarily because the query dies before it completes.  </p>\n\n<p><strong>DDL</strong>  </p>\n\n<p>In case sql fiddle dies:  </p>\n\n<pre><code>create table dog_vets\n(\n     name varchar2(50),\n     founded timestamp,\n     staff_count number\n  );\n\ncreate table dog_statuses\n(\n      check_up timestamp,\n      sick varchar2(1)\n  );\n\n\ncreate index dog_vet_name\non dog_vets(name);\n\ncreate index dog_status_check_up\non dog_statuses(check_up);\n\ncreate index dog_status_sick\non dog_statuses(sick);\n</code></pre>\n"},{"tags":["mysql","sql","query","subquery","ranking"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12976162,"title":"Ranking system using a complex query: more precise filters","body":"<p>To realize a ranking system on my gameserver, I store some information about each player in a MySQL database.\nI've got the following database tables.</p>\n\n<p>Table <code>players</code> with example data:</p>\n\n<pre><code>id | steamId | deaths\n---+---------+-------\n1  | asdja   | 2\n2  | kfjsl   | 5\n</code></pre>\n\n<p>Table <code>weapons</code> with example data:</p>\n\n<pre><code>playerId | weaponId | kills\n---------+----------+------\n1        | 5        | 8\n1        | 9        | 7\n2        | 3        | 3\n2        | 6        | 10\n2        | 7        | 2\n</code></pre>\n\n<p>You see that I do not store the kills for each player in the <code>players</code>-table, because I could simply calculate it from the <code>weapons</code>-table.\nI'm not very familiar with SQL queries, but I finished creating the following one to select a simple data set with following fields:</p>\n\n<pre><code>kills,\ndeaths,\nkill-death-rate (kdrate),\ncount (maximum number of players),\nrank (current ranking position, sorted by kills)\n</code></pre>\n\n<p>The query:</p>\n\n<pre><code>SELECT\n    SUM(weapons.kills) AS `kills`,\n    `deaths`,\n    (SUM(kills) / IF(deaths, deaths, 1)) AS `kdrate`,\n    (SELECT COUNT(*) FROM `players`) AS `count`,\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            (\n                SELECT\n                    p.id AS id2,\n                    SUM(w.kills) AS kills2,\n                    p.deaths AS deaths2,\n                    p.steamId AS steamId2\n                FROM\n                    weapons AS w,\n                    players AS p\n                WHERE\n                    p.id = w.playerId\n                GROUP BY\n                    p.id\n            ) AS temp\n        WHERE\n            temp.kills2 &gt;= (\n                SELECT\n                    SUM(weapons.kills) AS `kills`\n                FROM\n                    `players`,\n                    `weapons`\n                WHERE\n                    players.id = weapons.playerId AND\n                    `id` = 1\n                GROUP BY\n                  `id`\n            )\n        ORDER BY\n            temp.kills2 DESC,\n            temp.deaths2 ASC,\n            temp.steamId2 ASC\n    ) AS `rank`\nFROM\n    `players`\nINNER JOIN\n    `weapons`\nON\n    players.id = weapons.playerId\nWHERE\n    `id` = 1\nGROUP BY\n    `id`\n</code></pre>\n\n<p>There are two problems:</p>\n\n<p>1.) The query is horrible.</p>\n\n<p>2.) Executing this query with the given example data results in \"the same rank\".\nI mean, both players get the same rank because I the amount of kills is the same on both players.\nBut instead, player 1 should be on rank 1 because he has less deaths than player 2.\nI don't know how I can realize this.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:\n@Manueru_mx gave me a basic idea of how to do it:\nI've got the following code based on his answer:</p>\n\n<pre><code>SELECT\n    id,\n    kills,\n    deaths,\n    kdrate,\n    COUNT(*) AS rank,\n    (SELECT COUNT(*) FROM players) AS `count`\nFROM\n    (\n        SELECT\n            pys.id AS id,\n            SUM(wps.kills) AS kills,\n            pys.deaths AS deaths,\n            (SUM(wps.kills) / pys.deaths) as kdrate\n        FROM\n            players pys\n        INNER JOIN\n            weapons wps\n        ON\n            pys.id = wps.playerid\n        GROUP BY\n            pys.id\n        ORDER BY\n            2 DESC,\n            3,\n            4 ASC\n    ) AS tmp\nWHERE\n    id = 1\n</code></pre>\n\n<p>The only problem left is, that the <code>rank</code> is 1 in both cases.</p>\n"},{"tags":["query","solr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12977389,"title":"How to filter query in solr by date?","body":"<p>In my SOLR there is date field(published_date) and values are in this format <em>\"2012-09-26T10:08:09.123Z\"</em></p>\n\n<p>How I can search by simple input like \"2012-09-10\" instead of full ISO date format.</p>\n\n<p>Is it possible in SOLR?I have tried with </p>\n\n<p><code>fq=[2012-09-24%20TO%20NOW]</code></p>\n\n<p>It should return by filtering results greater than published date 2012-09-24 and less than NOW.</p>\n\n<p>But it returns data with published date with 2012-09-23,like below</p>\n\n<pre><code>&lt;float name=\"score\"&gt;2.8183863&lt;/float&gt;\n&lt;str name=\"name\"&gt;Local Team Inspires Obama&lt;/str&gt;\n&lt;date name=\"published_date\"&gt;2012-09-23T07:44:53.123Z&lt;/date&gt;\n</code></pre>\n\n<p>Am I missing something?</p>\n\n<p>thanks in advance.</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12975454,"title":"SQL Server 2008: Finding strings within a table which contain the word World","body":"<p>I'm trying to filter my query to show only table entries with the word WORLD and also contains other country codes. </p>\n\n<p>I have used the wildcard function but I am unsure as to how I can have it only return entries with both WORLD and other country codes.</p>\n\n<pre><code>SELECT *\nFROM [****].[dbo].[Titles]\nWHERE Territories LIKE '%world%'\n</code></pre>\n\n<p>Any help is appreciated </p>\n\n<p>EDIT: Expected result would return all rows with both WORLD and one or more country code in the field. The territories column in this table contains both World or country codes and should bot contain both. the reason im running this query is to search for any rows with bad data.</p>\n"},{"tags":["php","mysql","query","function","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12966091,"title":"PHP pass variables to my own MySQL function--DB using variable as column name","body":"<p>This is sort of a follow up to my last question (http://stackoverflow.com/questions/12945119/mysql-function-add-prices-from-multiple-tables ) so the MySQL code is there.  My background with DBs is all SQL Server 2008 and Access, so the idiosyncrasies of MySQL are getting the better of me.  I've Googled my brains out, read every even vaguely relevant Q&amp;A on StackOverflow, StackExchange's programming and webdeveloper boards, etc.  (Had to get that disclaimer out of the way.)</p>\n\n<p>I ran the function in DreamCoder and when it just prompts me for intput and then runs the function, it returns the correct answer (a decimal,) so the function's logic is sound as far as I can tell. However, when I try to call the function from PHP, it errors out.</p>\n\n<p>The DB access code is as follows:</p>\n\n<pre><code>function getQuote($json)\n\necho(\"JSON input: \");\nvar_dump($json);\n\n    $array = json_decode($json, TRUE);\n    echo(\"JSON decoded array: \");\n    print_r($array);\n\n    $cheese = $array[0];\n    $meat = $array[1];\n    $veg = $array[2];   \n\n    $c = db_connect();\n    $query = \"SELECT calculatePrice($cheese, $meat, $veg)\";\n    var_dump($query);\n    $result  = mysql_query($query , $c);\n    if(!$result)\n    {\n        echo \"\\nCould not successfully run query ($query) from DB: \" . mysql_error();\n        exit;\n    }\n\nif (mysql_num_rows($result) == 0) {\n    echo \"No rows found, nothing to print so am exiting\";\n    exit;\n}\n\nwhile($row = mysql_fetch_assoc($result)){\n    echo(\"Row: \");\n    var_dump($row);\n\n    if(!$row)\n        die(\"No price returned!\" . var_dump($row));\n    else\n    {   \n        return json_encode($row);   \n    }\n}  //end while\n</code></pre>\n\n<p>And I wrote the following \"test harness\" to manually feed it data.  I know the JSON's going in right because the full code gives the same error verbatim, so the issues's either PHP or MySQL.</p>\n\n<pre><code>    &lt;?php\n        require_once 'DBUtils.php';\n\n    $array = array();\n    $array[] = \"Chedder\";\n    $array[] =\"Ham\";\n    $array[] =\"Carrot\";\n\n    $json = json_encode($array);\n    echo(\"JSON object:\");\n    var_dump($json);\n\n    $test = getQuote($json);\n\n        echo(\"Test: \");\n        print_r($test);\n\n    ?&gt;\n</code></pre>\n\n<p>I've also tried MySQLi, same deal, same error.  According to MySQL's documentation, scant as it is, I'm calling the function properly and passing the variables correctly.  (PHP's documentation on such is virtually non-existent; their examples all amount to \"SELECT * from tblFoo WHERE bar=4.\")</p>\n\n<p>The error is that it treats chedder as a column name rather than as the variable: \"Unknown column 'cheddar' in 'field list'\".  What am I missing?</p>\n\n<p>I could do this in SQLServer and ASP.NET without batting an eye, but MySQL/PHP is confusing the penguins out of me X_X  (Not Linux penguins, just the zoo kind.)</p>\n\n<p>PHP version is 5.3.17, MySQL is 5.1 in case either makes a difference.  I think PHP 5.4.* has some relevant methods, but before I go through the hassle of changing my PHP version, I'd rather exhaust any 5.3.* options first.</p>\n\n<p>I'm well-aware the answer is probably obvious, and know there's no one who'll outdo me for calling myself stupid once I learn what I'm doing.</p>\n\n<p>Thank you again!  This site is darned near my go-to before Google for questions ^_^  (And at least 2/3 of the results for any Google question I ask come from here anyway =-p )</p>\n\n<p>EDIT:\nOK the MySQL works alone (SELECT from etc...)  Turns out it wanted ' vs. `.</p>\n"},{"tags":["django","query","optimization","foreign-keys","generic-foreign-key"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12466945,"title":"django: prefetch related objects of a GenericForeignKey","body":"<p>Suppose I have a model <code>Box</code> with a <code>GenericForeignKey</code> that points to either an <code>Apple</code> instance or a <code>Chocolate</code> instance. <code>Apple</code> and <code>Chocolate</code>, in turn, have ForeignKeys to <code>Farm</code> and <code>Factory</code>, respectively. I want to display a list of <code>Box</code>es, for which I need to access <code>Farm</code> and <code>Factory</code>. How do I do this in as few DB queries as possible?</p>\n\n<p>Minimal illustrative example:</p>\n\n<pre><code>class Farm(Model):\n    ...\n\nclass Apple(Model):\n    farm = ForeignKey(Farm)\n    ...\n\nclass Factory(Model):\n    ...\n\nclass Chocolate(Model):\n    factory = ForeignKey(Factory)\n    ...\n\nclass Box(Model)\n    content_type = ForeignKey(ContentType)\n    object_id = PositiveIntegerField()\n    content_object = GenericForeignKey('content_type', 'object_id')\n    ...\n\n    def __unicode__(self):\n        if self.content_type == ContentType.objects.get_for_model(Apple):\n            apple = self.content_object\n            return \"Apple {} from Farm {}\".format(apple, apple.farm)\n        elif self.content_type == ContentType.objects.get_for_model(Chocolate):\n            chocolate = self.content_object\n            return \"Chocolate {} from Factory {}\".format(chocolate, chocolate.factory)\n</code></pre>\n\n<p>Here are a few things I tried. In all these examples, <strong>N</strong> is the number of Boxes. The query count assumes that the <code>ContentType</code>s for <code>Apple</code> and <code>Chocolate</code> have already been cached, so the <code>get_for_model()</code> calls do not hit the DB.</p>\n\n<p>1) Naive:</p>\n\n<p><code>print [box for box in Box.objects.all()]</code></p>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>N</strong> (fetch Apple or Chocolate for each Box) + <strong>N</strong> (fetch Farm for each Apple and Factory for each Chocolate) queries.</p>\n\n<p>2) <code>select_related</code> doesn't help here, because <code>Box.content_object</code> is a <code>GenericForeignKey</code>.</p>\n\n<p>3) As of django 1.4, <code>prefetch_related</code> can fetch <code>GenericForeignKey</code>s.</p>\n\n<p><code>print [box for box in Box.objects.prefetch_related('content_object').all()]</code></p>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>2</strong> (fetch Apples and Chocolates for all Boxes) + <strong>N</strong> (fetch Farm for each Apple and Factory for each Chocolate) queries.</p>\n\n<p>4) Apparently <code>prefetch_related</code> isn't smart enough to follow ForeignKeys of GenericForeignKeys. If I try:</p>\n\n<p><code>print [box for box in Box.objects.prefetch_related(\n    'content_object__farm',\n    'content_object__factory').all()]</code></p>\n\n<p>it rightfully complains that <code>Chocolate</code> objects don't have a <code>farm</code> field, and vice versa.</p>\n\n<p>5) I could do:</p>\n\n<pre><code>apple_ctype = ContentType.objects.get_for_model(Apple)\nchocolate_ctype = ContentType.objects.get_for_model(Chocolate)\nboxes_with_apples = Box.objects.filter(content_type=apple_ctype).prefetch_related('content_object__farm')\nboxes_with_chocolates = Box.objects.filter(content_type=chocolate_ctype).prefetch_related('content_object__factory')\n</code></pre>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>2</strong> (fetch Apples and Chocolates for all Boxes) + <strong>2</strong> (fetch Farms for all Apples and Factories for all Chocolates) queries. The downside is that I have to merge and sort the two querysets (<code>boxes_with_apples</code>, <code>boxes_with_chocolates</code>) manually. In my real application, I'm displaying these Boxes in a paginated ModelAdmin. It's not obvious how to integrate this solution there. Maybe I could write a custom Paginator to do this caching transparently?</p>\n\n<p>6) I could cobble together something based on <a href=\"http://blog.roseman.org.uk/2010/02/22/django-patterns-part-4-forwards-generic-relations/\" rel=\"nofollow\">this</a> that also does O(1) queries. But I'd rather not mess with internals (<code>_content_object_cache</code>) if I can avoid it.</p>\n\n<p>In summary: <strong>Printing a Box requires access to the ForeignKeys of a GenericForeignKey. How can I print N Boxes in O(1) queries?</strong> Is (5) the best I can do, or is there a simpler solution?</p>\n\n<p>Bonus points: <strong>How would you refactor this DB schema to make such queries easier?</strong></p>\n"},{"tags":["mysql","forms","wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12975590,"title":"wordpress search form sql query","body":"<p>I am trying to build a custom search <code>form</code> that will query my <code>wordpress DB</code> for the results.\nThe problems I seem to encounter is that the form does not send anything to function upon action just says <code>404 not found</code>.</p>\n\n<p>The function to query the database is located at <code>functions/theme-search.php</code> and I have declared <code>function search_db</code> in it.</p>\n\n<p>Where am I going wrong?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12973700,"title":"Hibernate query date compare on year and month only","body":"<p>I need to grab some records from a table which has a Column <code>birthDate</code> which is a <code>Date</code>(without time). I need to filter records by comparing against year and month only. \nFor example I want all the users born on March of 1990. The day doesn't matter.</p>\n\n<p>How do you handle it?</p>\n"},{"tags":["php","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12972254,"title":"Best way to write a concatenating PHP MS SQL Query and put it into a loop","body":"<p>So normally I would write queries and loops like follows:</p>\n\n<pre><code>    $result = mssql_query(\"SELECT Element FROM Table WHERE Type='Type'\");\n\n                while ($row = mssql_fetch_array($result)) { \n}\n</code></pre>\n\n<p>I know it isn't best practice but I am still learning and it works. </p>\n\n<p>I used to concatenate my queries as follows:</p>\n\n<pre><code>$query = \"SELECT Element \";\n$query .= \"FROM Table \";\n$query .= \"WHERE Condition = 'no' \";\n\n$result = mssql_query($query);\n\n$numRows = mssql_num_rows($result);\n</code></pre>\n\n<p>This isn't very secure however I have written a SQL Encode but I digress. I now face the problem of having t write a very long query and loop it. I have written the following, however it doesn't work. Can someone tell me if my syntax is correct, so that I can debug if the problem lays with my syntax or another element. Any help would be greatly appreciated. </p>\n\n<pre><code> $query = \"INSERT INTO Items (BasketID, Qty, ProductType, Element1, Element2, Element3, Element4, Element5, Element6, Element7, Element8, Element9, Element10, Element11, Element12, Element13, Element14, Element15, Element16, Element17, Element18, Element19, Element20, DateAdded, Notes)\";\n$query .= \" VALUES (\"$_SESSION['basketid']\", \"1\", \"Type1\", \"SQLencode($_POST['Element1'])\", \"SQLencode($_POST['Element2'])\", \"SQLencode($_POST['Element3'])\", \"SQLencode($_POST['Element4'])\", \"SQLencode($_POST['Element5'])\", \"SQLencode($_POST['Element6'])\", \"SQLencode($_POST['Element7'])\",\";\n$query .= \"\"SQLencode($_POST['Element8'])\", \"SQLencode($_POST['Element9'])\", \"SQLencode($_POST['Element10'])\",\"SQLencode($_POST['Element11']\", \"SQLencode($_POST['Element12']\", \"SQLencode($_POST['Element13']\",\"SQLencode($_POST['Element14']\",\"SQLencode($_POST['Element15']\", \"SQLencode($_POST['Element16']\",\";\n$query .= \"\"SQLencode($_POST['Element17'])\",\"SQLencode($_POST['Element18'])\",\"SQLencode($_POST['Element19'])\", \"SQLencode($_POST['Element20'])\", \"NOW()\", \"SQLencode($_POST['Notes'])\" ) \"\n\n$insertsql = mssql_query($query);\n\nwhile ($insertrow = mssql_fetch_array($insertsql)) { \n\n\n?&gt;\n</code></pre>\n\n<p>I think/hope I am the right track, but I think my syntax for the actual query is slightly wrong somewhere but I can't quite figure out why, I keep getting unexpected t_variables. Can anyone point me where I am going wrong please?</p>\n"},{"tags":["mysql","database","query","function","mysql-workbench"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12969000,"title":"Identical MySQL query returning different result in MySQL Workbench than from command-line","body":"<p>This query `</p>\n\n<pre><code>delimiter $$\n\nCREATE DEFINER=`root`@`localhost` FUNCTION `calculatePrice`(cheese VARCHAR(50), meat VARCHAR(50), veg VARCHAR(50)) RETURNS decimal(10,0)\n    DETERMINISTIC\nBEGIN\nDECLARE price DECIMAL;\nSET price = (SELECT  SUM(x.Price) \n    FROM\n    (\n        SELECT `priceFactor` AS Price FROM `tblCheese` WHERE `cheeseName` = cheese\n        UNION ALL \n        SELECT `priceFactor` AS Price FROM `tblMeat` WHERE `meatName` = meat \n        UNION ALL \n        SELECT `priceFactor` AS Price FROM `tblVeggie` WHERE `veggieName` = veg\n    ) x );\nRETURN price;\nEND$$\n\n`\n</code></pre>\n\n<p>is returning the mathematically-correct answer when called from the MySQL command-line client, but incorrect for any other program or when called from PHP (it's returning 3 there, no matter what parameters are passed.)  See below:\n<img src=\"http://i.stack.imgur.com/hHcXs.png\" alt=\"Identical query, identical parameters, different results\"></p>\n\n<p>The calling statement, in case it's blurry, is SELECT calculatePrice('colby', 'sausage', 'black beans');</p>\n\n<p>I've never seen this weirdness before.  It's all going off of the same copy of MySQL, etc.</p>\n\n<p>Edit to add: phpMyAdmin also yields the correct answer to the query.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12971993,"title":"Working on friending system, need to have a way to add friend's id to WHERE query? Same column?","body":"<p>Ok this may be obvious but I am making a friending system but I need to have multiple possible userids for the userid column in my table <code>activity</code> but when i use the code below:</p>\n\n<pre><code>$q = $pdo-&gt;prepare(\"SELECT * FROM friends WHERE userid=:uid\");\n        $q-&gt;execute(array(\n            \":uid\"=&gt;$user['id'],\n        ));\n        if($q-&gt;rowCount()&gt;0){\n            $remainder =\"\";\n            foreach($q as $p){\n                $remainder .= \"OR `userid` =`\".$p['friendid'].\"`\";\n            }\n        }\n        $query = $pdo -&gt; prepare(\"SELECT * FROM `activity` WHERE `userid`=:id .$remainder. ORDER BY id DESC LIMIT 50\");\n        $query-&gt;execute(array(\n            \":id\"=&gt;$user['id']\n        ));\n</code></pre>\n\n<p>it in fact returns nothing when I <code>var_dump</code> the result. Whereas it should have the stream content of the user and all his/her friends.</p>\n\n<p>What have I done wrong here? I cannot seem to find the problem?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","mysql","query","date"],"answer_count":14,"favorite_count":12,"up_vote_count":24,"down_vote_count":0,"view_count":44312,"score":24,"question_id":510012,"title":"Get a list of dates between two dates","body":"<p>Using standard mysql functions is there a way to write a query that will return a list of days between two dates.</p>\n\n<p>eg given 2009-01-01 and 2009-01-13 it would return a one column table with the values:</p>\n\n<ul>\n<li>2009-01-01 </li>\n<li>2009-01-02 </li>\n<li>2009-01-03</li>\n<li>2009-01-04 </li>\n<li>2009-01-05</li>\n<li>2009-01-06</li>\n<li>2009-01-07</li>\n<li>2009-01-08 </li>\n<li>2009-01-09</li>\n<li>2009-01-10</li>\n<li>2009-01-11</li>\n<li>2009-01-12</li>\n<li>2009-01-13</li>\n</ul>\n\n<p>Edit: It appears I have not been clear. I want to GENERATE this list. I have values stored in the database (by datetime) but want them to be aggregated on a left outer join to a list of dates as above (I am expecting null from the right side of some of this join for some days and will handle this).</p>\n"},{"tags":["mysql","sql","query","group-by"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":12971455,"title":"Advances MySQL Group by","body":"<p>I have MySQL table that contains all messages from user to user:</p>\n\n<pre><code>id | to_id /*user_id*/ | from_id /*user_id*/\n 1 |  32               |  54\n 2 |  54               |  32\n 3 |  32               |  54\n</code></pre>\n\n<p>The goal is get MySQL answer like list of dialogs user_id - user_id ordered by date. But if i do sql query:</p>\n\n<pre><code>select * from messages group by to_id, from_id\n</code></pre>\n\n<p>i will get</p>\n\n<pre><code> to_id /*user_id*/ | from_id /*user_id*/\n  32               |  54\n  54               |  32\n</code></pre>\n\n<p>But first and second string is the same dialog. How can i group this records?</p>\n"},{"tags":["query","mongoid","has-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":11003179,"title":"How to select document with has_many relation with Mongoid","body":"<p>I know that my problem is the trivial one, but I need some help.</p>\n\n<p>I have two mongoid classes with <code>has_many</code> relation:</p>\n\n<pre><code>class Container\n    ...\n    has_many: items\n    ...\nend\n\nclass Item\n    ...\n    field :date, type =&gt; Date\n    belongs_to: container\n    ...\nend\n</code></pre>\n\n<p>I need all containers that have item at the particular date.</p>\n\n<p>Here is the scope that doesn't work as expected. It returns both, the containters that do have, and the containers that don't have items at the given date:</p>\n\n<pre><code>class Container\n    ...\n    scope :with_items_on, -&gt;(date){ where(:_id.in =&gt; Item.on(date).only(:container_id).distinct(:container_id)) }\n    ...\nend\n</code></pre>\n\n<p><code>.on(date)</code> is scope that returns correctly all Items for the given date.\nThanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12966848,"title":"getting the minimum and maximum date in the same query","body":"<p>I have a working query that gives me the maxdate:</p>\n\n<pre><code>SELECT a.client_id AS client_id\n   , a.patientcount AS patientcount\n   , received_date AS maxRecDate\nFROM\n(\n   SELECT DISTINCT CLIENT_ID\n   , PATIENT_ID\n   , count(*) over (partition by client_id, patient_id) AS patientcount\n   from f_accession_daily\n) AS a\nJOIN F_ACCESSION_DAILY AS f ON a.CLIENT_ID = f.CLIENT_ID\n   AND a.PATIENT_ID = f.PATIENT_ID\nGROUP BY f.RECEIVED_DATE, a.CLIENT_ID, a.patientcount\nHAVING f.RECEIVED_DATE = MAX(f.received_date)\n</code></pre>\n\n<p>In the same query I would also like to return min(f.received_date).</p>\n\n<p>Is there a way to do this? perhaps with the subquery?</p>\n"},{"tags":["mysql","performance","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12970402,"title":"Slow MySQL query with multiple sub-select joins","body":"<p>This has been bothering me all day:</p>\n\n<p>I have this query which works fine but is quite slow in some cases. The explain result tells me mysql is scanning 40000 rows 3 times. The query joins on approximatily similar sub-selects but there all a little different.</p>\n\n<p>How can I improve this?</p>\n\n<pre><code>SET @lastchecktime = (SELECT max(tresults.StartTime) FROM tresults);\nSELECT tresults.shopID\n , tshops.OfficialName\n , tresults.Price, tresults.starttime\n , Sub2.minprice\n , Sub2.StartTime\n , Sub3.daystoolow\n , (sub2.minprice/tsupplierproducts.lowestprice) -1 as afwijking\n , If(maxstarttime = @lastchecktime,'yes' ,'no') as notavailable     \nFROM\n  tresults\nINNER JOIN tshops\nON tshops.shopID = tresults.shopID\ninner JOIN (SELECT tresults.shopID\n                 , max(tresults.StartTime) AS MaxStartTime\n            FROM\n            tresults\n            WHERE\n              tresults.pID = 7\n              AND tresults.websiteID = 1\n              AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"              \n            GROUP BY\n              tresults.shopID) Sub1\nON tresults.StartTime = Sub1.MaxStartTime AND Sub1.shopID = tshops.shopID\nINNER JOIN (SELECT tresults.shopID\n             , tresults.StartTime\n             , min(tresults.Price) AS minprice\n        FROM\n          tresults\n        WHERE\n          tresults.pID = 7\n          AND tresults.websiteID = 1\n          AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"\n        GROUP BY\n          tresults.shopID) Sub2\nON Sub2.shopID = tshops.shopID\nINNER JOIN (SELECT tresults.shopID\n             , round(count(tresults.StartTime)/3,0) AS daystoolow\n        FROM\n          tsupplierproducts\n        INNER JOIN tresults\n        ON tsupplierproducts.pID = tresults.pID AND tresults.Price &lt; tsupplierproducts.LowestPrice\n        WHERE\n          tresults.pID = 7\n          AND tresults.websiteID = 1\n          AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"\n          AND tsupplierproducts.supplierID = 2\n        GROUP BY\n          tresults.shopID) Sub3\nON Sub3.shopID = tshops.shopID\nINNER JOIN tsupplierproducts\nON tsupplierproducts.pID = tresults.pID AND tsupplierproducts.supplierID = 2\nWHERE\n  tresults.pID = 7\n  AND tresults.websiteID = 1\nORDER BY\nnotavailable desc, tresults.Price DESC\n</code></pre>\n\n<p>The explain result:</p>\n\n<pre><code>1, PRIMARY, tsupplierproducts, const, PRIMARY,fk_SupplierID,fk_pID, PRIMARY, 8, const,const, 1, Using temporary; Using filesort\n1, PRIMARY, &lt;derived4&gt;, ALL, , , , , 27, \n1, PRIMARY, &lt;derived2&gt;, ALL, , , , , 43, Using where; Using join buffer\n1, PRIMARY, &lt;derived3&gt;, ALL, , , , , 43, Using where; Using join buffer\n1, PRIMARY, tshops, eq_ref, PRIMARY, PRIMARY, 4, Sub1.shopID, 1, Using where\n1, PRIMARY, tresults, eq_ref,     PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,fk_shopID, PRIMARY, 20, Sub1.MaxStartTime,const,Sub3.shopID,const, 1, \n4, DERIVED, tsupplierproducts, const, PRIMARY,fk_SupplierID,fk_pID, PRIMARY, 8, , 1, Using temporary; Using filesort\n4, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,     idxPID, 4, , 42048, Using     where\n3, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,     idxPID, 4, , 42048,     Using     where; Using temporary; Using filesort\n2, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC, idxPID, 4, , 42048, Using where; Using index; Using temporary; Using filesort\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3293,"score":0,"question_id":8510112,"title":"How would you display the manager name from employee table in an SQL query?","body":"<p>I have an employee table that displays the employee number, name, and manager's employee number. I'm trying to create a query that displays the emp name, emp#, manager name and mgr#. </p>\n\n<p>The table looks like this:</p>\n\n<pre><code>EMPNO ENAME  JOB       MGR  HIREDATE  SAL COMM DEPTNO \n7839  KING   PRESIDENT -    17-NOV-81 5000 -   10 \n7698  BLAKE  MANAGER   7839 01-MAY-81 2850 -   30 \n7782  CLARK  MANAGER   7839 09-JUN-81 2450 -   10 \n7566  JONES  MANAGER   7839 02-APR-81 2975 -   20 \n7654  MARTIN SALESMAN  7698 28-SEP-81 1250 1400 30 \n7499  ALLEN  SALESMAN  7698 20-FEB-81 1600 300 30 \n7844  TURNER SALESMAN  7698 08-SEP-81 1500 0   30 \n7900  JAMES  CLERK     7698 03-DEC-81 950  -   30 \n7521  WARD   SALESMAN  7698 22-FEB-81 1250 500 30 \n7902  FORD   ANALYST   7566 03-DEC-81 3000 -   20 \n</code></pre>\n\n<p>Three of the columns are pretty simple since they are in the table but how would I add the manager name when all I have is the employee number of their manager?</p>\n\n<p>This is what I have so far that only displays the 3 colums</p>\n\n<pre><code>select ename as \"Employee\", empno as \"Emp#\", mgr as \"Mgr#\"  from emp;\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"},{"tags":["android","query","sqlite"],"answer_count":5,"favorite_count":14,"up_vote_count":22,"down_vote_count":0,"view_count":17766,"score":22,"question_id":1296180,"title":"Android quotes within an sql query string","body":"<p>I want to perform a query like the following:</p>\n\n<pre><code>uvalue = EditText( some user value );\np_query = \"select * from mytable where name_field = '\" +  uvalue + \"'\" ;\nmDb.rawQuery( p_query, null );\n</code></pre>\n\n<p>if the user enters a single quote in their input it crashes.  If you change it to:</p>\n\n<pre><code>p_query = \"select * from mytable where name_field = \\\"\" +  uvalue + \"\\\"\" ;\n</code></pre>\n\n<p>it crashes if the user enters a double quote in their input.\nand of course they could always enter both single and double quotes.</p>\n"},{"tags":["php","sql","query","select","sql-order-by"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12969116,"title":"SQL Query SELECT,ORDER","body":"<p><strong>SQL Query SELECT,ORDER date</strong> </p>\n\n<p>Hi, I need to select the date from my table, the problem is that I have above 130 rows and it will grow every day. I want to short it and in the query to select the date that equal for today <code>date=date(\"Y-m-d\")</code> and the date that bigger from the date of today.</p>\n\n<p>It can be a variable the date of today because I'm using a date selection to paginated between the dates. I know I can use timestamp but I dont know how to implement it in the query.</p>\n\n<pre><code>  $r = mysql_query(\"SELECT  date FROM yoman  ORDER BY date ASC,time ASC  \") \n            or die(mysql_error()); \n</code></pre>\n\n<p>I hope you will unserstand, <a href=\"http://attiatech.com/projects/tours/index.php?db=cmVsXzIwMTI=\" rel=\"nofollow\">http://attiatech.com/projects/tours/index.php?db=cmVsXzIwMTI=</a> this is the link, try to pick the 1.10.2012 and see how many rows are printed, i have the second option of view paginated but i want in this query to filter it too.</p>\n"},{"tags":["mysql","sql","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12968538,"title":"MySQL: Combining two queries into one row result","body":"<p>First part of the query:</p>\n\n<pre><code>SET @centerLat = '48.531157';\nSET @centerLng = '-123.782959';\n\nSELECT user_id, lat, lng, ( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat ) ) ) ) AS distance FROM bid_userloc HAVING distance &lt; 25 ORDER BY distance LIMIT 0 , 20\n</code></pre>\n\n<p>Second aspect is taking the <code>user_id</code> and grabbing a bunch of information from the USERS table </p>\n\n<p>I'm still learning what JOIN even means and I don't quite understand how it all works best...</p>\n"},{"tags":["query","alfresco"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12909151,"title":"How to find content older than a specific number of days in Alfresco","body":"<p>I'm developing a number of scheduled tasks in Alfresco. One of these tasks should only run on nodes where a certain date property is older than a fixed number of days. I've looked into range queries: <code>date:[MIN TO NOW]</code>, but I don't want to use NOW, but a date that is <em>x</em> days in the past. </p>\n\n<p>Can this be specified in the query?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12967812,"title":"Rewrite query without UNION","body":"<p>I am reading values from 4 tables </p>\n\n<pre><code>select '1' as htl_EventId,  \n    'Reading Records' + cast(rank() OVER (ORDER BY ReadingRecord_Id) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,Reading_Date) as htl_StartDate ,dateadd(dd,01,Reading_Date) as htl_EndDate,'White' as htl_Colour,'ForestGreen' as htl_TextColour,'This is your Reading  no ' + cast(rank() OVER (ORDER BY ReadingRecord_Id) as varchar) as htl_EventDescription,\n     'http://google.co.in' as htl_UrlValue\n     from Reading_Records where User_Id=@UserID and Reading_Date between \n     convert(date, @StartDate, 103) and convert(date, @EndDate, 103) \n     --order by Start_Date ASC\n    --('#' + cast((select ABS(CHECKSUM(NEWID())) % 900000000 + 100000000) as nvarchar)) as htl_Colour,\n    union \n\n    select '2' as htl_EventId,  \n    'Incident Details' + cast(rank() OVER (ORDER BY Incident_Id ) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,From_Date) as htl_StartDate ,dateadd(dd,01,coalesce(To_Date,from_Date)) as htl_EndDate,'maroon' as htl_Colour,'Black' as htl_TextColour, 'This is your Incident  no ' + cast(rank() OVER (ORDER BY Incident_Id ) as varchar) as htl_EventDescription,\n     'http://gmail.co.in' as htl_UrlValue\n     from User_Incidents where User_Id=@UserID and From_Date &gt;= \n     convert(date, @StartDate, 103) and To_Date &lt;= convert(date, @EndDate, 103) and status='True'\n     --order by From_Date ASC\n\n     union \n\n     select '3' as htl_EventId,  \n    'HealthConditions' + cast(rank() OVER (ORDER BY Condition_Id ) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,Start_MonthYear) as htl_StartDate ,dateadd(dd,01,Start_MonthYear) as htl_EndDate,'maroon' as  htl_Colour,'Red' as  htl_TextColour,'This is your HealthCondition  no ' + cast(rank() OVER (ORDER BY Condition_Id ) as varchar) as htl_EventDescription,\n     'http://facebook.com' as htl_UrlValue\n     from User_Health_Condition where User_Id=@UserID and Start_MonthYear between \n     convert(date, @StartDate, 103) and convert(date, @EndDate, 103) and status='True'\n     order by 1 ASC \n</code></pre>\n\n<p>Please give any suggestion ? Thank you in advance . I need to add one more query for the above </p>\n\n<pre><code>select '1' as htl_EventId, \n dateadd(dd,01,Reading_Date) as htl_StartDate ,dateadd(dd,01,Reading_Date) as htl_EndDate,DR.Reading_Name as htl_ReadingName\n from Reading_Records RR LEFT OUTER JOIN DBO.[Defined_Readings] DR  ON RR.Reading_Id=DR.Reading_Id  where User_Id=@UserID\n</code></pre>\n"},{"tags":["mysql","sql","query","group-by","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12967982,"title":"Group By/Order By Two Columns - Get Data Without Losing Rows - MySQL","body":"<p>I have a table <code>number_color_style</code> with the structure as shown below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/xevDJ.png\" alt=\"Table Strcture\"></p>\n\n<p>This table contains data as shown below(8 rows)</p>\n\n<p><img src=\"http://i.stack.imgur.com/LPvKx.png\" alt=\"Table Data\"></p>\n\n<p>What I want as I output is All records grouped by <code>number_color_id</code> , <code>number_style_id</code></p>\n\n<p>I tried below query</p>\n\n<pre><code>SELECT *\nFROM `number_color_style`\nGROUP BY `number_color_id` , `number_style_id`\n</code></pre>\n\n<p>It gives me output but some rows are missing</p>\n\n<p><img src=\"http://i.stack.imgur.com/XJboK.png\" alt=\"Result\"></p>\n\n<p>What I want is <strong>four set of data</strong> without missing a single row(should contain all 8 rows).\nEG:</p>\n\n<ul>\n<li>1st set where <code>number_color_id = 1</code> , <code>number_style_id = 1</code></li>\n<li>2nd set where <code>number_color_id = 1</code> , <code>number_style_id = 2</code></li>\n<li>3rd set where <code>number_color_id = 2</code> , <code>number_style_id = 1</code></li>\n<li>4th set where <code>number_color_id = 2</code> , <code>number_style_id = 2</code></li>\n</ul>\n\n<p>How can I do it ? </p>\n\n<p>Create table query</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `number_color_style` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `img` varchar(100) NOT NULL,\n  `number_color_id` int(11) NOT NULL,\n  `number_style_id` int(11) NOT NULL,\n  `number_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`)\n);\n</code></pre>\n\n<p>Some sample data</p>\n\n<pre><code>INSERT INTO `jink`.`number_color_style` (`id`, `img`, `number_color_id`, `number_style_id`, `number_id`) VALUES (NULL, 'img1.png', '1', '1', '10'), (NULL, 'img2.png', '1', '1', '10'), (NULL, 'img3.png', '1', '2', '10'), (NULL, 'img4.png', '2', '1', '10'), (NULL, 'img5.png', '2', '1', '10');\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12965008,"title":"LOAD DATA LOCAL INFILE custom value","body":"<p>How to add a custom value using LOAD DATA LOCAL INFILE?\nThe column time_added is the 7th column and the file has only 2 values for the first and the second column. For the 7th column, time_added I want to use the unix timestamp when loading from file.</p>\n\n<p>This code isn't working:</p>\n\n<pre><code>$result = mysql_query(\"LOAD DATA LOCAL INFILE '{$myFile}' INTO TABLE {$table} FIELDS TERMINATED BY ':' LINES TERMINATED BY '\\n' SET `time_added`=unix_timestamp()\");\n</code></pre>\n"},{"tags":["php","mysql","query","data","while-loop"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12967399,"title":"while ($row=mysql_fetch_array($result)) is not working","body":"<p>I'm using the below code to get some data.</p>\n\n<pre><code>    $result = mysql_query($sql);\n    while($row = mysql_fetch_array($result)) {\n        $data[] = array(\n            $row['Qty'], \n            $row['Description'] \n        );      \n    }\n</code></pre>\n\n<p>This is giving an empty array.</p>\n\n<p>When I'm trying the $sql manually its getting the correct results.</p>\n\n<p>Is anything wrong with the code above..??</p>\n\n<pre><code>SELECT CO.order_id AS TaxNo, \nDATE_FORMAT(CO.created,'%d-%m-%Y') AS InvoiceDate, \nC.company_name AS Consumer, CONCAT(C.delivery_address1, ', ', \nC.delivery_address2) AS DelAdd, \nCOD.qty AS Qty, \nP.product_name AS Description, \nPP.amount AS Price, \n(COD.qty * PP.amount) AS Total, \nSUM(COD.qty * PP.amount) AS InvoiceTotal, \nCPH.discount_on_payment AS Discount, \nCPH.amount_paid AS AmountPaid, \n(SUM(COD.qty * PP.amount) - CPH.discount_on_payment - CPH.amount_paid) AS Balance,  \nCOUNT(COD.qty) AS TotLine \nFROM consumer_orders AS CO \nINNER JOIN consumer AS C ON CO.consumer_id = C.consumer_id \nINNER JOIN consumer_order_details AS COD ON CO.order_id = COD.order_id \nINNER JOIN product AS P ON COD.Product_id = P.product_id \nLEFT JOIN product_price AS PP ON P.product_id = PP.product_id \nLEFT JOIN tbl_customer_payment_history AS CPH \nON CO.order_id = CPH.order_id WHERE CO.order_id = '60' \nGROUP BY CO.order_id, CO.created, C.company_name, CONCAT(C.delivery_address1, ', ', C.delivery_address2), COD.qty, P.product_name, PP.amount \n</code></pre>\n"},{"tags":["oracle","query","plsql","oracle-apex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12956887,"title":"using between with apex item in Oracle apex_util.json_from_sql","body":"<p>Does anybody know how to use apex item in apex_util.json_from_sql in application process when we try to find a value between two number? My query just like this one below :</p>\n\n<pre><code>SELECT  \nID , locn_x lat, locn_y lon\nFROM database where locn_x between :P1_SEBOUNDLAT and :P1_NWBOUNDLAT\n</code></pre>\n\n<p>But it's return no result. Apex item :P1_SEBOUNDLAT and :P1_NWBOUNDLAT has a value cos i diplay it and i try to do query in database and give me result. it seem : without = become a problem in this query. Because when i try to query </p>\n\n<pre><code>where locn_x &gt; :P1_SEBOUNDLAT \n</code></pre>\n\n<p>it give me an error</p>\n\n<p>Please somebody give me an advice. </p>\n"},{"tags":["query","wordpress","post","parent","category"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":7864,"score":1,"question_id":1228130,"title":"How do I get the parent category name in wordpress template? And can I query post by the parent category?","body":"<p>I tried getting help on the wordpress forums but no luck. Anyways, heres my question...</p>\n\n<p>Lets say i am creating 10 parent categories and 2 sub categories to each parent. My wordpress post belongs to one sub category of a particular parent category</p>\n\n<p>How do i get the parent category name ONLY? i don't want subcategories names? what wordpress code would do that?</p>\n\n<p>And one more question...</p>\n\n<p>Is it possible to query post by the parent of a sub category by using</p>\n\n<p></p>\n\n<p>but instead of entering \"cat=1\" or the name of the particular category, can I do something like</p>\n\n<p></p>\n\n<p>so this way it would automatically insert and query post for the parent of any particular sub category that's clicked on?</p>\n"},{"tags":["sql","query","ms-access","expression","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12966356,"title":"Comparing data between reporting periods MS Access","body":"<p>I have a big table that contains records for each reporting period in my project.\nThe period is indentified by an integer 1, 2, 3, 4, 5, 6, 7.</p>\n\n<p>Each period contains about 7000 rows of tasks each identified a unique ID. These tasks all have a percent complete column which is an integer.</p>\n\n<p>I want to add a comparison column.\nso it would look up the unique id in the previous period then return the difference in percent complete.</p>\n\n<p>eg\nfor\nPeriod: 8 Item Unique ID: 42w3wer324wer32 Percent complete: 50</p>\n\n<p>it would find:\nPeriod: 7 Item Unique ID: 42w3wer324wer32 Percent complete: 40</p>\n\n<p>the fill in the field with: 10.</p>\n\n<p>If it could not find the Item Unique ID in the previous period then it would default to 0.</p>\n\n<p>thanks</p>\n"},{"tags":["query","sharepoint","caml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3533,"score":0,"question_id":5662386,"title":"SharePoint Cascading Dropdown with CAML query that filters one of the choices","body":"<p>I have made a cascading dropdown form using <a href=\"http://spservices.codeplex.com\" rel=\"nofollow\">http://spservices.codeplex.com</a> but want to add a filter to the third cascading dropdown. So SPServices have a function called CAMLQuery where I can add this filter but I want the filter to be specified with the value from the top dropdown on the form.</p>\n\n<p>One example that is given on the page is:</p>\n\n<pre><code>            CAMLQuery: \"&lt;Eq&gt;&lt;FieldRef Name='Status'/&gt;&lt;Value Type='Text'&gt;Active&lt;/Value&gt;&lt;/Eq&gt;\"\n</code></pre>\n\n<p>I want this Status column to get its value from the choice selected on of the fields on the form. Is this possible and how would I write that?</p>\n\n<hr>\n\n<p>Edit: I am trying to make an asset list with cascading choices to find the right asset after picking unit and department. \nCode example after trying the below answer and not getting anything coming up in the \"Asset\" chooser. There are two lists, one containing Units and Departments and one containing the assets with a Department and Unit key to filter with.\nIf I replace the \"dynamic\" queries with a static one such as:</p>\n\n<pre><code>CAMLQuery: \"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;Unit 1&lt;/Value&gt;&lt;/Eq&gt;\"\n</code></pre>\n\n<p>the assets appear filtered for that unit. Current code:</p>\n\n<pre><code>&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery-1.5.2.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery.SPServices-0.6.0.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nvar sCamlQuery = \"\";\n\n$(document).ready(function() {\n    $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Departments\",\n        relationshipListParentColumn: \"Unit\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Unit\",\n        childColumn: \"Department\",\n        completefunc: function() {\n        sCamlQuery = \"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;\" + $(\"select[title='Unit']\").attr(\"spcascadedropdown_selected_\") + \"&lt;/Value&gt;&lt;/Eq&gt;\";\n        }\n    });\n        $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Asset Database\",\n        relationshipListParentColumn: \"Department\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Department\",\n        childColumn: \"Asset\",\n        CAMLQuery: sCamlQuery\n    });\n\n});\n</code></pre>\n\n<p>The HTML:</p>\n\n<pre><code>&lt;tr&gt;\n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Unit&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff3_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff3_1_ctl00_Lookup\" title=\"Unit\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Unit 1&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Unit 2&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;¨\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr&gt;\n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Department&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff4_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff4_1_ctl00_Lookup\" title=\"Department\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"5\"&gt;Administration&lt;/option&gt;\n            &lt;option value=\"4\"&gt;IT&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Kitchen&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Production&lt;/option&gt;\n            &lt;option value=\"7\"&gt;Production&lt;/option&gt;\n            &lt;option value=\"6\"&gt;Sales&lt;/option&gt;\n            &lt;option value=\"3\"&gt;Warehouse&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr&gt;    \n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Asset&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff5_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff5_1_ctl00_Lookup\" title=\"Asset\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"3\"&gt;Computer&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Copy machine&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Dishwasher&lt;/option&gt;\n            &lt;option value=\"5\"&gt;Dishwasher&lt;/option&gt;\n            &lt;option value=\"4\"&gt;Oven&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Verifying function:</p>\n\n<pre><code>&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery-1.5.2.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery.SPServices-0.6.0.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nvar sCamlQuery = \"\";\n\n$(document).ready(function() {\n\n    $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Departments\",\n        relationshipListParentColumn: \"Unit\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Unit\",\n        childColumn: \"Department\",\n        completefunc: function() {\n        sCamlQuery = window.alert(\"completefunc\");//\"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;\"+ $(\"select[title='Unit'] option:selected\").text() +\"&lt;/Value&gt;&lt;/Eq&gt;\";\n                                }\n    });\n\n        $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Asset Database\",\n        relationshipListParentColumn: \"Department\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Department\",\n        childColumn: \"Asset\",\n        CAMLQuery: sCamlQuery\n    });\n\n});\n&lt;/script&gt;\n</code></pre>\n\n<p><strong>Departments list:</strong></p>\n\n<p><em>Title</em>  <em>Unit</em></p>\n\n<p>IT       Unit1</p>\n\n<p>Sales    Unit1</p>\n\n<p>IT       Unit2</p>\n\n<p>Sales    Unit2</p>\n\n<p><strong>Asset Database:</strong></p>\n\n<p><em>Title</em>  <em>Department</em> *Unit* </p>\n\n<p>Asset1    IT    Unit1</p>\n\n<p>Asset2    IT     Unit2</p>\n\n<p>David</p>\n"},{"tags":["mysql","query","transpose"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12962000,"title":"join tables and transpose columns and rows","body":"<p>I have one table that looks like this called survey_1:</p>\n\n<pre><code>================================================\n|id  | token  |     1X2X1     |    1X2X2       |\n=====+========+===============+================|\n| 1  |   1    |    YES        | Justin Beiber  |\n|----+--------+---------------+----------------|\n| 2  |   1    |    YES        | Britney Spears |\n|----+--------+---------------+----------------|\n</code></pre>\n\n<p><strong>note</strong>: 1X2X1 represents- survey-id X group-id X question-id</p>\n\n<p>I have another table called survey_questions:</p>\n\n<pre><code>===============================================================\n|sid |   gid  |   qid  |             question                 |\n=====+========+===============+===============================|\n| 1  |  2     |    1   |  Do you listen to music?             |\n|----+--------+-----------------------------------------------|\n| 1  |  2     |    2   |  Who is your favorite music artists? |\n|----+--------+-----------------------------------------------|\n</code></pre>\n\n<p>The sid (survey-id), gid (group-id) and qid(question-id) define that specific question in this table   </p>\n\n<p>I need a query that will give me a result like this:</p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>NOTE</strong>: My database contains thousands of these columns, so it would be very time consuming to edit every survey to match up perfectly in this format.</p>\n\n<p>Can anyone help out with this? Thank you </p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12264669,"title":"Sql query- needs to extract records based on Datefield","body":"<p>I need to extract data from Table1 and insert it into Table2 on Last monday of every month. Basic version of my Tables are something like this..</p>\n\n<p>Table1 (ID,Name,EffectiveDate)</p>\n\n<p>Table2 (ID,Name,EffectiveDate,ProcessDate)</p>\n\n<p>I want to extract only those records where Effectivedate has been 4 months from current date (For Example: if EffectiveDate is 1st January then it should be extracted after 1st April...). Actually Table2 is being used for Reporting purpose so we have 'processDate' field that we can use while Filtering.</p>\n\n<p>Any help would be appreciated..thanks</p>\n\n<p>EDIT:</p>\n\n<p>well, i know we can do something like this </p>\n\n<p>EffectiveDate &lt; DATEADD(MM,-4,GetDate())</p>\n"},{"tags":["sql-server","query","coldfusion"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12961444,"title":"MS-SQL sort output in descending order","body":"<p>I have this MS-SQL query with thousands of row records in database:<br /></p>\n\n<pre><code>SELECT DISTINCT TOP 7 DATENAME(MM, mydatetime) + ' ' + CAST(DAY(mydatetime) AS VARCHAR(2)) as thedate\n    , MONTH(mydatetime)\n    , DAY(mydatetime)\n    , COUNT(Page) as totalcount\n    , count(DISTINCT Page) as visitors\n  FROM someTable\n  WHERE Page LIKE '%AEC%'\n  GROUP BY DATENAME(MM, mydatetime) + ' ' + CAST(DAY(mydatetime) AS VARCHAR(2))\n    , MONTH(mydatetime)\n    , DAY(mydatetime)\n  ORDER BY MONTH(mydatetime) DESC\n    , DAY(mydatetime) DESC\n</code></pre>\n\n<p>It will output this:<br/></p>\n\n<pre><code>thedate     | totalcount | visitors\n-----------------------------------\nOctober 17  |     4      |    1\nOctober 15  |     1      |    1\nOctober 12  |     1      |    1\nOctober 3   |     3      |    3\nOctober 2   |     42     |    22\nSeptember 28|     2      |    1\nSeptember 21|     14     |    10\n</code></pre>\n\n<p>My problem is that I simply cant output this in descending order so it will look like this:</p>\n\n<pre><code>thedate     | totalcount | visitors\n-----------------------------------\nSeptember 21|     14     |    10\nSeptember 28|     2      |    1\nOctober 2   |     42     |    22\nOctober 3   |     3      |    3\nOctober 12  |     1      |    1\nOctober 15  |     1      |    1\nOctober 17  |     4      |    1\n</code></pre>\n\n<p>So any help is greatly appreciated. </p>\n"},{"tags":["django","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":37,"score":-3,"question_id":12961545,"title":"Queries in Django, sql","body":"<p>I would be very grateful if you send me one sql-query.\nSo, columns are: <strong>even</strong> (contains strings '*' or '1' or '2') and <strong>weeks</strong> (contains strings '*' or '1 2 3 4 5 ' etc).\nI have 2 variables: </p>\n\n<ol>\n<li>even_week = int, 1 or 2</li>\n<li>today_week = int, num of the week</li>\n</ol>\n\n<p>I need all fields from that table, where </p>\n\n<pre><code>(even='*' OR even = even_week) AND (weeks='*' or today_week in weeks)\n</code></pre>\n\n<p>I am newbie in Django, please, help. Thanks</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12961437,"title":"mysql getting max value of a column group by many","body":"<p>I have a mysql table:</p>\n\n<pre><code>id       int\na        varchar\nb        varchar\nc        varchar\nversion  int\nactive   bool\n</code></pre>\n\n<p>I want to grab the max version group by a, b and c , so I have following query to do that:</p>\n\n<pre><code>select a, b, c, max(version) as version from mytbl where active = 1 group by (a, b, c)\n</code></pre>\n\n<p>but this returns </p>\n\n<pre><code>Operand should contain 1 column(s)\n</code></pre>\n\n<p>What is wrong here?</p>\n"},{"tags":["php","mysql","query","admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12960284,"title":"Searching Database column for certain numbers","body":"<p>I need a query to search a database for a specific number within a group of numbers listed in the same column on a database.</p>\n\n<p>The database <code>Access</code> will contain two columns</p>\n\n<p>First column: Page Name</p>\n\n<p>Second Column: Access</p>\n\n<p>And will be set up similar to:   Page Name: Blog-Admin   Access: 60,61,62,76,83,94</p>\n\n<p>where the numbers in the column Access are the ranks that are allowed to view the page.</p>\n\n<p>On each page, there will be a query that finds the users rank and stores it in a $URank variable.</p>\n\n<p>Each page is named in a variable ($PageName) which will match the column Page Name in the <code>Access</code> Database</p>\n\n<p>In this query, it needs to search the column Access for the users rank for that page (page name = $PageName)</p>\n\n<p>By storing this in a database, it will allow admins to modify who has access to what pages at any point in time.</p>\n\n<p>I just need the query that will search the database to make sure that user rank has permission to access that page.</p>\n\n<p>This may be very simple, not sure.</p>\n\n<p>I'm use to queries such as  mysql_query(\"select * from database where blahblah=viarable\")...so if it could be answered in this format, that would be fantastic.  Even if its the mysqli equivilant.</p>\n"},{"tags":["regex","query","postgresql","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12960397,"title":"Query for only integers Rails 2.3","body":"<p>My environment is <code>Ruby 1.8.7-p358 with Rails 2.3.11</code>.  I am trying to query for all <code>accounts</code> that have a <code>first_name</code> containing only numbers (they are all 3 digit integers, i.e. 001, 143, 815, etc.).  I have been trying to use this query:</p>\n\n<pre><code>Account.find(:all, :conditions =&gt; [\"first_name LIKE ?\", \"[^0-9][^0-9][^0-9]\"])\n</code></pre>\n\n<p>All I get in return is <code>=&gt; []</code>.</p>\n\n<p>If I use the same query only with <code>NOT LIKE</code> I get all <code>accounts</code>, including the ones where <code>first_name</code> is an integer.</p>\n\n<p>I've also tried using:</p>\n\n<pre><code>Account.find(:all, :conditions =&gt; [\"first_name REGEXP ?\", \"[^0-9][^0-9][^0-9]\"])\n</code></pre>\n\n<p>but that only gives me:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PGError: ERROR:  syntax error at or near \"REGEXP\"\nLINE 1: SELECT * FROM \"accounts\" WHERE (first_name REGEXP '[0-9][0-9...\n                                               ^\n\n: SELECT * FROM \"accounts\" WHERE (first_name REGEXP '[0-9][0-9][0-9]')  ORDER BY first_name ASC\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract_adapter.rb:227:in `log'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:520:in `execute'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:1002:in `select_raw'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:989:in `select'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `select_all_without_query_cache'\n      from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract/query_cache.rb:62:in `select_all'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:665:in `find_by_sql'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:1582:in `find_every'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:619:in `find'\n  from (irb):189\n  from :0\n</code></pre>\n\n<p>Are regular expressions not allowed?  How am I able to find each <code>account</code> with a <code>first_name</code> that's equal to a three digit integer?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12959849,"title":"Select products with users","body":"<p>I have not worked with SQL for quite a long time, and I need some help for a basic query. I have the three following tables:</p>\n\n<ul>\n<li><code>users (id, name)</code></li>\n<li><code>products (id, name)</code></li>\n<li><code>owners (userid, productid, date)</code></li>\n</ul>\n\n<p>One product can be sold by user A to user B and then back to A.</p>\n\n<p>Now, I want the list of all products currently owned by every single user with the date of transaction. </p>\n\n<p>Currently, my query is this one, but I'm stuck with old data (first association of one product to one user, and not the newest one):</p>\n\n<pre><code>SELECT users.name, products.name, date\nFROM products\n     JOIN owners ON products.id = owners.id\n     JOIN users ON owners.id = user.id\nGROUP BY product.id\n</code></pre>\n\n<p>Do you have some hints?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12959160,"title":"How to select next 4 consecutive rows from my resultant row?","body":"<p>I want to know, how can i select next 4 consecutive rows along with the resultant row in mysql?</p>\n\n<p>To explain:-</p>\n\n<p>i have following rows in table abc</p>\n\n<pre><code>name | amount \n\n a   -  1000\n\n b   -  2000\n\n c   -  3000\n\n d   -  4000\n\n e   -  5000\n\n f   -  6000\n</code></pre>\n\n<p>Now, \nif my selection criteria is name = a , then resultant rows returned should be</p>\n\n<pre><code> a   -  1000\n\n b   -  2000\n\n c   -  3000\n\n d   -  4000\n\n e   -  5000\n</code></pre>\n\n<p>In other words i want a query which will return result of query - \"select * from abc where name = 'a'\" plus next 4 consecutive rows to that row?</p>\n"},{"tags":["sql-server","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12959281,"title":"SQL Server partitioning monthly data by weeks and calculating weekly weighted average based on month days of that week belong to","body":"<p>I have a table like this:</p>\n\n<pre><code>Month          Value\n2012-08-01      0.345\n2012-09-01      0.543\n2012-10-01      0.321\n2012-11-01      0.234\n2012-12-01      0.234\n</code></pre>\n\n<p>User inputs week range from '2012-09-29' to '2012-10-13'\nOutput should show results for all weeks in requested range and average values for each week with the following logic:\n - if all weekdays are entirely in one month, just use monthly value for that month\n - if weekdays are spread out over two months, calculate weekly value as average between those two months giving preference to the month that contains the most days of that week.</p>\n\n<p>If someone can give me an idea how to do something like this in T-SQL that would be highly appreciated.</p>\n"},{"tags":["php","mysql","query","optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":12958828,"title":"adding and multiplying COUNT() of several tables","body":"<p>Is it possible to add and multiply the count of different tables where the id is the same?\nImagine:</p>\n\n<pre><code>Table_1       Table_2    Table_3\nid            id         id\n1             1          1\n1             2          2\n2             2          3\n3             2          3\n3             2          3\n3             3          3\n</code></pre>\n\n<p>So that the end result would be this table with 2 columns:</p>\n\n<pre><code>id        (COUNT(Table_1.id) + 2*COUNT(Table_2.id) + 3*COUNT(Table_3.id))\n1                                   7\n2                                   12\n3                                   17\n</code></pre>\n"},{"tags":["php","mysql","query","optimization","unlink"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12958777,"title":"There has got to be a more efficient way to do this","body":"<p>Basically I am trying to trim the images table down to 3,500 rows of unsaved or unfiltered images. Unsaved and unfiltered refer to other tables in the DB. A user can save an image as well as mark an image safe for work etc... I would like to keep all images in the saves table as well as the filter table. </p>\n\n<p>Ultimately, The images table will get trimmed down to (3,500 unsaved/unfiltered images) + (\"X\" saved)+(\"X\" unfiltered). The link between saves/filters/images is the auto_incremented id given to the record in the <code>images</code> table. So saves has an image_id field that gets the key of the record in the <code>images</code> table. same with the filters table </p>\n\n<pre><code>//connect to database\n$connect = xxxxxxxxxxx;\n\n\n//GET ALL IMAGES FROM `images` Table - NEWEST FIRST (`id` is auto_increment)\n$sql = mysql_query(\"SELECT * FROM `images` ORDER BY `id` DESC\") or die(mysql_error());\n$x = 0;\nwhile($row = mysql_fetch_array($sql)){\n    //GET CURRENT IMAGES ID AND URL\n    $id = $row['id'];\n    $file = $row['url'];\n\n    //SEE IF IMAGE IS IN THE saves Table\n    $saves = mysql_query(\"SELECT `id` FROM `saves` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($saves) == 0){$saved = FALSE;}\n    else {$saved = TRUE;}\n\n    //SEE IF IMAGE IS IN THE filters Table\n    $filter = mysql_query(\"SELECT `id` FROM `filter` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($filter) == 0){$filtered = FALSE;}\n    else {$filtered = TRUE;}\n\n    //If the image has not been saved or filtered then put it in a que for deletion\n    if(!$saved || !$filtered){\n        $IdQue[$x] = $id;\n        $FileQue[$x] = $file;\n        $x++;\n    }//END if   \n}//END while\n\n//Process the delete que: Delete node from database, delete file on server. Keep 3,500 of the newest images.\nfor($i=3500; $i&lt;$x; $i++){\n    mysql_query(\"DELETE FROM `images` WHERE id='\".$IdQue[$i].\"' LIMIT 1\") or die(\"line 33\".mysql_error());\n\n    if(file_exists($FileQue[$i])){\n        unlink($FileQue[$i]) or die(\"file Not deleted\");\n    }//END if\n}//END for\necho ($i-3500).\" files deleted&lt;br/&gt;\";\n\n//terminate connection\nmysql_close($connect);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12957635,"title":"Sql query to insert datetime in SQL Server","body":"<p>I want to insert a <code>datetime</code> value into a table(SQL Server) using the sql query below</p>\n\n<pre><code>insert into table1(approvaldate)values(18-06-12 10:34:09 AM);\n</code></pre>\n\n<p>But I get this Error msg. <code>Incorrect syntax near '10'.</code></p>\n\n<p>I tried it with the quotes</p>\n\n<pre><code>insert into table1(approvaldate)values('18-06-12 10:34:09 AM');\n</code></pre>\n\n<p>I get this error message <code>Cannot convert varchar to datetime</code></p>\n\n<p>Kindly help! \nThanks.</p>\n"},{"tags":["mysql","database","query","many-to-many"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":11064275,"title":"Fetching data from many-to-many relationships","body":"<p>I want to fetch the title from book table and the subject name from subject table for all the books of a certain author</p>\n\n<p>Here is the tables relationships</p>\n\n<p><img src=\"http://i.stack.imgur.com/7suGS.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/vnrPp.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried to select the title and the subject from the tables but I can't get it to work with the many to many relationship</p>\n\n<pre><code>SELECT book_title,subject_name FROM book,subject WHERE $subject_ID = subject_ID INNER JOIN book_author ON author_ID = '$author_ID'\n</code></pre>\n\n<p>I thought about making two separate queries, if someone could help me on that I would be really glad.</p>\n"},{"tags":["query","node.js","mongodb","date","mongoose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12855280,"title":"Querying by date, regardless time part","body":"<p>I want to show my blog posts, paginated by creation date. I will have a page for 5 posts written in 2012-10-01, a page for 11 posts written in 2012-10-03 and no page at all for 2012-10-02 (no posts written)</p>\n\n<p>Each post document is stored with a creation date which is a datetime value, here's a mongoose snippet:</p>\n\n<pre><code>var postSchema = new Schema({\n    url: String,\n    creationDate: {type: Date, default: Date.now},\n    contenuto: String,\n});\n</code></pre>\n\n<p>so it will have something like 2012-10-01 18:45:03... know what I mean.</p>\n\n<p>In my code, I will create a </p>\n\n<pre><code>var searchDate = new Date(yy,mm,dd);\n</code></pre>\n\n<p><strong>How can I use that for querying the posts collection, without considering the \"time part\" of creationDate?</strong></p>\n\n<p>I'm not sure this would always work:</p>\n\n<pre><code>Post.find({ creationDate:dataRicerca })\n</code></pre>\n"},{"tags":["sql-server","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12938332,"title":"Multiple COUNT SELECTS from the same table in one query","body":"<p>For some people it might look very simple, but I just simply can't get it.<br />\nI have multiple MS-SQL SELECT queries from the same table over and over:<br /></p>\n\n<pre><code>SELECT count(Page) as tAEC\nFROM someTable\nWHERE Page LIKE '%AEC%'\n</code></pre>\n\n<p>next one</p>\n\n<pre><code>SELECT count(Page) as tTOL\nFROM someTable\nWHERE Page LIKE '%TOL%'\n</code></pre>\n\n<p>and so on...<br /></p>\n\n<p>What would be more efficient way to write this query. I Googled bunch of similar questions but I couldnt make any of them to work. So any help is greatly appreciated.</p>\n"},{"tags":["php","mysql","sql","query","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12957327,"title":"Can't get query to work","body":"<p>I have a database containing 3 tables (member, boat, boatType) and in the method below two of them is affected. What I want is to list all boats that's registered on a member, but there's a problem with the code (at least with the SQL, but I suspect that's not all).</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>boatHandler.php:</strong></p>\n\n<pre><code>public function GetMembersBoats($memberId) {\n\n    $query = \"SELECT b.boatId, b.length, bt.type\n                  FROM boat AS b\n                      INNER JOIN member AS m\n                          ON b.memberId = m.memberId\n                              WHERE m.memberId = ?\n                      INNER JOIN boatType AS bt\n                          ON b.boatTypeId = bt.boatTypeId\n                      GROUP BY b.boatId\";\n\n    $stmt = $this-&gt;m_db-&gt;Prepare($query);\n    $stmt-&gt;bind_param('i', $memberId);\n\n    $boats = $this-&gt;m_db-&gt;GetBoats($stmt);\n}\n</code></pre>\n\n<p><strong>database.php:</strong></p>\n\n<pre><code>public function GetBoats($stmt) {\n    $boats = array(\n            0 =&gt; array(),\n            1 =&gt; array(),\n            2 =&gt; array()\n        );\n\n    $stmt-&gt;execute();\n\n    $stmt-&gt;bind_result($boatId, $length, $type);\n\n    while ($stmt-&gt;fetch()) {\n        array_push($boats[0], $boatId);\n        array_push($boats[1], $length);\n        array_push($boats[2], $type);\n    }\n\n    $stmt-&gt;Close();\n\n    return $boats;\n}\n</code></pre>\n\n<h3>Affected tables:</h3>\n\n<ul>\n<li><strong>boat:</strong> boatId, boatTypeId, length, memberId</li>\n<li><strong>boatType:</strong> boatTypeId, type</li>\n</ul>\n"},{"tags":["mysql","sql","query","metadata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12945702,"title":"SQL: Complicated Select Statement and returned radius","body":"<p>This query is driving me insane and I honestly just don't know how to accomplish it.</p>\n\n<p>I need to grab all USERS and SHOPS longitude and latitude that are within a certain radius, and return back some other information attached to those resulting IDs... the radius part, I have figured out:</p>\n\n<p><code>( 3959 * acos( cos( radians('48.453541') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-123.491765') ) + sin( radians('48.453541') ) * sin( radians( lat ) ) ) ) AS distance</code></p>\n\n<p>^This radians in the statement above are just a random address that I want to query against.</p>\n\n<p>But grabbing results that essentially are two different rows AS ONE result confuses me right out. Both tables are constructed in this manner:</p>\n\n<pre><code>id\nmeta_key\nmeta_value\n</code></pre>\n\n<p>So I need to grab the \"meta_value\" of two keys for both a USER and a SHOP ... the \"meta_key\"  for the USER is \"bid_user_lat\" and \"bid_user_lng\" ... and the \"meta_key\" for the SHOP are \"bid_resource_lat\" and \"bid_resource_lng\"</p>\n\n<p>Ideal results (just showing one of each, but should be multiple, depending on radius):</p>\n\n<pre><code>id - 223\nfirst_name - \"Mark\"\nlast_name - \"Johnson\"\nbid_user_lat - 45.0000\nbid_user_lng - -150.0000\n\nid - 688\ncompany_name - \"Joe's Shop\"\nbid_resource_lat - 45.0000\nbid_resource_lng - -150.0000\n</code></pre>\n\n<p>I really hope I'm explaining this correctly, because this is just driving me nuts!</p>\n\n<hr>\n\n<p>My updated query is as follow, yet it's still not producing any results and it should:</p>\n\n<pre><code>SET @lat =  '48.453541';\nSET @lng =  '-123.491765';\nSET @radius =  '10000';\n\nSELECT\n    wp_usermeta.user_id,\n    bid_user_lat.meta_value,\n    bid_user_lng.meta_value,\n\n( 3959 * acos( cos( radians( @lat ) ) * cos( radians( bid_user_lat.meta_value ) ) * cos( radians( bid_user_lng.meta_value ) - radians( @lng ) ) + sin( radians( @lat ) ) * sin( radians( bid_user_lat.meta_value ) ) ) )  AS distance \n\nFROM\n    wp_usermeta\nJOIN \n    wp_usermeta bid_user_lat\n    ON wp_usermeta.user_id = bid_user_lat.user_id\n    AND wp_usermeta.meta_key = \"bid_user_lat\"\nJOIN\n    wp_usermeta bid_user_lng\n    ON wp_usermeta.user_id = bid_user_lng.user_id\n    AND wp_usermeta.meta_key = \"bid_user_lng\"\n\nHAVING distance &lt; @radius ORDER BY distance LIMIT 0 , 20;\n</code></pre>\n"},{"tags":["android","query","url","google","illegal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1417,"score":1,"question_id":6868373,"title":"URL error, Exception:Illegal character in query at index 185","body":"<p>What's wrong with my URL :</p>\n\n<p><a href=\"http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28\" rel=\"nofollow\">http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28</a> Jul 2011 10:00:02 GMT&amp;did=10169</p>\n\n<p>i got in my log cat </p>\n\n<p>07-29 10:11:16.995: VERBOSE/Exception doing background(334): Exception:Illegal character in query at index 185: \n<a href=\"http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28\" rel=\"nofollow\">http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28</a> Jul 2011 10:00:02 GMT&amp;did=10169</p>\n"},{"tags":["oracle","query","date-arithmetic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":60,"score":-4,"question_id":12954947,"title":"How to add 2 dates in Oracle sp?","body":"<p>How can we add two dates in oracle? For example in sql we can do this, \" date_1 + date_2 \" how can we achieve the same thing in Oracle</p>\n"},{"tags":["php","mysql","query","cakephp","cakephp-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12938422,"title":"CakePHP Query & JSON output - Improve current solution","body":"<p>I'm coding a tagging system in CakePHP (latest release) but the solution I have made seems over complicated compared to how easy the rest of CakePHP is. Hopefully someone can point me in the right direction or help me improve my current solution.</p>\n\n<p>I need to pass to my view data in this format (JSON):</p>\n\n<pre><code>[{label:'actionscript', count: 14}, {label:'php', count: 2} ... ]\n</code></pre>\n\n<p>Now I know the following SQL query gives me the needed data:</p>\n\n<pre><code>SELECT tags.name, count(*)\nFROM tags\nRIGHT JOIN tags_users\nON tags.id=tags_users.tag_id\nGROUP BY name\";\n</code></pre>\n\n<p>So using CakePHP find method I made:</p>\n\n<pre><code>$options = array();\n$options['contain'] = '';   \n$options['recursive'] =  -1;            \n$options['joins'][0]['table'] = 'tags_users';\n$options['joins'][0]['type'] = 'RIGHT';\n$options['joins'][0]['conditions'] = 'Tag.id = tags_users.tag_id';\n$options['fields'] =  array('name', 'COUNT(*) as tag_counter');\n$options['group']  =  'Tag.name';\n$options['order']  =  'tag_counter DESC';       \n$availableTagsArray = $this-&gt;User-&gt;TagsUser-&gt;Tag-&gt;find('all', $options);\n</code></pre>\n\n<p>This give me an array out as:</p>\n\n<pre><code>Array\n(\n[0] =&gt; Array\n    (\n        [Tag] =&gt; Array\n            (\n                [name] =&gt; actionscript\n            )\n\n        [0] =&gt; Array\n            (\n                [tag_counter] =&gt; 14\n            )\n\n    )\n\n[1] =&gt; Array\n    (\n        [Tag] =&gt; Array\n            (\n                [name] =&gt; php\n            )\n\n        [0] =&gt; Array\n            (\n                [tag_counter] =&gt; 2\n            )\n\n    )\n)\n</code></pre>\n\n<p>I then convert this array to JSON by:</p>\n\n<pre><code>$availableTags = \"[\";\n\nforeach ($availableTagsArray as $tag) {\n        $availableTags .= \"{label:'{$tag['Tag']['name']}', count:{$tag[0]['tag_counter']}},\";   \n    }\n\n$availableTags = substr($availableTags, 0, -1);\n$availableTags .= \"]\";  \n$this-&gt;set(\"availableTags\", $availableTags);\n</code></pre>\n\n<p><strong>[UPDATE]</strong></p>\n\n<p>After doing a lot of research and using both answers. I've found there multiple ways to do this and that includes my original solution. You could also use virtual fields then the afterFind method and flattening the results there. </p>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":12954730,"title":"count and group on multiple columns","body":"<p>I am totally new to SQL. I have created following tables..</p>\n\n<pre><code>Employee\n- employee_id\n- employee_name\n\nProjects\n- project_id\n- project_name\n\nRoles\n- role_id\n- role_name\n\nEmployee_project_role\n- employee_id\n- project_id\n- role_id\n</code></pre>\n\n<p>I have to write a query for: list employees with count of different roles and also list role.\ni.e. if an employee(emp1) works as Team Leader(TL) in one project and as Tester(TEST) in other two different projects then the output should be :</p>\n\n<pre><code>employee_name   count   Role\n---------------------------\n  emp1           1      TL\n  emp1           2      TEST\n</code></pre>\n"},{"tags":["sql","database","query","plsql","oracle10g"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12953580,"title":"SQL Query works different than expected","body":"<p>I have problems with understanding sql statement.\nWhen I execute the it(see below), I'm getting only people with sgtn_typ 'L'.   </p>\n\n<pre><code> SELECT DISTINCT kun_id kid\n                ,dep_id\n                ,ddg_rang_g RANG\n                ,dep_perf_g\n                ,TO_CHAR(dep_buchwert + dep_kasse, '999G999G990D99') WERT\n                ,kun_name1\n                ,Kun_vorname\n                ,kun_cust_id\n                ,kun_strasse\n                ,kun_plz\n                ,kun_ort\n                ,kun_e_mail\n                ,kun_pseudonym\n                ,kka_value\n   FROM ddg, dep, kun, kat, kka, sgtn\n  WHERE dep_spi_id = 245\n        AND dep_abr_id = 24\n        AND ddg_dgr_id = 3\n        AND ddg_abr_id = dep_abr_id\n        AND ddg_spi_id = dep_spi_id\n        AND ddg_dep_id = dep_id\n        AND dep_kun_id = kun_id\n        AND kun_aktiv = 'J'\n        AND dep_spi_id = kun_spi_id\n        AND dep_id IS NOT NULL\n        AND dep_id NOT IN (SELECT ddg_dep_id\n                             FROM ddg\n                            WHERE ddg_spi_id = 245\n                                  AND ddg_abr_id = 0\n                                  AND ddg_dgr_id = 1)\n        AND kun_id = kka_kun_id\n        AND kka_spi_id = 245\n        AND kat_spi_id = 245\n        AND kka_kat_kuerzel = kat_kuerzel\n        AND kat_kuerzel = 'NSCH'\n        AND kka_spi_id = sgtn_spi_id\n        AND kka_kun_id = sgtn_kun_id\n        AND sgtn_spi_id = 245\n        AND sgtn_e_mail = kun_e_mail\n        AND (sgtn_typ = 'L' \n           OR (sgtn_typ = 'T'\n              AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                      FROM sgtn\n                                      WHERE sgtn_spi_id = 245\n                                      AND sgtn_typ = 'L'))\n          )\n  ORDER BY kun_id, sgtn_typ;\n</code></pre>\n\n<p>But when I execute this, I'm getting people with sgtn_typ 'T': </p>\n\n<pre><code> SELECT *\n   FROM sgtn\n  WHERE sgtn_spi_id = 245\n        AND (sgtn_typ = 'L' \n             OR (sgtn_typ = 'T'\n                 AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                         FROM sgtn\n                                         WHERE sgtn_spi_id = 245\n                                         AND sgtn_typ = 'L'))\n )\n  ORDER BY sgtn_kun_id;\n</code></pre>\n\n<p>I don't understand why? Could someone give me any clue? I was expecting, that I substitute all people with type 'L' and will get people with type 'T': </p>\n\n<pre><code> AND (sgtn_typ = 'L'\n         OR (sgtn_typ = 'T' \n              AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                     FROM sgtn\n                                     WHERE sgtn_spi_id = 245\n                                      AND sgtn_typ = 'L'))\n       )\n</code></pre>\n\n<p>There are 'duplicates' in sgtn table(some people are entered with 'T' and 'L'). And apart from that the whole record is the same. </p>\n\n<p>Table scheme are like the folowing:</p>\n\n<p>SGTN: </p>\n\n<pre><code>SGTN_ID             NUMBER(22)\nSGTN_SPI_ID             NUMBER(22)\nSGTN_KUN_ID             NUMBER(22)\nSGTN_TYP                VARCHAR2(4)\nSGTN_GESCHLECHT     VARCHAR2(4)\nSGTN_VORNAME        VARCHAR2(160)\nSGTN_NAME1              VARCHAR2(240)\nSGTN_STRASSE        VARCHAR2(240)\nSGTN_PLZ                VARCHAR2(60)\nSGTN_ORT                VARCHAR2(240)\nSGTN_E_MAIL             VARCHAR2(240)\nSGTN_GEB_DAT            DATE(7)\nSGTN_KLASSE             VARCHAR2(200)\nSGTN_SCHULE             VARCHAR2(200)\nSGTN_TELEFON        VARCHAR2(120)\nSGTN_KONTONUMMER        VARCHAR2(120)\n</code></pre>\n\n<p>KUN: </p>\n\n<pre><code>KUN_ID          NUMBER(22)\nKUN_SPI_ID          NUMBER(22)\nKUN_LAN_ID          NUMBER(22)\nKUN_MED_KBEZ    VARCHAR2(40)\nKUN_NAME1           VARCHAR2(240)\nKUN_MKZ         VARCHAR2(80)\nKUN_TS          DATE(7)\nKUN_AKTIV           VARCHAR2(12)\nKUN_KTOINH          VARCHAR2(240)\nKUN_BLZ         VARCHAR2(40)\nKUN_BANK            VARCHAR2(240)\nKUN_KTONR           VARCHAR2(80)\nKUN_ZAHLART         VARCHAR2(4)\nKUN_NAME2           VARCHAR2(240)\nKUN_VORNAME         VARCHAR2(160)\nKUN_STRASSE         VARCHAR2(240)\nKUN_PLZ         VARCHAR2(60)\nKUN_ORT         VARCHAR2(240)\nKUN_TEL1            VARCHAR2(120)\nKUN_TEL2            VARCHAR2(120)\nKUN_FAX         VARCHAR2(120)\nKUN_E_MAIL          VARCHAR2(240)\nKUN_PSEUDONYM   VARCHAR2(120)\nKUN_PWD         VARCHAR2(60)\nKUN_CUST_ID         VARCHAR2(240)\nKUN_GESCHLECHT  VARCHAR2(4)\nKUN_K_NAME          VARCHAR2(80)\nKUN_K_NR            NUMBER(22)\nKUN_K_VALID         VARCHAR2(40)\nKUN_ZUSATZ_1    VARCHAR2(400)\nKUN_ZUSATZ_DATUM    DATE(7)\nKUN_COMMENT         VARCHAR2(4000)\nKUN_EVT_SMS         VARCHAR2(80)\nKUN_EVT_E_MAIL  VARCHAR2(240)\nKUN_COMMENT2    VARCHAR2(4000)\nKUN_AKTIV_BIS   DATE(7)\nKUN_FLG_AGB         VARCHAR2(4)\nKUN_TITEL           VARCHAR2(200)\n</code></pre>\n\n<p>Thank you in advance for clues.</p>\n\n<p>Greetings</p>\n\n<p>R. Bada</p>\n"},{"tags":["mysql","performance","query","order"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12952903,"title":"MySQL ORDER BY - Slowing Down Query","body":"<p>Question pertains to a listing site that holds listing data and lead data in two tables.  When doing a query for listings and total number of leads for each listing, the results are extremely slow after adding an ORDER BY. Without the ORDER BY, the results are retrieved very fast.  Any advice or help with restructuring the query below would be awesome!! Fyi, there are 20k listings and 100k leads.</p>\n\n<pre><code>SELECT ls.*, IFNULL(ld.total_leads, 0) AS total_leads\nFROM listing ls \nLEFT JOIN (SELECT listing_id, COUNT(listing_id) AS total_leads \n            FROM lead GROUP BY listing_id) ld\nON (ls.listing_id = ld.listing_id)\nORDER BY ls.listing_id DESC LIMIT 0,20\n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12951690,"title":"Create INSERT statement using parameter","body":"<p>I need to create a INSERT statement using parameters. Say I have two variable name <code>@DestinationFields</code>, <code>@InsertValues</code>.</p>\n\n<p>Here <code>@DestinationFields</code> contain the column name like: <code>product,price</code> and <code>@InsertValues</code> contains the values for those two columns, like: <code>Book,100</code>. </p>\n\n<p>Now, How i create a insert command to insert those values where each value need to add a quotation mark .I already tried as </p>\n\n<p>I already tried as </p>\n\n<pre><code>EXEC('INSERT into tbl_test('+@DestinationFields+')values('+@InsertValues+')')\n</code></pre>\n\n<p>But it's returning an error.</p>\n\n<blockquote>\n  <p><em>The name \"book\" is not permitted in this context. Valid expressions are constants, constant expressions, and (in some\n  contexts) variables. Column names are not permitted.</em></p>\n</blockquote>\n\n<p>How do I do it? Thanks in advance.</p>\n"},{"tags":["query","syntax","solr","lucene"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12937432,"title":"How do I query a range and a missing in one lucene query?","body":"<p>The query:</p>\n\n<pre><code>start: [ 2012101700 TO * ] OR end: [* TO 2012101700]\n</code></pre>\n\n<p>will give me the result where the start is after today or the end is before today.</p>\n\n<p>This query will give me all the records with missing start or ends:</p>\n\n<pre><code> -(end: [ * TO *] OR start: [* TO *])\n</code></pre>\n\n<p>(<em>The strange bracketing is due to oddities in the query parser, see: <a href=\"http://stackoverflow.com/q/12935540/442351\">Solr query with grouping not working</a></em>)</p>\n\n<p>However, I want to combine these so that my results are all the records with results in the defined range or missing completely.  This query doesn't work though as the [* TO *] spoils it.</p>\n\n<pre><code>(end: [ * TO 2012101700] OR start: [2012101700 TO *])\n OR -(end: [ * TO *] \n OR start: [* TO *])\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n\n<p>Dave</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12931709,"title":"How to store data pairs in a mysql database?","body":"<p>I have to store a big amount of data pairs. Data pairs are in the form:</p>\n\n<blockquote>\n  <p>parameter = value</p>\n</blockquote>\n\n<p>and are related to a container. It's similar to a INI file. For example, I have a container that have these values:</p>\n\n<pre><code>p1 = 32\np2 = \"hello world\"\np3 = -54\n</code></pre>\n\n<p>and another one that have:</p>\n\n<pre><code>p1 = 32\np2 = 36\np5 = 42\np6 = \"bye\"\n</code></pre>\n\n<p>There is an undefined number of parameters per container. The values are numbers or strings of any length (numbers can be converted to strings). Data retrieval is made by parameter name (<em>\"all p1 values\"</em>) or value (<em>\"a 'p6' parameter with the value 'bye'\"</em>). The database will contain milions of pairs. Inserts and reads will be made very often and will be rare to delete or update a record.</p>\n\n<p>My first attempt has been make two tables. First one like this:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `container` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  OTHER CONTAINER INFO\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;\n</code></pre>\n\n<p>where <code>id</code> will be used in another table that contains the pairs:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `data` (\n  `container` int(11) NOT NULL,\n  `name` varchar(64) COLLATE utf8_unicode_ci NOT NULL,\n  `value` text COLLATE utf8_unicode_ci NOT NULL,\n  KEY `container` (`container`),\n  KEY `name` (`name`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n</code></pre>\n\n<p>Adding the data:</p>\n\n<pre><code>INSERT INTO `container` (`id`) VALUES ('1'), ('2');\nINSERT INTO  `data` (`container`, `name`, `value`) VALUES \n     ('1',  'p1',  '32'), \n     ('1',  'p2',  'hello world'), \n     ('1',  'p3',  '-54'), \n     ('2',  'p1',  '32'), \n     ('2',  'p2',  '36'), \n     ('2',  'p5',  '42'), \n     ('2',  'p6',  'bye');\n</code></pre>\n\n<p>It works, but it's not very \"usable\" and fast. For instance, if I need to find all parameters from each container that has a <code>p1=32</code> I have to make two SQL queries, first:</p>\n\n<pre><code>SELECT id FROM  `container` WHERE id IN (\n   SELECT container\n   FROM DATA WHERE name =  'p1'\n  AND value =  '32')\n</code></pre>\n\n<p>and then for each container <code>id</code> get all data:</p>\n\n<pre><code>SELECT * FROM  `data` WHERE container = '$id'\n</code></pre>\n\n<p>and then make a post-processing via PHP because it returns a table like this:</p>\n\n<pre><code>container   name    value\n    1       p1      32\n    1       p2      hello world\n    1       p3      -54\n</code></pre>\n\n<p>(post-processing is just a couple of calls to array_* functions, but it makes slower the processing).</p>\n\n<p>I've been testing with a database that contains 50000 data pairs and listing all the records using this procedure takes more than 5 seconds. The question is: how to store this kind of data? or how to improve the performance of my implementation?</p>\n\n<p><strong>NOTE</strong>: The problem is not the first SQL query (0'003 seconds) or the second one (0'002 seconds each one). The problem is to make a SQL query for each result of the first SQL sentence!!</p>\n\n<p><strong>NOTE 2</strong>: The goal is to have a PHP array that contains each result and for each result an  associative array with pairs key-value. The result for a <code>print_r</code>:</p>\n\n<pre><code>Array\n(\n    [1] =&gt; Array\n        (\n            [p1] =&gt; 32\n            [p2] =&gt; hello world\n            [p3] =&gt; -54\n        )\n    [2] =&gt; Array\n        (\n            [p1] =&gt; 32\n            [p2] =&gt; 36\n            [p5] =&gt; 42\n            [p6] =&gt; bye\n        )\n)\n</code></pre>\n\n<p>And, of course, the data structure I have shown here is my first attempt, I'm researching, that's not a production, so I can change, no problem at all.</p>\n"},{"tags":["database","query","sql-server-2005"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12914499,"title":"ROW_NUMBER() without over in SQL","body":"<p>Is there any way to use <code>ROW_NUMBER()</code> in SQL without using <code>OVER</code>, because I want to use sorting. </p>\n\n<p>I have a Grid with multiple sortable columns with configurable rows. In my scenario order by is variable that's why I am not able to put order by using ROWNUM.</p>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":12950300,"title":"How to use for loop in mongodb","body":"<p>I need to insert a new field(column) to mongodb collection which has now 5246 documents. The field should be auto incremented . So that i use an for loop . My query is as follows `</p>\n\n<pre><code>for(i=1;i&lt;=5246;i++) {\n    db.coll.update({},{$set:{\"new_field\":i}},false,true)\n}; \n</code></pre>\n\n<p>But my bad the output is as, </p>\n\n<pre><code>{new_field:5246},{new_field:5246},{new_field:5246},.......\n</code></pre>\n\n<p>Is there any problem with query..?.</p>\n"},{"tags":["vb.net","query","odata"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":5792232,"title":"List of Titles for John Wayne","body":"<p>I know that there is another question similar to this, but none of the answers worked for me.  this is what I have been trying:</p>\n\n<pre><code>        cat = (From t In catalog.Titles.Expand(\"Cast\")\n               Where t.Name.Contains(\"John Wayne\")\n               Select t)\n\n        for each c in cat\n           listbox.items.add(c.titles)\n        next\n</code></pre>\n\n<p>I've tried all the different combinations, and always get some sort of error.\nAll I want to return is all the titles that John Wayne has been in.</p>\n"},{"tags":["sql-server-2008","query","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12919949,"title":"How to group by SqlFunction with VarArgsSQLFunction in NHibernate","body":"<p>I'm trying to implement the following SQL query with QueryOver:</p>\n\n<pre><code>SELECT [Time]/1000\nFROM TableName\nGROUP BY [Time]/1000\n</code></pre>\n\n<p>Here's my current attempt:</p>\n\n<pre><code>var result = session\n    .QueryOver&lt;TableName&gt;\n    .Select(Projections.GroupProperty(\n        Projections.SqlFunction(\n            new VarArgsSQLFunction(\"(\", \"/\", \")\"),\n            NHibernateUtil.Int64,\n            Projections.Property(\"Time\")\n            Projections.Constant(1000))\n    ))\n    .List&lt;object&gt;();\n</code></pre>\n\n<p>Unfortunately I get the following exception (GenericADOException):</p>\n\n<pre><code>could execute query\n[ SELECT (this_.Time/@p0) as y0_ FROM [TableName] this_ GROUP BY (this_.Time/?) ]\n</code></pre>\n\n<p>And the inner exception:</p>\n\n<pre><code>Incorrect syntax near ?.\n</code></pre>\n\n<p>I can replace the \"GroupProperty\" with a \"Sum\" and it works. Any idea what's missing?</p>\n\n<hr>\n\n<p><strong>Update</strong>:\nApparently it's a bug in NHibernate. See also <a href=\"http://stackoverflow.com/questions/10696539/incorrect-syntax-near-nhibernate-generated-query\">this question</a>.</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":12847704,"title":"sql concat query does not working correctly","body":"<p>SQL concat query does not working correctly</p>\n\n<pre><code>UPDATE product\nSET    pimg_mid1=concat('.jpg', pimg_mid1) \nWHERE  pid&gt;=21\n</code></pre>\n\n<p>The table column is named by <code>img_mid1</code> and currently it contains <code>xxxxx</code> type values after 21 rows (21 rows are correct). But required is <code>xxxxx.JPG</code>.</p>\n\n<p>All the row except the top 21 are incorrect. These rows should named <code>xxxxx.JPG</code> (postfix .JPG)</p>\n\n<p>What would be the right sql query?</p>\n"},{"tags":["javascript","query","sql-update","google-fusion-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":11866366,"title":"Google Fusion Table Javascript UPDATE Query?","body":"<p>I have looked everywhere for a way to update a Google Fusion table using an UPDATE query from a javascript. All I need to do is update one column with an array that is generated from the code itself, after the fusion table information is read and processed. I do not need the user to update the table. </p>\n\n<p>Is there a way to do this using Javascript alone? Or do I really need a combination of OAuth 2.0 and php? Is there a working example of this? All I find is extremely vague or fragmentary. </p>\n\n<p>Thank you.</p>\n"},{"tags":["php","database","arrays","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":47,"score":-3,"question_id":12946231,"title":"PHP selecting from database","body":"<p>I'm having trouble selecting data from inside one of the tables in the database.</p>\n\n<p>I'm trying to display a user's profile when their name is clicked on.</p>\n\n<pre><code>&lt;?php\n    $view = mysql_fetch_array(mysql_query(\"select * from users where id=$view\"));\n    if (empty ($view[id])) {\n    print \"No such user.\";\n    exit;\n    }\n    print \"&lt;center&gt;&lt;b&gt;&lt;u&gt;$view[user]&lt;/b&gt;&lt;/u&gt; ($view[id])&lt;/center&gt;&lt;br&gt;\";\n    print \"Rank: $view[rank]&lt;br&gt;\";\n?&gt;\n</code></pre>\n\n<p>The link they will click is:</p>\n\n<pre><code>viewpage.php?page_id=4&amp;view=....\n</code></pre>\n\n<p>I can't get this to work.</p>\n"},{"tags":["sql-server","query","reporting-services"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12918936,"title":"Improve performance that uses isnull in a where clause","body":"<p>There is a report whose query is using isnull in the where clause and it's causing some performance issues. \nHere is a very simplified example. \n<a href=\"http://www.sqlfiddle.com/#!6/79759/11\" rel=\"nofollow\">http://www.sqlfiddle.com/#!6/79759/11</a></p>\n\n<p>The query is using a multi-valued parameter, usually just returning one or two values. (I've tried to replicate the SSRS multi-value param using a table variable in sqlfiddle)</p>\n\n<pre><code>select \n  isnull(descrL,descr) as division,\n  product\nfrom Upper\nleft join Lower on product = productL\nwhere isnull(DescrL,Descr) in (@params)\n</code></pre>\n\n<p>There is an Upper division that has all the products. Some of the products exist on a child  division. If it exists in the lower division, that is the division that should be shown.</p>\n\n<p>The company parameter can accept the upper division, lower division, or both.</p>\n\n<p>Any ideas on how the query can be changed for better performance?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12851094,"title":"How can I write this MySQL query?","body":"<p>We have a system where users send in bags of goods to us.</p>\n\n<p>I am trying figure out how to pull users with a calculated field for the date they sent their 3rd bag of goods.  The state on the history table that would indicate this event is \"processed\".  If I wanted to just get the received date for a particular bag I would write:</p>\n\n<pre><code>SELECT bags.created_at FROM history \nWHERE history.state='received' AND history.bag_id LIMIT 1\n</code></pre>\n\n<p>Here are our tables:</p>\n\n<pre><code>users\n  id\n\nbags\n  user_id\n\nhistory\n  state\n  bag_id\n  created_at\n</code></pre>\n\n<p>The end goal is a select query that gives us user records and adds the \"field\" 3rd_bag_received_at</p>\n\n<p>Any ideas?</p>\n"},{"tags":["query","google-api","spreadsheet","google-spreadsheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12942754,"title":"google spreadsheet: query in a script","body":"<p>Hy,\nmy question is:\nI'm working with spreadsheet of google.\nI'd like to insert query into a script.\nIs it possible?</p>\n\n<p>I need create a spreadsheet in which runs a query to create an effect \"post card\" (name of a people and salary in different years).</p>\n\n<p>I rescue to do it in a cell for only a man:</p>\n\n<pre><code> query(sheet1!1:100; \"select I, J,K, G, sum(H), F, L where B contains \"\"\"&amp;A6&amp;\"\"\" group by B,I, J, K, G, F, L \")  \n</code></pre>\n\n<p>\"\"\"&amp;A6&amp;\"\"\" is a cell in which i put a name.</p>\n\n<p>I need to do it for all my collegues (30) in a script.</p>\n\n<p>thanks</p>\n"},{"tags":["query","google-apps-script"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12943181,"title":"Query variable arrays","body":"<p>How do I use an array variable as a query argument instead of the literal array itself?</p>\n\n<p>For example, the documentation mentions the following:</p>\n\n<pre><code>var result = db.query({name: db.anyOf(['fred', 'barney', 'mark']});\n</code></pre>\n\n<p>But instead, I wish to do this:</p>\n\n<pre><code>var myTeam = [\"fred\",\"barney\",\"mark\"];\nvar result = db.query({name: db.anyOf(myTeam)});\n</code></pre>\n\n<p>So far, I have not been successful.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12921894,"title":"sql server 2008 query inline","body":"<p><code>select devicename, name, value, timestamp from table1</code> gives me the following,</p>\n\n<pre><code>DEVICENAME     NAME     VALUE    TIMESTAMP\n123            CURRENT  130      2012-10-16 13:00:00.000\n123            AVG      140      2012-10-16 13:00:00.000\n123            MIN      100      2012-10-16 13:00:00.000\n123            MAX      160      2012-10-16 13:00:00.000\n</code></pre>\n\n<p>How do i get them like this in sql query,</p>\n\n<pre><code>123, 130, 140, 100, 160 2012-10-16 13:00:00.000\n</code></pre>\n"},{"tags":["sql","database","oracle","query","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":166,"score":1,"question_id":12921792,"title":"Oracle database search all tables for string, return row data","body":"<p>I need to search all tables in an oracle database for a specific string and return all the records where that string is found. I am working with SQL Developer. There are several really useful scripts and stored procedures that have been posted online that provide a way to search the entire database and they all seem to be able to return the table name and the column name where the string is found. I actually want to see the rows like a select * statement but I would like it to be for all the tables in my database. I want to note that I am very much a beginner and I'm not familiar with advanced PL/SQL scripting and database concepts so though I've tried and tried I can't seem to figure it out so any input would be appreciated.</p>\n\n<p>Here is a script that I was trying to modify (someone else's solution)</p>\n\n<pre><code>declare\n l_count number := 0;\n l_str varchar2(20) := '%test%';\nbegin\n for rec in (select table_name, column_name\n             from user_tab_columns\n             where data_type in ( 'VARCHAR2' , 'VARCHAR', 'CHAR' ) ) loop\n  execute immediate 'select count(*) from '||rec.table_name||\n                ' where '||rec.column_name||' like '''||l_str||'''' into l_count;\n  if l_count &gt; 0 then\n   dbms_output.put_line('Table : '||rec.table_name||'  '||rec.column_name);\n  end if;\n end loop;\nend;\n/\n</code></pre>\n"},{"tags":["php","mysql","sql","query","rows"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":12937213,"title":"mysql_fetch_row() not a valid result resource","body":"<p>I am confused, I don't know what's wrong. I'm about to transfer all data from my first table to the other. Here is my code:</p>\n\n<pre><code>$getdata = mysql_query(\"SELECT Quantity, Description, Total FROM ordercart\");\n\nwhile($row = mysql_fetch_row($getdata))\n{\nforeach($row as $cell){\n\n$query1 = mysql_query(\"INSERT INTO ordermem (Quantity, Description, Total) VALUES \n($cell)\",$connect);\n\n}\nmysql_free_result($getdata);\n}\n</code></pre>\n\n<p>I get the error: Warning: mysql_fetch_row(): 5 is not a valid MySQL result resource.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12905778,"title":"Converting numbers to text from mysql in PHP","body":"<p>In my MYSQL database I have many headers to columns that are in this format- <code>2345X32X12.......</code> <code>2345=survey id, 32=page id, 12= question id.</code>..</p>\n\n<p>Under each header contains the question of that specific ID set. With PHP I am trying to grab the text of each question of each ID set to place in a csv file. </p>\n\n<p>Right now when I open my csv file from my web server, I get that format as the headers <code>(2345X32X12)</code> in the columns of an excel file; </p>\n\n<p>I want to get the question under each column to look like this - What is your age?.........I hope this makes sense</p>\n\n<p>In another table in my database the numbered headers define the question-in A1: 2345X32X12 B1: What is your age?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>&lt;?php\n// connection with the database \n//$sid =$_SESSION['sid'];\n//echo $sid;\n$id=$_GET['sid']; \necho $id;\n\n$dbhost= \"\"; //your MySQL Server \n$dbuser = \"\"; //your MySQL User Name \n$dbpass = \"\"; //your MySQL Password \n$dbname = \"y\";    \n$link = mysql_connect($host, $user, $pass);\nmysql_select_db($dbname); \n$tablename = \"survey_\".$id; // this is the tablename that you want to export to csv from mysql. \n$sql = \"Select * from $tablename\"; \n//create  code for connecting to mysql \n$Connect = @mysql_connect($dbhost, $dbuser, $dbpass) \nor die(\"Couldn't connect to MySQL:&lt;br&gt;\" . mysql_error() . \"&lt;br&gt;\" . mysql_errno()); \n//select database \n$Db = @mysql_select_db($dbname, $Connect) \nor die(\"Couldn't select database:&lt;br&gt;\" . mysql_error(). \"&lt;br&gt;\" . mysql_errno()); \n//execute query \n$result = @mysql_query($sql,$Connect) \nor die(\"Couldn't execute query:&lt;br&gt;\" . mysql_error(). \"&lt;br&gt;\" . mysql_errno()); \n\n\nexportMysqlToCsv($tablename);\nfunction exportMysqlToCsv($tablename,$filename = 'Results.csv'){\n    $sql_query = \"select * from $tablename where id=2\";\n    // Gets the data from the database\n\n    $result = mysql_query($sql_query);\n\n    $f = fopen('php://temp', 'wt');\n    $first = true;\n\n    while ($row = mysql_fetch_assoc($result)) {\n\n        if ($first) {\n\n            fputcsv($f, array_keys($row));\n\n            $first = false;\n }\n  fputcsv($f, $row);\n\n    } // end while\n\n    $size = ftell($f);\n    rewind($f);\n    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n    header(\"Content-Length: $size\");\n\n // Output to browser with appropriate mime type, you choose ;)\n    header(\"Content-type: text/x-csv\");\n    header(\"Content-type: text/csv\");\n    header(\"Content-type: application/csv\");\n    header(\"Content-Disposition: attachment; filename=$filename\");\n\n    fpassthru($f);\n\n    exit;\n}\n\n?&gt; \n</code></pre>\n"},{"tags":["query","data","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":11849425,"title":"Read all data from all databases in my server","body":"<p>I'm working with sql server 2000, and I need to read all data  from all databases\n  in my server, because then I will work with some data, how can I make ths query? \n  I´ll tryied this code, but doesn´t works as I want.</p>\n\n<pre><code>ALTER  PROCEDURE TMP_INGRESO_MASIVO_DAT_CLIENTES AS\n\ndeclare @Fila as int\ndeclare @Script_Dinamico as varchar(8000)\ndeclare @Script_Dinamico1 as varchar(8000)\ndeclare @Nro_Registros as int\n\nSelect Distinct  cod_empresa,Nombre_Base Into #Tmp_Bases1 From Estadistica_Cobranza.Dbo.Sis_Conexion_pagos Where Cod_Estado = 1 and Proc_Automaticos= 1--capturo nombre BD\nSelect Distinct  Identity(Int,1,1) As Fila, cod_empresa , Nombre_Base As Name  Into #Tmp_Bases From #Tmp_Bases1\n\n    Drop table #Tmp_Bases1\n    Select @Fila = 1\n    Select @Script_Dinamico = ''\n    Select @Script_Dinamico1 = ''\n    Select @Nro_Registros  =  (Select Count (*) From  #Tmp_Bases ) + 1--cantidad de filas  +1\n\n\n\n\n\n    While @Fila &lt; = @Nro_Registros \nBegin\n    Print(@Script_Dinamico)\n\nSelect @Script_Dinamico = 'INSERT INTO buc.dbo.tmp_DAT_CLIENTES '\nSelect @Script_Dinamico = @Script_Dinamico +'(COD_EMPRESA,'\nSelect @Script_Dinamico = @Script_Dinamico +'COD_SUCURSALEMPRESA,'\nSelect @Script_Dinamico = @Script_Dinamico +'RUT_CLIENTE,'\nSelect @Script_Dinamico = @Script_Dinamico +'RAZON_SOCIAL, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_CARGA,'\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_MODIFICACION'\nSelect @Script_Dinamico = @Script_Dinamico +')'\nSelect @Script_Dinamico = @Script_Dinamico +'Select '\nSelect @Script_Dinamico = @Script_Dinamico +'COD_EMPRESA, '\nSelect @Script_Dinamico = @Script_Dinamico +'COD_SUCURSALEMPRESA, '\nSelect @Script_Dinamico = @Script_Dinamico +'RUT_CLIENTE, '\nSelect @Script_Dinamico = @Script_Dinamico +'RAZON_SOCIAL, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_CARGA, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_MODIFICACION'\nSelect @Script_Dinamico = @Script_Dinamico + ' from ' + (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES '\nSelect @Script_Dinamico = @Script_Dinamico  + 'Where ' + (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.cod_empresa =  '+ convert(varchar,(Select cod_empresa  From #tmp_bases  Where Fila = @Fila))\nSelect @Script_Dinamico = @Script_Dinamico  +'and '+ (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.rut_cliente not in (select RUT_CLIENTE from tmp_dat_clientes'\nSelect @Script_Dinamico = @Script_Dinamico+' where '+ (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.rut_cliente = buc.dbo.tmp_DAT_CLIENTES.RUT_CLIENTE )'\n\n\n\n\n\n\n\n\n            Print ( @Script_Dinamico)\n            Exec (@Script_Dinamico )\n            Select  @Fila = @Fila +1\n            Select @Script_Dinamico = ''\n            Select @Script_Dinamico1 = ''\n\n\n\nEnd\nDrop Table #Tmp_Bases\n\nGO\nSET QUOTED_IDENTIFIER OFF \nGO\nSET ANSI_NULLS ON \nGO\n</code></pre>\n\n<p>thanks in advance.</p>\n"},{"tags":["java","query","parent-child","rally"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12697477,"title":"How to check the folders relationship toeach other in Rally using Java API","body":"<p>I am trying to use the <code>\"Parent\"</code> attribute of a folder inside the <code>\"QueryFilter\"</code> as shown:</p>\n\n<pre><code>myFolder.setQueryFilter(new QueryFilter(\"TestFolder.Name\", \"=\", foldername)\n    .and(new QueryFilter(\"Parent\", \"=\", ??????)));\n</code></pre>\n\n<p>I am trying to check whether this folder is a subfolder of another folder. </p>\n\n<p>I dont know what to put instead of <code>??????</code>.</p>\n\n<p>UPDATE: \nI am using following code but its throwing a nullpointer exception. I am trying to query for a parent folder, so I am putting Parent as null. I dont know if I should get nullpointer exception. If yes, how should I handle it?</p>\n\n<p>QueryRequest parent1 = new QueryRequest(\"TestFolder\");</p>\n\n<p>parent1.setFetch(new Fetch(\"Name\",\"Project\"));</p>\n\n<p>parent1.setQueryFilter(new QueryFilter(\"name\", \"=\", foldername).and(new \nQueryFilter(\"Parent\", \"=\", null)).and(new QueryFilter(\"Project\", \"=\", proj_ref)));</p>\n\n<p>QueryResponse parent2 = batman.query(parent1);</p>\n\n<p>parent_ref = parent2.getResults().get(0).getAsJsonObject().get(\"_ref\").getAsString();</p>\n\n<p>System.out.println(\"Parent ref: \"+parent_ref);</p>\n\n<p>System.out.println(\"Parent folder already exists.\");</p>\n\n<p>Thanks.</p>\n"},{"tags":["query","list","contains","sparql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12920215,"title":"How do I match records which have a certain entry IN their rdfs:label attribute?","body":"<p>I'm trying to query dbpedia for programming languages like D by name:</p>\n\n<p><a href=\"http://dbpedia.org/page/D_%28programming_language%29\" rel=\"nofollow\">http://dbpedia.org/page/D_(programming_language)</a></p>\n\n<p>And I figure <code>rdfs:label</code> is a good way to do this. But I'm having trouble coming up with syntax for searching by labels containing \"D (programming language)\". In dpbedia, <code>rdfs:labels</code> aren't simply strings, they're more like lists. How do I filter for records that have a certain entry IN the <code>rdfs:label</code>?</p>\n"},{"tags":["query","ms-access","date","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12929085,"title":"Access 2007 query to capture records that encompass 2 dates","body":"<p>I'm working on a query to get records based on two dates, start and end dates.</p>\n\n<p>What I need to obtain are records that are span some or all of the given period, in other words the start date maybe before the parameter date but less than the end date or start after the start date and end after the end date.</p>\n\n<p>I.e. Start date = 01 Oct 12 and end date 31 Oct 12. I would like to capture records where start date is before 1 Oct but spans this period whether it finishes in November or mid October. As well as records that are between 01 Oct 12 and 31 Oct 12.</p>\n\n<p>In reality I need the records that exclude this period, but first need to make sure I'm getting this dataset correct.</p>\n"},{"tags":["sql","sql-server","database","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12937829,"title":"Database engineering: Many Rows or extra backup columns for a scenario like Extendable Profile Table","body":"<p>I have a decision to make for a database with up to 20,000+ student profiles, Each student profile have more than 120+ Property, </p>\n\n<p>In many Enterprise projects like DOTNETNUKE CMS, the used method is two tables, one is\nUserProfile :</p>\n\n<pre><code>[ProfileID],[UserID],[PropertyDefinitionID],[PropertyValue]\n</code></pre>\n\n<p>and the other is : ProfilePropertyDefinition</p>\n\n<pre><code>[PropertyDefinitionID],[DataType] ,[PropertyCategory],[PropertyName]\n</code></pre>\n\n<p>If i used this method i will have 20,000 x 120 = 2.4 million row!</p>\n\n<p>I know this is the correct way, to have a normalized database, and I know, the Database servers were created to handle millions of records, but i am wondering, why don't we create one profile table with 120 column + enough backup columns for the extensibility? If the performance is important, Does it more harm than good? </p>\n"},{"tags":["oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":12922889,"title":"Substring inside string","body":"<p>Suppose this is my table:</p>\n\n<pre><code>ID  STRING\n1   'ABC'\n2   'DAE'\n3   'BYYYYYY'\n4   'H'\n</code></pre>\n\n<p>I want to select all rows that have at least one of the characters in the STRING column somewhere in another row's STRING variable.</p>\n\n<p>For example, <code>1</code> and <code>2</code> have an <code>A</code> in common and <code>1</code> ad <code>3</code> have a <code>B</code> in common, but <code>4</code> does not have any characters in common with any of the other rows. So my query should return only the first three lines.</p>\n\n<p>I don't need to know with which line it matched.</p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","sql","query","tsql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12924154,"title":"Difficult T-SQL Join/Pivot","body":"<p>The original way I worded this question would be unhelpful to most, so I've reworked it significantly.</p>\n\n<p>I have a legacy database, whose schema <strong>I have no control over</strong> (nor ever have). The db schema was designed agnostic of the provider for consumption by unmanaged C++, so there are no FK constraints, etc. I come along and need to consume this from .NET, and also need to present the data much differently than it was originally intended.</p>\n\n<p>Here is the schema of the relevant tables (I've bolded/asteriskifed what amount to the keys for this question):</p>\n\n<pre><code>CREATE TABLE [dbo].[Formats](\n[GroupName] [varchar](255) NOT NULL,\n**[BatchID] [bigint] NOT NULL,**\n[SeriesNumber] [bigint] NOT NULL,\n**[SequenceID] [bigint] NOT NULL,**\n[SeqNum] [int] NOT NULL,\n[FormatName] [varchar](50) NOT NULL\n\nCREATE TABLE [dbo].[Fields](\n[GroupName] [varchar](255) NOT NULL,\n**[BatchID] [bigint] NOT NULL,**\n**[SequenceID] [bigint] NOT NULL,**\n[SeqNum] [int] NOT NULL,\n**[FieldName] [varchar](50) NOT NULL,**\n[FieldDisplayName] [varchar](50) NOT NULL,\n[FieldValue] [ntext] NULL\n</code></pre>\n\n<p>There is a 1:Many relationship between Formats:Fields.</p>\n\n<p>I need to query for a list of format rows. The challenges are several:\n   + There is a compound foreign key.\n   + I need to filter the formats to a subset that contains related Fields.\n   + The related fields must match an arbitrary number of filter criteria before being inner-joined to the formats.</p>\n\n<p>So to walk through this:\nThe Stored Proc receives the following table valued parameter:</p>\n\n<pre><code>_FieldDisplayName_  Field_Value\n Field 1             001\n Field 2             002\n</code></pre>\n\n<p>It then needs to filter the Fields table by those values.</p>\n\n<p>Since I needed to use ALL of the criteria and not just one of them, I did not know how work with this to retrieve something useful to join with, when I didn't know how many values I'd have, or what the FieldDisplayName values would be.</p>\n\n<p>@Joe Phillips was smart enough to see through the chaos and suggest that I needed to pivot the table. That's this:</p>\n\n<p><strong>Edit:</strong>\nThe following is working to pivot the data, but I am not sure it is ideal. Still waiting on other ideas before supplying an answer.</p>\n\n<p>Instead of using a TVP, I'm using a temp table and dynamic SQL (and yes, I see the injection vulnerability):</p>\n\n<pre><code>IF OBJECT_ID('[tempdb].[dbo].[#FilterFields]') is not null\nDrop Table dbo.#FilterFields\n\nCREATE Table #FilterFields (FieldDisplayName varchar(50), FieldValue nvarchar(max))\n/* Just some example data */\nINSERT INTO #FilterFields (FieldDisplayName, FieldValue) VALUES ('PTNUM', '011')\nINSERT INTO #FilterFields (FieldDisplayName, FieldValue) VALUES('SITENUM', '001')\n\nDeclare @column_names varchar(max)\nDeclare @dynamic_pivot_query as varchar(max)\n\nSELECT @column_names = Stuff((SELECT DISTINCT ',[' + FieldDisplayName + ']'\n                FROM #FilterFields FOR xml path('')),1,1,'')\n\nPRINT(@column_names)    \n\nSET @dynamic_pivot_query =\n'select * ' +\n'from tempdb.dbo.#FilterFields ' +\n'Pivot\n(\nMIN(\n    FieldValue\n    )\nFOR FieldDisplayName IN (' + @column_names + ')\n) as P'\n\nPRINT(@dynamic_pivot_query)\nEXEC(@dynamic_pivot_query)\n</code></pre>\n"},{"tags":["mysql","query","group-by","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12936871,"title":"MySQL use of GROUP BY and ORDER BY","body":"<p>I have a table of people, each one has the <em>number of visits</em> and the <em>priority</em>:</p>\n\n<pre><code>ID | NAME          |  VISITS | PRIORITY\n---------------------------------------\n 1 |     John      |    1    |   0\n 2 |     Joe       |    2    |   1\n 3 |     Peter     |    1    |   1\n 4 |     Sara      |    0    |   2  \n 5 |     Phillip   |    5    |   0\n 6 |     Bob       |    3    |   1\n 7 |     Andrew    |    4    |   2\n</code></pre>\n\n<p>There are only certain allowed priorities: (0,1,2) </p>\n\n<p><strong>How do I create a query which gives me people ordered by the number of visits (starting from the lowest) but within their corresponding priority groups?</strong> </p>\n\n<p>So the result should look like this:</p>\n\n<pre><code>ID | NAME          |  VISITS | PRIORITY\n---------------------------------------\n 1 |     John      |    1    |   0\n 2 |     Philip    |    5    |   0\n 3 |     Peter     |    1    |   1\n 4 |     Joe       |    2    |   1  \n 5 |     Bob       |    3    |   1\n 6 |     Sara      |    0    |   2\n 7 |     Andrew    |    4    |   2\n</code></pre>\n\n<p>I suppose there has to be some use of the GROUP BY clause, but Im not sure how to use it.</p>\n"},{"tags":["sql","query","report"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12935755,"title":"SQL Report - Group by Query for getting data from 12 months ago (this month included)","body":"<p>So, I found this nice little query:</p>\n\n<pre><code>Select    count(*) \nFROM      Table_X \nWHERE     year(DATE) = '2012' \nGROUP BY  month(DATE)\n</code></pre>\n\n<p>Which does almost exactly what I need.. Except I need to query the data of current month, up until 1 year ago. So for October, sept, aug, jul, jun, may, apr, mar, feb, jan 2012 and dec, nov 2011.. </p>\n\n<p>So I could just wait till the end of december to make the report :) . But there must be some other way?</p>\n"},{"tags":["php","query","mongodb","key"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12935461,"title":"PHP MongoDB Query into an array with an unknown key","body":"<p>I have a mongoDB set up like so:</p>\n\n<pre><code>fieldName: {\n  \"1\": {\n      client: \"name-here\",\n      subfield: \"more-junk-here\"\n   },\n   \"2\": {\n      client: \"another-client-name-here\",\n      subfield: \"more-data\"\n   },\n   \"3\": {\n      client: \"client-num-3\",\n      subfield: \"i-like-turkey-sandwiches\"\n   }\n}\n</code></pre>\n\n<p>How do I query for \"i-like-turkey-sandwiches\", without knowing it's in position 3, and without doing a search of the whole document? I started writing this, but am completely stumped how to do the search...</p>\n\n<pre><code>$cursor = $collection-&gt;findOne(array('fieldName' =&gt; 'i-like-turkey-sandwiches));\n</code></pre>\n"},{"tags":["query","select","sap","abap"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":323,"score":3,"question_id":11623637,"title":"How do I group conditions in a SELECT statement in ABAP?","body":"<p>First off, I have no experience with ABAP, I'm operating on guesswork here.</p>\n\n<p>I want to add a condition to a SELECT in an existing report.\nThe existing code looks like this:</p>\n\n<pre><code>SELECT SINGLE *\n  FROM EKPO\n  WHERE EBELN = GT_MSEG-EBELN\n  AND   EBELP = GT_MSEG-EBELP.\n</code></pre>\n\n<p>I want to add a condition to exclude the record if field F1 is a certain value and field F2 is 0 (both conditions must be true to exclude the record). I've tried this:</p>\n\n<pre><code>SELECT SINGLE *\n  FROM EKPO\n  WHERE EBELN = GT_MSEG-EBELN\n  AND   EBELP = GT_MSEG-EBELP\n  AND NOT (F1 = 'value' AND F2 = '0').\n</code></pre>\n\n<p>I get a syntax error: Field \"F1 = 'value' AND F2 = '0'\" is unknown. It is neither in one of the specified tables nor defined by a \"DATA\" statement.</p>\n\n<p>Fields F1 and F2 definitely exist in the EKPO table, I've checked. It seems that the brackets are making the compiler look at the contents as a field name, but I don't know why.</p>\n\n<p>Is the syntax incorrect, am I missing a definition somewhere, or both?</p>\n"},{"tags":["sql-server","vb.net","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12934506,"title":"Get one list from two table columns","body":"<p>I have two tables in SQL Server which have two similar columns.</p>\n\n<pre><code> table1 (\n     partID, PartName,  ....\n )\n\n table2 (\n    sekId,  Part2Name, ....\n )\n</code></pre>\n\n<p>I need to populate one combobox in vb.net with the cummulated values of <code>PartName</code> and <code>Part2Name</code> so that the list can appear like being sourced from one single column, because the user might require from either. The combobox must be one that's how the design has it. Is there an SQL statement to sort me out? </p>\n"},{"tags":["sql","sql-server-2008","query","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12933514,"title":"Sorting table data issue","body":"<p>I've quite bulky data in a Database table and I want to sort the data based on their ID (Primary Key). The data in the key column could be:</p>\n\n<pre><code>001/2011,\n002/2011,\n001/2012\n</code></pre>\n\n<p>When I use '<code>order by id</code>' it sorts the rows like</p>\n\n<pre><code>001/2011,\n001/2012,\n002/2011\n</code></pre>\n\n<p>However, what I am looking for is </p>\n\n<pre><code>001/2011,\n002/2011,\n001/2012\n</code></pre>\n\n<p>The data type of the id column is <code>varchar(50)</code>. Is there a special SQL function that I should use to sort such type of data?</p>\n"},{"tags":["mysql","query","count"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12932784,"title":"MySQL - Selecting Count with multiple tables and conditions for each","body":"<p>I am having a rather simple query in mind:</p>\n\n<p>I have three tables and I want to return the count of the rows which are used (have foreign key) of each table.</p>\n\n<p>This was my first attempt:</p>\n\n<pre><code>    SELECT \n        COUNT(at.code) AS atcount, \n        COUNT(de.code) AS decount, \n        COUNT(ch.code) AS chcount \n    FROM \n        table_at at, \n        table_ch ch, \n        table_de de \n    WHERE \n        at.teilnehmerid != 0\n    AND\n        de.teilnehmerid != 0\n    AND\n        ch.teilnehmerid != 0\n</code></pre>\n\n<p>But this somehow does not work, it does not generate any error, but the conditions are just not considered. I also thought about about subqueries, like:</p>\n\n<pre><code>    SELECT \n        (SELECT COUNT(code) FROM table_at at WHERE at.teilnehmerid != 0), \n        (SELECT COUNT(code) FROM table_de de WHERE de.teilnehmerid != 0), \n        (SELECT COUNT(code) FROM table_ch ch WHERE ch.teilnehmerid != 0)\n</code></pre>\n\n<p>But I was confused about something rather stupid with this attempt... what about the <code>FROM</code>?\nOf course I am getting an error: <code>Operand should contain 1 column(s)</code> - but I just want the counts...</p>\n\n<p>I also read about Joins, but did not understand how to get the <code>COUNT</code> via a <code>JOIN</code> inside my main <code>SELECT</code> statement.</p>\n\n<p>And yeah I have read some other questions around here, but did not see an answer applying to both problems:</p>\n\n<ul>\n<li>selecting multiple tables</li>\n</ul>\n\n<p>AND</p>\n\n<ul>\n<li>doing a <code>COUNT</code> on multiple table</li>\n</ul>\n\n<p>If I am wrong and just did not get the answer right, maybe a better explanation would help.</p>\n"},{"tags":["c#",".net","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":107,"score":5,"question_id":12859536,"title":"simple select query in linq","body":"<p>Lets say I have a student table and I want to display the student with ID 1.</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID = 1\n</code></pre>\n\n<p>This is how I achive this in Linq.</p>\n\n<pre><code>StudentQuery = from r in oStudentDataTable.AsEnumerable()\n                                     where (r.Field&lt;int&gt;(\"ID\") == 1)\n                                     select r;\n            oStudentDataTable = StudentQuery.CopyToDataTable();\n</code></pre>\n\n<p>but what if I want to display the students with these ids 1,2,3,4,5..</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID IN (1,2,3,4,5)\n</code></pre>\n\n<p>How can I achieve this in Linq?</p>\n"},{"tags":["android","sql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12933758,"title":"SQLiteDatabase Query in android","body":"<p>Am having a table <strong>card</strong> with colums <strong>id,name, content,status, date.</strong></p>\n\n<p>i want to take <strong>id,name,content</strong> condition is <strong>status &lt;= cards.STATUS</strong> also have to <strong>sort it by date</strong></p>\n\n<p>How i have to do this.\nam doing like,</p>\n\n<pre><code>private Cursor c;\n\nString[] cols = { id,name, content };\nc = cardsDB.query(CARDS_TABLE_NAME, cols, \"status &lt;=\" + Card.STATUS, null, null, null, \"date desc\");\n\nif (c.moveToFirst()) {\n            do {\n                CardArray.add(new Card(c.getInt(0), c.getInt(1), c.getString(2)));\n            } while (c.moveToNext());\n        }\n        c.close();\n</code></pre>\n"},{"tags":["query","hibernate","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12932207,"title":"Hibernate: Inner Join Mapped and Unmapped Table using HibernateTempate","body":"<p>I have the following tables:</p>\n\n<pre><code>USER\n    ID VARCHAR(32) INTEGER NOT NULL\n\nROLE\n    ID INTEGER NOT NULL\n\nUSERROLE /*Many to Many*/\n    USER_ID VARCHAR(32) NOT NULL\n    ROLE_ID INTEGER NOT NULL\n</code></pre>\n\n<p>and I'm using annotations to Map the DB Tables to my Classes.</p>\n\n<pre><code>/* Mapping for USER table */\n@Entity\n@Table (name=\"USER\")\npublic class User{\n    @Id\n    @Column (name=\"ID\")\n    private String id;\n\n    @ManyToMany \n    @JoinTable (name=\"USERROLE\", joinColumns = {@JoinColumn (name=\"USER_ID\")}, \n            inverseJoinColumns = {@JoinColumn (name=\"ROLE_ID\")})\n    @LazyCollection (LazyCollectionOption.FALSE)\n    private List&lt;Role&gt; roles;\n}\n\n/* Mapping for ROLE table */\n@Entity\n@Table (name=\"ROLE\")\npublic class Role {\n    @Id\n    @Column (name=\"ID\")\n    private int id;\n\n}\n</code></pre>\n\n<p>Now I would like to do a query that Joins ROLE and USERROLE tables so that i could get those ROLEs that has user assigned to it.</p>\n\n<p>--EDIT</p>\n\n<p>I have the Role.id, and I want to check whether this Role is being referenced in the USERROLE table. in native SQL, I would do it this way:</p>\n\n<pre><code>SELECT DISTINCT A.* from ROLE A INNER JOIN USERROLE B \nWHERE A.ID = B.ROLE_ID AND A.ID = ?;\n</code></pre>\n\n<p>how to do it in hibernate using HibernateTemplate?</p>\n"},{"tags":["php","database","query","codeigniter","fatal-error"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":12931555,"title":"Codeigniter Fatal error: Call to a member function query() on a non-object","body":"<p>Now I am learning Codeigniter. I have more databases, so I choosed this time Anketa one.\nWhy is error :</p>\n\n<pre><code>**Fatal error: Call to a member function query() on a non-object in /var/www/domains/svastara/application/controllers/anketa.php on line 12** ???\n</code></pre>\n\n<p>I chacked, the user and pass in database is ok, database is loaded in conf, and chacked the table name. So what more?</p>\n\n<pre><code>$this-&gt;db = $this-&gt;load-&gt;database('anketa');\n\n        $q = $this-&gt;db-&gt;query(\"SELECT * FROM anketaip\");\n\n        if($q-&gt;num_rows()&gt;0){\n        foreach ($q-&gt;result() as $row)\n        {\n            $data[] = $row;\n        }\n\n        }return $data;\n\n        $this-&gt;load-&gt;view('anketa_nova', $data);\n</code></pre>\n"},{"tags":["mysql","sql","query","select"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":12893233,"title":"mysql select from different tables with if clause","body":"<p><strong>table: user</strong> </p>\n\n<pre><code>| userid | fullname |\n|   1    |  admin   |\n|   2    |  jimmy   |\n|   3    |  anton   |\n|   4    |  steven  |\n</code></pre>\n\n<p><strong>table: maschinen</strong>    </p>\n\n<pre><code>| maschine | maschine-name |\n|    1     |       M1      |\n|    2     |       M2      |\n|    3     |       M3      |\n|    4     |       M4      |\n</code></pre>\n\n<p><strong>table:    vorrichtungen</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby |      datecreated    | updatedby |     dateupdated     |\n| 1  |    1     |    11111    |     1     | 2012-06-23 17:10:25 |     1     | 2012-06-23 18:15:20 |\n| 2  |    1     |    22222    |     1     | 2012-06-25 07:50:49 |     0     | 0000-00-00 00:00:00 |\n| 3  |    2     |    33333    |     2     | 2012-06-27 10:22:29 |     0     | 0000-00-00 00:00:00 |\n| 4  |    3     |    44444    |     2     | 2012-06-28 09:41:27 |     1     | 2012-06-28 12:40:37 |\n| 5  |    4     |    11111    |     3     | 2012-06-29 15:53:47 |     0     | 0000-00-00 00:00:00 |\n| 6  |    4     |    33333    |     4     | 2012-06-29 22:30:02 |     2     | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p><strong>my query looks like this:</strong>       </p>\n\n<pre><code>SELECT\n    vorrichtungen.`id`, \n    maschinen.`maschine-name` AS maschine, \n    vorrichtungen.`vorrichtung`, \n    vorrichtungen.`createdby`, \n    user.`fullname` AS creator, \n    vorrichtungen.`datecreated`, \n    vorrichtungen.`updatedby`, \n    vorrichtungen.`dateupdated`\nFROM \n    vorrichtungen,maschinen,user\nWHERE \n    maschinen.`maschine` = vorrichtungen.`maschine` \nAND \n    vorrichtungen.`createdby` =  user.`userid` \n</code></pre>\n\n<p><strong>and i recieve this result:</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby | creator |      datecreated    | updatedby |     dateupdated     |\n| 1  |    M1    |    11111    |     1     |  admin  | 2012-06-23 17:10:25 |     1     | 2012-06-23 18:15:20 |\n| 2  |    M1    |    22222    |     1     |  admin  | 2012-06-25 07:50:49 |     0     | 0000-00-00 00:00:00 |\n| 3  |    M2    |    33333    |     2     |  jimmy  | 2012-06-27 10:22:29 |     0     | 0000-00-00 00:00:00 |\n| 4  |    M3    |    44444    |     2     |  jimmy  | 2012-06-28 09:41:27 |     1     | 2012-06-28 12:40:37 |\n| 5  |    M4    |    11111    |     3     |  anton  | 2012-06-29 15:53:47 |     0     | 0000-00-00 00:00:00 |\n| 6  |    M4    |    22222    |     4     |  steven | 2012-06-29 22:30:02 |     2     | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p>i try to explain what i want..</p>\n\n<p>if updatedby !=0 than select fullname from table user AS updatetor else 0 or something like that .. but i want all 6 rows</p>\n\n<p><strong>i want to receive this result:</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby | creator |      datecreated    | updatedby | updatetor |     dateupdated     |\n| 1  |    M1    |    11111    |     1     |  admin  | 2012-06-23 17:10:25 |     1     |   admin   | 2012-06-23 18:15:20 |\n| 2  |    M1    |    22222    |     1     |  admin  | 2012-06-25 07:50:49 |     0     |      0    | 0000-00-00 00:00:00 |\n| 3  |    M2    |    33333    |     2     |  jimmy  | 2012-06-27 10:22:29 |     0     |      0    | 0000-00-00 00:00:00 |\n| 4  |    M3    |    44444    |     2     |  jimmy  | 2012-06-28 09:41:27 |     1     |   admin   | 2012-06-28 12:40:37 |\n| 5  |    M4    |    11111    |     3     |  anton  | 2012-06-29 15:53:47 |     0     |      0    | 0000-00-00 00:00:00 |\n| 6  |    M4    |    22222    |     4     |  steven | 2012-06-29 22:30:02 |     2     |   jimmy   | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p>is it possible to realize that? \nthanks for your help :)</p>\n\n<p>regards berni   </p>\n"},{"tags":["query","jasper-reports"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12930326,"title":"Parameter and single quotes: passing value to the IN clause","body":"<p>In my report's query I have a parameter that gets multiple values from a table which will be my barcode value. This is the query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT location_code, zone_code, check_digit_code\n  FROM location \n  WHERE location_code IN ($P!{LocationIn})\n</code></pre>\n\n<p>It works, but the value(s) that I input in the <em><code>LocationIn</code></em> parameter needs to be in single quotes (<code>'A01001'</code>, <code>'A1212'</code>) otherwise it fails with error : </p>\n\n<pre><code>Caused by: java.sql.SQLException: ORA-00904: \"A1212\": invalid identifier\n</code></pre>\n\n<p>I know the error is because of the two data types.</p>\n\n<p>I want to eliminate the effort of putting in the single quotes but I don't know how. Is this possible? I'm sure it is...</p>\n"},{"tags":["query","hibernate","jpa","jpql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12922320,"title":"Hibernate query - How to select those parents that have ALL the children matching a value?","body":"<p>I'm trying to write a Hibernate (JPA) query to select those parents where <strong>ALL</strong> their children match a property.</p>\n\n<p>Let's make a pratical example... </p>\n\n<p>I want to select those fathers who have <strong>ALL</strong> their children blond. If just one is black haired the father is not selected.</p>\n\n<p>How will the query look like?\nThank you in advance!</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12930802,"title":"How does COUNT behave when cross joins are involved in mysql?","body":"<p>I'm having a problem with counting the number of results of one of my queries that uses cross join.</p>\n\n<p>The data-gathering query is </p>\n\n<pre><code>SELECT CF.*, C.Type AS Ctype, C.Resp AS Resp \nFROM Campaigns C, CampaignEntities CF \nWHERE C.clientId = '10' AND LOWER(C.Resp) in ('resp1','resp2','resp3')\nORDER BY entityCode DESC \n</code></pre>\n\n<p>and it properly returns the rows that fit the criteria.</p>\n\n<p>However, when changing it to get the number of rows that fit:</p>\n\n<pre><code>SELECT COUNT(*) as RowNr \nFROM Campaigns C, CampaignEntities CF \nWHERE C.clientId = '10' AND LOWER(C.Resp) in ('resp1','resp2','resp3')\nORDER BY entityCode DESC\n</code></pre>\n\n<p>I get numbers in the millions (basically the result of the join without any of the WHERE conditions applied).</p>\n\n<p>Any idea why it's behaving like this or how I can possibly get the right number?</p>\n"},{"tags":["query","cassandra","range","astyanax"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12762818,"title":"Astyanax key range query","body":"<p>trying to write a query which will paginate through all rows in a column family using astyanax client and RowSliceQuery.</p>\n\n<pre><code>keyspace.prepareQuery(COLUMN_FAMILY).getKeyRange(null, null, null, null, 100);\n</code></pre>\n\n<p>Done this successfully using hector where 1st call is done with null start and end keys. After retrieving 1st page I use last key from the result to make query for second page and etc.  This is code for 1st page using hector.</p>\n\n<pre><code>HFactory.createRangeSlicesQuery(keyspace,\nLongSerializer.get(), new CompositeSerializer(),\nBytesArraySerializer.get())\n.setColumnFamily(COLUMN_FAMILY)\n.setRange(null, null, false, 100).setRowCount(100);\n</code></pre>\n\n<p>Now when I am trying to do this with astyanax I am getting errors about null and non-null keys and tokens.  Not sure what tokens do in this query.  Also I am able to use allRows(), but would like to do this using key range query as it gives me more flexibility.</p>\n\n<p>Does anybody have an example of key range query using astyanax?  I cannot find an example neither in \"getting started\" documentation or anywhere else on the net.</p>\n\n<p>Thanks!\nAnton</p>\n"},{"tags":["sql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12930621,"title":"select everything from one table, and array from another","body":"<p>I have one table that contains lots of data and I want to select everything from this one.</p>\n\n<p>Another table contains different statuscodes ( fields <code>ID</code> and <code>text</code> ), and I want to join this table into the first one so i get something like</p>\n\n<p>All data from first table <code>id1,text2,id2,text2</code> or <code>id1,id2,text1,text2</code> from the second table. </p>\n"},{"tags":["mysql","query","sql-order-by","subquery","group-concat"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12930715,"title":"GROUP_CONCAT with ORDER BY , but results are not orderd","body":"<pre><code>SELECT\n*,\n(SELECT\nGROUP_CONCAT(url SEPARATOR '$$' )\nFROM project_photos\nWHERE project_id = projects.id\nORDER BY priority) AS images\nFROM projects\nWHERE catID = 2\nLIMIT 0,5\n</code></pre>\n\n<p>above query works fine but the <code>images</code> coloumn are not ordered as priority , unable to understand why it is happening</p>\n\n<pre><code>// Structure for table project is\nCREATE TABLE `projects` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`catID` int(11) NOT NULL,\n`title` varchar(255) NOT NULL,\n`description` varchar(400) NOT NULL,\n`url` varchar(255) DEFAULT NULL,\n`tags` varchar(255) DEFAULT NULL,\n`featured` varchar(3) NOT NULL DEFAULT 'No',\n`featured_url` varchar(255) DEFAULT NULL,\n`order` int(11) DEFAULT NULL,\n`created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,\nPRIMARY KEY (`id`),\nKEY `catID` (`catID`),\nCONSTRAINT `FK_catID` FOREIGN KEY (`catID`) REFERENCES `category` (`catID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=latin1;\n\n\n// Structure for table project_photos is\n\nCREATE TABLE `project_photos` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`url` varchar(250) DEFAULT NULL,\n`project_id` int(11) DEFAULT NULL,\n`priority` int(11) DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=347 DEFAULT CHARSET=utf8;\n</code></pre>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12930545,"title":"MySQL Query - not interested in using inner query","body":"<p>I have a query say,</p>\n\n<pre><code>select col1,col2 from table1;\n</code></pre>\n\n<p>which return 2 columns of multiple rows. I want to use these two values in where condition of another query. Something like</p>\n\n<pre><code>select col3,col4 from table2 where col5=col1 and col6=col2;\n</code></pre>\n\n<p>where <code>col1</code> and <code>col2</code> are the resultant values of the first query.</p>\n\n<p>Currently I have used inner query something like</p>\n\n<pre><code>select col3,col4 from table2 \nwhere col5 in (select col1 from table1) \n  and col6 in (select col2 from table1);\n</code></pre>\n\n<p>But I dont want to use inner query like the one shown above as it slows down bring results. </p>\n\n<p>Please suggest.</p>\n"},{"tags":["query","session","mongodb","mongoose"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12929087,"title":"how to create a document in a mongodb collection and update another collection in the same time","body":"<p>here is my problem</p>\n\n<p>i have three schema</p>\n\n<pre><code>var UserSchema = new Schema({\n        username:String,\n        email:String,\n        hashed_password:String,\n        salt:String,\n        shop_id:{type:Schema.Types.ObjectId,ref:'Shop'},\n})\n\nvar ShopSchema = new Schema({\n       owner_id:{type:Schema.Types.ObjectId,ref:'User'},        \n       owner_real_id:String,                                    \n       owner_real_name:String,                                  \n       owner_real_location:String,                              \n\n       shop_name:String,\n       sell_product_ids:[Schema.Types.ObjectId],\n\n})\n\nvar ProductSchema = new Schema({\n\n\n})\n</code></pre>\n\n<p>it is necessary to sign up the userschema to use the app, but unnecessary to sign up the shopschema unless the user want to sell some stuff. however when the user do sign up the shopschema i need to update the userschema with the shop's _id, </p>\n\n<p>so here is what i did </p>\n\n<ol>\n<li>create the document in shop collection</li>\n<li>find the shops _id </li>\n<li>update the user collection</li>\n</ol>\n\n<p>as u can see i query the datebase three times,so i was wondering if this can be done in one query in order to save time like</p>\n\n<pre><code>Shop.create(regist_data,function(){\n    //update the user collection here\n})\n</code></pre>\n\n<p>Just in case u wondering why i need this, its becase i use 'passport' to log user in, and i want to acess the ProductShcema by shop's _id in the req.user, otherwise every time i want to acess the ProductShcema i nend to find the shop's _id and then get the product that belong to the shop's _id. </p>\n\n<p>any way if u have better solution,please let me know.thanx!!!</p>\n"},{"tags":["sql","query"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":81,"score":1,"question_id":12929191,"title":"Join two sql result","body":"<p>my first result looks like this</p>\n\n<pre><code>ID       Name\n----------------------------------\n1        George\n2        Peter\n3        San\n</code></pre>\n\n<p>my other result looks like this</p>\n\n<pre><code>AnotherID     ID     Note\n-----------------------------------\n1             1      georgesnote1\n2             1      georgesnote2\n3             3      sansnote1\n4             1      georgesnote3\n</code></pre>\n\n<p>How I want them to look:</p>\n\n<pre><code>ID       Name        Note\n----------------------------------\n1        George      georgesnote1\n1        George      georgesnote2\n1        George      georgesnote3\n2        Peter       NULL\n3        San         sansnote1\n</code></pre>\n\n<p>My SQL knowledge pretty much limits me to achieve this. I guess I need something like UNION ALL. INNER JOIN OR LEFT OUTER JOIN doesnt work. My actual query is around 21 lines so this is not a beginner question. What I need is to join two results based on same IDs. Please someone guide me.</p>\n"},{"tags":["query","pymongo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12926808,"title":"advanced query combining or and gte and lt in pymongo","body":"<p>How can it implement this in pymongo?   </p>\n\n<p>number == 100 or (number >=10000 and number &lt; 10100)?  </p>\n\n<p>currently, I am doing it with<br>\n*condition['number'] = {'$gte':input_number * 100, '$lt':(input_number + 1) * 100}*<br>\nand then query with the condition.  </p>\n\n<p>But I don't know how to add \"number == 100\". Thanks!</p>\n"},{"tags":["sql","oracle","query","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12928798,"title":"What does this JDBC snippet achieves?","body":"<pre><code>String q = \"SELECT attr FROM students foo =? AND bar = ?\";\nPreparedStatement s= connection.prepareStatement(q);\ns.setString(1,\"a\");\ns.setString(2.\"b\");\nResultSet rs = s.executeQuery();\nif(rs.next())\n{\n System.out.println(\"aba\");\n}\nelse\n{\n System.out.println(\"zab\");\n}\n</code></pre>\n\n<p>I'm not entirely sure, but my interpretation is that it performs query to find \"attr\" from \"students\" where foo is something and bar is something. In case of successful results from query it prints out aba, otherwise it will print out zab. </p>\n\n<p>Correct me if i'm wrong.What s.setStrings(1,\"a\") are for? What exactly question mark stands for?</p>\n"},{"tags":["query","wordpress","pagination"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1607,"score":1,"question_id":2149416,"title":"How to set a variable in Wordpress's $wp_query","body":"<p>I'm trying to use the <code>set()</code> function, to set <code>$wp_query->query_vars['paged']</code>. </p>\n\n<p>What's the proper syntax for this function? </p>\n\n<p>Thanks.</p>\n"},{"tags":["javascript","mysql","query","node.js","image-uploading"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":98,"score":-2,"question_id":12927939,"title":"How to store image into a MySQL database using node.js and Javascript","body":"<p>I am developing web application using node.js. I want to store an image into MySQL database.Please give some suggestions.</p>\n\n<pre><code>var Client = require('mysql').Client,\n    client = new Client();\nclient.user = DB_USER;\nclient.password = DB_PASS;\nclient.host = DB_HOST;\nclient.connect(function(error, results) {\n    if(error) {\n        client.end();\n        return;\n    }\n    client.query('USE ' + DB_SCHEME, function(error, results) {\n        if(error) {\n            client.end();\n            return;\n        }\n\n        var sql = \"INSERT INTO b SET `data` = ?\";\n        var values = [buf];\n\n        client.query(sql, values,\n            function(error, results) {\n                if(error) {\n                    return;\n                }\n                return;\n            }\n        );\n    });\n});\n</code></pre>\n\n<p>Here <strong>data</strong> is blob type.</p>\n"},{"tags":["mysql","sql","query","database-backups"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":12556713,"title":"Query for mysql database backup (only data) without usin mysql dump","body":"<p>I need to fetch data from database for backup in the form of insert statements</p>\n\n<p>I need to do it against a user button click in c#. So i think an sql query or stored procedure will be appropriate to do this, rather than mysqldump.</p>\n\n<p>Secondly I need them for <strong>all tables</strong>. Instead of writing table and column names they should be fetched from information_schema, because with dynamic names, changes in schema would not affect the query</p>\n\n<p>If there already exists a solution, please guide me.</p>\n\n<p><strong>Edit</strong> : (Not necessary to read) Question included an unnecessary query which I have removed now. the first answer was not satisfactory but it was for outfile. I have left outfile because that works for single table and does not allow appending</p>\n\n<p><strong>Update</strong> : I have made a solution, it is posted, but looking for the better one.</p>\n"},{"tags":["mysql","query","left-join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12926870,"title":"Left join has me stumped","body":"<p>I have 2 tables, person and movie</p>\n\n<p>The person table has ID and gender, and the Movie table has ID, movie_type, and movie_attended. genderID and movie_attended can be null.</p>\n\n<p>I want to create a query that will return 3 columns: gender, movie_attended (but it must be a romance movie), and a count of the number of people who have that gender and movie_attended.</p>\n\n<p>Right now I have</p>\n\n<pre><code>select person.gender, movie.movie_attended, count(person.gender)\nfrom person left join movie\non person.ID = movie.ID\nwhere movie.movie_type = \"romance\"\norder by person.gender DESC\n</code></pre>\n\n<p>Unfortunately this just gives me one row of information. If I remove the count(person.gender) I get too many rows. Lets say there are only 3 romance movies to choose from. I want my first row to read Male - The Notebook - 12. Second row: Male - Casablanca - 8. Third row: Male - Romeo &amp; Juliet - 2. Fourth row: Male - Null - 2</p>\n\n<p>Then start over with Female</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12882515,"title":"Rails - use join only if a condition is true","body":"<p>How do I use joins only if a certain condition is true?\nFor example, I have this query:</p>\n\n<pre><code>@courses = Course.find(:all,\n    :order=&gt; 'courses.name asc',\n    :include =&gt; [:units],\n    :joins =&gt; :course_sub_responsibles,\n    :group =&gt; 'courses.name',\n    :conditions =&gt; conditions) \n</code></pre>\n\n<p>But I need to join the course_sub_responsibles table only in a certain condition.</p>\n"},{"tags":["css","query","internet-explorer","media","susy-compass"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12899945,"title":"susy, media queries, and lt IE9","body":"<p>I was wondering what (if any) shims you use to get the magic grids to respond correctly in <a href=\"http://susy.oddbird.net/\" rel=\"nofollow\">SUSY</a> in IE8 and under?</p>\n\n<p>On non-susy sites I've always used <a href=\"http://modernizr.com/\" rel=\"nofollow\">moderizr</a> or the shim from google and they worked as expected. I'm working on my first SUSY site and the media queries for the largest size won't kick in.</p>\n\n<p><a href=\"http://dev.apehangar.com\" rel=\"nofollow\">http://dev.apehangar.com</a></p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":64,"score":-1,"question_id":12924436,"title":"Query broke down and left me stranded in the woods","body":"<p>I am trying to execute a query that deletes all files from the images table that do not exist in the filters tables. I am skipping 3,500 of the latest files in the database as to sort of \"Trim\" the table back to 3,500 + \"X\" amount of records in the filters table.</p>\n\n<p>The filters table holds markers for the file, as well as the file id used in the images table. </p>\n\n<p>The code will run on a cron job. </p>\n\n<p>My Code:</p>\n\n<pre><code>$sql = mysql_query(\"SELECT * FROM `images` ORDER BY `id` DESC\") or die(mysql_error());\n\nwhile($row = mysql_fetch_array($sql)){\n    $id = $row['id'];\n    $file = $row['url'];\n\n    $getId = mysql_query(\"SELECT `id` FROM `filter` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($getId) == 0){        \n        $IdQue[] = $id;\n        $FileQue[] = $file;\n    }\n}\nfor($i=3500; $i&lt;$x; $i++){\n    mysql_query(\"DELETE FROM `images` WHERE id='\".$IdQue[$i].\"' LIMIT 1\") or die(\"line 18\".mysql_error());\n    unlink($FileQue[$i]) or die(\"file Not deleted\");\n}\necho ($i-3500).\" files deleted.\";\n</code></pre>\n\n<p>Output: 0 files deleted.</p>\n\n<p>Database contents:</p>\n\n<pre><code>images table: 10,000 rows\nfilters table: 63 rows\n</code></pre>\n\n<p>Amount of rows in filters table that contain an images table id: 63\nExecution time of php script: 4 seconds +/- 0.5 second</p>\n\n<p>Relevant DB structure</p>\n\n<ul>\n<li>TABLE: images </li>\n<li>id </li>\n<li>url </li>\n<li><p>etc...</p></li>\n<li><p>TABLE: filter </p></li>\n<li>id </li>\n<li>img_id (CONTAINS ID FROM images table) </li>\n<li>etc...</li>\n</ul>\n"},{"tags":["database","query","informix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":5013845,"title":"Tweak Informix query","body":"<p>I have a bunch of Informix queries and I need to verify the performance of each query.</p>\n\n<p>All these queries are long and contain a lot inner SELECT and JOINs. So I am wondering if there is any tool which can assist me to check which fragment in the query affects the whole query performance?  </p>\n\n<p>It would help a lot because it's hard to check only by eyes.</p>\n"},{"tags":["query","drop-down-menu","caml","sharepoint-list","sharepoint-object-model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":12185935,"title":"How to get a single listitem field value?","body":"<p>I have a SharePoint list with Roles as the columns(Admin, Viewer, Manager) and Document Types as the items (Word docs, PPtx docs, excel docs). I have filled in the corresponding values with the permissions each Role has per Doc Type. </p>\n\n<p>I have built a web part with 2 dropdowns. Dropdown1 has Roles and Dropdown2 has Doc Types.</p>\n\n<p>How can I use the selected value for each dropdown and query the corresponding value from the list?</p>\n\n<p>Do I use CAML or can I use SharePoint object model?</p>\n\n<pre><code>using (SPSite siteCol = new SPSite(\"http://mySharepoint/\"))\n{\n    using (SPWeb web = siteCol.RootWeb)\n    {\n        SPList list = web.GetList(\"/Lists/PermissionMatrix\");\n\n        SPListItem item = list.GetItemByIdSelectedFields([*Requires ID*], \"Role\");\n\n        String role1= (String)item[\"Roles\"];\n    }\n}\n</code></pre>\n\n<p>Doesn't work because I have to use the Item ID and I could only query the item using CAML</p>\n\n<p>Please help. Thanks</p>\n"},{"tags":["wordpress","query","sorting","sql-order-by","custom-fields"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3195,"score":1,"question_id":5396015,"title":"order by custom field - wordpress","body":"<p>I'm trying to sort a page of posts by a custom field. </p>\n\n<p>Here's what I have so far, I'm just not sure how or where to add the orderby</p>\n\n<pre><code>$args = array(\n    'post_type' =&gt; 'new',\n    'meta_query' =&gt; array(\n        array(\n            'key' =&gt; 'over-make',\n            'value' =&gt; 'Doral',\n            'compare' =&gt; 'LIKE'\n        )\n    )\n\n );\n$loop = new WP_Query( $args);\n</code></pre>\n"},{"tags":["php","query","button","submit","isset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12922810,"title":"intercept an sql query which is executed without push the right submit button correlated php","body":"<p>I have a submit type button called \"validate\" if user has allowed appeared in page.\nvalidate button set a row in db as validated (TRUE)</p>\n\n<p>i check first in db if validated field is true or false.</p>\n\n<p>if false and  isset($_POST['valid'])  i show up the button </p>\n\n<pre><code>                        &lt;input &lt;?php echo $disabledvalid; ?&gt; type=\"submit\" class=\"sub\" name=\"valid\"  id=\"valid\" value = \"validate\"   /&gt;\n</code></pre>\n\n<p>after i put the UPDATE query which change validated field from FALSE to true.</p>\n\n<p>When the page is processed the if is ignored and was executed update query?</p>\n\n<p>How can i fix this problem?</p>\n\n<pre><code>                &lt;form action=\"view_support.php\" method=\"post\"&gt;\n            &lt;?php\n\n            //check if validated field is true or false\n            $queryvalid = \"SELECT validated FROM support WHERE suppid = $suppid\";\n            $risqueryvalid = pg_query($queryvalid);\n            $row = pg_fetch_array($risqueryvalid);\n            $suppvalidated = $row['validated'];\n            //echo \"supp \" . $suppvalidated;\n\n\n\n            //$suppvalidated == \"f\";\n            unset($_POST['valid']);\n            //if validated field is false show me validate button\n            if ( $suppvalidated == FALSE &amp;&amp; (isset($_POST['valid'])  ){ \n                $suppvalidated = 'true';\n\n\n                    &lt;input &lt;?php echo $disabledvalid; ?&gt; type=\"submit\" class=\"sub\" name=\"valid\"  id=\"valid\" value = \"validate\"   /&gt;\n                &lt;?php\n\n                if(isset($_POST['valid'])){\n                    $vquery = \"UPDATE support SET validated = $suppvalidated WHERE suppid = $suppid\";\n                    $risvquery = pg_query($vquery);\n                    if (!$risvquery) {\n                        #die(\"Error during insert support\");    \n                        die(\"Errore nella query $risvquery: \" . pg_last_error());\n                    }\n                    unset($_POST['valid']);\n                }\n</code></pre>\n"},{"tags":["mysql","query","stored-procedures","timestamp","mysql-workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12922972,"title":"Mysql query to copy timestamp data from another","body":"<p>I was working on mysql query and could not get it running. I am trying to copy timestamp field data from one table to another based on user id. It is not straight forward. Here is the story. In the score table I have User_id, question id Tag id and add_date field......   There are various Tag id for one user in that table and I want to copy add date field  for each user where tagid=627 in the other table called as User in its respective Date_record(timestap) field which is 0000 0000 right now .Once again, trying to Copy add_date field for each user where tagid=627(for each) and paste to the same user id(field name is id for this table which is same a suser id) in other table in the Date_record field which is time stamp and currently 0000-00-00 00:00:00.  For example, screen shot of tables.</p>\n\n<p><a href=\"http://minus.com/lw2prl55nTBHA\" rel=\"nofollow\">http://minus.com/lw2prl55nTBHA</a>\nuser table with empty Date_record field(timestamp) which will be having data from score table(next) for same user id(int this table id is same as user_id) and tag id=627][1]</p>\n\n<p><a href=\"http://minus.com/lby84cURuoD5DN\" rel=\"nofollow\">http://minus.com/lby84cURuoD5DN</a>\nscore table in which for same user id there are diff tag id and I want to copy tagid =627 add_date data field</p>\n"},{"tags":["android","query","sqlite","spatialite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12916041,"title":"Android: Failing to update row using SQL Extension function or builtin","body":"<p>I'm having a lot of trouble with SQLiteDatabase command.  I have loaded up spatialite and enabled the extension.  I want one of my values to be the output of the MakePoint function so I have a content value like this:</p>\n\n<pre><code>values.put(\"Location\", \"MakePoint(43.2, 27.345, 4326)\");\n</code></pre>\n\n<p>When this is passed into <code>SQLiteDatabase.Update()</code> it's escapsed so that the resulting string ends up being <code>\"UPDATE Targets SET Location='MakePoint(43.2, 27.345, 4326)'\"</code> SQLite hates this and throws an exception. </p>\n\n<p>Is there an easy way around this? Right now I'm trying to build up the string manually since I can't use Update.</p>\n"},{"tags":["ajax","query","postgresql","data-visualization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12897730,"title":"Efficiently Subsample Timeseries Data in Database","body":"<p>I have a timeseries of values (e.g., a random walk of stock market prices) stored in a PostgreSQL database. It's a very large table and I'd like to be able to handle queries for arbitrary time spans similarly fast. I have <a href=\"http://www.highcharts.com/stock/demo/lazy-loading\" rel=\"nofollow\">this chart</a> in the back of my mind, and I wonder how they did this.</p>\n\n<p>A simple Example: </p>\n\n<pre><code>WITH t(ts, val) AS ( VALUES\n    ('2012-10-04 00:00:00'::timestamp, 1.11::numeric),\n    ('2012-10-04 00:00:01', 1.21),\n    ('2012-10-04 00:00:02', 1.25),\n    ('2012-10-04 00:00:03', 1.41),\n    ('2012-10-04 00:00:04', 1.31),\n    ('2012-10-04 00:00:05', 1.25),\n    ('2012-10-04 00:00:06', 1.33))\n</code></pre>\n\n<p>(Assume there's an index on the timestamp column.) The table is large, and it takes a long time to retrieve all values of a time span of, e.g., a quarter of a year. However, as all I want to do with that data is to make a plot to visualize the global trend, I do not really need to get the entire data set from that period, but a representative subset would be fine.</p>\n\n<p>Things that came to my mind:</p>\n\n<ul>\n<li>generate a list of sub-statements, each of which retrieves one arbitrary value for a short sub-time-interval (e.g. one value per hour interval).</li>\n<li>aggregate values, e.g. <code>AVG()</code> and group by <code>date_trunc('hour', ts)</code> or similar (but would this be any faster on its own? Probably make another table that holds pre-aggregated values?)</li>\n</ul>\n\n<p>Is there a way-to-go to achieve this?</p>\n"},{"tags":["php","mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12911526,"title":"Any way to select from MySQL table where a field ends in certain character/number?","body":"<p>I am hoping to run a mysql_query where I can select a row if a certain field ends in a number. For example:</p>\n\n<pre><code>&lt;?php\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 0]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 1]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 2]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 3]\");\n//and so on...\n?&gt;\n</code></pre>\n\n<p>Is there a way to do this? Any help would be great. Thank you!</p>\n"},{"tags":["sql","query","relational","algebra"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":11106268,"title":"SQL relational query","body":"<p><img src=\"http://i.stack.imgur.com/Z0Bbg.jpg\" alt=\"enter image description here\"></p>\n\n<p>I have two example tables R,S as seen above, I want to write a query that returns all attributes A (left table) that are associated with exactly 'b2' and 'b4' from the other table, in this case it should return only a2.</p>\n\n<p>Using division returns both a1 and a2 since they both have that association, but a1 does not apply since it has association with other attributes, I am only allowed to use minimal relational algebra operators.</p>\n"},{"tags":["mysql","query","join","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12884035,"title":"Query with multiple joins and sum function giving wrong total or sum","body":"<p>Posted query retrieving all the relevant fields but the <strong><code>SUM(af_py_commission)</code></strong> function causing problem as in and it simply add an extra zero at the end and then on the right end. </p>\n\n<p>e.g. if the answer is 45 it will give 450 and data format of the field is float else this query is working perfect....</p>\n\n<p>I've tried a simple query with same function on the same field but without the joins so it work fine and give correct ans. Can anyone help what i'm doing wrong in this>??</p>\n\n<pre><code>SELECT f.af_id AS af_if\n   , aff_cust_tbl.af_id AS cu_af_id\n   , aff_payment_tbl.af_cust_id AS pym_cus_id\n   , SUM(af_py_commission)\nFROM aff_tbl AS f\nINNER JOIN aff_tbl ON f.af_id = 2\nINNER JOIN aff_cust_tbl ON aff_cust_tbl.af_id = 2\nINNER JOIN aff_payment_tbl ON aff_payment_tbl.af_id = 2;\n</code></pre>\n"},{"tags":["sql","query","aggregate-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12919802,"title":"Do several aggregates in one query using where clause SQL","body":"<p>Is it possible to do several aggregate functions inside a single query</p>\n\n<p>I know whe can use </p>\n\n<pre><code>SELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01'\n</code></pre>\n\n<p>I've been trying to make an example</p>\n\n<pre><code>CREATE TABLE mytable\n    (id varchar(10), value int, `date` date, situation varchar(10) ) ;\n\nINSERT INTO mytable\n    (id, value, date, situation)\nVALUES\n    ('id0', 1338, '2012-05-14','Urgent'),\n    ('id0', 3572, '2012-05-13','Urgent'),\n    ('id0', 3232, '2012-05-06','Urgent'),\n    ('id0', 3068, '2012-05-05','Post'),\n    ('id0', 3363, '2012-05-04','Urgent'),\n    ('id0', 2022, '2012-04-28','Anual'),\n    ('id0', 3193, '2012-04-24','Post')\n</code></pre>\n\n<p>But is it possible to use the same query to get other aggregate values?</p>\n\n<pre><code>SELECT SUM(value),SUM(value),Count(*) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01', WHERE date  between '2012-05-01' AND '2012-10-01', Where situation like 'Urgent' \n</code></pre>\n\n<p>instead of 3 queries:</p>\n\n<pre><code>SELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01'\nSELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-10-01'\nSELECT Count(*)   FROM mytable Where situation like 'Urgent'\n</code></pre>\n"},{"tags":["query","file","process","count","descriptor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12914607,"title":"How can I read out how many file descriptors refer a file of a given name within an arbitrary process","body":"<p>On linux c(++): How can I count how many file descriptors refer a file of a given name in a given process. I would be pariculary interested in knowing, how many shm_open had added a reference on a file. How can I read this out from inside an arbitrary process? Because i dont want to unlink the files in other processes before everyone called close, because it will delete the file name, which I do not want.</p>\n\n<p>Ok, I found that most likely there is no way to do this without calling external utilities and that is very inefficient. So my question rather would be: how would you solve this problem (tracking open-close pairs across processes) without IPC stuff like message queues or SHM. I guess I'll go with message queue, but if anyone has a simpler solution feel free to recommend!</p>\n"},{"tags":[".net","query","sqlite","driver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12918126,"title":"C# application compiled with .NET SQLite driver?","body":"<p>Real quick question! <strong>*If I load an SQLite driver into my .NET project, when I save and compile this project (it's a simple Windows Forms application), will the SQLite driver form part of the application?</strong> Basically I'm planning on having one of my form controls execute an SQL query on an SQLite database which will exist on a user's machine. Obviously if this driver does not exist then the SQLite database file will not be able to be interpreted!</p>\n\n<p>Thanks for any input.</p>\n"},{"tags":["sql","database","sql-server-2008","query","sql-optimization"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12918362,"title":"Temporary table vs short-circuit operation for SQL query","body":"<p>Following is my query which I want to optimize, here the bottleneck for the optimization is CONDITION_B. </p>\n\n<pre><code>select @COMPUTE_X = count(distinct TABLEA.COLUMN_T5)\nfrom #TMP_TABLEA TABLEA\ninner join TABLEB on TABLEB.ID = TABLEA.ID\nleft join....\nwhere\n(\n  CONDITION_A --Complex condition\n) and\n(\n  CONDITION_B --Complex condition with some functions returning table\n)\n</code></pre>\n\n<p>If I put my result of above query leaving CONDITION_B to a temporary table and then apply CONDITION_B on that temporary table, I achieve a very good amount of performance gain. I think CONDITION_B always evaluated whether the result for CONDITION_A is false.</p>\n\n<p>Could anyone let me know if there is a better way of doing it. And does short-circuit operations work in SQL query statement, if yes what is the order of their processing.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":128,"score":4,"question_id":12904097,"title":"SQL Query to return maximums over decades","body":"<p><strong>THIS IS USING MYSQL</strong>\nMy question is the following. I have a baseball database, and in that baseball database there is a master table which lists every player that has ever played. There is also a batting table, which tracks every players' batting statistics. I created a view to join those two together; hence the <code>masterplusbatting</code> table. \n  I now want to find the highest HR hitter in each decade since baseball began. Here is what I tried.</p>\n\n<pre><code>    select f.yearID, truncate(f.yearid/10,0) as decade,f.nameFirst, f.nameLast, f.HR\n    from (\n    select yearID, max(HR) as HOMERS\n    from masterplusbatting group by yearID\n    )as x inner join masterplusbatting as f on f.yearID = x.yearId and f.HR = x.HOMERS\n    group by decade\n</code></pre>\n\n<p>You can see that I truncated the yearID in order to get <code>187, 188, 189</code> etc instead of <code>1897, 1885,</code>. I then grouped by the decade, thinking that it would give me the highest per decade, but it is not returning the correct values. For example, it's giving me Adrian Beltre with 48 HR's in 2004 but everyone knows that Barry Bonds hit 73 HR in 2001. Can anyone give me some pointers?</p>\n"},{"tags":["php","ajax","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12917033,"title":"AJAX, PHP DB Lookup","body":"<p>Currently I have a form and when the user is entering data, this code calls another page to check if the username is in use. This is the code from the main page that calls the DB Page(test.php)</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\nfunction showHint(str)\n{\nif (str.length==0)\n  { \n  document.getElementById(\"txtHint\").innerHTML=\"\";\n  return;\n  }\nif (window.XMLHttpRequest)\n  {// code for IE7+, Firefox, Chrome, Opera, Safari\n  xmlhttp=new XMLHttpRequest();\n  }\nelse\n  {// code for IE6, IE5\n  xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\n  }\nxmlhttp.onreadystatechange=function()\n  {\n    if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)\n    {\n        document.getElementById(\"txtHint\").innerHTML=xmlhttp.responseText;\n        if (xmlhttp.responseText.indexOf(\"green\") != -1) {\n            document.getElementById(\"submit\").disabled = false;\n        } else {\n            document.getElementById(\"submit\").disabled = true;\n        }\n    }\n  }\nxmlhttp.open(\"GET\",\"test.php=\"+str,true);\nxmlhttp.send();\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>I want to change this so when it calls test.php it passes a value to test.php based on what form field the user is entering into.</p>\n\n<p>That way I can use test.php to perform diffident DB lookups depending on the form field the user is completing.</p>\n\n<p>Can anyone help ?\nThanks :) </p>\n"},{"tags":["sql-server-2008","query","inner-join","multiple-columns"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12917711,"title":"In sql 2008 R2, how do i join 2 columns from one table with 2 columns in another table?","body":"<p>I have 2 tables. In table1 I have 2 columns -- cust_npa &amp; cust_nxx. In table2, I have 2 columns -- valid_npa &amp; valid_nxx. Each entry in table2.valid_npa has a corresponding entry in table2.valid_nxx.</p>\n\n<pre><code>valid_npa   valid_nxx\n201         551\n201         552\n201         553\n202         851\n202         852\n</code></pre>\n\n<p>I wish to return all the rows in table1 that have a combination of valid_nap &amp; valid_nxx from table2.</p>\n\n<p>For example, a row in table1 that has cust_npa of 201 and cust_nxx of 852 would not be returned (as this is not a valid combination from table2).</p>\n"},{"tags":["mysql","query","epoch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12916275,"title":"mysql update HH:MM:SS from an epoch time","body":"<p>I'm looking to do a mass query update on a column that is in ms from the epoch.  For each row returned according to my where clause, I would like to update the time value to something passed in, and have it still stored in ms.  What would my update clause need to look like?</p>\n\n<p>For example, I have two rows</p>\n\n<pre><code>MY_TIMESTAMP  | VALUE\n----------------------\n1281275302000 | some val 1\n1347198502000 | some val 2\n</code></pre>\n\n<p>Row 1 corresponds to Sun, 08 Aug 2010 13:48:22 UTC \nRow 2 corresponds to Sun, 09 Sep 2012 13:48:22 UTC</p>\n\n<p>Now I want to set both times, say to 07:00:00, but leave the dates as is.  So the result of the update statement should look like:</p>\n\n<pre><code>MY_TIMESTAMP  | VALUE\n----------------------\n1281250800000 | some val 1\n1347174000000 | some val 2\n</code></pre>\n\n<p>corresponding to Sun, 08 Aug 2010 07:00:00 UTC and Sun, 09 Sep 2012 07:00:00 UTC</p>\n"},{"tags":["java","query","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12900029,"title":"Hibernate Sorting by associated (optional) fields","body":"<p>I am trying to do a sort on a Hibernate dataset, ordering by a attribute of an (optionally) associated object. I followed the example from <a href=\"http://stackoverflow.com/questions/870029/hibernate-order-by-association\">hibernate order by association</a> - and that works to an extent. The problem comes when there is not an associated object, the whole record is ignored.</p>\n\n<p>If I change the association type of the object to be an outer join, will it help matters? And if so, can someone please point me towards the correct directive?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["mysql","query","join","left-join","limit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12915374,"title":"Getting total mysql results returned from query with a limit: FOUND_ROWS error","body":"<p>I have this mysql query:</p>\n\n<pre><code>SELECT Files.GUID, Files.Name, Files.Type, Files.Visibility, Files.CreationDate, Files.OwnerUser, Date, BackupsCount\nFROM Files\n  LEFT JOIN (\n    SELECT FileGUID, Date, COUNT(*) AS BackupsCount\n    FROM Versions\n    GROUP BY FileGUID\n  ) Versions ON Files.GUID = Versions.FileGUID\nWHERE Files.ParentFolder = '96251A8B-B2A8-416B-92D7-3509E6A645C7'\nORDER BY Files.Type DESC, CreationDate ASC\nLIMIT 0, 50\n</code></pre>\n\n<p>I'd like to know how many record this query would return <strong>if the LIMIT directive was not there</strong>, I googled and found that I needed to add <code>SELECT SQL_CALC_FOUND_ROWS</code> and <code>SELECT FOUND_ROWS();</code></p>\n\n<p><strong>MY problem is:</strong> I couldn't get it to work:</p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS * FROM (\nSELECT Files.GUID, Files.Name, Files.Type, Files.Visibility, Files.CreationDate, Files.OwnerUser, Date, BackupsCount\nFROM Files\n  LEFT JOIN (\n    SELECT FileGUID, Date, COUNT(*) AS BackupsCount\n    FROM Versions\n    GROUP BY FileGUID\n  ) Versions ON Files.GUID = Versions.FileGUID\nWHERE Files.ParentFolder = '96251A8B-B2A8-416B-92D7-3509E6A645C7'\nORDER BY Files.Type DESC, CreationDate ASC\nLIMIT 0, 50)\n\n-- Find total rows\nSELECT FOUND_ROWS()\n</code></pre>\n\n<p>Assuming this is good idea (I mean doing one query vs two separate ones), <strong>how can I get the <code>FOUND_ROWS()</code> to work with this query?</strong></p>\n"},{"tags":["php","mysql","query","join","mybb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":167,"score":0,"question_id":3077336,"title":"How can I join 3 tables with mysql & php?","body":"<p>I have a page that pulls the users Post,username,xbc/xlk tags etc which is perfect... BUT since I am pulling information from a MyBB bulletin board system, its quite different. When replying, people are are allowed to change the \"Thread Subject\" by simplying replying and changing it.</p>\n\n<p>I dont want it to SHOW the changed subject title, just the original title of all posts in that thread.</p>\n\n<p>By default it repies with \"RE:thread title\". They can easily edit this and it will show up in the \"Subject\" cell &amp; people wont know which thread it was posted in because they changed their thread to when replying to the post.</p>\n\n<p>So I just want to keep the orginial thread title when they are replying.</p>\n\n<p>Make sense~??</p>\n\n<p>Tables:mybb_users\nFields:uid,username</p>\n\n<p>Tables:mybb_userfields\nFields:ufid</p>\n\n<p>Tables:mybb_posts\nFields:pid,tid,replyto,subject,ufid,username,uid,message</p>\n\n<p>Tables:mybb_threads\nFields:tid,fid,subject,uid,username,lastpost,lastposter,lastposteruid</p>\n\n<p>I haev tried multiple queries with no success:</p>\n\n<pre><code>$result = mysql_query(\"\n    SELECT * FROM mybb_users\n    LEFT JOIN (mybb_posts, mybb_userfields, mybb_threads)\n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n        AND mybb_users.uid=mybb_userfields.ufid\n    )\n    WHERE mybb_posts.fid=42\");\n\n\n$result = mysql_query(\"\n    SELECT * FROM mybb_users\n    LEFT JOIN (mybb_posts, mybb_userfields, mybb_threads)\n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n        AND mybb_users.uid=mybb_posts.uid\n    )\n    WHERE mybb_threads.fid=42\");\n\n$result = mysql_query(\"\n    SELECT * FROM mybb_posts \n    LEFT JOIN (mybb_userfields, mybb_threads) \n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n    )\n    WHERE mybb_posts.fid=42\");\n</code></pre>\n"},{"tags":["android","query","ormlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":190,"score":0,"question_id":11671791,"title":"ORMLite - Query foreign field","body":"<p>Using ORMLite for Android, I need to build a query that returns orders by order id or by customer name. Please consider the following class declarations:</p>\n\n<pre><code>@DatabaseTable(tableName = \"order\")\npublic class Order {\n    @DatabaseField(generatedId = true)\n    private Long id;\n\n    @DatabaseField(foreign = true, canBeNull = false, foreignAutoRefresh = true, columnName = \"customer_id\")\n    private Customer customer;\n\n    // default constructor, getters and setters...\n}\n\n@DatabaseTable(tableName = \"customer\")\npublic class Customer {\n    @DatabaseField(generatedId = true)\n    private Long id;\n\n    @DatabaseField\n    private String name;\n\n    // default constructor, getters and setters...\n}\n</code></pre>\n\n<p>The raw SQL I'm looking for would be something like this:</p>\n\n<pre><code>SELECT \n    o.* \nFROM\n    order o\n    JOIN customer c on\n        o.customer_id = c.id\nWHERE\n    (o.id = ?) OR (c.name = ?)\n</code></pre>\n\n<p>What is the best way to do this using ORMLite?</p>\n"},{"tags":["php","html","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12915677,"title":"PHP / MySQL String Search Query","body":"<p>I've got a database setup with \"customer\" information.  I've got a PHP form to search for the strings, first name (fname), last name (lname), and phone number (phone).  For some reason, I'm not even getting the helpers displayed that the functions are working?  I've re-read over this code over and over and can't seem to figure out where I'm missing something.</p>\n\n<pre><code>&lt;form name=\"search\" method=\"post\" action=\"&lt;?=$PHP_SELF?&gt;\"&gt;\n Seach for: &lt;input type=\"text\" name=\"find\" /&gt; in \n &lt;Select NAME=\"field\"&gt;\n &lt;Option VALUE=\"fname\"&gt;First Name&lt;/option&gt;\n &lt;Option VALUE=\"lname\"&gt;Last Name&lt;/option&gt;\n &lt;Option VALUE=\"phone\"&gt;Phone #&lt;/option&gt;\n &lt;/Select&gt;\n &lt;input type=\"hidden\" name=\"searching\" value=\"yes\" /&gt;\n &lt;input type=\"submit\" name=\"search\" value=\"Search\" /&gt;\n &lt;/form&gt;\n &lt;? \n //This is only displayed if they have submitted the form \n if ($searching ==\"yes\") \n { \n echo \"&lt;h2&gt;Results&lt;/h2&gt;&lt;p&gt;\"; \n\n //If they did not enter a search term we give them an error \n if ($find == \"\") \n { \n echo \"&lt;p&gt;You forgot to enter a search term\"; \n exit; \n } \n\n // We preform a bit of filtering \n $find = strtoupper($find); \n $find = strip_tags($find); \n $find = trim ($find); \n\n //Now we search for our search term, in the field the user specified \n $data = mysql_query(\"SELECT * FROM customer WHERE upper($field) LIKE'%$find%'\"); \n\n //And we display the results \n while($result = mysql_fetch_array( $data )) \n { \n echo $result['fname']; \n echo \" \"; \n echo $result['lname']; \n echo \"&lt;br&gt;\"; \n echo $result['phone']; \n echo \"&lt;br&gt;\"; \n echo \"&lt;br&gt;\"; \n } \n\n //This counts the number or results - and if there wasn't any it gives them a little message explaining that \n $anymatches=mysql_num_rows($data); \n if ($anymatches == 0) \n { \n echo \"Sorry, but we can not find an entry to match your query&lt;br&gt;&lt;br&gt;\"; \n } \n\n //And we remind them what they searched for \n echo \"&lt;b&gt;Searched For:&lt;/b&gt; \" .$find; \n } \n ?&gt;\n</code></pre>\n"},{"tags":["java","xml","query","relaxng","jing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":9465968,"title":"Querying a RelaxNG schema (xml syntax) in java, preferably using Jing","body":"<p>I am trying to find a way to query a RNG schema while avoiding reinvention of the wheel, in order to answer basic questions such as: what elements are valid children of an XML instance element, what can/must be it's attributes and so on.</p>\n\n<p>A post <a href=\"http://www.velocityreviews.com/forums/t170553-querying-schema-rng-files.html\" rel=\"nofollow\">here</a> raised my hopes of doing this with Jing/Trang, since I am already doing RNG validation with Jing, but after searching around I've found no source code examples which would confirm the claim and browsing API docs also did not help me much (which in turn also seems to be the only documentation bundled with Jing).</p>\n\n<p>I'd really like to avoid parsing schema into my own object model to do these queries and it also seems kinda redundant since I know Jing must also be doing it somewhere. The question is how to obtain the information I require from it.</p>\n\n<p>Is there another library I could use to query RNG schema from java code? Note that I'm not trying to validate instance files by using a schema, I am trying to query the schema itself.</p>\n"},{"tags":["sql","query","join","inner-join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12906243,"title":"Inefficient JOIN Method?","body":"<p>I'm trying to query two fairly large tables here to pull some results and having some trouble with effeciency. </p>\n\n<p><em>Note: I've only included relevant columns to make this not look so messy!</em></p>\n\n<p>TableA (Stock) has productID, ownerID, and count columns</p>\n\n<p>TableB (Owners) has ID, accountHolderID, and name columns</p>\n\n<p>What I'm trying to do is query TableA and where productID = X pull up Stock.productID, Stock.accountHolderID and Owners.name. The relation between these two tables is Stock.ownerID = Owners.ID so if the WHERE condition pulled say five productIDs then I'd want the name from TableB that matched up to the ownerID from TableA.</p>\n\n<p>The only unique ID in this situation is Owners.ID from TableB</p>\n\n<p>Just doing a basic SELECT query on TableA for those products takes 15 seconds however when I add an INNER JOIN to match things up to TableB the query takes significantly longer, upwards of 10 minutes. I'm guessing I've designed this query inefficiently. </p>\n\n<pre><code>SELECT\nOwners.name,\nStock.productID,\nStock.ownerID\nFROM Stock\nINNER JOIN \nOwners\nON Stock.ownerID = Owners.ID\nWHERE\nStock.productID = 42301679\n</code></pre>\n\n<p>How can I make this query more efficient?</p>\n\n<p>Would adding ORs to the WHERE condition allow me to pull multiple productIDs at once? </p>\n"},{"tags":["android","database","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12913894,"title":"Sqlite select statement not working","body":"<p>I was making a sample app where I had created a database for sqlite, I have also inserted values inside the table. But when I am using the select query, I am getting nullpointer exception.</p>\n\n<p>This is my class:</p>\n\n<pre><code>public class MainActivity extends Activity {\n\n    Button insert;\n    Button show;\n    EditText name;\n    EditText mobile;\n    SQLiteDatabase db;\n    String name_str;\n    String mob_str;\n\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.main);\n\n\n        name = (EditText)findViewById(R.id.name_editText);\n\n\n        insert = (Button) findViewById(R.id.insert_button);\n\n        insert.setOnClickListener(new OnClickListener() {\n\n            @Override\n            public void onClick(View v) {\n                //Toast.makeText(getApplicationContext(), \"Onclick works\", Toast.LENGTH_LONG).show();\n\n\n\n                name_str=name.getText().toString();\n                Toast.makeText(getApplicationContext(), name_str, Toast.LENGTH_LONG).show();\n\n                // create or open database file\n                db = openOrCreateDatabase(\"Test.db\" , SQLiteDatabase.CREATE_IF_NECESSARY,  \n                                                                                      null);\n                db.setVersion(1);\n               // db.setLocale(Locale.getDefault());\n                db.setLockingEnabled(true);\n\n                //System.out.println(\"Database Created\");\n\n             // creating table in database\n                db.execSQL(\"CREATE TABLE IF NOT EXISTS \"+\"contacts\"+\" \" +\n                                \"( id INTEGER PRIMARY KEY AUTOINCREMENT,\" +\n                                \"  name varchar, \" +\n                                \"  mobile varchar ); \");\n\n                db.execSQL(\"INSERT INTO contacts(name, mobile)VALUES ('Swift','9830098300');\");\n\n                db.execSQL(\"drop table contacts\");\n\n\n                //Database Exists check\n                File database=getApplicationContext().getDatabasePath(\"Test.db\");\n\n                if (!database.exists()) {\n                    // Database does not exist so copy it from assets here\n                    Log.i(\"Database\", \"Not Found\");\n                } else {\n                    Log.i(\"Database\", \"Found\");\n                }\n\n\n\n\n\n\n            }\n\n\n\n        });\n        show = (Button) findViewById(R.id.show_button);\n\n        show.setOnClickListener(new OnClickListener() {\n\n            @Override\n            public void onClick(View v) {\n//                //Toast.makeText(getApplicationContext(), \"Onclick works\", Toast.LENGTH_LONG).show();\n                Cursor c =db.rawQuery(\"SELECT COUNT() FROM sqlite_master WHERE name ='contacts';\",null);\n                if (c != null ) {\n                    if  (c.moveToFirst()) {\n                          do {\n        String firstName = c.getString(c.getColumnIndex(\"name\"));\n\n                          }while (c.moveToNext());\n                    }\n               }\n\n            }\n        });\n\n    }\n\n\n\n\n\n    @Override\n    public boolean onCreateOptionsMenu(Menu menu) {\n        getMenuInflater().inflate(R.menu.main, menu);\n        return true;\n    }\n\n\n\n\n\n}\n</code></pre>\n\n<p>This is the main.xml:</p>\n\n<pre><code>&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\" &gt;\n\n    &lt;TextView\n        android:id=\"@+id/name_textView\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignParentLeft=\"true\"\n        android:layout_alignParentTop=\"true\"\n        android:layout_marginTop=\"60dp\"\n        android:text=\"Name:\"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\" /&gt;\n\n    &lt;EditText\n        android:id=\"@+id/name_editText\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/name_textView\"\n        android:layout_alignBottom=\"@+id/name_textView\"\n        android:layout_marginLeft=\"14dp\"\n        android:layout_toRightOf=\"@+id/name_textView\"\n        android:ems=\"10\" &gt;\n\n        &lt;requestFocus /&gt;\n    &lt;/EditText&gt;\n\n    &lt;TextView\n        android:id=\"@+id/mobile_textView\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignParentLeft=\"true\"\n        android:layout_below=\"@+id/name_editText\"\n        android:layout_marginTop=\"53dp\"\n        android:text=\"Mobile: \"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\" /&gt;\n\n    &lt;EditText\n        android:id=\"@+id/mobile_editText\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/mobile_textView\"\n        android:layout_alignBottom=\"@+id/mobile_textView\"\n        android:layout_alignLeft=\"@+id/name_editText\"\n        android:ems=\"10\"\n        android:inputType=\"phone\" /&gt;\n\n    &lt;Button\n        android:id=\"@+id/insert_button\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignLeft=\"@+id/mobile_editText\"\n        android:layout_centerVertical=\"true\"\n        android:text=\"Insert\" /&gt;\n\n    &lt;Button\n        android:id=\"@+id/show_button\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/insert_button\"\n        android:layout_alignBottom=\"@+id/insert_button\"\n        android:layout_alignRight=\"@+id/mobile_editText\"\n        android:text=\"Show\" /&gt;\n\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>Logcat:</p>\n\n<pre><code>10-16 17:16:28.938: D/AndroidRuntime(413): Shutting down VM\n10-16 17:16:28.938: W/dalvikvm(413): threadid=1: thread exiting with uncaught exception (group=0x4001d800)\n10-16 17:16:28.958: E/AndroidRuntime(413): FATAL EXCEPTION: main\n10-16 17:16:28.958: E/AndroidRuntime(413): java.lang.NullPointerException\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.cyberswift.database.example.MainActivity$2.onClick(MainActivity.java:97)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.view.View.performClick(View.java:2408)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.view.View$PerformClick.run(View.java:8816)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Handler.handleCallback(Handler.java:587)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Handler.dispatchMessage(Handler.java:92)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Looper.loop(Looper.java:123)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.app.ActivityThread.main(ActivityThread.java:4627)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at java.lang.reflect.Method.invokeNative(Native Method)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at java.lang.reflect.Method.invoke(Method.java:521)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at dalvik.system.NativeStart.main(Native Method)\n10-16 17:16:30.998: I/Process(413): Sending signal. PID: 413 SIG: 9\n</code></pre>\n\n<p>Exactly where am I going wrong...............</p>\n"},{"tags":["mysql","performance","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12912890,"title":"Simple MySQL query with performance issues","body":"<p>I have the following simple MySQL query:</p>\n\n<pre><code>SELECT SQL_NO_CACHE mainID\nFROM tableName \nWHERE otherID3=19\nAND dateStartCol &gt;= '2012-08-01' \nAND dateStartCol &lt;= '2012-08-31';\n</code></pre>\n\n<p>When I run this it takes 0.29 seconds to bring back 36074 results. When I increase my date period to bring back more results (65703) it runs in 0.56. When I run other similar SQL queries on the same server but on different tables (some tables are larger) the results come back in approximately 0.01 seconds.</p>\n\n<p>Although 0.29 isn't slow - this is a basic part for a complex query and this timing means that it is not scalable.</p>\n\n<p>See below for the table definition and indexes.  </p>\n\n<p>I know it's not server load as I have the same issue on a development server which has very little usage.</p>\n\n<pre><code>+---------------------------+--------------+------+-----+---------+----------------+\n| Field                     | Type         | Null | Key | Default | Extra          |\n+---------------------------+--------------+------+-----+---------+----------------+\n| mainID                    | int(11)      | NO   | PRI | NULL    | auto_increment |\n| otherID1                  | int(11)      | NO   | MUL | NULL    |                |\n| otherID2                  | int(11)      | NO   | MUL | NULL    |                |\n| otherID3                  | int(11)      | NO   | MUL | NULL    |                |\n| keyword                   | varchar(200) | NO   | MUL | NULL    |                |\n| dateStartCol              | date         | NO   | MUL | NULL    |                |\n| timeStartCol              | time         | NO   | MUL | NULL    |                |\n| dateEndCol                | date         | NO   | MUL | NULL    |                |\n| timeEndCol                | time         | NO   | MUL | NULL    |                |\n| statusCode                | int(1)       | NO   | MUL | NULL    |                |\n| uRL                       | text         | NO   |     | NULL    |                |\n| hostname                  | varchar(200) | YES  | MUL | NULL    |                |\n| IPAddress                 | varchar(25)  | YES  |     | NULL    |                |\n| cookieVal                 | varchar(100) | NO   |     | NULL    |                |\n| keywordVal                | varchar(60)  | NO   |     | NULL    |                |\n| dateTimeCol               | datetime     | NO   | MUL | NULL    |                |\n+---------------------------+--------------+------+-----+---------+----------------+\n\n\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| Table              | Non_unique | Key_name                      | Seq_in_index | Column_name               | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| tableName          |          0 | PRIMARY                       |            1 | mainID                    | A         |      661990 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID1                  |            1 | otherID1                   | A         |      330995 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID2                  |            1 | otherID2                   | A         |          25 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID3                  |            1 | otherID3                   | A         |          48 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_dateStartCol              |            1 | dateStartCol               | A         |         187 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_timeStartCol              |            1 | timeStartCol               | A         |       73554 |     NULL | NULL   |      | BTREE      |         |\n|tableName          |          1 | idx_dateEndCol                 |            1 | dateEndCol                 | A         |         188 |     NULL | NULL   |      | BTREE      |         |\n|tableName          |          1 | idx_timeEndCol                 |            1 | timeEndCol                 | A         |       73554 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_keyword                   |            1 | keyword                    | A         |       82748 |     NULL | NULL   |      | BTREE      |         |\n| tableName           |          1 | idx_hostname                 |            1 | hostname                   | A         |        2955 |     NULL | NULL   | YES  | BTREE      |         |\n| tableName           |          1 | idx_dateTimeCol              |            1 | dateTimeCol                | A         |      220663 |     NULL | NULL   |      | BTREE      |         |\n| tableName           |          1 | idx_statusCode               |            1 | statusCode                 | A         |           2 |     NULL | NULL   |      | BTREE      |         |\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n</code></pre>\n\n<p>Explain Output:</p>\n\n<pre><code>+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n| id | select_type | table     | type  | possible_keys                    | key               | key_len | ref  | rows  | filtered | Extra       |\n+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n|  1 | SIMPLE      | tableName | range | idx_otherID3,idx_dateStartCol | idx_dateStartCol | 3       | NULL | 66875 |    75.00 | Using where |\n+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n</code></pre>\n"},{"tags":["query","syntax","sparql","dbpedia"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12913389,"title":"How would I query dbpedia for a list of programming languages?","body":"<p>I go to the <a href=\"http://dbpedia.org/sparql\" rel=\"nofollow\">dbPedia SPARQL Endpoint</a> and type:</p>\n\n<pre><code>select distinct ?Programming_language where {[] a ?Programming_language} LIMIT 100\n</code></pre>\n\n<p>But it just spits out a generic list of concepts like Animal, Book, Place.</p>\n\n<p>What would be the correct syntax for listing 100 programming languages?</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":46,"score":0,"question_id":12912461,"title":"sql - How can I extract all information through one statement from 3 tables?","body":"<p>I have 3 tables.</p>\n\n<p><strong>First one:</strong></p>\n\n<p>Two columns (<code>StoreID</code>, <code>Name</code>)</p>\n\n<p><strong>Second one:</strong></p>\n\n<p>Two columns (StoreID, <code>ItemID</code>)</p>\n\n<p><strong>Third one:</strong></p>\n\n<p>Three columns (ItemID, <code>Name</code>, <code>Price</code>)</p>\n\n<p>How can I write a single statement, which get <code>all StoreID</code> and <code>all names</code> and <code>all items for each StoreID</code>?</p>\n\n<p>Should I use Join or something?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12912139,"title":"Select from MySQL table","body":"<p>I have a table and I'm trying to retrieve any row which has a number in it </p>\n\n<p>For example this:</p>\n\n<pre><code>+----------+--------------+\n| Name     | age          | \n+----------+--------------+\n| name1    |      21      | \n| name2    |      22      | \n| name3    |      21      |\n+----------+--------------+\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>SELECT * FROM table WHERE 'age' = 21;\n</code></pre>\n\n<p>the message I get from the is </p>\n\n<pre><code>Empty set, 1 warning (0.00 sec)\n</code></pre>\n\n<p>I'm not to sure what I'm doing wrong?</p>\n"},{"tags":["sql","sql-server","query","select"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12911859,"title":"SQL Select part of string","body":"<p>I have a string that looks a bit like the following:</p>\n\n<blockquote>\n  <p>189 A 190 Merit 191 68.6</p>\n</blockquote>\n\n<p>Now I want the value that falls between <code>190</code> and <code>191</code> - <code>Merit</code>.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["php","mysql","sql","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12910885,"title":"Extract Unique Orders","body":"<p>Please help me to write a SQL query to extract unique orders from below tables.  To do that I Have prepared a SQL query. It’s working fine but in some place its returning some duplicate rows as some orders have more than one products. </p>\n\n<p><strong>For Example:</strong> </p>\n\n<p>Customer can buy “IPAD” in one order. However, if they purchase “Ipad” and “Android” as bundle they will receive 50% discount and they can save money. In this case, we will get two products under 1 order. However, customer will pay as one product(i.e $120). To allocate order properly, we have created an extra row for the extra product(if products  two). If bundle contain three products, it will create three rows in “product_orders” table respectively.</p>\n\n<p><strong>Example “product_orders”</strong> table for multiple products:</p>\n\n<pre><code>id orders_id product_id qty\n 1   3      2         1\n 2   2      1         1\n 3   3      3         1\n</code></pre>\n\n<p>Please check above example table, one order_id copied twice for the bundle order.\nIf we able to extract one order information, we will get the whole bundle information. So, we don’t need the extra row.</p>\n\n<p><strong>The Query I have applied:</strong></p>\n\n<pre><code>Select \n    orders.id, \n    orders.order_price, \n    orders.purchase_date,\n    customers.email, \n    product_orders.qty, \n    products.name \nfrom \n    orders \n    INNER JOIN product_orders on orders.id=product_orders.orders_id \n    INNER JOIN products on product_orders.product_id=products._id \n    INNER JOIN customers on orders.customer_id =customers.id\n</code></pre>\n\n<p><em><strong></em><code>Result of the above query:</code>**</strong></p>\n\n<pre><code>Id  order_price  purchase_date      email        qty         name \n3  20         12/6/2011     aa@gmail.com             1   Ipad\n\n3  20         12/6/2011     aa@gmail.com             1   Android\n1  40         10/5/2011     bb@gmail.com             2  Laser hair remover\n</code></pre>\n\n<p><strong>Required Result:</strong></p>\n\n<p>remove duplicate order ID</p>\n\n<pre><code>Id  order_price  purchase_date      email        qty         name \n    3  20         12/6/2011     aa@gmail.com             1   Ipad\n\n\n    1  40         10/5/2011     bb@gmail.com             2  Laser hair remover\n</code></pre>\n\n<p><strong>Table 1: orders</strong></p>\n\n<pre><code>id  customer_id order_price purchase_date\n1   1                   0.20    12/6/2011\n2   2                   0.20    12/6/2011\n3   1                   0.20    12/6/2011\n4   1                   0.20    12/6/2011\n5   1                   0.20    12/7/2011\n6   3                   199.00  12/7/2011\n7   4                   199.00  12/7/2011\n8   5                   199.00  12/7/2011\n9   6                   199.00  12/7/2011\n10  7                   199.00  12/7/2011\n</code></pre>\n\n<p><strong>Table 2 : customers</strong></p>\n\n<pre><code>id  email                   name\n1   aa@dealboard.com.au aa\n2   bb@dealboard.com.au bb\n3   cc@live.com.au          cc\n4   dd@acgglobal.com    dd\n5   ee.heinrich@det.nsw.edu.au  ee\n6   ff@optusnet.com.au  ff\n7   ssy@hotmail.com         ss\n</code></pre>\n\n<p><strong>table 3: products</strong></p>\n\n<pre><code>id  name\n1   A Home Portable Laser Hair Remover\n2   Ipad\n3   android\n4   Asus\n5   s\n6   10 inch Android\n7   A Fabric Steamer Cleaner\n8   A Magnetic Fly Screen Door\n9   pillopw\n10  LCD\n</code></pre>\n\n<p><strong>table 4: product_orders</strong></p>\n\n<pre><code>id orders_id product_id qty\n    1   1      1         1\n    2   3      3         1\n    3   3      4         1\n    4   4      1         1\n    5   4      2         1\n    6   6      1         1\n    7   7      1         1\n    8   4      2         1\n    9   4      3         1\n    10  10     1         1\n</code></pre>\n\n<p>Please help me to extract only 1 order from “product_orders” table and the query will omit other extra rows</p>\n"},{"tags":["css","query","html5boilerplate","breakpoint","min-width"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":134,"score":3,"question_id":12903150,"title":"Why min-width: 35em and not 480px or 30em?","body":"<p>In the latest version of h5bp, you guys are using min-width:35em for the first breaking point in your queries. I was curious as to why this number specifically? Is this based on the latest smartphone screen sizes or something? Typically its usually been 480px/30em for the first break point.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query","jsp","hosting","localhost"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12910000,"title":"mysql remote hosting","body":"<p>Hello I have hosted a small webpage (JSP+Mysql) on Eatj.com for trial offer of 15 days.My problem is that database connection on localhost is successful but after hosting my connection string is giving exception.\ncode:</p>\n\n<pre><code>try{\n  String connectionURL = \"jdbc:mysql://pulicipaddress/dbname\"; \n\n  Connection con= null; \n  Class.forName(\"com.mysql.jdbc.Driver\"); \n  con = DriverManager.getConnection(connectionURL, \"eatjid\", \"eatjpassword\");\n...\n</code></pre>\n\n<p>it says that my connection not defined.</p>\n"},{"tags":["c#","asp.net","sql","query","odbc"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1488,"score":2,"question_id":1535994,"title":"ASP.NET Query with parameters","body":"<p>Please help me, I don't know what can be wrong with the following code:</p>\n\n<pre><code>        OdbcConnection conn = new OdbcConnection(connString);\n        String query = \"INSERT INTO customer (custId, custName, custPass, \"+\n                       \"custEmail, custAddress, custAge) VALUES (\" +\n                       \"@ID, @Name, @Pass, @Email, @Address, @Age)\";\n\n        OdbcCommand exe = new OdbcCommand(query, conn);\n        exe.Parameters.Add(\"@ID\", OdbcType.UniqueIdentifier).Value = id;\n        exe.Parameters.Add(\"@Name\", OdbcType.VarChar).Value = name;\n        exe.Parameters.Add(\"@Pass\", OdbcType.VarChar).Value = pass;\n        exe.Parameters.Add(\"@Email\", OdbcType.VarChar).Value = email;\n        exe.Parameters.Add(\"@Address\", OdbcType.VarChar).Value = address;\n        exe.Parameters.Add(\"@Age\", OdbcType.Int).Value = age;\n        conn.Open();\n        exe.ExecuteNonQuery(); // ERROR [07002] [Microsoft][ODBC Microsoft Access Driver] Too few parameters. Expected 6.\n</code></pre>\n\n<p>This code throws me <code>Too few parameters.</code> error when I am trying to execute query. The database is fine, it works fine when I hardcode values into a query, instead of using parameters.</p>\n\n<p>Thank you.</p>\n"},{"tags":["php","mysql","query","query-optimization"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12910035,"title":"How to delete a column from a MySQL big table","body":"<p>I have a 250GB 500M rows MySQL table and would like to delete one of its columns. \nThe column is VARCHAR(255). I would like to perform this operation with as little as possible down-time. Thoughts:  </p>\n\n<ol>\n<li>Is there any configuration I can add that will help this operation?</li>\n<li>Would it be better to iterate in php before on each row and delete the value inside it?</li>\n<li>Would it require OPTIMIZE TABLE afterwards?</li>\n<li>What would be a reasonable time estimation for such a procedure?</li>\n</ol>\n"},{"tags":["mysql","query","variables","split"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12877234,"title":"Split table into new multiple tables with dynamic table name assignment","body":"<p>I've a \"<strong>TableOriginal</strong>\" that I want to \"split\" into multiple tables, each one with the <strong>name</strong> of the different values than can be found on \"<em>split</em>\" column in \"<strong>tableOriginal</strong>\". The name, therefore, must be dynamic (maybe formed by a variable that is the result of a previous query).</p>\n\n<p><strong>TableOriginal:</strong></p>\n\n<pre><code>+----+-------+-------+\n| id | split | value |\n+----+-------+-------+\n| 1  |   A   |  v1   |\n| 2  |   A   |  v2   |\n| 3  |   A   |  v3   |\n| 4  |   B   |  v4   |\n| 5  |   B   |  v5   |\n| 6  |   B   |  v6   |\n| 7  |   C   |  v7   |\n| 8  |   C   |  v8   |\n| 9  |   A   |  v9   |\n| 10 |   B   |  v10  |\n| 11 |   B   |  v11  |\n| 12 |   C   |  v12  |\n+----+-------+-------+\n</code></pre>\n\n<p><strong>TableSplit_A</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      1      |  v1   |\n| 2  |      2      |  v2   |\n| 3  |      3      |  v3   |\n| 4  |      9      |  v9   |\n+----+-------------+-------+\n</code></pre>\n\n<p><strong>TableSplit_B</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      4      |  v4   |\n| 2  |      5      |  v5   |\n| 3  |      6      |  v6   |\n| 4  |      10     |  v10  |\n| 5  |      11     |  v11  |\n+----+-------------+-------+\n</code></pre>\n\n<p><strong>TableSplit_C</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      7      |  v7   |\n| 2  |      8      |  v8   |\n| 3  |      12     |  v12  |\n+----+-------------+-------+\n</code></pre>\n\n<h1>SQLFiddle:</h1>\n\n<p><a href=\"http://sqlfiddle.com/#!2/61266\" rel=\"nofollow\"><strong>http://sqlfiddle.com/#!2/61266</strong></a></p>\n"},{"tags":["sql","query","join"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12908921,"title":"SQL join, getting multiple columns with same name","body":"<p>I have one table with a column <code>ID</code> and <code>SERVICE_TYPE_TEXT</code>, and another table with columns</p>\n\n<pre><code>ID, SERVICE_TYPE ... \n</code></pre>\n\n<p>and lots of other columns.</p>\n\n<p>The <code>SERVICE_TYPE</code> in the second table contains the <code>ID</code> from the first table. I want to query so I can get the <code>SERVICE_TYPE_TEXT</code> from the first table that matches the <code>ID</code> given in the second table.</p>\n\n<p>I've tried to join, and setting different names on <code>ID</code> with <code>AS</code>, but always at the end of the query result I get the original ID from the first table with column name <code>ID</code>, as well as the name I defined in the AS.</p>\n\n<p>Any suggestions on how I can get the ID from the first table to stay away ? :)</p>\n"},{"tags":["sql","query","select","null","record"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":782,"score":2,"question_id":8098795,"title":"Return a value if no record is found","body":"<p>I have this simple statement that works:</p>\n\n<pre><code>SELECT idnumber FROM dbo.database WHERE number = '9823474'\n</code></pre>\n\n<p>If the number does not exist anywhere in the table, it fails. I would like to add something to this statement that says:<br>\nIF NO RECORD IS FOUND RETURN NULL INSTEAD OF NO ROW.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["mysql","sql","query","max","composite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12908254,"title":"How to find max from a composite set of rows?","body":"<p>I have a table such as :</p>\n\n<pre><code>Year | Month\n------------\n2011    10   \n2011    11   \n2012    5   \n2012    6 \n</code></pre>\n\n<p>The query should return the latest \"Month\" for the latest \"year\". </p>\n\n<p>Currently I'm doing something like </p>\n\n<blockquote>\n  <p>Select MAX(\"Month\") from table where \"Year\" in (select MAX(\"Year\") from table)</p>\n</blockquote>\n\n<p>But I'm not satisfied with query. Can someone suggest a more compact and cleaner way? </p>\n"},{"tags":["sql","query","excel","parameters"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12082688,"title":"Excel QueryTable Parameters do not bind Sql Parameters","body":"<p>I'm new in Excel development and I have an issue that It's driving me crazy. I hope you can help me.\nLet me explain the situation, \nI'm trying to create a QueryTable to import data from SQL , but ... I get an error at the moment to refresh the QueryTable, \nthe error message indicates that I'm not passing values for required parameters. ( It works hard coded :[ )</p>\n\n<p>After many hours of investigation, I wasn't able to find a solution or an example to guide me...  And here I am :|\nI don't know what I'm doing wrong,  Here is some code </p>\n\n<pre><code>foreach (Range row in main.Rows)\n    {\n            //row.Clear();\n            rowID = row.Row;\n            if (string.IsNullOrEmpty(getAccounts(rowID, columnID)) )  \n                continue;\n\n            /*  string connectionString = // \\\"\n                    string.Format(\"OLEDB;Provider=SQLOLEDB;Data Source={0};Initial Catalog={1};User ID={2};Password={3}\",\n             */      \n\n            //string sql = \"EXECUTE [Funciones].[Cuenta_Saldo_Anho] ?,?\";\n            //if (!string.IsNullOrEmpty(txtTipoSaldo.Text)) sql +=  \",?\";\n\n           string sql = \"{CALL [Funciones].[Cuenta_Saldo_Anho] (?, ?\";\n           sql += (!string.IsNullOrEmpty(txtTipoSaldo.Text))? \"\" : \", ?\" + \")}\"; // optional parameter\n\n           var qt = wSheet.QueryTables.Add( connectionString, row.Cells , sql);\n           qt.CommandType = XlCmdType.xlCmdSql;\n\n           var ctas = qt.Parameters.Add(\"@ctas\", XlParameterDataType.xlParamTypeLongVarChar);\n           //ctas.SetParam(XlParameterType.xlConstant, cuentas);\n           ctas.SetParam(XlParameterType.xlRange, wSheet.Cells[rowID, columnID]));\n           ctas.RefreshOnChange = true;\n\n           qt.Parameters.Add(\"@anho\", XlParameterDataType.xlParamTypeInteger)\n .SetParam(XlParameterType.xlConstant, Int32.Parse(anho));\n\n           qt.Parameters.Add(\"@tipoSaldo\", XlParameterDataType.xlParamTypeVarChar)\n .SetParam(XlParameterType.xlConstant, txtTipoSaldo.Text);\n\n            //qt.BackgroundQuery = true;\n            qt.FieldNames = false;\n            qt.AdjustColumnWidth = false;\n            qt.RefreshOnFileOpen = false;\n            qt.Refresh();\n      }\n</code></pre>\n\n<p>Any help is welcome.  Thanks.</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12907178,"title":"Join Found and Not Fund records on same DataResult","body":"<p>I have a single table with Id, the thing is that i need to provide N number of Ids (using  WHERE id IN (1,5,101)) but i need to get the same number of records back (if i send 100 ids, i need a DataSet with 100 rows ..) even if Id doesn't exist on this table.</p>\n\n<p>I'm using SQLite so RIGHT JOIN is not an option.</p>\n\n<p>Here is some sample of what i have but cant make it work :S ..</p>\n\n<pre><code>SELECT * FROM (\n SELECT r.report_id, r.batch_name, tr.report_id id, tr.batch_name bn\n FROM reports tr\n LEFT OUTER JOIN (  SELECT report_id, batch_name FROM reports\n                    WHERE batch_name IN (\"L6964498\",\"AAAAAA\")) r on r.report_id = tr.report_id) as v \n LEFT JOIN reports ON v.id = reports.report_id\n</code></pre>\n\n<p>Thanks in advance ...</p>\n"},{"tags":["html","wordpress","query","slider","custom-post-type"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12907076,"title":"How do I use WP_Query for a custom post type of a specific taxonomy?","body":"<p>I have a slide custom post type and I need to be able to create a query for a selected tag of this custom post type so I can create a group of these custom slider post types to show up in the slider.  So far I can't figure it out.</p>\n"},{"tags":["mysql","database","query","join","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12906215,"title":"Mysql LEFT Join query only returns one row when adding Count() mysql function","body":"<p>I have this mysql query (evolving <strong>two tables</strong>: <code>Users</code> and <code>Files</code>) that's giving me headaches:</p>\n\n<pre><code>SELECT Users.GUID, Users.Name, Users.CreationDate, Files.Date, \n    Count(Files.GUID) As FilesCount\nFROM Users\n\n    LEFT JOIN Files ON Users.GUID = Files.UserGUID\n\nWHERE Users.Group =  '1'\n</code></pre>\n\n<p>When I execute it, it <strong>always</strong> return 1 row (which is not what I want). But if I remove this:</p>\n\n<pre><code>Count(Files.Date) As FilesCount\n</code></pre>\n\n<p>It correctly return all the rows that I expect.</p>\n\n<p><strong>I basically need to get the number of files that belongs to a user</strong> (along with the user info)</p>\n\n<p><strong>My question is:</strong> How can I fix this &amp; make the mysql query return the user basic info along with the files count?</p>\n\n<p>BTW, I'm using CodeIgniter 2 with PHP 5 (although I don't think it matters here...)</p>\n"},{"tags":["sql-server","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12904498,"title":"Join type to use for reading from tables that contain templates and different numbers of items?","body":"<p>I have two tables, one that contains questions (that are considered 'templates'):</p>\n\n<pre><code>|QuestionID|QuestionText      |\n|----------|------------------|\n|1         |What is your name?|\n|2         |What is your age? |\n|-----------------------------|\n</code></pre>\n\n<p>And one that contains answers to those questions, keyed by a separate Customer ID value:</p>\n\n<pre><code>|CustID    |QuestionID|Answer |\n|----------|------------------|\n|1000      |1         |John   |\n|1000      |2         |22     |\n|2000      |1         |Alice  |\n|-----------------------------|\n</code></pre>\n\n<p>As you can see, Customer #1000 answered questions 1 and 2, and customer #2000 answered only question 1.</p>\n\n<p>I need to load these into a grid on a web page by customer, and I thought I'd just do a left outer join between the template and answer tables to get something like this:</p>\n\n<pre><code>|CustID    |QuestionID|Answer |\n|----------|------------------|\n|2000      |1         |Alice  |\n|2000      |2         |&lt;null&gt; |\n|-----------------------------|\n</code></pre>\n\n<p>So in this case, cust #2000 would come back with the <code>Answer</code> column for question #2 as null and the application would know that it needs to be answered. This is an example of the SQL I tried but no matter how many combinations of <code>OUTER</code> and <code>LEFT</code> and so on I use for the <code>JOIN</code>, I just can't get this to work with a single query:</p>\n\n<pre><code>select \n    q.QuestionID,\n    q.QuestionText,\n    a.CustID,\n    a.Answer,\nfrom \n    SurveyAnswers a  \n        full outer join SurveyQuestions q\n        on a.QuestionID = q.QuestionID\n    where \n        a.CustID = @CustomerID\n</code></pre>\n\n<p>Basically I need <em>all</em> the records in the <code>SurveyQuestions</code> table, and the value of the <code>Answer</code> column from any records in <code>SurveyAnswers</code> that match the CustomerID.</p>\n\n<p>Instead I just get the one record in <code>SurveyAnswers</code> that has an answer, and therefore is a match (I guess?) in <code>SurveyQuestions</code>. My SQL-fu is not strong.</p>\n\n<p>I also tried <code>UNION</code> and friends, but the two tables have different structures so that didn't work too well.</p>\n\n<p>I could of course pull the questions and answers separately and do the 'coalescing' in my C# code but I wanted to see if I could do it directly from the stored procedure. Thanks!</p>\n"},{"tags":["php","mysql","query","excel","format"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":89,"score":0,"question_id":12845991,"title":"How to format a CSV file using PHP and MYSQL","body":"<p>Currently I am able to query a MYSQL database using PHP and my data is imported into a CSV with no problems. However, I need to take the column data on the top row, and put it in rows on the left side instead and i need my data under each column to correlate with the correct row. So basically, I need PHP to transpose data in excel exactly like the transpose tool in excel.</p>\n\n<p><strong>Here is my current code:</strong> </p>\n\n<pre><code>ExportMysqlToCsv($tablename);\n\nfunction exportMysqlToCsv($tablename,$filename = 'Results.csv')\n{\n    $csv_terminated = \"\\n\";\n    $csv_separator = \",\";\n    $csv_enclosed = '\"';\n    $csv_escaped = \"\\\\\";\n    $sql_query = \"select * from $tablename where id=2\";\n\n    // Gets the data from the database\n    $result = mysql_query($sql_query);\n    $fields_cnt = mysql_num_fields($result);\n\n    $schema_insert = '';\n\n    for ($i = 0; $i &lt; $fields_cnt; $i++)\n    {\n        $l = $csv_enclosed . str_replace($csv_enclosed, $csv_escaped . $csv_enclosed,\n            stripslashes(mysql_field_name($result, $i))) . $csv_enclosed;\n        $schema_insert .= $l;\n        $schema_insert .= $csv_separator;\n    } // end for\n\n    $out = trim(substr($schema_insert, 0, -1));\n    $out .= $csv_terminated;\n\n    // Format the data\n    while ($row = mysql_fetch_array($result))\n    {\n        $schema_insert = '';\n        for ($j = 0; $j &lt; $fields_cnt; $j++)\n        {\n            if ($row[$j] == '0' || $row[$j] != '')\n            {\n\n                if ($csv_enclosed == '')\n                {\n                    $schema_insert .= $row[$j];\n                } else\n                {\n                    $schema_insert .= $csv_enclosed . \n                    str_replace($csv_enclosed, $csv_escaped . $csv_enclosed, $row[$j]) . $csv_enclosed;\n                }\n            } else\n            {\n                $schema_insert .= '';\n            }\n\n            if ($j &lt; $fields_cnt - 1)\n            {\n                $schema_insert .= $csv_separator;\n            }\n        } // end for\n\n        $out .= $schema_insert;\n        $out .= $csv_terminated;\n    } // end while\n\n\n    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n    header(\"Content-Length: \" . strlen($out));\n\n // Output to browser with appropriate mime type, you choose ;)\n    header(\"Content-type: text/x-csv\");\n    header(\"Content-type: text/csv\");\n    header(\"Content-type: application/csv\");\n    header(\"Content-Disposition: attachment; filename=$filename\");\n    echo $out;\n    exit;\n}\n</code></pre>\n"},{"tags":["sql","query","sql-server-2000"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12903154,"title":"SQL Query to convert columns to rows","body":"<p>I have a table say Timesheet, which is having one week hour entry stored as a row. Eg:</p>\n\n<pre><code>ID  Start Date  Sun  Mon  Tue  Wed  Thu  Fri  Sat\n-------------------------------------------------\n1   14-Oct-2012  0    1    1    2    3    5    0\n</code></pre>\n\n<p>The start date is always Sunday's date.\nI need to export this data into multiple rows, one row for each date, based on input criteria.</p>\n\n<p>For example, if the input criteria is: Date is between 15-Oct-2012 to 17-Oct-2012, my output should be something like:</p>\n\n<pre><code>Date   Hours\n------------\n15-Oct   1\n16-Oct   1\n17-Oct   2\n</code></pre>\n\n<p>I am using SQL Server 2000, please suggest me a way.</p>\n"},{"tags":["query","sparql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12902596,"title":"SparQL query displaying results","body":"<p>i want to display the names (?m), ordered by their overall scores. Displaying the names doesn't work. Any suggestions? </p>\n\n<pre><code> SELECT ?t ?o\n    {\n    ?t ?p ?o.\n     FILTER regex(?t, \"^http://..t/semweb/recourse/university/\"). \n     FILTER regex(?p, \"^http://../semweb/ontology/overall_score\").\n     FILTER regex(?m, \"^http://../semweb/ontology/name\")\n    }\n    ORDER BY DESC(?o)\n    LIMIT 1000\n</code></pre>\n"},{"tags":["sql","query","select","join","merge"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12901930,"title":"Merge / Join SQL Select Queries","body":"<p>I am struggling  with combining the below Select Statments, I know I could cheat and add some fake columns in and then use Union, but I want to do this correctly. \nOnce I have them joined, I will be putting the Statment in to a XML file for use with Word and CRM4.</p>\n\n<pre><code>SELECT BILLTO_NAME, \n       BILLTO_LINE1, \n       BILLTO_LINE2, \n       BILLTO_LINE3, \n       BILLTO_CITY, \n       BILLTO_COUNTRY, \n       BILLTO_POSTALCODE, \n       ORDERNUMBER, \n       REQUESTDELIVERYBY, \n       MODIFIEDON, \n       SHIPTO_NAME, \n       SHIPTO_LINE1, \n       SHIPTO_LINE2, \n       SHIPTO_LINE3, \n       SHIPTO_CITY, \n       SHIPTO_STATEORPROVINCE, \n       SHIPTO_COUNTRY, \n       SHIPTO_POSTALCODE, \n       CREATEDBY \nFROM   SALESORDERBASE \n\n\n\nSELECT QUANTITY, \n       DESCRIPTION \nFROM   SALESORDERDETAILBASE \n\nSELECT NEW_ORDERNOTES, \n       NEW_NOTES \nFROM   SALESORDEREXTENSIONBASE \n</code></pre>\n\n<p>They all have the common column of SalesOrderID, which I need to add in somewhere as well.</p>\n"},{"tags":["sql-server","query","coldfusion","user-agent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12901883,"title":"Filter browser information from stored useragent data in MS SQL database","body":"<p>I have stored visitors' <code>user_agent</code> info in my MS-SQL database. Each row has this regular format:</p>\n\n<p><code>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; F-6.0SP2-20041109; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 1.1.4322; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; AskTbORJ/5.14.1.20007)</code> </p>\n\n<p>Is it possible to filter and display browser information? Something like if string contains <code>%MSIE 8.0%</code> then output as IE8, if it contains <code>%Firefox%</code> then output as Firefox and etc.</p>\n\n<p>I have searched everywhere and I can't find any help.</p>\n"},{"tags":["mysql","sql","database","query","database-design"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12900677,"title":"Fundamental database design scenario","body":"<p><strong>Problem definition:</strong> a company wants to measure customers satisfaction of their products by asking some questions. company's prducts data stores in \"products\" table, customers data of each product stores in \"customers\" table and questions of each product stores in questions table. As simple as below:</p>\n\n<blockquote>\n  <p>products: [ id, name ]</p>\n  \n  <p>customers: [ id, product_id(fk), name ]</p>\n  \n  <p>questions: [ id, product_id(fk), text ]</p>\n</blockquote>\n\n<p>the question is, how can we design a table to store answers of each customer by considering that each customer can only answer its product's question. For example, if your answer is something like this:</p>\n\n<blockquote>\n  <p>customer_answer:[ id, customer_id(fk), question_id(fk), answer ]</p>\n</blockquote>\n\n<p>then its wrong because if our table's sample data is like the following:</p>\n\n<blockquote>\n  <p>products: [ 1, \"Chair\" ], [ 2, \"Table\" ]</p>\n  \n  <p>customers:[ 1, 1, \"Anthony Quinn\" ], [ 2, 2, \"Marilyn Monroe\" ]</p>\n  \n  <p>question: [ 1, 1, \"Any suggestion for this product ?\" ], [ 2, 1, \"How\n  do you estimate this chair ?\" ]</p>\n</blockquote>\n\n<p>then there <strong>might be</strong> a possible row with below data:</p>\n\n<blockquote>\n  <p>customer_answer: [ 2, 1, 'No, thanks' ]</p>\n</blockquote>\n\n<p>that is wrong, because the customer with id #2 don't have the product_id #1, so it can be wrong table for this problem.</p>\n\n<p>What can we do in such situations ? </p>\n\n<p>it doesn't matter but BTW I'm using mysql for solving this problem.</p>\n"},{"tags":["php","mysql","query","transactions","oscommerce"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12899666,"title":"Duplicate ID being sent to the payment processor","body":"<p>Here is the scenario. This table Orders has an auto_increment column called orders_id. The table uses InnoDB storage engine. (This is not about inserting new records in the Orders table, its about how to avoid sending duplicate IDs to the processor)</p>\n\n<pre><code>orders_id       cust_id       name       address \n100              55           abc        123 street    \n101              12           def        456 street   \n</code></pre>\n\n<p>For the next order, I calculate the next available Orders_id like so</p>\n\n<pre><code>$new_order_id_query = \"SHOW TABLE STATUS LIKE ORDERS\";\n$result = tep_db_query($new_order_id_query);\n$row = tep_db_fetch_array($result);\n$new_order_id = $row['Auto_increment'];\n</code></pre>\n\n<p>Then I collect other information like name, address, items_ordered... and send it to the payment processor like this</p>\n\n<pre><code>102              44           xyz         44 Street\n</code></pre>\n\n<p>The problem is <strong>only</strong> sometimes when there are two or more orders at exactly the same time, I end up sending <strong>two orders with the same orders_id</strong> to the payment processor.</p>\n\n<p>The question is how can I make sure that I am not sending a duplicate Orders_id to the Payment Processor?</p>\n\n<p>I have been suggested to use last_insert_id() which may be right or wrong but I dont know how I can implement it. </p>\n\n<p>I read about Locking Tables - Is that a good idea for a Transaction Environment and InnoDB? If so how can I implement it?</p>\n"},{"tags":["sql","sql-server","query","nhibernate"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":79,"score":4,"question_id":12897943,"title":"Select every nth row with NHibernate","body":"<p>How would you implement a query that selects every nth row, with NHibernate QueryOver, HQL or Criteria?</p>\n\n<p>Currently I use the following T-SQL query:</p>\n\n<pre><code>SELECT * FROM (\n    SELECT *, ROW_NUMBER() OVER (ORDER BY Id) AS [Row]\n    FROM [TABLE_NAME]\n) x WHERE (x.[Row] % 100) = 0\n</code></pre>\n\n<p>(Thanks to <a href=\"http://stackoverflow.com/questions/4208366/linq-to-sql-every-nth-row-from-table\">Marc Gravell</a>)</p>\n"},{"tags":["sql","query","db2","catalog"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12888463,"title":"How to find DB2 tables that do not exist","body":"<p>I have a list of tables, and I want to check which ones do not currently exist in the target database, I can't figure out a query to return only the tables from the list that do not exist? I am running DB2 9.7.</p>\n"},{"tags":["jquery","string","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":80,"score":-1,"question_id":12842146,"title":"How to filter the string data using jQuery","body":"<p>I have a data in a string which I need to further filter the data save it in another string  variable.using jQuery.</p>\n\n<p>For example, I have</p>\n\n<pre><code> var str= 'a=\"apple\",a=\"ajax\",b=\"boy\",b=\"bird\",b=\"ball\".........';\n</code></pre>\n\n<p>rom this I want data where a=\" \", so apple,ajaxneed to be saved</p>\n\n<p>The following data is returned from web service as string format:</p>\n\n<blockquote>\n  <p>&lt;?xml\n  version=\"1.0\" encoding=\"utf-16\"?&gt;&lt;TermStore&gt;&lt;T\n  a9=\"5af46de3-630b-4cd9-aff3-4d1fbb95333c\" a21=\"false\"\n  a61=\"0\"&gt;&lt;LS&gt;&lt;TL a32=\"SharePoint\" a31=\"true\" /&gt;&lt;TL\n  a32=\"MOSS\" a31=\"false\" /&gt;&lt;TL a32=\"SharePoint 2007\" a31=\"false\"\n  /&gt;&lt;TL a32=\"SharePoint 2010\" a31=\"false\" /&gt;&lt;TL\n  a32=\"SharePoint 2013\" a31=\"false\" /&gt;&lt;TL a32=\"SharePoint Admin\"\n  a31=\"false\" /&gt;&lt;TL a32=\"SharePoint Designer\" a31=\"false\"\n  /&gt;&lt;TL a32=\"SharePoint Developer\" a31=\"false\" /&gt;&lt;TL\n  a32=\"SharePoint Infopath\" a31=\"false\" /&gt;&lt;TL a32=\"WSS\"\n  a31=\"false\" /&gt;&lt;/LS&gt;&lt;DS&gt;&lt;TD a11=\"It is an extensible\n  web based Platfrom\" /&gt;&lt;/DS&gt;&lt;TMS&gt;&lt;TM\n  a24=\"f03e532e-6e71-48c4-b499-c93efc7a4f7b\" a12=\"Microsoft\" a40=\"\"\n  a17=\"true\"\n  /&gt;&lt;/TMS&gt;&lt;/T&gt;&lt;/TermStore&gt;`</p>\n</blockquote>\n\n<p>from this I need to filter only <code>a32=\"\"</code>, values and store it in different string.</p>\n"},{"tags":["query","twitter-bootstrap","media","tablet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12860258,"title":"Twitter Bootstrap 800px tablet media query issue?","body":"<p>I'm currently building a site with bootstraps responsive layout which I have working fine in my browser but for some reason when I view the same site on my Nexus 7 tablet (Screen 1200 x 800) in portrait format the site renders with the media query @media (max-width: 767px) instead of @media (min-width: 768px) and (max-width: 979px).</p>\n\n<p>Interestingly I checked this out on bootstraps [example sites][1] and exactly the same thing happens even though the screen size is big enough for the @media (min-width: 768px) and (max-width: 979px) media query.  The correct query is loaded when the tablet is in landscape format.</p>\n\n<p>Here's bootstraps break points.</p>\n\n<pre><code>/* Large desktop */\n@media (min-width: 1200px) { ... }\n\n/* Portrait tablet to landscape and desktop */\n@media (min-width: 768px) and (max-width: 979px) { ... }\n\n/* Landscape phone to portrait tablet */\n@media (max-width: 767px) { ... }\n\n/* Landscape phones and down */\n@media (max-width: 480px) { ... }\n</code></pre>\n\n<p>Is there anything I can do to make sure the correct media query is picked up by the tablet?</p>\n"},{"tags":["c#","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12897913,"title":"C# get specific database using GetScheme","body":"<p>I am trying to figure out how I can only list specific databases in my combo box for databases.  I have several database that all contain  _Logging.  I just want the logging ones to show up in the combo box.  How do I accomplish this?  After the getScheme is called, do I need to call another query to do something like '%Logging%' query or something like that?</p>\n\n<pre><code> var databases = sqlConnection1.GetSchema(\"Databases\");\n\n            foreach (DataRow database1 in databases.Rows)\n            {\n\n                String dbName = database1.Field&lt;String&gt;(\"database_name\");\n\n                Console.WriteLine(dbName);\n\n                cmbDatabaseList.Items.Add(dbName);\n\n            }\n</code></pre>\n"},{"tags":["mysql","query","stored-procedures","plsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12895082,"title":"Why stored procedure is not giving output in one string and the stored procedure executed on MySql 6.0 gives error on MySql 5.0","body":"<p>I have following table structure</p>\n\n<pre><code>id     |      Name     | senior id\n\n1      |   superadmin  |  -1\n2      |   abc         |   1     \n3      |   xyz         |   1\n4      |   pqr         |   2   \n5      |   vwx         |   3\n6      |   stu         |   3\n7      |   efg         |   4\n8      |   ijk         |   3\n9      |   nop         |   3\n10     |   rst         |   3\n11     |   uvw         |   9\n</code></pre>\n\n<p>Here I Wrote a stored procedure which takes id as a input and will return a string of concatanated names seperated by '/' from the name associated with id to the name whose seniorid is -1.</p>\n\n<p>for example if I pass the id as 10 to SP I will expect the return string as \n<code>rst/xyz/superadmin/</code></p>\n\n<p>Here is the stored procedure that I have written</p>\n\n<pre><code>DELIMITER $$;\n\nDROP PROCEDURE IF EXISTS `mydb`.`get_list_up_to_senior`$$\n\nCREATE DEFINER=`root`@`localhost` PROCEDURE `get_list_up_to_senior`(id int (8))\n\nBEGIN\nDECLARE strsenior VARCHAR(250);\nDECLARE strseniorlist VARCHAR(250);\nDECLARE temp int(8);\nSET strsenior =  '';\nSET strseniorlist = '';\nSET temp = id;\nWHILE temp  != -1 DO\n   SET  strsenior = (SELECT name FROM mydb.tblname WHERE id = temp limit 1);\n   SET  temp = (SELECT seniorid FROM mydb.tblname WHERE id = temp limit 1);\n   SET  strseniorlist = CONCAT(strseniorlist,strsenior,'/');\nEND WHILE;\n\nSELECT strseniorlist;\nEND$$\n\nDELIMITER ;$$\n</code></pre>\n\n<p>When I compiles this SP I get compiles with no error. But when I execute this SP; its get executed perfectly and returns</p>\n\n<pre><code>strseniorlist\nsuperadmin/\n</code></pre>\n\n<p>1)What is wrong in my SP so that I am not getting desired output.</p>\n\n<p>My database version is MySQL 6.0 and I am using Sqlyog to execute above SP.</p>\n\n<p>2)When I execute the above SP on MySql 5.0 Its not get created and gives following errors</p>\n\n<pre><code>ERROR :\n\n(0 row(s) affected)\n(0 ms taken)\n\nError Code : 1064\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PROCEDURE `get_list_up_to_senior`(id int (8))\n\nBEGIN\nDECLARE strsenior VA' at line 1\n(16 ms taken)\n</code></pre>\n\n<p>Please guide me friends in this to solve the problems \nThank You!</p>\n"},{"tags":["sql","oracle","query","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":11196744,"title":"Get a certain number of contiguous rows","body":"<p>I've got a school project, kind of huge, and only a few days left, so here is one problem I'm stuck on, hope you can help.<br>\nI've got this table: </p>\n\n<pre><code>places(id, otherInfo)\n</code></pre>\n\n<p>Simple enough, well I need to make a SQL query or PL/SQL function to retrieve a certain number of contiguous rows. For instance if I call the function using <code>getContiguousPlaces(3);</code> On the table which has the rows:</p>\n\n<pre><code>ID\n1\n4\n5\n6\n18\n19\n</code></pre>\n\n<p>I want to get rows with <code>ID</code> 4, 5 and 6.</p>\n\n<p>How could I do that?</p>\n"},{"tags":["mysql","sql","query","hsqldb","dialect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12895425,"title":"How to deal with union/order by differences between HSQLDB and MySQL?","body":"<p>I am currently using hsqldb for testing and mysql for production. This combination has worked great for me on every recent project, but I've come across a situation where HSQLDB's syntax/dialect is different from MySQL, and I'm not really sure what the best strategy is to overcome it.</p>\n\n<p>In mysql, you can write a union query like this:</p>\n\n<pre><code>select ...\nunion\nselect ...\norder by created_on desc\nlimit 20 offset 0\n</code></pre>\n\n<p>However, in HSQLDB, it complains that <code>order by</code> clause has an error.</p>\n\n<p>Is there any way I can write the query so that both databases like the syntax?</p>\n"},{"tags":["query","postgresql","where-in"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12891971,"title":"PostgreSQL: WHERE IN and NOT WHERE IN","body":"<p>I have two tables <code>A</code> and <code>B</code>, <code>A</code> referred to <code>B</code> by field <code>A.id_b B.id</code>, so that any <code>id_b</code> value present in <code>B.id</code>.</p>\n\n<p>I have three queries:\nFirst one:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\nWHERE b.id NOT IN (\n    SELECT a.id_b\n    FROM A a)\n</code></pre>\n\n<p>It gives me <code>0</code>;</p>\n\n<p>Second one, difference only in <code>NOT</code>:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\nWHERE b.id IN (\n    SELECT a.id_b\n    FROM A a)\n</code></pre>\n\n<p>This query gives me: <code>1899</code></p>\n\n<p>Third one:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\n</code></pre>\n\n<p>And this query gives me <code>3599</code></p>\n\n<p>SAME result in:</p>\n\n<pre><code>SELECT a.id_b\nFROM A a\n</code></pre>\n\n<p>guaranty me spliting <code>B.id</code> on two sets, and count of elements in both sets must much total elements count, but I have: <strong>1899 + 0 != 3599</strong>.</p>\n\n<p>How that could be?</p>\n"},{"tags":["php","mysql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12893141,"title":"query mysql php","body":"<p>I'm trying to <code>select hora from entradas where data ='some date';</code>.</p>\n\n<p><strong>table <code>entradas</code></strong></p>\n\n<pre>\n+------------+----------+\n| data       | hora     |\n+------------+----------+\n| 2012-09-27 | 07:59:11 |\n| 2012-09-27 | 16:03:27 |\n| 2012-09-28 | 16:03:35 |\n| 2012-09-29 | 09:29:16 |\n| 2012-09-29 | 09:43:05 |\n| 2012-09-29 | 09:43:14 |\n| 2012-10-01 | 08:03:10 |\n+------------+----------+\n</pre>\n\n<p>I can do it in mysql:</p>\n\n<pre>\n+----------+\n| hora     |\n+----------+\n| 09:29:16 |\n| 09:43:05 |\n| 09:43:14 |\n+----------+\n</pre>\n\n<p>but when I try it in PHP:</p>\n\n<pre><code>$consulta_data = mysql_query(\"\n  select hora from entradas where data = '2012-09-29';\n\") or die(mysql_error());\n\nwhile($row = mysql_fetch_array($consulta_data))\n{\n  echo $row[0];\n}\n</code></pre>\n\n<p>the 3 rows turn in to one and give me the result <code>09:29:1609:43:0509:43:14</code>.</p>\n\n<p>How do I output the resultset as a table in HTML, as below:</p>\n\n<pre>\nrow[0]=09:29:16\nrow[1]=09:43:05\nrow[2]=09:43:14\n</pre>\n"},{"tags":["mysql","sql","query","distinct"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12188027,"title":"MySQL SELECT DISTINCT multiple columns","body":"<p>Let's say I have columns <code>a, b c, d</code> in a table in a MySQL database. What I'm trying to do is to select the distinct values of ALL of these 4 columns in my table (only the distinct values). I tried stuff like:</p>\n\n<pre><code>SELECT DISTINCT a,b,c,d FROM my_table;\nSELECT DISTINCT a,b,c,d FROM my_table GROUP BY a,b,c,d;\n</code></pre>\n\n<p>None of those worked. Can anybody help out here?</p>\n\n<p>Thank you</p>\n\n<p><strong>NOTE</strong> I want the distinct values of the columns <code>a, b, c d</code> separately. Not the distinct combination of values</p>\n"},{"tags":["mysql","query","insert","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12528140,"title":"Reducing time taken to execute mysql query","body":"<p>I have two databases with three similar tables(mdl_user, mdl_course and mdl_course_enrol).</p>\n\n<p>The id values for users and courses in mdl_user and mdl_course are different in both the databases. Both values are referred by the third table, namely mdl_course_enrol. In database 1 the table is empty and in database 2 (nlbdb1_9), the table is filled. I am trying to execute a query such that the correct values get inputted in mdl_course_enrol. Following is my query:-</p>\n\n<pre><code>Insert into mdl_course_enrol \n(userid, courseid, registrationdate, expirydate, status, startdate, enddate, roleassignmentid)\nSelect u1.id, c1.id, t2.registrationdate, t2.expirydate, t2.status, t2.startdate, t2.enddate, t2.roleassignmentid\nfrom \nnlbdb1_9.mdl_course_enrol as t2, mdl_user as u1, mdl_course as c1\nwhere \nt2.userid=(Select u1.id from nlbdb1_9.mdl_user as u2 where t2.userid=u2.id and BINARY u2.email=BINARY u1.email)\nand\nt2.courseid=(Select c1.id from nlbdb1_9.mdl_course as c2 where t2.courseid=c2.id and BINARY c2.fullname = BINARY c1.fullname);\n</code></pre>\n\n<p>Following are the table structures:-</p>\n\n<pre><code>CREATE TABLE `mdl_course_enrol` (\n  `id` bigint(10) unsigned NOT NULL AUTO_INCREMENT,\n  `userid` bigint(10) unsigned NOT NULL,\n  `courseid` bigint(10) unsigned NOT NULL,\n  `registrationdate` bigint(10) unsigned NOT NULL,\n  `expirydate` bigint(10) unsigned NOT NULL,\n  `status` varchar(32) NOT NULL DEFAULT 'Not Attempted',\n  `startdate` bigint(10) NOT NULL,\n  `enddate` bigint(10) NOT NULL,\n  `roleassignmentid` bigint(10) unsigned NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=MyISAM AUTO_INCREMENT=14962 DEFAULT CHARSET=utf8;\n\n\nCREATE TABLE `mdl_course` (\n  `id` bigint(10) NOT NULL AUTO_INCREMENT,\n  `category` bigint(10) NOT NULL DEFAULT '0',\n  `sortorder` bigint(10) NOT NULL DEFAULT '0',\n  `fullname` varchar(254) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `shortname` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `idnumber` varchar(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `summary` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `summaryformat` tinyint(2) NOT NULL DEFAULT '0',\n  `format` varchar(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT 'topics',\n  `showgrades` tinyint(2) NOT NULL DEFAULT '1',\n  `sectioncache` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `modinfo` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `newsitems` mediumint(5) NOT NULL DEFAULT '1',\n  `startdate` bigint(10) NOT NULL DEFAULT '0',\n  `numsections` mediumint(5) NOT NULL DEFAULT '1',\n  `marker` bigint(10) NOT NULL DEFAULT '0',\n  `maxbytes` bigint(10) NOT NULL DEFAULT '0',\n  `legacyfiles` smallint(4) NOT NULL DEFAULT '0',\n  `showreports` smallint(4) NOT NULL DEFAULT '0',\n  `visible` tinyint(1) NOT NULL DEFAULT '1',\n  `visibleold` tinyint(1) NOT NULL DEFAULT '1',\n  `hiddensections` tinyint(2) NOT NULL DEFAULT '0',\n  `groupmode` smallint(4) NOT NULL DEFAULT '0',\n  `groupmodeforce` smallint(4) NOT NULL DEFAULT '0',\n  `defaultgroupingid` bigint(10) NOT NULL DEFAULT '0',\n  `lang` varchar(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `theme` varchar(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `timecreated` bigint(10) NOT NULL DEFAULT '0',\n  `timemodified` bigint(10) NOT NULL DEFAULT '0',\n  `requested` tinyint(1) NOT NULL DEFAULT '0',\n  `enablecompletion` tinyint(1) NOT NULL DEFAULT '0',\n  `completionstartonenrol` tinyint(1) NOT NULL DEFAULT '0',\n  `completionnotify` tinyint(1) NOT NULL DEFAULT '0',\n  `coursedisplay` tinyint(2) NOT NULL DEFAULT '0',\n  PRIMARY KEY (`id`),\n  KEY `mdl_cour_cat_ix` (`category`),\n  KEY `mdl_cour_idn_ix` (`idnumber`),\n  KEY `mdl_cour_sho_ix` (`shortname`),\n  KEY `mdl_cour_sor_ix` (`sortorder`)\n) ENGINE=InnoDB AUTO_INCREMENT=45 DEFAULT CHARSET=utf8 COMMENT='Central course table';\n\nCREATE TABLE `mdl_user` (\n  `id` bigint(10) unsigned NOT NULL AUTO_INCREMENT,\n  `auth` varchar(20) NOT NULL DEFAULT 'manual',\n  `confirmed` tinyint(1) NOT NULL DEFAULT '0',\n  `policyagreed` tinyint(1) NOT NULL DEFAULT '0',\n  `deleted` tinyint(1) NOT NULL DEFAULT '0',\n  `mnethostid` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `username` varchar(100) NOT NULL DEFAULT '',\n  `password` varchar(32) NOT NULL DEFAULT '',\n  `pwdlastchange` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `idnumber` varchar(255) NOT NULL DEFAULT '',\n  `firstname` varchar(100) NOT NULL DEFAULT '',\n  `lastname` varchar(100) NOT NULL DEFAULT '',\n  `email` varchar(100) NOT NULL DEFAULT '',\n  `emailstop` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `nric` varchar(15) NOT NULL DEFAULT '',\n  `skype` varchar(50) NOT NULL DEFAULT '',\n  `yahoo` varchar(50) NOT NULL DEFAULT '',\n  `aim` varchar(50) NOT NULL DEFAULT '',\n  `msn` varchar(50) NOT NULL DEFAULT '',\n  `phone1` varchar(20) NOT NULL DEFAULT '',\n  `phone2` varchar(20) NOT NULL DEFAULT '',\n  `institution` varchar(40) NOT NULL DEFAULT '',\n  `department` varchar(30) NOT NULL DEFAULT '',\n  `address` varchar(70) NOT NULL DEFAULT '',\n  `city` varchar(20) NOT NULL DEFAULT '',\n  `country` varchar(2) NOT NULL DEFAULT '',\n  `lang` varchar(30) NOT NULL DEFAULT 'en_utf8',\n  `theme` varchar(50) NOT NULL DEFAULT '',\n  `timezone` varchar(100) NOT NULL DEFAULT '99',\n  `firstaccess` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastaccess` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastlogin` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `currentlogin` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastip` varchar(15) NOT NULL DEFAULT '',\n  `secret` varchar(15) NOT NULL DEFAULT '',\n  `picture` tinyint(1) NOT NULL DEFAULT '0',\n  `url` varchar(255) NOT NULL DEFAULT '',\n  `description` text,\n  `mailformat` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `maildigest` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `maildisplay` tinyint(2) unsigned NOT NULL DEFAULT '2',\n  `htmleditor` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `ajax` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `autosubscribe` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `trackforums` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `timemodified` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `trustbitmask` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `imagealt` varchar(255) DEFAULT NULL,\n  `screenreader` tinyint(1) NOT NULL DEFAULT '0',\n  `nlbid` bigint(10) unsigned DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `mdl_user_mneuse_uix` (`mnethostid`,`username`),\n  KEY `mdl_user_del_ix` (`deleted`),\n  KEY `mdl_user_con_ix` (`confirmed`),\n  KEY `mdl_user_fir_ix` (`firstname`),\n  KEY `mdl_user_las_ix` (`lastname`),\n  KEY `mdl_user_cit_ix` (`city`),\n  KEY `mdl_user_cou_ix` (`country`),\n  KEY `mdl_user_las2_ix` (`lastaccess`),\n  KEY `mdl_user_ema_ix` (`email`),\n  KEY `mdl_user_aut_ix` (`auth`),\n  KEY `mdl_user_idn_ix` (`idnumber`)\n) ENGINE=MyISAM AUTO_INCREMENT=5902 DEFAULT CHARSET=utf8 COMMENT='One record for each person';\n</code></pre>\n\n<p>I am trying to run the insert query but it is taking way too long. Is there any way to reduce the time?</p>\n\n<p>Following is the output after explain select:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/lzONZ.png\" alt=\"enter image description here\"></p>\n"},{"tags":["xml","query","schema","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12885933,"title":"XQuery XML Schema","body":"<p>Can one use XQuery and a simple XQuery processor to get the XML schema from some files in a directory and then process some of those files (whose names are not known in advance)? Also, can you do this while the files are in-memory, or is it better to chose an XML db?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12886602,"title":"MySQL threeway triangle query","body":"<p>I have a database of teams, schools and assignments. After choosing an assignment, the school (its users anyway) can add a team to an assignment, so that they may start working on the assignment.  The ER-diagram looks like this:\n<img src=\"http://i.stack.imgur.com/TXUom.png\" alt=\"ER-diagram of the database\">\n<strong>Important:</strong> Even though the setup of the database suggests otherwise, the team&lt;-> assignment relationship is 1:N. A team can work on only one assignment. This is controlled through the ORM-system.  </p>\n\n<p>Now here's the catch: there are teams in the database that work on assignments which do not belong to their school: the school choose the assignment, created a team and removed their assignment choice. I need to find the schools (id, name) for which this is the case.</p>\n\n<p>The best query so far that I've managed to come up with is:</p>\n\n<pre><code>SELECT schools.school_id, schools.name\nFROM schools\nLEFT JOIN teams ON schools.school_id = teams.school_id\nLEFT JOIN assignment_teams ON teams.team_id = assignment_teams.team_id\nLEFT JOIN assignment_schools ON schools.school_id = assignment_schools.school_id\nWHERE assignment_teams.assignment_id != assignment_schools.assignment_id;\n</code></pre>\n\n<p>But it doesn't work when I checked the results manually. What's the correct query that I'm looking for?</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12890487,"title":"SQL query to search between two weeks from different years","body":"<p>I have a column with week number and a column with year number. I want to search into database for a time interval, for example:</p>\n\n<p>If I want to search between a week from this year, and a week from the next year, what query should I use?</p>\n\n<p>If the year was the same that would be easy and my query will look like:</p>\n\n<pre><code>Select *\nFrom mytable\nWhere (Finish_Week BETWEEN @Finish_Week1 AND @Finish_Week2) \n       AND (Finish_Year = @Finish_Year)\n</code></pre>\n"},{"tags":["mysql","sql","query","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12890028,"title":"Displaying duplicate row numbers","body":"<p>I joined a table to itself to find duplicate rows</p>\n\n<pre><code>select a.data, a.rowNumber, b.rowNumber\nfrom DuplicateRows as a\njoin DuplicateRows as b \non\na.data = b.data and a.Id != b.Id\ngroup by a.data, a.rowNumber, b.rowNumber\n</code></pre>\n\n<p>This query gives the results like</p>\n\n<pre><code>\"content\" | 1 | 2\n\"content\" | 1 | 6\n\"content\" | 2 | 1\n\"content\" | 2 | 6 \n...and so on\n</code></pre>\n\n<p>Howcome I rewrite it to have results formed like</p>\n\n<pre><code>\"content\" | 1 | 2, 6\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I think the question should be a little bit corrected. \nYou see I don't want to get the inversed result, I mean I just want to get \none entry </p>\n\n<pre><code>`1 -&gt; 2, 6` \n</code></pre>\n\n<p>not </p>\n\n<pre><code>`1 -&gt; 2, 6 and `2 -&gt; 1, 6`\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":12889996,"title":"Multiple counts in SQL query (MS Access)","body":"<p>Given the following simple table structure:</p>\n\n<pre><code>Travel_Request\n\nPK- ID   From1   From2  From3   From4   To1   To2   To3   To4\n--------------------------------------------------------------\n1          A       B      C       D      A     A     C     B\n2          B       A      C       D      A     A     A     B          \n3          A       B      C       D      C     A     A     B\n4          A       C      C       D      B     A     A     B\n5          A       A      C       D      A     A     A     B\n</code></pre>\n\n<p>Is there a way without using subqueries (which is easy) where I could get this sample output:</p>\n\n<pre><code>Origin   Destination   Total\n-----------------------------\nA             A          3\nA             B          1\nA             C          1\n</code></pre>\n\n<p>And so on and so forth?</p>\n"},{"tags":["query"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12889412,"title":"Using Alias in Like Query","body":"<p>I have a Query \"namePrefix + ' ' + nameFirstname + ' ' + nameSurname AS salName\".\nHow can I use it in Store Procedure Like Query?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12886752,"title":"Query - Trying to SUM one field based on content of another field","body":"<p><strong>Table:</strong> </p>\n\n<pre><code>DayOfWeek           Enrollments\nMonday                 35\nMonday                 12\nSaturday               25\nTuesday                15\nMonday                  9\nTuesday                15\n</code></pre>\n\n<p>Basically I'm trying to sum the total enrolments for each day. </p>\n\n<p>so the Output will look like:</p>\n\n<pre><code>DayOfWeek           Enrollments\nMonday                 56\nSaturday               25\nTuesday                30\n</code></pre>\n\n<p>I've spent around 4 hours trying to work this out trying many many different ways but no luck. </p>\n\n<p>The problem I'm having is i can count how many enrollments for each day but can't have it aligned with the correct day when i run the query e.g. I want The total to be on the same line as the day it was calculated from. (I hope that is clear enough)</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12886551,"title":"sql query not working correctly (about picking the random records)","body":"<pre><code>USE [cms]\nGO\n/****** Object:  StoredProcedure [dbo].[SpCateProductsInfo]    Script Date: 10/14/2012 00:50:25 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER proc [dbo].[SpCateProductsInfo](@cate_id int)\nas\nbegin\nselect sb.subcate_name, sum(p.qty) as totalqty, \n(select top 1 pimg_mid1 from product join subcategory\non product.subcate_id=\n(\n    select top 1 subcate_id\n    from subcategory\n    where cate_id=@cate_id\n    order by NEWID()\n)\norder by NEWID()) as pimg_mid1\nfrom subcategory sb \n  join product p on p.subcate_id = sb.subcate_id\nwhere sb.cate_id = @cate_id\ngroup by sb.subcate_name\n\n\nend\n</code></pre>\n\n<p>It is working f9, But the problem is that the pimg_mid1 column contains same entries (<strong>every row regarding the pimg_mid1 column contains same data</strong>)</p>\n\n<p>can any one tell me abt this error and the solution ???</p>\n"},{"tags":["php","mysql","query","mvc","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12886621,"title":"HOW TO DB query multi-tables relational db","body":"<h1><code>Customer table</code></h1>\n\n<pre><code>///////////////////////////////////////////////////////////\n|      id[PR]  |      name        |       email           |  \n|      10      |      fabio       |     fab@fab.com       |   \n|      11      |      james       |     james@james.com   |   \n</code></pre>\n\n<h1><code>Order table</code></h1>\n\n<pre><code>//////////////////////////////////////////////////////////////////\n|  order_id[PR]  |  ship_to[FK]  |  bill_to[FK]   | customer[FK] |  product, total, etc\n|      251       |       3       |         2      |       10     |  . . . \n</code></pre>\n\n<h1><code>Ship to table</code></h1>\n\n<pre><code>//////////////////////////////////////////////////////////////////////\n|   customer[FK]  |  ship_to[PR]  |   label   |    address           |  city, state, zip, etc\n|       10        |      3        |   office  |  123 main st         |  . . .\n|       10        |      1        |   home    |  85 some place st    |  . . .\n</code></pre>\n\n<h1><code>Bill to table</code></h1>\n\n<pre><code>///////////////////////////////////////////////////////////////////////////\n|   customer[FK]  |  bill_to[PR]  |   label   |    account                |  billing details\n|       10        |      2        |   visa    |  AES_CRYPT(temp storage)  |   . . .\n|       10        |      1        |     mc    |  AES_CRYPT(temp storage)  |   . . .\n</code></pre>\n\n<p>Ok so each customer can have multi-ship to addresses and multi-payment methods on file in their account. When they place an order the order table stores the cart and session information.</p>\n\n<p>I need to generate <code>invoices</code> how do I structure my query so that when i lookup the order table i can see the row of <code>ship to table</code> and the row of <code>bill to table</code> instead of the <code>id</code> of the row in the associated table.</p>\n\n<p>Now mind you i don't expect anyone to write my code but if you can please give me some links to read up on that would be great or an example would be awesome. Please note im building on codeigniter so im using the MVC pattern.</p>\n\n<p>? - Should all of these lookups be structured in 1 model function or should they be spread over several functions in the model?</p>\n\n<pre><code>return $this-&gt;db-&gt;get('order_table')-&gt;result();\n#this would return all the orders in the order table . \n</code></pre>\n\n<p>in my <code>view</code> i would foreach these results and make the order-id a link to more details/ invoice   page. How do i pass the values from the row to the model query to generate the proper details/invoice page?</p>\n\n<p>E.g. - So if you click on order 251, you will see a details page with an invoice that will say </p>\n\n<ol>\n<li>customer id 10</li>\n<li>name: fabio</li>\n<li>email: fab@fab.com</li>\n<li>ship to: office, 123 main st...</li>\n<li>bill to: visa, acct#, etc...</li>\n</ol>\n"},{"tags":["sql","query","sql-server-2008-r2","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12886295,"title":"sql sum some column when all other columns match","body":"<p>I have the following SQL temp table which is a result of an SQL query</p>\n\n<p><img src=\"http://i.stack.imgur.com/ffL4C.png\" alt=\"enter image description here\"></p>\n\n<p>I am trying to SUM columns <code>numitems</code> and <code>ignoreditems</code> where all the other columns match</p>\n\n<p>I tried something like the following query:</p>\n\n<pre><code>SELECT \n    catalogid, \n    sum(numitems), sum(ignoreditesm) \nFROM ##temporderstable \nGROUP BY \n    catalogid, supplierid, cname, cprice, cstock, ccode, minstock, pother4\n</code></pre>\n\n<p>I can't seem to get it to work</p>\n\n<p>I get an error </p>\n\n<blockquote>\n  <p><em>numitems doesn't belong to the table</em></p>\n</blockquote>\n\n<p>although I can see it when I run the command </p>\n\n<pre><code>select * from ##temporderstable\n</code></pre>\n"},{"tags":["query","plugins","netbeans","autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12886455,"title":"netbeans completion provider","body":"<p>I implement auto - complete function as Netbeans Plugin. </p>\n\n<pre><code>@Override\npublic CompletionTask createTask(int queryType, JTextComponent jtc) {\n\n    if (queryType != CompletionProvider.COMPLETION_QUERY_TYPE) {\n        return null;\n    }        \n\n    return new AsyncCompletionTask(new AsyncCompletionQuery() {\n\n        @Override\n        protected void query(CompletionResultSet completionResultSet, Document document, int caretOffset) {  \n            System.out.println(\"Document: \" + document); // document variable is null\n            System.out.println(\"Caret offset: \" + caretOffset); // caretOffset is -1\n\n            // Iterate through the available locales and assign each country display name\n            // to a CompletionResultSet:\n            Locale[] locales = Locale.getAvailableLocales();\n\n            for (int i = 0; i &lt; locales.length; i++) {\n                final Locale locale = locales[i];\n                final String country = locale.getDisplayCountry();\n                if (!country.equals(\"\")) {\n                    completionResultSet.addItem(new CountriesCompletionItem(country, caretOffset));\n                }\n            }\n\n            completionResultSet.finish();\n        }\n    });\n}\n</code></pre>\n\n<p>I have 2 problems with this code:</p>\n\n<ol>\n<li>document variable is always null</li>\n<li>caretOffset is always -1</li>\n</ol>\n\n<p>Why???</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql","database","query","data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12885607,"title":"Merge tables into One WITH same generated number in both new tables","body":"<p>I found some options to run a myslq query to migrate/split one table into 2 new tables, but one of the fields I would like to create on the new table has to be the same as in the other new table:</p>\n\n<p>So from the \"From_payments\" table, I would like to create 2 new tables called: \"To_paymenttransaction\" and \"To_paymentinfo\". A lof of the field are predefined and some are from the old table. The only problem is that the predefined field \"paymentinfoid\" has to be the same is both new tables. </p>\n\n<pre><code>**To_paymenttransaction** --- &lt; --- **From_payments**\n\npaymenttransactionid ------- &lt; --- (Generate next available number in this column)\n\npaymentinfoid -------------- &lt; --- (Generate next available number in this column)\n\ntransactionid --------------- &lt; --- txn_id\n\nstate ---------------------- &lt; --- (Set all to \"1\")\n\namount -------------------- &lt; --- mc_gross\n\ncurrency ------------------- &lt; --- mc_currency\n\ndateline -------------------- &lt; --- payment_date\n\npaymentapiid --------------- &lt; --- (Set all to \"1\")\n\nrequest -------------------- &lt; --- (Set all to \"NULL\")\n\nreversed ------------------- &lt; --- (Set all to \"0\")\n\n**To_paymentinfo** -----------&lt; \n\npaymentinfoid -------------- &lt; --- (Same generated number that goes to the paymentinfoif field in To_paymenttransaction table )\n\nhash ----------------------- &lt; --- (Set all to \"Imported\")\n\nsubscriptionid --------------- &lt; --- (Set all to \"1\")\n\nsubscriptionsubid ------------ &lt; --- (\"2\" IF above field mc_gross is 4, \"1\" IF above field mc_gross is 6, \"0\" IF above field mc_gross is 10)\n\nuserid   ---------------------- &lt; --- userid\n\ncompleted ------------------ &lt; --- (Set all to \"0\")\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>All help is greatly appreciated.</p>\n\n<p>Thanks you!</p>\n"},{"tags":["sql","sql-server","query","tsql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12863074,"title":"t-sql query with deep joining","body":"<p>I'm having a little trouble of getting a fast sql-query on this. I've managed to get a query to return the result I want but it takes about 2 sek to run even with the right indexes.</p>\n\n<p>I have these tables:</p>\n\n<pre><code>[Login]\nloginID\nloginTime\nuserID\n\n[user]\nuserID \nuserName\n\n[companyParticipant]\nuserID\ncompanyID\n\n[company]\ncompanyID\norganisationID\nCompanyName\n</code></pre>\n\n<p>What I want to show is all the top 10 latest logins persons with loginTime. Where the user is in a company that I am a participant or a company within the organisations where I am member of a company of that organisation</p>\n\n<p>To get my organisations:</p>\n\n<pre><code>SELECT organisationID \nFROM companys \nWHERE companyID IN (\n    SELECT companyID \n    FROM companyParticipant \n    WHERE userID = @userID) \nGROUP BY organisationID \n</code></pre>\n\n<p>So what i want i a query like this:</p>\n\n<pre><code>SELECT TOP 10 userName, LoginTime \nFROM ....\nORDER BY loginID\n</code></pre>\n"},{"tags":["sql","database","query","metadata"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":50,"score":-4,"question_id":12884953,"title":"Software that analyzes schema metadata and outputs user language queries","body":"<p>I am a student and I am planning to propose my own master thesis topic. </p>\n\n<p>I am interested in databases. So I am more inquisitive about database engine working and query parsers. </p>\n\n<p>I am wondering whether there exists any non-traditional software that analyzes the given db-schema and process the user custom queries (not in SQL format, in general language) and parses them against analyzed schema and retrieves the data by creating queries or dynamic queries. </p>\n\n<p>I mean user question to the engine can be like this: \"fetch me employees whose salary is greater than 10K and who work in CS department at senior management level\". </p>\n\n<p>My assumption is that the schema exists but no pre-query is written, and the engine should build the required SQL query dynamically for the user question (or can be any other alternative) and retrieve the results. My intention is work based on db-metadata and indexing it by engine to have faster results. </p>\n\n<p>If no such system exists,  I am interested to start it as my Master thesis project. On successful completion, it can completely eliminate manual sql queries. </p>\n"},{"tags":["mysql","sql","wordpress","query","csv"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12855854,"title":"Export WordPress Posts and Meta Information in CSV format using SQL Query","body":"<p><em>Apologies, this is a <a href=\"http://wordpress.stackexchange.com/questions/67798/export-wordpress-posts-and-meta-information-in-csv-format\">duplicate of entry of this post</a> but I found I'm not getting the right answer there and not sure how to ask to move it over to SO?</em></p>\n\n<p>I need to export all WordPress Posts and related Meta information using an SQL query in CSV format. I've managed to export just the Posts but realised that the Meta information is in another table.</p>\n\n<p>Could someone please tell me how I would go about doing this please?</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT: I have already tried a number of plugins, none of which have worked for this specific scenario. I really do need to work on the query itself. Thanks</strong></p>\n\n<p><strong>EDIT: The final outcome of the CSV file should look something like this. On one row, these are the columns that I will end up with. (I will delete the additional columns in CSV, I'm just giving a shortened version here)</strong></p>\n\n<pre><code>post_content | post_title | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* \n</code></pre>\n\n<p>So one post per row with the meta information in the same row.</p>\n\n<p><strong>EDIT: With the S-ha-dum, I've managed to get some way, but I have about 12 meta_value > meta_key values to pull out of the DB so I need help to write the rest of the query please</strong></p>\n\n<pre><code>SELECT *,(SELECT meta_value FROM wp_postmeta WHERE wp_postmeta.meta_key = 'Publisher' AND wp_postmeta.post_id = wp_posts.ID) as Publisher FROM wp_posts\n</code></pre>\n"},{"tags":["query","sparql","ontology"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12817346,"title":"Sparql substract instance","body":"<p>I have an anthology, I created an interface for evaluation or there is a submit button. This button allows you to calculate the difference between the old value and the value 20. I try to select an instance with sparql and I would evaluate an instance subtracts the old value with the value 20.</p>\n\n<pre><code>valider.addActionListener(new ActionListener()\n    {\n        public void actionPerformed(ActionEvent e)\n        {\n            Model m=ModelFactory.createMemModelMaker().createModel(null);\n            FileManager.get().readModel( m, owlFile );\n            String myOntologyName = \"ProjetHela\";\n            String uri=\"file:///C:/Project/Krs1.owl\";\n            // Définition de prefixe pour simplifier l'utilisation de SPARQL\n            String reuses = \"maj: &lt;\"+RDF.getURI()+\"&gt;\" ;\n            // String myOntologyPrefix = \"PREFIX \"+myOntologyName+\": &lt;\"+myOntologyNS+\"&gt;\" ;\n            String myOntologyPrefix = \"PREFIX \"+myOntologyName+\": &lt;\"+uri+\"&gt;\" ;\n            // if (liste.getSelectedItem().toString().equals(\"GMP: Puissance=60352 Watt,limite supérieure= 73500 Watt\")) {\n            String queryString= \n                \"PREFIX maj: &lt;http://www.owl-ontologies.com/reuses.owl#&gt;\"\n                + \"SELECT ?hasnameevaluated\"\n                + \" WHERE \"\n                + \"{\"\n                + \"?Besoin maj:hasnameevaluated ?hasnameevaluated \"\n                +\"FILTER (?hasnameevaluated - 20)  \"\n                + \" } \";\n            Query query = QueryFactory.create(queryString) ;\n\n            QueryExecution qexec = QueryExecutionFactory.create(query, m) ;\n            try  {\n                ResultSet rs = qexec.execSelect() ;\n\n                // Affichage des resultats\n                for ( ; rs.hasNext() ; ){\n                //System.out.print(\"\");\n                QuerySolution rb = rs.nextSolution() ;\n                String y = rb.getLiteral(\"hasnameevaluated\").getString();\n                System.out.println( \" \" + y);\n                }}  finally {\n                    qexec.close() ;\n\n                    }\n                }   \n            }\n\n\n    );\n</code></pre>\n\n<p>but it doesn't work\nplease help me</p>\n"},{"tags":["sql","query","sql-server-2008-r2","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12884168,"title":"SQL join with sum","body":"<p>Hello i've the following SQL Query which produces the following result</p>\n\n<pre><code>SELECT * FROM\n     (\n     Select\n        catalogid, numitems, allitems - numitems ignoreditems\n     from\n         ( \n             select\n                 i.catalogid,\n                 case\n                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)\n                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) AND odate is not null AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)\n                 else 0 end numitems,\n                 sum(numitems) allitems \n             from \n                 \"orders o\n             inner join\n                 \"oitems i \n             on \n                 \"i.orderid=o.orderid\n             inner join\n                 \"products T1\n             on \n                 \"T1.catalogid = i.catalogid\n             group by \n                 \"i.catalogid, ocardtype, odate,o.orderid\n         ) A\n     ) B\n     INNER JOIN\n     (\n         SELECT \n             catalogId, \n             ProcessedSucssessfully = \n                STUFF((SELECT ', ' + CAST( b.orderid as varchar(10))\n                       FROM oitems b JOIN orders o ON b.orderid = o.orderid \n                       WHERE b.catalogId = a.catalogId \n                       AND  NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) AND (Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) OR Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) and o.odate is not null)\n                       FOR XML PATH('')), 1, 2, ''), \n                           \"NotProcessed = \n                 STUFF((SELECT ', ' + CAST( c.orderid as varchar(10))\n                        FROM oitems c JOIN orders o ON c.orderId = o.orderid\n                        WHERE c.catalogid = a.catalogid \n                        AND (o.ocardtype in ('mastercard') OR o.ocardtype is null) and o.odate is null\n                        FOR XML PATH('')), 1, 2, '') \n         FROM \n             oitems a \n         GROUP BY \n             a.catalogid \n     )C\n         ON \n             B.catalogid = C.catalogid \n</code></pre>\n\n<p>the the result of this query you can see in the following image\n<img src=\"http://i.stack.imgur.com/T9k80.png\" alt=\"enter image description here\"></p>\n\n<p>you see those 2 circled rows, i want them to be in a one row that will only sum the numitems, the processed successfully value and all other values will be always the same for the records the share catalogid so no problem with them.</p>\n\n<p>basicly the result row should have the sum of the numitem valuse in all rows that have the same catalogid</p>\n\n<p>so how can i solve this problem?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12882875,"title":"returns sometimes blank row with the use of two random records","body":"<p>I have three tables:</p>\n\n<ul>\n<li><p><code>product (p_id(pk), subcate_id, pname)</code>.</p></li>\n<li><p><code>cate(cate_id(pk), cate_name)</code>.</p></li>\n<li><p><code>subcate(subcate_id(pk), cate_id, subcate_name )</code>.</p></li>\n</ul>\n\n<p>I want that pass a <code>cate_id</code> and get a random <code>subcate_id</code> and then on the behalf on those <code>subcate_ids</code>, get a random <code>record</code>(<code>pname</code>) from product table.</p>\n\n<p>So I have tried the following code:</p>\n\n<pre><code>select top 1 pname from product join subcategory\non product.subcate_id=\n(\n    select top 1 subcate_id\n    from subcategory\n    where cate_id=3\n    order by NEWID()\n)\norder by NEWID()\n</code></pre>\n\n<p>But the problem is that this code <em>returns sometimes blank row</em>. <strong>Why?</strong></p>\n\n<p>Is there any error in my code?</p>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12883034,"title":"Receive (bind) the data coming from two select commands n a single proc in SQL Server","body":"<pre><code> create proc [dbo].[SpCateProducts](@cate_id int)\n    as\nbegin\n    select sb.subcate_name, sum(p.qty)\n    from subcategory sb \n      join product p on p.subcate_id = sb.subcate_id\n    where sb.cate_id = @cate_id\n    group by sb.subcate_name\n\n        select top 1 pname from product join subcategory\n    on product.subcate_id=\n    (\n        select top 1 subcate_id\n        from subcategory\n        where cate_id=3\n        order by NEWID()\n    )\nend\n</code></pre>\n\n<p>but it is returning two tables, then how can I bind it to the listview?</p>\n\n<p>Or is there any way that it will returns a single table, which will contain all these required rows of data?</p>\n\n<p>I mean that that 1st one select command already giving a table of 4 rows and 4 columns, then is there any way that it will contain one more column (<code>pname</code>) which is currently returning by 2nd select command</p>\n"},{"tags":["android","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":295,"score":0,"question_id":7882580,"title":"SQLite and Android Exception","body":"<p>I am facing problem in android application i want to create database with following script.</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS events (\n_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\nsource_device_id INT,\ntimestamp INT NOT NULL,\nprocessed BOOLEAN DEFAULT FALSE,\nevent_type TINYINT NOT NULL,\npayload BLOB);\n\nCREATE INDEX IF NOT EXISTS events_unprocessed ON events (processed, _id);\n</code></pre>\n\n<p>and my android code is </p>\n\n<pre><code>public void onCreate(SQLiteDatabase db) {\n  InputStream schemaStream = context.getResources().openRawResource(R.raw.logdb_schema);\n  Scanner schemaScanner = new Scanner(schemaStream, \"UTF-8\");\n  schemaScanner.useDelimiter(\";\");\n\n  Log.i(TAG, \"Creating database\");\n  try {\n    db.beginTransaction();\n    while (schemaScanner.hasNext()) {\n      String statement = schemaScanner.next();\n      Log.d(TAG, \"Creating database: \" + statement);\n      db.execSQL(statement);\n    }\n    db.setTransactionSuccessful();\n  }\n  finally {\n    db.endTransaction();\n  }\n}\n</code></pre>\n\n<p>Its not working its generating run-time exception:</p>\n\n<blockquote>\n  <p>android.database.sqlite.SQLiteException: not an error:</p>\n</blockquote>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":38,"score":-2,"question_id":12882404,"title":"How can I join 3 tables?","body":"<p>I have 3 mysql tables. The first table(<code>tb_user</code>) or the parent table have columns <code>region_id</code> and <code>institution_id</code> and both can also be found from a different tables:</p>\n\n<ul>\n<li><code>region_id</code>(table: <code>tb_region</code>), and </li>\n<li><code>institution_id</code>(table: <code>tb_institutional_profile</code>).</li>\n</ul>\n\n<p>How do I query it to get all the columns in <code>tb_user</code> and display names(<code>region_name</code> from <code>tb_region</code> and <code>institution_name</code> form <code>tb_institutional_profile</code>) and not <code>ID</code>s.?</p>\n"},{"tags":["ruby-on-rails-3","query","activerecord","active-relation"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":276,"score":0,"question_id":10042270,"title":"Rails 3 query in multiple date ranges","body":"<p>Suppose we have some date ranges, for example:</p>\n\n<pre><code>ranges = [\n          [(12.months.ago)..(8.months.ago)],\n          [(7.months.ago)..(6.months.ago)],\n          [(5.months.ago)..(4.months.ago)],\n          [(3.months.ago)..(2.months.ago)],\n          [(1.month.ago)..(15.days.ago)]\n         ]\n</code></pre>\n\n<p>and a <code>Post</code> model with <code>:created_at</code> attribute.</p>\n\n<p>I want to find posts where <code>created_at</code> value is in this range, so the goal is to create a query like:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06' OR\n    BETWEEN '2011-09-06' AND '2011-10-06' OR\n    BETWEEN '2011-11-06' AND '2011-12-06' OR\n    BETWEEN '2012-01-06' AND '2012-02-06' OR\n    BETWEEN '2012-02-06' AND '2012-03-23';\n</code></pre>\n\n<p>If you have only one range like this:</p>\n\n<pre><code>range = (12.months.ago)..(8.months.ago)\n</code></pre>\n\n<p>we can do this query:</p>\n\n<pre><code>Post.where(:created_at =&gt; range)\n</code></pre>\n\n<p>and query should be:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06';\n</code></pre>\n\n<p>Is there a way to make this query using a notation like this <code>Post.where(:created_at =&gt; range)</code>?</p>\n\n<p>And what is the <em>correct</em> way to build this query?</p>\n\n<p>Thank you</p>\n"},{"tags":["mysql","sql","performance","query","sql-update"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12812331,"title":"How to efficiently UPDATE a column when it requires joining 2 large tables in MySQL?","body":"<p>I've got 2 tables, named: <code>csv (a csv dump)</code>, and <code>items (primary data table)</code> with 7M (csv dump) and 15M rows respectively. I need to update a column in <code>items</code> that exists in table <code>csv</code>.</p>\n\n<p>Both tables have a commonly indexed join ID (a <code>VARCHAR(255)</code>).</p>\n\n<p>An UPDATE query with a join on the mutual ID column (indexed) still takes multiple days to run. After researching it  I believe the inefficiency is in MySQL scanning the <code>csv</code> table and making per-row random-access queries against the <code>items</code> table.</p>\n\n<p>Even though there are indexes, those indexes don't fit in memory, so the required 7M random access queries are nose diving performance.</p>\n\n<p>Are there \"typical\" ways of addressing this kind of issue?</p>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>We're basically taking multiple catalogs of \"items\" and storing them\n  in our <code>items</code> table (this is bit of a simplification for discussion).\n  Each of say 10 catalogs will have 7M items (some duplicates across catalogs that we\n  normalize to 1 row in our item table). We need to compare and\n  verify changes to those 10 catalogs daily (<code>UPDATES</code> w/ joins between two big\n  tables, or other such mechanism).</p>\n  \n  <p>In reality we have an <code>items</code> table and an <code>items_map</code> table, but no\n  need to discuss that additional level of abstraction here. I'd be\n  happy to find a way to perform an update between the <code>csv</code> dump table\n  and an <code>items</code> table (given that they both have a common ID that's\n  indexed in both tables). But  given that the <code>items</code> table might have\n  20M rows, and the <code>csv</code> table might have 7M rows.</p>\n  \n  <p>In this case indexes don't fit in memory and we're hammering the drive with random seeks I believe</p>\n</blockquote>\n"},{"tags":["c#","database","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12880950,"title":"Calculate the retrieved rows in database","body":"<p><img src=\"http://i.stack.imgur.com/46urR.png\" alt=\"Form1\"></p>\n\n<p>I am new in Visual C# and would want to know how to calculate the retrieved data from a database.</p>\n\n<p>Using the above GUI, when \"Calculate\" is click, the program will display the number of students in textBox1, and the average GPA of all students in textBox2.</p>\n\n<p>Here is my database table \"Students\":</p>\n\n<p><img src=\"http://i.stack.imgur.com/rrNFp.png\" alt=\"enter image description here\"></p>\n\n<p>I was able to display the number of students but I'm still confused to how I can calculate the average GPA</p>\n\n<p>Here's my code:</p>\n\n<pre><code>    private void button1_Click(object sender, EventArgs e)\n    {\n            string connection = @\"Provider=Microsoft.ACE.OLEDB.12.0;Data  Source=C:\\Database1.accdb\";\n            OleDbConnection connect = new OleDbConnection(connection);\n\n        string sql = \"SELECT * FROM Students\";\n        connect.Open();\n        OleDbCommand command = new OleDbCommand(sql, connect);\n        DataSet data = new DataSet();\n        OleDbDataAdapter adapter = new OleDbDataAdapter(command);\n        adapter.Fill(data, \"Students\");\n\n        textBox1.Text = data.Tables[\"Students\"].Rows.Count.ToString();\n\n        double gpa;\n        for (int i = 0; i &lt; data.Tables[\"Students\"].Rows.Count; i++)\n        {\n            gpa = Convert.ToDouble(data.Tables[\"Students\"].Rows[i][2]);\n        }\n\n        connect.Close();\n    }\n</code></pre>\n"},{"tags":["php","mysql","query","logging","doctrine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12880976,"title":"MySQL - How to track every query?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6479107/how-to-enable-mysql-query-log\">How to enable MySQL Query Log?</a>  </p>\n</blockquote>\n\n\n\n<p>Is there a way to track every SQL query in MySQL?</p>\n\n<p>Im using Doctrine ORM to build entities and fetch them from database, and would like to see what queries is Doctrine producing. So when I refresh a webpage that uses Doctrine ORM to fetch some data from database, where could I see queries executed in database?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["php","mysql","query","loops"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12880291,"title":"How to query all fields in a row","body":"<p>I know this is very simple, but I haven't used PHP/MySQL in a while and I have been reading other threads/php website and can't seem to get it.</p>\n\n<p>How can I query a single row from a MySQL Table and print out all of the fields that have data in them? I need to exclude the NULL fields, and only add those that have data to an html list.</p>\n\n<p>To clarify, I would like to display the field data without specifying the field names, just for the reason that I have a lot of fields and will not know which ones will be NULL or not.</p>\n"},{"tags":["php","mysql","query","insert","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12879294,"title":"First time mysqli, having INSERT error","body":"<p>I'm getting the following error from the following code. Connection works with no errors, all the input columns are correct, and I've dumbed down the inputs to just 0's to make sure it wasn't the variables I was passing. Any help would be greatly appreciated. MySQL ver 5.5.28.</p>\n\n<blockquote>\n  <p>FAILURE You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near 'keys, values, childID, accessID) VALUES ('0','0','0','0')' at\n  line 1</p>\n</blockquote>\n\n<pre><code>$query=\"INSERT INTO carts (keys, values, childID, accessID)\n                    VALUES\n                    ('0','0','0','0')\";\n                    echo $query;\nif (mysqli_query($link, $query) == FALSE) {echo \"FAILURE \" . mysqli_error($link);}\n</code></pre>\n\n<p>Been working 20 hours without sleep so if this a facepalm moment, I wont be surprised. I will say that I've never used mysqli, just mysql commands.</p>\n"},{"tags":["sql","query","select","sql-server-2008-r2","case"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12879041,"title":"SQL Cannot perform an aggregate function on an expression containing an aggregate or a subquery","body":"<p>I am new to SQL and I've the following SQL Query</p>\n\n<pre><code>select catalogid, numitems, allitems - numitems ignoreditems\n from (\n  select i.catalogid,\" \n    sum(case when (ocardtype in ('PayPal','Sofort') OR\n                   ocardtype in ('mastercard','visa') and\n                   odate is not null) AND NOT EXISTS (select CAST(booked AS INT) FROM bookedordersids b where b.booked = o.orderid)\n                   then numitems\n                   else 0 end) numitems,\n    sum(numitems) allitems\n  from orders o\n  join oitems i on i.orderid=o.orderid\n  group by i.catalogid\n ) X\n</code></pre>\n\n<p>and it gives me the following error</p>\n\n<pre><code>Cannot perform an aggregate function on an expression containing an aggregat or a subquery\n</code></pre>\n\n<p>When I remove the following line it works fine</p>\n\n<pre><code>AND NOT EXISTS (select CAST(booked AS INT) FROM bookedordersids b where b.booked = o.orderid)\n</code></pre>\n\n<p>but it's important to do this check; how can I fix this?</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12878973,"title":"Error in using EXCEPT with INTERSECT in SQL","body":"<p>Suppose I have three tables Table A,Table B and Table C.</p>\n\n<p>Table A contains the col t1 with entries 1,2,2,3,4,4.<br>\nTable B has col t2 with entries 1,3,4,4.<br>\nTable C has col t3 with entries 1,2,4,4. </p>\n\n<p>The query given was</p>\n\n<pre><code>SELECT * FROM  A EXCEPT (SELECT * FROM  B INTERSECT SELECT * FROM C ).\n</code></pre>\n\n<p>I saw this question in a test paper. It was mentioned that the expected answer was 2 but the answer obtained from this query was 1,2,4. I am not able to understand the principle behind this.</p>\n"},{"tags":["sql","query","postgresql","optimization","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":85,"score":3,"question_id":12875060,"title":"Optimizing an SQL query","body":"<p>Using PostgreSQL 8.4 and with a table such as this:</p>\n\n<pre><code>create table log (\n    id bigint primary key,\n    first_sn bigint not null,\n    last_sn bigint not null\n);\n</code></pre>\n\n<p>where first_sn and last_sn represent a range of serial numbers, and the table holding > 1 million rows, what sort of index and query should I use if I want to search for all rows where  the serial number range contain an element in a list of serial numbers.</p>\n\n<p>For example, for a list [5348491, 1230505, 5882233] I'm currently doing:</p>\n\n<pre><code>select 5348491, *\nfrom log\nwhere 5348491 between first_sn and last_sn\nunion\nselect 1230505, *\nfrom log\nwhere 1230505 between first_sn and last_sn\nunion\nselect 5882233, *\nfrom log\nwhere 5882233 between first_sn and last_sn;\n</code></pre>\n\n<p>But that's a bit slow.</p>\n\n<p>Edit: A query like that will take around 600ms and I would like to be able to search with a list of >10k serial numbers.</p>\n\n<p>Since someone requested it, here's the real table, query and an explain analyze (I hesitated since all the column names are in spanish, but in the previous example 'id' would be 'movimiento_id' here, 'first_sn' would be 'serial_inicial' , and 'last_sn' would be 'serial_final'. 'tipo_movimiento' is the type of event and really it's just a way to filter the resultset further):</p>\n\n<pre><code>    CREATE TABLE movimiento\n(\n  movimiento_id bigserial NOT NULL,\n  serial_inicial bigint NOT NULL,\n  serial_final bigint NOT NULL,\n  serial_chip bigint,\n  numero_telefono text,\n  fecha_movimiento timestamp without time zone DEFAULT now(),\n  producto_id integer NOT NULL,\n  usuario_id integer NOT NULL,\n  factura_proveedor text,\n  fecha_ingreso date,\n  fecha_venta date,\n  vendedor_id integer,\n  cliente_id integer,\n  tipo_movimiento text NOT NULL,\n  costo numeric(12,4),\n  precio numeric(10,2),\n  descuento double precision,\n  bodega_id integer NOT NULL DEFAULT 1,\n  fecha_activo timestamp without time zone,\n  factura text,\n  envio text,\n  documento text,\n  bodega_id_origen integer,\n  fecha date,\n  traslado_id integer,\n  detalle_factura_id bigint,\n  es_venta boolean DEFAULT false,\n  CONSTRAINT movimiento_pkey PRIMARY KEY (movimiento_id ),\n  CONSTRAINT movimiento_bodega_id_fkey FOREIGN KEY (bodega_id)\n      REFERENCES bodega (bodega_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_bodega_id_origen_fkey FOREIGN KEY (bodega_id_origen)\n      REFERENCES bodega (bodega_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_cliente_id_fkey FOREIGN KEY (cliente_id)\n      REFERENCES cliente (cliente_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_producto_id_fkey FOREIGN KEY (producto_id)\n      REFERENCES producto (producto_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_usuario_id_fkey FOREIGN KEY (usuario_id)\n      REFERENCES usuario (usuario_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_vendedor_id_fkey FOREIGN KEY (vendedor_id)\n      REFERENCES vendedor (vendedor_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_check CHECK (serial_final &gt;= serial_inicial),\n  CONSTRAINT movimiento_costo_check CHECK (costo &gt;= 0::numeric),\n  CONSTRAINT movimiento_descuento_check CHECK (descuento &gt;= 0::double precision),\n  CONSTRAINT movimiento_precio_check CHECK (precio &gt;= 0::numeric),\n  CONSTRAINT movimiento_tipo_movimiento_check CHECK (tipo_movimiento = ANY (ARRAY['Ingresado'::text, 'Vendido'::text, 'Entregado'::text, 'Regresado'::text, 'Eliminado'::text, 'Devuelto'::text, 'Inconforme'::text, 'Trasladado'::text, 'Consignado'::text, 'Devolucion Consignado'::text, 'Activado'::text, 'Devolucion Claro'::text, 'Asignado'::text, 'Fusion-Sale'::text, 'Fusion'::text, 'Separacion-Sale'::text, 'Separacion'::text]))\n)\nWITH (\n  OIDS=TRUE\n);\n</code></pre>\n\n<p>Here's the query:</p>\n\n<pre><code>    explain analyze select 869461009867643, *\nfrom movimiento\nwhere (869461009867643 between serial_inicial and serial_final)\nand tipo_movimiento = 'Ingresado'\nunion all\nselect 12121001477546, *\nfrom movimiento\nwhere 12121001477546 between serial_inicial and serial_final\nand tipo_movimiento = 'Ingresado'\nunion all\nselect 354689040208615, *\nfrom movimiento\nwhere 354689040208615 between serial_inicial and serial_final\nand tipo_movimiento = 'Ingresado';\n</code></pre>\n\n<p>And the explain analyze:</p>\n\n<pre><code>Append  (cost=7542.94..185580.33 rows=232322 width=165) (actual time=93.222..571.928 rows=4 loops=1)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7542.94..61089.00 rows=90645 width=165) (actual time=93.220..206.248 rows=1 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((869461009867643::bigint &gt;= serial_inicial) AND (869461009867643::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=66.445..66.445 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7534.24..61080.30 rows=55815 width=165) (actual time=84.364..179.571 rows=2 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((12121001477546::bigint &gt;= serial_inicial) AND (12121001477546::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=60.282..60.282 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7541.75..61087.81 rows=85862 width=165) (actual time=173.876..186.082 rows=1 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((354689040208615::bigint &gt;= serial_inicial) AND (354689040208615::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=60.294..60.294 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\nTotal runtime: 572.138 ms\n</code></pre>\n\n<p>Here's the explain analyze with a_horse_with_no_name's example:</p>\n\n<pre><code>    Nested Loop  (cost=7614.18..98703.44 rows=125144 width=173) (actual time=629.373..2919.334 rows=4 loops=1)\n  Join Filter: ((lista.serie &gt;= movimiento.serial_inicial) AND (lista.serie &lt;= movimiento.serial_final))\n  CTE lista\n    -&gt;  Values Scan on \"*VALUES*\"  (cost=0.00..0.04 rows=3 width=8) (actual time=0.012..0.033 rows=3 loops=1)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7614.14..59283.04 rows=375432 width=165) (actual time=110.909..460.563 rows=372409 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=107.182..107.182 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  CTE Scan on lista  (cost=0.00..0.06 rows=3 width=8) (actual time=0.001..0.003 rows=3 loops=372409)\nTotal runtime: 2919.514 ms\n</code></pre>\n\n<p>So combining a_horse_with_no_name and Craig Ringer's suggestions, searching for three serial numbers ran under 350ms. Tried with 10k and it did that in 3s+:</p>\n\n<pre><code>create temporary table lista (\n    serie bigint\n) on commit drop;\ncreate index lista_index on lista using btree (serie);\ninsert into lista (select distinct serial_inicial from movimiento limit 10000);\nanalyze lista;\nselect serie, movimiento.*\nfrom movimiento join lista on serie between serial_inicial and serial_final\nwhere tipo_movimiento = 'Ingresado';\n</code></pre>\n"},{"tags":["php","mysql","query","while-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12878249,"title":"Appending MySQL Results Together in a PHP Loop","body":"<p>Using PHP, for-each row in a MySQL query's result set, I need to execute another MySQL query. So far, I've got</p>\n\n<pre><code>$result = mysql_query(\"SELECT id, state FROM states WHERE region='given_region'\")\nor die(mysql_error());\n\nwhile($row = mysql_fetch_row($result))\n{\n    $state = $row['state'];\n    $r = mysql_query(\"SELECT * FROM locations WHERE state REGEXP '(^|,)\".$state.\"($|,)'\");\n}\n</code></pre>\n\n<p>Now I need to append all of the results $r into ONE result set that I can then iterate through with a standard while-loop, however, my very limited PHP skills are leaving me at a loss getting code to do that.</p>\n\n<p>Can anyone provide any insight into how I'd go about appending all the results into one set within the given while loop?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12878251,"title":"MySQL Join 2nd table with not Unique Foreign Key","body":"<p>I have got 2 Tables I need to query. I cannot unique values for the linked key.\nThe first Table stores stories or posts per child.</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `learning_story` (\n  `story_id` int(10) NOT NULL AUTO_INCREMENT,\n  `child_id` int(10) NOT NULL,\n  `img_file` varchar(250) NOT NULL,\n  `title` varchar(300) NOT NULL,\n  `description` text NOT NULL,\n  `link` varchar(300) NOT NULL,\n  `storydate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `teacher_id` int(11) NOT NULL,\n  `pro_id` int(10) NOT NULL DEFAULT '0',\n  `status` varchar(10) NOT NULL DEFAULT 'draft',\n  PRIMARY KEY (`story_id`),\n  KEY `child_id` (`child_id`),\n  KEY `pro_id` (`pro_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=0 ;\n</code></pre>\n\n<p>Each story or post is unique to a child (child_id Foreign Key).\nNow I am adding the ability to add posts that belong to a group of children.\nHere are 4 sample rows</p>\n\n<pre><code>INSERT INTO `learning_story` (`story_id`, `child_id`, `img_file`, `title`, `description`, `link`, `storydate`, `teacher_id`, `pro_id`, `status`) VALUES\n(1, 5, '', 'Story 1', '&lt;p&gt;&lt;img src=\"http://127.0.0.1/websites/my-books/assets/mercury_img/2dfeb1f41c48a308b7eee8526918ebb7.JPG\" style=\"cursor: default; width: 222.28915662650604px; height: 125px; float: right; margin: 0px 0px 10px 10px; \" alt=\"\"&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=\"http://127.0.0.1/websites/my-books/img/timbthumb.php?src=http://127.0.0.1/websites/my-books/assets/2/children/test_09.JPG&amp;q=100&amp;w=180&amp;h=130\" alt=\"imagetitle\" style=\"cursor: default; \"&gt;dsd sdsdsd s ds ffdfdf &lt;/p&gt;\\r\\n', '', '2012-10-08 20:42:05', 0, 2, 'draft'),\n(12, 5, '', 'Teachers Final Test 33', '&lt;p&gt;ds sd sd sd sd  dsdsd dsd sd s &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tweety&lt;/p&gt;\\r\\n', '', '2012-10-12 12:19:45', 31, 2, 'draft'),\n(30, 6, '', 'Boys High Choir', '&lt;p&gt;sasassa&lt;/p&gt;', '', '2012-10-14 09:55:08', 0, 2, 'draft'),\n(32, 0, '', 'Story Not Mine ID 5', '&lt;p&gt;dsd sd sd s ds ds ds sd sd &lt;/p&gt;\\r\\n', '', '2012-10-14 12:21:36', 0, 2, 'draft');\n</code></pre>\n\n<p>Among these there is 1 record that has a child_id set to 0. This record belongs to the child_id's in the 2nd table.</p>\n\n<p>2nd table</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `story_groups` (\n  `id` int(10) NOT NULL AUTO_INCREMENT,\n  `child_id` int(10) NOT NULL,\n  `story_id` int(10) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=112 ;\n\n\n\nINSERT INTO `story_groups` (`id`, `child_id`, `story_id`) VALUES\n(40, 7, 30),\n(41, 8, 30),\n(107, 8, 32),\n(108, 9, 32),\n(109, 11, 32),\n(110, 12, 32),\n(111, 5, 32);\n</code></pre>\n\n<p>So I want to get all stories/posts for a child. Including the Group Stories.</p>\n\n<p>I have tried UNION matching and a bunch of JOIN combinations but I just cant crack it.</p>\n\n<p>It is probably a simple JOIN operation which I just cant crack.</p>\n\n<p>Could somebody please help me write my query to include the rows from the story_groups table?</p>\n"},{"tags":["sql","query","search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12877476,"title":"SQL: Searching at least 2 similar rows between different tables","body":"<p>This is my current setup:<br>\nI have 2 tables, <strong>RECIPE</strong> and <strong>INGREDIENTS</strong>.<br>\n<strong>RECIPE</strong> holds the <em>ID</em> among other data. <strong>INGREDIENTS</strong> has X rows needed for each RECIPE.<br>\nHow can one match 2 recipes with at least 2 matching ingredients?<br>\nI can do it specifying which ingredient must match, but my problem is when the recipe has more than 10 ingredients and I need two recipes that uses the same 2 ingredients, not knowing which ones.<br>\nSorry my English, is not my natural language. I'll post more details if needed, or if I wasn't clear enough.<br>\n<br>\nPratical example:<br>\nRecipe 1 has: fish, potatoes and salt.<br>\nRecipe 2 has: turkey and rice.<br>\nRecipe 3 has: fish, rice and salt.<br>\nRecipe 4 has: turkey, potatoes and salt.<br>\n<br>\nResult based on recipe 1 should be: 4<br>\nResult based on recipe 2 should be: None<br>\nResult based on recipe 3 should be: 1<br>\nResult based on recipe 4 should be: 1<br>\n(Yep, I need to run every recipe based on a filter not explained here)<br></p>\n"},{"tags":["python","django","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":6494350,"title":"Want to display the latest note entry only in Django","body":"<p>I have another Django form that stores notes and again it has the user, client and datetime stored automatically. What I want to do this time is create some note form that allows you to add a note for a particular client, and every time you add a note it displays the <strong>latest result and only</strong> the latest result in the <code>client_details.html</code>template. So every time add a new note it will keep on replacing the existing note. How can I achieve this? </p>\n\n<p><strong>forms.py</strong></p>\n\n<pre><code>class NoteForm(forms.ModelForm):\n    class Meta:\n        model = models.Note\n        exclude = ('client','user','datetime')\n</code></pre>\n\n<p><strong>Views.py</strong></p>\n\n<pre><code>@login_required\ndef get_client(request, client_id = 0):\n    client = None\n    try:\n        client = models.Client.objects.get(pk = client_id)\n        notes = client.note_set.all()\n        comments = client.comment_set.order_by('-datetime')\n    except:\n        pass\n    return render_to_response('client_details.html', {'client':client, 'notes':notes, 'comments':comments}, context_instance = RequestContext(request))\n\n@login_required\n    def add_notes(request, client_id = 0):\n        client = None\n        contact = None\n        try:\n            client = models.Client.objects.get(pk = client_id)\n        except:\n            return HttpResponseNotFound()\n\n        if request.method == 'POST':\n            form = forms.NoteForm(request.POST)\n            if form.is_valid():\n                note = form.save(commit=False)\n                note.user = request.user\n                note.client = client\n                note.save(True)\n                request.user.message_set.create(message = \"Note is successfully added.\")\n                return HttpResponse(\"&lt;script language=\\\"javascript\\\" type=\\\"text/javascript\\\"&gt;window.opener.location = window.opener.location; window.close();&lt;/script&gt;\")\n        else:\n            form = forms.NoteForm()\n        return render_to_response('note_form.html', {'form':form, 'client':client}, context_instance = RequestContext(request))\n</code></pre>\n"},{"tags":["query","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":6991786,"title":"Return only the latest records","body":"<p>I have a table that tracks the completion of interval tasks. for example, item a has to be completed every 7 days, item b every 1 days, and so on. The table logs the \"nextDue\" value on insert. I need a query that will return only the latest \"nextDue\" dates that are within 3 days of becoming due. This is what I have right now:</p>\n\n<pre><code>SELECT items.id, items.shortDescription, recs.nextDue, sup.name\nFROM lut_ResponsibleParties sup INNER JOIN(\n     rec_controlCompletion recs INNER JOIN lut_controlItems items\n          ON recs.controlItem = items.id)\n     ON items.responsiblePerson = sup.id\nWHERE datediff(\"d\",Now(),recs.nextDue) &lt;= 3\n</code></pre>\n\n<p>This was close, except it is returning ALL items that are less than or equal to 3 days, even if the latest completion date is beyond that. Does that make sense? I need the query to only return items based on the latest completion date. I don't know how else to explain that. Please let me know if I can clarify.</p>\n"},{"tags":["mysql","wordpress","query","posts"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":640,"score":0,"question_id":7426023,"title":"One query to get latest 7 posts from each category in WordPress","body":"<p>I'm looking to write a SINGLE custom SQL query to retrieve the latest 7 posts from each of my 6 specific categories of a custom post type.</p>\n\n<p>I know how to query custom post types and taxonomies, but my SQL knowledge is limited. I don't know how to get WordPress to give me 7 latest posts from each of the 6 categories. It doesn't really matter in what order it's returned, as long as the content is there.</p>\n\n<p>Example: If I have categories 1, 2, 3, 4, 5, 6, I would like to retrieve the 7 latest posts from each of those categories. Specifically, the query should pull the 7 latest posts for category 1, 7 latest posts for category 2, and so forth, all with a single query.</p>\n\n<p>I don't want to have 6 separate WP_Query instances as it's not efficient.</p>\n"},{"tags":["php","mysql","database","query","time"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12874814,"title":"Database time data retrieval, time based queries","body":"<p>I am new to time manipulation or time arithmetic operations\nand am currently developing a navigation system with Web server based information and currently I have this Database that contains a table peek hours whose columns are id, start_time, end_time , edge_id, day_of_the_week, edge_weight</p>\n\n<pre><code> ------------------------------------------------------------------------\n|                  Peek Hours                                           |\n ------------------------------------------------------------------------\n|    |            |           |         |                 |             |\n| id | start_time |  end_time | edge_id | day_of_the_week | edge_weight |\n|    |            |           |         |                 |             |\n ------------------------------------------------------------------------\n</code></pre>\n\n<p>I am using PHP as a webservice and so based on the current time i want to get all the records that would fit this equation </p>\n\n<p><code>start_time&lt; current_time &lt; end_time</code></p>\n"},{"tags":["php","sql","database","query","website"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":120,"score":3,"question_id":12876921,"title":"SQL Query only retrieving one row","body":"<p>I have a a php website with some code on it to pull from a database after the user has defined some search terms and then show them a table with all their information in it</p>\n\n<p>The problem is even when i do a select * from the tables, i am only getting the first row back.</p>\n\n<p>Code:</p>\n\n<pre><code>$result = mysql_query(\"SELECT trees.*     \nFROM trees \nINNER JOIN price \nON trees.ID=price.treeid  \n\");\n\n\n$num_rows = mysql_num_rows($result);\nif($num_rows == 0) {\necho \"No rows retrieved\";\n} else {\necho $num_rows;\n}\n</code></pre>\n\n<p>i have 2 rows in my database:</p>\n\n<pre><code>Spruce  El Sorbeous Sprucious   Green   Green   Green   100     200\nits a tree ma!  true    NULL    NULL    NULL\n\nMayday  el daymay   red green   white   10  4000000\nGOING DOWN  true    Grey    true    false\n</code></pre>\n\n<p>when i print out the $num_rows up there, it is only one.\nWhen i print out my table below, there is only one row:</p>\n\n<pre><code>echo '&lt;table border = 0 cellpadding=0 &gt;';\necho '&lt;tr&gt;';\necho '&lt;td&gt;&lt;b&gt;&lt;u&gt;Name&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Latin Name&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Primary Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Secondary Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Fall Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Trunk Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;';\n\necho '&lt;td&gt;&lt;b&gt;&lt;u&gt;Description&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Height&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Spread&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Drought Resistant?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Flowering?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Fruit Producing?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;';\n\necho '&lt;/tr&gt;';\n\nwhile ($row = mysql_fetch_assoc($result)) {\n     echo '&lt;tr&gt;';\n     echo '&lt;td&gt;';\n     echo $row['name'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['latinname'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['primarycolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['secondarycolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['fallcolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['trunkcolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['description'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['height'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['spread'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['droughtresistant'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['flowering'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['fruitproducing'];\n     echo '&lt;/td&gt;';\n\n     echo '&lt;/tr&gt;';\n\n}\necho '&lt;table&gt;';\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":12876858,"title":"Why is my NULL count returning 0 in MySQL? Very basic","body":"<p>I have an 2 easy questions that are puzzling me (I am new to Mysql)</p>\n\n<p>I have a table (survey) with 3 columns, UserID (primary), SkinColor, and HairColor. I wanted to count the number of people who have a hair color that is null (they didn't answer the survey).</p>\n\n<p>I did this with:</p>\n\n<pre><code>select count(id)\nfrom survey\nwhere haircolor is null\n</code></pre>\n\n<p>But I was puzzled why I couldn't do</p>\n\n<pre><code>select count(haircolor)\nfrom survey\nwhere haircolor is null\n</code></pre>\n\n<p>It returned 0. Why is this?</p>\n\n<p>Question 2: I want to return the total number of survey respondents (all ID's), number of people with null value for hair color, and null value for skin color. I tried this query</p>\n\n<pre><code>select count(id), count(skincolor), count(haircolor)\nfrom survey\nwhere skincolor is null and haircolor is null\n</code></pre>\n\n<p>But that just returned the the count where skincolor and haircolor are both null obviously, and not an individual count for each column. Is there a way to put the WHERE constraint up in the SELECT section so I can specify different constraints for each select? </p>\n\n<p>Thanks!</p>\n"},{"tags":["query","pointers","mysql++"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12875495,"title":"Mysql++ Query fails only when the query variable is a pointer... :S","body":"<p>I am having a problem which makes me think that I don't understand something fundamental. I am using MySQL++ and when calling query.execute() (where \"query\" is an instance of class mysqlpp::Query) it works, but when calling query->execute() (where \"query\" is a pointer to an instance of class myqslpp::Query) the same query fails! The error message is \"Query was empty\".</p>\n\n<p>Here is the code I used for testing this.</p>\n\n<p>The following runs without errors, and the table is created in the database.</p>\n\n<pre><code>void test1() {\n    mysqlpp::Connection conn;\n    conn.connect(0, \"server\", \"user\", \"password\");\n    conn.select_db(\"db_name\");\n\n    mysqlpp::Query query = conn.query();\n    try {\n        query &lt;&lt; \"CREATE TABLE IF NOT EXISTS MY_TABLE (MY_COLUMN SMALLINT)\";\n        query.execute();\n    }\n    catch (const mysqlpp::BadQuery&amp;) {\n        std::cerr &lt;&lt; query.error() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>While the following produces output \"Query was empty\" and the table is not created in the database.</p>\n\n<pre><code>void test2() {\n    mysqlpp::Connection conn;\n    mysqlpp::Query *query = 0;\n    conn.connect(0, \"server\", \"user\", \"password\");\n    conn.select_db(\"db_name\");\n\n    query = &amp;conn.query();\n    try {\n        *query &lt;&lt; \"CREATE TABLE IF NOT EXISTS MY_TABLE (MY_COLUMN SMALLINT)\";\n        query-&gt;execute();\n    }\n    catch (const mysqlpp::BadQuery&amp;) {\n        std::cerr &lt;&lt; query-&gt;error() &lt;&lt; std::endl;\n    }\n    query = 0;\n}\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12869826,"title":"SQL Server Query for a DVD Rental Company","body":"<p>I've got a sample database for a movie rental business. I'm trying to write a query that finds all movie titles that are currently sold out. </p>\n\n<ul>\n<li>All DVDs for that film are currently rented. Or...</li>\n<li>No DVDs exist for that film</li>\n</ul>\n\n<p>Keep in mind I want to make sure this query doesn't capture DVDs that are in inventory but have never appeared in the rental table.</p>\n\n<p>Edit: this is what I have so far, but I can't account for the scenario in the line above^.</p>\n\n<pre><code>SELECT Count(DvdID) AS Inventory, Movie.Title\nFROM Dvd\nJOIN Movie on Dvd.MovieID = Movie.MovieID\nWHERE Dvd.DvdID IN\n    (SELECT RentalID\n    FROM Rental\n    WHERE Rental.ReturnDate IS NULL)\nOR Dvd.DvdID NOT IN\n    (SELECT Dvd.DvdID\n    FROM Dvd\n    WHERE DvdID NOT IN\n    (SELECT Rental.DvdID FROM RENTAL)\n    )\n\nGROUP BY Movie.Title\n</code></pre>\n\n<p>TABLES:</p>\n\n<h2>Movie</h2>\n\n<p>-MovieID</p>\n\n<p>-MovieTitle</p>\n\n<h2>Dvd</h2>\n\n<p>-DvdID</p>\n\n<p>-MovieID</p>\n\n<h2>Rental</h2>\n\n<p>-RentalID</p>\n\n<p>-DvdID</p>\n\n<p>-AccountID</p>\n\n<p>-RentalDate</p>\n\n<p>-ReturnDate</p>\n"},{"tags":["sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":12874183,"title":"SQL Server : get count and sum of columns","body":"<p>I am designing a website that people post text messages. users can rate the messages (1 to 5). I'm recording this ratings into a table to:</p>\n\n<ol>\n<li>avoid multiple rating by one user for the same post</li>\n<li>to be able get the average rating of a post.</li>\n</ol>\n\n<p>but I also the number of votes are important too. for example a post having 10 votes of 3 (makes 30) are valuable than the post with 2 votes of 5 (that makes 10). Now when I'm showing a page with 20 of this messages I want to show their rating too</p>\n\n<p>This is my rating table:</p>\n\n<pre><code>create table ratings(\n[id] int primary key identity(1,1),\n[msgid] int,\n[uid] int,\n[rating] tinyint\n)\n</code></pre>\n\n<p>I want to get to 20 messages from messages table with the sum of the ratings for each message and the count of ratings for each message.</p>\n\n<pre><code>select \n    msg.id, msg.text,\n    sum(rate.rating), \n    count(rate.id) \nfrom \n    messages as msg \ninner join \n    ratings as rate on msg.id = rate.msgid \ngroup by \n    msg.id\n</code></pre>\n\n<p>can any one please help me with the SQL query code?</p>\n"},{"tags":["ajax","wordpress","query","loops","category"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":571,"score":3,"question_id":10483925,"title":"Filtering the loop by category using Ajax in Wordpress","body":"<p>Well, I have been looking everywhere for hours and hours and it seems like there's so many ways to do this, since I have never used Ajax before and have little knowledge of havascript, its become too hard for me.</p>\n\n<p>I have the loop on my front page (index) or wordpress and I want to have a filter, a dropdown menu with different categories, that when clicked, the only posts showing in that same screen are the ones from that category. I need the loop to be refreshed with ajax, so the whole page is still left intact while you use the filter.</p>\n\n<p>this is what i have on my Index file:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://www.google.com/jsapi\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;google.load(\"jquery\", \"1.2.6\")&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n$(function(){\n     $('#main_cat').change(function(){\n         var $mainCat=$('#main_cat').val();\n          $(\"#sub_cat\").empty();\n              // call ajax\n                  $.ajax({\n\n              url:\"&lt;?php bloginfo('wpurl'); ?&gt;/wp-admin/admin-ajax.php\",       \n              type:'POST',\n              data:'action=my_special_ajax_call&amp;main_catid=' + $mainCat,\n              success:function(results)\n              {\n            //  alert(results);\n              $('#sub_cat *').fadeOut(500);\n              $('#sub_cat + p').fadeOut(500);\n              $(\"#sub_cat\").append(results);\n                  $('#sub_cat').load('http://localhost:8888/public_html/wp-content/themes/twentyten-child/templateloop.php');\n              $('#sub_cat + p').fadeIn(1);\n                  }\n                      });\n\n            }\n    );\n});\n</code></pre>\n\n<p>The dropdown with the categories goes like this:</p>\n\n<pre><code>&lt;?php\nwp_dropdown_categories('show_count=0&amp;selected=-1&amp;hierarchical=1&amp;depth=1&amp;hide_empty=0&amp;exclude=1&amp;show_option_none=Main Categories&amp;name=main_cat');\n?&gt;\n</code></pre>\n\n<p>So, the dropdown works, and it's supposed to ajax load a wp template file with a query filtering only one category (grabbed from the wp_dropdown_categories). And the loading works fine if I have a dummy text in the templateloop.php file, but when I have the wp query, nothing happens. the #sub_cat div, which is where the loop is located and was supposed to be switched by the template file just dissapears with all the post listing and im left only with the top half of the page (until where the #sub_cat div used to be).</p>\n\n<p>There has been so much trial and error, ive tried with the query call in the template file, in the index file, in the functions, i never seem to get any result.</p>\n\n<p>on my functions.php file ive got this:</p>\n\n<pre><code>function implement_ajax() {\nif(isset($_POST['main_catid']))\n            {\n              echo '&lt;?php $paged = (get_query_var(\"paged\")) ? get_query_var(\"paged\") : 1; query_posts(\"cat='.$_GET['maincatid'].'&amp;paged=$paged\"); ?&gt;';\n\n            die();\n            } // end if\n}\nadd_action('wp_ajax_my_special_ajax_call', 'implement_ajax');\nadd_action('wp_ajax_nopriv_my_special_ajax_call', 'implement_ajax');//for users that are not logged in.\n</code></pre>\n\n<p>and the query line i used to use before all this, in the index file is:</p>\n\n<pre><code>       &lt;?php $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n query_posts(\"cat=1,2,3,4,5&amp;paged=$paged\"); ?&gt;\n</code></pre>\n\n<p>i've tried using the wp_query but it's just going nowhere, i really need guidance. Any help is appreciated. thank you.</p>\n"},{"tags":["c#","linq","query","data"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":12873855,"title":"C# Groupby Linq and foreach","body":"<p>I need a more efficient way of producing multiple files from my data group.\nIm using a <code>List&lt;MyObject&gt;</code> type and my object has some public properties in which I need to group the data by.</p>\n\n<p>I have heard of <em>Linq</em> and it sounds like something I could use. However Im not sure how to go about it.</p>\n\n<p>I need to produce a text file for each STATE, so grouping all the <code>MyObjects</code> (people) by state, then running a <code>foreach</code> look on them to build the TEXT file.</p>\n\n<pre><code>void Main()\n{\n\n    List&lt;MyObject&gt;   lst = new List&lt;MyObject&gt;();\n    lst.Add(new MyObject{ name = \"bill\", state = \"nsw\", url = \"microsoft.com\"});\n    lst.Add(new MyObject{ name = \"ted\",  state = \"vic\", url = \"apple.com\"});\n    lst.Add(new MyObject{ name = \"jesse\", state = \"nsw\", url = \"google.com\"});\n    lst.Add(new MyObject{ name = \"james\", state = \"qld\", url = \"toshiba.com\"});\n\n    string builder = \"\";\n    foreach (MyObject item in myObjects)  {\n\n        builder += item.name + \"\\r\\n\";\n        builder += item.url + \"\\r\\n\" + \"\\r\\n\\r\\n\";\n\n    }\n\nand out to the `StreamWriter` will be the filenames by state. \n</code></pre>\n\n<p>In total for the above data I need 3 files;</p>\n\n<pre><code>-nsw.txt\n-vic.txt\n-qld.txt\n</code></pre>\n"},{"tags":["mysql","query","date","select","ranges"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12873067,"title":"MySQL query date ranges","body":"<p>I have googled but did not find anything related. I have a MySQL table like this:</p>\n\n<pre>\n+++++++++++++++++++++++++++++++\n| roomID |    date    | price |\n+++++++++++++++++++++++++++++++\n|  1     | 2012-10-10 |   10  |\n|  1     | 2012-10-11 |   10  |\n|  1     | 2012-10-12 |   10  |\n|  1     | 2012-10-13 |   12  |\n|  2     | 2012-10-10 |   15  |\n|  2     | 2012-10-11 |   15  |\n|  2     | 2012-10-12 |   15  |\n|  2     | 2012-10-13 |   16  |\n|  2     | 2012-10-14 |   16  |\n|  2     | 2012-10-15 |   16  |\n+++++++++++++++++++++++++++++++</pre>\n\n<p>I need to get periods based on price and roomID:</p>\n\n<pre>\n++++++++++++++++++++++++++++++++++++++++++++\n| roomID |    from    |    till    | price |\n++++++++++++++++++++++++++++++++++++++++++++\n|    1   | 2012-10-10 | 2012-10-12 |   10  |\n|    1   | 2012-10-13 | 2012-10-13 |   12  |\n|    2   | 2012-10-10 | 2012-10-12 |   15  |\n|    2   | 2012-10-13 | 2012-10-15 |   16  |\n++++++++++++++++++++++++++++++++++++++++++++</pre>\n\n<p>Thank you!</p>\n"},{"tags":["php","mysql","query","relationship"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12872830,"title":"Find related artists - php and mysql","body":"<p>I just read a lot about finding related data with php and mysql. Maybe a little bit too much, because now I'm just totally confused, which is the right and easiest way for me.</p>\n\n<p>I have a table of artists, which can be tagged. I save the relationship between artists and tags in an extra table.</p>\n\n<p>So its</p>\n\n<p><code>artist_id | artist_name</code> , <code>artistXtag | artist_id | tag_id</code> and <code>tag_id | tag_name</code></p>\n\n<p>For my point of view only the artistXtag table is interesting for finding related artists, because all the relationships are made up in this table.</p>\n\n<pre><code>id   artist_id tag_id\n1        1       1\n2        2       1\n3        3       1\n4        2       2\n5        3       2\n6        1       3\n7        5       4\n8        4       4\n9        5       1\n10       3       4\n</code></pre>\n\n<p>So now i just want to find out which artists has the most overlaps of tags, based on one input artist_id for example \"1\" and the result sorted by the number of overlaps.</p>\n\n<p>In the End i want to have a function get_related_artists(id) and want to get an array of the most related artists as an result.</p>\n\n<p>I found some functions like this</p>\n\n<pre><code>SELECT t.item_id FROM tags t\n  JOIN tag_names tn\n    ON t.tag_id = tn.tag_id\nGROUP BY\n  t.item_id\nHAVING\n  COUNT(DISTINCT t.tag_id) = (SELECT COUNT(*) FROM tag_names)\n</code></pre>\n\n<p>which should do something like i want, but to be honest i do not understand this query at all :( I know basic mysql stuff like Joins etc. but i have problems to understand the query i want to have would work.</p>\n\n<p>Is it clear, what i want to do?</p>\n"},{"tags":["sql","query","sqlite","select","string-comparison"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12871988,"title":"SQL case sensitive string comparison with like and \"=\"","body":"<p>i have one table named category.</p>\n\n<p>in this table i have two columns 1st is cat_id, 2nd is cat_name.</p>\n\n<p>in this table i have added record with this value : cat_id = 1, cat_name = test</p>\n\n<p>Now when i am going to run select query</p>\n\n<pre><code>SELECT * FROM category WHERE cat_name = 'Test'\n</code></pre>\n\n<p>this query returns me null result. Instade of null result i want the result with 1st record.</p>\n\n<p>also i want same result in vice versa small and capital string.</p>\n\n<p>i am using sqlite as database.</p>\n"},{"tags":["php","mysql","xml","query","issues"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12870803,"title":"php query for iOS latitude and longitude not searching for nearby mysql lat and lon with a xml output","body":"<p>I am trying to get the output of the lat and lon coordinates from ios (this is working fine), send it to php to query with MySQL and have the php emit an xml document back to ios(this step is not working because it is refusing to read an uploaded data entry from mysql), then parsing it on iOS UItableview (this is working fine too). I am trying to get this to work with XML because parsing xml on iOS is really simple for me and I've gotten a simpler xml script running already on it, but probably due to mistakes from inexperience in php, I cannot get this php script working. What am I doing wrong in my php script? Thanks!</p>\n\n<pre><code>&lt;?php\n{ $lat = (float)$_GET['lat']; } //ios get \"lat\" value from: NSString *urlString = [NSString stringWithFormat:@\"http://www.mysite.com/loc.php?lat=%g&amp;lon=%g\", latitude, longitude];\n{ $lon = (float)$_GET['lon']; } //ios get \"lon\" value from: NSString *urlString = [NSString stringWithFormat:@\"http://www.mysite.com/loc.php?lat=%g&amp;lon=%g\", latitude, longitude];\n$minlat = $lat-.1;\n$maxlat = $lat+.1;\n$minlon = $lon-.1;\n$maxlon = $lon+.1;\n$dbh = new PDO('(censored personal information)');\n$sql = 'SELECT lat, lon, name FROM locations WHERE lat &gt;= ? AND lat &lt;= ? AND lon &gt;= ? AND lon &lt;= ?';\n$params = array( $minlat, $maxlat, $minlon, $maxlon );\n$q = $dbh-&gt;prepare( $sql );\n$q-&gt;execute( $params );\n$doc = new DOMDocument();\n$r = $doc-&gt;createElement( \"locations\" );\n$doc-&gt;appendChild( $r );\nforeach ( $q-&gt;fetchAll() as $row) {\n  {\n    $e = $doc-&gt;createElement( \"location\" );\n    $e-&gt;setAttribute( 'name', $row['name'] );\n    $e-&gt;setAttribute( 'd', $d );\n    $r-&gt;appendChild( $e );\n  }\n}\nprint $doc-&gt;saveXML();\n?&gt;\n</code></pre>\n"},{"tags":[".net","query","mongodb","datetime","mongodb-csharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12831025,"title":"How do I resolve a year/month/day date to a more specific date with time data in MongoDB?","body":"<p>I'm working on converting my blog over to use <code>/year/month/day</code> type URLs. I've ran into a pretty bad problem with the concept though. I want to only have down to hour/minute resolution, but of course all of my entries are stored with a full time specific as possible(and I don't want to change that). </p>\n\n<p>How exactly do I go about resolving a specific date to a less specific date with MongoDB? I'm using 10gen's official MongoDB mapper for .Net. </p>\n\n<p>My data-model looks like:</p>\n\n<pre><code>public class BlogEntryData{\n    [BsonId]\n    public ObjectId ID;\n    public string Title;\n    public string Text;\n    public DateTime Posted;\n    public DateTime Edited;\n    public List&lt;string&gt; Tags;\n    [BsonDefaultValue(true)]\n    public bool Publish;\n}\n</code></pre>\n\n<p>and I get an entry for my blog using</p>\n\n<pre><code>var c=Config.GetDB().GetCollection&lt;BlogEntryData&gt;(\"entries\");\nBlogEntryData entry;\ntry{\n    entry=c.FindOneByIdAs&lt;BlogEntryData&gt;(new ObjectId(RouteParams[\"id\"]));\n}catch{\n    throw new HttpException(404,\"Blog entry not found\");\n}\nif(entry==null){\n    throw new HttpException(404,\"Blog entry not found\");\n}\n</code></pre>\n\n<p>I'm know how to change it to use instead of ID something like a numerical search field or whatever, but I've never queried against dates.</p>\n\n<p>Also, as an aside, would it be better to store the \"URL date\" denormalized as a string in my entry model? I'd only want to do this if indexes didn't work properly on dates or something</p>\n"},{"tags":["php","mysql","xml","query","script"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12870393,"title":"php query for iOS latitude and longitude to search for nearby mysql lat and lon with a xml output issue","body":"<p>I am trying to get the output of the lat and lon coordinates from ios (this is working fine), send it to php to query with MySQL and have the php emit an xml document back to ios(this step is not working), then parsing it on iOS UItableview (this is working fine too). I am trying to get this to work with XML because parsing xml on iOS is really simple for me and I've gotten a simpler xml script running already on it, but probably due to mistakes from inexperience in php, I cannot get this php script working. What am I doing wrong in my php script? Thanks!</p>\n\n<pre><code>&lt;?php\n{ $lat = (float)$_GET['lat']; }\n{ $lon = (float)$_GET['lon']; }\n$minlat = $lat-.1;\n$maxlat = $lat+.1;\n$minlon = $lon-.1;\n$maxlon = $lon+.1;\n$dbh = new PDO('(censored personal information)');\n$sql = 'SELECT lat, lon, name FROM locations WHERE lat &gt;= ? AND lat &lt;= ? AND lon &gt;= ? AND lon &lt;= ?';\n$params = array( $minlat, $maxlat, $minlon, $maxlon );\n$q = $dbh-&gt;prepare( $sql );\n$q-&gt;execute( $params );\n$doc = new DOMDocument();\n$r = $doc-&gt;createElement( \"locations\" );\n$doc-&gt;appendChild( $r );\nforeach ( $q-&gt;fetchAll() as $row) {\n  {\n    $e = $doc-&gt;createElement( \"location\" );\n    $e-&gt;setAttribute( 'name', $row['name'] );\n    $e-&gt;setAttribute( 'd', $d );\n    $r-&gt;appendChild( $e );\n  }\n}\nprint $doc-&gt;saveXML();\n?&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12227236,"title":"2 JOINS MYSQL and LIMIT 1","body":"<p>I have 3 tables and want to make a sql query to proper view them.</p>\n\n<p>1.) Zakaz</p>\n\n<pre><code>id | Comment\n</code></pre>\n\n<p>2.) Tovar</p>\n\n<pre><code>id  | id_clients | zakaz\n</code></pre>\n\n<p>3.) Users</p>\n\n<pre><code>id | name\n</code></pre>\n\n<p>They are connected as:</p>\n\n<pre><code>zakaz.id = tovar.zakaz\ntovar.id_clients = users.id\n</code></pre>\n\n<p>I want to see</p>\n\n<pre><code>zakaz.id | users.name  \n</code></pre>\n\n<p>BUT I want to limit only to 1 string per zakaz, so I did:</p>\n\n<pre><code>SELECT zakaz.id, zakaz.comment, tovar.id_clients\n    FROM zakaz\n    JOIN tovar ON zakaz.id = tovar.zakaz\nGROUP BY zakaz.id\n</code></pre>\n\n<p>and then I want to JOIN users but it doesnt work</p>\n\n<pre><code>SELECT zakaz.id, zakaz.comment, tovar.id_clients, users.name\n    FROM zakaz\n    JOIN tovar ON zakaz.id = tovar.zakaz\n    GROUP BY zakaz.id\nJOIN users ON users.id = tovar.id_clients\n</code></pre>\n"},{"tags":["mysql","sql","database","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12766733,"title":"How to Avoid Complete Table Scan in Database?","body":"<p>I want to creating a website where users can sign up in website and upload 20 images to their account. (planning to allow users to upload unlimited images in future)</p>\n\n<p>I have two tables in database.\nOne for keeping user data\nTable name - members\nFields- userid, username, password, email.\nOther for saving image path\nTable name- images\nFields - userid, imagepath</p>\n\n<p>So I can display images of a user in his page searching image path from table 'images'</p>\n\n<p>Things are working fine. But if the number of users grow this will become slower.\nFor example - If there is 50000 users I should check all the rows to find images uploaded by a single user\nie;\n50000 userid * 20 images/user = 1000000 scans for table rows\nThis will make the system slow and make overload.\nWhat I should do to avoid this?</p>\n"},{"tags":["sql","query","scala","macros","compilation"],"answer_count":3,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":159,"score":9,"question_id":11777278,"title":"What's the recommended way to pass the results of macro computations to run-time?","body":"<p>I'm trying to build some SQL-like abstraction and I have hit a problem.</p>\n\n<p>This is a simplified “database table”:</p>\n\n<pre><code>trait Coffee {\n  def id: Long\n  def name: String\n  def brand: String\n}\n</code></pre>\n\n<p>This is my query abstraction:</p>\n\n<pre><code>import language.experimental.macros\n\nobject Query {  \n  def from[T] = \n    macro QueryMacros.fromMacro[T]\n}\n\nclass From[T] {  \n  def select[S](s: T =&gt; S): Select[T] =\n    macro QueryMacros.selectMacro[T, S]\n}\n\nclass Select[T] {\n  def where(pred: T =&gt; Boolean): Where =\n    macro QueryMacros.whereMacro[T]\n}\n\nclass Where(val result: String)\n</code></pre>\n\n<p>This is my macro implementation:</p>\n\n<pre><code>import scala.reflect.macros.Context\n\nobject QueryMacros {\n  val result = new StringBuilder\n\n  def fromMacro[T : c.WeakTypeTag](c: Context): c.Expr[From[T]] = { \n    result ++= (\"FROM \" + c.weakTypeOf[T])\n    c.universe.reify(new From[T])\n  }\n\n  def selectMacro[T : c.WeakTypeTag, S : c.WeakTypeTag](c: Context)(s: c.Expr[T =&gt; S]): c.Expr[Select[T]] = {\n    result ++= (\"SELECT \" + s.tree)\n    c.universe.reify(new Select[T])\n  }\n\n  def whereMacro[S](c: Context)(pred: c.Expr[S]): c.Expr[Where] = {\n    result ++= (\"WHERE \" + pred.tree)\n    c.universe.reify(new Where(result.toString))\n  }\n}\n</code></pre>\n\n<p>And this is my example code:</p>\n\n<pre><code>object Main extends App {\n  println(\"Query start\")\n  val query = \n    Query.from[Coffee]\n         .select(_.id)\n         .where(_.brand == \"FairTrade\")\n\n  println(query.result)\n  println(\"Query end\")\n}\n</code></pre>\n\n<p>It compiles and runs fine, but the output is:</p>\n\n<pre><code>Query start\n\nQuery end\n</code></pre>\n\n<p>Basically, <code>result</code> seems to be empty. I expected that it would hold the accumulated strings of the trees.</p>\n\n<p>How can I pass my data from the macro compile stage to the next stage, so it shows up at runtime?\nI could of course pass the current string to the next method  explicitly, but I would like to avoid that.</p>\n"},{"tags":["mysql","query","row","column"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12868047,"title":"Make row names of one table columns of the other MySQL","body":"<p>I don't know if this is possible or not.\nI have <code>Table1</code> with the following fields.</p>\n\n<pre><code>No\n\nA\nB\nC\nD\n</code></pre>\n\n<p>I want <code>table2's</code> column names to be table1's row names (varchar(20) each, all null's)</p>\n\n<pre><code>A B C D\n</code></pre>\n\n<p>If I add a row in table1, table2 column should get appended too.</p>\n\n<p>Any suggestions. </p>\n"},{"tags":["python","query","google-app-engine","gae-datastore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12868184,"title":"GAE Chaining Queries through tables","body":"<p>I have these models (below). I want to run a query that gets 10 recent entries from Result  where the \"site\" ReferenceProperty is one of mine, based on the \"users\" in Site.</p>\n\n<p>I tried:</p>\n\n<pre><code>user = users.get_current_user()\nsites = Site.all().filter('user =', user).order('name')\nresults = Result.all().filter('site IN', sites).fetch(limit=10)\n</code></pre>\n\n<p>The user and sites queries work, but the results one is not working because \"sites\" is not a list.</p>\n\n<pre><code>from google.appengine.ext import db\n\nclass Site(db.Model):\n\nusers = db.ListProperty(db.Key)\nname = db.StringProperty(required=True)\nslug = db.TextProperty(required=True)\nurl = db.TextProperty(required=True)\npage = db.TextProperty()\nactive = db.BooleanProperty()\nblackboard = db.BooleanProperty()\n\n\nclass Result(db.Model):\n\nsite = db.ReferenceProperty(Site)\ntimestamp = db.DateTimeProperty(auto_now_add=True)\nstatus = db.StringProperty(required=True)\nreason = db.StringProperty(required=True)\nheaders = db.TextProperty()\nextra_info = db.TextProperty()\n</code></pre>\n"},{"tags":["c#","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":12866274,"title":"C# SQL Query in public DataTable","body":"<p>I have this public DataTable that I am trying to run an sql query in, but the dang thing wont work...</p>\n\n<pre><code>public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)\n    {\n        cn = new SqlConnection(objCommon.IpcConnectionString);\n        cmd = new SqlCommand(\"select * from dbo.OrderTransaction_Master where orderID = \" + orderID, cn);\n        cmd.CommandType = CommandType.Text;\n        cn.Open();\n        cmd.ExecuteNonQuery();\n        cn.Close();\n    }\n</code></pre>\n\n<p>I get a red line under <code>get_OrderTransaction_Master_ByOrderID</code> saying</p>\n\n<pre><code>Error   3   'OrderTransaction_Master.get_OrderTransaction_Master_ByOrderID(long)': not all code paths return a value    C:\\IPC\\App_Code\\OrderTransaction_Master.cs  32  22  http://localhost/ipc/\n</code></pre>\n\n<p>What Am I doing wrong?</p>\n"},{"tags":["performance","query","innodb","longtext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12863549,"title":"query very slow longtext field innodb table","body":"<p>Well, firts of all, sorry by my english. I try to do a query in a table that the users can include some text, like a blog page. The users can design the content in a html format. In my table it is stored like this:</p>\n\n<pre><code>Estad&amp;amp;iacute;sticas&amp;lt;br /&amp;gt;\n&amp;lt;table border=&amp;quot;0&amp;quot;&amp;gt;\n&amp;lt;tbody&amp;gt;\n&amp;lt;tr&amp;gt;\n&amp;lt;td&amp;gt;Columna 1&amp;lt;/td&amp;gt;\n&amp;lt;td&amp;gt;Columna 2&amp;lt;/td&amp;gt;\n&amp;lt;/tr&amp;gt;\n&amp;lt;tr&amp;gt;\n&amp;lt;td&amp;gt;Columna 3&amp;lt;br /&amp;gt;&amp;lt;/td&amp;gt;\n&amp;lt;td&amp;gt;Columna 4&amp;lt;br /&amp;gt;&amp;lt;/td&amp;gt;\n&amp;lt;/tr&amp;gt;\n&amp;lt;/tbody&amp;gt;\n&amp;lt;/table&amp;gt;\n</code></pre>\n\n<p>I must serch in that content all that user's want. The field 'texto' (that I'm using for it) is a longtext field and the table is innodb. I can't use full text search, 'cause it is only for myisam tables. I made the query as:</p>\n\n<pre><code>\"SELECT * FROM texto WHERE texto like '%$variable%'\"\n</code></pre>\n\n<p>but the query is very, very slow, an it take an eternity. The table has a 849 records, that's isn't big. If I write the same query in a phpmyadmin also take a very, very long time. But there are big records in this field, some records have the video html, tables, images, but it's just that, text like the above.</p>\n\n<p>What I can do??? How can improve the performance of the query??? I appreciate all your help. Thanks a lot. And again, sorry for my english.</p>\n"},{"tags":["c#","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12867227,"title":"C# SQL query not returning anything","body":"<p>I have the public DataTable here and the code looks right, but its not returning anything, the OrderID is correct, the query itself is correct, its not returning anything...can anyone tell me why?</p>\n\n<pre><code>public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)\n    {\n\n        cn = new SqlConnection(objCommon.IpcConnectionString);\n        cn.Open();\n\n        string query = \"select transactionID from dbo.OrderTransaction_Master where orderID = \" + orderID;\n        SqlCommand queryCommand = new SqlCommand(query, cn);\n        SqlDataReader queryCommandReader = queryCommand.ExecuteReader();\n        DataTable dataTable = new DataTable();\n        dataTable.Load(queryCommandReader);\n        cn.Close();\n        return dataTable;\n\n    }\n</code></pre>\n"},{"tags":["android","database","query","sqlite","android-sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12849622,"title":"Delete Query And Refresh in ListView in Android (sqlite)","body":"<p>I'm new to Java, Android, and SQLite, and I'm stuck at this. I have columns, namely <code>_id</code> (autoincrement), <code>type</code>, <code>amount</code> (int), <code>category</code>, and <code>description</code>. Three queries.</p>\n\n<p>Firstly, I am not able to delete a transaction (row) retrieved from database. (Please refer to the attached Logcat). </p>\n\n<p>Secondly, I need to know how to refresh the ListView after deleting the entry.</p>\n\n<p>And third, the silly issue I think. If I open the database once and retrieve data, it does so. Further, without closing the database, if I delete a transaction it does not delete it and gives the error \"database not open\". Further, if I close the database after retrieval and then open again at the time of deletion, it works. I dont get it. Main issue is the first one, but please answer if you know any of the above</p>\n\n<pre><code>    final ListView lv = getListView();\n    localArrayList.clear();                //To Stop the silly repeating issue\n    localDbCrud = new DbCrud(this);\n    localAdapter = new SimpleAdapter(\n            this,\n            localArrayList,\n            R.layout.transaction_list_item,\n            new String[]{\"Amount\",\"Category\",\"Date\",\"Description\"},\n            new int[]{R.id.tli_amount,R.id.tli_category,R.id.tli_date,R.id.tli_desc});\n\n    localDbCrud.open();\n    DbCrud.getAllTransaction();             //Using HashMap localHashMap , localHashMap.put(localArrayList) in loop\n    localDbCrud.close();\n    lv.setOnItemLongClickListener(new OnItemLongClickListener() {\n\n        public boolean onItemLongClick(final AdapterView&lt;?&gt; arg0, View arg1,\n                 final int arg2, final long arg3) {\n            // TODO Auto-generated method stub\n            AlertDialog.Builder ladbuilder = new Builder(TransactionList.this);\n            ladbuilder.setTitle(\"Choose Your Option\");\n            ladbuilder.setItems(R.array.alertdialog_prompt, new DialogInterface.OnClickListener() {\n\n                public void onClick(DialogInterface dialog, int selected_item) {\n                    // TODO Auto-generated method stub\n                    if (selected_item == 0){\n                        localDbCrud.open();\n                        HashMap itemMap = (HashMap)localAdapter.getItem(arg2);\n                        int item_id =(Integer) itemMap.get(\"Id\");\n                        DbCrud.deleteTransaction(item_id);\n                        //final int ite=  (Integer) arg0.getItemAtPosition(arg2);\n                         // final int item_id = c.getInt(c.getColumnIndex(DbCrud.TN_ID));\n                        //DbCrud.deleteTransaction(item_id);\n                        localDbCrud.close();\n\n                    }\n                    else{\n\n\n                        //update code\n\n                    }\n                }\n            });\n            AlertDialog localad = ladbuilder.create();\n            localad.show();\n\n\n            return false;\n        }\n    });\n\n    localDbCrud.close();\n\n    setListAdapter(localAdapter);\n\n}\n</code></pre>\n\n<p>Logcat</p>\n\n<pre><code>10-13 01:21:26.804: E/AndroidRuntime(22023): FATAL EXCEPTION: main\n10-13 01:21:26.804: E/AndroidRuntime(22023): java.lang.ClassCastException: java.lang.String\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.hishighness.budgetracker.TransactionList$1$1.onClick(TransactionList.java:62)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.app.AlertController$AlertParams$3.onItemClick(AlertController.java:878)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.AdapterView.performItemClick(AdapterView.java:284)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.ListView.performItemClick(ListView.java:3701)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.AbsListView$PerformClick.run(AbsListView.java:1970)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Handler.handleCallback(Handler.java:587)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Handler.dispatchMessage(Handler.java:92)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Looper.loop(Looper.java:130)\n    10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.app.ActivityThread.main(ActivityThread.java:3687)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at java.lang.reflect.Method.invoke(Method.java:507)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at dalvik.system.NativeStart.main(Native Method)\n</code></pre>\n\n<p>here's the getallTransaction() function.This is the only trace of hash map in my project</p>\n\n<pre><code>    public static void getAllTransaction(){\n\n    Cursor localCursor = localDatabase.query(true, TN_TABLE, null, null, null, null, null, null, null) ;\n    if (localCursor != null) {\n\n        localCursor.moveToFirst();\n            do{\n                HashMap&lt;String,String&gt; temp = new HashMap&lt;String,String&gt;();\n                temp.put(\"Amount\", localCursor.getString(localCursor.getColumnIndex(\"amount\")));\n                temp.put(\"Category\", localCursor.getString(localCursor.getColumnIndex(\"category\")));\n                temp.put(\"Date\", localCursor.getString(localCursor.getColumnIndex(\"date\")));\n                temp.put(\"Description\", localCursor.getString(localCursor.getColumnIndex(\"description\")));\n                temp.put(\"Id\", localCursor.getString(localCursor.getColumnIndex(\"_id\")));\n                TransactionList.localArrayList.add(temp);\n\n\n\n            }while (localCursor.moveToNext());\n\n    }\n</code></pre>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12753865,"title":"Update field1 when field2 is duplicated","body":"<p>I would like to update latitude and longitude location from different records when their site_id is the same. </p>\n\n<p>For example if </p>\n\n<pre><code>ID | SiteID | Latitude | Longitude\n1      5      74.4545   -35.5466\n2      6      74.4545   -35.5466\n3      5      75.4584   -45.5966\n4      6      79.6545   -36.5496\n</code></pre>\n\n<p>I would like Records 3 and all the others that match SiteID 5 to take the Latitude and Longitude of Record 1. Similarly Records 2 and 4</p>\n\n<p>How can I do this in mysql.</p>\n"},{"tags":["php","mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":9,"view_count":50,"score":-9,"question_id":12867094,"title":"i need help to make function in php","body":"<p>i want to make a function on hotel management system in php if customer's net dues or amounts remaining are still not clear or still remaining in mysql database then checkout button disabled else customer's net dues or amounts remaining are null then enable checkout button. How can i make this type of function in php with mysql database please help thanks in advance</p>\n"},{"tags":["php","mysql","sql","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12866655,"title":"SQL query not in return specific result","body":"<p>I'm trying to create query to not include the cars where the part_id = '1'. This works, but the car continues to show up because the car_id is associated with multiple other part_id's.</p>\n\n<p>Here's my query:</p>\n\n<pre><code>SELECT\n    distinct car.car_id, \n             part.description\nFROM car\nJOIN car_parts part on (car.car_id = part.car_id)\nWHERE part.part_id &lt;&gt; '1'\n</code></pre>\n\n<p>My table: car_parts</p>\n\n<pre><code>Car ID | Part ID\n   1        1\n   1        3\n   1        4\n   2        2\n   2        5\n   2        7\n   3        1\n   3        4\n   3        9\n   4        1\n</code></pre>\n\n<p>The only car_id that should be returned from the query is car_id = 2.</p>\n"},{"tags":["mysql","sql","query","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12865027,"title":"mysql queries based on a previous (mysql root password change) query","body":"<p>I have some methods to perform mysql queries using JDBC in the following sequence (with parameters of course):</p>\n\n<pre><code>testMysql(); \nchangeUserPassword(); \nflushPrivileges(); \nsomeMoreMethodsUsingNewPassword();\n</code></pre>\n\n<p>The result for these methods are</p>\n\n<pre><code>succes\nfail\nfail\nfail\n</code></pre>\n\n<p>The first one only succeeds after closing my application. I restart and see that the password has been changed.</p>\n\n<p>Now, why didnt it reflect imediately after the 3rd (<code>flushPrivileges()</code>) and why didnt it make <code>someMoreMethodsUsingNewPassword()</code> as success?</p>\n\n<p>well I am editing it from here</p>\n\n<p>I discovered that flushing priviliges is compulsory. As up to method 3 (flushprivs) is ok in the backend.</p>\n\n<p>I am using a method for all initializations as similer to this:</p>\n\n<pre><code>if(main.MainDB.changeUserPassword(host, user, pass/*old*/, newPassword)){\n    resultTextArea.setText(resultTextArea.getText()+\"\\r\\n\"\n            + \"- Root password change \\t\\t\\t\\t\\t Success !\");\n}else{\n    resultTextArea.setText(resultTextArea.getText()+\"\\r\\n\"\n            + \"- Root password change \\t\\t\\t\\t\\t Failed !\");\n}\n</code></pre>\n\n<p>and I always get failed results, despite success is in the back end.</p>\n\n<p>So any one knows whats wrong?</p>\n\n<pre><code>public static boolean testMysql(String host, String user, String password) {\n    Connection con = null;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, password);\n        Statement stmt = con.createStatement();\n        boolean b = stmt.execute(\"show tables\");\n        con.close();\n        return b;\n    } catch (ClassNotFoundException | SQLException e) {\n        ErrorLogging.errorLog(e.toString());\n        e.printStackTrace();\n        return false;\n    } \n}\npublic static boolean changeUserPassword(String host, \n                                         String user, \n                                         String prevPass, \n                                         String newPass) {\n    Connection con = null;\n    int num = 0;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, prevPass);\n        PreparedStatement pStmt = con.prepareStatement(\n            \"update user set password=PASSWORD(?) where User=?\");\n        pStmt.setString(1, newPass);\n        pStmt.setString(2, user);\n        //  PreparedStatement pStmt = con.prepareStatement(\n        //  \"SET PASSWORD FOR ?@? = PASSWORD(?)\");\n        //  pStmt.setString(1, user);\n        //  pStmt.setString(2, host);   \n        //  pStmt.setString(3, newPass); \n        num = pStmt.executeUpdate();\n        con.close();\n    } catch (ClassNotFoundException | SQLException e) {\n        main.ErrorLogging.errorLog(e.toString());\n    } \n    if(num == 1){\n        return true;\n    }else{\n        return false;\n    }  \n}\n\npublic static boolean flushPrivileges(String host, \n                                      String user, \n                                      String password) {\n    Connection con = null;\n    int num = 0;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, password);\n        PreparedStatement pStmt = con.prepareStatement(\n            \"flush privileges\");\n        num = pStmt.executeUpdate();\n        con.close();\n    } catch (ClassNotFoundException | SQLException e) {\n        main.ErrorLogging.errorLog(e.toString());\n    } \n    if(num == 1){\n    return true;\n    }else{\n    return false;\n    }  \n}\n</code></pre>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12865935,"title":"how to write a fieldValue.contains(\"someString\") query in MongoDB that works for find and aggregation functions","body":"<p>I need to implement fieldValue.contains(\"someString\") search in MongoDB query?</p>\n\n<p>the solution that I found is </p>\n\n<pre><code>db.main.find(  { $where: \"this.content.indexOf('someString') != -1\" } );\n</code></pre>\n\n<p>and it works fine for a find function.</p>\n\n<p>but when I do the same in Aggregation function</p>\n\n<pre><code>db.foo.aggregate(\n    {\n        $match: \n                { $where: \"this.content.indexOf('someString') != -1\" }\n    },\n    {\n        $project :\n                {\n                    _id : 1,\n                    words : 1\n                }\n    },\n    {\n        $unwind : \"$words\"\n    },\n    {\n        $group : {\n                    _id : { tags : \"$words\" },\n                    count : { $sum : 1 }\n                }\n    },\n    {\n        $sort: {count:-1}\n    },\n    {\n        $limit : 5\n    }\n);\n</code></pre>\n\n<p>I've got this result:</p>\n\n<pre><code>{\n        \"errmsg\" : \"exception: $where is not allowed inside of a $match aggregation expression\",\n        \"code\" : 16395,\n        \"ok\" : 0\n}\n</code></pre>\n\n<p>The question: how to write a fieldValue.contains(\"someString\") query in MongoDB that works for find and aggregation functions.</p>\n"},{"tags":["sql","query","max","min","lag"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12856659,"title":"Check Sequence in Max Min Values","body":"<p>I have a database table that Stores Maximum and Minimum Price Breaks for a Product.\n<img src=\"http://i.stack.imgur.com/WBj4S.jpg\" alt=\"enter image description here\"></p>\n\n<p>Does anyone know of the SQL which say if I have a break from one Max to the Min of the next item.  E.g. 1-10 12-20  I would like it to return me either the numbers that are missing or at the very least a count or bool if it can detect a break from the Absolute Min and the Absolute Max by going through each range.</p>\n\n<p>SQL Server (MSSQL) 2008</p>\n"},{"tags":["query","mongodb","sorting","geospatial"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":508,"score":8,"question_id":6003943,"title":"Find most recent & closest posts, limit 20","body":"<p>Let's say I have a bunch of posts (for a feed, like a Twitter/Facebook/foursquare feed) in MongoDB, and each post has a <a href=\"http://www.mongodb.org/display/DOCS/Geospatial+Indexing\" rel=\"nofollow\">location</a> &amp; a <a href=\"http://www.mongodb.org/display/DOCS/Timestamp+Data+Type\" rel=\"nofollow\">timestamp</a>.</p>\n\n<p>What's the best way to get the most recent &amp; closest posts, limited to 20 posts?</p>\n\n<p>This is also a subjective question. Let's say that you can specify <code>$maxDistance</code> and the max time since now (I'm not sure how you'd do it otherwise.). How would you specify them? Would you sort by most recent or closest, or keep it random or sort some other way? Which sorting algorithm do you think is most interesting?</p>\n"},{"tags":["php","html","mysql","query","get"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12865435,"title":"PHP GET with multiple where clause in mySQL","body":"<p>Afternoon Stackers, </p>\n\n<p>Having a rough time with a PHP/mySql query through $_GET. </p>\n\n<p><strong><em>What I would like to accomplish</em></strong>\nUsing $_GET run a mySql query similar to the following URL:\n<code>http://localhost/searchresults.php?clause1=ABC&amp;clause2=XYZ</code></p>\n\n<p>Pull specific data from a table using the <em>WHERE = '' AND = ''</em> </p>\n\n<p>.......<br>\nI currently have a similar script in play using the following code string(s):</p>\n\n<p>i) Search string is created utilizing <code>$_POST['tableColumn']</code> data (currently working in a single WHERE clause)<br>\nii) searchstring passed via URL to .php page _http://localhost/example.php?clause=somesearch (this is working well but needs to include a second search clause)<br>\niii) <code>$search = searchQuery('search', 'example.php');</code><br>\niv) searchQuery defined as  </p>\n\n<pre><code>function searchQuery ($id, $location) {\nif (isset($_GET[$id])) {\n    return $_GET[$id];\n} elseif (isset($_POST[$id])) {\n    return $_POST[$id];\n} else {\n    header(\"Location: $location\");\n    exit;\n}\n}\n</code></pre>\n\n<p>v) search is run utilizing the URL $_GET data and runs with the script:</p>\n\n<pre><code>function pullQuery($read, $clause) {\n$sql = \"SELECT * FROM `table` WHERE `clause` = '$clause'\";\nreturn $read-&gt;fetchAll($sql);\n}\n</code></pre>\n\n<p>So up to this point things work out well, the single clause works just fine, my problem is creating a multiple clause search query. What would need to be modified to make this work. In effect the modified \"pullQuery\" would look like:</p>\n\n<pre><code>function pullQuery($read, $clause, $clause2) {\n$sql = \"SELECT * FROM `table` WHERE `clause` = '$clause' AND `clause2' = '$clause2'\";\nreturn $read-&gt;fetchAll($sql);\n}\n</code></pre>\n\n<p>Now this is far as I have gone in mySql cli.. this works but what needs to be done to make a link like: <code>http://localhost/example.php?clause=somesearch&amp;clause2=anothersearch</code></p>\n\n<p>Any help would be appreciated, have a wonderful weekend.</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12863606,"title":"SQL Optimization : How to optimize the query in MySQL?","body":"<p>I am writing a SQL query which requires highly optimized solution, so as to not timeout. But I have got no idea of how to continuously optimize the following SQL query:</p>\n\n<pre><code>select distinct j.job,f.path,p.path \nfrom fixes f, jobs j, paths p where f.job=j.id and p.id =f.path \nand (p.path like '//Tools/Web/%' or p.path = '//Tools/Web');\n</code></pre>\n\n<p>I have created indexes on the following fields(essentially everything):</p>\n\n<ul>\n<li>jobs.id</li>\n<li>jobs.job</li>\n<li>paths.path</li>\n<li>paths.id</li>\n<li>fixes.job</li>\n<li>fixes.path</li>\n</ul>\n\n<p>In each of the \"fixes\", \"jobs\", \"paths\" table there are ~50,000 rows, and current timeout is 6 min</p>\n\n<h3>The 'explain' command shows the following information, try to deciphering</h3>\n\n<pre><code>1   SIMPLE  j   index   PRIMARY         job     62   (null)    73226    Using index; Using temporary\n1   SIMPLE  f   ref     path,job        job     8    j.id      825  \n1   SIMPLE  p   eq_ref  PRIMARY,path    PRIMARY 8    f.path    1        Using where\n</code></pre>\n\n<h3>The table creation statements for the 'paths' table:</h3>\n\n<pre><code>CREATE TABLE `paths` (\n   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n   `path` varchar(250) NOT NULL,\n   PRIMARY KEY (`id`),\n   UNIQUE KEY `path` (`path`),\n ) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n"},{"tags":["android","query","httpresponse","bufferedreader"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12855301,"title":"android calling php but response isn't readable","body":"<p>I'm trying to query from a php script as the following: </p>\n\n<pre><code>http://xxxx.com/ccvo/mel-asset-data/query.php?lon=144.963620993985&amp;lat=-37.8140023779914&amp;within=20&amp;category=Litter Bin\n</code></pre>\n\n<p>The results from the webpage query will be in plain text like the following: </p>\n\n<pre><code>4|Litter Bin,-37.8141472000103,144.963691391683,17.2492037024|Litter Bin,\n37.8141472763581,144.963685395193,17.0753971521|Litter Bin,\n37.8139653160326,144.963765797949,13.3704129156|Litter Bin,\n37.8139469233985,144.963755935562,13.3613106302\n</code></pre>\n\n<p>I need to pass values to the four parametsers. My code so far is getting error 200 which means it has access to the web. Also, the query is formated well, and when do Log.d I get the following: </p>\n\n<pre><code>query[lon=144.963620993985, lat=-37.8140023779914, within=4, keyword=Litter Bin]\n</code></pre>\n\n<p>Then I need to parse the results as the following: \nnumber of results, (lon and lat), within, keyword</p>\n\n<p>my could is: </p>\n\n<pre><code>    public class myMapService extends AsyncTask&lt;String, Void, Integer&gt; {\n        private ProgressDialog progressDialog;\n        private keyword activity;\n        private int id = -1;\n        private String rst = \" \" ; \n\n\n        public myMapService(keyword activity, ProgressDialog progressDialog)\n        {\n            this.activity = activity;\n            this.progressDialog = progressDialog;\n        }\n\n        @Override\n        protected void onPreExecute()\n        {\n            progressDialog.show();\n        }\n\n\n        @Override\n        protected Integer doInBackground(String... arg0) {\n            String result = \"\";\n            int responseCode = 0;\n            try \n            {\n                HttpClient client = new DefaultHttpClient();\n                HttpPost httppost = new HttpPost(\"http://xxxx.com/ccvo/mel-asset-data/query.php\");\n\n                List&lt;NameValuePair&gt; nameValuePairs = new ArrayList&lt;NameValuePair&gt;();\n                nameValuePairs.add(new BasicNameValuePair(\"lon\", \"144.963620993985\"));\n                nameValuePairs.add(new BasicNameValuePair(\"lat\", \"-37.8140023779914\"));\n                nameValuePairs.add(new BasicNameValuePair(\"within\", \"20\"));\n                nameValuePairs.add(new BasicNameValuePair(\"keyword\", \"Litter Bin\"));\n            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs,HTTP.UTF_8));\n\n            Log.v(\"URL\", \" with query\" + nameValuePairs);\n\n            int executeCount = 0;\n            HttpResponse response;\n            do\n            {\n                progressDialog.setMessage(\"Passing paratmeters.. (\"+(executeCount+1)+\"/5)\");\n                // Execute HTTP Post Request\n                executeCount++;\n                response = client.execute(httppost);\n                responseCode = response.getStatusLine().getStatusCode();                        \n                // If you want to see the response code, you can Log it\n                // out here by calling:\n                // Log.d(\"256 Design\", \"statusCode: \" + responseCode)\n                //InputStream content = response.getEntity().getContent();\n\n\n               // Log.d(\"256 Design\", \" Response print\" + response);\n\n\n            } while (executeCount &lt; 5 &amp;&amp; responseCode == 408);\n\n\n            BufferedReader rd = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));\n            StringBuilder sb = new StringBuilder();\n\n            //Log.d(\"Results\", \" Inside whileloops \" + rd);\n\n            String line;\n            while ((line = rd.readLine()) != null)\n            {\n                result = line.trim();\n                sb.append(line);\n\n                rst = result.toString();\n\n\n\n            }\n\n\n            Log.v(\"Results\", \"rst \" + sb);\n            id = Integer.parseInt(result);\n\n        }\n\n\n\n        catch (Exception e) {\n            responseCode = 408;\n            e.printStackTrace();\n        }\n\n        Log.d(\"Results\", \"from web: \" + rst);\n\n\n        return responseCode;\n\n    }\n\n\n\n@Override\nprotected void onPostExecute(Integer headerCode)\n{\n    progressDialog.dismiss();\n\n}\n}\n</code></pre>\n\n<hr>\n\n<p>when I do Log.d to the response or the BufferedReader , I get something like this : </p>\n\n<pre><code>-java.io.BufferedReader@40fc93c8\n-printorg.apache.http.message.BasicHttpResponse@40f746b8\n</code></pre>\n\n<p>I need help please to get the results and parse them. </p>\n\n<p>Thank you,\nA. </p>\n"},{"tags":["mysql","performance","query","group-concat"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12864693,"title":"Mysql, group_concat performance: split huge table","body":"<p>I've a huge table (231,451,584 rows, 14 columns, 15.1 GiB size). </p>\n\n<p>The last 3 columns have data that will be \"group_concated\" into 3 different tables (resuming the number of rows to ≈2,500 by eliminate the redundancy of the first 11 columns and merging the values of columns #12 or #13 or #14 into a big comma separated, csv formatted text).</p>\n\n<p>This operation (the group_concat insert on each new table) takes a huge time (≈18.000 seconds per new table).</p>\n\n<p>It should be fast if I split my first table into 3 (same 11 columns first, and just a last one with the different values I want to concat, for each new table)?</p>\n\n<p>I'm asking this here because it takes to long to get a benchmark for my case... </p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12863652,"title":"adding a column if record exists in two tables","body":"<p>I have two tables.  One is a list of all categories. The other is a list of categories a thing might belong to. A thing can belong to more than one category (it might have more than one record in table two)</p>\n\n<p>So, I have </p>\n\n<p>table: </p>\n\n<pre><code>categories \n1,   horror\n2,   romance\n3,   post modern\n4,   Canadian\n5,    English\n\n...\n2340  \n</code></pre>\n\n<p>Then another table, thingsToCategories, with two columns (thingID, categoryID)</p>\n\n<pre><code>thingID   categoryID\n6323-01    1\n6323-01    4\n6323-01    5\n1342-01    2\n1342-01    4\n</code></pre>\n\n<p>Given a thingID, I need a list of all categories (as in select * from table A), with an indication of whether that thing ID exists in table B</p>\n\n<p>So, given thingID of 6323-01, I need a list like this:</p>\n\n<pre><code>1,   horror    selected\n2,   romance\n3,   post modern\n4,   Canadian   selected\n5,    English   selected\n</code></pre>\n\n<p>My SQL skills are rusty and bad enough I'm not even sure what sort of join to use.  Can anyone give any pointers?</p>\n\n<p>(I inherited this database, fwiw)</p>\n"},{"tags":["php","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12544758,"title":"How to find the table name which the image randomly selected from","body":"<p>i have a query to randomly select 6 images from 3 sql table in same database and once some one clicked on that image i want to send them to separate page according from what table that image is selected from. to do that by the query i want to find out the table name which that random image was selected. \nmy sql query is </p>\n\n<pre><code>$sql=\"SELECT *\nFROM   salehotel\nUNION ALL\nSELECT *\nFROM   saleland\nUNION ALL\nSELECT *\nFROM   salehouse\nORDER BY RAND()\nLIMIT 6\n\";\n$result=mysql_query($sql)or die(mysql_error());\n?&gt;\n&lt;?php\n        while($row = mysql_fetch_array($result))\n        {?&gt;\n    &lt;div style=\"float: left; margin-left: 10px;\"&gt;\n        &lt;a href=\"sale_house_detail.php?id=&lt;?php echo $row['property_id'];  ?&gt;\"&gt;\n            &lt;img src=&lt;?= '\"admin/uploads/'.$row['image1'].'\"'; ?&gt; width=\"172px\" height=\"149px\" style='border:5px solid  #CCC' /&gt;\n        &lt;/a&gt;\n    &lt;p&gt;&lt;?php  echo $row['Type']; ?&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;?php  echo $row['Location']; ?&gt;&lt;/p&gt;\n  &lt;/div&gt;\n\n    &lt;?php   }\n    ?&gt;\n</code></pre>\n"},{"tags":["android","database","query","sqlite","assets"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12832421,"title":"Read only SQLite DB update in assets folder for new app version","body":"<p>At the moment I am fiddling myself into working with sql databases in android and created my first app. now i wanted to update this app and the including database in the assets folder. I overwrote the old database with the new one but on my phone it doesnt show the new entries.</p>\n\n<p>It somehow is saving the old entries/queries or entirely the old Db. I checked on the net but couldnt really find a solution. Below my dbhelper code. Do i have to do something in <code>onUpgrade</code> or what would be the procedure?</p>\n\n<p>Many thanks for helping!</p>\n\n<pre><code>public class DataBaseHelper extends SQLiteOpenHelper {\nprivate static String DB_PATH;\n\nprivate static String DB_NAME;\n\nprivate SQLiteDatabase db_object;\n\nprivate final Context context;\n\npublic DataBaseHelper(Context context, String db) {\n    super(context, db, null, 80);\n    this.context = context;\n    DB_PATH = \"/data/data/\" + context.getPackageName() + \"/databases/\";\n //   DB_PATH = \"/data/data/com.comp.appname/databases/\";\n    DB_NAME = \"mydatabase.sqlite\";\n    try {\n        createDataBase();\n    } catch (IOException ioe) {\n        throw new Error(\"Unable to create database\");\n    }\n    try {\n        openDataBase();\n    } catch (SQLException sqle) {\n        throw sqle;\n    }\n}\n\n@Override\npublic void onCreate(SQLiteDatabase db) {\n    // TODO Auto-generated method stub\n}\n\n@Override\npublic void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n    // TODO Auto-generated method stub\n}\n\npublic void createDataBase() throws IOException {\n    boolean dbExist = checkDataBase();\n    if (dbExist) {\n    } else {\n        this.getReadableDatabase();\n        try {\n            copyDataBase();\n        } catch (IOException e) {\n            throw new Error(\"Error copying database\");\n        }\n    }\n}\n\nprivate boolean checkDataBase() {\n    SQLiteDatabase checkDB = null;\n    try {\n        String myPath = DB_PATH + DB_NAME;\n        checkDB = SQLiteDatabase.openDatabase(myPath, null,\n                SQLiteDatabase.OPEN_READONLY);\n    } catch (SQLiteException e) {\n    }\n    if (checkDB != null) {\n        checkDB.close();\n    }\n    return checkDB != null ? true : false;\n}\n\nprivate void copyDataBase() throws IOException {\n    InputStream myInput = context.getAssets().open(DB_NAME);\n    String outFileName = DB_PATH + DB_NAME;\n    OutputStream myOutput = new FileOutputStream(outFileName);\n    byte[] buffer = new byte[1024];\n    int length;\n    while ((length = myInput.read(buffer)) &gt; 0) {\n        myOutput.write(buffer, 0, length);\n    }\n    myOutput.flush();\n    myOutput.close();\n    myInput.close();\n}\n\npublic void openDataBase() throws SQLException {\n    String myPath = DB_PATH + DB_NAME;\n    db_object = SQLiteDatabase.openDatabase(myPath, null,\n            SQLiteDatabase.OPEN_READONLY);\n}\n\n@Override\npublic synchronized void close() {\n    if (db_object != null)\n        db_object.close();\n    super.close();\n}\n}\n</code></pre>\n"},{"tags":["mysql","query","left-join","tornado"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12860806,"title":"Exclusive queries, left outer join or addition of queries","body":"<p>I have two tables:</p>\n\n<pre><code>nets_permissions\n\n    user_id INT NOT NULL,\n    network_id BIGINT UNSIGNED NOT NULL,\n    perm INT(3) NOT NULL,\n    PRIMARY KEY(user_id, network_id)\n\n\ndevices_permissions\n\n    user_id INT NOT NULL,\n    network_id BIGINT UNSIGNED NOT NULL,\n    device_id INT UNSIGNED NOT NULL,\n    perm INT(3) NOT NULL,\n    PRIMARY KEY(user_id, network_id, device_id),\n</code></pre>\n\n<p>The <code>nets_permissions table</code> has permissions for each user. A user can have a different perm values: 1 for read permission, 2 for write permission, 4 for read+commands permission. The net admin have a perm value of 3.</p>\n\n<p>Same thing for the second table, but this time for the devices that are in the specific net. The users are added to this table when the admin of the net and devices give them a permission. But the admin of the net is not registered in this table. He is only in the nets_permission table with perm=3. </p>\n\n<p>I have to create a query that select the permission of the current user in an handler of Tornado Web Server. The code is in this form:</p>\n\n<pre><code># Retrieve the current user \n    usr = self.get_current_user()\n    usr_id = usr['id']\n    self.lock_tables(\"read\", ['nets_permissions as n, devices_permissions as d'])\n    usrperm = self.db.query(\"SELECT * FROM nets_permissions as n \n         LEFT OUTER JOIN devices_permissions as d \n              ON n.network_id = d.network_id WHERE d.user_id=%s \n                 AND d.device_id=%s\", \n         int(usr_id), sens.id);\n    self.unlock_tables()\n</code></pre>\n\n<p>In usr_id I retrieve is the id of the current user. </p>\n\n<p>The current user can be the admin of the net (so he is only in the table nets_permissions with perm=3) or a user with some permission on the specific device (so he is only in the devices_permissions table with some value for perm). </p>\n\n<p>In the query result 'userperm' I would use an integer to compare after in the html page with a permission value and to show or not something to the user.</p>\n\n<p>Sorry for my English but is difficult explain for me the problem. I don't know I can structure the query to obtain this result I want.</p>\n\n<p>Thank you very much for your help.</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12862535,"title":"Selecting chained records from a table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/53108/is-it-possible-to-make-a-recursive-sql-query\">Is it possible to make a recursive SQL query?</a>  </p>\n</blockquote>\n\n\n\n<p>Imagine an application where one would want to keep a history of the changes made to a 'record' in a database.</p>\n\n<p>This can be realized by introducing a column 'revised_id' which points to the newer version of the record.</p>\n\n<pre><code>id  value                               revised_id\n--------------------------------------------------\n1   Initial value...                    3\n2   Value of a different record         Null\n3   Value which has been altered        4\n4   Value which has been altered again  Null\n</code></pre>\n\n<p>The table illustrates two 'actual records', one of which has been altered two times</p>\n\n<p>Getting all the latest versions simply means adding revised_id = null to the WHERE clause. To get the previous version simply: SELECT * FROM table WHERE revised_id = $current_id</p>\n\n<p>My questing is: would it be possible to select all te previous versions of a given record?(The problem being that simple comparisons do not suffice because the records to be selected are 'chained' together.)</p>\n"},{"tags":["php","mysql","query","drop-down-menu","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12861936,"title":"Filtering MYSQL data using dropdown boxes","body":"<p>I have populated an html page with a table from the database. I want to add dropdown boxes at the top that can filter out unnecessary data. How would I go about sending this information to the database to make a query so that I can filter out data with multiple variables?</p>\n\n<p>For example, I have 5 categories, A, B, C, D, and E.\nI have used PHP code to populate the boxes with the possible values/entries for A, B, C, D, and E. I've also added a \"NULL entry\" in case the user does not want to include this column as part of the filter.</p>\n\n<p>So right now as it stands, for the respective columns we can have:</p>\n\n<pre><code>Apple, always, as, amazing, as, almonds, NULL.\nBelly, boosts, bad, NULL.\nCandy, can, create, NULL.\nDandy, does, do, don't, NULL.\nElements, exist, NULL.\n</code></pre>\n\n<p>How would I go about sending the information to the database when the variables are indefinite? They may or may not be set.</p>\n\n<p>I figured I'd start by seeing if the variables were set in the first place by using the isset(), but how would I proceed from there? It seems like a lot of 'if' statements. All I need to do is to change the query based on the values of the variables the user enters. But I don't see an easy way of doing that.</p>\n\n<p>I'll simply be adding \"WHERE A = this AND B = that AND C = thisthat AND ..\" to the end of the query but what if one or more or all of those entries are null? </p>\n\n<p>Thanks a lot for any help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12861520,"title":"Non linear, three way sum of table data","body":"<p>My <a href=\"http://sqlfiddle.com/#!2/0dc39\" rel=\"nofollow\">table</a></p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       BadAd             2\napple        21       Lead              5\napple        21       DNC               6\napple        21       pajs              2\norange       34       Lead              9\norange       34       disks             3\norange       34       BadAd             8\norange       34       pajs              5\n</code></pre>\n\n<p>My attempt</p>\n\n<pre><code> SELECT sum(calls) FROM (SELECT y.calls, y.user_name, y.status FROM stats\n INNER JOIN\n (select user_name, status, sum(calls) as calls\n from stats WHERE status = ('BadAD', 'Lead', 'DNC')\n group by user_name, status) y\n ON y.user_name = stats.user_name\n GROUP BY y.status) w WHERE w.user_name = y.username\n</code></pre>\n\n<p>My problem: I am trying to add up the values from the <code>calls</code> field of rows that only contain a certain <code>status</code> field value (<code>WHERE status = ('BadAD', 'Lead', 'DNC')</code>) and has the same user_name. So it would look like this.</p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       BadAd             13           (BadAd 2 + Lead 5 + DNC 6)\norange       34       Lead              17           (etc..)\n</code></pre>\n"},{"tags":["mysql","query","mongodb","express","mongoose"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12858902,"title":"How can i repeat MySQL's WHERE 1 query in MongoDB?","body":"<p>I can do this in MySQL:</p>\n\n<pre><code>WHERE 1 AND 1 AND 1\n</code></pre>\n\n<p>How can i repeat it in MongoDB? What is MongoDB's equivalent for WHERE 1 ?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>So. I don't know how choose best answer ^^ and expanded question. As @mark-hillick noticed - i'm searching the best way to build query.\nNow I'm using this way (express+mongoose):</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>//req.query - get/post object in Express\n\nfor (var q in req.query) {\n  if (req.query[q]) { //simplified example\n    query[q] = req.query[q];\n  };\n}\n\nCollection.find(query)\n</code></pre>\n\n<p>Your suggestions?</p>\n"},{"tags":["sql-server","performance","query","large-data"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12460602,"title":"Large SQL Server database timing out PHP web application","body":"<p>We are running a hospital system which is web based created in PHP. The system was initially fast due to small size of the database but now it has become slow.</p>\n\n<p>The following is an example query</p>\n\n<pre><code>select pa.id, pa.date as date, pa.visitno, pa.receiptno, pa.debitnoteno, pad.id as padid,\n pad.serviceid as serviceid, pad.waitno, pa.paytype, s.id as doctorid, s.fullname as\n doctorname, p.id as patientid, p.name as patient, p.regno, p.age, p.gender, p.doc,\n p.department, p.telno, p.address, pa.ins_prov_id, ip.name as provider,\n pa.sicksheet_billcode as billcode, ds.id as serviceid, ds.name as servicename, ds.departid\n as departid, ds.servicetype as servicetype, pad.charge, pad.status as status, ts.id as\n timeslotid, ts.name as timeslot, pad.treatment, sd.anesthesiologist, sd.hospitalcharge,\n sd.anesthcharge from patientappointments as pa\nINNER JOIN patientappdetails as pad ON pa.id = pad.patappid \nINNER JOIN patients as p ON pa.patid = p.id \nINNER JOIN staffs as s ON pad.doctorid = s.id \nLEFT JOIN departmentalservices as ds ON pad.serviceid = ds.id \nLEFT JOIN insproviders as ip ON pa.ins_prov_id = ip.id \nLEFT JOIN timeslots as ts ON pad.timeslotid = ts.id \nLEFT JOIN surgerydetails as sd ON sd.appdetid = pad.id \nwhere 1 = 1 and pa.date &gt;= '01.Jul.2012' and ds.departgroupid = 16 and pad.charge != 0\n</code></pre>\n\n<p>As you can see the size of our queries (call them un-optimized) which shows the patient, doctor, service taken, what time and which ins company he came from. So now we created indexes that did help for a while but now again the speed has become slow. Running the system on localhost results in around 15 secs for the result to appear while on the live system, <strong>it times out</strong>.</p>\n\n<p>Can you suggest any method to improve the speed and exactly how to implement them. </p>\n\n<p>Just FYI, rows in each table are as follows:</p>\n\n<ul>\n<li>patientappdetails - 195k</li>\n<li>patients - 34k</li>\n<li>staffs - 200</li>\n<li>departmentalservices - 700</li>\n<li>insproviders - 2800</li>\n</ul>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12835851,"title":"Find closest location with longitude and latitude using linq c#","body":"<p>i am working on a application where i need to get nearby location, \nmy web service will receive 2 parametrs (decimal longitude, decimal latitude )</p>\n\n<p>i have a table where the locations are saved in database with longitude and latitude fields,</p>\n\n<p>i want to retrieve the nearest locations.</p>\n\n<p>can anyone help ?</p>\n\n<p>Thanks</p>\n\n<p>here is my code</p>\n\n<pre><code> var locations = from l in locations\n\n     select l\n</code></pre>\n\n<p>Here are further details about this :\ni have a 2 fields (decimal(18, 2) null) 1 latitude, 2 longitude inside a database table,</p>\n\n<p>and i have a method </p>\n\n<pre><code>public List&lt;Locations&gt;  GetLocation(decimal? Long, decimal? lat) \n{\nvar Loc = from l in Locations\n  //// now here is how to get nearest location ? how to query?\n  //// i have also tried Math.Abs(l.Lat - lat) its giving error about nullable decimal always hence i have seted decimal to nullable or converted to nullable\n //// also i have tried where (l.lat - Lat) * (l.lon - Long)  this is also giving error about can not convert decimal to bool\nreturn Loc.ToList();\n}\n</code></pre>\n"},{"tags":["java","database","query","wsdl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12845128,"title":"abstracting data-type heterogeneity of different database","body":"<p>In my current  project, I have a requirement of abstracting data-type heterogeneity among different database.</p>\n\n<p>For instance,  I have a table in MySQL database. Table name is <code>FIRSTTABLE(badgeID *Integer* , pref INT)</code>.</p>\n\n<p>I have a table in Apache-Derby database. Table name is <code>FIRSTTABLE (badgeID *varchar(12)*, pref INT)</code>.</p>\n\n<p>Now,  query component, which queries MySQL database and Apache Derby database at same time, has badgeID as \"double\".</p>\n\n<p>My requirement is that query-component should not know underlying database (either MySQL or Apache Derby). Its query should be independent of type of database.</p>\n\n<p>How could I resolve this issue ? My research problem is not limited to MySQL or Apach-Derby. For clarity, I have taken an example of Apache-Derby and MySQL.</p>\n"},{"tags":["performance","query","mongodb","limit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12859857,"title":"Find the next \"older\" document (performance)","body":"<p>I have a collection of posts (see the pseudo-json :-) ) : </p>\n\n<pre><code>[\n  {\"title\":\"First\",\"created\":\"2012-10-04 01:00:00\"},\n  {\"title\":\"Second\",\"created\":\"2012-10-04 03:30:00\"},\n  {\"title\":\"Third\",\"created\":\"2012-10-02 02:00:00\"}\n]\n</code></pre>\n\n<p>I am in the \"2012-10-04\" posts page and I want to know if there are older posts, just for displaying a \"next page\" button.</p>\n\n<p>I can think about a query like this:</p>\n\n<pre><code>db.posts.find({\"created\":{$lt:ISODate(\"2012-10-04\")} }).limit(1);\n</code></pre>\n\n<p>I still have to try it, but I think it will work... actually my question is:</p>\n\n<p><em>What about its performance? Will it run at the same speed with billions of documents in the collection?</em></p>\n"},{"tags":["mysql","sql","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":12859895,"title":"Mathematical SUM of multiple rows by value","body":"<p>I have a table</p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       cars              67\napple        21       bikes             85\napple        21       skates            6\napple        21       pajs              56\norange       34       bikes             9\norange       34       disks             3\norange       34       cars              21\norange       34       pajs              76\n</code></pre>\n\n<p>I want to add up all the calls for <code>status's</code> that are cars, bikes and skates only and for each user_name. I have experminted with <code>SUM</code> but after several hours of late night, earnest attempts its pretty clear to me that this is going to require more than that. Can anyone point me in the right direction please?</p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/0dc39\" rel=\"nofollow\">My Table</a></p>\n"},{"tags":["sql","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12858915,"title":"How to update all varchar, nvarchar or char field of a SQL Server database and set empty string in the place of NULL?","body":"<p>In my database there are a lot of <code>NULL</code> values. Now I need to replace all the <code>NULL</code> values and set them to empty strings instead, because my existing software has problems with <code>NULL</code>  values.</p>\n\n<p>How can I do that?</p>\n"},{"tags":["sql","query","relational-database","left-join","relation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12847000,"title":"get a query which returns items associated with categories and subcategories?","body":"<p>I want to get a query which returns all items that belong to a category and subcategories.</p>\n\n<p>Here's the setup:</p>\n\n<pre><code>CREATE TABLE [dbo].[CategoriasProductos](\n    [IdCategoria] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [Nombre] [varchar](50) NULL,\n    [Estado] [varchar](20) NULL,\n    [Descripcion] [text] NULL,\n    [IdCategoriaPadre] [int] NULL,\n    [Nivel] [nchar](10) NULL,\n CONSTRAINT [PK_CategoriasProductos] PRIMARY KEY CLUSTERED \n(\n    [IdCategoria] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\n\n\n\nCREATE TABLE [dbo].[Productos](\n    [IdProducto] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [IdCategoria] [int] NULL,\n    [IdAlmacen] [varchar](50) NULL,\n    [Codigo] [varchar](50) NULL,\n    [Nombre] [varchar](50) NULL,\n    [Descripcion] [varchar](max) NULL,\n    [Cantidad] [int] NULL,\n    [Imagen] [varchar](max) NULL,\n    [StockMin] [int] NULL,\n    [StockMax] [int] NULL,\n    [Ancho] [varchar](50) NULL,\n    [Alto] [varchar](50) NULL,\n    [Largo] [varchar](50) NULL,\n    [Peso] [varchar](50) NULL,\n    [Volumen] [varchar](50) NULL,\n    [Color] [varchar](50) NULL,\n    [Material] [varchar](50) NULL,\n    [Presentacion] [varchar](50) NULL,\n    [bitPrecioVentaUnico] [int] NULL,\n    [PrecioCompra] [money] NULL,\n    [DescuentoCompra] [float] NULL,\n    [PrecioVenta] [money] NULL,\n    [DescuentoVenta] [float] NULL,\n    [Estado] [varchar](20) NULL,\n CONSTRAINT [PK_Productos] PRIMARY KEY CLUSTERED \n(\n    [IdProducto] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY]\n</code></pre>\n\n<p>Now to add some data (at least for the categories only)</p>\n\n<pre><code>SET IDENTITY_INSERT [dbo].[CategoriasProductos] ON\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (1, 1, N'0')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (2, 1, N'1')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (3, 1, N'1')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (4, 2, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (5, 2, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (6, 4, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (7, 4, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (10, 5, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (11, 5, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (14, 3, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (15, 3, N'2')\nSET IDENTITY_INSERT [dbo].[CategoriasProductos] OFF\n</code></pre>\n\n<p>(I only inserted the data that I know that will or might be requiered for the query. Also, I have more rows in my original database but inserted fewer just to not make this anymore convoluted)</p>\n\n<p>Now, for the moment I tried this query out:</p>\n\n<pre><code>SELECT Productos.Codigo, Productos.Nombre, Productos.Descripcion, A.Nombre AS Categoria\nFROM Productos LEFT OUTER JOIN\nCategoriasProductos AS A ON Productos.IdCategoria = A.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS B ON B.IdCategoriaPadre = A.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS C ON C.IdCategoriaPadre = B.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS D ON D.IdCategoriaPadre = C.IdCategoria\nWHERE (A.IdCategoria = 1)\n</code></pre>\n\n<p>Also a picture of how I constructed the query:\n<a href=\"http://imageshack.us/a/img841/7029/pruebau.jpg\" rel=\"nofollow\">http://imageshack.us/a/img841/7029/pruebau.jpg</a></p>\n\n<p>Now... in the query, it states that if A.IdCategoria = 1, (in this case) it should display all products that their IdCategoria either equals to 1 or equals another value that is somehow linked to IdCategoria 1 (in the Categorias Table).</p>\n\n<p>Another example could be if I instead type WHERE B.IdCategoria = 2...\nThen it should only show products which have an IdCategoria of 2, 4, 5, 6, 7, 10 or 11.</p>\n\n<p>I tried with this query and it did not work. Maybe I'm not using joins in the correct way...</p>\n\n<p>I was wondering if someone could please tell me what I'm doing wrong here, or what I have to add to the query to make it work...</p>\n\n<p>I hope you can help me\nThanks in advance</p>\n"},{"tags":["mysql","sql","performance","query"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12858224,"title":"Why doesn't this query run?","body":"<p>I have this query that isn't finishing (I think the server runs out of memory)</p>\n\n<pre><code>SELECT fOpen.*, fClose.*\nFROM (\n    SELECT of.*\n    FROM fixtures of\n        JOIN (\n            SELECT MIN(id) id\n            FROM fixtures\n            GROUP BY matchId, period, type\n        ) ofi ON ofi.id = of.id\n) fOpen\nJOIN (\n    SELECT cf.*\n    FROM fixtures cf\n        JOIN (\n            SELECT MAX(id) id\n            FROM fixtures\n            GROUP BY matchId, period, type\n        ) cfi ON cfi.id = cf.id\n) fClose ON fClose.matchId = fOpen.matchId AND fClose.period = fOpen.period AND fClose.type = fOpen.type\n</code></pre>\n\n<p>This is the EXPLAIN of it:</p>\n\n<p><img src=\"http://i.stack.imgur.com/EP83o.png\" alt=\"\"></p>\n\n<p>Those 2 subqueries 'of' and 'cf' take about 1.5s to run, if I run them separately.</p>\n\n<p>'id' is a PRIMARY INDEX and there is a BTREE INDEX named 'matchPeriodType' that has those 3 columns in that order.</p>\n\n<p>More info: MySQL 5.5, 512MB of server memory, and the table has about 400k records.</p>\n"},{"tags":["mysql","sql","query","foreign-keys"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12857856,"title":"mysql foregin key error 150","body":"<p>i am trying to create an order management system \nbut after creating base tables ie (<code>Suppliers,Customers,Categories,Employees,Shippers</code>)\ni go to next level with creating product and orders, i am able to add foregin keys in those table.\nnow i added last level table <code>oderDetail</code> and trying to add foregin key to OrderID and ProdcuID but it just gives me error 150\nmysqldump</p>\n\n<pre><code>-- MySQL Administrator dump 1.4\n--\n-- ------------------------------------------------------\n-- Server version   5.5.8\n\n\n/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;\n/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;\n/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\n/*!40101 SET NAMES utf8 */;\n\n/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;\n/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;\n/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;\n\n\n--\n-- Create schema testdrive\n--\n\nCREATE DATABASE IF NOT EXISTS testdrive;\nUSE testdrive;\n\n--\n-- Definition of table `categories`\n--\n\nDROP TABLE IF EXISTS `categories`;\nCREATE TABLE `categories` (\n  `CategoryID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `Description` varchar(45) NOT NULL,\n  `Picture` blob,\n  PRIMARY KEY (`CategoryID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `categories`\n--\n\n/*!40000 ALTER TABLE `categories` DISABLE KEYS */;\n/*!40000 ALTER TABLE `categories` ENABLE KEYS */;\n\n\n--\n-- Definition of table `customers`\n--\n\nDROP TABLE IF EXISTS `customers`;\nCREATE TABLE `customers` (\n  `CustomerID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `ContactName` varchar(255) NOT NULL,\n  `ContactTitle` varchar(255) NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(45) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  `Fax` varchar(255) NOT NULL,\n  PRIMARY KEY (`CustomerID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `customers`\n--\n\n/*!40000 ALTER TABLE `customers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `customers` ENABLE KEYS */;\n\n\n--\n-- Definition of table `employees`\n--\n\nDROP TABLE IF EXISTS `employees`;\nCREATE TABLE `employees` (\n  `EmployeeID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `LastName` varchar(255) NOT NULL,\n  `FirstName` varchar(255) NOT NULL,\n  `Title` varchar(255) NOT NULL,\n  `BirthDate` date NOT NULL,\n  `HireDate` date NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(45) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `HomePhone` varchar(255) NOT NULL,\n  `Extension` varchar(255) DEFAULT NULL,\n  `Photo` blob NOT NULL,\n  `Notes` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`EmployeeID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `employees`\n--\n\n/*!40000 ALTER TABLE `employees` DISABLE KEYS */;\n/*!40000 ALTER TABLE `employees` ENABLE KEYS */;\n\n\n--\n-- Definition of table `orderdetail`\n--\n\nDROP TABLE IF EXISTS `orderdetail`;\nCREATE TABLE `orderdetail` (\n  `OrderDetailID` int(10) NOT NULL,\n  `ProductID` int(10) NOT NULL,\n  `OrderID` int(10) NOT NULL,\n  `Quantity` varchar(255) NOT NULL,\n  `Discount` varchar(255) NOT NULL,\n  PRIMARY KEY (`OrderDetailID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `orderdetail`\n--\n\n/*!40000 ALTER TABLE `orderdetail` DISABLE KEYS */;\n/*!40000 ALTER TABLE `orderdetail` ENABLE KEYS */;\n\n\n--\n-- Definition of table `ordres`\n--\n\nDROP TABLE IF EXISTS `ordres`;\nCREATE TABLE `ordres` (\n  `OrderID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CustomerID` int(10) unsigned NOT NULL,\n  `EmployeeID` int(10) unsigned NOT NULL,\n  `OderDate` date NOT NULL,\n  `RequiredDate` date NOT NULL,\n  `ShippedDate` date NOT NULL,\n  `ShipperID` int(10) unsigned NOT NULL,\n  PRIMARY KEY (`OrderID`),\n  KEY `Order_Customer` (`CustomerID`),\n  KEY `Order_Employee` (`EmployeeID`),\n  KEY `Order_Shipper` (`ShipperID`),\n  CONSTRAINT `Order_Customer` FOREIGN KEY (`CustomerID`) REFERENCES `customers` (`CustomerID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Order_Employee` FOREIGN KEY (`EmployeeID`) REFERENCES `employees` (`EmployeeID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Order_Shipper` FOREIGN KEY (`ShipperID`) REFERENCES `shippers` (`ShipperID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `ordres`\n--\n\n/*!40000 ALTER TABLE `ordres` DISABLE KEYS */;\n/*!40000 ALTER TABLE `ordres` ENABLE KEYS */;\n\n\n--\n-- Definition of table `products`\n--\n\nDROP TABLE IF EXISTS `products`;\nCREATE TABLE `products` (\n  `ProductID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `ProductName` varchar(255) NOT NULL,\n  `SupplierID` int(10) unsigned NOT NULL,\n  `CategoryID` int(10) unsigned NOT NULL,\n  `QuantityPerUnit` varchar(255) NOT NULL,\n  `UnitPrice` varchar(255) NOT NULL,\n  PRIMARY KEY (`ProductID`),\n  KEY `Product_Supplier` (`SupplierID`),\n  KEY `Product_Category` (`CategoryID`),\n  CONSTRAINT `Product_Supplier` FOREIGN KEY (`SupplierID`) REFERENCES `suppliers` (`SupplierID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Product_Category` FOREIGN KEY (`CategoryID`) REFERENCES `categories` (`CategoryID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `products`\n--\n\n/*!40000 ALTER TABLE `products` DISABLE KEYS */;\n/*!40000 ALTER TABLE `products` ENABLE KEYS */;\n\n\n--\n-- Definition of table `shippers`\n--\n\nDROP TABLE IF EXISTS `shippers`;\nCREATE TABLE `shippers` (\n  `ShipperID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  PRIMARY KEY (`ShipperID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `shippers`\n--\n\n/*!40000 ALTER TABLE `shippers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `shippers` ENABLE KEYS */;\n\n\n--\n-- Definition of table `suppliers`\n--\n\nDROP TABLE IF EXISTS `suppliers`;\nCREATE TABLE `suppliers` (\n  `SupplierID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `ContractTittle` varchar(255) NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(255) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  `Fax` varchar(255) NOT NULL,\n  `HomePage` text NOT NULL,\n  PRIMARY KEY (`SupplierID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `suppliers`\n--\n\n/*!40000 ALTER TABLE `suppliers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `suppliers` ENABLE KEYS */;\n</code></pre>\n\n<p>and here is what i am trying to do</p>\n\n<pre><code>  ALTER TABLE testdrive.orderdetail\n ADD CONSTRAINT orderDetail_Product FOREIGN KEY (ProductID) REFERENCES testdrive.products (ProductID) ON UPDATE CASCADE ON DELETE CASCADE,\n ADD CONSTRAINT OrderDetail_Order FOREIGN KEY (OrderID) REFERENCES testdrive.ordres (OrderID) ON UPDATE CASCADE ON DELETE CASCADE;\n</code></pre>\n"},{"tags":["database","query","doctrine2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12858157,"title":"Query for ManyToMany Join between two tables using DOctrine 2","body":"<p>I have got two entities which are joined by a join table.</p>\n\n<p>Employee Entity</p>\n\n<pre><code>class Employee \n{    \n\n    /**\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\");\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    protected $employeeId;\n\n    /**\n     * @ORM\\Column(type=\"string\")\n     */\n    protected $employeeName;\n\n    /**\n     * @ORM\\ManyToMany( targetEntity=\"Manager\", inversedBy=\"employees\" )\n     * @ORM\\JoinTable( name=\"employee_manager\" )\n     */\n    protected $manager;\n\n    //Add and remove employee methods follow\n\n}\n</code></pre>\n\n<p>Manager Entity</p>\n\n<pre><code>class Manager\n{    \n\n    /**\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\");\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    protected $managerId;\n\n    /**\n     * @ORM\\Column(type=\"string\")\n     */\n    protected $managerName;\n\n    /**\n     * @ORM\\ManyToMany(targetEntity=\"Employee\", cascade={\"ALL\"})\n     * @ORM\\JoinTable(name=\"employee_manager\",\n     *        joinColumns={@ORM\\JoinColumn(name=\"managerId\", referencedColumnName=\"managerId\")},\n     *        inverseJoinColumns={@ORM\\JoinColumn(name=\"employeeId\", referencedColumnName=\"employeeId\")}\n     * )\n     */\n    protected $manager;\n\n}\n</code></pre>\n\n<p>DataBase Structure:</p>\n\n<pre><code>employee Table-\n-- employeeId (PK, AI)\n-- employeeName\n\nmanager Table-\n-- managerId (PK, AI)\n-- managerName\n\nemployee_manager Table-\n--managerId (PK, FK references manager.managerId)\n--employeeId (PK, FK references employee.employeeId)\n</code></pre>\n\n<p>So basically that are my entities with mappings and database structure. I can assign multiple employees to a manager and update the join table as well. Until that it was no problem.</p>\n\n<p>What I am trying to get is that, I want to retrieve the names of the employees assigned to particular manager WHERE managerId equals to.</p>\n\n<p>Is there a way how I can query this using Doctrine 2.2 or above. In other words I want to get the names of the employees assigned to a particular manager using the managerId as WHERE condition.</p>\n\n<p>Any advice would be appreciated.</p>\n"},{"tags":["java","android","query","sqlite","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12857173,"title":"Sqlite query using dates as text in android?","body":"<p>I have an app tha has in a sqlite database some measures.</p>\n\n<p>From an activity(Email Activity) the user selects which data will be sent to doctor's email(the data of last 1/7/30 days).</p>\n\n<p><img src=\"http://i.stack.imgur.com/7imZD.png\" alt=\"enter image description here\"></p>\n\n<p>This is the code of this activity:</p>\n\n<pre><code>import com.oikonomopo.blood.pressure.tracker.dao.BpDAO;\n\n...\n\npublic class EmailActivity extends Activity implements OnItemSelectedListener {\n\n    Spinner spinner;\n    String[] measures = { \"today\", \"7 days\", \"30 days\" };\n\n    private Calendar theStart;\n    private Calendar theEnd;\n    SimpleDateFormat dateFormat;\n    String start;\n    String end;\n\n    //this refers to another class for the manipulate of my table\n    private BpDAO dao = null;\n\n    private Button sendEmailBtn;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.email);\n\n        // ////////////////////////////////////\n        theEnd = Calendar.getInstance();\n        theStart = (Calendar) theEnd.clone();\n        dateFormat = new SimpleDateFormat(\"yyyy-MM-dd HH:mm\");\n        // //////////////////////////////////\n\n        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(\n                EmailActivity.this, android.R.layout.simple_spinner_item,\n                measures);\n\n        sendEmailBtn = (Button) findViewById(R.id.button1);\n        spinner = (Spinner) findViewById(R.id.spinner1);\n        spinner.setAdapter(adapter);\n        spinner.setOnItemSelectedListener(this);\n\n        // BpDao - refers to my table - see later\n        dao = new BpDAO(this);\n\n        // add a click listener to the button\n        sendEmailBtn.setOnClickListener(new View.OnClickListener() {\n            public void onClick(View v) {\n/////////////////////////////////////////////////////////////////////////////////////////\n                Log.d(\"BPT\", \"before\"); // it works untill here\n                Cursor bpLastDaysList = dao.lastXdays_bp(start, end);\n                Log.d(\"BPT\", \"after\"); //doesn't reach the code here!!\n/////////////////////////////////////////////////////////////////////////////////////////\n            }\n        });\n    }\n\n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        dao.close();\n    }\n\n    public void onItemSelected(AdapterView&lt;?&gt; arg0, View arg1, int arg2,\n            long arg3) {\n        int position = spinner.getSelectedItemPosition();\n        switch (position) {\n\n                // last day\n        case 0:\n            theStart.add(Calendar.DAY_OF_MONTH, -1);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n\n        // last 7 days\n        case 1:\n            theStart.add(Calendar.DAY_OF_MONTH, -7);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n\n        // last 30 days\n        case 2:\n            theStart.add(Calendar.DAY_OF_MONTH, -30);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>But it gives me this <strong>logcat error</strong>:</p>\n\n<pre><code>    FATAL EXCEPTION: main\nandroid.database.sqlite.SQLiteException: near \"09\": syntax error: , while compiling: SELECT DISTINCT systolic, diastolic, datetime, _id, notes, pulses FROM bp_import WHERE datetime BETWEEN 2012-10-12 09:44 AND 2012-10-12 09:44 ORDER BY datetime DESC\nat android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)\n...\nat android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1405)\nat com.oikonomopo.blood.pressure.tracker.dao.BpDAO.lastXdays_bp(BpDAO.java:76)\nat com.oikonomopo.blood.pressure.tracker.EmailActivity$1.onClick(EmailActivity.java:70)\n</code></pre>\n\n<p><strong>android.database.sqlite.SQLiteException: near \"09\": syntax error: , while compiling: SELECT DISTINCT systolic, diastolic, datetime, _id, notes, pulses FROM bp_import WHERE datetime BETWEEN 2012-10-12 09:44 AND 2012-10-12 09:44 ORDER BY datetime DESC</strong></p>\n\n<hr>\n\n<p>The code for the function of the BpDAO class is :</p>\n\n<pre><code>    public class BpDAO {\n        private DatabaseHelper_bp dbHelper;\n        private SQLiteDatabase database;\n        /**\n         * Movie table related constants.\n         */\n        public final static String bp_TABLE = \"bp_import\";\n        public final static String bp_ID = \"_id\";\n        public final static String bp_DT = \"datetime\";\n        public final static String bp_SYS = \"systolic\";\n        public final static String bp_DIA = \"diastolic\";\n        public final static String bp_PUL = \"pulses\";\n        public final static String bp_NOT = \"notes\";\n\n        public BpDAO(Context context) {\n            dbHelper = new DatabaseHelper_bp(context);\n            database = dbHelper.getWritableDatabase();\n        }\n\n        /**\n         * \\ Creates a new blood pressure measure\n         * \n         * @param datetime\n         * @param systolic\n         * @param diastolic\n         * @param pulses\n         * @param notes\n         * @return\n         */\n        public long importBP(String datetime, String systolic, String diastolic,\n                String pulses, String notes) {\n            ContentValues values = new ContentValues();\n            values.put(bp_DT, datetime);\n            values.put(bp_SYS, systolic);\n            values.put(bp_DIA, diastolic);\n            values.put(bp_PUL, pulses);\n            values.put(bp_NOT, notes);\n            return database.insert(bp_TABLE, null, values);\n        }\n\n    // this is working perfect\n        /**\n         * Fetch all bps sorted DESCending\n         * @return\n         */\n        public Cursor fetchAll_bp() {\n            Cursor mCursor = database.query(true, bp_TABLE, new String[] { bp_SYS,\n                    bp_DIA, bp_DT, bp_ID, bp_NOT, bp_PUL }, null, null, null, null,\n                    bp_DT + \" DESC\", null);\n            if (mCursor != null) {\n                mCursor.moveToFirst();\n            }\n            return mCursor;\n        }\n    // here is the problem!\n        /**\n         * Fetch all bps sorted DESCending by date(yyyy-mm-dd hh:mm) of last\n         * X[1-7-30] days\n         * @return\n         */\n        public Cursor lastXdays_bp(String start, String end) {\n            Cursor mCursor = database.query(true, bp_TABLE, new String[] { bp_SYS,\n                    bp_DIA, bp_DT, bp_ID, bp_NOT, bp_PUL }, \"datetime BETWEEN \"\n                    + start + \" AND \" + end, null, null, null, bp_DT + \" DESC\",\n                    null);\n            if (mCursor != null) {\n                mCursor.moveToFirst();\n            }\n            return mCursor;\n        }\n//\n        public void close() {\n            database.close();\n        }\n    }\n</code></pre>\n\n<p>And the code of the DatabaseHelper_bp(extends SQLiteOpenHelper) is :</p>\n\n<pre><code>    public class DatabaseHelper_bp extends SQLiteOpenHelper {\n\n    private static final String DATABASE_NAME = \"bpDB\";\n    private static final int DATABASE_VERSION = 1;\n\n    // Database creation sql statement\n    private static final String DATABASE_CREATE = \"create table bp_import ( _id integer primary key, datetime text not null, systolic text not null, diastolic text not null, pulses text not null, notes text not null);\";\n\n    public DatabaseHelper_bp(Context context) {\n        super(context, DATABASE_NAME, null, DATABASE_VERSION);\n    }\n\n    // Method is called during creation of the database\n    @Override\n    public void onCreate(SQLiteDatabase database) {\n        database.execSQL(DATABASE_CREATE);\n    }\n\n    // Method is called during an upgrade of the database,\n    @Override\n    public void onUpgrade(SQLiteDatabase database, int oldVersion,\n            int newVersion) {\n        Log.w(DatabaseHelper_bp.class.getName(),\n                \"Upgrading database from version \" + oldVersion + \" to \"\n                        + newVersion + \", which will destroy all old data\");\n        database.execSQL(\"DROP TABLE IF EXISTS bp_import\");\n        onCreate(database);\n    }\n}\n</code></pre>\n\n<p>I save the datetime as text in sqlite. (2012-10-12 09:43)</p>\n"},{"tags":["php","sql-server","arrays","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12856662,"title":"Selecting one value from an array called by a query in PHP","body":"<p>Basically I have a query called using PHP:</p>\n\n<pre><code>&lt;?php $result = mssql_query(\"SELECT * FROM Colours WHERE Type = 'type1' \");\n\n\nwhile ($row = mssql_fetch_array($result)) { \n\nif ($row['ColourID'] == \"1\") {\n\n    $sayclass1=\"imgactive\";\n\n    }else{\n\n    $sayclass1=\"imginactive\"; }\n\n\n            ?&gt;\n</code></pre>\n\n<p>As you can see once I execute the query I then loop it, the problem is that it returns an array, now in some instances I need to use the full array, but I would like to be able to select one entry from it for if statements and such. For example:</p>\n\n<pre><code>&lt;img id=\"h\" src=\"&lt;?php echo $row['thumbimg']; ?&gt;\n</code></pre>\n\n<p>now thumbimg is a column in my DB, and it just holds a url. However due to the fact its an array the picture doesn't display because its echoing all the values, so instead of <strong>images/image1.png</strong> for example it is echoing <strong>images/image1.png images/image2.png images/image3.png</strong> etc etc...</p>\n\n<p>I hope that makes sense, and can anyone tell me how to manipulate the query/code slight to still return all the entries but to select certain values from the arrays please?</p>\n"},{"tags":["php","sql","query","injection","parameterized"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12856566,"title":"Is using parameterized in just the login script enough?","body":"<p>More of a risk assessment question than technical.</p>\n\n<p>So i have been reading a lot about protecting against SQL Injection. Lets assume i have a large web application that is mostly unprotected and i need to make some improvements to protect against this problem.  Read large as lots of SQL interaction using dynamic queries but on few (less than 100 registered users).</p>\n\n<p>My question is... If i have already secured the main login script (the only publicly available user input) using parameterized queries, is it really that necessary to do the same work for the rest of the site?  I mean if a potential attacker can't log in, how much other damage can he do? </p>\n\n<p>Assuming of course none of my registered users have malicious intent.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12855661,"title":"Calculate count of rows in MySQL query","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4483798/count-and-distinct-can-i-use-together\">COUNT() and DISTINCT can i use together?</a>  </p>\n</blockquote>\n\n\n\n<p>I have this sql statement:</p>\n\n<pre><code>SELECT * FROM wp_posts\nINNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id)\nWHERE ( wp_term_relationships.term_taxonomy_id IN (4,3) )\nAND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'published')\n</code></pre>\n\n<p>and I get two rows with the same ID => expected</p>\n\n<p>adding <code>GROUP BY wp_posts.ID</code> will reduce the count of rows to one</p>\n\n<p>Now I would like to get the number of rows with and SQL query</p>\n\n<pre><code>SELECT COUNT(*) AS cnt FROM wp_posts\nINNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id)\nWHERE ( wp_term_relationships.term_taxonomy_id IN (4,3) )\nAND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'published')\nGROUP BY wp_posts.ID\n</code></pre>\n\n<p>I'll get as result \"2\" instead of \"1\", even with the \"GROUP BY\".</p>\n\n<p>What is the correct statement to get the numbers of rows from the first statement?</p>\n"},{"tags":["php","query","count","google-api","google-index"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12856051,"title":"Google API for finding no. of domains and subdomains indexed in google","body":"<p>Well I am trying to do this for a long time but unable to finalize and I am almost stuck on a point.</p>\n\n<p>For now I am able to count the no. of results for a specific domain name but what I need next is to also find the no. of indexed results for all subdomains of a specific domain.</p>\n\n<p>I have this function for counting the number of results</p>\n\n<pre><code>function getGoogleCount($domain) {\n    $content = file_get_contents('http://ajax.googleapis.com/ajax/services/' .\n        'search/web?v=1.0&amp;filter=0&amp;q=site:' . urlencode($domain));\n\n\n    $data = json_decode($content);\n\n\n    return ($data-&gt;responseData-&gt;cursor-&gt;resultCount);\n</code></pre>\n\n<p>My Questioning Ideas:</p>\n\n<p>1) I don't think but is there any query that I can use in google for finding list of all the subdomains and then I can loop all of the subdomains through this function for finding index result count of each sub domain?</p>\n\n<p>(Saying something like <code>site:*.domain.com/</code> really doesn't help)</p>\n\n<p>2) Google API provides us the urls of all the indexed results. I think if I get all the urls and then shortlist the urls to find out the unique (non repeating) sub domains. Once I found the list of subdomains I can loop them through the function I already have to find count of each.?</p>\n\n<p>No doubt that link to this (deprecated) API is <a href=\"http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=\" rel=\"nofollow\">http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=</a></p>\n"},{"tags":["android","query","sqlite","sqliteopenhelper","android-sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":11283290,"title":"querying my database using cursor","body":"<p>I have a database set up and I know I am inserting to it correctly.  I am, however, having difficulty returning any data from it through a query.  This is my main class and database helper class.</p>\n\n<pre><code>public class DBTesterActivity extends Activity {\n\nMyDBAdapter db;\nCursor cursor;\n\n/** Called when the activity is first created. */\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n    Item item1;\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.main);\n\n\n    db = new MyDBAdapter(this);\n    db.open();\n    db.insertEntry(item1 = new Item(\"Bathtub\", \"Bathroom\", \"Typical\", \"Clean\", \"fill, wash\", \"Round, deep\", \"Bathroom\", \"Toilet, Bathroom\", R.drawable.ic_launcher));\n    //this.populateDatabase();\n    //Cursor entryCursor = db.getAllEntries();\n    item1 = db.getEntry(1);\n    Log.i(\"db\", item1.toString());\n}\n</code></pre>\n\n<p>and my database adapter class here...</p>\n\n<pre><code>public class MyDBAdapter {\nprivate static final String DATABASE_NAME = \"myDatabase.db\";\nprivate static final String DATABASE_TABLE = \"mainTable\";\nprivate static final int DATABASE_VERSION = 1;\n\n//main table columns\npublic static final String KEY_ITEM              = \"itemName\";\npublic static final String KEY_GROUP             = \"itemGroup\";\npublic static final String ITEM_CLASSIFICATION   = \"classification\";\npublic static final String KEY_USE               = \"use\";\npublic static final String KEY_ACTION            = \"action\";\npublic static final String KEY_PROPERTIES        = \"properties\";\npublic static final String KEY_ASSOCIATION       = \"association\";\npublic static final String KEY_IMG_ID            = \"imgId\";\n\n// The index (key) column name for use in where clauses.\npublic static final String KEY_ID=\"_id\";\n\n// The name and column index of each column in your database.\npublic static final int NAME_COLUMN = 1;\npublic static final int GROUP_COLUMN = 2;\npublic static final int CLASSIFICATION_COLUMN = 3;\npublic static final int USE_COLUMN = 4;\npublic static final int ACTION_COLUMN = 5;\npublic static final int PROPERTIES_COLUMN = 6;\npublic static final int ASSOCIATION_COLUMN = 7;\npublic static final int IMG_ID_COLUMN = 8;\n// TODO: Create public field for each column in your table.\n\n// SQL Statement to create a new database.\nprivate static final String DATABASE_CREATE = \"create table \" + \n        DATABASE_TABLE + \" (\" \n        + KEY_ID + \" integer primary key autoincrement, \" \n        + KEY_ITEM + \" TEXT, \" \n        + KEY_GROUP + \" TEXT, \" \n        + ITEM_CLASSIFICATION + \" TEXT, \" \n        + KEY_USE + \" TEXT, \" \n        + KEY_ACTION + \" TEXT, \" \n        + KEY_PROPERTIES + \" TEXT, \" \n        + KEY_ASSOCIATION + \" TEXT, \" \n        + KEY_IMG_ID + \" INTEGER);\";\n\n// Variable to hold the database instance\nprivate SQLiteDatabase db;\n// Context of the application using the database.\nprivate final Context context;\n// Database open/upgrade helper\nprivate myDbHelper dbHelper;\n\npublic MyDBAdapter(Context _context) {\n    context = _context;\n    dbHelper = new myDbHelper(context, DATABASE_NAME, null, DATABASE_VERSION);\n}\n\npublic MyDBAdapter open() throws SQLException {\n    try {  \n        db = dbHelper.getWritableDatabase();\n    } catch (SQLiteException e) {\n        db = dbHelper.getReadableDatabase();\n    }\n    return this;\n}\n\npublic void close() {\n    db.close();\n}\n\npublic void insertEntry(Item item) {\n    // TODO: Create a new ContentValues to represent my row\n    // and insert it into the database.\n    SQLiteDatabase db = dbHelper.getWritableDatabase();\n\n    ContentValues values = new ContentValues();\n    values.put(KEY_ITEM, item.get_item_name());\n    values.put(KEY_GROUP, item.get_group());\n    values.put(ITEM_CLASSIFICATION, item.get_item_classification());\n    values.put(KEY_USE, item.get_use());\n    values.put(KEY_ACTION, item.get_action());\n    values.put(KEY_PROPERTIES, item.get_properties());\n    values.put(KEY_ASSOCIATION, item.get_association());\n    values.put(KEY_IMG_ID, item.get_img_id());\n\n    // insert row to table\n    try{\n        db.insertOrThrow(DATABASE_TABLE, null, values);\n        Log.i(\"success\", \"insert was successful\");\n    }catch (Exception e){Log.w(\"insertFail\", \"insert failed: \" + e.toString());}\n\n\n}\n  public Item getEntry(long _rowIndex) {\n// TODO: Return a cursor to a row from the database and\n// use the values to populate an instance of MyObject\n  SQLiteDatabase db = dbHelper.getReadableDatabase();\n\n  Cursor cursor = db.query(false, DATABASE_TABLE, new String[] { KEY_ID,\n          KEY_ITEM, KEY_GROUP, ITEM_CLASSIFICATION, KEY_USE, KEY_ACTION, KEY_PROPERTIES, KEY_ASSOCIATION, KEY_IMG_ID}, KEY_ID + \"=?\",\n          new String[] { String.valueOf(_rowIndex) }, null, null, null, null);\n  if (cursor != null)\n      cursor.moveToFirst();\n\n  Item item = new Item(Integer.parseInt(cursor.getString(0)),\n          cursor.getString(1), cursor.getString(2), cursor.getString(3), cursor.getString(4), cursor.getString(5), cursor.getString(6), cursor.getString(7), cursor.getString(8),  Integer.parseInt(cursor.getString(9)));\n  // return contact\n  return item;\n</code></pre>\n\n<p>}</p>\n\n<p>I am getting these in my logCat ----  Bad request for field slot 0,9. numRows = 1, numColumns = 9<br>\nand                             ----  java.lang.IllegalStateException: get field slot from row 0 col 9 failed</p>\n"},{"tags":["mysql","sql","query","join","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12853516,"title":"Reforming table structure of columns possible?","body":"<p>I have bee at this all day. I have played around with a lot of MySQL code and I am either inept, or not very good at coding.. </p>\n\n<p><strong>I have a table</strong></p>\n\n<pre><code>name     id       type      amount\n=================================\napple    21       cars      67\napple    21       bikes     85\napple    21       skates    557\napple    21       pajs      56\norange   34       bikes     345\norange   34       disks     678\norange   34       cars      234\norange   34       pajs      5678\n</code></pre>\n\n<p><strong>I want to write a query that will bring back the table in this form</strong></p>\n\n<pre><code>name    id cars bikes skates pajas disks\n=========================================\napple   21 67   85    557    56    0    \norange  34 234  345   0      5678  678\n</code></pre>\n\n<p>I really just have no clue where to start. Sorry if this is noobie question but MySQL is really hard to conceptualize sometimes.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12853529,"title":"MySQL Query: Consider A Value As Another Value","body":"<p>I need to do a query to count instances of different values and group them.</p>\n\n<pre><code>SELECT COUNT(*), Type FROM Table GROUP BY Type\n</code></pre>\n\n<p>The values for Type can be C, V, and I - but I want it to consider any values that are I to be V.</p>\n\n<p>So: <br>\n    C = C<br>\n    V = V<br>\n    I = V<br></p>\n\n<p>How can I do this in a query?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12852692,"title":"Mysql squery to get the value not mapped","body":"<p>I got the table structure as follows</p>\n\n<pre>\n--------------------------------\nid   processId   newId     value\n--------------------------------\n1        1        1         a\n2        1        2         b\n3        1        4         c\n4        2        5         d\n--------------------------------\n</pre>\n\n<p>and </p>\n\n<pre>\n------------------------\nid   processId  mapnewId\n------------------------\n1        1        1\n2        1        2\n------------------------\n\n</pre>\n\n<p>How should i get the value \"<b>c</b>\" (that means i should get the value which is not mapped to \"<b>1</b>\" in the second table) from the table in which the id mapped.</p>\n"},{"tags":["query","sparql","ontology"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12816284,"title":"SPARQL: Query to get all Instances of two classes that share the same connections to a third class","body":"<p>Im trying to understand the capabilities of SPARQL an im wondering if this kind of query is possible:</p>\n\n<p><a href=\"http://www.pictureupload.de/originals/pictures/101012113644_ProblemDiagram.jpeg\" rel=\"nofollow\">Diagram of my Ontology structure</a> (sorry, Im not allowed to post pictures yet)</p>\n\n<p>I want to get all instances of class A and B that have connections to the same Instances of class B. So some kind of:</p>\n\n<pre><code>Select ?a, ?c\nWhere\n{\n ?a myOntology:ab ?c .\n ?c myOntology:cb ?B .\n}\n</code></pre>\n\n<p>Which would give me:</p>\n\n<pre><code>A:1 C:1\nA:2 C:1 (with B:2)\nA:2 C:1 (with B:3)\n</code></pre>\n\n<p>(Where the letter is the class and the number the instance, counted from the top)</p>\n\n<p>But with the difference that I only want the ones that have exactly the same related instances of B:</p>\n\n<pre><code>A:2 C:1 (with B:2 and B:3)\n</code></pre>\n\n<p>Is that possible or do I have to use external logic to get that?</p>\n\n<p>I would be pleased for any answers...</p>\n"},{"tags":["sql","oracle","query","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12849976,"title":"Oracle SQL Left Join with sum and fields other than \"join on\" fields","body":"<p>I have two tables.</p>\n\n<p>First table is \"a\" with fields a.pr, a.info and a.id.  Second table is \"b\" with fields b.id and b.amount.</p>\n\n<p>a.id = b.id, though multiple b.id's may match with a single a.id.</p>\n\n<p>My SQL statement is as follows:</p>\n\n<pre><code>SELECT a.pr, a.info, a.id, SUM(b.amount) AS total\nFROM   a \nLEFT JOIN b ON a.id=b.id\nWHERE  a.pr = \"549\"\nGROUP BY a.id\n</code></pre>\n\n<p>Now, this doesn't work.  It throws a \"not a GROUP BY expression\" error.  As I understand it, I need a subquery, but none of the examples I found seemed to exactly match what I am trying to accomplish here, and I couldn't get any of them to work right.</p>\n\n<p>What would the full SQL statement (with subquery) look like in this case?</p>\n"},{"tags":["vb.net","query","ms-access","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":192,"score":1,"question_id":12851692,"title":"Get result of MS Access query into textbox in VB.NET","body":"<p>I have a table in MS Access which has a colum named NameC (using ODBC to connect to MS Access)</p>\n\n<p>I want the result of the following query to be saved in a txtField</p>\n\n<pre><code>Dim query = \"SELECT NameC FROM Table WHERE ClientID = \" &amp; Integer.Parse(clientID) \n</code></pre>\n\n<p>How to do that in VB.NET?</p>\n\n<p>I have a <code>txtNameC.Text</code> field</p>\n\n<p>I currently was reviewing some sample code and they do:</p>\n\n<pre><code>  Dim _consultationTable As DataTable\n  Public Sub Load()\n    Dim query = \"SELECT * FROM Table WHERE ClientID = \" &amp; Integer.Parse(clientID)\n    Me._consultationTable = DatabaseFunctions.GetDataTable(query)\n    dvgInfo.Rows.Clear()\n    For Each  dtRow In Me._consultationTable.Rows\n        dvgInfo.Rows.Add()\n        dvgInfo.Rows.Add(dvgInfo.RowCount-1).Cells(\"ColClientID\").Value = dtRow(\"ClientId\").ToString()\n   Next\n</code></pre>\n\n<p>but I do not want to fill a table I just want to get the result of a query into a text box\nHow can I do this?</p>\n\n<p>I want to do something like this but just return a value and save it into a textbox</p>\n\n<pre><code>Protected Sub BindData()  \n   strSQL = \"SELECT * FROM customer\"  \n\n   Dim dtReader As OdbcDataReader  \n   objCmd = New OdbcCommand(strSQL, objConn)  \n   dtReader = objCmd.ExecuteReader()  \n\n   '*** BindData to GridView ***'  \n   myGridView.DataSource = dtReader  \n   myGridView.DataBind()  \n\n   dtReader.Close()  \n   dtReader = Nothing  \nEnd Sub  \n\n\nProtected Sub BindData()  \n   strSQL = \"SELECT SpecificValue FROM customer where x = y...\"  \n\n   Dim dtReader As OdbcDataReader  \n   objCmd = New OdbcCommand(strSQL, objConn)  \n   dtReader = objCmd.ExecuteReader()  \n\n   '*** BindData to GridView ***'  \n   myGridView.DataSource = dtReader  \n   myGridView.DataBind()  \n\n   dtReader.Close()  \n   dtReader = Nothing  \nEnd Sub  \n</code></pre>\n"},{"tags":["sql","mysql","query","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1437,"score":3,"question_id":4561650,"title":"mysql GROUP_CONCAT duplicates","body":"<p>I make my join from a farmTOanimal table like this.  There is a similar farmTotool table</p>\n\n<pre><code>id | FarmID  | animal\n 1 |    1    | cat\n 2 |    1    | dog\n</code></pre>\n\n<p>When I join my tables in a view, I get a result that looks like this</p>\n\n<pre><code>FarmID | animal | tool\n   1   |  cat   | shovel\n   1   |  dog   | shovel\n   1   |  cat   | bucket\n   1   |  dog   | bucket\n</code></pre>\n\n<p>Now, I do GROUP BY FarmID, and GROUP_CONCAT(animal) and GROUP_CONCAT(tool), i get</p>\n\n<pre><code>FarmID |     animals     |         tools\n  1    | cat,dog,cat,dog | shovel,shovel,bucket,bucket\n</code></pre>\n\n<p>But, what I really want is a result that looks like this.  How can I do it?</p>\n\n<pre><code>FarmID | animals |    tools\n  1    | cat,dog | shovel,bucket\n</code></pre>\n"},{"tags":["database","oracle","query","plsql","oraclereports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12851617,"title":"oracle pl/sql how to call back this alias created for a parameter?","body":"<p>i have a query im doing to display records to oracle reports. the parameter i need as selection is the <code>class_code</code> but when user click on the dropdown value it's a bit messy for them(hard to explain here) so they ask to combine the <code>study_intake</code> and <code>class_code</code> as a word which would be clear to them.</p>\n\n<p>now what i did is use AS for alias of a new column which combines the two, but i cant call it back (since it's not the right syntax)</p>\n\n<p>here's a sample of my query:</p>\n\n<pre><code>SELECT DISTINCT STUDENT_ATTENDENTS.IC_PASSPORT, \nSTUDENT_ATTENDENTS.NAME,\n STUDENT_ATTENDENTS.A_DATE, \nSTUDENT_ATTENDENTS.A_TYPE, \nSTUDENT_ATTENDENTS.ATTEN, \nTUTORIAL_CLASSES_MASTER.LECTURER_NAME, \nSTUDENT_ATTENDENTS.COURSE_CODE, \nSTUDENT_ATTENDENTS.SUBJECT_CODE, \nSUBJECT_MASTER_TABLE.CREDIT_POINT,\nTUTORIAL_CLASSES_MASTER.STUDY_INTAKE || ' ' || STUDENT_ATTENDENTS.CLASS_CODE AS Study_Intake_Class_Code\n\n\nFROM STUDENT_ATTENDENTS, TUTORIAL_CLASSES_MASTER, SUBJECT_MASTER_TABLE\n\nWHERE Study_Intake_Class_Code = :CLASS_DODE\nAND STUDENT_ATTENDENTS.SUBJECT_CODE = SUBJECT_MASTER_TABLE.SUBJECT_CODE\nAND (STUDENT_ATTENDENTS.CLASS_CODE = TUTORIAL_CLASSES_MASTER.CLASS_CODE)\n</code></pre>\n\n<p>the line <code>WHERE Study_Intake_Class_Code = :CLASS_DODE</code> will return an error which is </p>\n\n<blockquote>\n  <p>ORA-00904: \"STUDY_INTAKE_CLASS_CODE\": invalid identifier </p>\n</blockquote>\n\n<p>i cant use back the alias. an idea i came up with is to create a <strong>view</strong> but this made the report haywire and affecting all the formulas(i didnt create the original report)</p>\n\n<p>how do i adjust this query to make it work? any ideas or other style of query?</p>\n"},{"tags":["query","select","oracle10g","intersection","ora-00932"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":222,"score":1,"question_id":5014952,"title":"Oracle Error: inconsistent datatypes","body":"<p>I am using the following query in my ORACLE(10g) DB. </p>\n\n<p><strong>SELECT * from student_table where student_no like '%STUDENT%' \nINTERSECT \nSELECT * from student_table where student_no in ('STUDENT1234','STUDENT5678')</strong></p>\n\n<p>I got error like:\n<strong>java.sql.SQLSyntaxErrorException: ORA-00932: inconsistent datatypes: expected - got CLOB</strong> </p>\n\n<p>Any Idea how to resolve this Error?</p>\n"},{"tags":["query","crystal-reports","report","feed"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":328,"score":0,"question_id":9920533,"title":"SAP Crystal reports for VS 2010. Change the query at run time","body":"<p>I am using SAP CR for VS 2010 in C sharp. i have five tables and i am linking them with the following query:</p>\n\n<p>query = \"SELECT Items.AccessionNo, Items.Name, Items.LocalName, Items.Usage, Items.Province, Items.District, Items.VillTown, Items.EthnicCommunity, Arts.Name, Items.PurchasedDonated, Items.PurchasedFrom, Items.YearOfCollection, Items.Material, Items.Height, Items.Width, Items.Length, Items.Circumference, Items.Diameter, Items.Color, Items.Age, Items.Weight, Items.PurchasedValue, Items.Rare, Items.LivingDyingTrad, Items.ManufacturingProcess, Items.PlaceOfManufacturing, Items.ConditionReport, Items.Recommandations, Items.DateOfAddition, Items.Placement, Donators.Name, Collectors.Name, Placement.Name FROM Items INNER JOIN Arts ON Items.ArtId=Arts.ArtId INNER JOIN Donators ON Items.DonatorId=Donators.id INNER JOIN Collectors ON Items.CollectorId=Collectors.id INNER JOIN Placement ON Items.PlacementId=Placement.id WHERE Items.id=\" + itemid;</p>\n\n<p>The problem is that the report still shows up multiple results using the already embedded query at the time of design.</p>\n\n<p>I am using the following code to pass the above query</p>\n\n<pre><code>           SqlCommand cmd = new SqlCommand(query, dbconn.conn);\n            if (dbconn.conn.State == ConnectionState.Closed)\n            {\n                dbconn.conn.Open();\n            }\n\n            SqlDataAdapter Datadpt = new SqlDataAdapter(cmd);\n\n            DataSet dtset = new DataSet(\"items\");\n            Datadpt.Fill(dtset);\n            //rep is the Report document object already defined\n            rep.Load(@\"..\\..\\Reports\\CRItem.rpt\");\n            rep.SetDataSource(dtset);\n            CRViewer.ReportSource = rep;\n            if (dbconn.conn.State == ConnectionState.Open)\n            {\n                dbconn.conn.Close();\n            }\n            this.CRViewer.RefreshReport();\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["php","mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12734020,"title":"php date and mysql timestamp comparison","body":"<p>How can I do a select from a db field that uses a timestamp when all I have from php is a date? </p>\n\n<pre><code>$date = 2012-10-03;\n</code></pre>\n\n<p>something like:</p>\n\n<pre><code>\"select value from table where completed_date = $date\" \n</code></pre>\n\n<p>only the value for completed_date is really something like \"2012-10-03 02:16:10\" what I really would like is all values that are the same day as $date and for the query to almost disregard the time aspect of the timestamp for this query. Is that possible? </p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","query","group-by","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12849720,"title":"GROUP CONCAT and GROUP BY issue","body":"<p>suppose an object can have multiple tids</p>\n\n<p>now suppose I do this query: </p>\n\n<pre><code>SELECT n.nid, t.tid, GROUP_CONCAT(t.tid) \nFROM node n JOIN term_node t ON t.nid = n.nid \nGROUP BY n.nid \nHAVING t.tid = 31;\n</code></pre>\n\n<p>In which I want to fetch entries in table node that has tid = 31...but then I also want a list of all the tids corresponding to that row (hence the GROUP_CONCAT) even if they are not 31</p>\n\n<p>Using WHERE t.tid = 31 will leave out the tids that are not 31 from the GROUP concat\nand using HAVING t.tid = 31 will leave out rows in which the tid column that appears in the GROUPed row is not 31</p>\n\n<p>Either way has the potential to make the GROUP_CONCAT list incomplete or the rows of nodes with at least one tid = 31 incomplete </p>\n\n<p>Is there a way to resolve this such that I am guaranteed to get ALL the nodes in which the node has at least one tid association equals to 31 AND that GROUP_CONCAT will list ALL The list of tids associated with that node?</p>\n"},{"tags":["sql","query","join","exists"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12849945,"title":"How to do WHERE ((SELECT COUNT(*) ...) = 0 OR EXISTS (SELECT * FROM ...))?","body":"<p>For example, I have a table <code>Person</code> having an ID for each entry and I have a table <code>PersonEvent</code> which records the <code>personID</code> of each person at an event.</p>\n\n<p>If <code>PersonEvent</code> contains no rows for the event, everyone in the <code>Person</code> table attended.  However if there are entries in the <code>PersonEvent</code> table, only those people attended the event.</p>\n\n\n\n<p>I want to do a query such as:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * \nFROM Person p \nWHERE ((SELECT COUNT(*)\n        FROM PersonEvent pe \n        WHERE pe.personID = p.ID \n        AND pe.eventID = '290') = 0 \n      OR EXISTS \n        (SELECT * \n         FROM PersonEvent pe \n         WHERE pe.personID = p.ID \n         AND pe.eventID = '290'))\n</code></pre>\n\n<p>How do I do this?</p>\n"},{"tags":["mysql","query","overhead-minimization"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12848758,"title":"MySQL Database Structure Decisions","body":"<p>I'm trying to decide between having 1 enormous table for all the possible data about a user, a lot of which won't apply to every user, and then having a separate table for the data that a user can have multiple instances of (for example, previous jobs) versus having the data about each user distributed between multiple tables. </p>\n\n<p>The first way is more streamlined but I feel like it would use a ton of unnecessary overhead, whereas the second way results is easier to work with but results in a lot of extra database queries.</p>\n"},{"tags":["query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12849035,"title":"\"Find Unmatched\" Query -- Using Queries instead of Tables","body":"<p>I'm using Access 2010.</p>\n\n<p>I have a database with multiple tables, each containing different components of teaching data.</p>\n\n<p>Ultimately, I'd like to find \"people who will be teaching a course in the upcoming semester and who have never taught before.\"</p>\n\n<p>Currently, I am doing this through a series of steps:</p>\n\n<ol>\n<li>Creating one table (through a query) that has a list of everyone who is teaching in the upcoming semester and what they are teaching (this data comes from multiple tables). <strong>(tbl_NewInstructors)</strong></li>\n<li>Creating another table (through a query) that has a list of everyone who has ever taught (but not including this upcoming semester). <strong>(tbl_NewInstructors2)</strong></li>\n<li><p>Running this select statement:</p>\n\n<pre><code>SELECT tbl_NewInstructors.Name, tbl_NewInstructors.Course \n\nFROM tbl_NewInstructors\n\nWHERE (((Exists (SELECT * from tbl_NewInstructors2 \n\nWHERE tbl_NewInstructors2.Name = tbl_NewInstructors.Name))=False));\n</code></pre></li>\n<li><p>Getting my list!</p></li>\n</ol>\n\n<p>The main issue is that I have to create two tables each time I want to run this, and I would RATHER just run a query of my two current select queries, than a query on tables that I create through those queries. Unfortunately, when I try to run a query on the queries, it doesn't work. </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12848733,"title":"SQL query using both LIKE and IN with wild cards","body":"<p>I have a database table where users can filter a single column using a large number of variables and currently my sql query strings look something like:</p>\n\n<pre><code>SELECT * \nFROM TABLE1\nWHERE COLUMN1 LIKE '%APPLE%'\nAND COLUMN1 LIKE '%ORANGE%'\nAND COLUMN1 LIKE '%GRAPE%'\nAND COLUMN1 LIKE '%LEMON%'\nAND COLUMN1 LIKE '%LIME%'\nAND COLUMN1 LIKE '%TOMATO%'\nAND COLUMN1 LIKE '%POTATO%'\n...\n</code></pre>\n\n<p>which becomes a pain to implement especially if I am using a parameterized query string in a table adapter to create fill and get methods that end up having 20 parameters.</p>\n\n<p>Is there any better way of doing this (like using the IN command so I only need one parameter)?</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":12847305,"title":"Building nested menus with one mysql table","body":"<p>Would be possible to build a nested menu with one mysql table? I have been making a table having the following structure but I'm having problem to build up the query </p>\n\n<pre><code>ID | Menu  | parent | position | active\n\n 1   test      0         1         1\n\n 2   test2     1         2         1\n</code></pre>\n\n<p>....</p>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":12841168,"title":"Multiple linq joins but different operators","body":"<p>How would I express the following in LINQ?</p>\n\n<pre><code>select * from table_1 t1\njoin table_2 t2 on t1.col1 = t2.col1 and t1.col2 &lt;= t2.col2\n</code></pre>\n\n<p>Here's what I've tried, but I'm not getting the desired results. I'm trying to join\nthe 2 tables but since <code>table_1</code> quantity is not greater or equal than what's in <code>table_2</code> quantity for <code>WidgetA</code>\nI wouldn't expect there to be any records in the results (in xList ).</p>\n\n<pre><code>    List&lt;anObj&gt; table_1 = new List&lt;anObj&gt;();\n    table_1.Add(new anObj() { Product = \"WidgetA\", Quantity = 0 });\n    table_1.Add(new anObj() { Product = \"WidgetB\", Quantity = 3 });\n\n    List&lt;anObj&gt; table_2 = new List&lt;anObj&gt;();\n    table_2.Add(new anObj() { Product = \"WidgetA\", Quantity = 1 });\n    table_2.Add(new anObj() { Product = \"WidgetB\", Quantity = 1 });\n\n    var xList =\n    from t1 in table_1\n    join t2 in table_2\n        on t1.Product equals t2.Product\n    where t1.Quantity &gt;= t2.Quantity\n    select new\n    {\n        t1,\n        t2\n    };\n\n    if (xList.Any())\n        Console.WriteLine(\"Found\");\n    else\n        Console.WriteLine(\"None\"); //I'm looking for this result.           \n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12848192,"title":"Using COUNT() to find how many rows exist in another table","body":"<p>This is the query that's been getting me everything I wanted to know about photos in my database up until now:</p>\n\n<pre><code>SELECT\n      users.facebook_id,\n      users.first_name,\n      users.last_name,\n      photos.*,\n      bookmarks.photo_id AS bookmark\nFROM\n      photos\nJOIN users\n      ON photos.author = users.facebook_id\nLEFT JOIN bookmarks\n    ON photos.id = bookmarks.photo_id\n    AND bookmarks.facebook_id = 123456789\nWHERE photos.description &lt;&gt; ''\nORDER BY photos.id DESC\n</code></pre>\n\n<p>However now, I'd like to get one more piece of information. I'd like to know how many votes have been cast on a particular photo.</p>\n\n<p>Here is my votes table:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `votes` (\n  `photo_id` int(11) NOT NULL,\n  `facebook_id` bigint(20) NOT NULL COMMENT 'The user''s Facebook ID.',\n  `date` varchar(10) NOT NULL COMMENT 'Date formatted as YYYY-MM-DD.',\n  UNIQUE KEY `one_vote_per_day` (`photo_id`,`facebook_id`,`date`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n</code></pre>\n\n<p>And here is what I tried already:</p>\n\n<pre><code>SELECT\n      count(votes.photo_id) as vote_count,\n      users.facebook_id,\n      users.first_name,\n      users.last_name,\n      photos.*,\n      bookmarks.photo_id AS bookmark\nFROM\n      photos\nJOIN users\n      ON photos.author = users.facebook_id\nLEFT JOIN votes\n    ON votes.id = photos.photo_id\nLEFT JOIN bookmarks\n    ON photos.id = bookmarks.photo_id\n    AND bookmarks.facebook_id = 123456789\nWHERE photos.description &lt;&gt; ''\nORDER BY photos.id DESC\n</code></pre>\n\n<p>Obviously I'm doing something wrong, because when I tried this, I'd never get more than a single photo in the result.</p>\n\n<p>This method works fine for me when I only need information on a single photo, but this query needs to work for all photos at once...</p>\n"}]}
